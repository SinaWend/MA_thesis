Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul  8 12:01:18 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673

 Experiment start at: 2024-07-08 12:09:10.231834
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9212329, 'precision': 0.81122535, 'recall': 0.7817981, 'specificity': 0.99132866, 'f1': 0.79054475, 'auroc': 0.99349076}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     0    0     6    2    0     1     3     7   10     69
1     1  1253    0    14    0    0     0    48     8    0      8
2     1     0  135     2   74    1     1     6    10   78      4
3     1     0    1  8005    0    8     0   258   164    2      1
4     2     0   13     1  325    2     0     3    31    9    153
5     1     0    1    83    3  307     0     0    11  114      1
6   129     3    3    18   32    1  1448    13    12   18    231
7     4    34   11   265   11    1     1  6699   198    6     31
8     4     2    6   188   23    0     0    44  2973    2     53
9     3     0   47    15   11   48     0     1     6  357      5
10   17     0    4     6  132    0     1    20    60    7  12545
---- Validation: 
scalar performance:
{'acc': 0.92296374, 'precision': 0.8130517, 'recall': 0.7882147, 'specificity': 0.99155784, 'f1': 0.794888, 'auroc': 0.9937544}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     0    0     7    2    1     0     4     4   10     62
1     0  1262    0    13    1    0     0    40     9    0      7
2     1     0  149     3   82    2     1     2     7   63      2
3     0     2    1  8020    1    6     0   249   158    2      1
4     1     0   15     0  326    4     0     3    35   12    143
5     1     0    1    82    2  303     0     0     9  122      1
6   142     3    1    23   24    1  1453     7    21   17    216
7     3    26    7   255   13    0     0  6712   211    6     32
8     3     1    4   191   22    2     0    43  2974    7     49
9     3     0   49    13    6   54     0     0     7  358      3
10   16     0    3     9  142    0     1    14    49    7  12555
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57524663, 'precision': 0.6245693, 'recall': 0.52661574, 'specificity': 0.9570369, 'f1': 0.5130239, 'auroc': 0.87555975}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1033     0    0  39    1    1     0    33     5   16    42
1      1  1101    1  23    0    0     0   281     7    2    83
2     12     0  108  11  337    2     0    77    95   80   293
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0  136    0     0     1     5    0  1490
5      5     0    1  87    1  146     0     1     9  329    13
6      8     3    0   2    3    0  1124     3    41    0  1883
7      2     0    0  14    0    0     0  1139     2    1     6
8      2     0    1  98   14    0     2    15  1201   10    27
9     14     2  197  75   25   11     0   126    62  589    36
10     0     0    0   0    1    0     0     0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-08 12:51:08.597774,epoch time: 0:41:58.365940,used: 0:41:58.365940,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9432523, 'precision': 0.84917504, 'recall': 0.8323337, 'specificity': 0.99388087, 'f1': 0.8282231, 'auroc': 0.99634266}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     2    0    0     1     2     1    5     17
1     0  1273    1    13    0    0     0    40     3    0      2
2     5     0  144     0   75    1     0     4     0   82      1
3    10     1    1  8126    1   10     1   189    92    8      0
4    11     0    7     0  346    2     0     5     6   12    150
5     4     0    0    36    0  302     1     0     8  169      1
6   102     0    1     3    3    0  1779     1     3    3     12
7    16    23    4   195    3    0     2  6964    34    7     15
8    27     0    5   152   22    0     1   129  2854    8     96
9     7     0   23     5    4   17     0     5     2  429      1
10  102     0    3     6   64    0    10    11     9    5  12583
---- Validation: 
scalar performance:
{'acc': 0.94099236, 'precision': 0.84367937, 'recall': 0.8325733, 'specificity': 0.9936495, 'f1': 0.8258397, 'auroc': 0.99653757}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     3    1    0     0     1     0    2     18
1     0  1278    1     8    0    0     1    37     4    0      3
2     4     0  146     0   65    0     1     7     2   85      2
3    15     2    2  8109    0   13     2   183    99   14      1
4     8     0    8     0  342    0     0     3    14   12    152
5     4     0    0    30    2  307     0     0     3  174      1
6   104     0    1     4    6    1  1771     3     4    2     12
7    16    24    7   215    5    0     2  6926    43    7     20
8    23     0    4   163   27    2     2   126  2841   16     92
9     6     0   23     6    4   19     0     3     2  430      0
10  116     0    3     7   61    0    12    14     8    4  12571
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70621985, 'precision': 0.6335563, 'recall': 0.5800355, 'specificity': 0.9703187, 'f1': 0.56673676, 'auroc': 0.8767915}
confusion matrix:
      0     1    2   3    4   5     6     7     8    9     10
0   1157     0    0   4    0   0     2     2     0    4     1
1     12  1170    3  15    0   0     1   243     2    4    49
2     56     1  138   1  547   0     9    35    33   33   162
3      0     0    0   0    0   0     0     0     0    0     0
4      4     0    0   0  186   0     2     1     0    0  1440
5     31     0   15  12   11  99     4     0     4  416     0
6      6     0    1   0    4   0  2944     0     0    1   111
7     24     0    2  48    2   0     1  1083     0    1     3
8     15     1   15  57   47   1    40    41  1123    9    21
9     61     1  343  16   56   4     2    61    16  555    22
10     0     0    0   0    6   0     1     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-08 13:31:00.985232,epoch time: 0:39:52.387458,used: 1:21:50.753398,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93993473, 'precision': 0.8547508, 'recall': 0.8394525, 'specificity': 0.9935627, 'f1': 0.8381738, 'auroc': 0.9964818}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     8    3    0     2     5     4    3     20
1     0  1274    0    24    1    0     0    28     3    0      2
2     4     1  164     4   59    1     1     9     3   65      1
3     1     0    0  8265    4    4     1    74    83    5      0
4     5     4   22     2  379    0     3     6    18   13     87
5     5     0    0    60    1  285     1     0     6  162      1
6    32     1    1    23    2    0  1834     1     7    0      7
7     1    30    2   476    6    0     1  6689    50    1      6
8     1     1    0   188   17    1     2    85  2985    4     10
9     6     1   29    12    2   14     0     3     3  423      0
10   46     9    6    11  193    0    25    32    74    4  12395
---- Validation: 
scalar performance:
{'acc': 0.93949443, 'precision': 0.85903895, 'recall': 0.842809, 'specificity': 0.9935137, 'f1': 0.8419744, 'auroc': 0.99619496}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0    12    3    0     5     2     3    5     22
1     0  1276    0    18    0    0     0    34     4    0      0
2     2     1  175     2   49    0     1    12     7   62      1
3     0     0    0  8277    3    2     0    64    88    6      0
4     8     3   18     3  381    1     1     4    24   13     83
5     6     0    0    51    2  298     1     0     7  155      1
6    42     2    0    34    2    0  1811     1     6    4      6
7     0    23    1   483    4    0     1  6680    61    4      8
8     0     1    1   186   26    0     0    86  2976    5     15
9     5     2   27    15    2   11     1     1     5  424      0
10   43     7    3    13  209    0    22    33    66    6  12394
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7357448, 'precision': 0.68060195, 'recall': 0.6017965, 'specificity': 0.97358555, 'f1': 0.60256344, 'auroc': 0.8861471}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   981     1    2   45    1    0    58    53    16   10     3
1     0  1289    0   45    0    0     1   151     7    0     6
2     5     2  130   17  360    1    19    66   301   71    43
3     0     0    0    0    0    0     0     0     0    0     0
4     3     1    1    0  568    0     3     3    31    0  1023
5     3     0    2  132    3  141    15     0    26  269     1
6     2     1    0   18    1    0  3012     2    16    0    15
7     3     0    0   93    0    0     2  1065     0    0     1
8     1     0    0  114    0    0     9     5  1240    1     0
9     3     3  100  141   18   24    18    84   238  498    10
10    0     0    0    0   51    0     2     0     1    0  1592
new oracle model saved
early stop counter: 1
val acc:0.9394944310188293, best validation acc: 0.9409923553466797, corresponding to test acc:                         0.7062198519706726 / 0.7357447743415833
after epoch: 3,now: 2024-07-08 14:10:47.492301,epoch time: 0:39:46.507069,used: 2:01:37.260467,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95184076, 'precision': 0.88455546, 'recall': 0.8334122, 'specificity': 0.9947392, 'f1': 0.842925, 'auroc': 0.9972844}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     1    1    0    16     3     0    5     45
1     0  1253    0    12    0    0     1    54     3    0      9
2     2     0  149     0   51    0     1     3     0  103      2
3     2     0    2  8149    2   18     6   128   113   15      2
4     5     0    9     1  344    0     1     1     5   11    162
5     0     0    0    13    0  258     0     0     3  246      1
6     2     0    0     1    2    0  1881     0     0    3     19
7     2     7    3   152    7    0     8  6987    48    8     41
8     3     0    2    78   51    2     0    85  2980   17     78
9     0     0    7     4    4    7     1     0     1  468      0
10    9     0    2     8   43    0    17     8     9    3  12695
---- Validation: 
scalar performance:
{'acc': 0.9516651, 'precision': 0.879249, 'recall': 0.83096874, 'specificity': 0.99474007, 'f1': 0.83958304, 'auroc': 0.9972129}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     4    0    0    15     1     0    8     45
1     0  1251    0    16    0    0     0    54     3    0      8
2     1     0  142     0   59    1     1     3     0  103      2
3     1     1    2  8139    1   19     3   156    97   21      0
4     4     0    9     0  339    0     1     1     3   16    166
5     0     0    0    18    1  263     0     0     2  236      1
6     6     0    0     3    2    0  1883     1     2    2      9
7     3     6    4   160    5    0     5  6987    53    7     35
8     1     0    2    67   54    2     2    83  2996   21     68
9     1     0   14     1    2    6     0     0     1  468      0
10   11     0    2     7   40    0    14     6    12    4  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7044008, 'precision': 0.64229274, 'recall': 0.5804614, 'specificity': 0.9701154, 'f1': 0.56939167, 'auroc': 0.87719333}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   881     0    0   9    3    2   101    13     1  133    27
1     2  1045    1  22    2    0     1   354     7    6    59
2     5     0  111   6  484    4    15    35    94  114   147
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  162    0     2     0     6    0  1463
5     0     0    1  45    4  155     1     0     7  379     0
6     0     0    0   1    0    0  3010     2     0    0    54
7     3     0    0  65    0    0     5  1072     0    1    18
8     0     0    0  63    6    2    16    26  1239   11     7
9     2     0  100  48   27   28     5    71    86  750    20
10    0     0    0   0    3    0     0     0     0    0  1643
better model found
persisted
after epoch: 4,now: 2024-07-08 14:50:49.717060,epoch time: 0:40:02.224759,used: 2:41:39.485226,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94368047, 'precision': 0.8797235, 'recall': 0.81171197, 'specificity': 0.9940226, 'f1': 0.8171116, 'auroc': 0.99756}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     0    1     2    0    2    19     1    11    3     51
1     0  1295    0     4    0    0     0    28     4    0      1
2     0     1  223     2    7   18     3    10    22   20      6
3     0     3    1  7858    0   16     2   189   368    0      0
4     3     0   52     1  210    5     0     4    70    4    190
5     0     0    0    12    0  495     0     0    11    2      1
6     1     1    0     1    0    2  1874     4     8    0     17
7     0    21    0    91    1    0     2  6892   247    0      9
8     0     3    1    27    0    0     0    39  3210    0     15
9     0     0   54     2    0  286     2     1    20  128      0
10    3     0    2     7    6    1     9    12    60    0  12693
---- Validation: 
scalar performance:
{'acc': 0.9438812, 'precision': 0.8829894, 'recall': 0.8135681, 'specificity': 0.99404454, 'f1': 0.8203489, 'auroc': 0.99752283}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     1    0     2    0    3    28     1     7    3     51
1     0  1296    0     2    0    0     0    27     5    0      2
2     1     0  225     1    7   20     2     4    26   16     10
3     0    13    1  7873    0   11     0   199   343    0      0
4     3     0   53     1  218    4     0     7    70    4    179
5     0     0    0    12    0  492     1     0    12    3      1
6     3     0    0     1    0    2  1868     4     8    0     22
7     0    17    0   106    1    0     1  6872   263    0      5
8     0     0    0    25    0    1     1    25  3229    0     15
9     0     0   48     2    0  282     0     1    24  136      0
10    5     0    3     7    3    0     7    10    69    1  12691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6722871, 'precision': 0.65368533, 'recall': 0.56958985, 'specificity': 0.96707535, 'f1': 0.5100716, 'auroc': 0.8782007}
confusion matrix:
     0     1   2    3   4    5     6     7     8   9     10
0   776     0   2   41   0   10   189    65    38  23    26
1     0  1251   0   21   0    0     0   210     8   0     9
2     0     1  68   12   6   72     0    76   626  10   144
3     0     0   0    0   0    0     0     0     0   0     0
4     0     0   1    0  23    0     1     1    94   0  1513
5     0     0   0   98   0  452     0     1    31   9     1
6     0     2   0   10   0    0  2899     4    78   0    74
7     0     0   0   11   0    0     0  1151     0   0     2
8     0     0   0   65   0    2     1    11  1290   0     1
9     2     2  24  126   0  390     2    91   422  56    22
10    0     0   0    0   0    0     2     0     1   0  1643
early stop counter: 1
val acc:0.9438812136650085, best validation acc: 0.9516651034355164, corresponding to test acc:                         0.7044007778167725 / 0.7357447743415833
after epoch: 5,now: 2024-07-08 15:30:33.085689,epoch time: 0:39:43.368629,used: 3:21:22.853855,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9586098, 'precision': 0.90639424, 'recall': 0.8678171, 'specificity': 0.9954071, 'f1': 0.88245934, 'auroc': 0.99810344}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     2    0     2    1    0     4     2     1    3     44
1     0  1307    0     2    0    0     0    19     3    0      0
2     2     0  235     3   19    1     0     3    13   30      6
3     1    11    0  8170    0    6     4   103   142    2      0
4     2     0   32     1  268    2     1     3    23    6    201
5     0     0    3    25    1  437     0     0     5   49      1
6     9     0    1     2    0    0  1876     1     2    0     17
7     1    27    1   218    1    0     2  6863   139    1     11
8     1     1    1    54    8    3     0    37  3155    2     33
9     1     1   41     7    0   61     0     3     9  369      1
10    6     0    2     8   15    1     6     9    17    2  12725
---- Validation: 
scalar performance:
{'acc': 0.9580313, 'precision': 0.9058768, 'recall': 0.8662035, 'specificity': 0.9953391, 'f1': 0.8811666, 'auroc': 0.998118}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     4    1    0     3     3     0    2     51
1     0  1308    0     3    0    0     0    20     1    0      0
2     2     0  237     1   22    2     1     0    16   27      4
3     0     8    2  8168    0    6     1   102   151    1      1
4     3     0   34     1  275    2     0     2    22    4    196
5     0     0    0    27    0  434     0     0     8   51      1
6    13     0    2     1    0    0  1872     1     5    0     14
7     0    30    0   222    1    0     1  6862   139    0     10
8     0     1    5    50    5    5     1    43  3140    3     43
9     0     0   45    12    0   64     0     1     9  362      0
10    4     0    5     8   10    1     4    10    15    0  12739
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.713706, 'precision': 0.6527568, 'recall': 0.5919219, 'specificity': 0.97130525, 'f1': 0.5831768, 'auroc': 0.8795505}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1012     0    0   40    0    0    35    41    11   12    19
1      0  1321    0   22    0    0     1   140     6    0     9
2      6     1  121   26  218    5    21    68   155   34   360
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    0    0  123    0     2     1     4    0  1503
5      1     0    2  206    0  222     1     0    22  135     3
6      0     0    0    3    0    0  2994     0     1    0    69
7      0     0    0   34    0    0     1  1122     1    0     6
8      0     0    0   55    3    0    10    21  1260    2    19
9      8     1  184  211   10   43     7    93   151  385    44
10     0     0    0    0    3    0     1     1     0    0  1641
better model found
persisted
after epoch: 6,now: 2024-07-08 16:10:31.327301,epoch time: 0:39:58.241612,used: 4:01:21.095467,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95925194, 'precision': 0.8841962, 'recall': 0.87021345, 'specificity': 0.99563086, 'f1': 0.8739257, 'auroc': 0.99814004}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     5    2    0    13     2     1    3     20
1     0  1301    0    10    0    0     0    17     3    0      1
2     0     0  180     0   11    9     2     3     1  106      0
3     0     2    1  8316    0   24     1    61    31    3      0
4     3     0   53     1  350    3     2     2    19   13     93
5     0     0    0    13    0  496     0     0     2    9      1
6     2     0    0     0    0    1  1900     0     1    0      4
7     1    43    1   223    1    0     2  6923    61    1      7
8     1     2    2   215    4    6     3    42  2999    3     16
9     0     0    5     3    0  148     1     0     0  336      0
10    9     0    8     8   59    1    37     9    43    4  12616
---- Validation: 
scalar performance:
{'acc': 0.9582185, 'precision': 0.8810045, 'recall': 0.8693087, 'specificity': 0.99552405, 'f1': 0.872217, 'auroc': 0.9981513}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     1    2    0    22     0     0    4     19
1     0  1296    0     9    0    0     0    22     4    0      1
2     0     0  180     0    8    8     2     3     3  107      1
3     2     4    0  8290    0   22     4    84    32    2      0
4     4     0   58     3  352    4     4     2    14   10     88
5     0     0    0    13    0  497     0     0     3    7      1
6     6     0    0     0    0    0  1895     0     1    2      4
7     0    35    2   224    2    0     1  6938    55    3      5
8     0     1    2   222    5    7     3    41  2990    6     19
9     0     0    6     2    0  145     1     3     0  336      0
10    6     0   10     8   63    1    40     7    43    4  12614
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7420416, 'precision': 0.68205714, 'recall': 0.64228666, 'specificity': 0.9739789, 'f1': 0.6248251, 'auroc': 0.88920873}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1042     0    0   32    2    5    58    16     1    9     5
1      1  1231    2   33    0    1     9   192     9    0    21
2     13     0  214    9  192   37    66    25   117  109   233
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    5    0  152    0    35     1    10    1  1429
5      4     0    0   40    0  471     3     0     1   69     4
6      0     0    0    1    0    0  3065     0     0    0     1
7      1     0    0   60    0    1     2  1094     2    1     3
8      0     0    1  119    0   16    45     8  1176    1     4
9      8     0   67   76    2  285    11    64    72  527    25
10     0     0    0    0    4    0     8     0     0    0  1634
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-08 16:50:24.666390,epoch time: 0:39:53.339089,used: 4:41:14.434556,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96040237, 'precision': 0.91260254, 'recall': 0.8825413, 'specificity': 0.99577916, 'f1': 0.89363986, 'auroc': 0.9985208}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     4    1    0    17     3     2    0     15
1     0  1297    0     6    0    0     1    26     1    0      1
2     2     0  184     2   43    1     0     4     8   65      3
3     0     3    0  8094    0    3     2   123   210    2      0
4     5     0    9     1  379    0     0     3    24    1    117
5     1     0    0    29    0  415     0     1     5   69      1
6     0     0    1     1    2    1  1886     3     3    0     11
7     0    41    0   129    1    0     4  6928   155    0      7
8     0     1    1    43    2    0     0    21  3212    2     14
9     0     0   13     4    2   38     1     0     5  428      2
10   15     0    0     6   48    0    10     6    73    0  12632
---- Validation: 
scalar performance:
{'acc': 0.96046543, 'precision': 0.9119226, 'recall': 0.8830675, 'specificity': 0.9957925, 'f1': 0.89365375, 'auroc': 0.99857575}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     3    1    0    18     2     2    0     12
1     0  1297    0     9    0    0     0    22     2    0      2
2     2     0  182     0   39    1     1     4     7   70      6
3     0     2    0  8096    0    5     5   105   224    3      0
4     6     0    9     1  381    0     0     1    28    1    112
5     0     0    0    24    0  425     1     0     5   65      1
6     3     0    0     3    2    0  1887     1     6    0      6
7     0    35    1   125    2    0     5  6934   154    0      9
8     0     2    2    56    3    1     1    22  3189    0     20
9     1     0   12     5    2   38     2     3     7  421      2
10   14     0    0     7   47    0    13     4    61    0  12650
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73973274, 'precision': 0.6543085, 'recall': 0.6214083, 'specificity': 0.973625, 'f1': 0.6071525, 'auroc': 0.8803201}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   972     1    0  23    1    0    89    53    22    2     7
1     0  1347    0  15    0    0     1    98     8    0    30
2     4     4  121   4  320   11     4    23   202   46   276
3     0     0    0   0    0    0     0     0     0    0     0
4     0     1    0   0  202    0     2     0    11    0  1417
5     6     0    1  73    5  299     3     1    35  160     9
6     0     0    0   1    0    0  3047     0     2    0    17
7     0     1    2   2    0    0     0  1139    16    0     4
8     0     0    0  13    4    0     4    10  1335    3     1
9     6     6  141  43   28   95     4    82   193  475    64
10    0     0    0   0    7    0     2     1     0    0  1636
better model found
persisted
after epoch: 8,now: 2024-07-08 17:30:11.593900,epoch time: 0:39:46.927510,used: 5:21:01.362066,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9533658, 'precision': 0.8845961, 'recall': 0.9067163, 'specificity': 0.9949901, 'f1': 0.89250934, 'auroc': 0.99846894}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    1    0     3     1     1    3      6
1     0  1269    0    23    0    0     0    36     1    0      3
2     0     0  274     3    6    2     0     0     0   27      0
3     1     0    0  8385    0    2     0    26    22    1      0
4     5     0   41     1  448    2     0     1     7    8     26
5     0     0    0    78    0  409     0     0     2   31      1
6    11     0    2     6    1    1  1864     0     3    1     18
7     2    10    9   440    3    0     1  6766    30    1      3
8     0     0    9   217   13    3     0    59  2980    7      8
9     1     0   42     9    0   53     0     0     1  387      0
10   39     0   10     8  266    0    12    11    60    1  12384
---- Validation: 
scalar performance:
{'acc': 0.9521466, 'precision': 0.8835942, 'recall': 0.90332925, 'specificity': 0.99485713, 'f1': 0.89027685, 'auroc': 0.99840903}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    2    0     2     1     0    4      8
1     0  1267    0    20    0    0     0    39     4    0      2
2     0     0  269     1    9    3     0     1     0   29      0
3     0     0    1  8383    0    0     0    33    21    2      0
4     7     0   37     2  451    3     0     2     7    6     24
5     0     0    0    75    1  408     0     0     2   35      0
6     9     0    0     5    3    1  1872     0     6    2     10
7     0     5   10   439    4    0     1  6766    34    0      6
8     2     0    9   245   20    1     1    61  2947    1      9
9     1     0   38    16    0   56     0     0     1  381      0
10   44     0    9     8  265    1     9    15    57    1  12387
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7287483, 'precision': 0.7119374, 'recall': 0.6045192, 'specificity': 0.97346824, 'f1': 0.6337383, 'auroc': 0.88527673}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   938     0    7   90    3    4     8   29     3   83     5
1     0  1085    3   63    2    0     0  309    10    2    25
2     3     0  359   63  261    6     2   75   126   52    68
3     0     0    0    0    0    0     0    0     0    0     0
4     2     0    3    0  907    0     0    2    25    0   694
5     0     0    3  252    2  164     0    0     0  170     1
6     5     0    2   29   14    0  2866    2    26    1   122
7     1     0    1  188    0    0     0  973     0    0     1
8     0     0    5  192    2    1     4   28  1135    3     0
9     2     0  188  326    6   24     0   65    33  481    12
10    0     0    1    0  132    0     1    1     3    0  1508
early stop counter: 1
val acc:0.952146589756012, best validation acc: 0.9604654312133789, corresponding to test acc:                         0.7397327423095703 / 0.7420415878295898
after epoch: 9,now: 2024-07-08 18:10:24.451111,epoch time: 0:40:12.857211,used: 6:01:14.219277,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95976025, 'precision': 0.9073694, 'recall': 0.8710953, 'specificity': 0.99563503, 'f1': 0.8870508, 'auroc': 0.9983039}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     1    0     1    0    0     2     1     0    1     37
1     0  1318    0     2    0    0     0    11     1    0      0
2     0     4  223     1   13    1     1    40     6   19      4
3     0    19    0  8074    0    0     0   233   113    1      0
4     2     2   27     1  361    0     1    15    32    1     97
5     0     1    1    71    0  381     0     2    19   45      1
6    12     3    0     3    1    0  1867     5     1    0     14
7     1    83    0    49    2    0     1  7100    26    0      3
8     0    14    1    43    2    0     0    95  3119    0     21
9     1     2   50    14    3   32     1    21    13  354      2
10    2    11    0     7   75    0     3    29    28    0  12636
---- Validation: 
scalar performance:
{'acc': 0.95768356, 'precision': 0.90537035, 'recall': 0.8678408, 'specificity': 0.9954084, 'f1': 0.8843435, 'auroc': 0.998234}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     1    1     2    0    0     5     1     1    0     36
1     0  1316    0     1    0    0     0    14     1    0      0
2     0     2  219     1   18    2     2    44     7   14      3
3     0    20    0  8045    0    1     0   257   117    0      0
4     2     3   30     1  366    0     0    10    35    2     90
5     0     0    2    69    0  374     0     1    16   57      2
6    11     4    0     2    1    1  1865     4     3    0     17
7     0    70    0    66    1    0     1  7087    35    0      5
8     0    18    1    57    2    0     0    99  3101    0     18
9     1     3   53    10    1   32     1    19    15  356      2
10    1     4    1     6   59    0     4    42    40    1  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.703911, 'precision': 0.6592142, 'recall': 0.567457, 'specificity': 0.97047484, 'f1': 0.5512143, 'auroc': 0.88212794}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   929     4   0   43    0    2    71   112     2    2     5
1     0  1371   0    9    0    0     0   113     1    0     5
2    12    12  70   22  103    5    18   265   227   30   251
3     0     0   0    0    0    0     0     0     0    0     0
4     0     2   1    0  351    0     4     9    18    0  1248
5     5     0   5  279    2  142     4     8    30  114     3
6     1     0   0    2    0    0  3041     3     5    0    15
7     0     1   0    6    0    0     0  1156     0    0     1
8     0     1   0  115    0    0     8    70  1173    0     3
9    11    28  76  228    3   33    12   390   116  214    26
10    0     0   0    0   29    0     2     1     0    0  1614
early stop counter: 2
val acc:0.9576835632324219, best validation acc: 0.9604654312133789, corresponding to test acc:                         0.7397327423095703 / 0.7420415878295898
after epoch: 10,now: 2024-07-08 18:51:51.252800,epoch time: 0:41:26.801689,used: 6:42:41.020966,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.970061, 'precision': 0.92641073, 'recall': 0.8986769, 'specificity': 0.99677074, 'f1': 0.90830046, 'auroc': 0.99895304}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    1    0     4     2     1    1      5
1     0  1284    0     7    0    0     0    38     2    0      1
2     1     0  226     0   25    0     0    11     4   45      0
3     0     0    0  8319    0    1     0    85    32    2      0
4     7     0    8     1  426    0     0     3    33    1     60
5     1     0    1    71    1  336     0     0     8  101      1
6     4     0    0     3    1    0  1883     2     7    0      7
7     0     5    0    91    1    0     1  7147    13    2      3
8     0     1    1    85    2    0     0    99  3091    0     14
9     2     0   21     7    1   11     0     2     2  447      0
10   18     2    4     6   69    0     3    19    45    0  12629
---- Validation: 
scalar performance:
{'acc': 0.96832955, 'precision': 0.9262644, 'recall': 0.8957034, 'specificity': 0.99656546, 'f1': 0.9066813, 'auroc': 0.99895763}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    2    0     2     2     3    0     10
1     0  1283    0     8    0    0     0    40     1    0      0
2     2     0  228     1   21    0     0    12     6   41      1
3     1     0    0  8286    0    3     0   114    36    0      0
4     7     0   11     2  416    0     0     2    32    2     67
5     1     0    0    67    0  338     0     0     8  106      1
6     9     0    0     6    0    0  1879     2     3    0      9
7     3     7    1    97    0    0     1  7137    15    0      4
8     0     1    1    92    3    0     0    99  3086    1     13
9     1     0   17     8    2    8     0     4     7  446      0
10   18     0    3     7   61    0     5    11    52    1  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68991816, 'precision': 0.649724, 'recall': 0.56786263, 'specificity': 0.9690889, 'f1': 0.55440015, 'auroc': 0.88019645}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1074     0    1   12    0    0    17    55     5    5     1
1      1  1096    0   28    1    0     1   347     5    0    20
2     59     0  107   19  169    5    10   129   324   33   160
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    0  332    0     3     3    25    0  1268
5     20     0   14  209    3  138     0     2    20  186     0
6      6     0    0    7    0    0  2823     5    17    0   209
7      0     0    0   10    0    0     0  1153     0    0     1
8      0     0    0  114    0    0     2    60  1190    1     3
9     30     1  105  235    8   25     3   245   127  340    18
10     0     0    0    0   34    0     2     2     0    0  1608
better model found
persisted
after epoch: 11,now: 2024-07-08 19:35:18.736742,epoch time: 0:43:27.483942,used: 7:26:08.504908,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9698737, 'precision': 0.9193747, 'recall': 0.9128665, 'specificity': 0.9967793, 'f1': 0.91255105, 'auroc': 0.9991556}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    1     0    1    0     7     0     1    0     19
1     0  1292    0     4    0    0     0    30     3    0      3
2     0     0  287     0    4    1     0     1     1   18      0
3     0     2    0  8107    1    4     0   147   173    3      1
4     7     0   35     1  391    0     0     3     8    2     91
5     0     0    2    10    0  393     2     0     4  109      1
6     2     0    2     2    1    0  1888     0     3    0     10
7     0     5    6    75    0    0     1  7121    48    0      6
8     0     0    5    19    7    2     0    36  3209    1     17
9     2     0   63     0    2    8     0     2     2  411      3
10    5     0   13     7   36    0     8     7    20    0  12697
---- Validation: 
scalar performance:
{'acc': 0.97060317, 'precision': 0.9220929, 'recall': 0.9156027, 'specificity': 0.9968598, 'f1': 0.9156841, 'auroc': 0.9991939}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     1    0    0    11     1     1    0     15
1     0  1283    0     6    0    0     0    34     6    0      3
2     0     0  285     1    9    0     0     2     2   13      0
3     0     0    0  8124    1    8     0   131   173    3      0
4     5     0   40     1  384    0     0     2    10    1     96
5     0     0    2     8    0  405     0     0     2  103      1
6     5     0    0     0    1    0  1879     3     5    1     14
7     0     4    6    70    1    0     2  7126    50    0      6
8     0     0    7    18    9    3     0    29  3218    0     12
9     2     0   53     1    1    4     0     0     3  428      1
10    3     0    9     6   35    0     7     8    27    1  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74190164, 'precision': 0.6746969, 'recall': 0.62681425, 'specificity': 0.97401685, 'f1': 0.6200894, 'auroc': 0.88374245}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   949     0    6  25    1    1    38    91    20   17    22
1     3  1174    3  20    1    0    10   214    19    3    52
2     4     0  409   1  193    5     0    52   175   56   120
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   12   0  213    0     2     2    21    0  1383
5     2     0   12  53    1  232     0     2    17  269     4
6     1     0    1   1    2    0  3015     1     2    0    44
7     0     0    2  26    0    0     0  1129     4    0     3
8     1     0    0  23    1    2     1    27  1312    2     1
9     4     0  266  42    3   51     1   102   118  536    14
10    0     0    0   0    9    0     2     0     0    0  1635
better model found
persisted
after epoch: 12,now: 2024-07-08 20:15:40.665210,epoch time: 0:40:21.928468,used: 8:06:30.433376,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97174656, 'precision': 0.9197516, 'recall': 0.9147409, 'specificity': 0.99702823, 'f1': 0.9104185, 'auroc': 0.9991906}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    1    0     5     0     0    4      7
1     0  1314    0     3    0    0     0    12     1    0      2
2     1     0  174     0   23    1     1     0     1  110      1
3     2     3    0  8321    1    2     7    49    44    6      1
4     5     0    6     1  475    0     0     0     7    8     37
5     0     0    0    24    0  442     1     0     4   49      1
6     2     0    0     1    0    0  1898     1     2    1      3
7     1    15    5   146    3    0     4  7021    49   12      8
8     1     2    0    64   10    0     4    23  3142    8     41
9     0     0    0     1    0   30     0     0     0  461      0
10   17     0    1     7  135    0     9     3    10    6  12606
---- Validation: 
scalar performance:
{'acc': 0.9736793, 'precision': 0.92509604, 'recall': 0.91789806, 'specificity': 0.9972326, 'f1': 0.9151077, 'auroc': 0.9992265}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    1    0    10     1     0    2      6
1     0  1313    0     7    0    0     0    11     1    0      0
2     0     0  172     0   25    1     2     0     1  110      1
3     1     3    0  8341    0    5     7    46    32    4      1
4     4     0    6     0  489    2     0     0     6    6     26
5     0     0    0    21    0  454     0     0     4   41      1
6     1     0    0     0    0    0  1901     0     3    0      3
7     1    19    2   141    3    0     3  7021    55   13      7
8     0     0    0    71    6    1     1    19  3155    4     39
9     1     0    1     1    0   30     3     0     0  457      0
10   14     0    3     6  112    0     8     3    10    5  12635
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7561743, 'precision': 0.7037644, 'recall': 0.635048, 'specificity': 0.9754783, 'f1': 0.63505024, 'auroc': 0.886938}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1041     0    0   15    0    3    80    10     0   18     3
1      4  1246    0   31    2    0     2   177     4    9    24
2     27     1  121   13  396   10    24    29   118  147   129
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    1    0  479    0     4     1     7    0  1138
5      4     0    0   94    1  265     5     1     1  220     1
6      0     0    0    0    1    0  3049     1     1    1    14
7      1     0    0  115    0    0     3  1035     1    7     2
8      0     0    0   77    3    3    20    31  1221    9     6
9     16     1   36   90   18   75    11    52    78  741    19
10     0     0    0    0   32    0     3     1     0    0  1610
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-08 20:55:25.680214,epoch time: 0:39:45.015004,used: 8:46:15.448380,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9676263, 'precision': 0.9211064, 'recall': 0.9096681, 'specificity': 0.996412, 'f1': 0.914823, 'auroc': 0.99904495}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     5    1    0     0     3     0    2     10
1     0  1246    0     6    0    0     1    71     5    0      3
2     1     0  258     2    9    0     0     9     1   30      2
3     0     0    0  8180    0    4     0   172    80    0      0
4     5     0   42     1  397    0     1     2     4    5     82
5     0     0    2    18    0  443     0     0     4   53      1
6    19     0    1     5    2    0  1835     5     4    2     35
7     0     1    0    82    1    0     1  7146    25    0      7
8     1     0    1    44   19    0     0    71  3082    0     78
9     0     0   23     3    0   33     0     6     5  423      0
10   14     0    0     7   62    0     1     9     5    1  12694
---- Validation: 
scalar performance:
{'acc': 0.96776783, 'precision': 0.92206806, 'recall': 0.9078107, 'specificity': 0.9964318, 'f1': 0.9140043, 'auroc': 0.99911606}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     8    0    0     2     2     0    2      7
1     1  1243    0     8    0    0     0    74     2    0      4
2     0     0  254     1    6    1     0     6     1   41      2
3     0     0    0  8176    0    5     0   179    80    0      0
4     6     0   49     1  392    1     0     2     2    3     83
5     0     0    4    28    0  436     0     0     5   47      1
6    19     0    0     4    1    1  1840     4     3    0     36
7     1     2    0    78    1    0     4  7145    25    0      9
8     0     1    3    45   17    0     1    80  3091    0     58
9     0     0   21     2    0   30     0     6     5  429      0
10   10     0    3    10   45    0     1    10     4    1  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6815224, 'precision': 0.67064166, 'recall': 0.5901068, 'specificity': 0.9681624, 'f1': 0.5849048, 'auroc': 0.88153046}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   966    0    0  101    1    6     2    69     5   16     4
1     2  810    0   19    1    0     2   584     7    1    73
2     9    0  176   18  240   13     0   141   107  118   193
3     0    0    0    0    0    0     0     0     0    0     0
4     4    0    2    0  388    0     1     3     6    0  1229
5     2    0    2  106    1  339     0     0     8  133     1
6    13    0    1   22    3    0  2568     6     3    0   451
7     0    0    0   23    0    0     0  1137     0    1     3
8     1    0    0   69    8    4     1    50  1226    1    10
9     4    0   75  101    8  131     0   179   106  507    26
10    0    0    0    0   21    0     0     1     0    0  1624
early stop counter: 1
val acc:0.9677678346633911, best validation acc: 0.9736793041229248, corresponding to test acc:                         0.7561743259429932 / 0.7561743259429932
after epoch: 14,now: 2024-07-08 21:35:44.638719,epoch time: 0:40:18.958505,used: 9:26:34.406885,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9724422, 'precision': 0.9329869, 'recall': 0.9257539, 'specificity': 0.9970347, 'f1': 0.9268469, 'auroc': 0.99934876}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    1     2    2    1     2     1     0    1      2
1     0  1267    0     7    0    0     0    56     1    0      1
2     1     0  269     0    3    5     0     9     2   23      0
3     0     0    0  8213    0   30     0   150    43    1      1
4     6     0   18     0  422    2     0     0    16    2     73
5     0     0    0     1    0  514     0     0     1    4      1
6    21     0    0     5    0    1  1848    22     6    0      4
7     0     1    0    82    1    0     1  7140    32    0      5
8     1     0    1    66    1    6     1    38  3177    0      5
9     0     0   34     1    0   82     1     6     1  368      0
10   17     0    3     8   25    2    10    12    59    0  12658
---- Validation: 
scalar performance:
{'acc': 0.9721011, 'precision': 0.9298731, 'recall': 0.9244609, 'specificity': 0.9970003, 'f1': 0.92469287, 'auroc': 0.99929285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     3    2    0     2     5     0    0      8
1     0  1267    0     6    0    0     0    58     1    0      0
2     1     0  271     1    8    3     0     4     0   24      0
3     0     1    0  8202    0   41     0   154    40    2      0
4     5     0   16     0  430    3     0     0    16    1     68
5     0     0    2     2    0  506     0     0     1    9      1
6    12     0    1     3    1    3  1865    14     3    0      6
7     3     0    2   106    1    0     1  7116    31    0      5
8     0     0    1    58    1    5     1    29  3193    1      7
9     0     0   35     1    0   89     0     3     3  362      0
10   19     0    5     6   19    2     6    12    60    0  12667
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70377105, 'precision': 0.6362736, 'recall': 0.6007335, 'specificity': 0.9702915, 'f1': 0.56445754, 'auroc': 0.8804578}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   920    0    0  47    0   12    20   138    15   13     5
1     0  968    0  17    0    0     1   454    12    0    47
2    24    0  112  14  182   73    54    61   254   49   192
3     0    0    0   0    0    0     0     0     0    0     0
4     3    0    0   0  171    0    12     3    28    0  1416
5     3    0    1  52    1  458     1     1     3   72     0
6     1    0    0   6    0    0  3049     2     0    0     9
7     0    0    0  12    0    0     1  1146     3    0     2
8     0    0    0  34    1   11     3    22  1294    3     2
9    15    1   73  79    3  340     7   127   157  312    23
10    0    0    0   0   12    0     4     1     0    0  1629
early stop counter: 2
val acc:0.972101092338562, best validation acc: 0.9736793041229248, corresponding to test acc:                         0.7561743259429932 / 0.7561743259429932
after epoch: 15,now: 2024-07-08 22:15:43.882464,epoch time: 0:39:59.243745,used: 10:06:33.650630,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97712433, 'precision': 0.9404578, 'recall': 0.935613, 'specificity': 0.9975158, 'f1': 0.9360431, 'auroc': 0.9995135}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     1   20    1     0     1     1    7     15
1     0  1297    0     9    0    0     0    23     0    0      3
2     0     0  234     0   20    2     0     0     0   55      1
3     0     0    0  8367    1   18     0    39    13    1      0
4     0     0    7     0  489    0     0     0     2    2     39
5     0     0    0     6    0  496     0     0     0   18      1
6     5     0    0     7    4    1  1871     3     2    1     13
7     0     6    1   138    2    0     1  7087    17    6      6
8     0     0    1   113   14    4     0    30  3110    5     19
9     0     0    4     0    2   33     0     0     0  454      0
10    3     0    1     5   75    1     4     8    12    2  12679
---- Validation: 
scalar performance:
{'acc': 0.9779056, 'precision': 0.9388054, 'recall': 0.9371707, 'specificity': 0.99760824, 'f1': 0.93676937, 'auroc': 0.9995216}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     5   15    1     0     1     1    6     19
1     0  1307    0     4    0    0     0    20     0    0      1
2     0     0  243     0   13    0     0     0     0   55      1
3     0     0    1  8364    0   12     0    45    14    4      0
4     0     0    9     0  492    1     0     2     3    1     31
5     0     0    0     3    0  492     0     0     0   25      1
6    10     0    0     6    7    0  1872     2     1    1      9
7     0     7    0   131    2    0     1  7100    15    5      4
8     1     0    4   111   15    3     0    30  3106    5     21
9     0     0    9     0    0   35     0     1     0  447      1
10    1     0    2     5   67    1     3     5    10    1  12701
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7325264, 'precision': 0.6725304, 'recall': 0.621274, 'specificity': 0.9732826, 'f1': 0.6262507, 'auroc': 0.8789632}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   771     0    7  104   47   28    19    87     4   91    12
1     2  1223    1   37    2    0     3   167     9    7    48
2     2     0  220   13  443   16     4    25    58   92   142
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    1    0  353    0     5     2     4    0  1267
5     0     0    3   62    5  370     0     0     1  151     0
6     1     0    0    3    2    0  3045     0     1    0    15
7     0     0    4  103    0    1     1  1048     1    3     3
8     0     0    4  110   27   10     3    20  1184    6     6
9     2     0  145   73   27  147     1    32    50  637    23
10    0     0    0    0   24    0     2     1     0    0  1619
better model found
persisted
after epoch: 16,now: 2024-07-08 22:55:27.480436,epoch time: 0:39:43.597972,used: 10:46:17.248602,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9785424, 'precision': 0.938926, 'recall': 0.9362685, 'specificity': 0.9976966, 'f1': 0.9347154, 'auroc': 0.9995778}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    0    0     6     0     0    6      7
1     0  1319    0     2    0    0     0    10     0    0      1
2     0     0  288     0    2    0     1     0     1   19      0
3     2     2    0  8308    0   10     0    57    54    2      0
4     5     0   32     0  428    0     2     1     2    3     66
5     0     0    1     3    0  402     0     0     1  113      1
6     4     0    0     5    0    0  1894     1     1    1      2
7     0    13    4   109    0    0     1  7107    23    1      7
8     0     0    3    49    7    2     3    25  3180    5     21
9     0     0   26     1    0    2     0     0     0  464      0
10    6     1    5     5   19    0    13     9    15    1  12720
---- Validation: 
scalar performance:
{'acc': 0.9777986, 'precision': 0.9378327, 'recall': 0.93529254, 'specificity': 0.99762857, 'f1': 0.93317187, 'auroc': 0.9995437}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    0    0     3     1     0    1      9
1     0  1314    0     3    0    0     0    10     5    0      0
2     0     0  291     1    1    0     0     0     1   18      0
3     0     7    0  8307    0    8     1    60    53    4      0
4     4     0   30     0  443    0     2     0     0    6     54
5     0     0    3     4    0  381     0     0     1  131      1
6     5     0    0     6    0    0  1890     3     2    0      2
7     0    13    4   129    0    0     1  7088    27    0      3
8     0     0    3    45   10    0     3    28  3187    1     19
9     0     0   29     0    0    2     0     0     1  461      0
10    6     0    3     7   20    0    14    10    10    1  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7092283, 'precision': 0.66198856, 'recall': 0.580908, 'specificity': 0.9709545, 'f1': 0.584839, 'auroc': 0.8804292}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   928     1    7   90    1    1    46   24     7   60     5
1     0  1205    1   31    0    1     4  220     6    3    28
2    13     0  299   11  200    3    29   43   144   81   192
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  180    0    11    2    11    0  1427
5     1     0   18   65    2  137     4    0     4  360     1
6     1     0    0    2    0    0  3057    2     0    0     5
7     0     0    4  319    0    1     1  832     2    3     2
8     0     0    2   64    1    0    18   13  1259    6     7
9     4     1  253   78    6   26     5   35    94  608    27
10    0     0    0    0    6    0     7    1     0    0  1632
early stop counter: 1
val acc:0.977798581123352, best validation acc: 0.9779055714607239, corresponding to test acc:                         0.732526421546936 / 0.7561743259429932
after epoch: 17,now: 2024-07-08 23:35:14.394311,epoch time: 0:39:46.913875,used: 11:26:04.162477,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97562605, 'precision': 0.94014466, 'recall': 0.93994296, 'specificity': 0.9973814, 'f1': 0.9383724, 'auroc': 0.9994976}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    2     0    2    0     0     4     0    3      6
1     0  1304    0     1    0    0     0    26     0    0      1
2     1     0  293     0    1    0     0     0     2   15      0
3     1     1    0  8083    0    6     0   251    87    1      5
4     4     0   28     0  418    2     1     1    17    6     62
5     1     0    2     6    0  458     0     0     3   50      1
6     6     0    5     2    0    0  1873     3     4    4     10
7     0     2    2    30    2    0     1  7188    34    0      6
8     1     2    4     8    5    0     1    29  3237    0      7
9     0     0   30     1    0   15     0     1     4  442      0
10    6     0   14     3   22    0     1    10    36    0  12703
---- Validation: 
scalar performance:
{'acc': 0.97488296, 'precision': 0.9422195, 'recall': 0.9430028, 'specificity': 0.99729633, 'f1': 0.94157594, 'auroc': 0.99956703}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    5    0     2     0     0    2      9
1     0  1303    0     1    0    0     0    28     0    0      0
2     0     0  291     0    0    0     0     0     3   18      0
3     1     1    0  8056    0    0     0   275   101    1      5
4     1     0   28     0  440    0     0     0    14    4     52
5     0     0    1     3    0  464     0     0     5   47      1
6     6     0    4     2    1    0  1872     2     4    2     15
7     2     5    4    32    0    0     0  7191    25    1      5
8     0     2    1    20    3    2     0    32  3224    3      9
9     0     0   25     0    1   21     0     0     3  443      0
10   12     0    8     4   23    0     2     2    47    0  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72601974, 'precision': 0.65887547, 'recall': 0.6111884, 'specificity': 0.9723998, 'f1': 0.5974624, 'auroc': 0.87719935}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   906     0   11  26    2   18    41    80    23   36    27
1     0  1177    1   9    0    0     0   288     5    1    18
2     3     0  297   2  116   12     6    54   285   71   169
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    9   0  189    0     3     2    26    0  1403
5     0     0   21  59    1  254     2     6    32  215     2
6     3     0    0   0    0    0  2988     3     4    1    68
7     0     0    1   1    0    0     1  1158     2    0     1
8     0     0    0  14    0    2     1    41  1308    2     2
9     1     1  222  32    6   60     2   123   198  465    27
10    0     0    0   0   10    0     0     1     0    0  1635
early stop counter: 2
val acc:0.974882960319519, best validation acc: 0.9779055714607239, corresponding to test acc:                         0.732526421546936 / 0.7561743259429932
after epoch: 18,now: 2024-07-09 00:15:00.001926,epoch time: 0:39:45.607615,used: 12:05:49.770092,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9831175, 'precision': 0.95813787, 'recall': 0.94455457, 'specificity': 0.9981352, 'f1': 0.9500456, 'auroc': 0.99974746}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     3    3    0     4     0     1    0     13
1     0  1319    0     0    0    0     0    13     0    0      0
2     0     0  276     0   15    3     0     1     2   14      1
3     0     2    0  8321    0   15     1    54    43    0      0
4     4     0    2     0  466    0     0     0     5    2     60
5     0     0    0     4    0  510     0     0     2    4      0
6     2     0    0     1    1    0  1888     1     0    0     14
7     0    11    1    57    1    0     1  7163    23    0      8
8     0     2    1    26    4    1     1    28  3192    0     40
9     1     1   19     1    1   77     0     1     2  390      0
10    2     1    1     5   13    0     3     7     1    0  12761
---- Validation: 
scalar performance:
{'acc': 0.984245, 'precision': 0.9608963, 'recall': 0.9491176, 'specificity': 0.9982442, 'f1': 0.9543263, 'auroc': 0.9997368}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    2    0     2     0     0    0     12
1     0  1320    0     0    0    0     0    12     0    0      0
2     1     0  269     1   18    2     1     0     2   17      1
3     1     2    0  8342    0    7     1    46    41    0      0
4     3     0    7     0  469    0     0     1     2    0     57
5     0     0    1     1    0  512     0     1     0    6      0
6     0     1    0     0    2    1  1892     0     3    0      9
7     0     7    1    68    0    0     0  7161    18    0     10
8     0     2    1    30    5    1     1    26  3185    0     45
9     0     0   17     2    2   56     0     0     2  413      1
10    1     0    2     5   11    2     2     4     3    0  12766
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6854404, 'precision': 0.63715863, 'recall': 0.567658, 'specificity': 0.96852803, 'f1': 0.56243014, 'auroc': 0.8731428}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   918     0   0   39    6    4    82    70     6    7    38
1     0  1275   1   26    0    0     0   180     1    0    16
2     7     0  88   31  321   14     3   105   161   42   243
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  255    0     2     3     7    0  1366
5    10     0   3  160    8  227     9     4    34  135     2
6     2     1   0   24    3    0  2804     4     3    0   226
7     0     0   0  149    0    0     2  1010     2    0     1
8     0     0   0   69    5    1     4    30  1247    2    12
9    10     1  80  211   29  105    10   153   154  338    46
10    0     0   0    0   10    0     0     1     0    0  1635
better model found
persisted
after epoch: 19,now: 2024-07-09 00:54:53.241252,epoch time: 0:39:53.239326,used: 12:45:43.009418,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9815925, 'precision': 0.9549715, 'recall': 0.9489104, 'specificity': 0.9980286, 'f1': 0.9514648, 'auroc': 0.99964905}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     2    1    0     2     0     0    1      3
1     0  1324    0     2    0    0     2     3     1    0      0
2     0     0  270     0   11    0     0     1     1   29      0
3     6     7    0  8282    0    3     8    73    56    1      1
4     4     0   13     0  443    0     0     0     8    1     70
5     0     0    0    14    0  489     0     0     5   13      0
6     9     0    0     0    0    0  1888     0     1    1      9
7     2    45    2    43    0    0     7  7078    81    0      5
8     0     0    0    20    1    0     1     7  3252    0     15
9     0     0   14     2    1   21     1     1     5  447      0
10    8     3    1     5   16    0     1     4    13    1  12741
---- Validation: 
scalar performance:
{'acc': 0.98178416, 'precision': 0.9567769, 'recall': 0.9503533, 'specificity': 0.9980491, 'f1': 0.95310926, 'auroc': 0.9996965}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    2    0     1     1     0    1      2
1     1  1326    0     0    0    0     0     4     1    0      0
2     0     0  268     0    9    0     0     0     3   31      1
3     8     6    0  8276    0    3     8    74    63    1      1
4     7     0    6     0  465    0     1     1     5    2     52
5     1     0    2    20    0  470     0     0     5   23      0
6     2     0    0     1    0    0  1896     0     0    0      9
7     2    43    0    51    1    0     6  7078    74    1      9
8     0     0    1    16    0    1     1     4  3248    1     24
9     0     0   11     1    1   19     0     0     7  453      1
10    4     3    1     4   17    0     1     3    15    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7103477, 'precision': 0.6370189, 'recall': 0.5904572, 'specificity': 0.9708468, 'f1': 0.5747852, 'auroc': 0.8725671}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1007     1    4   20    6    0    39    60     3    6    24
1      0  1387    0   19    0    0     0    69    14    1     9
2     14    14  143    8  222    3     5    42   290   41   233
3      0     0    0    0    0    0     0     0     0    0     0
4      0     9    0    0  235    0     3     1    20    0  1365
5     15     0   36  107    7  191     5     6    51  169     5
6      6     1    0   29    1    0  2822     4    11    0   193
7      0     7    0   14    0    0     1  1134     7    0     1
8      0     0    0   50    1    2     4    26  1286    0     1
9     25    13  182   96   13   55     8   108   299  313    25
10     0     1    0    0    9    0     0     1     0    0  1635
early stop counter: 1
val acc:0.9817841649055481, best validation acc: 0.9842450022697449, corresponding to test acc:                         0.6854404211044312 / 0.7561743259429932
after epoch: 20,now: 2024-07-09 01:34:46.060394,epoch time: 0:39:52.819142,used: 13:25:35.828560,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98226136, 'precision': 0.9604812, 'recall': 0.9401449, 'specificity': 0.99807405, 'f1': 0.9474153, 'auroc': 0.9997342}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    3    0     1     0     0    1     19
1     0  1321    0     3    0    0     0     5     0    0      3
2     0     0  216     0   26    0     0     8     5   57      0
3     0     2    0  8363    0    6     0    28    38    1      0
4     1     0    3     0  476    0     0     0     7    3     49
5     0     0    0     4    0  475     0     0     2   39      1
6     3     0    0     0    0    0  1898     0     1    1      4
7     0    17    0   141    1    0     1  7058    39    0      5
8     0     0    0    24    3    1     0    17  3243    1      7
9     0     0    2     1    0    7     0     0     2  481      0
10    2     0    1     6   18    0     3     4    35    1  12723
---- Validation: 
scalar performance:
{'acc': 0.9810084, 'precision': 0.9588504, 'recall': 0.93860453, 'specificity': 0.9979427, 'f1': 0.94532704, 'auroc': 0.99973464}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     2    4    0     0     0     2    2     17
1     0  1318    0     3    0    0     1     9     1    0      0
2     0     0  208     0   27    0     0    10     1   66      0
3     0     1    0  8361    0    3     0    33    42    0      0
4     2     0    1     0  482    1     0     0     9    1     43
5     0     0    1     3    0  485     0     0     2   29      1
6     1     0    0     1    1    1  1895     0     3    1      5
7     0    17    0   145    0    0     2  7045    51    0      5
8     0     1    0    35    3    1     0    19  3223    0     14
9     0     0    2     1    0    9     0     0     1  480      0
10    1     0    0     5   30    1     4     3    27    3  12722
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7325264, 'precision': 0.65256035, 'recall': 0.6117388, 'specificity': 0.97304034, 'f1': 0.5994392, 'auroc': 0.88052744}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   977     0    0  36   10    2    42    27     4   43    29
1     0  1296    0  15    1    0     0   145     9    2    31
2     9     1  100   2  373    8     5    82   229   82   124
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  257    0     3     2    22    0  1349
5     1     0    9  29   11  242     1     2    16  281     0
6     2     0    0   5    0    0  2999     3     5    1    52
7     0     0    0  71    0    0     1  1086     4    1     1
8     0     0    0  37    0    4     7    25  1288    9     0
9     7     4   81  55   29   60     3   135   141  596    26
10    0     0    0   0   13    0     4     0     0    0  1629
early stop counter: 2
val acc:0.9810084104537964, best validation acc: 0.9842450022697449, corresponding to test acc:                         0.6854404211044312 / 0.7561743259429932
after epoch: 21,now: 2024-07-09 02:14:27.814473,epoch time: 0:39:41.754079,used: 14:05:17.582639,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98293024, 'precision': 0.95836294, 'recall': 0.95748794, 'specificity': 0.9981229, 'f1': 0.9573951, 'auroc': 0.9997516}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    1     1    2    0     3     2     0    0     10
1     0  1324    0     2    0    0     0     5     1    0      0
2     0     0  297     1    3    0     0     0     0   11      0
3     0     2    0  8291    0    6     0   121    14    2      0
4     6     0   18     0  466    0     4     0     1    2     42
5     0     0    0     6    0  474     0     0     0   41      0
6     1     0    0     0    0    0  1903     1     0    0      3
7     0    15    0    26    0    0     1  7216     2    1      2
8     0     3    1    54    8    1     3    91  3101    2     32
9     0     0   23     0    0    6     0     0     0  464      0
10    4     1    3     4   27    0     9     5     1    1  12738
---- Validation: 
scalar performance:
{'acc': 0.98333555, 'precision': 0.95869756, 'recall': 0.95962465, 'specificity': 0.99817467, 'f1': 0.9585712, 'auroc': 0.99977887}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     1    1    0     2     4     0    1     13
1     0  1322    0     2    0    0     0     7     1    0      0
2     1     0  302     0    0    0     0     1     0    8      0
3     0     2    0  8301    0    3     0   120    13    1      0
4     6     0   16     0  477    0     2     1     0    1     36
5     0     0    0     3    1  470     0     0     1   46      0
6     2     0    0     2    0    0  1901     1     0    0      2
7     0    27    0    26    3    0     1  7199     3    0      6
8     1     0    1    48   13    2     5    72  3117    5     32
9     0     0   23     1    0    5     0     0     0  464      0
10    2     3    5     3   20    0    13     1     1    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74833834, 'precision': 0.67960715, 'recall': 0.6227875, 'specificity': 0.9745705, 'f1': 0.61988866, 'auroc': 0.88368434}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   941     1   19  19    3    3    52    58     4   48    22
1     0  1299    1  13    0    0     1   174     2    1     8
2     4     3  300   4  281    5    22    91    51   94   160
3     0     0    0   0    0    0     0     0     0    0     0
4     0     2    0   0  335    0    24     0     3    0  1269
5     1     0   29  30    5  166     2     3     4  348     4
6     1     0    0   4    0    0  3055     0     0    1     6
7     0     0    0  21    0    0     1  1141     0    0     1
8     0     0    7  43   14    3    22    66  1202    7     6
9     2     6  209  32    6   24     1   135    57  639    26
10    0     0    0   0   18    0    10     0     0    0  1618
early stop counter: 3
val acc:0.983335554599762, best validation acc: 0.9842450022697449, corresponding to test acc:                         0.6854404211044312 / 0.7561743259429932
after epoch: 22,now: 2024-07-09 02:54:15.391561,epoch time: 0:39:47.577088,used: 14:45:05.159727,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9825289, 'precision': 0.95855814, 'recall': 0.9451982, 'specificity': 0.9981248, 'f1': 0.95106053, 'auroc': 0.9996635}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     2    2    1     4     0     1    3      9
1     0  1309    0     2    0    0     0    21     0    0      0
2     0     0  253     1   23    0     0     8     4   21      2
3     0     3    0  8319    0    1     1    54    58    0      0
4     0     0    2     0  486    0     1     2    12    3     33
5     0     0    0    19    0  490     0     0     4    8      0
6     1     0    0     0    0    0  1894     1     3    0      8
7     0     1    0    84    1    0     0  7138    34    0      6
8     1     0    0    28    3    0     2    12  3243    0      7
9     0     0    9     7    0   40     0     2     7  428      0
10    1     0    0     3   68    0     2     5    11    1  12702
---- Validation: 
scalar performance:
{'acc': 0.9819446, 'precision': 0.9573146, 'recall': 0.94458354, 'specificity': 0.9980668, 'f1': 0.9500389, 'auroc': 0.9996597}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    1     1    0    1     6     0     1    2     17
1     0  1311    0     3    0    0     1    16     1    0      0
2     0     0  253     2   16    0     0    10     3   24      4
3     0     0    0  8312    0    0     2    61    63    1      1
4     2     0    3     0  498    0     0     1     9    1     25
5     0     0    0    30    0  481     0     0     2    8      0
6     3     0    0     2    0    1  1895     1     2    0      4
7     0     2    0    87    3    0     1  7129    38    0      5
8     0     0    0    16    2    0     3     8  3260    0      7
9     0     0    7     4    0   43     0     3     8  428      0
10    1     0    0     7   76    0     2     6    15    0  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6907577, 'precision': 0.6399357, 'recall': 0.57433295, 'specificity': 0.96888983, 'f1': 0.5671145, 'auroc': 0.8715715}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   770     0   10   52    2   16   111   103    44   37    25
1     0  1192    0   16    2    0     1   261     7    0    20
2     8     1  122   11  187    6     7   105   231   53   284
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  385    0     1     3    14    0  1230
5     1     0   22   84    5  252     2     4    34  186     2
6     3     0    0   17    0    0  2821     3     7    0   216
7     0     0    0   35    0    0     2  1123     2    0     2
8     0     0    0   48    0    2     5    37  1267    0    11
9     3     0  120  131    4   72     7   198   224  346    32
10    0     0    0    0   45    0     4     1     1    0  1595
early stop counter: 4
val acc:0.9819446206092834, best validation acc: 0.9842450022697449, corresponding to test acc:                         0.6854404211044312 / 0.7561743259429932
after epoch: 23,now: 2024-07-09 03:34:09.977885,epoch time: 0:39:54.586324,used: 15:24:59.746051,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9815122, 'precision': 0.9484232, 'recall': 0.9590844, 'specificity': 0.9980516, 'f1': 0.9524483, 'auroc': 0.9997203}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    3    0    17     1     0    0      2
1     0  1315    0     0    0    0     0    15     1    0      1
2     0     0  266     0    9    0     0     0     0   36      1
3     1     3    0  8394    0    5     1    25     8    0      0
4     7     0   10     1  501    0     1     1     2    1     15
5     0     0    0     9    0  497     0     0     1   14      0
6     1     0    0     1    2    0  1900     0     0    2      2
7     1     3    0   120    1    0     1  7121    13    0      3
8     0     0    1    96    9    3     2    27  3152    0      6
9     0     0    3     1    0   15     0     0     0  474      0
10   10     0    1     3  149    0     8     5    11    0  12605
---- Validation: 
scalar performance:
{'acc': 0.9813027, 'precision': 0.9487406, 'recall': 0.9637408, 'specificity': 0.9980292, 'f1': 0.9547969, 'auroc': 0.99973977}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0    2    0    19     1     0    2      2
1     0  1323    0     0    0    0     0     9     0    0      0
2     0     0  279     0    5    0     0     1     0   26      1
3     1     0    0  8396    0    4     2    29     7    0      1
4     2     0   12     0  514    0     1     0     0    0     10
5     0     0    1     6    1  499     1     0     0   13      0
6     1     0    0     0    1    0  1901     1     0    0      4
7     1     3    0   120    2    0     2  7125     9    0      3
8     1     0    1   110    7    0     2    30  3135    3      7
9     1     0    5     1    0   18     0     0     0  468      0
10    9     0    0     4  168    0    10     3    12    1  12589
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69166726, 'precision': 0.633564, 'recall': 0.5599863, 'specificity': 0.96852565, 'f1': 0.561537, 'auroc': 0.8757778}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   510     0    5  22    6    1   506    61    11   22    26
1     1  1160    1  20    1    1     2   256    10    1    46
2     1     0  203  10  332    6    15    72   190   37   149
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    1   0  489    0    10     1    18    0  1113
5     2     0   61  92    7  190    26     6    17  190     1
6     0     0    0   7    1    0  3027     4     0    0    28
7     0     0    0  87    0    0     2  1073     0    1     1
8     0     0    0  49    1    2     7    35  1273    2     1
9     1     2  237  90   18   88    29   126   148  369    29
10    0     0    0   0   44    0     8     1     1    0  1592
early stop counter: 5
val acc:0.9813026785850525, best validation acc: 0.9842450022697449, corresponding to test acc:                         0.6854404211044312 / 0.7561743259429932
after epoch: 24,now: 2024-07-09 04:13:47.033965,epoch time: 0:39:37.056080,used: 16:04:36.802131,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9862746, 'precision': 0.96296674, 'recall': 0.95460063, 'specificity': 0.99853885, 'f1': 0.9572165, 'auroc': 0.9998014}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    1    0     1     1     1    0      2
1     0  1319    0     0    0    0     0    11     1    0      0
2     0     0  241     0   10    1     0     0     3   56      1
3     5     1    0  8361    0    2     1    41    28    0      0
4     5     0    2     0  477    0     0     1     8    2     44
5     1     0    0     3    0  509     0     0     0    8      0
6    24     0    0     1    0    1  1877     1     1    0      3
7     3     4    0    58    0    0     0  7150    44    0      5
8     2     0    1    13    0    0     3     5  3257    0     14
9     0     0    0     1    0   23     0     1     2  466      0
10    9     0    1     1   15    1    15     5    14    1  12729
---- Validation: 
scalar performance:
{'acc': 0.9865187, 'precision': 0.9613381, 'recall': 0.9542243, 'specificity': 0.9985782, 'f1': 0.95629096, 'auroc': 0.9998165}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     2     0     0    0      0
1     0  1319    0     0    0    0     0    12     1    0      0
2     1     0  244     1    9    3     0     0     3   50      1
3     5     1    0  8357    0    7     0    46    24    0      0
4     5     0    1     0  483    0     0     0     9    1     40
5     0     0    0     4    0  508     0     0     0    9      0
6    34     1    0     0    1    0  1867     1     1    1      2
7     0     6    0    52    0    0     2  7156    44    1      4
8     1     0    0    14    1    0     1     5  3264    0     10
9     1     0    1     4    1   32     0     0     1  453      0
10    7     0    1     1   12    0    15     4     6    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69859374, 'precision': 0.6243613, 'recall': 0.5879953, 'specificity': 0.96968085, 'f1': 0.5630065, 'auroc': 0.87118167}
confusion matrix:
      0    1    2   3    4    5     6     7     8    9     10
0   1004    0    2   5    1    1     9   111     6   18    13
1      4  950    0  27    1    0     5   432    10    2    68
2     17    0  127   7  192   15    14    69   294   71   209
3      0    0    0   0    0    0     0     0     0    0     0
4      0    0    2   0  107    0    10     2    25    1  1486
5     10    0    3  53    2  308     2     4    14  193     3
6     10    0    0   6    0    0  3009     3     1    0    38
7      3    0    0  24    0    1     2  1125     7    2     0
8      6    0    0  43    0    5    14    34  1262    2     4
9     22    0   72  69   21  148     2   121   197  459    26
10     0    0    0   0    4    0     6     1     0    1  1634
better model found
persisted
after epoch: 25,now: 2024-07-09 04:53:20.476946,epoch time: 0:39:33.442981,used: 16:44:10.245112,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98935145, 'precision': 0.9767861, 'recall': 0.972296, 'specificity': 0.99882144, 'f1': 0.97441727, 'auroc': 0.9998958}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    2    0     2     0     0    0      7
1     0  1319    0     7    0    0     0     6     0    0      0
2     0     0  301     0    2    0     0     0     0    9      0
3     3     0    0  8378    0    2     0    45    10    0      0
4     4     0   10     0  490    0     2     0     7    0     26
5     2     0    0     7    0  499     0     0     1   12      0
6     1     0    0     2    0    0  1902     0     0    0      3
7     1     3    0    55    0    0     3  7192     6    0      2
8     1     0    0    55    1    1     8    25  3194    1     10
9     4     0    8     1    0   12     0     0     0  468      0
10    3     2    1     2   11    0     2     2     6    0  12763
---- Validation: 
scalar performance:
{'acc': 0.9895145, 'precision': 0.97587174, 'recall': 0.9697856, 'specificity': 0.9988433, 'f1': 0.9727554, 'auroc': 0.9998922}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    3    0     2     0     0    0      3
1     0  1318    0     6    0    0     1     7     0    0      0
2     0     0  290     1    1    1     0     3     1   15      0
3     1     0    0  8384    0    1     2    44     8    0      0
4     4     0    8     0  492    0     1     2     5    0     27
5     0     0    0     3    0  500     0     0     1   17      0
6     1     0    0     2    0    0  1901     1     0    0      3
7     1     3    0    54    1    0     3  7194     7    0      2
8     0     0    0    50    0    0     5    30  3202    0      9
9     0     0    8     1    1   17     0     0     0  465      1
10    1     0    3     2   14    0     1     0     3    0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.690268, 'precision': 0.65298283, 'recall': 0.58038384, 'specificity': 0.96923065, 'f1': 0.5687506, 'auroc': 0.87072307}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1058     0    0   17    0    5    60    4     1   13    12
1      2  1094    3   61    3    0     5  300     6    5    20
2     26     0  119   43  166   34    13   82   218   44   270
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    1    1  264    0     4    1    27    0  1335
5     22     0    5  103    2  401     8    0     5   42     4
6      6     0    0    1    0    0  3033    0     0    0    27
7      4     0    1  195    0    1     4  953     0    5     1
8      7     0    0  223    0    8    32   16  1077    4     3
9     38     1   65  248   12  252    13  119   105  242    42
10     0     0    0    0   15    0     5    1     0    0  1625
better model found
persisted
after epoch: 26,now: 2024-07-09 05:32:57.546944,epoch time: 0:39:37.069998,used: 17:23:47.315110,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9847228, 'precision': 0.9679419, 'recall': 0.9495003, 'specificity': 0.998306, 'f1': 0.95798135, 'auroc': 0.99978197}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     1    5    0    29     1     0    0      3
1     0  1316    0     0    0    0     0    15     0    0      1
2     0     0  275     0   10    1     0     2     4   19      1
3     2     1    0  8393    0    5     1    32     4    0      0
4     2     0    4     0  467    1     0     0     4    2     59
5     0     0    0     8    0  507     1     0     1    3      0
6     0     0    0     1    0    0  1906     0     0    0      0
7     1     3    0   115    0    0     0  7124    14    1      7
8     0     0    0    60    1    2     3    24  3192    0     13
9     0     0    4     3    0   53     0     0     2  431      0
10    8     0    1     2   10    0     6     1    14    0  12750
---- Validation: 
scalar performance:
{'acc': 0.98354954, 'precision': 0.9685029, 'recall': 0.94969296, 'specificity': 0.99816144, 'f1': 0.95839655, 'auroc': 0.9997699}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     1    4    0    27     0     0    0      3
1     0  1315    0     2    0    0     0    14     0    0      1
2     1     0  278     0   11    2     0     2     2   16      0
3     0     1    0  8393    0    2     2    34     7    0      1
4     2     0    4     0  461    1     1     1     6    0     63
5     1     0    0     4    0  507     0     0     0    9      0
6     1     0    0     0    0    0  1903     0     0    0      4
7     2     7    0   134    0    0     0  7097    16    1      8
8     0     0    0    81    4    0     3    25  3171    0     12
9     0     0    2     2    1   51     0     0     1  436      0
10    9     0    1     2    2    0     7     3    10    1  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.649059, 'precision': 0.6086128, 'recall': 0.5331159, 'specificity': 0.9641134, 'f1': 0.5181548, 'auroc': 0.8650187}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   310     0   3   33    8   20   663    53     5   37    38
1     2  1114   0   45    2    0     8   253    17    0    58
2     3     0  83   23  291   21    22    55   233   53   231
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  234    0     4     1    18    0  1376
5     1     0   7   86    3  323    14     2    10  139     7
6     1     0   1    4    2    0  2907     5    10    0   137
7     0     0   1   51    0    1     3  1102     2    0     4
8     0     0   2   92    2    3    17    19  1230    0     5
9     4     1  94  191   35  156    14    87   170  345    40
10    0     0   0    0   13    0     2     1     1    0  1629
early stop counter: 1
val acc:0.9835495352745056, best validation acc: 0.9895145297050476, corresponding to test acc:                         0.6902679800987244 / 0.7561743259429932
after epoch: 27,now: 2024-07-09 06:12:29.210762,epoch time: 0:39:31.663818,used: 18:03:18.978928,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98630136, 'precision': 0.9551388, 'recall': 0.9564929, 'specificity': 0.9985135, 'f1': 0.95341027, 'auroc': 0.9998387}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     1    0     0    4    0     0     1     0    0      4
1     0  1322    0     2    0    0     0     6     0    0      0
2     0     0  311     0    0    0     0     0     0    0      1
3     5     1    0  8380    0   13     4    24     2    5      2
4     6     0   37     1  437    1     1     1     6    1     48
5     1     0    4     1    0  487     0     0     0   28      0
6     4     0    0     0    0    0  1902     0     0    1      1
7     2     3    0    79    0    0     0  7174     3    2      2
8     1     0    2    74    3    1     1    18  3183    1     11
9     2     0   57     0    0    7     0     0     1  426      0
10    4     1    3     0    3    0     5     3     6    0  12769
---- Validation: 
scalar performance:
{'acc': 0.98710716, 'precision': 0.9568168, 'recall': 0.95838207, 'specificity': 0.9986067, 'f1': 0.95534855, 'auroc': 0.99985045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     0    4    0     2     0     1    0      3
1     0  1326    0     1    0    0     0     5     0    0      0
2     0     0  308     0    0    0     0     0     2    1      1
3     2     0    1  8391    0   10     5    22     3    6      0
4     3     0   32     0  459    0     0     0     4    1     40
5     1     0    0     3    0  489     0     0     0   27      1
6     3     0    0     0    1    0  1900     0     1    0      3
7     2     5    1    70    0    0     0  7179     3    0      5
8     1     1    3    63    2    2     2    17  3191    2     12
9     1     0   70     1    0    3     0     0     0  418      0
10    2     1    3     1    3    0     4     4     8    0  12770
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7391031, 'precision': 0.6698257, 'recall': 0.6230691, 'specificity': 0.9737879, 'f1': 0.61791897, 'auroc': 0.87689435}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1049     0   13   8    0    8    13    32     2   32    13
1      1  1199    7  20    1    1     0   225     6    7    32
2      9     0  405   5  136    5     7    35   101   67   245
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    7   0  217    0     4     1    14    0  1390
5      3     1   34  21    2  215     0     2     1  304     9
6      1     0    1   1    0    0  3013     2     0    1    48
7      1     1    6  58    0    0     1  1091     1    1     4
8      1     0    7  69    2   16    15    27  1218    7     8
9      7     1  369  35    3   64     2    44    58  526    28
10     0     0    0   0   12    0     2     1     0    0  1631
early stop counter: 2
val acc:0.9871071577072144, best validation acc: 0.9895145297050476, corresponding to test acc:                         0.6902679800987244 / 0.7561743259429932
after epoch: 28,now: 2024-07-09 06:52:00.606022,epoch time: 0:39:31.395260,used: 18:42:50.374188,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9840807, 'precision': 0.9610102, 'recall': 0.9601831, 'specificity': 0.9982636, 'f1': 0.9598624, 'auroc': 0.99977356}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    1     2    7    0     2     2     0    1      9
1     0  1327    0     1    0    0     0     3     0    0      1
2     0     0  281     0    8    1     1     0     0   20      1
3     1     2    0  8359    0   40     0    24    12    0      2
4     1     0    1     0  494    1     1     0     1    3     37
5     0     0    0     0    0  514     0     0     0    6      1
6     4     1    0     1    0    1  1897     0     0    1      2
7     1    33    2    84    4    0     1  7081    42    1     14
8     3     3    0    75    5    7     1     8  3159    2     31
9     0     0    6     0    0   46     0     0     0  441      0
10    0     2    0     1    5    1     6     3     5    0  12770
---- Validation: 
scalar performance:
{'acc': 0.9844323, 'precision': 0.9617466, 'recall': 0.9617551, 'specificity': 0.99830174, 'f1': 0.96130675, 'auroc': 0.99978197}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     1    6    1     1     2     0    3      8
1     0  1330    0     0    0    0     0     1     0    0      1
2     0     0  285     0   13    1     0     1     0   11      1
3     0     4    1  8372    0   25     0    20    16    0      2
4     1     0    3     1  495    0     0     1     2    1     35
5     0     0    0     2    0  511     0     0     0    7      1
6     3     0    0     1    0    0  1898     2     0    2      2
7     5    29    1   103    3    1     1  7067    40    3     12
8     0     3    0    77    6    6     1     8  3169    5     21
9     0     0    8     1    0   43     0     0     0  441      0
10    1     0    1     0    8    1     6     3     1    1  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7249703, 'precision': 0.65297943, 'recall': 0.6186476, 'specificity': 0.9724648, 'f1': 0.5976675, 'auroc': 0.87714875}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   820     4   0   49    6   75    43    48    13  101    11
1     8  1353   0   31    1    3     5    65     9    2    22
2    10     2  68   13  438   65    26    11   121   69   192
3     0     0   0    0    0    0     0     0     0    0     0
4     0     1   0    0  350    0    14     1     7    1  1259
5     1     0   0   32    1  504     0     1     1   52     0
6     2     0   0    8    0    1  3040     0     1    0    15
7     2     2   1  112    1    2     6  1022     6    7     3
8     0     0   0   98    6   31    24     3  1202    3     3
9     2     5  51   91   44  384     9    30   102  388    31
10    0     0   0    0   20    0    10     1     0    0  1615
early stop counter: 3
val acc:0.9844322800636292, best validation acc: 0.9895145297050476, corresponding to test acc:                         0.6902679800987244 / 0.7561743259429932
after epoch: 29,now: 2024-07-09 07:31:36.597036,epoch time: 0:39:35.991014,used: 19:22:26.365202,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9881742, 'precision': 0.96952945, 'recall': 0.9734825, 'specificity': 0.99872375, 'f1': 0.97102284, 'auroc': 0.99991024}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    2    0     0     1     0    0      5
1     0  1323    0     0    0    0     1     8     0    0      0
2     0     0  299     0    7    1     0     1     0    2      2
3     0     2    0  8259    0   10     2   144    18    0      0
4     2     0    5     0  516    0     0     0     2    0     14
5     0     0    0     3    0  513     0     0     2    3      0
6     2     0    0     1    0    0  1898     4     0    0      3
7     0     5    0    12    1    0     0  7239     4    0      3
8     0     0    0    21    4    0     0    25  3230    0     15
9     1     0   28     1    0   26     0     0     1  436      0
10    3     1    0     0   37    0     2     2     3    0  12747
---- Validation: 
scalar performance:
{'acc': 0.9878561, 'precision': 0.9676559, 'recall': 0.97451687, 'specificity': 0.9986973, 'f1': 0.9706681, 'auroc': 0.9998918}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    3    0     1     1     0    0      4
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  299     0    6    3     0     0     0    3      1
3     1     0    0  8271    0    8     0   142    18    0      0
4     4     0    4     0  517    0     0     0     2    0     12
5     0     0    0     0    0  515     0     0     0    6      0
6     2     0    0     0    0    2  1900     0     0    0      4
7     1     9    1    15    0    0     0  7227     7    0      5
8     1     0    0    18    7    2     0    35  3219    0     14
9     1     0   25     1    0   24     0     0     1  441      0
10    2     1    0     1   40    0     2     2     5    0  12743
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7421815, 'precision': 0.65269506, 'recall': 0.63192785, 'specificity': 0.9740231, 'f1': 0.6123628, 'auroc': 0.8784959}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1045     0   0  22    4   29    36     6     5   12    11
1      1  1300   0  10    2    0     0   168     5    2    11
2     16    11  96   7  394   30     4    50   135   46   226
3      0     0   0   0    0    0     0     0     0    0     0
4      0     6   0   0  390    0     5     1     4    0  1227
5      5     0   1  38    3  398     1     0    10  134     2
6      1     1   0  15    1    0  2991     3     3    0    52
7      0     2   1  31    0    0     2  1124     0    1     3
8      2     0   0  30   16   10    13    34  1259    1     5
9     12    10  87  44   44  223     0    82   180  394    61
10     0     1   0   0   31    0     2     1     0    0  1611
early stop counter: 4
val acc:0.9878560900688171, best validation acc: 0.9895145297050476, corresponding to test acc:                         0.6902679800987244 / 0.7561743259429932
after epoch: 30,now: 2024-07-09 08:11:06.945459,epoch time: 0:39:30.348423,used: 20:01:56.713625,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:01:56.713625 at 2024-07-09 08:11:06.945459
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.690268, 'precision': 0.65298283, 'recall': 0.58038384, 'specificity': 0.96923065, 'f1': 0.5687506, 'auroc': 0.87072307}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1058     0    0   17    0    5    60    4     1   13    12
1      2  1094    3   61    3    0     5  300     6    5    20
2     26     0  119   43  166   34    13   82   218   44   270
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    1    1  264    0     4    1    27    0  1335
5     22     0    5  103    2  401     8    0     5   42     4
6      6     0    0    1    0    0  3033    0     0    0    27
7      4     0    1  195    0    1     4  953     0    5     1
8      7     0    0  223    0    8    32   16  1077    4     3
9     38     1   65  248   12  252    13  119   105  242    42
10     0     0    0    0   15    0     5    1     0    0  1625
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7561743, 'precision': 0.7037644, 'recall': 0.635048, 'specificity': 0.9754783, 'f1': 0.63505024, 'auroc': 0.886938}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1041     0    0   15    0    3    80    10     0   18     3
1      4  1246    0   31    2    0     2   177     4    9    24
2     27     1  121   13  396   10    24    29   118  147   129
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    1    0  479    0     4     1     7    0  1138
5      4     0    0   94    1  265     5     1     1  220     1
6      0     0    0    0    1    0  3049     1     1    1    14
7      1     0    0  115    0    0     3  1035     1    7     2
8      0     0    0   77    3    3    20    31  1221    9     6
9     16     1   36   90   18   75    11    52    78  741    19
10     0     0    0    0   32    0     3     1     0    0  1610
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725673_instance_wise_predictions.txt
accuracy from prediction file 0.6902679633386972
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/rule_results/0.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 460234 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool | 415617 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |  44617 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 460234 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool | 415617 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |  44617 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449784 KiB |   6803 MiB |   1406 TiB |   1406 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   1389 TiB |   1389 TiB |
|       from small pool |  42709 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7504 MiB |   7504 MiB |   7504 MiB |      0 B   |
|       from large pool |   7440 MiB |   7440 MiB |   7440 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 461366 KiB | 687911 KiB |   1061 TiB |   1061 TiB |
|       from large pool | 454783 KiB | 678614 KiB |   1044 TiB |   1044 TiB |
|       from small pool |   6583 KiB |  14742 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6392    |    8370    |  236930 K  |  236923 K  |
|       from large pool |     187    |     783    |  130600 K  |  130600 K  |
|       from small pool |    6205    |    8141    |  106329 K  |  106323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6392    |    8370    |  236930 K  |  236923 K  |
|       from large pool |     187    |     783    |  130600 K  |  130600 K  |
|       from small pool |    6205    |    8141    |  106329 K  |  106323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     343    |     343    |     343    |       0    |
|       from large pool |     311    |     311    |     311    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      60    |    1532    |  156606 K  |  156606 K  |
|       from large pool |      36    |     308    |  101067 K  |  101067 K  |
|       from small pool |      24    |    1496    |   55538 K  |   55538 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |      0 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |      0 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1406 TiB |   1406 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1389 TiB |   1389 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |   7504 MiB |   7504 MiB |   6604 MiB |
|       from large pool |    850 MiB |   7440 MiB |   7440 MiB |   6590 MiB |
|       from small pool |     50 MiB |     64 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 687911 KiB |   1061 TiB |   1061 TiB |
|       from large pool |  24320 KiB | 678614 KiB |   1044 TiB |   1044 TiB |
|       from small pool |      0 KiB |  40958 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8370    |  236930 K  |  236930 K  |
|       from large pool |       2    |     783    |  130600 K  |  130600 K  |
|       from small pool |       0    |    8141    |  106329 K  |  106329 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8370    |  236930 K  |  236930 K  |
|       from large pool |       2    |     783    |  130600 K  |  130600 K  |
|       from small pool |       0    |    8141    |  106329 K  |  106329 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     343    |     343    |     280    |
|       from large pool |      38    |     311    |     311    |     273    |
|       from small pool |      25    |      32    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1532    |  156608 K  |  156608 K  |
|       from large pool |       3    |     308    |  101067 K  |  101067 K  |
|       from small pool |       0    |    1496    |   55540 K  |   55540 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |      0 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |      0 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1406 TiB |   1406 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1389 TiB |   1389 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |   7504 MiB |   7504 MiB |   6604 MiB |
|       from large pool |    850 MiB |   7440 MiB |   7440 MiB |   6590 MiB |
|       from small pool |     50 MiB |     64 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 687911 KiB |   1061 TiB |   1061 TiB |
|       from large pool |  24320 KiB | 678614 KiB |   1044 TiB |   1044 TiB |
|       from small pool |      0 KiB |  40958 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8370    |  236930 K  |  236930 K  |
|       from large pool |       2    |     783    |  130600 K  |  130600 K  |
|       from small pool |       0    |    8141    |  106329 K  |  106329 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8370    |  236930 K  |  236930 K  |
|       from large pool |       2    |     783    |  130600 K  |  130600 K  |
|       from small pool |       0    |    8141    |  106329 K  |  106329 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     343    |     343    |     280    |
|       from large pool |      38    |     311    |     311    |     273    |
|       from small pool |      25    |      32    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1532    |  156608 K  |  156608 K  |
|       from large pool |       3    |     308    |  101067 K  |  101067 K  |
|       from small pool |       0    |    1496    |   55540 K  |   55540 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673

 Experiment start at: 2024-07-09 08:47:37.704922
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93156034, 'precision': 0.8419438, 'recall': 0.76610297, 'specificity': 0.9926748, 'f1': 0.7599173, 'auroc': 0.99405164}
confusion matrix:
     0     1    2     3    4   5     6     7     8    9      10
0   418     0    0     4    0   0     4     7     8    5     37
1     0  1264    0    12    1   0     0    48     4    0      3
2     3     0  154     1    8   0     2    13    14  114      3
3     4     3    1  8041    0   0     4   212   167    5      2
4     5     1  110     0  158   0     0     4    63   22    176
5     0     0    0   101    0  88     0     0    10  321      1
6    48     0    0     5    0   0  1797     2    10   10     35
7     5    21    3   236    1   0     4  6853   121    6     12
8     1     3    4   109    2   0     0    88  3064    6     18
9     1     0   12    12    0   0     0     4    13  448      3
10   30     3   28     7   27   0     9    23   126    7  12533
---- Validation: 
scalar performance:
{'acc': 0.9313896, 'precision': 0.8354798, 'recall': 0.7669465, 'specificity': 0.9926925, 'f1': 0.75805205, 'auroc': 0.99404496}
confusion matrix:
     0     1    2     3    4   5     6     7     8    9      10
0   414     0    0     6    0   0     5     5     8   11     34
1     0  1268    0    12    0   0     0    44     5    0      3
2     0     1  157     0   10   0     1    15     8  119      1
3     4     1    1  8051    0   0     5   197   168    8      5
4     7     2  105     1  162   0     4     5    63   21    169
5     0     0    2   102    0  80     0     0    13  323      1
6    45     0    2     3    0   0  1811     2    12    5     28
7     0    34    2   227    0   0     3  6848   127    6     18
8     3     2    4   124    5   0     2    73  3064    3     16
9     1     0   16     8    0   3     0     3    10  452      0
10   42     3   21     6   31   0    13    21   133   13  12513
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6799132, 'precision': 0.68359697, 'recall': 0.5566608, 'specificity': 0.9679357, 'f1': 0.518188, 'auroc': 0.8858579}
confusion matrix:
      0     1   2    3    4   5     6     7     8    9     10
0   1055     0   0   26    0   0     7    10    11   53     8
1      0  1195   0   26    0   0     3   244     3    0    28
2     21     0  34   10   80   0     0    78   453  184   155
3      0     0   0    0    0   0     0     0     0    0     0
4      1     0   2    0  169   0     1     3    34    1  1422
5      1     0   0  142    0  26     0     0    29  391     3
6      5     0   0    1    0   0  2642     4   169    0   246
7      6     0   0   60    0   0     1  1092     0    0     5
8      1     0   0   66    0   0     1    11  1285    4     2
9     23     7  10  112    3   1     0    96   290  578    17
10     0     0   0    0    3   0     0     0     1    0  1642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 09:28:42.650221,epoch time: 0:41:04.945299,used: 0:41:04.945299,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.942851, 'precision': 0.8764093, 'recall': 0.80712074, 'specificity': 0.9936952, 'f1': 0.8212327, 'auroc': 0.9965746}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    0     4    0    0     5     6     0    4     46
1     0  1273    0     8    0    0     0    41     5    0      4
2     0     2  118     0   76    0     0    15    10   88      3
3     1     1    0  8008    1   11     1   314    98    4      0
4     7     1    5     0  322    0     0     5    25    4    170
5     0     0    1    32    1  220     1     0     4  260      1
6    26     1    0    15    1    0  1803    11     7    2     41
7     1    16    1   178    3    0     1  7003    41    2     16
8     2     0    2   143   14    0     0   121  2943    3     67
9     0     0   14     8    4    8     0     4     4  451      0
10   18     1    2     7   40    0     3    19    23    1  12681
---- Validation: 
scalar performance:
{'acc': 0.9439615, 'precision': 0.8822607, 'recall': 0.8095887, 'specificity': 0.9938101, 'f1': 0.8253412, 'auroc': 0.99663675}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     0    0     9    0    0     3     7     0    5     44
1     0  1274    0     9    0    0     0    44     3    0      2
2     0     1  121     2   69    0     1    20     3   89      6
3     0     2    0  8020    0   12     0   305    97    3      1
4     6     1    8     1  333    0     1    11    21    3    154
5     0     0    0    33    3  223     0     0    11  250      1
6    28     1    0    13    1    0  1806    11     3    2     43
7     1    14    0   175    1    0     1  7011    43    2     17
8     2     0    2   146   19    1     0   104  2954    1     67
9     1     2   10    11    6    4     0     6     6  447      0
10   12     0    1     6   39    0     5    27    18    2  12686
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67557544, 'precision': 0.6887109, 'recall': 0.54901814, 'specificity': 0.96752656, 'f1': 0.5248786, 'auroc': 0.87936777}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   873     3   0  106    0    0    91    57     5   33     2
1     0  1204   0   17    0    0     0   262     1    0    15
2    10    10   5   23  188    0     0   251   218   98   212
3     0     0   0    0    0    0     0     0     0    0     0
4     0     1   0    0  193    0     1     8    25    1  1404
5     1     0   0  156    4  112     1     1    26  291     0
6     6     1   0    5    0    0  2834    18    11    0   192
7     0     0   0   23    0    0     0  1140     0    0     1
8     0     0   0  110    0    0     2    57  1196    1     4
9     4    17   0  153    7   11     3   318   144  463    17
10    0     0   0    0    9    0     0     1     0    0  1636
better model found
persisted
after epoch: 2,now: 2024-07-09 10:08:38.780963,epoch time: 0:39:56.130742,used: 1:21:01.076041,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9435734, 'precision': 0.8375331, 'recall': 0.8524059, 'specificity': 0.9940819, 'f1': 0.8304886, 'auroc': 0.99635404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     1    7     1    1    1     7     2     1    2     26
1     0  1302    0     4    0    0     0    23     3    0      0
2     0     0  279     0    2    3     1     2     0   24      1
3     3    12    0  7905    0   33     0   341   142    3      0
4     5     1  212     0  187    2     0     5    17    6    104
5     0     0    6    12    0  460     0     0     5   37      1
6    27     3    1     6    1    0  1847     3     4    0     15
7     0    58   11    98    0    0     1  7044    40    3      8
8     1     6   33    91    5    1     0   129  3003    2     25
9     1     0   85     3    0   99     0     1     2  302      0
10   15     1   88     6  100    1    16    29    30    1  12504
---- Validation: 
scalar performance:
{'acc': 0.9434265, 'precision': 0.8397044, 'recall': 0.85303557, 'specificity': 0.99406374, 'f1': 0.8317288, 'auroc': 0.9964303}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     1    1     3    0    1     7     4     3    5     31
1     0  1291    0     7    0    0     0    29     4    0      1
2     0     0  281     1    2    2     1     2     2   21      0
3     1    11    3  7921    0   39     1   333   130    1      0
4     3     1  221     0  189    3     1     4    13    4    100
5     0     0    4    10    0  459     0     0     6   41      1
6    23     4    1     4    0    1  1851     7     5    0     12
7     1    61   16   108    0    0     1  7034    37    1      6
8     1     5   33    90    4    5     0   123  3003    4     28
9     0     1   83     3    0   87     0     3     4  312      0
10   12     3   90     7  101    1    19    28    32    1  12502
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.79619396, 'precision': 0.73326653, 'recall': 0.69575596, 'specificity': 0.9794889, 'f1': 0.6873844, 'auroc': 0.89293456}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1052     3    4  12    1    3    29    13     1   44     8
1      1  1335    0   5    0    0     0   141     1    0    16
2      9     1  607   0   53   10     3    69   109   53   101
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0   26   0  323    0     1     2    13    1  1267
5      3     0    9  22    0  393     1     0     7  156     1
6      0     0    0   1    0    0  3047     4     0    0    15
7      0     0    0   3    0    0     0  1159     0    1     1
8      0     0    6  45    1    9     4    29  1268    1     7
9      5     8  239  27    1  100     0    95    82  570    10
10     0     0    1   0   17    0     1     1     0    0  1626
new oracle model saved
early stop counter: 1
val acc:0.9434264898300171, best validation acc: 0.943961501121521, corresponding to test acc:                         0.6755754351615906 / 0.7961939573287964
after epoch: 3,now: 2024-07-09 10:48:55.795341,epoch time: 0:40:17.014378,used: 2:01:18.090419,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95315176, 'precision': 0.89438015, 'recall': 0.8517698, 'specificity': 0.9948175, 'f1': 0.865721, 'auroc': 0.9976842}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    2     5    1    0    10     3     1    2     67
1     0  1207    2    10    0    0     1    95     6    0     11
2     0     0  258     0    8    1     1     5     6   32      1
3     0     0    0  8166    0    8     8   109   140    3      4
4     1     0   61     1  295    1     0     1    23    6    150
5     0     0    1    42    0  337     0     0    13  127      1
6     6     0    2     2    1    0  1862     0     6    0     29
7     0     4    6   196    0    0     1  6905   122    1     28
8     0     0    4    83    5    0     0    41  3120    1     40
9     0     0   63     4    0   24     0     2     5  393      2
10    1     0    7     7   39    0     9     8    30    2  12690
---- Validation: 
scalar performance:
{'acc': 0.9549017, 'precision': 0.8979495, 'recall': 0.8547374, 'specificity': 0.99501616, 'f1': 0.8696469, 'auroc': 0.99770653}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   403     0    1     1    0    0    13     1     0    2     62
1     0  1210    1    12    0    0     0    95     6    0      8
2     0     0  252     0   10    0     1     5     3   38      3
3     0     0    2  8181    0    7     3   112   131    1      3
4     2     0   55     0  300    1     0     2    20   10    149
5     0     0    1    35    0  338     0     0    12  133      2
6     2     0    1     2    2    0  1873     0     5    3     20
7     0     5    2   189    1    0     4  6905   133    1     25
8     0     0    3    77    8    0     0    43  3124    0     41
9     1     0   54     6    1   23     0     2     7  396      3
10    2     0    4     7   32    0     2     4    26    2  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66466105, 'precision': 0.67797744, 'recall': 0.54487026, 'specificity': 0.9660891, 'f1': 0.5195105, 'auroc': 0.8815448}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   879    0   0  25    0    0   152    15    12   39    48
1     1  804   0  19    0    0     0   576    13    0    86
2     1    0  70   1   44    1     2   108   329   99   360
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   1   0  175    0     1     2    23    0  1431
5     4    0   0  86    0  126     1     0    25  344     6
6     0    0   0   1    0    0  2831     5     3    0   227
7     0    0   0   8    0    0     1  1152     0    0     3
8     0    0   0  38    0    0     4    16  1305    3     4
9     2    0  32  47    1   12     1   194   282  517    49
10    0    0   0   0    4    0     0     1     0    0  1641
better model found
persisted
after epoch: 4,now: 2024-07-09 11:29:38.120358,epoch time: 0:40:42.325017,used: 2:42:00.415436,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9449914, 'precision': 0.8596095, 'recall': 0.8587431, 'specificity': 0.9940262, 'f1': 0.8527432, 'auroc': 0.99707127}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     0    1     6    1    0     0     3     2    9     54
1     0  1269    0     8    0    0     0    46     1    0      7
2     0     1  259     0    5    1     0     3     2   41      0
3     0     2    1  7779    0   60     0   359   225    8      3
4     3     0   96     1  269    1     0     4    12    9    144
5     0     0    3    15    0  422     0     0     3   77      1
6    47     1    6    26    0    0  1764    10     0    8     46
7     4    27   11    76    1    0     0  7039    88    0     19
8     5     3   30    47   15   13     0    76  3034    6     66
9     0     1   49     5    0   47     1     2     2  385      0
10    9     0   11     7   39    1     3    15    12    3  12693
---- Validation: 
scalar performance:
{'acc': 0.9429183, 'precision': 0.85503936, 'recall': 0.8503521, 'specificity': 0.9937838, 'f1': 0.845138, 'auroc': 0.9970882}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   400     0    1     5    2    1     0     8     1    9     56
1     0  1271    0     8    0    0     0    45     2    0      6
2     2     0  255     0    5    2     1     4     0   41      2
3     2     2    1  7765    0   59     0   389   213    6      3
4     2     1  109     1  253    1     0     2     9    9    152
5     0     0    3    14    0  425     0     0     3   75      1
6    50     0    5    25    0    3  1765    15     2    7     36
7     1    24   12    78    1    1     1  7029    96    1     21
8     2     3   25    43   14   13     0    78  3017    7     94
9     1     0   60     1    0   57     0     3     2  369      0
10    8     0   10     7   34    1     4    11    16    3  12702
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75736374, 'precision': 0.682726, 'recall': 0.65652853, 'specificity': 0.975546, 'f1': 0.6391809, 'auroc': 0.8873664}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1042     3    0  33    0    0    15    26    10   19    22
1      2  1340    0   7    0    0     0   107     5    1    37
2     16     3  285   0  140   20     2    38   147   77   287
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    2   0  150    0     1     1     6    0  1473
5      7     0    2  25    0  417     0     0     2  137     2
6      2     0    1   1    0    0  2989     2     1    0    71
7      2     0    1  22    0    1     0  1133     3    0     2
8      5     0    2  35    1   25     1     3  1288    4     6
9     12    11  183  26    2  161     0    90    76  541    35
10     0     0    0   0    4    0     1     1     0    0  1640
early stop counter: 1
val acc:0.9429183006286621, best validation acc: 0.9549016952514648, corresponding to test acc:                         0.6646610498428345 / 0.7961939573287964
after epoch: 5,now: 2024-07-09 12:09:35.973360,epoch time: 0:39:57.853002,used: 3:21:58.268438,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9468108, 'precision': 0.86668515, 'recall': 0.8277594, 'specificity': 0.99420476, 'f1': 0.8422276, 'auroc': 0.99650574}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     2    1    0    10     6     1    0     20
1     0  1261    0    10    0    0     1    54     4    0      1
2     5     0  179     1   75    0     4    10    20   11      7
3     0     0    0  7948    0    6     2   283   194    1      4
4     5     0    8     0  300    2     3     5    37    0    179
5     9     0    1    26    5  415     2     0    21   40      2
6    12     1    0     2    2    0  1877     3     1    0     10
7     3    23    1   108    1    0     6  7021    67    0     34
8     1     0    1    47    6    1     2   122  3060    0     54
9    25     0   80    12   37   44     8     3    32  249      3
10   60     1    1     7   30    1    16     6    36    0  12635
---- Validation: 
scalar performance:
{'acc': 0.9457804, 'precision': 0.8525051, 'recall': 0.80974746, 'specificity': 0.9941217, 'f1': 0.82617205, 'auroc': 0.9964065}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     1    0     7    3    0    12     6     1    0     19
1     0  1267    0     9    0    0     0    48     7    0      1
2     5     0  155     2   94    1     1    13    24   12      5
3     0     1    0  7980    1    9     2   240   204    0      3
4     8     0    1     1  272    0     4     6    49    1    197
5    12     0    2    29    5  389     2     0    24   57      1
6    11     0    0     1    1    0  1879     3     3    0     10
7     1    31    2   105    1    0     3  7017    73    0     32
8     1     1    2    37    3    0     1   109  3088    0     54
9    28     0   87    12   39   47     6     5    27  241      1
10   49     0    0     7   27    0    24    11    42    0  12636
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68012315, 'precision': 0.5678349, 'recall': 0.5571861, 'specificity': 0.9676295, 'f1': 0.5121236, 'auroc': 0.8686225}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1069     1   0   13    0    0    56    12     7    1    11
1      0  1101   0   12    0    0     1   361     3    0    21
2     52     0  19    3  235    3    30    61   371    7   234
3      0     0   0    0    0    0     0     0     0    0     0
4      4     0   0    0   33    0     4     2    24    0  1566
5     58     0   1  105   23  239    10     0    61   91     4
6      2     0   0    1    0    0  3036     1    10    0    17
7      0     0   0    8    0    0     0  1149     1    0     6
8      0     1   0   36    1    0     4    13  1313    0     2
9    114     5  48   67  105   42    36    92   464  119    45
10     0     0   0    0    0    0     1     1     1    0  1643
early stop counter: 2
val acc:0.9457803964614868, best validation acc: 0.9549016952514648, corresponding to test acc:                         0.6646610498428345 / 0.7961939573287964
after epoch: 6,now: 2024-07-09 12:49:41.227521,epoch time: 0:40:05.254161,used: 4:02:03.522599,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95668346, 'precision': 0.9019006, 'recall': 0.85109943, 'specificity': 0.9952619, 'f1': 0.86511505, 'auroc': 0.99825644}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     3    1    0    39     0     1    4     26
1     0  1276    0     8    0    0     0    43     3    0      2
2     0     0  134     2   40    1     3    10     5  110      7
3     5     3    0  8096    0   42     2   158   125    5      1
4     5     0   10     0  303    1     9     2    16   12    181
5     0     0    1    11    0  439     0     0     3   66      1
6     5     0    0     1    1    1  1885     2     2    2      7
7     1     4    0   108    1    0     2  7073    62    1     11
8     2     2    0    66    4    5     1    68  3075    4     69
9     0     0    3     2    0   45     2     3     2  434      2
10    9     0    2     8   13    0    99     9    18    3  12633
---- Validation: 
scalar performance:
{'acc': 0.9567741, 'precision': 0.89952207, 'recall': 0.8498561, 'specificity': 0.9952842, 'f1': 0.8636955, 'auroc': 0.9982045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     1    0    0    42     0     0    4     26
1     0  1283    0     2    0    0     0    41     4    0      2
2     3     0  132     2   43    1     3     3     3  119      3
3     3     1    0  8107    0   35     6   157   123    7      1
4     4     1   10     0  308    1    12     3    19   10    171
5     0     0    0    10    1  435     1     0     4   69      1
6     3     0    0     1    1    0  1891     0     3    1      8
7     1    10    0   133    1    0     2  7052    54    1     11
8     0     1    2    61    6    4     4    64  3079    3     72
9     0     0    6     5    0   47     5     3     1  425      1
10   15     0    0     8   10    0    94     9    12    1  12647
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71692437, 'precision': 0.6404334, 'recall': 0.59869945, 'specificity': 0.9712477, 'f1': 0.57066154, 'auroc': 0.8788564}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   964     0   0  25    0    0   112    35    21    4     9
1     1  1228   0  12    0    0     2   224     5    0    27
2     8     0  31   7  114    5    53    66   201   85   445
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0   72    0    13     2     8    1  1537
5    10     0   0  63    1  284     2     2    19  210     1
6     0     0   0   2    0    0  3060     1     0    0     4
7     0     0   0   3    0    0     0  1159     1    0     1
8     1     0   0  27    1    4     8    22  1295    2    10
9    22     2  33  79    8   64    18   102   249  518    42
10    0     0   0   0    2    0     6     1     1    0  1636
better model found
persisted
after epoch: 7,now: 2024-07-09 13:29:23.337749,epoch time: 0:39:42.110228,used: 4:41:45.632827,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9633187, 'precision': 0.91117215, 'recall': 0.8902784, 'specificity': 0.99603593, 'f1': 0.8985868, 'auroc': 0.9985631}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    1     1    0    1     2     0     0    0     12
1     0  1206    0    14    0    0     0    98     6    0      8
2     1     0  199     0   54    1     1     1     2   48      5
3     2     0    0  8084    0   19     1   162   169    0      0
4     7     0    7     1  395    1     0     1    19    1    107
5     0     0    0    11    0  439     0     0     6   64      1
6    15     0    0     0    2    0  1873     1     2    0     15
7     6     3    1   102    2    0     0  7074    63    0     12
8     1     0    1    35   10    0     1    55  3173    1     19
9     1     0   19     3    2   46     1     1     4  415      1
10   20     0    2     8   39    1     2    11    28    0  12681
---- Validation: 
scalar performance:
{'acc': 0.96169585, 'precision': 0.90948296, 'recall': 0.88364375, 'specificity': 0.9958544, 'f1': 0.89413464, 'auroc': 0.9985481}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    1    0     3     1     1    0     12
1     0  1213    0    16    0    0     0    83     9    0     11
2     2     0  195     2   46    1     1     8    10   45      2
3     2     0    0  8079    0   20     0   168   170    1      0
4     5     0    9     0  384    1     1     2    20    1    116
5     1     0    1    12    0  429     0     2     7   67      2
6    15     0    0     3    1    0  1865     3     4    2     15
7     0     4    1   118    3    0     2  7060    64    1     12
8     1     0    1    35   11    0     4    51  3173    2     18
9     1     0   17     2    3   55     0     2     3  408      2
10   20     0    1     7   33    1     4     9    38    0  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7301476, 'precision': 0.6461749, 'recall': 0.6167935, 'specificity': 0.9727278, 'f1': 0.59813845, 'auroc': 0.87999547}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1078     0   0  21    0    0    48    15     1    5     2
1      3  1099   0  21    0    0     4   283    15    0    74
2     31     0  70   6  312   11    38    46   236   72   193
3      0     0   0   0    0    0     0     0     0    0     0
4      1     0   0   0  264    0     6     2    16    0  1344
5      8     0   4  51    0  341     4     0     9  173     2
6      3     0   0   1    0    0  3053     1     0    0     9
7      2     0   0  22    0    0     0  1138     1    0     1
8      0     0   0  53    4    4    21    13  1271    1     3
9     33     0  87  67   23   93    15    99   198  491    31
10     0     0   0   0   11    0     3     1     0    0  1631
better model found
persisted
after epoch: 8,now: 2024-07-09 14:09:00.345702,epoch time: 0:39:37.007953,used: 5:21:22.640780,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9659675, 'precision': 0.8983293, 'recall': 0.90866756, 'specificity': 0.9964018, 'f1': 0.9029183, 'auroc': 0.9986888}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     1    0     2    2    0     6     3     3    1     22
1     0  1302    0     7    0    0     0    20     1    0      2
2     1     0  252     0   16    3     0     0     2   36      2
3     0     6    2  8206    0   23     0   112    78   11      0
4     0     0   26     0  398    1     1     2    16    7     88
5     1     0    1    11    0  475     0     0     2   30      1
6     5     0    1     2    2    1  1885     1     3    0      8
7     0    30   21   118    2    0     1  7002    76    7      7
8     0     0    7    54   10    8     2    33  3167    6      8
9     0     0   32     4    2   71     0     1     2  381      0
10    5     1    6     8  104    2     7    13    52    0  12593
---- Validation: 
scalar performance:
{'acc': 0.96538717, 'precision': 0.89716524, 'recall': 0.90793526, 'specificity': 0.99634206, 'f1': 0.90157384, 'auroc': 0.9986659}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     2    2    0     5     1     4    3     28
1     0  1306    1     4    1    0     0    18     1    0      1
2     0     0  256     1   16    1     0     0     2   34      2
3     0     9    1  8217    0   18     0   103    86    6      0
4     4     0   32     0  394    1     1     0    18    3     86
5     0     0    0    16    1  481     0     0     2   21      0
6     7     1    2     2    0    0  1884     2     3    0      7
7     0    31   21   115    1    0     1  7008    76    6      6
8     1     2    8    66   11    9     0    34  3150    3     12
9     0     0   32     2    0   82     0     1     1  375      0
10    5     1   11     7  103    2     8    10    63    4  12582
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74966764, 'precision': 0.68603384, 'recall': 0.6439306, 'specificity': 0.9748541, 'f1': 0.63177484, 'auroc': 0.8845872}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1060     1    0  31    0    2    28    22     2   15     9
1      1  1282    1  25    0    0     2   144     9    0    35
2      8     0  210   8  136   21    13    35   263   90   231
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   0  229    0     2     2    24    0  1373
5      7     0    3  71    0  392     1     0     3  113     2
6      1     0    0   1    0    0  3005     0     1    0    59
7      2     0    0  54    0    1     0  1098     7    1     1
8      1     0    0  51    0   10     8     5  1285    7     3
9     11     2  142  81    3  150     5    44   139  526    34
10     0     0    0   0   17    0     0     1     0    0  1628
better model found
persisted
after epoch: 9,now: 2024-07-09 14:48:52.020644,epoch time: 0:39:51.674942,used: 6:01:14.315722,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97051585, 'precision': 0.927497, 'recall': 0.90289116, 'specificity': 0.99672407, 'f1': 0.90847135, 'auroc': 0.99919116}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    0    0     2     0     0    3     12
1     0  1300    0     5    0    0     0    23     2    0      1
2     0     0  278     0    2    1     0     3     5   22      1
3     0     1    1  8308    1    4     2    52    66    2      2
4     5     0   52     0  295    2     2     0    18    3    162
5     0     0    3    24    0  426     0     0     2   64      2
6     4     0    3     1    0    1  1885     0     1    0     13
7     0    27    8   149    0    0     2  7004    64    1      8
8     1     2    8    51    3    0     1    27  3157    6     40
9     0     0   42     3    0   29     0     1     1  417      0
10    8     1    5     6    4    1     7     9    11    0  12739
---- Validation: 
scalar performance:
{'acc': 0.97196734, 'precision': 0.93021864, 'recall': 0.9043727, 'specificity': 0.9968888, 'f1': 0.90955037, 'auroc': 0.9992158}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     2    0    0     2     0     0    1      9
1     0  1307    0     3    0    0     0    20     1    0      1
2     1     0  285     0    1    0     0     2     3   20      0
3     0     1    2  8308    0    2     2    55    69    1      0
4     5     0   59     0  288    2     1     2    16    4    162
5     0     0    2    22    0  410     0     0     4   82      1
6     7     0    1     0    0    0  1887     1     1    0     11
7     1    16    3   130    1    0     2  7040    64    0      8
8     0     0    6    63    1    0     0    25  3164    3     34
9     0     0   42     3    0   22     0     0     1  425      0
10    8     0    5     7    6    0     3     3     9    1  12754
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73833346, 'precision': 0.68482494, 'recall': 0.6154567, 'specificity': 0.97366506, 'f1': 0.6014302, 'auroc': 0.88399386}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1099     0    0   18   0    0    24     6     3    9    11
1      1  1369    0    2   0    0     1   112     1    0    13
2      8     4  255    4  58    4    24    31   222   66   339
3      0     0    0    0   0    0     0     0     0    0     0
4      0     0    2    0  59    0     6     1     9    0  1556
5      4     0    1  119   0  169     2     0    15  280     2
6      3     0    0    0   0    0  3034     0     2    0    28
7      0     0    0   84   0    0     0  1077     2    0     1
8      0     1    0   50   0    0     5    12  1293    5     4
9      5    24  193   91   0   19     8    56   156  555    30
10     0     0    0    0   1    0     1     1     0    0  1643
better model found
persisted
after epoch: 10,now: 2024-07-09 15:29:31.062989,epoch time: 0:40:39.042345,used: 6:41:53.358067,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9665293, 'precision': 0.91856205, 'recall': 0.89069, 'specificity': 0.9964129, 'f1': 0.8945924, 'auroc': 0.99898505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     2    7    0     7     2     0    0      7
1     0  1293    0     8    0    0     0    30     1    0      0
2     3     0  134     3   77    2     1    10     1   80      1
3     1     0    0  8291    0    2     0   116    27    1      0
4     4     0    3     1  465    0     0     6     5    0     55
5     0     0    0    26    2  457     2     0     4   28      1
6     8     0    0     1    0    0  1890     2     2    0      5
7     1    11    0   114    1    0     3  7126     4    0      4
8     2     0    0   118   12    3     0   139  3010    2      6
9     4     0    4     4    5   46     1     6     1  422      0
10   25     0    0     9   98    1    18    39    26    0  12579
---- Validation: 
scalar performance:
{'acc': 0.9649592, 'precision': 0.9149214, 'recall': 0.8854419, 'specificity': 0.99624527, 'f1': 0.8886721, 'auroc': 0.9990422}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     3    8    0    10     4     0    0      8
1     0  1290    0     8    0    0     0    33     1    0      0
2     0     0  122     2   78    1     1    20     1   86      1
3     0     0    0  8285    0    5     0   124    26    0      0
4     4     0    1     2  476    0     0     2     9    1     44
5     0     0    0    27    0  455     0     0     1   36      2
6     7     0    0     2    1    0  1890     1     2    0      5
7     0    10    0   123    2    0     3  7116     7    1      3
8     1     1    0   131   13    1     1   145  2991    2     10
9     0     0    7     6    5   49     2     1     4  419      0
10   37     1    0     7   91    1    11    44    23    0  12581
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69474566, 'precision': 0.60267377, 'recall': 0.56567276, 'specificity': 0.96965915, 'f1': 0.55955577, 'auroc': 0.87853974}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   968     1   0   66    1    0    60   58     9    2     5
1     1  1283   0   19    1    0     1  183     1    0    10
2    38     4   0   45  398    6     9   85   208   51   171
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  293    0     2    3    16    0  1319
5    21     0   0  205    2  227     2    2     7  124     2
6     1     0   0   10    0    0  3030    1     1    0    24
7     0     0   0  217    0    0     0  946     0    0     1
8     1     0   0  123    0    0     8   19  1216    1     2
9    40    21   1  299   76   47    12  103   159  342    37
10    0     0   0    0   19    0     1    0     1    0  1625
early stop counter: 1
val acc:0.9649592041969299, best validation acc: 0.971967339515686, corresponding to test acc:                         0.7383334636688232 / 0.7961939573287964
after epoch: 11,now: 2024-07-09 16:09:04.388549,epoch time: 0:39:33.325560,used: 7:21:26.683627,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9690711, 'precision': 0.92187107, 'recall': 0.9111158, 'specificity': 0.99659413, 'f1': 0.9153544, 'auroc': 0.9990892}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     3    2    1     2     2     0    3     29
1     0  1256    0     4    0    0     0    70     1    0      1
2     1     0  252     0   12    1     0     1     1   44      0
3     0     0    1  8209    0   15     1   135    71    5      1
4     3     0   37     1  390    1     0     2     6    8     91
5     0     0    0     6    1  485     0     0     3   25      1
6     2     0    1     0    0    1  1883     3     4    0     14
7     0     1    2    98    1    0     1  7142    11    2      4
8     0     2    6    33   10   22     0   122  3037   13     50
9     0     0   17     1    0   57     0     0     1  417      0
10    2     0    6     5   36    0     4    20     9    3  12708
---- Validation: 
scalar performance:
{'acc': 0.9680086, 'precision': 0.91625595, 'recall': 0.90924335, 'specificity': 0.99649215, 'f1': 0.9116567, 'auroc': 0.9991407}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    1     4    2    2     2     1     0    1     25
1     0  1257    1     6    0    0     0    66     2    0      0
2     1     0  256     0    8    0     1     2     0   44      0
3     0     0    1  8197    0   21     0   121    94    4      2
4     2     0   43     0  396    3     0     4     6    3     82
5     0     0    0     6    0  468     0     0     0   46      1
6     6     0    0     2    1    0  1871     2     2    2     22
7     0     2    3    93    0    0     1  7142    18    1      5
8     0     2   12    41    6   11     0   109  3037   16     62
9     0     0   20     0    0   59     0     2     1  411      0
10    0     0    5     7   42    0     3    19    10    1  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72091234, 'precision': 0.70149565, 'recall': 0.60107243, 'specificity': 0.97184765, 'f1': 0.59294355, 'auroc': 0.88622093}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   915    1    0  40    0    0   101    48     9   29    27
1     0  951    0  15    0    0     0   509     3    0    21
2     5    0  186   4  190    3     7   138   119  134   229
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    1   0  366    0     2     4    13    2  1245
5     3    0    2  39    1  157     1     5     2  379     3
6     1    0    0   1    0    0  2930     2     1    0   132
7     0    0    0  29    0    0     0  1132     1    0     2
8     0    0    0  32    1    5     3    52  1257   16     4
9     5    0   53  36    6   13     3   171    42  784    24
10    0    0    0   0   18    0     1     1     0    0  1626
early stop counter: 2
val acc:0.9680085778236389, best validation acc: 0.971967339515686, corresponding to test acc:                         0.7383334636688232 / 0.7961939573287964
after epoch: 12,now: 2024-07-09 16:48:50.656667,epoch time: 0:39:46.268118,used: 8:01:12.951745,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97182685, 'precision': 0.93870306, 'recall': 0.92106295, 'specificity': 0.9969316, 'f1': 0.92830515, 'auroc': 0.9993701}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    0    0    10     0     0    0      5
1     0  1311    0     4    0    0     0    13     2    0      2
2     1     0  263     0   16    1     0     1     4   24      2
3     0     0    0  8377    0    2     0    28    31    0      0
4     5     0   10     0  397    2     1     0    21    3    100
5     0     0    0    21    0  487     0     0     2   10      1
6     2     0    0     1    0    0  1897     0     4    0      3
7     2    18    5   183    1    0     1  6949   100    0      4
8     0     0    2   139    3    1     0    11  3138    2      0
9     0     0   24     4    0   78     0     1     1  385      0
10   14     0    2     7   17    2    11     3    84    0  12652
---- Validation: 
scalar performance:
{'acc': 0.9717801, 'precision': 0.94087285, 'recall': 0.9215123, 'specificity': 0.9969212, 'f1': 0.9296591, 'auroc': 0.9993434}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    3    0    16     0     1    0      4
1     0  1313    0     5    0    0     0    13     1    0      0
2     0     0  267     2   11    1     2     1     2   26      0
3     1     1    1  8381    1    1     0    32    22    0      0
4     4     0   10     0  392    2     1     1    26    1    102
5     0     0    0    22    0  487     0     0     1   10      1
6     3     0    0     1    1    1  1897     0     2    0      3
7     3    12    4   195    2    0     1  6952    92    0      4
8     0     0    1   125    0    1     0    14  3150    2      3
9     0     0   14     5    0   81     1     0     0  392      0
10   10     0    3     7   23    1    14     7    91    0  12640
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.723501, 'precision': 0.6690358, 'recall': 0.6011467, 'specificity': 0.9722452, 'f1': 0.59481424, 'auroc': 0.8824531}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   897     2    2   52    2    1   116    29    41   19     9
1     2  1339    0   18    0    0     1   107    16    0    16
2     6     0  122   13  187    9    13    30   427   83   125
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  228    0    10     1    55    1  1337
5     5     0    1  138    1  272     2     0    20  153     0
6     0     0    0    1    0    0  3057     0     2    0     7
7     0     0    0   81    0    0     0  1075     7    0     1
8     0     0    0   88    0    0     5     5  1270    2     0
9     4     5   97  167    9   70    14    48   258  448    17
10    0     0    0    0    7    0     5     0     1    0  1633
early stop counter: 3
val acc:0.9717801213264465, best validation acc: 0.971967339515686, corresponding to test acc:                         0.7383334636688232 / 0.7961939573287964
after epoch: 13,now: 2024-07-09 17:29:06.701171,epoch time: 0:40:16.044504,used: 8:41:28.996249,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9696597, 'precision': 0.9279237, 'recall': 0.9060477, 'specificity': 0.99673384, 'f1': 0.91341597, 'auroc': 0.9991214}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     4    1    0     6     4     0    0     22
1     0  1294    0     4    0    0     0    33     1    0      0
2     1     0  204     3   24    1     1    15     5   57      1
3     0     1    0  8301    0    2     0    99    35    0      1
4     4     0    6     1  473    2     0     1    18    3     30
5     0     0    0    28    0  475     0     0     1   16      1
6     0     0    0     3    0    0  1889     4     3    0      8
7     0     5    0   126    1    0     1  7114    12    0      4
8     0     0    0   114    4    1     0    76  3087    0     13
9     0     0    3     8    1   94     1     8     7  371      0
10    3     0    1    10  134    1     7    19    30    0  12589
---- Validation: 
scalar performance:
{'acc': 0.9705497, 'precision': 0.9276404, 'recall': 0.90837455, 'specificity': 0.99683857, 'f1': 0.9154382, 'auroc': 0.99915266}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     8    0    0    14     2     0    0     19
1     0  1296    0     6    0    0     1    27     2    0      0
2     0     0  214     2   17    1     1    20     3   51      3
3     0     0    0  8317    0    2     0    91    30    0      0
4     5     0    9     1  469    0     0     1    17    4     33
5     0     0    0    28    0  474     0     0     4   14      1
6     0     1    0     4    0    0  1889     5     4    0      5
7     0     7    0   129    0    0     1  7108    16    0      4
8     0     0    0    96    2    4     0    76  3111    0      7
9     0     0    8     7    0   91     0     8     4  375      0
10    3     4    0    10  138    0     5    19    26    0  12591
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6850206, 'precision': 0.67381793, 'recall': 0.5684829, 'specificity': 0.9686086, 'f1': 0.55510855, 'auroc': 0.88012207}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   835     3   1   76    0    0    68   128    20    5    34
1     0  1138   0   20    0    0     0   328     5    0     8
2    12     1  32   42  153   18     7   132   396   33   189
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  459    0     2     2    33    0  1137
5     6     0   1  187    0  292     0     6    17   81     2
6     5     0   0    8    0    0  2833     8    33    0   180
7     0     0   0   27    0    0     0  1136     0    0     1
8     0     0   0   78    0    1     1    48  1241    0     1
9    10     3  14  289    7   59     4   236   263  222    30
10    0     0   0    0   41    0     2     0     0    0  1603
early stop counter: 4
val acc:0.9705497026443481, best validation acc: 0.971967339515686, corresponding to test acc:                         0.7383334636688232 / 0.7961939573287964
after epoch: 14,now: 2024-07-09 18:09:28.130134,epoch time: 0:40:21.428963,used: 9:21:50.425212,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9742616, 'precision': 0.9358498, 'recall': 0.92420065, 'specificity': 0.99715865, 'f1': 0.92640567, 'auroc': 0.99942815}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     1    6    1     2     0     1    1     36
1     0  1301    0     4    0    2     0    18     4    0      2
2     0     0  278     0   22    3     0     2     1    5      1
3     0     2    0  8255    1   33     0    69    78    0      0
4     0     0    7     0  444    1     0     0     3    0     84
5     0     0    0     1    0  518     0     0     1    0      1
6     9     1    0     1    2    2  1851     0     2    2     37
7     0    15    3   123    3    1     0  7071    34    0     13
8     0     0    2    26   19   11     0    20  3171    3     42
9     0     0   36     0    4  107     0     0     0  344      2
10    0     0    1     6   28    0     0     6     8    0  12746
---- Validation: 
scalar performance:
{'acc': 0.9731443, 'precision': 0.93158174, 'recall': 0.9191213, 'specificity': 0.9970208, 'f1': 0.9218591, 'auroc': 0.9994157}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     0    3    0     0     1     3    2     39
1     0  1302    0     6    0    0     0    18     2    0      4
2     0     0  272     0   20    4     0     3     0   11      2
3     0     1    0  8247    0   37     0    83    71    1      0
4     0     0    5     0  445    0     0     0     1    0     88
5     0     0    0     1    0  514     0     0     1    4      1
6     6     0    0     2    5    0  1840     1     3    1     50
7     0    10    3   123    2    0     0  7081    35    2      9
8     0     0    2    24   19   13     0    22  3166    3     47
9     0     0   42     0    6  110     0     0     1  333      1
10    0     0    0     6   34    1     0     4     5    0  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6610928, 'precision': 0.6231166, 'recall': 0.58855224, 'specificity': 0.9658145, 'f1': 0.5743103, 'auroc': 0.87374663}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1028     1    2   26    8   15    10    19     6   19    36
1      0  1244    0   31    1    3     0   168     7    2    43
2      1     1  109    8  331   11     1    48   168   40   297
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    1  101    1     0     0     5    0  1524
5      2     0    9   20    8  389     0     0     2  161     1
6      1     0    0    2    0    0  2147     4     1    0   912
7      0     0    0  127    0    2     0  1029     4    0     2
8      0     0    0   62    0   18     0    10  1267    6     7
9      2     4  147   51   45  166     0    65   117  490    50
10     0     0    0    0    1    0     0     0     0    0  1645
better model found
persisted
after epoch: 15,now: 2024-07-09 19:27:22.690813,epoch time: 1:17:54.560679,used: 10:39:44.985891,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9791845, 'precision': 0.95355856, 'recall': 0.9310546, 'specificity': 0.9977281, 'f1': 0.9414795, 'auroc': 0.9995204}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     0    2    0    36     0     1    0      6
1     0  1309    0     2    0    0     0    19     1    0      1
2     1     0  265     0   11    0     1     6     1   27      0
3     0     0    2  8357    0    2     2    43    32    0      0
4     5     0    8     0  428    1     1     1    18    2     75
5     0     0    0    10    0  485     0     0     3   22      1
6     0     0    0     1    0    0  1901     0     0    0      4
7     0    15    0    99    1    0     3  7108    32    0      7
8     0     0    0    63    0    1     4    53  3161    1     13
9     0     0   17     2    0   45     1     3     2  423      0
10    3     0    3     4   13    0    24     1    20    0  12724
---- Validation: 
scalar performance:
{'acc': 0.9784673, 'precision': 0.94793236, 'recall': 0.92433745, 'specificity': 0.9976614, 'f1': 0.9352615, 'auroc': 0.999479}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     1    0     0    3    0    42     0     0    0     11
1     0  1313    0     2    0    0     0    16     1    0      0
2     2     0  254     1   13    0     1     2     0   37      2
3     0     0    0  8366    0    1     2    45    25    1      0
4     6     0   10     0  421    0     3     3    19    2     75
5     0     0    0    10    0  481     0     0     3   26      1
6     1     0    1     0    0    1  1900     3     0    0      2
7     1    10    0   104    2    0     2  7118    25    0      3
8     1     3    2    64    0    1     2    48  3161    1     13
9     0     1   13     1    3   45     0     3     2  425      0
10    1     0    1     5   23    0    27     4    20    0  12715
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7095082, 'precision': 0.6476163, 'recall': 0.58930445, 'specificity': 0.97011185, 'f1': 0.5790809, 'auroc': 0.87657326}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   637     1    1   8    0    1   466    21     1   24    10
1     1  1322    0  10    0    0     4   132     3    0    27
2     3     3  178   9  181    5   109    74   270   53   130
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  175    0    29     2    34    0  1393
5     2     0   13  48    0  293    11     0     9  216     0
6     0     1    0   0    0    0  3063     0     0    0     3
7     0     0    0  13    0    0     1  1148     1    0     1
8     0     0    0  64    0    3    16    48  1237    2     0
9     1    16  166  79   11   70    29   157   136  449    23
10    0     0    0   0    0    0     6     0     1    0  1639
better model found
persisted
after epoch: 16,now: 2024-07-09 20:12:00.560329,epoch time: 0:44:37.869516,used: 11:24:22.855407,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97600067, 'precision': 0.9409721, 'recall': 0.91661775, 'specificity': 0.99737966, 'f1': 0.9265216, 'auroc': 0.9994895}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     1    1    0     3     1     0    2     25
1     0  1272    0     4    0    0     0    51     3    0      2
2     0     0  249     1    0    4     0     2     8   47      1
3     3     0    0  8260    0   12     0    93    69    2      0
4     2     0   34     0  389    3     1     1    25    4     80
5     0     0    0     2    0  502     0     0     2   13      1
6     2     0    0     2    0    1  1881     7     2    0     13
7     0     0    0    74    1    0     1  7141    41    1      4
8     1     0    0    40    0    4     0    25  3204    1     21
9     0     0    8     0    0   85     0     2     6  392      0
10    0     0    1     5   17    0     1     7    21    0  12739
---- Validation: 
scalar performance:
{'acc': 0.9764879, 'precision': 0.942998, 'recall': 0.9204796, 'specificity': 0.9974288, 'f1': 0.9294647, 'auroc': 0.99949235}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     0    1    0     2     3     1    0     26
1     0  1281    0     4    0    0     0    44     3    0      0
2     0     0  262     0    1    1     0     2     8   37      1
3     1     0    0  8280    0    8     1    78    68    2      2
4     2     0   42     0  382    1     1     1    25    3     82
5     0     0    0     3    1  506     0     0     1   10      0
6     1     0    0     1    0    2  1886     5     4    0      9
7     0     0    1    71    0    0     1  7137    50    0      5
8     0     0    0    41    3    3     0    33  3189    1     26
9     0     0    5     0    0   90     0     0     5  393      0
10    0     0    0     4   20    0     1     9    22    0  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66871893, 'precision': 0.66717446, 'recall': 0.57320374, 'specificity': 0.96672463, 'f1': 0.5464664, 'auroc': 0.8813952}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   875    0   1  45    0    9    54    74    13   71    28
1     0  956   0  37    0    0     3   459     8    0    36
2     6    0  87  14   28   26    12    62   444   54   282
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   2   0  127    0     1     1    19    0  1483
5     2    0   0  65    1  388     0     3    22  110     1
6     6    0   0   8    0    0  2722     3     3    0   325
7     0    0   0  51    0    0     0  1109     2    0     2
8     0    0   0  68    0    2     2    20  1276    0     2
9     3    0  36  97    1  169     4    81   337  379    30
10    0    0   0   0    5    0     2     0     0    0  1639
early stop counter: 1
val acc:0.9764878749847412, best validation acc: 0.9784672856330872, corresponding to test acc:                         0.7095081806182861 / 0.7961939573287964
after epoch: 17,now: 2024-07-09 20:51:27.312744,epoch time: 0:39:26.752415,used: 12:03:49.607822,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9788634, 'precision': 0.95243466, 'recall': 0.9498187, 'specificity': 0.99773, 'f1': 0.9506078, 'auroc': 0.99964935}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    1    0     4     1     0    0      9
1     0  1290    0     1    0    0     0    39     1    0      1
2     0     0  260     0   11    1     0     1     0   37      2
3     1     1    0  8094    0   17     0   234    84    4      0
4     5     0   11     1  478    1     0     0     7    1     34
5     0     0    0     0    0  507     0     0     1   13      0
6     0     0    0     2    0    0  1896     1     1    2      6
7     0     2    0    29    2    0     1  7191    30    1      8
8     0     0    1    19    6    2     0    21  3233    2     11
9     0     0    8     0    0   40     0     1     2  442      0
10    9     0    0     4   24    3     5     3    19    1  12727
---- Validation: 
scalar performance:
{'acc': 0.97774506, 'precision': 0.9482415, 'recall': 0.9455574, 'specificity': 0.99762714, 'f1': 0.94595635, 'auroc': 0.99965894}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    0    0     3     0     0    2      7
1     0  1295    0     0    0    0     0    32     2    0      3
2     0     0  250     0   11    3     0     4     0   44      0
3     0     1    0  8083    0   18     0   243    88    7      0
4     8     0    8     0  468    1     0     0    10    1     43
5     0     0    0     0    0  508     0     0     0   13      0
6     2     1    0     0    0    0  1899     1     1    1      3
7     0     1    1    33    1    0     0  7188    36    0      5
8     0     0    0    10    3    6     0    19  3248    1      9
9     0     0    7     0    0   47     0     1     0  438      0
10   10     0    0     4   32    2     5     6    31    1  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7129364, 'precision': 0.6655534, 'recall': 0.59596634, 'specificity': 0.9709291, 'f1': 0.57701087, 'auroc': 0.8803333}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   667     1   0  76    2   14   178    63    34  115    20
1     2  1247   0  12    0    1     4   184     6    0    43
2     4     1  57  12  218   18    38    68   293  109   197
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  244    0     5     1    18    1  1364
5     0     0   0  72    1  312     1     3    20  183     0
6     0     0   0   6    0    0  2991     0     1    0    69
7     0     0   0   9    0    1     0  1145     7    0     2
8     0     0   0  22    0    5     4    18  1314    2     5
9     2     1  22  65    7   89     3   134   203  583    28
10    0     0   0   0   12    0     3     0     1    0  1630
early stop counter: 2
val acc:0.9777450561523438, best validation acc: 0.9784672856330872, corresponding to test acc:                         0.7095081806182861 / 0.7961939573287964
after epoch: 18,now: 2024-07-09 21:30:48.222260,epoch time: 0:39:20.909516,used: 12:43:10.517338,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9805223, 'precision': 0.93642366, 'recall': 0.9474453, 'specificity': 0.9979685, 'f1': 0.93994856, 'auroc': 0.9996144}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    1    0     3     3     0    1      2
1     0  1306    0     3    0    0     1    20     1    0      1
2     0     0  295     0   10    0     0     0     0    5      1
3     0     0    1  8276    0    5     3   108    46    0      0
4     6     0   31     0  473    0     0     1     6    2     20
5     0     0    4     7    0  481     0     0     4   25      0
6     0     0    1     2    0    0  1895     1     1    2      5
7     0     4    7    62    0    0     1  7165    20    0      4
8     1     0    4    22    2    1     1    35  3224    1      5
9     0     0   66     2    0   36     0     2     1  386      0
10   10     0    4     5   59    0     2     7    31    0  12674
---- Validation: 
scalar performance:
{'acc': 0.98068744, 'precision': 0.9376257, 'recall': 0.9496974, 'specificity': 0.9979821, 'f1': 0.94222677, 'auroc': 0.9995725}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    1     0    0    0     0     2     0    1      1
1     0  1302    0     1    0    0     0    26     2    0      1
2     0     0  297     0    9    0     0     0     0    5      1
3     0     0    0  8290    0    2     0   102    43    3      0
4     5     0   24     0  479    0     0     0     6    3     22
5     0     0    2     6    0  477     0     0     5   31      0
6     6     0    0     0    0    0  1893     2     2    3      2
7     0     4    8    57    0    0     1  7172    20    0      3
8     0     0    3    25    4    0     0    42  3212    1      9
9     0     0   59     3    0   35     0     2     1  393      0
10   11     0    4     5   58    0     7     9    32    0  12670
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7346953, 'precision': 0.67335796, 'recall': 0.6093863, 'specificity': 0.9733901, 'f1': 0.6106633, 'auroc': 0.8853935}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   870     0   13   41    1    2    77    63    13   83     7
1     0  1183    0   19    0    0     1   276     7    0    13
2     5     1  222   12  209    8    14   116   186   65   177
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  492    0     7     3     9    1  1119
5     3     0   13  117    2  225     0     2    19  211     0
6     3     0    0    2    0    0  3053     2     1    0     6
7     0     0    0   26    0    0     2  1134     0    0     2
8     0     0    0   44    0    0    12    23  1286    2     3
9     1     2  165  129    4   54     5   157   135  460    25
10    0     1    0    0   66    0     2     1     0    0  1576
better model found
persisted
after epoch: 19,now: 2024-07-09 22:10:06.783280,epoch time: 0:39:18.561020,used: 13:22:29.078358,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9852847, 'precision': 0.9649936, 'recall': 0.9592557, 'specificity': 0.998418, 'f1': 0.9620424, 'auroc': 0.99977714}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     3    5    0     7     4     1    0      3
1     0  1297    0     2    0    0     0    27     2    0      4
2     0     0  280     0   13    1     0     1     0   16      1
3     0     0    1  8303    0    5     0    54    77    0      0
4     2     0    0     0  496    0     0     0     4    1     36
5     0     0    0     3    0  501     0     0     2   15      0
6     1     0    0     0    0    0  1904     0     0    1      2
7     0     0    3    64    2    0     1  7159    28    1      4
8     1     0    0    31    4    1     0    18  3233    1      4
9     0     0   21     3    1   23     0     0     1  444      0
10    4     0    0     5   16    1     6     1    10    1  12749
---- Validation: 
scalar performance:
{'acc': 0.98427176, 'precision': 0.9640916, 'recall': 0.95641124, 'specificity': 0.99829876, 'f1': 0.9601456, 'auroc': 0.99979335}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     6    4    1     8     2     0    1      5
1     0  1301    0     4    0    0     0    24     1    0      2
2     0     0  282     1   16    0     1     0     0    9      3
3     0     0    1  8305    0    2     0    55    76    1      0
4     2     0    2     1  492    0     1     0     2    0     39
5     0     0    0     4    0  495     0     0     2   20      0
6     0     0    0     2    1    1  1899     0     2    1      2
7     0     1    2    74    0    0     0  7153    30    1      4
8     0     0    0    35    0    1     0    19  3233    1      7
9     0     0   21     2    1   27     0     0     2  440      0
10    3     0    1     7   21    0    11     2    10    0  12741
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69733435, 'precision': 0.6308533, 'recall': 0.5721215, 'specificity': 0.96935594, 'f1': 0.5592293, 'auroc': 0.8715372}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   744     1    0  44    5   10   192    69    19   79     7
1     0  1078    0  24    0    0     5   345    14    0    33
2     2     0  128  10  272    7    24    43   259  106   164
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    0   0  200    0     9     1    18    1  1403
5     1     0    2  66    3  175     2     2     8  332     1
6     0     0    0   2    0    0  3007     5     2    0    51
7     0     0    0  29    0    0     2  1126     4    0     3
8     0     0    0  28    0    0     7    22  1305    5     3
9     1     1  143  72   20   37     9    58   204  569    23
10    0     0    0   0    8    0     2     1     0    0  1635
better model found
persisted
after epoch: 20,now: 2024-07-09 22:49:34.443757,epoch time: 0:39:27.660477,used: 14:01:56.738835,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9834118, 'precision': 0.94920844, 'recall': 0.94370544, 'specificity': 0.998241, 'f1': 0.94501454, 'auroc': 0.9997281}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    1    0     6     1     1    1      5
1     0  1307    0     3    0    0     0    21     1    0      0
2     0     0  267     0    1    6     1     2     4   31      0
3     0     3    0  8403    0    4     0    18    10    0      0
4     5     0   26     0  473    0     0     1     2    5     27
5     0     0    0     2    0  517     0     0     0    2      0
6     1     1    0     2    0    1  1899     0     0    0      4
7     0     3    1   125    0    0     2  7108    19    0      1
8     0     0    0    50    2    2     0    21  3216    1      4
9     0     0    6     2    0  107     0     0     0  378      0
10    4     0    1     6   33    1     6     5    17    1  12721
---- Validation: 
scalar performance:
{'acc': 0.9822656, 'precision': 0.9478006, 'recall': 0.94466305, 'specificity': 0.99811226, 'f1': 0.9450876, 'auroc': 0.99970925}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     1    1    0     2     0     3    1      6
1     0  1308    0     1    0    0     0    19     1    0      3
2     1     0  270     1    0    4     0     4     2   29      1
3     0     0    0  8411    0    3     0    17     9    0      0
4     6     0   31     0  470    2     0     0     6    5     19
5     0     0    0     4    0  513     0     0     0    4      0
6     2     0    0     1    0    0  1897     0     2    0      6
7     1     4    0   141    1    0     1  7086    27    0      4
8     1     0    0    60    1    3     0    22  3204    2      3
9     0     0    4     0    0  101     0     0     1  387      0
10    2     0    0     7   42    0     9    12    17    0  12707
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72469044, 'precision': 0.6801412, 'recall': 0.61832106, 'specificity': 0.97246766, 'f1': 0.61016273, 'auroc': 0.8824064}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   992     2    0   33    0    5    20    59    16   32    11
1     2  1202    0   16    0    1     0   251     6    2    19
2     7     1  209   17  129   22     5    54   232  124   215
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    5    1  256    0     3     2    13    0  1353
5     5     0    0   63    0  337     0     0     6  179     2
6     0     0    0    9    0    0  2899     3     3    0   153
7     0     0    0  101    0    1     0  1058     2    1     1
8     0     0    0   79    0    6     5    18  1256    4     2
9     7     7   67  120    2  171     3    53   158  527    22
10    0     0    0    0   21    0     2     1     0    0  1622
early stop counter: 1
val acc:0.9822655916213989, best validation acc: 0.984271764755249, corresponding to test acc:                         0.697334349155426 / 0.7961939573287964
after epoch: 21,now: 2024-07-09 23:29:07.600643,epoch time: 0:39:33.156886,used: 14:41:29.895721,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9819938, 'precision': 0.9611945, 'recall': 0.93087435, 'specificity': 0.9980172, 'f1': 0.94318247, 'auroc': 0.99976176}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    1    0     0     0     0    0     13
1     0  1304    0     1    0    0     0    24     2    0      1
2     0     0  232     0    8    1     0     1    13   56      1
3     1     0    0  8304    0   10     2    51    68    0      0
4     2     0    8     0  395    0     0     3    23    2    105
5     0     0    0     3    0  508     0     0     3    7      0
6     6     0    0     3    2    0  1886     3     3    1      3
7     0     1    0    72    0    0     0  7148    35    2      5
8     0     0    0    12    0    0     0    10  3263    0     11
9     1     0    2     0    0   45     0     1     4  440      0
10    1     0    2     1    1    0     2     3    30    1  12754
---- Validation: 
scalar performance:
{'acc': 0.9825331, 'precision': 0.9636619, 'recall': 0.93134654, 'specificity': 0.99805975, 'f1': 0.9447086, 'auroc': 0.999756}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    2    0     0     2     0    1     14
1     0  1303    0     3    0    0     0    23     3    0      0
2     2     0  234     0    6    1     0     5     8   55      1
3     1     2    0  8323    0    3     0    41    69    0      1
4     3     0    5     0  399    0     0     2    12    2    116
5     0     0    0     3    0  497     0     0     5   16      0
6     4     0    0     1    0    1  1891     1     5    2      3
7     0     3    0    76    0    0     0  7140    39    1      6
8     0     0    0    14    0    1     0     7  3268    0      6
9     0     0    2     1    0   36     0     0     3  450      1
10    1     0    3     2    2    0     1     5    19    0  12763
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7190233, 'precision': 0.6395962, 'recall': 0.60707074, 'specificity': 0.9715841, 'f1': 0.57540524, 'auroc': 0.878485}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1045     1   0   4    0    0    17    45    10   15    33
1      2  1288   0   6    0    0     0   168    13    0    22
2      8     1  78   2  117    7     0    65   437   69   231
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0   76    0     4     1    34    0  1517
5     10     0   2  30    4  295     0     2    49  195     5
6      2     0   0   1    0    0  2925     3     2    0   134
7      0     0   0   8    0    0     1  1149     4    0     2
8      0     0   0  13    0    0     2    13  1340    1     1
9     14     2  55  22   15   92     1    73   392  443    28
10     0     0   0   0    6    0     2     0     0    0  1638
early stop counter: 2
val acc:0.9825330972671509, best validation acc: 0.984271764755249, corresponding to test acc:                         0.697334349155426 / 0.7961939573287964
after epoch: 22,now: 2024-07-10 00:10:52.396659,epoch time: 0:41:44.796016,used: 15:23:14.691737,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9825824, 'precision': 0.94592124, 'recall': 0.96501863, 'specificity': 0.99817926, 'f1': 0.9548452, 'auroc': 0.9997838}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    1     0    4    0     0     0     0    1      3
1     0  1315    0     2    0    0     0    13     2    0      0
2     0     0  283     0   17    0     0     0     0    9      1
3     5     0    0  8315    0   10     0    66    34    6      1
4     2     0    4     0  517    0     0     0     4    0     12
5     0     0    0    10    0  497     0     0     1   13      0
6    32     0    2     3    6    2  1827     5     4    0     27
7     1     5    7    47    0    0     0  7122    69    8      6
8     0     0    1    33    4    0     0     7  3240    4      7
9     0     0   16     0    0   22     0     0     0  455      0
10    9     0    4     6   73    2     0     1    16    1  12680
---- Validation: 
scalar performance:
{'acc': 0.98296106, 'precision': 0.9516875, 'recall': 0.9681193, 'specificity': 0.9981867, 'f1': 0.9593526, 'auroc': 0.9997499}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    1     0    1    0     0     0     0    0      0
1     0  1312    0     4    0    0     0    14     2    0      0
2     0     0  287     0   20    0     0     0     0    5      0
3     4     0    1  8314    0   10     0    64    39    8      0
4     4     0    4     0  503    1     0     0     4    0     23
5     0     0    0     5    0  509     0     0     2    5      0
6    31     0    2     0    5    0  1824     2     4    1     39
7     0     2    4    55    4    0     0  7130    61    5      4
8     3     0    2    39    5    0     0     7  3225    2     13
9     0     0   14     0    0   13     0     0     0  466      0
10    7     0    2     4   70    1     0     0    14    1  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6631918, 'precision': 0.66035986, 'recall': 0.59242105, 'specificity': 0.96607614, 'f1': 0.5849406, 'auroc': 0.87572396}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1048     0    3  25    1    1     1    42    16   23    10
1      7  1231    0  24    1    0     0   203     9    0    24
2     11     1  150  14  275    9     0    24   286  105   140
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    0   0  407    0     0     1    22    2  1201
5     14     0    7  91    1  238     0     0    14  225     2
6     52     0    2  18   19    0  1776     3    59    2  1136
7      0     0    1  16    0    0     0  1124    18    2     3
8      1     0    0  85    0    2     1     6  1268    6     1
9     17     1   95  88   20   66     0    33   161  630    26
10     0     0    0   0   39    0     0     0     0    0  1607
early stop counter: 3
val acc:0.9829610586166382, best validation acc: 0.984271764755249, corresponding to test acc:                         0.697334349155426 / 0.7961939573287964
after epoch: 23,now: 2024-07-10 00:51:27.210287,epoch time: 0:40:34.813628,used: 16:03:49.505365,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.985793, 'precision': 0.9600323, 'recall': 0.9595139, 'specificity': 0.9985136, 'f1': 0.9583525, 'auroc': 0.9998189}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     1    0     0    5    0     0     0     0    1      2
1     0  1326    0     1    0    0     0     4     1    0      0
2     0     1  289     0    3    1     0     3     2   12      1
3     0     1    0  8312    0    2     0    82    40    0      0
4     2     0   16     0  492    0     1     0     7    1     19
5     0     0    0     8    0  423     0     0     3   87      0
6    11     2    0     1    0    0  1888     4     1    0      1
7     1     5    0    35    1    0     1  7208     8    0      5
8     1     0    1    15    1    0     0    24  3248    0      6
9     0     0    5     1    0    1     0     1     1  483      1
10    7     0    0     6   27    0    18     6    26    0  12702
---- Validation: 
scalar performance:
{'acc': 0.9853952, 'precision': 0.95930386, 'recall': 0.9594582, 'specificity': 0.99847543, 'f1': 0.9585159, 'auroc': 0.9998015}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    5    1     2     2     1    1      5
1     0  1325    0     0    0    0     0     6     1    0      0
2     0     0  290     0    1    0     0     0     3   17      1
3     0     0    0  8316    0    1     1    75    47    0      0
4     2     0   16     0  488    0     3     2    10    0     18
5     0     0    0     8    0  442     0     1     1   69      0
6    10     0    0     5    0    0  1889     1     1    0      2
7     1     8    0    27    0    0     2  7211    12    0      4
8     1     0    0    16    0    0     0    31  3243    1      4
9     0     0    6     2    0    5     0     1     2  477      0
10   10     1    1     5   31    1    19     8    27    1  12692
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72650945, 'precision': 0.68109155, 'recall': 0.59848773, 'specificity': 0.9724822, 'f1': 0.5825491, 'auroc': 0.88050365}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   929     3   0  31    0    0    15   136    19   30     7
1     1  1296   0  15    0    0     3   153     3    0    28
2     6     2  81   8  182    5    10    91   317   92   221
3     0     0   0   0    0    0     0     0     0    0     0
4     0     1   0   0  373    0     8     2    32    1  1216
5     6     0   0  68    1  151     0     7    28  330     1
6     5     1   0   8    1    0  2949     1     3    0    99
7     1     0   0  27    0    0     1  1131     0    1     3
8     1     0   0  35    0    0     5    37  1285    3     4
9     6     8  33  70    9   28     5   144   216  590    28
10    0     0   0   0   40    0     6     1     0    0  1599
better model found
persisted
after epoch: 24,now: 2024-07-10 01:31:01.560222,epoch time: 0:39:34.349935,used: 16:43:23.855300,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98410743, 'precision': 0.9682464, 'recall': 0.9429629, 'specificity': 0.9981792, 'f1': 0.95311856, 'auroc': 0.99980974}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    1     1    0    0     5     0     0    0     29
1     0  1325    0     1    0    0     1     3     1    0      1
2     0     0  301     0    2    0     2     2     0    1      4
3     1     0    0  8382    0    0     5    20    29    0      0
4     5     0    8     0  398    0     0     0     6    1    121
5     0     0    2     6    1  505     0     0     2    4      1
6     3     0    0     1    0    1  1900     0     0    0      3
7     0     9    0   102    0    0     5  7077    57    0     14
8     1     0    0    14    2    1     2     2  3262    0     11
9     1     0   33     6    1   39     1     2     1  408      1
10    1     0    0     1    3    0     4     0     6    0  12777
---- Validation: 
scalar performance:
{'acc': 0.9837635, 'precision': 0.9679937, 'recall': 0.94188505, 'specificity': 0.9981369, 'f1': 0.95251733, 'auroc': 0.9997904}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     0    0    0     2     0     0    0     28
1     0  1323    0     1    0    0     0     4     3    0      1
2     0     0  296     0    8    0     1     0     2    2      3
3     0     0    0  8385    0    0     5    22    27    1      0
4     4     0    8     0  392    0     0     3     9    0    123
5     0     0    0     2    0  511     0     0     5    2      1
6     5     0    0     0    0    0  1899     0     1    0      3
7     0    12    0    98    1    0     5  7077    61    0     11
8     0     0    0    14    2    0     2     4  3255    0     19
9     2     0   34     4    0   35     0     2     5  406      5
10    1     0    1     1    4    0     1     4     3    0  12781
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69558525, 'precision': 0.62156993, 'recall': 0.58527935, 'specificity': 0.969425, 'f1': 0.56762, 'auroc': 0.869728}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1005     5    0   24    0    2    29   29    39    4    33
1      1  1230    0   10    0    0     4  201    10    0    43
2     11     1  156    8  185   17    10   50   294   37   246
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    3    1   69    0     3    1    22    0  1534
5     13     0   13   69    2  324     2    0    27  131    11
6      3     0    1    5    2    0  2923    0     2    0   131
7      0     0    0  196    0    0     5  956     5    0     2
8      1     1    0   40    0    2     4    6  1311    1     4
9     26     4  138   85   18  121     9   80   297  325    34
10     0     0    0    0    1    0     2    0     0    0  1643
early stop counter: 1
val acc:0.9837635159492493, best validation acc: 0.9853951930999756, corresponding to test acc:                         0.7265094518661499 / 0.7961939573287964
after epoch: 25,now: 2024-07-10 02:11:15.159287,epoch time: 0:40:13.599065,used: 17:23:37.454365,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9843215, 'precision': 0.96000946, 'recall': 0.9684846, 'specificity': 0.99833035, 'f1': 0.96376884, 'auroc': 0.9998348}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     1    0     0    2    0     0     0     1    1      7
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  301     0    0    0     0     0     0   10      1
3     1     2    0  8393    0    2     0    27    11    2      0
4     4     0   24     0  488    0     0     1     6    1     15
5     0     0    0     4    0  493     0     0     1   23      0
6     4     0    0     0    1    1  1888     0     2    2     10
7     1   107    3    97    1    0     3  7027    16    0      7
8     0     0    0    73    3    1     0    15  3192    0     10
9     0     0   16     1    0   10     0     0     0  466      0
10    2     0    3     2   18    0     0     1    29    0  12739
---- Validation: 
scalar performance:
{'acc': 0.98371005, 'precision': 0.9596657, 'recall': 0.96686023, 'specificity': 0.9982567, 'f1': 0.9627962, 'auroc': 0.9998254}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    2    0     0     0     0    0     15
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  304     0    0    0     0     0     0    6      2
3     1     3    0  8390    0    4     1    33     6    0      2
4     5     0   32     0  481    0     0     1    10    0     10
5     0     0    0     6    1  491     0     0     0   23      0
6     3     2    1     1    1    1  1879     1     3    2     14
7     1   101    2    98    1    0     1  7034    20    3      4
8     0     0    0    67    1    2     0    18  3197    1     10
9     0     0    8     2    1   12     0     0     2  468      0
10    1     0    0     4   24    0     0     5    28    0  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74539983, 'precision': 0.6998911, 'recall': 0.62461096, 'specificity': 0.97460634, 'f1': 0.62227845, 'auroc': 0.8823631}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1065     1    0   21    0    0    10    29     6   31     7
1      1  1394    0   16    0    0     0    58     5    2    23
2      6     2  206   24   67   13     5    73   399  127    93
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0   12    0  463    0     4     1    57    0  1096
5      3     0    0   87    1  169     0     0    11  320     1
6      5     2    2    5    1    0  2839     3    40    0   170
7      0     0    0   57    0    0     0  1103     2    1     1
8      1     0    0  128    0    3     3     9  1222    3     1
9     11    10   65  147    1   68     1    57   168  592    17
10     0     0    0    0   44    0     0     0     1    0  1601
early stop counter: 2
val acc:0.9837100505828857, best validation acc: 0.9853951930999756, corresponding to test acc:                         0.7265094518661499 / 0.7961939573287964
after epoch: 26,now: 2024-07-10 02:52:57.547825,epoch time: 0:41:42.388538,used: 18:05:19.842903,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98555225, 'precision': 0.9730409, 'recall': 0.9546801, 'specificity': 0.99834394, 'f1': 0.96282053, 'auroc': 0.99983495}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    1     2    1    0     0     0     1    0      9
1     0  1283    0     2    0    0     0    41     3    0      1
2     0     0  308     0    1    0     0     1     0    0      2
3     0     0    0  8395    0    1     0    33     9    0      1
4     5     0    4     1  455    0     0     3     3    2     66
5     0     0    0    23    0  478     0     0     0   19      1
6     3     0    0     3    0    0  1894     3     0    1      4
7     0     0    1    91    0    0     0  7158     5    0      7
8     0     0    0    50    5    0     1    42  3188    0     10
9     2     0   38     4    1    6     1     3     2  432      3
10    1     0    1     0    4    0     2     4     6    0  12776
---- Validation: 
scalar performance:
{'acc': 0.9872676, 'precision': 0.9741492, 'recall': 0.95756066, 'specificity': 0.9985415, 'f1': 0.9649102, 'auroc': 0.9998783}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    1    0     2     1     0    0     10
1     0  1289    0     3    0    0     0    34     3    0      3
2     0     0  305     0    3    0     0     0     1    2      1
3     0     0    1  8400    0    0     0    31     8    0      0
4     4     0    2     0  456    0     0     1     5    1     70
5     0     0    3    14    0  479     0     0     2   21      2
6     4     0    0     2    0    0  1894     3     1    0      4
7     0     1    0    70    1    0     0  7188     1    0      4
8     0     0    0    36    2    0     1    40  3207    0     10
9     0     0   39     2    0    2     0     4     0  445      1
10    1     0    2     0    5    0     3     3     5    0  12777
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6498985, 'precision': 0.63620055, 'recall': 0.5243754, 'specificity': 0.96491617, 'f1': 0.50925606, 'auroc': 0.8694087}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   870    1   0   72    2    0    54   108    23    3    37
1     4  951   0   31    0    0     5   441     6    0    61
2    15    0  89   32  100    3    21   120   166   36   433
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0  131    0     2     3    15    0  1482
5    12    0   9  174    0  108     3     2    19  233    32
6     2    0   0    8    0    0  2866     4     1    0   186
7     2    0   0   89    0    0     0  1070     1    0     2
8     0    0   0   71    1    0    10    34  1246    2     6
9    24    0  91  193   14   14    16   183   171  320   111
10    0    0   0    0    6    0     2     0     0    0  1638
better model found
persisted
after epoch: 27,now: 2024-07-10 03:35:34.570689,epoch time: 0:42:37.022864,used: 18:47:56.865767,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9838934, 'precision': 0.94912696, 'recall': 0.94286245, 'specificity': 0.99831206, 'f1': 0.9403017, 'auroc': 0.9997802}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    2    0     0     0     0    1     14
1     0  1318    0     1    0    0     0    11     0    0      0
2     0     0  289     0   20    0     0     0     1    2      0
3     1     1    0  8372    0    6     0    33    19    8      0
4     2     0    0     0  511    0     0     0     2    0     22
5     0     0    0     3    1  327     0     0     1  189      0
6     5     0    0     0    0    0  1889     0     1    1     12
7     1     2    6    68    0    0     3  7141    30    5      8
8     1     0    1    20   10    0     3    10  3224    5     22
9     0     0   15     0    0    0     0     0     0  478      0
10    1     0    0     2   18    0     1     2     8    1  12759
---- Validation: 
scalar performance:
{'acc': 0.984138, 'precision': 0.94878465, 'recall': 0.9415443, 'specificity': 0.9983487, 'f1': 0.9393703, 'auroc': 0.99978274}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    4    0     3     0     0    0     17
1     0  1325    0     0    0    0     0     6     1    0      0
2     0     0  288     0   22    0     0     0     0    1      1
3     1     0    1  8387    0    3     0    22    16    9      1
4     1     0    2     0  517    0     0     1     1    0     17
5     0     0    0     3    2  325     0     0     0  190      1
6     2     0    0     0    0    0  1900     0     1    0      5
7     2     7    4    76    1    0     4  7126    37    4      4
8     0     0    0    23    8    0     3     5  3233    3     21
9     0     0   19     0    0    0     0     0     0  472      2
10    1     2    0     2   18    0     2     2     9    0  12760
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70712936, 'precision': 0.67885125, 'recall': 0.569951, 'specificity': 0.97052526, 'f1': 0.5588243, 'auroc': 0.8711125}
confusion matrix:
     0     1    2    3    4   5     6    7     8    9     10
0   859     5    1   84    1   1    67   21    28   53    50
1     6  1286    0   22    1   0    19  115    19    6    25
2     3     2  108    7  335   0     7   20   167  142   224
3     0     0    0    0    0   0     0    0     0    0     0
4     0     1    0    0  321   0     3    0    21    2  1285
5     2     0    4   56    5  32     3    0     5  476     9
6     0     0    0    3    2   0  2952    0     3    0   107
7     2     2    6  196    0   0    14  919     5   14     6
8     0     0    3   60   12   0    23    2  1219   20    31
9     6     4   74   60   22   1     8   17   126  786    33
10    0     0    0    0   21   0     0    0     0    0  1625
early stop counter: 1
val acc:0.984138011932373, best validation acc: 0.9872676134109497, corresponding to test acc:                         0.6498985290527344 / 0.7961939573287964
after epoch: 28,now: 2024-07-10 04:15:23.653046,epoch time: 0:39:49.082357,used: 19:27:45.948124,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9891642, 'precision': 0.9680873, 'recall': 0.96856666, 'specificity': 0.9988418, 'f1': 0.9679484, 'auroc': 0.99986553}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     1    5    0     3     1     1    0      3
1     0  1326    0     0    0    0     0     4     0    0      0
2     0     0  280     0   10    0     0     0     1   19      2
3     0     0    0  8362    1   39     0    27     9    2      0
4     1     0    3     0  490    0     0     0     5    0     40
5     0     0    0     1    0  508     0     0     0   12      0
6     1     0    0     1    0    0  1893     1     2    1      8
7     0     1    2    42    1    4     1  7149    53    6      4
8     0     1    1    21    2    6     0     3  3253    2      6
9     1     0    5     0    0   18     0     0     0  469      0
10    3     0    2     2    6    1     1     0     6    0  12772
---- Validation: 
scalar performance:
{'acc': 0.9889795, 'precision': 0.97147083, 'recall': 0.9689243, 'specificity': 0.9987891, 'f1': 0.96983826, 'auroc': 0.999895}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     1    6    0     4     1     1    1      7
1     0  1326    0     2    0    0     0     4     0    0      0
2     0     0  289     0    2    0     0     0     1   19      1
3     0     0    0  8367    0   35     0    26    10    2      0
4     1     1    3     0  484    1     0     0     1    0     48
5     0     0    0     1    0  512     0     0     0    8      0
6     0     0    0     3    0    0  1883     3     1    0     18
7     0     4    9    54    0    0     1  7147    41    2      7
8     0     0    0    23    0    4     0     5  3262    1      1
9     0     0    5     0    0   18     1     0     1  468      0
10    1     0    1     3    8    2     0     1     7    0  12773
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7113272, 'precision': 0.6460376, 'recall': 0.6124352, 'specificity': 0.9710703, 'f1': 0.586594, 'auroc': 0.8717079}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   960     1    1   41    1    9    55    49    24   14    15
1     1  1315    0   24    0    1     0   130     2    0    26
2     3     1  109   20  134   53    13    47   363   79   193
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  129    0     1     0    39    0  1462
5     2     0    2   43    1  410     1     1     3  127     2
6     0     0    0   41    0    0  2813     5    16    0   192
7     0     0    1   42    0    1     0  1115     0    1     4
8     0     0    0   91    1   22     3    11  1236    3     3
9     8     7   76  113   16  262     5    62   122  438    28
10    0     0    0    0    4    0     0     0     0    0  1642
better model found
persisted
after epoch: 29,now: 2024-07-10 04:54:47.328290,epoch time: 0:39:23.675244,used: 20:07:09.623368,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98951197, 'precision': 0.97015685, 'recall': 0.97453094, 'specificity': 0.99890774, 'f1': 0.97155285, 'auroc': 0.9999037}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     2    5    0     2     0     0    0      7
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  301     1    9    0     0     0     1    0      0
3     0     1    0  8381    0    3     0    38    16    0      0
4     1     0    2     1  527    0     0     0     1    0      7
5     0     0    0     0    0  518     0     0     2    1      0
6     1     0    0     1    1    0  1899     0     1    0      5
7     0     9    0    41    2    0     0  7143    65    0      3
8     0     3    0    16    3    1     0     6  3260    0      5
9     0     0   25     0    3   37     1     0     3  424      0
10    4     0    0     4   35    0     1     3    12    0  12733
---- Validation: 
scalar performance:
{'acc': 0.98884577, 'precision': 0.9667282, 'recall': 0.97288173, 'specificity': 0.99884456, 'f1': 0.9689877, 'auroc': 0.99990976}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    1     1    5    0     3     0     0    0      7
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  298     1   10    0     0     0     1    1      1
3     0     1    0  8382    0    5     0    36    16    0      0
4     2     0    3     0  525    0     0     0     2    0      7
5     0     0    0     3    0  514     0     0     1    2      1
6     0     0    0     2    1    0  1897     1     4    1      2
7     0    11    0    55    3    0     0  7135    60    0      1
8     0     2    0    19    3    0     0     7  3264    0      1
9     0     0   23     2    5   32     0     0     3  428      0
10    1     1    2     3   56    0     0     0     4    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7349052, 'precision': 0.66139746, 'recall': 0.6235864, 'specificity': 0.97336066, 'f1': 0.6083349, 'auroc': 0.87776375}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   922     3    2   50   13   14    47    44    41   14    20
1     1  1302    0   14    1    0     1   155    10    0    15
2     5     2  125    9  346   29    12    29   309   50    99
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  394    0     4     0    25    1  1206
5     3     0    1   65    6  390     1     0    15  106     5
6     3     2    0    4    1    0  2975     0    10    0    72
7     0     0    2   22    0    1     0  1132     5    0     2
8     0     0    0   53    1    4     3     4  1303    2     0
9     9    10   79  103   42  189     5    37   294  348    21
10    0     0    0    0   31    0     1     1     0    0  1613
early stop counter: 1
val acc:0.9888457655906677, best validation acc: 0.9889795184135437, corresponding to test acc:                         0.7113271951675415 / 0.7961939573287964
after epoch: 30,now: 2024-07-10 05:34:12.694277,epoch time: 0:39:25.365987,used: 20:46:34.989355,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:46:34.989355 at 2024-07-10 05:34:12.694277
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7113272, 'precision': 0.6460376, 'recall': 0.6124352, 'specificity': 0.9710703, 'f1': 0.586594, 'auroc': 0.8717079}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   960     1    1   41    1    9    55    49    24   14    15
1     1  1315    0   24    0    1     0   130     2    0    26
2     3     1  109   20  134   53    13    47   363   79   193
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  129    0     1     0    39    0  1462
5     2     0    2   43    1  410     1     1     3  127     2
6     0     0    0   41    0    0  2813     5    16    0   192
7     0     0    1   42    0    1     0  1115     0    1     4
8     0     0    0   91    1   22     3    11  1236    3     3
9     8     7   76  113   16  262     5    62   122  438    28
10    0     0    0    0    4    0     0     0     0    0  1642
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.79619396, 'precision': 0.73326653, 'recall': 0.69575596, 'specificity': 0.9794889, 'f1': 0.6873844, 'auroc': 0.89293456}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1052     3    4  12    1    3    29    13     1   44     8
1      1  1335    0   5    0    0     0   141     1    0    16
2      9     1  607   0   53   10     3    69   109   53   101
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0   26   0  323    0     1     2    13    1  1267
5      3     0    9  22    0  393     1     0     7  156     1
6      0     0    0   1    0    0  3047     4     0    0    15
7      0     0    0   3    0    0     0  1159     0    1     1
8      0     0    6  45    1    9     4    29  1268    1     7
9      5     8  239  27    1  100     0    95    82  570    10
10     0     0    1   0   17    0     1     1     0    0  1626
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_47_37_seed_1_21725673_instance_wise_predictions.txt
accuracy from prediction file 0.7113272231162108
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457979 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool | 414728 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |  43251 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457979 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool | 414728 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |  43251 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   6803 MiB |   2812 TiB |   2812 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   2779 TiB |   2779 TiB |
|       from small pool |  41979 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7498 MiB |   7504 MiB |  14102 MiB |   6604 MiB |
|       from large pool |   7434 MiB |   7440 MiB |  14024 MiB |   6590 MiB |
|       from small pool |     64 MiB |     64 MiB |     78 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 434948 KiB | 687911 KiB |   2060 TiB |   2060 TiB |
|       from large pool | 429048 KiB | 678614 KiB |   2026 TiB |   2026 TiB |
|       from small pool |   5900 KiB |  40958 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    8370    |  473859 K  |  473855 K  |
|       from large pool |     187    |     783    |  261201 K  |  261200 K  |
|       from small pool |    4369    |    8141    |  212658 K  |  212654 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    8370    |  473859 K  |  473855 K  |
|       from large pool |     187    |     783    |  261201 K  |  261200 K  |
|       from small pool |    4369    |    8141    |  212658 K  |  212654 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     343    |     343    |     623    |     280    |
|       from large pool |     311    |     311    |     584    |     273    |
|       from small pool |      32    |      32    |      39    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      58    |    1636    |  314941 K  |  314941 K  |
|       from large pool |      35    |     311    |  204229 K  |  204229 K  |
|       from small pool |      23    |    1601    |  110711 K  |  110711 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |      0 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |      0 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2812 TiB |   2812 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |   7504 MiB |  14102 MiB |  13230 MiB |
|       from large pool |    824 MiB |   7440 MiB |  14024 MiB |  13200 MiB |
|       from small pool |     48 MiB |     64 MiB |     78 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 687911 KiB |   2060 TiB |   2060 TiB |
|       from large pool |  24320 KiB | 678614 KiB |   2026 TiB |   2026 TiB |
|       from small pool |      0 KiB |  40958 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8370    |  473859 K  |  473859 K  |
|       from large pool |       2    |     783    |  261201 K  |  261201 K  |
|       from small pool |       0    |    8141    |  212658 K  |  212658 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8370    |  473859 K  |  473859 K  |
|       from large pool |       2    |     783    |  261201 K  |  261201 K  |
|       from small pool |       0    |    8141    |  212658 K  |  212658 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     343    |     623    |     562    |
|       from large pool |      37    |     311    |     584    |     547    |
|       from small pool |      24    |      32    |      39    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1636    |  314942 K  |  314942 K  |
|       from large pool |       3    |     311    |  204229 K  |  204229 K  |
|       from small pool |       0    |    1601    |  110713 K  |  110713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |      0 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |      0 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2812 TiB |   2812 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |   7504 MiB |  14102 MiB |  13230 MiB |
|       from large pool |    824 MiB |   7440 MiB |  14024 MiB |  13200 MiB |
|       from small pool |     48 MiB |     64 MiB |     78 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 687911 KiB |   2060 TiB |   2060 TiB |
|       from large pool |  24320 KiB | 678614 KiB |   2026 TiB |   2026 TiB |
|       from small pool |      0 KiB |  40958 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8370    |  473859 K  |  473859 K  |
|       from large pool |       2    |     783    |  261201 K  |  261201 K  |
|       from small pool |       0    |    8141    |  212658 K  |  212658 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8370    |  473859 K  |  473859 K  |
|       from large pool |       2    |     783    |  261201 K  |  261201 K  |
|       from small pool |       0    |    8141    |  212658 K  |  212658 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     343    |     623    |     562    |
|       from large pool |      37    |     311    |     584    |     547    |
|       from small pool |      24    |      32    |      39    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1636    |  314942 K  |  314942 K  |
|       from large pool |       3    |     311    |  204229 K  |  204229 K  |
|       from small pool |       0    |    1601    |  110713 K  |  110713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_06_10_52_seed_2_21725673

 Experiment start at: 2024-07-10 06:10:52.534788
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9192262, 'precision': 0.8395825, 'recall': 0.7318899, 'specificity': 0.9908225, 'f1': 0.7635683, 'auroc': 0.9932233}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   359     0   0     8    1    0     6    16     3    5     85
1     0  1145   0    20    0    0     0   155     6    0      6
2     3     0  36     9  142    2     3    48    12   52      5
3     0     0   0  7833    0    6     0   526    72    1      0
4     2     0   1     2  274    1     0    10    44    5    200
5     1     0   1    95    2  295     0     1    10  113      3
6    42     0   0    18    5    1  1692    11     9    3    126
7     1     2   0   162    2    0     1  7052    33    1     11
8     0     0   0   288    4    0     1   227  2677    2     97
9     3     0  15    33   20   55     0    29     4  330      4
10    5     1   0     9   32    1     2    43    32    1  12664
---- Validation: 
scalar performance:
{'acc': 0.9200482, 'precision': 0.84674335, 'recall': 0.7316123, 'specificity': 0.9909277, 'f1': 0.7626078, 'auroc': 0.99280465}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   358     0   0    11    0    0     3    14     3    5     89
1     0  1150   0    18    1    0     0   150     5    0      8
2     3     0  36     6  131    4     1    47    17   61      6
3     0     0   0  7850    0    3     0   512    74    0      1
4     2     0   0     4  283    1     0    12    39    6    192
5     1     0   0    91    1  290     0     0     8  129      1
6    44     0   0    25    7    0  1679    10    12    6    125
7     0     5   0   172    2    0     0  7041    34    0     11
8     1     0   0   273    7    0     0   221  2705    0     89
9     8     0  10    25   11   60     0    34    16  323      6
10    5     1   0    12   27    1     5    42    18    4  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49954525, 'precision': 0.55841386, 'recall': 0.46594954, 'specificity': 0.9495887, 'f1': 0.43465358, 'auroc': 0.86292684}
confusion matrix:
     0    1   2    3   4    5    6     7     8    9     10
0   902    0   0   50   0    0   15   154     9   17    23
1     0  847   0   29   0    0    0   590     5    0    28
2     2    0   0   12  87    4    0   345   133   89   343
3     0    0   0    0   0    0    0     0     0    0     0
4     1    0   0    0  36    0    0     5    10    0  1581
5     5    0   0  149   1  190    0     4    10  230     3
6     0    0   0    1   5    0  820    27    35    0  2179
7     0    0   0    7   0    0    0  1155     0    0     2
8     1    0   0  126   1    1    0    89  1144    2     6
9    10    1   0  125   3   25    0   498    47  400    28
10    0    0   0    0   0    0    0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 06:52:49.802587,epoch time: 0:41:57.267799,used: 0:41:57.267799,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_06_10_52_seed_2_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9454998, 'precision': 0.8661357, 'recall': 0.82843345, 'specificity': 0.99419934, 'f1': 0.8399208, 'auroc': 0.9970298}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     0    0     6    2    0    36     4    10    4     36
1     0  1280    0    13    0    0     0    27     9    0      3
2     1     0  160     1   35    6     1     9    11   85      3
3     0     2    1  7986    0   35     0   153   260    0      0
4     3     1   22     0  308    5     4     2    37    9    148
5     0     0    0    12    0  479     3     0     9   17      1
6     6     0    0     9    1    0  1867     3     9    1     12
7     0    38    1   219    1    0     1  6824   171    3      5
8     0     2    0    57   10    8     0    39  3142    8     28
9     2     1   14     4    3  179     6     2    13  268      0
10   14     3    4     7   37    2    25    13    48    2  12640
---- Validation: 
scalar performance:
{'acc': 0.94583386, 'precision': 0.8751632, 'recall': 0.8313345, 'specificity': 0.99420106, 'f1': 0.84483075, 'auroc': 0.99684334}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    0     7    2    1    31     3     8    2     42
1     0  1284    0     8    0    0     0    28    11    0      1
2     1     1  159     1   30    7     1    13    11   86      2
3     1     1    0  7964    0   28     0   162   284    0      0
4     3     1   22     0  297    5     1     3    41    8    158
5     0     0    0     9    0  486     2     0     5   18      1
6     5     0    1     5    2    0  1871     5     9    0     10
7     0    33    0   229    2    0     1  6817   172    3      8
8     0     0    0    54   10    8     0    30  3160    3     31
9     2     0    8     6    3  170     4     7     9  284      0
10    8     3    1     8   39    2    26    13    45    0  12651
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72049254, 'precision': 0.68326324, 'recall': 0.6127695, 'specificity': 0.971648, 'f1': 0.5820056, 'auroc': 0.8877757}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   932     0   0  23    0    1   166    24    12    5     7
1     0  1381   0  19    0    0     0    90     5    0     4
2     9    16  50   4   97   11     7   153   306  106   256
3     0     0   0   0    0    0     0     0     0    0     0
4     3     6   0   0  127    0     1     2    12    0  1482
5     6     0   0  72    0  365     7     1    35  105     1
6     0     0   0   1    1    0  2892     1    14    0   158
7     0     3   0   7    0    0     0  1152     1    0     1
8     0     0   0  30    1    0     2    13  1319    1     4
9    16    21  10  53    3   96     9   212   257  441    19
10    0     1   0   0    6    0     0     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 07:32:22.417166,epoch time: 0:39:32.614579,used: 1:21:29.882378,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_06_10_52_seed_2_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93236303, 'precision': 0.8640615, 'recall': 0.8437312, 'specificity': 0.99266404, 'f1': 0.8501204, 'auroc': 0.9969897}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     2    2    0     1     7     5    0     22
1     0  1264    0     3    0    0     0    53     7    0      5
2     4     0  178     0   60    3     1    16    12   28     10
3     7     2    0  7188    1   37     5   901   295    2      0
4     9     0   12     0  347    2     1     4    28    1    135
5     1     0    0     6    2  455     0     0    10   45      1
6    29     0    1     3    1    1  1836     2    13    0     22
7     0    12    0    54    1    0     1  7095    88    1     10
8     1     1    3    45   11    4     0    89  3103    1     36
9     9     0   51     7    7   89     1    10    18  297      4
10   35     0    2     5   39    2    10    21    40    0  12641
---- Validation: 
scalar performance:
{'acc': 0.93521464, 'precision': 0.8633316, 'recall': 0.8443434, 'specificity': 0.99297523, 'f1': 0.85097075, 'auroc': 0.99684876}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     1    0    0     6     5     2    1     26
1     0  1265    0     4    1    0     0    53     7    0      2
2     4     0  179     0   67    2     1    12    14   27      6
3     2     2    0  7255    0   38     3   878   261    0      1
4     7     0    8     0  346    3     0     5    25    2    143
5     4     0    0    18    2  436     0     0     8   52      1
6    29     0    1     0    0    0  1833     5    14    0     26
7     0    12    0    55    2    0     1  7103    86    1      5
8     2     0    3    44   15    2     0    70  3132    0     28
9    17     0   59     0    4   80     2     8    10  312      1
10   33     1    0     6   50    2     6    13    25    0  12660
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7331561, 'precision': 0.636327, 'recall': 0.6311474, 'specificity': 0.97301257, 'f1': 0.58786225, 'auroc': 0.8841884}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1140     0   0   2    0    2    13     7     4    1     1
1      0  1206   0   7    0    0     0   259    10    0    17
2     42     1  79   1  189   22    11    85   253   45   287
3      0     0   0   0    0    0     0     0     0    0     0
4      4     0   0   0   79    0     1     1    10    0  1538
5     13     0   0  21    0  463     2     3    37   53     0
6      2     0   0   1    0    0  3036     2     1    0    25
7      0     0   0   1    0    1     1  1156     4    0     1
8      0     0   0   7    0    3     3    15  1340    0     2
9     50     2  84   7    7  140     8   233   236  336    34
10     0     0   0   0    1    0     0     1     0    0  1644
new oracle model saved
early stop counter: 1
val acc:0.935214638710022, best validation acc: 0.9458338618278503, corresponding to test acc:                         0.7204925417900085 / 0.7331560850143433
after epoch: 3,now: 2024-07-10 08:12:07.857658,epoch time: 0:39:45.440492,used: 2:01:15.322870,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_06_10_52_seed_2_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9484429, 'precision': 0.8944185, 'recall': 0.8441289, 'specificity': 0.99430376, 'f1': 0.8621399, 'auroc': 0.9974511}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    0     6    0    0    16     8     2    3     61
1     0  1274    0     3    0    0     0    51     1    0      3
2     2     0  155     0   34    1     2     5     5  106      2
3     2     1    0  7878    0   10     3   476    60    6      0
4     2     0   12     0  349    2     2     2    17   19    134
5     1     0    0    30    1  398     0     0     1   89      1
6     6     0    1     1    1    0  1872     2     1    0     24
7     0    17    0    62    3    0     1  7135    35    3      8
8     0     1    0   178   10    2     0   132  2931   11     31
9     0     0   14     6    0   53     1     1     1  416      1
10    1     1    2     5   50    0    16    16    43    4  12654
---- Validation: 
scalar performance:
{'acc': 0.94891, 'precision': 0.8948809, 'recall': 0.84408176, 'specificity': 0.9943622, 'f1': 0.8619473, 'auroc': 0.99750364}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   381     0    0     6    0    0    16     8     1    4     67
1     0  1275    0     6    0    0     0    49     1    0      1
2     3     0  154     1   39    1     2     9     1   99      3
3     1     4    0  7912    0   10     5   449    54    5      0
4     3     0   12     0  346    1     3     2    23   17    132
5     1     0    0    25    1  395     0     0     2   96      1
6     5     0    0     0    0    0  1882     1     4    1     15
7     0    18    1    73    1    0     1  7121    38    1     11
8     0     2    2   167    9    5     0   148  2927    8     28
9     0     0    8     4    0   47     1     7     0  426      0
10    3     3    4     6   55    1    14    12    39    3  12656
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7248303, 'precision': 0.6932041, 'recall': 0.60549957, 'specificity': 0.97218466, 'f1': 0.5861286, 'auroc': 0.88546896}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1032     0   0   8    0    0    70    22     7   17    14
1      1  1312   0   6    0    0     0   172     0    0     8
2      0     6  74   8   97    4     9   129   189  129   370
3      0     0   0   0    0    0     0     0     0    0     0
4      0     1   0   0  206    0     1     2    12    1  1410
5      3     0   0  92    0  210     5     2    10  268     2
6      0     1   0   1    0    0  2920     2     1    0   142
7      0     0   0   6    0    0     2  1154     0    0     2
8      0     3   0  49    0    1    14    62  1238    2     1
9      4     9  31  57    2   29    17   285    85  578    40
10     0     0   0   0    9    0     0     1     0    0  1636
better model found
persisted
after epoch: 4,now: 2024-07-10 08:52:17.884766,epoch time: 0:40:10.027108,used: 2:41:25.349978,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_06_10_52_seed_2_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95852953, 'precision': 0.9095979, 'recall': 0.86271244, 'specificity': 0.99533665, 'f1': 0.8811409, 'auroc': 0.99803215}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     4    0    0     3     2     0    3     50
1     0  1262    0    15    0    0     0    52     1    0      1
2     1     0  167     1   50    2     1     8     3   67     12
3     0     0    0  8171    0   17     1   166    80    1      0
4     4     0    7     0  355    1     0     1    10    3    158
5     0     0    0    25    2  461     0     0     3   29      1
6    11     0    1     3    2    1  1866     1     1    1     20
7     0     9    0   146    5    0     1  7003    68    2     31
8     0     0    1   119   18    4     0    61  3024    8     61
9     0     0    9     7    5   86     1     4     1  379      1
10    9     0    0    11   27    1     7     7    12    2  12717
---- Validation: 
scalar performance:
{'acc': 0.95741606, 'precision': 0.9041985, 'recall': 0.85516596, 'specificity': 0.9952209, 'f1': 0.8735658, 'auroc': 0.99795616}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     5    2    0     3     4     1    2     47
1     0  1259    0    19    0    0     0    49     2    0      3
2     0     0  152     3   61    2     1     6     1   78      8
3     1     0    0  8188    2   10     0   163    73    2      1
4     3     0    7     1  335    1     1     1    10    7    173
5     0     0    0    27    0  457     0     0     4   31      2
6    11     1    1     3    6    2  1861     2     1    0     20
7     1    10    0   141    2    0     2  7021    67    4     17
8     2     0    2   125   20    4     1    74  2999    4     65
9     0     0    8     7    3   77     0     2     2  391      3
10    7     1    0     8   38    1     7     8    12    3  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7123767, 'precision': 0.6612649, 'recall': 0.6062831, 'specificity': 0.9711313, 'f1': 0.58582306, 'auroc': 0.8724699}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   973     0   0   30    5   14    31     6     7   68    36
1     0  1313   0   35    0    0     1   135     5    0    10
2     1     2  22   23  213   11     1    30   238  113   361
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  118    0     1     1     8    1  1504
5     0     0   0  141    3  352     0     0    10   86     0
6     0     0   0    6    1    0  2858     2     4    0   196
7     0     0   0   24    0    0     0  1131     5    0     4
8     0     0   0   92    5    0     1     7  1251    3    11
9     1     3  13  148   18  119     1    67   205  521    41
10    0     0   0    0    3    0     0     0     0    0  1643
better model found
persisted
after epoch: 5,now: 2024-07-10 09:32:29.256137,epoch time: 0:40:11.371371,used: 3:21:36.721349,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_06_10_52_seed_2_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.955747, 'precision': 0.90943253, 'recall': 0.8444141, 'specificity': 0.9950158, 'f1': 0.8671186, 'auroc': 0.9980463}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     6    0    0     8     0     0    0     36
1     0  1300    0    10    0    0     0    20     2    0      0
2     0     0  142     2   56    1     0     9     6   92      4
3     2     2    0  8308    0    1     0    63    62    1      0
4     2     0    6     2  320    0     0     2    14    6    186
5     0     0    0    73    0  367     0     0     7   73      1
6    13     2    0     8    2    0  1815     1     6    3     58
7     3    50    0   294    1    0     2  6832    71    0     10
8     1     4    2   150   10    0     0    38  3062    1     28
9     2     0    6    16    4   37     0     1     1  425      1
10    5     0    1     9   23    0     3     8    22    2  12718
---- Validation: 
scalar performance:
{'acc': 0.9577371, 'precision': 0.9135897, 'recall': 0.84846556, 'specificity': 0.99523175, 'f1': 0.8711271, 'auroc': 0.99811697}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     3    1    0     4     0     0    2     34
1     0  1297    0    15    0    0     0    18     2    0      0
2     2     1  141     7   60    0     0     5     5   87      4
3     0     4    0  8325    0    0     0    50    60    1      0
4     2     1    5     2  322    0     0     1    18    7    181
5     0     0    0    70    1  375     0     0     5   69      1
6    16     3    1     2    1    1  1824     0     6    0     54
7     1    40    0   295    1    0     0  6840    70    0     18
8     1     5    1   130    7    0     0    45  3079    2     26
9     1     0    8    14    1   35     0     2     4  428      0
10    5     0    0     8   15    1     2     8    18    4  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6314979, 'precision': 0.6460017, 'recall': 0.54919446, 'specificity': 0.96306527, 'f1': 0.5416018, 'auroc': 0.8649235}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   998     0   0   46    4    1    68     3     2   18    30
1     2  1393   0   40    0    0     0    60     1    0     3
2     1    11  36   43  258    4     1    38   226   90   307
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    1   44    0     0     1     9    0  1578
5     2     0   0  215    3  213     1     0    12  145     1
6     6    15   0   26    1    0  1972     2     1    0  1044
7     1     0   0  118    0    0     0  1042     1    0     2
8     0     2   0  139    1    1     0    10  1209    0     8
9     8    26  21  299   20   39     2    66   151  473    32
10    0     0   0    0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 6,now: 2024-07-10 10:16:02.708748,epoch time: 0:43:33.452611,used: 4:05:10.173960,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_06_10_52_seed_2_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9606164, 'precision': 0.90682685, 'recall': 0.8678209, 'specificity': 0.99568474, 'f1': 0.88521343, 'auroc': 0.9984077}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     2    1    0     5     2     2    2     57
1     0  1276    0     5    0    0     0    47     2    0      1
2     2     1  198     2   47    1     2    24     5   29      1
3     0     3    0  8290    0    3     2    89    50    1      0
4     2     0   10     1  402    0     1     6    22    4     90
5     0     0    0    41    1  441     1     0    12   24      1
6     4     0    0     1    1    0  1881     0     8    0     13
7     0    15    0   189    1    0     2  7024    30    0      3
8     0     0    1   119    7    0     1    87  3071    0     10
9     0     0   43    13    3   89     0     9    13  323      0
10    1     0    4     7   75    0     7    34    77    1  12586
---- Validation: 
scalar performance:
{'acc': 0.9619901, 'precision': 0.9098921, 'recall': 0.87133884, 'specificity': 0.99584305, 'f1': 0.8883213, 'auroc': 0.99844986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     1    0    0    14     2     3    2     52
1     0  1287    0     3    0    0     0    40     2    0      0
2     1     0  202     2   45    1     1    28     5   27      0
3     1     3    0  8312    0    1     1    70    50    2      0
4     3     0    6     0  412    1     0     6    20    1     90
5     0     0    1    33    0  448     0     0     7   31      1
6     6     0    1     2    0    0  1881     1     6    0     11
7     0    19    0   180    1    0     1  7028    33    0      3
8     0     0    0   130    8    0     0    86  3066    0      6
9     0     0   37    14    4   96     0    10    13  319      0
10    3     0    4     8   64    0    10    39    68    0  12600
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70419085, 'precision': 0.67145705, 'recall': 0.58158815, 'specificity': 0.97043914, 'f1': 0.5788889, 'auroc': 0.885925}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   893     0    0   34    2    1    91    43    14   18    74
1     0  1058    0   20    0    0     0   408     2    0    11
2     1     0  144   19  231    7     4   160   179   61   209
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    1  340    0     5     6     9    0  1269
5     3     0    1  183    4  247     0     1    17  134     2
6     0     0    0    3    0    0  3049     2     1    0    12
7     0     0    0   16    0    0     0  1146     0    0     2
8     0     0    0  106    3    0     1    38  1218    0     4
9     6     1   78  226    6   61     2   251   135  355    16
10    0     0    0    0   27    0     4     0     0    0  1615
better model found
persisted
after epoch: 7,now: 2024-07-10 11:17:47.990640,epoch time: 1:01:45.281892,used: 5:06:55.455852,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_06_10_52_seed_2_21725673
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9564159, 'precision': 0.8926721, 'recall': 0.8903039, 'specificity': 0.995273, 'f1': 0.88909394, 'auroc': 0.9983387}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     0    1    1    17     0     0    1     18
1     0  1307    0     2    0    0     1    19     2    0      1
2     2     0  229     0   23    1     1     1     1   50      4
3    19     8    3  7835    0   42    25   314   188    4      1
4     7     0   16     0  338    1     2     0     6    3    166
5     1     0    1     2    0  449     1     0     3   63      1
6     9     0    0     0    1    0  1887     0     0    0      9
7    12    27    9    78    2    0    10  7043    58    2     21
8    11     2   14    34    3   12    14    58  3086    5     57
9     4     0   21     2    1   41     2     1     1  419      1
10   22     0    3     5   20    0    21     3     9    1  12709
---- Validation: 
slurmstepd: error: *** JOB 21725673 ON gpusrv40 CANCELLED AT 2024-07-10T12:01:43 DUE TO TIME LIMIT ***
