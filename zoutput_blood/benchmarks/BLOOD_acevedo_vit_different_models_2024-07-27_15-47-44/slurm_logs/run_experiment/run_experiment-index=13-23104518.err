Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 23:00:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/13.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=13
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518

 Experiment start at: 2024-07-27 23:12:26.377797
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.12040859460830688
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93311214, 'precision': 0.8491275, 'recall': 0.7942085, 'specificity': 0.9927288, 'f1': 0.8100046, 'auroc': 0.99500877}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   356     0    0     1    0    1    28     3    10    4     79
1     0  1257    0     8    0    1     2    54     4    0      6
2     4     2  135     1   69    9     1    11     5   63     12
3     2     1    0  7629    0   45     7   342   409    2      1
4     2     0   11     1  270    6     0     1    32    7    208
5     3     0    1    19    0  468     1     0     8   20      1
6    17     0    0     0    0    2  1846     6    10    2     25
7     0    21    0   123    3    2     5  6904   166    2     38
8     1     2    1    49   17    8     4    51  3085    6     71
9     9     1   19     0    5  203     2     6    10  232      6
10    4     1    2     6   22    2    17    12    33    0  12694
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9335295, 'precision': 0.84541285, 'recall': 0.79568946, 'specificity': 0.99277914, 'f1': 0.8102839, 'auroc': 0.9950782}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   370     0    0     3    0    0    21     6     7    1     75
1     0  1263    0     7    0    0     0    50     8    0      4
2     6     2  133     1   64   10     1     5    10   62     18
3     1     2    0  7641    2   47     7   344   394    1      1
4     1     0    9     0  275    2     2     2    34    9    205
5     4     0    1    18    1  459     1     0    11   25      1
6    18     1    1     1    0    3  1848     3     7    0     26
7     2    17    2   132    3    2     2  6893   172    1     39
8     0     2    4    39   17    8     5    57  3098    0     66
9     7     2   27     2    5  200     2     3    10  230      5
10    8     0    2     6   26    2    11    10    41    0  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6978941, 'precision': 0.6280069, 'recall': 0.6087831, 'specificity': 0.96961844, 'f1': 0.57427317, 'auroc': 0.8827418}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1020     2    0   9    0    4    82    15    20    2    16
1      2  1227    0  28    1    0     2   195    19    0    25
2     23    13  162   9  243   59     5    29   260   66   146
3      0     0    0   0    0    0     0     0     0    0     0
4      1     1    3   0  199    0     0     0    30    0  1399
5     31     0    0  64    1  458     2     0    12   23     1
6      0     1    0   3    3    0  2654     4   304    0    98
7      1     0    0  12    0    1     8  1128     8    1     5
8      5     0    1  76    3    4     8     5  1264    3     1
9     53    28  129  85   19  318    14    63   173  229    26
10     0     0    0   0   11    0     0     0     1    0  1634
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 23:59:10.208260,epoch time: 0:46:43.830463,used: 0:46:43.830463,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9507973, 'precision': 0.879881, 'recall': 0.8393301, 'specificity': 0.9946003, 'f1': 0.84690005, 'auroc': 0.9973132}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     1    1     6    2    0    10     2     3    1     50
1     0  1277    0     7    0    0     0    42     3    0      2
2     1     0  246     1   26    5     0     6     3   15      9
3     0     1    1  7957    0   19     0   284   175    0      0
4     2     0   43     0  275    3     0     6    23    2    185
5     0     0    2    19    0  474     0     1     8   16      1
6     9     1    1     6    1    2  1852     9     3    1     23
7     1    27    0   102    1    0     1  7077    49    1      6
8     1     2    4    52   12    1     1    97  3079    0     45
9     2     0   99     8    0  166     1     5     7  201      4
10   15     0    3     5   19    2     7    23    27    0  12693
---- Validation: 
scalar performance:
{'acc': 0.9515581, 'precision': 0.8862593, 'recall': 0.84638965, 'specificity': 0.9946717, 'f1': 0.8532522, 'auroc': 0.99740744}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     1    1     5    0    0     8     4     0    3     46
1     0  1281    0    10    0    0     0    37     2    0      2
2     3     0  251     1   18    3     1    10     1   17      7
3     1     1    0  7958    0   19     0   291   170    0      0
4     3     1   34     1  295    0     2     3    20    1    179
5     0     0    2    18    0  479     0     0     7   14      1
6    11     1    2     3    1    2  1858    10     5    0     15
7     0    22    2   111    1    0     2  7079    38    0     10
8     0     2    5    48    6    3     1   113  3063    0     55
9     1     0   94     5    1  177     1     6     5  200      3
10   17     0    5     5   15    2     7    23    27    0  12695
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71006787, 'precision': 0.672124, 'recall': 0.6180342, 'specificity': 0.97109026, 'f1': 0.58870625, 'auroc': 0.8857538}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1059     3    0   24    0   12    30    16     8   10     8
1      3  1298    2   34    1    0     0   132     6    0    23
2     11     4  304   28   80   50     3    28   278   21   208
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    7    0  141    0     1     0    23    0  1460
5      5     0    0  117    0  444     0     0    16    7     3
6      2     2    1    4    2    0  2747     3   202    0   104
7      1     0    0   55    0    0     2  1096     5    1     4
8      1     0    1   81    0    2     2     4  1277    1     1
9     16    13  215  206    3  271     4    61   184  143    21
10     0     0    0    0    5    0     0     0     1    0  1640
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 00:44:24.137943,epoch time: 0:45:13.929683,used: 1:31:57.760146,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9601081, 'precision': 0.90290344, 'recall': 0.8657874, 'specificity': 0.9956295, 'f1': 0.8828694, 'auroc': 0.99805707}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     4    0    0    17     2     4    1     35
1     0  1285    0    15    0    0     1    28     2    0      1
2     3     1  191     0   50    2     0     9     6   48      2
3     1     0    0  8234    0    5     4   142    51    0      0
4     2     1   17     1  370    1     2     3    32    5    105
5     0     0    0    47    0  418     0     0     5   50      1
6     7     0    1     0    1    0  1882     1     4    0     12
7     1    12    0   167    1    0     2  7029    44    2      5
8     2     0    1   139    3    3     7    84  3035    0     22
9     1     1   34    10    2   63     3     3     6  369      1
10   12     0    2     6   38    0    16    13    52    1  12652
---- Validation: 
scalar performance:
{'acc': 0.95950246, 'precision': 0.903083, 'recall': 0.8639889, 'specificity': 0.99555874, 'f1': 0.88172805, 'auroc': 0.9980762}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     3    1    0    16     3     4    0     30
1     0  1292    0     9    0    0     1    27     1    0      2
2     3     1  189     1   50    2     1    14     5   43      3
3     2     1    0  8214    0    7     3   160    52    1      0
4     4     0   14     0  365    2     1     2    31    4    116
5     1     0    0    45    1  407     1     0     6   59      1
6     5     0    1     2    0    0  1888     1     2    0      9
7     0    17    0   164    1    0     4  7039    33    1      6
8     1     0    1   148    3    1     1    90  3037    0     14
9     1     1   31    11    2   63     6     6     3  368      1
10   12     1    1     7   40    0    15    17    56    1  12646
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74232143, 'precision': 0.6674334, 'recall': 0.63805044, 'specificity': 0.97417545, 'f1': 0.6242542, 'auroc': 0.88704574}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1113     2    0    6    0    3    21     8     8    5     4
1      0  1257    0   34    2    0     3   181     7    0    15
2     18     0  146   15  355   17     5    30   240   72   117
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    1    0  313    0     1     0    23    0  1293
5      8     0    2   70    4  423     1     0     3   80     1
6      2     0    0    3    4    0  2967     4    40    0    47
7      1     0    0   65    0    0     4  1088     2    1     3
8      1     0    0  104    2    2    11    12  1234    2     2
9     23     7  119  105   33  177    10    90   122  437    14
10     0     0    0    0   12    0     1     0     1    0  1632
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-28 01:29:26.915515,epoch time: 0:45:02.777572,used: 2:17:00.537718,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96040237, 'precision': 0.8938828, 'recall': 0.8940345, 'specificity': 0.9957567, 'f1': 0.89257956, 'auroc': 0.9984695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    1     2    1    1    30     0     2    3     26
1     0  1301    0    10    0    0     1    16     1    0      3
2     1     0  245     0   18    3     2     2     2   38      1
3     2     1    2  8220    1   17    12    54   126    1      1
4     4     0   26     0  404    1     4     1     9    7     83
5     0     0    0    11    0  483     1     0     4   21      1
6     2     0    1     1    0    0  1891     1     2    1      8
7     2    21    6   289    3    0    19  6823    87    3     11
8     2     2    9    62   23    6     3    26  3120    1     42
9     0     0   34     1    1  108     1     3     3  341      1
10   10     0    4     8   86    0    22     0    10    1  12651
---- Validation: 
scalar performance:
{'acc': 0.96025145, 'precision': 0.8864783, 'recall': 0.8907082, 'specificity': 0.9957568, 'f1': 0.8873331, 'auroc': 0.99844027}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     1    2    0    26     0     1    5     22
1     0  1305    0     7    0    0     0    16     3    0      1
2     0     0  237     0   26    1     2     1     2   42      1
3     4     2    3  8231    0   22    14    50   113    1      0
4     6     0   34     0  396    1     3     1     8    6     84
5     0     0    0    10    1  481     0     0     4   24      1
6     5     0    0     0    0    0  1889     0     3    3      8
7     2    32    5   299    3    0    12  6815    78    1     18
8     4     0   12    57   27    5     1    25  3126    3     36
9     0     0   33     3    2  118     1     1     0  334      1
10    9     0    4     7   75    0    22     5    11    4  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7201427, 'precision': 0.6819563, 'recall': 0.6201768, 'specificity': 0.9719342, 'f1': 0.6260678, 'auroc': 0.88866496}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1058     0    0    6    0    1    75    1     5   19     5
1      1  1250    1   37    1    0     0  170     4    1    34
2     11     0  309   13  219   10    12   23   161   89   168
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    4    0  360    0     1    0     8    0  1259
5     12     0    2   77    3  340     1    0     4  146     7
6      1     0    1    3    3    0  2718    3    56    0   282
7      6     0    0  187    0    0    30  929     3    2     7
8      1     0    2  107    4    0    10    7  1234    4     1
9     15     2  173  137    5  137    17   49   105  466    31
10     0     0    0    0   16    0     1    0     0    0  1629
better model found
persisted
after epoch: 4,now: 2024-07-28 02:14:17.276702,epoch time: 0:44:50.361187,used: 3:01:50.898905,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96888375, 'precision': 0.92786294, 'recall': 0.8812013, 'specificity': 0.9965038, 'f1': 0.90006816, 'auroc': 0.9989867}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     2    1    0     4     1     0    0     10
1     0  1287    0     6    0    0     0    38     1    0      0
2     3     0  198     2   41    4     0    13     6   41      4
3     1     1    0  8316    0    3     1    81    31    0      0
4     7     0    6     0  342    0     0     4    15    5    160
5     1     0    0    30    1  468     0     0     3   17      1
6    14     0    0     2    0    0  1871     1     2    2     16
7     0     6    0   122    1    0     1  7125     6    0      4
8     2     3    0    99    2    0     0    97  3061    0     31
9     2     0   14     9    2   92     1     5     8  358      2
10   24     0    1     8    7    1     3    12    16    0  12722
---- Validation: 
scalar performance:
{'acc': 0.9688645, 'precision': 0.92426753, 'recall': 0.8782165, 'specificity': 0.9965166, 'f1': 0.89705634, 'auroc': 0.99893165}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     3    0    0     6     3     1    0     13
1     0  1296    0     7    0    0     0    28     1    0      0
2     5     0  202     1   36    2     0    10     5   47      4
3     0     0    0  8332    0    5     0    75    28    0      0
4     9     0    7     0  335    1     0     2    23    3    159
5     0     0    0    32    0  465     1     0     3   19      1
6     9     0    0     3    0    0  1876     0     3    3     14
7     0     7    0   119    1    0     2  7114    17    0      5
8     1     0    1    97    3    0     0    99  3071    0     24
9     2     0   20    12    3   99     0     3     6  347      1
10   22     0    0     8    7    0     3    14    15    1  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70370114, 'precision': 0.6537312, 'recall': 0.6079805, 'specificity': 0.9704759, 'f1': 0.59612274, 'auroc': 0.88253546}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1103     1    0   12    0    4    13    22     1   10     4
1      1  1199    1   31    1    0     1   238     3    1    23
2     17     1  245   30  123   20     1    59   196   87   236
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    3    0   66    0     1     2    10    0  1550
5      7     0    0  128    1  361     1     0     2   90     2
6      3     0    0    9    2    0  2768     3    57    0   225
7      0     0    0   93    0    0     1  1062     0    1     7
8      1     0    1  166    0    0     5    13  1179    4     1
9     26     4  138  201    3  166     2    95    45  432    25
10     0     0    0    0    2    0     0     0     1    0  1643
better model found
persisted
after epoch: 5,now: 2024-07-28 02:59:11.570745,epoch time: 0:44:54.294043,used: 3:46:45.192948,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97527826, 'precision': 0.93697286, 'recall': 0.9250679, 'specificity': 0.9972999, 'f1': 0.9298072, 'auroc': 0.9993366}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     3    0    0     4     1     0    1     11
1     0  1303    0     3    0    0     0    24     2    0      0
2     1     0  255     0   13    0     1     3     2   35      2
3     4     1    2  8276    0    6     3    90    52    5      0
4     5     0   14     0  415    1     1     1    10    3     89
5     0     0    1    11    0  439     0     0     4   65      1
6     5     0    1     0    1    0  1884     0     2    0     13
7     4     8    0   110    1    0     1  7112    21    3      5
8     0     0    5    54    7    2     1    44  3162    5     14
9     0     0   21     2    0   20     0     0     2  448      0
10   18     1    2     7   16    1     5    19    28    0  12696
---- Validation: 
scalar performance:
{'acc': 0.97659487, 'precision': 0.9422909, 'recall': 0.9304975, 'specificity': 0.997441, 'f1': 0.9351209, 'auroc': 0.99940157}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    0    0     2     0     3    1      5
1     0  1299    0     5    0    0     0    26     2    0      0
2     1     0  259     0   14    1     2     2     1   32      0
3     1     1    3  8298    0    3     2    77    50    4      1
4     6     1   14     0  421    2     1     1     8    3     82
5     1     0    1    21    0  437     0     0     5   55      1
6     6     0    0     0    0    0  1888     2     0    1     11
7     8    11    2   113    1    0     2  7098    20    3      7
8     1     1    2    50    8    1     0    44  3167    6     16
9     3     0   14     2    1   12     0     0     2  459      0
10   12     0    3     7   17    1     3    12    28    0  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7484083, 'precision': 0.6851474, 'recall': 0.63656497, 'specificity': 0.974702, 'f1': 0.6307696, 'auroc': 0.88532156}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1101     0    0   4    1    0    27    12     8   13     4
1      3  1170    0  26    1    0     1   256     7   12    23
2     10     0  325  11  167   10    17    28   181   87   179
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    5   0  221    0     2     0    20    0  1384
5      7     0   10  84    1  250     4     0     4  231     1
6      2     1    1   5    1    0  2986     3    29    0    39
7      2     0    0  25    0    0     3  1128     2    1     3
8      0     0    4  79    0    0    19    10  1248    9     1
9     13     2  210  68    3   65     6    45    70  630    25
10     0     0    0   0    7    0     0     0     1    0  1638
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-28 03:44:16.230739,epoch time: 0:45:04.659994,used: 4:31:49.852942,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9731646, 'precision': 0.94102794, 'recall': 0.91875625, 'specificity': 0.99707115, 'f1': 0.9279968, 'auroc': 0.9994062}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     1    1     4    1    0     5     2     3    0     35
1     0  1314    0     2    0    0     0    10     5    0      1
2     1     0  276     0   11    1     0     2     3   17      1
3     0     6    0  8138    1   11     0   109   174    0      0
4     2     0   21     0  389    1     0     1    21    1    103
5     1     0    2    16    0  476     0     0     5   20      1
6     1     0    0     2    2    0  1888     0     3    0     12
7     0    22    2    59    1    0     1  7098    72    1      6
8     0     0    1    26    3    0     0    21  3215    1     26
9     2     0   34     2    1   50     0     1     6  396      1
10    0     0    2     6   12    0     2     6    14    0  12752
---- Validation: 
scalar performance:
{'acc': 0.9748562, 'precision': 0.94622684, 'recall': 0.9247799, 'specificity': 0.99724513, 'f1': 0.9338899, 'auroc': 0.99938124}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    1     1    1    1     2     2     2    0     25
1     0  1318    0     1    0    0     0    11     2    0      0
2     0     0  277     0    7    0     1     2     8   14      3
3     0     2    0  8158    1   11     0   114   153    0      1
4     2     0   19     1  394    0     0     1    17    0    105
5     0     0    1    14    0  474     0     0     7   24      1
6     1     0    1     0    1    0  1885     1     4    0     15
7     0    19    0    58    1    0     1  7104    77    0      5
8     0     0    2    17    2    0     0    18  3232    0     25
9     0     0   31     6    4   39     1     0     8  403      1
10    3     0    3     7   13    1     2     3    12    0  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.694116, 'precision': 0.67985046, 'recall': 0.6057805, 'specificity': 0.96928453, 'f1': 0.5884049, 'auroc': 0.8853838}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   936     2    1   23    0    6    45    65    43   18    31
1     0  1305    0   19    1    0     1   134    14    5    20
2     4     0  333   15   33   23     4    27   310   50   216
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0   11    0  101    0     0     0    17    0  1504
5     4     0    2  160    0  343     1     0    16   64     2
6     1     0    5    3    0    0  2496     4   144    0   414
7     0     0    1   31    0    0     0  1120     7    1     4
8     0     0    1   38    0    0     6     5  1315    2     3
9     4     3  153  116    2  203     2    56   244  330    24
10    0     0    0    0    3    0     0     0     1    0  1642
early stop counter: 1
val acc:0.9748561978340149, best validation acc: 0.976594865322113, corresponding to test acc:                         0.748408317565918 / 0.748408317565918
after epoch: 7,now: 2024-07-28 04:29:23.018906,epoch time: 0:45:06.788167,used: 5:16:56.641109,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97819453, 'precision': 0.95886534, 'recall': 0.9249859, 'specificity': 0.9975266, 'f1': 0.9383526, 'auroc': 0.99957454}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     4    1    0     2     5     1    1     25
1     0  1296    0    11    0    0     0    23     2    0      0
2     0     0  284     0    1    0     0     2     4   19      2
3     0     0    0  8396    0    2     0    22    17    0      0
4     2     0   23     1  366    0     0     1    24    3    119
5     0     0    1    12    0  432     0     0     5   69      1
6     3     0    0     4    0    0  1892     1     3    1      4
7     0     4    0   185    1    0     1  7040    27    1      4
8     1     1    0    63    1    0     0    18  3200    2     10
9     0     0   17     2    1    9     0     0     0  463      1
10    0     0    1     7    1    0     1     1    34    0  12748
---- Validation: 
scalar performance:
{'acc': 0.97745085, 'precision': 0.9596782, 'recall': 0.92294514, 'specificity': 0.9974451, 'f1': 0.93743205, 'auroc': 0.9995383}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     6    1    0     4     2     1    2     20
1     0  1300    0     6    0    0     0    24     1    0      1
2     0     0  282     1    3    0     1     3     3   17      2
3     0     0    0  8386    0    1     0    28    23    2      0
4     2     0   15     0  364    1     0     1    31    2    123
5     0     0    1    14    0  423     0     0     2   80      1
6     3     0    0     2    0    0  1888     2     2    1     10
7     0     3    0   197    1    0     1  7033    25    1      4
8     0     0    0    61    0    0     0    23  3208    0      4
9     0     0   16     2    0    8     0     2     2  463      0
10    0     0    2     6    0    0     3     3    34    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6796334, 'precision': 0.64604306, 'recall': 0.56326765, 'specificity': 0.96800154, 'f1': 0.54595923, 'auroc': 0.8702852}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   877     2    0   51   0    2    36   109    17   59    17
1     0  1219    0   34   1    0     1   195     7    4    38
2     4     0  129   36  47    5     8    33   422   89   242
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    6    0  40    0     1     1    53    0  1532
5     3     0    0  176   0  177     0     1    19  212     4
6     2     0    0    9   0    0  2811     3   129    0   113
7     0     0    0   51   0    0     0  1104     4    1     4
8     0     0    0   93   0    0     6     9  1259    3     0
9     4     3   57  225   5   59     6    78   209  456    35
10    0     0    0    0   1    0     0     0     3    0  1642
better model found
persisted
after epoch: 8,now: 2024-07-28 05:14:24.665200,epoch time: 0:45:01.646294,used: 6:01:58.287403,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9835456, 'precision': 0.9545799, 'recall': 0.96082544, 'specificity': 0.99823785, 'f1': 0.95737505, 'auroc': 0.99975574}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     0     0     0    0      2
1     0  1319    0     4    0    0     0     9     0    0      0
2     1     0  271     0   20    0     0     0     1   18      1
3     1     1    0  8328    0   16     0    41    46    3      0
4     4     0    2     0  510    0     0     0     4    2     17
5     1     0    1     4    0  476     0     0     1   37      1
6     4     1    0     0    1    0  1892     2     2    0      6
7     2     7    1   118    1    0     1  7082    44    0      8
8     0     0    1    21    5    1     2    12  3220    0     33
9     1     0   15     1    1   16     0     0     0  459      0
10    7     0    2     7   46    0     1     1     4    1  12724
---- Validation: 
scalar performance:
{'acc': 0.9833891, 'precision': 0.95406145, 'recall': 0.9595419, 'specificity': 0.9982291, 'f1': 0.9565139, 'auroc': 0.99969363}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    1    0     1     0     0    0      5
1     0  1319    0     3    0    0     1     8     1    0      0
2     1     0  272     0   16    1     0     1     0   21      0
3     2     0    0  8319    1    9     0    51    53    4      1
4     5     0    1     0  505    0     1     1     4    1     21
5     0     0    0     1    1  480     0     0     3   35      1
6     6     0    2     0    1    0  1890     1     2    1      5
7     1    11    0   102    1    0     1  7102    41    0      6
8     3     2    2    17   10    1     0    13  3216    2     30
9     1     0   16     1    1   15     1     0     1  457      0
10    7     0    0     6   40    2     2     2     8    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7456797, 'precision': 0.68436456, 'recall': 0.64479136, 'specificity': 0.9744415, 'f1': 0.6344332, 'auroc': 0.88833916}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1103     1    0   9    2    4    19    10     3   15     4
1      1  1361    0  21    2    0     2    91     6    2    13
2      9     2  207  10  186   19    15    28   239   99   201
3      0     0    0   0    0    0     0     0     0    0     0
4      1     1    2   0  316    0     0     1    15    0  1297
5      8     0    3  64    0  377     1     0     7  129     3
6      2     2    1   8    1    0  2801     3    38    0   211
7      2     0    2  67    0    0     1  1084     4    1     3
8      0     0    2  61    1    3     9     4  1278    6     6
9     17    10  126  80    4  174    12    46   147  499    22
10     0     0    0   0   13    0     0     0     1    0  1632
better model found
persisted
after epoch: 9,now: 2024-07-28 05:59:31.562638,epoch time: 0:45:06.897438,used: 6:47:05.184841,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9813249, 'precision': 0.95777845, 'recall': 0.9348881, 'specificity': 0.99798316, 'f1': 0.94314665, 'auroc': 0.99978346}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    5    0     1     1     0    3     11
1     0  1309    0     4    0    0     0    15     4    0      0
2     0     0  246     0    2    0     1     1     2   57      3
3     3     0    0  8225    0    6     1    84   114    4      0
4     0     0   13     0  441    0     0     1    13    6     65
5     0     0    0     5    0  427     0     0     6   81      1
6     3     0    0     0    0    0  1886     1     0    2     16
7     0     6    0    37    0    0     0  7181    27    1     11
8     1     0    0     9    1    0     2    12  3254    1     16
9     0     0    4     0    0    4     0     1     1  482      0
10    0     0    0     6    3    0     1     2    17    0  12765
---- Validation: 
scalar performance:
{'acc': 0.9811689, 'precision': 0.9573163, 'recall': 0.9316459, 'specificity': 0.997961, 'f1': 0.940742, 'auroc': 0.9997473}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    3    0     1     0     1    2     11
1     0  1307    0     2    0    0     0    18     4    0      1
2     0     0  250     0    0    0     0     3     0   57      2
3     1     0    0  8225    0    8     0    81   121    3      1
4     3     1   15     2  419    0     1     0    14    5     79
5     0     0    0    11    0  417     0     0     1   91      1
6     1     0    0     1    1    1  1888     1     1    1     13
7     0     2    0    34    0    0     2  7193    28    0      6
8     0     0    1    11    0    0     0    10  3260    0     14
9     0     0    3     1    0    3     1     0     0  485      0
10    1     0    0     5    4    0     1     3     9    1  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7330861, 'precision': 0.6840921, 'recall': 0.6197967, 'specificity': 0.97302634, 'f1': 0.60110605, 'auroc': 0.8802267}
confusion matrix:
      0     1    2   3   4    5     6     7     8    9     10
0   1040     1    0   4   0    1    43    20    15   40     6
1      1  1261    1  18   1    0     2   174    11   13    17
2      3     1  259   6  54    9    33    28   307  145   170
3      0     0    0   0   0    0     0     0     0    0     0
4      1     0   16   0  81    0     2     0    42    0  1491
5      4     0    1  59   0  192     0     0    12  320     4
6      1     0    2   2   0    0  2896     3    79    1    83
7      0     0    0  42   0    0     1  1111     6    1     3
8      0     0    2  33   0    1    23    10  1290   10     1
9     13     3   78  43   2   45    22    63   142  705    21
10     0     0    0   0   1    0     0     0     2    0  1643
early stop counter: 1
val acc:0.9811689257621765, best validation acc: 0.9833890795707703, corresponding to test acc:                         0.7456796765327454 / 0.748408317565918
after epoch: 10,now: 2024-07-28 06:44:32.640299,epoch time: 0:45:01.077661,used: 7:32:06.262502,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:32:06.262502 at 2024-07-28 06:44:32.640299
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7456797, 'precision': 0.68436456, 'recall': 0.64479136, 'specificity': 0.9744415, 'f1': 0.6344332, 'auroc': 0.88833916}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1103     1    0   9    2    4    19    10     3   15     4
1      1  1361    0  21    2    0     2    91     6    2    13
2      9     2  207  10  186   19    15    28   239   99   201
3      0     0    0   0    0    0     0     0     0    0     0
4      1     1    2   0  316    0     0     1    15    0  1297
5      8     0    3  64    0  377     1     0     7  129     3
6      2     2    1   8    1    0  2801     3    38    0   211
7      2     0    2  67    0    0     1  1084     4    1     3
8      0     0    2  61    1    3     9     4  1278    6     6
9     17    10  126  80    4  174    12    46   147  499    22
10     0     0    0   0   13    0     0     0     1    0  1632
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7484083, 'precision': 0.6851474, 'recall': 0.63656497, 'specificity': 0.974702, 'f1': 0.6307696, 'auroc': 0.88532156}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1101     0    0   4    1    0    27    12     8   13     4
1      3  1170    0  26    1    0     1   256     7   12    23
2     10     0  325  11  167   10    17    28   181   87   179
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    5   0  221    0     2     0    20    0  1384
5      7     0   10  84    1  250     4     0     4  231     1
6      2     1    1   5    1    0  2986     3    29    0    39
7      2     0    0  25    0    0     3  1128     2    1     3
8      0     0    4  79    0    0    19    10  1248    9     1
9     13     2  210  68    3   65     6    45    70  630    25
10     0     0    0   0    7    0     0     0     1    0  1638
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_12_25_seed_0_23104518_instance_wise_predictions.txt
accuracy from prediction file 0.7456797033512909
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/13.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB | 414147 GiB | 414145 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411242 GiB | 411240 GiB |
|       from small pool |      7 MiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB | 414147 GiB | 414145 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411242 GiB | 411240 GiB |
|       from small pool |      7 MiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB | 412582 GiB | 412580 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 409680 GiB | 409678 GiB |
|       from small pool |      6 MiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  16520 MiB |      0 B   |
|       from large pool |  16492 MiB |  16492 MiB |  16492 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 235584 KiB | 630848 KiB |  63120 GiB |  63120 GiB |
|       from large pool | 216320 KiB | 628608 KiB |  60199 GiB |  60198 GiB |
|       from small pool |  19264 KiB |  22064 KiB |   2921 GiB |   2921 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   30047 K  |   30045 K  |
|       from large pool |     247    |     595    |   13397 K  |   13397 K  |
|       from small pool |    2399    |    3599    |   16649 K  |   16647 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   30047 K  |   30045 K  |
|       from large pool |     247    |     595    |   13397 K  |   13397 K  |
|       from small pool |    2399    |    3599    |   16649 K  |   16647 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     467    |       0    |
|       from large pool |     453    |     453    |     453    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     117    |     566    |   16745 K  |   16745 K  |
|       from large pool |      95    |     303    |    8723 K  |    8723 K  |
|       from small pool |      22    |     457    |    8021 K  |    8021 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414147 GiB | 414147 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414147 GiB | 414147 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412582 GiB | 412582 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409680 GiB | 409680 GiB |
|       from small pool |      0 KiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630848 KiB |  63121 GiB |  63121 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60200 GiB |  60200 GiB |
|       from small pool |      0 KiB |  25684 KiB |   2921 GiB |   2921 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30047 K  |   30047 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3599    |   16649 K  |   16649 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30047 K  |   30047 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3599    |   16649 K  |   16649 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     566    |   16745 K  |   16745 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |     457    |    8022 K  |    8022 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414147 GiB | 414147 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414147 GiB | 414147 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412582 GiB | 412582 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409680 GiB | 409680 GiB |
|       from small pool |      0 KiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630848 KiB |  63121 GiB |  63121 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60200 GiB |  60200 GiB |
|       from small pool |      0 KiB |  25684 KiB |   2921 GiB |   2921 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30047 K  |   30047 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3599    |   16649 K  |   16649 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30047 K  |   30047 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3599    |   16649 K  |   16649 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     566    |   16745 K  |   16745 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |     457    |    8022 K  |    8022 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518

 Experiment start at: 2024-07-28 07:03:27.361090
before training, model accuracy: 0.09417197853326797
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9257277, 'precision': 0.8482949, 'recall': 0.74028593, 'specificity': 0.99191964, 'f1': 0.77062035, 'auroc': 0.9948879}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   162     0    0     4    1    1   204    10     8   11     82
1     0  1238    0    16    0    0     4    64     2    0      8
2     0     2  114     2   70    2     6    28    18   66      3
3     0     0    0  7653    1    7    20   553   203    1      1
4     0     1    6     1  265    4    11     8    54   11    178
5     0     0    0    68    0  385     5     0    14   48      1
6     4     0    0     2    1    1  1867     6     9    0     18
7     0     5    0   100    1    0    12  7052    77    0     15
8     0     1    1    96    4    1    24   112  3008    1     48
9     1     1   24    12    5  137    16    13    18  260      6
10    1     1    3     6   25    1    76    29    53    1  12596
---- Validation: 
scalar performance:
{'acc': 0.9253711, 'precision': 0.8462236, 'recall': 0.7422935, 'specificity': 0.9918764, 'f1': 0.77117985, 'auroc': 0.9947807}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   150     0    1     7    0    0   209     9     7   10     90
1     0  1242    0    16    0    0     3    63     3    0      5
2     1     3  127     0   62    4     9    20    15   63      8
3     0     0    0  7650    0    9    23   551   204    0      3
4     0     1    9     1  253    2    12    12    55   12    182
5     1     0    2    65    0  380     7     0    16   49      1
6     1     0    0     0    0    0  1879     4     6    1     17
7     0    14    0   101    1    0    14  7050    71    1     13
8     0     1    2    88    4    1    22   124  2996    2     56
9     2     1   34     8    2  126    18     9    11  277      5
10    0     0    1     5   30    2    80    23    63    1  12591
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6399636, 'precision': 0.6053625, 'recall': 0.50716525, 'specificity': 0.96220076, 'f1': 0.47990525, 'auroc': 0.8744545}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   267     0   0   45    0    0   810    33     2    6     7
1     0  1346   0   28    0    0    18    64     3    0    40
2     0    15   5   14  127    9   269    45   389   32   110
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  139    0    58     2    20    0  1414
5     2     0   0  173    1  239   118     0    17   42     0
6     0     1   0    1    0    0  3047     3    10    0     5
7     0     2   0   26    0    0    13  1120     0    0     3
8     0     1   0  102    1    0    71    11  1182    0     2
9     1    35  16  149   22   81   300    95   257  168    13
10    0     0   0    0    6    0     5     1     0    0  1634
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 07:50:17.386104,epoch time: 0:46:50.025014,used: 0:46:50.025014,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9471051, 'precision': 0.8828652, 'recall': 0.84647, 'specificity': 0.99415624, 'f1': 0.8613597, 'auroc': 0.99690235}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     5    1    0     5     5     6    3     46
1     0  1249    0     6    0    0     0    67     7    1      2
2     2     0  221     0   29    2     1     8     7   37      5
3     2     0    0  7809    0   17     1   481   127    2      0
4     3     0   34     0  289    2     0     4    22    8    177
5     0     0    1    16    0  410     0     0     8   85      1
6    18     0    0     4    0    0  1837    12     8    2     26
7     0     8    4    89    1    0     1  7086    61    2     10
8     1     0    8    74    8    2     1   126  3048    0     28
9     5     0   54     1    3   61     0     6     8  349      6
10   11     0    4     8   17    1     8    18    34    2  12689
---- Validation: 
scalar performance:
{'acc': 0.9485355, 'precision': 0.8869588, 'recall': 0.84961545, 'specificity': 0.9943067, 'f1': 0.8650713, 'auroc': 0.99690044}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     2    1    1     4     6     6    1     41
1     0  1249    0     8    0    0     2    66     4    0      3
2     5     0  226     2   27    4     1     6     6   27      8
3     1     1    0  7848    0   18     0   434   136    2      0
4     4     0   29     0  295    2     2     2    23    7    175
5     2     0    2    21    0  403     0     0    10   82      1
6    23     0    0     1    1    2  1831    11     8    2     29
7     0    10    2    87    1    0     2  7104    49    1      9
8     0     1    4    78    6    3     0   122  3047    1     34
9     5     0   55     4    0   58     1     5    11  349      5
10    9     0    3     6   19    1     5    22    42    1  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7165046, 'precision': 0.62001467, 'recall': 0.60751164, 'specificity': 0.9713627, 'f1': 0.5832968, 'auroc': 0.8786752}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1080     0    0  20    0    0    12    21    19    4    14
1      1  1319    1  22    0    1     5    93     8    5    44
2     17     2   85   3  207    9     8    21   296   63   304
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    0   0  102    0     1     0    14    0  1515
5     24     0    0  54    1  324     6     0    20  155     8
6      0     1    0   1    1    0  2889     3    32    0   140
7      0     2    1  26    0    1     3  1120     6    0     5
8      0     0    1  44    3    6    14     8  1286    3     5
9     60    18  192  36   14  107    10    33   227  391    49
10     0     0    0   0    0    0     0     0     1    0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 08:35:20.366287,epoch time: 0:45:02.980183,used: 1:31:53.005197,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95743257, 'precision': 0.889274, 'recall': 0.8644084, 'specificity': 0.9953099, 'f1': 0.87431365, 'auroc': 0.99785984}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     1    0     3    3    0     5     3     1    3     60
1     0  1299    1    11    0    0     0    17     2    0      2
2     0     0  231     1   44    0     0     0     3   31      2
3     2     4    2  8207    1    1     0   132    84    3      0
4     3     0   17     1  362    0     0     2    11    3    140
5     1     0    3    45    1  360     0     0     2  108      1
6     6     1    3     0    3    0  1863     0     6    2     23
7     3    55   14   150    5    0     3  6891   104    3     34
8     1     1    6   107    9    3     4    31  3074    8     52
9     0     0   73     5    3   30     0     0     1  379      2
10    4     0    3     6   35    0     4     3    23    2  12715
---- Validation: 
scalar performance:
{'acc': 0.9579243, 'precision': 0.8892832, 'recall': 0.8675103, 'specificity': 0.9953923, 'f1': 0.87557316, 'auroc': 0.99774814}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     3    3    0     4     2     1    8     50
1     0  1296    0    12    0    0     0    18     4    0      2
2     1     0  236     0   48    0     1     0     2   23      1
3     0     3    1  8210    1    4     1   132    86    2      0
4     3     0   16     1  364    0     1     1    10    5    138
5     0     0    1    39    1  355     0     0     4  120      1
6     5     0    2     3    4    0  1856     4     5    2     27
7     2    52   21   136    2    0     2  6904   117    3     26
8     1     1    8    99   11    2     3    38  3083    2     48
9     0     0   75     4    4   22     0     2     2  384      0
10    6     1    3     5   40    0     2     4    21    2  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70069265, 'precision': 0.64423454, 'recall': 0.5720136, 'specificity': 0.970065, 'f1': 0.574403, 'auroc': 0.87328845}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   955     1    6   52    2    0    41     6     5   35    67
1     1  1396    3   31    0    0     1    23     3    3    38
2     0    10  162   23  323    0    11     8   194   43   241
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    0    0  163    0     1     0     8    1  1459
5     3     0    5  212    3  140     2     0     2  221     4
6     0     2    1    1    1    0  2963     1     5    0    93
7     1     6   16   62    0    0     3  1058    11    0     7
8     0     1    4  159    6    0    25     0  1165    3     7
9     4    28  367  173   30   31     9     8    95  369    23
10    0     0    0    0    2    0     0     0     0    0  1644
better model found
persisted
after epoch: 3,now: 2024-07-28 09:20:33.417621,epoch time: 0:45:13.051334,used: 2:17:06.056531,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9580747, 'precision': 0.90522635, 'recall': 0.8874884, 'specificity': 0.9953638, 'f1': 0.8956445, 'auroc': 0.99856675}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     4    1    0     2     6     1    4     19
1     0  1240    0     8    0    0     0    82     1    0      1
2     1     0  236     0   31    1     0     9     1   33      0
3     0     0    0  8137    0   13     0   273    14    1      0
4     3     1   17     1  406    2     0     4    11    3     90
5     1     0    0    16    0  453     0     0     3   47      1
6    13     0    2     4    2    1  1861     7     2    2     14
7     1     3    1    72    1    0     1  7167    11    0      4
8     1     0    4   261   14   10     1   149  2821    3     32
9     1     0   44     4    0   67     0     4     0  372      1
10   12     0    2     6   59    1     5    19    18    2  12670
---- Validation: 
scalar performance:
{'acc': 0.95730907, 'precision': 0.9028734, 'recall': 0.8849724, 'specificity': 0.99528587, 'f1': 0.89325744, 'auroc': 0.998421}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     1    0     4    0    0     1     9     0    2     12
1     0  1247    0     6    0    0     0    77     1    0      1
2     2     0  228     1   34    1     0     8     2   36      0
3     0     0    0  8109    0   15     0   293    23    0      0
4     4     1   14     0  401    2     0     7    13    5     92
5     0     0    1    17    0  443     0     1     2   56      1
6     9     0    1     3    3    0  1864     6     3    3     16
7     0     2    1    68    1    0     1  7180     8    0      4
8     1     0    4   255   17    8     0   154  2817    6     34
9     2     0   43     4    0   63     0     5     0  376      0
10   16     1    4     6   56    0     1    24    17    1  12670
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68711954, 'precision': 0.65176463, 'recall': 0.5846238, 'specificity': 0.9688709, 'f1': 0.5822896, 'auroc': 0.8804065}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   970     0    0   58    1    2    13    82    15   13    16
1     0  1085    0   31    1    0     0   324     3    0    55
2     1     1  123   33  265   10     1    80   258   59   184
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    3    0  357    0     1     2    10    1  1258
5     4     0    1  170    2  320     0     0     1   91     3
6     0     0    0    8    2    0  2703    10    31    0   313
7     0     0    0   20    0    0     0  1141     0    0     3
8     0     0    0  217    1    0     2    26  1118    2     4
9     6     3  150  203   22  133     1   122   104  377    16
10    0     0    0    0   18    0     0     1     0    0  1627
early stop counter: 1
val acc:0.9573090672492981, best validation acc: 0.9579243063926697, corresponding to test acc:                         0.7006926536560059 / 0.7165045738220215
after epoch: 4,now: 2024-07-28 10:05:41.953641,epoch time: 0:45:08.536020,used: 3:02:14.592551,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.92451495, 'recall': 0.89170897, 'specificity': 0.99640673, 'f1': 0.9049157, 'auroc': 0.99880636}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     2    1    0     0     4     0    2     11
1     0  1279    0     8    0    0     0    41     2    0      1
2     3     0  197     1   17    0     1     9     5   77      2
3     2     0    0  8189    0    7     0   184    54    0      0
4     5     0   18     2  369    1     0    10    19    3    110
5     0     0    0    10    0  468     0     0     5   37      1
6    12     0    0     1    0    0  1861     8     6    2     18
7     0     5    0    81    1    0     1  7162    10    0      4
8     2     0    2    77    0    1     0   126  3057    3     28
9     1     0   12     5    0   61     0     6     3  404      1
10   22     0    0     6   21    1     2    15    17    0  12711
---- Validation: 
scalar performance:
{'acc': 0.968918, 'precision': 0.92440104, 'recall': 0.899758, 'specificity': 0.9965977, 'f1': 0.9098966, 'auroc': 0.9989209}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    1    0     1     3     0    3      9
1     0  1274    0     9    0    0     0    46     1    0      2
2     2     0  206     0   14    2     0     8     4   73      3
3     1     0    0  8208    0    6     0   165    59    1      0
4     5     0   18     1  397    1     1     8    20    4     84
5     0     0    0    14    0  474     0     0     4   28      1
6    12     0    0     0    1    1  1861     6     6    2     19
7     0     6    0    67    1    0     1  7172    10    2      6
8     2     0    3    66    1    2     0   125  3068    1     28
9     4     0   12     2    0   67     0     3     4  401      0
10   21     0    1     7   27    0     3    18    21    1  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7055901, 'precision': 0.66128397, 'recall': 0.6082788, 'specificity': 0.97050464, 'f1': 0.5888316, 'auroc': 0.8829841}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1024     0   0   37    1    5    17    30    21   19    16
1      2  1240   0   32    0    0     0   148     5    0    72
2      3     0  41   12  198   21     0    36   391   67   246
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   1    0  297    0     1     1    23    1  1309
5      2     0   0   97    3  392     0     1    13   74    10
6      0     0   0    2    2    0  2674     6   131    0   252
7      1     0   0   80    0    1     1  1075     0    0     6
8      0     0   0  102    1    1     2    12  1246    2     4
9     10     4  35   93   16  215     2    65   191  463    43
10     0     0   0    0   12    0     0     0     1    0  1633
better model found
persisted
after epoch: 5,now: 2024-07-28 10:50:57.234834,epoch time: 0:45:15.281193,used: 3:47:29.873744,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97003424, 'precision': 0.9296876, 'recall': 0.9027566, 'specificity': 0.99667346, 'f1': 0.91366297, 'auroc': 0.99916834}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     4    0    0    13     0     0    3     23
1     0  1276    0     6    0    0     0    50     0    0      0
2     0     0  262     1    3    4     0     4     2   36      0
3     0     1    0  8364    0    5     2    40    24    0      0
4     2     0   33     0  385    2     0     2    10    3    102
5     0     0    1    23    0  481     0     1     4   10      1
6     3     0    1     1    0    0  1897     0     0    0      6
7     0     1    1   223    1    0     1  6992    36    0      9
8     0     2    3   115   11    1     1    56  3090    1     16
9     1     0   26     5    1  107     0     2     4  347      0
10    2     0    4     8   21    2     7     5    21    0  12722
---- Validation: 
scalar performance:
{'acc': 0.9704962, 'precision': 0.92915666, 'recall': 0.90327847, 'specificity': 0.99672455, 'f1': 0.91357815, 'auroc': 0.9991476}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    1     5    1    1    11     0     3    1     25
1     0  1284    0     6    0    0     0    40     1    0      1
2     1     0  262     0    5    3     1     5     3   32      0
3     0     1    0  8370    0    3     0    38    27    1      0
4     2     0   41     0  378    3     0     1    11    2    101
5     0     0    0    22    0  486     1     1     3    7      1
6     2     0    0     3    0    0  1890     0     1    2     10
7     1     3    0   207    1    0     2  7015    31    0      5
8     0     1    4   113   10    3     2    71  3074    0     18
9     0     0   25     5    1  103     0     1     2  356      0
10    3     0    5     7   26    2     6     4    11    0  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6791436, 'precision': 0.6587182, 'recall': 0.5629598, 'specificity': 0.96815634, 'f1': 0.5738208, 'auroc': 0.88123274}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   779     0    1   88    6   41   161    8     7   51    28
1     1  1197    0   38    0    0     5  211     3    0    44
2     0     4  160   46  252   29    35   19   271   58   141
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    0  273    0     4    0    15    1  1337
5     0     0    0  175    1  363     5    0     2   40     6
6     0     0    0    1    1    0  3038    3     2    0    22
7     0     0    0  371    0    0     4  781     4    0     4
8     0     0    1  208    3    0    38    1  1112    1     6
9     1    10  106  273   11  200    12   29   110  366    19
10    0     0    0    0    7    0     0    0     1    0  1638
better model found
persisted
after epoch: 6,now: 2024-07-28 11:36:15.090329,epoch time: 0:45:17.855495,used: 4:32:47.729239,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97602737, 'precision': 0.93193316, 'recall': 0.9311112, 'specificity': 0.9974654, 'f1': 0.92921877, 'auroc': 0.9994306}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    2    0     1     1     1    1      8
1     0  1306    0     6    0    0     0    19     1    0      0
2     1     0  211     0   17    1     3     7     2   68      1
3     1     0    0  8333    0    8     0    49    46    0      0
4     2     1   12     0  482    0     0     4    11    2     24
5     0     0    0     9    0  478     1     0     5   27      1
6     9     0    0     1    1    0  1883     1     0    1     11
7     0     7    0   123    1    0     1  7118    10    1      3
8     0     0    1    47    6    0     1    53  3169    2     17
9     1     0    5     1    0   41     1     0     0  444      0
10    8     1    2     7  125    0     5    30    28    0  12588
---- Validation: 
scalar performance:
{'acc': 0.9750435, 'precision': 0.92901754, 'recall': 0.930845, 'specificity': 0.9973832, 'f1': 0.9274069, 'auroc': 0.9993884}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     2    3    1     3     0     1    0      4
1     1  1306    0    10    0    0     0    15     0    0      0
2     1     0  214     0   14    1     2     4     5   71      0
3     1     1    0  8337    0    3     0    39    59    0      0
4     6     0   11     0  479    1     1     2    10    3     26
5     1     0    0     8    0  476     0     0     6   29      1
6    10     0    0     0    0    0  1882     1     1    1     13
7     1     8    0   120    1    0     1  7108    22    1      3
8     1     0    0    51    3    3     0    67  3164    0      7
9     1     0    6     1    0   31     2     2     3  446      1
10   11     2    1     8  151    0     2    25    25    0  12571
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7519065, 'precision': 0.6754728, 'recall': 0.64030266, 'specificity': 0.975165, 'f1': 0.6228668, 'auroc': 0.88638985}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1069     0   0   14    2    4    23    21     9   13    15
1      1  1320   0   18    0    4     0   134     6    2    14
2      6     4  48   17  301   32    15    50   331   61   150
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  638    0     2     3    20    1   969
5     12     0   0   82    2  419     8     0    17   45     7
6      0     0   0    2    1    1  2950     4    25    0    84
7      2     0   0  111    0    1     1  1047     0    0     2
8      0     0   0   60    1    4     8    17  1278    0     2
9     20    11  46   91   19  234    16    69   213  395    23
10     0     1   0    0   60    0     0     1     1    0  1583
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-28 12:45:23.163785,epoch time: 1:09:08.073456,used: 5:41:55.802695,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9654859, 'precision': 0.9099245, 'recall': 0.9211533, 'specificity': 0.99646914, 'f1': 0.91036147, 'auroc': 0.99925953}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    1     1    5    0    12     6     3    1     18
1     0  1322    0     1    0    0     0     5     2    0      1
2     1     0  270     0   29    0     0     3     3    5      1
3     1     7    0  8026    3    1    11   181   209    1      0
4     2     0    4     0  511    0     0     0    15    0      7
5     0     0    2    40    0  387     0     0    14   76      1
6     2     0    1     2    2    1  1886     0     6    0      7
7     0    10    2    55    1    0     5  7142    42    0      5
8     0     1    1     7   10    0     2    38  3225    0     12
9     0     0   66     7    5    4     0     4    12  395      0
10    2     0    2     6  256    0    11     6    24    0  12486
---- Validation: 
scalar performance:
{'acc': 0.9669654, 'precision': 0.9105548, 'recall': 0.92175263, 'specificity': 0.99664485, 'f1': 0.9106869, 'auroc': 0.99930775}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     2    6    0    14     2     7    0     17
1     0  1321    0     0    0    0     0     6     4    0      1
2     1     0  272     0   30    0     1     2     0    6      0
3     0     3    0  8078    0    1    11   147   200    0      0
4     0     0    6     0  509    0     1     1    12    0     10
5     0     0    1    41    0  384     0     0    15   79      1
6     0     0    0     0    1    0  1896     1     4    0      6
7     0    14    1    39    4    0     5  7155    43    0      4
8     0     0    1     9   12    0     2    32  3230    0     10
9     0     0   65     4    3    6     1     7    11  396      0
10    4     0    1     4  272    0    11     9    21    0  12474
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7237109, 'precision': 0.66295874, 'recall': 0.5961483, 'specificity': 0.97227764, 'f1': 0.5907324, 'auroc': 0.8837201}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   940     0    1   33    9    0    88    36    28   16    19
1     0  1254    0   12    2    0     4   169     8    0    50
2     0     6   91   15  377    3     6    36   372   41    68
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  882    0     2     1    17    1   730
5     7     1    5  235    2  147     3     1    56  130     5
6     0     1    0    1    5    0  2725     4   244    0    87
7     1     0    0   21    0    0     4  1128     5    0     5
8     0     0    0   19    1    0     4    24  1318    1     3
9     7    16  143  126   29   29    11   109   318  333    16
10    0     0    0    0  119    0     0     0     1    0  1526
early stop counter: 1
val acc:0.96696537733078, best validation acc: 0.9750434756278992, corresponding to test acc:                         0.7519065141677856 / 0.7519065141677856
after epoch: 8,now: 2024-07-28 14:16:22.731455,epoch time: 1:30:59.567670,used: 7:12:55.370365,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97923803, 'precision': 0.9523113, 'recall': 0.94351476, 'specificity': 0.9977745, 'f1': 0.9472957, 'auroc': 0.99966747}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     1    0    0    22     0     1    0     17
1     0  1309    0     4    0    0     0    15     3    0      1
2     0     0  280     0    3    0     3     0     1   25      0
3     0     0    1  8293    0    2     0    31   109    1      1
4     4     0   13     0  455    1     0     0     7    1     58
5     0     0    0     5    0  494     2     0     3   16      1
6     0     0    0     1    0    0  1901     0     3    0      3
7     0     2    9   115    3    0     2  7009   110    0     15
8     0     0    3    15    2    0     1     6  3261    0      7
9     0     0   15     3    0   49     1     0     0  425      0
10    0     0    4     6   22    0    11     1    15    0  12731
---- Validation: 
scalar performance:
{'acc': 0.9785743, 'precision': 0.95256805, 'recall': 0.94286644, 'specificity': 0.99771196, 'f1': 0.9469115, 'auroc': 0.999575}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     2    2    0    24     0     2    2      7
1     0  1311    0     3    0    0     0    13     5    0      0
2     0     0  286     0    4    0     2     0     1   19      0
3     2     0    2  8285    0    2     0    23   124    2      0
4     5     0   15     0  442    0     2     0    11    1     63
5     0     0    0    12    0  492     3     0     1   12      1
6     0     0    0     1    0    0  1899     0     0    0      8
7     1     3    4   114    2    1     1  7004   119    1     15
8     0     0    1    21    5    2     1     2  3258    2      4
9     0     0   21     2    0   44     0     0     1  425      0
10    1     0    1     7   13    0    10     0    26    0  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69005805, 'precision': 0.6383304, 'recall': 0.56888306, 'specificity': 0.96817803, 'f1': 0.56512797, 'auroc': 0.87408406}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   609     0    0   30    2    1   399    38    40   23    28
1     0  1256    0   24    0    0    15   139     8    2    55
2     0     2  128   11  332   23    88     9   200   39   183
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  261    0     5     0    17    1  1347
5     0     0    2  131    4  309    52     0    11   70    13
6     0     0    0    1    1    0  3025     0    10    0    30
7     0     1    0   90    0    0    10  1050     8    0     5
8     0     0    2   46    6    0    45    10  1256    2     3
9     3     8  146  109   32  178   129    31   133  331    37
10    0     0    0    0    7    0     0     0     1    0  1638
better model found
persisted
after epoch: 9,now: 2024-07-28 15:49:58.949837,epoch time: 1:33:36.218382,used: 8:46:31.588747,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9825824, 'precision': 0.94486284, 'recall': 0.94174343, 'specificity': 0.99818087, 'f1': 0.938651, 'auroc': 0.9997642}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    1     3    4    3     4     0     0    1      6
1     0  1326    0     2    0    0     0     3     1    0      0
2     0     0  298     0    4    3     0     0     0    7      0
3     0     0    0  8399    0   10     0    15    12    0      0
4     4     0   16     0  475    2     2     0    11    2     27
5     0     0    0     2    0  516     0     0     0    3      0
6     3     0    1     1    0    2  1896     1     0    1      3
7     1    23    1   107    0    0     0  7110    18    0      3
8     2     1    1    64    0    4     1    10  3205    1      5
9     0     0   19     0    0  155     0     0     0  319      0
10   23     0    2     7   13    2     5     8    15    0  12720
---- Validation: 
scalar performance:
{'acc': 0.9817039, 'precision': 0.9449423, 'recall': 0.9410991, 'specificity': 0.9980844, 'f1': 0.9387132, 'auroc': 0.99973524}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     2    2    1     3     1     0    0      2
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     0  287     0    3    6     0     0     2   14      0
3     0     0    0  8408    0    4     0    17    11    0      0
4     6     0    8     0  483    2     3     0    12    0     25
5     0     0    0     4    0  515     0     0     0    2      0
6     2     0    1     2    0    1  1896     1     0    0      5
7     0    19    0   112    1    0     1  7105    24    0      3
8     3     2    2    65    1    4     2    20  3188    1      8
9     0     0   17     4    0  152     0     1     1  318      0
10   31     1    1     6   19    2     8     7    21    0  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7227314, 'precision': 0.6702119, 'recall': 0.6069545, 'specificity': 0.972548, 'f1': 0.6040778, 'auroc': 0.88263756}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   958     4    0   63    3   15    44   52    10   16     5
1     3  1360    0   34    0    1     5   74     3    1    18
2     2     2  215   29  337   41    35   27   213   16    98
3     0     0    0    0    0    0     0    0     0    0     0
4     2     0    3    0  494    0    16    2    16    0  1100
5     5     0    6  154    2  399     6    0     4   12     4
6     0     0    0    4    1    0  3040    3     2    0    17
7     2     0    1  186    0    1     1  970     0    0     3
8     0     1    0  195    1    5    21   12  1130    0     5
9    10     8  258  243   20  290    19   56    70  151    12
10    0     0    0    0   28    0     2    1     2    0  1613
better model found
persisted
after epoch: 10,now: 2024-07-28 17:28:57.556759,epoch time: 1:38:58.606922,used: 10:25:30.195669,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 10:25:30.195669 at 2024-07-28 17:28:57.556759
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7227314, 'precision': 0.6702119, 'recall': 0.6069545, 'specificity': 0.972548, 'f1': 0.6040778, 'auroc': 0.88263756}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   958     4    0   63    3   15    44   52    10   16     5
1     3  1360    0   34    0    1     5   74     3    1    18
2     2     2  215   29  337   41    35   27   213   16    98
3     0     0    0    0    0    0     0    0     0    0     0
4     2     0    3    0  494    0    16    2    16    0  1100
5     5     0    6  154    2  399     6    0     4   12     4
6     0     0    0    4    1    0  3040    3     2    0    17
7     2     0    1  186    0    1     1  970     0    0     3
8     0     1    0  195    1    5    21   12  1130    0     5
9    10     8  258  243   20  290    19   56    70  151    12
10    0     0    0    0   28    0     2    1     2    0  1613
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7519065, 'precision': 0.6754728, 'recall': 0.64030266, 'specificity': 0.975165, 'f1': 0.6228668, 'auroc': 0.88638985}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1069     0   0   14    2    4    23    21     9   13    15
1      1  1320   0   18    0    4     0   134     6    2    14
2      6     4  48   17  301   32    15    50   331   61   150
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  638    0     2     3    20    1   969
5     12     0   0   82    2  419     8     0    17   45     7
6      0     0   0    2    1    1  2950     4    25    0    84
7      2     0   0  111    0    1     1  1047     0    0     2
8      0     0   0   60    1    4     8    17  1278    0     2
9     20    11  46   91   19  234    16    69   213  395    23
10     0     1   0    0   60    0     0     1     1    0  1583
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_03_26_seed_1_23104518_instance_wise_predictions.txt
accuracy from prediction file 0.722731406982439
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |   1647 MiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      6 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  31154 MiB |  14634 MiB |
|       from large pool |  16492 MiB |  16492 MiB |  31124 MiB |  14632 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 237632 KiB | 631720 KiB | 126227 GiB | 126227 GiB |
|       from large pool | 216320 KiB | 628608 KiB | 120386 GiB | 120386 GiB |
|       from small pool |  21312 KiB |  25684 KiB |   5841 GiB |   5841 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   60095 K  |   60092 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2399    |    3599    |   33299 K  |   33296 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   60095 K  |   60092 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2399    |    3599    |   33299 K  |   33296 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     828    |     361    |
|       from large pool |     453    |     453    |     813    |     360    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     122    |     570    |   33509 K  |   33509 K  |
|       from large pool |      95    |     304    |   17481 K  |   17481 K  |
|       from small pool |      27    |     461    |   16027 K  |   16027 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |  16640 KiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1888 MiB |  16520 MiB |  31154 MiB |  29266 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  31124 MiB |  29264 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 631720 KiB | 126228 GiB | 126228 GiB |
|       from large pool |  24320 KiB | 628608 KiB | 120387 GiB | 120387 GiB |
|       from small pool |      0 KiB |  25684 KiB |   5841 GiB |   5841 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   60095 K  |   60095 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3599    |   33299 K  |   33299 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   60095 K  |   60095 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3599    |   33299 K  |   33299 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     107    |     467    |     828    |     721    |
|       from large pool |      93    |     453    |     813    |     720    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     570    |   33510 K  |   33510 K  |
|       from large pool |       3    |     304    |   17481 K  |   17481 K  |
|       from small pool |       0    |     461    |   16028 K  |   16028 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 17:48:53 2024]
Finished job 0.
1 of 1 steps (100%) done
