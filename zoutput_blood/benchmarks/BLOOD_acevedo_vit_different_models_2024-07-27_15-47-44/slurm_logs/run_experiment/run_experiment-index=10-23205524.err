Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 29 09:38:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524

 Experiment start at: 2024-07-29 10:03:19.399167
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.56897473, 'precision': 0.5481146, 'recall': 0.52636176, 'specificity': 0.95773554, 'f1': 0.46630463, 'auroc': 0.93906087}
confusion matrix:
     0     1   2     3   4    5      6     7     8    9    10
0   116     0   0    12   0    3    191   108    45    5    3
1     1  1159   0    12   0    0     16   137     5    0    1
2    11     7   0     2   0    4     32    89    72   91    4
3     0     0   0  7600   0    4      3   640   191    0    0
4    26     1   0     1   0    4    292    26   163   10   16
5     0     0   0   145   0  235      1     7    10  123    0
6     3     2   0     9   0    2   1808    43    41    0    0
7    11     7   0   108   0    0      7  7012   119    0    0
8     1     0   0   113   0    1     20   246  2914    0    1
9     2     1   0    20   0  133      5    64    13  255    0
10  113     1   0     9   0    1  12040    37   421    2  167
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5688645, 'precision': 0.55074954, 'recall': 0.5272594, 'specificity': 0.95771766, 'f1': 0.46850622, 'auroc': 0.9363759}
confusion matrix:
     0     1   2     3   4    5      6     7     8    9    10
0   111     0   0    11   0    6    193   111    44    4    3
1     0  1155   0    13   0    3     20   132     8    0    1
2    15     7   0     2   0    4     29    98    74   80    3
3     0     0   0  7613   0    3      3   617   204    0    0
4    33     0   0     3   0    3    289    17   159   15   20
5     0     0   0   140   0  242      2     6    15  116    0
6     2     1   0    12   0    1   1812    31    47    2    0
7     8    11   0   125   0    0      9  6978   128    0    6
8     0     0   0   120   0    0     23   226  2925    1    1
9     2     4   0    26   0  117      9    59    17  259    0
10   85     0   0     8   0    0  12057    36   437    1  172
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48205414, 'precision': 0.3984968, 'recall': 0.38975903, 'specificity': 0.9444747, 'f1': 0.32979882, 'auroc': 0.80473626}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9   10
0   49     0   0   33   0    2   302   653   121   10   0
1    1  1135   0   25   0    2    91   231    13    0   1
2   23     2   0    5   0    8   126   235   554   54   8
3    0     0   0    0   0    0     0     0     0    0   0
4    8     0   0    0   0    0  1468     2    96    0  59
5    0     0   0  146   0  260    28    47    36   75   0
6    0     1   0    1   0    0  2753    13   299    0   0
7    0     0   0    4   0    0     2  1153     4    0   1
8    0     0   0   61   0    0     1    38  1270    0   0
9    7     5   0   68   0   91    37   480   188  257   4
10   1     0   0    0   0    0  1629     1     2    0  13
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 11:25:02.339733,epoch time: 1:21:42.940566,used: 1:21:42.940566,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.91031677, 'precision': 0.705788, 'recall': 0.6963664, 'specificity': 0.99059236, 'f1': 0.67432004, 'auroc': 0.9778129}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   256     2   0     6   0    6    98    13     3   13     86
1     0  1283   0     9   0    2     6    26     4    1      1
2     0    35   0     3   2   17    41    61    15  132      6
3     0     7   0  7842   0   38     9   380   154    3      2
4     5    12   0     1   2   17   254    16    38   30    164
5     0     1   0    36   0  379     1     0     7   96      1
6     5     4   0     1   0    4  1876     4     4    4      6
7     0    94   0   112   1    1     5  6963    75    2     11
8     2     5   0    85   0    5    20   136  2984    3     56
9     1     4   0     5   0  112     2    12     3  352      2
10   15    14   0    11   0    8   586    18    44   10  12087
---- Validation: 
scalar performance:
{'acc': 0.91154206, 'precision': 0.7629191, 'recall': 0.6946957, 'specificity': 0.99071205, 'f1': 0.6733023, 'auroc': 0.97730935}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   239     1   0     6   0    2   101    18     3   16     97
1     0  1279   0     9   0    5     2    30     4    0      3
2     2    38   0     2   0   11    40    55    14  142      8
3     0     9   0  7867   0   28     4   386   145    0      1
4     5    12   0     4   1   15   256    13    39   29    165
5     0     0   0    32   0  383     0     2     5   98      1
6     2     4   0     2   0    2  1877     4     5    2     10
7     1   102   0   111   0    0     9  6957    74    2      9
8     0     4   0    79   0    7    28   122  3003    5     48
9     0     6   0     4   0  114     1     8     5  354      1
10   13    15   0     8   0    8   561    18    46    9  12118
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6794935, 'precision': 0.5132447, 'recall': 0.5779418, 'specificity': 0.9665355, 'f1': 0.5221081, 'auroc': 0.83812785}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   536     4   0   9   0   24   317   131    15   93    41
1     0  1315   0  17   0   19    25   108     9    3     3
2     9    39   0   4   0   75   312   145   235  144    52
3     0     0   0   0   0    0     0     0     0    0     0
4     3     3   0   0   0    3   522     1    17    0  1084
5     2     0   0  19   0  485     7     1     4   74     0
6     0     5   0   9   0    2  2984    13    39    0    15
7     0     1   0   6   0    1     1  1148     2    0     5
8     0     1   0  41   0   23    33    14  1257    1     0
9     5    59   0  23   0  320    26   159   102  437     6
10    0     1   0   0   0    0    95     0     0    0  1550
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 12:38:43.704229,epoch time: 1:13:41.364496,used: 2:35:24.305062,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9351723, 'precision': 0.7765155, 'recall': 0.71265966, 'specificity': 0.9926716, 'f1': 0.7214591, 'auroc': 0.9859888}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   315     0   0     6   0    0     6    49    22    4     81
1     0  1276   0    10   0    2     0    36     3    0      5
2     2     7   0   158  23    6     5    32     4   55     20
3     0     1   0  8162   0   17     0   160    95    3      1
4     3     0   0    68  56    3    91    15    17    5    281
5     0     0   0    37   0  441     0     0     4   38      1
6     7     0   0     7   0    2  1858     3     3    0     28
7     1    60   0   168   1    2     1  6934    75    1     19
8     1     2   0   131   0    6     0    79  3010    4     63
9     1     1   0    48   2  184     0     6     8  236      6
10   20     2   0    16   2    1    26    22    36    2  12665
---- Validation: 
scalar performance:
{'acc': 0.9346797, 'precision': 0.7821818, 'recall': 0.7122303, 'specificity': 0.9926115, 'f1': 0.72131443, 'auroc': 0.9852346}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   316     0   0     7   0    1     3    38    22    5     91
1     0  1277   0    10   0    4     1    30     5    0      5
2     1     4   0   168  17    5     6    28     7   55     21
3     0     3   0  8158   0   15     1   156   103    4      0
4     3     1   0    72  54    4    92    10    16    6    281
5     0     0   0    42   0  439     0     0     5   34      1
6    10     0   0     4   0    1  1854     8     1    1     29
7     1    49   0   178   0    1     2  6928    84    3     19
8     1     4   0   132   2    2     0    95  3005    3     52
9     2     2   0    50   0  182     0     6     7  239      5
10   18     2   0    12   1    2    24    21    40    3  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6741062, 'precision': 0.5420767, 'recall': 0.56863886, 'specificity': 0.96707165, 'f1': 0.52924323, 'auroc': 0.8626706}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   717     0   0   24   0    5   108   210    52   24    30
1     0  1242   0   42   0    6    11   170     4    0    24
2    26    10   0  133  69   23   170    49    90   58   387
3     0     0   0    0   0    0     0     0     0    0     0
4     3     1   0    1   1    0    38     1     6    0  1582
5     4     0   0   63   0  452    10     2     4   56     1
6     0     1   0   12   0    0  2987     1     5    0    61
7     0     0   0   60   0    2     0  1089     6    0     7
8     0     0   0  105   0   15    31     6  1204    1     8
9    19    28   0  173  14  261    40    99   142  297    64
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 3,now: 2024-07-29 13:56:48.082291,epoch time: 1:18:04.378062,used: 3:53:28.683124,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9216877, 'precision': 0.85129774, 'recall': 0.7073308, 'specificity': 0.9913846, 'f1': 0.7167113, 'auroc': 0.9885906}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   288     0   0     0   0    0    48     8     1    1    136
1     0  1258   0    11   0    0     9    35    11    1      7
2     2     1   5   133  48    0    21    32     4   50     16
3     3     1   0  7979   1   38    59   123   222    5      7
4     0     0   0    25  83    1   216     4     9    1    200
5     0     0   0    16   0  292     2     1     8  193      9
6     3     0   0     0   0    0  1885     0     2    0     18
7     3    20   0   342   2    0    25  6606   237    6     23
8     3     0   0    41   0    3    29    60  3049    7    104
9     3     1   0    33   1   31     6    21     4  371     22
10   10     0   0    11   3    0   112     7    14    1  12633
---- Validation: 
scalar performance:
{'acc': 0.92181355, 'precision': 0.8211825, 'recall': 0.71279216, 'specificity': 0.9914188, 'f1': 0.7196597, 'auroc': 0.9884302}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   300     0   0     1   0    0    40     5     2    1    134
1     1  1250   0    14   0    0    10    41     9    0      7
2     3     3   2   122  52    1    19    38     5   53     14
3     3     1   0  7941   0   49    61   133   235    5     12
4     1     0   0    22  92    1   209     5     8    1    200
5     0     0   0    13   0  296     3     0     7  195      7
6     1     0   0     0   1    0  1879     0     2    0     25
7     5    14   0   338   0    1    31  6614   233    3     26
8     1     0   0    43   2    0    32    49  3071    8     90
9     6     2   1    25   1   25     3    27     2  385     16
10   10     0   0    11   3    0   122     4    12    2  12632
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6611628, 'precision': 0.5461933, 'recall': 0.54088354, 'specificity': 0.9653412, 'f1': 0.52441144, 'auroc': 0.8581402}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   888     0   0    1   0    0    88   11     6    9   167
1     1  1141   0   32   4   11    23  177    23   11    76
2    11     0   0  100  53    9   243   41   103   85   370
3     0     0   0    0   0    0     0    0     0    0     0
4     1     0   0    0   2    0    96    0     5    0  1529
5     4     0   0    7   0  280    15    2     7  252    25
6     0     0   0    0   0    1  3036    0     1    0    29
7     3     1   0  378   0    0   149  553    57   15     8
8     0     0   0   27   0   17    72    0  1235   10     9
9    16     6   0   56   6   67    28  103    89  671    95
10    0     0   0    0   0    0     2    0     0    0  1644
early stop counter: 1
val acc:0.9218135476112366, best validation acc: 0.9346796870231628, corresponding to test acc:                         0.6741061806678772 / 0.6794934868812561
after epoch: 4,now: 2024-07-29 14:59:35.616888,epoch time: 1:02:47.534597,used: 4:56:16.217721,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9432791, 'precision': 0.8361124, 'recall': 0.74153596, 'specificity': 0.9936444, 'f1': 0.7531451, 'auroc': 0.99139535}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   325     0   0     1   0    0     4    22     8    5    118
1     0  1280   0    10   0    1     3    30     4    0      3
2     0     8   9    91  78    3     8    18    10   76     11
3     0     3   0  8144   0   12     1   149   128    1      1
4     1     3   1    10  84    1   159     9    18    4    249
5     0     0   0    23   0  427     0     1     5   63      1
6    12     0   0     3   1    1  1825     1     3    1     61
7     0    26   0   133   1    1     2  6990    94    1     15
8     1     2   0    73   1    1     4    53  3113    2     45
9     0     4   4    17   2  104     0    14     4  342      2
10    5     0   0    11   4    0    19    13    22    2  12717
---- Validation: 
scalar performance:
{'acc': 0.9427043, 'precision': 0.8280705, 'recall': 0.741784, 'specificity': 0.9936402, 'f1': 0.7515458, 'auroc': 0.9914409}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   340     0   0     5   0    1     2    23     4    2    106
1     0  1282   0    16   0    1     1    26     4    0      2
2     0    14   9    84  83    2    13    14     8   77      8
3     0     1   1  8114   0   20     1   170   130    1      2
4     1     4   0    20  79    0   178     8    22    4    223
5     0     0   0    22   0  427     0     0     5   64      3
6     6     2   0     6   2    0  1832     0     8    0     52
7     0    21   0   124   1    2     2  6994   109    1     11
8     1     2   0    67   0    2     2    58  3113    3     48
9     0     5   5    22   1  114     1     5     5  333      2
10    4     0   0    11   3    0    20     7    30    1  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69859374, 'precision': 0.62282926, 'recall': 0.5884191, 'specificity': 0.9692912, 'f1': 0.55062234, 'auroc': 0.86283046}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   864     3   0  16    0    4    30    78    20   21   134
1     0  1263   0  30    0    2    10   175     7    2    10
2     3    27   8  38  116   19   242    44   273   75   170
3     0     0   0   0    0    0     0     0     0    0     0
4     1     1   0   0    3    0   114     1     8    0  1505
5     2     0   0  71    0  398    15     0    16   82     8
6     0     0   0   3    0    0  3039     2     9    0    14
7     0     0   0  63    0    1     2  1090     3    0     5
8     0     0   0  69    0    6    15     3  1274    0     3
9     7    50   2  67   17  165    19    88   290  402    30
10    0     0   0   0    1    0     1     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 16:10:26.520300,epoch time: 1:10:50.903412,used: 6:07:07.121133,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9402023, 'precision': 0.8077202, 'recall': 0.7379623, 'specificity': 0.99327564, 'f1': 0.7545761, 'auroc': 0.99208957}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   316     0   0     1    0    0     9    14     3    1    138
1     0  1229   0    12    0    0     6    77     4    0      4
2     2     1   0   163   24    1     5    24     4   81      7
3     0     1   0  7978    0    7    26   210   211    2      4
4     0     0   0    46  116    1   141     9     7    4    215
5     0     0   0    48    0  376     2     0     8   82      4
6     3     0   0     2    0    0  1871     2     1    0     29
7     1     2   0   115    2    0     4  7085    43    1     11
8     2     0   0    32    0    0     3   100  3118    4     37
9     1     0   0    25    0   72     2     7     2  376      8
10    8     0   0    13    5    0    37    17    34    1  12676
---- Validation: 
scalar performance:
{'acc': 0.9402434, 'precision': 0.81316304, 'recall': 0.7428023, 'specificity': 0.99330676, 'f1': 0.7599695, 'auroc': 0.9916415}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   319     0   0     2    0    0     9    13     2    3    135
1     0  1233   0    10    0    0     3    75     7    0      4
2     0     0   0   161   25    1     6    23     3   88      5
3     1     0   0  7963    0    6    23   204   238    3      2
4     0     0   0    48  132    2   130     8    15    2    202
5     0     0   0    45    0  383     1     0     7   84      1
6     2     0   0     2    0    0  1876     0     1    0     27
7     0     4   0   107    1    0     5  7093    49    1      5
8     1     0   0    44    0    0    10   100  3100    3     38
9     0     0   0    24    0   63     3    12     2  380      9
10    6     0   0    21    2    0    45    18    32    0  12672
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6675296, 'precision': 0.557032, 'recall': 0.5532257, 'specificity': 0.96623194, 'f1': 0.5234648, 'auroc': 0.8634962}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   603     0   0    2   0    4    85    35     1   17   423
1     0  1056   0   37   1    1    13   350    19    2    20
2     5     0   0   86  36    9    87    95   196  110   391
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    2   4    0    90     2     9    0  1525
5     0     0   0   82   0  350    34     0    19   90    17
6     0     0   0    2   0    0  3063     1     0    0     1
7     0     0   0   25   0    1    10  1121     2    0     5
8     0     0   0   92   0    2    35     4  1232    0     5
9     2     6   1  110   2  142    30   145   150  470    79
10    0     0   0    0   0    0     3     0     1    0  1642
early stop counter: 1
val acc:0.9402434229850769, best validation acc: 0.9427043199539185, corresponding to test acc:                         0.6985937356948853 / 0.6985937356948853
after epoch: 6,now: 2024-07-29 17:09:34.513172,epoch time: 0:59:07.992872,used: 7:06:15.114005,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9423427, 'precision': 0.78990644, 'recall': 0.7213875, 'specificity': 0.9935048, 'f1': 0.7347434, 'auroc': 0.99184793}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   206     0   0    10   0    2     1    78     1    2    183
1     0  1277   0    15   0    1     1    36     1    0      1
2     0     7   0    98  60    2    14    20     4   98      9
3     0     2   0  8336   0    7     2    53    36    2      0
4     0     9   1    10  89    5   200    19    16    5    185
5     0     0   0    33   0  420     0     1     1   65      1
6     1     0   0     5   0    1  1863     5     5    1     27
7     0     7   0   178   0    0     3  7045    22    3      4
8     0     1   0   190   4    2     3   132  2936    3     24
9     0     2   0    17   0   91     1     1     2  376      3
10    1     2   0    11   4    3    31    31    37    0  12673
---- Validation: 
scalar performance:
{'acc': 0.9421693, 'precision': 0.8263099, 'recall': 0.7229918, 'specificity': 0.99345464, 'f1': 0.73796535, 'auroc': 0.99226487}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   208     0   0    10   0    0     7    69     1    4    184
1     0  1277   0    16   0    0     0    37     1    0      1
2     0     7   1   106  52    2    13    17     5  101      8
3     0     1   0  8341   0   10     0    63    25    0      0
4     0     6   2    14  96    6   190    10    17    4    194
5     0     0   0    29   0  423     0     0     1   66      2
6     0     0   0     6   1    1  1855     5     2    1     37
7     0     7   0   205   0    0     2  7026    21    0      4
8     0     2   0   189   2    2     0   144  2936    5     16
9     0     2   0    19   0   87     1     3     3  375      3
10    3     1   0    13   2    1    33    22    35    1  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6088295, 'precision': 0.6165655, 'recall': 0.49050885, 'specificity': 0.96004784, 'f1': 0.44418436, 'auroc': 0.8501934}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   53     3   0   23   1   25   220   46     0   46   753
1    0  1260   0   52   0    1     5  172     0    1     8
2    0    23   1   81  99   94   341   78   155   66    77
3    0     0   0    0   0    0     0    0     0    0     0
4    0     0   0    1   2    1   340    2    11    0  1276
5    0     3   0  123   0  400    45    0     2   19     0
6    0     0   0    4   0    0  3057    3     2    0     1
7    0     0   0  170   0    1     9  981     0    0     3
8    0     0   0  262   0    2    45    4  1056    0     1
9    0    41   0  227   9  340    61   81    97  265    16
10   0     0   0    0   1    0    18    0     0    0  1627
early stop counter: 2
val acc:0.9421693086624146, best validation acc: 0.9427043199539185, corresponding to test acc:                         0.6985937356948853 / 0.6985937356948853
after epoch: 7,now: 2024-07-29 18:14:58.598830,epoch time: 1:05:24.085658,used: 8:11:39.199663,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9379816, 'precision': 0.8825592, 'recall': 0.7012652, 'specificity': 0.9928602, 'f1': 0.7173269, 'auroc': 0.99279803}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   135     0   0     3    0    0     1    50     4    7    283
1     0  1300   0     3    0    0     0    24     3    1      1
2     0     2   4   122   36    1     3    36     2   91     15
3     0     6   0  8102    0    8     0   243    77    2      0
4     0     2   1    20  124    2    98     9    18    4    260
5     0     0   0    31    0  254     0     0     3  232      1
6     1     1   0     2    0    2  1837     2     3    3     56
7     0    13   0   115    1    0     2  7079    44    0     10
8     0     0   0    73    4    2     1   133  3042    3     35
9     0     2   0    11    0   11     0    12     3  449      5
10    0     1   0     9    1    2     5    18    26    1  12732
---- Validation: 
scalar performance:
{'acc': 0.93839777, 'precision': 0.8787283, 'recall': 0.70284826, 'specificity': 0.9929127, 'f1': 0.71894115, 'auroc': 0.9924541}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   145     0   0     6    0    0     1    55     4    9    263
1     0  1295   0     2    0    0     0    30     2    2      1
2     0     2   3   129   41    1     1    28     8   88     11
3     0     7   0  8103    0    4     0   248    73    3      2
4     0     4   1    26  117    0   100     7    11    6    267
5     0     0   0    31    0  259     0     0     4  226      1
6     0     0   0     4    0    1  1837     3     6    4     53
7     0    15   0   101    1    0     1  7088    43    1     15
8     0     1   0    80    3    1     1   126  3047    2     35
9     0     1   0    12    0   11     0    12     2  452      3
10    0     1   0     9    1    2     4    14    28    1  12736
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6504583, 'precision': 0.6404065, 'recall': 0.5198584, 'specificity': 0.96469676, 'f1': 0.4730571, 'auroc': 0.860465}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   73     2   0   14   0   30    31    91    24  175   730
1    0  1273   0   14   0    1     3   194     5    2     7
2    0    21   5  119  65   17    84    58   192  168   286
3    0     0   0    0   0    0     0     0     0    0     0
4    0     2   0    2   6    1    68     2     7    1  1544
5    0     1   0   87   0  185     4     0     3  311     1
6    0     0   0    1   0    0  3044     3    11    1     7
7    0     0   0   30   1    0     4  1125     1    1     2
8    0     1   0  128   1    4    20     8  1202    3     3
9    0    32   0   84   1   34     5    84   133  739    25
10   0     0   0    0   0    0     0     1     0    0  1645
early stop counter: 3
val acc:0.9383977651596069, best validation acc: 0.9427043199539185, corresponding to test acc:                         0.6985937356948853 / 0.6985937356948853
after epoch: 8,now: 2024-07-29 19:08:45.734895,epoch time: 0:53:47.136065,used: 9:05:26.335728,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9354666, 'precision': 0.82244706, 'recall': 0.68852437, 'specificity': 0.9924484, 'f1': 0.7047407, 'auroc': 0.994288}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   58     1   0     0    0    0     6    32     2    1    383
1    0  1278   0     5    0    0     0    42     3    1      2
2    0     1   0   159   25    0     2    39     9   56     21
3    0     1   0  7924    0    7     2   292   207    2      2
4    0     0   0    15  127    0    97     5    19    1    275
5    0     0   0    30    0  313     0     0     9  168      1
6    0     0   0     4    0    0  1808     2     2    1     91
7    0     9   0    53    0    0     1  7142    47    1     10
8    0     0   0    22    0    0     0    67  3161    0     45
9    0     1   0    31    0   24     0    16     8  410      3
10   0     2   0     7    1    0     5     8    28    0  12743
---- Validation: 
scalar performance:
{'acc': 0.9373813, 'precision': 0.8215556, 'recall': 0.6951068, 'specificity': 0.99265903, 'f1': 0.7112934, 'auroc': 0.99397933}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   62     0   0     1    0    0     4    35     3    1    377
1    0  1276   0     5    0    0     0    43     5    0      3
2    0     1   0   150   35    0     1    43     7   55     20
3    0     2   0  7959    0    6     0   265   203    4      1
4    0     0   0    20  131    0    99     9    11    0    269
5    0     0   0    22    0  330     0     0    12  155      2
6    0     0   0     1    0    0  1806     4     3    1     93
7    0     5   0    48    1    0     0  7155    44    1     11
8    0     0   0    21    0    0     0    78  3153    0     44
9    0     1   0    23    0   23     0    16     4  422      4
10   0     1   0     8    2    0     1    12    20    2  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63870424, 'precision': 0.53915614, 'recall': 0.5161495, 'specificity': 0.96347874, 'f1': 0.46422845, 'auroc': 0.8470222}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   54     0   0   13   0    7    41   177    14   25   839
1    0  1297   0   18   0    1     1   164     4    4    10
2    0    12   0   60  12   20    92    63   356   54   346
3    0     0   0    0   0    0     0     0     0    0     0
4    0     2   0    0   0    0    35     2    16    0  1578
5    0     0   0  142   0  316     2     0    18  109     5
6    0     0   0    6   0    0  3013     3    22    0    23
7    0     0   0    8   0    1     1  1147     2    1     4
8    0     1   0   69   0    2     5     7  1284    0     2
9    1    27   0  152   0  109    14    93   321  373    47
10   0     1   0    0   0    0     0     0     0    0  1645
early stop counter: 4
val acc:0.9373813271522522, best validation acc: 0.9427043199539185, corresponding to test acc:                         0.6985937356948853 / 0.6985937356948853
after epoch: 9,now: 2024-07-29 20:00:53.089860,epoch time: 0:52:07.354965,used: 9:57:33.690693,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9397742, 'precision': 0.8105295, 'recall': 0.6879872, 'specificity': 0.993051, 'f1': 0.6896432, 'auroc': 0.99393386}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    9     0   0     6   0    1     0   283     4    4    176
1    0  1247   0    18   0    0     0    51     4    0     11
2    0     0   0   112  29    2     3    34    11  106     15
3    0     1   0  8313   0    9     0    68    43    2      0
4    0     2   0    31  88    0   130    10     8   11    259
5    0     0   0    33   0  417     0     0     1   69      1
6    0     1   0     4   2    0  1859     8     3    1     30
7    0     5   0   209   1    0     2  7006    32    0      9
8    0     0   0   119   0    0     0    73  3050    3     51
9    0     0   0    10   0   74     0     9     3  396      1
10   0     0   0     9   3    1     5    16    17    2  12740
---- Validation: 
scalar performance:
{'acc': 0.9402969, 'precision': 0.8210949, 'recall': 0.6918581, 'specificity': 0.9930798, 'f1': 0.6957984, 'auroc': 0.99413574}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   11     0   0     9   0    1     4   277     3    5    173
1    0  1249   0    11   1    1     0    61     2    0      7
2    0     1   0   117  22    0     2    38     2  114     16
3    0     0   0  8325   0    4     0    71    39    1      0
4    0     0   0    36  98    1   114     8     9    9    264
5    0     0   0    30   0  423     0     0     1   65      2
6    0     2   0     6   0    0  1862     6     5    0     27
7    0     4   0   240   1    0     1  6980    28    0     11
8    0     0   0   107   0    0     1    68  3066    2     52
9    0     0   0    14   0   62     0    13     4  398      2
10   0     0   0    10   2    0     3    14    24    2  12741
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5821731, 'precision': 0.5382832, 'recall': 0.47596347, 'specificity': 0.95796967, 'f1': 0.43478608, 'auroc': 0.8348913}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   24     2   0   21   0   10    25   266     7   21   794
1    0  1096   0   41   0    0     6   285    14    0    57
2    0     7   0   60  44    6    64    49   242   66   477
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   0    0   2    0    38     1     7    0  1585
5    0     1   0  153   0  310     1     1     6  115     5
6    0     0   0   28   0    0  2619     3    61    0   356
7    0     0   0  108   0    0     0  1042     8    1     5
8    0     0   0  148   0    0     0     3  1213    2     4
9    0     3   0  182   2  105     6   113   280  369    77
10   0     0   0    0   0    0     0     0     0    0  1646
early stop counter: 5
val acc:0.9402968883514404, best validation acc: 0.9427043199539185, corresponding to test acc:                         0.6985937356948853 / 0.6985937356948853
after epoch: 10,now: 2024-07-29 21:07:24.732319,epoch time: 1:06:31.642459,used: 11:04:05.333152,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 11:04:05.333152 at 2024-07-29 21:07:24.732319
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69859374, 'precision': 0.62282926, 'recall': 0.5884191, 'specificity': 0.9692912, 'f1': 0.55062234, 'auroc': 0.86283046}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   864     3   0  16    0    4    30    78    20   21   134
1     0  1263   0  30    0    2    10   175     7    2    10
2     3    27   8  38  116   19   242    44   273   75   170
3     0     0   0   0    0    0     0     0     0    0     0
4     1     1   0   0    3    0   114     1     8    0  1505
5     2     0   0  71    0  398    15     0    16   82     8
6     0     0   0   3    0    0  3039     2     9    0    14
7     0     0   0  63    0    1     2  1090     3    0     5
8     0     0   0  69    0    6    15     3  1274    0     3
9     7    50   2  67   17  165    19    88   290  402    30
10    0     0   0   0    1    0     1     0     0    0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69859374, 'precision': 0.62282926, 'recall': 0.5884191, 'specificity': 0.9692912, 'f1': 0.55062234, 'auroc': 0.86283046}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   864     3   0  16    0    4    30    78    20   21   134
1     0  1263   0  30    0    2    10   175     7    2    10
2     3    27   8  38  116   19   242    44   273   75   170
3     0     0   0   0    0    0     0     0     0    0     0
4     1     1   0   0    3    0   114     1     8    0  1505
5     2     0   0  71    0  398    15     0    16   82     8
6     0     0   0   3    0    0  3039     2     9    0    14
7     0     0   0  63    0    1     2  1090     3    0     5
8     0     0   0  69    0    6    15     3  1274    0     3
9     7    50   2  67   17  165    19    88   290  402    30
10    0     0   0   0    1    0     1     0     0    0  1644
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_03_18_seed_0_23205524_instance_wise_predictions.txt
accuracy from prediction file 0.6985937172042258
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/10.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1657 MiB |   8645 MiB | 424327 GiB | 424325 GiB |
|       from large pool |   1650 MiB |   8630 MiB | 421332 GiB | 421330 GiB |
|       from small pool |      7 MiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1657 MiB |   8645 MiB | 424327 GiB | 424325 GiB |
|       from large pool |   1650 MiB |   8630 MiB | 421332 GiB | 421330 GiB |
|       from small pool |      7 MiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |   8622 MiB | 422414 GiB | 422412 GiB |
|       from large pool |   1647 MiB |   8607 MiB | 419422 GiB | 419420 GiB |
|       from small pool |      6 MiB |     16 MiB |   2992 GiB |   2992 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9114 MiB |   9114 MiB |   9114 MiB |      0 B   |
|       from large pool |   9096 MiB |   9096 MiB |   9096 MiB |      0 B   |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 236182 KiB | 494347 KiB |  74115 GiB |  74115 GiB |
|       from large pool | 227168 KiB | 491072 KiB |  71086 GiB |  71086 GiB |
|       from small pool |   9014 KiB |  13085 KiB |   3028 GiB |   3028 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   31809 K  |   31806 K  |
|       from large pool |     247    |     398    |   14164 K  |   14164 K  |
|       from small pool |    2419    |    3627    |   17644 K  |   17642 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   31809 K  |   31806 K  |
|       from large pool |     247    |     398    |   14164 K  |   14164 K  |
|       from small pool |    2419    |    3627    |   17644 K  |   17642 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     265    |     265    |       0    |
|       from large pool |     256    |     256    |     256    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     111    |    1235    |   16176 K  |   16176 K  |
|       from large pool |      91    |     181    |    8615 K  |    8615 K  |
|       from small pool |      20    |    1144    |    7560 K  |    7560 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB | 424327 GiB | 424327 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421332 GiB | 421332 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB | 424327 GiB | 424327 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421332 GiB | 421332 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB | 422414 GiB | 422414 GiB |
|       from large pool |  16640 KiB |   8607 MiB | 419422 GiB | 419422 GiB |
|       from small pool |      0 KiB |     16 MiB |   2992 GiB |   2992 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1888 MiB |   9114 MiB |   9114 MiB |   7226 MiB |
|       from large pool |   1872 MiB |   9096 MiB |   9096 MiB |   7224 MiB |
|       from small pool |     16 MiB |     18 MiB |     18 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 494347 KiB |  74116 GiB |  74116 GiB |
|       from large pool |  24320 KiB | 491072 KiB |  71087 GiB |  71087 GiB |
|       from small pool |      0 KiB |  14546 KiB |   3028 GiB |   3028 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   31809 K  |   31809 K  |
|       from large pool |       2    |     398    |   14164 K  |   14164 K  |
|       from small pool |       0    |    3627    |   17644 K  |   17644 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   31809 K  |   31809 K  |
|       from large pool |       2    |     398    |   14164 K  |   14164 K  |
|       from small pool |       0    |    3627    |   17644 K  |   17644 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      98    |     265    |     265    |     167    |
|       from large pool |      90    |     256    |     256    |     166    |
|       from small pool |       8    |       9    |       9    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1235    |   16177 K  |   16177 K  |
|       from large pool |       3    |     181    |    8615 K  |    8615 K  |
|       from small pool |       0    |    1144    |    7561 K  |    7561 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB | 424327 GiB | 424327 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421332 GiB | 421332 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB | 424327 GiB | 424327 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421332 GiB | 421332 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB | 422414 GiB | 422414 GiB |
|       from large pool |  16640 KiB |   8607 MiB | 419422 GiB | 419422 GiB |
|       from small pool |      0 KiB |     16 MiB |   2992 GiB |   2992 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1888 MiB |   9114 MiB |   9114 MiB |   7226 MiB |
|       from large pool |   1872 MiB |   9096 MiB |   9096 MiB |   7224 MiB |
|       from small pool |     16 MiB |     18 MiB |     18 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 494347 KiB |  74116 GiB |  74116 GiB |
|       from large pool |  24320 KiB | 491072 KiB |  71087 GiB |  71087 GiB |
|       from small pool |      0 KiB |  14546 KiB |   3028 GiB |   3028 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   31809 K  |   31809 K  |
|       from large pool |       2    |     398    |   14164 K  |   14164 K  |
|       from small pool |       0    |    3627    |   17644 K  |   17644 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   31809 K  |   31809 K  |
|       from large pool |       2    |     398    |   14164 K  |   14164 K  |
|       from small pool |       0    |    3627    |   17644 K  |   17644 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      98    |     265    |     265    |     167    |
|       from large pool |      90    |     256    |     256    |     166    |
|       from small pool |       8    |       9    |       9    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1235    |   16177 K  |   16177 K  |
|       from large pool |       3    |     181    |    8615 K  |    8615 K  |
|       from small pool |       0    |    1144    |    7561 K  |    7561 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524

 Experiment start at: 2024-07-29 21:41:04.357167
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5113442, 'precision': 0.38937515, 'recall': 0.44365367, 'specificity': 0.9532323, 'f1': 0.33959308, 'auroc': 0.9112708}
confusion matrix:
     0     1      2     3   4   5   6     7     8   9    10
0   377    16     51    14   0   0   3     3    18   0    1
1     2  1236      6    27   0   0   0    51    10   0    0
2    31     6    152    15   0   0   0    32    57   0   19
3     2     2      1  8234   0   0   0   143    57   0    0
4    12    25    389     6   0   0   0     3    97   0    7
5    40     6      1   395   0   0   0    11    11   0   57
6   522  1276     31    23   0   0  30     9    14   0    3
7    11    15     36   720   1   0   0  6406    72   0    0
8     4     5     73   502   0   0   0    41  2670   0    0
9   119     6     46   141   0   0   1    22    35   0  122
10   53   137  12334    15   0   0   0    17   231   0    7
---- Validation: 
scalar performance:
{'acc': 0.5114083, 'precision': 0.39441636, 'recall': 0.44549736, 'specificity': 0.9532453, 'f1': 0.3395574, 'auroc': 0.90930367}
confusion matrix:
     0     1      2     3   4   5   6     7     8   9    10
0   388    13     52     9   0   0   1     7    11   0    2
1     1  1235      4    21   3   0   0    56    12   0    0
2    31     8    153    16   0   0   0    25    59   0   20
3     7     2      0  8233   0   0   0   147    51   0    0
4    13    19    392     9   0   0   0     3    94   0    9
5    38     6      3   390   0   0   0    15    10   0   59
6   539  1269     28    25   0   0  28     6    10   0    3
7    13    14     24   720   3   0   0  6411    79   0    1
8     9     8     76   499   0   0   0    48  2656   0    0
9   124     9     48   143   0   0   1    28    32   0  108
10   42   153  12315    14   0   0   1    16   240   0   15
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32211572, 'precision': 0.2362824, 'recall': 0.32788467, 'specificity': 0.93385345, 'f1': 0.26090878, 'auroc': 0.7656486}
confusion matrix:
     0     1     2    3   4   5   6     7    8   9    10
0   981    11     8   78   0   0  51    39    2   0    0
1    16  1279     6   55  12   0   0   116   15   0    0
2    88    27   265  131   0   0   2    28  367   0  107
3     0     0     0    0   0   0   0     0    0   0    0
4     5    24  1530    1   0   0   0     0   58   0   15
5    75     3     0  464   0   0   0    14    0   0   36
6   222  1976    77  557   0   0   8     7  130   0   90
7     6     2     0   71   0   0   0  1084    1   0    0
8     7     0     0  374   0   0   0     5  984   0    0
9   171    24    33  592   0   0   1    48  153   0  115
10    0    12  1625    0   0   0   0     0    6   0    3
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 22:51:20.821621,epoch time: 1:10:16.464454,used: 1:10:16.464454,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.56212544, 'precision': 0.47032785, 'recall': 0.5271392, 'specificity': 0.95813644, 'f1': 0.46858013, 'auroc': 0.921187}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   395     1     39     7   0   0    19    16     4   0    2
1     0  1234      9    18   0   0     2    69     0   0    0
2    67     1    145     5   0   0     2    76     7   0    9
3     4     3      2  8270   0   0     3   126    27   0    1
4    26     3    450     1   0   0     7    24    17   0   11
5    67     0      2   228   0   0    10    37     3   0  174
6    23     2     12    11   0   0  1846     8     4   0    1
7     2     7      5   469   0   0     4  6760    17   0    0
8     8     8    179   566   0   0     2   193  2335   0    4
9   252     2     32    30   0   0     6    70    11   0   90
10   54     4  12563    23   0   0    33    45    47   0   25
---- Validation: 
scalar performance:
{'acc': 0.5633543, 'precision': 0.47280276, 'recall': 0.52704626, 'specificity': 0.9582628, 'f1': 0.46995512, 'auroc': 0.92060566}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   399     2     37     9   0   0    21    13     1   0    1
1     1  1232      6    19   0   0     0    71     1   0    2
2    74     0    138     5   0   0     2    72     6   0   15
3     2     0      3  8268   0   0     4   122    40   0    1
4    31     0    451     4   0   0     4    23    17   0    9
5    66     0      6   224   0   0     8    40     3   0  174
6    13     2     11     8   0   0  1860     7     4   0    3
7     1     9      8   451   0   0     4  6779    13   0    0
8     5     7    168   564   0   0     4   194  2354   0    0
9   257     0     30    34   0   0     9    69     6   0   88
10   53     6  12559    19   0   0    31    55    42   0   31
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5043728, 'precision': 0.36534995, 'recall': 0.4064371, 'specificity': 0.95152587, 'f1': 0.36865547, 'auroc': 0.8012125}
confusion matrix:
     0     1     2    3   4   5     6     7    8   9    10
0   865     7     8   68   0   0   132    85    1   0    4
1     4  1094    29   48   0   0    13   308    2   0    1
2   155     1   522   45   0   0    21   122  101   0   48
3     0     0     0    0   0   0     0     0    0   0    0
4     4     0  1617    0   0   0     1     3    6   0    2
5    86     0     1  264   0   0    30    55    2   0  154
6     2    11   131  201   0   0  2714     3    3   0    2
7     3     0     1  131   0   0     4  1025    0   0    0
8     3     0    30  315   0   0    10    20  989   0    3
9   322     2    92  221   0   0    60   282   42   0  116
10    0     0  1644    1   0   0     0     1    0   0    0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-30 00:00:01.790266,epoch time: 1:08:40.968645,used: 2:18:57.433099,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.57488763, 'precision': 0.47428387, 'recall': 0.5683658, 'specificity': 0.9598057, 'f1': 0.48486128, 'auroc': 0.9337394}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   381     6     63     5   0   0    18     3     5   0    2
1     0  1279      1     6   0   0     5    38     3   0    0
2    25     8    250     1   0   0     2    15     6   0    5
3     4     3      5  8035   0   0    14   284    90   0    4
4     5    11    491     1   0   0     0     3    25   0    2
5    64     8     26   129   0   0     1    43    22   0  228
6    14    15     12     4   0   0  1858     1     2   0    1
7     8    21     19   185   0   0     5  7013    12   0    0
8     1    17    210   209   0   0     7   184  2668   0    0
9   152     4    152     7   0   0     4    35    49   0   90
10    9    78  12635     8   0   0    18    16    25   0    3
---- Validation: 
scalar performance:
{'acc': 0.5757389, 'precision': 0.4740401, 'recall': 0.5685554, 'specificity': 0.9599084, 'f1': 0.48544106, 'auroc': 0.93268347}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   383    10     60     2   0   0    17     6     5   0    0
1     0  1278      2    13   0   0     3    35     1   0    0
2    28     6    245     0   0   0     2    20    10   0    1
3     6     2      2  8028   0   0    17   281    97   0    7
4    11    13    487     0   0   0     1     7    19   0    1
5    73     6     22   123   0   0     2    37    31   0  227
6    12    10     14     0   0   0  1865     2     2   0    3
7     6    25     25   176   0   0     6  7011    14   0    2
8     1    18    202   186   0   0     7   171  2711   0    0
9   149     6    144     7   0   0     5    38    48   0   96
10    6    70  12655     8   0   0    20    17    17   0    3
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5604142, 'precision': 0.3737326, 'recall': 0.4510903, 'specificity': 0.9565939, 'f1': 0.3964426, 'auroc': 0.8261877}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9    10
0   1080    14     8    3   0   0    57    6     2   0    0
1     19  1331     5   20   0   0    10  114     0   0    0
2     54    35   667   12   0   0     4   36   162   0   45
3      0     0     0    0   0   0     0    0     0   0    0
4      1     7  1616    0   0   0     1    0     7   0    1
5    118    13     4   38   0   0     8   61    14   0  336
6      0    54     7    0   0   0  3004    1     1   0    0
7     36     2     3  224   0   0    69  829     0   0    1
8     17    38    36  140   0   0    26    4  1099   0   10
9    283    65   293   49   0   0    15   98   146   0  188
10     0     0  1646    0   0   0     0    0     0   0    0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-30 01:09:08.212144,epoch time: 1:09:06.421878,used: 3:28:03.854977,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.57809824, 'precision': 0.49784833, 'recall': 0.57742786, 'specificity': 0.9602653, 'f1': 0.49974585, 'auroc': 0.9462972}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   371     0     97     3   0   0     6     3     1   0    2
1     0  1256      9     9   0   0     1    48     9   0    0
2    11     0    274     1   0   0     1    17     7   0    1
3     4     1      5  7958   0   0     6   220   236   0    7
4     1     0    516     0   0   0     0     1    16   0    5
5    19    37     31    90   0   0     5    45    76   0  218
6    20     3     22     3   0   0  1848     2     5   0    5
7     3     4     39   166   0   0     1  6953    96   0    0
8     0     0    248    58   0   0     1    45  2943   0    1
9    65     3    200     4   0   0     1    50    41   0  129
10    4     2  12748     8   0   0     4     6    17   0    4
---- Validation: 
scalar performance:
{'acc': 0.5775311, 'precision': 0.4967756, 'recall': 0.57483256, 'specificity': 0.9602194, 'f1': 0.49911785, 'auroc': 0.9461441}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   379     0     92     1   0   0     6     2     1   0    2
1     0  1239     20    11   0   0     1    53     8   0    0
2    11     0    265     0   0   0     1    24    10   0    1
3     5     3      7  7970   0   0     5   200   244   0    6
4     0     0    523     0   0   0     1     2     9   0    4
5    18    49     29    97   0   0     7    51    60   0  210
6    16     5     28     5   0   0  1848     2     1   0    3
7     3     8     57   161   0   0     1  6960    75   0    0
8     1     1    243    59   0   0     0    65  2926   0    1
9    73     6    195     6   0   0     1    46    34   0  132
10    4     0  12751     8   0   0     6     9    14   0    4
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5446023, 'precision': 0.39184177, 'recall': 0.44092265, 'specificity': 0.9551955, 'f1': 0.39744508, 'auroc': 0.81357473}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9    10
0   1021     2    62    7   0   0    53   17     7   0    1
1      6  1069    88   40   0   0     0  284    10   0    2
2     19     2   731   14   0   0     6   40   130   0   73
3      0     0     0    0   0   0     0    0     0   0    0
4      0     0  1626    0   0   0     2    0     5   0    0
5     28    21     2   60   0   0    15   42    20   0  404
6      3     6    54   14   0   0  2962    6    15   0    7
7      4     0     3  241   0   0     1  912     3   0    0
8      6     4    95  144   0   0    11   14  1089   0    7
9    142     8   297   69   0   0     4  164   130   0  323
10     0     0  1646    0   0   0     0    0     0   0    0
better model found
persisted
after epoch: 4,now: 2024-07-30 02:16:57.385443,epoch time: 1:07:49.173299,used: 4:35:53.028276,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5785531, 'precision': 0.46215752, 'recall': 0.57840514, 'specificity': 0.9606722, 'f1': 0.47955537, 'auroc': 0.95220983}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   421     0     48     0   0   0     0     7     6   0   1
1     0  1255      5     3   0   0     0    65     4   0   0
2    29     3    251     0   0   0     1    14     9   0   5
3     4     1      1  7794   0   0     1   397   239   0   0
4     7     4    513     0   0   0     0     0    13   0   2
5    23   197      7    11   0   0     3    15   244   0  21
6   113    15     23     6   0   0  1740     3     7   0   1
7     3     7     27    74   0   0     1  7088    62   0   1
8     3     0     96    42   0   0     0    82  3073   0   0
9   155   108    137     1   0   0    10    26    31   0  25
10   36     4  12682     4   0   0     3    15    46   0   2
---- Validation: 
scalar performance:
{'acc': 0.5809282, 'precision': 0.46632832, 'recall': 0.5841299, 'specificity': 0.960944, 'f1': 0.48138148, 'auroc': 0.9512181}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   424     1     49     0   0   0     0     3     6   0   0
1     0  1264      3     4   0   0     0    54     7   0   0
2    28     1    264     1   0   0     0    10     7   0   1
3     8     3      2  7829   0   0     0   373   225   0   0
4     9     3    507     0   0   0     0     3    15   0   2
5    26   199      8     8   0   0     3    10   254   0  13
6   117    19     26     3   0   0  1734     4     3   0   2
7     0     4     25    69   0   0     1  7112    53   0   1
8     2     0     90    30   0   0     0    86  3088   0   0
9   157   110    134     1   0   0     4    28    32   0  27
10   25     5  12704     3   0   0     3    16    37   0   3
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5535577, 'precision': 0.3401891, 'recall': 0.45358086, 'specificity': 0.9559511, 'f1': 0.37968045, 'auroc': 0.83029056}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9   10
0   1141     9     5    2   0   0     0    10     3   0   0
1     16  1151    16   17   0   0     2   259    38   0   0
2    106    92   455    2   0   0     7    18   327   0   8
3      0     0     0    0   0   0     0     0     0   0   0
4      3     1  1599    0   0   0     1     0    29   0   0
5     43   339     0   18   0   0     2     0   187   0   3
6     24    88    52  119   0   0  2764     2    18   0   0
7     14     1     3   26   0   0     0  1117     3   0   0
8      8     8     6   61   0   0     1     2  1284   0   0
9    273   292   157   20   0   0     5    27   351   0  12
10     0     0  1644    0   0   0     0     0     2   0   0
better model found
persisted
after epoch: 5,now: 2024-07-30 03:28:05.978508,epoch time: 1:11:08.593065,used: 5:47:01.621341,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.587088, 'precision': 0.48121306, 'recall': 0.5547158, 'specificity': 0.9613623, 'f1': 0.475503, 'auroc': 0.95460767}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   406     5     27     5   0   0    12     7    21   0   0
1     1  1282      0     7   0   0     0    36     6   0   0
2    76     7    148     0   0   0     2    26    41   0  12
3     0     2      0  8258   0   0     2   119    56   0   0
4    23     8    361     0   0   0     0     7   113   0  26
5    33   280      1    28   0   0     1     2   173   0   3
6     9     9     10     8   0   0  1856     0    14   0   2
7     2    11      9   240   0   0     1  6953    47   0   0
8     1     1     23   182   0   0     1    75  3009   0   3
9   240   161     16     7   0   0     3    36    24   0   6
10   13    13  12449     5   0   0    12    17   254   0  31
---- Validation: 
scalar performance:
{'acc': 0.5878026, 'precision': 0.4867853, 'recall': 0.5566527, 'specificity': 0.96146, 'f1': 0.47510615, 'auroc': 0.9548149}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   412     5     24     3   0   0     9     2    25   0   3
1     1  1277      2    12   0   0     0    36     4   0   0
2    83     8    151     2   0   0     3    26    29   0  10
3     3     4      0  8251   0   0     0   119    63   0   0
4    26     9    352     0   0   0     2     8   121   0  21
5    33   274      1    26   0   0     3     1   180   0   3
6     9     9     14     4   0   0  1860     0    10   0   2
7     2    10      5   214   0   0     3  6987    44   0   0
8     1     4     28   191   0   0     0    71  3001   0   0
9   252   156     15     6   0   0     8    33    17   0   6
10   21    10  12456     6   0   0    12    15   240   0  36
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5042328, 'precision': 0.3337135, 'recall': 0.38810402, 'specificity': 0.9513597, 'f1': 0.35160315, 'auroc': 0.8166135}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9   10
0   1032     3     0   12   0   2   106    9     6   0   0
1      6  1263     8   39   0   0     3  159    21   0   0
2     73    98   253   38   0   0    28   25   442   0  58
3      0     0     0    0   0   0     0    0     0   0   0
4      2     3  1584    0   0   0     2    0    39   0   3
5     37   255     0  137   0   0    22    2   128   0  11
6      0     3    17  103   0   0  2930    2    11   0   1
7     11     1     2  516   0   0    24  603     7   0   0
8      0     3     0  229   0   0    12    0  1126   0   0
9    200   240    49  217   0   1    72   68   240   0  50
10     0     0  1637    0   0   0     1    0     8   0   0
better model found
persisted
after epoch: 6,now: 2024-07-30 04:33:31.882968,epoch time: 1:05:25.904460,used: 6:52:27.525801,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.58382386, 'precision': 0.49327713, 'recall': 0.5626755, 'specificity': 0.96080744, 'f1': 0.48300397, 'auroc': 0.9583039}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   439     1     15     4   0   0     1     3     8   0   12
1     0  1290      0    11   0   0     1    26     3   0    1
2    44    13    165     0   0   0     4    39    14   0   33
3     4     6      0  8339   0   0     3    44    40   0    1
4    13    11    367     0   0   0     5     9    76   0   58
5    14   249      1    18   0   0     5     5   222   0    7
6    35    16      7     1   0   0  1838     1     4   0    6
7    14    13     18   493   0   0     2  6635    86   0    3
8     5    18     46   178   0   0     2    35  2994   0   17
9   127   187     15     2   0   0    26    94    11   0   30
10   25     7  12420     8   0   0     7    12   193   0  121
---- Validation: 
scalar performance:
{'acc': 0.58371, 'precision': 0.4891828, 'recall': 0.56011283, 'specificity': 0.96078444, 'f1': 0.48348647, 'auroc': 0.9566509}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   437     2     14     1   0   0     4     5    10   0  10
1     0  1290      0    13   0   0     1    23     3   0   2
2    48     8    156     0   0   0     5    46    17   0  32
3     4     4      2  8342   0   0     3    33    50   0   2
4     9    12    358     0   0   0     2    12    79   0  67
5     8   254      2    15   0   0     8     8   222   0   4
6    24    14      7     0   0   0  1850     3     4   0   6
7     8    16     19   474   0   0     3  6666    75   0   4
8     8    13     40   202   0   0     0    35  2982   0  16
9   129   186     15     1   0   0    30    96     7   0  29
10   25     8  12435    10   0   0    10    18   191   0  99
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5203946, 'precision': 0.3472497, 'recall': 0.4031394, 'specificity': 0.95270705, 'f1': 0.36762953, 'auroc': 0.83330524}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9    10
0   1149     4     2    4   0   0     3    6     2   0    0
1     16  1296     5   51   0   0    16  100    12   0    3
2     50    83   258   30   0   0    39   43   285   0  227
3      0     0     0    0   0   0     0    0     0   0    0
4      2     1  1565    0   0   0     1    0    44   0   20
5     22   226     0   59   0   0    52   17   170   0   46
6      1    13     3   28   0   0  3000    0     4   0   18
7     33     1     1  413   0   0    19  691     4   0    2
8      2    11     5  268   0   0    10   10  1043   0   21
9    129   265    48  114   0   0   110  103   143   0  225
10     0     1  1639    0   0   0     0    0     5   0    1
early stop counter: 1
val acc:0.5837100148200989, best validation acc: 0.5878025889396667, corresponding to test acc:                         0.5042328238487244 / 0.56041419506073
after epoch: 7,now: 2024-07-30 05:41:33.277237,epoch time: 1:08:01.394269,used: 8:00:28.920070,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.5902986, 'precision': 0.519172, 'recall': 0.5614368, 'specificity': 0.9611348, 'f1': 0.50390005, 'auroc': 0.9634866}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   422     2     24     4   0   0     7     9     7   0    8
1     0  1288      0     7   0   0     0    35     1   0    1
2    18     2    166     1   0   0     2    87     4   0   32
3     0     1      0  8291   0   0     3   112    31   0    0
4     4     1    311     2   0   0     1    29    55   0  136
5     1   191      2    54   0   0    13    21   204   0   35
6    10     2      5     3   0   0  1872     8     2   0    6
7     0     8      3   191   0   0     1  7054     6   0    1
8     1     1     38   261   0   0     1   166  2822   0    4
9    20    60     25    16   0   0    30   247     9   0   86
10    5     5  12467     8   0   0    23    40    96   0  148
---- Validation: 
scalar performance:
{'acc': 0.5917882, 'precision': 0.5191342, 'recall': 0.56431293, 'specificity': 0.9612953, 'f1': 0.5038271, 'auroc': 0.963933}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   413     0     21     3   0   0    10    18     4   0   14
1     0  1291      1     4   0   0     0    33     3   0    0
2    14     2    177     2   0   0     2    82     9   0   24
3     2     4      0  8310   0   0     2    99    22   0    1
4     3     2    288     2   0   0     4    26    72   0  142
5     2   198      2    48   0   0    16    19   194   0   42
6     5     2      6     2   0   0  1881     6     3   0    3
7     0     7      3   179   0   0     1  7069     5   0    1
8     1     3     32   257   0   0     1   159  2838   0    5
9    20    70     23     5   0   0    25   261    13   0   76
10    6    10  12466     9   0   0    17    53    90   0  145
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5338977, 'precision': 0.39322615, 'recall': 0.41588926, 'specificity': 0.9546089, 'f1': 0.39456978, 'auroc': 0.82168496}
confusion matrix:
     0     1     2    3   4   5     6     7     8   9    10
0   846     4     3   68   0   3   124   108     8   0    6
1     1  1294     4   32   0   0     1   162     4   0    1
2     3    10   332  103   0   0    24    69   290   0  184
3     0     0     0    0   0   0     0     0     0   0    0
4     0     2  1578    1   0   0     5     2    33   0   12
5     4    12     0  403   0   0    10    37    54   0   72
6     0     0     1    5   0   0  3059     1     0   0    1
7     1     0     0  144   0   0     0  1017     2   0    0
8     0     0     0  273   0   0    12     1  1081   0    3
9     8    14    59  580   0   0    26   170    81   0  199
10    0     0  1638    0   0   0     1     0     5   0    2
better model found
persisted
after epoch: 8,now: 2024-07-30 06:51:21.720604,epoch time: 1:09:48.443367,used: 9:10:17.363437,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.5899775, 'precision': 0.49394256, 'recall': 0.5668084, 'specificity': 0.9613273, 'f1': 0.48578274, 'auroc': 0.9574609}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   447     0     18     0   0   0     2    10     2   0    4
1     0  1284      1     6   0   0     1    35     3   0    2
2    52     0    166     0   0   0     1    66     1   0   26
3     1     8      2  8160   0   0     4   118   126   0   20
4    25     2    280     0   0   0     0    20     8   0  203
5    63   285      1     4   0   0    15    30   114   0    8
6    30     2      4     2   0   0  1854     7     2   0    6
7     0     5     13   227   0   0     1  6976    36   0    5
8     7     3    101    90   0   1     5    84  2959   0   46
9   187    56     14     1   0   0    12   211     2   0   10
10   85     0  12449     6   0   0     9    16    23   0  205
---- Validation: 
scalar performance:
{'acc': 0.5894878, 'precision': 0.494429, 'recall': 0.5662794, 'specificity': 0.96127105, 'f1': 0.48586938, 'auroc': 0.9566551}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   447     0     18     1   0   0     2     6     4   0    5
1     0  1289      0     9   0   0     1    31     1   0    1
2    54     2    163     0   0   0     1    66     2   0   24
3     4     3      3  8138   0   0     4   122   150   0   16
4    27     1    278     0   0   0     1    23     8   0  201
5    46   287      1     5   0   0    14    37   124   0    7
6    28     2      7     2   0   0  1857     7     1   0    4
7     2     4     16   240   0   0     1  6966    32   0    4
8     6     2     90    93   0   0     1    84  2969   0   51
9   191    58     11     1   0   0    13   209     1   0    9
10   83     2  12446     6   0   0    11    13    26   0  209
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56286293, 'precision': 0.36123607, 'recall': 0.44763586, 'specificity': 0.9566193, 'f1': 0.39142686, 'auroc': 0.8434242}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9    10
0   1099     1     1    7   0   1    20    39     2   0    0
1      6  1173    22   24   0   0    14   236    15   0    9
2     97     5   370    3   0   0    36    71   230   0  203
3      0     0     0    0   0   0     0     0     0   0    0
4      4     0  1465    0   0   0    11     0    23   0  130
5     51   146     0   44   0   0    61    83    55   0  152
6      1     1     1    1   0   0  3063     0     0   0    0
7      4     0     2  112   0   0     5  1037     4   0    0
8      1     0     1   43   0   6    22    10  1278   0    9
9    189    32   148   30   0   1    52   390   150   0  145
10     0     0  1615    0   0   0     3     0     3   0   25
new oracle model saved
early stop counter: 1
val acc:0.5894877910614014, best validation acc: 0.5917881727218628, corresponding to test acc:                         0.5338976979255676 / 0.5628629326820374
after epoch: 9,now: 2024-07-30 07:59:06.780919,epoch time: 1:07:45.060315,used: 10:18:02.423752,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.57694775, 'precision': 0.49171045, 'recall': 0.57411563, 'specificity': 0.95990485, 'f1': 0.48379523, 'auroc': 0.9722415}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   418     0     17     0   0   0     0     4     2   0   42
1     0  1299      0     3   0   0     0    26     4   0    0
2    11     4    220     0   0   0     1    31     3   0   42
3     3     7      1  7313   0   0     2   729   379   0    4
4     8     4    233     0   0   0     0     9     5   0  280
5   127   263      5     8   0   0     1    21    90   0    6
6    30     5      8     1   0   0  1845     4     5   0   10
7     0    13     30    16   0   0     1  7165    33   0    5
8     0     0    139     5   0   0     0    68  3067   0   16
9   191    26     66     1   0   0     3   175     6   0   25
10    7     3  12526     2   0   0     2    10     5   0  237
---- Validation: 
scalar performance:
{'acc': 0.5770496, 'precision': 0.49331173, 'recall': 0.5727991, 'specificity': 0.9598955, 'f1': 0.48421004, 'auroc': 0.9716214}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   419     0     22     0   0   0     1    10     0   0   31
1     0  1298      0     3   0   0     0    25     6   0    0
2    16     2    214     0   0   0     0    30     2   0   48
3     1     2      1  7310   0   0     0   738   386   0    2
4     5     2    219     0   0   0     0     7    11   0  295
5   120   262      4     7   0   0     3    29    93   0    3
6    27     5      7     0   0   0  1852     3     2   0   12
7     0    22     34    21   0   0     1  7154    29   0    4
8     0     0    133     9   0   0     0    65  3070   0   19
9   189    30     69     1   0   0     2   184     3   0   15
10   10     3  12504     2   0   0     3    10     8   0  256
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.570629, 'precision': 0.37477845, 'recall': 0.45683235, 'specificity': 0.9574523, 'f1': 0.40516892, 'auroc': 0.844543}
confusion matrix:
      0     1     2   3   4   5     6     7     8   9    10
0   1124     2     1   1   0   0    22    13     5   0    2
1      2  1332    24   5   0   0     0   118    14   0    4
2     44     3   328   1   0   0     4    48   121   0  466
3      0     0     0   0   0   0     0     0     0   0    0
4      0     0  1436   0   0   0     2     0     2   0  193
5    174   103     2  30   0   0    17   112    83   0   71
6      1    31     3   1   0   0  2975     0     6   0   50
7      2     0     3  99   0   0     2  1053     3   0    2
8      0     0    16  11   0   1     4    16  1320   0    2
9    184    23   264   9   0   0     7   272   187   0  191
10     0     0  1622   0   0   0     0     0     0   0   24
new oracle model saved
early stop counter: 2
val acc:0.5770496129989624, best validation acc: 0.5917881727218628, corresponding to test acc:                         0.5338976979255676 / 0.5706290006637573
after epoch: 10,now: 2024-07-30 09:11:55.261520,epoch time: 1:12:48.480601,used: 11:30:50.904353,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:30:50.904353 at 2024-07-30 09:11:55.261520
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5338977, 'precision': 0.39322615, 'recall': 0.41588926, 'specificity': 0.9546089, 'f1': 0.39456978, 'auroc': 0.82168496}
confusion matrix:
     0     1     2    3   4   5     6     7     8   9    10
0   846     4     3   68   0   3   124   108     8   0    6
1     1  1294     4   32   0   0     1   162     4   0    1
2     3    10   332  103   0   0    24    69   290   0  184
3     0     0     0    0   0   0     0     0     0   0    0
4     0     2  1578    1   0   0     5     2    33   0   12
5     4    12     0  403   0   0    10    37    54   0   72
6     0     0     1    5   0   0  3059     1     0   0    1
7     1     0     0  144   0   0     0  1017     2   0    0
8     0     0     0  273   0   0    12     1  1081   0    3
9     8    14    59  580   0   0    26   170    81   0  199
10    0     0  1638    0   0   0     1     0     5   0    2
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.570629, 'precision': 0.37477845, 'recall': 0.45683235, 'specificity': 0.9574523, 'f1': 0.40516892, 'auroc': 0.844543}
confusion matrix:
      0     1     2   3   4   5     6     7     8   9    10
0   1124     2     1   1   0   0    22    13     5   0    2
1      2  1332    24   5   0   0     0   118    14   0    4
2     44     3   328   1   0   0     4    48   121   0  466
3      0     0     0   0   0   0     0     0     0   0    0
4      0     0  1436   0   0   0     2     0     2   0  193
5    174   103     2  30   0   0    17   112    83   0   71
6      1    31     3   1   0   0  2975     0     6   0   50
7      2     0     3  99   0   0     2  1053     3   0    2
8      0     0    16  11   0   1     4    16  1320   0    2
9    184    23   264   9   0   0     7   272   187   0  191
10     0     0  1622   0   0   0     0     0     0   0   24
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_21_41_03_seed_1_23205524_instance_wise_predictions.txt
accuracy from prediction file 0.5338977121667949
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1657 MiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |   1650 MiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      7 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1657 MiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |   1650 MiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      7 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |   8622 MiB |    825 TiB |    825 TiB |
|       from large pool |   1647 MiB |   8607 MiB |    819 TiB |    819 TiB |
|       from small pool |      6 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9114 MiB |   9114 MiB |  16340 MiB |   7226 MiB |
|       from large pool |   9096 MiB |   9096 MiB |  16320 MiB |   7224 MiB |
|       from small pool |     18 MiB |     18 MiB |     20 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 238230 KiB | 494347 KiB | 148387 GiB | 148386 GiB |
|       from large pool | 227168 KiB | 491072 KiB | 142331 GiB | 142331 GiB |
|       from small pool |  11062 KiB |  14546 KiB |   6055 GiB |   6055 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   63620 K  |   63617 K  |
|       from large pool |     247    |     398    |   28330 K  |   28329 K  |
|       from small pool |    2419    |    3627    |   35290 K  |   35287 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   63620 K  |   63617 K  |
|       from large pool |     247    |     398    |   28330 K  |   28329 K  |
|       from small pool |    2419    |    3627    |   35290 K  |   35287 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     265    |     432    |     167    |
|       from large pool |     256    |     256    |     422    |     166    |
|       from small pool |       9    |       9    |      10    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     113    |    1251    |   32493 K  |   32493 K  |
|       from large pool |      91    |     181    |   17319 K  |   17319 K  |
|       from small pool |      22    |    1160    |   15174 K  |   15174 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB |    825 TiB |    825 TiB |
|       from large pool |  16640 KiB |   8607 MiB |    819 TiB |    819 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1890 MiB |   9114 MiB |  16340 MiB |  14450 MiB |
|       from large pool |   1872 MiB |   9096 MiB |  16320 MiB |  14448 MiB |
|       from small pool |     18 MiB |     18 MiB |     20 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 494347 KiB | 148388 GiB | 148388 GiB |
|       from large pool |  24320 KiB | 491072 KiB | 142332 GiB | 142332 GiB |
|       from small pool |      0 KiB |  16594 KiB |   6055 GiB |   6055 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   63620 K  |   63620 K  |
|       from large pool |       2    |     398    |   28330 K  |   28330 K  |
|       from small pool |       0    |    3627    |   35290 K  |   35290 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   63620 K  |   63620 K  |
|       from large pool |       2    |     398    |   28330 K  |   28330 K  |
|       from small pool |       0    |    3627    |   35290 K  |   35290 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     265    |     432    |     333    |
|       from large pool |      90    |     256    |     422    |     332    |
|       from small pool |       9    |       9    |      10    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   32494 K  |   32494 K  |
|       from large pool |       3    |     181    |   17319 K  |   17319 K  |
|       from small pool |       0    |    1160    |   15175 K  |   15175 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 30 09:30:26 2024]
Finished job 0.
1 of 1 steps (100%) done
