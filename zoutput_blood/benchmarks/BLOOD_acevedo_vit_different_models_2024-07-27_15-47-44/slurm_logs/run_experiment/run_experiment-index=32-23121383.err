Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 17:50:24 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/32.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=32
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383

 Experiment start at: 2024-07-28 18:24:14.244814
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89017016, 'precision': 0.6626791, 'recall': 0.6099644, 'specificity': 0.9881206, 'f1': 0.61039925, 'auroc': 0.94992274}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   165     0   0    11   0    6    77    39    61   23    101
1     1  1038   0    14   0    0    21   227    18    0     11
2     2     0   0    16   0    1    10    41   112   64     66
3     0     0   0  7640   0    7     0   336   455    0      0
4     2     0   0     5   0    0    44     6   147   15    320
5     0     0   0   115   0  114     0     0    31  260      1
6     8     0   0     3   0    3  1803    24    37    6     22
7     0     1   0   181   0    0     1  6886   183    0     12
8     0     0   0    52   0    0     1    99  3127    2     14
9     1     0   0    22   0   41     2    12    74  330     11
10   11     0   0     6   0    0   281    46   276    7  12168
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8897419, 'precision': 0.66693354, 'recall': 0.6116493, 'specificity': 0.9880393, 'f1': 0.6129718, 'auroc': 0.9505385}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   165     0   0    10   0    7    71    36    61   20    113
1     1  1033   0    11   1    0    20   232    23    0     11
2     4     0   0    20   0    0     9    46   112   56     65
3     0     0   0  7660   0    4     1   324   448    3      0
4     3     0   0     4   0    0    41     8   137   16    330
5     0     0   0   117   0  119     2     1    27  254      1
6     6     0   0     5   0    2  1803    23    41    2     26
7     1     1   0   176   0    0     2  6876   195    0     14
8     0     0   0    50   0    0     0   105  3120    0     21
9     0     0   0    21   0   35     4     9    76  339      9
10   14     0   0     8   0    1   277    49   295    4  12148
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5527881, 'precision': 0.47524977, 'recall': 0.44567272, 'specificity': 0.95487463, 'f1': 0.38536647, 'auroc': 0.81856436}
confusion matrix:
     0    1   2   3   4    5     6     7     8    9     10
0   367    0   0  29   0   22   108   347   195   87    15
1    11  301   0  25   0    2    22  1015    37    0    86
2     6    0   0   7   0    4    34    82   581  117   184
3     0    0   0   0   0    0     0     0     0    0     0
4     3    0   0   0   0    0    42     2    52    1  1533
5     4    0   0  73   0  149    12     1    40  313     0
6     0    0   0   6   0    0  2588     8   327    0   138
7     0    0   0   3   0    0     0  1155     3    1     2
8     0    0   0  31   0    0     4    11  1318    6     0
9     7    0   0  40   0   50    10    84   516  401    29
10    0    0   0   0   0    0    22     1     1    0  1622
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 20:28:52.450878,epoch time: 2:04:38.206064,used: 2:04:38.206064,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9274936, 'precision': 0.7396966, 'recall': 0.69258446, 'specificity': 0.99176455, 'f1': 0.69912994, 'auroc': 0.9807644}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   305     1   0     5   0    0     9    14     3    6    140
1     2  1227   0    16   0    2     3    67     7    0      8
2     3     3   0    60  34    6    23    23     7   91     62
3     2     1   0  8075   0   23     7   244    83    1      0
4     0     0   0     8  20    8   148     5    30    9    311
5     0     0   0    41   0  288     0     1     3  187      1
6     5     2   0     3   0    3  1858     5     1    1     30
7     0     8   0   164   0    1     6  6980    76    4     24
8     1     0   0   212   0   12     3   113  2866    4     84
9     5     1   0    20   1   74     2     6     4  356     24
10    5     1   0     7   0    0    34    17    37    2  12691
---- Validation: 
scalar performance:
{'acc': 0.92785877, 'precision': 0.75801873, 'recall': 0.6951067, 'specificity': 0.99180865, 'f1': 0.702452, 'auroc': 0.98194003}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   311     1   0     2   0    5     6    22     2    3    131
1     0  1215   0    14   0    3     4    84     5    1      6
2     1     6   0    66  21    4    26    22     5  102     59
3     0     0   0  8074   0   19     4   249    91    2      1
4     0     0   0    14  29    5   128     6    23    8    326
5     0     0   0    39   0  284     0     0     3  193      2
6    10     1   0     2   0    1  1850     5     3    2     34
7     0     8   0   174   1    1     3  6988    67    2     21
8     1     0   0   222   0    3     8    93  2893    8     68
9     2     1   0    18   1   85     0     5     5  362     14
10    6     1   0     8   0    0    46    19    32    2  12682
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6885189, 'precision': 0.5388257, 'recall': 0.5700181, 'specificity': 0.96785295, 'f1': 0.536388, 'auroc': 0.8654717}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   862     0   0   6   0    4    73   105    13    8    99
1     2  1210   0  25   0    8    23   208     6    2    15
2    18     5   0  32  66   12   350    63   134   76   259
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   0   0    0   181     1     7    0  1442
5    15     0   0  40   0  267    13     0     7  228    22
6     0     0   0   8   0    0  3019     5     9    1    25
7     0     0   0  11   0    0    10  1139     1    1     2
8     0     0   0  52   0    5    55    10  1234    9     5
9    72    14   0  81  21   76    68   109   133  477    86
10    0     0   0   0   0    0    13     0     0    0  1633
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 22:22:23.934820,epoch time: 1:53:31.483942,used: 3:58:09.690006,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9304634, 'precision': 0.8366145, 'recall': 0.718295, 'specificity': 0.99247533, 'f1': 0.7143214, 'auroc': 0.98198557}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   306     0   0     4   0    4     6    40    11    7    105
1     0  1250   0    16   0    1     3    45    13    0      4
2     2     3   1    62  38    2    22    23    12  141      6
3     0     0   0  8046   0   32     0   262    96    1      1
4     1     2   0    18  38    4   228    12    39   13    184
5     0     0   0    20   0  432     0     0     4   64      1
6     8     2   0     3   0    5  1853     8     9    1     19
7     0    12   0   165   0    1     4  6977    96    0      8
8     0     0   0   124   0    4     3    78  3061    8     17
9     0     0   0    15   0  152     1     5     3  313      4
10   15     2   0     8   2    3   128    20   113    1  12500
---- Validation: 
scalar performance:
{'acc': 0.9312826, 'precision': 0.7897827, 'recall': 0.71880686, 'specificity': 0.9925701, 'f1': 0.71576345, 'auroc': 0.9801752}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   311     1   0     6   0    2     6    34     7    8    108
1     0  1249   0    11   0    5     3    46    15    0      3
2     0     3   1    60  46    4    22    19    12  135     10
3     0     1   0  8078   0   22     0   237   101    1      0
4     3     1   1    13  40    6   231    11    48   16    169
5     0     0   0    25   0  432     0     0     5   58      1
6    10     0   0     7   0    8  1844     8     8    0     23
7     1     8   0   173   0    0     3  6987    84    6      3
8     0     0   0   129   0    9     3    85  3047    4     19
9     0     1   0    15   1  151     0     7     6  311      1
10   10     0   0     7   1    3   113    25   118    3  12516
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6786539, 'precision': 0.6256303, 'recall': 0.57600933, 'specificity': 0.96670896, 'f1': 0.53280526, 'auroc': 0.8679449}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   638     0   0   14   0   22    43   260    30   74    89
1     0  1273   0   29   0   12    12   162     7    2     2
2     2     6   1  122  97   35   273    68   304   98     9
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    0   3    0   785     3    28    1   812
5     1     0   0   72   0  478     6     1     7   26     1
6     0     0   0   18   0    1  3032     2    14    0     0
7     0     0   0   21   0    1     2  1131     7    1     1
8     0     0   0   84   0   11     3     2  1268    2     0
9     2    17   0  128  15  285    20    59   215  389     7
10    0     0   0    0   0    0   158     0     1    0  1487
better model found
persisted
after epoch: 3,now: 2024-07-29 00:17:42.993936,epoch time: 1:55:19.059116,used: 5:53:28.749122,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9356806, 'precision': 0.8425909, 'recall': 0.69116014, 'specificity': 0.99269235, 'f1': 0.7130172, 'auroc': 0.9866172}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   180     0   0    15   0    2    16    17     4    0    249
1     0  1281   0    14   0    0     1    33     2    0      1
2     1     8   5    86  68    3    16    55     9   43     18
3     0     3   0  8100   0    5     0   200   129    0      0
4     0     4   1    10  82    5   177     8    23    0    229
5     0     0   0    59   0  396     0     1     6   57      2
6     1     0   0     9   0    1  1857     3     7    0     29
7     0    16   0   125   1    0     3  7079    30    0      9
8     0     0   0    71   0    0     1   161  3019    1     41
9     1     2   1    38   3  143     2    31     7  257      8
10    0     3   0     9   3    3    22    13    26    0  12716
---- Validation: 
scalar performance:
{'acc': 0.9353216, 'precision': 0.8679592, 'recall': 0.6896134, 'specificity': 0.99266297, 'f1': 0.71101236, 'auroc': 0.9864979}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   176     0   0    10   0    5    13    21     8    1    249
1     0  1278   0    15   0    0     1    35     1    0      2
2     0     6   4    92  72    2    16    53    10   43     14
3     0     2   0  8094   0    4     0   209   130    0      1
4     0     1   0    12  80    4   181     8    27    0    226
5     0     0   0    54   0  396     0     2    12   56      1
6     0     0   0    12   1    2  1841     3    14    0     35
7     0    18   0   131   1    0     0  7078    28    0      9
8     1     1   0    60   0    0     4   132  3060    0     38
9     0     2   0    41   3  139     3    27    11  257     10
10    0     2   0    10   0    3    38    17    22    1  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58343244, 'precision': 0.519456, 'recall': 0.48901442, 'specificity': 0.9582063, 'f1': 0.43465948, 'auroc': 0.83419025}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   91     0   0   60   0   69   151    91    60   22   626
1    0  1303   0   45   0    1     2   137     2    0     9
2    0    19   0  126  41   33    64   112   416   50   154
3    0     0   0    0   0    0     0     0     0    0     0
4    0     1   0    0   2    0    42     2    51    0  1535
5    0     0   0  178   0  349     3     0    19   43     0
6    0     0   0   86   0    0  2343     6   528    0   104
7    0     0   0   68   0    0     0  1092     1    0     3
8    0     0   0   72   0    1     0    11  1285    1     0
9    0    24   0  239   6  155     4   137   306  231    35
10   0     0   0    0   0    0     0     2     1    0  1643
better model found
persisted
after epoch: 4,now: 2024-07-29 02:13:17.983656,epoch time: 1:55:34.989720,used: 7:49:03.738842,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93907857, 'precision': 0.80968213, 'recall': 0.7362688, 'specificity': 0.99325854, 'f1': 0.7491431, 'auroc': 0.99078226}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   318     0   0     4    0    0     3    43     7    8    100
1     0  1249   0     6    0    0     0    59    10    3      5
2     0     0   0   140   27    0     1    20     3  112      9
3     0     1   0  7953    0   10     0   198   274    2      1
4     0     0   0    50  152    2    86     9    17   11    212
5     0     0   0    33    0  264     0     0     4  219      1
6     5     1   0     7    1    1  1819     6     9    1     57
7     0     4   0   100    1    0     1  7054    93    2      6
8     2     0   0    29    0    0     0    86  3157    2     20
9     0     0   0    14    0   23     0     8     6  442      0
10    3     0   0    15    1    0    10    14    56    3  12691
---- Validation: 
scalar performance:
{'acc': 0.9388525, 'precision': 0.8068305, 'recall': 0.7356972, 'specificity': 0.99323064, 'f1': 0.7466372, 'auroc': 0.9898912}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   321     0   0     5    0    0     1    40     2   15     99
1     0  1248   0    12    0    0     0    59     4    1      8
2     0     1   0   152   26    0     1    21     4  103      4
3     0     0   0  7939    0   15     0   207   274    4      1
4     0     0   0    54  132    1    96     9    25   10    212
5     0     0   0    22    0  271     0     1     7  219      1
6     7     0   0     5    2    0  1821     9     5    3     56
7     0     3   0    96    1    0     1  7071    83    2      8
8     1     0   0    27    0    0     0    76  3163    3     26
9     0     0   0    14    0   22     0     4     5  447      1
10    4     0   0    15    2    0    12    17    58    2  12686
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6533268, 'precision': 0.56975013, 'recall': 0.54131013, 'specificity': 0.9652786, 'f1': 0.51469314, 'auroc': 0.8614694}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   635     1   0   15   1    1    11   174    61   76   195
1     0  1162   0   28   0    2     2   260    11    0    34
2     0     0   0  306  77    3    81   122   224  108    94
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    9  28    0   123     2    14    0  1457
5     0     0   0  111   0  201     0     2    16  259     3
6     0     0   0  103   0    0  2678     3    35    0   248
7     0     0   0   43   0    0     0  1116     0    1     4
8     0     0   0   31   0    1     1     4  1331    1     1
9     2     2   0  154   0   48     1   161   208  543    18
10    0     0   0    0   0    0     2     0     0    0  1644
better model found
persisted
after epoch: 5,now: 2024-07-29 04:09:59.272850,epoch time: 1:56:41.289194,used: 9:45:45.028036,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9431186, 'precision': 0.82839745, 'recall': 0.7242781, 'specificity': 0.99371, 'f1': 0.72772163, 'auroc': 0.9931161}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   304     0   0     4   0    1     3    73     9    1     88
1     0  1255   1    11   0    1     3    53     3    0      5
2     0     1   1    75  38    0    18    43     4  121     11
3     0     0   0  8191   0   14     0   144    84    5      1
4     1     0   0    13  50    1   216     5    11   12    229
5     0     0   0    19   0  277     0     0     3  220      2
6     3     0   0     7   0    1  1858     7     4    1     27
7     0     9   0   109   1    0     0  7075    58    2     10
8     2     0   0    78   0   11     4    82  3064    7     46
9     0     1   0     6   0   13     0     9     4  455      4
10    4     1   0     8   2    0    23    11    23    1  12720
---- Validation: 
scalar performance:
{'acc': 0.94214255, 'precision': 0.85739803, 'recall': 0.7214366, 'specificity': 0.9935873, 'f1': 0.7268911, 'auroc': 0.99204}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   294     0   0     7   0    0     5    69     7    1    100
1     0  1254   0    10   0    0     1    53     7    1      6
2     0     1   5    58  45    0    17    43     5  127     11
3     0     0   0  8177   0   20     2   158    76    7      0
4     1     0   1    10  55    1   210     6    11   18    226
5     0     0   0    24   0  268     0     0     2  226      1
6     4     1   0     5   0    1  1848     5     4    2     38
7     0     6   0   118   0    0     1  7070    55    2     13
8     0     0   0    85   0    4     6    86  3051   14     50
9     0     0   0     7   0   17     0     9     3  454      3
10    4     0   0     9   0    0    13     7    16    1  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67361647, 'precision': 0.6311419, 'recall': 0.55160004, 'specificity': 0.9669529, 'f1': 0.51830745, 'auroc': 0.8687147}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   555     1   0   23   0    3    16   263   138   56   115
1     0  1195   0   29   1    3     2   202    12    4    51
2     2     2   1   83  63    7   252    54   211  169   171
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    0   1    0   150     1     6    1  1473
5     0     0   0   53   0  205     0     0     8  324     2
6     0     0   0   45   0    0  2978     2    11    0    31
7     0     0   0   31   0    1     0  1125     3    1     3
8     0     0   0  142   0    8     0     5  1207    5     3
9     1     2   0  107   8   74     3    87   106  718    31
10    0     0   0    0   0    0     3     0     0    0  1643
better model found
persisted
after epoch: 6,now: 2024-07-29 06:05:09.533788,epoch time: 1:55:10.260938,used: 11:40:55.288974,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9455533, 'precision': 0.8956895, 'recall': 0.7491273, 'specificity': 0.99399, 'f1': 0.75574887, 'auroc': 0.994419}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   240     0   0     2    0    0     2    74     1    6    158
1     0  1281   0    10    0    0     1    28     7    2      2
2     0     1   1    81   27    1     0    51     4  138      8
3     0     1   0  8067    0   48     3   179   118   17      3
4     0     0   0    52  149    2   142     9     9   11    164
5     0     1   0    11    0  410     0     0     1   97      1
6     1     0   0     4    0    2  1868     6     3    2     22
7     1     3   0    67    0    1     2  7119    57    7      7
8     0     0   0    54    6    2     1    75  3112   20     25
9     0     0   0     3    0   60     0     3     1  426      0
10    1     0   0    16    4    1    56    10    36    3  12668
---- Validation: 
scalar performance:
{'acc': 0.9453257, 'precision': 0.8944241, 'recall': 0.74876297, 'specificity': 0.99397737, 'f1': 0.755896, 'auroc': 0.9944725}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   240     0   0     1    0    0     4    77     1    7    153
1     0  1276   0     6    0    0     2    36     9    1      2
2     0     0   3    81   25    1     1    54     2  140      5
3     0     2   0  8071    0   52     1   181   113   18      2
4     0     0   0    49  158    4   134     9     9   11    165
5     0     0   0     8    0  402     0     0     3  107      1
6     1     0   0     0    0    0  1869     4     0    4     30
7     0     7   0    71    0    0     4  7113    54    9      7
8     0     1   0    42    4    4     5    71  3119   25     25
9     0     0   0     4    0   62     0     2     1  422      2
10    0     0   0    19    8    1    56    10    31    3  12668
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6772546, 'precision': 0.57202613, 'recall': 0.5659623, 'specificity': 0.967278, 'f1': 0.523837, 'auroc': 0.8720453}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   360     1   0    3   0   14    13   225    42  207   305
1     0  1117   0   30   1   14    12   240    35   16    34
2     0     0   0  138  72    9    67   132   273  281    43
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0   13  46    0   356     2    21    2  1193
5     0     0   0   21   0  356     0     0     2  213     0
6     0     0   0   33   0    0  3018     2     5    2     7
7     0     0   0   39   0    0     0  1106     6   10     3
8     0     0   0   82   0    6     1     4  1256   21     0
9     0     1   0   40   1  127     1    38   107  814     8
10    0     0   0    1   0    0    37     0     1    0  1607
better model found
persisted
after epoch: 7,now: 2024-07-29 08:01:33.584771,epoch time: 1:56:24.050983,used: 13:37:19.339957,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9398812, 'precision': 0.8766493, 'recall': 0.701746, 'specificity': 0.9928823, 'f1': 0.7246875, 'auroc': 0.9923019}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   62     0   0     3    0    0     4    70     0    3    341
1    0  1274   0    10    0    0     0    45     3    0      0
2    0     0  22    26    6    1     1   133     6   99     17
3    0     1   0  8222    0    6     0   160    47    1      0
4    0     3  24     8  127    1    37    17    21    8    293
5    0     0   0    47    0  395     0     0     3   75      1
6    0     0   0    12    0    1  1810     8     2    1     74
7    0     6   0    80    0    0     1  7116    44    1     15
8    0     0   0   130    0    0     0   127  2980    2     57
9    0     0   0     7    0   82     0    17     3  378      6
10   0     1   0    12    1    2     6    13    13    2  12743
---- Validation: 
scalar performance:
{'acc': 0.9403504, 'precision': 0.8819139, 'recall': 0.69989955, 'specificity': 0.9929247, 'f1': 0.7218692, 'auroc': 0.9927696}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   48     0   0     2    0    1     1    79     0    4    348
1    0  1269   0    14    0    0     0    47     1    0      1
2    0     1  24    30   10    1     0   119    12   98     17
3    0     1   0  8238    0   11     0   147    42    1      0
4    0     3  16    12  125    2    45    22    21    5    288
5    0     0   0    46    0  405     0     0     2   66      2
6    1     0   0    15    0    0  1811     2     0    3     76
7    0     3   0    87    1    0     1  7125    38    0     10
8    0     0   0   120    0    1     0   132  2984    1     58
9    0     0   0     5    0   82     0    23     6  371      6
10   1     0   0     7    1    0     3    16    12    1  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5543973, 'precision': 0.52222514, 'recall': 0.43933484, 'specificity': 0.95625705, 'f1': 0.40902066, 'auroc': 0.8032577}
confusion matrix:
    0     1   2    3   4    5     6     7    8    9     10
0   12     2   0  110   0    6    57   236    5   28   714
1    0  1215   0   58   0    0     0   213    2    0    11
2    0     4   0  239  16   11    54   131  283   67   210
3    0     0   0    0   0    0     0     0    0    0     0
4    0     0   0    3   0    0    22     2   28    1  1577
5    0     0   0  309   0  229     2     1    1   48     2
6    0     0   0  414   0    0  2635     4   12    0     2
7    0     0   0   83   0    0     0  1078    0    1     2
8    0     0   0  446   0    1     0    11  910    1     1
9    0     7   0  477   0  148     4   117  151  201    32
10   0     0   0    0   0    0     2     0    0    0  1644
early stop counter: 1
val acc:0.9403504133224487, best validation acc: 0.9453256726264954, corresponding to test acc:                         0.6772546172142029 / 0.6885188817977905
after epoch: 8,now: 2024-07-29 09:57:48.577728,epoch time: 1:56:14.992957,used: 15:33:34.332914,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.947774, 'precision': 0.8771088, 'recall': 0.7323239, 'specificity': 0.9941075, 'f1': 0.7596351, 'auroc': 0.99532}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   149     0   0     2    0    0    13    86     6    1    226
1     0  1293   0     5    0    0     1    24     7    0      1
2     0     8  19   101  102    0     1    31     4   37      9
3     0     3   0  8166    1    2     5   154   107    1      1
4     0     2   1     5  241    0    96     4    19    0    171
5     0     1   0    47    0  331     2     3    10  123      4
6     1     0   0     0    1    0  1879     3     1    0     22
7     0    13   0    74    3    0     2  7101    58    0     13
8     0     0   0    42    3    0     2    57  3171    1     18
9     0     2   7    23    6   34     0    36    10  367      7
10    0     0   0     8   11    0    32     5    29    1  12707
---- Validation: 
scalar performance:
{'acc': 0.94687706, 'precision': 0.88687515, 'recall': 0.72819346, 'specificity': 0.9940193, 'f1': 0.753701, 'auroc': 0.9956996}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   142     0   0     1    0    1    11    97    11    0    220
1     0  1298   0     7    0    0     1    20     4    0      2
2     0     3  15   101  107    0     5    36     5   32      8
3     0     4   0  8162    0    4     4   153   112    0      1
4     0     2   0     1  230    0   107     7    15    2    175
5     0     0   0    46    0  326     1     2     7  135      4
6     0     0   0     0    1    0  1880     3     3    0     21
7     0    11   0    75    1    0     1  7100    68    0      9
8     0     1   0    46    3    0     2    59  3163    1     21
9     0     4   3    30    6   30     5    27     8  374      6
10    0     0   0     7   13    0    28     5    33    1  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63716507, 'precision': 0.6242546, 'recall': 0.4996248, 'specificity': 0.96303225, 'f1': 0.46026173, 'auroc': 0.86153275}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   161     1   0    6    1    1   129   186    47    4   634
1     0  1330   0   22    1    0     6   111    11    0    18
2     0     9   5   55  218    0   141    74   340   37   136
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  109    0   183     0    16    0  1325
5     1     1   0  143    0  155     9     8    52  213    10
6     0     0   0   12    0    0  3010     2     8    0    35
7     0     0   0   17    0    0     2  1135     5    0     5
8     0     0   0   73    0    0     4    11  1279    1     2
9     1     8   3  133   30   15    16   290   306  291    44
10    0     0   0    0    1    0    12     0     1    0  1632
better model found
persisted
after epoch: 9,now: 2024-07-29 11:25:01.682231,epoch time: 1:27:13.104503,used: 17:00:47.437417,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9425835, 'precision': 0.81095684, 'recall': 0.70850104, 'specificity': 0.9932649, 'f1': 0.7143774, 'auroc': 0.9968082}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   52     0   0     1    0    1     4    36     2    2    385
1    0  1307   0     6    0    0     0    17     1    1      0
2    0     0   0   143   40    1     3     4     1  102     18
3    0     4   0  8123    0    9     3   212    81    1      5
4    0     2   0    15  124    1   151     0     1    6    239
5    0     0   0    14    0  429     0     0     1   76      1
6    0     0   0     1    0    1  1876     1     1    0     28
7    0    19   0    50    2    0     0  7156    14    5     18
8    0     1   0    49    2    4     4   120  3003   12    101
9    0     1   0    10    1   75     0     2     0  400      4
10   0     2   0     7    2    0     9     5     3    2  12760
---- Validation: 
scalar performance:
{'acc': 0.94430923, 'precision': 0.8586632, 'recall': 0.7139535, 'specificity': 0.9934455, 'f1': 0.7222294, 'auroc': 0.996683}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   56     1   0     1    0    0     3    32     0    2    388
1    0  1304   0     2    0    1     0    22     1    0      2
2    0     0   1   135   51    2     2     1     0  102     18
3    0     1   0  8137    0    9     3   216    67    2      5
4    0     0   0    12  143    1   143     2     3    3    232
5    0     0   0    13    0  441     0     0     2   64      1
6    0     0   0     2    0    1  1874     1     0    1     29
7    0    16   0    49    1    0     0  7160    15    6     18
8    0     0   1    45    1    0     2   115  3029    5     98
9    0     1   0     9    0   81     0     4     2  392      4
10   0     0   0     7    5    1     5     7     5    0  12766
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6498985, 'precision': 0.6594141, 'recall': 0.52716434, 'specificity': 0.96445996, 'f1': 0.48668876, 'auroc': 0.8631849}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   48     0   0   10    0    4    74   116     1   23   894
1    0  1337   0   27    0    1     3   113     5    0    13
2    0     5   2  128  175    7   183    57   169   91   198
3    0     0   0    0    0    0     0     0     0    0     0
4    0     0   0    1   19    0   108     0     5    1  1499
5    0     1   0  114    0  310     4     2    14  141     6
6    0     0   0   15    0    0  3028     3    11    0    10
7    0     0   0   10    0    0     0  1149     0    0     5
8    0     0   0   91    1    0     6    25  1240    2     5
9    1     9   0  190    5   86    10   120   157  512    47
10   0     0   0    0    0    0     2     0     0    0  1644
early stop counter: 1
val acc:0.9443092346191406, best validation acc: 0.9468770623207092, corresponding to test acc:                         0.6371650695800781 / 0.6885188817977905
after epoch: 10,now: 2024-07-29 12:38:49.123598,epoch time: 1:13:47.441367,used: 18:14:34.878784,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 18:14:34.878784 at 2024-07-29 12:38:49.123598
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63716507, 'precision': 0.6242546, 'recall': 0.4996248, 'specificity': 0.96303225, 'f1': 0.46026173, 'auroc': 0.86153275}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   161     1   0    6    1    1   129   186    47    4   634
1     0  1330   0   22    1    0     6   111    11    0    18
2     0     9   5   55  218    0   141    74   340   37   136
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  109    0   183     0    16    0  1325
5     1     1   0  143    0  155     9     8    52  213    10
6     0     0   0   12    0    0  3010     2     8    0    35
7     0     0   0   17    0    0     2  1135     5    0     5
8     0     0   0   73    0    0     4    11  1279    1     2
9     1     8   3  133   30   15    16   290   306  291    44
10    0     0   0    0    1    0    12     0     1    0  1632
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6885189, 'precision': 0.5388257, 'recall': 0.5700181, 'specificity': 0.96785295, 'f1': 0.536388, 'auroc': 0.8654717}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   862     0   0   6   0    4    73   105    13    8    99
1     2  1210   0  25   0    8    23   208     6    2    15
2    18     5   0  32  66   12   350    63   134   76   259
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   0   0    0   181     1     7    0  1442
5    15     0   0  40   0  267    13     0     7  228    22
6     0     0   0   8   0    0  3019     5     9    1    25
7     0     0   0  11   0    0    10  1139     1    1     2
8     0     0   0  52   0    5    55    10  1234    9     5
9    72    14   0  81  21   76    68   109   133  477    86
10    0     0   0   0   0    0    13     0     0    0  1633
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_18_24_13_seed_0_23121383_instance_wise_predictions.txt
accuracy from prediction file 0.6371650458266285
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/32.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/32.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/32.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |   1648 MiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      7 MiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |   1648 MiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      7 MiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB |    816 TiB |    816 TiB |
|       from large pool |   1647 MiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      6 MiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20112 MiB |  20112 MiB |  20112 MiB |      0 B   |
|       from large pool |  20078 MiB |  20078 MiB |  20078 MiB |      0 B   |
|       from small pool |     34 MiB |     34 MiB |     34 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231478 KiB | 783421 KiB | 117575 GiB | 117575 GiB |
|       from large pool | 216320 KiB | 781120 KiB | 111655 GiB | 111655 GiB |
|       from small pool |  15158 KiB |  17181 KiB |   5919 GiB |   5919 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   53605 K  |   53602 K  |
|       from large pool |     247    |     691    |   27281 K  |   27281 K  |
|       from small pool |    2419    |    3627    |   26323 K  |   26321 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   53605 K  |   53602 K  |
|       from large pool |     247    |     691    |   27281 K  |   27281 K  |
|       from small pool |    2419    |    3627    |   26323 K  |   26321 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     566    |     566    |     566    |       0    |
|       from large pool |     549    |     549    |     549    |       0    |
|       from small pool |      17    |      17    |      17    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     120    |    1251    |   30691 K  |   30691 K  |
|       from large pool |      94    |     367    |   18777 K  |   18777 K  |
|       from small pool |      26    |    1157    |   11914 K  |   11914 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |    816 TiB |    816 TiB |
|       from large pool |  16640 KiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20112 MiB |  20112 MiB |  18230 MiB |
|       from large pool |   1860 MiB |  20078 MiB |  20078 MiB |  18218 MiB |
|       from small pool |     22 MiB |     34 MiB |     34 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 783421 KiB | 117576 GiB | 117576 GiB |
|       from large pool |  24320 KiB | 781120 KiB | 111656 GiB | 111656 GiB |
|       from small pool |      0 KiB |  20690 KiB |   5919 GiB |   5919 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   53605 K  |   53605 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   53605 K  |   53605 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     566    |     566    |     462    |
|       from large pool |      93    |     549    |     549    |     456    |
|       from small pool |      11    |      17    |      17    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   30692 K  |   30692 K  |
|       from large pool |       3    |     367    |   18777 K  |   18777 K  |
|       from small pool |       0    |    1157    |   11915 K  |   11915 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |    816 TiB |    816 TiB |
|       from large pool |  16640 KiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20112 MiB |  20112 MiB |  18230 MiB |
|       from large pool |   1860 MiB |  20078 MiB |  20078 MiB |  18218 MiB |
|       from small pool |     22 MiB |     34 MiB |     34 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 783421 KiB | 117576 GiB | 117576 GiB |
|       from large pool |  24320 KiB | 781120 KiB | 111656 GiB | 111656 GiB |
|       from small pool |      0 KiB |  20690 KiB |   5919 GiB |   5919 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   53605 K  |   53605 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   53605 K  |   53605 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     566    |     566    |     462    |
|       from large pool |      93    |     549    |     549    |     456    |
|       from small pool |      11    |      17    |      17    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   30692 K  |   30692 K  |
|       from large pool |       3    |     367    |   18777 K  |   18777 K  |
|       from small pool |       0    |    1157    |   11915 K  |   11915 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383

 Experiment start at: 2024-07-29 13:02:04.920569
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8270548, 'precision': 0.5343945, 'recall': 0.50094825, 'specificity': 0.9812628, 'f1': 0.45304108, 'auroc': 0.9053469}
confusion matrix:
      0     1    2     3   4   5    6     7     8   9      10
0    431     1    2     8   0   0    0    26     3   0     12
1      0  1221    4    21   0   0    0    78     4   0      3
2    106     5   29    11   0   1    0    60     4   0     96
3      7     0    0  8033   0   0    0   336    60   0      1
4     52    23   19    12   0   3    0    37    38   0    355
5    220     1    1   168   0   8    1    34    32   0     56
6   1122   114    8    36   0  10  247    65    15   0    291
7      4    14    3   276   0   1    0  6953     6   0      7
8     15    19   91   676   0   7    1   380  2042   0     64
9    339     2    8    30   0   2    0    52     4   0     56
10   368    22  122    31   0   3    1   263    35   0  11948
---- Validation: 
scalar performance:
{'acc': 0.8260265, 'precision': 0.5395106, 'recall': 0.4985127, 'specificity': 0.98111385, 'f1': 0.45342016, 'auroc': 0.90590274}
confusion matrix:
      0     1    2     3   4   5    6     7     8   9      10
0    419     0    3     7   0   0    0    34     1   0     19
1      0  1213    6    20   0   0    0    88     2   0      3
2    103     6   31     5   0   2    0    66     6   0     93
3      3     2    1  8064   0   0    0   308    62   0      0
4     60    21   24    12   0   2    0    41    30   0    349
5    222     0    1   169   0  11    4    27    21   0     66
6   1097   109    6    39   0   5  255    61    16   0    320
7      5     8    6   272   0   0    0  6961     5   0      8
8     14    21   92   697   0   9    1   409  1995   0     58
9    345     1    7    25   0   2    0    39     2   0     72
10   374    21  143    29   0   7    0   254    36   0  11932
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40740222, 'precision': 0.38958257, 'recall': 0.38702598, 'specificity': 0.9408434, 'f1': 0.2972873, 'auroc': 0.7278571}
confusion matrix:
     0     1   2    3   4   5   6     7    8   9     10
0   876     2   7   27   0   0   0   253    1   0     4
1     1  1179   9   32   0   0   0   271    0   0     7
2   423    24  92   50   0   6   0   168   51   0   201
3     0     0   0    0   0   0   0     0    0   0     0
4    67     8  12    3   0   4   0    25    8   0  1506
5   374     0   0   69   0   7   0    94   13   0    35
6   611    82  25  288   0  32  19   112   69   0  1829
7     2     1   0   12   0   0   0  1146    0   0     3
8    20     7  17  297   0  12   1   122  879   0    15
9   686    22  30   81   0   6   1   240   14   0    57
10   10     0   2    1   0   0   0     8    0   0  1625
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 14:22:53.869558,epoch time: 1:20:48.948989,used: 1:20:48.948989,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90868473, 'precision': 0.6462692, 'recall': 0.6530311, 'specificity': 0.9900619, 'f1': 0.6345365, 'auroc': 0.9348033}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   393     0   0     6   0    2    41    10    12   0     19
1     0  1247   2    23   0    0     0    45    12   0      3
2    62     1  61     4   0    5     7    63    62   0     47
3     0     0   0  8115   0    4     4   118   195   0      0
4    31     2  14     3   0   15     2    31   109   0    332
5    60     0   2    70   0  250    36     6    86   0     11
6    13     0   0     4   0    2  1870     3     8   0      6
7     1     6   4   444   0    0     5  6679   115   0     10
8     1     0   2   127   0    9     1    53  3090   0     13
9   238     0  15    18   0   59    21    34    64   0     44
10  155     3  13    43   0   46    39    76   161   0  12258
---- Validation: 
scalar performance:
{'acc': 0.90851945, 'precision': 0.64326876, 'recall': 0.6526591, 'specificity': 0.99005187, 'f1': 0.63491154, 'auroc': 0.9353248}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   381     1   0     4   0    1    54    14    13   0     15
1     0  1247   3    21   0    0     0    48    11   0      2
2    61     2  62     0   0    7     5    60    68   0     47
3     1     0   2  8145   0    1     7   103   181   0      0
4    39     0  15     3   0    7     3    20   114   0    338
5    58     0   1    67   0  260    36     6    83   0     10
6    16     0   0     8   0    0  1870     0     7   0      7
7     1    11   5   451   0    0     2  6668   118   0      9
8     2     0   2   124   0   10     2    52  3087   0     17
9   223     0  20    18   0   65    25    41    63   0     38
10  138     1  13    43   0   50    33    84   189   0  12245
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6419226, 'precision': 0.46349406, 'recall': 0.5056915, 'specificity': 0.96398747, 'f1': 0.445419, 'auroc': 0.8199066}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   917     3   0   13   0    6   187   31     8   0     5
1     0  1253   7   44   0    3     6  159    16   0    11
2   202     8  27   18   0   65    17   89   344   0   245
3     0     0   0    0   0    0     0    0     0   0     0
4    12     0   1    9   0   18     7    7    38   0  1541
5   222     0   0   85   0  118    23   25    68   0    51
6     0     0   0   14   0   17  3012    5    19   0     0
7     0     0   0  178   0    0     7  975     1   0     3
8     2     0   0  104   0    7    11    5  1241   0     0
9   425     4  14  115   0   83    49  132   244   0    71
10    0     0   0    4   0    1     6    2     1   0  1632
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 15:38:36.038793,epoch time: 1:15:42.169235,used: 2:36:31.118224,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9198148, 'precision': 0.69132614, 'recall': 0.6418692, 'specificity': 0.99054533, 'f1': 0.6452552, 'auroc': 0.931528}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   396     7   1     6   0    0    12     9     5   0     47
1     0  1286   1     8   0    0     0    26    10   0      1
2    25     1  15     3   0    3     2    79    25   0    159
3     0     3   0  8215   0    1     8   145    65   0      0
4     6     7   0     2   0    3     2    17    36   0    466
5     7     1   0    45   0  250     2     5   170   0     41
6    13     7   0     4   0    2  1851     1    11   0     19
7     1    44   1   273   0    0     2  6907    29   0      7
8     2     6   0   259   0    1     0   126  2858   0     42
9    38     1   5    18   0   76     5    48    76   0    226
10   17    35   5    31   0    0     6    46    52   0  12601
---- Validation: 
scalar performance:
{'acc': 0.9200482, 'precision': 0.6888777, 'recall': 0.63933873, 'specificity': 0.99055535, 'f1': 0.64352435, 'auroc': 0.9313962}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   388     7   0    11   0    0     9    14     3   0     51
1     0  1291   1    13   0    0     0    23     3   0      1
2    22     0  17     4   0    6     3    67    21   0    172
3     1     5   0  8230   0    0     4   146    53   0      1
4     2    11   1     2   0    3     0    20    42   0    458
5     5     1   1    45   0  236     2     5   179   0     47
6    11     7   0     1   0    3  1857     3     6   0     20
7     1    52   3   267   0    0     1  6903    28   0     10
8     3    14   2   256   0    0     3   112  2863   0     43
9    47     3   6    13   0   66     8    48    69   0    233
10   18    44   2    31   0    0     7    39    44   0  12611
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6259008, 'precision': 0.49388558, 'recall': 0.49890977, 'specificity': 0.9624597, 'f1': 0.4486932, 'auroc': 0.80457395}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   978    21   1   23   0    0    71   31     4   0    41
1     0  1360   3   34   0    0     0   95     4   0     3
2     9    52  11   27   0    6     3   87   328   0   492
3     0     0   0    0   0    0     0    0     0   0     0
4     0    13   1    2   0    0     2    2    19   0  1594
5     6     0   0  135   1   87     1   13   146   0   203
6     1    24   0   27   0  110  2695    5    71   0   134
7     0     5   0  191   0    0     2  961     0   0     5
8     0     0   0  128   0    2     0   23  1216   0     1
9    32    26   2  169   0   37     3  180   288   0   400
10    0     6   0    0   0    0     0    1     1   0  1638
better model found
persisted
after epoch: 3,now: 2024-07-29 16:53:04.575829,epoch time: 1:14:28.537036,used: 3:50:59.655260,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.928216, 'precision': 0.68568313, 'recall': 0.6808859, 'specificity': 0.9917615, 'f1': 0.68136746, 'auroc': 0.9410171}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   401     0   0     1   0    0    11    18     2   0     50
1     0  1261   3    12   0    0     0    52     3   0      1
2    13     0  75     2   0    3     4   163    13   0     39
3     2     0   1  8231   0    3     2    90   110   0      0
4     5     0  21     0   0    2     0    85    16   0    410
5     5     0   2     5   0  359     4     9   124   0     13
6    12     0   1    10   0    1  1857     3     1   0     23
7     0     9  19   266   0    1     4  6904    50   0     10
8     1     0  39   143   0    6     0    91  2947   0     67
9    64     0  20     4   0  123    32   128    59   0     63
10    8     0  10    10   0    0     6    82    18   0  12658
---- Validation: 
scalar performance:
{'acc': 0.9272703, 'precision': 0.6828216, 'recall': 0.67691886, 'specificity': 0.99166805, 'f1': 0.6778494, 'auroc': 0.9407484}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   398     0   1     2   0    1     7    17     3   0     54
1     0  1265   5    15   0    0     0    43     2   0      2
2    16     0  71     1   0    6     4   162    14   0     38
3     1     0   1  8225   0    5     1    96   110   0      1
4     6     0  20     0   0    6     1    94    16   0    396
5     5     0   2     7   0  345     9     3   134   0     16
6    11     0   0     7   0    2  1862     3     2   0     21
7     1     6  26   281   0    0     5  6892    48   0      6
8     2     1  28   154   0    9     2    99  2947   0     54
9    54     0  17     2   0  125    18   145    63   0     69
10    6     0  14    12   0    2     8    76    17   0  12661
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6841811, 'precision': 0.5050784, 'recall': 0.56986785, 'specificity': 0.9681201, 'f1': 0.50729704, 'auroc': 0.83499974}
confusion matrix:
      0     1   2   3   4    5     6     7     8   9     10
0   1117     1   3   3   0    2    14    15     4   0    11
1      0  1287  14  34   0    0     2   152     1   0     9
2     43     5  83   9   0   23    16   288   149   0   399
3      0     0   0   0   0    0     0     0     0   0     0
4      1     0   2   0   0    1     4     7    11   0  1607
5     36     0   0  16   0  338    29    25   115   0    33
6      0     0   0  17   0   13  3009     1     8   0    19
7      1     2   4  40   0    1     4  1106     0   0     6
8      1     1   1  98   0   18     5    41  1197   0     8
9    195     1  58  39   0  168   103   301   188   0    84
10     0     0   0   0   0    0     2     1     1   0  1642
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 18:15:22.440223,epoch time: 1:22:17.864394,used: 5:13:17.519654,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.91622967, 'precision': 0.6701621, 'recall': 0.62870955, 'specificity': 0.989962, 'f1': 0.6256112, 'auroc': 0.9422653}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   435     0   0     0   0    0     3     7     0   0     38
1     0  1277   2    10   0    0     0    32     5   0      6
2    32     0   5     0   0    0     1   129     4   0    141
3     9     0   0  7880   0   16     2   376   145   0     10
4     5     0   0     0   0    0     0    16     6   0    512
5    16     0   0     8   0  161    22    30   157   0    127
6    23     2   0     2   0    0  1859     2     0   0     19
7     9    10   3    89   0    0     2  7091    24   0     33
8     6     2   4   109   0   16     4   127  2804   0    223
9   100     0   2     3   0   12     4   189    15   0    168
10   29     1   0     4   0    0     3    24     1   0  12733
---- Validation: 
scalar performance:
{'acc': 0.9161428, 'precision': 0.67324924, 'recall': 0.6283163, 'specificity': 0.9899421, 'f1': 0.6257763, 'auroc': 0.9405345}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   435     0   1     0   0    0     1    10     0   0     36
1     0  1272   0     6   0    0     1    43     3   0      7
2    25     0   5     0   0    0     2   130     0   0    150
3     7     1   0  7889   0   14     4   372   143   0     10
4     5     0   0     0   0    0     0    17     5   0    512
5    16     0   1    12   0  162     8    38   168   0    116
6    22     1   0     3   0    0  1861     4     0   0     17
7     9    14   3    79   0    0     2  7100    30   0     28
8     4     1   2   113   0   18     1   126  2789   0    242
9   105     0   2     1   0   18     7   191     4   0    165
10   28     1   0     3   0    0     3    23     1   0  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6729868, 'precision': 0.49843797, 'recall': 0.53375286, 'specificity': 0.96683246, 'f1': 0.46587527, 'auroc': 0.8305353}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9     10
0   1142     1   0   3   0   0     4    16     2   0     2
1      5  1321   2  21   0   0     4   123     5   0    18
2     45     2  11   9   0  15    13   128   154   0   638
3      0     0   0   0   0   0     0     0     0   0     0
4      2     0   0   0   0   2     7     5     7   0  1610
5     23     0   0  55   0  78    17    79   126   0   214
6      2     0   0   8   0   2  3048     1     1   0     5
7     14     0   0  14   0   0     8  1124     1   0     3
8      1     0   0  67   0   9     7    24  1251   0    11
9    182     3  13  37   0  24    68   340   202   0   268
10     0     0   0   0   0   0     2     0     0   0  1644
early stop counter: 1
val acc:0.9161428213119507, best validation acc: 0.9272702932357788, corresponding to test acc:                         0.6841810941696167 / 0.6841810941696167
after epoch: 5,now: 2024-07-29 19:25:47.695778,epoch time: 1:10:25.255555,used: 6:23:42.775209,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.927119, 'precision': 0.69431806, 'recall': 0.636335, 'specificity': 0.99153626, 'f1': 0.634664, 'auroc': 0.9508206}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   394     0   0     4   0    0    24    14     0   0     47
1     0  1285   0     7   0    0     2    30     3   0      4
2    20     0   8     0   0    1     4   203     4   0     72
3     0     0   0  8195   0    4     5   172    61   0      1
4     6     1   0     3   0    1     6    41     6   0    475
5    12     0   0    29   0  202    42    31   196   0      9
6     8     0   0     3   0    0  1877     8     0   0     11
7     2    15   2   113   0    0     6  7082    22   0     21
8     1     4   4   149   0    2    10    92  2905   0    128
9   148     0   0     4   0   39    47   204    23   0     28
10   15     0   0    20   0    0    13    39     3   0  12704
---- Validation: 
scalar performance:
{'acc': 0.92740405, 'precision': 0.6678822, 'recall': 0.63752174, 'specificity': 0.99158293, 'f1': 0.63495964, 'auroc': 0.9515113}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   391     0   0     2   0    0    32    12     0   0     46
1     0  1292   0     7   0    0     2    26     4   0      1
2    17     0   3     0   0    2     4   216     4   0     66
3     1     5   0  8190   0    3     7   165    67   0      2
4     7     0   0     5   0    2     3    46     8   0    468
5    16     0   0    27   0  218    36    33   185   0      6
6     7     0   0     3   0    0  1879     8     1   0     10
7     3    12   1   120   0    0     3  7075    27   0     24
8     1     1   6   149   0    3     7    97  2909   0    123
9   132     0   1     3   0   42    46   213    27   0     29
10   14     0   0    16   0    0    23    25     4   0  12714
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63002867, 'precision': 0.511158, 'recall': 0.48643768, 'specificity': 0.9628018, 'f1': 0.44028318, 'auroc': 0.8182125}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   895     2   0   28   0   0   206   31     2   0     6
1     0  1373   0   31   0   0     9   80     0   0     6
2    94     7   1   75   0   0    41  220    44   0   533
3     0     0   0    0   0   0     0    0     0   0     0
4     1     0   0    8   0   0    11    5     3   0  1605
5    25     0   0  152   0  72    61   95   113   0    74
6     0     0   0   16   0   0  3049    1     0   0     1
7     1     1   0  262   0   0     6  890     0   0     4
8     0     0   0  211   0   4    17   26  1087   0    25
9   234     9   1  253   0  16    98  393    38   0    95
10    0     0   0    6   0   0     2    0     0   0  1638
better model found
persisted
after epoch: 6,now: 2024-07-29 20:41:12.053673,epoch time: 1:15:24.357895,used: 7:39:07.133104,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.927119, 'precision': 0.73535454, 'recall': 0.633194, 'specificity': 0.9915851, 'f1': 0.62859285, 'auroc': 0.9516667}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   416     1   0     3   0    0    16    18     1   0     28
1     1  1270   0     6   0    0     1    47     3   0      4
2    28     0  15     3   0    0     3   175     4   0     84
3     5     1   0  8016   0    1     2   191   218   0      3
4     7     0   1     3   0    0     1    21    11   0    495
5    22     0   0    12   0  134    16    95   203   0     39
6    12     3   0     1   0    0  1874     3     2   0     12
7     1     7   0    81   0    0     3  7128    30   0     12
8     5     3   0    30   0    0     3   100  3090   0     65
9   177     0   1     4   0    2     6   224    24   0     54
10   15     0   0     9   0    0     9    40    13   0  12709
---- Validation: 
scalar performance:
{'acc': 0.92791224, 'precision': 0.7240715, 'recall': 0.6338608, 'specificity': 0.99169797, 'f1': 0.6296136, 'auroc': 0.9527361}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   412     1   1     2   0    0    14    20     0   0     33
1     0  1277   0     5   0    0     0    44     4   0      2
2    31     0  18     3   0    0     1   172     3   0     84
3     3     0   0  8031   0    1     1   182   221   0      1
4    10     0   0     2   0    0     0    25    11   0    491
5    25     0   0     4   0  131    19    87   213   0     42
6    10     1   0     2   0    0  1878     3     2   0     12
7     1     6   0    83   0    0     3  7132    27   0     13
8     1     2   3    25   0    0     3   106  3101   0     55
9   175     0   1     5   0    6     5   235    29   0     37
10   17     2   0     7   0    0     7    41    12   0  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6508081, 'precision': 0.4897697, 'recall': 0.5060129, 'specificity': 0.9649192, 'f1': 0.42699292, 'auroc': 0.82349885}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1111     0   0    8   0   0    29    17     5   0     0
1      3  1219   0   18   0   0     3   230     5   0    21
2    149     8   1   23   0   0     7   205   231   0   391
3      0     0   0    0   0   0     0     0     0   0     0
4      3     0   0    0   0   0     3     4    10   0  1613
5     52     2   0   72   0  10     5    96   191   0   164
6      4     1   0    4   0   0  3032     5    10   0    11
7      0     0   0  148   0   0     3  1010     0   0     3
8      2     0   0   59   0   1     0    33  1273   0     2
9    334     5   2   87   0   1    11   383   210   0   104
10     0     0   0    0   0   0     0     0     0   0  1646
better model found
persisted
after epoch: 7,now: 2024-07-29 21:59:43.161128,epoch time: 1:18:31.107455,used: 8:57:38.240559,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9199754, 'precision': 0.76464164, 'recall': 0.6140776, 'specificity': 0.9903468, 'f1': 0.62673396, 'auroc': 0.94033486}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   398     0   0     8   0   0     4    21     0   0     52
1     0  1262   0     7   0   0     0    58     1   0      4
2     5     0  44    10   0   0     1   138    16   0     98
3     0     0   0  7984   0   0     1   401    50   0      2
4     0     0   2     4   0   0     0    17     8   0    508
5     0     0   0    85   0  34     3     5   321   0     73
6    17     9   0     4   0   0  1835     3     4   0     34
7     0     2   0    62   0   0     1  7187     7   0      5
8     1     0   0    97   0   0     0   204  2912   0     81
9     8     0   2    26   0   1     3   106    51   0    296
10    3     2   0    13   0   0     3    38     5   0  12729
---- Validation: 
scalar performance:
{'acc': 0.9211181, 'precision': 0.7661094, 'recall': 0.6192435, 'specificity': 0.99049854, 'f1': 0.6333742, 'auroc': 0.9418251}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   402     0   0     4   0   0     5    18     0   0     54
1     0  1260   0     9   0   0     0    59     1   0      3
2     7     0  58    12   0   0     1   122    10   0    102
3     0     0   0  7999   0   0     0   385    54   0      2
4     2     1   3     6   0   0     0    15    11   0    501
5     0     0   0    71   0  33     2     9   338   0     68
6     9     8   0     9   0   0  1843     4     4   0     31
7     0     4   0    72   0   0     1  7171    11   0      6
8     0     0   0    99   0   0     1   203  2925   0     68
9     7     0   4    21   0   0     3   107    55   0    296
10    3     3   0    10   0   0     3    30     2   0  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63303715, 'precision': 0.5170995, 'recall': 0.4927191, 'specificity': 0.96359324, 'f1': 0.44509888, 'auroc': 0.7911077}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   991     1   0   89   0   0    15    49     8   0    17
1     0  1250   0   39   0   0     0   190     0   0    20
2     2     5   0   84   0   0     0    69   223   0   632
3     0     0   0    0   0   0     0     0     0   0     0
4     1     0   0    0   0   0     1     4    12   0  1615
5     2     0   0  304   0  11     4     9   159   0   103
6     1     2   0   81   0   0  2907     2    28   0    46
7     0     0   0  113   0   0     0  1047     0   0     4
8     0     0   0  141   0   0     1    25  1197   0     6
9     8     4   0  471   0   0     5   130   179   0   340
10    0     0   0    0   0   0     0     1     0   0  1645
early stop counter: 1
val acc:0.9211180806159973, best validation acc: 0.9279122352600098, corresponding to test acc:                         0.6508080959320068 / 0.6841810941696167
after epoch: 8,now: 2024-07-29 23:18:14.133543,epoch time: 1:18:30.972415,used: 10:16:09.212974,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9290989, 'precision': 0.7459823, 'recall': 0.62531203, 'specificity': 0.9918581, 'f1': 0.6261085, 'auroc': 0.9564271}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   410     0   0     1   0   0     1    36     3   0     32
1     0  1301   0     5   0   0     0    22     3   0      1
2    10     1  49     0   0   0     1   223     8   0     20
3     0     4   0  8291   0   0     2    81    61   0      0
4     2     0   5     2   0   0     0   114    16   0    400
5     6     0   1    18   0  20    40    87   327   0     22
6     9     0   0     3   0   1  1865    10     2   0     17
7     0    25   0   158   0   0     2  7028    45   0      5
8     0     0   0   105   0   0     0    69  3095   0     27
9    54     0   1     2   0   1    14   367    22   0     32
10    3     0   0     6   0   0     4    95    16   0  12667
---- Validation: 
scalar performance:
{'acc': 0.9295707, 'precision': 0.745507, 'recall': 0.63002336, 'specificity': 0.991889, 'f1': 0.6325331, 'auroc': 0.9558677}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   412     0   0     0   0   0     0    31     4   0     36
1     0  1302   0     6   0   0     1    19     2   0      2
2     8     0  64     0   0   0     2   207     5   0     26
3     0     3   0  8304   0   0     0    78    53   0      2
4     1     0   5     1   0   0     0   100    20   0    412
5     7     0   1    17   0  21    40    95   319   0     21
6     6     1   0     6   0   0  1867     7     4   0     17
7     0    31   0   146   0   0     1  7037    45   0      5
8     0     0   2   110   0   0     0    78  3076   0     30
9    58     0   1     6   0   2    11   362    16   0     37
10    5     1   1     5   0   0     7    88    20   0  12669
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65612537, 'precision': 0.46530446, 'recall': 0.5111816, 'specificity': 0.96566, 'f1': 0.43994042, 'auroc': 0.82062817}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1102     1   0    8   0   0    12    33     8   0     6
1      0  1323   0   36   0   0     1   112     6   0    21
2      7     6   2   35   0   0     3   256   422   0   284
3      0     0   0    0   0   0     0     0     0   0     0
4      0     0   0    1   0   0     2     9    26   0  1595
5     11     0   0  200   0   1     8   100   188   0    84
6      2     0   0   26   0   4  3001     2    23   0     9
7      0     3   0  108   0   0     0  1046     4   0     3
8      0     0   0  104   0   0     1     6  1259   0     0
9     28     9   2  241   0   1    32   415   315   0    94
10     0     0   0    0   0   0     1     0     1   0  1644
better model found
persisted
after epoch: 9,now: 2024-07-30 00:39:28.564799,epoch time: 1:21:14.431256,used: 11:37:23.644230,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9250856, 'precision': 0.6881306, 'recall': 0.632077, 'specificity': 0.9915749, 'f1': 0.6319856, 'auroc': 0.9560605}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   413     1   0     2   0   0     7    29     1   0     30
1     0  1310   0     5   0   1     1    12     3   0      0
2     3     0  80     3   0   0     5   174    24   0     23
3     0     8   0  8237   0   6     1    36   147   0      5
4     1     0   9     8   0   0     2    73    31   0    415
5     0     0   0     5   0   5    22    11   471   0      7
6     7     1   0     2   0   0  1878     3     2   0     14
7     3    42   0   220   0   0     1  6829   163   0      5
8     2     1   0    65   0   0     6    22  3152   0     47
9     4     0   7     1   0   4    76   261   106   0     34
10    7     1   0     7   0   0    15    65    24   0  12672
---- Validation: 
scalar performance:
{'acc': 0.9247827, 'precision': 0.6863347, 'recall': 0.630535, 'specificity': 0.99152964, 'f1': 0.6309004, 'auroc': 0.9571265}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   409     0   0     1   0   0    12    23     1   0     37
1     0  1311   0     2   0   0     0    13     4   0      2
2     6     0  77     1   0   0    10   167    24   0     27
3     0     5   0  8241   0   7     2    36   145   0      4
4     2     0  10    12   0   1     1    64    39   0    410
5     0     0   0     6   0   6    11    17   475   0      6
6     8     1   0     2   0   0  1879     0     1   0     17
7     0    36   1   225   0   0     2  6819   175   0      7
8     1     1   1    67   0   0     3    26  3150   0     47
9     6     0   6     1   0   5    67   271   105   0     32
10    5     0   1     8   0   0    11    70    20   0  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6520674, 'precision': 0.47940373, 'recall': 0.5068462, 'specificity': 0.964955, 'f1': 0.43683955, 'auroc': 0.8351869}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   974     3   1   21   0   0    24    96    37   0    14
1     0  1337   0   33   0   0     3   106    12   0     8
2     8     2  14   28   0   0    11   233   330   0   389
3     0     0   0    0   0   0     0     0     0   0     0
4     0     0   0    0   0   0     1    10    19   0  1603
5     1     0   1   71   0  12     9    24   435   0    39
6     1     2   0    7   0   0  3005     2    25   0    25
7     2     1   0  107   0   0     0  1044     7   0     3
8     0     0   0   75   0   1     0     4  1288   0     2
9    20     0  24   91   0  10    68   376   440   0   108
10    0     0   0    0   0   0     0     0     0   0  1646
early stop counter: 1
val acc:0.9247826933860779, best validation acc: 0.9295706748962402, corresponding to test acc:                         0.6561253666877747 / 0.6841810941696167
after epoch: 10,now: 2024-07-30 02:05:47.778764,epoch time: 1:26:19.213965,used: 13:03:42.858195,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 13:03:42.858195 at 2024-07-30 02:05:47.778764
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65612537, 'precision': 0.46530446, 'recall': 0.5111816, 'specificity': 0.96566, 'f1': 0.43994042, 'auroc': 0.82062817}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1102     1   0    8   0   0    12    33     8   0     6
1      0  1323   0   36   0   0     1   112     6   0    21
2      7     6   2   35   0   0     3   256   422   0   284
3      0     0   0    0   0   0     0     0     0   0     0
4      0     0   0    1   0   0     2     9    26   0  1595
5     11     0   0  200   0   1     8   100   188   0    84
6      2     0   0   26   0   4  3001     2    23   0     9
7      0     3   0  108   0   0     0  1046     4   0     3
8      0     0   0  104   0   0     1     6  1259   0     0
9     28     9   2  241   0   1    32   415   315   0    94
10     0     0   0    0   0   0     1     0     1   0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6841811, 'precision': 0.5050784, 'recall': 0.56986785, 'specificity': 0.9681201, 'f1': 0.50729704, 'auroc': 0.83499974}
confusion matrix:
      0     1   2   3   4    5     6     7     8   9     10
0   1117     1   3   3   0    2    14    15     4   0    11
1      0  1287  14  34   0    0     2   152     1   0     9
2     43     5  83   9   0   23    16   288   149   0   399
3      0     0   0   0   0    0     0     0     0   0     0
4      1     0   2   0   0    1     4     7    11   0  1607
5     36     0   0  16   0  338    29    25   115   0    33
6      0     0   0  17   0   13  3009     1     8   0    19
7      1     2   4  40   0    1     4  1106     0   0     6
8      1     1   1  98   0   18     5    41  1197   0     8
9    195     1  58  39   0  168   103   301   188   0    84
10     0     0   0   0   0    0     2     1     1   0  1642
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_02_04_seed_1_23121383_instance_wise_predictions.txt
accuracy from prediction file 0.6561253760582103
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/32.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/32.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |   1648 MiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      7 MiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |   1648 MiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      7 MiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB |   1633 TiB |   1633 TiB |
|       from large pool |   1647 MiB |  19328 MiB |   1622 TiB |   1622 TiB |
|       from small pool |      6 MiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20092 MiB |  20112 MiB |  38322 MiB |  18230 MiB |
|       from large pool |  20058 MiB |  20078 MiB |  38276 MiB |  18218 MiB |
|       from small pool |     34 MiB |     34 MiB |     46 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231478 KiB | 783421 KiB | 235167 GiB | 235167 GiB |
|       from large pool | 216320 KiB | 781120 KiB | 223334 GiB | 223334 GiB |
|       from small pool |  15158 KiB |  20690 KiB |  11833 GiB |  11833 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |  107210 K  |  107207 K  |
|       from large pool |     247    |     691    |   54563 K  |   54563 K  |
|       from small pool |    2419    |    3627    |   52647 K  |   52644 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |  107210 K  |  107207 K  |
|       from large pool |     247    |     691    |   54563 K  |   54563 K  |
|       from small pool |    2419    |    3627    |   52647 K  |   52644 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     565    |     566    |    1027    |     462    |
|       from large pool |     548    |     549    |    1004    |     456    |
|       from small pool |      17    |      17    |      23    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     121    |    1251    |   61315 K  |   61315 K  |
|       from large pool |      95    |     367    |   37601 K  |   37601 K  |
|       from small pool |      26    |    1157    |   23714 K  |   23714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |  16640 KiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      0 KiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |  16640 KiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      0 KiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |   1633 TiB |   1633 TiB |
|       from large pool |  16640 KiB |  19328 MiB |   1622 TiB |   1622 TiB |
|       from small pool |      0 KiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20112 MiB |  38322 MiB |  36440 MiB |
|       from large pool |   1860 MiB |  20078 MiB |  38276 MiB |  36416 MiB |
|       from small pool |     22 MiB |     34 MiB |     46 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 783421 KiB | 235168 GiB | 235168 GiB |
|       from large pool |  24320 KiB | 781120 KiB | 223335 GiB | 223335 GiB |
|       from small pool |      0 KiB |  20690 KiB |  11833 GiB |  11833 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |  107210 K  |  107210 K  |
|       from large pool |       2    |     691    |   54563 K  |   54563 K  |
|       from small pool |       0    |    3627    |   52647 K  |   52647 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |  107210 K  |  107210 K  |
|       from large pool |       2    |     691    |   54563 K  |   54563 K  |
|       from small pool |       0    |    3627    |   52647 K  |   52647 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     566    |    1027    |     923    |
|       from large pool |      93    |     549    |    1004    |     911    |
|       from small pool |      11    |      17    |      23    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   61316 K  |   61316 K  |
|       from large pool |       3    |     367    |   37601 K  |   37601 K  |
|       from small pool |       0    |    1157    |   23715 K  |   23715 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 30 02:41:41 2024]
Finished job 0.
1 of 1 steps (100%) done
