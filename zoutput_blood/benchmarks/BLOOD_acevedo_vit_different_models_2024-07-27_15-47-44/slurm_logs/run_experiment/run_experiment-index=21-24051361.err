Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 09:34:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361

 Experiment start at: 2024-08-03 09:44:33.632513
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.044287413358688354
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91869116, 'precision': 0.8159393, 'recall': 0.7008153, 'specificity': 0.9908524, 'f1': 0.72161305, 'auroc': 0.98453367}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   195     0   0     5   0    2   136     6    10   11    118
1     1  1272   0    10   0    0     2    32    11    0      4
2     7    13  51     0  29   35    17     8    26   80     46
3     0     6   0  7864   1   15     5   259   273    8      6
4     2     3   9     1  97    6    24     3    41   10    342
5     0     0   0    37   0  357     3     0    16  105      3
6     3     1   0     6   1    0  1851     6    12    2     25
7     2    76   1   206   1    1     6  6732   155    5     78
8     1     2   1    85   4    6    16    63  2897    6    214
9     2     1  17     9   0  116    10     2    22  305      9
10    2     5   0     7   3    0    30    16    14    2  12716
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.91753376, 'precision': 0.822789, 'recall': 0.6976996, 'specificity': 0.99072427, 'f1': 0.7169225, 'auroc': 0.9846233}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   188     0   0     7   0    2   134     9    11   13    119
1     0  1267   0    12   0    1     2    33    11    1      5
2     5    11  50     0  30   43    16    15    19   82     41
3     1     5   0  7848   1   20    10   264   274    7     10
4     1     2   6     2  94    8    17     2    49   14    344
5     0     0   0    29   0  363     3     0    15  109      2
6     4     4   0     4   0    0  1849     4    10    1     32
7     2    81   0   224   0    1     7  6718   152    1     79
8     2     6   1    76   3   10    11    50  2910    6    221
9     2     4   7     8   2  131    11     0    23  297      8
10    5     4   0     8   1    0    25    19    14    2  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6494788, 'precision': 0.6264447, 'recall': 0.52493584, 'specificity': 0.96350557, 'f1': 0.4923586, 'auroc': 0.852378}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   373     1   0  24   0    0   668    24    33   37    10
1     0  1320   0  12   0    0     8   114    12    5    28
2    27    15   8   2  72    7   134    37   327  115   271
3     0     0   0   0   0    0     0     0     0    0     0
4     0     5   0   0  69    0    14     1    21    0  1523
5    16     0   0  61   0  150    55     0    38  271     1
6     0     1   0   3   1    0  2790     9    35    1   227
7     0     2   0  11   0    0    12  1130     1    1     7
8     0     0   0  18   0    2    58     2  1280    5     5
9    23    31   4  29   6   30   104    39   326  524    21
10    0     1   0   0   2    0     4     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 10:28:46.874679,epoch time: 0:44:13.242166,used: 0:44:13.242166,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94033605, 'precision': 0.84577894, 'recall': 0.7786908, 'specificity': 0.99349713, 'f1': 0.7930435, 'auroc': 0.9940726}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   389     0   0    10    0    2     5     8     5   20     44
1     0  1240   0    15    0    0     0    63    11    0      3
2     1     0  67     2   22    7     1    22    26  160      4
3     0     1   0  8153    0   21     0   142   121    1      0
4     2     0  42     4  177    3     0    14    75   34    188
5     0     0   0    33    0  405     0     0     8   74      1
6    20     0   0    12    1    3  1822     7    13    9     20
7     1     4   0   322    1    0     1  6847    78    2      6
8     1     1   1   105    1    3     0    79  3083    2     20
9     0     0   3    12    0  106     0     3    12  356      0
10   20     0   4    11   10    1     7    35    93    5  12607
---- Validation: 
scalar performance:
{'acc': 0.9416076, 'precision': 0.8562059, 'recall': 0.78484344, 'specificity': 0.99363583, 'f1': 0.8013815, 'auroc': 0.9940666}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   383     0   0    15    0    0     3     6    10   24     42
1     0  1237   0    16    0    0     0    62    14    0      3
2     0     0  76     6   18    3     1    19    26  158      5
3     1     0   0  8149    0   15     1   136   135    3      0
4     3     0  36     4  190    4     0    15    75   37    175
5     0     0   0    38    0  405     0     0     8   69      1
6    20     0   0    15    1    3  1824     2     9    8     26
7     1     3   0   304    1    1     1  6865    84    0      5
8     2     0   1   100    1    5     0    77  3090    2     18
9     1     0   5    18    0   88     0     1    10  369      1
10   19     0   4     9   10    4     6    32    95    3  12614
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6909676, 'precision': 0.67058927, 'recall': 0.59489745, 'specificity': 0.96901536, 'f1': 0.5624321, 'auroc': 0.8763297}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1046     0   0   28    0    0     8    21    33   30     4
1      0  1084   0   28    0    2     1   316    43    2    23
2     13     0  25   10   59   24     6    51   519  190   118
3      0     0   0    0    0    0     0     0     0    0     0
4      2     0   1    0  156    0     1     3    51    1  1418
5      7     0   0   59    0  365     5     0    22  133     1
6      3     0   0   10    6    0  2670     7   256    1   114
7      1     0   0  110    0    0     4  1039     4    3     3
8      0     0   0   32    0    5     3     3  1324    3     0
9     20     8   6   51    4  139     0    38   329  529    13
10     0     0   0    0    7    0     0     0     1    0  1638
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 11:11:19.489279,epoch time: 0:42:32.614600,used: 1:26:45.856766,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94921875, 'precision': 0.873948, 'recall': 0.8142736, 'specificity': 0.99455553, 'f1': 0.8369509, 'auroc': 0.99556214}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   337     0    0     3    1    0    67     3    18    5     49
1     0  1274    0    10    0    0     0    30    16    0      2
2     0     0  147     1   49    1     4     5    36   68      1
3     0     1    1  8090    1   13     3   137   191    2      0
4     0     0   21     1  293    1     4     2    64    5    147
5     1     0    0    32    0  351     1     0    17  118      1
6     4     0    0     5    1    0  1871     2    10    1     13
7     0    11    3   184    2    0     5  6941   102    2     13
8     0     0    3    58    4    0     1    36  3172    0     22
9     1     0   33     8    0   42     4     0    24  379      2
10    8     0    2     8   43    0    25    12    69    2  12623
---- Validation: 
scalar performance:
{'acc': 0.94965893, 'precision': 0.87984145, 'recall': 0.81750035, 'specificity': 0.9945975, 'f1': 0.8405999, 'auroc': 0.99558157}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     0    0     4    0    0    57     3    18    4     51
1     0  1276    0     7    1    0     0    29    16    0      3
2     1     1  151     1   36    1     6     5    35   74      1
3     0     0    0  8075    0   12     4   139   207    3      0
4     0     0   17     2  284    1     4     3    67    7    154
5     0     0    0    27    0  356     3     0    15  119      1
6     2     1    0     1    1    0  1880     1    10    1     11
7     0    12    1   181    3    0     4  6951   101    1     11
8     1     0    2    51    3    0     0    40  3176    1     22
9     0     0   31     7    0   45     6     1    20  382      1
10    4     2    0     7   48    1    13    15    77    3  12626
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68621004, 'precision': 0.6482713, 'recall': 0.5585054, 'specificity': 0.96777976, 'f1': 0.54681516, 'auroc': 0.87285566}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   645     0   0   6    1    0   449    10    45    7     7
1     0  1246   0  30    1    0     7   153    43    0    19
2     4     2  58   3  192   10    37    30   569   57    53
3     0     0   0   0    0    0     0     0     0    0     0
4     1     0   0   0  304    0     4     0    59    0  1265
5     8     0   1  56    0  224    44     0    57  201     1
6     0     0   0   5    2    0  2975     4    62    0    19
7     0     1   0  96    0    0    23  1034     6    1     3
8     0     0   0  24    0    0    22     1  1323    0     0
9    10     7  45  30   13   52    59    36   502  371    12
10    0     0   0   0   15    0     2     0     1    0  1628
better model found
persisted
after epoch: 3,now: 2024-08-03 11:54:02.590607,epoch time: 0:42:43.101328,used: 2:09:28.958094,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95930547, 'precision': 0.88780695, 'recall': 0.86515176, 'specificity': 0.9955909, 'f1': 0.87466216, 'auroc': 0.9969301}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     3    1    0     4     4     4    6     32
1     0  1284    0    11    0    0     0    31     6    0      0
2     2     0  213     0   30    4     2     3     7   51      0
3     1     1    1  8229    0   11     1    90   100    2      0
4     3     0   38     1  314    2     3     3    33    8    134
5     3     0    0    22    0  395     0     0     8   92      1
6    10     0    0     4    1    0  1875     2     3    1     12
7     0    19    2   196    3    0     1  6978    55    3      7
8     2     2    4    88    7    3     0    67  3100    2     21
9     4     0   33     4    0   48     0     2    10  391      1
10   17     6    3     8   50    1     8    14    36    2  12647
---- Validation: 
scalar performance:
{'acc': 0.9599037, 'precision': 0.88555783, 'recall': 0.86139303, 'specificity': 0.9956701, 'f1': 0.87181133, 'auroc': 0.99694324}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     5    2    0     6     3     4    3     31
1     0  1288    0    10    0    0     0    29     5    0      0
2     4     1  195     2   35    2     1     6    10   55      1
3     2     1    1  8231    0   10     0    93   100    2      0
4     5     2   42     1  320    1     2     4    28    6    128
5     2     0    0    20    0  395     0     0     8   95      1
6    10     0    0     9    2    0  1861     3     5    2     16
7     2    16    0   160    2    1     3  7031    44    0      6
8     1     0    5    84    8    0     0    71  3105    2     20
9     3     0   29     4    0   51     2     2    10  392      0
10   12     5    3     7   57    0    13    17    41    2  12639
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7334359, 'precision': 0.6790785, 'recall': 0.6156727, 'specificity': 0.97333324, 'f1': 0.61172044, 'auroc': 0.87828785}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1008     0    0   37    0    0    59    37    18    8     3
1      1  1259    0   23    1    0     0   198    12    1     4
2     19     1  174   16  173   12    15    63   362   88    92
3      0     0    0    0    0    0     0     0     0    0     0
4      1     4    1    0  402    0     1     3    33    1  1187
5      8     0    0  114    2  276     1     0    19  171     1
6      0     0    0   17    3    0  2955     6    51    0    35
7      0     0    0  116    0    0     2  1042     0    1     3
8      0     0    0   75    0    0     7    11  1276    1     0
9     19    11   98   85   10   87     7   110   238  466     6
10     0     1    0    0   18    0     1     0     1    0  1625
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 12:36:16.843180,epoch time: 0:42:14.252573,used: 2:51:43.210667,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9558273, 'precision': 0.8721826, 'recall': 0.86346084, 'specificity': 0.99533665, 'f1': 0.86623734, 'auroc': 0.996782}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     1    0     4    1    0    17     3    12    8     22
1     0  1301    0    11    0    0     0    13     6    0      1
2     0     1  189     1    9    3     0     5     7   97      0
3     0     9    1  8236    0   12     1   117    61    3      0
4     3     0   53     0  329    4     3     5    48   17     77
5     0     0    0    18    1  438     0     0     5   59      0
6     3     0    0     3    0    0  1882     3     4    3      9
7     0    51    0   151    1    0     1  7013    39    4      3
8     0     1    1   166    3    3     2    56  3051    4      9
9     0     0   12     7    0   86     0     0     6  382      0
10   23     1   15     9   97    1    19    30   100    6  12489
---- Validation: 
scalar performance:
{'acc': 0.9545807, 'precision': 0.86425465, 'recall': 0.86089605, 'specificity': 0.9952323, 'f1': 0.8610394, 'auroc': 0.9966972}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     3    1    2    18     4    13    4     16
1     0  1300    0     7    0    0     0    19     6    0      0
2     0     1  185     1   13    2     0     1     8  101      0
3     0     6    0  8231    0   17     1   129    55    1      0
4     4     0   65     1  316    3     4     5    44   18     79
5     0     0    0    21    0  430     0     0     6   63      1
6     4     1    0     6    0    1  1883     1     4    2      6
7     0    62    1   167    1    0     4  6980    41    5      4
8     0     1    1   142    5    3     1    50  3082    6      5
9     0     0    9     6    0   85     0     0     7  386      0
10   23     0   18    11  102    2    23    29   109    7  12472
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76478, 'precision': 0.7109599, 'recall': 0.65108573, 'specificity': 0.97638655, 'f1': 0.665142, 'auroc': 0.8889833}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   775     0    1   38    2    7   237    7    11   88     4
1     0  1246    0   28    3    0     6  183    16    3    14
2     1     0  308   12  179   13    31   14   301  145    11
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0   15    0  822    0     3    1    26    1   765
5     0     0    0   50    1  400     4    0     0  137     0
6     0     0    0    1    4    0  3055    0     6    0     1
7     0     0    0  200    0    0     6  951     3    1     3
8     0     0    0  150    0    3    16    5  1194    2     0
9     2     3  115   62    4  171     9   13   104  650     4
10    0     0    1    0  113    0     2    0     0    0  1530
new oracle model saved
early stop counter: 1
val acc:0.9545807242393494, best validation acc: 0.9599037170410156, corresponding to test acc:                         0.7334359288215637 / 0.7647799849510193
after epoch: 5,now: 2024-08-03 13:18:46.105925,epoch time: 0:42:29.262745,used: 3:34:12.473412,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9600546, 'precision': 0.8901359, 'recall': 0.8614496, 'specificity': 0.9957058, 'f1': 0.86965936, 'auroc': 0.9974672}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     3    1    0    16     3     8    4     22
1     0  1293    0     8    0    0     0    22     9    0      0
2     0     1  178     1   18    0     1     4     4  104      1
3     0     1    0  8209    0   44     0    45   132    4      0
4     3     0   43     1  280    2     5     3    26    9    167
5     0     0    0     5    0  481     0     0     6   27      1
6     3     0    0     2    1    1  1885     3     6    1      5
7     0    13    5   236    2    0     4  6933    65    4      3
8     1     2    3    61    4   14     1    33  3163    7      7
9     2     0    7     1    1  110     2     1     3  366      0
10   10     1    4     7   18    1    23    19    41    1  12669
---- Validation: 
scalar performance:
{'acc': 0.9608934, 'precision': 0.89148504, 'recall': 0.8644164, 'specificity': 0.99579906, 'f1': 0.871556, 'auroc': 0.9973468}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     2    0    0    17     2     9    3     25
1     0  1294    0     7    0    1     0    24     6    0      0
2     0     1  177     0   19    3     1     2     5  100      4
3     0     1    0  8211    0   53     1    38   134    2      0
4     3     1   41     0  287    1     4     2    26   10    164
5     0     0    0     3    0  492     0     0     3   22      1
6     3     1    0     2    0    2  1880     2     8    3      7
7     0    12    3   210    2    0     3  6958    63    7      7
8     1     1    5    51    5   14     1    42  3159    8      9
9     1     0    6     2    0  113     0     0     2  369      0
10   12     3    4     8   18    1    12    17    49    1  12671
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7282586, 'precision': 0.67923117, 'recall': 0.6276757, 'specificity': 0.97273135, 'f1': 0.6101059, 'auroc': 0.8676458}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   934     0    1   22    2   15   135    7    32   19     3
1     1  1348    0   18    0    3     5  101    14    3     6
2     1     2  219    6  144   40    16   21   384   78   104
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    9    0  228    0     1    1    32    1  1361
5     3     0    0   33    2  513     7    0     5   28     1
6     0     0    0    0    3    0  3002    2    23    1    36
7     0     0    0  306    0    1    16  834     4    0     3
8     0     0    0   42    0    9    12    2  1304    1     0
9     9     6  102   40    6  346    18   28   181  391    10
10    0     0    0    0    8    0     1    0     1    0  1636
better model found
persisted
after epoch: 6,now: 2024-08-03 14:01:25.959316,epoch time: 0:42:39.853391,used: 4:16:52.326803,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.964817, 'precision': 0.91029227, 'recall': 0.867147, 'specificity': 0.9960716, 'f1': 0.8861292, 'auroc': 0.99815303}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     1    0     5    0    0     2     1     5    5     54
1     0  1302    0     6    0    0     0    21     3    0      0
2     1     0  202     2   29    2     0     7     6   59      4
3     0     2    0  8318    0    5     0    88    26    0      0
4     1     0   22     2  336    1     0     3    24    8    142
5     0     0    0    30    0  444     0     0     2   44      1
6     5     0    0     4    2    2  1864     4     8    2     17
7     0    15    1   129    2    0     1  7088    15    0     11
8     2     2    4   155    6    2     0    71  3029    4     19
9     0     1   25    10    0   89     0     2     1  364      1
10    3     1    3     7   24    2     3    14    32    0  12705
---- Validation: 
scalar performance:
{'acc': 0.9652267, 'precision': 0.91395366, 'recall': 0.8752975, 'specificity': 0.9961108, 'f1': 0.89275104, 'auroc': 0.99815977}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     1    0     2    1    0     1     0     5    5     50
1     0  1298    0     5    0    0     0    25     4    0      0
2     2     0  217     2   25    1     0     6     2   53      4
3     1     3    0  8313    0    0     0    91    30    2      0
4     1     0   25     1  349    1     0     2    15    6    139
5     0     0    0    33    0  444     0     0     4   39      1
6     5     0    1     7    5    1  1859     3     5    4     18
7     0    13    1   143    1    0     2  7083     9    1     12
8     1     3    1   159    7    2     0    74  3031    4     14
9     0     0   21    12    0   90     0     0     2  368      0
10    4     0    4     6   27    1     2    13    33    1  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7009725, 'precision': 0.6867207, 'recall': 0.59332705, 'specificity': 0.9705855, 'f1': 0.59752357, 'auroc': 0.86871654}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   982     1    1   47    2    9    16   18    43   33    18
1     0  1253    0   33    1    0     0  190     9    0    13
2     2     1  185   49  104   24    11   55   413   94    77
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    6    0  322    0     2    3    53    1  1246
5     2     0    0  176    0  371     0    0     1   41     1
6     0     0    0   34    4    0  2899    3    57    1    69
7     0     0    0  228    0    0     1  931     1    0     3
8     0     0    0  281    0    0     1    5  1082    1     0
9     3     3   68  269    2  210     0   82   122  364    14
10    0     0    0    0   13    0     1    0     2    0  1630
better model found
persisted
after epoch: 7,now: 2024-08-03 14:43:26.100445,epoch time: 0:42:00.141129,used: 4:58:52.467932,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9668504, 'precision': 0.90566987, 'recall': 0.89562637, 'specificity': 0.996461, 'f1': 0.89972925, 'auroc': 0.9983878}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     3    0    0     7     0     2    4     13
1     0  1278    0    12    0    0     0    35     5    0      2
2     1     0  220     0   29    4     1     6     4   47      0
3     0     0    1  8316    1    5     1    34    77    1      0
4     4     0   18     2  420    0     3     4    22    2     64
5     1     0    0    25    0  465     0     0     6   23      1
6     6     0    1     4    1    0  1884     2     4    0      5
7     0     8    1   246    1    0     3  6956    41    1      6
8     1     1    4    60    6    3     0    33  3175    2     10
9     0     0   32     4    0  105     1     4     5  342      0
10   14     0    3    10   85    0    14     6    36    0  12627
---- Validation: 
scalar performance:
{'acc': 0.9662967, 'precision': 0.9061501, 'recall': 0.8949872, 'specificity': 0.99639225, 'f1': 0.8995781, 'auroc': 0.9984174}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     3    0    0     6     0     4    3     13
1     0  1272    0    12    0    0     0    39     7    0      2
2     2     0  226     0   28    2     0     5     7   41      1
3     0     1    1  8322    0    6     0    42    68    0      0
4     5     1   20     2  412    2     1     4    19    2     71
5     0     0    0    26    0  465     0     0     6   23      1
6     4     0    0     4    3    0  1885     0     4    1      7
7     0     7    3   232    1    0     1  6959    54    1      7
8     1     0    4    55    4    3     2    37  3175    1     14
9     1     0   33     5    0  103     1     3     8  339      0
10   17     0    2     9   80    1    19     8    44    0  12616
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72559994, 'precision': 0.6952424, 'recall': 0.60486054, 'specificity': 0.97278357, 'f1': 0.6153124, 'auroc': 0.8725853}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1015     0    1   41    0    0    69    8    21   11     4
1      3  1232    0   40    1    0    15  173    13    0    22
2     23     0  197   49  187   18    52   30   324   62    73
3      0     0    0    0    0    0     0    0     0    0     0
4      4     0    5    0  482    0    20    1    22    0  1099
5      7     0    0  225    1  310     3    0     1   45     0
6      0     0    0    6    0    0  3057    1     1    0     2
7      0     0    0  200    0    0    16  943     3    0     2
8      0     0    0  164    0    0     8    2  1196    0     0
9     20     1   85  277   12  154    16   59   159  343    11
10     0     0    0    0   44    0     5    0     1    0  1596
better model found
persisted
after epoch: 8,now: 2024-08-03 15:26:35.950836,epoch time: 0:43:09.850391,used: 5:42:02.318323,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9690978, 'precision': 0.9006543, 'recall': 0.91414, 'specificity': 0.9967876, 'f1': 0.90500915, 'auroc': 0.9985521}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    1     2    1    0     1     1     4    7     13
1     0  1310    0     6    0    0     1    10     4    0      0
2     1     0  246     0   23    0     0     1     1   40      0
3     0     3    1  8288    0   18     1    89    32    7      0
4     1     1   23     1  444    0     1     7    13    4     44
5     0     0    0     7    1  389     0     0     1  123      0
6     8     0    1     2    3    0  1882     0     4    3      5
7     0    25    0   114    1    0     3  7094    22    1      4
8     1     2    7    82    9    4     0    45  3133    3     10
9     0     0   31     2    0   16     0     0     1  443      0
10   15     1    3     9  162    1     7    13    39    1  12539
---- Validation: 
scalar performance:
{'acc': 0.9680353, 'precision': 0.8949917, 'recall': 0.9071973, 'specificity': 0.9966815, 'f1': 0.89867485, 'auroc': 0.9986288}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    2    0     2     1     3    4     17
1     0  1310    0     6    0    0     0    11     5    0      0
2     1     0  232     0   27    0     0     3     3   46      0
3     0     4    0  8279    0   22     3    95    31    6      0
4     3     1   28     1  441    0     0     2    15    6     42
5     1     0    0     8    1  386     0     1     2  122      0
6     4     0    0     2    2    1  1884     0     2    3     10
7     1    22    0   127    1    0     2  7093    15    1      3
8     3     0    4    74    7    5     1    54  3138    5      5
9     0     0   35     5    0   18     0     2     1  432      0
10   12     3    2     7  182    0     7     8    32    2  12541
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7488981, 'precision': 0.70136774, 'recall': 0.6317783, 'specificity': 0.9748825, 'f1': 0.638585, 'auroc': 0.8714536}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1005     0    1   12    1    2    81   24    10   31     3
1      0  1293    0   29    2    0     3  146    13    3    10
2      3     2  227    8  177   14    21   24   343  128    68
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    3    0  439    0     4    1    30    1  1154
5      2     0    0   63    1  293     4    0     2  226     1
6      0     0    0    3    4    0  3017    2    10    1    30
7      0     0    0  227    0    0     3  928     2    1     3
8      0     0    0  134    1    3    16    3  1211    2     0
9      7     6   99   78    6   79     8   44   122  676    12
10     0     0    0    0   29    0     1    0     1    0  1615
better model found
persisted
after epoch: 9,now: 2024-08-03 16:08:48.925892,epoch time: 0:42:12.975056,used: 6:24:15.293379,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9664491, 'precision': 0.90388405, 'recall': 0.8919374, 'specificity': 0.9962709, 'f1': 0.89478016, 'auroc': 0.99848354}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     2    0    1     0     4     0    3     10
1     0  1281    1    11    0    0     0    36     1    0      2
2     1     0  251     3   13    3     0     1     1   38      1
3     0     0    2  8360    1   17     0    47    11    2      0
4     8     0   33     3  333    1     0     2     8    6    145
5     0     0    1    12    0  451     0     0     1   55      1
6    61     0    2     3    1    0  1805     4     1    4     24
7     1     3    1   147    1    0     1  7099     5    1      5
8     2     0   11   174   14    8     0    57  2965   15     48
9     0     0   35     5    0   62     0     0     0  391      0
10   20     0    5    10   12    2     1    11     9    0  12723
---- Validation: 
scalar performance:
{'acc': 0.96597564, 'precision': 0.9091988, 'recall': 0.8961647, 'specificity': 0.99618495, 'f1': 0.898973, 'auroc': 0.998522}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    0    0     0     1     1    6     11
1     0  1278    0    10    0    0     0    37     2    0      5
2     0     0  260     1    8    0     0     5     0   38      0
3     0     0    1  8354    0   16     1    52    16    0      0
4     6     0   33     2  329    0     0     3     5    9    152
5     0     0    0     9    0  469     0     0     1   41      1
6    65     0    2     3    1    1  1791     3     1    7     34
7     0     2    2   154    1    0     1  7087    14    1      3
8     5     0   12   172   12    9     0    64  2951   11     60
9     0     0   37     4    0   56     0     1     0  395      0
10   21     0    1     8   12    1     2    11     3    1  12736
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7182537, 'precision': 0.69115186, 'recall': 0.6317895, 'specificity': 0.9719806, 'f1': 0.6321613, 'auroc': 0.86182666}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1117     0    0   12    1    4     2   16     2   14     2
1      1  1107    4   41    1    0     1  292     7    8    37
2     17     0  368   30  171   24    22   35    79  134   135
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    8    0  192    0     2    1     5    1  1423
5      5     0    0   79    0  415     1    0     1   89     2
6     18     0    1   24    2    0  2728    3     4    2   285
7      0     0    0  160    0    1     1  998     0    1     3
8      0     0    1  235    3   14    11    1  1094    5     6
9     19     1  127  127    4  181     1   30    25  606    16
10     0     0    0    0    5    0     0    0     0    0  1641
early stop counter: 1
val acc:0.9659756422042847, best validation acc: 0.9680352807044983, corresponding to test acc:                         0.7488980889320374 / 0.7647799849510193
after epoch: 10,now: 2024-08-03 16:51:14.091666,epoch time: 0:42:25.165774,used: 7:06:40.459153,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:06:40.459153 at 2024-08-03 16:51:14.091666
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7488981, 'precision': 0.70136774, 'recall': 0.6317783, 'specificity': 0.9748825, 'f1': 0.638585, 'auroc': 0.8714536}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1005     0    1   12    1    2    81   24    10   31     3
1      0  1293    0   29    2    0     3  146    13    3    10
2      3     2  227    8  177   14    21   24   343  128    68
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    3    0  439    0     4    1    30    1  1154
5      2     0    0   63    1  293     4    0     2  226     1
6      0     0    0    3    4    0  3017    2    10    1    30
7      0     0    0  227    0    0     3  928     2    1     3
8      0     0    0  134    1    3    16    3  1211    2     0
9      7     6   99   78    6   79     8   44   122  676    12
10     0     0    0    0   29    0     1    0     1    0  1615
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76478, 'precision': 0.7109599, 'recall': 0.65108573, 'specificity': 0.97638655, 'f1': 0.665142, 'auroc': 0.8889833}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   775     0    1   38    2    7   237    7    11   88     4
1     0  1246    0   28    3    0     6  183    16    3    14
2     1     0  308   12  179   13    31   14   301  145    11
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0   15    0  822    0     3    1    26    1   765
5     0     0    0   50    1  400     4    0     0  137     0
6     0     0    0    1    4    0  3055    0     6    0     1
7     0     0    0  200    0    0     6  951     3    1     3
8     0     0    0  150    0    3    16    5  1194    2     0
9     2     3  115   62    4  171     9   13   104  650     4
10    0     0    1    0  113    0     2    0     0    0  1530
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051361_instance_wise_predictions.txt
accuracy from prediction file 0.7488980619883859
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/6.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2611 MiB |  16814 MiB | 414311 GiB | 414309 GiB |
|       from large pool |   2597 MiB |  16782 MiB | 411239 GiB | 411236 GiB |
|       from small pool |     14 MiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2611 MiB |  16814 MiB | 414311 GiB | 414309 GiB |
|       from large pool |   2597 MiB |  16782 MiB | 411239 GiB | 411236 GiB |
|       from small pool |     14 MiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2607 MiB |  16770 MiB | 412753 GiB | 412751 GiB |
|       from large pool |   2594 MiB |  16737 MiB | 409684 GiB | 409682 GiB |
|       from small pool |     13 MiB |     33 MiB |   3069 GiB |   3069 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17542 MiB |  17542 MiB |  17542 MiB |      0 B   |
|       from large pool |  17506 MiB |  17506 MiB |  17506 MiB |      0 B   |
|       from small pool |     36 MiB |     36 MiB |     36 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 305829 KiB | 700029 KiB |  64354 GiB |  64353 GiB |
|       from large pool | 285440 KiB | 697280 KiB |  61275 GiB |  61275 GiB |
|       from small pool |  20389 KiB |  23171 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3082    |    4805    |   31278 K  |   31275 K  |
|       from large pool |     349    |     697    |   13399 K  |   13398 K  |
|       from small pool |    2733    |    4255    |   17879 K  |   17876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3082    |    4805    |   31278 K  |   31275 K  |
|       from large pool |     349    |     697    |   13399 K  |   13398 K  |
|       from small pool |    2733    |    4255    |   17879 K  |   17876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     510    |     510    |     510    |       0    |
|       from large pool |     492    |     492    |     492    |       0    |
|       from small pool |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     173    |    1218    |   16913 K  |   16913 K  |
|       from large pool |     130    |     339    |    8787 K  |    8787 K  |
|       from small pool |      43    |    1087    |    8126 K  |    8126 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16814 MiB | 414311 GiB | 414311 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411239 GiB | 411239 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16814 MiB | 414311 GiB | 414311 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411239 GiB | 411239 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB | 412753 GiB | 412753 GiB |
|       from large pool |  16640 KiB |  16737 MiB | 409684 GiB | 409684 GiB |
|       from small pool |      0 KiB |     33 MiB |   3069 GiB |   3069 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2910 MiB |  17542 MiB |  17542 MiB |  14632 MiB |
|       from large pool |   2876 MiB |  17506 MiB |  17506 MiB |  14630 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 700029 KiB |  64355 GiB |  64355 GiB |
|       from large pool |  24320 KiB | 697280 KiB |  61276 GiB |  61276 GiB |
|       from small pool |      0 KiB |  27677 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31278 K  |   31278 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17879 K  |   17879 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31278 K  |   31278 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17879 K  |   17879 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     510    |     510    |     360    |
|       from large pool |     133    |     492    |     492    |     359    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1218    |   16914 K  |   16914 K  |
|       from large pool |       3    |     339    |    8787 K  |    8787 K  |
|       from small pool |       0    |    1087    |    8127 K  |    8127 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16814 MiB | 414311 GiB | 414311 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411239 GiB | 411239 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16814 MiB | 414311 GiB | 414311 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411239 GiB | 411239 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB | 412753 GiB | 412753 GiB |
|       from large pool |  16640 KiB |  16737 MiB | 409684 GiB | 409684 GiB |
|       from small pool |      0 KiB |     33 MiB |   3069 GiB |   3069 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2910 MiB |  17542 MiB |  17542 MiB |  14632 MiB |
|       from large pool |   2876 MiB |  17506 MiB |  17506 MiB |  14630 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 700029 KiB |  64355 GiB |  64355 GiB |
|       from large pool |  24320 KiB | 697280 KiB |  61276 GiB |  61276 GiB |
|       from small pool |      0 KiB |  27677 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31278 K  |   31278 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17879 K  |   17879 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31278 K  |   31278 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17879 K  |   17879 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     510    |     510    |     360    |
|       from large pool |     133    |     492    |     492    |     359    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1218    |   16914 K  |   16914 K  |
|       from large pool |       3    |     339    |    8787 K  |    8787 K  |
|       from small pool |       0    |    1087    |    8127 K  |    8127 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361

 Experiment start at: 2024-08-03 17:09:08.456620
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9178617, 'precision': 0.826463, 'recall': 0.7035072, 'specificity': 0.99089015, 'f1': 0.7335185, 'auroc': 0.9849725}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   284     0    0    17   0    0    16    29    21    0    115
1     0  1151    0    19   0    0     0   144    10    0      6
2     5     0  163     3  13    0     5    31    63   19     10
3     0     0    1  7890   0    5     0   358   184    0      1
4     1     1   41     2  66    1     3    13   184    7    220
5     3     0   23    92   0  292     1     0    19   90      1
6    20     2    1    21   0    0  1700    17    27    2    118
7     0     4    1   159   0    0     1  6999    89    0      9
8     0     0    2   137   0    0     0    95  3039    0     23
9     8     0  138    25   0   81     0    15    27  191      8
10    6     0    0     8   1    0     7    58   182    1  12531
---- Validation: 
scalar performance:
{'acc': 0.9169453, 'precision': 0.82932824, 'recall': 0.70251775, 'specificity': 0.99080515, 'f1': 0.73074603, 'auroc': 0.98515296}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   287     0    1    20   0    0    12    28    29    2    104
1     0  1167    0    19   0    0     0   129    10    0      7
2     3     0  166     3   7    1     5    29    59   25     14
3     0     0    0  7878   0    5     0   380   177    0      0
4     0     0   47     2  57    1     4    12   180   11    225
5     2     0   23    81   0  284     0     0    24  106      1
6    14     0    0    19   0    0  1699    24    32    1    119
7     0     2    0   171   0    0     1  6974   107    0     10
8     0     0    1   132   0    0     0    95  3045    0     23
9    11     0  122    20   0   89     2    14    39  191      5
10    5     0    1     8   0    1     7    54   187    1  12532
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5153572, 'precision': 0.5454831, 'recall': 0.4694065, 'specificity': 0.9512799, 'f1': 0.41754496, 'auroc': 0.7942453}
confusion matrix:
     0    1   2    3   4    5     6     7     8    9     10
0   883    0   0   50   0    0     9   159    34    0    35
1     2  911   0   33   0    0     1   490    12    0    50
2    62    0  25   20  11    7     0    78   606   11   195
3     0    0   0    0   0    0     0     0     0    0     0
4     1    0   0    0  10    0     0     6    63    0  1553
5    75    0   1  165   0  237     1     3    58   49     3
6     1    3   0   11  13    0  1139    25   460    0  1415
7     0    0   0   18   0    0     0  1141     1    0     4
8     1    0   0   80   0    0     0    15  1271    0     3
9   148    4  83  143   0   56     2   146   420  103    32
10    0    0   0    0   0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 17:53:59.766825,epoch time: 0:44:51.310205,used: 0:44:51.310205,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9394531, 'precision': 0.8660308, 'recall': 0.793298, 'specificity': 0.9932381, 'f1': 0.81952596, 'auroc': 0.99317396}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   370     0    0    12    0    0    19     4    10    7     61
1     0  1264    0    24    0    0     1    30     8    0      5
2     1     1  105     4   88    1     1     4    17   86      4
3     1     0    0  8277    0    9     0    66    84    0      0
4     1     0    1     1  270    1     5     5    48   16    191
5     0     0    1    57    0  412     0     0     4   46      1
6     5     0    0     4    1    0  1864     2    10    2     20
7     1    19    0   524    2    0     2  6576   120    0     18
8     0     0    3   205    3    0     0    42  2996    1     46
9     2     0   27    17    7  117     1     5     8  305      3
10    7     0    0     8   26    1    14    18    43    3  12674
---- Validation: 
scalar performance:
{'acc': 0.9377825, 'precision': 0.86328036, 'recall': 0.7886314, 'specificity': 0.99304754, 'f1': 0.814621, 'auroc': 0.9931485}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   371     0   1     8    1    0    16     6     7    5     68
1     0  1264   0    18    0    0     0    34    11    0      5
2     0     1  96     4   90    2     2     7    14   91      5
3     2     1   0  8260    0    6     0    78    93    0      0
4     1     1   3     1  273    1     2     5    46   13    193
5     0     0   2    56    1  404     0     0     4   53      1
6     8     0   0     7    0    0  1856     1    12    3     21
7     0    15   0   558    1    1     2  6571   101    0     16
8     1     0   1   208    7    0     1    54  2983    0     41
9     2     0  21    15   12  124     3     1     9  304      2
10    4     1   0     9   27    1     9    20    47    1  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64206254, 'precision': 0.59960866, 'recall': 0.56282234, 'specificity': 0.96428895, 'f1': 0.5308451, 'auroc': 0.8370561}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1066     0   2   31    0    3    25    7    15    6    15
1      0  1202   0   50    1    0     2  178    22    0    44
2     16     0  22   23  268   41     3   10   356   87   189
3      0     0   0    0    0    0     0    0     0    0     0
4      1     0   0    0  108    0     0    0    17    0  1507
5      5     0   0  100    1  458     0    0     7   21     0
6      0     1   0    6   10    0  2334    3   217    0   496
7      1     0   0  268    0    0     2  884     4    0     5
8      0     0   0  118    0    3     0    1  1246    0     2
9     28     2  29  166   62  326     0   17   275  215    17
10     0     0   0    0    3    0     0    1     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 18:37:49.167256,epoch time: 0:43:49.400431,used: 1:28:40.710636,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94913846, 'precision': 0.876196, 'recall': 0.84234077, 'specificity': 0.99436563, 'f1': 0.857148, 'auroc': 0.9956869}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    1     9    1    1     5     5     1    7     27
1     0  1240    0    14    0    0     0    73     3    0      2
2     2     0  193     0   27    3     1     5     4   75      2
3     0     0    0  8301    0   11     0    90    34    1      0
4     6     0   37     1  311    1     1     4    28   17    133
5     0     0    2    38    0  408     0     0     4   68      1
6    10     0    1    13    1    1  1862     3     4    4      9
7     0     5    0   324    1    0     2  6904    21    0      7
8     2     0    4   300    9    2     0   103  2842    1     31
9     1     0   40    10    1   81     2     5     1  351      0
10   25     0    2     9   46    2    16    25    27    5  12637
---- Validation: 
scalar performance:
{'acc': 0.9491775, 'precision': 0.875397, 'recall': 0.8393549, 'specificity': 0.9943669, 'f1': 0.8548317, 'auroc': 0.9957384}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    1     7    0    1     9     6     5    8     22
1     0  1236    0    18    0    0     0    72     2    0      4
2     2     0  192     1   25    4     1     7     5   71      4
3     0     0    0  8316    0    7     1    73    41    2      0
4     5     0   43     1  295    1     0     6    30   16    142
5     0     0    1    40    0  407     0     0     3   69      1
6    14     0    1     8    1    0  1863     4     3    5      9
7     0     6    0   332    1    0     2  6891    23    3      7
8     1     0    4   305   12    1     1    83  2855    1     33
9     1     0   37     9    0   90     0     1     1  354      0
10   21     0    0     8   45    1    18    26    22    3  12652
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6991534, 'precision': 0.6643893, 'recall': 0.59608316, 'specificity': 0.9702951, 'f1': 0.59283435, 'auroc': 0.85112256}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1013     1    0   76    1    1    18    25     2   30     3
1      2  1017    0   42    0    0     1   423     0    0    14
2      9     1  144   50  158   21    10    72   298   98   154
3      0     0    0    0    0    0     0     0     0    0     0
4      4     1    2    0  365    0     2     3    17    1  1238
5      0     0    0  122    1  405     0     1     7   56     0
6      8     0    0   78    0    0  2909    13    26    0    33
7      0     0    0   80    0    0     0  1080     0    0     4
8      0     0    1  236    0    2     1    26  1101    1     2
9     13     4  131  262    8  157     1    92   112  342    15
10     0     0    0    0   26    0     2     1     0    0  1617
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 19:20:23.382442,epoch time: 0:42:34.215186,used: 2:11:14.925822,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9528842, 'precision': 0.8978362, 'recall': 0.8370148, 'specificity': 0.9947532, 'f1': 0.8595589, 'auroc': 0.99648947}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   403     0    0     7    1    0    11     4    10   12     35
1     0  1261    0    11    0    0     0    58     2    0      0
2     0     0  192     1   11    2     0    15     7   82      2
3     0     0    0  8157    0    6     0   243    33    1      0
4     3     1   43     0  252    0     2     8    40   22    167
5     0     0    1    48    0  396     0     0     2   73      1
6     8     1    0     5    1    0  1853     8     5    8     19
7     0     6    0    97    1    0     1  7131    20    0      6
8     1     0    3   205    1    0     0   150  2900    3     31
9     1     0   16     3    0   69     0     9     4  390      1
10    6     0    1     6   17    0    10    26    40    7  12680
---- Validation: 
scalar performance:
{'acc': 0.95399225, 'precision': 0.89653385, 'recall': 0.8378395, 'specificity': 0.99487466, 'f1': 0.85955, 'auroc': 0.99663115}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     0    0     4    0    1     4     9     7   13     38
1     0  1264    0     8    0    0     0    55     4    0      1
2     0     0  186     1   15    1     0    14     5   86      4
3     0     1    0  8166    0    4     0   237    30    2      0
4     3     0   42     0  254    1     1    10    32   21    175
5     0     0    1    37    0  405     0     0     1   76      1
6     8     0    0     3    0    0  1857     9     5    9     17
7     0     8    0    89    1    0     1  7145    17    0      4
8     0     0    4   205    1    1     0   162  2903    2     18
9     1     0   20     6    0   69     0     7     3  386      1
10    9     0    1     7   16    2     4    31    31    3  12692
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6717974, 'precision': 0.6466893, 'recall': 0.5771709, 'specificity': 0.96750915, 'f1': 0.5542383, 'auroc': 0.84445226}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   989     1   0   38    0    6    15    36     3   77     5
1     0  1023   0   36    0    0     0   421     4    0    15
2     4     0  71   32   99   32     0    96   399  144   138
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   1    0  189    0     1     4    30    2  1405
5     1     0   0  107    1  434     0     1     2   46     0
6     0     0   0   40    1    0  2786    16   117    1   106
7     0     0   0   61    0    0     0  1101     0    0     2
8     0     0   0  327    0    1     0    17  1022    1     2
9     6     2  34  184    3  279     0   109   150  349    21
10    0     0   0    0    7    0     0     1     0    0  1638
better model found
persisted
after epoch: 4,now: 2024-08-03 20:03:10.196985,epoch time: 0:42:46.814543,used: 2:54:01.740365,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95917165, 'precision': 0.87659967, 'recall': 0.8751733, 'specificity': 0.9956589, 'f1': 0.8733314, 'auroc': 0.99732196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     6    0    0     3     1     3    2      9
1     0  1290    1    10    0    0     0    28     2    0      0
2     5     0  235     0   33    1     0     2     7   29      0
3     1     1    0  8208    0    6     1   134    84    1      0
4    11     1   30     0  336    0     1     4    31    8    117
5     2     0    0    26    0  413     0     0     4   75      1
6    41     0    1     2    1    0  1849     2     4    1      7
7     1    12    1   166    1    0     2  7028    47    1      4
8     2     1    5    90    6    3     1    60  3118    0      9
9     2     0   76     4    2   56     0     2     5  345      1
10   93     0    1     7   42    0    12    12    57    2  12569
---- Validation: 
scalar performance:
{'acc': 0.9599037, 'precision': 0.8805079, 'recall': 0.876292, 'specificity': 0.99573284, 'f1': 0.87567544, 'auroc': 0.9974615}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    1     6    0    0     3     2     4    2      6
1     0  1288    0     9    0    0     0    31     4    0      0
2     4     1  238     2   32    0     1     3     5   26      0
3     0     2    1  8239    0    5     0   123    70    0      0
4    10     1   32     1  340    1     1     1    34    3    115
5     2     0    1    33    0  409     0     0     6   69      1
6    38     0    0     2    2    0  1851     2     7    2      4
7     1    12    1   156    1    0     1  7040    49    0      4
8     2     0    3    96    3    1     2    55  3121    0     13
9     3     0   79     7    5   47     0     1     6  345      0
10   95     0    1     7   43    0     9    14    68    3  12556
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71734416, 'precision': 0.66456246, 'recall': 0.6014897, 'specificity': 0.9720186, 'f1': 0.5855919, 'auroc': 0.85753894}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1120     0    1   17    0    0     0    14    15    3     0
1      4  1256    0   37    0    0     2   185     6    0     9
2     48     1  119   41  167   17     3    31   462   44    82
3      0     0    0    0    0    0     0     0     0    0     0
4      6     0    3    0  337    0     4     1    41    0  1241
5     23     0    1  225    1  314     0     0     6   21     1
6     18     0    0   35    0    0  2958     4    26    0    26
7     10     1    0   44    0    0     1  1103     1    1     3
8      1     0    0  151    0    2     0     1  1214    0     1
9     50     5  104  245   12  186     1    34   279  206    15
10     0     0    0    0   15    0     3     1     1    0  1626
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-03 20:44:57.380031,epoch time: 0:41:47.183046,used: 3:35:48.923411,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9638003, 'precision': 0.90209705, 'recall': 0.87393403, 'specificity': 0.996098, 'f1': 0.8824667, 'auroc': 0.9978981}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     4    0    0     4     2     1    6     10
1     0  1291    0    10    0    0     0    25     6    0      0
2     2     2  193     0   40    0     0     2     4   68      1
3     1     2    0  8302    0   15     0    74    39    2      0
4     5     1   15     0  334    0     5     2    29   18    130
5     1     0    0    15    0  373     1     0     2  128      1
6    19     0    0     3    1    0  1870     3     2    2      8
7     1    26    1   137    1    0     3  7034    51    4      5
8     2     0    2   140    4    5     0    55  3067    2     18
9     1     2   19     2    0   27     0     1     1  440      0
10   30     2    0     8   22    0    11    12    44    3  12663
---- Validation: 
scalar performance:
{'acc': 0.964023, 'precision': 0.9078318, 'recall': 0.8781528, 'specificity': 0.9960972, 'f1': 0.8870642, 'auroc': 0.9980762}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    0    0     5     3     1    5     10
1     0  1290    0    12    0    0     0    24     6    0      0
2     0     3  200     0   36    0     0     6     6   61      0
3     1     2    0  8305    0   16     0    68    45    3      0
4     7     3   19     0  333    1     1     3    19   15    138
5     0     0    0    15    0  373     0     0     2  130      1
6    12     0    0     6    0    0  1875     1     1    2     11
7     0    24    0   140    1    0     3  7015    66    4     12
8     3     2    0   139    1    8     0    56  3059    9     19
9     0     0   16     2    1   20     0     1     2  451      0
10   28     2    1     7   16    0    12     8    38    4  12680
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74029243, 'precision': 0.6777959, 'recall': 0.6175163, 'specificity': 0.97410685, 'f1': 0.60871524, 'auroc': 0.86727154}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1095     2   0   24    0    0     2     7    10   29     1
1      0  1284   0   41    0    0     2   155     8    1     8
2     20     1  82   17  216    4     5    29   329  173   139
3      0     0   0    0    0    0     0     0     0    0     0
4      2     2   2    0  311    0     2     0    28    1  1285
5      5     0   0   64    2  221     1     0     2  296     1
6      2     0   0   16    0    0  3030     2     6    0    11
7      3     1   0   91    0    0     1  1062     1    2     3
8      0     0   0  169    0    3     6     5  1179    7     1
9     15    11  59  128    9   66     1    27   118  688    15
10     0     0   0    0   12    0     3     1     1    0  1629
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-03 21:30:31.791077,epoch time: 0:45:34.411046,used: 4:21:23.334457,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96864295, 'precision': 0.9069443, 'recall': 0.8871472, 'specificity': 0.9966279, 'f1': 0.89482, 'auroc': 0.99837387}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    1     3    0    1    11     3     0    2     16
1     0  1290    0     4    0    0     0    35     3    0      0
2     3     1  244     0   19    0     1     1     2   38      3
3     0     2    0  8254    0    1     1   106    75    0      0
4     8     1   50     0  344    0     6     5    15    6    104
5     1     0    0    24    0  409     1     0     6   79      1
6     9     0    0     0    1    0  1883     3     3    1      6
7     1     9    2    92    0    0     3  7132    21    0      3
8     3     1    5    65    2    1     5    63  3132    0     17
9     1     0   36     3    0   63     1     1     8  380      0
10   21     1    2     6   20    0    13    16    24    1  12690
---- Validation: 
scalar performance:
{'acc': 0.96849006, 'precision': 0.9089688, 'recall': 0.89046395, 'specificity': 0.9966086, 'f1': 0.8978642, 'auroc': 0.99841267}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     4    0    0    17     2     1    2     12
1     0  1295    0     3    0    0     0    31     3    0      0
2     1     0  243     1   20    0     3     2     4   38      0
3     0     3    1  8246    0    3     1   114    71    1      0
4     6     0   51     0  346    0     5     3    17    5    106
5     0     0    1    28    0  424     1     0     5   61      1
6     6     0    0     1    0    0  1885     3     4    2      7
7     0    12    1    87    2    0     4  7131    22    0      6
8     1     3    3    64    5    1     4    62  3135    0     18
9     3     0   40     5    1   51     2     3     4  384      0
10   23     0    2     6   24    0    23    17    26    2  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71790385, 'precision': 0.6604492, 'recall': 0.602901, 'specificity': 0.9717235, 'f1': 0.5868776, 'auroc': 0.86090267}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1095     0    0    7    0    0    45     9     5    8     1
1      1  1192    0   36    0    0    21   238     3    0     8
2     20     1  115   31  154   15    69    57   316   86   151
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    2    0  229    0    15     3    15    1  1366
5     15     0    0  143    0  343     9     0     6   73     3
6      0     0    0    1    0    0  3062     1     1    0     2
7      1     0    0   57    0    0    11  1094     0    0     1
8      0     0    0  136    0    0    19     9  1203    1     2
9     23     4   75  234    4  183    39    64   194  295    22
10     0     0    0    0    7    0     5     1     0    0  1633
better model found
persisted
after epoch: 7,now: 2024-08-03 22:21:02.486264,epoch time: 0:50:30.695187,used: 5:11:54.029644,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96532536, 'precision': 0.9043628, 'recall': 0.8900509, 'specificity': 0.99620914, 'f1': 0.8944754, 'auroc': 0.9985059}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     4    1    0     0     3     1    4     14
1     0  1297    0     4    1    0     0    25     4    0      0
2     0     0  219     0   30    0     0     1     3   59      0
3     2     0    0  8156    0   24     0   192    65    1      0
4     4     1   18     0  356    1     0     2     9    4    144
5     0     0    0     7    0  463     0     0     2   48      1
6    99     0    1     5    3    1  1764    10     2    3     20
7     1     6    0    96    1    0     1  7129    23    0      6
8     1     2    5    59    5    6     0    70  3110    1     36
9     2     0   16     1    1   71     0     1     1  399      1
10   11     0    2     5   15    0     3    13     8    3  12731
---- Validation: 
scalar performance:
{'acc': 0.9651464, 'precision': 0.90265256, 'recall': 0.8886368, 'specificity': 0.9961844, 'f1': 0.8927414, 'auroc': 0.99857825}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     3    0    0     0     4     2    6     15
1     0  1296    0     3    1    0     0    28     4    0      0
2     1     1  213     0   32    1     0     1     1   60      2
3     0     1    0  8161    1   22     0   191    63    1      0
4     5     0   20     0  353    0     0     2     5    8    146
5     1     0    0     7    0  470     0     0     3   39      1
6   106     0    0     5    5    0  1751     6     3    4     28
7     0     9    0    84    1    0     1  7141    23    0      6
8     1     0    7    54    6    5     0    64  3114    1     44
9     0     0   11     1    3   73     0     1     1  403      0
10   13     0    2     5   17    2     4    14    11    1  12727
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73161685, 'precision': 0.6469899, 'recall': 0.6346102, 'specificity': 0.97316587, 'f1': 0.59410846, 'auroc': 0.8603008}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1094     0    1  18    1    6     0    10    11   27     2
1      0  1222    0  32    1    2     0   217    13    0    12
2      7     0  113   5  245   57     0    27   363   88   110
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    2   0  155    0     1     0    18    1  1454
5      3     0    0  34    0  522     0     0     6   25     2
6      9     0    0   3    1    0  3005     3     5    0    41
7      0     0    0  42    0    1     0  1116     3    1     1
8      0     0    0  80    0    8     0     2  1276    2     2
9      9     4   67  51   14  425     0    33   199  314    21
10     0     0    0   0    4    0     1     1     0    0  1640
early stop counter: 1
val acc:0.9651464223861694, best validation acc: 0.9684900641441345, corresponding to test acc:                         0.7179038524627686 / 0.7402924299240112
after epoch: 8,now: 2024-08-03 23:19:31.458453,epoch time: 0:58:28.972189,used: 6:10:23.001833,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9651381, 'precision': 0.8843977, 'recall': 0.9160372, 'specificity': 0.99641, 'f1': 0.8958154, 'auroc': 0.99881643}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     1    4     0    4    0     0     3     0    4     15
1     0  1311    1     6    0    0     0    11     3    0      0
2     0     0  265     0   29    0     0     1     1   16      0
3     0     5    2  8182    2   10     0   181    56    1      0
4     5     2   21     0  492    1     0     1     3    0     14
5     0     0    3    10    0  450     0     0     0   57      1
6    18     1    3     0    9    1  1833     8     1    7     27
7     0    49    3    54    2    0     1  7119    28    0      6
8     0     2   19    54   48    3     0    54  3082    0     31
9     0     0   92     1    5   47     0     1     0  347      0
10    5     1    3     5  211    0     3    12    10    4  12540
---- Validation: 
scalar performance:
{'acc': 0.9645045, 'precision': 0.8813215, 'recall': 0.9109136, 'specificity': 0.99634486, 'f1': 0.8912238, 'auroc': 0.99876565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    4     1    2    0     0     1     1    6     19
1     0  1313    0     3    0    0     0    13     3    0      0
2     0     0  262     0   31    0     0     1     0   18      0
3     0     4    2  8180    1    8     0   196    49    0      0
4     3     1   23     0  490    0     0     1     0    4     17
5     0     0    3     9    3  441     0     0     3   61      1
6    12     1    1     1    8    1  1842     2     0    5     35
7     1    44    3    60    7    0     0  7118    28    0      4
8     0     1   10    50   46    3     0    54  3108    2     22
9     0     0  105     1    5   49     0     0     1  332      0
10    6     1    6     6  234    0     3    12     4    1  12523
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75428534, 'precision': 0.6883557, 'recall': 0.6552032, 'specificity': 0.9754013, 'f1': 0.6606084, 'auroc': 0.8694023}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1007     2   14   19    6    2    15     9     2   88     6
1      0  1303    4   29    2    0     1   147     4    0     9
2      0     1  368    1  468   12     3    21    53   61    27
3      0     0    0    0    0    0     0     0     0    0     0
4      0     2    5    0  593    0     1     0     5    0  1027
5      3     0    5   57    4  393     1     0     3  124     2
6      0     0    1    1   18    0  2777     2     0    1   267
7      0     4    0   47    0    0     2  1107     1    1     2
8      0     1    0  134   17    4     8     5  1187    5     9
9      4     4  350   66   26  147     2    53    32  448     5
10     0     0    0    0   46    0     1     1     0    0  1598
new oracle model saved
early stop counter: 2
val acc:0.9645044803619385, best validation acc: 0.9684900641441345, corresponding to test acc:                         0.7179038524627686 / 0.7542853355407715
after epoch: 9,now: 2024-08-04 00:25:16.412975,epoch time: 1:05:44.954522,used: 7:16:07.956355,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97337866, 'precision': 0.91920185, 'recall': 0.9126468, 'specificity': 0.99715173, 'f1': 0.9150945, 'auroc': 0.99896884}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    2     2    0    0    13     1     2    2     36
1     0  1310    0     4    0    0     0    12     6    0      0
2     1     1  260     1   16    1     0     1     4   25      2
3     0     3    0  8271    0    6     0    85    72    1      0
4     3     1   42     1  428    1     0     0     6    2     55
5     0     0    1    14    1  463     0     0     2   40      0
6     3     1    1     1    0    0  1880     1     0    1     20
7     1    28    1    78    2    0     2  7090    50    0     10
8     0     1    4    36    7    1     0    37  3185    0     23
9     0     0   45     1    1   62     2     1     6  374      1
10    2     1    2     7   54    0     9     4    19    1  12695
---- Validation: 
scalar performance:
{'acc': 0.9740805, 'precision': 0.92292225, 'recall': 0.9175841, 'specificity': 0.9972271, 'f1': 0.9192983, 'auroc': 0.99908006}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    2     4    0    0    11     1     1    4     31
1     0  1314    0     5    0    0     0    11     2    0      0
2     0     0  268     0   16    1     0     0     6   20      1
3     0     3    1  8267    0    6     0    91    71    1      0
4     3     0   38     0  432    0     1     0    10    2     53
5     0     0    0    20    0  467     0     0     3   30      1
6     6     0    1     1    2    0  1883     0     0    0     15
7     0    29    1    85    1    0     3  7082    51    0     13
8     0     0    4    37    5    1     0    27  3203    0     19
9     1     0   42     1    2   70     1     0     2  373      1
10    3     1    1     6   55    0     6     6    20    0  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.739243, 'precision': 0.6761233, 'recall': 0.62912583, 'specificity': 0.97389674, 'f1': 0.625434, 'auroc': 0.8653932}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   847     4    0   33    1    6   154    28    13   60    24
1     0  1345    0   34    1    0     4   101     3    2     9
2     1     3  227   13  304   33    22    12   223   66   111
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    5    0  499    0     2     0    12    1  1114
5     1     0    0  104    0  444     0     0     6   34     3
6     0     0    0    4    1    0  3024     1     2    0    35
7     1     2    0  118    0    0     3  1029     3    2     6
8     0     0    0  128    2    3     9     0  1223    2     3
9     3     9  166  118   19  309     5    26   155  316    11
10    0     0    0    0   32    0     2     0     0    0  1612
better model found
persisted
after epoch: 10,now: 2024-08-04 01:24:42.566130,epoch time: 0:59:26.153155,used: 8:15:34.109510,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:15:34.109510 at 2024-08-04 01:24:42.566130
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.739243, 'precision': 0.6761233, 'recall': 0.62912583, 'specificity': 0.97389674, 'f1': 0.625434, 'auroc': 0.8653932}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   847     4    0   33    1    6   154    28    13   60    24
1     0  1345    0   34    1    0     4   101     3    2     9
2     1     3  227   13  304   33    22    12   223   66   111
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    5    0  499    0     2     0    12    1  1114
5     1     0    0  104    0  444     0     0     6   34     3
6     0     0    0    4    1    0  3024     1     2    0    35
7     1     2    0  118    0    0     3  1029     3    2     6
8     0     0    0  128    2    3     9     0  1223    2     3
9     3     9  166  118   19  309     5    26   155  316    11
10    0     0    0    0   32    0     2     0     0    0  1612
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75428534, 'precision': 0.6883557, 'recall': 0.6552032, 'specificity': 0.9754013, 'f1': 0.6606084, 'auroc': 0.8694023}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1007     2   14   19    6    2    15     9     2   88     6
1      0  1303    4   29    2    0     1   147     4    0     9
2      0     1  368    1  468   12     3    21    53   61    27
3      0     0    0    0    0    0     0     0     0    0     0
4      0     2    5    0  593    0     1     0     5    0  1027
5      3     0    5   57    4  393     1     0     3  124     2
6      0     0    1    1   18    0  2777     2     0    1   267
7      0     4    0   47    0    0     2  1107     1    1     2
8      0     1    0  134   17    4     8     5  1187    5     9
9      4     4  350   66   26  147     2    53    32  448     5
10     0     0    0    0   46    0     1     1     0    0  1598
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_09_07_seed_1_24051361_instance_wise_predictions.txt
accuracy from prediction file 0.7392429860771007
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2611 MiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |   2597 MiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |     14 MiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   2611 MiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |   2597 MiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |     14 MiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2607 MiB |  16770 MiB |    806 TiB |    806 TiB |
|       from large pool |   2594 MiB |  16737 MiB |    800 TiB |    800 TiB |
|       from small pool |     13 MiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  32194 MiB |  14632 MiB |
|       from large pool |  17526 MiB |  17526 MiB |  32156 MiB |  14630 MiB |
|       from small pool |     36 MiB |     36 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 303781 KiB | 719869 KiB | 128703 GiB | 128703 GiB |
|       from large pool | 285440 KiB | 717120 KiB | 122545 GiB | 122545 GiB |
|       from small pool |  18341 KiB |  27677 KiB |   6157 GiB |   6157 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3082    |    4805    |   62558 K  |   62555 K  |
|       from large pool |     349    |     697    |   26798 K  |   26797 K  |
|       from small pool |    2733    |    4255    |   35760 K  |   35757 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3082    |    4805    |   62558 K  |   62555 K  |
|       from large pool |     349    |     697    |   26798 K  |   26797 K  |
|       from small pool |    2733    |    4255    |   35760 K  |   35757 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     511    |     511    |     871    |     360    |
|       from large pool |     493    |     493    |     852    |     359    |
|       from small pool |      18    |      18    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     173    |    1225    |   33806 K  |   33806 K  |
|       from large pool |     130    |     339    |   17529 K  |   17529 K  |
|       from small pool |      43    |    1094    |   16277 K  |   16276 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |  16640 KiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |  16640 KiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |  16737 MiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2908 MiB |  17562 MiB |  32194 MiB |  29286 MiB |
|       from large pool |   2876 MiB |  17526 MiB |  32156 MiB |  29280 MiB |
|       from small pool |     32 MiB |     36 MiB |     38 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 719869 KiB | 128704 GiB | 128704 GiB |
|       from large pool |  24320 KiB | 717120 KiB | 122546 GiB | 122546 GiB |
|       from small pool |      0 KiB |  27677 KiB |   6158 GiB |   6158 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   62558 K  |   62558 K  |
|       from large pool |       2    |     697    |   26798 K  |   26798 K  |
|       from small pool |       0    |    4255    |   35760 K  |   35760 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   62558 K  |   62558 K  |
|       from large pool |       2    |     697    |   26798 K  |   26798 K  |
|       from small pool |       0    |    4255    |   35760 K  |   35760 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     149    |     511    |     871    |     722    |
|       from large pool |     133    |     493    |     852    |     719    |
|       from small pool |      16    |      18    |      19    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1225    |   33807 K  |   33807 K  |
|       from large pool |       3    |     339    |   17529 K  |   17529 K  |
|       from small pool |       0    |    1094    |   16277 K  |   16277 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 01:33:38 2024]
Finished job 0.
1 of 1 steps (100%) done
