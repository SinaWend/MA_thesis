Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 29 12:17:32 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/31.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=31
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569

 Experiment start at: 2024-07-29 12:37:55.420156
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8879227, 'precision': 0.638639, 'recall': 0.6080742, 'specificity': 0.9880509, 'f1': 0.59229165, 'auroc': 0.95092773}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   63     0   0     7   0   10    48    96    63  112     84
1    1  1154   0    13   0    0     8   139    11    0      4
2    2     9   0     8   1    4    15    57    57  114     45
3    0     0   0  7777   0    6     1   397   257    0      0
4    2     1   0     0   0    4   103    20   140   26    243
5    0     0   0   113   0  158     0     1    24  224      1
6    3     1   0     8   0    8  1763    46    55   11     11
7    0     4   0   162   0    1     3  6914   172    0      8
8    0     0   0   122   0    1     2   110  3047    3     10
9    0     3   0    19   0   55     2    29    18  360      7
10  15     2   0     7   0    0   496    49   254   21  11951
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.88856494, 'precision': 0.6443201, 'recall': 0.6113724, 'specificity': 0.9880554, 'f1': 0.59839386, 'auroc': 0.9518047}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   70     0   0     9   1    9    41   109    57   96     91
1    0  1154   0    13   0    0     8   136    14    0      7
2    1     4   0     5   1    4     8    68    63  104     54
3    0     0   0  7810   0   10     0   372   248    0      0
4    1     2   0     2   0    6   110    20   122   22    254
5    0     0   0   121   0  168     2     2    16  210      2
6    2     0   0     6   0    6  1771    46    57    6     14
7    1     8   0   168   0    0     2  6898   176    1     11
8    0     0   0    95   0    3     2   127  3049    1     19
9    0     0   0    23   0   48     2    28    26  360      6
10  18     1   0     8   0    5   487    50   271   17  11939
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56853, 'precision': 0.46513146, 'recall': 0.4606177, 'specificity': 0.9552802, 'f1': 0.40151125, 'auroc': 0.8336484}
confusion matrix:
    0     1   2   3   4    5     6     7     8    9     10
0   49     0   0  11   0    9    38   596   166  290    11
1    1  1099   0  18   0    3    48   292    26    2    10
2    1     5   0   4   0   13    97   144   450  168   133
3    0     0   0   0   0    0     0     0     0    0     0
4    1     1   0   0   0    0   725     1    50    3   852
5    0     0   0  58   0  205     5     4    42  278     0
6    0     1   0  10   0    0  2684    15   328    2    27
7    0     0   0   1   0    0     2  1158     1    1     1
8    0     0   0  24   0    3     3    15  1320    4     1
9    1     5   0  14   0   69    15   264   262  490    17
10   0     0   0   0   0    0   523     0     2    0  1121
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 14:16:39.042095,epoch time: 1:38:43.621939,used: 1:38:43.621939,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.923186, 'precision': 0.74229836, 'recall': 0.6987121, 'specificity': 0.9913784, 'f1': 0.7044649, 'auroc': 0.9772699}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   322     0   0     2   0    1    11    22     4    5    116
1     0  1242   0     9   1    1    10    56     5    0      8
2     3     4   0    43  56    2    23    34    18  101     28
3     1     1   0  7799   0   20     3   528    82    2      0
4     4     0   0     9  36    3   155     7    28   17    280
5     2     0   0    44   0  271     1     0     5  196      2
6     8     0   0     4   0    1  1860     7     4    2     22
7     1     9   0    79   1    0     2  7113    39    1     18
8     2     0   0   169   0    3     5   221  2798    5     92
9     8     0   0    15   3   46     0    17     7  385     12
10   10     0   0     7   1    0    51    16    28    2  12679
---- Validation: 
scalar performance:
{'acc': 0.92264277, 'precision': 0.75210714, 'recall': 0.7008045, 'specificity': 0.9913069, 'f1': 0.7077385, 'auroc': 0.9779155}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   325     0   0     2   0    3    12    19     4    6    112
1     0  1235   0    11   0    0    12    62     5    1      6
2     1     3   0    51  51    2    22    29    20   98     35
3     1     1   0  7780   0   14     3   561    78    2      0
4     4     0   0     7  49    5   137     8    31   16    282
5     3     0   0    45   0  262     0     0     5  204      2
6    10     0   0     3   0    2  1849     7     5    1     31
7     0     7   0    89   0    1     3  7109    33    1     22
8     0     1   0   162   0    2     7   208  2823    7     86
9     4     1   0    12   3   50     1    10     9  394      9
10    8     1   0     7   2    0    61    20    26    4  12667
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6898482, 'precision': 0.52408373, 'recall': 0.57349735, 'specificity': 0.9680742, 'f1': 0.53222424, 'auroc': 0.85781133}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   924     1   0   3   0    0    83   111    22   10    16
1     2  1209   0  19   0    6    40   188    10    2    23
2    50     6   0  16  61   24   308    64   221   84   181
3     0     0   0   0   0    0     0     0     0    0     0
4     3     0   0   0   2    0   175     1    14    0  1438
5    33     0   0  41   0  298    21     1     6  185     7
6     1     0   0  11   0    0  3024     3    18    1     9
7     0     0   0  29   0    0     5  1125     2    1     2
8     2     0   0  66   0    2    43    21  1225    8     3
9   101    13   0  47  14  136    65    89   211  418    43
10    0     0   0   0   0    0    10     0     1    0  1635
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 15:39:29.505724,epoch time: 1:22:50.463629,used: 3:01:34.085568,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93632275, 'precision': 0.77324927, 'recall': 0.7246676, 'specificity': 0.9930071, 'f1': 0.7254436, 'auroc': 0.98216337}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   321     0   0     6   0    1     2    33     7    8    105
1     1  1234   0    17   0    1     4    53    14    0      8
2     1     1   0    54  22    5    22    31    13  146     17
3     0     0   0  8096   0   18     0   167   153    4      0
4     3     0   0    14  45    3   196     7    44   11    216
5     0     0   0    37   0  424     0     0     7   52      1
6    17     0   0     3   0    3  1837    11     8    1     28
7     1     5   0   192   0    0     4  6964    92    0      5
8     0     0   0    94   0    2     3    76  3097    4     19
9     0     0   0     8   0  133     2     4     7  332      7
10    8     0   0     8   0    2    37    17    73    1  12646
---- Validation: 
scalar performance:
{'acc': 0.9363381, 'precision': 0.7630094, 'recall': 0.7238146, 'specificity': 0.9930327, 'f1': 0.72227746, 'auroc': 0.98140633}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   333     0   0     6   0    1     3    26     8   10     96
1     1  1228   0    13   0    2     4    64    13    2      5
2     0     0   0    59  26    3    22    26    12  147     17
3     0     0   0  8126   0   18     0   148   145    2      1
4     1     0   0     5  35    5   206     8    51   16    212
5     0     0   0    29   0  434     0     0     7   50      1
6    13     0   0     2   0    2  1832    14     8    2     35
7     0     2   0   182   0    0     3  6973    94    5      6
8     0     0   0    87   0    4     3    77  3098    3     24
9     0     0   0    13   0  142     4     7     5  317      5
10   11     0   0     8   0    2    35    25    85    1  12629
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6785839, 'precision': 0.52061164, 'recall': 0.5737151, 'specificity': 0.9673403, 'f1': 0.52232766, 'auroc': 0.8592105}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   720     0   0   14   0   14    18   205    33  121    45
1     1  1162   0   40   1    3    11   229    18    7    27
2     3     0   0   40  31   47   277    59   380   89    89
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    0   0    0   264     1    29    0  1337
5     0     0   0   85   0  468     6     1    12   18     2
6     0     0   0   14   0    0  3022     4    25    0     2
7     0     0   0   52   0    1     0  1095    10    2     4
8     0     0   0   61   0    5     2     1  1300    0     1
9     1     2   1  129   3  317    13    49   294  298    30
10    0     0   0    0   0    0    11     0     1    0  1634
better model found
persisted
after epoch: 3,now: 2024-07-29 16:53:04.189401,epoch time: 1:13:34.683677,used: 4:15:08.769245,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93830264, 'precision': 0.82692456, 'recall': 0.7163398, 'specificity': 0.9931876, 'f1': 0.73212916, 'auroc': 0.98329747}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   298     0   0     7   0    6    10    25     8    3    126
1     0  1258   0    18   0    0     0    50     4    0      2
2     0     9  18    36  68    6    19    34    17   96      9
3     0     1   0  8149   0    7     1   175   104    0      0
4     0     2   2     7  68    6   197     9    41   10    197
5     0     0   0    68   0  395     0     0     5   52      1
6     4     0   0     2   0    4  1816     3     9    1     68
7     0     7   0   135   1    0     0  7054    58    2      6
8     0     0   0    86   0    0     2   108  3075    1     22
9     1     1   5    16   1  167     1    11     9  278      3
10    4     1   0    11   2    3    36    20    57    0  12661
---- Validation: 
scalar performance:
{'acc': 0.93912, 'precision': 0.8512561, 'recall': 0.7204764, 'specificity': 0.9932533, 'f1': 0.73833185, 'auroc': 0.98353416}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   301     0   0     9   0    7     6    20     8    1    131
1     0  1261   0    21   0    0     0    43     3    0      4
2     2     7  22    53  65    6    18    33    15   85      6
3     0     1   0  8147   0    7     0   166   119    0      0
4     0     0   1     9  71    8   189     6    41    8    206
5     0     0   0    63   0  407     0     1     8   41      1
6     2     0   0     2   1    4  1816     3    13    1     66
7     0     8   0   135   0    0     2  7052    60    0      8
8     0     0   0    82   1    1     1   101  3094    2     14
9     0     2   1    22   0  168     1    11    11  274      3
10    2     2   0    14   3    2    24    23    61    1  12664
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5927377, 'precision': 0.5067003, 'recall': 0.51277745, 'specificity': 0.9591277, 'f1': 0.46361625, 'auroc': 0.82757545}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   454     0   0   41   0  101   101    88    16   29   340
1     1  1174   0   45   0    0     4   260     5    0    10
2     3     0   0   50  37   48    95   107   490   67   118
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    1   0    0    61     6    62    0  1502
5     0     0   0  140   0  412     2     1    14   20     3
6     0     0   0   65   0    0  2210    10   606    0   176
7     0     0   0   96   0    0     0  1058     7    0     3
8     0     0   0   75   0    2     2     8  1282    0     1
9     2     8   0  170   3  262     6   102   325  238    21
10    0     0   0    0   0    0     0     1     1    0  1644
better model found
persisted
after epoch: 4,now: 2024-07-29 18:14:59.146462,epoch time: 1:21:54.957061,used: 5:37:03.726306,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93926585, 'precision': 0.8004183, 'recall': 0.7386801, 'specificity': 0.99333805, 'f1': 0.7503958, 'auroc': 0.99065924}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   363     0   0     3    1    0     8    39     4    1     64
1     0  1272   0    10    0    0     0    45     2    0      3
2     1     0   0   173   30    0     7    36     4   58      3
3     0     2   0  8103    0   11     0   204   110    7      2
4     1     0   0    37  159    2   160    18     9    7    146
5     0     0   0    31    0  246     0     1     4  237      2
6     4     0   0     5    2    0  1854     8     6    1     27
7     0     5   0   115    1    0     1  7105    28    0      6
8     3     2   0    44    6    2    20   186  2987    5     41
9     1     0   0    30    0   12     0    23     7  419      1
10    9     0   0    10   13    0   115    20    26    2  12598
---- Validation: 
scalar performance:
{'acc': 0.93689984, 'precision': 0.79517305, 'recall': 0.7327497, 'specificity': 0.99309, 'f1': 0.743796, 'auroc': 0.99049693}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   368     0   0     3    0    1     4    40     3    2     62
1     0  1264   0    12    0    0     1    50     1    0      4
2     1     0   0   173   30    0     6    41     4   54      3
3     0     0   0  8095    0   15     1   196   122    9      2
4     2     1   0    44  142    0   180     8    11    7    144
5     0     0   0    27    0  243     0     4     4  239      4
6     5     0   0     2    1    0  1856    10     5    2     27
7     0     7   0   100    1    0     2  7119    26    1      9
8     1     2   0    59    7    1    27   205  2950    5     39
9     1     0   0    43    0   11     0    19     4  409      6
10   13     0   0    12   11    1   125    18    35    1  12580
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.682362, 'precision': 0.55875826, 'recall': 0.5546808, 'specificity': 0.96743476, 'f1': 0.52086735, 'auroc': 0.8742753}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   791     0   0    4    1    3    28   169    25   47   102
1     0  1266   0   16    0    3     3   193     5    3    10
2     0     4   0  152  235    0   191   185   143   69    36
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    5   21    0   493     1     7    0  1105
5     2     0   0   36    1  135     4     3    19  389     3
6     0     0   0   18    5    0  2958     4    45    0    37
7     0     0   0   20    0    0     0  1140     0    1     3
8     0     0   0   45    0    2    10    24  1283    4     2
9     3    11   1   75    9    7     3   334   135  544    15
10    0     0   0    0    0    0    30     1     0    0  1615
early stop counter: 1
val acc:0.9368998408317566, best validation acc: 0.9391199946403503, corresponding to test acc:                         0.5927376747131348 / 0.6898481845855713
after epoch: 5,now: 2024-07-29 19:25:03.815145,epoch time: 1:10:04.668683,used: 6:47:08.394989,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9456603, 'precision': 0.88330257, 'recall': 0.75728065, 'specificity': 0.9939579, 'f1': 0.77075803, 'auroc': 0.99227786}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   315     2   0     7    0    1     2    35     7    3    111
1     0  1268   0     9    0    1     1    44     4    0      5
2     0     1  10    65   29    1     3    63    14  121      5
3     0     0   0  8069    0   20     0   223   126    1      0
4     0     1   2    28  144    3   139    17    14   12    178
5     0     0   0    17    0  421     0     0     4   78      1
6     3     0   0     6    1    1  1829     4     7    2     55
7     0     6   0    70    1    0     0  7132    46    0      9
8     0     2   0    65    0    9     2    97  3081    4     34
9     0     0   0     7    0   82     0     9     2  391      1
10    2     0   0     9    7    1    42    16    30    1  12685
---- Validation: 
scalar performance:
{'acc': 0.94537914, 'precision': 0.8702641, 'recall': 0.75455856, 'specificity': 0.99389684, 'f1': 0.769241, 'auroc': 0.9924068}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   306     0   0     8    0    2     0    26     6    4    131
1     0  1265   0     7    0    1     1    47     7    0      4
2     0     2  10    54   33    2     5    67    10  127      2
3     0     1   0  8090    0   21     0   214   113    1      0
4     1     1   3    18  158    3   134     7    12   16    186
5     0     0   0    17    0  414     0     0     4   85      1
6     1     0   0    12    0    2  1805     5     6    2     75
7     0     7   0    79    1    0     0  7125    43    2      8
8     0     0   0    56    1    5     5   101  3087    2     39
9     0     0   1     5    1   88     0     8     3  386      1
10    4     0   0    12    6    0    32    21    22    2  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66983837, 'precision': 0.60965985, 'recall': 0.56094724, 'specificity': 0.966573, 'f1': 0.5184877, 'auroc': 0.8665189}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   359     5   0  15    0   30    18   152    32  140   419
1     0  1236   0  20    0    9     0   195     6    8    25
2     1    10   5  64  142   11   121    93   312  145   111
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   1   20    0   182     2    20    1  1407
5     0     0   0  41    0  386     1     0     4  158     2
6     0     0   0  30    1    2  2943     2    51    1    37
7     0     0   0  17    0    1     0  1135     7    2     2
8     0     0   0  99    0   11     0     1  1255    3     1
9     1     6   2  73    2  161     1    83   195  593    20
10    0     0   0   0    0    0     2     1     1    0  1642
better model found
persisted
after epoch: 6,now: 2024-07-29 20:41:18.999402,epoch time: 1:16:15.184257,used: 8:03:23.579246,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9329516, 'precision': 0.8499445, 'recall': 0.7298112, 'specificity': 0.9926177, 'f1': 0.7407067, 'auroc': 0.99361795}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   289     0   0     3    0    0     1    77     4    4    105
1     0  1271   0     2    0    0     0    47     6    2      3
2     0     1   1   163   19    0     4    32    11   78      3
3     0     0   0  7630    0   26     0   588   182   10      0
4     1     0   1    61  135    0   151     9    10   12    158
5     0     0   0    13    0  260     0     1     6  240      1
6     1     0   0     4    0    1  1867     8     5    1     21
7     0     5   0    29    0    0     1  7182    34    3     10
8     1     0   0    21    4    0     3   130  3104    5     27
9     0     0   0    14    0   13     0     7     7  452      0
10    2     1   0    14    7    1    64     6    19    2  12679
---- Validation: 
scalar performance:
{'acc': 0.93355626, 'precision': 0.89827466, 'recall': 0.72813845, 'specificity': 0.99266094, 'f1': 0.7390189, 'auroc': 0.9931426}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   284     0   0     1    1    0     4    65     8    3    117
1     0  1271   0     4    0    0     0    45     8    0      4
2     0     0   1   164   11    0     4    31    12   87      2
3     0     2   0  7635    0   32     0   571   193    7      0
4     0     0   0    70  124    0   145    10    13   13    164
5     0     0   0    12    0  267     0     0     5  236      1
6     4     0   0     1    0    0  1862     9     1    3     28
7     0     4   0    28    0    0     1  7196    28    3      5
8     0     0   0    15    3    1     5   109  3126    3     34
9     0     1   0    12    1   11     0    10     6  449      3
10    2     0   0    15    5    0    58    13    16    1  12686
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6858602, 'precision': 0.5679999, 'recall': 0.5580895, 'specificity': 0.96800816, 'f1': 0.5235524, 'auroc': 0.87851423}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   548     2   0    3    0    4    37   140    56  100   280
1     0  1235   0   24    1    3     3   175    17   15    26
2     0     0   0  207  150    1   157   138   187  110    65
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    5   19    0   281     1    11    1  1315
5     1     0   0   12    0  173     0     0    19  386     1
6     0     0   0    6    0    0  3025     3    26    0     7
7     0     0   0   36    0    0     1  1118     4    2     3
8     0     0   0   17    0    4     0     2  1335   10     2
9     1     5   0   64    2   10     1    88   235  713    18
10    0     0   0    0    1    0     8     0     0    0  1637
early stop counter: 1
val acc:0.9335562586784363, best validation acc: 0.9453791379928589, corresponding to test acc:                         0.6698383688926697 / 0.6898481845855713
after epoch: 7,now: 2024-07-29 22:02:45.201329,epoch time: 1:21:26.201927,used: 9:24:49.781173,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9455533, 'precision': 0.89038503, 'recall': 0.730161, 'specificity': 0.9937636, 'f1': 0.75038975, 'auroc': 0.99423}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   195     0   0     4    0    0     9    38     1    2    234
1     0  1286   0    11    0    1     1    30     2    0      1
2     0     1  13   119   24    1     6    27     4  104     12
3     0     0   0  8307    0    5     1    81    37    4      2
4     0     0   3    17  116    2   147     8    19    5    222
5     0     0   0    29    0  409     1     0     3   76      3
6     1     0   0     3    0    1  1872     3     1    1     26
7     0    43   0   115    0    0     2  7048    42    3     10
8     0     1   0   176    0    0     9    74  2999    2     35
9     0     0   0    12    0   81     0     5     2  385      8
10    0     1   0    10    1    0    33     6    31    0  12711
---- Validation: 
scalar performance:
{'acc': 0.9449512, 'precision': 0.89611554, 'recall': 0.72820663, 'specificity': 0.99370015, 'f1': 0.74830806, 'auroc': 0.99353063}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   192     0   0     7    0    2    12    46     0    1    223
1     0  1289   0    15    0    0     1    24     1    0      2
2     0     0  11   115   30    1     7    32     3   99     14
3     0     2   0  8292    0   10     0    92    42    1      1
4     0     1   0    18  120    0   150     4    15    6    225
5     0     0   0    32    0  402     0     0     2   83      2
6     0     0   0     4    0    1  1875     3     0    1     24
7     0    31   0   126    1    0     1  7055    41    0     10
8     0     3   1   179    0    1     6    76  2996    1     33
9     0     0   0    10    0   83     1     4     4  383      8
10    0     1   0     9    2    1    33    10    28    0  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6147065, 'precision': 0.546046, 'recall': 0.48985642, 'specificity': 0.96134746, 'f1': 0.4545861, 'auroc': 0.8495426}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   66     5   0   32   0    7   125   110     5   22   798
1    0  1352   0   34   0    3     1   103     0    0     6
2    0    16   0  112  30   11   121    91   294   63   277
3    0     0   0    0   0    0     0     0     0    0     0
4    0     4   0    0   5    0    69     1    25    0  1529
5    0     0   0  184   0  271     4     1     2  120    10
6    0     0   0  104   0    0  2951     3     8    0     1
7    0     0   0  131   0    0     0  1030     0    0     3
8    0     0   0  225   0    0     5    17  1119    2     2
9    2    15   0  271   4  123    17   150   154  350    51
10   0     1   0    0   0    0     3     0     0    0  1642
early stop counter: 2
val acc:0.9449511766433716, best validation acc: 0.9453791379928589, corresponding to test acc:                         0.6698383688926697 / 0.6898481845855713
after epoch: 8,now: 2024-07-29 23:25:37.200520,epoch time: 1:22:51.999191,used: 10:47:41.780364,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9425835, 'precision': 0.87673634, 'recall': 0.7240285, 'specificity': 0.99350965, 'f1': 0.747332, 'auroc': 0.99428225}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   198     0   0     1    0    0     1   110     6    1    166
1     0  1284   0     8    0    0     0    30     5    0      4
2     0     7  19    80   82    0     8    23     5   73     15
3     0     1   0  8070    0    5     2   240   117    2      3
4     0     1   0     7  122    0   159     5    11    1    233
5     0     0   0    43    0  324     0     1     5  146      2
6     0     0   0     2    0    0  1867     2     4    0     32
7     0     9   0    62    1    0     2  7124    47    1     18
8     0     0   0    73    2    1     0   101  3076    2     39
9     0     3   3    16    3   33     1    12     4  411      6
10    1     0   0     7    4    0    15     6    23    2  12735
---- Validation: 
scalar performance:
{'acc': 0.94267756, 'precision': 0.87987906, 'recall': 0.7252759, 'specificity': 0.9935101, 'f1': 0.74903417, 'auroc': 0.99499947}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   200     0   0     1    0    1     3   114     5    1    158
1     0  1286   0     9    0    0     2    25     7    0      3
2     0     6  24    86   79    1     8    24     4   63     17
3     0     1   0  8061    0    4     1   244   126    3      0
4     0     1   0    10  106    0   165     7    12    1    237
5     0     0   0    42    0  321     0     1     4  149      4
6     1     0   0     1    1    0  1872     2     4    0     27
7     0     7   0    68    1    0     1  7118    41    0     29
8     0     0   0    62    0    0     2    94  3097    2     39
9     0     2   3    15    1   24     0    12     4  423      9
10    1     0   0     7    4    0    19     6    23    2  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6423424, 'precision': 0.55513316, 'recall': 0.5138541, 'specificity': 0.9639852, 'f1': 0.47864404, 'auroc': 0.8583805}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   258     0   0    7    0    1    28   366    40    9   461
1     0  1310   0   28    0    1     3   129     9    1    18
2     0     2   0   69  112    3    79   143   266   85   256
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0   23    0    74     0    10    0  1526
5     1     0   0  130    0  210     2     6    14  218    11
6     0     0   0   19    0    0  2978     2    12    0    56
7     0     0   0   34    0    1     2  1117     5    0     5
8     0     0   0  128    0    0     2    11  1225    2     2
9     2     2   2  145   11   42     5   264   205  415    44
10    0     0   0    0    0    0     1     0     0    0  1645
early stop counter: 3
val acc:0.9426775574684143, best validation acc: 0.9453791379928589, corresponding to test acc:                         0.6698383688926697 / 0.6898481845855713
after epoch: 9,now: 2024-07-30 00:49:50.749835,epoch time: 1:24:13.549315,used: 12:11:55.329679,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94319886, 'precision': 0.8246714, 'recall': 0.7110151, 'specificity': 0.99349827, 'f1': 0.72776735, 'auroc': 0.9937781}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   79     0   0     4    0    1     1   188     9    6    195
1    0  1277   0    14    0    1     0    38     1    0      1
2    0     1   0   190    8    2     0     9     4   92      6
3    0     0   0  8253    0    8     1    94    82    0      0
4    0     0   0   100  192    1    13     4    25    6    198
5    0     0   0    27    0  450     0     0     3   40      1
6    0     1   0     5    0    4  1813     3    14    0     68
7    0     5   0   124    0    0     0  7082    49    0      4
8    0     0   0    78    1    1     0    55  3152    4      5
9    0     0   0    16    0  160     0     2     4  311      0
10   0     0   0    15    4    2     6    24    95    0  12644
---- Validation: 
scalar performance:
{'acc': 0.94289154, 'precision': 0.82807386, 'recall': 0.7132381, 'specificity': 0.99345225, 'f1': 0.7297563, 'auroc': 0.99358153}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   70     0   0     5    0    1     2   200     9    6    190
1    0  1259   0    15    0    1     0    51     4    0      2
2    0     0   0   199    5    2     0     5     5   93      3
3    0     0   0  8263    0    9     0    94    73    1      0
4    0     0   0    94  202    2    18     2    22    5    194
5    0     0   0    22    0  461     0     0     4   33      1
6    0     1   0     4    1    2  1795     5    16    4     80
7    0     3   0   129    0    0     0  7066    58    3      6
8    0     0   0    67    0    0     0    58  3164    0      7
9    0     0   0    15    0  142     0     5     7  323      1
10   0     0   0    14    7    0     2    22   102    2  12647
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.505912, 'precision': 0.5495109, 'recall': 0.44278228, 'specificity': 0.9509831, 'f1': 0.39476776, 'auroc': 0.8031834}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   18     3   0   36   0   28    19  268    61   83   654
1    0  1132   0   53   0    1     1  282     9    0    21
2    0     0   0  184  26   21     5   63   499   78   139
3    0     0   0    0   0    0     0    0     0    0     0
4    0     0   0    4  29    0     8    2    64    1  1525
5    0     0   0  177   0  364     0    1     9   38     3
6    0     0   0  245   0    0  1603    5   896    0   318
7    0     0   0  208   0    0     9  933    11    0     3
8    0     0   0  152   0    2     0    2  1214    0     0
9    0     2   0  310   0  195     0   70   244  293    23
10   0     0   0    0   0    0     0    0     1    0  1645
early stop counter: 4
val acc:0.942891538143158, best validation acc: 0.9453791379928589, corresponding to test acc:                         0.6698383688926697 / 0.6898481845855713
after epoch: 10,now: 2024-07-30 02:16:56.662746,epoch time: 1:27:05.912911,used: 13:39:01.242590,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 13:39:01.242590 at 2024-07-30 02:16:56.662746
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66983837, 'precision': 0.60965985, 'recall': 0.56094724, 'specificity': 0.966573, 'f1': 0.5184877, 'auroc': 0.8665189}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   359     5   0  15    0   30    18   152    32  140   419
1     0  1236   0  20    0    9     0   195     6    8    25
2     1    10   5  64  142   11   121    93   312  145   111
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   1   20    0   182     2    20    1  1407
5     0     0   0  41    0  386     1     0     4  158     2
6     0     0   0  30    1    2  2943     2    51    1    37
7     0     0   0  17    0    1     0  1135     7    2     2
8     0     0   0  99    0   11     0     1  1255    3     1
9     1     6   2  73    2  161     1    83   195  593    20
10    0     0   0   0    0    0     2     1     1    0  1642
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6898482, 'precision': 0.52408373, 'recall': 0.57349735, 'specificity': 0.9680742, 'f1': 0.53222424, 'auroc': 0.85781133}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   924     1   0   3   0    0    83   111    22   10    16
1     2  1209   0  19   0    6    40   188    10    2    23
2    50     6   0  16  61   24   308    64   221   84   181
3     0     0   0   0   0    0     0     0     0    0     0
4     3     0   0   0   2    0   175     1    14    0  1438
5    33     0   0  41   0  298    21     1     6  185     7
6     1     0   0  11   0    0  3024     3    18    1     9
7     0     0   0  29   0    0     5  1125     2    1     2
8     2     0   0  66   0    2    43    21  1225    8     3
9   101    13   0  47  14  136    65    89   211  418    43
10    0     0   0   0   0    0    10     0     1    0  1635
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_12_37_52_seed_0_23205569_instance_wise_predictions.txt
accuracy from prediction file 0.6698383824249633
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/31.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/31.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/31.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |   1648 MiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      7 MiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |   1648 MiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      7 MiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB |    816 TiB |    816 TiB |
|       from large pool |   1647 MiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      6 MiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20112 MiB |  20112 MiB |  20112 MiB |      0 B   |
|       from large pool |  20078 MiB |  20078 MiB |  20078 MiB |      0 B   |
|       from small pool |     34 MiB |     34 MiB |     34 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231478 KiB | 783421 KiB | 117584 GiB | 117583 GiB |
|       from large pool | 216320 KiB | 781120 KiB | 111654 GiB | 111654 GiB |
|       from small pool |  15158 KiB |  17181 KiB |   5929 GiB |   5929 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   53604 K  |   53601 K  |
|       from large pool |     247    |     691    |   27281 K  |   27281 K  |
|       from small pool |    2419    |    3627    |   26322 K  |   26320 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   53604 K  |   53601 K  |
|       from large pool |     247    |     691    |   27281 K  |   27281 K  |
|       from small pool |    2419    |    3627    |   26322 K  |   26320 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     566    |     566    |     566    |       0    |
|       from large pool |     549    |     549    |     549    |       0    |
|       from small pool |      17    |      17    |      17    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     118    |    1251    |   30752 K  |   30752 K  |
|       from large pool |      94    |     367    |   18777 K  |   18777 K  |
|       from small pool |      24    |    1157    |   11975 K  |   11975 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |    816 TiB |    816 TiB |
|       from large pool |  16640 KiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20112 MiB |  20112 MiB |  18230 MiB |
|       from large pool |   1860 MiB |  20078 MiB |  20078 MiB |  18218 MiB |
|       from small pool |     22 MiB |     34 MiB |     34 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 783421 KiB | 117585 GiB | 117585 GiB |
|       from large pool |  24320 KiB | 781120 KiB | 111655 GiB | 111655 GiB |
|       from small pool |      0 KiB |  20690 KiB |   5929 GiB |   5929 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   53604 K  |   53604 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26322 K  |   26322 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   53604 K  |   53604 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26322 K  |   26322 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     566    |     566    |     462    |
|       from large pool |      93    |     549    |     549    |     456    |
|       from small pool |      11    |      17    |      17    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   30753 K  |   30753 K  |
|       from large pool |       3    |     367    |   18777 K  |   18777 K  |
|       from small pool |       0    |    1157    |   11976 K  |   11976 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |    816 TiB |    816 TiB |
|       from large pool |  16640 KiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20112 MiB |  20112 MiB |  18230 MiB |
|       from large pool |   1860 MiB |  20078 MiB |  20078 MiB |  18218 MiB |
|       from small pool |     22 MiB |     34 MiB |     34 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 783421 KiB | 117585 GiB | 117585 GiB |
|       from large pool |  24320 KiB | 781120 KiB | 111655 GiB | 111655 GiB |
|       from small pool |      0 KiB |  20690 KiB |   5929 GiB |   5929 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   53604 K  |   53604 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26322 K  |   26322 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   53604 K  |   53604 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26322 K  |   26322 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     566    |     566    |     462    |
|       from large pool |      93    |     549    |     549    |     456    |
|       from small pool |      11    |      17    |      17    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   30753 K  |   30753 K  |
|       from large pool |       3    |     367    |   18777 K  |   18777 K  |
|       from small pool |       0    |    1157    |   11976 K  |   11976 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569

 Experiment start at: 2024-07-30 02:56:31.676168
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8203928, 'precision': 0.5540018, 'recall': 0.60978544, 'specificity': 0.9822546, 'f1': 0.54982245, 'auroc': 0.90924907}
confusion matrix:
     0     1   2     3   4     5     6     7     8   9     10
0   264     2   3     7   1    40   144     7     7   0     8
1     0  1257   6    15   0     2     1    47     3   0     0
2     7    17   4     1   0   221    32    18    10   0     2
3     1     1   4  7817   0    99     2   232   281   0     0
4     3    17   0     0   0   325    15     7    42   0   130
5     0     0   1    11   0   477    16     0    15   0     1
6    51    13   0     7   0    27  1796     4     2   0     8
7     1    63   8   353   3    22     6  6757    44   0     7
8     1    18  32   266   0   459     4   154  2350   0    11
9     3     1   4     0   0   402    68     4    11   0     0
10   37    76   9    12   0  1973   153    32   560   0  9941
---- Validation: 
scalar performance:
{'acc': 0.8201685, 'precision': 0.5623099, 'recall': 0.6141642, 'specificity': 0.9822095, 'f1': 0.5540756, 'auroc': 0.9089257}
confusion matrix:
     0     1   2     3   4     5     6     7     8   9     10
0   279     2   4     8   0    38   129     8     5   0    10
1     0  1265   3    13   0     4     0    42     3   0     2
2     5    13   9     1   0   228    29    14    11   0     2
3     1     1   1  7818   0    97     5   229   288   0     0
4     4    17   1     2   0   327    15     8    33   0   132
5     1     0   0    10   0   482    16     0    12   0     0
6    56    16   0     9   0    32  1782     4     5   0     4
7     0    63   5   371   4    24     8  6745    38   0     7
8     4    16  32   288   0   453     7   146  2335   0    15
9     4     4   1     2   0   402    76     0     4   0     0
10   31    89   8    11   0  1974   131    43   562   0  9947
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5768558, 'precision': 0.43963248, 'recall': 0.48790878, 'specificity': 0.9571191, 'f1': 0.44085735, 'auroc': 0.7997442}
confusion matrix:
     0     1   2   3   4    5     6     7     8   9     10
0   875     2   7   3   0    6   227    49     1   0     0
1     3  1336  13  12   0   13    11   101     5   0     5
2    30    46  34   1   0  486   308    36    67   0     7
3     0     0   0   0   0    0     0     0     0   0     0
4    11    37   1   0   0  798    67     0   139   0   580
5    14     0   3   2   0  323   244     2     4   0     0
6    25    81   0   4   1  404  2512     1    23   0    16
7     4     3   4  20   0    4     3  1125     1   0     0
8    10     0  20  31   0  233    50    14  1012   0     0
9    80    30  54   7   0  431   454    53    24   0     4
10    1    22   1   0   0  427    14     0   153   0  1028
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-30 04:22:31.360412,epoch time: 1:25:59.684244,used: 1:25:59.684244,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90841717, 'precision': 0.6499045, 'recall': 0.6640507, 'specificity': 0.9899195, 'f1': 0.65064096, 'auroc': 0.9285924}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   380     1   0     3   0    1    44     8    12   0     34
1     0  1270   1     9   0    0    11    30     8   0      3
2    49     0  74     4   0    4    12    62    38   0     69
3     3     1   1  7739   0    9    63   207   413   0      0
4     7     2  20     7   0    9     7    19    87   0    381
5    17     0   1    45   0  301    13     7    95   0     42
6    16     0   0     1   0    2  1867     3     7   0     10
7     2    18   9   245   0    0    36  6796   142   0     16
8     1     5   7    41   0   18    14    67  3123   0     20
9   126     3  33    12   0   76     7    58    64   0    114
10   35     7   8    52   0   52    50    42   145   0  12403
---- Validation: 
scalar performance:
{'acc': 0.90851945, 'precision': 0.6510883, 'recall': 0.66533947, 'specificity': 0.98989135, 'f1': 0.6530051, 'auroc': 0.9278459}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   377     1   0     1   0    5    46    11     9   0     33
1     0  1267   0    15   0    0     5    35     7   0      3
2    36     3  76     3   0    2    10    64    49   0     69
3     0     3   0  7758   0    5    61   200   409   0      4
4     6     3  19     5   0   11     6    20    79   0    390
5    18     2   5    40   0  309    14     6    84   0     43
6    16     2   0     4   0    1  1866     2     6   0     11
7     1    18   5   264   0    1    30  6790   140   0     16
8     3     1   4    42   0   18    19    56  3132   0     21
9   112     1  41    10   0   69    11    48    64   0    137
10   35    12  15    39   0   54    62    46   143   0  12390
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64199257, 'precision': 0.46396428, 'recall': 0.5212635, 'specificity': 0.96381634, 'f1': 0.45875725, 'auroc': 0.8177518}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   951     2   3    6   0    3   171   18    14   0     2
1     1  1267   2   31   0    0    10  167    16   0     5
2   136    17  27    9   0   53    34   82   480   0   177
3     0     0   0    0   0    0     0    0     0   0     0
4     5     9   0    3   0   34    23    8    64   0  1487
5    98    21   0   51   0  230    61    8   100   0    23
6     0     0   0   27   0   35  2841    2   161   0     1
7     0     0   0  229   0    1    25  903     4   0     2
8     2     0   0   35   0    3     3    2  1325   0     0
9   288    24  26   55   0  116    61  121   370   0    76
10    0     4   0    3   0    0     5    0     2   0  1632
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-30 05:42:16.615356,epoch time: 1:19:45.254944,used: 2:45:44.939188,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91845036, 'precision': 0.6739327, 'recall': 0.6635672, 'specificity': 0.9905999, 'f1': 0.64743507, 'auroc': 0.92739487}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   418     6   0     6   0    0     7     5     3   0     38
1     0  1283   1    13   0    0     0    29     5   0      1
2    25    13  12     3   0   12     2    52    24   0    169
3     1     3   0  8287   0    3     1    64    77   0      1
4     8    19   1     3   0    6     3     5    43   0    451
5     7    10   0    28   0  373     9     0    87   0      7
6    24     8   0     5   0    3  1832     3    10   0     23
7     1    47   2   480   0    0     2  6686    33   0     13
8     1     4   2   300   0    7     1    79  2869   0     31
9    48    54   4    12   0  171    23    18    46   0    117
10   42    67   0    14   0    7     9    26    60   0  12568
---- Validation: 
scalar performance:
{'acc': 0.91820246, 'precision': 0.6744877, 'recall': 0.6607094, 'specificity': 0.99060667, 'f1': 0.6459379, 'auroc': 0.9283569}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   408     9   0     7   0    1     7     9     5   0     37
1     0  1284   0    15   0    0     0    30     2   0      1
2    31     7  13     2   0   15     6    48    31   0    159
3     1     4   0  8281   0    1     0    72    81   0      0
4     8    26   1     0   0    8     2     8    50   0    436
5     5    15   0    26   0  364     9     1    95   0      6
6    22    16   0     4   0    6  1834     1     8   0     17
7     0    45   0   486   0    0     0  6688    32   0     14
8     1    10   0   281   0    5     3    83  2877   0     36
9    53    61   5     7   0  149    23    18    59   0    118
10   35    58   4    21   0   11    12    23    54   0  12578
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62737006, 'precision': 0.47670153, 'recall': 0.5207242, 'specificity': 0.9626585, 'f1': 0.45536423, 'auroc': 0.7973268}
confusion matrix:
      0     1   2    3   4    5     6     7     8   9     10
0   1073     3   0   28   0    1     7    34    19   0     5
1      2  1289   4   37   0    0     1   144    14   0     8
2     61    72  10   18   0   21     6    76   375   0   376
3      0     0   0    0   0    0     0     0     0   0     0
4      3     6   0    2   0    8     0     5    31   0  1578
5     48    39   0   91   0  190    12    11   147   0    54
6      6    47   0   45   0  146  2447     5   282   0    89
7      1     1   0  111   0    0     1  1042     3   0     5
8      1     0   0   94   0    0     0     4  1271   0     0
9    154    91   4  123   0   73    22   110   408   0   152
10     0     0   0    0   0    0     0     0     1   0  1645
better model found
persisted
after epoch: 3,now: 2024-07-30 07:12:15.636188,epoch time: 1:29:59.020832,used: 4:15:43.960020,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9239084, 'precision': 0.6780635, 'recall': 0.6604599, 'specificity': 0.9910077, 'f1': 0.6511257, 'auroc': 0.9360846}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   411     0   0     0   0    2     2    14     2   0     52
1     0  1247   0    11   0    0     0    67     6   0      1
2    33     1   6     1   0    5     2   102    14   0    148
3     2     0   1  8191   0    7     0   114   123   0      1
4     5     1   2     2   0    2     0    13     9   0    505
5     7     1   0     5   0  382     0     5   108   0     13
6    56     3   0     8   0    3  1788     6     5   0     39
7     5     8   2   280   0    0     1  6898    56   0     13
8     3     4   3   191   1    2     0    90  2874   0    126
9    59     0   0     2   0  156     6    82    55   0    133
10   15     0   0    10   0    0     2    22     8   0  12735
---- Validation: 
scalar performance:
{'acc': 0.92475593, 'precision': 0.69070387, 'recall': 0.6623603, 'specificity': 0.99110544, 'f1': 0.6509374, 'auroc': 0.93516195}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   411     0   0     1   0    1     2    13     5   0     50
1     0  1255   0    15   0    0     0    57     3   0      2
2    43     0   4     0   0   11     1    96    13   0    144
3     2     0   0  8201   0    6     0   112   119   0      0
4     5     0   1     1   0    3     0    15    15   0    499
5     7     0   0     4   0  393     2     4    91   0     20
6    53     3   0    14   0    6  1780     8     6   0     38
7     2     8   1   257   0    0     1  6922    61   0     13
8     7     2   1   188   0    4     0    82  2880   0    132
9    59     0   0     5   0  150     7    69    65   0    138
10   16     1   0    13   0    2     1    27    10   0  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64619046, 'precision': 0.49569577, 'recall': 0.52691466, 'specificity': 0.96440023, 'f1': 0.46916208, 'auroc': 0.8183341}
confusion matrix:
      0     1   2    3   4    5     6     7     8   9     10
0   1114     0   0    6   0    2     1    34     2   0    11
1      1  1261   3   30   0    0     0   189     2   0    13
2    105     3   1   18   0    1     0   169    25   0   693
3      0     0   0    0   0    0     0     0     0   0     0
4      2     0   0    0   0    0     1     2     0   0  1628
5    100     1   0   26   0  181    18    57   125   0    84
6     15     6   0  107   0    3  2783    13     4   0   136
7      4     0   0   22   0    0     0  1132     0   0     6
8      5     1   1  143   0    0     0    40  1118   0    62
9    396     4   1   66   0   15     6   308    76   0   265
10     0     0   0    0   0    0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-30 08:43:31.397441,epoch time: 1:31:15.761253,used: 5:46:59.721273,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92107236, 'precision': 0.6717465, 'recall': 0.63613176, 'specificity': 0.9908878, 'f1': 0.62386644, 'auroc': 0.945413}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   420     0   1     0   0    0     8    12     1   0     41
1     0  1287   0     7   0    0     0    33     2   0      3
2    54     0   6     0   0    0     3   132     4   0    113
3     4     1   0  7852   0    3     2   436   137   0      3
4    10     0   0     0   0    0     2    36     6   0    485
5    69     0   3    12   0  181    28    50   125   0     53
6     9     3   0     2   0    0  1873     4     2   0     14
7     0    22   0    60   0    0     2  7130    31   0     16
8     3     4   4    92   0    0     4   106  2996   0     86
9   247     0   4     3   0   10     9   134    15   0     71
10   39     3   0    11   0    0     7    46     8   0  12681
---- Validation: 
scalar performance:
{'acc': 0.9216263, 'precision': 0.6583662, 'recall': 0.6357949, 'specificity': 0.9909443, 'f1': 0.6224153, 'auroc': 0.9458013}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   424     0   0     0   0    0     8    18     0   0     33
1     0  1285   0     5   0    0     0    36     2   0      4
2    47     1   3     0   0    0     3   144     1   0    113
3     4     1   0  7853   0    2     4   443   131   0      2
4    18     0   0     2   0    1     1    20     6   0    491
5    64     2   1    15   0  179    19    54   129   0     58
6    12     2   0     2   0    0  1875     3     1   0     13
7     3    24   2    50   0    0     2  7142    24   0     18
8     3     5   7   104   0    0     3    93  2998   0     83
9   237     0   2     2   0   15     9   147    12   0     69
10   42     1   0     5   0    0    12    34     6   0  12696
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65738475, 'precision': 0.4917327, 'recall': 0.51756877, 'specificity': 0.96554154, 'f1': 0.44438305, 'auroc': 0.8248415}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1051     1   1    7   0   0     5    85    15   0     5
1      5  1313   2   21   0   0     6   129     4   0    19
2    130     3   7   20   0   0     5   198   104   0   548
3      0     0   0    0   0   0     0     0     0   0     0
4      3     0   0    0   0   0     3     3     5   0  1619
5    165     0   0   68   0  49    18   111    97   0    84
6      1     3   0   51   0   0  2984     3     7   0    18
7      3     0   0   35   0   0     3  1115     1   0     7
8      5     0   0  103   0   1     3    20  1231   0     7
9    431     5  20   60   0   5    19   333   143   0   121
10     0     0   0    0   0   0     0     0     0   0  1646
new oracle model saved
early stop counter: 1
val acc:0.9216263294219971, best validation acc: 0.9247559309005737, corresponding to test acc:                         0.6461904644966125 / 0.6573847532272339
after epoch: 5,now: 2024-07-30 10:28:07.978966,epoch time: 1:44:36.581525,used: 7:31:36.302798,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93006206, 'precision': 0.6641583, 'recall': 0.6493324, 'specificity': 0.99220145, 'f1': 0.6347146, 'auroc': 0.9523735}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   422     0   0     3   0    0    11    21     4   0     22
1     0  1287   0     5   0    0     1    31     7   0      0
2    31     1   2     0   0    2    11   202    18   0     45
3     0     2   0  8178   0    2     1   129   126   0      0
4    12     1   0     0   0    3     8    54    31   0    430
5     7     0   0    13   0  230    46    11   212   0      2
6    11     0   0     1   0    2  1876     2     6   0      9
7     2    10   1   127   0    0     3  7015    97   0      8
8     0     3   0    78   0    7     3    47  3125   0     32
9   153     0   2     0   0   81   121   110    19   0      7
10   17     3   0     5   0    4    18    71    49   0  12627
---- Validation: 
scalar performance:
{'acc': 0.93015915, 'precision': 0.67530376, 'recall': 0.6490082, 'specificity': 0.9922058, 'f1': 0.6368727, 'auroc': 0.95158184}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   412     0   0     2   0    0    14    28     6   0     21
1     0  1288   0     8   0    0     0    30     6   0      0
2    32     0   4     0   0    2    11   199    19   0     45
3     1     1   0  8191   0    3     1   121   122   0      0
4    13     1   0     0   0    9     2    58    30   0    426
5     7     0   0    12   0  236    42     6   215   0      3
6    12     0   0     2   0    1  1875     6     3   0      9
7     1    14   0   146   0    0     3  6996    99   0      6
8     0     0   1    70   0    5     7    56  3128   0     29
9   130     0   3     2   0   78   126   121    25   0      8
10   19     0   0     3   0    0    25    64    41   0  12644
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6498286, 'precision': 0.46179205, 'recall': 0.5070368, 'specificity': 0.9649224, 'f1': 0.43843463, 'auroc': 0.8274292}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1035     2   0   24   0   0    26    69    11   0     3
1      0  1313   0   36   0   0     4   136     4   0     6
2    104     8   3   19   0   8    20   279   266   0   308
3      0     0   0    0   0   0     0     0     0   0     0
4      4     0   0    0   0   2     3     8    19   0  1597
5     51     0   1  134   0  42    65   108   180   0    11
6      0     1   0   26   0   1  3025     2     9   0     3
7      1     0   0  125   0   0     1  1031     2   0     4
8      1     0   0  154   0   4     2    15  1194   0     0
9    210     9  10  169   0  11    65   433   200   0    30
10     0     0   0    0   0   0     0     0     1   0  1645
better model found
persisted
after epoch: 6,now: 2024-07-30 11:59:06.635981,epoch time: 1:30:58.657015,used: 9:02:34.959813,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9144638, 'precision': 0.6439985, 'recall': 0.6063112, 'specificity': 0.9900602, 'f1': 0.58539873, 'auroc': 0.94930285}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   432     0   0     1   0   0     2    24     0   0     24
1     1  1289   0     4   0   0     0    34     3   0      1
2    16     0   0     0   0   0     1   224     0   0     71
3     6     0   0  7965   0   0     3   304   153   0      6
4    10     0   0     0   0   0     0    27     1   0    501
5    79     4   0    12   0  40    56    79   218   0     33
6    24     1   0     3   0   0  1854     8     0   0     17
7     3    15   1    71   0   0     0  7122    13   0     37
8    10     7   1    61   0   0     2   183  2770   0    262
9   211     1   0     1   0   1     7   219    10   0     42
10   29     1   0     5   0   0     4    48     1   0  12707
---- Validation: 
scalar performance:
{'acc': 0.9155009, 'precision': 0.6538685, 'recall': 0.60856426, 'specificity': 0.99020076, 'f1': 0.5883845, 'auroc': 0.9505474}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   433     0   0     1   0   0     0    22     0   0     27
1     0  1290   0     5   0   0     0    35     2   0      0
2    24     1   1     0   0   0     1   208     0   0     77
3     8     1   0  7998   0   1     0   285   142   0      5
4    11     3   0     0   0   0     0    40     2   0    483
5    79     7   0     5   0  47    57    77   219   0     30
6    23     3   0     0   0   0  1855     5     1   0     21
7     1    12   0    72   0   0     1  7125    15   0     39
8     6     3   6    64   0   1     1   192  2778   0    245
9   215     2   0     1   0   1    11   213     9   0     41
10   24     1   0     5   0   0     7    59     1   0  12699
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64416146, 'precision': 0.48834294, 'recall': 0.5007793, 'specificity': 0.9644648, 'f1': 0.42866105, 'auroc': 0.82769394}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1105     1   0   11   0   0     3    45     1   0     4
1      0  1269   0   35   0   0     1   187     0   0     7
2    109    13   0   43   0   0     5   335    68   0   442
3      0     0   0    0   0   0     0     0     0   0     0
4      5     0   0    1   0   0     2     8     2   0  1615
5     67     6   0  100   0   1     3   162    94   0   159
6      2    13   0   20   0   0  2992     5     2   0    33
7      0     0   0   85   0   0     0  1075     0   0     4
8      1     0   0  190   0   0     1    42  1119   0    17
9    244    11   0  163   0   0     1   555    51   0   112
10     0     0   0    0   0   0     0     0     0   0  1646
early stop counter: 1
val acc:0.9155008792877197, best validation acc: 0.9301591515541077, corresponding to test acc:                         0.6498286128044128 / 0.6573847532272339
after epoch: 7,now: 2024-07-30 13:54:58.451368,epoch time: 1:55:51.815387,used: 10:58:26.775200,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.91952056, 'precision': 0.7198894, 'recall': 0.60981214, 'specificity': 0.99077487, 'f1': 0.60200524, 'auroc': 0.9522947}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   414     1   0     3   0   0     1    28     5   0     31
1     0  1275   0     7   0   0     0    48     2   0      0
2    29     0  21    12   0   1     1   169    21   0     58
3     0     1   0  7883   0   0     0   468    86   0      0
4     1     0   0    13   0   0     1    28    21   0    475
5     4     0   0    22   0   7    12    19   441   0     16
6    16     2   0     8   0   0  1847     5     9   0     19
7     0     4   0    64   0   0     1  7170    20   0      5
8     1     1   0    53   0   0     0   138  3068   0     34
9    51     0   0    10   0   4    34   236    98   0     60
10   10     3   0    11   0   0     7    48    31   0  12683
---- Validation: 
scalar performance:
{'acc': 0.9197539, 'precision': 0.7140217, 'recall': 0.60907626, 'specificity': 0.9907911, 'f1': 0.60194635, 'auroc': 0.9536294}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   411     5   0     3   0   0     1    26     3   0     34
1     0  1275   0     5   0   0     0    50     2   0      0
2    25     0  21    12   0   0     2   172    19   0     61
3     0     1   0  7905   0   0     0   446    88   0      0
4     3     1   1    14   0   0     0    25    17   0    478
5     4     0   0    19   0   7    11    22   448   0     10
6    12     3   0    17   0   0  1840     8     9   0     19
7     0     6   0    60   0   0     1  7170    22   0      6
8     1     1   0    46   0   0     0   137  3071   0     40
9    52     1   2     6   0   4    29   235   100   0     64
10    8     2   0    13   0   0     8    56    24   0  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6580144, 'precision': 0.48974413, 'recall': 0.51133823, 'specificity': 0.9656825, 'f1': 0.43576366, 'auroc': 0.82810587}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1029     2   0   18   0   0     8    84    21   0     8
1      0  1338   0   31   0   0     0   117     7   0     6
2     34     7   0   41   0   0     8   170   303   0   452
3      0     0   0    0   0   0     0     0     0   0     0
4      2     0   0    5   0   0     5     3    14   0  1604
5     16     0   0   95   0   1    15    52   385   0    28
6      0     1   0   24   0   0  3028     2     8   0     4
7      2     0   0   83   0   0     0  1072     2   0     5
8      0     0   0   66   0   0     0    10  1294   0     0
9     81     8   2  170   0   0    14   366   376   0   120
10     0     0   0    2   0   0     0     0     1   0  1643
new oracle model saved
early stop counter: 2
val acc:0.919753909111023, best validation acc: 0.9301591515541077, corresponding to test acc:                         0.6498286128044128 / 0.6580144166946411
after epoch: 8,now: 2024-07-30 16:03:02.138352,epoch time: 2:08:03.686984,used: 13:06:30.462184,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9268782, 'precision': 0.7326232, 'recall': 0.6329543, 'specificity': 0.99165344, 'f1': 0.63712364, 'auroc': 0.95949113}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   404     0   0     2   0   0     3    45     2   0     27
1     0  1307   0     8   0   0     0    13     4   0      0
2    16     0  74     4   0   0     0   179    22   0     17
3     0     5   0  8300   0   1     2    97    31   0      3
4     1     1  20    34   0   0     1    67    41   0    374
5     3     0   0    18   0  42    39    47   352   0     20
6     9     0   0     4   0   0  1874     6     1   0     13
7     0    61   1   150   0   0     6  7016    24   0      5
8     2     5   2   164   0   0     1    75  2989   0     58
9    46     0   2     6   0   1    32   318    46   0     42
10    5     6   1    20   0   0    18    94    10   0  12637
---- Validation: 
scalar performance:
{'acc': 0.92702955, 'precision': 0.7246146, 'recall': 0.6331202, 'specificity': 0.99165916, 'f1': 0.6358452, 'auroc': 0.9595167}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   414     0   0     1   0   0     2    42     2   0     22
1     0  1311   0     7   0   0     0    12     2   0      0
2    13     0  71     7   0   0     2   180    17   0     22
3     0     5   0  8316   0   1     1    84    33   0      0
4     6     1  16    30   0   0     0    80    39   0    367
5     1     0   1    21   0  38    35    49   349   0     27
6     6     1   0     3   0   0  1880     4     1   0     13
7     0    60   1   163   0   0     3  7009    22   0      7
8     1    11   2   178   0   1     2    83  2959   0     59
9    49     0   5     6   0   4    30   317    38   0     44
10    9     3   0    20   0   0    18    78     9   0  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6468201, 'precision': 0.56245273, 'recall': 0.49937576, 'specificity': 0.9649388, 'f1': 0.44312114, 'auroc': 0.8276765}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   952     3   0   37   0   0    32   131     7   0     8
1     0  1375   0   40   0   0     4    74     0   0     6
2    20     4  24  120   0   0    12   347   229   0   259
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0    3   0   0    22    23    11   0  1573
5     2     0   0  208   0   7     7    72   111   0   185
6     0     1   0    5   0   0  3059     0     1   0     1
7     0     1   0  110   0   0     1  1050     0   0     2
8     0     1   0  220   0   0     2     3  1140   0     4
9    44     9  12  378   0   0     9   437   108   0   140
10    0     0   0    0   0   0     5     3     0   0  1638
early stop counter: 3
val acc:0.927029550075531, best validation acc: 0.9301591515541077, corresponding to test acc:                         0.6498286128044128 / 0.6580144166946411
after epoch: 9,now: 2024-07-30 17:51:41.189553,epoch time: 1:48:39.051201,used: 14:55:09.513385,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.92190176, 'precision': 0.71891475, 'recall': 0.6209222, 'specificity': 0.9909527, 'f1': 0.6242839, 'auroc': 0.9609117}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   408     1   0     3   0   0     9    19     0   0     43
1     0  1292   0     7   0   0     3    19     9   0      2
2     3     0  64     6   0   0     2   181    19   0     37
3     1     2   0  8266   0   1     6    56    98   0     10
4     0     0   8    20   0   0     0    39    37   0    435
5     0     1   0     8   0   3    54    47   388   0     20
6     6     0   0     2   0   0  1875     6     1   0     17
7     0    19   0   262   0   0     3  6832   129   0     18
8     0     1   0   107   0   0     8    45  2985   0    149
9    16     0   2     0   0   1    26   355    42   0     51
10    5     1   0    12   0   0     7    23    11   0  12732
---- Validation: 
scalar performance:
{'acc': 0.92143905, 'precision': 0.7128535, 'recall': 0.62027293, 'specificity': 0.9909142, 'f1': 0.62250227, 'auroc': 0.96149254}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   405     2   0     0   0   0     6    25     0   0     45
1     0  1301   0     7   0   0     1    18     4   0      1
2     4     0  61     3   0   0     3   184    21   0     36
3     0     3   0  8249   0   3     5    56   118   0      6
4     2     1   8    31   0   0     1    37    32   0    427
5     2     0   0     6   0   4    39    44   406   0     20
6     9     0   0     0   0   0  1878     1     1   0     19
7     0    15   1   283   0   0     3  6817   130   0     16
8     1     3   0    91   0   0     6    41  2997   0    157
9    20     0   1     1   0   0    28   363    36   0     44
10    4     3   1    15   0   0     7    21     9   0  12736
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62967885, 'precision': 0.5581049, 'recall': 0.48027706, 'specificity': 0.96268195, 'f1': 0.42290726, 'auroc': 0.83311623}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   922     0   0    5   0   0   107  112     2   0    22
1     1  1299   0   38   0   0     5  138     7   0    11
2     1     0  22   43   0   0     8  228   186   0   527
3     0     0   0    0   0   0     0    0     0   0     0
4     0     0   0    2   0   0    10    8    11   0  1602
5     2     0   0   31   0   1    21   95   253   0   189
6     0     0   0    1   0   0  3056    0     5   0     5
7     2     0   0  300   0   0    12  843     2   0     5
8     0     1   0  101   0   0     7   11  1215   0    35
9     9     3   7   59   0   0    11  608   146   0   294
10    0     0   0    0   0   0     4    0     0   0  1642
early stop counter: 4
val acc:0.9214390516281128, best validation acc: 0.9301591515541077, corresponding to test acc:                         0.6498286128044128 / 0.6580144166946411
after epoch: 10,now: 2024-07-30 19:44:12.662424,epoch time: 1:52:31.472871,used: 16:47:40.986256,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 16:47:40.986256 at 2024-07-30 19:44:12.662424
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6498286, 'precision': 0.46179205, 'recall': 0.5070368, 'specificity': 0.9649224, 'f1': 0.43843463, 'auroc': 0.8274292}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1035     2   0   24   0   0    26    69    11   0     3
1      0  1313   0   36   0   0     4   136     4   0     6
2    104     8   3   19   0   8    20   279   266   0   308
3      0     0   0    0   0   0     0     0     0   0     0
4      4     0   0    0   0   2     3     8    19   0  1597
5     51     0   1  134   0  42    65   108   180   0    11
6      0     1   0   26   0   1  3025     2     9   0     3
7      1     0   0  125   0   0     1  1031     2   0     4
8      1     0   0  154   0   4     2    15  1194   0     0
9    210     9  10  169   0  11    65   433   200   0    30
10     0     0   0    0   0   0     0     0     1   0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6580144, 'precision': 0.48974413, 'recall': 0.51133823, 'specificity': 0.9656825, 'f1': 0.43576366, 'auroc': 0.82810587}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1029     2   0   18   0   0     8    84    21   0     8
1      0  1338   0   31   0   0     0   117     7   0     6
2     34     7   0   41   0   0     8   170   303   0   452
3      0     0   0    0   0   0     0     0     0   0     0
4      2     0   0    5   0   0     5     3    14   0  1604
5     16     0   0   95   0   1    15    52   385   0    28
6      0     1   0   24   0   0  3028     2     8   0     4
7      2     0   0   83   0   0     0  1072     2   0     5
8      0     0   0   66   0   0     0    10  1294   0     0
9     81     8   2  170   0   0    14   366   376   0   120
10     0     0   0    2   0   0     0     0     1   0  1643
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_02_56_30_seed_1_23205569_instance_wise_predictions.txt
accuracy from prediction file 0.6498285874204156
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/31.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/31.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |   1648 MiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      7 MiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |   1648 MiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      7 MiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB |   1633 TiB |   1633 TiB |
|       from large pool |   1647 MiB |  19328 MiB |   1622 TiB |   1622 TiB |
|       from small pool |      6 MiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20092 MiB |  20112 MiB |  38322 MiB |  18230 MiB |
|       from large pool |  20058 MiB |  20078 MiB |  38276 MiB |  18218 MiB |
|       from small pool |     34 MiB |     34 MiB |     46 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231478 KiB | 783421 KiB | 235188 GiB | 235188 GiB |
|       from large pool | 216320 KiB | 781120 KiB | 223333 GiB | 223333 GiB |
|       from small pool |  15158 KiB |  20690 KiB |  11855 GiB |  11855 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |  107209 K  |  107206 K  |
|       from large pool |     247    |     691    |   54563 K  |   54563 K  |
|       from small pool |    2419    |    3627    |   52646 K  |   52643 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |  107209 K  |  107206 K  |
|       from large pool |     247    |     691    |   54563 K  |   54563 K  |
|       from small pool |    2419    |    3627    |   52646 K  |   52643 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     565    |     566    |    1027    |     462    |
|       from large pool |     548    |     549    |    1004    |     456    |
|       from small pool |      17    |      17    |      23    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     117    |    1251    |   61452 K  |   61452 K  |
|       from large pool |      95    |     367    |   37601 K  |   37601 K  |
|       from small pool |      22    |    1157    |   23851 K  |   23850 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |  16640 KiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      0 KiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |  16640 KiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      0 KiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |   1633 TiB |   1633 TiB |
|       from large pool |  16640 KiB |  19328 MiB |   1622 TiB |   1622 TiB |
|       from small pool |      0 KiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20112 MiB |  38322 MiB |  36440 MiB |
|       from large pool |   1860 MiB |  20078 MiB |  38276 MiB |  36416 MiB |
|       from small pool |     22 MiB |     34 MiB |     46 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 783421 KiB | 235189 GiB | 235189 GiB |
|       from large pool |  24320 KiB | 781120 KiB | 223334 GiB | 223334 GiB |
|       from small pool |      0 KiB |  20690 KiB |  11855 GiB |  11855 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |  107209 K  |  107209 K  |
|       from large pool |       2    |     691    |   54563 K  |   54563 K  |
|       from small pool |       0    |    3627    |   52646 K  |   52646 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |  107209 K  |  107209 K  |
|       from large pool |       2    |     691    |   54563 K  |   54563 K  |
|       from small pool |       0    |    3627    |   52646 K  |   52646 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     566    |    1027    |     923    |
|       from large pool |      93    |     549    |    1004    |     911    |
|       from small pool |      11    |      17    |      23    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   61453 K  |   61453 K  |
|       from large pool |       3    |     367    |   37601 K  |   37601 K  |
|       from small pool |       0    |    1157    |   23851 K  |   23851 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 30 19:53:43 2024]
Finished job 0.
1 of 1 steps (100%) done
