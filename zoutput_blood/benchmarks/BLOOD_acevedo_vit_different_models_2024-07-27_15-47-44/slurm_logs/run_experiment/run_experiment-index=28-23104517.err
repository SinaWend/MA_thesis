Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 20:13:06 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/28.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=28
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517

 Experiment start at: 2024-07-27 20:20:35.583160
before training, model accuracy: 0.12012873589992523
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.944162, 'precision': 0.8811703, 'recall': 0.81629235, 'specificity': 0.9938719, 'f1': 0.8379188, 'auroc': 0.9960718}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   358     0    0     3    0    0    43     6     8    2     62
1     0  1257    0    15    0    0     1    49     4    0      6
2     1     0  181     0   28    0     2     7     8   76      9
3     1     1    0  7837    0   21     7   320   247    1      1
4     1     0   22     0  272    1     2     2    26   16    197
5     1     0    2    30    0  295     2     0    14  176      1
6     7     0    0     0    0    0  1866     7     5    3     19
7     0    13    2   110    2    0     4  7043    72    3     16
8     0     0    4    61    8    1     8    84  3066    5     58
9     2     0   26     5    0   26     4     4     8  415      3
10    8     0    2     8   14    0    16    14    32    1  12699
---- Validation: 
scalar performance:
{'acc': 0.94348, 'precision': 0.8802622, 'recall': 0.81934184, 'specificity': 0.9937883, 'f1': 0.8394509, 'auroc': 0.9960771}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   375     0    0     2    0    0    34     4     5    7     56
1     0  1241    0    11    0    0     1    68     5    0      6
2     3     0  192     0   23    1     3     7     4   68     11
3     1     1    0  7843    0   12    17   323   240    3      0
4     1     0   28     0  252    1     4     5    29   11    208
5     1     0    2    25    0  308     0     0    12  172      1
6     5     0    0     1    0    0  1872     1     6    1     22
7     0    11    1   123    3    0     3  7018    88    3     15
8     1     0    7    54    8    2     4    85  3067    5     63
9     2     0   33     4    1   26     3     2    10  410      2
10    3     1    3     6   16    1    24    14    32    2  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74700904, 'precision': 0.67397755, 'recall': 0.63986677, 'specificity': 0.9743198, 'f1': 0.6251532, 'auroc': 0.8881765}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1048     0    0   2    0    0    83    11     9   11     6
1      1  1233    0  26    0    0     2   192     4    7    34
2     19     3  207   7  183   21    59    45   209  115   147
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    2   0  237    0     4     1    15    0  1372
5     39     0    0  20    1  375    13     0    14  129     1
6      0     0    0   1    1    0  3018     4    29    0    14
7      4     2    0  30    0    1    17  1104     0    1     5
8      1     0    1  45    1    4    34     7  1271    4     2
9     50    11  109  47    4  132    26    79   105  554    20
10     0     0    0   0   16    0     0     0     0    0  1630
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 21:31:28.012174,epoch time: 1:10:52.429014,used: 1:10:52.429014,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9535531, 'precision': 0.88981247, 'recall': 0.84911865, 'specificity': 0.9948169, 'f1': 0.8614182, 'auroc': 0.99756867}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     0    1     2    2    0     8     0     0    3     63
1     0  1251    0     9    0    0     0    56     6    1      9
2     2     0  247     0   31    1     1     2     1   21      5
3     1     0    1  8103    1    7     2   194   125    2      1
4     1     0   29     0  348    0     2     2     6    4    147
5     2     0    3    42    0  270     0     0     4  199      1
6    11     0    0     3    1    0  1857     4     1    1     29
7     0     3    2   141    1    0     1  7025    52    5     34
8     0     0    8    74    9    1     2    76  3025    3     97
9     1     0   72     5    4    9     1     3     3  391      4
10    2     0    3     6   42    0     6     4    10    2  12719
---- Validation: 
scalar performance:
{'acc': 0.9549552, 'precision': 0.89230484, 'recall': 0.8492187, 'specificity': 0.99497306, 'f1': 0.8628819, 'auroc': 0.9975782}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    0     1    1    0     3     4     1    3     65
1     0  1245    0    12    0    0     0    59     5    0     11
2     1     0  238     0   30    1     1     4     2   29      6
3     0     0    3  8128    0    6     3   179   118    2      1
4     0     0   27     0  353    0     0     2     6    6    145
5     1     0    1    46    0  274     0     0     6  192      1
6     7     0    1     3    2    0  1872     0     1    1     21
7     0     4    5   150    1    0     2  7015    52    5     31
8     3     0    7    74   15    0     0    55  3048    2     92
9     0     0   75     3    2   10     1     1     6  392      3
10    1     0    1     7   36    0     7     6     5    2  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.727559, 'precision': 0.6753297, 'recall': 0.6077765, 'specificity': 0.97271156, 'f1': 0.6127838, 'auroc': 0.8861221}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1084     0    0   12    0    0    30    7     4   18    15
1      2  1187    1   32    1    0     2  200     2    5    67
2      4     0  226   15  304    4     7   15   119   62   259
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    5    0  271    0     1    1     6    0  1349
5     12     0    0  121    2  230     9    0    13  204     1
6      0     0    0    2    1    0  3006    3     3    0    52
7      3     0    0  177    0    0     1  973     2    2     6
8      0     0    1   69    4    0     8    4  1273    4     7
9     18     1  231  117   11   44    11   35   121  512    36
10     0     0    0    0    9    0     0    0     0    0  1637
better model found
persisted
after epoch: 2,now: 2024-07-27 22:40:05.531768,epoch time: 1:08:37.519594,used: 2:19:29.948608,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96211475, 'precision': 0.9117204, 'recall': 0.87688863, 'specificity': 0.99575704, 'f1': 0.89133745, 'auroc': 0.9985204}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     4    2    0     2     4     0    0     30
1     0  1291    0    10    0    0     0    29     1    0      0
2     1     0  235     0   29    0     0     7     2   35      3
3     2     1    0  8310    0    5     1    95    23    1      1
4     1     0   12     0  369    0     1     4    11    4    136
5     2     0    1    34    1  354     0     0     3  125      1
6    11     0    0     7    2    0  1874     0     2    1     10
7     2    12    0   160    2    0     1  7061    17    1      7
8     2     1    5   191   22    0     3   115  2906    0     50
9     0     1   38     8    5   21     1     4     3  408      3
10   11     0    2    12   28    0     8    14     9    0  12711
---- Validation: 
scalar performance:
{'acc': 0.96177614, 'precision': 0.9121394, 'recall': 0.87405074, 'specificity': 0.99570584, 'f1': 0.88998884, 'auroc': 0.99858147}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    1     2    2    0     2     3     1    1     36
1     0  1290    0     8    0    0     0    33     1    0      0
2     2     1  222     0   34    1     0     8     1   37      6
3     2     1    0  8321    0    3     2    86    22    2      1
4     3     1   22     0  365    0     0     3    10    2    133
5     0     0    1    42    1  360     1     0     4  111      1
6     7     0    0     2    0    0  1881     1     2    3     12
7     1    12    1   157    1    0     1  7071    13    1      7
8     1     1    3   199   17    0     2   127  2896    0     50
9     1     0   35     6    2   17     2     3     2  419      6
10    9     1    2    11   36    0     8    19    14    0  12696
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.717624, 'precision': 0.6701683, 'recall': 0.593174, 'specificity': 0.97188926, 'f1': 0.5886788, 'auroc': 0.8851886}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1127     1    0   13    1    0    11    8     1    6     2
1      0  1268    0   28    1    0     2  192     1    0     7
2     12     8  147   28  200    7     4   66   274   42   227
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    1    0  236    0     1    3    13    0  1379
5     19     0    1  179    1  218     4    0    17  136    17
6      3     2    0    2    1    0  3033    3     8    0    15
7      0     1    0  173    0    0     1  986     0    0     3
8      0     0    1  117    0    0     7   14  1228    1     2
9     21    23  107  195    4   54     6  125   175  376    51
10     0     0    0    0    8    0     0    0     0    0  1638
better model found
persisted
after epoch: 3,now: 2024-07-27 23:48:23.466456,epoch time: 1:08:17.934688,used: 3:27:47.883296,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96500427, 'precision': 0.9124486, 'recall': 0.89480495, 'specificity': 0.99623203, 'f1': 0.8995644, 'auroc': 0.99866855}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     1    0     2    1    0     8     0     2    1     15
1     0  1316    0     3    0    0     0     5     7    0      1
2     1     0  184     1   47    1     0     0     1   76      1
3     1     6    1  8263    0    9     2    80    72    4      0
4     5     1    7     0  398    1     1     2    14   11     99
5     1     0    0    14    0  446     0     0     4   55      1
6     7     1    0     1    1    1  1881     1     3    3      9
7     0    92    0   189    2    0     1  6891    76    2     10
8     2     1    1    77    7    6     0    52  3103    7     38
9     2     0    5     4    3   39     1     1     2  436      0
10   16     1    3     7   49    0     4     6     9    1  12697
---- Validation: 
scalar performance:
{'acc': 0.9651197, 'precision': 0.91446704, 'recall': 0.89611846, 'specificity': 0.99624395, 'f1': 0.90096724, 'auroc': 0.9987887}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     1    0    1     7     0     0    3     14
1     0  1319    0     4    0    0     0     4     4    0      1
2     3     0  184     0   48    2     0     1     2   72      0
3     1    11    0  8257    2   19     0    67    82    1      0
4     5     0    3     0  407    2     0     2    12    7    101
5     0     0    0    12    0  442     0     0     3   63      1
6     6     0    0     2    1    0  1879     0     2    2     16
7     1   102    3   175    2    0     2  6880    85    3     12
8     0     1    0    89    6    2     1    40  3111    6     40
9     1     0    7     4    0   43     0     0     4  434      0
10   12     1    1     7   36    0     8     3    15    2  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75204647, 'precision': 0.66400254, 'recall': 0.64140284, 'specificity': 0.9748927, 'f1': 0.61995125, 'auroc': 0.8809709}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1103     1   0   5    0    0    15     4     7   26     9
1      1  1410   0  13    1    3     0    35    12    0    24
2      6     3  93   3  310   11     2    13   246  101   227
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0  138    0     1     0    14    0  1479
5      8     0   0  23    0  348     1     0    23  186     3
6      0     0   0   0    1    0  2994     2    11    0    59
7      1    15   0  34    0    1     7  1092     6    1     7
8      0     0   0  17    0    5     5     3  1336    3     1
9     18     7  73  29   18   91     4    25   247  591    34
10     0     0   0   0    2    0     0     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 00:56:39.597471,epoch time: 1:08:16.131015,used: 4:36:04.014311,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96706444, 'precision': 0.9298135, 'recall': 0.8695773, 'specificity': 0.9963652, 'f1': 0.88768244, 'auroc': 0.999063}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     1    1    0     5     7     0    3     22
1     0  1277    0    10    0    0     0    38     4    0      2
2     1     0  130     1   41    1     0     7     5  121      5
3     1     1    0  8341    0    1     1    40    50    1      0
4     4     0    0     0  352    1     0     4    26    8    144
5     0     0    0    25    0  443     0     0     9   43      1
6     8     0    0     2    2    0  1869     2     5    0     20
7     0     3    0   209    1    0     1  6938   108    0      4
8     1     0    2    66    3    0     2    16  3191    0     15
9     0     0    2     5    0   45     0     1     6  434      0
10    3     0    1     7   17    0     2     6    28    3  12726
---- Validation: 
scalar performance:
{'acc': 0.96739334, 'precision': 0.9319369, 'recall': 0.8747088, 'specificity': 0.9963986, 'f1': 0.89216524, 'auroc': 0.9990432}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     2    1    0     3     3     1    3     30
1     0  1283    0     7    0    0     0    36     5    0      1
2     1     0  140     1   37    1     0     4     5  115      8
3     3     1    0  8357    0    0     0    33    46    0      0
4     3     0    0     0  378    1     0     2    20    8    127
5     0     0    0    27    1  431     0     0     7   54      1
6    11     0    0     3    2    0  1859     2     4    3     24
7     0     6    0   192    1    0     1  6965    94    1      5
8     1     0    0    88    1    0     0    26  3162    3     15
9     0     0    2     7    2   36     0     0     5  441      0
10    4     0    0     8   26    0     2    12    31    3  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69656473, 'precision': 0.6761943, 'recall': 0.5885935, 'specificity': 0.96964115, 'f1': 0.56995714, 'auroc': 0.87849057}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1042     0   0   17    0    0     5    54    15   23    14
1      0  1182   0   29    1    0     0   252     9    0    26
2     18     1  98   19   79    5     0    67   373   87   268
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   1    0  105    0     1     3    21    0  1502
5      4     0   0  173    0  268     0     0    34  110     3
6     10     0   0   10    1    0  2795     8    37    0   206
7      0     0   0   41    0    0     0  1122     0    0     1
8      0     0   0   97    0    0     1    14  1256    1     1
9     15     0  37  149    2   64     0   124   268  446    32
10     0     0   0    0    3    0     0     1     0    0  1642
better model found
persisted
after epoch: 5,now: 2024-07-28 02:05:01.157266,epoch time: 1:08:21.559795,used: 5:44:25.574106,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97782, 'precision': 0.92819947, 'recall': 0.93533564, 'specificity': 0.99766105, 'f1': 0.93126386, 'auroc': 0.99936473}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     1    0     1    2    0     8     2     0    2      7
1     0  1324    0     1    0    0     0     6     1    0      0
2     0     0  282     0   16    1     0     0     0   12      1
3     0     8    1  8259    0   17     0    82    67    3      0
4     5     0   13     0  439    0     1     1    11    1     68
5     0     0    2     2    0  458     0     0     3   55      1
6     3     0    0     0    0    1  1897     2     2    0      3
7     0    29    2    55    1    0     3  7131    33    0      9
8     2     1    4    31    7    2     1    35  3198    1     14
9     0     0   52     0    1   30     0     0     2  408      0
10   24     1    3     8   39    1    11     2    11    1  12691
---- Validation: 
scalar performance:
{'acc': 0.9768624, 'precision': 0.92858696, 'recall': 0.93630695, 'specificity': 0.99754965, 'f1': 0.9317368, 'auroc': 0.99930525}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     1    1    0     6     4     0    1      9
1     0  1321    0     1    0    0     0     9     1    0      0
2     0     0  284     1   15    2     0     0     1    9      0
3     1     4    2  8240    0   16     1    85    84    7      0
4     8     0   12     0  446    1     1     0     6    3     62
5     0     0    0     4    0  467     0     0     3   46      1
6     5     1    1     0    0    0  1889     2     2    1      7
7     0    22    3    76    1    0     4  7112    41    2      4
8     2     1    5    42    7    0     0    26  3196    0     17
9     0     0   60     2    2   27     1     0     1  400      0
10   22     0    3     6   34    0    11     4    11    1  12704
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76631916, 'precision': 0.6970752, 'recall': 0.65500116, 'specificity': 0.9761551, 'f1': 0.64670354, 'auroc': 0.8852458}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   980     2    1   6    0    1   118    36    11   12     3
1     0  1413    1  11    0    0     1    54     4    4    11
2     6     3  304   5  148    7    71    29   152   84   206
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    5   0  147    0     6     0    11    1  1463
5     3     0    5  39    1  318    11     0    10  203     2
6     0     0    0   1    0    0  3059     2     1    0     4
7     0     2    0  10    0    0     3  1141     1    3     4
8     0     0    2  29    0    3    26    15  1286    6     3
9     5     8  180  45    3   61    28    33    89  667    18
10    0     0    0   0    4    0     4     0     0    0  1638
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-28 03:13:27.387516,epoch time: 1:08:26.230250,used: 6:52:51.804356,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97693706, 'precision': 0.9403753, 'recall': 0.93748426, 'specificity': 0.9974737, 'f1': 0.93680173, 'auroc': 0.9995912}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     2    3    0     4     0     0    3     12
1     0  1325    0     2    0    0     0     4     1    0      0
2     0     0  294     0    6    0     0     0     0   12      0
3     0     2    0  8402    0    2     0    17    13    2      0
4     1     0   20     1  450    0     0     0     7    0     60
5     0     0    0    15    0  404     2     0     0   98      1
6     2     0    0     1    0    0  1895     0     1    0      8
7     0    20    8   152    5    0     3  7034    34    2      5
8     0     1    9   148    8    0     1    21  3079    4     24
9     0     0   24     3    1    7     0     0     1  457      0
10    3     0    6     8   42    0     7     4     9    0  12715
---- Validation: 
scalar performance:
{'acc': 0.97734386, 'precision': 0.94260585, 'recall': 0.9409021, 'specificity': 0.9975089, 'f1': 0.93977267, 'auroc': 0.99961525}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     0    4    0     7     0     1    3     10
1     0  1322    0     5    0    0     0     5     0    0      0
2     0     0  298     1    1    0     0     0     0   12      0
3     0     1    0  8410    0    1     2    14    11    0      1
4     1     0   21     0  456    0     0     0     3    0     58
5     0     0    1    18    0  415     0     0     0   86      1
6     2     0    2     2    0    0  1895     0     0    0      7
7     0    20    7   166    6    0     1  7030    26    5      4
8     0     2    5   152    8    0     0    17  3084    3     25
9     0     0   29     2    1    4     1     0     0  456      0
10    7     0    4     7   42    0     6     2    14    0  12714
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7282586, 'precision': 0.7044955, 'recall': 0.6018106, 'specificity': 0.97278714, 'f1': 0.6118077, 'auroc': 0.8841701}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   861     1    6   19    1    1   220    29     3   23     6
1     3  1304    0   31    2    0     1   132     3    4    19
2     2     2  456   38  131    3    17    22   184   70    90
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0   13    0  244    0     5     0    23    1  1347
5     1     0   25  177    0  117     6     0     0  264     2
6     1     0    0    1    0    0  3037     3     5    1    19
7     1     0    0  126    0    0     2  1026     1    3     5
8     0     0    3  210    0    0    14    11  1124    5     3
9     2     5  199  187    2   23    15    38    47  606    13
10    0     0    0    0    9    0     2     0     1    0  1634
better model found
persisted
after epoch: 7,now: 2024-07-28 04:21:49.378232,epoch time: 1:08:21.990716,used: 8:01:13.795072,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9811109, 'precision': 0.9649015, 'recall': 0.9409193, 'specificity': 0.9978975, 'f1': 0.9520845, 'auroc': 0.9996948}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     2    2    0     2     1     2    1      3
1     0  1296    0    13    0    0     0    22     1    0      0
2     1     0  276     3    8    0     0     5     7   12      0
3     0     1    0  8402    0    1     0    16    16    0      0
4     4     0   10     0  431    0     0     0    24    1     69
5     0     0    0    23    0  468     0     0    10   18      1
6     2     0    0     2    0    0  1898     0     1    0      5
7     0     2    0   192    0    0     2  7042    24    0      3
8     0     0    0    47    0    0     1     4  3241    0      1
9     0     0   22     6    0   25     0     0     5  435      0
10    2     0    1     7    9    0     6    12    46    0  12711
---- Validation: 
scalar performance:
{'acc': 0.98087466, 'precision': 0.9660176, 'recall': 0.9399705, 'specificity': 0.99786437, 'f1': 0.9521496, 'auroc': 0.9997014}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     2    2    0     4     0     1    1      3
1     0  1296    0    12    0    0     0    23     1    0      0
2     0     0  274     1   10    0     0     6    11   10      0
3     0     0    0  8409    0    0     0    12    19    0      0
4     2     0    4     0  430    0     1     2    24    2     74
5     0     0    0    19    0  472     0     0     6   23      1
6     1     0    0     1    0    0  1898     0     3    0      5
7     0     1    0   190    0    0     2  7045    22    0      5
8     0     0    0    51    0    0     0    17  3226    0      2
9     0     0   23     5    0   23     1     2     6  433      0
10    2     0    3     7    7    0     4     7    49    0  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67851394, 'precision': 0.6506833, 'recall': 0.5657686, 'specificity': 0.96768415, 'f1': 0.55755234, 'auroc': 0.8722532}
confusion matrix:
     0     1    2    3   4    5     6    7     8    9     10
0   876     0    0    8   3    0   237   20     3   19     4
1     2  1122    0   33   1    0     3  299    11    1    27
2    11     1  160   35  88   11    26   43   418   68   154
3     0     0    0    0   0    0     0    0     0    0     0
4     0     0    4    0  60    0     2    1    43    0  1523
5     4     0    2  144   0  287     3    0    21  125     6
6     1     0    0    4   0    0  2940    3    36    0    83
7     0     0    0  207   0    0     7  943     1    1     5
8     0     0    0  102   0    1     9   10  1247    1     0
9     9     6   52  201   2   89    15   70   250  422    21
10    0     0    0    0   2    0     1    0     2    0  1641
better model found
persisted
after epoch: 8,now: 2024-07-28 05:30:16.429661,epoch time: 1:08:27.051429,used: 9:09:40.846501,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9875321, 'precision': 0.96776974, 'recall': 0.96142364, 'specificity': 0.99865425, 'f1': 0.96406674, 'auroc': 0.99983704}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    0    0     1     0     0    1      5
1     0  1311    0     2    0    0     0    17     0    0      0
2     0     0  284     0    5    0     0     0     1   21      1
3     0     0    1  8370    0    3     0    32    27    2      0
4     3     0   10     0  484    0     0     0     3    1     38
5     0     0    0     2    0  515     0     0     1    2      1
6     4     0    0     3    1    0  1891     1     1    0      7
7     0     1    2    66    0    0     0  7156    35    1      3
8     0     0    0    28    3    0     0    10  3253    0      2
9     0     0    5     0    1   63     0     0     1  423      0
10    2     0    1     6   10    0     4     4    19    1  12748
---- Validation: 
scalar performance:
{'acc': 0.98740137, 'precision': 0.96880317, 'recall': 0.96154964, 'specificity': 0.9986376, 'f1': 0.9648519, 'auroc': 0.99984473}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     1    1    1     0     0     0    0      7
1     0  1317    0     4    0    0     0    11     0    0      0
2     0     0  280     0    5    0     0     0     2   25      0
3     1     0    0  8379    0    4     0    29    25    2      0
4     4     0    7     0  488    0     0     0    10    0     30
5     0     0    0     4    0  509     0     0     2    5      1
6     4     0    0     5    0    0  1887     2     2    0      8
7     0     1    2    76    0    0     0  7152    30    0      4
8     1     0    0    33    2    0     0     6  3253    0      1
9     0     0    8     0    0   48     0     0     2  435      0
10    2     0    1     7    9    0     3     8    24    0  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.707829, 'precision': 0.66493225, 'recall': 0.6038321, 'specificity': 0.9708453, 'f1': 0.56983006, 'auroc': 0.87555695}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1028     0    0    7    0   19    50    43     8   11     4
1      1  1150    1   30    0    3     6   286     4    2    16
2      8     2  127   30  101   66    36    53   375   47   170
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    5    0  153    0     5     1    43    0  1426
5      3     0    0  112    0  449     2     0     9   15     2
6      1     0    0    2    0    0  3026     4    12    0    22
7      0     0    1   42    0    0     0  1115     1    1     4
8      0     0    0  140    0    4    15    14  1196    1     0
9      5     5   45  161    3  419    11    67   163  234    24
10     0     0    0    0    3    0     3     0     1    0  1639
better model found
persisted
after epoch: 9,now: 2024-07-28 06:39:01.008343,epoch time: 1:08:44.578682,used: 10:18:25.425183,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98662245, 'precision': 0.96360373, 'recall': 0.9646949, 'specificity': 0.99859816, 'f1': 0.96390045, 'auroc': 0.9998325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    1     1    2    0    21     2     1    1      0
1     0  1294    0     1    0    0     0    33     2    0      0
2     1     0  300     0    5    0     2     1     1    2      0
3     0     0    0  8318    0   11     0    51    57    0      0
4     2     0    6     0  510    0     0     2     2    1     16
5     0     0    2     4    0  482     0     0     2   30      1
6     0     0    0     0    0    0  1902     2     0    0      4
7     0     0    0    53    2    0     1  7179    27    0      2
8     0     0    1     3    8    0     0     7  3269    0      8
9     0     0   26     1    0   13     3     0     2  448      0
10    6     0    2     7   22    0    19     8     9    0  12720
---- Validation: 
scalar performance:
{'acc': 0.98761535, 'precision': 0.96421075, 'recall': 0.9664171, 'specificity': 0.998695, 'f1': 0.9650277, 'auroc': 0.9998626}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    1     0    1    0    16     0     0    0      2
1     0  1291    0     2    0    0     0    38     1    0      0
2     0     0  300     0    4    0     1     2     1    3      1
3     0     0    1  8348    0    6     0    38    46    0      1
4     3     0    3     0  513    0     1     1     1    0     17
5     0     0    1     2    0  485     0     0     2   30      1
6     0     0    0     0    0    0  1903     0     0    0      5
7     0     1    1    51    0    0     1  7185    23    0      3
8     0     0    0     5    4    0     0     9  3271    0      7
9     0     0   32     1    1   14     2     1     0  442      0
10   12     0    5     7   21    0    16     6     8    0  12721
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71573496, 'precision': 0.6824119, 'recall': 0.60170376, 'specificity': 0.9711492, 'f1': 0.5899923, 'auroc': 0.8831177}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   877     0    0    7    0    3   202    48    13   20     0
1     0  1123    0   23    1    0     2   321     8    4    17
2    11     0  167   28   88   16   133    71   359   83    59
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    7    0  237    0    17     3    33    0  1336
5    10     0    0   97    1  318     5     0    15  145     1
6     0     0    0    3    0    0  3029     3    22    0    10
7     0     2    0   35    0    0     2  1121     0    0     4
8     1     0    1   81    0    0    24    16  1243    4     0
9     7     3   36  120    1  146    58   113   165  479     9
10    0     0    0    0    7    0     1     0     2    0  1636
better model found
persisted
after epoch: 10,now: 2024-07-28 07:47:23.085489,epoch time: 1:08:22.077146,used: 11:26:47.502329,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:26:47.502329 at 2024-07-28 07:47:23.085489
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71573496, 'precision': 0.6824119, 'recall': 0.60170376, 'specificity': 0.9711492, 'f1': 0.5899923, 'auroc': 0.8831177}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   877     0    0    7    0    3   202    48    13   20     0
1     0  1123    0   23    1    0     2   321     8    4    17
2    11     0  167   28   88   16   133    71   359   83    59
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    7    0  237    0    17     3    33    0  1336
5    10     0    0   97    1  318     5     0    15  145     1
6     0     0    0    3    0    0  3029     3    22    0    10
7     0     2    0   35    0    0     2  1121     0    0     4
8     1     0    1   81    0    0    24    16  1243    4     0
9     7     3   36  120    1  146    58   113   165  479     9
10    0     0    0    0    7    0     1     0     2    0  1636
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76631916, 'precision': 0.6970752, 'recall': 0.65500116, 'specificity': 0.9761551, 'f1': 0.64670354, 'auroc': 0.8852458}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   980     2    1   6    0    1   118    36    11   12     3
1     0  1413    1  11    0    0     1    54     4    4    11
2     6     3  304   5  148    7    71    29   152   84   206
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    5   0  147    0     6     0    11    1  1463
5     3     0    5  39    1  318    11     0    10  203     2
6     0     0    0   1    0    0  3059     2     1    0     4
7     0     2    0  10    0    0     3  1141     1    3     4
8     0     0    2  29    0    3    26    15  1286    6     3
9     5     8  180  45    3   61    28    33    89  667    18
10    0     0    0   0    4    0     4     0     0    0  1638
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_20_20_35_seed_0_23104517_instance_wise_predictions.txt
accuracy from prediction file 0.715734975162667
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/28.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/28.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/28.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15814 MiB | 677065 GiB | 677063 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 672110 GiB | 672108 GiB |
|       from small pool |      7 MiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15814 MiB | 677065 GiB | 677063 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 672110 GiB | 672108 GiB |
|       from small pool |      7 MiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15770 MiB | 675223 GiB | 675222 GiB |
|       from large pool |   1647 MiB |  15745 MiB | 670272 GiB | 670271 GiB |
|       from small pool |      6 MiB |     26 MiB |   4951 GiB |   4951 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16410 MiB |  16410 MiB |  16410 MiB |      0 B   |
|       from large pool |  16382 MiB |  16382 MiB |  16382 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 225344 KiB | 685765 KiB |  94012 GiB |  94012 GiB |
|       from large pool | 216320 KiB | 683904 KiB |  88851 GiB |  88851 GiB |
|       from small pool |   9024 KiB |  13093 KiB |   5161 GiB |   5161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   44767 K  |   44765 K  |
|       from large pool |     247    |     593    |   22816 K  |   22816 K  |
|       from small pool |    2399    |    3599    |   21951 K  |   21948 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   44767 K  |   44765 K  |
|       from large pool |     247    |     593    |   22816 K  |   22816 K  |
|       from small pool |    2399    |    3599    |   21951 K  |   21948 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     462    |     462    |     462    |       0    |
|       from large pool |     448    |     448    |     448    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     112    |     562    |   25596 K  |   25596 K  |
|       from large pool |      94    |     302    |   15928 K  |   15928 K  |
|       from small pool |      18    |     453    |    9668 K  |    9668 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 677065 GiB | 677065 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 672110 GiB | 672110 GiB |
|       from small pool |      0 KiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 677065 GiB | 677065 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 672110 GiB | 672110 GiB |
|       from small pool |      0 KiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 675223 GiB | 675223 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 670272 GiB | 670272 GiB |
|       from small pool |      0 KiB |     26 MiB |   4951 GiB |   4951 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |  16410 MiB |  16410 MiB |  14534 MiB |
|       from large pool |   1860 MiB |  16382 MiB |  16382 MiB |  14522 MiB |
|       from small pool |     16 MiB |     28 MiB |     28 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 685765 KiB |  94013 GiB |  94013 GiB |
|       from large pool |  24320 KiB | 683904 KiB |  88852 GiB |  88852 GiB |
|       from small pool |      0 KiB |  15459 KiB |   5161 GiB |   5161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44767 K  |   44767 K  |
|       from large pool |       2    |     593    |   22816 K  |   22816 K  |
|       from small pool |       0    |    3599    |   21951 K  |   21951 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44767 K  |   44767 K  |
|       from large pool |       2    |     593    |   22816 K  |   22816 K  |
|       from small pool |       0    |    3599    |   21951 K  |   21951 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     101    |     462    |     462    |     361    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       8    |      14    |      14    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     562    |   25597 K  |   25597 K  |
|       from large pool |       3    |     302    |   15928 K  |   15928 K  |
|       from small pool |       0    |     453    |    9668 K  |    9668 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 677065 GiB | 677065 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 672110 GiB | 672110 GiB |
|       from small pool |      0 KiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 677065 GiB | 677065 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 672110 GiB | 672110 GiB |
|       from small pool |      0 KiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 675223 GiB | 675223 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 670272 GiB | 670272 GiB |
|       from small pool |      0 KiB |     26 MiB |   4951 GiB |   4951 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |  16410 MiB |  16410 MiB |  14534 MiB |
|       from large pool |   1860 MiB |  16382 MiB |  16382 MiB |  14522 MiB |
|       from small pool |     16 MiB |     28 MiB |     28 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 685765 KiB |  94013 GiB |  94013 GiB |
|       from large pool |  24320 KiB | 683904 KiB |  88852 GiB |  88852 GiB |
|       from small pool |      0 KiB |  15459 KiB |   5161 GiB |   5161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44767 K  |   44767 K  |
|       from large pool |       2    |     593    |   22816 K  |   22816 K  |
|       from small pool |       0    |    3599    |   21951 K  |   21951 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44767 K  |   44767 K  |
|       from large pool |       2    |     593    |   22816 K  |   22816 K  |
|       from small pool |       0    |    3599    |   21951 K  |   21951 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     101    |     462    |     462    |     361    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       8    |      14    |      14    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     562    |   25597 K  |   25597 K  |
|       from large pool |       3    |     302    |   15928 K  |   15928 K  |
|       from small pool |       0    |     453    |    9668 K  |    9668 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517

 Experiment start at: 2024-07-28 08:05:29.916075
before training, model accuracy: 0.09438186883926392
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9336205, 'precision': 0.8447172, 'recall': 0.82284206, 'specificity': 0.9929412, 'f1': 0.82713825, 'auroc': 0.9953962}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     1    0     6    0    1    10     9    22    8     36
1     0  1282    0    14    0    0     0    30     4    0      1
2     0     0  190     3   45   10     2    12    13   35      2
3     1     3    1  8254    0   12     0    69    96    1      0
4     2     0   14     3  343    3     0    11    70    8     85
5     0     0    0    41    0  454     0     0     6   20      0
6    11     2    0     8    1    5  1826     2    28    2     23
7     0    43    1   437    2    0     1  6682    89    0      8
8     0     2    2   174    4    0     0    49  3061    0      4
9     0     0   49    11    3  200     1     2    16  210      1
10   10     0    4     7  197    3     9    57   302    1  12203
---- Validation: 
scalar performance:
{'acc': 0.9327805, 'precision': 0.84168977, 'recall': 0.822146, 'specificity': 0.99286187, 'f1': 0.8248766, 'auroc': 0.99523354}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    1     9    1    3     8    10    23    5     29
1     0  1280    0    13    0    0     0    34     4    0      1
2     0     2  192     2   47   10     1    12     8   36      2
3     0     3    0  8243    0   15     0    74   105    0      0
4     2     0   22     2  337    4     0    12    65    7     88
5     0     0    1    36    0  458     0     0     8   18      0
6     9     1    1     7    2    7  1825     7    26    0     23
7     0    42    0   449    1    0     1  6674    94    0      4
8     1     0    3   160    4    2     0    57  3066    0      3
9     0     1   60     9    3  196     0     5    15  203      1
10    7     1    2    10  192    1    11    59   310    3  12200
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6836913, 'precision': 0.66586477, 'recall': 0.59065074, 'specificity': 0.96833014, 'f1': 0.57108724, 'auroc': 0.8802564}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   848     3   0   49    1   16   175    9    31   27    11
1     0  1346   0   39    1    0     0   68    23    0    22
2     1     4  29   13  195   51    14   25   570   43    70
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    0  618    0     1    0    67    1   945
5     3     0   0   76    0  463     2    0    24   21     3
6     0     1   0    2    5    0  2471    5   463    0   120
7     0     2   0  207    0    0     1  934    18    0     2
8     0     0   0   87    0    2     1    0  1279    1     0
9     3    22  19  121   21  294     8   24   396  220     9
10    0     1   0    0   75    0     0    0     6    0  1564
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 09:16:16.447358,epoch time: 1:10:46.531283,used: 1:10:46.531283,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95095783, 'precision': 0.8736341, 'recall': 0.8580152, 'specificity': 0.9947237, 'f1': 0.8592536, 'auroc': 0.9976376}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     0    1    0    17     2     2    2     22
1     0  1296    1     6    0    0     0    26     2    0      1
2     3     0  210     0   46    0     0     6     2   44      1
3     5     4    1  7954    1   15    10   386    54    8      0
4     6     0   16     0  379    0     1     2     5    2    128
5     0     0    1    15    1  289     0     0     4  210      1
6     7     0    0     1    5    1  1880     1     2    1      8
7     1    25    4    58    2    0     5  7152    11    1      5
8     2     6    7    95   36    3    10   192  2895    9     40
9     3     0   53     3    4    4     2     3     1  419      1
10   24     0    4     5   69    0    27    15    15    2  12632
---- Validation: 
scalar performance:
{'acc': 0.9516651, 'precision': 0.878747, 'recall': 0.86239046, 'specificity': 0.9947972, 'f1': 0.86360544, 'auroc': 0.99759215}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     0    4    0    14     3     2    3     16
1     0  1301    1     5    0    0     0    20     4    0      1
2     2     0  223     0   47    0     0     4     2   34      0
3     5     4    0  7952    0   10    10   376    73   10      0
4     7     0   20     0  369    1     2     3     7    2    128
5     0     0    1    15    0  288     0     0     2  214      1
6     6     0    0     0    2    0  1884     3     1    3      9
7     2    14    3    68    3    0     6  7142    18    2      7
8     4     7    9    98   22    4     7   188  2913   10     34
9     3     0   49     2    8    3     0     4     0  424      0
10   24     0    2     6   59    0    27    21    15    1  12641
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7579235, 'precision': 0.67830384, 'recall': 0.63178766, 'specificity': 0.97539645, 'f1': 0.6358324, 'auroc': 0.8833015}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1058     0    1   2    5    0    84     3     1   13     3
1      2  1358    2   9    0    0    10    88     2   10    18
2      3     3  214   3  565    2    22    26    70   51    56
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    4   0  462    0     5     0     5    0  1155
5      8     0    5  33   12  208    12     0     4  302     8
6      0     0    0   1    1    0  3061     2     0    0     2
7      0     1    2  41    0    0     9  1106     0    1     4
8      0     0    2  69   22   11    61    30  1163    9     3
9     11    19  314  21   46   23    18    39    48  584    14
10     0     0    0   0   24    0     3     0     0    0  1619
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 10:24:53.412693,epoch time: 1:08:36.965335,used: 2:19:23.496618,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.947774, 'precision': 0.8939113, 'recall': 0.8592892, 'specificity': 0.9944921, 'f1': 0.86814165, 'auroc': 0.99771565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     5    0    0     8     0    10    0      7
1     0  1295    0    11    0    0     0    20     6    0      0
2     1     1  237     1   16    0     1     2    20   32      1
3     0     4    0  8129    0    7     0   158   140    0      0
4     7     1   26     1  268    1     3     3    90    9    129
5     0     0    0    44    0  344     0     0     7  125      1
6     4     0    0     1    0    0  1891     2     4    1      5
7     0    32    0   159    1    0     2  6881   181    2      5
8     1     0    1    87    1    1     0    29  3173    2      1
9     7     0   53     7    0   15     1     1    18  391      0
10   28     0    3     7   12    1    23     6   347    3  12362
---- Validation: 
scalar performance:
{'acc': 0.9481343, 'precision': 0.88753116, 'recall': 0.85578513, 'specificity': 0.9945394, 'f1': 0.86421824, 'auroc': 0.99765176}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    1     3    0    0    12     0     3    0      7
1     0  1301    0    11    0    0     0    18     2    0      0
2     6     0  226     0   22    0     2     4    23   29      0
3     1     5    0  8149    0    2     0   150   133    0      0
4     6     1   32     1  277    1     0     1    94    4    122
5     2     0    0    41    0  336     0     0     8  133      1
6     4     0    0     3    0    0  1887     1     7    1      5
7     0    37    1   169    1    0     2  6882   168    0      5
8     1     2    2    88    1    1     1    30  3169    0      1
9     7     0   50     8    2   26     2     1    13  383      1
10   31     1    2     9   13    0    23     9   328    1  12379
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70377105, 'precision': 0.6901133, 'recall': 0.5873888, 'specificity': 0.97041607, 'f1': 0.57021725, 'auroc': 0.8789627}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   962     1   0   74   0    0    70    19    32    8     4
1     0  1371   0   33   0    0     3    72    11    0     9
2     3     8  96   29  18    9    21    17   600   81   133
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   3    0  74    0     8     0   113    1  1433
5     4     0   0  199   0  284     1     0    18   84     2
6     0     0   0    1   0    0  2956     3   106    0     1
7     0     2   0   86   0    0     1  1067     5    0     3
8     0     0   0  101   0    0     0     5  1262    1     1
9     5    37  58  200   1   97    14    34   321  353    17
10    0     1   0    0   2    0     2     1     6    0  1634
early stop counter: 1
val acc:0.9481343030929565, best validation acc: 0.9516651034355164, corresponding to test acc:                         0.7579234838485718 / 0.7579234838485718
after epoch: 3,now: 2024-07-28 11:33:34.564163,epoch time: 1:08:41.151470,used: 3:28:04.648088,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96575344, 'precision': 0.92040527, 'recall': 0.86582375, 'specificity': 0.9962096, 'f1': 0.8852768, 'auroc': 0.998721}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    0     0    2    0    12     0     2    1     48
1     0  1283    0     8    0    0     1    28     6    0      5
2     2     0  152     0   77    1     2     4     6   59      9
3     2     1    0  8307    0   12     4    43    70    0      1
4     3     0    2     0  362    1     1     2    20    1    147
5     2     0    0    17    0  489     0     0     2   10      1
6     3     0    0     2    2    0  1877     0     4    0     20
7     4     2    0   185    1    0     2  6957    96    0     13
8     1     0    1    70    2    4     0    23  3180    0     15
9     6     0    8     2    8  102     4     6     3  351      3
10    1     0    0     6   13    1     2     5    44    1  12720
---- Validation: 
scalar performance:
{'acc': 0.96549416, 'precision': 0.91707945, 'recall': 0.86938405, 'specificity': 0.99620456, 'f1': 0.8866968, 'auroc': 0.99872196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     1    3    0    11     1     3    0     43
1     0  1290    0     8    0    0     0    23     5    0      6
2     4     0  162     0   77    2     0     3    10   51      3
3     2     0    0  8300    0   14     1    39    84    0      0
4     3     0    1     0  363    1     0     0    19    0    152
5     2     0    0     9    0  494     0     0     4   10      2
6     2     0    1     1    1    1  1885     0     3    0     14
7     5     7    2   179    3    0     3  6956    98    0     12
8     0     0    1    81    5    5     0    23  3164    0     17
9    10     0   11     1   15  101     0     3     6  345      1
10    3     0    0     7    9    1     4     6    51    0  12715
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7068495, 'precision': 0.6230172, 'recall': 0.5964481, 'specificity': 0.9703084, 'f1': 0.5678867, 'auroc': 0.87364423}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1055     0   0   4    4    0    80     2     4    1    20
1      2  1225   0  24    0    0     4   149     7    0    88
2     12     0  42   3  266   10    18    17   323   22   302
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0   55    0     2     1    16    0  1559
5     25     0   1  70    7  381     3     0    26   53    26
6      0     0   0   1    0    0  3023     2     3    0    38
7      2     0   1  89    0    1     0  1056     6    0     9
8      0     0   0  41    1    1    12    10  1299    3     3
9     46     3  60  54   41  134    24    60   315  321    79
10     0     0   0   0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 4,now: 2024-07-28 12:42:30.696059,epoch time: 1:08:56.131896,used: 4:37:00.779984,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96286386, 'precision': 0.91966534, 'recall': 0.87847626, 'specificity': 0.995832, 'f1': 0.8884507, 'auroc': 0.9989629}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   370     0    0     0    0    0     9     2     2    1     99
1     0  1277    0     6    0    0     0    44     3    0      2
2     0     0  285     0    7    1     1     1     1    7      9
3     0     0    0  8072    0   50     0   149   159    0      8
4     0     0   32     0  333    1     1     3    10    1    158
5     0     0    1     3    0  500     0     0     2   14      1
6     1     0    0     0    0    0  1867     1     3    0     35
7     0     2    2    61    1    0     1  7098    76    0     24
8     0     0    7    14    1    7     0    34  3175    0     56
9     1     0   86     2    0  107     2     1     3  284      7
10    1     0    1     6   16    1     3     5    32    0  12727
---- Validation: 
scalar performance:
{'acc': 0.9621239, 'precision': 0.91883975, 'recall': 0.8783808, 'specificity': 0.995754, 'f1': 0.88971055, 'auroc': 0.9989639}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   373     0    0     1    0    1     3     3     2    2     98
1     0  1269    0     4    0    0     0    49     7    0      3
2     0     0  278     0    9    3     0     1     2    7     12
3     0     0    1  8068    1   51     1   162   149    3      4
4     0     0   32     0  336    0     1     1    13    0    156
5     0     0    1     3    0  498     0     0     1   17      1
6     1     0    0     0    0    0  1860     2     2    0     43
7     0     1    0    67    1    0     1  7092    86    0     17
8     0     0    2    25    3    9     0    36  3175    0     46
9     0     0   75     1    0  107     2     4     1  297      6
10    1     0    0     7   17    1     4     7    36    0  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74092215, 'precision': 0.6816913, 'recall': 0.6382706, 'specificity': 0.9738839, 'f1': 0.62281144, 'auroc': 0.8857381}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1014     0    0  13    2   10    67     8     9   18    29
1      2  1216    0  22    0    1     5   200    11    1    41
2      1     0  246   4  141   25    25    36   289   26   222
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    5   0  331    0     2     1    23    0  1271
5      3     0   10  34    0  472     8     0    10   48     7
6      0     0    0   1    0    0  3018     3     9    0    36
7      1     0    0  98    0    1     0  1052     5    0     7
8      0     0    0  42    0    6    16     7  1293    0     6
9      5     4  252  42    3  182    21   102   168  315    43
10     0     0    0   0   12    0     0     0     1    0  1633
early stop counter: 1
val acc:0.9621238708496094, best validation acc: 0.9654941558837891, corresponding to test acc:                         0.7068495154380798 / 0.7579234838485718
after epoch: 5,now: 2024-07-28 13:51:16.634935,epoch time: 1:08:45.938876,used: 5:45:46.718860,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9758936, 'precision': 0.93255305, 'recall': 0.9388372, 'specificity': 0.9974448, 'f1': 0.93470573, 'auroc': 0.99941367}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    1    0     2     0     0    1      2
1     1  1286    0     1    0    0     1    41     2    0      0
2     2     0  276     0    8    1     0     3     4   18      0
3     5     2    1  8212    1   10     5    75   127    0      1
4     7     0   34     0  422    0     1     3     8    4     59
5     0     0    0     5    0  472     0     0     3   40      1
6     7     0    0     0    0    0  1889     1     0    0      9
7     1     0    0    98    1    0     4  7130    27    1      3
8     3     0    1    17    4    1     3    45  3207    4     11
9     2     0   24     3    1   19     0     2     3  439      0
10   49     0    4     6   31    0     7    10    18    1  12665
---- Validation: 
scalar performance:
{'acc': 0.9756052, 'precision': 0.92897147, 'recall': 0.9324325, 'specificity': 0.99743414, 'f1': 0.9295362, 'auroc': 0.9994255}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    0     6     0     0    0      2
1     0  1284    0     3    0    0     0    42     2    0      1
2     1     0  266     0    9    1     0     1     4   30      0
3     2     2    0  8221    0    6     2    56   150    1      0
4     9     0   38     0  413    0     4     1    10    3     61
5     0     0    0     7    1  471     0     0     3   38      1
6     7     0    1     1    0    0  1893     0     0    1      5
7     4     2    1    96    0    0     5  7128    26    0      3
8     4     0    2     9    7    3     2    37  3219    1     12
9     2     0   29     2    1   24     1     1     2  431      0
10   46     0    2     7   20    0    11     9    26    2  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7113272, 'precision': 0.6568737, 'recall': 0.6010819, 'specificity': 0.9708457, 'f1': 0.59108806, 'auroc': 0.8768139}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1085     0    0    1    0    1    69    6     1    6     1
1      4  1166    0   21    0    0    12  251     5    1    39
2     15     0  154    7  180   19    70   55   264   67   184
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    3    0  182    0     4    3    23    1  1417
5     13     0    1   50    4  380    22    0     6  113     3
6      1     0    0    1    0    0  3046    4     6    0     9
7      1     1    0  306    0    1    13  840     0    0     2
8      0     0    1   53    0    4    73   12  1221    1     5
9     39     4   83   56    9  144    54  111   155  456    26
10     0     0    0    0    5    0     2    1     1    0  1637
better model found
persisted
after epoch: 6,now: 2024-07-28 15:00:10.261022,epoch time: 1:08:53.626087,used: 6:54:40.344947,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9726027, 'precision': 0.94326687, 'recall': 0.9269002, 'specificity': 0.9969872, 'f1': 0.9306564, 'auroc': 0.9995889}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    4    0     1     0     1    1      9
1     0  1297    0    13    0    0     0    18     2    0      1
2     0     0  195     0   33    0     0     6     1   77      0
3     0     0    0  8413    0   11     0     9     6    1      0
4     3     0    0     0  504    0     0     0     3    2     27
5     0     0    0    12    0  476     0     0     0   32      1
6     5     0    0     2    0    0  1885     0     3    2     10
7     1     4    0   300    2    0     1  6925    24    2      6
8     0     0    0   191    8    2     0    17  3060    3     14
9     0     0    2     1    0   33     0     0     1  455      0
10    4     0    3     8   56    1     8     9    25    1  12676
---- Validation: 
scalar performance:
{'acc': 0.97239536, 'precision': 0.9419458, 'recall': 0.92264616, 'specificity': 0.99696696, 'f1': 0.9274205, 'auroc': 0.9995831}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     2    2    0     1     0     0    2      6
1     1  1304    0    10    0    0     0    17     0    0      0
2     0     0  187     2   35    2     0     6     5   73      2
3     0     0    0  8419    0    2     0    12     6    1      0
4     4     0    4     0  492    1     0     0     7    2     29
5     0     0    0     8    0  477     0     0     0   35      1
6     4     0    0     3    1    0  1884     0     0    3     13
7     1     6    0   302    2    0     3  6917    26    2      6
8     0     0    0   186    5    4     0    20  3065    5     11
9     0     0    1     4    1   35     0     0     2  449      1
10    4     0    0     8   60    1     6     8    19    1  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.701952, 'precision': 0.6672952, 'recall': 0.5776394, 'specificity': 0.97055405, 'f1': 0.5869059, 'auroc': 0.8808393}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1057     0   0   40    4    1     6    4     2   51     5
1      7  1204   0   38    1    0     9  198     3    3    36
2      4     1  59   39  457   14    10   27   166  134   104
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   1    0  390    0     4    2    15    1  1220
5      2     0   0  107    5  235     0    0     0  240     3
6      0     0   0    1    3    0  2999    3     5    0    56
7      2     0   0  467    0    1     0  689     0    1     4
8      0     0   0  223   11    7    12    4  1106    4     3
9      4     5  30  161   25  107     3   61    51  672    18
10     0     0   0    0   19    0     4    0     1    0  1622
early stop counter: 1
val acc:0.9723953604698181, best validation acc: 0.9756051898002625, corresponding to test acc:                         0.7113271951675415 / 0.7579234838485718
after epoch: 7,now: 2024-07-28 16:09:08.969847,epoch time: 1:08:58.708825,used: 8:03:39.053772,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9783016, 'precision': 0.9377683, 'recall': 0.93372047, 'specificity': 0.99764097, 'f1': 0.93300664, 'auroc': 0.99960417}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     2    6    0     2     1     1    0      5
1     0  1323    0     3    0    0     0     5     1    0      0
2     0     0  281     0   17    0     0     7     6    0      1
3     1     5    0  8292    0    4     0   119    17    1      0
4     2     0    2     0  492    0     0     0     8    0     34
5     0     0    1    25    0  473     0     0     2   19      1
6     4     0    1     4    1    1  1886     1     0    0     10
7     1    24    0    35    1    0     1  7160    14    0     28
8     1     3    1    62    7    1     0    47  3134    0     39
9     0     0   98     7    2   39     0     4     2  339      2
10   10     1    1     4   41    1     6     1     7    0  12719
---- Validation: 
scalar performance:
{'acc': 0.9790023, 'precision': 0.9429388, 'recall': 0.9409045, 'specificity': 0.99769247, 'f1': 0.9394868, 'auroc': 0.9996263}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    1     2    5    0     3     0     0    0     12
1     0  1328    0     2    0    0     0     2     0    0      0
2     0     0  289     0   14    0     0     1     3    2      3
3     0     3    0  8289    0    5     0   118    24    0      1
4     2     0    4     1  501    0     0     1     5    0     25
5     0     0    4    27    0  475     0     0     2   13      0
6     4     0    0     3    3    1  1886     2     0    0      9
7     0    25    1    35    0    0     0  7158    17    0     29
8     0     1    0    55    6    0     0    44  3126    0     64
9     1     0   89     3    2   33     1     0     2  362      0
10    6     1    1     5   47    0     2     0     8    0  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72224164, 'precision': 0.6713957, 'recall': 0.6111843, 'specificity': 0.9725094, 'f1': 0.6079073, 'auroc': 0.87996155}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1019     1    2   45    5    2    10    66     1   17     2
1      0  1326    0   31    1    0     0   121     2    1    17
2      5    11  195   46  265   32    10    72   240   35   104
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    6    1  371    0     3     2    20    0  1228
5      1     0    1  194    0  357     0     0     2   36     1
6      8     2    0    5    5    0  2935     4    13    0    95
7      0     0    1   81    0    0     0  1080     0    0     2
8      0     0    0  172    1    4     9    32  1144    1     7
9      8    21  165  262   15  190     1   118    71  270    16
10     0     0    0    0   17    0     2     0     1    0  1626
better model found
persisted
after epoch: 8,now: 2024-07-28 17:18:04.327042,epoch time: 1:08:55.357195,used: 9:12:34.410967,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98145866, 'precision': 0.96749187, 'recall': 0.94862396, 'specificity': 0.9978844, 'f1': 0.95727956, 'auroc': 0.99975294}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    0    0     0     1     1    0      7
1     0  1325    0     3    0    0     0     4     0    0      0
2     0     0  272     0    4    1     1     2     5   25      2
3     0     0    0  8405    0    2     0    19    12    0      0
4     7     1    7     0  444    0     0     0     3    4     73
5     0     0    0    11    0  493     0     0     0   15      1
6     2     1    0     3    0    0  1889     1     0    0     11
7     1    15    0   199    1    0     0  7030    12    2      5
8     0     2    0    89    2    1     0    44  3138    1     18
9     0     0    7     2    0   32     1     0     1  450      0
10    4     0    2     8    5    0     2     1     6    0  12765
---- Validation: 
scalar performance:
{'acc': 0.9815969, 'precision': 0.96866345, 'recall': 0.9530663, 'specificity': 0.9979147, 'f1': 0.9601206, 'auroc': 0.9997604}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     3    1    0     1     0     0    0      2
1     0  1325    0     4    0    0     0     3     0    0      0
2     0     0  269     1    6    0     1     0     1   34      0
3     0     0    0  8417    0    2     0    13     8    0      0
4     5     1    5     0  452    0     0     0     7    4     65
5     0     0    0     8    0  500     0     0     0   13      0
6     1     0    0     4    0    0  1894     0     0    0      9
7     0    22    0   197    1    0     2  7013    23    0      7
8     1     0    0    89    1    3     0    52  3130    0     20
9     1     0    3     1    0   24     0     0     0  464      0
10    2     0    0     7   14    0     2     2    10    2  12757
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68830895, 'precision': 0.6641322, 'recall': 0.5781282, 'specificity': 0.9689432, 'f1': 0.5860468, 'auroc': 0.87524414}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1053     0    0   18    1    0    34   15     0   21    28
1      1  1355    0   33    0    0     3   56     1    4    46
2      5     3  186   21  184   11    16   17   174   83   315
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    5    1   88    0     0    1     8    0  1530
5      8     0    1  138    0  269     1    0     3  158    14
6      2     0    0    2    1    0  2813    2     4    0   243
7      1     8    1  470    0    1     0  675     3    1     4
8      0     0    1  131    0    3    32   12  1173    4    14
9     13     9  124  143    4   86    11   33    69  582    63
10     0     0    0    0    0    0     1    0     1    0  1644
better model found
persisted
after epoch: 9,now: 2024-07-28 18:26:38.007124,epoch time: 1:08:33.680082,used: 10:21:08.091049,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.980656, 'precision': 0.95922863, 'recall': 0.9565244, 'specificity': 0.9978959, 'f1': 0.9555579, 'auroc': 0.99979264}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    3    0     0     0     0    0      2
1     0  1320    0     3    0    0     0     8     0    0      0
2     0     0  301     0    2    1     0     0     3    5      0
3     0     0    0  8398    0    2     0    37     1    0      0
4     2     0    9     0  508    1     0     0    11    0      8
5     0     0    0     7    0  514     0     0     0    0      0
6     0     0    0     1    0    0  1902     1     3    0      1
7     0     7    0   214    1    0     0  7032     9    0      2
8     0     0    0   130    0    2     0    24  3138    0      2
9     0     0   21     4    0   97     0     1     3  366      0
10    1     0    3     7   38    1     5     3    36    0  12697
---- Validation: 
scalar performance:
{'acc': 0.9800722, 'precision': 0.9560627, 'recall': 0.95408624, 'specificity': 0.9978365, 'f1': 0.95280844, 'auroc': 0.99977255}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    1     2    3    0     0     0     0    0      4
1     0  1324    0     2    0    0     0     5     1    0      0
2     0     0  300     1    3    0     0     1     2    4      1
3     0     0    0  8393    0    4     0    38     5    0      0
4     1     0    5     2  510    0     0     0    11    2      8
5     0     0    0     7    0  510     0     0     0    3      1
6     0     1    0     0    0    0  1901     1     4    0      1
7     0     5    0   198    1    0     0  7047    11    1      2
8     0     0    1   145    1    1     0    23  3124    0      1
9     0     0   27     2    1   98     1     1     1  362      0
10    4     0    1     8   42    0     4     8    33    0  12696
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7429511, 'precision': 0.68151325, 'recall': 0.63661206, 'specificity': 0.9744203, 'f1': 0.62175256, 'auroc': 0.8814153}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   973     0    1   13    7   50    68    23     7   22     6
1     0  1281    0   29    0    1     3   167     6    0    12
2     0     3  257   26  219   48    16    23   335   23    65
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1   12    1  501    0     9     0    47    0  1062
5     2     0    1   96    0  474     0     0     2   15     2
6     0     0    0    2    1    0  3042     2    18    0     2
7     0     2    1   48    0    1     1  1106     4    0     1
8     0     0    0  163    0    6     8    11  1177    3     2
9     4    15  179  162    7  312     5    55   171  207    20
10    0     0    0    0   39    0     3     1     2    0  1601
early stop counter: 1
val acc:0.9800722002983093, best validation acc: 0.9815968871116638, corresponding to test acc:                         0.6883089542388916 / 0.7579234838485718
after epoch: 10,now: 2024-07-28 19:35:31.913738,epoch time: 1:08:53.906614,used: 11:30:01.997663,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:30:01.997663 at 2024-07-28 19:35:31.913738
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68830895, 'precision': 0.6641322, 'recall': 0.5781282, 'specificity': 0.9689432, 'f1': 0.5860468, 'auroc': 0.87524414}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1053     0    0   18    1    0    34   15     0   21    28
1      1  1355    0   33    0    0     3   56     1    4    46
2      5     3  186   21  184   11    16   17   174   83   315
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    5    1   88    0     0    1     8    0  1530
5      8     0    1  138    0  269     1    0     3  158    14
6      2     0    0    2    1    0  2813    2     4    0   243
7      1     8    1  470    0    1     0  675     3    1     4
8      0     0    1  131    0    3    32   12  1173    4    14
9     13     9  124  143    4   86    11   33    69  582    63
10     0     0    0    0    0    0     1    0     1    0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7579235, 'precision': 0.67830384, 'recall': 0.63178766, 'specificity': 0.97539645, 'f1': 0.6358324, 'auroc': 0.8833015}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1058     0    1   2    5    0    84     3     1   13     3
1      2  1358    2   9    0    0    10    88     2   10    18
2      3     3  214   3  565    2    22    26    70   51    56
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    4   0  462    0     5     0     5    0  1155
5      8     0    5  33   12  208    12     0     4  302     8
6      0     0    0   1    1    0  3061     2     0    0     2
7      0     1    2  41    0    0     9  1106     0    1     4
8      0     0    2  69   22   11    61    30  1163    9     3
9     11    19  314  21   46   23    18    39    48  584    14
10     0     0    0   0   24    0     3     0     0    0  1619
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_08_05_28_seed_1_23104517_instance_wise_predictions.txt
accuracy from prediction file 0.6883089624291612
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/28.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/28.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15814 MiB |   1322 TiB |   1322 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1312 TiB |   1312 TiB |
|       from small pool |      7 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15814 MiB |   1322 TiB |   1322 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1312 TiB |   1312 TiB |
|       from small pool |      7 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15770 MiB |   1318 TiB |   1318 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1309 TiB |   1309 TiB |
|       from small pool |      6 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16390 MiB |  16410 MiB |  30924 MiB |  14534 MiB |
|       from large pool |  16362 MiB |  16382 MiB |  30884 MiB |  14522 MiB |
|       from small pool |     28 MiB |     28 MiB |     40 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 223296 KiB | 685765 KiB | 188049 GiB | 188049 GiB |
|       from large pool | 216320 KiB | 683904 KiB | 177724 GiB | 177723 GiB |
|       from small pool |   6976 KiB |  15459 KiB |  10325 GiB |  10325 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   89533 K  |   89531 K  |
|       from large pool |     247    |     593    |   45632 K  |   45632 K  |
|       from small pool |    2399    |    3599    |   43901 K  |   43898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   89533 K  |   89531 K  |
|       from large pool |     247    |     593    |   45632 K  |   45632 K  |
|       from small pool |    2399    |    3599    |   43901 K  |   43898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     461    |     462    |     822    |     361    |
|       from large pool |     447    |     448    |     802    |     355    |
|       from small pool |      14    |      14    |      20    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     114    |     564    |   51235 K  |   51235 K  |
|       from large pool |      95    |     302    |   31903 K  |   31903 K  |
|       from small pool |      19    |     455    |   19332 K  |   19332 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1312 TiB |   1312 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1312 TiB |   1312 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1318 TiB |   1318 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1309 TiB |   1309 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1874 MiB |  16410 MiB |  30924 MiB |  29050 MiB |
|       from large pool |   1860 MiB |  16382 MiB |  30884 MiB |  29024 MiB |
|       from small pool |     14 MiB |     28 MiB |     40 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 685765 KiB | 188050 GiB | 188050 GiB |
|       from large pool |  24320 KiB | 683904 KiB | 177725 GiB | 177725 GiB |
|       from small pool |      0 KiB |  15459 KiB |  10325 GiB |  10325 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   89533 K  |   89533 K  |
|       from large pool |       2    |     593    |   45632 K  |   45632 K  |
|       from small pool |       0    |    3599    |   43901 K  |   43901 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   89533 K  |   89533 K  |
|       from large pool |       2    |     593    |   45632 K  |   45632 K  |
|       from small pool |       0    |    3599    |   43901 K  |   43901 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     100    |     462    |     822    |     722    |
|       from large pool |      93    |     448    |     802    |     709    |
|       from small pool |       7    |      14    |      20    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     564    |   51236 K  |   51236 K  |
|       from large pool |       3    |     302    |   31903 K  |   31903 K  |
|       from small pool |       0    |     455    |   19332 K  |   19332 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 19:45:51 2024]
Finished job 0.
1 of 1 steps (100%) done
