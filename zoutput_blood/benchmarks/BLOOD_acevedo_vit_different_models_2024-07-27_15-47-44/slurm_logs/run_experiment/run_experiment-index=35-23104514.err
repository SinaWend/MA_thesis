Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 16:16:40 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/35.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=35
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514

 Experiment start at: 2024-07-27 16:27:33.619188
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5528681, 'precision': 0.458647, 'recall': 0.5003128, 'specificity': 0.9560943, 'f1': 0.4282383, 'auroc': 0.93070287}
confusion matrix:
    0     1   2     3   4    5      6     7     8    9   10
0    4     0   0    41   0   23    364     8    30   10   3
1    0  1118   0    50   1    2     26   114    21    0   0
2    0     2   0    14   0   59     81    17    24  112   3
3    0     0   0  8262   0   18      1    82    72    0   0
4    1     0   0     9   0   16    416     2    85    8   2
5    0     0   0   100   0  216      2     0     2  201   0
6    0     0   0    48   0    6   1829     3    19    2   1
7    0     2   0   837   0    4     16  6227   173    2   1
8    0     0   0   451   0   39     59    45  2698    3   0
9    0     0   0    27   0  148      3     1     4  309   1
10   6     0   0    26   0    5  12541    17   196    4   1
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.55356425, 'precision': 0.48783037, 'recall': 0.5012725, 'specificity': 0.9561714, 'f1': 0.42776495, 'auroc': 0.93077296}
confusion matrix:
    0     1   2     3   4    5      6     7     8    9   10
0    3     0   0    39   0   29    369     6    26   10   1
1    0  1118   0    51   0    3     31   107    21    1   0
2    0     2   0    13   0   63     82    15    25  109   3
3    0     0   0  8291   0   17      2    65    65    0   0
4    1     0   0     8   0   24    408     2    82   13   1
5    0     0   0   107   0  211      1     0     1  201   0
6    0     0   0    51   0    6   1831     4    14    2   0
7    0     2   0   852   0    8     12  6203   185    3   0
8    0     0   0   439   0   32     48    53  2717    7   0
9    0     0   0    28   0  138      3     1     6  317   0
10   5     0   0    29   0   11  12526    14   203    4   4
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4651228, 'precision': 0.41082618, 'recall': 0.36408955, 'specificity': 0.94254553, 'f1': 0.3221885, 'auroc': 0.79198855}
confusion matrix:
    0    1   2    3   4    5     6     7     8    9   10
0    1    2   0  231   0  122   702    17     7   85   3
1    0  793   0   79   0   25    81   491    21    8   1
2    0    3   0   67   0  107   368    29   279  157   5
3    0    0   0    0   0    0     0     0     0    0   0
4    0    0   0    0   0    2  1614     0    16    1   0
5    0    0   0   88   0  205     1     0     3  295   0
6    0    0   0   34   0    2  3011     2    17    1   0
7    0    0   0  103   0    3     4  1048     6    0   0
8    0    0   0  308   0   29    14     2  1014    3   0
9    0    7   0  117   0  337    34    35    30  576   1
10   0    0   0    0   0    0  1646     0     0    0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 17:28:32.985592,epoch time: 1:00:59.366404,used: 1:00:59.366404,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9177547, 'precision': 0.72601056, 'recall': 0.6718903, 'specificity': 0.9910803, 'f1': 0.66257435, 'auroc': 0.97993374}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   244     0   0     3   0    3    45    16     7   10    155
1     0  1257   0     8   0    1     6    44     9    0      7
2     1     3   0    93   3    5    46    14     7  116     24
3     1     2   0  7954   0    7     9   292   170    3      1
4     0     0   0    26   2    6   253     6    24    9    213
5     0     0   0    71   0  171     0     0     7  271      1
6     4     1   0     0   0    2  1877     3     7    2     12
7     3    20   0   115   0    1     5  6982   113    7     15
8     0     1   0    77   0    3    13    92  3020    6     83
9     0     1   0    28   0   35     3     3     6  413      4
10    6     1   0     9   0    3   350    11    29    2  12382
---- Validation: 
scalar performance:
{'acc': 0.91879094, 'precision': 0.7281904, 'recall': 0.67495835, 'specificity': 0.9912067, 'f1': 0.6655747, 'auroc': 0.9795496}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   251     1   0     2   0    4    41    19    17    9    139
1     0  1265   0     6   0    2     7    32    11    0      9
2     0     5   0    96   3    6    46    17    11  108     20
3     2     2   0  7922   0    5    19   310   176    2      2
4     1     0   0    19   2    6   259     7    29   10    206
5     0     0   0    70   0  173     0     0     8  269      1
6     6     0   0     1   0    3  1871     2    11    2     12
7     1    28   0   115   0    0     5  6995   103    4     14
8     0     0   0    70   0    0     9    91  3036    5     85
9     0     0   0    28   0   35     3     2     5  417      3
10    6     0   0    10   0    0   326    11    24    2  12417
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68320155, 'precision': 0.5237087, 'recall': 0.5593636, 'specificity': 0.9671936, 'f1': 0.52279836, 'auroc': 0.862471}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   625     2   0   5   0   11   177    59    74  121    96
1     1  1188   0  22   0   24    37   168    20   24    15
2     6     5   0  53   0   44   351    44   229  131   152
3     0     0   0   0   0    0     0     0     0    0     0
4     1     0   0   1   0    2   368     2     9    0  1250
5     0     0   0  49   0  218     8     0    13  304     0
6     0     0   0   0   0    0  3057     3     5    1     1
7     1     0   0  15   0    1    12  1109     8   15     3
8     0     0   0  56   0    8    19     2  1274    5     6
9     1     7   0  81   0  119    31    46   150  680    22
10    0     0   0   0   0    0    32     0     0    0  1614
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 18:28:00.377906,epoch time: 0:59:27.392314,used: 2:00:26.758718,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9220623, 'precision': 0.7320597, 'recall': 0.7012993, 'specificity': 0.99148405, 'f1': 0.6910596, 'auroc': 0.98662776}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   307     0   0     4   0    5    22    14     5    0    126
1     0  1250   0    14   0    1     2    53     8    1      3
2     1     0   0   127  12    5    54     9     1   82     21
3     1     0   0  7961   0   87     2   201   170   13      3
4     2     0   0    20  13    6   276     1     6    6    209
5     1     0   0    11   0  291     0     0     1  216      1
6     6     0   0     3   0    1  1869     7     3    0     19
7     1     6   0   164   0    1     3  6951   102   15     19
8     0     0   0    82   1   19    41    83  2898   26    146
9     3     0   0    18   0   52     2     0     1  404     13
10   10     2   0    13   1    3   203    12    29    0  12519
---- Validation: 
scalar performance:
{'acc': 0.92218804, 'precision': 0.7275203, 'recall': 0.7026116, 'specificity': 0.99150944, 'f1': 0.6913321, 'auroc': 0.9865352}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   316     0   0     4   0    3    15    14     5    2    124
1     0  1252   0    11   0    1     2    56     4    0      6
2     1     2   0   111  15    5    55     9     0   96     18
3     1     0   0  7950   0   88     0   218   164   15      4
4     0     0   0    18  11    9   277     3     6    6    209
5     0     0   0    13   0  289     0     0     2  215      2
6     5     0   0     4   0    2  1868     7     3    0     19
7     3     4   0   143   0    0     3  6977   103   13     19
8     1     0   0    74   0   12    45    93  2888   28    155
9     0     0   0    15   0   58     6     0     0  406      8
10    8     0   0    11   0    2   212    11    32    1  12519
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6622822, 'precision': 0.5445981, 'recall': 0.5598783, 'specificity': 0.96466607, 'f1': 0.5306622, 'auroc': 0.8724149}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   621     0   0   12   0   39   141   66     9   32   250
1     1  1105   0   51   1   17    15  263    22   15     9
2     4     1   0   93  16   53   536   54    98  118    42
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    2   1    1   760    2     5    0   862
5     3     0   0   24   0  467     7    0     0   89     2
6     0     0   0    1   0    1  3061    3     1    0     0
7     1     0   0  188   0    4     9  950     7    2     3
8     0     0   0  145   0   19    61    1  1135    4     5
9     7     3   0   50   1  298    57   50    42  614    15
10    0     0   0    0   0    0   134    0     0    0  1512
better model found
persisted
after epoch: 3,now: 2024-07-27 19:27:36.798785,epoch time: 0:59:36.420879,used: 3:00:03.179597,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9357877, 'precision': 0.85078245, 'recall': 0.71081567, 'specificity': 0.99291086, 'f1': 0.7236718, 'auroc': 0.9856363}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   253     1   0     5   0    2    14    21     9    6    172
1     0  1249   0     7   0    0     0    64     5    0      7
2     0    49  10    27  62    1    20    32     8   96      7
3     0     0   0  8043   0    9     1   257   126    2      0
4     0     6   0     5  67    3   201     7    26    9    213
5     0     0   0    35   0  313     0     2     4  166      1
6     1     2   0     6   0    1  1857     8     4    2     27
7     0    10   0    95   1    0     1  7109    37    0     10
8     0     1   1    71   1    0     3   149  3034    2     34
9     0    15   0    15   1   54     4    11     4  387      2
10    1     2   0     9   3    2    63    18    41    0  12654
---- Validation: 
scalar performance:
{'acc': 0.9363648, 'precision': 0.81822133, 'recall': 0.711077, 'specificity': 0.99295765, 'f1': 0.7227861, 'auroc': 0.9861377}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   257     1   0     7   0    3     9    22     5    4    175
1     0  1250   0    10   0    0     2    58     7    0      5
2     1    42   5    31  63    2    20    34    14   93      7
3     0     2   0  8057   0   12     0   260   108    0      1
4     0     6   2     8  68    5   190     5    29    6    220
5     0     1   0    38   0  316     0     0     6  159      1
6     1     3   0     7   0    1  1862     6     6    1     21
7     0    10   0    81   1    0     2  7130    33    1      7
8     0     1   0    88   2    1     4   157  3005    1     37
9     0    13   2     9   2   59     1     8     7  389      3
10    1     1   0    11   3    1    66    13    32    1  12667
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6500385, 'precision': 0.5273408, 'recall': 0.53503263, 'specificity': 0.964646, 'f1': 0.4908852, 'auroc': 0.8487072}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   332     1   0   98   0   42    54   195    56   56   336
1     0  1087   0   33   0    1     3   337     9    0    29
2     0    19   0   34  37   20   188   112   339  111   155
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1   1    1    65     2    15    0  1548
5     0     0   0  108   0  348     3     0    13  118     2
6     0     0   0   13   0    0  3010     6    29    0     9
7     0     0   0   18   0    1     0  1142     0    0     3
8     0     0   0   58   0    2     3    17  1285    3     2
9     0    19   0   98   4  124    10   156   263  442    21
10    0     0   0    0   0    0     2     0     0    0  1644
better model found
persisted
after epoch: 4,now: 2024-07-27 20:26:55.688379,epoch time: 0:59:18.889594,used: 3:59:22.069191,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9408711, 'precision': 0.8698379, 'recall': 0.76858294, 'specificity': 0.99358606, 'f1': 0.79428506, 'auroc': 0.99041927}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   270     1   0     3    0    0     7    37    12    1    152
1     0  1282   0     3    0    0     1    29    12    0      5
2     0    10  58    59   51    0     2    39    44   48      1
3     0     3   0  7988    0    5     5   244   193    0      0
4     1     8  10    15  274    0    44    10    40    4    133
5     0     0   0    40    0  340     0     0    10  130      1
6     2     0   0     1    1    0  1869     4     6    0     25
7     0    45   0    60    1    0     1  7034   113    1      9
8     0     2   1    29    5    0     0    52  3187    1     18
9     0     1   5    16    1   41     0    29    31  367      0
10    1     3   1    12   75    1   136    14    52    1  12497
---- Validation: 
scalar performance:
{'acc': 0.9410191, 'precision': 0.8686871, 'recall': 0.7687393, 'specificity': 0.9936147, 'f1': 0.79476523, 'auroc': 0.99051255}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   272     1   0     1    0    0    11    40    11    1    146
1     0  1284   0     4    0    0     2    32     7    0      3
2     0    12  62    52   51    0     1    43    44   45      2
3     1     3   0  7984    0    9     2   250   191    0      0
4     1    12   6    19  263    0    59     6    37    3    133
5     0     0   0    36    0  342     0     0    10  132      1
6     2     0   0     1    1    0  1872     7     6    1     18
7     1    35   0    70    2    0     2  7046   104    0      5
8     1     0   3    30    3    0     1    51  3190    1     16
9     0     3   8    25    0   40     0    18    30  367      2
10    2     1   1    13   67    1   148    12    51    2  12498
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6831316, 'precision': 0.65052766, 'recall': 0.56674457, 'specificity': 0.96785253, 'f1': 0.5341362, 'auroc': 0.8658914}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   669     0   0   6    2    4    25   212    81   30   141
1     0  1255   0  27    0    0     2   174    27    0    14
2     0    25  34  57  152    4    31   140   486   42    44
3     0     0   0   0    0    0     0     0     0    0     0
4     1     2   2   3   95    0   269     4    31    0  1226
5     1     0   0  76    0  321     0     2    37  154     1
6     0     0   0   7    1    0  2974     3    32    0    50
7     0     0   0  14    0    0     0  1143     4    0     3
8     0     0   0  34    0    1     0     4  1330    1     0
9     0     7   3  71    3   78     1   170   474  325     5
10    0     0   0   0    1    0    25     0     2    0  1618
better model found
persisted
after epoch: 5,now: 2024-07-27 21:26:22.209866,epoch time: 0:59:26.521487,used: 4:58:48.590678,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93859696, 'precision': 0.81547666, 'recall': 0.71428704, 'specificity': 0.9930774, 'f1': 0.7363581, 'auroc': 0.9888996}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   267     0   0     8    0    0     1   127    11    2     67
1     0  1258   0     7    0    0     1    58     6    0      1
2     0     0   0   183   16    0     2    34    18   49     10
3     0     0   0  7978    0    2     0   306   152    0      0
4     2     0   0    56  107    1    85     7    23    1    256
5     0     0   0    52    0  268     0     0    10  190      1
6     5     0   0     4    0    0  1844     8    15    0     32
7     0     5   0    57    1    0     1  7134    61    0      5
8     1     0   0    45    1    0     0    80  3130    0     37
9     0     0   0    47    0   22     1    14     9  399      1
10   13     0   0    14    3    1     9    15    42    1  12696
---- Validation: 
scalar performance:
{'acc': 0.9395747, 'precision': 0.8220285, 'recall': 0.71598023, 'specificity': 0.9931522, 'f1': 0.7404912, 'auroc': 0.9892362}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   267     0   0     9    0    1     1   133     2    1     69
1     0  1256   0     8    0    0     0    57     7    0      4
2     0     0   0   187   14    0     3    43    15   40     10
3     0     0   0  8012    0    3     0   291   134    0      0
4     1     0   0    61  121    0    78     9    20    1    248
5     0     0   0    61    0  259     0     0    10  190      1
6     6     0   0     6    0    1  1832    13    11    0     39
7     0     4   0    74    0    0     1  7117    65    0      4
8     2     0   0    36    0    0     0    75  3146    0     37
9     0     0   0    46    0   16     1    14    11  405      0
10    9     0   0    14    6    0     8    20    28    0  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6341566, 'precision': 0.55896866, 'recall': 0.4987304, 'specificity': 0.9634219, 'f1': 0.45261863, 'auroc': 0.8535327}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   348     0   0   19   0    0     5   664    99   11    24
1     0  1119   0   22   0    0     0   314    26    0    18
2     1     2   0  176  25    1    25   139   340   40   266
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    4   8    0    11     3    13    0  1592
5     0     0   0  149   0  104     0     3    53  282     1
6     0     0   0   25   0    0  2985     5    25    0    27
7     0     0   0    2   0    0     0  1157     2    0     3
8     0     0   0   22   0    0     0    13  1329    3     3
9     0     3   0  120   0    9     0   176   431  370    28
10    0     0   0    0   0    0     0     0     2    0  1644
early stop counter: 1
val acc:0.9395747184753418, best validation acc: 0.9410191178321838, corresponding to test acc:                         0.6831315755844116 / 0.6832015514373779
after epoch: 6,now: 2024-07-27 22:25:45.251223,epoch time: 0:59:23.041357,used: 5:58:11.632035,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.942744, 'precision': 0.8688915, 'recall': 0.7353291, 'specificity': 0.99356306, 'f1': 0.748546, 'auroc': 0.99250793}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   277     0   0     4    0    1     4    49     1    3    144
1     0  1265   0    17    0    0     2    42     3    0      3
2     0     2   7   106   53    4    10     8     4  114      4
3     0     0   0  8345    0   13     0    35    43    2      0
4     0     1   0    17  103    2   205     4    15    5    186
5     0     0   0    28    0  455     0     0     1   35      2
6     2     1   0    12    0    1  1834     7     6    1     43
7     0     6   0   324    1    0     1  6861    57    4     10
8     0     0   0   141    2    4     6    47  3044    7     45
9     0     1   1     7    0  147     0     3     4  328      2
10    3     0   0    12    3    2    33     7    15    0  12717
---- Validation: 
scalar performance:
{'acc': 0.9431055, 'precision': 0.87051404, 'recall': 0.73916996, 'specificity': 0.9936012, 'f1': 0.7511749, 'auroc': 0.99253136}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   269     0   0     5    0    0     1    53     4    5    146
1     0  1266   0    16    0    1     1    38     5    0      5
2     0     2   5   111   47    3    13     8     5  114      4
3     0     1   0  8338    0   12     0    44    45    0      0
4     0     2   1    12  110    4   198     3    14    5    190
5     0     0   0    15    0  475     0     0     2   26      3
6     0     0   0     9    0    1  1850     6     4    3     35
7     0     7   0   330    0    0     1  6849    64    4     10
8     0     1   0   121    3    2     2    52  3063    7     45
9     0     1   0    11    0  142     0     1     4  330      4
10    4     0   0    10    4    3    43    10    19    0  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6606731, 'precision': 0.59931976, 'recall': 0.55395925, 'specificity': 0.96603733, 'f1': 0.5255786, 'auroc': 0.85840386}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   786     1   0   15   0    2     5  155     8    8   190
1     1  1203   0   53   0    6     2  195     7    2    30
2     1     5   1   61  46   21   154   63   260   42   361
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    0   1    0    52    2     9    0  1569
5     3     0   0  107   0  422     2    1    12   34    11
6     0     0   0   76   0    0  2944    3     6    0    38
7     0     0   0  234   0    0     0  920     6    1     3
8     0     0   0  141   0    1     2    0  1219    1     6
9     8     6   1  191  10  187     9  138   228  301    58
10    0     0   0    0   0    0     0    0     0    0  1646
better model found
persisted
after epoch: 7,now: 2024-07-27 23:24:42.276820,epoch time: 0:58:57.025597,used: 6:57:08.657632,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9429313, 'precision': 0.82875574, 'recall': 0.6968935, 'specificity': 0.99321365, 'f1': 0.71453106, 'auroc': 0.99453723}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   82     0   0     5   0    0     7    80     1    2    306
1    0  1284   0    12   0    0     2    26     5    0      3
2    0     0   0   185  15    1     6    19     1   59     26
3    0     0   0  8321   0    2     3    74    35    1      2
4    0     0   0    32  86    2   117     3     4    1    294
5    0     0   0    36   0  427     0     0     1   56      1
6    0     0   0     6   0    1  1868     3     0    0     30
7    0    10   0   137   0    1     1  7043    51    0     21
8    0     0   0   142   0    1     0    55  3028    1     68
9    0     0   0    42   0   93     0     5     1  346      6
10   0     0   0     8   1    1    11     5     6    1  12758
---- Validation: 
scalar performance:
{'acc': 0.94214255, 'precision': 0.8207466, 'recall': 0.6924266, 'specificity': 0.99314255, 'f1': 0.70940125, 'auroc': 0.9944552}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   75     0   0     4   0    1    11    76     0    1    315
1    0  1285   0    11   0    1     0    28     3    0      4
2    0     0   0   172  19    3     1    25     3   64     25
3    0     1   0  8312   0    4     2    84    36    1      0
4    0     0   0    41  86    1   118     3     9    1    280
5    0     0   0    39   0  419     0     0     1   61      1
6    1     0   0     3   0    1  1869     1     3    0     30
7    0    11   0   135   1    0     3  7058    42    3     12
8    0     0   0   160   0    1     0    58  3011    0     66
9    0     0   0    42   0   94     0     7     3  338      9
10   1     0   0     9   0    0     4     6     7    0  12769
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5942069, 'precision': 0.55082077, 'recall': 0.47679913, 'specificity': 0.9598404, 'f1': 0.4411103, 'auroc': 0.8379529}
confusion matrix:
    0     1   2    3   4    5     6     7    8    9     10
0   70     2   0   36   0   14    81   212   13   33   709
1    0  1230   0   55   0    2     3   166    7    1    35
2    0     2   0  243   5   29    17    50  212   60   397
3    0     0   0    0   0    0     0     0    0    0     0
4    0     0   0    4   1    0     8     1   12    0  1607
5    0     0   0  209   0  357     0     0    2   22     2
6    0     0   0   88   0    0  2950     2    2    0    25
7    0     0   0  104   0    0     3  1044    5    0     8
8    0     0   0  360   0    4     2     1  998    0     5
9    0     4   0  418   0  233     4    64  168  198    48
10   0     0   0    0   0    0     1     0    0    0  1645
early stop counter: 1
val acc:0.9421425461769104, best validation acc: 0.9431055188179016, corresponding to test acc:                         0.6606730818748474 / 0.6832015514373779
after epoch: 8,now: 2024-07-28 00:23:41.991178,epoch time: 0:58:59.714358,used: 7:56:08.371990,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9363763, 'precision': 0.79741323, 'recall': 0.6962445, 'specificity': 0.99265134, 'f1': 0.69859874, 'auroc': 0.99209595}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   62     0   0     3    0    2     0    48     4   46    318
1    0  1282   0     4    0    0     0    36     4    1      5
2    0     0   0    98    9    3     0     3     2  191      6
3    0     1   0  8243    0   41     0    97    54    3      0
4    0     0   0    89  150    7    44     5     8   21    215
5    0     0   0    14    0  494     0     0     0   12      1
6    0     1   0    14    6    6  1660     6     5   22    188
7    0     9   0   163    1    1     0  7015    62    4      8
8    0     0   0   120    0   17     0    48  3068   10     31
9    0     0   0     4    0  188     0     0     3  297      1
10   0     0   0    14    5    3     3    11    24    5  12727
---- Validation: 
scalar performance:
{'acc': 0.93593687, 'precision': 0.7983874, 'recall': 0.6965039, 'specificity': 0.99261427, 'f1': 0.6980604, 'auroc': 0.9920125}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   65     1   0     2    0    1     0    51     3   45    315
1    0  1278   0     9    0    0     0    36     5    3      1
2    0     0   0    92    6    5     0     2     5  198      4
3    0     2   0  8247    0   46     0    93    47    4      1
4    0     0   0    88  138    6    44     4    12   27    220
5    0     0   0    13    0  495     0     0     1   11      1
6    2     1   0    10    2    7  1680     5     5   24    172
7    0     7   0   200    1    1     0  6981    61    5      9
8    0     0   0   130    0   16     1    51  3069    4     25
9    0     0   0     6    0  181     0     0     2  304      0
10   0     0   0    17    3    2     2     8    26    5  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5853215, 'precision': 0.55866, 'recall': 0.5030781, 'specificity': 0.95873535, 'f1': 0.43627065, 'auroc': 0.8300952}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   20     0   0   17   0   54     1   134    30  474   440
1    0  1115   0   48   1    5     0   245    19   21    45
2    0     0   0  133   5   75     0    36   454  132   180
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   0    5  10    1     2     2    27    4  1582
5    0     0   0   53   0  516     0     0     2   19     2
6    0     0   0   67   0    4  2447     4   115    3   427
7    0     0   0   90   0    1     0  1059     9    2     3
8    0     0   0  161   0    8     0     2  1194    3     2
9    0     0   0  183   0  368     0    33   171  360    22
10   0     0   0    0   0    0     0     0     1    0  1645
early stop counter: 2
val acc:0.9359368681907654, best validation acc: 0.9431055188179016, corresponding to test acc:                         0.6606730818748474 / 0.6832015514373779
after epoch: 9,now: 2024-07-28 01:21:50.990115,epoch time: 0:58:08.998937,used: 8:54:17.370927,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9405233, 'precision': 0.90426147, 'recall': 0.68485963, 'specificity': 0.9931058, 'f1': 0.6952854, 'auroc': 0.99516594}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0    1     1   0     1    0    1     7   160     1    1    310
1    0  1279   0    11    0    0     0    37     4    0      1
2    0     0   1   181   65    1     4    20     6   31      3
3    0     0   0  8165    0    4     1   179    87    1      0
4    0     0   0    15  142    1   171     3     4    0    203
5    0     0   0    58    0  362     0     0     4   95      2
6    0     0   0     2    0    0  1880     2     3    0     21
7    0     6   0    79    1    0     0  7128    31    1     17
8    0     0   0    72    2    0     8    75  3078    1     59
9    0     0   0    56    1   49     3     8     7  367      2
10   0     0   0    12    2    2    17     5     5    0  12750
---- Validation: 
scalar performance:
{'acc': 0.9408319, 'precision': 0.7830676, 'recall': 0.6864915, 'specificity': 0.9931392, 'f1': 0.6962633, 'auroc': 0.99544525}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0    0     0   0     4    0    1    11   152     1    1    313
1    0  1284   0     8    0    0     0    36     3    0      1
2    0     0   2   182   61    0     5    10    12   34      6
3    0     1   0  8186    0    5     1   170    76    0      1
4    0     2   0    15  138    0   179     0     6    0    199
5    0     0   0    52    0  374     0     0     4   90      1
6    0     0   0     2    1    0  1879     1     0    0     25
7    0     5   1    78    1    0     1  7121    46    0     12
8    0     1   0    65    1    0     4    72  3078    0     75
9    0     0   0    53    1   51     0     9     9  366      4
10   0     0   0    10    6    0    24     3     8    0  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6178549, 'precision': 0.5459793, 'recall': 0.49243665, 'specificity': 0.961373, 'f1': 0.4436894, 'auroc': 0.8581939}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0    2     6   0   33    0   21    50   273    18   45   722
1    0  1191   0   41    1    0     1   242     5    2    16
2    0     5   0  118  159   11   217    83   203   40   179
3    0     0   0    0    0    0     0     0     0    0     0
4    0     0   0    2   23    0   174     2     7    0  1425
5    0     1   0  193    0  280     4     0    15   98     1
6    0     0   0   33    0    0  3001     2     2    0    29
7    0     0   0   26    0    0     0  1134     1    0     3
8    0     0   0  103    0    0     6    11  1245    2     3
9    0     1   1  240   12   81    13   167   288  310    24
10   0     0   0    0    0    0     1     0     0    0  1645
early stop counter: 3
val acc:0.9408318996429443, best validation acc: 0.9431055188179016, corresponding to test acc:                         0.6606730818748474 / 0.6832015514373779
after epoch: 10,now: 2024-07-28 02:20:46.035780,epoch time: 0:58:55.045665,used: 9:53:12.416592,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 9:53:12.416592 at 2024-07-28 02:20:46.035780
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6606731, 'precision': 0.59931976, 'recall': 0.55395925, 'specificity': 0.96603733, 'f1': 0.5255786, 'auroc': 0.85840386}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   786     1   0   15   0    2     5  155     8    8   190
1     1  1203   0   53   0    6     2  195     7    2    30
2     1     5   1   61  46   21   154   63   260   42   361
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    0   1    0    52    2     9    0  1569
5     3     0   0  107   0  422     2    1    12   34    11
6     0     0   0   76   0    0  2944    3     6    0    38
7     0     0   0  234   0    0     0  920     6    1     3
8     0     0   0  141   0    1     2    0  1219    1     6
9     8     6   1  191  10  187     9  138   228  301    58
10    0     0   0    0   0    0     0    0     0    0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68320155, 'precision': 0.5237087, 'recall': 0.5593636, 'specificity': 0.9671936, 'f1': 0.52279836, 'auroc': 0.862471}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   625     2   0   5   0   11   177    59    74  121    96
1     1  1188   0  22   0   24    37   168    20   24    15
2     6     5   0  53   0   44   351    44   229  131   152
3     0     0   0   0   0    0     0     0     0    0     0
4     1     0   0   1   0    2   368     2     9    0  1250
5     0     0   0  49   0  218     8     0    13  304     0
6     0     0   0   0   0    0  3057     3     5    1     1
7     1     0   0  15   0    1    12  1109     8   15     3
8     0     0   0  56   0    8    19     2  1274    5     6
9     1     7   0  81   0  119    31    46   150  680    22
10    0     0   0   0   0    0    32     0     0    0  1614
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_27_33_seed_0_23104514_instance_wise_predictions.txt
accuracy from prediction file 0.660673056741062
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/35.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/35.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/35.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |   1648 MiB |  19382 MiB |    814 TiB |    814 TiB |
|       from small pool |      7 MiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |   1648 MiB |  19382 MiB |    814 TiB |    814 TiB |
|       from small pool |      7 MiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB |    817 TiB |    817 TiB |
|       from large pool |   1647 MiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      6 MiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20106 MiB |  20106 MiB |  20106 MiB |      0 B   |
|       from large pool |  20072 MiB |  20072 MiB |  20072 MiB |      0 B   |
|       from small pool |     34 MiB |     34 MiB |     34 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231478 KiB | 777243 KiB | 120658 GiB | 120658 GiB |
|       from large pool | 216320 KiB | 775200 KiB | 114735 GiB | 114735 GiB |
|       from small pool |  15158 KiB |  17181 KiB |   5922 GiB |   5922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   53606 K  |   53603 K  |
|       from large pool |     247    |     691    |   27282 K  |   27282 K  |
|       from small pool |    2419    |    3627    |   26323 K  |   26321 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   53606 K  |   53603 K  |
|       from large pool |     247    |     691    |   27282 K  |   27282 K  |
|       from small pool |    2419    |    3627    |   26323 K  |   26321 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     563    |     563    |     563    |       0    |
|       from large pool |     546    |     546    |     546    |       0    |
|       from small pool |      17    |      17    |      17    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     116    |    1241    |   30867 K  |   30867 K  |
|       from large pool |      94    |     363    |   18766 K  |   18766 K  |
|       from small pool |      22    |    1147    |   12101 K  |   12101 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19382 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19382 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |    817 TiB |    817 TiB |
|       from large pool |  16640 KiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20106 MiB |  20106 MiB |  18224 MiB |
|       from large pool |   1860 MiB |  20072 MiB |  20072 MiB |  18212 MiB |
|       from small pool |     22 MiB |     34 MiB |     34 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 777243 KiB | 120659 GiB | 120659 GiB |
|       from large pool |  24320 KiB | 775200 KiB | 114736 GiB | 114736 GiB |
|       from small pool |      0 KiB |  20690 KiB |   5922 GiB |   5922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   53606 K  |   53606 K  |
|       from large pool |       2    |     691    |   27282 K  |   27282 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   53606 K  |   53606 K  |
|       from large pool |       2    |     691    |   27282 K  |   27282 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     563    |     563    |     459    |
|       from large pool |      93    |     546    |     546    |     453    |
|       from small pool |      11    |      17    |      17    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1241    |   30868 K  |   30868 K  |
|       from large pool |       3    |     363    |   18766 K  |   18766 K  |
|       from small pool |       0    |    1147    |   12102 K  |   12102 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19382 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19382 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |    817 TiB |    817 TiB |
|       from large pool |  16640 KiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20106 MiB |  20106 MiB |  18224 MiB |
|       from large pool |   1860 MiB |  20072 MiB |  20072 MiB |  18212 MiB |
|       from small pool |     22 MiB |     34 MiB |     34 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 777243 KiB | 120659 GiB | 120659 GiB |
|       from large pool |  24320 KiB | 775200 KiB | 114736 GiB | 114736 GiB |
|       from small pool |      0 KiB |  20690 KiB |   5922 GiB |   5922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   53606 K  |   53606 K  |
|       from large pool |       2    |     691    |   27282 K  |   27282 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   53606 K  |   53606 K  |
|       from large pool |       2    |     691    |   27282 K  |   27282 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     563    |     563    |     459    |
|       from large pool |      93    |     546    |     546    |     453    |
|       from small pool |      11    |      17    |      17    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1241    |   30868 K  |   30868 K  |
|       from large pool |       3    |     363    |   18766 K  |   18766 K  |
|       from small pool |       0    |    1147    |   12102 K  |   12102 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514

 Experiment start at: 2024-07-28 02:38:42.037617
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.55763054, 'precision': 0.5626554, 'recall': 0.5551593, 'specificity': 0.95844746, 'f1': 0.4892605, 'auroc': 0.91589063}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   397     1     39     6   0    0    27    11     2   0   0
1     0  1174     70    15   0    0     0    71     2   0   0
2    74     4    190     2   0    0     4    21    12   0   5
3     8     1      7  7912   0    3     1   383   124   0   0
4    31     4    462     3   0    1     8     6    22   0   1
5   111     5      7   107   0  134   118     3    35   0   1
6    57    28     32    21   0    0  1752    11     5   0   2
7     2    32    108   255   0    0     6  6824    32   0   3
8     6    10    463   249   0    0     3   125  2439   0   0
9   269    15     60    14   0   30    65    15    18   0   7
10   85    18  12503    19   0    0    62    35    51   0  20
---- Validation: 
scalar performance:
{'acc': 0.55639964, 'precision': 0.5523429, 'recall': 0.55447644, 'specificity': 0.95832896, 'f1': 0.48736197, 'auroc': 0.9161441}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   392     0     36    10   0    0    30    12     3   0   0
1     0  1181     66    16   0    0     0    67     1   0   1
2    76     3    191     3   0    0     2    20    12   0   5
3     5     1     13  7904   0    3     1   373   140   0   0
4    29     4    453     2   0    2    11     4    33   0   1
5   130     2     10    97   0  137   110     2    33   0   0
6    63    27     25    26   0    0  1748     9     8   0   2
7     4    32     99   278   0    0     9  6814    28   0   1
8     9     7    471   246   0    1     6   135  2420   0   1
9   272     9     62    11   0   31    66    13    22   0   7
10   89    30  12495    16   0    0    76    29    47   0  14
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5338277, 'precision': 0.45255205, 'recall': 0.45323467, 'specificity': 0.9541106, 'f1': 0.39986664, 'auroc': 0.80600846}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9   10
0   1077     1     7   13   0   0    11    60     1   0   0
1     33  1145   218   11   0   0     1    91     0   0   0
2    264     5   669    4   0   1    12    11    47   0   2
3      0     0     0    0   0   0     0     0     0   0   0
4      7     0  1611    4   0   0     2     0     9   0   0
5    362     5     5   20   0  55   121     6    18   0   0
6     50    31   291  187   0   0  2499     5     4   0   0
7     31     1    17   31   0   0     4  1080     0   0   0
8     76    14   104   55   0   2     4    10  1105   0   0
9    709    40   259    5   0   7    37    15    64   0   1
10     0     0  1640    4   0   0     2     0     0   0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 03:39:12.951125,epoch time: 1:00:30.913508,used: 1:00:30.913508,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5827269, 'precision': 0.5572776, 'recall': 0.5827625, 'specificity': 0.9609836, 'f1': 0.52929246, 'auroc': 0.9320939}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   421     0     39     4   0    1     5     8     5   0   0
1     0  1229      5    15   0    0     0    75     7   0   1
2    84     0    122     2   0    5     5    43    51   0   0
3     1     0      1  8054   0    3     0   271   109   0   0
4    35     1    413     0   0    3     7     7    73   0   0
5    35     0      3    66   0  254    91     0    72   0   0
6    86     6     14     6   0    1  1784     5     6   0   0
7     2     6     17   184   0    1     3  7000    51   0   0
8     3     2    108   172   0    3     1    92  2915   0   0
9   191     0     44    10   0   66   130    15    36   0   1
10   85     8  12593     7   0    1    23    18    53   0   1
---- Validation: 
scalar performance:
{'acc': 0.5826669, 'precision': 0.52527046, 'recall': 0.579914, 'specificity': 0.96098506, 'f1': 0.52819186, 'auroc': 0.932328}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   421     0     39     4   0    0     5    11     2   0   1
1     0  1224      6    13   0    0     0    85     4   0   0
2    84     0    118     1   0    4     8    45    52   0   0
3     1     0      1  8089   0    4     2   228   114   0   1
4    28     1    429     3   0    2     8     7    61   0   0
5    26     0      2    58   0  244   107     2    82   0   0
6    79     6     13     9   0    1  1789     5     6   0   0
7     5     5     17   194   0    0     1  6981    62   0   0
8     5     1    113   178   0    0     3    79  2917   0   0
9   188     0     43     9   0   84   116    18    34   0   1
10   79     2  12609     7   0    3    17    26    53   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.54698104, 'precision': 0.41067082, 'recall': 0.45052287, 'specificity': 0.9551821, 'f1': 0.40078694, 'auroc': 0.8280009}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9   10
0   1043     0     8   31   0    0     5    78     5   0   0
1      6  1179    12   35   0    0     6   255     6   0   0
2    224     3   320   16   0    4    47    66   334   0   1
3      0     0     0    0   0    0     0     0     0   0   0
4     16     3  1570    0   0    1     8     3    32   0   0
5    146     0    13   72   0  101   212    10    38   0   0
6     11     3     8  167   0   13  2805     7    53   0   0
7      3     0     3   16   0    0     1  1141     0   0   0
8      3     0     5  116   0    0     0    17  1229   0   0
9    412     2   113  102   0   25   137   147   199   0   0
10     0     0  1640    0   0    0     3     1     2   0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 04:38:18.600642,epoch time: 0:59:05.649517,used: 1:59:36.563025,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.59051263, 'precision': 0.5403487, 'recall': 0.6258769, 'specificity': 0.96183145, 'f1': 0.5553884, 'auroc': 0.9429668}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   416     0     42     3   0    0     4    12     6   0   0
1     0  1259      8    13   0    0     0    46     5   0   0
2    50     0    184     1   0    6     7    27    34   0   3
3     1     3      1  8004   0   13     4   235   177   0   0
4    16     0    459     0   0    5     2     8    45   0   4
5    10     0      5    20   0  379    49     0    57   0   1
6    57     9     46     5   0    3  1765     5    15   0   1
7     1    15     18   149   0    0     1  7045    36   0   0
8     1     1     56    88   0    1     0   130  3019   0   0
9   140     0     54     3   0  129   112    17    33   0   5
10   30     2  12671     6   0    1     7    27    48   0   0
---- Validation: 
scalar performance:
{'acc': 0.59031695, 'precision': 0.5525526, 'recall': 0.6226604, 'specificity': 0.9618095, 'f1': 0.5545957, 'auroc': 0.9426977}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   409     0     46     3   0    1     4    13     6   0   1
1     1  1246      4    13   0    0     1    61     6   0   0
2    51     0    176     2   0    9     6    31    34   0   3
3     4     1      0  8008   0    8     3   238   177   0   1
4    11     0    457     0   0    6     4     8    52   0   1
5     6     0      7    14   0  383    47     1    63   0   0
6    67     4     38     7   0    1  1779     2    10   0   0
7     2    13     16   146   0    0     1  7044    43   0   0
8     0     1     56    92   0    2     0   123  3022   0   0
9   126     0     59     2   0  144   105    17    34   0   6
10   35     0  12679     7   0    2     3    27    41   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58972925, 'precision': 0.42776287, 'recall': 0.49708197, 'specificity': 0.9592049, 'f1': 0.44292605, 'auroc': 0.84119797}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1059     0    16  11   0    2     9    47    26   0   0
1      3  1289    19  20   0    2     0   154    12   0   0
2    140     0   493   4   0   15    34    36   288   0   5
3      0     0     0   0   0    0     0     0     0   0   0
4      3     0  1609   0   0    0     2     1    18   0   0
5    107     0     6  17   0  211   204     9    38   0   0
6      1     5    40   9   0    2  2983     3    24   0   0
7      5     2     7  59   0    0     2  1089     0   0   0
8     10     0     5  32   0    4     3    11  1305   0   0
9    342     6   192  23   0   89   192    82   209   0   2
10     0     0  1645   0   0    0     0     0     1   0   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-28 05:37:22.008018,epoch time: 0:59:03.407376,used: 2:58:39.970401,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5958102, 'precision': 0.5599794, 'recall': 0.6546103, 'specificity': 0.9623525, 'f1': 0.5712504, 'auroc': 0.9453694}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   417     2     32     1   0    0    13     2    13   0   3
1     0  1290      5     3   0    0     0    27     6   0   0
2    42     0    212     1   0    5     4    15    18   0  15
3     3     2      5  7940   0   14     5   261   209   0   1
4    10     3    471     0   0    4     5     2    39   0   5
5     6     0      4     8   0  450    17     0    33   0   3
6    11     1      7     1   0    0  1878     1     8   0   1
7     6    34     48   113   0    0     3  6982    75   0   0
8     1     9     80    52   0    4     6    54  3089   0   0
9    85     5     72     2   0  175    50    21    26   0  57
10   29    19  12595     5   0    3    33    14    84   0  11
---- Validation: 
scalar performance:
{'acc': 0.59457004, 'precision': 0.5601538, 'recall': 0.6567336, 'specificity': 0.96221876, 'f1': 0.5718858, 'auroc': 0.94494087}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   421     2     32     2   0    1    12     2    10   0   1
1     0  1293      3     4   0    0     0    27     5   0   0
2    32     1    222     0   0    8     6    12    18   0  13
3     4     3      3  7914   0   11     6   291   208   0   0
4     7     3    474     0   0    5     3     1    38   0   8
5     2     0      3     8   0  447    19     0    39   0   3
6    17     0     11     0   0    1  1873     0     6   0   0
7     3    32     67   109   0    0     2  6977    75   0   0
8     3     3     99    47   0    6     4    63  3071   0   0
9    81     6     63     1   0  166    63    17    32   0  64
10   26    24  12585     5   0    2    31    15    98   0  10
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.61757505, 'precision': 0.44284788, 'recall': 0.5394563, 'specificity': 0.96193993, 'f1': 0.47777757, 'auroc': 0.8468118}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1069     0     5   6   0    0    78     5     7   0   0
1     15  1394    11  18   0    2    16    39     4   0   0
2     61     7   495   2   0   47    77    23   235   0  68
3      0     0     0   0   0    0     0     0     0   0   0
4      3     7  1570   0   0    2    25     0    24   0   2
5     41     0     0  21   0  429    71     4    25   0   1
6      0     0     0   9   0    0  3054     0     4   0   0
7     26     0     3  25   0    1    10  1089     8   0   2
8      7     0     8  25   0   14    18     1  1297   0   0
9    256    18   138   6   0  272   159    54   190   0  44
10     0     5  1630   0   0    0     6     0     5   0   0
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 06:36:41.742066,epoch time: 0:59:19.734048,used: 3:57:59.704449,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5954891, 'precision': 0.5656002, 'recall': 0.63276297, 'specificity': 0.96234506, 'f1': 0.55797744, 'auroc': 0.9523257}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   416     1     44     7   0    0     2     7     6   0   0
1     0  1248      3    13   0    0     0    62     4   0   0
2    57     0    216     0   0    6     3    13    16   0   1
3     0     0      0  8145   0    2     0   171   119   0   0
4    11     1    490     0   0    4     1     6    23   0   3
5     9     0      4    19   0  339    24     6   120   0   0
6    25     4     18    11   0    2  1827     8    11   0   1
7     2     7     19   189   0    0     1  6994    52   0   1
8     1     0     71    82   0    2     0    70  3069   0   0
9   182     0     67     8   0  132    41    38    19   0   6
10   20     3  12704     8   0    2     3    10    41   0   3
---- Validation: 
scalar performance:
{'acc': 0.5964157, 'precision': 0.5659411, 'recall': 0.6358764, 'specificity': 0.96243536, 'f1': 0.55920815, 'auroc': 0.94970036}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   411     0     46     8   0    0     4     7     7   0   0
1     0  1255      1    10   0    0     0    61     5   0   0
2    46     0    226     1   0    6     1    16    15   0   1
3     0     0      0  8156   0    4     0   178   102   0   0
4    12     1    489     0   0    5     1     6    24   0   1
5    15     0      7    20   0  343    21     4   111   0   0
6    24     3     15    16   0    2  1828     5    13   0   2
7     1     7     18   171   0    0     1  7014    53   0   0
8     1     0     76    86   0    0     0    72  3061   0   0
9   179     0     63    11   0  127    51    28    25   0   9
10   18     3  12701     6   0    2     5    17    41   0   3
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5800042, 'precision': 0.43785584, 'recall': 0.48552978, 'specificity': 0.9585693, 'f1': 0.44253138, 'auroc': 0.8445667}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9   10
0   1071     0     4   45   0    0    14   10    26   0   0
1     13  1282    17   52   0    0    12  102    21   0   0
2    144     0   468   18   0   15    35   26   306   0   3
3      0     0     0    0   0    0     0    0     0   0   0
4      3     2  1591    0   0    0    11    0    25   0   1
5     77     0     0   79   0  217   118    4    96   0   1
6      0     1     2   30   0    1  3018    1    14   0   0
7     26     1     7  130   0    1     2  990     7   0   0
8      1     0     3  117   0    1     4    0  1244   0   0
9    382     1   186   96   0   77   138   34   222   0   1
10     0     0  1641    0   0    0     3    0     2   0   0
better model found
persisted
after epoch: 5,now: 2024-07-28 07:35:44.295383,epoch time: 0:59:02.553317,used: 4:57:02.257766,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5966128, 'precision': 0.5856979, 'recall': 0.60870516, 'specificity': 0.9622603, 'f1': 0.5507078, 'auroc': 0.9558635}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   426     1     26     3   0    0    13     4     5   0   5
1     1  1290      2    14   0    0     0    22     3   0   0
2    64     2    176     0   0    0     6    42     4   0  18
3     1     1      1  8172   0    5     1   117   138   0   1
4     8     1    456     0   0    1     5    14     9   0  45
5    11     2      1    20   0  227    62    19   156   0  23
6     9     2     10     4   0    0  1875     1     3   0   4
7     2    14     22   166   0    0     3  7013    41   0   0
8     2     1    109    67   0    2     4    66  3039   0   6
9   174     9     25     5   0   36    48   122     9   0  65
10   26    13  12593    10   0    0    30    23    18   0  81
---- Validation: 
scalar performance:
{'acc': 0.59612143, 'precision': 0.5843965, 'recall': 0.60915506, 'specificity': 0.96221954, 'f1': 0.5487312, 'auroc': 0.95422834}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   416     0     23     9   0    0    15     7     4   0   9
1     0  1280      3    15   0    0     0    30     4   0   0
2    63     0    191     0   0    1     3    30     2   0  22
3     1     1      0  8183   0    3     1   105   143   0   3
4     8     3    452     0   0    1     3    13    12   0  47
5    21     3      3    19   0  222    56    14   165   0  18
6    17     0      8     6   0    1  1871     1     2   0   2
7     2     8     20   172   0    0     4  7014    43   0   2
8     1     2    121    67   0    2     2    68  3026   0   7
9   161     6     36     7   0   44    58   115     7   0  59
10   22     5  12622     8   0    0    32    20     4   0  83
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56069404, 'precision': 0.4359162, 'recall': 0.45678824, 'specificity': 0.95665514, 'f1': 0.41903204, 'auroc': 0.8393777}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9   10
0   1004     1     3   42   0    1    60   21    37   0   1
1      6  1356    10   52   0    0    12   53    10   0   0
2    134     6   423   16   0    5    36  108   247   0  40
3      0     0     0    0   0    0     0    0     0   0   0
4      3     7  1579    0   0    0    10    1    15   0  18
5    110     0     0   67   0  157   144   36    72   0   6
6      0     1     1   22   0    0  3034    1     6   0   2
7     16     1     3  336   0    1    11  793     3   0   0
8      5     0     5  110   0    0     7    2  1241   0   0
9    391     9   127   71   0   32   101  173   227   0   6
10     0     0  1637    0   0    0     2    0     1   0   6
early stop counter: 1
val acc:0.5961214303970337, best validation acc: 0.5964156985282898, corresponding to test acc:                         0.5800042152404785 / 0.6175750494003296
after epoch: 6,now: 2024-07-28 08:34:38.801915,epoch time: 0:58:54.506532,used: 5:55:56.764298,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.59324163, 'precision': 0.58293724, 'recall': 0.6072826, 'specificity': 0.9619447, 'f1': 0.53251326, 'auroc': 0.9662509}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   424     3     35     2   0    0     4     7     6   0   2
1     0  1304      4     5   0    0     0    17     2   0   0
2    11     2    244     0   0    0     2    45     4   0   4
3     1     6      1  8162   0    0     0   169    95   0   3
4     8     3    477     0   0    1     0    16    22   0  12
5    20     1     12    15   0  106    62    37   258   0  10
6    17     1     12     3   0    0  1867     3     3   0   1
7     1    51     10   189   0    0     2  6990    22   0   0
8     1     1     39    79   0    0     0   117  3058   0   1
9   117     3     95     6   0   19    33   181    13   0  26
10   19     2  12635     6   0    0     8    40    63   0  18
---- Validation: 
scalar performance:
{'acc': 0.5923231, 'precision': 0.5815217, 'recall': 0.6018796, 'specificity': 0.9618509, 'f1': 0.528703, 'auroc': 0.96723133}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   415     0     32     2   0   0     7    12     8   0   7
1     0  1306      1     6   0   0     0    16     3   0   0
2     9     2    240     1   0   0     3    51     5   0   1
3     2     4      0  8160   0   1     0   168   103   0   2
4     2     4    482     1   0   0     1    13    25   0  11
5    23     0      7    15   0  93    76    34   257   0  16
6     8     5     18     1   0   1  1862     4     8   0   1
7     0    55      5   178   0   0     1  7004    22   0   0
8     0     1     41    95   0   0     0   109  3050   0   0
9   120     5     99     3   0  10    38   171    21   0  26
10   15     1  12649     9   0   0    10    40    58   0  14
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5721682, 'precision': 0.4469803, 'recall': 0.4649942, 'specificity': 0.9579638, 'f1': 0.41545552, 'auroc': 0.8515052}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9   10
0   1097     1     5   17   0   0    36   13     1   0   0
1      6  1389     5   28   0   0     0   65     6   0   0
2     74    20   508   13   0   0     7  109   253   0  31
3      0     0     0    0   0   0     0    0     0   0   0
4      1     4  1601    1   0   0     5    2    17   0   2
5    149     0     0   38   0  83   115  107    72   0  28
6      0     6     3   17   0   0  3025    1    12   0   3
7      4     1     0  317   0   0     2  839     1   0   0
8      3     1     3  110   0   0     1   14  1237   0   1
9    254    23   242   76   0   6    26  336   165   0   9
10     0     0  1644    0   0   0     1    1     0   0   0
early stop counter: 2
val acc:0.5923231244087219, best validation acc: 0.5964156985282898, corresponding to test acc:                         0.5800042152404785 / 0.6175750494003296
after epoch: 7,now: 2024-07-28 09:33:19.648288,epoch time: 0:58:40.846373,used: 6:54:37.610671,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.60094714, 'precision': 0.6000413, 'recall': 0.61086464, 'specificity': 0.9623627, 'f1': 0.57108736, 'auroc': 0.95879745}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   425     0     20     4   0    0     5    10     6   0   13
1     0  1266      2     7   0    0     1    53     2   0    1
2     2     0    164     2   0    0     1   105     5   0   33
3     4     0      0  8281   0    1     4    87    60   0    1
4     2     1    399     1   0    2     0    11    30   0   92
5     4     2      1    16   0  259    36    10   168   0   25
6    21     0     10     2   0    0  1865     1     3   0    6
7     4     3      3   163   0    0     5  7046    38   0    1
8     1     1     26   137   0    0     1    57  3067   0    6
9    13     0     14     3   0   69    30   220    10   0  134
10   11     4  12571     8   0    1    11    37    61   0   88
---- Validation: 
scalar performance:
{'acc': 0.5996523, 'precision': 0.5978722, 'recall': 0.60625947, 'specificity': 0.96223223, 'f1': 0.5700418, 'auroc': 0.95815647}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   419     0     28     1   0    0     5    16     5   0    9
1     0  1265      2     6   0    0     1    55     3   0    0
2     2     0    151     0   0    0     1   115     8   0   35
3     6     2      0  8279   0    3     5    87    56   0    2
4     3     0    388     0   0    1     3    23    26   0   95
5     3     0      1    21   0  262    28    16   166   0   24
6    17     1      5     0   0    1  1870     5     3   0    6
7     2     2      5   187   0    0     2  7026    40   0    1
8     0     1     32   133   0    0     3    55  3067   0    5
9    14     1     16     1   0   70    34   229     9   0  119
10   18     0  12590    10   0    2     8    32    57   0   79
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5715385, 'precision': 0.45452577, 'recall': 0.47584575, 'specificity': 0.95767677, 'f1': 0.43298572, 'auroc': 0.8500877}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9    10
0   1110     0     3    1   0    0    40    12     2   0    2
1      7  1106    10   21   0    0     6   335    13   0    1
2     25     3   454   10   0    2     8   154   206   0  153
3      0     0     0    0   0    0     0     0     0   0    0
4      0     2  1585    1   0    0     8     2    14   0   21
5     39     0     0   23   0  175   100   151    41   0   63
6      0     2     1   18   0    0  3032     3     6   0    5
7      3     0     0   43   0    0     2  1112     3   0    1
8      1     2     4  161   0    0     3    18  1177   0    4
9    108     1   135   43   0   22    37   614   119   0   58
10     0     1  1639    0   0    0     1     1     1   0    3
better model found
persisted
after epoch: 8,now: 2024-07-28 10:32:12.747566,epoch time: 0:58:53.099278,used: 7:53:30.709949,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.5973887, 'precision': 0.60110784, 'recall': 0.5961759, 'specificity': 0.96214867, 'f1': 0.5291489, 'auroc': 0.97089475}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   407     0     49     5   0   0     4     6     6   0   6
1     0  1295      2     8   0   0     0    16     9   0   0
2    12     1    238     1   0   0     1    25     8   0  26
3     1     4      0  8227   0   0     1    90   114   0   1
4     0     0    419     0   0   0     0    10    12   0  97
5     7     0      3    20   0  48    18    81   281   0  63
6     6     1     15     2   0   0  1873     5     3   0   3
7     1    21     10   146   0   0     1  6994    87   0   3
8     0     0     37    52   0   0     0    35  3167   0   5
9    63     0     67     2   0   9     1   273    10   0  68
10    2     0  12664     5   0   0     4     7    33   0  79
---- Validation: 
scalar performance:
{'acc': 0.59751236, 'precision': 0.606736, 'recall': 0.5956948, 'specificity': 0.9621494, 'f1': 0.5298752, 'auroc': 0.9717187}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   402     0     43     3   0   0     1    18     2   0   14
1     0  1295      3     8   0   0     0    20     6   0    0
2     9     0    239     0   0   0     0    27     3   0   34
3     0     0      0  8242   0   1     0    82   114   0    1
4     1     0    413     1   0   0     0     4    17   0  103
5     5     0      5    21   0  50    17    78   293   0   52
6     8     0     15     2   0   0  1871     5     2   0    5
7     0    16     13   136   0   0     2  6994   103   0    1
8     0     0     44    48   0   0     0    33  3164   0    7
9    60     0     66     3   0   5     5   282     7   0   65
10    4     1  12667     8   0   0     4     9    22   0   81
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5827328, 'precision': 0.46154642, 'recall': 0.47362477, 'specificity': 0.958911, 'f1': 0.41100383, 'auroc': 0.8462478}
confusion matrix:
      0     1     2   3   4   5     6     7     8   9    10
0   1080     0    24  11   0   0    15    26    13   0    1
1      1  1242    33  23   0   0     2   160    27   0   11
2     14     0   554   2   0   0     1    76   176   0  192
3      0     0     0   0   0   0     0     0     0   0    0
4      1     0  1599   0   0   0     4     0    11   0   18
5     33     0     1  49   0   5     6   329    71   0   98
6      1     2    10  13   0   0  3018     3    13   0    7
7      1     0     7  19   0   0     0  1133     4   0    0
8      0     0     9  53   0   0     0    11  1296   0    1
9     93     0   315  45   0   1     3   416   205   0   59
10     0     1  1643   0   0   0     0     0     1   0    1
early stop counter: 1
val acc:0.5975123643875122, best validation acc: 0.5996522903442383, corresponding to test acc:                         0.571538507938385 / 0.6175750494003296
after epoch: 9,now: 2024-07-28 11:31:14.400937,epoch time: 0:59:01.653371,used: 8:52:32.363320,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.5940711, 'precision': 0.6092392, 'recall': 0.60395515, 'specificity': 0.9614557, 'f1': 0.55629086, 'auroc': 0.96641415}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   426     0     21     0   0    0    11     5     0   0   20
1     0  1282      6     3   0    0     0    37     3   0    0
2    13     0    187     0   0    0     3    32     0   0   77
3     4     1      4  7823   0    3    15   441   146   0    2
4     4     1    183     0   0    0     3     6     2   0  340
5    14     0      5     3   0  194   116    38   148   0    3
6     8     0      5     0   0    0  1883     2     0   0   10
7     1     6     69    44   0    0     6  7077    51   0   10
8     6     0    127    30   0    2    10    55  3009   0   56
9    80     0     61     1   0   16    54   261     2   0   18
10   11     0  12430     3   0    0    11     9     4   0  323
---- Validation: 
scalar performance:
{'acc': 0.59580046, 'precision': 0.6096307, 'recall': 0.60525495, 'specificity': 0.9615991, 'f1': 0.55692786, 'auroc': 0.96784544}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   422     0     29     0   0    0     8     6     0   0   18
1     0  1281      4     2   0    1     1    40     3   0    0
2    14     0    189     0   0    0     3    29     0   0   77
3     3     1      3  7846   0    9     8   413   154   0    3
4     6     0    164     0   0    0     3     9     0   0  357
5    18     0      5     2   0  196   118    48   130   0    4
6     7     1      9     0   0    0  1881     2     0   0    8
7     5     5     71    43   0    0     2  7084    35   0   20
8     4     1    107    29   0    0     4    49  3046   0   56
9    81     0     58     1   0    7    67   250     4   0   25
10   14     1  12420     3   0    0    14    12     3   0  329
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56797034, 'precision': 0.46047288, 'recall': 0.45016506, 'specificity': 0.9566593, 'f1': 0.40720993, 'auroc': 0.8434491}
confusion matrix:
      0     1     2   3   4   5     6     7     8   9    10
0   1070     0     9   2   0   0    73     8     3   0    5
1      6  1222    28  14   0   0    12   192    11   0   14
2     68     0   229   2   0   0    37    85    68   0  526
3      0     0     0   0   0   0     0     0     0   0    0
4      0     3  1015   0   0   0     9     1     1   0  604
5    193     0     0  16   0  20   185   139    22   0   17
6      0     0     1   0   0   0  3064     0     0   0    2
7      5     2    10   7   0   0     5  1133     2   0    0
8     18     0    14  22   0   1    42    11  1241   0   21
9    324     1   276   6   0   1    55   339    65   0   70
10     0     0  1507   0   0   0     0     0     0   0  139
early stop counter: 2
val acc:0.5958004593849182, best validation acc: 0.5996522903442383, corresponding to test acc:                         0.571538507938385 / 0.6175750494003296
after epoch: 10,now: 2024-07-28 12:30:35.954769,epoch time: 0:59:21.553832,used: 9:51:53.917152,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 9:51:53.917152 at 2024-07-28 12:30:35.954769
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5715385, 'precision': 0.45452577, 'recall': 0.47584575, 'specificity': 0.95767677, 'f1': 0.43298572, 'auroc': 0.8500877}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9    10
0   1110     0     3    1   0    0    40    12     2   0    2
1      7  1106    10   21   0    0     6   335    13   0    1
2     25     3   454   10   0    2     8   154   206   0  153
3      0     0     0    0   0    0     0     0     0   0    0
4      0     2  1585    1   0    0     8     2    14   0   21
5     39     0     0   23   0  175   100   151    41   0   63
6      0     2     1   18   0    0  3032     3     6   0    5
7      3     0     0   43   0    0     2  1112     3   0    1
8      1     2     4  161   0    0     3    18  1177   0    4
9    108     1   135   43   0   22    37   614   119   0   58
10     0     1  1639    0   0    0     1     1     1   0    3
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.61757505, 'precision': 0.44284788, 'recall': 0.5394563, 'specificity': 0.96193993, 'f1': 0.47777757, 'auroc': 0.8468118}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1069     0     5   6   0    0    78     5     7   0   0
1     15  1394    11  18   0    2    16    39     4   0   0
2     61     7   495   2   0   47    77    23   235   0  68
3      0     0     0   0   0    0     0     0     0   0   0
4      3     7  1570   0   0    2    25     0    24   0   2
5     41     0     0  21   0  429    71     4    25   0   1
6      0     0     0   9   0    0  3054     0     4   0   0
7     26     0     3  25   0    1    10  1089     8   0   2
8      7     0     8  25   0   14    18     1  1297   0   0
9    256    18   138   6   0  272   159    54   190   0  44
10     0     5  1630   0   0    0     6     0     5   0   0
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_02_38_41_seed_1_23104514_instance_wise_predictions.txt
accuracy from prediction file 0.5715385153571678
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/35.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/35.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |   1648 MiB |  19382 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      7 MiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |   1648 MiB |  19382 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      7 MiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB |   1634 TiB |   1634 TiB |
|       from large pool |   1647 MiB |  19328 MiB |   1622 TiB |   1622 TiB |
|       from small pool |      6 MiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20086 MiB |  20106 MiB |  38310 MiB |  18224 MiB |
|       from large pool |  20052 MiB |  20072 MiB |  38264 MiB |  18212 MiB |
|       from small pool |     34 MiB |     34 MiB |     46 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231478 KiB | 777243 KiB | 241346 GiB | 241346 GiB |
|       from large pool | 216320 KiB | 775200 KiB | 229495 GiB | 229495 GiB |
|       from small pool |  15158 KiB |  20690 KiB |  11850 GiB |  11850 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |  107213 K  |  107211 K  |
|       from large pool |     247    |     691    |   54565 K  |   54565 K  |
|       from small pool |    2419    |    3627    |   52648 K  |   52645 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |  107213 K  |  107211 K  |
|       from large pool |     247    |     691    |   54565 K  |   54565 K  |
|       from small pool |    2419    |    3627    |   52648 K  |   52645 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     562    |     563    |    1021    |     459    |
|       from large pool |     545    |     546    |     998    |     453    |
|       from small pool |      17    |      17    |      23    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     118    |    1243    |   61675 K  |   61675 K  |
|       from large pool |      95    |     363    |   37579 K  |   37579 K  |
|       from small pool |      23    |    1148    |   24096 K  |   24096 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |  16640 KiB |  19382 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      0 KiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |  16640 KiB |  19382 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      0 KiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |   1634 TiB |   1634 TiB |
|       from large pool |  16640 KiB |  19328 MiB |   1622 TiB |   1622 TiB |
|       from small pool |      0 KiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20106 MiB |  38310 MiB |  36428 MiB |
|       from large pool |   1860 MiB |  20072 MiB |  38264 MiB |  36404 MiB |
|       from small pool |     22 MiB |     34 MiB |     46 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 777243 KiB | 241347 GiB | 241347 GiB |
|       from large pool |  24320 KiB | 775200 KiB | 229496 GiB | 229496 GiB |
|       from small pool |      0 KiB |  20690 KiB |  11850 GiB |  11850 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |  107213 K  |  107213 K  |
|       from large pool |       2    |     691    |   54565 K  |   54565 K  |
|       from small pool |       0    |    3627    |   52648 K  |   52648 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |  107213 K  |  107213 K  |
|       from large pool |       2    |     691    |   54565 K  |   54565 K  |
|       from small pool |       0    |    3627    |   52648 K  |   52648 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     563    |    1021    |     917    |
|       from large pool |      93    |     546    |     998    |     905    |
|       from small pool |      11    |      17    |      23    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1243    |   61676 K  |   61676 K  |
|       from large pool |       3    |     363    |   37579 K  |   37579 K  |
|       from small pool |       0    |    1148    |   24096 K  |   24096 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 12:39:14 2024]
Finished job 0.
1 of 1 steps (100%) done
