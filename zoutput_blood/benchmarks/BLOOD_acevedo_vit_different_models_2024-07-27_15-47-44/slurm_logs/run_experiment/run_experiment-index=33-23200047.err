Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 29 04:08:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/33.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=33
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047

 Experiment start at: 2024-07-29 04:34:39.443158
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8858626, 'precision': 0.65976095, 'recall': 0.62103224, 'specificity': 0.98790205, 'f1': 0.6174897, 'auroc': 0.9479399}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   148     0   0     4   0    5    85    50    76   48     67
1     3  1032   0    13   0    0    12   222    36    0     12
2     0     0   0     1   0    4     5    61    88  123     30
3     0     0   0  7571   0    8     0   341   517    1      0
4     5     0   0     1   0    3    40    18   198   20    254
5     0     0   0    95   0  192     0     3    26  204      1
6     4     0   0     2   0    3  1796    28    52    7     14
7     0     1   0   151   0    0     4  6817   286    1      4
8     0     0   0    52   0    1     0    73  3160    1      8
9     0     0   0    13   0   64     0    29    37  346      4
10   14     2   0     6   0    1   277    39   400    8  12048
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8838839, 'precision': 0.65936106, 'recall': 0.6226381, 'specificity': 0.98767877, 'f1': 0.6190612, 'auroc': 0.94954824}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   151     0   0     4   0    5    76    47    74   50     76
1     3  1031   0    12   0    0    18   220    35    0     13
2     2     0   0     1   0    5     2    66    88  116     32
3     1     0   0  7519   0   13     0   361   546    0      0
4     2     0   0     1   0    3    41    17   204   21    250
5     0     0   0   103   0  200     0     3    21  192      2
6     6     1   0     2   0    1  1798    24    54    4     18
7     0     1   0   144   0    0     3  6820   288    1      8
8     0     0   0    41   0    1     2    84  3155    1     12
9     0     0   0    11   0   69     1    24    37  350      1
10   12     0   0     8   0    2   262    46   433   13  12020
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5713986, 'precision': 0.46614647, 'recall': 0.46295685, 'specificity': 0.95569754, 'f1': 0.41388205, 'auroc': 0.8204189}
confusion matrix:
     0    1   2   3   4    5     6     7     8    9     10
0   355    0   0  17   0    6   278   138   263   94    19
1    19  567   0  29   0    4    32   726    68    0    54
2     5    0   0   4   0   22   108    53   617   98   108
3     0    0   0   0   0    0     0     0     0    0     0
4     1    0   0   0   0    0   471     2    80    0  1079
5     5    1   0  50   0  250    38     3    67  172     6
6     0    0   0   0   0    0  2832     5   225    0     5
7     0    0   0   7   0    1     1  1133    21    0     1
8     0    0   0  14   0    3    28     0  1324    1     0
9     7    0   0  25   0  131    36   104   478  327    29
10    0    0   0   0   0    0   265     0     2    0  1379
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 06:18:53.700273,epoch time: 1:44:14.257115,used: 1:44:14.257115,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.91938674, 'precision': 0.7360691, 'recall': 0.6846638, 'specificity': 0.9913181, 'f1': 0.6779738, 'auroc': 0.97607774}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   257     0   0     4   0   13    83     5     7    1    113
1     0  1273   0    10   0    1    10    29     6    1      2
2     0     4   0    92   2   13    41    12    13  118     17
3     0     2   0  7924   0   17     8   365   118    2      0
4     1     1   0    30   4   12   232     4    50   15    190
5     0     0   0    44   0  328     1     0     7  140      1
6     3     1   0     3   0    2  1874     5     8    1     11
7     1    42   0   132   0    0    12  6959    97    1     19
8     1     3   0   121   0    4    12    95  3018    2     39
9     1     1   0    22   0  129     2     6    11  316      5
10    7     4   0    17   1    4   259    13    78    1  12410
---- Validation: 
scalar performance:
{'acc': 0.9178547, 'precision': 0.7074596, 'recall': 0.68107975, 'specificity': 0.9911525, 'f1': 0.67356336, 'auroc': 0.9770883}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   242     0   0     3   0   12    91     8     7    5    115
1     0  1275   0    14   1    3     7    26     4    0      2
2     0     6   0    85   6   10    35     8    18  121     23
3     0     6   0  7914   0   15     7   378   119    1      0
4     0     0   0    29   3   13   232     4    42   13    203
5     0     0   0    45   0  318     1     0     9  147      1
6     2     1   0     3   0    3  1877     4     6    2     10
7     0    46   0   145   1    0    10  6955    90    2     16
8     0     3   0   135   0    4    18    84  3009    2     41
9     1     1   0    17   0  134     0     2    11  324      3
10    6     8   0    12   0    8   289    14    62    0  12397
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6816624, 'precision': 0.53619075, 'recall': 0.566999, 'specificity': 0.9665414, 'f1': 0.5308008, 'auroc': 0.86601996}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   801     0   0    6   0    6   268    47     6   15    21
1     0  1365   0   28   0    2    18    80     2    3     1
2     6    21   0   63  16   64   417    28   212   44   144
3     0     0   0    0   0    0     0     0     0    0     0
4     1     6   0    1   1    0   435     0     8    0  1181
5    15     0   0   49   0  357    56     0    10  105     0
6     0     0   0    6   0    0  3056     3     2    0     0
7     0     3   0   34   0    0    16  1110     0    1     0
8     0     0   0   51   0    3    66    13  1235    0     2
9    23    37   0  119   1  224   140    38   218  302    35
10    0     4   0    0   0    0   126     0     0    0  1516
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 08:02:09.745146,epoch time: 1:43:16.044873,used: 3:27:30.301988,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93049014, 'precision': 0.7940382, 'recall': 0.7067298, 'specificity': 0.99248433, 'f1': 0.70651126, 'auroc': 0.98266935}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   299     0   0     5   0    9    22    23    13    5    107
1     1  1271   0    14   0    1     4    32     7    0      2
2     3    19   2    37  61    5    41    22    20   95      7
3     0     1   0  8122   0   18     2   199    96    0      0
4     1     1   0     3  38    5   251     8    28    8    196
5     0     0   0    42   0  426     1     0     5   46      1
6    11     2   0     3   0    2  1859    10     7    0     14
7     0    14   0   176   0    0     4  6997    64    0      8
8     0     2   0   157   0    3    11   105  2993    1     23
9     0     3   1    17   2  196     3     5     4  256      6
10   13     1   0    10   0    3   172    20    57    1  12515
---- Validation: 
scalar performance:
{'acc': 0.9306941, 'precision': 0.7287274, 'recall': 0.7073909, 'specificity': 0.9925262, 'f1': 0.70511395, 'auroc': 0.9825332}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   304     0   0     4   0   12    26    19    14    7     97
1     1  1273   0     9   0    3     1    33     7    0      5
2     0    18   0    46  65   10    38    20    17   89      9
3     0     1   0  8131   0   13     1   197    97    0      0
4     2     1   0     3  27    6   271     6    31    9    183
5     0     3   0    39   0  432     1     0     7   38      1
6     9     0   0     5   0    1  1857    14     6    0     16
7     0    12   0   184   0    0     3  6999    57    3      7
8     0     2   0   144   0    5     8   102  3007    1     27
9     0     6   1    13   2  192     3     7     7  260      2
10    8     0   0     9   0    2   178    25    69    1  12504
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66389143, 'precision': 0.6106945, 'recall': 0.5563932, 'specificity': 0.9657556, 'f1': 0.50610334, 'auroc': 0.8563209}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   600     1   0   20   0  115    87   171    38   48    90
1     0  1289   0   39   0    5     8   140     5    2    11
2     1    26   1   55  33   65   306    47   354   64    63
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    1   0    1   406     2    24    0  1198
5     0     0   0  105   0  465     4     0     6    9     3
6     0     0   0   14   0    0  3043     4     5    0     1
7     0     1   0   37   0    1     0  1114     7    2     2
8     0     0   0  197   0    6     4     2  1161    0     0
9     0    13   0  162   8  385    18    40   267  225    19
10    0     0   0    0   0    0    55     0     0    0  1591
better model found
persisted
after epoch: 3,now: 2024-07-29 09:46:17.121125,epoch time: 1:44:07.375979,used: 5:11:37.677967,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93391484, 'precision': 0.8381872, 'recall': 0.69330704, 'specificity': 0.99264276, 'f1': 0.7140571, 'auroc': 0.98379683}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   154     0   0     4    1    6    31    18     9    0    260
1     0  1269   0    10    0    0     2    41     7    0      3
2     0     5  13    69  109    4    14    28    19   43      8
3     0     1   0  8161    0   10     1   190    74    0      0
4     0     1   0    10  106    3   202     7    48    2    160
5     0     0   0    65    0  389     1     1     5   59      1
6     0     0   1     3    0    4  1851     5     8    0     35
7     0    15   0   149    0    0     3  7044    44    1      7
8     1     0   0   134    0    0     3    96  3041    0     19
9     0     2   3    35    5  146     0    18     9  273      2
10    0     0   0     8    8    3    79    18    74    0  12605
---- Validation: 
scalar performance:
{'acc': 0.9342517, 'precision': 0.8503937, 'recall': 0.6952566, 'specificity': 0.99265945, 'f1': 0.71689, 'auroc': 0.9840657}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   158     0   0     9    0    7    22    17    10    0    260
1     0  1267   0    12    0    0     1    42     4    0      6
2     0     3  15    81  106    8     9    31    12   42      5
3     0     1   0  8163    0    5     1   195    75    0      0
4     0     0   0     8  106    2   201    10    41    4    167
5     0     0   0    58    0  395     0     0     9   58      1
6     0     1   0     2    1    5  1842     2    14    1     40
7     0    18   0   151    1    0     0  7035    52    0      8
8     0     0   0   127    1    1     1    90  3059    0     17
9     0     2   2    39    5  145     1    12    12  272      3
10    1     0   0    10    5    2    76    13    73    1  12615
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5778353, 'precision': 0.60923594, 'recall': 0.48913047, 'specificity': 0.95759, 'f1': 0.43821728, 'auroc': 0.8162718}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   232     1   0   22   0  115   173    35    10    7   575
1     0  1268   0   30   0    1     0   171     5    0    24
2     0    13   1   68  26   35    81    44   580   28   139
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1   0    0   117     0    71    0  1444
5     0     0   0  185   0  383     1     0    12    9     2
6     0     0   0  134   0    1  2295     5   480    0   152
7     0     0   0   52   0    0     1  1105     3    0     3
8     0     0   0  159   0    2     1     5  1202    0     1
9     0    20   0  276   5  232    10    61   372  133    28
10    0     0   0    0   0    0     4     1     1    0  1640
better model found
persisted
after epoch: 4,now: 2024-07-29 11:25:01.608644,epoch time: 1:38:44.487519,used: 6:50:22.165486,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9354666, 'precision': 0.87588227, 'recall': 0.72727513, 'specificity': 0.9930569, 'f1': 0.73198736, 'auroc': 0.990078}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   323     0   0     5    0    0     3    36    23    5     88
1     0  1256   0     6    0    0     0    58     6    1      5
2     0     1   2   113   47    0     7    23     3  109      7
3     0     1   0  8034    0   11     0   202   188    3      0
4     1     0   0    21  130    0   218    10    15   14    130
5     0     0   0    26    0  219     0     0     4  271      1
6     9     4   0     8    1    4  1809    19    10    2     41
7     0     5   0   104    1    0     0  7084    57    4      6
8     1     1   0    53    6    0    14   120  3072    5     24
9     0     0   0    15    1   11     0     6     2  458      0
10    3     0   0    12    7    0   136    15    42    1  12577
---- Validation: 
scalar performance:
{'acc': 0.932192, 'precision': 0.7746893, 'recall': 0.7199533, 'specificity': 0.99268544, 'f1': 0.7233143, 'auroc': 0.98946524}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   325     0   0     4    0    0     0    37    16    7     94
1     0  1258   0     7    0    0     1    58     4    2      2
2     1     1   0   116   49    0     6    27     1  107      4
3     0     1   0  7998    0   14     1   222   196    7      1
4     1     0   1    42  105    1   213     8    23    8    137
5     0     0   0    22    0  223     0     2     4  269      1
6     9     5   0     7    0    0  1803    30    13    2     39
7     0     6   0    99    1    0     2  7089    58    2      8
8     1     1   0    51    7    1    11   143  3041   10     30
9     0     0   0    18    3   14     0     8     2  447      1
10    4     0   0    14   10    0   135    22    48    2  12561
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6328972, 'precision': 0.52778554, 'recall': 0.5271574, 'specificity': 0.9626446, 'f1': 0.4901482, 'auroc': 0.8620204}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   528     1   0   10    0    5     3   193   336   53    41
1     0  1189   0   20    0    3     0   250     7    2    28
2     1     2   0  111  117    1   151   137   203  104   188
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    3    3    0   482     2     7    1  1134
5     0     0   0   70    0  161     0     4     5  350     2
6     0     2   0  158    1    0  2468    12   229    1   196
7     0     0   0   27    0    1     0  1125     5    3     3
8     0     0   0   47    0    5     2     8  1300    5     3
9     0     5   0  102    5   32     0   190   107  662    34
10    0     0   0    0    0    0    36     0     0    0  1610
early stop counter: 1
val acc:0.9321920275688171, best validation acc: 0.9342517256736755, corresponding to test acc:                         0.5778353214263916 / 0.681662380695343
after epoch: 5,now: 2024-07-29 13:02:13.200289,epoch time: 1:37:11.591645,used: 8:27:33.757131,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9451252, 'precision': 0.8697473, 'recall': 0.7398348, 'specificity': 0.99398226, 'f1': 0.74796855, 'auroc': 0.9917554}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   253     0   0     8   0    1     5    75     7    3    131
1     0  1262   0    13   0    1     1    47     5    0      3
2     1     9   5    35  47    1    12    29    15  153      5
3     0     1   0  8202   0   11     0   126    96    3      0
4     0    11   1    10  97    3   205    11    24   15    161
5     0     0   0    24   0  398     0     0     4   94      1
6     0     0   0     3   0    1  1859     6     5    1     33
7     0    11   0   128   1    0     0  7050    67    2      5
8     0     1   0    99   0    5     4    69  3092    4     20
9     0     2   0     6   1   50     2     4     3  423      1
10    1     0   0     8   4    1    47    14    30    4  12684
---- Validation: 
scalar performance:
{'acc': 0.94401497, 'precision': 0.86962056, 'recall': 0.73791945, 'specificity': 0.99383175, 'f1': 0.7477374, 'auroc': 0.991237}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   247     0   0    10   0    0     4    72     5    5    140
1     0  1262   0    10   0    2     1    45     9    0      3
2     0    13  10    30  42    0    10    35    17  149      6
3     0     3   0  8219   0   12     1   122    80    2      1
4     1     7   2     7  93    2   202     7    29   16    173
5     0     0   0    25   0  398     0     0     3   94      1
6     2     0   0     8   0    0  1854     7     3    2     32
7     0    10   0   148   0    0     1  7033    65    1      7
8     0     1   0    96   0    4     7    72  3085    6     25
9     0     1   0     5   1   56     1     5     3  419      2
10    3     0   0     9   3    0    53    23    31    2  12672
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6436018, 'precision': 0.52608174, 'recall': 0.5253581, 'specificity': 0.9640707, 'f1': 0.49975216, 'auroc': 0.8645471}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   478     3   0   30   0   13    29  141   163  107   206
1     0  1263   0   23   0    7     3  151     8    5    39
2     1    18   0   72  53   10   183   20   414  148    96
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    2   4    0   305    0    33    2  1287
5     1     0   0   81   0  255     0    0     3  250     2
6     0     0   0   55   0    1  2895    1    83    1    31
7     0     1   0  195   0    1     0  947    12    4     4
8     0     0   0  205   0    8     0    0  1152    3     2
9     1    26   0  191   1  131     2   27   162  576    20
10    0     0   0    0   1    0    15    0     1    0  1629
better model found
persisted
after epoch: 6,now: 2024-07-29 14:29:04.835606,epoch time: 1:26:51.635317,used: 9:54:25.392448,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93562716, 'precision': 0.8191934, 'recall': 0.73571074, 'specificity': 0.9926568, 'f1': 0.7557812, 'auroc': 0.99301827}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   188     0   0     3    0    1     1    69     2    2    217
1     0  1263   0     6    0    0     0    57     2    2      1
2     0     1   0   154   29    2     0    41     3   75      7
3     0     0   0  7751    0   32     1   552    88   12      0
4     0     0   0    45  208    3    73     9    13    4    183
5     0     0   0    15    0  385     0     0     1  119      1
6     2     0   0     3    0    1  1840    12     6    1     43
7     0     5   0    55    0    0     0  7175    21    2      6
8     0     0   1    47    0    0     0   178  3035    6     28
9     0     0   0    19    0   46     0     6     4  416      2
10    0     0   0    13    6    0    19    22    24    2  12709
---- Validation: 
scalar performance:
{'acc': 0.93473315, 'precision': 0.8166581, 'recall': 0.73263115, 'specificity': 0.9925467, 'f1': 0.750604, 'auroc': 0.9932359}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   170     0   0     2    0    1     3    63     1    3    240
1     0  1266   0     5    0    0     0    58     1    0      2
2     0     1   0   158   25    1     0    36     4   79      8
3     0     1   0  7729    0   44     1   567    90    7      1
4     0     1   0    42  194    2    83    10    15    5    187
5     0     0   0     8    0  392     0     0     3  117      1
6     1     0   0     1    1    0  1845    11     3    1     45
7     0     4   0    50    1    0     0  7180    24    0      6
8     0     0   0    43    2    2     1   164  3048    7     29
9     0     0   0    17    0   39     0     8     4  422      3
10    0     0   0    13   11    0    23    25    24    1  12699
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66032326, 'precision': 0.5867691, 'recall': 0.5455525, 'specificity': 0.9657903, 'f1': 0.5132426, 'auroc': 0.86484706}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   374     1   0    1   0    3     8   194    17   74   498
1     0  1159   0   16   0    9     1   286     6    6    16
2     1     0   0  257  96    2    16   116   174  108   245
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    9  47    0    74     2    18    0  1483
5     1     0   0    6   0  229     0     2     9  342     3
6     0     0   0   12   2    0  2805     8    44    3   193
7     0     0   0   11   0    0     0  1146     2    2     3
8     0     0   0   32   0    6     0     7  1300   22     3
9     1     1   0   65   2   21     0   134   143  735    35
10    0     0   0    1   0    0     1     0     1    0  1643
early stop counter: 1
val acc:0.9347331523895264, best validation acc: 0.9440149664878845, corresponding to test acc:                         0.6436017751693726 / 0.681662380695343
after epoch: 7,now: 2024-07-29 15:53:49.961113,epoch time: 1:24:45.125507,used: 11:19:10.517955,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94798803, 'precision': 0.909539, 'recall': 0.7390082, 'specificity': 0.9940011, 'f1': 0.7682346, 'auroc': 0.994639}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   166     0   0     6    0    1     1   150     0    4    155
1     0  1292   0    15    0    0     0    21     3    0      1
2     0     4  26   143   41    1     5    22     8   51     10
3     0     2   0  8279    0   22     0    87    44    3      0
4     0     1   0    13  191    1    90     3    14    1    225
5     0     0   0    25    0  442     0     0     4   49      1
6     0     0   0     1    1    1  1864     4     3    0     34
7     0    15   0   116    0    0     1  7063    37    3     28
8     1     1   0   159    1    0     2    62  3028    1     41
9     0     2   1    29    2  109     0     5     2  337      6
10    0     0   0    13    5    0    10     4    17    0  12744
---- Validation: 
scalar performance:
{'acc': 0.9477063, 'precision': 0.89719373, 'recall': 0.7354758, 'specificity': 0.99398017, 'f1': 0.7638968, 'auroc': 0.99489754}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   177     0   0     8    0    1     2   148     0    2    145
1     0  1297   0    14    0    0     0    20     0    0      1
2     0     4  19   143   52    1     1    18    11   49     14
3     0     1   0  8284    0   21     0    89    42    3      0
4     1     1   2    13  183    0    95     4    15    0    225
5     0     0   0    26    0  439     0     0     4   50      2
6     0     1   0     6    1    0  1864     0     2    0     34
7     0    10   0   119    0    0     1  7076    37    1     21
8     0     1   0   168    1    1     3    68  3016    2     36
9     0     5   1    27    2  107     0     8     7  327      9
10    1     0   0     9    3    0    12     9    14    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6301686, 'precision': 0.62739587, 'recall': 0.51833713, 'specificity': 0.96283257, 'f1': 0.47861993, 'auroc': 0.8548306}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   242     0   0   14   0   11    38   431    28   28   378
1     0  1297   0   46   0    2     3   125    11    1    14
2     0    10   1   62  46    5    41    42   427   47   334
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    1   4    0   114     1    33    0  1479
5     0     0   0   81   0  334     1     0    26  146     4
6     0     1   0  110   0    0  2807     2   104    0    43
7     0     0   0   85   0    1     9  1055     9    3     2
8     0     0   0  116   0    1     3     2  1244    4     0
9     1    11   0  154   4  118     0    59   347  380    63
10    0     0   0    0   0    0     3     0     0    0  1643
better model found
persisted
after epoch: 8,now: 2024-07-29 17:09:34.991737,epoch time: 1:15:45.030624,used: 12:34:55.548579,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93327266, 'precision': 0.8685144, 'recall': 0.7272827, 'specificity': 0.9927801, 'f1': 0.74109644, 'auroc': 0.992848}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   125     5   0     2    0    0    21    89    18    2    221
1     0  1313   0     5    0    0     0    10     3    0      0
2     0    17  30   108   55    0     5    37    13   39      8
3     0    16   0  8143    0   14     1   111   150    5      0
4     0    11   2    13  265    0    73     5    18    1    151
5     0     2   0    29    0  280     3     1     9  193      4
6     0     8   0     3    1    0  1868     2     4    0     21
7     0   282   0   116    1    0     1  6704   151    1      8
8     0    21   1    40    4    1     3    32  3176    0     16
9     0     7   2    23    0   14    11    16    13  401      5
10    0    57   0     8   34    0    65    14    37    1  12577
---- Validation: 
scalar performance:
{'acc': 0.9350809, 'precision': 0.85693383, 'recall': 0.72845185, 'specificity': 0.99296695, 'f1': 0.742249, 'auroc': 0.9926116}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   136     7   0     2    0    0    21    90    14    2    211
1     0  1317   0     5    0    0     0     7     2    1      0
2     0    17  22   120   56    0     8    36    10   39      4
3     0    18   0  8143    0    8     1   110   157    3      0
4     0     9   2    16  266    0    71     9    15    2    149
5     0     0   0    24    0  291     1     2     7  193      3
6     1     6   0     3    2    1  1878     0     3    0     14
7     0   277   0   103    1    0     1  6743   131    1      8
8     0    19   0    38    4    0     3    34  3167    1     30
9     1     7   7    21    1   16     8    25     9  393      5
10    0    39   0    11   29    0    70    11    32    2  12602
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63562584, 'precision': 0.6237737, 'recall': 0.4958123, 'specificity': 0.96304893, 'f1': 0.46296558, 'auroc': 0.8682469}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   155     1   0    5    0    0    69  387   217   11   325
1     0  1449   0   16    0    3     2   24     3    1     1
2     0    69   6  137  151    0    43   77   418   55    59
3     0     0   0    0    0    0     0    0     0    0     0
4     0    23   2    9  258    0   388    0    29    0   924
5     0     0   0   71    1  120     0    8    53  336     3
6     0    10   0   49    0    0  2921    2    69    1    15
7     0    29   0  226    0    0    12  858    36    0     3
8     0     1   0   52    0    2     4    0  1307    2     2
9     0    72   3   79    4   11     7  122   374  452    13
10    0    10   1    0    8    0    67    0     1    0  1559
early stop counter: 1
val acc:0.935080885887146, best validation acc: 0.9477062821388245, corresponding to test acc:                         0.630168616771698 / 0.681662380695343
after epoch: 9,now: 2024-07-29 18:33:17.174290,epoch time: 1:23:42.182553,used: 13:58:37.731132,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94584763, 'precision': 0.904616, 'recall': 0.70733654, 'specificity': 0.99371505, 'f1': 0.7079426, 'auroc': 0.9954423}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0    2     2   0     3    0    0     4    24     3    6    439
1    0  1288   0    12    0    0     0    28     2    0      2
2    0     4   5   147   42    2     5     3     3   97      4
3    0     0   0  8236    0   10     0   123    67    2      0
4    0     3   0    21  159    0   145     3     9    9    190
5    0     0   0    19    0  448     0     0     2   51      1
6    0     2   0     6    0    1  1865     4     2    2     26
7    0     9   0    77    1    0     0  7119    48    2      8
8    0     0   0    64    1    0     2    55  3147    3     24
9    0     0   0    15    1  103     0     0     1  373      0
10   0     0   0     8    5    1    33     5    26    2  12710
---- Validation: 
scalar performance:
{'acc': 0.9456734, 'precision': 0.9071051, 'recall': 0.70565426, 'specificity': 0.99369335, 'f1': 0.7063509, 'auroc': 0.995522}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0    4     1   0     4    0    1     3    27     7    5    431
1    0  1285   0    16    0    0     0    27     3    0      1
2    0     3   2   165   38    2     4     3     6   86      3
3    0     1   0  8244    0   12     0   107    74    2      0
4    0     2   0    18  149    1   155     3     9    7    195
5    0     0   0    19    0  455     0     0     3   43      1
6    0     1   0     4    0    1  1870     4     2    2     24
7    0     6   0    93    2    0     0  7094    56    3     11
8    0     2   0    53    1    0     3    55  3161    0     21
9    0     0   0    13    0  106     1     1     4  368      0
10   0     0   0     9    3    0    28     7    25    2  12722
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62890923, 'precision': 0.55537254, 'recall': 0.5139814, 'specificity': 0.9626584, 'f1': 0.46548873, 'auroc': 0.85461205}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0    1     4   0   17   0    7     4   103    29   53   952
1    0  1278   0   31   1    0     4   162    12    0    11
2    0     4   0  121  94    9    79    55   387  113   153
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   0    4  12    0   115     0    19    1  1482
5    0     2   0  108   0  355     0     0    17  108     2
6    0     0   0   84   0    0  2900     4    48    0    31
7    0     0   0   89   0    1     0  1067     4    0     3
8    0     0   0   75   0    2     2     5  1282    2     2
9    0     0   0  190   2  111     2    83   273  453    23
10   0     0   0    0   0    0     4     0     1    0  1641
early stop counter: 2
val acc:0.945673406124115, best validation acc: 0.9477062821388245, corresponding to test acc:                         0.630168616771698 / 0.681662380695343
after epoch: 10,now: 2024-07-29 19:43:13.614435,epoch time: 1:09:56.440145,used: 15:08:34.171277,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 15:08:34.171277 at 2024-07-29 19:43:13.614435
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6301686, 'precision': 0.62739587, 'recall': 0.51833713, 'specificity': 0.96283257, 'f1': 0.47861993, 'auroc': 0.8548306}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   242     0   0   14   0   11    38   431    28   28   378
1     0  1297   0   46   0    2     3   125    11    1    14
2     0    10   1   62  46    5    41    42   427   47   334
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    1   4    0   114     1    33    0  1479
5     0     0   0   81   0  334     1     0    26  146     4
6     0     1   0  110   0    0  2807     2   104    0    43
7     0     0   0   85   0    1     9  1055     9    3     2
8     0     0   0  116   0    1     3     2  1244    4     0
9     1    11   0  154   4  118     0    59   347  380    63
10    0     0   0    0   0    0     3     0     0    0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6816624, 'precision': 0.53619075, 'recall': 0.566999, 'specificity': 0.9665414, 'f1': 0.5308008, 'auroc': 0.86601996}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   801     0   0    6   0    6   268    47     6   15    21
1     0  1365   0   28   0    2    18    80     2    3     1
2     6    21   0   63  16   64   417    28   212   44   144
3     0     0   0    0   0    0     0     0     0    0     0
4     1     6   0    1   1    0   435     0     8    0  1181
5    15     0   0   49   0  357    56     0    10  105     0
6     0     0   0    6   0    0  3056     3     2    0     0
7     0     3   0   34   0    0    16  1110     0    1     0
8     0     0   0   51   0    3    66    13  1235    0     2
9    23    37   0  119   1  224   140    38   218  302    35
10    0     4   0    0   0    0   126     0     0    0  1516
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_34_38_seed_0_23200047_instance_wise_predictions.txt
accuracy from prediction file 0.6301686140068565
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/33.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/33.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/33.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |   1648 MiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      7 MiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |   1648 MiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      7 MiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB |    816 TiB |    816 TiB |
|       from large pool |   1647 MiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      6 MiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20112 MiB |  20112 MiB |  20112 MiB |      0 B   |
|       from large pool |  20078 MiB |  20078 MiB |  20078 MiB |      0 B   |
|       from small pool |     34 MiB |     34 MiB |     34 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 229430 KiB | 783421 KiB | 117577 GiB | 117576 GiB |
|       from large pool | 216320 KiB | 781120 KiB | 111654 GiB | 111654 GiB |
|       from small pool |  13110 KiB |  17181 KiB |   5922 GiB |   5922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   53604 K  |   53601 K  |
|       from large pool |     247    |     691    |   27281 K  |   27281 K  |
|       from small pool |    2419    |    3627    |   26323 K  |   26320 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   53604 K  |   53601 K  |
|       from large pool |     247    |     691    |   27281 K  |   27281 K  |
|       from small pool |    2419    |    3627    |   26323 K  |   26320 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     566    |     566    |     566    |       0    |
|       from large pool |     549    |     549    |     549    |       0    |
|       from small pool |      17    |      17    |      17    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     117    |    1251    |   30760 K  |   30759 K  |
|       from large pool |      94    |     367    |   18777 K  |   18777 K  |
|       from small pool |      23    |    1157    |   11982 K  |   11982 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |    816 TiB |    816 TiB |
|       from large pool |  16640 KiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1880 MiB |  20112 MiB |  20112 MiB |  18232 MiB |
|       from large pool |   1860 MiB |  20078 MiB |  20078 MiB |  18218 MiB |
|       from small pool |     20 MiB |     34 MiB |     34 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 783421 KiB | 117578 GiB | 117578 GiB |
|       from large pool |  24320 KiB | 781120 KiB | 111655 GiB | 111655 GiB |
|       from small pool |      0 KiB |  18642 KiB |   5922 GiB |   5922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   53604 K  |   53604 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   53604 K  |   53604 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     103    |     566    |     566    |     463    |
|       from large pool |      93    |     549    |     549    |     456    |
|       from small pool |      10    |      17    |      17    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   30761 K  |   30761 K  |
|       from large pool |       3    |     367    |   18777 K  |   18777 K  |
|       from small pool |       0    |    1157    |   11983 K  |   11983 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |    819 TiB |    819 TiB |
|       from large pool |  16640 KiB |  19381 MiB |    814 TiB |    814 TiB |
|       from small pool |      0 KiB |     32 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |    816 TiB |    816 TiB |
|       from large pool |  16640 KiB |  19328 MiB |    811 TiB |    811 TiB |
|       from small pool |      0 KiB |     31 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1880 MiB |  20112 MiB |  20112 MiB |  18232 MiB |
|       from large pool |   1860 MiB |  20078 MiB |  20078 MiB |  18218 MiB |
|       from small pool |     20 MiB |     34 MiB |     34 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 783421 KiB | 117578 GiB | 117578 GiB |
|       from large pool |  24320 KiB | 781120 KiB | 111655 GiB | 111655 GiB |
|       from small pool |      0 KiB |  18642 KiB |   5922 GiB |   5922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   53604 K  |   53604 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   53604 K  |   53604 K  |
|       from large pool |       2    |     691    |   27281 K  |   27281 K  |
|       from small pool |       0    |    3627    |   26323 K  |   26323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     103    |     566    |     566    |     463    |
|       from large pool |      93    |     549    |     549    |     456    |
|       from small pool |      10    |      17    |      17    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   30761 K  |   30761 K  |
|       from large pool |       3    |     367    |   18777 K  |   18777 K  |
|       from small pool |       0    |    1157    |   11983 K  |   11983 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047

 Experiment start at: 2024-07-29 20:14:55.503155
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8565925, 'precision': 0.51962775, 'recall': 0.56157243, 'specificity': 0.98463166, 'f1': 0.5172245, 'auroc': 0.9145208}
confusion matrix:
     0     1    2     3   4   5     6     7     8   9      10
0   415     2    6     7   0   0     5    21     2   0     25
1     0  1230    2    13   0   0     0    82     4   0      0
2   108     8   48     2   0   0     0    99     0   0     47
3    16     0    5  8059   0   0     2   298    55   0      2
4    70    22   46     1   0   0     2    44     9   0    345
5   319     0   11   113   0   0     0    20     2   0     56
6   200    39    4    25   0   0  1591    17     3   0     29
7     1    12   13   296   0   0     2  6920    14   0      6
8    13    15  433   567   0   0     0   286  1879   0    102
9   371     1   31    10   0   0     0    51     2   0     27
10  218   207  226    20   0   0    30   208    10   0  11874
---- Validation: 
scalar performance:
{'acc': 0.85587806, 'precision': 0.5226201, 'recall': 0.5647379, 'specificity': 0.9845625, 'f1': 0.519219, 'auroc': 0.9151912}
confusion matrix:
     0     1    2     3   4   5     6     7     8   9      10
0   409     1    3    10   0   0     6    27     0   0     27
1     1  1234    3    12   0   0     0    79     2   0      1
2   105     3   66     3   0   0     1    82     0   0     52
3    11     1    8  8078   0   0     1   284    51   0      6
4    75    26   56     2   0   0     1    36     5   0    338
5   318     0    4   119   0   0     0    24     6   0     50
6   194    35    9    27   0   0  1594    20     3   0     26
7     2    14    9   314   0   0     5  6901    13   0      7
8    19    13  470   588   0   0     0   288  1834   0     84
9   377     1   28     7   0   0     0    52     1   0     27
10  209   181  232    20   1   0    27   238     7   0  11881
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52375287, 'precision': 0.4005839, 'recall': 0.43248385, 'specificity': 0.95270157, 'f1': 0.37158537, 'auroc': 0.76934147}
confusion matrix:
      0     1    2    3   4   5     6     7    8   9     10
0   1044     2    1    8   0   0     0   114    0   0     1
1      4  1029   11   20   0   0     0   432    2   0     1
2    399    34  212   27   0   0     0   154   25   0   164
3      0     0    0    0   0   0     0     0    0   0     0
4     47    50   67    2   0   0     5    43    2   0  1417
5    541     0    0   16   0   0     0    17    2   0    16
6    325    89    2   86   0   0  1921    54    6   0   584
7      3     0    0   27   0   0     0  1133    0   0     1
8     52     4  115  592   0   0     0    55  536   0    16
9    767    19  111   27   0   0     0   183   13   0    17
10     1     4   18    1   0   0     4     7    0   0  1611
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 21:40:57.787353,epoch time: 1:26:02.284198,used: 1:26:02.284198,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90892553, 'precision': 0.58567405, 'recall': 0.6104541, 'specificity': 0.98928535, 'f1': 0.5967144, 'auroc': 0.9179799}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   391     1   2     6   0   0    14     8     4   0     57
1     0  1277   2     8   0   0     1    37     4   0      3
2    26     1  62     4   0   0     2    57    12   0    148
3     2     2   1  7895   0   0    11   266   259   0      0
4     7     2  13     5   0   0     1    23    17   0    471
5    29     4   3   275   0   0     0    23    25   0    162
6     9     3   0     3   0   0  1870     1     3   0     17
7    10    43  40   175   0   0     6  6879    88   0     23
8     2     8  68    89   0   0     4    94  2952   0     79
9   104     3  29    48   0   0     1    63    18   0    227
10   22    17  19    17   0   0    23    32    18   0  12646
---- Validation: 
scalar performance:
{'acc': 0.9106861, 'precision': 0.58978, 'recall': 0.6139386, 'specificity': 0.98946595, 'f1': 0.60057974, 'auroc': 0.9189746}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   386     2   0     4   0   0    18    10     3   0     60
1     0  1278   2    10   0   0     0    35     5   0      2
2    25     0  75     0   0   0     2    48    11   0    151
3     4     3   3  7914   0   0     5   266   244   0      1
4     7     3  11     5   0   0     2    17    21   0    473
5    31     3   7   269   0   0     1    20    19   0    171
6    18     3   0     7   0   0  1859     1     3   0     17
7     5    36  52   176   0   0     6  6892    80   0     18
8     2    13  49    99   0   0     2    86  2980   0     65
9   104     3  34    41   0   0     2    53    15   0    241
10   23    14  19    19   0   0    23    22    14   0  12662
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65024835, 'precision': 0.45448104, 'recall': 0.5047451, 'specificity': 0.9646317, 'f1': 0.44912273, 'auroc': 0.80838203}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   984     2   2    6   0   0   165     4     1   0     6
1     3  1264  10   30   0   0     9   161    13   0     9
2    44    33  62   32   0   0     7    61   181   0   595
3     0     0   0    0   0   0     0     0     0   0     0
4     3     4   3    3   0   0     6     3    10   0  1601
5    52     0   0  173   0   0     1    29    16   0   321
6     0     4   0   22   0   0  3028     0     3   0    10
7     3     1   1  110   0   0    10  1033     2   0     4
8     1     4   1   74   0   0     5     2  1277   0     6
9   165    20  51  155   0   0     7    87   195   0   457
10    0     0   0    0   0   0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 23:04:26.327363,epoch time: 1:23:28.540010,used: 2:49:30.824208,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91165453, 'precision': 0.6399511, 'recall': 0.5977695, 'specificity': 0.9890138, 'f1': 0.59373415, 'auroc': 0.9181766}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   405     1   0     1   0   1    15     6     4   0     50
1     0  1292   0     8   0   0     0    23     5   0      4
2    11     2   8     6   0   0     1    39     3   0    242
3     2     4   0  8207   0   0     7   147    64   0      6
4     4     0   0    16   0   1     0     7    16   0    495
5     5     1   0   142   0   0     1     9     4   0    359
6    12     0   0     3   0   2  1871     0     8   0     12
7     2    45   0   256   0   0     3  6893    47   0     18
8     1     1   4   309   0   0     0   108  2819   0     52
9    32     4   0    21   0   1     1    21     0   0    413
10   13    13   1    45   0  28    13    19    82   0  12579
---- Validation: 
scalar performance:
{'acc': 0.9108466, 'precision': 0.6174491, 'recall': 0.5948511, 'specificity': 0.9889522, 'f1': 0.59065056, 'auroc': 0.9179753}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   389     1   0     6   0   5    16     8     7   0     51
1     0  1292   1    12   0   0     0    22     1   0      4
2    15     3   9     8   0   0     1    23     4   0    249
3     3     7   0  8207   0   0     5   145    68   0      5
4     1     3   1     9   0   1     2     8    19   0    495
5     6     1   0   147   0   0     0    12     6   0    349
6    12     3   1     2   0   3  1872     2     2   0     11
7     5    64   6   236   0   0     3  6890    46   0     15
8     4     4   0   288   0   0     0   119  2816   0     65
9    35     3   3    13   0   0     2    16     3   0    418
10   14     6   1    49   0  41    18    23    67   0  12577
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.643042, 'precision': 0.48316282, 'recall': 0.49851328, 'specificity': 0.9639828, 'f1': 0.4449417, 'auroc': 0.81108946}
confusion matrix:
      0     1   2    3   4   5     6    7     8   9     10
0   1025     2   0   10   0   4   103   16     3   0     7
1      0  1314   0   34   0   0     1  141     3   0     6
2     23    24  14   87   0   4     1   50   177   0   635
3      0     0   0    0   0   0     0    0     0   0     0
4      2     4   0   12   0   2     3    3    18   0  1589
5     19     1   0   91   0   1     0   18     5   0   457
6      1    17   0   28   0  16  2980    5     7   0    13
7      1     5   0  149   0   0     7  996     1   0     5
8      0     1   0  116   0   1     0   20  1226   0     6
9    104    19   7  132   0   0     2  129   119   0   625
10     0     1   0    1   0   3     0    0     6   0  1635
better model found
persisted
after epoch: 3,now: 2024-07-30 00:30:48.855559,epoch time: 1:26:22.528196,used: 4:15:53.352404,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9121629, 'precision': 0.60047543, 'recall': 0.5927063, 'specificity': 0.9894998, 'f1': 0.58344376, 'auroc': 0.93374795}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   401     1   0    13   0   0    15    21     3   0     29
1     0  1233   1    15   0   0     0    81     2   0      0
2    34     0   7    10   0   0     1   141     8   0    111
3     0     0   0  8282   0   0     1   120    36   0      0
4    13     0   3     7   0   1     1    40    37   0    437
5    12     0   0   321   0   0     0    46     4   0    138
6    23     1   0     8   0   1  1855     3     1   0     16
7     0     4   2   277   0   0     2  6942    30   0      6
8     1     1   1   313   0   0     0   142  2796   0     40
9    96     0   0    77   0   0     0   106     7   0    207
10   18     7   8    24   0   2    35    85    36   0  12577
---- Validation: 
scalar performance:
{'acc': 0.91127455, 'precision': 0.5951333, 'recall': 0.5903559, 'specificity': 0.98938596, 'f1': 0.5814413, 'auroc': 0.93395966}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   397     5   1    11   0   0    21    14     2   0     32
1     0  1229   0    18   0   0     0    84     1   0      0
2    41     0   5    11   0   0     1   127     6   0    121
3     0     0   0  8289   0   0     0   116    35   0      0
4    11     2   1     9   0   0     1    44    32   0    439
5     8     0   1   311   0   0     0    59     9   0    133
6    16     1   0     9   0   0  1853     6     7   0     16
7     0     4   2   264   0   0     1  6961    25   0      8
8     1     1   5   335   0   0     1   139  2768   0     46
9    89     0   0    74   0   0     0   116     5   0    209
10   22     7   4    28   0   1    32    83    53   0  12566
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6409431, 'precision': 0.45621264, 'recall': 0.49604797, 'specificity': 0.9641125, 'f1': 0.43599075, 'auroc': 0.8182918}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   980     1   1   26   0   0   101    57     3   0     1
1     0  1225   0   40   0   0     2   226     1   0     5
2    70    26  32   55   0   0    34   192   157   0   449
3     0     0   0    0   0   0     0     0     0   0     0
4     2     9   2    3   0   1    34     7    14   0  1561
5    36     0   0  322   0   0     1    80    10   0   143
6     0     0   0   32   0   0  3030     3     1   0     1
7     0     1   0   78   0   0     0  1083     0   0     2
8     1     0   0  165   0   0     3    19  1177   0     5
9   185    19  18  244   0   0    14   353    95   0   209
10    0     0   0    2   0   0     7     2     1   0  1634
better model found
persisted
after epoch: 4,now: 2024-07-30 01:53:45.582988,epoch time: 1:22:56.727429,used: 5:38:50.079833,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9152932, 'precision': 0.61748576, 'recall': 0.60192406, 'specificity': 0.98963195, 'f1': 0.59649044, 'auroc': 0.93388927}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   411     0   0     0   0   0     8    16     1   0     47
1     0  1287   0     7   0   0     0    32     3   0      3
2    11     0  14     0   0   0     3   123     1   0    160
3     3     2   0  7973   0   0     1   356   100   0      3
4     4     0   0     1   0   0     1    19     4   0    510
5    15     0   0   180   0   0     1    83     5   0    237
6     8     0   0     0   0   1  1874     3     1   0     20
7     1    25   9    70   0   0     1  7088    39   0     28
8     1     3   4   156   0   0     0   142  2836   0    153
9    66     0   9    13   0   0     4   196     3   0    202
10   14     0   0     9   0   1    15    24     5   0  12727
---- Validation: 
scalar performance:
{'acc': 0.9156881, 'precision': 0.6187626, 'recall': 0.60242754, 'specificity': 0.9896933, 'f1': 0.59647334, 'auroc': 0.93323505}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   409     1   0     0   0   0     9    17     2   0     45
1     0  1288   1     8   0   0     0    30     3   0      2
2    11     1  15     1   0   0     2   119     0   0    163
3     1     2   0  7940   0   0     1   375   118   0      3
4     4     0   0     1   0   0     1    20     4   0    509
5    19     0   1   183   0   0     0    89     4   0    225
6     8     0   0     2   0   1  1876     4     1   0     16
7     0    28   8    51   0   0     2  7109    36   0     31
8     0     4   4   136   0   0     0   149  2857   0    146
9    74     0   6    12   0   0     2   177     3   0    219
10   14     0   1     3   0   1    13    23     2   0  12739
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66207236, 'precision': 0.43491405, 'recall': 0.5181289, 'specificity': 0.96593285, 'f1': 0.44983655, 'auroc': 0.8197065}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1115     0   0    5   0   0     7    35     2   0     6
1      0  1365   0   22   0   0     0    93     2   0    17
2     49    12   7   15   0   0     1   122    56   0   753
3      0     0   0    0   0   0     0     0     0   0     0
4      1     0   0    0   0   0     3     1     3   0  1625
5     58     0   0  165   0   0     0   116     8   0   245
6      1     3   0   36   0   5  2988     5     3   0    26
7      2     1   1   27   0   0     2  1123     0   0     8
8      6     3   1   69   0   0     1    31  1220   0    39
9    139    16  30   80   0   0     3   414    65   0   390
10     0     0   0    0   0   0     0     0     1   0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-30 03:18:41.859359,epoch time: 1:24:56.276371,used: 7:03:46.356204,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92010915, 'precision': 0.6084507, 'recall': 0.60024256, 'specificity': 0.99070346, 'f1': 0.58000374, 'auroc': 0.9485712}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   392     0   0     4   0   0    28    22     7   0     30
1     0  1280   0    13   0   0     0    26     8   0      4
2    45     0   1     1   0   0     3   179    11   0     72
3     1     0   0  8272   0   0     0    98    67   0      0
4    13     0   0     6   0   0     8    52    25   0    435
5    18     0   0   263   0   0     2   161     4   0     73
6     7     1   0     2   0   0  1879     5     3   0     10
7     0    17   0   228   0   0     2  6944    64   0      8
8     1     3   0   167   0   0     0    68  3033   0     23
9   180     0   0    32   0   0     2   217     3   0     59
10   20     5   1    20   0   0    42    76    41   0  12589
---- Validation: 
scalar performance:
{'acc': 0.92026216, 'precision': 0.5740672, 'recall': 0.6004263, 'specificity': 0.99075043, 'f1': 0.57883847, 'auroc': 0.9476573}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   390     0   0     5   0   0    35    20     2   0     31
1     0  1291   1     9   0   0     0    24     6   0      1
2    52     0   1     2   0   0     1   178     9   0     69
3     0     1   0  8267   0   0     4    96    72   0      0
4    17     0   1     2   0   0     1    62    30   0    426
5    21     0   0   264   0   0     4   157     4   0     71
6    12     0   0     3   0   0  1874     6     3   0     10
7     1    15   1   220   0   0     3  6953    67   0      5
8     2     1   1   149   0   0     0    67  3040   0     36
9   181     0   2    22   0   0     1   227     0   0     60
10   22     3   0    22   0   0    63    65    33   0  12588
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6311481, 'precision': 0.42352608, 'recall': 0.48422435, 'specificity': 0.9631694, 'f1': 0.42479354, 'auroc': 0.81487}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   909     1   0   23   0   0   174   47    10   0     6
1     0  1281   2   34   0   0    11  153     5   0    13
2    55    26   2   46   0   0     5  238   179   0   464
3     0     0   0    0   0   0     0    0     0   0     0
4     2     0   0    3   0   0    12    8     8   0  1600
5    24     0   0  329   0   0     2  171    10   0    56
6     0     7   0   35   0   0  3006    2     9   0     8
7     0     0   0  205   0   0     2  953     2   0     2
8     0     0   0  122   0   0     0   13  1230   0     5
9   121     6   3  226   0   0     5  515   121   0   140
10    0     0   0    1   0   0     4    1     0   0  1640
better model found
persisted
after epoch: 6,now: 2024-07-30 04:45:50.503697,epoch time: 1:27:08.644338,used: 8:30:55.000542,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.91325986, 'precision': 0.5625261, 'recall': 0.59905446, 'specificity': 0.9897834, 'f1': 0.57535195, 'auroc': 0.9443237}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   438     0   0     1   0   0     0    18     0   0     26
1     0  1282   0     7   0   0     0    37     3   0      3
2    30     0   0     0   0   0     1   187     1   0     93
3     4     0   0  8036   0   0     1   271   122   0      3
4    13     0   0     0   0   0     0    47     2   0    477
5    41     1   0   140   0   0     0   221     5   0    113
6    32     7   0     4   0   0  1845     4     1   0     14
7     5    10   0    70   0   0     2  7149     9   0     17
8    12     4   0    62   0   0     0   303  2724   0    191
9   199     1   0     2   0   0     0   236     0   0     54
10   46     4   0     5   0   0     4    75     1   0  12660
---- Validation: 
scalar performance:
{'acc': 0.9132272, 'precision': 0.5624622, 'recall': 0.59850824, 'specificity': 0.9897869, 'f1': 0.5749707, 'auroc': 0.94422024}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   436     0   0     0   0   0     1    21     0   0     25
1     0  1282   0     6   0   0     0    40     3   0      1
2    33     0   0     0   0   0     2   180     1   0     96
3     7     1   0  8042   0   0     0   264   124   0      2
4    23     0   0     0   0   0     0    40     1   0    475
5    37     0   0   130   0   0     1   231     5   0    117
6    29     3   0     3   0   0  1846     7     1   0     19
7     1    10   0    68   0   0     1  7162     6   0     17
8     6     3   0    68   0   0     0   331  2712   0    176
9   207     1   0     4   0   0     0   225     2   0     54
10   44     3   0     7   0   0     4    76     1   0  12661
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6349262, 'precision': 0.47953492, 'recall': 0.5017233, 'specificity': 0.9633472, 'f1': 0.42116383, 'auroc': 0.8290767}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1150     0   0    6   0   0     1    12     1   0     0
1      0  1286   0   22   0   0     3   180     0   0     8
2    210    15   1    8   0   0     1   271    41   0   468
3      0     0   0    0   0   0     0     0     0   0     0
4      6     1   0    1   0   0     1    14     0   0  1610
5     75     5   0  102   0   0     0   236    13   0   161
6    112    69   0   21   0   0  2735    15     9   0   106
7      2     0   0   92   0   0     0  1068     0   0     2
8      4     7   0   64   0   0     1    50  1189   0    55
9    382    13   0   34   0   0     1   517    38   0   152
10     0     0   0    0   0   0     0     0     0   0  1646
early stop counter: 1
val acc:0.9132272005081177, best validation acc: 0.9202621579170227, corresponding to test acc:                         0.631148099899292 / 0.6620723605155945
after epoch: 7,now: 2024-07-30 06:16:16.511124,epoch time: 1:30:26.007427,used: 10:01:21.007969,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9221693, 'precision': 0.6476038, 'recall': 0.61271256, 'specificity': 0.99080515, 'f1': 0.61316085, 'auroc': 0.939812}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   399     0   0     1   0   0     2    19     0   0     62
1     0  1260   0     4   0   0     0    61     4   0      3
2    12     0   0     0   0   1     2   107     8   0    182
3     0     0   0  8057   0   0     1   235   143   0      2
4     2     0   0     2   0   1     0     9     8   0    517
5     6     0   0    46   0  96    51    17   284   0     21
6    34     4   0     3   0   1  1809     8     3   0     44
7     0     4   0    79   0   0     1  7132    36   0     12
8     1     0   0    79   0   0     1   126  2971   0    117
9    48     0   0     8   0  25    70   186    59   0     97
10    7     0   0     9   0   0     2    26     6   0  12743
---- Validation: 
scalar performance:
{'acc': 0.92264277, 'precision': 0.6486161, 'recall': 0.6131317, 'specificity': 0.99086344, 'f1': 0.6139629, 'auroc': 0.9409719}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   402     0   0     0   0   0     2    17     1   0     61
1     0  1253   0     6   0   0     0    64     3   0      6
2    13     0   0     2   0   1     1   113     9   0    173
3     0     0   0  8074   0   0     1   214   150   0      1
4     1     1   0     4   0   0     0     9    10   0    514
5     6     0   0    40   0  97    52    14   296   0     16
6    32     6   0     5   0   0  1808    14     5   0     38
7     0     4   0    82   0   0     1  7139    26   0     13
8     0     1   0    79   0   0     0   120  2974   0    122
9    47     0   0     8   0  27    72   175    55   0    109
10    3     1   0     7   0   0     4    31     4   0  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62653047, 'precision': 0.46832848, 'recall': 0.5049499, 'specificity': 0.96230525, 'f1': 0.44408402, 'auroc': 0.8071858}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1091     0   0   30   0   0     2    30    11   0     6
1      2  1182   1   34   0   0     4   226     0   0    50
2     33     1   0   29   0   1     5    85   134   0   727
3      0     0   0    0   0   0     0     0     0   0     0
4      2     0   0    0   0   0     1     2     3   0  1625
5     24     0   0  115   0  65    55    48   258   0    27
6     18    22   0  101   0   0  2596    17    11   0   302
7      1     0   0   48   0   0     0  1111     0   0     4
8      2     0   0   69   0   0     1     9  1265   0    24
9     91     2   1  122   0  21    70   259   294   0   277
10     0     0   0    0   0   0     0     0     1   0  1645
better model found
persisted
after epoch: 8,now: 2024-07-30 07:49:39.968575,epoch time: 1:33:23.457451,used: 11:34:44.465420,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9301691, 'precision': 0.6824428, 'recall': 0.6458163, 'specificity': 0.9921789, 'f1': 0.6403971, 'auroc': 0.95123744}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   419     0   0     1   0    0     7    29     2   0     25
1     0  1295   0     4   0    0     0    28     5   0      0
2    12     1   4     0   0    4     7   251    12   0     21
3     0     3   0  8171   0    2     1   144   117   0      1
4     4     3   2     1   0    1     2   125    25   0    376
5     6     0   2     9   0  203   100    12   185   0      4
6    11     1   0     2   0    1  1880     2     2   0      8
7     0    13   0    80   0    0     1  7124    41   0      4
8     2     2   0    66   0    2     1    78  3116   0     29
9    69     0   1     1   0   43   157   188    20   0     14
10   14     9   1     6   0    0    16   147    44   0  12554
---- Validation: 
scalar performance:
{'acc': 0.92922294, 'precision': 0.67406374, 'recall': 0.6452999, 'specificity': 0.9920748, 'f1': 0.6399776, 'auroc': 0.9510337}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   423     0   0     3   0    0     3    23     4   0     27
1     0  1298   0     3   0    0     1    27     3   0      0
2    11     0   5     0   0    2     6   254    12   0     22
3     1     1   0  8176   0    1     1   147   111   0      2
4     2     3   4     0   0    5     5   110    24   0    386
5     7     0   2    11   0  198   107     9   184   0      3
6     7     1   0     2   0    1  1875     7     5   0     10
7     0    14   0    88   0    0     1  7107    50   0      5
8     0     5   0    69   0    1     0    96  3102   0     23
9    73     0   3     4   0   41   164   175    22   0     11
10   12    13   2     6   0    1    19   148    40   0  12555
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6697684, 'precision': 0.51150423, 'recall': 0.53689414, 'specificity': 0.96658266, 'f1': 0.47068858, 'auroc': 0.8396179}
confusion matrix:
      0     1   2   3   4    5     6     7     8   9     10
0   1064     0   0  21   0    0     6    60    16   0     3
1      0  1296   0  25   0    0     0   172     3   0     3
2     18     8   4   4   0    6    31   442   216   0   286
3      0     0   0   0   0    0     0     0     0   0     0
4      2     0   0   1   0    0     1    32    15   0  1582
5     22     0   0  70   0  147    98    34   199   0    22
6      0     3   0  20   0    0  3016     3    15   0    10
7      0     0   0  45   0    0     0  1116     1   0     2
8      0     0   0  75   0    0     1     7  1286   0     1
9     65     8   4  57   0   43   142   515   248   0    55
10     0     0   0   0   0    0     0     0     2   0  1644
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-30 09:21:14.959862,epoch time: 1:31:34.991287,used: 13:06:19.456707,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.925594, 'precision': 0.6731776, 'recall': 0.620772, 'specificity': 0.99126923, 'f1': 0.62279814, 'auroc': 0.95440996}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   427     0   0     3   0   0     1    15     2   0     35
1     0  1304   0     6   0   0     1    17     3   0      1
2     3     0   0     4   0   0     0   245     8   0     52
3     0     2   0  8331   0   2     0    67    36   0      2
4     3     2   0     3   0   0     1    60    13   0    457
5     2     0   0    51   0  81     2    22   338   0     25
6     6     1   0     6   0   0  1871     5     2   0     16
7     0    14   0   250   0   0     1  6961    32   0      5
8     1     2   0   218   0   0     0    81  2939   0     54
9    15     0   0    11   0   7     4   267    96   0     93
10   10     2   0    22   0   0     8    55    13   0  12681
---- Validation: 
scalar performance:
{'acc': 0.9251571, 'precision': 0.6724502, 'recall': 0.62084067, 'specificity': 0.9912194, 'f1': 0.62232375, 'auroc': 0.9544546}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   428     1   0     2   0   0     1    10     2   0     39
1     0  1303   0     6   0   0     1    20     2   0      0
2     6     0   0     2   0   0     0   238     6   0     60
3     0     2   0  8330   0   1     0    74    30   0      3
4     1     3   0     3   0   0     1    61    15   0    455
5     4     1   0    43   0  83     4    11   347   0     28
6    11     3   0     3   0   0  1867     1     4   0     19
7     0    22   0   263   0   0     1  6936    37   0      6
8     1     0   0   225   0   1     0    75  2944   0     50
9    12     0   0    10   0   6     8   274    86   0     97
10   11     1   0    13   0   0     5    52    18   0  12696
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6109284, 'precision': 0.5020634, 'recall': 0.4882902, 'specificity': 0.96146667, 'f1': 0.43995422, 'auroc': 0.8074185}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1068     1   0   40   0   0     2    49     4   0     6
1      0  1242   0   45   0   0     3   200     0   0     9
2     24     2   0   56   0   1     1   172   112   0   647
3      0     0   0    0   0   0     0     0     0   0     0
4      2     1   0    3   0   0     0     3     3   0  1621
5     13     0   0  300   0  26     0    29   112   0   112
6      7     9   0  371   0   0  2521     7    29   0   123
7      0     0   0  104   0   0     0  1058     0   0     2
8      0     0   0  177   0   0     0    10  1173   0    10
9     52     4   0  295   0   1     1   326   108   0   350
10     0     0   0    0   0   0     0     1     1   0  1644
early stop counter: 1
val acc:0.9251571297645569, best validation acc: 0.9292229413986206, corresponding to test acc:                         0.6697683930397034 / 0.6697683930397034
after epoch: 10,now: 2024-07-30 11:03:40.960123,epoch time: 1:42:26.000261,used: 14:48:45.456968,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 14:48:45.456968 at 2024-07-30 11:03:40.960123
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6697684, 'precision': 0.51150423, 'recall': 0.53689414, 'specificity': 0.96658266, 'f1': 0.47068858, 'auroc': 0.8396179}
confusion matrix:
      0     1   2   3   4    5     6     7     8   9     10
0   1064     0   0  21   0    0     6    60    16   0     3
1      0  1296   0  25   0    0     0   172     3   0     3
2     18     8   4   4   0    6    31   442   216   0   286
3      0     0   0   0   0    0     0     0     0   0     0
4      2     0   0   1   0    0     1    32    15   0  1582
5     22     0   0  70   0  147    98    34   199   0    22
6      0     3   0  20   0    0  3016     3    15   0    10
7      0     0   0  45   0    0     0  1116     1   0     2
8      0     0   0  75   0    0     1     7  1286   0     1
9     65     8   4  57   0   43   142   515   248   0    55
10     0     0   0   0   0    0     0     0     2   0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6697684, 'precision': 0.51150423, 'recall': 0.53689414, 'specificity': 0.96658266, 'f1': 0.47068858, 'auroc': 0.8396179}
confusion matrix:
      0     1   2   3   4    5     6     7     8   9     10
0   1064     0   0  21   0    0     6    60    16   0     3
1      0  1296   0  25   0    0     0   172     3   0     3
2     18     8   4   4   0    6    31   442   216   0   286
3      0     0   0   0   0    0     0     0     0   0     0
4      2     0   0   1   0    0     1    32    15   0  1582
5     22     0   0  70   0  147    98    34   199   0    22
6      0     3   0  20   0    0  3016     3    15   0    10
7      0     0   0  45   0    0     0  1116     1   0     2
8      0     0   0  75   0    0     1     7  1286   0     1
9     65     8   4  57   0   43   142   515   248   0    55
10     0     0   0   0   0    0     0     0     2   0  1644
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_20_14_54_seed_1_23200047_instance_wise_predictions.txt
accuracy from prediction file 0.6697684181067656
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/33.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/33.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |   1648 MiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      7 MiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |   1648 MiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      7 MiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB |   1633 TiB |   1633 TiB |
|       from large pool |   1647 MiB |  19328 MiB |   1622 TiB |   1622 TiB |
|       from small pool |      6 MiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20092 MiB |  20112 MiB |  38324 MiB |  18232 MiB |
|       from large pool |  20058 MiB |  20078 MiB |  38276 MiB |  18218 MiB |
|       from small pool |     34 MiB |     34 MiB |     48 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231478 KiB | 783421 KiB | 235181 GiB | 235180 GiB |
|       from large pool | 216320 KiB | 781120 KiB | 223334 GiB | 223334 GiB |
|       from small pool |  15158 KiB |  18642 KiB |  11846 GiB |  11846 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |  107210 K  |  107207 K  |
|       from large pool |     247    |     691    |   54563 K  |   54563 K  |
|       from small pool |    2419    |    3627    |   52647 K  |   52644 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |  107210 K  |  107207 K  |
|       from large pool |     247    |     691    |   54563 K  |   54563 K  |
|       from small pool |    2419    |    3627    |   52647 K  |   52644 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     565    |     566    |    1028    |     463    |
|       from large pool |     548    |     549    |    1004    |     456    |
|       from small pool |      17    |      17    |      24    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     120    |    1251    |   61400 K  |   61400 K  |
|       from large pool |      95    |     367    |   37601 K  |   37601 K  |
|       from small pool |      25    |    1157    |   23798 K  |   23798 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |  16640 KiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      0 KiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |   1639 TiB |   1639 TiB |
|       from large pool |  16640 KiB |  19381 MiB |   1628 TiB |   1628 TiB |
|       from small pool |      0 KiB |     32 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |   1633 TiB |   1633 TiB |
|       from large pool |  16640 KiB |  19328 MiB |   1622 TiB |   1622 TiB |
|       from small pool |      0 KiB |     31 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20112 MiB |  38324 MiB |  36442 MiB |
|       from large pool |   1860 MiB |  20078 MiB |  38276 MiB |  36416 MiB |
|       from small pool |     22 MiB |     34 MiB |     48 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 783421 KiB | 235182 GiB | 235182 GiB |
|       from large pool |  24320 KiB | 781120 KiB | 223335 GiB | 223335 GiB |
|       from small pool |      0 KiB |  20690 KiB |  11846 GiB |  11846 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |  107210 K  |  107210 K  |
|       from large pool |       2    |     691    |   54563 K  |   54563 K  |
|       from small pool |       0    |    3627    |   52647 K  |   52647 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |  107210 K  |  107210 K  |
|       from large pool |       2    |     691    |   54563 K  |   54563 K  |
|       from small pool |       0    |    3627    |   52647 K  |   52647 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     566    |    1028    |     924    |
|       from large pool |      93    |     549    |    1004    |     911    |
|       from small pool |      11    |      17    |      24    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   61401 K  |   61401 K  |
|       from large pool |       3    |     367    |   37601 K  |   37601 K  |
|       from small pool |       0    |    1157    |   23799 K  |   23799 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 30 11:23:01 2024]
Finished job 0.
1 of 1 steps (100%) done
