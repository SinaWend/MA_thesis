Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 15:50:06 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508

 Experiment start at: 2024-07-27 16:14:25.246225
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.12040859460830688
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9341556, 'precision': 0.84744215, 'recall': 0.7957879, 'specificity': 0.99283177, 'f1': 0.81077194, 'auroc': 0.99502325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   356     0    0     1    0    1    27     2     8    3     84
1     0  1264    0     8    0    1     1    48     3    0      7
2     5     1  157     1   67    9     0    10     5   48      9
3     1     2    0  7694    0   32    11   310   384    2      2
4     2     0   16     1  274    5     0     1    29    7    203
5     2     0    1    26    0  468     1     0     8   14      1
6    17     0    0     0    0    2  1847     6    10    1     25
7     0    27    0   138    3    1     3  6874   178    1     39
8     1     2    0    52   17    5     3    50  3088    3     74
9     9     1   33     1    8  219     2     6    12  197      5
10    4     0    2     6   27    2    14    13    29    0  12696
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9342784, 'precision': 0.84395725, 'recall': 0.7947097, 'specificity': 0.99285614, 'f1': 0.80889845, 'auroc': 0.9951044}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   369     0    0     3    0    0    19     4     8    1     79
1     0  1267    0     9    0    0     0    43     7    0      6
2     6     2  142     2   62   11     2     6     8   55     16
3     1     2    0  7706    2   36     4   295   391    1      2
4     2     0   11     0  278    2     1     2    33    9    201
5     5     0    1    22    1  461     0     0    10   20      1
6    19     1    1     1    0    2  1843     4     8    0     29
7     1    20    2   145    3    1     7  6858   186    0     42
8     0     2    3    42   15    4     5    54  3105    0     66
9     6     0   36     3    3  224     0     3     9  204      5
10    8     0    2     6   28    1     9    10    36    1  12695
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6885189, 'precision': 0.6286484, 'recall': 0.60246533, 'specificity': 0.96876484, 'f1': 0.56759876, 'auroc': 0.882361}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1044     2    0   13    0    5    55    13    16    2    20
1      2  1237    0   30    0    0     2   182    15    0    31
2     28    15  184   15  246   63     2    31   247   40   144
3      0     0    0    0    0    0     0     0     0    0     0
4      1     1    3    0  208    0     0     0    28    0  1392
5     32     0    0   84    2  449     1     0    10   13     1
6      0     3    1    2    5    0  2555     4   324    0   173
7      2     1    1   24    0    1     5  1117     8    0     5
8      6     0    1   89    3    4     5     6  1252    3     1
9     61    37  147  112   19  325    10    66   167  167    26
10     0     0    0    0   16    0     1     0     1    0  1628
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 16:58:58.958724,epoch time: 0:44:33.712499,used: 0:44:33.712499,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95154643, 'precision': 0.8759839, 'recall': 0.84184, 'specificity': 0.994718, 'f1': 0.84576046, 'auroc': 0.99736965}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   403     1    1     6    2    0    14     3     3    1     48
1     0  1289    0     7    0    0     0    31     2    0      2
2     2     0  252     1   21    5     1     6     3   15      6
3     0     2    1  8006    0   14     2   251   161    0      0
4     2     1   47     1  291    3     0     5    20    3    166
5     0     0    3    20    0  474     0     1    10   12      1
6    12     0    3     7    3    1  1846     8     3    2     23
7     1    37    1   115    1    0     1  7052    49    1      7
8     1     4    5    55   13    1     1    90  3078    1     45
9     2     0  107     8    0  171     1     6     6  190      2
10   13     0    6     6   29    2     7    22    25    0  12684
---- Validation: 
scalar performance:
{'acc': 0.9521198, 'precision': 0.8831068, 'recall': 0.847118, 'specificity': 0.99476737, 'f1': 0.851096, 'auroc': 0.9974681}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     1    0     4    2    1     9     4     1    3     47
1     0  1291    1    11    0    0     0    27     1    0      1
2     2     0  256     1   18    3     1     7     2   15      7
3     0     3    0  8008    0   19     0   248   162    0      0
4     3     1   43     1  304    0     2     4    17    1    163
5     0     0    3    21    0  478     0     0     6   12      1
6     7     1    2     4    1    2  1863     9     5    0     14
7     0    33    2   117    1    0     2  7051    48    1     10
8     0     5    5    59    9    3     1   104  3057    0     53
9     0     0  103     6    0  182     1     6     5  188      2
10   14     0    5     6   21    2     8    23    29    0  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70894843, 'precision': 0.67221326, 'recall': 0.6123987, 'specificity': 0.97100973, 'f1': 0.58955264, 'auroc': 0.8857456}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1042     3    0   31    0   14    37    15     8    8    12
1      2  1334    2   32    1    0     0   104     4    0    20
2      7    10  292   31   96   40     5    25   267   25   217
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    6    0  140    0     1     0    22    0  1464
5      4     0    0  141    0  418     1     0    16    9     3
6      0     5    1    2    3    0  2786     3   141    0   126
7      1     0    1   81    0    0     2  1069     6    0     4
8      0     0    1   97    0    0     3     4  1261    2     2
9     10    22  201  245    5  245     4    57   179  151    18
10     0     0    1    0    4    0     0     0     1    0  1640
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 17:41:07.716738,epoch time: 0:42:08.758014,used: 1:26:42.470513,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96091074, 'precision': 0.90480745, 'recall': 0.8682948, 'specificity': 0.9957193, 'f1': 0.88523936, 'auroc': 0.9980892}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     3    1    0    15     4     5    3     33
1     0  1282    0    17    0    0     0    29     3    0      1
2     3     0  197     2   49    1     0     6     5   47      2
3     1     0    0  8229    0    5     2   138    62    0      0
4     2     1   16     1  374    1     1     2    29    6    106
5     0     0    1    45    0  414     0     0     6   54      1
6     6     0    1     0    0    0  1877     3     6    0     15
7     1    13    0   157    1    0     1  7036    48    1      5
8     1     0    2   133    4    3     3    74  3057    0     19
9     1     1   33     9    4   58     2     3     6  373      3
10    9     0    2     6   40    0    12    11    54    1  12657
---- Validation: 
scalar performance:
{'acc': 0.9595292, 'precision': 0.9040036, 'recall': 0.8668464, 'specificity': 0.9955655, 'f1': 0.8839146, 'auroc': 0.9981443}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     1    0     5    1    0    14     4     4    0     32
1     0  1287    0    11    0    0     1    30     1    0      2
2     3     0  194     1   50    1     1    13     6   40      3
3     2     1    0  8197    0    7     4   169    59    1      0
4     4     0   16     0  372    2     1     2    28    4    110
5     1     0    0    45    0  407     1     0     6   60      1
6     5     0    1     2    0    0  1886     1     4    0      9
7     0    15    0   159    1    0     3  7040    39    1      7
8     1     0    2   145    3    2     1    82  3048    0     12
9     1     0   32    10    0   60     3     4     6  375      2
10   15     0    2     7   35    0    15    16    61    1  12644
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73413557, 'precision': 0.65981984, 'recall': 0.6322504, 'specificity': 0.9733088, 'f1': 0.6158206, 'auroc': 0.88636315}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1079     2    1    8    0    6    34    12    16    7     5
1      0  1263    0   33    1    0     1   168    11    0    22
2      9     0  138   13  331   19     6    29   275   77   118
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    0    0  252    0     1     1    28    0  1349
5      8     0    2   69    2  417     1     0     5   86     2
6      0     0    0    3    3    0  2908     2    93    0    58
7      0     0    0   43    0    0     4  1110     2    2     3
8      0     0    0   95    0    2     8     9  1254    2     0
9     18     5  115  108   37  164     9    74   153  439    15
10     0     0    0    0   10    0     1     1     1    0  1633
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 18:23:00.259098,epoch time: 0:41:52.542360,used: 2:08:35.012873,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96013486, 'precision': 0.89767766, 'recall': 0.8959576, 'specificity': 0.9957226, 'f1': 0.8951334, 'auroc': 0.9985038}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    1     2    1    1    35     0     2    3     26
1     0  1300    0    10    0    0     2    16     1    0      3
2     1     0  245     0   26    4     2     2     3   29      0
3     2     1    1  8233    1   24     6    48   119    1      1
4     3     0   20     0  424    1     3     0     9    5     74
5     0     0    0    12    0  480     1     0     3   24      1
6     1     0    1     1    1    0  1893     1     2    0      7
7     0    22    8   296    2    0    10  6803   104    3     16
8     1     2    8    67   24    4     4    23  3113    1     49
9     1     0   28     2    1  110     1     2     2  343      3
10    7     0    3     7   89    0    32     1    12    1  12640
---- Validation: 
scalar performance:
{'acc': 0.9599305, 'precision': 0.8871321, 'recall': 0.890475, 'specificity': 0.9957423, 'f1': 0.88701576, 'auroc': 0.99848586}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    1     1    4    0    36     0     1    4     24
1     0  1303    0     8    0    0     0    18     3    0      0
2     1     1  232     0   33    1     2     1     2   36      3
3     3     2    3  8254    0   23    10    38   105    1      1
4     5     0   19     0  426    1     3     1     9    5     70
5     0     0    0    10    1  480     0     0     4   25      1
6     2     0    1     0    0    1  1889     0     4    3      8
7     1    32    7   288    1    0    10  6796   109    1     20
8     3     0    6    57   33    6     1    18  3125    4     43
9     0     0   32     3    1  124     1     1     1  330      0
10    9     0    7     7   96    0    24     1     9    3  12640
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70034283, 'precision': 0.6772917, 'recall': 0.6011201, 'specificity': 0.9699583, 'f1': 0.6108436, 'auroc': 0.88754153}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   985     0    0    9    1    3   136    2     5   23     6
1     1  1268    1   40    2    0     0  142     5    0    40
2    10     0  251   16  245   13    14   22   174   90   180
3     0     0    0    0    0    0     0    0     0    0     0
4     1     0    3    0  349    0     1    0     8    0  1271
5     5     0    2   99    2  347     3    0     3  125     6
6     0     0    1    3    5    0  2656    3    41    0   358
7     2     0    0  251    0    0    27  871     4    2     7
8     0     0    1  128    6    0    12    5  1210    3     5
9    11     3  130  187    5  148    15   47   117  443    31
10    0     0    0    0   15    0     1    0     0    0  1630
better model found
persisted
after epoch: 4,now: 2024-07-27 19:05:14.486841,epoch time: 0:42:14.227743,used: 2:50:49.240616,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9667166, 'precision': 0.92111963, 'recall': 0.8803407, 'specificity': 0.99629843, 'f1': 0.89612585, 'auroc': 0.99890953}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     2    1    0     1     1     0    0      8
1     0  1283    0     7    0    0     0    41     1    0      0
2     5     0  189     2   47    4     0    18     7   37      3
3     0     0    0  8346    0    2     0    62    24    0      0
4     8     1    6     0  376    0     0     3    14    2    129
5     1     0    0    35    0  466     0     0     3   15      1
6    22     0    0     5    0    0  1861     3     3    2     12
7     1     6    0   162    1    0     1  7084     6    0      4
8     2     2    0   148    5    1     0    96  3017    0     24
9     5     0   14    12    3  100     0     6     6  346      1
10   38     0    1     8   17    1     4    15    16    0  12694
---- Validation: 
scalar performance:
{'acc': 0.9666979, 'precision': 0.9216413, 'recall': 0.87980616, 'specificity': 0.9962992, 'f1': 0.89644516, 'auroc': 0.99884564}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     3    0    0     1     2     0    0     11
1     0  1293    0     7    0    0     0    31     1    0      0
2     4     0  193     2   42    2     0    17     3   44      5
3     0     0    0  8353    0    3     0    65    19    0      0
4     8     0    6     1  373    1     0     2    19    3    126
5     1     0    0    41    0  457     1     0     3   17      1
6    14     0    0     8    0    2  1872     0     3    2      7
7     0     6    0   160    1    0     2  7074    16    0      6
8     1     2    1   149    4    0     0   102  3020    0     17
9     2     0   14    15    2  104     0     6     4  346      0
10   41     0    0     8   13    2     2    17    20    0  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68788916, 'precision': 0.65219545, 'recall': 0.59374285, 'specificity': 0.9689791, 'f1': 0.58079964, 'auroc': 0.883173}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1124     1    0   11    0    5     5    12     1    8     3
1      0  1229    0   33    2    0     0   215     3    0    17
2     17     1  165   42  140   20     0    89   205   88   248
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    2    0   89    0     1     3    14    0  1521
5      5     0    1  142    1  359     1     0     1   79     3
6      5     0    0   12    2    0  2662     4    84    0   298
7      0     0    0  103    0    0     0  1057     0    1     3
8      1     0    1  206    0    0     4    14  1141    2     1
9     28     4   85  268    4  158     1   140    57  366    26
10     0     0    0    0    5    0     0     0     1    0  1640
better model found
persisted
after epoch: 5,now: 2024-07-27 19:47:26.067831,epoch time: 0:42:11.580990,used: 3:33:00.821606,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97388697, 'precision': 0.9289885, 'recall': 0.91926837, 'specificity': 0.9971602, 'f1': 0.9213412, 'auroc': 0.9993127}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    0    0     2     1     0    1      9
1     0  1307    0     3    0    0     0    21     1    0      0
2     0     0  255     0   14    0     0     1     2   37      3
3     8     1    2  8232    0    5     2   122    59    7      1
4     4     0   17     0  413    1     1     0     6    1     96
5     0     0    2     8    0  395     0     0     3  112      1
6    17     0    0     0    2    0  1871     0     1    2     13
7     7     5    2    79    2    0     1  7145    15    2      7
8     0     1    6    48   11    2     3    60  3128    6     29
9     0     0   19     2    1   11     0     0     1  459      0
10   18     1    2     7   14    0     5     5    15    0  12726
---- Validation: 
scalar performance:
{'acc': 0.97402704, 'precision': 0.9291138, 'recall': 0.92010564, 'specificity': 0.9971773, 'f1': 0.92177826, 'auroc': 0.99937606}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    0    0     2     0     0    1      8
1     0  1302    0     4    0    0     0    25     1    0      0
2     0     0  251     0   17    0     2     2     0   37      3
3     6     1    2  8225    0    7     4   131    55    7      2
4     4     1   13     0  419    1     0     1     5    3     92
5     1     0    1    10    0  394     0     0     7  107      1
6    15     0    0     1    1    0  1877     1     0    2     11
7     9     9    6    78    1    0     2  7138    11    3      8
8     0     0    8    43   11    0     0    55  3143    6     30
9     4     0   17     1    1    7     0     0     0  463      0
10   14     0    4     7   18    0     3     3    16    1  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7351151, 'precision': 0.6754429, 'recall': 0.62328285, 'specificity': 0.97331345, 'f1': 0.61138964, 'auroc': 0.88149405}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1127     0    0   2    1    0    10     7     5   11     7
1      4  1211    2  17    1    0     1   215     7   11    30
2     12     0  342   7  140    4    10    20   179   85   216
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    7   0  148    0     1     0    14    0  1462
5      7     0   32  65    0  170     1     0     7  309     1
6      2     1    4   2    2    0  2851     4    65    0   136
7      5     0    3  15    0    0     4  1130     2    1     4
8      0     0   11  62    1    0    21    13  1250   10     2
9     19     2  274  46    3   25     2    38    67  638    23
10     0     0    0   0    5    0     0     0     1    0  1640
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 20:29:43.220214,epoch time: 0:42:17.152383,used: 4:15:17.973989,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9757331, 'precision': 0.9482695, 'recall': 0.92398, 'specificity': 0.9973184, 'f1': 0.9340291, 'auroc': 0.9994795}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     1    0     1    1    0     5     5     1    0     23
1     0  1299    0     5    0    0     0    21     5    0      2
2     0     0  285     0    5    1     0     4     1   15      1
3     0     0    0  8178    1    6     0   117   137    0      0
4     2     0   30     0  382    1     0     2    15    1    106
5     1     0    1    16    0  463     0     0     6   33      1
6     3     0    1     3    0    0  1889     0     3    0      9
7     0     4    0    53    1    0     1  7149    47    1      6
8     0     0    1    27    0    0     0    29  3207    1     28
9     1     0   27     5    4   36     1     1     4  414      0
10    0     0    3     7    7    0     2     6    12    0  12757
---- Validation: 
scalar performance:
{'acc': 0.9769159, 'precision': 0.950322, 'recall': 0.9281897, 'specificity': 0.9974443, 'f1': 0.93751985, 'auroc': 0.99947375}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     2    2    0     3     2     2    0     19
1     0  1304    0     2    0    0     0    23     3    0      0
2     0     0  282     0    4    1     1     0     6   15      3
3     0     0    1  8200    0   10     0   107   121    0      1
4     3     0   23     1  393    0     1     0    14    0    104
5     0     0    1    12    0  469     1     0     5   32      1
6     1     0    1     0    0    0  1893     1     1    0     11
7     0     5    0    54    1    0     1  7155    43    0      6
8     0     0    2    22    2    0     0    31  3208    0     31
9     0     0   32     4    1   26     3     1     9  415      2
10    3     0    3     7   10    1     2     5    15    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7005527, 'precision': 0.666342, 'recall': 0.5977762, 'specificity': 0.9699222, 'f1': 0.5777105, 'auroc': 0.88394296}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   936     2    0   21   0    2    59    65    50   17    18
1     0  1223    1   23   0    0     1   208    14    0    29
2     2     0  307   15  17   17    26    32   359   52   188
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0   11    0  24    0     0     0    24    0  1574
5     4     0    3  176   0  310     1     0    21   74     3
6     0     0    2    1   0    0  2819     5    86    0   154
7     0     0    1   35   0    0     2  1117     5    0     4
8     0     0    1   42   0    0     7    10  1305    2     3
9     6     2  108  129   1  155    11    67   309  329    20
10    0     0    0    0   2    0     0     0     1    0  1643
better model found
persisted
after epoch: 7,now: 2024-07-27 21:12:11.917799,epoch time: 0:42:28.697585,used: 4:57:46.671574,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98006743, 'precision': 0.95928836, 'recall': 0.93827474, 'specificity': 0.99776363, 'f1': 0.94725776, 'auroc': 0.99959344}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     7    2    1     2     5     0    3     15
1     0  1315    0     4    0    0     0    11     2    0      0
2     0     0  296     1    2    0     0     2     2    9      0
3     0     1    0  8391    0    1     0    34    10    0      0
4     2     0   21     0  406    0     0     1    20    2     87
5     1     0    2    18    0  457     0     0     6   35      1
6     4     0    0     5    1    0  1887     2     4    1      4
7     0     6    0   165    1    0     1  7065    21    1      3
8     0     1    0    70    1    0     0    20  3197    1      6
9     0     0   24     3    1   17     0     1     0  446      1
10    5     0    1     7   11    0     3     5    38    0  12723
---- Validation: 
scalar performance:
{'acc': 0.97935003, 'precision': 0.9587826, 'recall': 0.9346456, 'specificity': 0.99767435, 'f1': 0.9449283, 'auroc': 0.99956435}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     7    3    0     3     3     0    3     18
1     0  1315    0     3    0    0     0    14     0    0      0
2     0     0  294     1    4    0     1     0     2    8      2
3     0     0    0  8400    0    1     0    24    13    2      0
4     2     0   20     0  403    0     0     3    20    2     89
5     0     0    0    21    0  445     0     0     4   50      1
6     3     0    0     2    1    0  1886     2     4    0     10
7     0     4    0   179    1    0     1  7052    23    2      3
8     0     0    0    76    0    0     0    23  3191    1      5
9     0     0   21     3    0   18     0     2     1  448      0
10    1     0    4     6    8    0     1     6    36    1  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6932065, 'precision': 0.6448288, 'recall': 0.5755652, 'specificity': 0.96934843, 'f1': 0.5620153, 'auroc': 0.87056243}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   885     2    2   39   3    5    47    78    12   77    20
1     1  1295    0   31   1    0     2   135     7    2    25
2     2     0  144   28  86    7     9    20   447   94   178
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    5    0  70    0     2     1    50    0  1505
5     3     0    1  166   1  194     0     0    12  209     6
6     2     0    2    8   0    0  2861     2    97    0    95
7     0     0    1   58   0    0     1  1089    10    2     3
8     0     0    0   97   0    0     8     8  1254    3     0
9     2     3   71  230   8   80     7    57   176  475    28
10    0     0    1    0   1    0     1     0     2    0  1641
better model found
persisted
after epoch: 8,now: 2024-07-27 21:54:17.797724,epoch time: 0:42:05.879925,used: 5:39:52.551499,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98375964, 'precision': 0.9607408, 'recall': 0.96228963, 'specificity': 0.99823785, 'f1': 0.9614752, 'auroc': 0.9997722}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    2    0     0     0     0    1     14
1     0  1323    0     4    0    0     0     5     0    0      0
2     0     0  290     0    7    0     0     0     1   11      3
3     0     2    2  8361    0    7     0    19    43    2      0
4     4     0    8     0  501    0     0     0     5    1     20
5     0     0    1     4    0  485     0     0     2   28      1
6     2     2    0     1    0    0  1891     0     2    0     10
7     1    16    2   147    1    0     1  7037    54    0      5
8     0     2    1    27    2    1     2    10  3229    0     21
9     0     0   11     1    1   28     0     0     2  450      0
10    4     1    1     7   31    1     1     1     9    0  12737
---- Validation: 
scalar performance:
{'acc': 0.9827471, 'precision': 0.9548128, 'recall': 0.956242, 'specificity': 0.9981375, 'f1': 0.9554421, 'auroc': 0.99974304}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     3    2    0     0     0     0    2     14
1     0  1325    0     2    0    0     0     4     1    0      0
2     1     1  286     0    5    1     0     0     0   16      2
3     0     0    0  8354    0    5     0    28    50    2      1
4     4     0    9     0  489    0     0     2     5    3     27
5     0     0    0     3    0  479     0     0     5   33      1
6     0     1    3     2    1    0  1887     0     4    1      9
7     0    15    0   139    1    0     1  7051    54    1      3
8     0     0    4    20    5    1     1    10  3226    5     24
9     0     0   19     0    1   26     1     0     1  444      1
10    2     0    1     7   35    1     1     2    10    0  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71398586, 'precision': 0.67288524, 'recall': 0.62816775, 'specificity': 0.97120863, 'f1': 0.6171858, 'auroc': 0.8835629}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   959     1    4   8    2   11    65    19     7   80    14
1     0  1392    0  18    1    0     1    69     9    1     8
2     0     4  287  11  126   25    14    23   299  109   117
3     0     0    0   0    0    0     0     0     0    0     0
4     0     1    2   0  269    0     1     1    31    0  1328
5     2     0    5  57    0  386     1     0     8  129     4
6     1     3    4  13    2    0  2451     3   164    0   426
7     0     0    4  71    0    0     1  1076     6    2     4
8     0     0    2  53    0    3     8     4  1293    6     1
9     2     9  161  75    4  189     9    31   185  455    17
10    0     0    0   0    8    0     0     0     1    0  1637
better model found
persisted
after epoch: 9,now: 2024-07-27 22:36:31.553655,epoch time: 0:42:13.755931,used: 6:22:06.307430,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9854987, 'precision': 0.96741307, 'recall': 0.9595644, 'specificity': 0.9984296, 'f1': 0.96281314, 'auroc': 0.9998168}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    3    0     3     0     0    3      9
1     0  1310    0     6    0    0     0    13     2    0      1
2     0     0  265     0    2    0     2     1     1   40      1
3     1     0    0  8284    0   16     1    42    91    2      0
4     0     0    7     0  484    0     0     0     5    2     41
5     0     0    0     4    0  497     0     0     0   18      1
6     1     0    0     0    1    0  1892     1     0    2     11
7     2     2    1    63    0    0     1  7147    40    2      5
8     2     0    0    14    1    1     1     4  3255    2     16
9     0     0    2     2    0   14     0     0     0  474      0
10    1     0    1     6   12    0     1     0    12    0  12761
---- Validation: 
scalar performance:
{'acc': 0.98579645, 'precision': 0.9689324, 'recall': 0.9591366, 'specificity': 0.99845266, 'f1': 0.96330637, 'auroc': 0.9997977}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    3    0     1     0     0    1     13
1     0  1306    0     7    0    0     0    16     2    0      1
2     0     0  266     0    1    1     0     1     0   43      0
3     2     0    0  8298    0   12     0    36    92    0      0
4     0     0    4     1  485    0     1     0     5    6     37
5     0     0    0     6    0  493     0     0     0   22      0
6     1     0    1     2    1    0  1886     0     0    1     16
7     1     2    0    59    2    0     1  7161    33    0      6
8     0     0    0    18    2    0     1     9  3250    1     15
9     0     0    4     0    0   12     0     0     0  477      0
10    1     0    0     5   11    1     2     2     6    1  12767
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7141258, 'precision': 0.68292856, 'recall': 0.6142136, 'specificity': 0.9712777, 'f1': 0.6045872, 'auroc': 0.87994725}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   916     0    3   28    0   10    91    28    12   73     9
1     0  1207    3   29    1    1     4   181    19   13    41
2     1     0  321   10   41   26    24    12   283  138   159
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0   19    0  111    0     2     0    26    0  1474
5     2     0    1   84    0  340     1     0    12  150     2
6     1     0    3    2    0    0  2825     3    78    0   155
7     0     0    0  119    0    0     2  1031     6    2     4
8     0     0    2   58    0    4    16     6  1273   10     1
9     5     2  102  107    1  156    13    32   161  542    16
10    0     0    1    0    3    0     0     0     1    0  1641
better model found
persisted
after epoch: 10,now: 2024-07-27 23:18:36.423538,epoch time: 0:42:04.869883,used: 7:04:11.177313,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:04:11.177313 at 2024-07-27 23:18:36.423538
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7141258, 'precision': 0.68292856, 'recall': 0.6142136, 'specificity': 0.9712777, 'f1': 0.6045872, 'auroc': 0.87994725}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   916     0    3   28    0   10    91    28    12   73     9
1     0  1207    3   29    1    1     4   181    19   13    41
2     1     0  321   10   41   26    24    12   283  138   159
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0   19    0  111    0     2     0    26    0  1474
5     2     0    1   84    0  340     1     0    12  150     2
6     1     0    3    2    0    0  2825     3    78    0   155
7     0     0    0  119    0    0     2  1031     6    2     4
8     0     0    2   58    0    4    16     6  1273   10     1
9     5     2  102  107    1  156    13    32   161  542    16
10    0     0    1    0    3    0     0     0     1    0  1641
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7351151, 'precision': 0.6754429, 'recall': 0.62328285, 'specificity': 0.97331345, 'f1': 0.61138964, 'auroc': 0.88149405}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1127     0    0   2    1    0    10     7     5   11     7
1      4  1211    2  17    1    0     1   215     7   11    30
2     12     0  342   7  140    4    10    20   179   85   216
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    7   0  148    0     1     0    14    0  1462
5      7     0   32  65    0  170     1     0     7  309     1
6      2     1    4   2    2    0  2851     4    65    0   136
7      5     0    3  15    0    0     4  1130     2    1     4
8      0     0   11  62    1    0    21    13  1250   10     2
9     19     2  274  46    3   25     2    38    67  638    23
10     0     0    0   0    5    0     0     0     1    0  1640
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104508_instance_wise_predictions.txt
accuracy from prediction file 0.7141257958441195
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/11.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB | 414148 GiB | 414146 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411242 GiB | 411241 GiB |
|       from small pool |      7 MiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB | 414148 GiB | 414146 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411242 GiB | 411241 GiB |
|       from small pool |      7 MiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB | 412582 GiB | 412581 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 409680 GiB | 409679 GiB |
|       from small pool |      6 MiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  16520 MiB |      0 B   |
|       from large pool |  16492 MiB |  16492 MiB |  16492 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 235584 KiB | 630848 KiB |  63122 GiB |  63122 GiB |
|       from large pool | 216320 KiB | 628608 KiB |  60199 GiB |  60199 GiB |
|       from small pool |  19264 KiB |  23121 KiB |   2922 GiB |   2922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   30048 K  |   30045 K  |
|       from large pool |     247    |     595    |   13398 K  |   13397 K  |
|       from small pool |    2399    |    3599    |   16650 K  |   16647 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   30048 K  |   30045 K  |
|       from large pool |     247    |     595    |   13398 K  |   13397 K  |
|       from small pool |    2399    |    3599    |   16650 K  |   16647 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     467    |       0    |
|       from large pool |     453    |     453    |     453    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     119    |     567    |   16778 K  |   16778 K  |
|       from large pool |      95    |     303    |    8723 K  |    8723 K  |
|       from small pool |      24    |     458    |    8055 K  |    8055 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414148 GiB | 414148 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414148 GiB | 414148 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412582 GiB | 412582 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409680 GiB | 409680 GiB |
|       from small pool |      0 KiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630848 KiB |  63123 GiB |  63123 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60201 GiB |  60201 GiB |
|       from small pool |      0 KiB |  25506 KiB |   2922 GiB |   2922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3599    |   16650 K  |   16650 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3599    |   16650 K  |   16650 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     567    |   16779 K  |   16779 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |     458    |    8055 K  |    8055 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414148 GiB | 414148 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414148 GiB | 414148 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412582 GiB | 412582 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409680 GiB | 409680 GiB |
|       from small pool |      0 KiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630848 KiB |  63123 GiB |  63123 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60201 GiB |  60201 GiB |
|       from small pool |      0 KiB |  25506 KiB |   2922 GiB |   2922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3599    |   16650 K  |   16650 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3599    |   16650 K  |   16650 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     567    |   16779 K  |   16779 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |     458    |    8055 K  |    8055 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508

 Experiment start at: 2024-07-27 23:36:12.146522
before training, model accuracy: 0.09417197853326797
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9248983, 'precision': 0.8471108, 'recall': 0.738878, 'specificity': 0.9918468, 'f1': 0.7676443, 'auroc': 0.9948592}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   149     0    0     4    1    1   213    10     8   11     86
1     0  1244    0    17    0    0     4    57     2    0      8
2     0     2  114     1   69    3     8    29    19   63      3
3     0     0    0  7619    1    7    26   560   224    1      1
4     0     1    6     1  263    4    14     8    53   11    178
5     0     0    0    62    0  389     5     0    15   49      1
6     2     0    0     1    1    1  1872     4     9    0     18
7     0     7    0    91    1    0    12  7047    86    0     18
8     0     1    1    86    6    1    28   103  3019    1     50
9     0     1   29    10    5  131    18    15    17  261      6
10    1     2    2     6   26    1    79    28    54    1  12592
---- Validation: 
scalar performance:
{'acc': 0.92464894, 'precision': 0.84785163, 'recall': 0.7441925, 'specificity': 0.991813, 'f1': 0.7721981, 'auroc': 0.99472827}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   141     0    1     6    0    0   218     9     7    9     92
1     0  1245    0    14    0    0     2    62     3    0      6
2     1     3  130     0   66    4     9    19    13   58      9
3     0     1    0  7605    0   10    30   562   229    0      3
4     0     1    8     1  259    2    15    11    58    9    175
5     1     0    2    60    0  382     7     0    16   52      1
6     1     0    0     0    1    0  1879     4     6    1     16
7     0    13    0    96    2    0    18  7047    71    2     16
8     0     1    2    84    4    1    27   117  3003    2     55
9     2     1   34     8    3  113    19    10    12  285      6
10    0     0    0     5   31    2    78    24    63    1  12592
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6354159, 'precision': 0.60075706, 'recall': 0.5025334, 'specificity': 0.96150243, 'f1': 0.47321242, 'auroc': 0.87470233}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   191     0   0   41    0    0   890    31     2    5    10
1     0  1351   0   26    0    0    22    61     3    0    36
2     0    14   4   13  131    9   307    45   349   30   113
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  153    0    72     2    17    0  1389
5     0     0   0  152    1  250   128     1    17   43     0
6     0     0   0    1    0    0  3052     3     6    0     5
7     0     2   0   31    0    0    14  1114     0    0     3
8     0     1   0   91    1    0    93     9  1173    0     2
9     1    40  19  130   20   92   326    84   246  166    13
10    0     0   0    0    9    0     8     1     0    0  1628
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 00:19:32.689789,epoch time: 0:43:20.543267,used: 0:43:20.543267,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94611514, 'precision': 0.88360894, 'recall': 0.84375465, 'specificity': 0.9940337, 'f1': 0.8603119, 'auroc': 0.99688864}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     4    0    0     6     8     6    3     47
1     0  1241    0     7    0    0     0    72     7    1      4
2     2     0  214     0   32    2     1    11     7   37      6
3     2     0    0  7773    0   20     1   515   125    3      0
4     3     0   29     0  290    2     0     4    20    8    183
5     0     0    2    15    0  407     0     0     9   87      1
6    20     0    0     4    0    0  1841    11     6    2     23
7     0     6    3    80    1    0     1  7100    56    3     12
8     1     0    7    69    7    1     1   135  3044    0     31
9     5     0   50     1    2   59     1     7    10  354      4
10   11     0    3     8   16    1     9    19    34    2  12689
---- Validation: 
scalar performance:
{'acc': 0.94800055, 'precision': 0.88852084, 'recall': 0.8482473, 'specificity': 0.9942414, 'f1': 0.86520696, 'auroc': 0.9968879}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     2    1    0     6     6     6    2     41
1     0  1246    0     9    0    0     2    70     3    0      2
2     5     0  220     1   29    4     1    10     6   28      8
3     1     0    0  7809    0   19     0   472   137    2      0
4     4     0   24     0  299    2     3     5    21    6    175
5     2     0    1    19    0  402     0     0     9   87      1
6    19     0    0     1    1    2  1838    11     8    2     26
7     0     9    1    73    1    0     2  7121    46    1     11
8     0     0    3    70    6    2     0   132  3045    1     37
9     7     0   53     3    0   58     0     6    10  351      5
10   10     0    2     6   16    1     7    22    40    1  12691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7223116, 'precision': 0.62751144, 'recall': 0.61287534, 'specificity': 0.97195464, 'f1': 0.5914788, 'auroc': 0.88071096}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1077     0    0  19    0    0    22    20    16    3    13
1      1  1316    1  23    0    1     4    98     8    5    42
2     16     2  104   4  217   11    11    24   268   69   289
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    0   0  115    0     1     0    12    0  1504
5     21     0    0  52    1  329     7     0    14  164     4
6      0     1    0   1    1    0  2923     4    31    0   106
7      0     2    1  36    0    1     3  1110     6    0     5
8      0     0    1  49    4    7    15     8  1279    3     4
9     52    16  203  34   12  109    11    33   200  427    40
10     0     0    0   0    1    0     0     0     1    0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 01:01:22.884607,epoch time: 0:41:50.194818,used: 1:25:10.738085,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9574058, 'precision': 0.88876617, 'recall': 0.8659276, 'specificity': 0.99531734, 'f1': 0.8748083, 'auroc': 0.99784327}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     1    0     3    3    0     5     4     1    3     54
1     0  1302    1    11    0    0     0    16     1    0      1
2     0     1  229     1   43    0     0     0     4   32      2
3     2     5    2  8209    0    1     1   140    71    5      0
4     3     0   16     1  359    0     0     2    11    6    141
5     1     0    3    42    1  363     0     0     2  108      1
6     5     1    4     1    3    0  1861     0     5    2     25
7     3    66   13   146    5    0     3  6892    98    5     31
8     3     2    5   114   13    1     3    31  3065   10     49
9     0     0   69     5    3   27     0     0     1  386      2
10    5     0    3     6   38    0     3     3    26    2  12709
---- Validation: 
scalar performance:
{'acc': 0.95835227, 'precision': 0.8896127, 'recall': 0.8694217, 'specificity': 0.99545014, 'f1': 0.8766605, 'auroc': 0.99773455}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    0     3    3    0     3     4     1    5     47
1     0  1298    0    11    0    0     0    18     4    0      1
2     0     0  238     0   45    0     1     0     2   24      2
3     0     3    1  8206    1    4     2   142    78    2      1
4     3     0   16     1  366    0     1     1    12    4    135
5     0     0    1    39    2  354     0     0     3  121      1
6     6     1    2     3    5    0  1853     4     4    2     28
7     1    55   21   127    2    0     3  6920   113    3     20
8     2     3    9   107   11    1     2    36  3079    4     42
9     0     0   74     3    5   22     0     2     2  385      0
10    7     2    3     5   39    0     2     5    18    3  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7073392, 'precision': 0.6472497, 'recall': 0.58008534, 'specificity': 0.9707048, 'f1': 0.5818369, 'auroc': 0.87438935}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1001     1    5   37    2    0    29     7     5   29    54
1      1  1409    3   27    0    0     2    18     2    4    33
2      1    11  155   20  326    0     7     8   180   53   254
3      0     0    0    0    0    0     0     0     0    0     0
4      0     1    0    0  167    0     1     0     7    1  1456
5      4     0    6  184    3  148     3     0     2  238     4
6      0     4    0    1    2    0  2957     1     5    0    97
7      1    12   17   61    1    0     2  1053    11    0     6
8      0     1    4  164    6    0    26     0  1158    3     8
9      4    25  355  154   27   33     9     7    80  418    25
10     0     0    0    0    2    0     0     0     0    0  1644
better model found
persisted
after epoch: 3,now: 2024-07-28 01:43:14.349029,epoch time: 0:41:51.464422,used: 2:07:02.202507,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9587436, 'precision': 0.90355194, 'recall': 0.8920511, 'specificity': 0.99545866, 'f1': 0.8970921, 'auroc': 0.99859476}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     4    1    0     2     6     1    3     18
1     0  1246    0    10    0    0     0    75     1    0      0
2     1     0  244     0   26    2     0     7     1   31      0
3     0     0    0  8166    0   19     0   238    14    1      0
4     3     1   26     1  413    2     0     2     9    3     78
5     0     0    1    17    0  453     0     0     2   47      1
6    11     0    2     2    2    1  1867     7     2    2     12
7     1     4    0    76    1    0     1  7161    12    1      4
8     1     0    3   283   15   10     1   141  2809    3     30
9     1     0   47     4    0   65     0     2     0  373      1
10   12     0    2     6   65    0     9    21    21    4  12654
---- Validation: 
scalar performance:
{'acc': 0.9581918, 'precision': 0.9026369, 'recall': 0.888026, 'specificity': 0.9953904, 'f1': 0.89466953, 'auroc': 0.9984674}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     1    0     5    0    0     1     8     1    1     14
1     0  1252    0     5    0    0     0    73     1    0      1
2     2     0  235     0   31    1     0     7     2   34      0
3     0     0    0  8153    0   19     0   249    17    2      0
4     6     1   16     0  399    1     1     6    13    6     90
5     0     0    1    12    0  447     0     0     2   58      1
6    11     0    1     2    3    0  1867     4     3    3     14
7     0     2    1    74    1    0     1  7172    10    0      4
8     2     0    4   285   16   11     0   144  2797    7     30
9     1     0   43     4    0   62     0     3     0  380      0
10   13     0    3     7   59    0     1    25    19    1  12668
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69733435, 'precision': 0.65268946, 'recall': 0.5937785, 'specificity': 0.9699024, 'f1': 0.59135896, 'auroc': 0.881302}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   979     0    0   54    1    1    14    70    13   24    14
1     0  1092    0   32    1    0     0   318     3    0    53
2     3     1  127   34  272   11     2    67   265   64   169
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    3    0  369    0     1     2    11    1  1245
5     2     0    1  141    2  344     0     0     1   98     3
6     0     0    0    6    2    0  2786     8    27    0   238
7     0     0    0   30    0    1     0  1131     0    0     2
8     0     0    0  235    0    2     3    23  1101    2     4
9     6     3  157  185   23  157     2    99    79  413    13
10    0     0    0    0   20    0     0     1     0    0  1625
early stop counter: 1
val acc:0.9581918120384216, best validation acc: 0.958352267742157, corresponding to test acc:                         0.7073392271995544 / 0.7223116159439087
after epoch: 4,now: 2024-07-28 02:25:02.460675,epoch time: 0:41:48.111646,used: 2:48:50.314153,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9670912, 'precision': 0.9186534, 'recall': 0.8921509, 'specificity': 0.9964032, 'f1': 0.90223706, 'auroc': 0.9987645}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     2    1    0     0     4     0    2      9
1     0  1269    0     9    0    0     0    48     3    0      2
2     3     0  195     2   11    0     1     7     5   87      1
3     3     0    0  8169    0   14     0   189    60    1      0
4     4     0   25     2  375    1     0     9    22    6     93
5     0     0    0     9    0  469     0     0     5   37      1
6    17     0    0     0    1    0  1852     7     9    2     20
7     0     4    0    74    1    1     1  7165    13    1      4
8     3     0    2    70    0    3     0   116  3071    4     27
9     0     0   10     4    0   64     0     6     2  406      1
10   22     0    1     6   22    2     2    15    15    0  12710
---- Validation: 
scalar performance:
{'acc': 0.9679283, 'precision': 0.920971, 'recall': 0.9004925, 'specificity': 0.9965006, 'f1': 0.9087258, 'auroc': 0.9989034}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    2    0     1     3     1    3     10
1     0  1264    0    10    0    0     0    55     1    0      2
2     1     0  208     0   10    0     0     8     5   79      1
3     2     0    0  8198    0    9     0   169    61    1      0
4     6     0   18     0  404    1     1     8    18    4     79
5     0     0    0    10    0  475     0     0     4   31      1
6    20     0    0     1    2    1  1842     7     8    2     25
7     0     5    0    67    1    0     1  7169    14    3      5
8     2     0    4    67    2    3     0   118  3070    0     30
9     2     0   11     1    0   68     0     3     2  406      0
10   18     0    1     7   36    0     2    22    22    1  12687
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.697964, 'precision': 0.66401553, 'recall': 0.60996866, 'specificity': 0.96965253, 'f1': 0.589075, 'auroc': 0.8830522}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1031     0   0  30    1    5     7    34    19   23    20
1      2  1203   0  30    0    2     0   178     7    1    76
2      3     0  46   8  187   19     0    32   372   76   272
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0  280    0     1     1    20    1  1329
5      2     0   0  74    1  393     1     0    11  101     9
6      0     0   0   2    1    0  2485     8   158    0   413
7      1     0   0  54    0    1     1  1101     1    0     5
8      0     0   0  88    0    4     2     9  1260    2     5
9     10     3  34  73   14  197     2    49   168  540    47
10     0     0   0   0    8    0     0     0     1    0  1637
better model found
persisted
after epoch: 5,now: 2024-07-28 03:06:45.473392,epoch time: 0:41:43.012717,used: 3:30:33.326870,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9684289, 'precision': 0.9232359, 'recall': 0.89773, 'specificity': 0.99650383, 'f1': 0.9074031, 'auroc': 0.99915075}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     4    1    0     9     0     0    3     17
1     0  1272    0     7    0    0     0    53     0    0      0
2     0     0  256     1    4    4     0     3     3   41      0
3     0     0    0  8377    0    7     2    30    20    0      0
4     7     0   40     0  371    2     0     2    10    3    104
5     0     0    1    23    0  482     0     0     5    9      1
6     7     0    1     1    1    1  1889     0     0    0      8
7     0     1    1   265    1    0     2  6953    33    0      8
8     0     2    3   123    8    2     1    57  3085    1     14
9     1     0   23     5    1  120     0     2     3  338      0
10    5     0    5     7   19    2     6     7    17    0  12724
---- Validation: 
scalar performance:
{'acc': 0.96843654, 'precision': 0.92509145, 'recall': 0.8979908, 'specificity': 0.9964975, 'f1': 0.90794283, 'auroc': 0.99913347}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    1     6    1    1     3     0     3    1     18
1     0  1277    0     7    0    0     0    47     1    0      0
2     1     0  261     0    5    4     0     4     3   34      0
3     0     0    0  8373    0    2     0    34    30    1      0
4     2     1   42     0  362    2     0     2    13    3    112
5     0     0    0    21    0  487     1     1     3    7      1
6     3     0    0     2    0    0  1884     1     2    2     14
7     1     3    0   237    1    0     2  6981    35    0      5
8     1     2    6   132    9    3     0    65  3065    0     13
9     0     0   22     4    1  126     0     2     2  336      0
10    4     0    6     7   21    2     5     6    15    0  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6837613, 'precision': 0.6583339, 'recall': 0.569415, 'specificity': 0.96865857, 'f1': 0.5779947, 'auroc': 0.8818155}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   867     0    0   70    3   49   118   11     3   36    13
1     1  1213    0   38    0    0     5  206     3    0    33
2     2     2  150   49  287   36    45   17   228   61   138
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    0  265    0     4    0    14    1  1346
5     0     0    0  172    1  374     7    0     1   33     4
6     0     0    0    2    1    0  3030    3     3    0    28
7     0     0    0  356    0    0     2  800     2    0     4
8     0     0    1  235    5    0    38    2  1080    1     8
9     2    11  105  277   10  224    18   27    88  355    20
10    0     0    0    0    6    0     0    0     1    0  1639
better model found
persisted
after epoch: 6,now: 2024-07-28 03:49:03.591807,epoch time: 0:42:18.118415,used: 4:12:51.445285,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.975198, 'precision': 0.9332517, 'recall': 0.92785156, 'specificity': 0.9973707, 'f1': 0.92719364, 'auroc': 0.99943817}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     0    3    1     1     1     2    2     12
1     0  1304    0     7    0    0     0    19     2    0      0
2     1     0  210     0   24    1     2     4     2   65      2
3     2     0    0  8329    0    7     0    48    51    0      0
4     2     1    5     0  489    1     0     1     9    0     30
5     0     0    0    12    0  449     1     0     7   51      1
6    15     1    0     1    0    0  1873     1     0    1     15
7     1    10    0   125    1    0     1  7107    16    0      3
8     0     0    1    52    8    0     0    48  3169    0     18
9     1     0    5     1    0   26     0     0     0  460      0
10    2     1    1     6  126    0     3    21    36    0  12598
---- Validation: 
scalar performance:
{'acc': 0.97432125, 'precision': 0.9276492, 'recall': 0.9264939, 'specificity': 0.99730605, 'f1': 0.923933, 'auroc': 0.99938536}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     3    3    0     2     0     3    3     11
1     0  1305    0     9    0    0     0    18     0    0      0
2     1     0  214     0   22    2     1     3     5   64      0
3     1     0    0  8337    0    3     0    44    54    1      0
4     5     0   10     0  485    1     0     1     9    2     26
5     1     0    0    10    0  456     0     0     8   45      1
6    15     0    0     0    0    0  1873     1     2    1     16
7     0     8    1   121    2    0     1  7101    27    1      3
8     2     0    0    56    3    0     0    57  3171    0      7
9     1     0    4     3    1   26     2     1     5  449      1
10    6     2    1     6  164    0     2    16    23    0  12576
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73931295, 'precision': 0.6792146, 'recall': 0.6255293, 'specificity': 0.9739498, 'f1': 0.61089706, 'auroc': 0.88429713}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1081     0   0   12    2    5    17    16     8   14    15
1      1  1353   0   17    0    1     0   109     5    2    11
2      5     3  37   15  272   25    10    33   420   46   149
3      0     0   0    0    0    0     0     0     0    0     0
4      0     1   0    0  613    0     2     0    21    1   995
5     11     0   0  116    2  372     5     0    23   56     7
6      0     1   0    3    1    0  2882     4    43    0   133
7      2     0   0  155    0    1     1  1001     2    0     2
8      0     0   0   64    0    3     5    13  1283    0     2
9     16     9  28  114   18  196    15    65   295  354    27
10     0     0   0    0   53    0     0     1     1    0  1591
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-28 04:30:55.660447,epoch time: 0:41:52.068640,used: 4:54:43.513925,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96722496, 'precision': 0.9168638, 'recall': 0.9296238, 'specificity': 0.99665093, 'f1': 0.91903245, 'auroc': 0.9993431}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    1     2    6    0    12     3     3    0     14
1     0  1317    0     1    0    0     0     9     2    0      2
2     1     0  267     0   32    1     0     4     3    4      0
3     1     2    0  8059    2    1     8   172   195    0      0
4     1     0    6     0  509    0     0     0    14    0      9
5     0     0    1    28    0  413     0     0    13   64      1
6     2     0    1     0    2    0  1887     0     6    2      7
7     0     8    2    51    1    0     5  7141    47    0      7
8     0     0    1     9    8    0     1    37  3233    0      7
9     0     0   44     5    4    9     0     4    11  416      0
10    3     0    2     6  257    0     9     6    43    0  12467
---- Validation: 
scalar performance:
{'acc': 0.969132, 'precision': 0.9212773, 'recall': 0.9321686, 'specificity': 0.9968624, 'f1': 0.9224768, 'auroc': 0.9993846}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     0    7    0    11     1     5    0     12
1     0  1319    0     0    0    0     0    10     2    0      1
2     1     0  268     0   31    0     0     1     2    9      0
3     0     2    0  8081    0    3    10   160   184    0      0
4     1     0    3     0  513    0     0     1    16    0      5
5     0     0    1    39    0  402     0     1    12   65      1
6     2     0    0     0    1    0  1895     1     4    0      5
7     0    16    1    30    5    0     3  7161    46    0      3
8     0     0    1     9    8    0     2    33  3236    0      7
9     0     0   37     3    1    8     0     6    13  425      0
10    5     0    0     4  246    0     6    10    41    0  12484
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71909326, 'precision': 0.65700084, 'recall': 0.5884806, 'specificity': 0.9716943, 'f1': 0.58197397, 'auroc': 0.8820504}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   905     0    1   32    6    0   135    37    29   12    13
1     0  1259    0   12    1    0     3   174    11    0    39
2     0     3   88    9  304    2    13    25   462   36    73
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  792    0     2     0    34    1   803
5     7     0    7  205    2  152    22     2    67  124     4
6     0     0    0    1    3    0  2815     4   203    0    41
7     0     0    0   30    0    0     4  1120     7    0     3
8     0     0    0   17    0    0     7    24  1319    0     3
9     7     8  139  109   32   36    28    97   376  287    18
10    0     0    0    0  104    0     0     0     1    0  1541
early stop counter: 1
val acc:0.9691320061683655, best validation acc: 0.9743212461471558, corresponding to test acc:                         0.7393129467964172 / 0.7393129467964172
after epoch: 8,now: 2024-07-28 05:14:03.659122,epoch time: 0:43:07.998675,used: 5:37:51.512600,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97848886, 'precision': 0.9428165, 'recall': 0.9431717, 'specificity': 0.99773765, 'f1': 0.9419462, 'auroc': 0.9996206}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    1    0    17     0     2    1      5
1     0  1309    0     4    0    0     0    17     2    0      0
2     1     0  277     0    2    0     3     0     0   29      0
3     0     0    2  8332    0    4     0    32    67    1      0
4     5     0   19     0  461    2     1     0     9    2     40
5     0     0    0     3    0  511     0     0     2    4      1
6     0     0    0     2    0    0  1901     0     1    0      4
7     1     2    7   148    1    0     2  6996   100    0      8
8     0     1    2    23    2    2     0     5  3259    0      1
9     0     0   12     3    0   85     0     0     0  393      0
10    3     0    8     6   42    0    17     3    34    0  12677
---- Validation: 
scalar performance:
{'acc': 0.9784138, 'precision': 0.943746, 'recall': 0.9408387, 'specificity': 0.9977181, 'f1': 0.94091845, 'auroc': 0.9995257}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     3    2    0    14     0     2    2      2
1     0  1314    0     4    0    0     0    11     3    0      0
2     0     0  281     0    3    1     3     0     2   22      0
3     1     0    2  8346    0    3     0    20    67    1      0
4     7     0   19     0  450    1     5     0     7    0     50
5     0     0    0     6    0  508     1     0     0    5      1
6     0     0    0     1    0    0  1901     0     1    0      5
7     0     3    4   146    1    1     1  6996   101    2     10
8     0     0    1    29    4    4     2     4  3246    1      5
9     0     0   18     3    0   88     0     0     0  384      0
10    6     0    5     7   28    0    15     0    41    0  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68774927, 'precision': 0.639951, 'recall': 0.5687978, 'specificity': 0.96807814, 'f1': 0.554401, 'auroc': 0.8744807}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   659     0    1   47    1    7   362    37    39   12     5
1     0  1311    0   23    0    0    13   122     6    0    24
2     0     5  118   19  229   29   144     9   340   25    97
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  271    0    16     0    39    1  1302
5     2     0    2  152    0  359    38     0    12   23     4
6     0     0    0    2    1    0  3024     0    21    0    19
7     0     0    0   98    0    0     8  1044    10    0     4
8     0     0    1   73    0    2    37    11  1243    1     2
9     3    21  128  164   24  258   154    30   168  169    18
10    0     0    0    0    9    0     3     0     2    0  1632
better model found
persisted
after epoch: 9,now: 2024-07-28 05:57:17.133926,epoch time: 0:43:13.474804,used: 6:21:04.987404,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.981646, 'precision': 0.9447464, 'recall': 0.940324, 'specificity': 0.99807364, 'f1': 0.9385487, 'auroc': 0.99973583}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    2     2    3    1     5     0     0    1      2
1     0  1328    0     2    0    0     0     2     0    0      0
2     0     0  286     0    5    7     0     0     0   14      0
3     0     0    0  8397    0   13     0    18     8    0      0
4     5     0   13     0  475    2     2     1    11    4     26
5     0     0    0     2    0  517     0     0     0    2      0
6     3     1    0     1    0    1  1898     0     0    1      3
7     0    25    2   117    1    0     1  7100    12    0      5
8     2     2    1    85    0    6     0    15  3177    0      6
9     0     0    8     0    0  156     1     0     1  327      0
10   16     0    1     7   21    2     4     9    16    1  12718
---- Validation: 
scalar performance:
{'acc': 0.98114216, 'precision': 0.94292605, 'recall': 0.9380974, 'specificity': 0.9980289, 'f1': 0.93638766, 'auroc': 0.99968517}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     2    2    1    10     0     0    1      0
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     0  279     0    6    8     0     0     2   17      0
3     0     0    0  8412    0    6     0    12    10    0      0
4     7     0    9     0  483    2     1     1    13    3     20
5     0     0    0     2    0  517     0     0     0    1      1
6     3     0    0     2    0    1  1897     0     0    1      4
7     1    21    2   126    1    0     2  7096    13    0      3
8     1     2    2    91    0    6     1    16  3170    1      6
9     0     0   11     1    0  159     0     1     1  320      0
10   24     0    0     6   24    2     5     5    20    0  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72951794, 'precision': 0.68038094, 'recall': 0.6141734, 'specificity': 0.9730513, 'f1': 0.62211823, 'auroc': 0.88419056}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   919     4    2   65    0    5   100   48     4   18     5
1     1  1364    0   28    0    1    11   66     3    5    20
2     4     2  244   21  323   38    60   17   172   31   103
3     0     0    0    0    0    0     0    0     0    0     0
4     2     0    6    0  590    0    12    0    17    0  1006
5    15     0    6  123    2  407     8    0     4   21     6
6     0     0    0    2    1    0  3044    0     2    0    18
7     0     1    3  242    0    1     5  908     1    0     3
8     0     0    4  202    1    6    57    8  1089    0     3
9    12     7  294  161   18  277    27   20    42  267    12
10    0     0    0    0   44    0     6    0     1    0  1595
better model found
persisted
after epoch: 10,now: 2024-07-28 06:40:26.802895,epoch time: 0:43:09.668969,used: 7:04:14.656373,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:04:14.656373 at 2024-07-28 06:40:26.802895
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72951794, 'precision': 0.68038094, 'recall': 0.6141734, 'specificity': 0.9730513, 'f1': 0.62211823, 'auroc': 0.88419056}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   919     4    2   65    0    5   100   48     4   18     5
1     1  1364    0   28    0    1    11   66     3    5    20
2     4     2  244   21  323   38    60   17   172   31   103
3     0     0    0    0    0    0     0    0     0    0     0
4     2     0    6    0  590    0    12    0    17    0  1006
5    15     0    6  123    2  407     8    0     4   21     6
6     0     0    0    2    1    0  3044    0     2    0    18
7     0     1    3  242    0    1     5  908     1    0     3
8     0     0    4  202    1    6    57    8  1089    0     3
9    12     7  294  161   18  277    27   20    42  267    12
10    0     0    0    0   44    0     6    0     1    0  1595
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73931295, 'precision': 0.6792146, 'recall': 0.6255293, 'specificity': 0.9739498, 'f1': 0.61089706, 'auroc': 0.88429713}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1081     0   0   12    2    5    17    16     8   14    15
1      1  1353   0   17    0    1     0   109     5    2    11
2      5     3  37   15  272   25    10    33   420   46   149
3      0     0   0    0    0    0     0     0     0    0     0
4      0     1   0    0  613    0     2     0    21    1   995
5     11     0   0  116    2  372     5     0    23   56     7
6      0     1   0    3    1    0  2882     4    43    0   133
7      2     0   0  155    0    1     1  1001     2    0     2
8      0     0   0   64    0    3     5    13  1283    0     2
9     16     9  28  114   18  196    15    65   295  354    27
10     0     0   0    0   53    0     0     1     1    0  1591
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_23_36_11_seed_1_23104508_instance_wise_predictions.txt
accuracy from prediction file 0.7295179458476178
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |   1647 MiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      6 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  31154 MiB |  14634 MiB |
|       from large pool |  16492 MiB |  16492 MiB |  31124 MiB |  14632 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 235584 KiB | 631720 KiB | 126229 GiB | 126229 GiB |
|       from large pool | 216320 KiB | 628608 KiB | 120387 GiB | 120386 GiB |
|       from small pool |  19264 KiB |  25506 KiB |   5842 GiB |   5842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   60095 K  |   60093 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2399    |    3599    |   33299 K  |   33297 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   60095 K  |   60093 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2399    |    3599    |   33299 K  |   33297 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     828    |     361    |
|       from large pool |     453    |     453    |     813    |     360    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     119    |     567    |   33529 K  |   33529 K  |
|       from large pool |      95    |     304    |   17481 K  |   17481 K  |
|       from small pool |      24    |     458    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |  16640 KiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  31154 MiB |  29268 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  31124 MiB |  29264 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 631720 KiB | 126230 GiB | 126230 GiB |
|       from large pool |  24320 KiB | 628608 KiB | 120388 GiB | 120388 GiB |
|       from small pool |      0 KiB |  25506 KiB |   5842 GiB |   5842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   60095 K  |   60095 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3599    |   33299 K  |   33299 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   60095 K  |   60095 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3599    |   33299 K  |   33299 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     828    |     722    |
|       from large pool |      93    |     453    |     813    |     720    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     567    |   33529 K  |   33529 K  |
|       from large pool |       3    |     304    |   17482 K  |   17482 K  |
|       from small pool |       0    |     458    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 06:49:18 2024]
Finished job 0.
1 of 1 steps (100%) done
