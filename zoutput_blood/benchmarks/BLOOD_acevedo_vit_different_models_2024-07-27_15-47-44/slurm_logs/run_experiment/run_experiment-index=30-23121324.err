Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 10:54:05 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/30.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=30
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324

 Experiment start at: 2024-07-28 11:03:40.316118
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.12040859460830688
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9423427, 'precision': 0.878128, 'recall': 0.8095706, 'specificity': 0.99364763, 'f1': 0.83209026, 'auroc': 0.995873}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   372     0    0     3    0    0    28     4    10    2     63
1     0  1245    0    15    0    0     0    62     4    0      6
2     3     0  174     0   30    1     1     9     9   71     14
3     1     1    0  7805    0   24     8   322   272    2      1
4     2     0   21     0  240    1     2     2    31   17    223
5     1     0    2    25    0  300     3     0    14  175      1
6     7     0    0     0    0    0  1861     5     7    3     24
7     1    10    2   109    2    0     3  7037    81    3     17
8     0     0    4    53    6    1     5    87  3077    4     58
9     1     0   28     5    0   27     4     5    12  406      5
10    8     0    2     8    9    0    15    13    34    1  12704
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94251704, 'precision': 0.88239497, 'recall': 0.81426674, 'specificity': 0.99366766, 'f1': 0.83641255, 'auroc': 0.9959093}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     0    0     2    0    1    28     5     6    6     58
1     0  1232    0    13    0    0     1    75     4    0      7
2     4     0  182     0   26    1     4     8     7   67     13
3     1     0    0  7796    0   19    13   328   280    2      1
4     1     0   23     0  234    1     4     4    35   14    223
5     1     0    2    22    0  313     1     0    18  163      1
6     6     0    0     0    0    0  1866     2     6    1     27
7     1     7    1   113    0    0     2  7031    88    2     20
8     1     0    4    42    6    2     5    85  3089    6     56
9     2     0   30     3    1   27     4     3     9  411      3
10    5     1    1     4    7    0    19    15    36    3  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74484015, 'precision': 0.6693816, 'recall': 0.63788575, 'specificity': 0.97408456, 'f1': 0.6214803, 'auroc': 0.88682365}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1073     0    0   1    0    0    67     9     6    9     5
1      2  1180    0  25    1    0     2   231     4    8    46
2     19     2  216   4  170   19    54    50   218  112   151
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    2   0  212    0     2     2    17    0  1396
5     46     0    0  14    1  360    11     0    13  146     1
6      0     0    0   1    1    0  3016     3    32    0    14
7      5     1    0  17    0    0    17  1116     0    2     6
8      1     0    2  36    1    4    37    10  1272    5     2
9     51     4  130  26    4  113    30    83   106  566    24
10     0     0    0   0   11    0     0     0     0    0  1635
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 12:00:10.654804,epoch time: 0:56:30.338686,used: 0:56:30.338686,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9532053, 'precision': 0.8907083, 'recall': 0.85100156, 'specificity': 0.9947834, 'f1': 0.86286306, 'auroc': 0.99756956}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    1     2    3    0     6     1     0    2     63
1     0  1264    0     9    0    0     0    45     5    1      8
2     1     0  252     0   28    1     1     3     1   21      3
3     1     0    2  8070    1    7     2   214   137    2      1
4     1     0   26     0  347    0     2     2     8    4    149
5     1     0    5    44    0  270     1     0     5  194      1
6     8     0    0     3    1    0  1862     2     1    1     29
7     0     6    1   130    1    0     2  7034    55    5     30
8     0     0    6    70   11    1     3    78  3023    3    100
9     1     0   73     5    3    9     1     4     3  389      5
10    1     0    3     6   47    0     7     5    12    2  12711
---- Validation: 
scalar performance:
{'acc': 0.9539655, 'precision': 0.8893532, 'recall': 0.84924877, 'specificity': 0.99487996, 'f1': 0.8617679, 'auroc': 0.9975206}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     0    0     2    1    0     4     4     2    4     62
1     0  1261    0    10    0    0     0    48     6    0      7
2     2     0  239     0   30    1     1     4     2   28      5
3     0     0    3  8091    0    6     3   199   135    2      1
4     1     0   31     0  352    0     0     2     6    6    141
5     2     0    2    44    0  277     0     0     8  187      1
6     4     0    1     3    1    0  1872     1     3    1     22
7     0     5    4   143    2    0     2  7023    54    5     27
8     2     1    8    68   15    0     2    60  3032    3    105
9     0     0   76     4    2   12     1     1     6  388      3
10    2     0    2     8   39    0     5     6     7    2  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73546493, 'precision': 0.67883074, 'recall': 0.61324835, 'specificity': 0.97351253, 'f1': 0.61889035, 'auroc': 0.8867618}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1083     0    0   13    2    0    25    8     5   22    12
1      2  1252    0   30    1    0     2  147     2    6    57
2      3     0  245   13  348    3     6   12   122   62   201
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    5    0  301    0     2    1     7    0  1316
5     13     0    1  129    4  218     6    0    15  205     1
6      0     0    0    1    1    0  3022    3     3    0    37
7      1     0    1  169    0    0     1  982     3    1     6
8      0     0    1   59    4    0     9    4  1281    4     8
9     19     3  248  115   13   38     9   39   133  493    27
10     0     0    0    0   11    0     0    0     0    0  1635
better model found
persisted
after epoch: 2,now: 2024-07-28 12:54:29.854767,epoch time: 0:54:19.199963,used: 1:50:49.538649,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9615261, 'precision': 0.90651345, 'recall': 0.88035464, 'specificity': 0.99571764, 'f1': 0.89145124, 'auroc': 0.9984626}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    1     5    1    0     0     5     2    2     33
1     0  1292    0     9    0    0     0    29     1    0      0
2     1     0  246     0   26    1     0     7     1   29      1
3     1     0    0  8311    0    3     2    91    29    1      1
4     1     0   22     0  382    2     0     5    11    3    112
5     3     0    1    36    1  366     0     0     4  109      1
6     7     0    0     7    2    0  1868     2     4    3     14
7     0    14    1   163    2    0     1  7060    13    3      6
8     2     1    5   190   30    1     1   129  2887    0     49
9     0     1   46     8    3   27     1     3     2  398      3
10    9     0    3    11   45    0     7    17     8    1  12694
---- Validation: 
scalar performance:
{'acc': 0.96169585, 'precision': 0.9085873, 'recall': 0.8800207, 'specificity': 0.9957228, 'f1': 0.89227104, 'auroc': 0.99854195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    1     3    1    0     3     4     1    2     37
1     0  1292    0     9    0    0     0    30     1    0      0
2     1     1  234     0   27    2     0     6     2   34      5
3     3     1    1  8314    0    3     1    88    26    3      0
4     2     1   29     0  376    0     0     3    13    1    114
5     0     0    2    37    0  380     0     0     3   98      1
6     5     0    2     2    0    0  1876     2     2    4     15
7     1    13    0   160    1    0     1  7068    13    1      7
8     1     1    3   189   19    0     2   142  2891    0     48
9     1     0   46     6    3   20     0     2     1  410      4
10    7     0    2    10   53    0     7    21    14    1  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.717694, 'precision': 0.6695504, 'recall': 0.5954175, 'specificity': 0.9719097, 'f1': 0.5914042, 'auroc': 0.8856496}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1126     1    0   10    1    0     7   12     2    7     4
1      0  1282    0   27    1    0     2  176     1    0    10
2     12    10  157   23  207    7     2   66   266   47   218
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    3    0  214    0     1    2    10    0  1403
5     18     0    0  182    2  224     0    0    14  147     5
6      3     2    0    3    2    0  3009    3    12    0    33
7      2     1    0  159    0    0     0  998     0    0     4
8      0     0    1  124    0    0     6   16  1217    1     5
9     17    19  114  210    4   49     4  125   165  394    36
10     0     0    0    0    9    0     0    0     0    0  1637
better model found
persisted
after epoch: 3,now: 2024-07-28 13:49:16.025895,epoch time: 0:54:46.171128,used: 2:45:35.709777,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9656196, 'precision': 0.9182899, 'recall': 0.89619195, 'specificity': 0.9962609, 'f1': 0.90397596, 'auroc': 0.99872196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     1    0     2    1    1    10     0     2    1     18
1     0  1316    0     5    0    0     0     5     5    0      1
2     1     0  195     1   40    1     0     0     1   72      1
3     0     3    1  8290    0    9     1    65    67    2      0
4     4     1    5     0  397    0     1     2    15   10    104
5     0     0    0    14    0  446     0     0     5   55      1
6     4     0    0     1    2    1  1885     1     3    2      9
7     0    84    0   214    1    0     1  6883    67    0     13
8     1     2    1    94    5    6     1    45  3095    6     38
9     1     0    8     4    3   41     1     1     2  432      0
10    8     0    3     7   46    0     7     5    11    1  12705
---- Validation: 
scalar performance:
{'acc': 0.96546745, 'precision': 0.91532177, 'recall': 0.8946109, 'specificity': 0.99625576, 'f1': 0.9015211, 'auroc': 0.99883556}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     1    1    1    14     0     0    2     16
1     0  1317    0     4    0    0     0     7     3    0      1
2     2     0  190     0   43    2     0     1     3   70      1
3     1     6    0  8282    2   17     0    54    78    0      0
4     5     0    5     0  399    2     0     4    13    7    104
5     0     0    0    12    0  445     0     0     3   60      1
6     4     0    0     2    1    0  1883     0     2    1     15
7     0    83    2   199    2    0     1  6890    72    3     13
8     0     1    0    92    8    2     0    41  3102    7     43
9     2     0   10     2    0   47     1     0     2  429      0
10    6     1    2     7   39    0    10     3    17    2  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75246626, 'precision': 0.6668968, 'recall': 0.6422837, 'specificity': 0.9749228, 'f1': 0.62590754, 'auroc': 0.8820716}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1075     1    0   7    1    1    47     4     7   18     9
1      1  1414    0  20    1    2     0    32     6    0    23
2      3     1  124   4  350   13     4     9   214   82   211
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0  152    0     1     0    10    0  1469
5      6     0    0  25    2  377     2     0    20  156     4
6      0     0    0   0    1    0  3031     2     3    0    30
7      2    20    1  60    0    1    12  1056     6    0     6
8      0     0    0  21    1    4     4     2  1331    3     4
9     11     6  102  34   17  103     8    24   245  553    34
10     0     0    0   0    3    0     1     0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 14:44:02.106118,epoch time: 0:54:46.080223,used: 3:40:21.790000,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96634203, 'precision': 0.93590003, 'recall': 0.86886394, 'specificity': 0.99625015, 'f1': 0.89098996, 'auroc': 0.9990443}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     1    1    0    10     5     1    6     34
1     0  1279    0    11    0    0     0    37     3    0      1
2     0     0  149     1   31    1     0     6     7  109      8
3     0     1    0  8317    0    0     1    46    70    1      0
4     3     0    2     0  332    1     0     2    23   11    165
5     0     0    0    28    0  427     0     0    12   53      1
6     3     0    0     2    0    0  1879     2     5    1     16
7     0     3    0   229    1    0     1  6913   112    0      5
8     1     0    2    53    5    0     1    12  3205    2     15
9     0     0    2     4    0   33     0     1     3  450      0
10    2     0    0     7    6    0     1     6    26    3  12742
---- Validation: 
scalar performance:
{'acc': 0.96463823, 'precision': 0.9334375, 'recall': 0.86514276, 'specificity': 0.996077, 'f1': 0.88689363, 'auroc': 0.9990152}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     2    2    0     9     3     1    5     35
1     0  1284    0     5    0    0     0    37     5    0      1
2     0     0  149     0   19    1     0     9     6  118     10
3     3     1    0  8321    0    0     0    35    80    0      0
4     1     0    2     0  337    1     0     2    25   14    157
5     0     0    0    30    0  408     0     0    14   68      1
6     6     0    0     2    0    0  1870     2     3    3     22
7     0     8    0   224    1    0     1  6907   117    1      6
8     1     0    0    60    2    0     0    23  3186    4     20
9     0     0    1     5    0   32     0     2     6  447      0
10    4     0    0     8   16    0     2    10    26    2  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7018121, 'precision': 0.6695179, 'recall': 0.59100366, 'specificity': 0.9701065, 'f1': 0.5742067, 'auroc': 0.8798614}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1009     0    0   13   0    0    13    57    12   42    24
1      0  1208    0   30   0    0     0   227     7    0    27
2      9     0  134   14  64    7     0    73   266   99   349
3      0     0    0    0   0    0     0     0     0    0     0
4      0     0    2    0  66    0     1     1    12    0  1551
5      4     0    0  162   0  235     0     0    31  158     2
6      2     0    0   11   0    0  2829     8    21    1   195
7      0     0    0   37   0    0     0  1123     0    1     3
8      0     0    0   77   0    0     1    11  1277    2     2
9      3     0   66  132   4   51     0   108   233  507    33
10     0     0    0    0   3    0     0     0     0    0  1643
early stop counter: 1
val acc:0.9646382331848145, best validation acc: 0.9654674530029297, corresponding to test acc:                         0.7524662613868713 / 0.7524662613868713
after epoch: 5,now: 2024-07-28 15:39:15.254896,epoch time: 0:55:13.148778,used: 4:35:34.938778,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97586685, 'precision': 0.92281044, 'recall': 0.9337712, 'specificity': 0.99748325, 'f1': 0.92701304, 'auroc': 0.9993758}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     1    0     2    1    0    15     1     0    1      6
1     0  1330    0     0    0    0     0     1     1    0      0
2     0     0  291     0   14    2     1     0     0    4      0
3     1    16    1  8243    0   14     1    83    75    3      0
4     4     0   16     0  440    0     3     0    11    2     63
5     0     0    0     5    0  467     0     0     2   46      1
6     1     3    0     0    0    1  1897     0     1    0      5
7     0    55    4    63    2    0     4  7088    37    1      9
8     2     1    6    28    4    3     2    29  3206    2     13
9     0     0   66     0    0   45     0     0     1  381      0
10   20     3    2     7   41    1    21     4    16    2  12675
---- Validation: 
scalar performance:
{'acc': 0.97563195, 'precision': 0.92382824, 'recall': 0.9358851, 'specificity': 0.99745405, 'f1': 0.9287672, 'auroc': 0.9993587}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    1    0    10     2     0    1      3
1     0  1323    0     1    0    0     0     7     1    0      0
2     0     0  283     1   14    2     1     0     2    9      0
3     1    10    2  8226    0   14     1    86    93    7      0
4     5     0   18     0  444    1     3     0     5    3     60
5     0     0    0     3    0  474     0     0     3   40      1
6     3     2    1     0    0    1  1894     1     0    0      6
7     1    55    3    78    1    0     3  7069    50    1      4
8     1     4    5    26    7    0     0    19  3213    2     19
9     0     0   68     1    2   31     0     0     1  390      0
10   25     2    2     7   34    0    12     3    18    0  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7792626, 'precision': 0.7090546, 'recall': 0.66915834, 'specificity': 0.9774482, 'f1': 0.6663301, 'auroc': 0.88692164}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1009     1    2   6    0    1   113    15     3   19     1
1      1  1426    2   6    0    1     2    41     3   10     7
2      6     2  356   5  180   12    89    20   139   77   129
3      0     0    0   0    0    0     0     0     0    0     0
4      2     1    6   0  262    0    12     0    14    0  1336
5      3     0    3  35    1  341     8     0     6  193     2
6      0     0    0   1    0    0  3061     1     1    0     3
7      1     9    5  18    0    0    12  1112     1    2     4
8      0     0    2  35    0    3    28    10  1280   10     2
9      8     7  224  28    5   65    34    24    69  663    10
10     0     2    0   0   11    0     3     1     1    0  1628
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-28 16:34:26.014823,epoch time: 0:55:10.759927,used: 5:30:45.698705,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9794253, 'precision': 0.9501419, 'recall': 0.94205064, 'specificity': 0.9977261, 'f1': 0.9445203, 'auroc': 0.999623}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     1    3    0     1     0     0    2      7
1     0  1323    0     1    0    0     0     4     2    0      2
2     0     0  286     0    9    0     0     0     2   14      1
3     0     0    0  8398    0    2     0    25    11    2      0
4     3     0    7     1  454    0     0     1     5    0     68
5     0     0    1    18    0  412     0     0     1   87      1
6     5     0    0     1    1    0  1887     0     3    0     10
7     0    27    8   140    1    0     2  7041    34    2      8
8     0     0    1   111    6    0     0    17  3138    2     20
9     0     0   18     2    0    6     0     0     1  466      0
10    8     0    4     7   27    0     3     3     9    0  12733
---- Validation: 
scalar performance:
{'acc': 0.978708, 'precision': 0.94720435, 'recall': 0.9410238, 'specificity': 0.9976349, 'f1': 0.94263816, 'auroc': 0.9996316}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     1    3    1     1     0     0    3     12
1     0  1324    0     4    0    0     0     4     0    0      0
2     0     0  293     1    6    0     0     0     1    9      2
3     0     0    0  8408    0    0     0    18    12    0      2
4     2     0   15     0  444    0     0     0     4    1     73
5     0     0    0    20    0  426     0     0     1   73      1
6     3     0    3     4    2    0  1884     0     0    0     12
7     1    33    8   152    2    0     2  7027    31    4      5
8     0     0    4   113    6    1     0    17  3128    3     24
9     0     0   29     1    1    6     0     0     0  456      0
10    8     0    2     7   25    1     3     3    10    0  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73161685, 'precision': 0.6873584, 'recall': 0.60662246, 'specificity': 0.97334737, 'f1': 0.6136253, 'auroc': 0.8811919}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1051     0    4   26    3    0    26    26     3   26     5
1      4  1261    0   31    2    0     4   164     3    4    26
2      5     2  389   35  211    6    10    20   166   78    93
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    8    0  252    0     2     0    18    0  1353
5      4     0   10  163    3  119     1     0     1  289     2
6      2     0    3    3    0    0  3008     3     9    0    39
7      2     0    1  147    0    0     0  1007     0    2     5
8      0     0    2  192    0    0    15    13  1141    3     4
9      4     5  197  188   10   37     4    38    46  595    13
10     0     0    0    0   11    0     0     0     1    0  1634
better model found
persisted
after epoch: 7,now: 2024-07-28 17:29:27.760270,epoch time: 0:55:01.745447,used: 6:25:47.444152,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98070955, 'precision': 0.9632069, 'recall': 0.94395703, 'specificity': 0.9978571, 'f1': 0.95275533, 'auroc': 0.99968255}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     2    2    0     0     1     3    1      1
1     0  1310    0     7    0    0     0    14     1    0      0
2     0     0  276     1    7    0     0     5     8   15      0
3     0     1    0  8389    0    1     0    23    22    0      0
4     3     0   15     0  413    0     0     2    20    1     85
5     0     0    0    18    0  476     0     0     5   20      1
6     6     0    0     1    3    0  1881     1     6    0     10
7     1     3    0   180    0    0     2  7039    37    0      3
8     0     0    0    37    0    0     0     7  3249    0      1
9     0     0    8     3    0   21     0     0     4  457      0
10    4     0    3     8   20    0     1     8    58    0  12692
---- Validation: 
scalar performance:
{'acc': 0.9802327, 'precision': 0.9599008, 'recall': 0.94346476, 'specificity': 0.9978169, 'f1': 0.95100576, 'auroc': 0.9996869}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    3    0     0     0     1    1      3
1     0  1302    0     8    0    0     0    22     0    0      0
2     0     0  276     0    8    0     0     5     7   16      0
3     0     0    0  8396    0    1     0    19    24    0      0
4     2     0   15     0  415    0     0     1    25    2     79
5     0     0    0    16    0  478     0     0     2   24      1
6     4     0    1     1    4    2  1885     0     4    1      6
7     1     3    0   180    0    0     3  7024    47    1      6
8     0     0    0    31    3    0     0    13  3245    0      4
9     0     0   14     2    1   16     1     1     4  454      0
10    2     0    3     6   20    0     2    10    56    0  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70635974, 'precision': 0.6512519, 'recall': 0.5929605, 'specificity': 0.97074467, 'f1': 0.58394843, 'auroc': 0.8744866}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1073     0    3    9    4    0    31    9    16   16     9
1      2  1219    0   31    1    0     3  212    13    0    18
2      7     3  202   30  150   12     9   40   373   79   110
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0   10    0   75    0     4    0    38    0  1506
5     10     0    5  124    0  296     0    0    16  134     7
6      2     0    0    4    0    0  2999    3    29    0    30
7      0     0    0  250    0    0     3  904     1    1     5
8      0     0    0   94    0    1     5    6  1263    1     0
9     12     8   62  173    5  118     3   70   240  428    18
10     0     1    0    0    5    0     2    0     1    0  1637
better model found
persisted
after epoch: 8,now: 2024-07-28 18:24:53.160462,epoch time: 0:55:25.400192,used: 7:21:12.844344,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9881742, 'precision': 0.9735203, 'recall': 0.9627327, 'specificity': 0.9986993, 'f1': 0.96782243, 'auroc': 0.99985665}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     2    1    0     1     0     0    0      8
1     0  1304    0     8    0    0     0    17     1    0      0
2     0     0  273     0    5    1     0     0     2   29      2
3     0     0    0  8355    0    1     0    42    35    2      0
4     3     0    6     0  488    0     0     0     4    1     37
5     0     0    0     8    0  508     0     0     0    5      0
6     7     0    0     5    1    1  1882     1     3    0      8
7     0     3    2    62    0    0     0  7174    20    0      3
8     0     0    0    14    1    0     0    20  3256    0      5
9     0     0    5     1    1   28     0     0     0  458      0
10    5     0    0     7    5    0     2     3     8    0  12765
---- Validation: 
scalar performance:
{'acc': 0.98772234, 'precision': 0.97353184, 'recall': 0.9613869, 'specificity': 0.99864274, 'f1': 0.9671236, 'auroc': 0.9998651}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     1    0     0    0    0     0     0     0    0      8
1     0  1309    0    10    0    0     0    12     1    0      0
2     0     0  274     0   10    0     0     1     3   24      0
3     1     0    0  8368    0    3     0    37    29    2      0
4     5     0    4     0  483    0     0     0     6    0     41
5     0     0    0     0    0  499     0     0     4   17      1
6     3     0    0     9    0    0  1882     4     2    0      8
7     0     2    0    73    0    0     0  7162    21    0      7
8     1     0    0    25    1    0     0    10  3253    0      6
9     0     0    5     0    0   26     0     1     2  459      0
10    2     0    1     7    5    1     3     5     9    0  12763
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7146855, 'precision': 0.66835153, 'recall': 0.6096999, 'specificity': 0.97167087, 'f1': 0.59516567, 'auroc': 0.87846535}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1045     0    1   23    1    5    29   27    11   23     5
1      0  1207    0   30    1    5     2  225     3    3    23
2      8     4  165   28  189   44     9   59   338   73    98
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    6    0  229    0     3    1    37    0  1357
5      4     0    0   88    0  424     1    0    11   62     2
6      1     1    0    5    1    1  2983    4    56    0    15
7      1     2    0  212    0    1     0  940     0    3     5
8      0     0    0  139    0    8     3   15  1203    2     0
9      4     8   47  149    6  301     3   77   143  384    15
10     0     0    0    0    8    0     2    0     1    0  1635
better model found
persisted
after epoch: 9,now: 2024-07-28 19:18:14.884449,epoch time: 0:53:21.723987,used: 8:14:34.568331,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98638165, 'precision': 0.9667248, 'recall': 0.96645075, 'specificity': 0.998559, 'f1': 0.9661978, 'auroc': 0.99985886}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    2     2    7    0    13     1     3    0     14
1     0  1308    0     0    0    0     1    19     1    0      1
2     0     0  299     0    3    0     1     0     3    5      1
3     0     1    0  8295    0    5     0    50    86    0      0
4     2     0    6     0  514    0     0     2     2    0     13
5     0     0    2     3    1  485     0     0     3   26      1
6     0     0    0     0    1    0  1896     1     1    0      9
7     0     1    0    50    2    0     1  7161    44    0      5
8     0     0    0     4    6    0     0     7  3271    0      8
9     0     0   14     1    2    8     0     0     3  464      1
10    1     0    0     5   47    0     2     1     4    0  12733
---- Validation: 
scalar performance:
{'acc': 0.98836434, 'precision': 0.9690851, 'recall': 0.97081447, 'specificity': 0.9987714, 'f1': 0.96956205, 'auroc': 0.9998786}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    2     1    9    0     5     1     1    0     16
1     0  1320    0     2    0    0     0    10     0    0      0
2     0     0  302     1    3    0     0     2     0    3      1
3     0     0    0  8311    0    1     1    41    86    0      0
4     1     0    7     0  522    0     0     1     0    0      8
5     0     0    1     1    0  488     0     0     1   29      1
6     0     0    0     0    0    0  1902     0     0    0      6
7     0     2    0    44    0    0     1  7177    37    0      4
8     0     0    0     5    6    0     0     5  3271    0      9
9     0     0   21     0    3    8     1     2     0  458      0
10    0     0    1     5   34    0     1     0     4    0  12751
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71573496, 'precision': 0.6811649, 'recall': 0.595316, 'specificity': 0.9713761, 'f1': 0.59519935, 'auroc': 0.8828157}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   914     0    0    7    2    1   160    39    19   23     5
1     0  1168    1   28    2    0     3   260     6    2    29
2     4     0  153   24  195   11    71    75   318   80    84
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    3    0  387    0     3     2    23    1  1213
5    10     0    1   98    1  259     1     0    14  207     1
6     1     0    0    3    0    0  2988     3    24    0    48
7     0     0    0  148    0    0     3  1005     3    1     4
8     0     0    0   94    0    1    19     9  1244    3     0
9     9     2   35  141    6   94    29   111   205  493    12
10    0     0    0    0   26    0     0     0     1    0  1619
better model found
persisted
after epoch: 10,now: 2024-07-28 20:12:07.371677,epoch time: 0:53:52.487228,used: 9:08:27.055559,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 9:08:27.055559 at 2024-07-28 20:12:07.371677
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71573496, 'precision': 0.6811649, 'recall': 0.595316, 'specificity': 0.9713761, 'f1': 0.59519935, 'auroc': 0.8828157}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   914     0    0    7    2    1   160    39    19   23     5
1     0  1168    1   28    2    0     3   260     6    2    29
2     4     0  153   24  195   11    71    75   318   80    84
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    3    0  387    0     3     2    23    1  1213
5    10     0    1   98    1  259     1     0    14  207     1
6     1     0    0    3    0    0  2988     3    24    0    48
7     0     0    0  148    0    0     3  1005     3    1     4
8     0     0    0   94    0    1    19     9  1244    3     0
9     9     2   35  141    6   94    29   111   205  493    12
10    0     0    0    0   26    0     0     0     1    0  1619
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7792626, 'precision': 0.7090546, 'recall': 0.66915834, 'specificity': 0.9774482, 'f1': 0.6663301, 'auroc': 0.88692164}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1009     1    2   6    0    1   113    15     3   19     1
1      1  1426    2   6    0    1     2    41     3   10     7
2      6     2  356   5  180   12    89    20   139   77   129
3      0     0    0   0    0    0     0     0     0    0     0
4      2     1    6   0  262    0    12     0    14    0  1336
5      3     0    3  35    1  341     8     0     6  193     2
6      0     0    0   1    0    0  3061     1     1    0     3
7      1     9    5  18    0    0    12  1112     1    2     4
8      0     0    2  35    0    3    28    10  1280   10     2
9      8     7  224  28    5   65    34    24    69  663    10
10     0     2    0   0   11    0     3     1     1    0  1628
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_11_03_39_seed_0_23121324_instance_wise_predictions.txt
accuracy from prediction file 0.715734975162667
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/30.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/30.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/30.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15814 MiB | 692963 GiB | 692962 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 688007 GiB | 688005 GiB |
|       from small pool |      7 MiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15814 MiB | 692963 GiB | 692962 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 688007 GiB | 688005 GiB |
|       from small pool |      7 MiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15770 MiB | 690707 GiB | 690705 GiB |
|       from large pool |   1647 MiB |  15745 MiB | 685754 GiB | 685753 GiB |
|       from small pool |      6 MiB |     26 MiB |   4952 GiB |   4952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16412 MiB |  16412 MiB |  16412 MiB |      0 B   |
|       from large pool |  16384 MiB |  16384 MiB |  16384 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 227392 KiB | 680312 KiB | 102351 GiB | 102351 GiB |
|       from large pool | 216320 KiB | 677984 KiB |  97209 GiB |  97209 GiB |
|       from small pool |  11072 KiB |  13093 KiB |   5141 GiB |   5141 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   44744 K  |   44741 K  |
|       from large pool |     247    |     593    |   22680 K  |   22680 K  |
|       from small pool |    2399    |    3599    |   22063 K  |   22060 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   44744 K  |   44741 K  |
|       from large pool |     247    |     593    |   22680 K  |   22680 K  |
|       from small pool |    2399    |    3599    |   22063 K  |   22060 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     462    |     462    |     462    |       0    |
|       from large pool |     448    |     448    |     448    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     116    |     568    |   25183 K  |   25183 K  |
|       from large pool |      94    |     301    |   15425 K  |   15425 K  |
|       from small pool |      22    |     459    |    9757 K  |    9757 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 690707 GiB | 690707 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 685754 GiB | 685754 GiB |
|       from small pool |      0 KiB |     26 MiB |   4952 GiB |   4952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1878 MiB |  16412 MiB |  16412 MiB |  14534 MiB |
|       from large pool |   1860 MiB |  16384 MiB |  16384 MiB |  14524 MiB |
|       from small pool |     18 MiB |     28 MiB |     28 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680312 KiB | 102352 GiB | 102352 GiB |
|       from large pool |  24320 KiB | 677984 KiB |  97210 GiB |  97210 GiB |
|       from small pool |      0 KiB |  17454 KiB |   5141 GiB |   5141 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     102    |     462    |     462    |     360    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       9    |      14    |      14    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     568    |   25184 K  |   25184 K  |
|       from large pool |       3    |     301    |   15426 K  |   15426 K  |
|       from small pool |       0    |     459    |    9758 K  |    9758 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 690707 GiB | 690707 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 685754 GiB | 685754 GiB |
|       from small pool |      0 KiB |     26 MiB |   4952 GiB |   4952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1878 MiB |  16412 MiB |  16412 MiB |  14534 MiB |
|       from large pool |   1860 MiB |  16384 MiB |  16384 MiB |  14524 MiB |
|       from small pool |     18 MiB |     28 MiB |     28 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680312 KiB | 102352 GiB | 102352 GiB |
|       from large pool |  24320 KiB | 677984 KiB |  97210 GiB |  97210 GiB |
|       from small pool |      0 KiB |  17454 KiB |   5141 GiB |   5141 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     102    |     462    |     462    |     360    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       9    |      14    |      14    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     568    |   25184 K  |   25184 K  |
|       from large pool |       3    |     301    |   15426 K  |   15426 K  |
|       from small pool |       0    |     459    |    9758 K  |    9758 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324

 Experiment start at: 2024-07-28 20:30:06.797830
before training, model accuracy: 0.09417197853326797
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.932256, 'precision': 0.84354895, 'recall': 0.82218397, 'specificity': 0.99277115, 'f1': 0.8267529, 'auroc': 0.99546254}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    0     6    0    2     7     9    22    8     37
1     0  1271    0    14    0    0     0    41     4    0      1
2     0     0  182     3   53    9     2    11    15   36      1
3     0     1    1  8271    0    8     0    61    94    1      0
4     1     0   15     2  348    3     1    10    64   10     85
5     0     0    1    40    0  454     0     0     7   18      1
6    11     1    0    10    1    5  1832     1    23    2     22
7     0    31    0   489    2    0     2  6636    95    0      8
8     1     1    0   192    3    0     0    50  3044    1      4
9     0     0   53     9    4  188     1     2    16  220      0
10   13     1    4     9  211    3     8    62   286    2  12194
---- Validation: 
scalar performance:
{'acc': 0.93208504, 'precision': 0.84136605, 'recall': 0.8206911, 'specificity': 0.9927567, 'f1': 0.8240645, 'auroc': 0.9953311}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     0    3     9    1    3     6     8    23    3     30
1     0  1269    0    13    1    0     0    42     5    0      2
2     0     2  187     2   54    9     1    10     9   37      1
3     0     1    0  8266    0   16     0    61    96    0      0
4     2     0   21     3  341    6     0    14    58    6     88
5     0     0    1    40    0  453     0     0     8   18      1
6     9     1    0     8    2    7  1832     5    24    1     19
7     0    25    2   516    1    0     1  6625    91    0      4
8     1     0    3   172    2    2     0    53  3058    0      5
9     1     0   57     8    3  197     0     4    16  206      1
10    8     0    5    11  196    1    11    60   289    3  12212
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6995732, 'precision': 0.6832752, 'recall': 0.59939814, 'specificity': 0.9699749, 'f1': 0.5816279, 'auroc': 0.8814916}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   932     1   0   41    0   16   121    3    26   18    12
1     0  1320   0   43    1    0     0   87    18    0    30
2     2     2  32   11  191   43    16   25   561   52    80
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    0  576    0     1    0    66    1   988
5     3     0   0   69    0  462     2    0    31   22     3
6     0     0   0    2    1    0  2676    4   276    0   108
7     1     1   0  256    0    0     1  884    19    0     2
8     0     0   0   78    0    2     1    0  1288    1     0
9     5    15  13  112   23  275    12   17   401  251    13
10    0     0   0    0   63    0     0    0     5    0  1578
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 21:25:14.819308,epoch time: 0:55:08.021478,used: 0:55:08.021478,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95149297, 'precision': 0.87554973, 'recall': 0.85867023, 'specificity': 0.99477136, 'f1': 0.86140054, 'auroc': 0.9976638}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     0    1    0    15     2     3    2     21
1     0  1283    1     6    0    0     0    38     2    0      2
2     3     0  203     0   47    0     0     8     2   47      2
3     4     1    1  7964    1   15     8   365    67   12      0
4     6     0   17     0  373    1     1     3     8    1    129
5     0     0    0    15    1  306     0     0     4  194      1
6     8     0    1     1    5    1  1878     1     2    1      8
7     2    10    3    68    3    0     6  7153    15    0      4
8     4     1    7    87   25    3    10   197  2914   10     37
9     2     0   47     3    6    6     1     3     1  423      1
10   31     0    4     6   66    0    23    14    20    2  12627
---- Validation: 
scalar performance:
{'acc': 0.95209306, 'precision': 0.87931406, 'recall': 0.8631685, 'specificity': 0.99484104, 'f1': 0.86539745, 'auroc': 0.9976411}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     0    3    0    15     3     3    3     16
1     0  1281    1     7    0    0     0    40     3    0      0
2     2     0  216     0   46    0     0     4     2   40      2
3     6     1    0  7967    0   13     9   364    70   10      0
4     7     0   20     0  364    1     2     4     7    4    130
5     0     0    2    15    0  308     0     0     2  193      1
6     8     0    0     0    1    0  1886     1     3    2      7
7     2    10    2    73    2    0     7  7141    22    1      5
8     6     1    9   104   23    4     8   177  2929   11     24
9     3     0   44     2    5    5     0     3     0  431      0
10   31     0    1     6   57    0    21    25    22    1  12632
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74826837, 'precision': 0.6723293, 'recall': 0.6202773, 'specificity': 0.9743496, 'f1': 0.6218984, 'auroc': 0.88311946}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1017     1    0   2    5    0   115     3     1   21     5
1      2  1335    2  10    0    1    12   108     3    9    17
2      2     2  182   2  558    2    29    23    73   66    76
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    2   0  394    0     4     0     7    1  1223
5      4     0    5  24   13  177    14     0     4  344     7
6      0     0    0   1    1    0  3060     2     0    0     3
7      1     0    3  48    0    0     8  1099     0    2     3
8      0     0    3  66   19   10    78    24  1155   13     2
9      6    13  264  21   50   14    18    45    47  647    12
10     0     0    0   0   16    0     1     0     0    0  1629
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 22:18:50.975931,epoch time: 0:53:36.156623,used: 1:48:44.178101,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95168024, 'precision': 0.89524674, 'recall': 0.86195683, 'specificity': 0.9948684, 'f1': 0.86978984, 'auroc': 0.9979364}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    1     3    0    0     7     0     9    0      5
1     0  1283    0    10    0    1     1    30     7    0      0
2     3     0  233     0   18    0     1     4    12   39      2
3     0     3    0  8196    0    7     1   123   107    1      0
4     8     0   32     1  263    1     1     3    70   10    149
5     0     0    0    37    0  344     0     0     6  133      1
6     4     0    0     1    0    0  1890     2     3    3      5
7     0    19    0   174    1    0     1  6909   152    2      5
8     1     0    1    93    1    1     0    28  3166    3      2
9     7     0   44     6    0   12     2     1    12  409      0
10   37     0    3     7   12    1    13     4   293    3  12419
---- Validation: 
scalar performance:
{'acc': 0.9519326, 'precision': 0.89150566, 'recall': 0.85676545, 'specificity': 0.9949175, 'f1': 0.86574006, 'auroc': 0.99782896}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     2    0    0     8     0     7    1      7
1     0  1285    0    14    0    0     2    29     2    0      0
2     6     0  215     0   23    1     2     5    19   41      0
3     1     4    0  8224    0    4     0   105   101    1      0
4     6     0   31     0  275    2     0     2    79    6    138
5     2     0    0    31    0  333     0     0     5  149      1
6     5     0    0     2    0    0  1887     1     7    1      5
7     0    26    0   172    1    0     2  6911   148    1      4
8     1     1    1    93    1    2     1    34  3162    0      0
9     7     0   37     6    2   19     1     1    11  408      1
10   41     0    2     9    9    0    20     7   277    1  12430
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69649476, 'precision': 0.6878284, 'recall': 0.5823711, 'specificity': 0.9697498, 'f1': 0.5652514, 'auroc': 0.8799465}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   982     1   0   74   0    1    61    7    27   13     4
1     2  1325   0   40   0    0     2   92    19    0    19
2     5     5  78   28  15   14    16   15   605  103   131
3     0     0   0    0   0    0     0    0     0    0     0
4     1     0   4    0  47    0     5    0   106    1  1469
5     3     0   0  173   0  306     1    0    18   89     2
6     0     0   0    1   0    0  2953    3   108    0     2
7     0     1   0  179   0    0     2  971     9    0     2
8     0     0   0  111   0    0     2    2  1253    1     1
9     3    12  36  180   1  113    13   35   321  402    21
10    0     0   0    0   1    0     1    1     5    0  1638
early stop counter: 1
val acc:0.9519326090812683, best validation acc: 0.9520930647850037, corresponding to test acc:                         0.7482683658599854 / 0.7482683658599854
after epoch: 3,now: 2024-07-28 23:12:31.515924,epoch time: 0:53:40.539993,used: 2:42:24.718094,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9639608, 'precision': 0.91350955, 'recall': 0.8651098, 'specificity': 0.9959804, 'f1': 0.8825491, 'auroc': 0.99856377}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0     1    0    0    12     0     2    0     44
1     0  1271    0    10    0    0     3    36     7    0      4
2     4     0  152     0   79    0     2     2     5   59      9
3     4     1    1  8289    0   24     4    46    69    1      1
4     1     0    2     0  352    1     1     2    12    1    167
5     5     0    0    10    0  492     0     0     2   11      1
6     6     0    0     1    2    0  1869     0     2    0     28
7     7     2    0   183    1    0     4  6942    96    0     25
8     1     0    2    90    6    7     1    22  3142    0     25
9    10     0   12     3    8   86     3     4     2  361      4
10    2     0    1     6   13    1     3     5    27    0  12735
---- Validation: 
scalar performance:
{'acc': 0.96493244, 'precision': 0.9147178, 'recall': 0.87126404, 'specificity': 0.99610627, 'f1': 0.88727117, 'auroc': 0.9985341}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     1    2    0     8     0     1    0     42
1     1  1287    0    10    0    0     1    27     3    0      3
2     4     0  165     0   77    2     0     2     7   48      7
3     4     0    0  8295    0   19     2    49    71    0      0
4     3     0    2     0  353    2     1     0    11    0    167
5     4     0    0     8    0  490     0     0     3   14      2
6     5     0    1     0    1    1  1882     0     2    0     16
7     6    11    3   184    4    0     3  6948    90    0     16
8     1     0    1    90    6    9     2    25  3133    2     27
9    12     0   12     2    7   91     0     3     2  362      2
10    3     0    0     7    9    1     4     7    35    0  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7134262, 'precision': 0.6321303, 'recall': 0.60512054, 'specificity': 0.9709661, 'f1': 0.5831561, 'auroc': 0.8736207}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1080     0   0    3    4    0    62     0     2    1    18
1      2  1244   0   27    0    0     6   128     7    1    84
2      9     0  78    1  287    9    20    15   250   34   312
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0   64    0     2     1    11    0  1555
5     29     0   2   44    9  384     6     0    13   78    27
6      0     0   0    1    0    0  3004     1     0    0    61
7      2     0   1  128    1    1     3  1010     7    0    11
8      0     0   0   37    1    7    21     7  1285    3     9
9     59     5  87   37   34  140    26    55   216  402    76
10     0     0   0    0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 4,now: 2024-07-29 00:06:19.209093,epoch time: 0:53:47.693169,used: 3:36:12.411263,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9669574, 'precision': 0.9253682, 'recall': 0.88738024, 'specificity': 0.99630827, 'f1': 0.89840186, 'auroc': 0.99910927}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   384     0    1     0    0    0     6     2     3    1     86
1     0  1281    0     6    0    0     0    40     3    0      2
2     0     0  278     0    8    0     0     5     2   12      7
3     0     0    0  8181    0   31     0   103   119    0      4
4     0     0   31     0  356    1     1     5     9    0    136
5     0     0    1     3    0  502     0     0     3   11      1
6     1     0    0     3    0    0  1865     0     3    0     35
7     0     3    2    90    1    0     1  7076    79    0     13
8     0     0    4    21    1    4     0    31  3198    0     35
9     1     0   70     2    0  110     1     2     5  297      5
10    2     0    1     5   19    1     3     6    32    0  12723
---- Validation: 
scalar performance:
{'acc': 0.96546745, 'precision': 0.9205502, 'recall': 0.88606334, 'specificity': 0.9961622, 'f1': 0.89651704, 'auroc': 0.9990963}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    1     4    1    3     1     0     2    2     77
1     0  1275    0     5    0    0     0    42     8    0      2
2     0     0  275     0   11    3     0     3     2   11      7
3     0     0    0  8169    0   33     1   116   116    3      2
4     0     0   30     0  359    1     1     1    13    1    133
5     0     0    1     4    0  494     0     0     2   19      1
6     1     0    0     1    0    0  1859     1     3    0     43
7     0     1    0   101    1    0     1  7054    96    0     11
8     0     0    1    34    1    4     0    30  3199    0     27
9     0     0   67     1    0  117     0     4     1  298      5
10    1     0    0     7   23    1     2    11    31    0  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7300077, 'precision': 0.67526275, 'recall': 0.62980914, 'specificity': 0.9729182, 'f1': 0.6116564, 'auroc': 0.8855936}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1023     0    0   22    2   14    56    4    13   15    21
1      1  1244    0   30    0    0     4  179    14    0    27
2      1     0  208    4  148   31    10   34   348   32   199
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    5    0  329    0     2    1    29    0  1267
5      2     0    4   40    2  484     3    0    13   39     5
6      0     0    0    1    1    0  2941    3    54    0    67
7      1     0    0  156    0    1     0  993     8    0     5
8      0     0    0   47    0    9     9    4  1295    0     6
9      6     4  194   60    5  225     8   95   211  286    43
10     0     0    0    0   14    0     0    0     1    0  1631
better model found
persisted
after epoch: 5,now: 2024-07-29 01:06:08.591798,epoch time: 0:59:49.382705,used: 4:36:01.793968,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97570634, 'precision': 0.93094283, 'recall': 0.93344027, 'specificity': 0.9974343, 'f1': 0.93085, 'auroc': 0.9994259}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    1    0     3     0     0    0      2
1     0  1311    0     2    0    0     1    15     3    0      0
2     2     0  268     0    4    0     0     3     4   31      0
3     4     5    0  8235    1    6     5    68   115    0      0
4     9     0   43     0  404    1     2     5    11    3     60
5     0     0    1     7    0  477     0     0     5   30      1
6     7     0    0     0    0    0  1887     1     0    0     11
7     1     8    1   108    0    0     2  7102    39    1      3
8     4     1    0    17    2    1     1    38  3221    2      9
9     3     0   20     3    0   35     1     2     4  425      0
10   41     0    5     6   23    0     9     9    34    2  12662
---- Validation: 
scalar performance:
{'acc': 0.9766484, 'precision': 0.93286467, 'recall': 0.93233967, 'specificity': 0.9975369, 'f1': 0.93094695, 'auroc': 0.99942684}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    2    0    11     0     0    0      5
1     0  1304    0     3    0    0     0    24     1    0      0
2     3     0  266     0    3    1     0     1     4   34      0
3     2     7    0  8252    0    3     1    51   124    0      0
4     7     0   53     0  390    1     1     2    16    2     67
5     0     0    1    12    0  481     0     0     3   23      1
6     6     0    1     2    0    0  1890     0     1    1      7
7     3    11    1   105    0    0     5  7106    31    0      3
8     4     0    2     9    1    1     1    24  3249    1      4
9     2     0   16     3    0   28     1     0     2  441      0
10   42     0    2     7   21    0    12    10    31    2  12669
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7349052, 'precision': 0.6793331, 'recall': 0.624266, 'specificity': 0.97334564, 'f1': 0.6135741, 'auroc': 0.87955874}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1098     0    0    1    0    1    48    5     8    7     2
1      3  1262    0   23    0    0     5  181     5    1    19
2     16     1  199    5  135   16    47   46   306   85   159
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0   11    0  197    0     4    2    26    1  1392
5     12     0    3   63    2  364     7    0    11  128     2
6      0     0    0    1    1    0  3041    5     8    0    11
7      1     0    0  235    0    1     2  922     2    0     1
8      0     0    1   41    0    3    31    6  1283    2     3
9     36     5   76   65    4  135    20   90   185  500    21
10     0     0    0    0    4    0     1    1     2    0  1638
better model found
persisted
after epoch: 6,now: 2024-07-29 02:27:03.880002,epoch time: 1:20:55.288204,used: 5:56:57.082172,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.975091, 'precision': 0.94162995, 'recall': 0.93621004, 'specificity': 0.9972879, 'f1': 0.93655217, 'auroc': 0.9996151}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    2    0     0     0     0    1      1
1     0  1295    0     8    0    0     0    26     1    0      1
2     0     1  221     0   25    0     0     4     1   60      0
3     0     0    0  8402    1    9     0    13    14    1      0
4     3     0    5     0  503    0     0     2     4    2     20
5     0     0    0     9    1  471     0     0     0   39      1
6     7     0    0     2    1    0  1884     0     2    3      8
7     3     2    0   251    0    0     1  6990    13    1      4
8     2     0    0   173    7    4     0    24  3074    2      9
9     1     0    4     2    1   31     0     1     0  452      0
10   14     0    3     7   58    1     3    13    16    2  12674
---- Validation: 
scalar performance:
{'acc': 0.974669, 'precision': 0.9446775, 'recall': 0.932611, 'specificity': 0.9972242, 'f1': 0.93586105, 'auroc': 0.99960876}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    3    0     2     0     0    3      2
1     0  1297    0     8    0    0     0    27     0    0      0
2     1     0  214     0   30    2     0     5     4   55      1
3     0     0    0  8411    0    2     0    16    10    1      0
4     4     0    3     0  497    0     0     0     6    3     26
5     0     0    0     5    1  479     0     0     2   33      1
6     7     0    0     1    1    0  1886     0     1    2     10
7     2     3    0   272    0    0     1  6967    13    2      5
8     0     0    1   171    8    3     0    24  3079    2      8
9     1     0    2     3    0   35     0     1     1  449      1
10   13     0    1     8   52    1     5    10    18    1  12687
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7192332, 'precision': 0.66543305, 'recall': 0.59860754, 'specificity': 0.9721792, 'f1': 0.60151935, 'auroc': 0.88238513}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1094     0   0   30    5    2    12    4     3   17     3
1      2  1203   0   32    0    0     6  224     3    1    28
2      6     4  64   32  427   30    15   46   208   96    87
3      0     0   0    0    0    0     0    0     0    0     0
4      0     1   2    0  482    0     5    2    17    1  1123
5      8     0   0  106    6  305     0    0     1  162     4
6      1     0   0    1    2    0  3016    3     3    0    41
7      1     0   0  371    0    1     0  786     0    1     4
8      0     0   0  150    5    6    23    9  1170    4     3
9      8     5  39  151   27  162     4   86    90  547    18
10     0     1   0    0   29    0     2    0     1    0  1613
early stop counter: 1
val acc:0.9746689796447754, best validation acc: 0.9766483902931213, corresponding to test acc:                         0.7349051833152771 / 0.7482683658599854
after epoch: 7,now: 2024-07-29 03:45:02.066840,epoch time: 1:17:58.186838,used: 7:14:55.269010,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9811644, 'precision': 0.94686925, 'recall': 0.94990444, 'specificity': 0.9979352, 'f1': 0.94587564, 'auroc': 0.99971914}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    7    0     0     3     1    0      9
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     0  302     0    9    0     0     0     0    0      1
3     0     6    0  8353    0    4     0    62    13    1      0
4     1     0    8     0  496    0     0     1     1    0     31
5     0     0    1     8    0  500     0     0     1   10      1
6     3     0    0     2    1    1  1892     0     0    1      8
7     0    28    0    65    2    0     1  7130    17    1     20
8     1     2    1    92    4    2     0    32  3112    1     48
9     1     0   79     2    1   44     0     0     0  365      1
10    4     1    0     4   45    0     2     1     4    0  12730
---- Validation: 
scalar performance:
{'acc': 0.9816771, 'precision': 0.9503318, 'recall': 0.9532734, 'specificity': 0.99796796, 'f1': 0.94965637, 'auroc': 0.999733}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     1    1     0    6    0     0     0     0    0     17
1     0  1331    0     1    0    0     0     0     0    0      0
2     0     0  305     0    3    0     0     0     0    3      1
3     0     1    0  8354    0    7     1    55    20    1      1
4     0     0    9     1  503    0     0     1     3    0     22
5     0     0    3    11    0  498     0     0     0    8      1
6     3     1    0     2    3    0  1883     4     0    0     12
7     0    17    1    62    1    0     0  7144    18    1     21
8     0     1    1    90   10    1     0    26  3103    1     63
9     0     0   71     1    2   36     0     0     1  382      0
10    4     1    0     4   44    0     0     0     4    0  12739
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7347653, 'precision': 0.6814586, 'recall': 0.63166934, 'specificity': 0.97373056, 'f1': 0.6247613, 'auroc': 0.883181}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1044     1    3   26    3   13     8    42     3   21     6
1      0  1383    0   27    0    1     1    70     5    1    11
2      3    14  267   43  239   47     7    18   244   30   103
3      0     0    0    0    0    0     0     0     0    0     0
4      0     3    9    0  421    0     5     0    24    0  1171
5      1     0    2  139    0  419     0     0     1   29     1
6      4     3    1    8    0    1  2876     3    37    0   134
7      0     2    1   78    0    1     0  1078     1    0     3
8      0     2    1  180    0   14     9    11  1148    3     2
9      7    27  202  211    8  290     1    39    85  255    12
10     0     4    0    0   28    0     2     0     1    0  1611
better model found
persisted
after epoch: 8,now: 2024-07-29 05:10:24.211426,epoch time: 1:25:22.144586,used: 8:40:17.413596,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9830105, 'precision': 0.9681604, 'recall': 0.9546486, 'specificity': 0.9980637, 'f1': 0.9607563, 'auroc': 0.99978137}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    0    0     0     0     0    1      8
1     0  1321    0     3    0    0     0     8     0    0      0
2     1     0  284     0    3    0     0     0     3   19      2
3     0     0    0  8373    0    5     0    29    30    1      0
4     7     1    5     0  449    0     0     0     1    0     76
5     0     0    0     9    0  475     0     0     0   35      1
6     2     0    0     3    0    0  1891     0     0    0     11
7     2    10    2   162    1    0     0  7049    25    3     11
8     0     1    1    38    6    1     2    25  3189    3     29
9     0     0    7     0    1   11     2     1     0  470      1
10    1     0    1     6    8    0     5     1     3    0  12768
---- Validation: 
scalar performance:
{'acc': 0.9830948, 'precision': 0.9659599, 'recall': 0.9529005, 'specificity': 0.9980979, 'f1': 0.9586365, 'auroc': 0.9997668}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    1    0     1     0     0    0      6
1     0  1325    0     1    0    0     0     6     0    0      0
2     1     0  271     0    8    0     0     0     2   29      1
3     0     0    0  8385    0    1     0    27    24    2      1
4     5     1    8     0  448    0     0     2     6    1     68
5     0     0    0     8    0  479     0     0     1   33      0
6     4     0    0     1    1    0  1896     0     0    1      5
7     1    16    2   167    1    0     3  7028    34    3     10
8     1     0    1    48    3    2     1    19  3198    0     23
9     1     0    9     0    0    8     0     0     0  474      1
10    0     0    1     6    6    1     1     1     6    0  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7146855, 'precision': 0.6875136, 'recall': 0.60059184, 'specificity': 0.97159374, 'f1': 0.6166915, 'auroc': 0.87909085}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1072     0    0   11    2    2    24    3     1   30    25
1      3  1404    1   21    0    0     5   26     3    6    30
2      5     3  286   17  256   18    21    7   144   68   190
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    8    0  272    0     2    0    14    1  1336
5      8     0    3  134    0  284     1    0     3  146    13
6      0     0    1    1    2    0  2908    1     5    0   149
7      6    18   27  455    0    1     4  630     4    6    13
8      0     1    3  128    6    3    57    1  1152    5    14
9     13     9  206  120    9   88     7   13    66  568    38
10     0     0    0    0    6    0     1    0     0    0  1639
better model found
persisted
after epoch: 9,now: 2024-07-29 06:27:13.164713,epoch time: 1:16:48.953287,used: 9:57:06.366883,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98226136, 'precision': 0.9540022, 'recall': 0.96002173, 'specificity': 0.99811345, 'f1': 0.9553689, 'auroc': 0.9998027}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     1    2    0     0     0     0    0      0
1     0  1320    0     2    0    0     0     9     0    0      0
2     0     0  286     0   14    2     0     0     2    7      1
3     0     0    0  8395    1    9     0    29     4    0      0
4     1     0    5     0  511    0     0     0     7    0     15
5     0     0    0     1    0  519     0     0     1    0      0
6     1     0    0     0    0    0  1903     1     3    0      0
7     0     7    0   163    1    0     0  7083     6    2      3
8     0     0    2    74    0    8     0    29  3182    0      1
9     0     0   19     2    2   77     1     0     1  390      0
10   18     0    2     6   51    2     4     8    56    0  12644
---- Validation: 
scalar performance:
{'acc': 0.98173064, 'precision': 0.9547795, 'recall': 0.95671415, 'specificity': 0.9980608, 'f1': 0.9537718, 'auroc': 0.9997939}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    4    0     2     1     1    0      0
1     0  1318    0     4    0    0     0     9     0    0      1
2     0     0  279     0   22    3     1     1     1    3      2
3     1     0    0  8396    0    9     0    24     9    1      0
4     1     0    0     2  521    0     0     0     8    1      6
5     0     0    0     3    0  516     0     0     1    0      1
6     1     0    0     0    0    0  1901     1     4    0      1
7     0     6    0   150    1    0     0  7094    11    1      2
8     0     0    2   101    1    4     1    20  3166    0      1
9     0     0   14     2    4   86     0     0     1  386      0
10   21     0    2     8   45    0    10    11    49    0  12650
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77317566, 'precision': 0.7031873, 'recall': 0.66961384, 'specificity': 0.97747195, 'f1': 0.65548337, 'auroc': 0.8860984}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1086     0    1    7   10   19    27     1     0   11     8
1      4  1308    0   31    2    2     4   122     7    5    14
2      6     3  239   14  354   79    22    14   187   37    60
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    6    0  805    0     1     0    23    1   797
5      6     0    1   27    1  538     1     0     2   13     3
6      2     0    0    2    2    0  3031     1    16    0    13
7      2     0    7  118    0    1     0  1033     1    0     2
8      1     0    1  132    2   41    17    10  1160    4     2
9     16     8  131   85   19  462    13    28    57  297    21
10     0     0    0    0   89    0     1     1     1    0  1554
new oracle model saved
early stop counter: 1
val acc:0.9817306399345398, best validation acc: 0.9830948114395142, corresponding to test acc:                         0.7146854996681213 / 0.7731756567955017
after epoch: 10,now: 2024-07-29 07:33:02.680799,epoch time: 1:05:49.516086,used: 11:02:55.882969,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:02:55.882969 at 2024-07-29 07:33:02.680799
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7146855, 'precision': 0.6875136, 'recall': 0.60059184, 'specificity': 0.97159374, 'f1': 0.6166915, 'auroc': 0.87909085}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1072     0    0   11    2    2    24    3     1   30    25
1      3  1404    1   21    0    0     5   26     3    6    30
2      5     3  286   17  256   18    21    7   144   68   190
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    8    0  272    0     2    0    14    1  1336
5      8     0    3  134    0  284     1    0     3  146    13
6      0     0    1    1    2    0  2908    1     5    0   149
7      6    18   27  455    0    1     4  630     4    6    13
8      0     1    3  128    6    3    57    1  1152    5    14
9     13     9  206  120    9   88     7   13    66  568    38
10     0     0    0    0    6    0     1    0     0    0  1639
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77317566, 'precision': 0.7031873, 'recall': 0.66961384, 'specificity': 0.97747195, 'f1': 0.65548337, 'auroc': 0.8860984}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1086     0    1    7   10   19    27     1     0   11     8
1      4  1308    0   31    2    2     4   122     7    5    14
2      6     3  239   14  354   79    22    14   187   37    60
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    6    0  805    0     1     0    23    1   797
5      6     0    1   27    1  538     1     0     2   13     3
6      2     0    0    2    2    0  3031     1    16    0    13
7      2     0    7  118    0    1     0  1033     1    0     2
8      1     0    1  132    2   41    17    10  1160    4     2
9     16     8  131   85   19  462    13    28    57  297    21
10     0     0    0    0   89    0     1     1     1    0  1554
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_30_06_seed_1_23121324_instance_wise_predictions.txt
accuracy from prediction file 0.7146855103897013
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/30.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/30.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1656 MiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      8 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1656 MiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      8 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1655 MiB |  15770 MiB |   1349 TiB |   1349 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1339 TiB |   1339 TiB |
|       from small pool |      7 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16392 MiB |  16412 MiB |  30926 MiB |  14534 MiB |
|       from large pool |  16364 MiB |  16384 MiB |  30888 MiB |  14524 MiB |
|       from small pool |     28 MiB |     28 MiB |     38 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 224426 KiB | 680312 KiB | 204742 GiB | 204742 GiB |
|       from large pool | 216320 KiB | 677984 KiB | 194442 GiB | 194442 GiB |
|       from small pool |   8106 KiB |  17454 KiB |  10300 GiB |  10300 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3588    |    4646    |   89487 K  |   89483 K  |
|       from large pool |     247    |     593    |   45361 K  |   45361 K  |
|       from small pool |    3341    |    4346    |   44125 K  |   44122 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3588    |    4646    |   89487 K  |   89483 K  |
|       from large pool |     247    |     593    |   45361 K  |   45361 K  |
|       from small pool |    3341    |    4346    |   44125 K  |   44122 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     461    |     462    |     821    |     360    |
|       from large pool |     447    |     448    |     802    |     355    |
|       from small pool |      14    |      14    |      19    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     117    |     568    |   50455 K  |   50455 K  |
|       from large pool |      95    |     301    |   30898 K  |   30898 K  |
|       from small pool |      22    |     459    |   19556 K  |   19556 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1349 TiB |   1349 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1339 TiB |   1339 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |  16412 MiB |  30926 MiB |  29050 MiB |
|       from large pool |   1860 MiB |  16384 MiB |  30888 MiB |  29028 MiB |
|       from small pool |     16 MiB |     28 MiB |     38 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680312 KiB | 204743 GiB | 204743 GiB |
|       from large pool |  24320 KiB | 677984 KiB | 194443 GiB | 194443 GiB |
|       from small pool |      0 KiB |  17454 KiB |  10300 GiB |  10300 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4646    |   89487 K  |   89487 K  |
|       from large pool |       2    |     593    |   45361 K  |   45361 K  |
|       from small pool |       0    |    4346    |   44125 K  |   44125 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4646    |   89487 K  |   89487 K  |
|       from large pool |       2    |     593    |   45361 K  |   45361 K  |
|       from small pool |       0    |    4346    |   44125 K  |   44125 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     101    |     462    |     821    |     720    |
|       from large pool |      93    |     448    |     802    |     709    |
|       from small pool |       8    |      14    |      19    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     568    |   50456 K  |   50456 K  |
|       from large pool |       3    |     301    |   30898 K  |   30898 K  |
|       from small pool |       0    |     459    |   19557 K  |   19557 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 29 07:43:29 2024]
Finished job 0.
1 of 1 steps (100%) done
