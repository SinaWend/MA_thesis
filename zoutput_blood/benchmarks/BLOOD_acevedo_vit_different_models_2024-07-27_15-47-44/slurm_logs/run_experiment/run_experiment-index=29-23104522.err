Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 04:40:18 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/29.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=29
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522

 Experiment start at: 2024-07-28 04:51:38.953437
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.12040859460830688
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9417006, 'precision': 0.87733006, 'recall': 0.8100581, 'specificity': 0.99362165, 'f1': 0.8309026, 'auroc': 0.99611354}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   367     0    0     3    0    0    34     6    11    4     57
1     0  1246    0    15    0    0     0    61     3    1      6
2     1     0  173     0   28    1     1     9     9   79     11
3     1     1    0  7796    0   23     8   323   281    2      1
4     1     0   28     0  233    1     2     3    41   20    210
5     0     0    2    20    0  305     3     0    14  176      1
6     7     0    0     0    0    0  1862     6     7    3     22
7     1    10    2   120    2    0     3  7026    85    2     14
8     0     0    4    55    6    1     6    81  3086    5     51
9     1     0   24     5    0   28     4     4     8  417      2
10    8     0    2     8    7    0    17    14    51    1  12686
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94289154, 'precision': 0.8830163, 'recall': 0.81620765, 'specificity': 0.9937495, 'f1': 0.8366089, 'auroc': 0.9961021}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     0    0     2    0    0    30     5     5    9     53
1     0  1234    0    12    0    0     1    75     5    0      5
2     3     0  183     0   20    1     3    10     6   75     11
3     0     0    0  7818    0   17    13   313   276    2      1
4     0     0   25     0  226    1     4     6    41   20    216
5     0     0    2    24    0  317     0     0    13  164      1
6     6     0    0     1    0    0  1867     3     6    1     24
7     0     8    1   118    0    0     4  7022    96    3     13
8     1     0    5    46    6    2     6    80  3099    8     43
9     2     0   26     2    1   28     2     3     9  419      1
10    6     0    2     4   10    0    24    19    42    3  12686
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74651927, 'precision': 0.6800158, 'recall': 0.6390289, 'specificity': 0.9742893, 'f1': 0.6213906, 'auroc': 0.88899374}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1063     0    0   3    0    0    59    12     7   19     7
1      1  1188    0  26    0    0     2   226     7    9    40
2     17     0  183   6  139   13    48    60   251  138   160
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    3   0  200    0     2     1    17    0  1408
5     37     0    0  18    1  350    13     0    13  159     1
6      0     0    0   1    2    0  3009     3    38    0    14
7      2     0    0  16    0    0    11  1129     0    2     4
8      0     0    1  41    1    4    29     8  1282    2     2
9     40     4   89  32    1   92    23    82   121  628    25
10     0     0    0   0    8    0     0     0     0    0  1638
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 05:48:37.826665,epoch time: 0:56:58.873228,used: 0:56:58.873228,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9533658, 'precision': 0.88637936, 'recall': 0.85193443, 'specificity': 0.9948342, 'f1': 0.86253464, 'auroc': 0.997595}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     0    1     3    2    0    10     0     0    2     58
1     0  1259    0     9    0    0     0    50     5    1      8
2     3     0  244     0   33    1     1     4     0   20      5
3     1     0    1  8062    2   11     4   211   142    2      1
4     1     0   25     0  357    0     2     2     9    4    139
5     1     0    6    34    0  283     1     0     4  191      1
6     8     0    1     2    1    0  1871     1     0    0     23
7     0     5    1   133    1    0     2  7036    56    3     27
8     0     0    6    64   15    1     4    79  3025    3     98
9     1     0   81     5    3    8     1     3     3  383      5
10    3     0    2     5   49    0     9     7    11    2  12706
---- Validation: 
scalar performance:
{'acc': 0.9549819, 'precision': 0.88846475, 'recall': 0.85262156, 'specificity': 0.9950199, 'f1': 0.86382514, 'auroc': 0.9975593}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   403     0    1     2    1    0     4     3     2    3     64
1     0  1254    0     9    0    0     1    55     5    0      8
2     2     0  238     0   34    1     1     3     3   25      5
3     1     0    3  8089    0    7     4   193   137    5      1
4     2     0   24     0  361    0     0     2     6    5    139
5     1     0    1    34    0  284     0     0     9  191      1
6     5     0    1     2    1    0  1877     0     2    1     19
7     0     5    4   134    2    0     2  7041    50    5     22
8     2     0    7    64   17    1     2    62  3050    2     89
9     0     0   75     3    2   11     1     1     5  392      3
10    3     0    1     7   50    0     7     7     6    2  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73973274, 'precision': 0.6786698, 'recall': 0.62060153, 'specificity': 0.97390455, 'f1': 0.62685204, 'auroc': 0.8867056}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1091     0    0   12    0    0    26    7     3   17    14
1      2  1238    1   26    1    0     3  158     2   10    58
2      3     0  233   11  404    4     5   10   103   62   180
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    5    0  336    0     1    1     6    0  1283
5     12     0    2  102    7  255     6    0    15  192     1
6      0     0    0    1    2    0  3012    3     4    0    45
7      2     0    1  176    0    0     2  973     3    1     6
8      0     0    1   52    8    0     8    3  1285    5     8
9     19     2  261   88   18   47     7   33   118  515    29
10     0     0    0    0   11    0     0    0     0    0  1635
better model found
persisted
after epoch: 2,now: 2024-07-28 06:42:30.370202,epoch time: 0:53:52.543537,used: 1:50:51.416765,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9601616, 'precision': 0.9056709, 'recall': 0.87511826, 'specificity': 0.995559, 'f1': 0.88774097, 'auroc': 0.9984716}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     4    1    0     1     6     1    1     32
1     0  1290    0    12    0    0     0    28     1    0      0
2     2     0  234     0   31    1     0     9     1   32      2
3     1     0    0  8317    1    2     1    93    22    1      1
4     3     0   18     0  382    0     1     6    12    2    114
5     3     0    1    40    1  352     0     0     3  119      2
6     9     0    0     6    4    0  1870     0     3    2     13
7     0    15    1   174    2    0     1  7045    17    0      8
8     1     1    5   207   28    0     1   137  2865    0     50
9     0     1   44     8    6   21     1     4     2  403      2
10   10     0    3    10   47    0     6    18     8    1  12692
---- Validation: 
scalar performance:
{'acc': 0.9602782, 'precision': 0.90529966, 'recall': 0.8727361, 'specificity': 0.99557114, 'f1': 0.8861454, 'auroc': 0.9985303}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    1     4    4    0     3     3     1    1     37
1     0  1289    0     9    0    0     0    33     1    0      0
2     2     1  225     0   34    1     0     6     1   37      5
3     3     0    1  8324    0    2     2    86    19    3      0
4     3     0   26     0  380    0     0     3    12    1    114
5     3     0    1    40    0  355     1     0     5  115      1
6     5     0    2     3    1    0  1878     1     3    2     13
7     0    13    0   168    1    0     1  7059    14    1      8
8     1     1    3   221   21    0     3   133  2866    0     47
9     2     0   42     7    3   17     2     3     2  411      4
10    7     1    2    10   54    0     6    17    14    1  12684
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7258798, 'precision': 0.6763871, 'recall': 0.6033577, 'specificity': 0.9727259, 'f1': 0.60247684, 'auroc': 0.8872665}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1127     1    0    8    1    0    13    9     1    7     3
1      0  1285    0   24    1    0     1  182     1    0     5
2      8     8  176   26  227    6     7   67   263   41   186
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0  314    0     1    3    13    0  1300
5     14     0    1  164    2  240     1    0    16  147     7
6      1     4    0    2    2    0  3014    3    12    0    29
7      2     1    0  172    0    0     0  986     0    0     3
8      0     0    1  123    0    0     5   16  1223    1     1
9     20    26  123  191    4   60     4  114   185  374    36
10     0     0    0    0   10    0     0    0     0    0  1636
better model found
persisted
after epoch: 3,now: 2024-07-28 07:36:46.259119,epoch time: 0:54:15.888917,used: 2:45:07.305682,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9635595, 'precision': 0.9102787, 'recall': 0.8939664, 'specificity': 0.99606884, 'f1': 0.8983611, 'auroc': 0.9986541}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     1    2    1    18     0     1    2     16
1     0  1314    0     6    0    0     0     5     6    0      1
2     1     0  185     0   43    1     0     0     1   80      1
3     0     2    1  8303    0   11     3    58    58    2      0
4     5     1    7     0  417    1     1     2    11    8     86
5     0     0    0    16    0  441     1     0     4   58      1
6     3     0    0     0    1    1  1890     1     3    2      7
7     0    75    1   257    2    0     2  6831    81    4     10
8     0     1    1   108   12    5     0    42  3078    8     39
9     1     0    7     2    2   44     2     1     1  433      0
10   13     0    3     7   64    0     8     4    12    2  12680
---- Validation: 
scalar performance:
{'acc': 0.9643707, 'precision': 0.91054606, 'recall': 0.8957295, 'specificity': 0.99615335, 'f1': 0.89983785, 'auroc': 0.9987507}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     0    0    1    14     0     0    0     16
1     0  1315    0     3    0    0     0     7     6    0      1
2     2     0  186     0   47    2     0     1     3   71      0
3     1     3    1  8302    2   18     1    42    69    1      0
4     5     0    4     1  418    2     0     2    10    8     89
5     0     0    0    15    0  446     0     0     3   56      1
6     4     0    0     1    3    0  1881     0     2    2     15
7     0    76    4   243    2    0     3  6848    75    5      9
8     0     1    0   101   11    3     1    43  3085   10     41
9     1     0    9     3    0   51     2     0     2  425      0
10    8     1    4     7   51    1    11     2    15    1  12695
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75505495, 'precision': 0.66579187, 'recall': 0.645542, 'specificity': 0.9751864, 'f1': 0.62965614, 'auroc': 0.88385636}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1045     2    0   6    5    1    62     3    10   28     8
1      0  1421    0  20    2    3     1    28     8    0    16
2      2     1  113   5  412   14     4     7   204   89   164
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    2   0  202    0     1     0    10    0  1418
5      3     0    0  26    3  408     3     0    16  132     1
6      0     1    0   0    1    0  3045     2     6    0    12
7      0    29    2  64    0    1    17  1038     7    0     6
8      0     0    0  21    3    5     5     3  1329    3     1
9      8     9  107  38   16  134     8    23   215  551    28
10     0     0    0   0    5    0     1     0     0    0  1640
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 08:29:37.178060,epoch time: 0:52:50.918941,used: 3:37:58.224623,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9649775, 'precision': 0.9296051, 'recall': 0.86376107, 'specificity': 0.9961477, 'f1': 0.88082004, 'auroc': 0.99904853}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     1    1    0     3     5     1    4     34
1     0  1272    0    14    0    0     0    40     4    0      1
2     0     0  109     0   45    1     0     9     9  128     11
3     1     1    0  8342    0    0     1    36    54    1      0
4     4     0    0     0  356    1     0     3    27   11    137
5     0     0    0    23    0  446     0     0     8   43      1
6     7     0    0     2    2    0  1876     2     5    1     13
7     0     4    0   243    1    0     1  6872   139    0      4
8     1     0    1    62    2    0     0    11  3207    2     10
9     0     0    2     5    1   38     0     1     4  442      0
10    2     0    0     7   17    0     2     7    44    3  12711
---- Validation: 
scalar performance:
{'acc': 0.9642103, 'precision': 0.92741597, 'recall': 0.8636121, 'specificity': 0.9960782, 'f1': 0.8795997, 'auroc': 0.99900776}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     1    3    0     4     2     1    4     35
1     0  1279    0     8    0    0     0    39     5    0      1
2     0     0  111     0   41    1     0    12     7  130     10
3     2     1    0  8346    0    1     0    34    56    0      0
4     1     0    0     0  371    1     0     1    27   10    128
5     0     0    0    23    1  431     0     0     7   58      1
6    10     0    0     3    0    0  1868     3     3    4     17
7     0     7    0   236    1    0     1  6880   134    2      4
8     1     0    0    74    0    0     0    16  3191    3     11
9     0     0    2     5    0   37     0     2     5  442      0
10    4     0    0     7   25    0     2    13    46    4  12695
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7069195, 'precision': 0.67941165, 'recall': 0.59400386, 'specificity': 0.97066224, 'f1': 0.56925875, 'auroc': 0.88037145}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1022     0   0   13    0    0     8    59    16   38    14
1      0  1211   0   29    0    0     0   224    11    0    24
2     12     0  50   15   62   10     0    77   383  102   304
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   1    0  102    0     1     2    22    0  1505
5      3     0   0  154    0  289     0     1    27  116     2
6     10     0   0    7    0    0  2934     8    31    0    77
7      0     0   0   33    0    0     0  1130     0    0     1
8      0     0   0   90    0    0     1    13  1262    2     2
9      7     1  17  135    2   82     0   122   272  463    36
10     0     0   0    0    3    0     0     1     1    0  1641
early stop counter: 1
val acc:0.9642102718353271, best validation acc: 0.9643707275390625, corresponding to test acc:                         0.7550549507141113 / 0.7550549507141113
after epoch: 5,now: 2024-07-28 09:23:27.118049,epoch time: 0:53:49.939989,used: 4:31:48.164612,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97602737, 'precision': 0.9226839, 'recall': 0.9374106, 'specificity': 0.9975155, 'f1': 0.9296677, 'auroc': 0.99931824}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     1    0     1    1    0    13     3     0    2      3
1     0  1327    0     0    0    0     0     5     0    0      0
2     1     0  276     0   22    2     0     0     0   10      1
3     0    11    1  8255    0   14     0    90    64    2      0
4     6     0   11     0  464    0     1     2     9    2     44
5     0     0    0     5    0  453     0     0     3   59      1
6     4     0    0     1    0    0  1898     1     2    0      2
7     0    41    1    55    1    0     3  7128    27    2      5
8     2     5    5    47    9    1     1    44  3171    2      9
9     0     0   50     1    1   21     0     2     1  417      0
10   32     3    2     8   61    2    27     3    20    2  12632
---- Validation: 
scalar performance:
{'acc': 0.97573894, 'precision': 0.9215592, 'recall': 0.9365844, 'specificity': 0.99747586, 'f1': 0.9286554, 'auroc': 0.9992736}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    1    0     8     4     0    1      3
1     0  1321    0     1    0    0     0     9     1    0      0
2     0     0  275     1   22    2     0     0     2   10      0
3     1     3    1  8247    0   12     0    99    71    6      0
4     7     0   13     0  458    2     2     0     6    3     48
5     0     0    0     5    0  466     0     0     3   46      1
6     4     0    0     1    0    0  1895     2     2    1      3
7     0    36    2    75    1    0     4  7111    30    2      4
8     3     5    2    36    8    1     1    30  3197    2     11
9     0     0   58     2    0   30     0     0     1  402      0
10   28     2    2     7   66    1    23     4    21    1  12641
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76932764, 'precision': 0.70238674, 'recall': 0.65366113, 'specificity': 0.9764918, 'f1': 0.6544796, 'auroc': 0.8877258}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   948     1    2   6    0    1   160    33     4   15     0
1     0  1448    1   8    0    0     0    33     2    2     5
2     7     8  301  16  184   12    86    35   186   92    88
3     0     0    0   0    0    0     0     0     0    0     0
4     2     1    6   0  349    0    14     0    16    0  1245
5     4     0    1  71    2  313    12     0     9  179     1
6     0     1    0   1    0    0  3059     2     2    0     2
7     0    18    1  14    0    0    11  1116     0    1     3
8     0     0    1  67    1    1    35    17  1241    6     1
9     5    12  199  69    4   78    30    37    90  602    11
10    0     2    0   0   19    0     5     0     1    0  1619
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-28 10:16:39.884207,epoch time: 0:53:12.766158,used: 5:25:00.930770,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97923803, 'precision': 0.94310474, 'recall': 0.94356424, 'specificity': 0.9977328, 'f1': 0.942541, 'auroc': 0.9996194}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    1     1    4    0     1     0     0    4     15
1     0  1319    0     1    0    0     0     9     2    0      1
2     0     0  283     0   12    0     0     0     2   15      0
3     0     1    0  8394    0    2     0    27    12    2      0
4     1     0    9     0  470    0     0     0     3    1     55
5     0     0    1    10    0  445     1     0     0   62      1
6     3     0    0     1    0    0  1889     0     1    0     13
7     0    17    6   129    3    0     2  7063    34    3      6
8     0     1    3   113   11    0     0    17  3133    3     14
9     0     0   33     2    1    9     0     0     1  447      0
10    1     0    6     9   62    0     5     2     9    0  12700
---- Validation: 
scalar performance:
{'acc': 0.97926974, 'precision': 0.94745886, 'recall': 0.946471, 'specificity': 0.9977076, 'f1': 0.9460037, 'auroc': 0.99964404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     3    5    1     1     0     1    3     23
1     0  1319    0     3    0    0     0     9     0    0      1
2     0     0  294     1    7    0     0     0     1    9      0
3     0     1    0  8403    0    0     0    24    10    1      1
4     1     0   11     0  471    0     0     0     3    0     53
5     0     0    0    12    0  450     0     0     0   58      1
6     1     0    1     2    3    0  1890     0     0    0     11
7     0    22    6   148    0    0     2  7050    26    6      5
8     0     0    5   120    9    1     0     8  3129    2     22
9     0     0   32     0    3    5     0     0     0  453      0
10    4     0    5     7   52    0     4     5    14    0  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74700904, 'precision': 0.7040474, 'recall': 0.6212674, 'specificity': 0.97489905, 'f1': 0.63454634, 'auroc': 0.884732}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   967     0   10   39    5    0    53    52     7   28     9
1     1  1317    0   24    2    0     0   129     4    2    20
2     4     1  417   41  211    6     8    26   184   70    47
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0   18    0  426    0     4     0    23    0  1162
5     4     0   13  175    3  151     1     0     1  243     1
6     0     1    2    2    0    0  3017     3    16    1    25
7     1     0    1  108    0    0     1  1048     0    1     4
8     0     0    2  175    2    0    11    15  1159    3     3
9     2     4  203  207    5   39     5    49    59  554    10
10    0     0    0    0   23    0     1     0     1    0  1621
better model found
persisted
after epoch: 7,now: 2024-07-28 11:10:14.715603,epoch time: 0:53:34.831396,used: 6:18:35.762166,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9823951, 'precision': 0.9635396, 'recall': 0.94957846, 'specificity': 0.99806976, 'f1': 0.9560989, 'auroc': 0.9997446}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     3    4    0     1     0     2    1      1
1     1  1305    0    10    0    0     0    14     2    0      0
2     0     0  283     1    5    0     0     3     8   12      0
3     0     1    0  8388    0    2     0    21    24    0      0
4     4     0   11     0  440    0     0     1    21    1     61
5     0     0    0    11    0  479     0     0     5   24      1
6     1     0    0     1    0    0  1896     0     2    0      8
7     1     1    0   161    0    0     2  7055    41    0      4
8     0     0    1    27    1    0     1     2  3261    0      1
9     0     0   16     3    0   24     0     0     4  446      0
10    2     0    2    10   20    0     5     9    52    0  12694
---- Validation: 
scalar performance:
{'acc': 0.9822121, 'precision': 0.96624064, 'recall': 0.9497841, 'specificity': 0.9980409, 'f1': 0.95750177, 'auroc': 0.9997281}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    1     2    3    0     6     0     1    1      5
1     0  1306    0     9    0    0     0    17     0    0      0
2     0     0  282     1    4    0     0     2    11   12      0
3     0     0    0  8383    0    3     0    24    30    0      0
4     2     0    7     0  452    0     1     0    16    4     57
5     0     0    0    14    0  475     0     0     4   27      1
6     1     0    0     2    1    0  1894     0     4    0      6
7     0     2    0   171    0    0     1  7040    43    1      7
8     0     0    0    31    0    0     0     2  3260    0      3
9     0     0   18     1    0   18     1     0     4  451      0
10    1     0    2     7   11    0     3     4    54    1  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69614494, 'precision': 0.65690494, 'recall': 0.57920253, 'specificity': 0.9694388, 'f1': 0.5763575, 'auroc': 0.87700516}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   820     0    3   22    6    0   231   25    11   45     7
1     2  1191    0   29    2    0     0  237    16    2    20
2     4     1  199   18  176    8    21   44   389   78    77
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0   11    0  174    0     3    0    37    0  1408
5     4     0    1  129    0  261     2    0    27  165     3
6     1     0    0    1    0    0  2956    3    45    1    60
7     0     0    0  179    0    0     7  968     4    1     5
8     0     0    0   77    0    0     6    5  1280    2     0
9     3     3   65  168    2  116    12   61   230  464    13
10    0     0    0    0    6    0     1    0     2    0  1637
better model found
persisted
after epoch: 8,now: 2024-07-28 12:04:24.654725,epoch time: 0:54:09.939122,used: 7:12:45.701288,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9877729, 'precision': 0.9704735, 'recall': 0.96284574, 'specificity': 0.9986763, 'f1': 0.96628296, 'auroc': 0.99984235}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     2    2    0     0     0     0    0      1
1     0  1313    0     4    0    0     0    12     0    0      1
2     1     0  270     0   19    1     0     0     3   16      2
3     0     0    1  8357    1    2     0    43    29    2      0
4     4     0    1     0  488    0     0     0     5    0     41
5     0     0    0     2    0  513     0     0     0    6      0
6     4     0    0     7    1    0  1893     1     0    0      2
7     0     3    2    65    0    0     1  7158    32    0      3
8     0     0    0    18    2    0     0    14  3256    1      5
9     0     0    7     1    1   36     0     0     1  447      0
10    8     0    0     5   10    0     8     4    14    0  12746
---- Validation: 
scalar performance:
{'acc': 0.9874816, 'precision': 0.96958244, 'recall': 0.9623437, 'specificity': 0.99865323, 'f1': 0.9655526, 'auroc': 0.9998538}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     1    1    0     0     0     0    1      2
1     0  1314    0     5    0    0     0    12     0    0      1
2     0     0  265     0   22    0     0     0     3   22      0
3     0     0    0  8358    0    4     0    39    38    1      0
4     3     0    1     0  501    0     0     0     3    0     31
5     0     0    0     4    0  504     0     0     3   10      0
6     4     0    0     7    0    0  1893     2     1    0      1
7     0     2    0    67    1    0     1  7164    25    0      5
8     1     0    0    23    1    0     0    13  3252    0      6
9     1     0    7     0    1   32     0     0     2  450      0
10    9     0    1     7   10    1     5     6    19    0  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73070735, 'precision': 0.67441815, 'recall': 0.62231815, 'specificity': 0.97315836, 'f1': 0.6035852, 'auroc': 0.8785249}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1032     0    1   11    0   12    36    36    14   26     2
1      1  1223    0   30    2    2     1   222     5    2    11
2      7     1  142   32  234   62    34    53   300   72    78
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    9    0  293    0    14     0    31    0  1285
5      6     0    0  114    0  417     2     0     9   42     2
6      1     0    0    1    1    0  3047     3    12    0     2
7      0     0    1   56    0    1     2  1100     0    2     2
8      0     0    0  148    1    4    15    15  1183    4     0
9      5     7   34  146    3  362    12    68   112  377    11
10     0     0    0    0   12    0     3     0     1    0  1630
better model found
persisted
after epoch: 9,now: 2024-07-28 13:09:08.039554,epoch time: 1:04:43.384829,used: 8:17:29.086117,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98638165, 'precision': 0.9639483, 'recall': 0.9687295, 'specificity': 0.9985739, 'f1': 0.9661647, 'auroc': 0.99985194}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     3    3    0     0     2     2    0      3
1     0  1293    0     1    0    0     0    35     1    0      0
2     0     0  296     0    4    0     1     2     0    9      0
3     0     0    0  8288    0   18     0    51    79    1      0
4     6     0    9     0  505    0     0     3     4    0     12
5     0     0    1     1    0  502     0     0     2   14      1
6     5     0    0     0    1    0  1890     3     0    0      9
7     0     0    0    40    0    0     0  7175    46    0      3
8     0     0    0     3    4    0     0     6  3275    0      8
9     0     0   10     1    1   27     0     2     2  450      0
10    3     0    2     6   41    0     1     3    14    0  12723
---- Validation: 
scalar performance:
{'acc': 0.9878293, 'precision': 0.96764463, 'recall': 0.97184545, 'specificity': 0.99872154, 'f1': 0.9693793, 'auroc': 0.99988}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    3    0     0     0     0    1      1
1     0  1300    0     1    0    0     0    31     0    0      0
2     0     0  295     0    6    0     0     3     1    6      1
3     0     0    0  8312    0   10     0    50    68    0      0
4     3     1    3     0  522    0     0     0     1    0      9
5     0     0    0     2    0  509     0     0     0   10      0
6     5     0    0     0    0    0  1895     0     1    0      7
7     0     1    0    50    0    0     0  7184    27    0      3
8     0     0    0     5    4    2     0    11  3268    0      6
9     0     0   16     0    2   37     0     2     1  435      0
10    2     0    1     6   34    1     2     7    10    0  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71874344, 'precision': 0.67129374, 'recall': 0.6108101, 'specificity': 0.9718956, 'f1': 0.5860659, 'auroc': 0.88010406}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   981     0    0  16    0    7    21    72    28   44     1
1     0  1108    0  25    0    0     2   345     7    0    12
2     9     1  118  18  113   33    25    97   443  108    50
3     0     0    0   0    0    0     0     0     0    0     0
4     2     0    8   0  287    0     9     9    56    0  1262
5     5     0    0  66    0  402     0     0    15  103     1
6     4     0    0   4    0    0  3003     7    37    0    12
7     0     0    0  69    0    0     0  1091     2    1     1
8     0     0    0  66    0    3     6    13  1274    7     1
9     4     1   20  96    2  257     8   124   236  380     9
10    0     0    0   0   16    0     0     0     1    0  1629
better model found
persisted
after epoch: 10,now: 2024-07-28 14:13:22.526016,epoch time: 1:04:14.486462,used: 9:21:43.572579,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 9:21:43.572579 at 2024-07-28 14:13:22.526016
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71874344, 'precision': 0.67129374, 'recall': 0.6108101, 'specificity': 0.9718956, 'f1': 0.5860659, 'auroc': 0.88010406}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   981     0    0  16    0    7    21    72    28   44     1
1     0  1108    0  25    0    0     2   345     7    0    12
2     9     1  118  18  113   33    25    97   443  108    50
3     0     0    0   0    0    0     0     0     0    0     0
4     2     0    8   0  287    0     9     9    56    0  1262
5     5     0    0  66    0  402     0     0    15  103     1
6     4     0    0   4    0    0  3003     7    37    0    12
7     0     0    0  69    0    0     0  1091     2    1     1
8     0     0    0  66    0    3     6    13  1274    7     1
9     4     1   20  96    2  257     8   124   236  380     9
10    0     0    0   0   16    0     0     0     1    0  1629
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76932764, 'precision': 0.70238674, 'recall': 0.65366113, 'specificity': 0.9764918, 'f1': 0.6544796, 'auroc': 0.8877258}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   948     1    2   6    0    1   160    33     4   15     0
1     0  1448    1   8    0    0     0    33     2    2     5
2     7     8  301  16  184   12    86    35   186   92    88
3     0     0    0   0    0    0     0     0     0    0     0
4     2     1    6   0  349    0    14     0    16    0  1245
5     4     0    1  71    2  313    12     0     9  179     1
6     0     1    0   1    0    0  3059     2     2    0     2
7     0    18    1  14    0    0    11  1116     0    1     3
8     0     0    1  67    1    1    35    17  1241    6     1
9     5    12  199  69    4   78    30    37    90  602    11
10    0     2    0   0   19    0     5     0     1    0  1619
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_51_38_seed_0_23104522_instance_wise_predictions.txt
accuracy from prediction file 0.718743440845169
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/29.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/29.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/29.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15814 MiB | 692963 GiB | 692962 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 688007 GiB | 688005 GiB |
|       from small pool |      7 MiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15814 MiB | 692963 GiB | 692962 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 688007 GiB | 688005 GiB |
|       from small pool |      7 MiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15770 MiB | 690707 GiB | 690705 GiB |
|       from large pool |   1647 MiB |  15745 MiB | 685754 GiB | 685753 GiB |
|       from small pool |      6 MiB |     26 MiB |   4952 GiB |   4952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16412 MiB |  16412 MiB |  16412 MiB |      0 B   |
|       from large pool |  16384 MiB |  16384 MiB |  16384 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 225344 KiB | 680312 KiB | 102375 GiB | 102375 GiB |
|       from large pool | 216320 KiB | 677984 KiB |  97209 GiB |  97209 GiB |
|       from small pool |   9024 KiB |  11930 KiB |   5165 GiB |   5165 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   44744 K  |   44741 K  |
|       from large pool |     247    |     593    |   22680 K  |   22680 K  |
|       from small pool |    2399    |    3599    |   22063 K  |   22060 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   44744 K  |   44741 K  |
|       from large pool |     247    |     593    |   22680 K  |   22680 K  |
|       from small pool |    2399    |    3599    |   22063 K  |   22060 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     462    |     462    |     462    |       0    |
|       from large pool |     448    |     448    |     448    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     113    |     563    |   25171 K  |   25171 K  |
|       from large pool |      94    |     301    |   15425 K  |   15425 K  |
|       from small pool |      19    |     454    |    9745 K  |    9745 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 690707 GiB | 690707 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 685754 GiB | 685754 GiB |
|       from small pool |      0 KiB |     26 MiB |   4952 GiB |   4952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |  16412 MiB |  16412 MiB |  14536 MiB |
|       from large pool |   1860 MiB |  16384 MiB |  16384 MiB |  14524 MiB |
|       from small pool |     16 MiB |     28 MiB |     28 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680312 KiB | 102376 GiB | 102376 GiB |
|       from large pool |  24320 KiB | 677984 KiB |  97210 GiB |  97210 GiB |
|       from small pool |      0 KiB |  15445 KiB |   5165 GiB |   5165 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     101    |     462    |     462    |     361    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       8    |      14    |      14    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     563    |   25171 K  |   25171 K  |
|       from large pool |       3    |     301    |   15426 K  |   15426 K  |
|       from small pool |       0    |     454    |    9745 K  |    9745 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 690707 GiB | 690707 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 685754 GiB | 685754 GiB |
|       from small pool |      0 KiB |     26 MiB |   4952 GiB |   4952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |  16412 MiB |  16412 MiB |  14536 MiB |
|       from large pool |   1860 MiB |  16384 MiB |  16384 MiB |  14524 MiB |
|       from small pool |     16 MiB |     28 MiB |     28 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680312 KiB | 102376 GiB | 102376 GiB |
|       from large pool |  24320 KiB | 677984 KiB |  97210 GiB |  97210 GiB |
|       from small pool |      0 KiB |  15445 KiB |   5165 GiB |   5165 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     101    |     462    |     462    |     361    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       8    |      14    |      14    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     563    |   25171 K  |   25171 K  |
|       from large pool |       3    |     301    |   15426 K  |   15426 K  |
|       from small pool |       0    |     454    |    9745 K  |    9745 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522

 Experiment start at: 2024-07-28 14:40:18.077715
before training, model accuracy: 0.09417197853326797
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9331389, 'precision': 0.84308934, 'recall': 0.82420796, 'specificity': 0.9928782, 'f1': 0.8272772, 'auroc': 0.99555695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   388     0    0     6    0    2     8     9    22    8     40
1     0  1278    0    13    0    0     0    35     4    0      1
2     0     0  183     3   54    8     2    10    13   37      2
3     1     2    1  8258    0   13     0    59   102    1      0
4     1     0   16     2  352    3     1     9    61   10     84
5     0     0    1    37    0  459     0     0     8   16      0
6    10     1    0    10    2    5  1832     2    23    2     21
7     0    34    1   482    2    0     2  6633   101    0      8
8     1     1    2   179    5    0     0    50  3054    0      4
9     0     0   56     9    4  186     1     1    13  221      2
10    6     1    5     9  223    3    10    54   261    2  12219
---- Validation: 
scalar performance:
{'acc': 0.93235254, 'precision': 0.83920527, 'recall': 0.8216466, 'specificity': 0.9927993, 'f1': 0.8229502, 'auroc': 0.99538994}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     0    3     8    1    3     7     8    21    4     35
1     0  1274    0    12    1    0     0    38     5    0      2
2     0     2  188     2   54    9     1     9     9   37      1
3     0     2    0  8256    0   19     0    60   102    1      0
4     2     0   22     3  345    5     0    12    56    6     88
5     0     0    1    34    0  460     0     0     7   18      1
6     8     0    0     8    2    7  1835     5    22    1     20
7     0    33    2   519    1    1     1  6609    95    0      4
8     1     0    3   158    5    2     0    53  3071    0      3
9     1     0   58     7    3  204     0     4    15  200      1
10    4     0    5    13  211    1    11    55   267    4  12225
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7017421, 'precision': 0.67833143, 'recall': 0.6001408, 'specificity': 0.97015595, 'f1': 0.5838525, 'auroc': 0.8818017}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   899     2   0   37    0   20   146    2    27   24    13
1     0  1334   0   41    1    0     0   76    18    0    29
2     1     2  31    9  217   44    21   19   541   52    78
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    0  632    0     1    0    59    1   939
5     3     0   0   58    0  469     2    0    32   25     3
6     0     0   1    2    3    0  2697    4   249    0   111
7     0     3   0  288    0    0     2  846    23    0     2
8     0     0   0   70    0    2     2    0  1295    1     0
9     3    15  15   98   24  284    14   15   390  265    14
10    0     0   0    0   78    0     0    0     6    0  1562
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 15:47:06.043250,epoch time: 1:06:47.965535,used: 1:06:47.965535,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9512789, 'precision': 0.8750918, 'recall': 0.85947096, 'specificity': 0.99473774, 'f1': 0.8617428, 'auroc': 0.9976356}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     0    1    0    14     2     4    2     22
1     0  1286    1     6    0    0     0    35     2    0      2
2     3     0  209     0   45    0     0     7     2   45      1
3     5     1    1  7971    1   15     4   368    60   12      0
4     6     0   18     0  373    1     0     3     8    1    129
5     0     0    0    15    1  306     0     0     3  195      1
6     8     0    1     1    5    1  1877     1     2    1      9
7     1     9    4    68    3    0     6  7155    14    0      4
8     4     1   10    93   29    3     9   204  2890    9     43
9     3     0   46     3    7    7     1     3     1  421      1
10   28     0    4     6   69    0    23    16    16    2  12629
---- Validation: 
scalar performance:
{'acc': 0.95206636, 'precision': 0.88127387, 'recall': 0.8619112, 'specificity': 0.99481547, 'f1': 0.86525875, 'auroc': 0.9975971}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     0    3    0    13     4     2    3     18
1     0  1283    1     7    0    0     0    38     3    0      0
2     2     0  217     0   46    0     0     4     2   40      1
3     6     1    1  7978    0   12    11   352    68   11      0
4     7     0   23     0  359    1     2     3     7    2    135
5     0     0    2    15    0  303     0     0     2  198      1
6     5     0    0     0    1    0  1886     3     2    2      9
7     3     8    2    77    3    0     6  7139    19    2      6
8     6     2    9   108   24    4     7   195  2901   10     30
9     3     0   41     2    6    4     0     3     0  434      0
10   26     0    1     6   49    0    20    23    16    1  12654
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74917793, 'precision': 0.6722644, 'recall': 0.6225559, 'specificity': 0.97445583, 'f1': 0.6234744, 'auroc': 0.8827116}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1023     1    0   2    5    0   105     3     1   23     7
1      2  1340    2   9    0    1    11   106     2    9    17
2      2     4  176   3  556    2    29    24    78   67    74
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    2   0  378    0     5     0     7    1  1239
5      3     0    3  27   13  191    13     0     4  331     7
6      0     0    0   1    1    0  3059     2     0    0     4
7      1     0    2  38    0    0     6  1112     0    2     3
8      0     0    2  75   17   10    69    28  1156   11     2
9      7    18  245  22   51   16    21    46    54  643    14
10     0     0    0   0   15    0     1     0     0    0  1630
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 16:48:49.385818,epoch time: 1:01:43.342568,used: 2:08:31.308103,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9514662, 'precision': 0.8924433, 'recall': 0.8573988, 'specificity': 0.99483955, 'f1': 0.867381, 'auroc': 0.9978513}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    1     5    0    0     7     0     9    0      6
1     0  1285    0    13    0    0     1    27     6    0      0
2     3     0  224     1   28    0     2     5    15   32      2
3     0     3    0  8185    0    7     1   132   109    1      0
4     7     1   28     1  269    1     2     3    71    7    148
5     0     0    0    41    0  345     0     0     6  128      1
6     4     0    0     1    0    0  1891     2     3    2      5
7     0    17    0   174    1    0     1  6934   129    2      5
8     1     0    2    87    1    1     0    34  3168    1      1
9    10     0   48     7    1   12     2     4    16  393      0
10   39     0    3     8   12    0    16     3   295    3  12413
---- Validation: 
scalar performance:
{'acc': 0.95030093, 'precision': 0.88676786, 'recall': 0.85072315, 'specificity': 0.99473614, 'f1': 0.86077964, 'auroc': 0.99776703}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     3    0    0     7     0     7    1      8
1     0  1290    0    14    0    0     1    25     2    0      0
2     7     0  217     0   28    0     1     6    21   32      0
3     1     3    0  8217    0    2     0   120    97    0      0
4     7     0   26     1  278    1     0     2    85    4    135
5     4     0    0    42    0  322     0     0     6  146      1
6     5     0    0     3    0    0  1885     1     7    1      6
7     0    26    0   186    1    0     2  6909   136    1      4
8     1     1    2    92    1    2     1    35  3160    0      1
9     9     0   55     6    2   20     3     2    13  381      2
10   39     0    2     9    9    0    19     9   297    1  12411
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6915273, 'precision': 0.6893201, 'recall': 0.57415885, 'specificity': 0.9692865, 'f1': 0.5596254, 'auroc': 0.87894607}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   946     1   0  101   0    1    66   13    29   11     2
1     1  1337   0   40   0    0     2   84    17    0    18
2     5     6  79   32  19    9    15   15   611   92   132
3     0     0   0    0   0    0     0    0     0    0     0
4     1     0   4    0  50    0     8    0   118    1  1451
5     2     0   0  196   0  281     1    0    19   91     2
6     0     0   0    2   0    0  2963    3    97    0     2
7     0     1   0  186   0    0     1  964    10    0     2
8     0     0   0  109   0    0     0    3  1256    1     1
9     3    21  30  196   1   93    13   36   352  372    20
10    0     1   0    0   1    0     1    1     6    0  1636
early stop counter: 1
val acc:0.950300931930542, best validation acc: 0.9520663619041443, corresponding to test acc:                         0.7491779327392578 / 0.7491779327392578
after epoch: 3,now: 2024-07-28 17:42:05.563818,epoch time: 0:53:16.178000,used: 3:01:47.486103,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96417487, 'precision': 0.9162197, 'recall': 0.8662804, 'specificity': 0.99598205, 'f1': 0.88543737, 'auroc': 0.9985813}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     1    1    0    11     0     2    0     56
1     0  1277    0     7    0    0     3    31     8    0      5
2     4     0  166     0   69    1     2     2     4   55      9
3     4     1    1  8275    0   24     4    60    71    0      0
4     2     0    1     0  352    1     1     2    11    2    167
5     5     0    0    14    1  485     0     0     2   13      1
6     7     0    0     1    2    0  1871     0     2    0     25
7     4     5    0   168    2    0     4  6966    82    0     29
8     1     0    2    83    6    8     1    34  3131    0     30
9     9     0   13     4    7   84     3     4     2  362      5
10    1     0    0     6   14    1     2     5    23    1  12740
---- Validation: 
scalar performance:
{'acc': 0.96635014, 'precision': 0.9148806, 'recall': 0.8739976, 'specificity': 0.99626553, 'f1': 0.8893372, 'auroc': 0.9985485}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     1    2    0     7     0     1    0     42
1     0  1290    0     8    0    0     1    26     4    0      3
2     4     0  169     0   74    2     0     1     6   49      7
3     3     0    0  8281    0   20     1    54    79    0      2
4     3     0    3     0  358    1     1     0    12    0    161
5     5     0    0     7    1  490     0     0     3   13      2
6     6     0    1     0    1    1  1881     0     1    0     17
7     5    10    3   148    4    0     3  6999    75    0     18
8     1     0    1    76    7   11     1    31  3135    2     31
9    11     0   14     2    7   90     0     3     2  361      3
10    3     0    0     7   11    1     3     7    31    0  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7145456, 'precision': 0.6327661, 'recall': 0.6070182, 'specificity': 0.97108114, 'f1': 0.5844983, 'auroc': 0.8738958}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1058     0   0    4    5    0    68     1     3    1    30
1      1  1249   0   23    0    0     8   116     6    1    95
2      8     0  76    2  268    9    13    15   264   40   320
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0   60    0     2     1    10    0  1560
5     29     0   2   40    7  401     4     0    16   71    22
6      0     0   0    1    0    0  3017     2     0    0    47
7      1     1   0  129    0    1     3  1008     6    1    14
8      0     0   0   36    1    6    19     9  1286    3    10
9     45     4  89   35   29  148    22    54   221  412    78
10     0     0   0    0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 4,now: 2024-07-28 18:35:06.207055,epoch time: 0:53:00.643237,used: 3:54:48.129340,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9655929, 'precision': 0.9233929, 'recall': 0.88301444, 'specificity': 0.99616086, 'f1': 0.89336514, 'auroc': 0.99911344}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     0    0     0    0    0     5     4     4    1     91
1     0  1278    0     6    0    0     0    43     4    0      1
2     0     0  282     0    6    0     0     3     2   12      7
3     0     0    0  8163    0   33     0   108   131    0      3
4     0     0   31     0  352    1     1     4    10    0    140
5     0     0    1     4    0  506     0     0     2    7      1
6     2     0    1     3    0    0  1858     1     3    0     39
7     0     3    3    82    1    0     1  7084    78    0     13
8     0     0    4    19    3    6     0    31  3196    0     35
9     1     0   75     2    0  122     0     3     5  277      8
10    1     0    1     5   18    1     3    10    37    0  12716
---- Validation: 
scalar performance:
{'acc': 0.9645045, 'precision': 0.919706, 'recall': 0.8828422, 'specificity': 0.9960635, 'f1': 0.89337957, 'auroc': 0.9991098}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     0    1     2    0    4     2     3     2    2     85
1     0  1275    0     6    0    1     0    42     7    0      1
2     0     0  276     0   10    3     0     3     2   11      7
3     0     0    0  8160    0   31     0   118   129    1      1
4     0     0   31     0  358    1     1     1    15    0    132
5     0     0    1     4    0  497     0     0     2   16      1
6     1     0    0     1    0    0  1852     1     4    0     49
7     0     2    0    91    1    0     1  7061   100    0      9
8     0     0    1    32    2    7     0    31  3195    0     28
9     0     0   71     1    0  122     0     5     1  290      3
10    1     0    0     7   23    1     3    10    39    0  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7267194, 'precision': 0.6773367, 'recall': 0.626428, 'specificity': 0.9726004, 'f1': 0.6067898, 'auroc': 0.88589907}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   971     0    0   28    2   23    81     3    11   22    29
1     1  1258    0   30    0    0     2   168    12    1    27
2     0     0  210    7  130   39    12    34   354   24   205
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  300    0     1     2    28    0  1298
5     2     0    1   55    1  487     3     0     9   29     5
6     0     0    0    2    1    0  2950     3    39    0    72
7     1     0    0  130    0    1     0  1019     8    0     5
8     0     0    0   61    0    8     6     3  1285    1     6
9     3     4  178   78    5  266     5    84   202  274    38
10    0     0    0    0   12    0     0     0     1    0  1633
early stop counter: 1
val acc:0.9645044803619385, best validation acc: 0.9663501381874084, corresponding to test acc:                         0.7145456075668335 / 0.7491779327392578
after epoch: 5,now: 2024-07-28 19:27:59.292463,epoch time: 0:52:53.085408,used: 4:47:41.214748,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.975091, 'precision': 0.9256327, 'recall': 0.93512, 'specificity': 0.99738383, 'f1': 0.9286876, 'auroc': 0.99940443}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     0     0     0    0      2
1     1  1301    0     1    0    1     1    25     2    0      0
2     4     0  271     0    6    0     0     3     3   25      0
3    14     2    0  8219    1    8     7    81   107    0      0
4     8     0   47     0  407    0     0     5    10    4     57
5     0     0    0     3    0  472     0     0     4   41      1
6    10     0    0     0    0    0  1886     1     1    0      8
7     2     3    1   101    0    0     3  7108    42    2      3
8     7     0    2    18    2    1     2    37  3215    3      9
9     4     0   22     3    0   25     1     2     3  433      0
10   54     0    4     6   29    0     2    10    33    0  12653
---- Validation: 
scalar performance:
{'acc': 0.9760599, 'precision': 0.9282517, 'recall': 0.9338871, 'specificity': 0.99749255, 'f1': 0.92920065, 'auroc': 0.9994169}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    0     5     0     0    0      1
1     0  1299    0     1    0    0     1    30     1    0      0
2     3     0  266     0    5    0     0     2     4   32      0
3     9     6    0  8229    0    5     4    69   117    1      0
4    12     0   46     0  398    0     2     3    15    2     61
5     2     0    1     9    0  472     0     0     3   33      1
6     8     0    1     2    0    0  1889     0     1    0      7
7     6     8    1    96    0    0     4  7122    25    0      3
8     5     0    3     9    4    3     2    30  3236    1      3
9     5     0   16     1    0   24     1     0     3  443      0
10   56     0    2     8   22    0     8    12    26    2  12660
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7335759, 'precision': 0.671216, 'recall': 0.6228356, 'specificity': 0.9731014, 'f1': 0.60699034, 'auroc': 0.8790149}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1132     0    0    1    1    0    26    3     5    2     0
1      3  1227    0   20    0    0     5  219     4    1    20
2     28     1  156    3  160   13    61   56   269   83   185
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    5    0  177    0     5    2    26    0  1417
5     39     0    1   33    6  349     5    0     8  144     7
6      3     0    0    1    0    0  3035    4     7    0    17
7      3     0    0  178    0    1     2  977     2    0     1
8      3     0    1   39    0    5    40   13  1263    2     4
9     61     5   59   39   14  101    30  114   155  533    26
10     0     0    0    0    5    0     2    1     2    0  1636
better model found
persisted
after epoch: 6,now: 2024-07-28 20:21:21.619053,epoch time: 0:53:22.326590,used: 5:41:03.541338,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9723619, 'precision': 0.9421085, 'recall': 0.92843205, 'specificity': 0.9969648, 'f1': 0.93131, 'auroc': 0.9995792}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     3    4    0     0     0     1    2      5
1     0  1298    0    11    0    0     0    19     2    0      1
2     0     0  198     0   41    1     0     4     1   67      0
3     0     0    0  8412    0    6     0    11     9    2      0
4     3     0    2     0  507    0     0     0     4    1     22
5     0     0    0     7    1  480     0     0     0   32      1
6     5     1    0     4    0    0  1883     0     2    2     10
7     1     4    0   313    0    0     1  6919    21    1      5
8     1     0    0   208    5    3     0    16  3051    1     10
9     0     0    6     1    0   31     0     2     0  452      0
10    2     0    1     7   70    1     5    10    19    1  12675
---- Validation: 
scalar performance:
{'acc': 0.97156614, 'precision': 0.940756, 'recall': 0.92309, 'specificity': 0.99686885, 'f1': 0.9275676, 'auroc': 0.99956834}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     3    4    0     2     0     0    4      5
1     0  1299    0    10    0    0     0    22     1    0      0
2     0     0  192     0   38    3     1     7     5   64      2
3     0     0    0  8419    0    2     0    11     7    1      0
4     4     0    2     0  499    0     0     1     4    1     28
5     0     0    0     5    0  484     0     0     1   30      1
6     6     0    0     5    0    1  1878     0     2    2     14
7     1     6    0   317    1    0     2  6914    16    2      6
8     0     0    0   202    9    4     0    22  3048    1     10
9     0     0    5     6    0   37     0     1     1  442      1
10    3     0    0     8   72    2     6    10    13    0  12682
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7088085, 'precision': 0.6676353, 'recall': 0.58671546, 'specificity': 0.97128284, 'f1': 0.5973234, 'auroc': 0.88237}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1052     0   0   55    6    1     9    3     4   37     3
1      2  1174   0   39    0    0     4  246     3    1    30
2      5     2  63   52  481   33     7   45   150   93    84
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   2    0  531    0     5    1    12    1  1081
5      4     0   0  119    6  283     0    0     3  174     3
6      2     0   0    1    3    0  2984    4     6    0    67
7      2     0   0  415    0    1     0  739     0    1     6
8      0     0   0  184    9    6    14    6  1145    3     3
9      6     6  39  215   29  137     1   82    55  553    14
10     0     0   0    0   33    0     5    0     1    0  1607
early stop counter: 1
val acc:0.9715661406517029, best validation acc: 0.9760599136352539, corresponding to test acc:                         0.7335758805274963 / 0.7491779327392578
after epoch: 7,now: 2024-07-28 21:14:54.583866,epoch time: 0:53:32.964813,used: 6:34:36.506151,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97939855, 'precision': 0.9416162, 'recall': 0.9448032, 'specificity': 0.99772716, 'f1': 0.9402945, 'auroc': 0.99965775}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     1    5    0     1     2     1    1     12
1     0  1329    0     1    0    0     0     1     1    0      0
2     0     0  301     0    7    0     0     1     0    0      3
3     0     5    0  8321    0    4     0    86    22    0      1
4     1     0   11     0  490    0     0     0     1    0     35
5     0     0    2     6    0  495     0     0     0   17      1
6     4     0    0     2    1    0  1889     0     1    0     11
7     0    42    1    46    1    0     1  7119    17    2     35
8     1     1    1    71   13    3     0    27  3107    1     70
9     1     0   95     1    1   37     0     0     1  356      1
10    5     1    0     4   35    0     2     1     4    0  12739
---- Validation: 
scalar performance:
{'acc': 0.9795105, 'precision': 0.9424966, 'recall': 0.94684875, 'specificity': 0.9977269, 'f1': 0.9421759, 'auroc': 0.9996503}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     1    0     0    6    0     0     0     0    1     16
1     0  1331    0     1    0    0     0     0     0    0      0
2     0     0  299     1    8    0     0     1     0    1      2
3     0     2    0  8324    0   14     0    69    31    0      0
4     0     0   10     1  500    0     0     1     0    0     27
5     0     0    5    11    0  488     0     0     0   16      1
6     4     1    0     2    2    0  1885     2     0    0     12
7     0    40    1    46    0    0     0  7117    20    1     40
8     1     1    1    58   16    3     0    23  3101    1     91
9     1     0   89     2    1   28     0     0     1  371      0
10    2     0    0     5   37    0     3     0     5    0  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75855315, 'precision': 0.68851393, 'recall': 0.65539587, 'specificity': 0.97592527, 'f1': 0.6480053, 'auroc': 0.8855168}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1100     1    2    4    4    2     4    29     3   19     2
1      0  1395    0   26    1    1     1    48     1    3    23
2      6     9  290   18  320   45    10    20   160   35   102
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    7    0  459    0     3     0    11    0  1151
5      6     0    5   91    0  439     0     0     2   47     2
6     12     0    0    2    2    0  2946     3     8    0    94
7      0     2    3   81    0    1     0  1072     1    0     4
8      0     0    2  111   12   25    17    23  1169    5     6
9     18    24  205  106   14  285     3    37    73  358    14
10     0     0    0    0   30    0     2     0     0    0  1614
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-28 22:17:58.643751,epoch time: 1:03:04.059885,used: 7:37:40.566036,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9825289, 'precision': 0.9619532, 'recall': 0.9521221, 'specificity': 0.99803114, 'f1': 0.9563105, 'auroc': 0.99977183}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    0    0     0     1     0    0      8
1     0  1327    0     1    0    0     0     4     0    0      0
2     2     0  274     0    1    1     0     0     2   30      2
3     0     3    0  8385    0    2     0    33    15    0      0
4     7     1    9     0  454    0     0     0     1    2     65
5     1     0    0     4    0  480     0     0     0   34      1
6     4     0    0     2    0    0  1891     1     0    0      9
7     0    36    2   105    1    0     2  7092    10    3     14
8     2     2    0    71    4    2     1    51  3116    5     41
9     0     0    9     0    0   17     0     0     0  467      0
10    4     1    1     5   11    0     4     1     2    0  12764
---- Validation: 
scalar performance:
{'acc': 0.98250633, 'precision': 0.9611566, 'recall': 0.9525655, 'specificity': 0.998044, 'f1': 0.9561243, 'auroc': 0.99977964}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    1    0     1     0     0    0      5
1     0  1330    0     1    0    0     0     1     0    0      0
2     0     0  269     0    6    0     1     0     2   34      0
3     3     3    0  8392    0    0     1    29    12    0      0
4     4     1   14     0  455    0     0     2     2    4     57
5     0     0    0     9    0  480     0     0     0   31      1
6     5     0    0     0    1    0  1896     0     0    2      4
7     1    46    1   106    1    0     3  7084     7    1     15
8     1     2    1    70    4    5     3    51  3114    0     45
9     1     0    3     0    0   13     0     0     1  475      0
10    2     1    1     7   14    1     2     1     6    0  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7228014, 'precision': 0.6900723, 'recall': 0.60767126, 'specificity': 0.97224915, 'f1': 0.6161699, 'auroc': 0.8795314}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1108     0    0    6    2    0    17    1     0   23    13
1      3  1396    1   24    0    0     4   45     2    7    17
2      6     6  265   13  217    3    14   12   108  105   266
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    5    0  178    0     2    0     9    1  1438
5      7     0    2  100    2  215     1    0     1  250    14
6      1     0    0    1    2    0  2898    2     2    0   161
7      8    11    8  292    0    0     0  836     1    4     4
8      0     0    2  155    3    2    62   10  1100   11    25
9     19    11  158   82    6   49     5   29    39  692    47
10     0     0    0    0    2    0     1    0     0    0  1643
better model found
persisted
after epoch: 9,now: 2024-07-28 23:28:55.878388,epoch time: 1:10:57.234637,used: 8:48:37.800673,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98006743, 'precision': 0.94319385, 'recall': 0.9484683, 'specificity': 0.99791414, 'f1': 0.94193554, 'auroc': 0.9997833}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     1    3    0     0     0     0    0      0
1     0  1305    0     6    0    0     0    20     0    0      0
2     0     0  271     0   19    6     0     0     2   13      1
3     0     0    0  8405    0   15     1    16     1    0      0
4     1     0    2     0  526    1     0     0     5    0      4
5     0     0    0     3    0  518     0     0     0    0      0
6     1     0    0     0    0    0  1904     0     3    0      0
7     1     3    0   159    1    0     1  7084    10    4      2
8     0     0    0   115    1   13     0    24  3141    2      0
9     0     0   11     0    0  131     0     0     0  350      0
10   16     0    1     6   93    1     3     4    19    0  12648
---- Validation: 
scalar performance:
{'acc': 0.97983146, 'precision': 0.94684654, 'recall': 0.9505288, 'specificity': 0.9978656, 'f1': 0.9449762, 'auroc': 0.99978083}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     1    3    0     0     0     0    0      0
1     0  1308    0     1    0    0     0    22     0    0      1
2     0     0  281     0   16    3     0     1     0   10      1
3     0     0    0  8391    0   18     0    26     5    0      0
4     1     0    0     2  524    0     0     0     4    1      7
5     0     0    0     2    0  517     0     0     1    0      1
6     1     0    0     1    0    0  1902     1     2    0      1
7     1     5    0   152    1    0     0  7098     4    2      2
8     0     0    0   134    1    6     0    19  3133    0      3
9     0     0   11     1    0  130     0     0     1  350      0
10   22     0    0     8   80    0     9     9    20    0  12648
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75435525, 'precision': 0.69379, 'recall': 0.6496482, 'specificity': 0.97556555, 'f1': 0.63694525, 'auroc': 0.88464385}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1051     0    0    8    8   29    48    9     1   12     4
1      3  1281    0   32    1    2     5  150     5    3    17
2      4     7  189   16  348   76    36   14   210   48    67
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    4    0  642    0     6    0    20    1   960
5      1     0    1   49    2  522     0    0     1   13     3
6      0     0    0    1    1    0  3044    3     8    0    10
7      2     1    1  164    0    1     2  988     0    2     3
8      0     0    0  153    1   21    15   10  1167    2     1
9     11    14   98   99   16  430    13   38    79  316    23
10     0     0    0    0   61    0     2    0     1    0  1582
early stop counter: 1
val acc:0.9798314571380615, best validation acc: 0.9825063347816467, corresponding to test acc:                         0.7228013873100281 / 0.758553147315979
after epoch: 10,now: 2024-07-29 00:51:36.610497,epoch time: 1:22:40.732109,used: 10:11:18.532782,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 10:11:18.532782 at 2024-07-29 00:51:36.610497
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7228014, 'precision': 0.6900723, 'recall': 0.60767126, 'specificity': 0.97224915, 'f1': 0.6161699, 'auroc': 0.8795314}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1108     0    0    6    2    0    17    1     0   23    13
1      3  1396    1   24    0    0     4   45     2    7    17
2      6     6  265   13  217    3    14   12   108  105   266
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    5    0  178    0     2    0     9    1  1438
5      7     0    2  100    2  215     1    0     1  250    14
6      1     0    0    1    2    0  2898    2     2    0   161
7      8    11    8  292    0    0     0  836     1    4     4
8      0     0    2  155    3    2    62   10  1100   11    25
9     19    11  158   82    6   49     5   29    39  692    47
10     0     0    0    0    2    0     1    0     0    0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75855315, 'precision': 0.68851393, 'recall': 0.65539587, 'specificity': 0.97592527, 'f1': 0.6480053, 'auroc': 0.8855168}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1100     1    2    4    4    2     4    29     3   19     2
1      0  1395    0   26    1    1     1    48     1    3    23
2      6     9  290   18  320   45    10    20   160   35   102
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    7    0  459    0     3     0    11    0  1151
5      6     0    5   91    0  439     0     0     2   47     2
6     12     0    0    2    2    0  2946     3     8    0    94
7      0     2    3   81    0    1     0  1072     1    0     4
8      0     0    2  111   12   25    17    23  1169    5     6
9     18    24  205  106   14  285     3    37    73  358    14
10     0     0    0    0   30    0     2     0     0    0  1614
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_40_17_seed_1_23104522_instance_wise_predictions.txt
accuracy from prediction file 0.7228013713006367
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/29.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/29.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      7 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      7 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15770 MiB |   1349 TiB |   1349 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1339 TiB |   1339 TiB |
|       from small pool |      6 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16392 MiB |  16412 MiB |  30928 MiB |  14536 MiB |
|       from large pool |  16364 MiB |  16384 MiB |  30888 MiB |  14524 MiB |
|       from small pool |     28 MiB |     28 MiB |     40 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 223296 KiB | 680312 KiB | 204788 GiB | 204788 GiB |
|       from large pool | 216320 KiB | 677984 KiB | 194442 GiB | 194441 GiB |
|       from small pool |   6976 KiB |  15445 KiB |  10346 GiB |  10346 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   89487 K  |   89484 K  |
|       from large pool |     247    |     593    |   45361 K  |   45361 K  |
|       from small pool |    2399    |    3599    |   44125 K  |   44123 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   89487 K  |   89484 K  |
|       from large pool |     247    |     593    |   45361 K  |   45361 K  |
|       from small pool |    2399    |    3599    |   44125 K  |   44123 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     461    |     462    |     822    |     361    |
|       from large pool |     447    |     448    |     802    |     355    |
|       from small pool |      14    |      14    |      20    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     114    |     563    |   50427 K  |   50426 K  |
|       from large pool |      95    |     301    |   30898 K  |   30898 K  |
|       from small pool |      19    |     454    |   19528 K  |   19528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1349 TiB |   1349 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1339 TiB |   1339 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1874 MiB |  16412 MiB |  30928 MiB |  29054 MiB |
|       from large pool |   1860 MiB |  16384 MiB |  30888 MiB |  29028 MiB |
|       from small pool |     14 MiB |     28 MiB |     40 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680312 KiB | 204789 GiB | 204789 GiB |
|       from large pool |  24320 KiB | 677984 KiB | 194443 GiB | 194443 GiB |
|       from small pool |      0 KiB |  15445 KiB |  10346 GiB |  10346 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   89487 K  |   89487 K  |
|       from large pool |       2    |     593    |   45361 K  |   45361 K  |
|       from small pool |       0    |    3599    |   44125 K  |   44125 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   89487 K  |   89487 K  |
|       from large pool |       2    |     593    |   45361 K  |   45361 K  |
|       from small pool |       0    |    3599    |   44125 K  |   44125 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     100    |     462    |     822    |     722    |
|       from large pool |      93    |     448    |     802    |     709    |
|       from small pool |       7    |      14    |      20    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     563    |   50427 K  |   50427 K  |
|       from large pool |       3    |     301    |   30898 K  |   30898 K  |
|       from small pool |       0    |     454    |   19528 K  |   19528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 29 01:17:53 2024]
Finished job 0.
1 of 1 steps (100%) done
