Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 15:50:06 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/19.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=19
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510

 Experiment start at: 2024-07-27 16:14:25.195709
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.53646725, 'precision': 0.46732855, 'recall': 0.45584318, 'specificity': 0.9548091, 'f1': 0.35618895, 'auroc': 0.94093966}
confusion matrix:
    0   1   2     3   4     5      6     7     8    9   10
0   79   0   0    22   1    21    205    54    73   27   1
1    2   0   0    35   0  1088     31   158    15    0   2
2    0   1   0     1   0    16     42    74    67  111   0
3    0   0   0  8082   0    23      2   148   182    2   0
4    4   0   0     2   1    10    355    20   128   18   1
5    0   0   0    78   0   285      1     0     9  148   0
6    1   0   0    19   0     9   1845    14    18    1   0
7    1   0   0   581   0     3      9  6487   181    1   0
8    0   0   0   189   0     8     34    79  2982    3   0
9    0   4   0    21   0   137      6    21    19  285   0
10  15   0   0    11   0     5  12290    24   436    7   5
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5383175, 'precision': 0.41232437, 'recall': 0.45753354, 'specificity': 0.9550233, 'f1': 0.35672, 'auroc': 0.94045323}
confusion matrix:
    0   1   2     3   4     5      6     7     8    9   10
0   74   1   0    31   0    16    204    45    85   23   4
1    3   0   0    32   0  1080     38   168    11    0   0
2    3   0   0     1   0    28     38    71    62  109   0
3    0   0   0  8093   0    19      1   146   181    0   0
4    6   0   0     2   0    12    361    14   129   15   0
5    0   1   0    71   0   296      3     1     9  140   0
6    0   0   0    16   0     6   1848    16    19    3   0
7    1   0   0   544   0     3     11  6532   173    1   0
8    0   0   0   173   0     6     30    87  2995    5   0
9    0   3   0    12   0   148     10    17    19  284   0
10   9   0   0    12   0     8  12295    26   437    6   3
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.41600785, 'precision': 0.25798625, 'recall': 0.32666945, 'specificity': 0.9374193, 'f1': 0.23611033, 'auroc': 0.79554075}
confusion matrix:
    0   1   2   3   4    5     6     7     8    9   10
0   52   3   0  32   1   26   560   237   179   75   5
1   11   0   0  67   0  485   154   715    62    2   3
2    3   1   0  12   0   16   206   134   554   88   1
3    0   0   0   0   0    0     0     0     0    0   0
4    0   0   0   0   0    0  1537     3    93    0   0
5    0   1   0  60   0  227    20     7    36  241   0
6    0   0   0   3   0    0  2900     3   161    0   0
7    0   0   0  26   1    0     5  1118    13    1   0
8    0   0   0  32   0    7    45     7  1276    3   0
9    2   4   0  36   0  102    59   252   307  373   2
10   0   0   0   0   0    0  1643     0     3    0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 16:58:58.902729,epoch time: 0:44:33.707020,used: 0:44:33.707020,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.58647263, 'precision': 0.6113132, 'recall': 0.5948201, 'specificity': 0.95976746, 'f1': 0.5261916, 'auroc': 0.9702712}
confusion matrix:
     0     1   2     3   4    5      6     7     8    9    10
0   223     0   0    15   0    7    143    20    57   16    2
1     0  1232   0    35   0    2     26    29     3    4    1
2     2     1   0    12   0   24     76    30    26  130   11
3     0     1   0  8197   0   47      6    96    86    5    0
4     4     0   0     6   0   17    448     7    40   13    4
5     0     0   0    24   0  345      2     0     3  146    0
6     1     0   0    10   0    5   1877     1    10    4    0
7     2    43   0   494   0    2     24  6590   101    4    2
8     0     0   0   213   0    8     49    77  2939    9    1
9     1     1   0     9   0  104      3     6    11  358    0
10   18     1   0    11   0    6  12489    15    90    4  159
---- Validation: 
scalar performance:
{'acc': 0.5841915, 'precision': 0.6046895, 'recall': 0.59058124, 'specificity': 0.95953995, 'f1': 0.52096075, 'auroc': 0.96764255}
confusion matrix:
     0     1   2     3   4    5      6     7     8    9    10
0   215     0   0    14   0   10    148    18    55   13   10
1     0  1225   0    32   0   10     29    25     7    4    0
2     4     4   0    17   0   20     82    24    29  126    6
3     0     2   0  8194   0   45      8    97    92    2    0
4     5     0   0     3   0   17    434     7    55   15    3
5     0     0   0    16   0  340      1     0     4  160    0
6     2     0   0     8   0    7   1879     2     8    2    0
7     2    53   0   516   0    3     17  6563   108    2    1
8     2     0   0   224   0    8     62    79  2913    8    0
9     0     1   0     9   0  109      3     5     7  357    2
10   18     3   0     9   0    8  12491    18    90    5  154
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.527461, 'precision': 0.4358524, 'recall': 0.41917828, 'specificity': 0.9483564, 'f1': 0.38654178, 'auroc': 0.8428339}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9   10
0   368     0   0  43  11    9   358   147   190   42   2
1     1  1165   0  46   0   14   105   131    28    7   2
2    23     1   0  20   0    7   413    83   362   90  16
3     0     0   0   0   0    0     0     0     0    0   0
4     3     0   0   0   0    0  1611     1    16    0   2
5     2     0   0  50   0  157    10     1    18  354   0
6     0     0   0   3   0    0  3030     2    32    0   0
7     1     0   0  92   2    0    17  1046     5    1   0
8     0     0   0  45   0    1    28     7  1281    8   0
9    10     1   0  72   0   35    66   119   337  491   6
10    0     0   0   0   0    0  1645     0     0    0   1
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 17:41:07.703691,epoch time: 0:42:08.800962,used: 1:26:42.507982,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7224422, 'precision': 0.62910277, 'recall': 0.64781123, 'specificity': 0.97281647, 'f1': 0.6001951, 'auroc': 0.9812404}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9     10
0   362     0   0     2   0    1    46    15     8    1    47
1     0  1220   0     6   0    1     8    81    12    0     3
2    19     5   0     1   0   15   100    44    14   82    32
3     2     1   0  7791   0   17     1   295   328    5     0
4    12     0   0     1   0    4   454     7    23    6    32
5     3     0   0    30   0  278     1     1    13  194     1
6    15     0   0     2   2    2  1856    12    13    1     5
7    11     7   0   145   0    0     3  6975   115    1     4
8     2     0   0    43   0    0    37   111  3074    4    25
9     8     2   0     6   0   72    10    14    11  364     6
10   29     0   0     7   0    1  7624     7    42    1  5082
---- Validation: 
scalar performance:
{'acc': 0.72333825, 'precision': 0.63243246, 'recall': 0.6511087, 'specificity': 0.97291017, 'f1': 0.6032447, 'auroc': 0.98184526}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9     10
0   361     0   0     4   0    0    46    19     5    3    45
1     2  1219   0    10   0    1     7    79    11    0     3
2     8     3   0     1   1   10   116    56    14   85    18
3     0     0   0  7770   0   26     3   292   344    5     0
4     6     1   0     0   0    6   454     7    28    4    33
5     2     0   0    21   0  287     1     1    13  195     1
6    11     0   0     2   1    1  1868    10     9    1     5
7    11     7   0   146   0    0     4  6977   107    1    12
8     2     0   0    31   0    1    35   104  3091    4    28
9     8     2   0     4   0   66     7    14    12  371     9
10   38     0   0     7   0    1  7606    11    33    2  5098
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.54894006, 'precision': 0.46215552, 'recall': 0.44506818, 'specificity': 0.9510561, 'f1': 0.40742543, 'auroc': 0.8311572}
confusion matrix:
     0    1   2   3   4    5     6     7     8    9    10
0   797    0   0   5   0    1   105   161    81    4   16
1    14  935   0   9   0    2    22   446    40    2   29
2    64    1   0   2   1   14   346   141   314   44   88
3     0    0   0   0   0    0     0     0     0    0    0
4     3    0   0   0   0    0  1550     2    17    0   61
5    24    0   0  42   0  161    30     9    56  269    1
6     1    0   0   0   0    0  2975     6    83    0    2
7     0    0   0   2   0    0     2  1155     3    0    2
8     0    0   0  12   0    1    10    24  1317    4    2
9    60    3   0  12   0   35    60   328   292  323   24
10    0    0   0   0   0    0  1463     0     0    0  183
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 18:22:52.939252,epoch time: 0:41:45.235561,used: 2:08:27.743543,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90384203, 'precision': 0.75045127, 'recall': 0.70889366, 'specificity': 0.99011636, 'f1': 0.68397725, 'auroc': 0.98388726}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   366     0   0     4   0    0    12    30    11    3     57
1     0  1228   0    12   0    0     7    75     7    1      2
2     3    37   0     2   0    3    51    86    17  104      9
3     1     1   0  7844   0   10     1   376   200    6      0
4     3    12   0     3   3    4   366    21    30   11     85
5     0     0   0    31   0  275     1     0     5  208      1
6    10     1   0     3   1    0  1863     5     9    1     15
7     0     5   0    86   0    0     2  7080    86    1      4
8     2     0   0    48   0    2     7    96  3120    4     17
9     2     7   0     4   0   29     2    17    11  420      1
10   38     2   0    13   0    0  1033    26    93    2  11583
---- Validation: 
scalar performance:
{'acc': 0.9042932, 'precision': 0.7279035, 'recall': 0.71196926, 'specificity': 0.99017507, 'f1': 0.68600833, 'auroc': 0.9839103}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   372     0   0     2   1    0     6    32    12    4     54
1     0  1241   0     9   0    0     2    68     9    1      2
2     7    39   0     3   0    3    49    74    26  106      5
3     0     2   0  7841   0   12     1   377   202    4      1
4     4    15   0     2   2    4   351    19    36   14     92
5     0     0   0    34   0  282     1     0     6  198      0
6     9     0   0     4   1    1  1858     4    14    2     15
7     0     7   0    88   0    0     3  7074    88    1      4
8     3     1   0    37   0    0     7    87  3144    1     16
9     1     5   0     6   0   31     1    18    11  419      1
10   31     1   0    12   0    2  1061    28    85    2  11574
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58420205, 'precision': 0.5126244, 'recall': 0.4866193, 'specificity': 0.95551825, 'f1': 0.461582, 'auroc': 0.8437748}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9    10
0   891     0   0  13   0    3    16   158    48   27   14
1     0  1110   0  36   0    3    37   279    20    0   14
2     7    35   0  10   4    3   228   213   395   64   56
3     0     0   0   0   0    0     0     0     0    0    0
4     2     0   0   0   0    0  1501     3    28    0   99
5     5     0   0  77   0  188     9     7    53  253    0
6     0     1   0  61   0    0  2695     8   291    0   11
7     0     0   0  41   0    0     1  1116     4    0    2
8     0     0   0  30   0    0     1     7  1330    2    0
9    14    12   0  34   0   18    20   279   365  387    8
10    0     0   0   0   0    0  1013     0     0    0  633
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 19:04:27.524510,epoch time: 0:41:34.585258,used: 2:50:02.328801,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92594177, 'precision': 0.7342791, 'recall': 0.73065734, 'specificity': 0.99213225, 'f1': 0.7127375, 'auroc': 0.98310316}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   370     0   0     1   0    2     6    34     5    4     61
1     0  1243   0    15   0    3     0    65     2    0      4
2     4    15   0     0   6    1    23    81    33  142      6
3     0     1   0  8212   0   19     1   118    86    1      0
4    10    21   0     0   6    2   299    30    39   20    112
5     1     0   0    30   0  434     1     0     3   51      0
6     8     0   0    11   1    2  1860     3     7    1     14
7     1     8   0   344   0    0     3  6871    31    1      4
8     1     0   0   126   0    0     7   128  3006    7     20
9     1     0   0     6   0  109     0    10     8  359      0
10   28     2   0    11   2    4   423    26    44    8  12247
---- Validation: 
scalar performance:
{'acc': 0.9262271, 'precision': 0.74093366, 'recall': 0.7313226, 'specificity': 0.9921435, 'f1': 0.71370727, 'auroc': 0.98363864}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   371     0   0     4   0    2     7    28     3    5     63
1     0  1254   0    10   0    2     0    60     1    0      5
2     4    23   0     0   5    2    22    90    21  141      4
3     0     0   0  8213   0   14     0   128    83    2      0
4     4    19   0     0   7    5   292    24    42   22    124
5     0     0   0    20   0  440     0     0     4   56      1
6    15     0   0     9   0    5  1852     6     7    1     13
7     1     7   0   344   0    0     2  6871    34    1      5
8     1     0   0   119   0    2     7   121  3014    3     29
9     0     0   0     8   0  111     1    14     6  353      0
10   25     1   0     8   3    1   419    31    52    4  12252
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.652977, 'precision': 0.5223145, 'recall': 0.54540294, 'specificity': 0.96425045, 'f1': 0.51498604, 'auroc': 0.8424699}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   850     0   0   16   1    5    29   170    23   21    55
1     0  1202   0   28   0   10    11   231     2    0    15
2     4    11   0   29   6    8   229   218   347   98    65
3     0     0   0    0   0    0     0     0     0    0     0
4     3     0   0    0   0    0   810     4    20    0   796
5     4     0   0  113   0  299     5     6    22  140     3
6     1     1   0  145   0    0  2836     8    71    0     5
7     0     0   0   62   0    0     1  1097     2    0     2
8     0     0   0  150   0    0     3    32  1183    2     0
9    12    10   0  115   1   79     8   241   276  374    21
10    0     0   0    0   0    0   152     0     2    0  1492
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 19:46:04.508190,epoch time: 0:41:36.983680,used: 3:31:39.312481,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9346104, 'precision': 0.76728916, 'recall': 0.7037492, 'specificity': 0.99280983, 'f1': 0.70800453, 'auroc': 0.9814229}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   303     0   0     5   0    0     0    79     9    4     83
1     0  1214   0    11   0    0     0    98     3    0      6
2     2    12   0     0   9    1    36   116    32   93     11
3     0     0   0  8134   0    3     0   197   101    2      1
4     6    12   0     0   9    1   245    24    39    4    199
5     1     0   0    70   0  282     0     0     7  159      1
6     7     0   0     6   0    3  1807    24    15    1     45
7     0     2   0   117   0    0     2  7117    20    0      3
8     3     0   0    80   0    0     0   150  3051    2     10
9     0     3   0     8   0   29     0    23    13  415      2
10   12     0   0     8   1    1    24    30   117    1  12600
---- Validation: 
scalar performance:
{'acc': 0.9351344, 'precision': 0.77053523, 'recall': 0.7109865, 'specificity': 0.99286884, 'f1': 0.7139556, 'auroc': 0.97957563}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   332     0   0     7   0    1     0    63    10    3     67
1     0  1211   0     8   0    1     0   102     2    1      7
2     0    18   0     1   9    1    38   112    36   88      9
3     0     0   0  8143   1    3     0   192   101    0      0
4     6     8   0     1   9    1   230    32    40   10    202
5     0     0   0    76   0  283     0     1     9  151      1
6     6     0   0     6   0    1  1801    19    25    0     50
7     0     3   0   126   0    0     2  7106    25    0      3
8     1     0   0    83   0    0     0   142  3057    1     12
9     0     1   0     7   0   29     0    20     9  427      0
10   12     1   0     8   0    2    21    31   129    1  12591
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57818514, 'precision': 0.51304424, 'recall': 0.49192715, 'specificity': 0.9575028, 'f1': 0.44119412, 'auroc': 0.81003165}
confusion matrix:
     0     1   2   3   4   5     6     7     8    9     10
0   750     0   0   5   0   0     4   312    20   32    47
1     1  1125   0  18   0   6     0   302     5    1    41
2    11     2   0   1   0   1    35   203   330   77   355
3     0     0   0   0   0   0     0     0     0    0     0
4     1     0   0   0   0   0     6     2    23    0  1601
5     1     0   0  86   0  86     0    22    74  319     4
6     4     0   0  86   0   0  1812    43   557    0   565
7     0     0   0   2   0   0     0  1159     1    0     2
8     0     0   0  26   0   0     0    35  1307    1     1
9     9     9   0  34   0   4     3   343   315  381    39
10    0     0   0   0   0   0     0     1     1    0  1644
better model found
persisted
after epoch: 6,now: 2024-07-27 20:27:34.170622,epoch time: 0:41:29.662432,used: 4:13:08.974913,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93260384, 'precision': 0.7726135, 'recall': 0.72342, 'specificity': 0.9926408, 'f1': 0.7180867, 'auroc': 0.9851665}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   336     0   0    12   0    1    17    30    11    2     74
1     0  1264   0    32   0    0     3    27     3    1      1
2     2    60   0     7   2    1    30    65    30  109      6
3     0     2   0  8360   0    5     0    36    35    2      0
4     1    35   0     2   3    2   290    12    35   13    146
5     0     0   0    46   0  393     0     0     4   77      1
6     4     0   0    11   0    0  1873     1     4    1     14
7     0     6   0   478   0    0     3  6745    28    0      3
8     0     0   0   220   0    1     4    80  2969    4     18
9     0     0   0    13   0   76     0    14    10  380      0
10   14     1   0    12   0    2   132    31    62    2  12534
---- Validation: 
scalar performance:
{'acc': 0.934118, 'precision': 0.7593299, 'recall': 0.729701, 'specificity': 0.99281114, 'f1': 0.7229362, 'auroc': 0.9861152}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   345     0   0    10   0    0    17    36     6    1     68
1     0  1270   0    28   0    0     1    27     3    0      3
2     0    58   0     2   4    3    30    68    32  110      5
3     0     0   0  8370   0    6     1    34    28    1      0
4     4    29   0     3   3    1   286    15    37   11    150
5     0     0   0    33   0  416     0     0     4   67      1
6     4     0   0     9   0    1  1882     1     2    1      8
7     0    10   0   488   0    0     2  6735    27    0      3
8     0     0   0   195   0    0     3    94  2983    2     19
9     0     3   0    14   0   79     1    12     7  377      0
10   15     2   0    14   0    1   136    15    71    1  12541
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65283704, 'precision': 0.5304173, 'recall': 0.5341817, 'specificity': 0.96483487, 'f1': 0.5097074, 'auroc': 0.843082}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   714     0   0   22   1    4   119    83    32   26   169
1     0  1311   0   69   0    1    10    97     5    0     6
2     1    60   0   69   2   10   196    67   468   80    62
3     0     0   0    0   0    0     0     0     0    0     0
4     2     1   0    0   0    0   394     2    26    0  1208
5     2     0   0  180   0  278     2     2    14  112     2
6     0     0   0   92   0    0  2933     2    33    0     7
7     0     0   0  149   0    0     0  1013     0    0     2
8     0     0   0  186   0    0     5     5  1174    0     0
9     7    38   0  243   0   85    16    97   354  290     7
10    0     0   0    0   0    0    25     0     3    0  1618
early stop counter: 1
val acc:0.9341179728507996, best validation acc: 0.9351344108581543, corresponding to test acc:                         0.5781851410865784 / 0.6529769897460938
after epoch: 7,now: 2024-07-27 21:09:59.110952,epoch time: 0:42:24.940330,used: 4:55:33.915243,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9450717, 'precision': 0.79514354, 'recall': 0.73225963, 'specificity': 0.99380225, 'f1': 0.7403444, 'auroc': 0.991526}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   331     0   0     1   0    0     3    50     1    3     94
1     0  1226   0     7   0    1     0    88     2    1      6
2     0     0   0   149  25    2    17    26     2   80     11
3     0     0   0  8166   0   11     1   171    87    3      0
4     1     0   0    26  40    1   201     8    11    3    247
5     0     1   0    22   0  357     0     0     2  136      2
6     3     0   0     1   1    2  1849     8     6    0     38
7     1     3   0    73   0    0     3  7142    32    0     10
8     2     0   0    45   0    1     3   125  3065    5     47
9     0     2   0    23   0   39     1     6     4  415      3
10   10     0   0     8   0    1    12    14    17    1  12732
---- Validation: 
scalar performance:
{'acc': 0.94505817, 'precision': 0.7966156, 'recall': 0.7348442, 'specificity': 0.9937972, 'f1': 0.7424804, 'auroc': 0.99158305}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   339     0   0     2   0    0     2    50     0    3     87
1     0  1230   0    12   0    0     0    79     2    0      9
2     0     1   0   144  23    1    20    38     1   74     10
3     0     0   0  8170   0   15     1   162    92    0      0
4     1     0   0    23  39    1   189     4    14    3    265
5     0     0   0    17   0  364     0     0     3  136      1
6     4     0   0     1   1    2  1858     9     1    0     32
7     1     4   0    76   0    0     3  7133    37    1     10
8     1     0   0    56   0    2     3   140  3055    3     36
9     0     0   0    21   0   41     1     7     2  415      6
10    7     0   0    10   1    0    13     6    29    2  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64793956, 'precision': 0.54297304, 'recall': 0.54119647, 'specificity': 0.9644838, 'f1': 0.51001406, 'auroc': 0.8401931}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   875     0   0    7   0    2    17    95     7   28   139
1     1  1150   0   27   0    1     2   263     3    0    52
2     1     0   0  111  36    2   132    92   283   57   301
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0   0    0    38     1    15    0  1579
5     2     0   0  146   0  198     8     7    27  199     5
6     0     0   0   25   0    0  2572     6   102    0   362
7     0     0   0   49   0    0     0  1110     2    0     3
8     0     0   0   61   0    1     2    15  1287    1     3
9     5     2   1  108   3   41     8   199   302  423    45
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 8,now: 2024-07-27 21:51:47.016150,epoch time: 0:41:47.905198,used: 5:37:21.820441,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.946784, 'precision': 0.8414484, 'recall': 0.7379158, 'specificity': 0.9941642, 'f1': 0.7420746, 'auroc': 0.9934117}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   331     0   0     0   0    1     3    59     4    2     83
1     0  1276   0    13   0    0     1    32     6    0      3
2     0     2   2   131  47    6    17    19    10   69      9
3     1     1   0  8271   0   11     0    95    59    2      0
4     2     3   1    17  63    5   270     4    12    0    162
5     0     0   0    12   0  485     0     0     1   22      1
6     4     2   0     2   0    3  1866     2     1    0     27
7     0    13   0   145   0    0     1  7045    46    1     10
8     0     0   0    90   0    2     8    72  3092    2     30
9     1     3   0    18   0  185     0     4     3  276      2
10   11     1   0    11   3    0    60     6    22    0  12680
---- Validation: 
scalar performance:
{'acc': 0.9464491, 'precision': 0.8671255, 'recall': 0.7368088, 'specificity': 0.99414986, 'f1': 0.7394453, 'auroc': 0.9937427}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   336     0   0     4   0    0     4    55     1    3     80
1     0  1280   0    11   0    2     4    29     3    0      3
2     1     4   2   127  44    4    19    18    11   77      5
3     0     1   0  8279   0   13     0    73    72    1      1
4     2     2   0    23  60    3   279     1     9    7    153
5     0     0   0    18   0  478     1     0     2   21      1
6     3     1   0     2   0    5  1858     2     3    1     33
7     0    12   0   142   0    0     2  7054    46    0      9
8     2     1   0    94   1    1     2    79  3081    4     31
9     0     1   0    16   0  190     0     4     3  277      2
10   14     1   0    11   3    3    54     7    25    0  12678
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68956834, 'precision': 0.64174587, 'recall': 0.5806547, 'specificity': 0.96855116, 'f1': 0.5413033, 'auroc': 0.8528364}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   868     0   0   10   0    5    49    85    23   27   103
1     1  1366   0   16   0    3     2    89     5    0    17
2     1    15   1   48  39   17   189    44   443   73   145
3     0     0   0    0   0    0     0     0     0    0     0
4     1     1   0    0   3    0   124     1    30    0  1473
5     3     0   0  118   0  394     5     1    17   54     0
6     0     0   0   18   0    0  2943     2    66    0    38
7     1     1   0  109   0    0     3  1040     4    0     6
8     0     0   0   75   0    1     7    10  1275    1     1
9     5    18   0  107   6  164    15   100   373  322    27
10    0     0   0    0   0    0     1     0     1    0  1644
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-27 22:33:43.105817,epoch time: 0:41:56.089667,used: 6:19:17.910108,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9472121, 'precision': 0.85194004, 'recall': 0.73345804, 'specificity': 0.99410427, 'f1': 0.74417245, 'auroc': 0.99062395}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   280     0   0     3   0    0     1   150     1    0     48
1     0  1257   0    11   0    0     0    57     3    0      4
2     1     0   2   126  37    1    12    39     4   84      6
3     0     0   0  8247   0    9     0   101    81    0      0
4     5     1   0    16  58    0   226    10    11    7    205
5     0     1   0    34   0  398     0     0     2   85      1
6     7     0   0     6   0    1  1835     7     3    0     48
7     1     3   0   111   0    0     2  7108    33    0      6
8     1     0   0    50   0    1     3    81  3101    8     50
9     2     0   1    11   2   52     0    14     6  401      4
10   22     0   0     8   1    0    18    12    15    0  12716
---- Validation: 
scalar performance:
{'acc': 0.9478668, 'precision': 0.86852497, 'recall': 0.7352614, 'specificity': 0.9941833, 'f1': 0.74716854, 'auroc': 0.9906165}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   283     0   0     1   0    1     0   148     2    0     48
1     0  1260   0     6   0    0     0    61     1    0      4
2     1     1   4   131  33    1    13    29     4   88      7
3     0     1   0  8244   0   11     0   109    74    1      0
4     4     1   0    20  66    1   219    12     5    3    208
5     1     1   0    31   0  388     1     0     4   93      2
6     8     0   1     2   0    1  1852     4     2    0     38
7     0     3   0   100   1    0     1  7117    33    0     10
8     1     0   0    52   1    0     6    90  3104    2     40
9     1     1   0    13   0   51     2    17     5  401      2
10   24     0   0     8   1    0    13    17    16    0  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66557056, 'precision': 0.5441792, 'recall': 0.5500702, 'specificity': 0.96616083, 'f1': 0.5117741, 'auroc': 0.84006894}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   956     0   0    3   0    0     4   158     8    2    39
1     0  1173   0   15   0    1     0   276     6    0    28
2     8     6   0   63  53    2   163   142   236   52   290
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    0   1    0    65     2     7    0  1556
5     3     0   0  107   0  186     3    13    55  221     4
6     0     0   0   19   0    0  2764     6    43    0   235
7     0     0   0   36   0    0     0  1124     2    0     2
8     0     0   0   45   0    0     3    23  1291    2     6
9    13     1   0   62   3   25     2   331   280  372    48
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 10,now: 2024-07-27 23:14:54.464830,epoch time: 0:41:11.359013,used: 7:00:29.269121,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:00:29.269121 at 2024-07-27 23:14:54.464830
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66557056, 'precision': 0.5441792, 'recall': 0.5500702, 'specificity': 0.96616083, 'f1': 0.5117741, 'auroc': 0.84006894}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   956     0   0    3   0    0     4   158     8    2    39
1     0  1173   0   15   0    1     0   276     6    0    28
2     8     6   0   63  53    2   163   142   236   52   290
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    0   1    0    65     2     7    0  1556
5     3     0   0  107   0  186     3    13    55  221     4
6     0     0   0   19   0    0  2764     6    43    0   235
7     0     0   0   36   0    0     0  1124     2    0     2
8     0     0   0   45   0    0     3    23  1291    2     6
9    13     1   0   62   3   25     2   331   280  372    48
10    0     0   0    0   0    0     0     0     0    0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68956834, 'precision': 0.64174587, 'recall': 0.5806547, 'specificity': 0.96855116, 'f1': 0.5413033, 'auroc': 0.8528364}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   868     0   0   10   0    5    49    85    23   27   103
1     1  1366   0   16   0    3     2    89     5    0    17
2     1    15   1   48  39   17   189    44   443   73   145
3     0     0   0    0   0    0     0     0     0    0     0
4     1     1   0    0   3    0   124     1    30    0  1473
5     3     0   0  118   0  394     5     1    17   54     0
6     0     0   0   18   0    0  2943     2    66    0    38
7     1     1   0  109   0    0     3  1040     4    0     6
8     0     0   0   75   0    1     7    10  1275    1     1
9     5    18   0  107   6  164    15   100   373  322    27
10    0     0   0    0   0    0     1     0     1    0  1644
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104510_instance_wise_predictions.txt
accuracy from prediction file 0.6655705590149024
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/19.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB | 414204 GiB | 414203 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411247 GiB | 411245 GiB |
|       from small pool |      7 MiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB | 414204 GiB | 414203 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411247 GiB | 411245 GiB |
|       from small pool |      7 MiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB | 412639 GiB | 412637 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 409685 GiB | 409683 GiB |
|       from small pool |      6 MiB |     26 MiB |   2954 GiB |   2954 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  16520 MiB |      0 B   |
|       from large pool |  16492 MiB |  16492 MiB |  16492 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 235577 KiB | 630836 KiB |  63170 GiB |  63169 GiB |
|       from large pool | 216320 KiB | 628608 KiB |  60200 GiB |  60200 GiB |
|       from small pool |  19257 KiB |  23296 KiB |   2969 GiB |   2969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2660    |    3967    |   30392 K  |   30389 K  |
|       from large pool |     247    |     595    |   13398 K  |   13397 K  |
|       from small pool |    2413    |    3621    |   16994 K  |   16991 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2660    |    3967    |   30392 K  |   30389 K  |
|       from large pool |     247    |     595    |   13398 K  |   13397 K  |
|       from small pool |    2413    |    3621    |   16994 K  |   16991 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     467    |       0    |
|       from large pool |     453    |     453    |     453    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     122    |    1244    |   16641 K  |   16641 K  |
|       from large pool |      95    |     303    |    8723 K  |    8723 K  |
|       from small pool |      27    |    1148    |    7917 K  |    7917 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414204 GiB | 414204 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411247 GiB | 411247 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414204 GiB | 414204 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411247 GiB | 411247 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412639 GiB | 412639 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409685 GiB | 409685 GiB |
|       from small pool |      0 KiB |     26 MiB |   2954 GiB |   2954 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630836 KiB |  63171 GiB |  63171 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60201 GiB |  60201 GiB |
|       from small pool |      0 KiB |  24786 KiB |   2969 GiB |   2969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   30392 K  |   30392 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3621    |   16994 K  |   16994 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   30392 K  |   30392 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3621    |   16994 K  |   16994 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1244    |   16642 K  |   16642 K  |
|       from large pool |       3    |     303    |    8724 K  |    8724 K  |
|       from small pool |       0    |    1148    |    7918 K  |    7918 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414204 GiB | 414204 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411247 GiB | 411247 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414204 GiB | 414204 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411247 GiB | 411247 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412639 GiB | 412639 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409685 GiB | 409685 GiB |
|       from small pool |      0 KiB |     26 MiB |   2954 GiB |   2954 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630836 KiB |  63171 GiB |  63171 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60201 GiB |  60201 GiB |
|       from small pool |      0 KiB |  24786 KiB |   2969 GiB |   2969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   30392 K  |   30392 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3621    |   16994 K  |   16994 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   30392 K  |   30392 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3621    |   16994 K  |   16994 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1244    |   16642 K  |   16642 K  |
|       from large pool |       3    |     303    |    8724 K  |    8724 K  |
|       from small pool |       0    |    1148    |    7918 K  |    7918 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_33_15_seed_1_23104510

 Experiment start at: 2024-07-27 23:33:16.231625
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8115101, 'precision': 0.4809762, 'recall': 0.46374825, 'specificity': 0.97959316, 'f1': 0.4162627, 'auroc': 0.89207757}
confusion matrix:
      0     1    2     3   4   5   6     7     8   9      10
0    398     0    4    30   0   0   6    14     0   0     31
1      0  1196   17    39   0   0   0    75     1   0      4
2    145     4    8    37   0   0   1    18     6   0     93
3      2     0    1  8144   0   0   0   251    40   0      0
4     79     4   15    46   0   0   0    11    20   0    364
5    215     0    0   283   0   0   2     4     5   0     12
6   1306    17    8   119   0   0  28    52     8   0    370
7      6    27   17   555   0   0   0  6627    18   0     13
8      6     3  581   884   0   0   1   108  1653   0     59
9    345     2    1    97   0   0   4     8     2   0     34
10   256    34   34    87   0   0   1    65    38   0  12277
---- Validation: 
scalar performance:
{'acc': 0.81238467, 'precision': 0.48053738, 'recall': 0.46380195, 'specificity': 0.9797001, 'f1': 0.41645324, 'auroc': 0.8903823}
confusion matrix:
      0     1    2     3   4   5   6     7     8   9      10
0    397     0    1    29   0   0   5    21     1   0     29
1      0  1190   13    44   0   0   1    79     1   0      4
2    141    11    7    44   0   0   0    20     8   0     81
3      4     0    2  8121   0   0   0   255    58   0      0
4     72     2   10    57   0   0   0     8    22   0    368
5    212     0    0   280   0   0   2     6     8   0     13
6   1318    23    6   113   0   0  26    48    10   0    364
7     10    20   15   537   0   0   1  6652    13   0     17
8      6     3  565   877   0   0   1   113  1688   0     43
9    350     3    4    97   0   0   3     5     0   0     31
10   249    29   36    98   0   0   1    70    23   0  12290
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3617855, 'precision': 0.32299507, 'recall': 0.3402201, 'specificity': 0.9373438, 'f1': 0.26830947, 'auroc': 0.71934557}
confusion matrix:
      0     1   2     3   4   5   6     7    8   9     10
0    969     0   0   126   0   0  19    42    0   0    14
1     14  1233   9    88   0   0   7   122    0   0    26
2    538     1   0   191   0   0   2    24    9   0   250
3      0     0   0     0   0   0   0     0    0   0     0
4     60     2   0    12   0   0   0     5    2   0  1552
5    405     0   0   162   0   0  11    10    0   0     4
6   2398     4   0   154   0   0  21    63   15   0   412
7     45     6   0    71   0   0   0  1038    0   0     4
8     66     1   1  1006   0   0   1     3  267   0    25
9    699     3   0   337   0   0  15    19    0   0    64
10     0     0   0     0   0   0   0     3    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 00:16:52.016813,epoch time: 0:43:35.785188,used: 0:43:35.785188,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_33_15_seed_1_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8708797, 'precision': 0.55129975, 'recall': 0.61680603, 'specificity': 0.9862983, 'f1': 0.5612899, 'auroc': 0.92091197}
confusion matrix:
     0     1    2     3   4   5     6     7     8   9      10
0   420     2   20     2   0   0     5    19     1   0     14
1     0  1237   29    10   0   0     0    51     4   0      0
2    72     0  158     0   0   0     1    37     2   0     42
3     7     4   17  8051   0   0     1   247   108   0      1
4    26     3  160     2   0   0     0    47     8   0    293
5   127     4   25   160   0   0     0    30    25   0    150
6    70    30   12    16   0   0  1724    18     4   0     33
7     4    14   67   242   0   0     1  6870    59   0      7
8     2     0  401   273   0   0     0    61  2549   0     10
9   276     2   77    16   0   0     1    39     5   0     76
10  118    14  720    16   0   0    11   354    21   0  11541
---- Validation: 
scalar performance:
{'acc': 0.8728635, 'precision': 0.5510335, 'recall': 0.61432636, 'specificity': 0.9864627, 'f1': 0.5610246, 'auroc': 0.9219556}
confusion matrix:
     0     1    2     3   4   5     6     7     8   9      10
0   412     2   20     4   0   0     9    15     2   0     19
1     1  1245   18    11   0   0     0    51     4   0      2
2    77     0  151     1   0   0     1    40     4   0     38
3     9     2    8  8064   0   0     1   255   101   0      0
4    26     0  152     2   0   0     1    40    10   0    308
5   129     1   27   179   0   0     0    31    20   0    134
6    83    34   13     7   0   0  1719    16     5   0     31
7     3    11   71   232   0   0     1  6882    59   0      6
8     3     0  394   265   0   0     0    67  2556   0     11
9   266     0   73    12   0   0     1    48     8   0     85
10  124    13  646    15   0   0    10   368    17   0  11603
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60617083, 'precision': 0.42702568, 'recall': 0.49432796, 'specificity': 0.9607178, 'f1': 0.4336877, 'auroc': 0.79639775}
confusion matrix:
      0     1    2    3   4   5     6     7    8   9     10
0   1117     1    9    3   0   0     2    35    1   0     2
1      3  1219   56   27   0   0     2   170   12   0    10
2    334     0  261   15   0   0     2    73   53   0   277
3      0     0    0    0   0   0     0     0    0   0     0
4     21     0   26    0   0   0     2     8    6   0  1570
5    389     0    0   75   0   0     0    17    3   0   108
6    378    20   79   42   0   0  2369    93   13   0    73
7     28     2    7   25   0   0     1  1098    2   0     1
8     36     2  116  226   0   0     0    20  958   0    12
9    646     2  135   76   0   0     0    76   84   0   118
10     0     0    2    0   0   0     1     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 00:59:12.676000,epoch time: 0:42:20.659187,used: 1:25:56.444375,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_33_15_seed_1_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5791417, 'precision': 0.53753585, 'recall': 0.5829618, 'specificity': 0.9605454, 'f1': 0.52986777, 'auroc': 0.9239057}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   302     2     77    10   0    0    77     8     7   0   0
1     0  1249      2    15   0    0     1    62     2   0   0
2    44     6    168     5   0    8    16    42    22   0   1
3     1     0      0  7999   0    4     0   305   127   0   0
4     8     8    462     3   0    4    14     7    31   0   2
5    20     0      5    65   0  311    70     0    49   0   0
6     8     1     13    15   0    1  1865     3     2   0   0
7     1    12     17   142   0    0     4  7071    18   0   0
8     1     3    191   207   0    3     9   201  2680   0   0
9   143     2     63    23   0   89   123    18    28   0   4
10   23    37  12481    26   0    1   138    20    67   0   1
---- Validation: 
scalar performance:
{'acc': 0.5806607, 'precision': 0.5563534, 'recall': 0.5885924, 'specificity': 0.9607244, 'f1': 0.5297591, 'auroc': 0.9238531}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   313     2     71    12   1    1    69     7     7   0   0
1     0  1253      3    12   0    0     1    62     1   0   0
2    45     4    186     3   0    5    17    36    16   0   0
3     1     0      1  8008   0    4     1   303   122   0   0
4     7     5    461     1   0    6    15    10    34   0   0
5    26     0      5    57   0  296    77     0    60   0   0
6     7     0      7    20   0    0  1864     5     5   0   0
7     1    11     20   134   0    0     3  7081    15   0   0
8     3     3    182   190   0    2     8   202  2706   0   0
9   156     0     69    16   0   92   120    11    27   0   2
10   26    36  12494    24   0    0   123    27    65   0   1
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5433429, 'precision': 0.4016195, 'recall': 0.4366864, 'specificity': 0.95515877, 'f1': 0.4017377, 'auroc': 0.80798584}
confusion matrix:
     0     1     2    3   4   5     6    7     8   9   10
0   863     1     9  104   0   0    85  104     4   0   0
1     0  1302     7   45   0   0    33  112     0   0   0
2   185    16   412   74   0  17    51   62   146   0  52
3     0     0     0    0   0   0     0    0     0   0   0
4     3    29  1556    1   0   0    28    1    15   0   0
5   123     0    28  176   0  99    52   31    83   0   0
6     0     5     4   30   0   5  3016    1     6   0   0
7     0     2     3  169   0   0     7  983     0   0   0
8     0     0    24  212   0  13    16   14  1091   0   0
9   373    21    81  211   0  65    76  106   154   0  50
10    0    15  1620    0   0   0    10    1     0   0   0
early stop counter: 1
val acc:0.5806607007980347, best validation acc: 0.8728634715080261, corresponding to test acc:                         0.6061708331108093 / 0.6061708331108093
after epoch: 3,now: 2024-07-28 01:41:33.907998,epoch time: 0:42:21.231998,used: 2:08:17.676373,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_33_15_seed_1_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5867669, 'precision': 0.5528323, 'recall': 0.6224241, 'specificity': 0.9615256, 'f1': 0.5447279, 'auroc': 0.94425076}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   366     1     65     1   0    1    33     8     8   0   0
1     0  1256      9     6   0    1     2    45    13   0   0
2    25     0    245     0   0    0     4    13    25   0   0
3    14     3      2  7920   0    6   111   197   187   0   0
4     7     0    469     1   0    0     3     5    54   0   0
5    57     0     25    32   0  290    55     0    57   0   5
6    11     0     19     5   0    0  1865     2     5   0   0
7     2     8     37   160   0    0    14  6898   141   0   0
8     4     0     57    96   0    1     6    42  3090   0   0
9   209     0    172     4   0   43    28     9    23   0   5
10   13     1  12616     7   0    0    17    20   118   0   1
---- Validation: 
scalar performance:
{'acc': 0.5863582, 'precision': 0.5453763, 'recall': 0.6235281, 'specificity': 0.96149194, 'f1': 0.5452105, 'auroc': 0.9438974}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   374     0     65     1   0    1    29     5     8   0   0
1     0  1249      8     9   0    2     4    48    12   0   0
2    24     0    245     0   0    0     4    17    22   0   0
3    14     2      7  7903   0    4   125   205   180   0   0
4     4     0    473     1   0    0     4     6    51   0   0
5    65     0     24    28   0  289    54     0    59   0   2
6     6     0     15     1   0    0  1879     2     5   0   0
7     7     8     43   148   0    0    10  6895   154   0   0
8     4     0     60    95   0    1     5    44  3087   0   0
9   203     0    159     6   0   39    37     8    34   0   7
10   15     1  12626     8   0    1    22    16   107   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5835024, 'precision': 0.42517164, 'recall': 0.47927737, 'specificity': 0.9585315, 'f1': 0.42248413, 'auroc': 0.8278208}
confusion matrix:
     0     1     2   3   4   5     6     7     8   9   10
0   971     1    12   1   0   3   158     2    22   0   0
1     4  1304    36  15   0   3    13    92    32   0   0
2   107     2   574   4   0  11    39     8   269   0   1
3     0     0     0   0   0   0     0     0     0   0   0
4     3     0  1607   0   0   0     2     0    21   0   0
5   279     0     7  18   0  97   108     7    72   0   4
6     0     1    11   3   0   1  3042     0     9   0   0
7     3     1    21  53   0   1    22  1039    24   0   0
8     1     0     1  16   0  14    25     0  1313   0   0
9   394     5   272   7   0  31    76    12   337   0   3
10    0     0  1645   0   0   0     0     0     1   0   0
early stop counter: 2
val acc:0.5863581895828247, best validation acc: 0.8728634715080261, corresponding to test acc:                         0.6061708331108093 / 0.6061708331108093
after epoch: 4,now: 2024-07-28 02:24:00.238316,epoch time: 0:42:26.330318,used: 2:50:44.006691,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_33_15_seed_1_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5892016, 'precision': 0.55671096, 'recall': 0.62003285, 'specificity': 0.96154726, 'f1': 0.5534317, 'auroc': 0.94469804}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   426     1     38     2   0    0     3    12     0   0   1
1     0  1260      0    10   0    0     0    60     2   0   0
2   113     0    173     0   0    3     3    18     2   0   0
3     5     0      0  8106   0    5     1   281    38   0   0
4    17     1    481     0   0    2     2    18    13   0   5
5    48     1      2    25   0  365    26    12    26   0  16
6    26     2     16     3   0    0  1843    13     2   0   1
7     8     6     10   123   0    0     1  7105    11   0   0
8    15     3    109   253   0    1     2   171  2738   0   3
9   281     0     30     3   0   63    25    36     8   0  47
10   46     7  12677     5   0    0     9    29    16   0   6
---- Validation: 
scalar performance:
{'acc': 0.5898622, 'precision': 0.5534432, 'recall': 0.62377393, 'specificity': 0.9616085, 'f1': 0.55537117, 'auroc': 0.9453733}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   419     0     44     2   0    0     4    12     1   0   1
1     0  1274      1    10   0    0     0    45     2   0   0
2   100     1    181     0   0    2     4    19     3   0   2
3     9     1      1  8105   0    3     2   279    40   0   0
4    21     0    475     0   0    1     2    14    18   0   8
5    43     0      4    19   0  375    27     6    29   0  18
6    25     2     12     6   0    0  1848     9     2   0   4
7     7     6     13   114   0    0     2  7113    10   0   0
8    12     3    100   249   0    4     2   191  2734   0   1
9   266     0     34     3   0   69    22    47     8   0  44
10   37     6  12683     6   0    1    15    30    15   0   3
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56971943, 'precision': 0.43747634, 'recall': 0.47203454, 'specificity': 0.95782065, 'f1': 0.42144167, 'auroc': 0.8259872}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9   10
0   1091     4     4   13   0    0     8    49     1   0   0
1      2  1221     7   32   0    0     2   235     0   0   0
2    243    13   488   24   0    4     7   115    91   0  30
3      0     0     0    0   0    0     0     0     0   0   0
4      4     1  1612    0   0    0     2     2    11   0   1
5    196     0     1   96   0  137    28    55    56   0  23
6     18     3    15   11   0    2  3002     8     4   0   4
7      4     2     2   29   0    0     0  1127     0   0   0
8     13     0    15  223   0    7     9    26  1077   0   0
9    668     6    85   72   0   25    22   163    54   0  42
10     0     1  1645    0   0    0     0     0     0   0   0
early stop counter: 3
val acc:0.5898622274398804, best validation acc: 0.8728634715080261, corresponding to test acc:                         0.6061708331108093 / 0.6061708331108093
after epoch: 5,now: 2024-07-28 03:06:34.791633,epoch time: 0:42:34.553317,used: 3:33:18.560008,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_33_15_seed_1_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5906464, 'precision': 0.555024, 'recall': 0.6390934, 'specificity': 0.9617579, 'f1': 0.5585162, 'auroc': 0.9569664}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   424     0     50     2   0    0     2     2     3   0   0
1     0  1293      3    13   0    0     1    21     1   0   0
2    70     1    227     0   0    0     1    12     0   0   1
3     2     1      3  8226   0   18     4    43   140   0   1
4     9     0    510     0   0    1     0     3    10   0   6
5    55     0      3     7   0  349    14    27    28   0  38
6    27     1     22     5   0    0  1852     0     1   0   0
7     9    23     42   435   0    0     1  6676    77   0   0
8     8     3     91   123   0    3     1    35  3028   0   2
9   304     1     44     5   0   39     7    35     8   0  50
10   26     0  12720    10   0    1     5     6    24   0   1
---- Validation: 
scalar performance:
{'acc': 0.5906647, 'precision': 0.5574, 'recall': 0.6371233, 'specificity': 0.96174276, 'f1': 0.55941904, 'auroc': 0.95688033}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   419     0     57     2   0    0     2     2     1   0   0
1     0  1287      6    11   0    0     1    25     2   0   0
2    72     0    221     0   0    1     1    13     0   0   4
3     4     1      1  8225   0   14     3    48   143   0   1
4    12     0    506     0   0    1     0     4    13   0   3
5    43     0      4    11   0  353    20    27    14   0  49
6    28     1     22     3   0    0  1850     1     1   0   2
7    13    21     32   446   0    0     3  6673    77   0   0
8     7     2     84   115   0    1     0    30  3052   0   5
9   296     0     54     3   0   37     7    43    11   0  42
10   24     1  12723     7   0    1     4     7    27   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5632827, 'precision': 0.44002438, 'recall': 0.4636131, 'specificity': 0.9572686, 'f1': 0.42014176, 'auroc': 0.8295767}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9    10
0   1129     2     9   13   0    1     0    5    10   0    1
1     14  1343    20   31   0    2     1   83     5   0    0
2    196     2   594   13   0    1     0   66    78   0   65
3      0     0     0    0   0    0     0    0     0   0    0
4      3     0  1624    0   0    0     1    0     4   0    1
5    196     0     2   13   0  131    10   72    38   0  130
6     15     6    40    3   0   11  2967    3    21   0    1
7     52     3     6  415   0    0     5  678     5   0    0
8     10     0    34   84   0   18     3    9  1209   0    3
9    666     3   106   39   0   15     5  152    47   0  104
10     0     0  1646    0   0    0     0    0     0   0    0
early stop counter: 4
val acc:0.5906646847724915, best validation acc: 0.8728634715080261, corresponding to test acc:                         0.6061708331108093 / 0.6061708331108093
after epoch: 6,now: 2024-07-28 03:49:03.166492,epoch time: 0:42:28.374859,used: 4:15:46.934867,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_33_15_seed_1_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.59797734, 'precision': 0.57328665, 'recall': 0.6517628, 'specificity': 0.9623865, 'f1': 0.5741371, 'auroc': 0.96115893}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   406     0     49     7   0    0    15     2     4   0   0
1     0  1290      1     9   0    0     1    27     2   0   0
2    24     0    261     0   0    0     2    13     7   0   5
3     1     0      0  8299   0    7     0    55    78   0   0
4     4     2    503     0   0    1     3     4    17   0   5
5    23     1     11    23   0  365    12    14    23   0  49
6     7     1      9     8   0    0  1878     0     3   0   1
7     2     7     13   368   0    0     2  6850    21   0   0
8     1     1     64   168   0    2     2    57  3000   0   0
9   171     1    134     5   0   41     7    58     9   0  67
10   18    12  12694     8   0    1    24    11    24   0   1
---- Validation: 
scalar performance:
{'acc': 0.59676343, 'precision': 0.5736013, 'recall': 0.65102077, 'specificity': 0.9622444, 'f1': 0.57303834, 'auroc': 0.9611659}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   408     0     46     9   0    0    14     6     0   0   0
1     0  1283      3    15   0    0     1    29     1   0   0
2    23     0    261     0   0    1     4    12     7   0   4
3     2     0      1  8303   0    5     2    56    71   0   0
4     4     3    502     0   0    1     5     3    15   0   6
5    20     1     10    21   0  367    13    17    27   0  45
6     7     0     11     8   0    0  1878     0     3   0   1
7     1     9     13   395   0    0     2  6827    18   0   0
8     3     4     62   175   0    1     3    66  2981   0   1
9   193     4    123     3   0   33     8    53    10   0  66
10   16    10  12690     9   0    0    26    16    27   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57818514, 'precision': 0.45173576, 'recall': 0.47768867, 'specificity': 0.95861065, 'f1': 0.43315363, 'auroc': 0.8361505}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9    10
0   1081     6     6   31   0    0    23    8    15   0    0
1      1  1311    16   32   0    0    13  114    12   0    0
2    105     6   610   12   0    1    12   29   207   0   33
3      0     0     0    0   0    0     0    0     0   0    0
4      3     2  1611    0   0    0     3    0    14   0    0
5    135     5     3   62   0  142    10   69    47   0  119
6      0     5     5   10   0    0  3042    0     5   0    0
7      9     0     5  316   0    0     8  825     1   0    0
8      2     0     6   88   0    4    13    3  1253   0    1
9    350    31   245   41   0   21    23  129   209   0   88
10     0     1  1640    0   0    0     3    0     2   0    0
early stop counter: 5
val acc:0.5967634320259094, best validation acc: 0.8728634715080261, corresponding to test acc:                         0.6061708331108093 / 0.6061708331108093
after epoch: 7,now: 2024-07-28 04:30:58.753580,epoch time: 0:41:55.587088,used: 4:57:42.521955,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_33_15_seed_1_23104510
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 4:57:42.521955 at 2024-07-28 04:30:58.753580
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60617083, 'precision': 0.42702568, 'recall': 0.49432796, 'specificity': 0.9607178, 'f1': 0.4336877, 'auroc': 0.79639775}
confusion matrix:
      0     1    2    3   4   5     6     7    8   9     10
0   1117     1    9    3   0   0     2    35    1   0     2
1      3  1219   56   27   0   0     2   170   12   0    10
2    334     0  261   15   0   0     2    73   53   0   277
3      0     0    0    0   0   0     0     0    0   0     0
4     21     0   26    0   0   0     2     8    6   0  1570
5    389     0    0   75   0   0     0    17    3   0   108
6    378    20   79   42   0   0  2369    93   13   0    73
7     28     2    7   25   0   0     1  1098    2   0     1
8     36     2  116  226   0   0     0    20  958   0    12
9    646     2  135   76   0   0     0    76   84   0   118
10     0     0    2    0   0   0     1     1    0   0  1642
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60617083, 'precision': 0.42702568, 'recall': 0.49432796, 'specificity': 0.9607178, 'f1': 0.4336877, 'auroc': 0.79639775}
confusion matrix:
      0     1    2    3   4   5     6     7    8   9     10
0   1117     1    9    3   0   0     2    35    1   0     2
1      3  1219   56   27   0   0     2   170   12   0    10
2    334     0  261   15   0   0     2    73   53   0   277
3      0     0    0    0   0   0     0     0    0   0     0
4     21     0   26    0   0   0     2     8    6   0  1570
5    389     0    0   75   0   0     0    17    3   0   108
6    378    20   79   42   0   0  2369    93   13   0    73
7     28     2    7   25   0   0     1  1098    2   0     1
8     36     2  116  226   0   0     0    20  958   0    12
9    646     2  135   76   0   0     0    76   84   0   118
10     0     0    2    0   0   0     1     1    0   0  1642
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_33_15_seed_1_23104510_instance_wise_predictions.txt
accuracy from prediction file 0.6061708528650388
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB | 707403 GiB | 707401 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 702334 GiB | 702333 GiB |
|       from small pool |      7 MiB |     26 MiB |   5068 GiB |   5068 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB | 707403 GiB | 707401 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 702334 GiB | 702333 GiB |
|       from small pool |      7 MiB |     26 MiB |   5068 GiB |   5068 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB | 704734 GiB | 704732 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 699671 GiB | 699669 GiB |
|       from small pool |      6 MiB |     26 MiB |   5062 GiB |   5062 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  31154 MiB |  14634 MiB |
|       from large pool |  16492 MiB |  16492 MiB |  31124 MiB |  14632 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 237625 KiB | 630836 KiB | 107526 GiB | 107526 GiB |
|       from large pool | 216320 KiB | 628608 KiB | 102437 GiB | 102437 GiB |
|       from small pool |  21305 KiB |  24786 KiB |   5089 GiB |   5089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2660    |    3967    |   51903 K  |   51901 K  |
|       from large pool |     247    |     595    |   22877 K  |   22877 K  |
|       from small pool |    2413    |    3621    |   29026 K  |   29023 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2660    |    3967    |   51903 K  |   51901 K  |
|       from large pool |     247    |     595    |   22877 K  |   22877 K  |
|       from small pool |    2413    |    3621    |   29026 K  |   29023 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     828    |     361    |
|       from large pool |     453    |     453    |     813    |     360    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     121    |    1244    |   28342 K  |   28341 K  |
|       from large pool |      95    |     304    |   14926 K  |   14926 K  |
|       from small pool |      26    |    1148    |   13415 K  |   13415 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 707403 GiB | 707403 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 702334 GiB | 702334 GiB |
|       from small pool |      0 KiB |     26 MiB |   5068 GiB |   5068 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 707403 GiB | 707403 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 702334 GiB | 702334 GiB |
|       from small pool |      0 KiB |     26 MiB |   5068 GiB |   5068 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 704734 GiB | 704734 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 699671 GiB | 699671 GiB |
|       from small pool |      0 KiB |     26 MiB |   5062 GiB |   5062 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1888 MiB |  16520 MiB |  31154 MiB |  29266 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  31124 MiB |  29264 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630836 KiB | 107527 GiB | 107527 GiB |
|       from large pool |  24320 KiB | 628608 KiB | 102438 GiB | 102438 GiB |
|       from small pool |      0 KiB |  26834 KiB |   5089 GiB |   5089 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   51903 K  |   51903 K  |
|       from large pool |       2    |     595    |   22877 K  |   22877 K  |
|       from small pool |       0    |    3621    |   29026 K  |   29026 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   51903 K  |   51903 K  |
|       from large pool |       2    |     595    |   22877 K  |   22877 K  |
|       from small pool |       0    |    3621    |   29026 K  |   29026 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     107    |     467    |     828    |     721    |
|       from large pool |      93    |     453    |     813    |     720    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1244    |   28342 K  |   28342 K  |
|       from large pool |       3    |     304    |   14926 K  |   14926 K  |
|       from small pool |       0    |    1148    |   13416 K  |   13416 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 04:39:45 2024]
Finished job 0.
1 of 1 steps (100%) done
