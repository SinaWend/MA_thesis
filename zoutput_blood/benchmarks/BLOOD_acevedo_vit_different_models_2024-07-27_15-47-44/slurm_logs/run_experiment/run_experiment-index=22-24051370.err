Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 04:50:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370

 Experiment start at: 2024-08-04 05:00:11.321281
before training, model accuracy: 0.044287413358688354
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91970783, 'precision': 0.81149876, 'recall': 0.6884804, 'specificity': 0.991081, 'f1': 0.69960624, 'auroc': 0.9875936}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   133     0   0     6    0    3   196     5     9   12    119
1     0  1281   0    12    0    0     1    26     9    0      3
2     2     6  16     3   39   17    25     8    30  124     42
3     0     6   0  7916    0   10     7   250   239    4      5
4     2     5   6     2  106    4    38     2    46   13    314
5     0     0   0    49    0  361     2     0    16   91      2
6     3     4   0     5    0    1  1854     4    11    1     24
7     1   102   0   230    0    2     8  6724   136    3     57
8     1     3   0   106    4    4    16    58  2964    3    136
9     0     0   4    11    2  102    13     0    27  329      5
10    5     7   0     7    3    0    37    19    23    3  12691
---- Validation: 
scalar performance:
{'acc': 0.9187375, 'precision': 0.8167145, 'recall': 0.68703616, 'specificity': 0.99099654, 'f1': 0.69766474, 'auroc': 0.9876104}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   134     0   0     7    0    3   193     9    13   12    112
1     0  1274   0    11    0    1     2    28    11    1      4
2     5     6  17     3   40   20    13    19    32  120     37
3     2     5   0  7919    0   15    11   233   245    3      7
4     1     1   3     3  118    7    25     1    53   17    310
5     0     0   0    41    0  351     2     0    14  111      2
6     3     2   0     4    0    1  1848     5    11    2     32
7     2   113   0   230    4    1    14  6708   138    1     54
8     0     5   0    96    6    9     9    49  2964    5    153
9     1     2   2     9    4  108    12     0    27  323      5
10    3    12   0     7    5    2    33    21    21    1  12691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6575946, 'precision': 0.58808684, 'recall': 0.53161055, 'specificity': 0.9642414, 'f1': 0.49887186, 'auroc': 0.86618495}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   248     5   0  19    0    0   797    17    27   48     9
1     0  1336   0  15    0    0    10   104    12    5    17
2     4    15   0   2   79   12   156    37   366  149   195
3     0     0   0   0    0    0     0     0     0    0     0
4     0     6   0   0  143    0    19     1    24    0  1440
5     4     0   0  64    0  184    56     0    26  257     1
6     0     4   0   9    0    0  2857     7    37    2   151
7     0    10   0  12    0    0     7  1126     1    2     6
8     0     0   0  23    2    2    48     3  1279    9     4
9     6    25   1  27    6   42    80    37   307  593    13
10    0     4   0   0    5    0     4     0     0    0  1633
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 05:25:47.996389,epoch time: 0:25:36.675108,used: 0:25:36.675108,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9414598, 'precision': 0.86545086, 'recall': 0.77615106, 'specificity': 0.99355114, 'f1': 0.79416806, 'auroc': 0.9940578}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   384     0   0     8    0    2     3     8     6   21     51
1     0  1236   0    15    0    0     0    61    14    0      6
2     2     0  71     4   21    6     1    11    33  147     16
3     0     1   0  8150    0   18     0   140   128    2      0
4     2     0  14     1  167    3     0     6    85   26    235
5     0     0   0    31    0  428     0     0     7   54      1
6    28     0   0     9    1    1  1810     8    15   10     25
7     2     3   0   296    2    0     2  6854    90    2     11
8     0     0   1    98    1    3     0    56  3110    2     25
9     0     0   4    13    0  133     0     1    13  327      1
10   14     0   2     9    2    2     4    22    83    4  12651
---- Validation: 
scalar performance:
{'acc': 0.94155407, 'precision': 0.86615586, 'recall': 0.78207463, 'specificity': 0.9935434, 'f1': 0.8013265, 'auroc': 0.9939461}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   384     0   0    11    0    0     3     6     8   22     49
1     0  1230   0    16    0    0     0    63    18    0      5
2     1     0  84     3   21    7     1    16    32  134     13
3     2     0   0  8140    0   20     0   138   136    3      1
4     4     0  21     2  164    5     1     7    76   24    235
5     0     0   0    33    0  432     0     0     5   50      1
6    25     0   0     9    0    2  1806     6    15    8     37
7     1     3   0   288    1    1     1  6866    93    0     11
8     1     0   0    98    0    6     0    61  3103    2     25
9     1     0   8    16    0  108     0     0    15  343      2
10   10     0   3    10    5    3     3    21    91    2  12648
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6884489, 'precision': 0.67002004, 'recall': 0.59589964, 'specificity': 0.96861607, 'f1': 0.55738723, 'auroc': 0.8731879}
confusion matrix:
      0     1   2   3   4    5     6     7     8    9     10
0   1079     0   0   6   0    0     1    17    39   22     6
1      3  1102   0  20   1    2     2   273    67    1    28
2     23     0  32   4  29   16     4    27   530  156   194
3      0     0   0   0   0    0     0     0     0    0     0
4      3     0   0   0  52    0     1     0    52    0  1525
5     16     0   0  47   0  352     4     0    27  143     3
6      6     0   0   7   3    0  2610     3   303    0   135
7      4     0   0  47   0    0     3  1089    12    5     4
8      1     0   0  20   0    3     3     2  1334    6     1
9     38     2   8  32   3   96     0    24   361  547    26
10     0     0   0   0   2    0     0     0     1    0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 05:50:27.498850,epoch time: 0:24:39.502461,used: 0:50:16.177569,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9493258, 'precision': 0.88018036, 'recall': 0.81847197, 'specificity': 0.99455535, 'f1': 0.8398986, 'auroc': 0.9956516}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     0    0     3    1    0    27     1    14    3     41
1     0  1267    0     8    0    0     0    33    23    0      1
2     3     0  131     0   54    4     3     1    40   74      2
3     1     1    1  8018    0   17     2   137   260    1      1
4     2     0   16     0  258    2     4     2    63    5    186
5     3     0    0    21    0  380     1     0    19   96      1
6     6     0    0     3    1    0  1877     1     8    0     11
7     1     6    2   157    1    0     6  6932   137    2     19
8     0     0    2    36    2    0     1    33  3201    0     21
9     2     0   15     5    0   56     4     0    34  375      2
10   11     1    1     6   18    2    27    10    66    0  12650
---- Validation: 
scalar performance:
{'acc': 0.9494985, 'precision': 0.88737243, 'recall': 0.82173157, 'specificity': 0.99458516, 'f1': 0.8442939, 'auroc': 0.9957012}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   396     0    0     4    0    0    24     2    15    4     38
1     0  1273    0     7    0    0     0    30    22    0      0
2     2     1  144     0   37    1     4     4    42   75      2
3     1     0    0  8007    0   18     2   137   272    3      0
4     2     0   11     1  260    1     8     2    69    7    178
5     3     0    0    19    0  372     2     0    20  104      1
6     4     1    0     1    1    0  1880     1     9    1     10
7     0    10    2   163    2    0     6  6942   128    1     11
8     1     0    0    34    0    0     2    42  3191    1     25
9     5     0   16     3    0   55     7     0    32  374      1
10    7     2    1     6   20    1    14    13    72    2  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68970823, 'precision': 0.6464212, 'recall': 0.5571564, 'specificity': 0.9684824, 'f1': 0.53273326, 'auroc': 0.87531465}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   956     0   0   5    1    0   125    10    61    4     8
1     0  1225   0  23    1    0     9   161    59    0    21
2    11     1  38   0  140    8    25    18   656   49    69
3     0     0   0   0    0    0     0     0     0    0     0
4     1     0   1   0  218    0     3     0    67    0  1343
5    35     0   1  44    0  142    28     0   107  234     1
6     0     0   0   2    0    0  2984     0    61    0    20
7     0     0   0  97    0    0    42  1002    20    0     3
8     0     0   0   9    0    0     8     1  1352    0     0
9    36     5  21  18    7   36    33    20   640  308    13
10    0     0   0   0   11    0     1     0     1    0  1633
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 06:14:57.991486,epoch time: 0:24:30.492636,used: 1:14:46.670205,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95194775, 'precision': 0.8688469, 'recall': 0.84603673, 'specificity': 0.99482024, 'f1': 0.8547604, 'auroc': 0.99627185}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     1    1    10    0    1     4     9    13    3     19
1     0  1282    0    12    0    0     0    34     4    0      0
2     0     1  219     2   12    3     1    13    15   46      0
3     0     1    0  8294    0    6     0    76    58    1      0
4     2     4   80     5  263    4     3    11    55   10    102
5     1     0    2    43    0  414     0     0    10   50      1
6    21     0    0    11    2    1  1850     6     6    2      9
7     0    13    1   236    1    0     1  6983    24    2      3
8     0     2    2   190    1    0     1   103  2989    1      7
9     4     2   37    12    0   84     0     4    12  338      0
10   24    13   12    11   79    2     8    32    84    1  12526
---- Validation: 
scalar performance:
{'acc': 0.95161164, 'precision': 0.8658728, 'recall': 0.84208155, 'specificity': 0.99480367, 'f1': 0.8519079, 'auroc': 0.9961135}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     1    1     5    0    0     2     8    11    3     18
1     0  1281    0    13    0    0     0    35     3    0      0
2     1     1  200     4   14    3     0    14    19   56      0
3     0     2    0  8293    0    3     1    77    62    2      0
4     4     4   84     4  274    2     2    12    53    7     93
5     1     0    0    47    0  394     0     0    11   67      1
6    13     0    0     9    1    1  1855     7     7    2     13
7     0    18    0   214    1    0     1  7009    19    0      3
8     1     1    3   175    4    0     0   109  2996    0      7
9     1     0   35    13    0   82     1     4    16  341      0
10   22    14    9    15   79    3    15    42    98    0  12499
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7178339, 'precision': 0.6924968, 'recall': 0.6052253, 'specificity': 0.9720818, 'f1': 0.60709715, 'auroc': 0.87427074}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1010     3    0   60    0    0     4    66    21    6     0
1      1  1252    0   33    0    0     0   205     6    0     2
2     13     7  213   42   89   14     2   144   326   90    75
3      0     0    0    0    0    0     0     0     0    0     0
4      1     5    2    0  461    0     1     6    37    1  1119
5      5     0    0  206    1  252     0     0    16  112     0
6      4     0    0   36    1    0  2777    14   150    0    85
7      0     0    0   84    0    0     0  1077     0    0     3
8      0     0    0  138    0    0     0    23  1207    2     0
9     15    14   90  178    3   78     0   169   190  396     4
10     0     4    0    0   26    0     0     0     1    0  1615
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 06:39:12.128576,epoch time: 0:24:14.137090,used: 1:39:00.807295,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95315176, 'precision': 0.85464054, 'recall': 0.85866535, 'specificity': 0.99511147, 'f1': 0.85412997, 'auroc': 0.99678034}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    1     6    0    0    15     2    14    7     17
1     0  1307    1     9    0    0     0    12     1    2      0
2     0     1  155     2    9    0     0     6     5  134      0
3     0    15    1  8182    0   18     0   158    60    6      0
4     3     1   68     0  337    1     3     5    27   30     64
5     0     0    0    12    1  436     0     0     4   68      0
6     2     0    0     6    0    0  1885     2     3    3      6
7     0    74    2   153    0    0     1  6989    38    3      3
8     0     7    2   160    7    8     1    53  3034   10     14
9     0     0    6     4    0   78     0     0     2  403      0
10   19     3   20     7  125    1    32    24    73   10  12476
---- Validation: 
scalar performance:
{'acc': 0.95161164, 'precision': 0.8477268, 'recall': 0.8593421, 'specificity': 0.99497545, 'f1': 0.85110736, 'auroc': 0.9966159}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    1     4    0    0    15     1     9   12     16
1     0  1306    0     8    0    0     0    15     3    0      0
2     0     1  158     1    9    0     0     1     5  137      0
3     0    15    1  8188    0   23     0   154    53    6      0
4     2     2   78     2  328    2     4     2    27   27     65
5     0     0    0    10    0  434     0     0     6   70      1
6     4     1    0     3    1    0  1884     3     4    3      5
7     0    89    1   175    2    0     3  6948    37    6      4
8     2     5    3   151    6    6     2    53  3054    8      6
9     0     0    4     7    0   69     0     0     3  410      0
10   19     6   22    10  152    1    33    22    77   13  12441
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7866788, 'precision': 0.73080206, 'recall': 0.65893793, 'specificity': 0.978516, 'f1': 0.67332166, 'auroc': 0.8895259}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   811     0    4   35    2    2   181    14    13   99     9
1     0  1330    1   23    2    0     3   127     3    1     9
2     1     1  309   14  256    4    36    29   199  154    12
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    9    0  908    0     4     2    14    1   695
5     0     0    1   77    0  222     3     0     0  289     0
6     0     0    0    3    3    0  3056     1     3    0     1
7     0     0    0   58    0    0     3  1098     1    2     2
8     0     0    0  113    0    0     9     7  1237    4     0
9     1     4  104   74   13   40     9    45    78  768     1
10    0     0    1    0  138    0     1     0     1    0  1505
new oracle model saved
early stop counter: 1
val acc:0.9516116380691528, best validation acc: 0.9516116380691528, corresponding to test acc:                         0.7178338766098022 / 0.7866787910461426
after epoch: 5,now: 2024-08-04 07:02:56.390352,epoch time: 0:23:44.261776,used: 2:02:45.069071,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96115154, 'precision': 0.8982086, 'recall': 0.866493, 'specificity': 0.995806, 'f1': 0.8771521, 'auroc': 0.99764794}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     6    0    0    14     3    11    4     14
1     0  1300    0     6    0    0     0    19     7    0      0
2     2     1  190     2   20    2     1     7     3   84      0
3     0     3    0  8277    0   27     0    50    78    0      0
4     4     1   34     0  298    3    11     6    32    7    143
5     0     0    0    13    0  479     0     0     5   22      1
6     5     0    0     2    0    1  1882     4     7    1      5
7     0    19    1   217    1    0     3  6990    29    1      4
8     1     3    4   112    4   10     0    50  3103    3      6
9     2     0    8     3    0  116     3     2     2  356      1
10   19     5    3     8   19    1    29    32    60    0  12618
---- Validation: 
scalar performance:
{'acc': 0.9614284, 'precision': 0.8973135, 'recall': 0.86576223, 'specificity': 0.9958264, 'f1': 0.87663484, 'auroc': 0.9976384}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     3    0    0    13     3    12    2     20
1     0  1296    0     8    0    0     0    23     5    0      0
2     2     1  182     2   19    3     2     7     8   85      1
3     0     1    0  8283    0   26     1    45    82    2      0
4     4     2   38     4  300    1     6     4    25   11    144
5     1     0    0    11    0  481     1     0     5   21      1
6     3     0    0     2    0    1  1880     6     6    3      7
7     0    20    0   215    1    0     2  6988    33    1      5
8     1     3    4   100    8    7     1    52  3108    4      8
9     1     0    7     6    0  110     0     3     2  364      0
10   17     3    3     9   23    2    20    24    63    1  12631
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7525362, 'precision': 0.68304366, 'recall': 0.6503316, 'specificity': 0.9750392, 'f1': 0.6347235, 'auroc': 0.8743876}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1015     1    1   11    1    2    91    12    22   13     1
1      1  1347    1   15    0    1     4   110    13    2     5
2     11     2  230    5  200   24    22    32   323   78    88
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    4    0  286    0     6     1    25    0  1309
5      5     0    0   33    1  467    11     0     9   65     1
6      0     0    0    2    1    0  2998     2    34    0    30
7      0     0    0  129    0    1    13  1016     2    0     3
8      0     1    0   38    0    5     6     3  1315    2     0
9     16     9  139   40    6  217    15    52   185  448    10
10     0     0    0    0    7    0     4     0     1    0  1634
better model found
persisted
after epoch: 6,now: 2024-08-04 07:27:00.520728,epoch time: 0:24:04.130376,used: 2:26:49.199447,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96056294, 'precision': 0.8988199, 'recall': 0.85169005, 'specificity': 0.995617, 'f1': 0.87087333, 'auroc': 0.9977722}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    0     4    0    0     0     1     6   14     52
1     0  1273    0    12    0    0     0    42     5    0      0
2     0     0  162     4   21    0     0     9    11  105      0
3     0     1    0  8305    0    8     0    81    43    1      0
4     2     0   28     4  339    1     0     5    28   11    121
5     0     0    0    28    0  450     0     0     3   39      1
6    12     0    1    11   13    2  1760     3    15    5     86
7     0     4    1   142    2    0     0  7094    12    0      7
8     1     0    3   133    2    0     0    86  3054    5     10
9     1     0   10     8    0   95     0     3     2  374      0
10    4     0    4     9   32    1     1    10    47    0  12686
---- Validation: 
scalar performance:
{'acc': 0.9612411, 'precision': 0.90119135, 'recall': 0.8643109, 'specificity': 0.99571097, 'f1': 0.88019216, 'auroc': 0.9977552}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     2    1    1     1     0    10   10     39
1     0  1276    0     8    0    0     0    41     6    0      1
2     1     0  190     0   11    0     0     9     6   93      2
3     0     0    0  8324    0    3     0    85    26    2      0
4     2     0   33     1  351    1     0     3    29   10    109
5     0     0    0    29    0  444     0     0     5   42      1
6    14     0    1     7   22    0  1773     6     5    8     72
7     0     4    1   172    1    0     1  7067    13    1      5
8     0     0    1   142    3    2     0    84  3048    4     12
9     0     0   10     9    1   92     0     0     3  378      0
10    7     0    4     8   37    0     1    11    59    3  12666
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.698034, 'precision': 0.68202806, 'recall': 0.59573776, 'specificity': 0.96997064, 'f1': 0.5960281, 'auroc': 0.8672491}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   993     0    0   31    1    0     3    45    53   34    10
1     0  1052    0   32    0    0     0   379     9    0    27
2     2     0  229   20  128    8     0    92   343  116    77
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  336    0     1     3    43    1  1245
5     1     0    0  155    1  259     0     0     5  171     0
6     6     0    0    9   20    0  2665     5   177    1   184
7     0     0    0   79    0    0     0  1081     1    0     3
8     0     0    0  160    0    0     0    17  1192    1     0
9     5     0   80  166    5   76     1   107   138  543    16
10    0     0    0    0   16    0     0     0     3    0  1627
early stop counter: 1
val acc:0.9612411260604858, best validation acc: 0.9614284038543701, corresponding to test acc:                         0.7525361776351929 / 0.7866787910461426
after epoch: 7,now: 2024-08-04 07:51:00.497742,epoch time: 0:23:59.977014,used: 2:50:49.176461,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97035533, 'precision': 0.91007024, 'recall': 0.90103686, 'specificity': 0.99684453, 'f1': 0.9032765, 'auroc': 0.99855393}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    1     1    1    0     2     0     0    4     22
1     0  1289    0    10    0    0     0    28     4    0      1
2     1     0  252     0   21    3     1     4     5   24      1
3     0     0    1  8247    0    6     0    79   102    1      0
4     2     0   31     2  408    2     0     3    20    1     70
5     0     0    0    21    0  471     0     0     5   23      1
6     5     0    1     1    2    0  1883     3     4    0      8
7     0     5    0   111    1    0     2  7094    44    1      5
8     2     0    5    42    3    5     0    37  3183    0     18
9     0     0   68     2    0  102     0     3     2  316      0
10    9     0    3     8   51    2     9     5    34    1  12673
---- Validation: 
scalar performance:
{'acc': 0.969453, 'precision': 0.90339327, 'recall': 0.89382905, 'specificity': 0.9967488, 'f1': 0.8964885, 'auroc': 0.99858165}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     2    1    0     3     0     2    4     23
1     0  1285    0    10    0    0     0    29     7    0      1
2     1     0  248     0   24    0     1     1     4   32      1
3     0     1    1  8255    0    6     0    85    92    0      0
4     3     0   28     2  401    0     0     3    18    2     82
5     0     0    1    19    1  465     0     0     7   28      0
6     6     0    1     1    3    0  1881     1     4    2      9
7     0     6    0   106    2    0     1  7098    45    0      7
8     1     0    6    35    2    1     0    36  3194    1     20
9     0     0   71     4    0  111     2     1     4  300      0
10    8     0    4     8   58    1     9     5    34    1  12668
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7558945, 'precision': 0.6971482, 'recall': 0.63981074, 'specificity': 0.97563964, 'f1': 0.6446981, 'auroc': 0.87583065}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1040     0    1   18    1    3    30    11    44   19     3
1      0  1192    1   29    1    0     4   231    16    0    25
2      6     0  298   14  224   19    15    33   301   60    45
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0   10    0  528    0     6     1    19    0  1067
5      4     0    1  137    1  306     3     0     5  135     0
6      0     0    0   12    2    0  3029     1    12    0    11
7      0     0    0   68    0    0     3  1086     4    0     3
8      0     0    0   94    0    0     6     3  1267    0     0
9      7     3  158  139   14   96     9    51   198  457     5
10     0     0    0    0   39    0     5     0     1    0  1601
better model found
persisted
after epoch: 8,now: 2024-08-04 08:14:47.119971,epoch time: 0:23:46.622229,used: 3:14:35.798690,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96706444, 'precision': 0.9242438, 'recall': 0.8932104, 'specificity': 0.99638134, 'f1': 0.9065848, 'auroc': 0.9982602}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     4    1    0     2     7     3    4     17
1     0  1276    0     8    0    0     0    43     4    0      0
2     3     0  231     3   22    0     1    12     4   36      0
3     0     0    1  8339    0    8     0    80    11    0      0
4     3     0   21     1  402    0     0    10    22    4     76
5     0     0    0    27    0  388     0     0     3  102      1
6    11     0    1     4    1    0  1878     0     4    1      8
7     0     3    0   105    1    0     1  7146     5    0      3
8     1     0    2   199    2    1     0   128  2955    1      7
9     0     0   17     5    0   30     0     8     3  430      0
10   14     0    0    11   33    1     5    32    39    0  12655
---- Validation: 
scalar performance:
{'acc': 0.9670456, 'precision': 0.918967, 'recall': 0.8900658, 'specificity': 0.9963884, 'f1': 0.90244955, 'auroc': 0.9982444}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     5    1    1     1     9     3    3     11
1     0  1274    0    11    0    0     0    45     2    0      0
2     1     0  216     2   25    0     0    16     4   48      0
3     0     0    0  8334    0    4     0    88    11    3      0
4     4     0   24     1  404    0     1     6    15    2     82
5     0     0    1    25    0  392     0     0     2  100      1
6     8     0    1     2    1    0  1872     4     5    1     14
7     0     1    0   109    1    0     1  7149     1    0      3
8     1     0    2   188    4    1     1   110  2982    2      5
9     0     0   24     5    0   28     1     5     4  426      0
10   11     1    2     7   44    1     4    32    39    0  12655
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71230674, 'precision': 0.6691926, 'recall': 0.5950142, 'specificity': 0.9712696, 'f1': 0.58995736, 'auroc': 0.86185414}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   969     0    0   38    0    1    34    60    39   18    11
1     0  1127    0   33    1    0     2   292    18    0    26
2     6     0  133   13  198    7    14    53   397   92   102
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  319    0     2     3    26    1  1282
5     2     0    1  118    1  253     5     0     4  207     1
6     1     0    0   14    1    0  2951     2    20    0    78
7     0     0    0   59    0    0     1  1101     0    0     3
8     0     0    0  152    0    0     3    10  1204    1     0
9     9     3   77  142    7   75     4   110   204  493    13
10    0     0    0    0   13    0     1     0     1    0  1631
early stop counter: 1
val acc:0.9670456051826477, best validation acc: 0.969452977180481, corresponding to test acc:                         0.7558944821357727 / 0.7866787910461426
after epoch: 9,now: 2024-08-04 08:39:06.280475,epoch time: 0:24:19.160504,used: 3:38:54.959194,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9689105, 'precision': 0.9072721, 'recall': 0.8950269, 'specificity': 0.9966178, 'f1': 0.8969588, 'auroc': 0.99873745}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     3    0    0     0     3     0    3      7
1     0  1287    0    10    0    0     0    30     4    0      1
2     4     0  241     0   14    3     0     2     5   43      0
3     1     0    1  8314    0   11     1    59    50    3      0
4    10     0   30     2  330    1     1     3    10    4    148
5     2     0    1    13    0  432     0     0     5   67      1
6    73     0    2     1    1    0  1806     3     3    0     16
7     1     1    1   145    1    0     1  7083    24    1      6
8     2     0    3    82    5    3     0    24  3151    8     16
9     5     0   31     2    0   39     0     0     1  415      0
10   52     0    1     9   11    1     1     6    22    2  12688
---- Validation: 
scalar performance:
{'acc': 0.9686773, 'precision': 0.9086613, 'recall': 0.8966534, 'specificity': 0.99658203, 'f1': 0.8987746, 'auroc': 0.99865836}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    0    0     1     0     1    3      6
1     0  1278    0     9    0    0     0    41     2    0      2
2     2     0  242     0   18    0     0     4     6   40      0
3     0     0    0  8335    0   13     1    47    42    2      0
4     8     0   26     1  339    0     0     3     9    7    146
5     1     0    1     8    0  438     0     0     5   67      1
6    79     1    0     1    3    0  1798     2     3    1     20
7     1     1    2   170    1    0     1  7056    30    0      3
8     8     0    2    84    5    3     0    21  3144    8     21
9     3     0   32     4    0   40     0     1     1  412      0
10   47     0    2     8    7    0     3     7    18    3  12701
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7368642, 'precision': 0.67674416, 'recall': 0.632059, 'specificity': 0.9735248, 'f1': 0.6285813, 'auroc': 0.8693132}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1087     0    0    7    1    2    12    19    25   12     5
1      3  1080    4   27    1    0     5   324    15    3    37
2      8     0  267    5  290   11    34    28   136  108   128
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    2    0  224    0     1     1     8    1  1395
5      5     0    0   56    1  339     9     0     3  176     3
6      3     0    0    5    2    0  2971     2     5    0    79
7      1     0    1  115    0    0    18  1021     4    1     3
8      0     0    0   92    3    4    18     1  1243    3     6
9     19     0  147   53    5   93    15    43    80  661    21
10     0     0    0    0    6    0     0     0     1    0  1639
early stop counter: 2
val acc:0.968677282333374, best validation acc: 0.969452977180481, corresponding to test acc:                         0.7558944821357727 / 0.7866787910461426
after epoch: 10,now: 2024-08-04 09:03:03.934016,epoch time: 0:23:57.653541,used: 4:02:52.612735,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:02:52.612735 at 2024-08-04 09:03:03.934016
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7558945, 'precision': 0.6971482, 'recall': 0.63981074, 'specificity': 0.97563964, 'f1': 0.6446981, 'auroc': 0.87583065}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1040     0    1   18    1    3    30    11    44   19     3
1      0  1192    1   29    1    0     4   231    16    0    25
2      6     0  298   14  224   19    15    33   301   60    45
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0   10    0  528    0     6     1    19    0  1067
5      4     0    1  137    1  306     3     0     5  135     0
6      0     0    0   12    2    0  3029     1    12    0    11
7      0     0    0   68    0    0     3  1086     4    0     3
8      0     0    0   94    0    0     6     3  1267    0     0
9      7     3  158  139   14   96     9    51   198  457     5
10     0     0    0    0   39    0     5     0     1    0  1601
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7866788, 'precision': 0.73080206, 'recall': 0.65893793, 'specificity': 0.978516, 'f1': 0.67332166, 'auroc': 0.8895259}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   811     0    4   35    2    2   181    14    13   99     9
1     0  1330    1   23    2    0     3   127     3    1     9
2     1     1  309   14  256    4    36    29   199  154    12
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    9    0  908    0     4     2    14    1   695
5     0     0    1   77    0  222     3     0     0  289     0
6     0     0    0    3    3    0  3056     1     3    0     1
7     0     0    0   58    0    0     3  1098     1    2     2
8     0     0    0  113    0    0     9     7  1237    4     0
9     1     4  104   74   13   40     9    45    78  768     1
10    0     0    1    0  138    0     1     0     1    0  1505
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_05_00_10_seed_0_24051370_instance_wise_predictions.txt
accuracy from prediction file 0.7558944938081579
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/7.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2657 MiB |  16861 MiB | 436990 GiB | 436987 GiB |
|       from large pool |   2643 MiB |  16829 MiB | 433919 GiB | 433916 GiB |
|       from small pool |     14 MiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2657 MiB |  16861 MiB | 436990 GiB | 436987 GiB |
|       from large pool |   2643 MiB |  16829 MiB | 433919 GiB | 433916 GiB |
|       from small pool |     14 MiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2655 MiB |  16818 MiB | 435863 GiB | 435860 GiB |
|       from large pool |   2641 MiB |  16785 MiB | 432795 GiB | 432793 GiB |
|       from small pool |     13 MiB |     33 MiB |   3067 GiB |   3067 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17668 MiB |  17668 MiB |  17668 MiB |      0 B   |
|       from large pool |  17632 MiB |  17632 MiB |  17632 MiB |      0 B   |
|       from small pool |     36 MiB |     36 MiB |     36 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 346277 KiB | 778845 KiB |  58799 GiB |  58798 GiB |
|       from large pool | 325888 KiB | 777664 KiB |  55720 GiB |  55719 GiB |
|       from small pool |  20389 KiB |  23171 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3082    |    4805    |   31224 K  |   31221 K  |
|       from large pool |     349    |     697    |   13421 K  |   13421 K  |
|       from small pool |    2733    |    4255    |   17802 K  |   17799 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3082    |    4805    |   31224 K  |   31221 K  |
|       from large pool |     349    |     697    |   13421 K  |   13421 K  |
|       from small pool |    2733    |    4255    |   17802 K  |   17799 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     508    |     508    |     508    |       0    |
|       from large pool |     490    |     490    |     490    |       0    |
|       from small pool |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     169    |    1220    |   17365 K  |   17365 K  |
|       from large pool |     132    |     339    |    9279 K  |    9279 K  |
|       from small pool |      37    |    1087    |    8086 K  |    8086 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  16861 MiB | 436990 GiB | 436990 GiB |
|       from large pool |  65536 KiB |  16829 MiB | 433919 GiB | 433919 GiB |
|       from small pool |      0 KiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  16861 MiB | 436990 GiB | 436990 GiB |
|       from large pool |  65536 KiB |  16829 MiB | 433919 GiB | 433919 GiB |
|       from small pool |      0 KiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  16818 MiB | 435863 GiB | 435863 GiB |
|       from large pool |  65536 KiB |  16785 MiB | 432795 GiB | 432795 GiB |
|       from small pool |      0 KiB |     33 MiB |   3067 GiB |   3067 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2996 MiB |  17668 MiB |  17668 MiB |  14672 MiB |
|       from large pool |   2962 MiB |  17632 MiB |  17632 MiB |  14670 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  43008 KiB | 778845 KiB |  58800 GiB |  58800 GiB |
|       from large pool |  43008 KiB | 777664 KiB |  55721 GiB |  55721 GiB |
|       from small pool |      0 KiB |  28880 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31224 K  |   31224 K  |
|       from large pool |       2    |     697    |   13421 K  |   13421 K  |
|       from small pool |       0    |    4255    |   17802 K  |   17802 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31224 K  |   31224 K  |
|       from large pool |       2    |     697    |   13421 K  |   13421 K  |
|       from small pool |       0    |    4255    |   17802 K  |   17802 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     151    |     508    |     508    |     357    |
|       from large pool |     134    |     490    |     490    |     356    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1220    |   17366 K  |   17366 K  |
|       from large pool |       1    |     339    |    9279 K  |    9279 K  |
|       from small pool |       0    |    1087    |    8087 K  |    8087 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  16861 MiB | 436990 GiB | 436990 GiB |
|       from large pool |  65536 KiB |  16829 MiB | 433919 GiB | 433919 GiB |
|       from small pool |      0 KiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  16861 MiB | 436990 GiB | 436990 GiB |
|       from large pool |  65536 KiB |  16829 MiB | 433919 GiB | 433919 GiB |
|       from small pool |      0 KiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  16818 MiB | 435863 GiB | 435863 GiB |
|       from large pool |  65536 KiB |  16785 MiB | 432795 GiB | 432795 GiB |
|       from small pool |      0 KiB |     33 MiB |   3067 GiB |   3067 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2996 MiB |  17668 MiB |  17668 MiB |  14672 MiB |
|       from large pool |   2962 MiB |  17632 MiB |  17632 MiB |  14670 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  43008 KiB | 778845 KiB |  58800 GiB |  58800 GiB |
|       from large pool |  43008 KiB | 777664 KiB |  55721 GiB |  55721 GiB |
|       from small pool |      0 KiB |  28880 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31224 K  |   31224 K  |
|       from large pool |       2    |     697    |   13421 K  |   13421 K  |
|       from small pool |       0    |    4255    |   17802 K  |   17802 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31224 K  |   31224 K  |
|       from large pool |       2    |     697    |   13421 K  |   13421 K  |
|       from small pool |       0    |    4255    |   17802 K  |   17802 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     151    |     508    |     508    |     357    |
|       from large pool |     134    |     490    |     490    |     356    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1220    |   17366 K  |   17366 K  |
|       from large pool |       1    |     339    |    9279 K  |    9279 K  |
|       from small pool |       0    |    1087    |    8087 K  |    8087 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370

 Experiment start at: 2024-08-04 09:15:05.331557
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9157748, 'precision': 0.82359856, 'recall': 0.70347357, 'specificity': 0.99074614, 'f1': 0.7260117, 'auroc': 0.98540145}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   254     0    1    18   0    1    31    19    35   13    110
1     0  1152    0    36   0    0     0   115    20    0      7
2     1     0  186     1   7    1     3    11    69   25      8
3     0     0    0  8141   0    4     0   125   169    0      0
4     0     0   64     1  43    0     2    10   206   12    201
5     2     0   18    82   0  316     0     0    21   81      1
6     9     1    0    31   0    1  1719    12    24    6    105
7     0     4    0   383   0    0     1  6670   189    0     15
8     0     0    2   164   0    0     0    50  3067    0     13
9     3     0  125    18   1  119     0     5    34  183      5
10    4     0    1    10   1    0    11    36   233    1  12497
---- Validation: 
scalar performance:
{'acc': 0.9168115, 'precision': 0.8359312, 'recall': 0.70950556, 'specificity': 0.9908434, 'f1': 0.7342166, 'auroc': 0.9857967}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   257     0    5    19   0    0    36    12    35   12    107
1     0  1156    1    37   0    0     0   111    17    0     10
2     1     0  187     4   5    1     4    13    61   29      7
3     0     0    0  8131   0    6     0   148   155    0      0
4     0     0   60     3  53    1     3     4   194   12    209
5     0     0   15    80   0  312     0     0    23   90      1
6     7     0    0    35   0    1  1727     9    33    5     91
7     0     2    0   379   0    0     1  6675   187    0     21
8     0     0    1   162   0    0     0    52  3063    0     18
9     1     0  118    17   0  107     1     3    37  204      5
10    2     0    2     9   1    1     6    26   237    2  12510
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4929686, 'precision': 0.5681102, 'recall': 0.46042883, 'specificity': 0.9493308, 'f1': 0.4182862, 'auroc': 0.7922149}
confusion matrix:
     0    1   2    3   4    5    6     7     8   9     10
0   792    0   2  127   0    1   51    56   111  14    16
1     1  929   0   67   0    0    4   425    24   0    49
2    16    0  29   38   8   12    5    33   718  32   124
3     0    0   0    0   0    0    0     0     0   0     0
4     0    0   0    0  27    0    1     1   107   0  1497
5    14    0   0  193   0  315    1     0    40  29     0
6     0    2   1   17  16    0  928    17  1164   0   922
7     0    0   0  102   0    0    0  1056     1   1     4
8     0    0   0  138   0    0    1     2  1228   0     1
9    38    2  58  251   2  153    0    39   473  97    24
10    0    0   0    0   0    0    0     0     1   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 09:39:32.483374,epoch time: 0:24:27.151817,used: 0:24:27.151817,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93562716, 'precision': 0.85483027, 'recall': 0.7753197, 'specificity': 0.9928186, 'f1': 0.804757, 'auroc': 0.99142617}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   370     1    0    10    0    0    19     3    15    2     63
1     0  1264    0    20    0    0     0    32    11    0      5
2     8     3  106     2   72    2     2    12    36   60      9
3     0     1    0  8263    0   12     1    61    99    0      0
4     2     1    2     1  225    1     8     4    66   11    218
5     3     0    2    66    0  391     1     0     8   49      1
6     6     0    0     8    0    0  1859     1    12    1     21
7     1    29    0   540    1    0     2  6534   140    0     15
8     1     1    1   184    1    0     0    48  3025    0     35
9     9     0   44    19    9  108     4     6    16  268      9
10    8     0    0     9    8    0    18    22    61    3  12665
---- Validation: 
scalar performance:
{'acc': 0.9335295, 'precision': 0.85345554, 'recall': 0.7725526, 'specificity': 0.9925811, 'f1': 0.8021553, 'auroc': 0.9914211}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   362     0    0    11    0    0    32     8     5    1     64
1     0  1269    0    17    0    0     0    28    13    0      5
2     5     2  111     3   73    4     5    13    30   57      9
3     2     3    0  8240    0    8     1    80   106    0      0
4     2     1    3     1  219    0     4     7    66    9    227
5     3     0    2    62    1  395     1     0     7   49      1
6     7     0    0     9    1    0  1859     2    12    1     17
7     0    34    0   593    1    1     1  6495   128    0     12
8     1     0    0   187    1    0     2    47  3025    0     33
9    11     0   40    18    7  121    10     7    16  258      5
10    8     1    0    11   11    0    12    24    60    2  12667
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6551459, 'precision': 0.62016237, 'recall': 0.5571797, 'specificity': 0.9655548, 'f1': 0.5225196, 'auroc': 0.8342775}
confusion matrix:
      0     1   2    3   4    5     6    7     8    9     10
0   1038     0   0   29   0    1    62    6    18    2    14
1      0  1230   0   44   1    3     3  155    27    0    36
2     24     0   7   21  97   25     7   12   487   61   274
3      0     0   0    0   0    0     0    0     0    0     0
4      0     0   0    0  68    0     1    0    34    0  1530
5     24     0   0  107   0  398     2    0    16   41     4
6      0     2   0    9   0    0  2654    2   209    0   191
7      2     1   0  308   0    1     5  837     6    0     4
8      0     0   0   82   0    1     2    1  1282    0     2
9     41     4   5  137  25  267     6   23   388  207    34
10     0     0   0    0   2    0     0    1     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 10:03:39.715769,epoch time: 0:24:07.232395,used: 0:48:34.384212,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9432523, 'precision': 0.85797304, 'recall': 0.84122694, 'specificity': 0.9937457, 'f1': 0.847548, 'auroc': 0.9955469}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    1     9    2    1     3     5     2    5     21
1     0  1259    1    21    0    0     0    49     1    0      1
2     5     0  196     0   38    2     1     6     2   61      1
3     1     0    0  8323    1   13     0    65    33    1      0
4     9     0   29     3  340    1     0     2    20   14    121
5     1     0    1    35    0  386     0     0     5   92      1
6    68     1    0    14    1    2  1798     1     5    5     13
7     0     9    1   491    1    1     1  6731    21    0      8
8     5     0    4   324   11    2     0    84  2823    1     40
9     1     0   53    10    1   70     1     2     4  350      0
10   59     1    1     9   57    2     8    17    22    3  12615
---- Validation: 
scalar performance:
{'acc': 0.942945, 'precision': 0.85854876, 'recall': 0.8405049, 'specificity': 0.9936974, 'f1': 0.84734416, 'auroc': 0.99574935}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    1     6    1    0     1     2     3    6     18
1     0  1250    0    22    0    0     0    57     1    0      2
2     4     2  193     1   40    1     1     6     5   58      1
3     1     0    0  8350    0   10     0    46    32    1      0
4     6     0   27     4  331    2     0     3    22   14    130
5     0     0    1    27    1  391     0     0     2   98      1
6    68     1    0    13    3    1  1799     3     3    4     13
7     3    10    0   505    2    1     1  6714    21    2      6
8     6     0    5   336   13    2     1    77  2808    0     48
9     3     0   51     7    4   72     0     3     4  349      0
10   47     0    1    11   59    1     8    22    22    3  12622
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6931365, 'precision': 0.652323, 'recall': 0.5791209, 'specificity': 0.9698125, 'f1': 0.58064556, 'auroc': 0.8474891}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1062     3   1   76    1    0     0   14     1   11     1
1      0  1130   0   46    0    0     0  316     1    0     6
2     19     6  85   70  226    7     1   79   317   99   106
3      0     0   0    0    0    0     0    0     0    0     0
4      3     3   1    0  371    0     3    4    17    1  1230
5      5     0   0  175    1  303     0    0     8  100     0
6     35     3   0   73    2    0  2907    9    15    0    23
7      2     2   0  171    0    0     0  986     0    0     3
8      1     1   1  256    1    0     1   19  1088    1     1
9     17    16  86  274   17  110     2  106   146  357     6
10     0     0   0    0   25    0     1    2     0    0  1618
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 10:27:18.608923,epoch time: 0:23:38.893154,used: 1:12:13.277366,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95061004, 'precision': 0.8868619, 'recall': 0.83744955, 'specificity': 0.99449766, 'f1': 0.8558666, 'auroc': 0.99626625}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    0     5    0    1     8     8     6    8     36
1     0  1257    0     8    0    0     0    63     4    0      0
2     0     0  203     0   23    4     0    12     6   61      3
3     0     1    1  8106    0   19     0   277    36    0      0
4     2     1   44     0  250    3     2    10    31   14    181
5     0     0    1    26    0  446     0     1     3   43      1
6     5     2    0     3    0    2  1857     7     5   12     15
7     1     6    0    97    1    1     1  7140    11    0      4
8     1     0    3   219    1    1     1   168  2856    4     40
9     0     0   33     3    0  113     0     7     4  331      2
10   14     0    0     8   17    2    13    34    28    4  12673
---- Validation: 
scalar performance:
{'acc': 0.9510766, 'precision': 0.8864956, 'recall': 0.838843, 'specificity': 0.9945622, 'f1': 0.8562573, 'auroc': 0.99645245}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     2    1    1     7    10     5   10     28
1     0  1257    0     8    0    0     0    63     2    0      2
2     1     0  205     0   18    3     0    14     3   64      4
3     0     1    1  8109    0   16     0   283    29    1      0
4     4     1   39     0  256    3     2    14    26   14    180
5     0     0    1    23    0  447     0     0     2   47      1
6     6     0    0     3    0    1  1859    12     4    9     14
7     0     5    0   100    1    0     1  7139    15    0      4
8     2     0    5   208    1    9     0   185  2861    1     24
9     0     0   37     4    0  122     0     4     3  320      3
10   13     0    2     6   16    3     6    40    25    1  12684
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6727069, 'precision': 0.643664, 'recall': 0.5846804, 'specificity': 0.9675356, 'f1': 0.5479771, 'auroc': 0.8404664}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   965    1    1   37    0   18    25    34     3   81     5
1     0  970    0   36    0    1     0   480     4    0     8
2     2    0  103   20   91   80     0   109   368   98   144
3     0    0    0    0    0    0     0     0     0    0     0
4     1    0    1    0  152    0     1     4    30    2  1442
5     2    0    0   49    1  517     0     0     2   21     0
6     1    0    0   35    3    0  2811    15   119    1    82
7     1    0    0   62    0    1     0  1097     0    1     2
8     0    0    0  260    0   18     0    23  1066    1     2
9     2    1   36  109    1  430     0   108   137  293    20
10    0    0    0    0    4    0     0     1     0    0  1641
better model found
persisted
after epoch: 4,now: 2024-08-04 10:50:30.140322,epoch time: 0:23:11.531399,used: 1:35:24.808765,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9591181, 'precision': 0.88117296, 'recall': 0.8826691, 'specificity': 0.9956209, 'f1': 0.8803106, 'auroc': 0.99749273}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    1     7    2    0     8     0     3    0      6
1     0  1288    0    10    0    0     0    30     3    0      0
2     3     0  242     2   30    0     1     2     2   30      0
3     0     0    0  8289    0    4     2    72    68    1      0
4     7     1   37     1  356    2     0     4    21    9    101
5     1     0    0    32    0  407     0     0     3   77      1
6    20     0    1     3    1    0  1866     2     4    1     10
7     0    10    3   271    2    0     2  6936    35    0      4
8     2     0    7   105    4    1     1    67  3097    0     11
9     2     0   56     3    1   57     0     3     4  367      0
10   96     0    2     8   63    0     8    14    57    3  12544
---- Validation: 
scalar performance:
{'acc': 0.9583255, 'precision': 0.88110036, 'recall': 0.8788914, 'specificity': 0.9955466, 'f1': 0.87853116, 'auroc': 0.9975229}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     8    1    0     5     1     3    2      5
1     0  1283    0     9    0    0     1    35     4    0      0
2     3     0  236     1   32    1     1     2     4   32      0
3     2     2    1  8303    0    3     4    64    61    0      0
4     6     1   33     1  360    0     0     2    29    6    101
5     1     0    1    39    0  397     0     0     6   76      1
6    18     0    0     4    2    0  1869     2     6    3      4
7     0    16    1   251    2    0     2  6949    39    0      5
8     1     1    4   119    4    2     2    64  3090    0      9
9     4     0   62    10    1   43     0     2     9  362      0
10   83     1    1     9   76    0    13    17    72    4  12520
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7115371, 'precision': 0.65379715, 'recall': 0.5973064, 'specificity': 0.97144234, 'f1': 0.58829117, 'auroc': 0.85239315}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1118     1    1   21    0    1     0    12     9    7     0
1      0  1221    0   37    0    0     1   230     3    0     7
2     45     0  118   38  173    8     4    56   403   83    87
3      0     0    0    0    0    0     0     0     0    0     0
4      4     1    3    0  321    0     3     2    35    1  1263
5     23     0    0  203    1  288     1     0     7   69     0
6     29     0    0   42    2    0  2898     3    32    0    61
7      9     2    0   83    0    0     3  1064     0    0     3
8      1     0    0  167    0    0     4     7  1189    2     0
9     39     4  131  234   12  136     3    62   179  322    15
10     0     0    0    0   14    0     0     1     0    0  1631
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 11:13:48.435682,epoch time: 0:23:18.295360,used: 1:58:43.104125,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9619542, 'precision': 0.9051973, 'recall': 0.8579491, 'specificity': 0.9957793, 'f1': 0.87416667, 'auroc': 0.99755704}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     4    0    0     4     3     2    8     36
1     0  1276    0    15    0    0     0    33     5    0      3
2     1     0  184     0   39    0     0     0     1   83      4
3     0     1    0  8242    0   28     0    96    64    3      1
4     4     0   14     0  289    0     1     1    21   15    194
5     0     0    0    12    0  385     0     0     4  119      1
6    16     0    0     6    2    1  1849     6     3    3     22
7     0    13    1   134    1    0     1  7030    69    6      8
8     1     0    3    85    5    8     0    50  3099    3     41
9     0     0   13     4    2   36     0     1     1  435      1
10    8     0    0    10    6    0     3     8    19    2  12739
---- Validation: 
scalar performance:
{'acc': 0.9614284, 'precision': 0.9084668, 'recall': 0.859581, 'specificity': 0.99571466, 'f1': 0.87619156, 'auroc': 0.9975526}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    0     6    0    0     3     2     1    6     38
1     0  1273    0    14    0    0     0    33    10    0      2
2     1     0  190     0   31    2     0     3     4   77      4
3     0     2    0  8237    0   32     0    94    73    2      0
4     4     0    9     1  297    0     0     2    18   15    193
5     0     0    0    11    0  378     0     0     3  128      1
6     8     0    0     8    2    0  1850     2     0    6     32
7     2    14    0   136    1    0     1  7010    78    4     19
8     1     1    0    88    2   11     0    43  3103   12     35
9     0     0   15     3    2   35     0     0     1  435      2
10    8     0    0     6    9    0     2     5    19    4  12743
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6967047, 'precision': 0.6453216, 'recall': 0.6033663, 'specificity': 0.96950436, 'f1': 0.5837376, 'auroc': 0.8478463}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1086     1   0   22    1    0     1     3     8   39     9
1      1  1272   1   36    0    3     0   157     9    5    15
2      6     1  68    4  175    7     0    14   295  158   287
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  111    0     1     0    16    1  1504
5      4     0   0   29    1  281     0     0     4  271     2
6     16     0   0   12    3    0  2479     2    73    1   481
7      3     1   0  126    0    0     3  1019     4    5     3
8      0     0   0   83    0    8     1     0  1268    6     4
9     10     3  65   56   11   96     0    24   111  732    29
10     0     0   0    0    3    0     0     1     0    0  1642
better model found
persisted
after epoch: 6,now: 2024-08-04 11:37:02.621283,epoch time: 0:23:14.185601,used: 2:21:57.289726,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9618472, 'precision': 0.91413784, 'recall': 0.8484714, 'specificity': 0.9957073, 'f1': 0.8747922, 'auroc': 0.9975278}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    1     7    0    1    12    10     0    1     21
1     0  1285    0     6    0    0     0    38     3    0      0
2     1     0  222     1   28    1     0    10    12   33      4
3     0     0    0  8251    0    1     0   155    32    0      0
4     6     1   26     2  258    0     9    10    24    7    196
5     2     0    2    72    0  371     1     0    12   60      1
6     6     2    0     2    0    0  1875     5     3    2     11
7     0     6    0    76    1    0     1  7166     9    0      4
8     2     0    1   144    0    0     0   112  3015    1     19
9     1     0   36    19    2   59     0     7    15  354      0
10    5     1    2     7    2    0     8    23    22    1  12723
---- Validation: 
scalar performance:
{'acc': 0.9600642, 'precision': 0.91026115, 'recall': 0.8439097, 'specificity': 0.99550736, 'f1': 0.87044466, 'auroc': 0.9973632}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     8    0    0    17     7     0    1     20
1     0  1282    0     7    0    0     0    42     1    0      0
2     2     0  212     3   30    2     2    13    11   33      4
3     0     1    0  8242    0    0     0   169    28    0      0
4     4     1   29     1  249    1     7     5    34    7    201
5     2     0    1    73    0  376     0     0    11   57      1
6     4     0    0     4    0    0  1880     6     3    2      9
7     0     9    0    85    1    0     1  7155     8    0      6
8     1     0    1   143    2    1     1   122  3003    0     22
9     2     1   44    18    3   48     2     7    13  353      2
10    9     1    2     9    3    1     9    21    31    0  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6761352, 'precision': 0.65609545, 'recall': 0.550855, 'specificity': 0.967822, 'f1': 0.52109355, 'auroc': 0.842751}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1021     1   0   20   0    1    19    69    28    6     5
1      0  1195   0   37   0    0     5   254     1    0     7
2     26     2  12   63  33    9    74    81   437   64   214
3      0     0   0    0   0    0     0     0     0    0     0
4      1     0   0    0  70    0    13     4    24    1  1520
5     14     0   0  298   0  226     6     0     9   37     2
6      2     0   0    5   0    0  3040     3     6    0    11
7      1     0   0   52   0    0     2  1105     0    0     4
8      0     0   0  167   0    0     8    18  1175    0     2
9     29     4   6  379   0  128    20   122   240  181    28
10     0     0   0    0   2    0     4     1     0    0  1639
early stop counter: 1
val acc:0.960064172744751, best validation acc: 0.9614284038543701, corresponding to test acc:                         0.6967046856880188 / 0.7115371227264404
after epoch: 7,now: 2024-08-04 12:00:16.385534,epoch time: 0:23:13.764251,used: 2:45:11.053977,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9661815, 'precision': 0.9029652, 'recall': 0.88806, 'specificity': 0.99629694, 'f1': 0.8940706, 'auroc': 0.99846}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     4    2    0     1     2     4    6     22
1     0  1297    0     4    1    0     0    27     2    0      0
2     0     0  218     1   42    0     0     1     2   48      0
3     1     2    0  8154    1   56     0   146    77    3      0
4     1     0   16     0  358    1     0     1     7    2    153
5     0     0    0     9    0  470     0     0     1   40      1
6    18     2    1     6    2    0  1861     5     2    2      9
7     1    10    0   113    2    0     1  7098    30    1      7
8     1     1    6    50   21   10     2    44  3108    3     49
9     0     0   28     1    6   84     0     0     1  373      0
10    7     0    2     6   20    0     5    10     6    2  12733
---- Validation: 
scalar performance:
{'acc': 0.9669921, 'precision': 0.9050138, 'recall': 0.89174706, 'specificity': 0.99638486, 'f1': 0.89724493, 'auroc': 0.9984382}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     2    5    0     1     2     2    4     24
1     0  1298    0     2    0    0     0    27     5    0      0
2     1     0  219     0   42    1     0     1     1   46      1
3     0     1    0  8168    1   49     0   130    89    2      0
4     2     0   14     0  369    0     1     2     3    6    142
5     1     0    0     7    0  468     0     0     3   41      1
6    20     0    1     4    5    0  1851     5     3    3     16
7     0    15    1    87    2    0     1  7124    30    0      5
8     0     2    7    45   18    7     0    52  3101    3     61
9     0     0   24     1    5   77     0     1     0  384      1
10   10     0    3     7   23    1     4    14     6    2  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72133213, 'precision': 0.63864005, 'recall': 0.6209005, 'specificity': 0.9721587, 'f1': 0.5888524, 'auroc': 0.8566095}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1041     3   0  34    3    6    11    12    19   39     2
1      0  1195   1  36    2    2     2   242    11    2     6
2      3     0  96   7  351   39     1    22   308   70   118
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0  170    0     3     0    16    2  1441
5      3     0   0  54    1  502     0     0     4   26     2
6      4     0   0   8    2    0  3021     3     7    0    22
7      0     0   0  91    0    1     0  1064     6    1     1
8      0     0   0  90    0    8     2     0  1266    1     3
9      5     4  77  82   23  360     0    28   226  314    18
10     0     0   0   0    1    0     3     1     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-04 12:23:29.794325,epoch time: 0:23:13.408791,used: 3:08:24.462768,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9684022, 'precision': 0.90011036, 'recall': 0.9094666, 'specificity': 0.9967191, 'f1': 0.9019285, 'auroc': 0.9987722}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    3     1    0    0     1     8     6    3     12
1     0  1308    0     5    1    0     0    14     4    0      0
2     0     0  254     0   29    1     0     6     4   18      0
3     0     1    0  8148    1    5     0   202    81    1      0
4     4     1   21     0  466    1     0     2    11    1     32
5     0     0    1    17    0  471     0     0     3   28      1
6     7     2    1     3    4    0  1866     6     4    1     14
7     0    12    0    39    1    0     1  7175    31    0      3
8     0     1    6    38   13    2     0    51  3178    0      4
9     0     0   73     2    5   94     0     5     3  311      0
10   14     0    1     5  140    1     4    24    35    1  12569
---- Validation: 
scalar performance:
{'acc': 0.96739334, 'precision': 0.89767003, 'recall': 0.90256715, 'specificity': 0.996599, 'f1': 0.89765656, 'auroc': 0.99882716}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    4     3    1    0     0     4     5    2     20
1     0  1297    0     3    0    0     0    29     3    0      0
2     0     0  246     0   33    1     1     6     2   23      0
3     0     1    0  8149    0    3     0   201    86    0      0
4     5     1   21     0  464    0     0     3    10    2     33
5     0     0    3    23    0  460     0     1     4   30      0
6     7     1    1     1    4    0  1866     6     5    3     14
7     0    14    0    46    1    0     1  7161    38    0      4
8     0     0    4    35   11    1     0    45  3190    0     10
9     0     0   65     2    3  108     0     2     6  307      0
10   10     0    5     7  130    0     4    19    38    1  12582
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7283285, 'precision': 0.64597917, 'recall': 0.6155518, 'specificity': 0.9729188, 'f1': 0.601616, 'auroc': 0.8611045}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1069     2    0   24    1    0    14    18     5   32     5
1      0  1243    0   33    0    0     1   213     5    0     4
2      2     2  114   12  406   16     9    56   292   42    64
3      0     0    0    0    0    0     0     0     0    0     0
4      0     1    1    0  404    0     1     2    15    1  1208
5      2     0    1  125    6  379     0     0     8   69     2
6      0     0    0    2    1    0  3003     3     7    0    51
7      0     0    0   58    0    0     0  1101     4    0     1
8      0     0    0  142    2    0     2     3  1216    2     3
9      6     4  139  142   55  220     4   118   176  268     5
10     0     0    0    0   30    0     1     1     1    0  1613
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 12:46:55.789888,epoch time: 0:23:25.995563,used: 3:31:50.458331,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9733519, 'precision': 0.9165231, 'recall': 0.9109595, 'specificity': 0.99713945, 'f1': 0.91345304, 'auroc': 0.9989891}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    1     3    0    0     0     2     1    2     15
1     0  1301    0     7    0    0     0    17     6    0      1
2     1     1  246     1   23    2     1     2     5   30      0
3     0     0    1  8288    0   10     0    84    55    0      0
4     4     0   35     0  416    0     0     0     9    5     70
5     0     0    0    11    1  458     0     0     3   48      0
6     7     0    0     1    1    0  1872     1     2    2     22
7     1    13    1    84    1    0     1  7112    41    0      8
8     1     0    3    55    6    2     0    32  3166    2     27
9     3     0   30     0    2   78     0     1     5  374      0
10   10     0    3     8   45    1     1     9    29    0  12688
---- Validation: 
scalar performance:
{'acc': 0.9746155, 'precision': 0.922107, 'recall': 0.917984, 'specificity': 0.99727964, 'f1': 0.9198624, 'auroc': 0.9989555}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     6    0    0     4     3     0    4     10
1     0  1302    0     6    0    0     0    22     2    0      0
2     2     0  252     0   25    1     0     1     4   27      0
3     0     1    1  8301    0    6     0    75    55    1      0
4     5     0   25     0  427    0     2     1    12    5     62
5     0     0    0    13    0  469     0     0     2   36      1
6    10     0    0     2    1    0  1872     1     2    1     19
7     0    13    2    93    1    0     3  7102    43    0      8
8     1     1    3    56    8    0     0    27  3173    4     23
9     3     0   30     0    3   70     0     0     2  384      1
10   12     0    2     6   48    1     2     6    21    0  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7288183, 'precision': 0.6654041, 'recall': 0.62080497, 'specificity': 0.97294295, 'f1': 0.61554265, 'auroc': 0.86049783}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1043     0    0   35    1    3    47   14     7   13     7
1      3  1224    1   44    2    0     4  195     3    1    22
2      9     0  126   14  347   23    16   11   234   83   152
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0  404    0     1    0    17    1  1208
5      5     0    0   84    4  432     1    0     6   57     3
6      0     0    0    7    3    0  2996    0     6    0    55
7      1     0    1  202    0    0    10  940     5    1     4
8      0     0    0  122    0    2     9    3  1229    2     3
9     12     2  125  123   53  236    12   23   131  401    19
10     0     0    0    0   23    0     0    0     1    0  1622
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-04 13:10:10.059247,epoch time: 0:23:14.269359,used: 3:55:04.727690,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 3:55:04.727690 at 2024-08-04 13:10:10.059247
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7288183, 'precision': 0.6654041, 'recall': 0.62080497, 'specificity': 0.97294295, 'f1': 0.61554265, 'auroc': 0.86049783}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1043     0    0   35    1    3    47   14     7   13     7
1      3  1224    1   44    2    0     4  195     3    1    22
2      9     0  126   14  347   23    16   11   234   83   152
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0  404    0     1    0    17    1  1208
5      5     0    0   84    4  432     1    0     6   57     3
6      0     0    0    7    3    0  2996    0     6    0    55
7      1     0    1  202    0    0    10  940     5    1     4
8      0     0    0  122    0    2     9    3  1229    2     3
9     12     2  125  123   53  236    12   23   131  401    19
10     0     0    0    0   23    0     0    0     1    0  1622
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7288183, 'precision': 0.6654041, 'recall': 0.62080497, 'specificity': 0.97294295, 'f1': 0.61554265, 'auroc': 0.86049783}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1043     0    0   35    1    3    47   14     7   13     7
1      3  1224    1   44    2    0     4  195     3    1    22
2      9     0  126   14  347   23    16   11   234   83   152
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0  404    0     1    0    17    1  1208
5      5     0    0   84    4  432     1    0     6   57     3
6      0     0    0    7    3    0  2996    0     6    0    55
7      1     0    1  202    0    0    10  940     5    1     4
8      0     0    0  122    0    2     9    3  1229    2     3
9     12     2  125  123   53  236    12   23   131  401    19
10     0     0    0    0   23    0     0    0     1    0  1622
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_15_04_seed_1_24051370_instance_wise_predictions.txt
accuracy from prediction file 0.7288183026656405
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2658 MiB |  16861 MiB |    853 TiB |    853 TiB |
|       from large pool |   2644 MiB |  16829 MiB |    847 TiB |    847 TiB |
|       from small pool |     14 MiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   2658 MiB |  16861 MiB |    853 TiB |    853 TiB |
|       from large pool |   2644 MiB |  16829 MiB |    847 TiB |    847 TiB |
|       from small pool |     14 MiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2655 MiB |  16818 MiB |    851 TiB |    851 TiB |
|       from large pool |   2641 MiB |  16785 MiB |    845 TiB |    845 TiB |
|       from small pool |     13 MiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17688 MiB |  17688 MiB |  32360 MiB |  14672 MiB |
|       from large pool |  17652 MiB |  17652 MiB |  32322 MiB |  14670 MiB |
|       from small pool |     36 MiB |     36 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 345701 KiB |    776 MiB | 118664 GiB | 118664 GiB |
|       from large pool | 325312 KiB |    774 MiB | 112506 GiB | 112506 GiB |
|       from small pool |  20389 KiB |     28 MiB |   6158 GiB |   6158 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3082    |    4805    |   62452 K  |   62449 K  |
|       from large pool |     349    |     697    |   26844 K  |   26843 K  |
|       from small pool |    2733    |    4255    |   35608 K  |   35605 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3082    |    4805    |   62452 K  |   62449 K  |
|       from large pool |     349    |     697    |   26844 K  |   26843 K  |
|       from small pool |    2733    |    4255    |   35608 K  |   35605 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     509    |     509    |     866    |     357    |
|       from large pool |     491    |     491    |     847    |     356    |
|       from small pool |      18    |      18    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     169    |    1227    |   34669 K  |   34669 K  |
|       from large pool |     132    |     339    |   18472 K  |   18472 K  |
|       from small pool |      37    |    1094    |   16196 K  |   16196 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  16861 MiB |    853 TiB |    853 TiB |
|       from large pool |  65536 KiB |  16829 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  16861 MiB |    853 TiB |    853 TiB |
|       from large pool |  65536 KiB |  16829 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  16818 MiB |    851 TiB |    851 TiB |
|       from large pool |  65536 KiB |  16785 MiB |    845 TiB |    845 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2996 MiB |  17688 MiB |  32360 MiB |  29364 MiB |
|       from large pool |   2962 MiB |  17652 MiB |  32322 MiB |  29360 MiB |
|       from small pool |     34 MiB |     36 MiB |     38 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  43008 KiB |    776 MiB | 118666 GiB | 118666 GiB |
|       from large pool |  43008 KiB |    774 MiB | 112508 GiB | 112508 GiB |
|       from small pool |      0 KiB |     28 MiB |   6158 GiB |   6158 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   62452 K  |   62452 K  |
|       from large pool |       2    |     697    |   26844 K  |   26844 K  |
|       from small pool |       0    |    4255    |   35608 K  |   35608 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   62452 K  |   62452 K  |
|       from large pool |       2    |     697    |   26844 K  |   26844 K  |
|       from small pool |       0    |    4255    |   35608 K  |   35608 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     151    |     509    |     866    |     715    |
|       from large pool |     134    |     491    |     847    |     713    |
|       from small pool |      17    |      18    |      19    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1227    |   34670 K  |   34670 K  |
|       from large pool |       1    |     339    |   18473 K  |   18473 K  |
|       from small pool |       0    |    1094    |   16197 K  |   16197 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 13:14:55 2024]
Finished job 0.
1 of 1 steps (100%) done
