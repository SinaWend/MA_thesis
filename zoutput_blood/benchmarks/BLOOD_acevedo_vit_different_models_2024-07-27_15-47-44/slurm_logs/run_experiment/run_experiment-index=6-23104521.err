Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 03:27:12 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521

 Experiment start at: 2024-07-28 03:34:15.600356
before training, model accuracy: 0.13810956478118896
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.877622, 'precision': 0.62767744, 'recall': 0.59529775, 'specificity': 0.9861054, 'f1': 0.5826652, 'auroc': 0.9650485}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   22     0   0     3   0   38   215    28     8   21    148
1    0  1169   0    10   0    0     7   133     4    0      9
2    0     1   0    11   0    4     8    56    20   95    117
3    0     0   0  6910   0   58    14  1172   270    9      3
4    0     0   0     7   0    1    19    16    29   27    440
5    0     0   0    23   0  178     2     1    12  303      1
6    2     0   0     1   0    5  1827    12     8    4     49
7    4    11   0    45   0    1     6  7123    27    0     47
8    5     0   0    42   0    2    21   336  2578    7    304
9    0     0   0     5   0   50     3    27    22  373     13
10   5     3   0     4   0    2   123    20    10    5  12622
---- Validation: 
scalar performance:
{'acc': 0.8776782, 'precision': 0.60904586, 'recall': 0.590622, 'specificity': 0.98609215, 'f1': 0.5780959, 'auroc': 0.9648715}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   15     0   0     7   0   32   215    25    10   23    156
1    2  1162   0     6   0    1    11   135     5    0     10
2    0     1   0    17   0    7     8    55    29   90    105
3    0     0   0  6994   0   59    19  1102   250   13      3
4    2     0   0     3   0    3    22    18    24   16    451
5    0     0   0    22   0  177     3     1    13  304      1
6    3     0   0     2   0    5  1814    13     5    5     61
7    7    10   0    45   0    2     5  7112    26    2     56
8    6     0   0    54   0    1    27   335  2553   13    307
9    1     0   0     6   0   58     2    25    20  362     19
10   2     2   0     6   0    1   117    25    14    6  12623
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6119079, 'precision': 0.44839144, 'recall': 0.4713908, 'specificity': 0.9595761, 'f1': 0.4069574, 'auroc': 0.83137923}
confusion matrix:
    0     1   2   3   4   5     6     7     8    9     10
0   23     0   0   3   0  59   686   268    23   57    51
1    2  1170   0   6   0  13    36   246     5    3    18
2    6     1   0  22   0  11   264    79   129   67   436
3    0     0   0   0   0   0     0     0     0    0     0
4    0     1   0   0   0   0   147     1     3    0  1481
5    0     0   0   5   0  89    22     7    27  441     1
6    1     2   0   0   0   0  3037     6     1    0    20
7    0     0   0   0   0   0     2  1157     0    1     4
8    0     0   0   7   0   0    33    71  1201   15    43
9    2     1   0  33   0  47    71   195   280  430    78
10   0     0   0   0   0   0     7     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 04:26:35.701998,epoch time: 0:52:20.101642,used: 0:52:20.101642,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.914223, 'precision': 0.72265726, 'recall': 0.6668331, 'specificity': 0.9900502, 'f1': 0.67165637, 'auroc': 0.980593}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   262     0   0     3   0    1    21    12    10    6    168
1     0  1266   0     9   0    2     3    39     4    2      7
2     1     4   0    78   7    1     9    20     5   78    109
3     0     2   0  8054   1   12     8   258    94    8      1
4     1     0   0    16   4    7    21     4    13    4    469
5     0     0   0    65   0  232     0     1     4  217      2
6     4     1   0     1   0    0  1838    12     3    2     47
7     0   308   0   176   0    1     4  6657    42    1     72
8     0     1   0   193   0    1    12   130  2783    0    175
9     0     1   0    21   1   79     0    12     7  353     19
10    3     3   0     7   0    1    37     8    13    1  12721
---- Validation: 
scalar performance:
{'acc': 0.91459143, 'precision': 0.72112536, 'recall': 0.66447073, 'specificity': 0.9900861, 'f1': 0.6694257, 'auroc': 0.9803096}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   261     0   0     3   0    0    19    15     8    7    170
1     0  1266   0     9   0    3     3    38     3    2      8
2     2     4   0    76   8    3    12    19     4   80    104
3     0     2   0  8063   0   10     5   263    89    7      1
4     1     1   0    19   4    5    18     3     9    6    473
5     0     0   0    66   0  229     0     0     5  219      2
6     8     0   0     2   0    0  1844     6     7    1     40
7     0   299   0   176   0    0     4  6664    41    2     79
8     3     0   0   203   0    1     9   126  2787    0    167
9     1     1   0    27   0   83     2    11     6  341     21
10    5     4   0     8   0    2    30     6     7    1  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6755055, 'precision': 0.5393627, 'recall': 0.55456716, 'specificity': 0.96681035, 'f1': 0.52263814, 'auroc': 0.8605628}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   674     2   0    3   0    0   206    80    86   18   101
1     0  1339   0   14   0   16     8    86     0   12    24
2    13     4   0   37   5    5   122    80    72   35   642
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    0   0    0     7     1     4    0  1620
5    16     0   0   25   0  255    23     5    18  245     5
6     0     2   0    4   0    0  2970     5     4    0    82
7     0     9   0    3   0    0     2  1146     0    1     3
8     0     0   0   62   0    3    20    35  1220    4    26
9    44    13   0  104   2   67    50   226   107  407   117
10    0     0   0    0   0    0     2     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 05:16:32.715893,epoch time: 0:49:57.013895,used: 1:42:17.115537,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9273063, 'precision': 0.77522475, 'recall': 0.6897212, 'specificity': 0.9918945, 'f1': 0.69136465, 'auroc': 0.9872834}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   287     0   0     3   0    0    12    27    32    8    114
1     0  1244   0    16   0    0     0    58     7    0      7
2     0     0   0   139  13    0    12    20     6  102     19
3     0     0   0  7898   0   23     0   207   303    4      2
4     2     0   0    59  32    3   123     4    18    8    290
5     2     0   0    27   0  176     0     1     8  306      1
6     3     0   0     1   0    1  1855    11     6    3     27
7     0    10   0   164   0    0     3  6956    90    2     38
8     1     0   0    55   0    2     1    84  3077    3     72
9     0     1   0    22   0   22     1     7     7  428      5
10    4     0   0    12   1    0    21    17    32    2  12706
---- Validation: 
scalar performance:
{'acc': 0.927725, 'precision': 0.7712429, 'recall': 0.6937579, 'specificity': 0.99193805, 'f1': 0.695077, 'auroc': 0.98631847}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   310     0   0     3   0    0     7    20    26    6    111
1     0  1248   0    15   0    1     1    53     9    0      5
2     2     2   0   151  17    0    13    20     2   89     16
3     0     0   0  7910   0   22     0   208   293    7      0
4     1     0   0    62  36    1   117     3    16   11    292
5     2     0   0    27   0  174     0     0     8  308      2
6     6     0   0     7   0    0  1860     6     6    1     22
7     0    14   0   155   0    1     4  6961    83    4     43
8     1     0   0    58   0    1     4    92  3063    2     75
9     1     0   0    31   0   21     1     4     8  424      3
10    6     1   0    10   2    0    23    17    37    3  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6676695, 'precision': 0.5367496, 'recall': 0.53578067, 'specificity': 0.96648, 'f1': 0.4999373, 'auroc': 0.86466765}
confusion matrix:
     0     1   2    3   4   5     6     7     8    9     10
0   732     0   0    4   0   1    52   198   120    9    54
1     0  1283   0   41   0  13     9   126     4    1    22
2     8     1   0  205  32   1   126    57   127   63   395
3     0     0   0    0   0   0     0     0     0    0     0
4     1     1   0    3   1   0    39     0     6    0  1582
5     3     0   0   36   0  88    12     4    23  420     6
6     0     0   0    0   0   0  2915     2    18    0   132
7     0     0   0   28   0   0     5  1124     0    1     6
8     0     0   0   32   0   2     7     4  1310    4    11
9    18     3   0  238   4  19    22   155   187  444    47
10    0     0   0    0   0   0     0     0     0    0  1646
better model found
persisted
after epoch: 3,now: 2024-07-28 06:06:24.304698,epoch time: 0:49:51.588805,used: 2:32:08.704342,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93383455, 'precision': 0.7766141, 'recall': 0.71824336, 'specificity': 0.9926702, 'f1': 0.72413754, 'auroc': 0.9902029}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   334     0   0     2   0    0    11    25    25    1     85
1     0  1290   0     9   0    0     0    29     3    0      1
2     0     2   0   148  14    1    21    29     2   84     11
3     0     2   0  8077   0    8     0   257    95    1      0
4     1     0   0    60  33    1   231    12    11    5    185
5     2     0   0    41   0  331     1     2     5  134      5
6     2     1   0     6   0    1  1870     4     5    0     19
7     0    26   0   112   2    0     3  7088    23    1      9
8     2     1   0   113   2    1    10   225  2898    1     42
9     1     0   0    23   0   59     3    20     5  377      4
10   11     1   0    24   6    1    97    21    24    0  12605
---- Validation: 
scalar performance:
{'acc': 0.9344122, 'precision': 0.8712937, 'recall': 0.72190213, 'specificity': 0.99275696, 'f1': 0.7272766, 'auroc': 0.9902126}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   329     0   0     3   0    0    18    21    33    1     78
1     0  1287   0     5   0    0     1    32     7    0      0
2     1     3   1   139  16    2    14    41     0   80     15
3     1     4   0  8092   0    9     0   237    94    3      0
4     2     0   0    47  39    0   227    14    10    8    192
5     2     0   0    36   0  339     3     3     7  129      2
6     6     0   0     5   0    0  1870     5     4    1     17
7     0    31   0   113   0    0     5  7074    29    4      9
8     1     0   0   115   0    2     7   209  2918    1     43
9     1     0   0    24   0   56     3    12     5  387      5
10   11     0   0    14   7    0   113    25    29    0  12597
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.676415, 'precision': 0.5556878, 'recall': 0.55086446, 'specificity': 0.9668676, 'f1': 0.519235, 'auroc': 0.88195896}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   504     1   0   15   0    1    47   240   318    5    39
1     1  1324   0   19   0    4    11   123     6    3     8
2     5     2   0  267  33    3   339   111   114   65    76
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0   10   6    0   364     0     9    0  1243
5     1     3   0   52   0  245    17    10    15  247     2
6     0     0   0    5   0    0  3058     1     3    0     0
7     0     0   0   43   0    1     5  1089    20    2     4
8     0     0   0   50   0    0    10     5  1301    3     1
9     2    19   0  142   3   62    42   200   111  533    23
10    0     0   0    0   0    0    38     0     0    0  1608
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 06:56:16.031291,epoch time: 0:49:51.726593,used: 3:22:00.430935,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93907857, 'precision': 0.91704154, 'recall': 0.7223148, 'specificity': 0.99304235, 'f1': 0.7400452, 'auroc': 0.9860833}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   319     1   0     9   0    0     8    23    27    2     94
1     0  1251   0    11   0    0     1    61     5    0      2
2     0     0   1   145   5    1     1    70    17   60     12
3     0     0   0  8237   0    3     0   124    74    0      0
4     1     0   0   106  48    1    43    16    41    2    281
5     0     0   0    72   0  321     0     0     8  118      1
6     2     0   0     4   0    1  1856     2     8    0     34
7     1     4   0   203   0    0     1  6992    56    2      4
8     0     0   0   130   0    0     1    74  3075    1     14
9     0     1   0    20   0   35     1    21    16  397      2
10    5     0   0    14   2    0    29    26   116    1  12602
---- Validation: 
scalar performance:
{'acc': 0.93954796, 'precision': 0.8298885, 'recall': 0.7195177, 'specificity': 0.99310935, 'f1': 0.73727286, 'auroc': 0.9862762}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   324     0   0     8   0    0     6    21    21    2    101
1     0  1252   0    10   0    0     0    64     5    0      1
2     1     1   0   135   2    1     1    68    28   67      8
3     0     0   0  8242   0    4     0   124    70    0      0
4     0     0   0   104  54    0    31    24    45    1    280
5     0     0   0    77   0  304     0     0     6  133      1
6     3     0   0     8   0    1  1859     4     6    1     26
7     0     6   0   187   0    0     1  7013    54    0      4
8     0     0   0   117   0    0     0    81  3085    1     12
9     0     1   0    26   0   47     0    18    14  386      1
10    5     0   0    15   0    0    20    31   118    1  12606
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65521586, 'precision': 0.5546075, 'recall': 0.52682817, 'specificity': 0.9657059, 'f1': 0.4986806, 'auroc': 0.8579178}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   627     2   0   33   0    0    40   145   249    6    68
1     0  1159   0   30   0    0     5   290     4    0    11
2     2     0   0  289   7    0    44    82   331   34   226
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    8   1    0    31     2    28    0  1562
5     0     0   0  201   0  194     3     3    18  172     1
6     0     0   0   26   0    0  3033     1     6    0     1
7     0     0   0   15   0    0     1  1145     0    0     3
8     0     0   0  106   0    0     2     6  1255    1     0
9     4    10   1  306   2   49     0   108   324  308    25
10    0     0   0    0   0    0     1     1     1    0  1643
better model found
persisted
after epoch: 5,now: 2024-07-28 07:46:36.159583,epoch time: 0:50:20.128292,used: 4:12:20.559227,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.942744, 'precision': 0.80003554, 'recall': 0.7320164, 'specificity': 0.99347126, 'f1': 0.7323341, 'auroc': 0.9929761}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   325     0   0     3   0    1     9    10     5    3    127
1     0  1296   0     7   0    0     0    22     5    0      1
2     1     2   0   162   4    3     6    27     2   85     20
3     0     6   0  8139   0   26     2   160   106    1      0
4     2     0   0    69  11    2   116     6     9    6    318
5     0     0   0    15   0  402     0     0     2   99      3
6     3     0   0     4   0    1  1868     1     2    0     29
7     0    21   0    93   0    0     1  7093    41    3     10
8     2     1   0    58   0    3    28   132  3018    7     46
9     0     0   0    16   0   75     2     2     6  387      5
10    6     0   0    12   0    1    50    11    15    0  12697
---- Validation: 
scalar performance:
{'acc': 0.9419553, 'precision': 0.7786704, 'recall': 0.7283298, 'specificity': 0.9934145, 'f1': 0.72731996, 'auroc': 0.99309343}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   324     0   0     3   0    0    11    11     1    1    132
1     0  1297   0    10   0    0     0    19     4    1      1
2     0     3   0   157   5    3     7    27     3   89     18
3     0     5   0  8118   0   33     3   174   104    3      0
4     0     0   0    67   7    3   148     6     6    4    298
5     0     0   0    13   0  383     0     0     3  121      1
6     3     0   0     4   0    1  1876     0     1    0     23
7     0    25   0    98   1    0     5  7085    38    1     12
8     1     1   0    68   0    5    17   126  3027    4     47
9     1     2   0    15   0   70     0     7     3  388      7
10    8     1   0    13   0    0    40     8    15    1  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.698034, 'precision': 0.5643998, 'recall': 0.59062207, 'specificity': 0.96944916, 'f1': 0.5604958, 'auroc': 0.8747959}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   841     3   0    9   0    6    40    58    60   11   142
1     0  1288   0   32   0    7     7   148     0    2    15
2     5     6   0  282   3   17   293    78   124   53   154
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    8   0    0   178     1    10    0  1435
5     1     0   0   52   0  431     5     1     9   93     0
6     0     0   0   17   0    0  3045     1     2    0     2
7     0     0   0   76   0    1     3  1079     1    0     4
8     0     0   0  126   0    3    19    17  1200    4     1
9     5    16   0  209   3  176    21    97   125  454    31
10    0     0   0    0   0    0     7     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-28 08:37:19.891940,epoch time: 0:50:43.732357,used: 5:03:04.291584,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9419681, 'precision': 0.8192364, 'recall': 0.7158671, 'specificity': 0.9934507, 'f1': 0.72884595, 'auroc': 0.9912777}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   107     0   0     3    0    1     1   269    20    7     75
1     0  1274   0     6    0    2     0    45     3    1      1
2     0     0   0   130   13    1     0    14     5  142      6
3     0     1   0  8250    0   19     0    98    63    7      0
4     1     0   0    82  167    0    36     6    20   21    206
5     0     0   0    21    0  343     0     0     3  153      1
6     4     2   0     6    0    0  1781    23     6    7     79
7     0     6   0   104    1    1     0  7104    31    4     10
8     0     0   0   111    1    0     0   119  3023   15     27
9     0     0   0     7    0   22     0     5     1  458      0
10    2     0   0    20    6    0    10    14    37    5  12700
---- Validation: 
scalar performance:
{'acc': 0.94174135, 'precision': 0.8140129, 'recall': 0.71869653, 'specificity': 0.99341714, 'f1': 0.7324996, 'auroc': 0.99135417}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   116     1   0     2    0    0     0   262    17    9     76
1     0  1279   0     6    0    1     0    44     1    1      0
2     0     0   0   129   25    1     0    15     2  138      2
3     0     1   0  8244    0   17     0   107    66    5      0
4     0     0   0    75  177    1    30     5    23   15    213
5     0     0   0    17    0  347     0     0     1  155      1
6     8     3   0     5    1    1  1771    21     6    1     91
7     0     8   0   131    1    0     1  7085    25    3     11
8     0     0   0   102    0    1     0   122  3037   12     22
9     0     0   0    12    0   26     1     1     1  452      0
10    1     1   0    15    7    0    12    12    41    8  12699
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64206254, 'precision': 0.55533826, 'recall': 0.5276009, 'specificity': 0.964126, 'f1': 0.47379625, 'auroc': 0.8701881}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   76     2   0    9   0    1    12   956    54   33    27
1    0  1288   0   23   0    2     0   175     2    1     8
2    0     5   0  196  90    8    64    99   314  104   135
3    0     0   0    0   0    0     0     0     0    0     0
4    0     1   0    5  41    0   214     3    27    1  1341
5    0     0   0   69   0  359     0     2    11  150     1
6    0     1   0   56   1    0  2926    16    38    0    29
7    0     1   0   13   0    1     0  1146     0    0     3
8    0     0   0   97   0    2     1    15  1253    2     0
9    0     9   0  190   8  159     1   142   142  464    22
10   0     1   0    0   0    0    21     0     0    0  1624
early stop counter: 1
val acc:0.9417413473129272, best validation acc: 0.9419553279876709, corresponding to test acc:                         0.6980339884757996 / 0.6980339884757996
after epoch: 7,now: 2024-07-28 09:28:09.242331,epoch time: 0:50:49.350391,used: 5:53:53.641975,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94520545, 'precision': 0.7958778, 'recall': 0.72409475, 'specificity': 0.99385047, 'f1': 0.737688, 'auroc': 0.99558157}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   172     0   0     2    0    0     7    45     9    2    246
1     0  1292   0     2    0    0     0    34     4    0      0
2     0     3   0   116   76    0     4    24     2   80      7
3     0     2   0  8179    0   12     0   129   111    2      0
4     0     1   0    21  122    1   206     5    13    6    164
5     0     0   0    13    0  379     1     0     3  122      3
6     1     2   0     0    1    0  1865     2     3    0     34
7     0     9   0    86    1    0     1  7116    42    0      9
8     0     0   0    53    2    3     8   103  3091    4     32
9     0     3   0    20    1   44     1    10     2  408      4
10    0     0   0     8   10    0    42     5    24    0  12704
---- Validation: 
scalar performance:
{'acc': 0.9449244, 'precision': 0.8391546, 'recall': 0.72684324, 'specificity': 0.993827, 'f1': 0.7403852, 'auroc': 0.99540854}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   188     0   0     1    0    1     6    52     7    2    226
1     0  1296   0     5    0    0     0    27     4    0      0
2     0     2   1   117   77    1     3    19     1   81     10
3     0     2   0  8167    0   16     1   144   103    5      2
4     0     1   1    21  122    1   206     4    13    6    164
5     0     0   0    22    0  375     0     0     2  120      2
6     1     1   0     2    0    0  1861     3     3    1     36
7     0    12   0    91    0    0     2  7113    34    2     11
8     0     2   0    70    1    4     4    96  3089    3     27
9     0     4   0    19    3   43     0     8     4  410      2
10    2     0   0     7   10    0    39     8    26    0  12704
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6452109, 'precision': 0.5499025, 'recall': 0.52450883, 'specificity': 0.9639181, 'f1': 0.49690524, 'auroc': 0.86498576}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   321     1   0    8    0    1    51   236    34   10   508
1     0  1216   0   36    0    0     1   217    12    1    16
2     0     0   0   97  190    3   216    77   216   50   166
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0    8    0   354     2    15    0  1254
5     0     0   0   86    1  322     8     4     7  152    12
6     0     0   0    2    0    0  3049     1    10    0     5
7     0     0   0   73    0    1     0  1087     0    0     3
8     0     0   0  125    0    1     7    14  1220    2     1
9     1     9   4  304   31   95    10   175    86  376    46
10    0     0   0    0    1    0    19     1     2    0  1623
better model found
persisted
after epoch: 8,now: 2024-07-28 10:18:34.811392,epoch time: 0:50:25.569061,used: 6:44:19.211036,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9293932, 'precision': 0.7534801, 'recall': 0.66410494, 'specificity': 0.99193573, 'f1': 0.68966055, 'auroc': 0.9933218}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   180     0   0     1    0    0     4    42     2    0    254
1     0  1287   0     4    2    0     5    25     5    0      3
2     1     0   0   145  109    1    22    12     1    2     19
3     0     2   0  8231    1   11    11    74    89    6     14
4     0     0   0     6   66    0   278     1     3    0    185
5     0     1   0    20    1  306     1     3     3  175     11
6     0     0   0     0    2    0  1860     3     1    0     41
7     2    14   0   195    7    0    14  6886    68    4     72
8     0     0   0    97   21    1    35    78  2954    1    107
9     0     0   1   159   18   23     2    36     2  229     23
10    2     0   0     7    4    0    32     2    10    0  12738
---- Validation: 
scalar performance:
{'acc': 0.9288752, 'precision': 0.7555275, 'recall': 0.6648013, 'specificity': 0.99187386, 'f1': 0.69079304, 'auroc': 0.9935661}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   174     0   0     0    0    0     2    45     1    0    261
1     0  1288   0     7    3    0     6    20     3    0      5
2     1     0   0   148  111    0    19    14     1    3     15
3     0     4   0  8237    1   15    10    86    77    4      6
4     0     0   0     5   68    0   268     1     2    0    195
5     0     0   0    26    3  321     1     3     4  155      8
6     1     0   0     0    1    0  1854     1     1    0     50
7     1    20   0   210   10    0    12  6865    81    3     63
8     0     1   1    92   28    1    31    80  2965    2     95
9     0     1   1   172   18   20     0    31     3  225     22
10    0     0   0     7    4    0    44     3     9    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60141325, 'precision': 0.5540813, 'recall': 0.4643722, 'specificity': 0.9597336, 'f1': 0.45850274, 'auroc': 0.8675693}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   334     0   0    1    0    0     3  241    53    1   537
1     0  1255   0   54   12    0    26  108     1    0    43
2     1     0   0  137  273    0   297   30    30    8   239
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    1   13    0   324    1     2    0  1292
5     1     4   0  108    2  175     8   18    13  236    27
6     0     0   0    0    1    0  3036    0     3    0    27
7     0     0   0  331    3    0    15  793     1    1    20
8     0     0   0  153    2    0    36    7  1164    3     5
9     0     2   0  563   95   17    16  105    25  190   124
10    0     0   0    0    1    0     9    0     0    0  1636
early stop counter: 1
val acc:0.928875207901001, best validation acc: 0.9449244141578674, corresponding to test acc:                         0.6452109217643738 / 0.6980339884757996
after epoch: 9,now: 2024-07-28 11:09:23.535450,epoch time: 0:50:48.724058,used: 7:35:07.935094,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9439212, 'precision': 0.86429167, 'recall': 0.7086934, 'specificity': 0.9935752, 'f1': 0.7102103, 'auroc': 0.9962615}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0    6     0   0     1    1    0    16   127     2    5    325
1    0  1295   0     7    0    0     1    27     2    0      0
2    0     2   1   157   39    0     1    18     1   85      8
3    0     3   0  8133    0   15     1   166   116    3      0
4    0     1   0    35  172    1   140     8     7    1    174
5    0     0   0    17    0  389     0     0     4  108      2
6    0     1   0     1    0    0  1879     1     1    0     25
7    0    14   0    90    1    0     3  7114    39    0      3
8    0     0   0    36    1    0     8    91  3125    2     31
9    0     0   1     9    2   43     0     5     2  428      3
10   0     0   0    12    7    1    16     8    12    0  12738
---- Validation: 
scalar performance:
{'acc': 0.9441755, 'precision': 0.82253414, 'recall': 0.7100313, 'specificity': 0.99359185, 'f1': 0.7112212, 'auroc': 0.99601763}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0    4     0   0     3    0    0    11   133     0    2    330
1    0  1296   0     7    0    0     2    26     1    0      0
2    0     1   0   156   35    0     2    20     2   91      5
3    0     1   0  8147    0   14     0   149   127    2      0
4    0     0   0    38  175    0   133     4     7    3    179
5    0     0   0    16    0  400     1     0     3  100      1
6    0     0   0     3    1    0  1878     2     1    0     23
7    0     7   0    89    1    0     3  7129    33    0      3
8    0     2   0    44    1    1     9    90  3115    3     31
9    0     0   0    15    0   45     0     4     1  427      1
10   0     0   0    12    5    1    25     8    18    0  12727
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62226266, 'precision': 0.5584097, 'recall': 0.49594355, 'specificity': 0.9614272, 'f1': 0.4502843, 'auroc': 0.8529147}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0    1     6   0   12    0    4   295    75     2   16   759
1    0  1300   0   30    0    0     3   159     0    0     7
2    0     8   0  140  105    5   289    80   165   25   198
3    0     0   0    0    0    0     0     0     0    0     0
4    0     0   0    2   21    0   119     2     7    0  1482
5    0     5   0  155    0  322    19     1    19   66     5
6    0     0   0    5    0    0  3055     2     3    0     2
7    0     0   0  118    0    0     8  1035     1    0     2
8    0     0   0   81    0    1    12    18  1253    0     5
9    0    21   1  264   23  141    63   170   156  265    33
10   0     0   0    0    0    0     3     1     0    0  1642
early stop counter: 2
val acc:0.9441754817962646, best validation acc: 0.9449244141578674, corresponding to test acc:                         0.6452109217643738 / 0.6980339884757996
after epoch: 10,now: 2024-07-28 12:00:14.828351,epoch time: 0:50:51.292901,used: 8:25:59.227995,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:25:59.227995 at 2024-07-28 12:00:14.828351
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6452109, 'precision': 0.5499025, 'recall': 0.52450883, 'specificity': 0.9639181, 'f1': 0.49690524, 'auroc': 0.86498576}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   321     1   0    8    0    1    51   236    34   10   508
1     0  1216   0   36    0    0     1   217    12    1    16
2     0     0   0   97  190    3   216    77   216   50   166
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0    8    0   354     2    15    0  1254
5     0     0   0   86    1  322     8     4     7  152    12
6     0     0   0    2    0    0  3049     1    10    0     5
7     0     0   0   73    0    1     0  1087     0    0     3
8     0     0   0  125    0    1     7    14  1220    2     1
9     1     9   4  304   31   95    10   175    86  376    46
10    0     0   0    0    1    0    19     1     2    0  1623
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.698034, 'precision': 0.5643998, 'recall': 0.59062207, 'specificity': 0.96944916, 'f1': 0.5604958, 'auroc': 0.8747959}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   841     3   0    9   0    6    40    58    60   11   142
1     0  1288   0   32   0    7     7   148     0    2    15
2     5     6   0  282   3   17   293    78   124   53   154
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    8   0    0   178     1    10    0  1435
5     1     0   0   52   0  431     5     1     9   93     0
6     0     0   0   17   0    0  3045     1     2    0     2
7     0     0   0   76   0    1     3  1079     1    0     4
8     0     0   0  126   0    3    19    17  1200    4     1
9     5    16   0  209   3  176    21    97   125  454    31
10    0     0   0    0   0    0     7     0     0    0  1639
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_03_34_14_seed_0_23104521_instance_wise_predictions.txt
accuracy from prediction file 0.6452109424193662
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/6.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1658 MiB |   8645 MiB | 406204 GiB | 406202 GiB |
|       from large pool |   1651 MiB |   8631 MiB | 403210 GiB | 403208 GiB |
|       from small pool |      7 MiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1658 MiB |   8645 MiB | 406204 GiB | 406202 GiB |
|       from large pool |   1651 MiB |   8631 MiB | 403210 GiB | 403208 GiB |
|       from small pool |      7 MiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |   8622 MiB | 404715 GiB | 404714 GiB |
|       from large pool |   1647 MiB |   8607 MiB | 401724 GiB | 401723 GiB |
|       from small pool |      6 MiB |     16 MiB |   2990 GiB |   2990 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9086 MiB |   9086 MiB |   9086 MiB |      0 B   |
|       from large pool |   9068 MiB |   9068 MiB |   9068 MiB |      0 B   |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 220534 KiB | 533927 KiB |  84068 GiB |  84067 GiB |
|       from large pool | 209472 KiB | 531040 KiB |  81046 GiB |  81046 GiB |
|       from small pool |  11062 KiB |  13085 KiB |   3021 GiB |   3021 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   31811 K  |   31808 K  |
|       from large pool |     247    |     398    |   14242 K  |   14242 K  |
|       from small pool |    2419    |    3627    |   17568 K  |   17566 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   31811 K  |   31808 K  |
|       from large pool |     247    |     398    |   14242 K  |   14242 K  |
|       from small pool |    2419    |    3627    |   17568 K  |   17566 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     266    |     266    |     266    |       0    |
|       from large pool |     257    |     257    |     257    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     112    |    1225    |   16730 K  |   16730 K  |
|       from large pool |      91    |     184    |    9095 K  |    9095 K  |
|       from small pool |      21    |    1134    |    7634 K  |    7634 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB | 406204 GiB | 406204 GiB |
|       from large pool |  16640 KiB |   8631 MiB | 403210 GiB | 403210 GiB |
|       from small pool |      0 KiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB | 406204 GiB | 406204 GiB |
|       from large pool |  16640 KiB |   8631 MiB | 403210 GiB | 403210 GiB |
|       from small pool |      0 KiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB | 404715 GiB | 404715 GiB |
|       from large pool |  16640 KiB |   8607 MiB | 401724 GiB | 401724 GiB |
|       from small pool |      0 KiB |     16 MiB |   2990 GiB |   2990 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1874 MiB |   9086 MiB |   9086 MiB |   7212 MiB |
|       from large pool |   1856 MiB |   9068 MiB |   9068 MiB |   7212 MiB |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 533927 KiB |  84069 GiB |  84069 GiB |
|       from large pool |  24320 KiB | 531040 KiB |  81047 GiB |  81047 GiB |
|       from small pool |      0 KiB |  16594 KiB |   3021 GiB |   3021 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   31811 K  |   31811 K  |
|       from large pool |       2    |     398    |   14242 K  |   14242 K  |
|       from small pool |       0    |    3627    |   17568 K  |   17568 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   31811 K  |   31811 K  |
|       from large pool |       2    |     398    |   14242 K  |   14242 K  |
|       from small pool |       0    |    3627    |   17568 K  |   17568 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     266    |     266    |     167    |
|       from large pool |      90    |     257    |     257    |     167    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1225    |   16731 K  |   16731 K  |
|       from large pool |       3    |     184    |    9095 K  |    9095 K  |
|       from small pool |       0    |    1134    |    7635 K  |    7635 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB | 406204 GiB | 406204 GiB |
|       from large pool |  16640 KiB |   8631 MiB | 403210 GiB | 403210 GiB |
|       from small pool |      0 KiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB | 406204 GiB | 406204 GiB |
|       from large pool |  16640 KiB |   8631 MiB | 403210 GiB | 403210 GiB |
|       from small pool |      0 KiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB | 404715 GiB | 404715 GiB |
|       from large pool |  16640 KiB |   8607 MiB | 401724 GiB | 401724 GiB |
|       from small pool |      0 KiB |     16 MiB |   2990 GiB |   2990 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1874 MiB |   9086 MiB |   9086 MiB |   7212 MiB |
|       from large pool |   1856 MiB |   9068 MiB |   9068 MiB |   7212 MiB |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 533927 KiB |  84069 GiB |  84069 GiB |
|       from large pool |  24320 KiB | 531040 KiB |  81047 GiB |  81047 GiB |
|       from small pool |      0 KiB |  16594 KiB |   3021 GiB |   3021 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   31811 K  |   31811 K  |
|       from large pool |       2    |     398    |   14242 K  |   14242 K  |
|       from small pool |       0    |    3627    |   17568 K  |   17568 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   31811 K  |   31811 K  |
|       from large pool |       2    |     398    |   14242 K  |   14242 K  |
|       from small pool |       0    |    3627    |   17568 K  |   17568 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     266    |     266    |     167    |
|       from large pool |      90    |     257    |     257    |     167    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1225    |   16731 K  |   16731 K  |
|       from large pool |       3    |     184    |    9095 K  |    9095 K  |
|       from small pool |       0    |    1134    |    7635 K  |    7635 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521

 Experiment start at: 2024-07-28 12:18:33.251113
before training, model accuracy: 0.03799062594771385
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5645334, 'precision': 0.5248563, 'recall': 0.54266626, 'specificity': 0.95865816, 'f1': 0.51384646, 'auroc': 0.91354746}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   292     2     81    13   0    3    52    16    10   0   14
1     0  1186     32    20   0    0     0    88     6   0    0
2    27     7    117     7   0   12     5    51    34   0   52
3     3     2      1  7935   0   13     0   336   144   0    3
4     6     1    435     2   0    9     7     6    50   0   23
5    61     0      8    65   0  254    38     5    41   0   49
6    18     9     49    31   0   24  1718    14    39   0    6
7     0    11     21   319   0    2     2  6865    42   0    0
8     0     4    155   306   0    5     3   104  2716   0    2
9   155    10     31    22   0   60    21    27    24   0  143
10   15    11  12619    18   0    7    25    30    52   0   17
---- Validation: 
scalar performance:
{'acc': 0.56498593, 'precision': 0.52503747, 'recall': 0.5461011, 'specificity': 0.9587188, 'f1': 0.5143424, 'auroc': 0.91343397}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   299     2     88    11   0    6    37    17    10   0   13
1     0  1190     20    19   0    0     0    98     5   0    0
2    25     6    123     5   0   16     6    49    33   0   49
3     2     0      2  7952   0   10     0   324   149   0    1
4     5     0    439     3   0    8     6     4    49   0   25
5    75     0      7    61   0  255    33     3    40   0   47
6    15     7     46    33   0   24  1711    14    53   0    5
7     0    17     27   334   0    1     2  6842    41   0    1
8     1     3    142   304   0    9     3   100  2732   0    2
9   163     9     33    21   0   54    24    38    22   0  129
10   16    18  12608    12   0    6    22    36    60   0   18
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50402296, 'precision': 0.34788135, 'recall': 0.4071638, 'specificity': 0.95080364, 'f1': 0.3633877, 'auroc': 0.7628375}
confusion matrix:
     0     1     2   3   4    5     6     7     8   9   10
0   942     0     4  13   0    0   175    33     2   0   1
1     8  1000    34  38   0   10    19   379    11   0   0
2   172     0   222   8   1  133    76    48   276   0  79
3     0     0     0   0   0    0     0     0     0   0   0
4     4     0  1569   0   0    3     4     2    45   0   6
5   396     0     1   8   0   81    26     9    10   0  61
6     2     0    24   9   2  196  2750     6    67   0  11
7     0     0     3  57   0    0     5  1099     0   0   0
8    17     0     8  70   0  120    43     0  1110   0   2
9   514     4    32  22   0  150   110    81   128   0  96
10    0     0  1642   1   0    0     2     0     1   0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 13:11:14.200331,epoch time: 0:52:40.949218,used: 0:52:40.949218,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.579543, 'precision': 0.556191, 'recall': 0.5893091, 'specificity': 0.9606409, 'f1': 0.5335672, 'auroc': 0.9309051}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   385     0     66     7   0    0     9    11     4   0   1
1     0  1210     15    11   0    0     0    92     4   0   0
2    71     1    162     3   0    1     5    55    10   0   4
3     4     1      2  8021   0    8     0   281   123   0   0
4    18     1    481     1   0    1     2     6    27   0   1
5    96     4      6    21   0  289    51     3    47   0   4
6    51     0     31    10   0    1  1783    12    19   0   1
7     0     5     39   188   0    0     1  6988    43   0   0
8     1     0    117   221   0    3     0   133  2819   0   0
9   327     3     42     7   0   37    17    44     8   0   8
10   28     2  12681     7   0    1     6    24    38   0   4
---- Validation: 
scalar performance:
{'acc': 0.5792965, 'precision': 0.54605395, 'recall': 0.5891869, 'specificity': 0.96061134, 'f1': 0.53365767, 'auroc': 0.93223107}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   372     0     71     8   0    2     6    19     5   0   0
1     0  1212     15    11   0    0     0    90     4   0   0
2    70     0    166     2   0    2     2    57     8   0   5
3     3     1      4  8037   0   10     0   269   116   0   0
4    19     0    489     1   0    1     1     5    22   0   1
5    92     3      5    20   0  298    55     4    37   0   7
6    53     1     32    13   0    3  1767    11    26   0   2
7     0     3     36   214   0    0     1  6973    38   0   0
8     1     0    119   218   0    3     1   124  2830   0   0
9   310     2     48     6   0   38    30    38    11   0  10
10   28     0  12690    10   0    1     9    15    41   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5616735, 'precision': 0.3970034, 'recall': 0.46526444, 'specificity': 0.95662, 'f1': 0.41121006, 'auroc': 0.8199336}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1093     0     3   5   0    0    30    38     1   0   0
1      5  1060    52  27   0    3     6   342     4   0   0
2    213     3   320   8   0   29    62    70   308   0   2
3      0     0     0   0   0    0     0     0     0   0   0
4      7     0  1587   0   0    2     1     2    34   0   0
5    248     1     6  24   0  194    76    12    30   0   1
6      0     0     2   1   0   11  3027     4    22   0   0
7      0     0     2  53   0    0     2  1107     0   0   0
8      8     0     4  85   0   18    12    16  1227   0   0
9    511    10    44  28   0  100   123   143   177   0   1
10     0     0  1645   0   0    0     0     0     1   0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 14:01:53.743276,epoch time: 0:50:39.542945,used: 1:43:20.492163,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.58596426, 'precision': 0.5525532, 'recall': 0.6155673, 'specificity': 0.96127355, 'f1': 0.54911053, 'auroc': 0.94456035}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   372     1     81     3   0    0     7    15     4   0   0
1     0  1280      5     4   0    0     0    37     3   0   0
2    35     4    216     2   0    1     2    30    18   0   4
3     5     2      3  7888   0    2    18   440    81   0   0
4     5     0    483     0   0    1     0     8    39   0   3
5    56     0      7    31   0  307    34     6    66   0  14
6    32     1     33     4   0    0  1824     8     5   0   1
7     2    24     24    92   0    0     1  7076    44   0   0
8     1     1     87   166   0    0     2    99  2937   0   2
9   223     1    101     5   0   53    23    42    16   0  29
10    9     2  12703     7   0    0     3    24    45   0   1
---- Validation: 
scalar performance:
{'acc': 0.5857697, 'precision': 0.5555153, 'recall': 0.6133325, 'specificity': 0.961251, 'f1': 0.5487261, 'auroc': 0.9451158}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   376     0     78     3   0    0     6    15     4   0   1
1     0  1275      9     7   0    0     0    37     4   0   0
2    34     2    212     0   0    1     1    32    29   0   1
3     7     1      2  7881   0    1    18   447    83   0   0
4     6     0    488     0   0    1     0    10    32   0   2
5    54     0      9    31   0  300    30    14    65   0  18
6    39     3     36     1   0    1  1809     4    14   0   1
7     0    19     22    92   0    0     2  7081    49   0   0
8     1     2     79   159   0    1     0    90  2963   0   1
9   225     2    100     7   0   44    28    39    13   0  35
10    6     2  12715     6   0    0     5    24    36   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59063876, 'precision': 0.43165618, 'recall': 0.49600488, 'specificity': 0.95957655, 'f1': 0.4386632, 'auroc': 0.8373065}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1115     3    14   0   0    1    14    19     4   0   0
1      1  1246    17  19   0    0     4   210     2   0   0
2    129    11   523   7   0    6    15    44   265   0  15
3      0     0     0   0   0    0     0     0     0   0   0
4      3     0  1607   0   0    0     2     0    20   0   1
5    210     0     3  23   0  186    69    37    46   0  18
6      1     0     7   2   0   10  3029     5    13   0   0
7      7     0     5  13   0    0    20  1119     0   0   0
8     11     0     3  94   0    7    11    20  1224   0   0
9    455    38   209  36   0   47    61   110   166   0  15
10     0     0  1645   0   0    0     0     0     1   0   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-28 14:52:27.877223,epoch time: 0:50:34.133947,used: 2:33:54.626110,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.58960295, 'precision': 0.55993825, 'recall': 0.6077296, 'specificity': 0.9613582, 'f1': 0.5572266, 'auroc': 0.9407824}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   409     0     25    10   0    1     6    25     4   0   2
1     0  1256      3    15   0    0     0    51     7   0   0
2    62     0    129     5   0   11     6    59    26   0  13
3     0     0      0  8207   0    2     0   152    74   0   0
4    14     1    412     1   0    3     3    26    62   0  17
5     4     0      2    24   0  378     5     3    99   0   6
6    22     1      7    10   0    3  1843    10     8   0   3
7     0     4      6   238   0    0     1  6997    19   0   0
8     2     0     31   343   0    1     2   115  2799   0   3
9   105     1     15     9   0  147    47    84    35   0  50
10   27     3  12538    11   0    2     9    59   127   0  19
---- Validation: 
scalar performance:
{'acc': 0.5902635, 'precision': 0.56745005, 'recall': 0.60662085, 'specificity': 0.96141374, 'f1': 0.55720216, 'auroc': 0.9414641}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   399     2     24    11   0    0    10    29     7   0   1
1     0  1259      1    18   0    0     0    50     4   0   0
2    67     0    127     3   0    9     9    51    32   0  14
3     0     0      0  8203   0    4     0   166    67   0   0
4    11     0    414     3   0    6     3    23    64   0  15
5     2     0      1    19   0  383     9     8    94   0   5
6    17     0      6    15   0    5  1846    14     4   0   1
7     0     5      4   231   0    1     1  7005    18   0   0
8     1     0     26   324   0    2     1   128  2812   0   2
9   106     1     18    12   0  145    40    77    35   0  59
10   30     3  12523    12   0    1     8    67   119   0  33
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53235847, 'precision': 0.38987628, 'recall': 0.4310376, 'specificity': 0.9540992, 'f1': 0.3938315, 'auroc': 0.8287295}
confusion matrix:
     0     1     2    3   4    5     6     7     8   9   10
0   939     0     0   27   0    0    21   178     5   0   0
1     0  1086     7   50   0    0     1   349     6   0   0
2    82     2   197   35   0   41    38   163   421   0  36
3     0     0     0    0   0    0     0     0     0   0   0
4     4     0  1537    0   0    2     5     6    77   0   2
5    22     0     0  100   0  165    13    59   228   0   5
6     0     0     1   56   0    4  2989     6    11   0   0
7     0     0     1   99   0    0     0  1062     1   0   1
8     0     0     0  185   0    1     3    11  1170   0   0
9   157     4    39  144   0  149    79   289   254   0  22
10    0     0  1637    0   0    0     0     1     7   0   1
better model found
persisted
after epoch: 4,now: 2024-07-28 15:43:34.502252,epoch time: 0:51:06.625029,used: 3:25:01.251139,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.59281355, 'precision': 0.57395744, 'recall': 0.6257207, 'specificity': 0.96203595, 'f1': 0.5565882, 'auroc': 0.94783646}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   417     0     44     9   0    0     0    11     2   0   0
1     1  1263      6    15   0    0     0    46     1   0   0
2    90     1    171     1   0    4    10    28     6   0   1
3     2     1      0  8244   0    9     0    90    92   0   0
4    35     1    466     0   0    0     3     5    22   0   7
5    25     0      2    13   0  383    34     3    60   0   1
6    34     3     20    12   0    1  1824     8     6   0   0
7     0     5     34   346   0    1     1  6839    38   0   0
8     7     0     69   143   0    2     2    62  3010   0   1
9   259     2     34     7   0   91    68    17    12   0   3
10   35     1  12701     8   0    0     1    12    26   0   6
---- Validation: 
scalar performance:
{'acc': 0.59189516, 'precision': 0.56564844, 'recall': 0.6231738, 'specificity': 0.96194434, 'f1': 0.5532007, 'auroc': 0.9484313}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   415     0     42     6   0    0     3    11     4   0   2
1     0  1272      5    15   0    0     0    38     2   0   0
2    87     1    175     1   0    1    13    22     8   0   4
3     1     0      2  8262   0   12     0    75    87   0   1
4    30     1    456     1   0    0     4     8    30   0   9
5    20     2      2    17   0  367    50     2    61   0   0
6    40     0     20    11   0    1  1820     9     6   0   1
7     0     5     30   348   0    0     1  6843    38   0   0
8    10     2     88   154   0   11     1    63  2967   0   0
9   269     3     33     3   0   90    72    11     9   0   3
10   31     0  12697     7   0    0     4    21    29   0   7
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5759463, 'precision': 0.432882, 'recall': 0.48531887, 'specificity': 0.95806235, 'f1': 0.43958133, 'auroc': 0.83661413}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9   10
0   1075     0     8   24   0    1     9   51     2   0   0
1      3  1148    35   44   0    0     4  263     2   0   0
2    230     8   469    7   0    6    62   43   180   0  10
3      0     0     0    0   0    0     0    0     0   0   0
4      6     0  1598    0   0    1     6    1    20   0   1
5    106     0     0   43   0  260   112   13    54   0   4
6      2     0     5    8   0    0  3046    2     4   0   0
7      3     0     6  155   0    1     0  997     2   0   0
8      1     0     2  102   0   12    12    4  1237   0   0
9    478     7   149   64   0   67   192   87    92   0   1
10     0     0  1645    0   0    0     0    0     1   0   0
better model found
persisted
after epoch: 5,now: 2024-07-28 16:35:01.550173,epoch time: 0:51:27.047921,used: 4:16:28.299060,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.592439, 'precision': 0.56629854, 'recall': 0.6017624, 'specificity': 0.96181536, 'f1': 0.5351282, 'auroc': 0.9607357}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   416     0     52     0   0    0     3     7     3   0   2
1     0  1292      2     6   0    0     0    29     3   0   0
2    34     0    229     1   0    1     1    33     8   0   5
3     2     1      0  8203   0    4     1   178    47   0   0
4     2     1    481     1   0    3     1    13    27   0  10
5     8     1      6    19   0  123    20    20   293   0  31
6    20     1     15     2   0    0  1863     3     1   0   2
7     3    10     12   157   0    0     0  7055    27   0   0
8     1     0     68   167   0    1     3    97  2957   0   2
9   145     1     74     9   0   18    17   121    31   0  77
10   10     1  12701     5   0    0    14    21    36   0   5
---- Validation: 
scalar performance:
{'acc': 0.5928581, 'precision': 0.56675243, 'recall': 0.6000861, 'specificity': 0.96184695, 'f1': 0.53384733, 'auroc': 0.9613899}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   414     0     51     2   0    0     8     5     1   0   2
1     0  1285      2     6   0    0     1    34     4   0   0
2    32     0    229     0   0    1     2    33     7   0   8
3     3     1      2  8204   0    5     0   174    51   0   0
4     4     0    483     0   0    0     1    16    24   0  11
5     7     2      4    20   0  115    21    32   285   0  35
6    20     0     17     1   0    0  1859     4     4   0   3
7     2     9     13   150   0    0     1  7072    18   0   0
8     2     0     62   148   0    0     2   101  2980   0   1
9   130     3     70     6   0   21    15   141    34   0  73
10   10     7  12694     6   0    0    15    23    35   0   6
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55516684, 'precision': 0.42526108, 'recall': 0.4444695, 'specificity': 0.9564971, 'f1': 0.40053248, 'auroc': 0.8316978}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9   10
0   1096     0     8   13   0   0    15   35     3   0   0
1      0  1217    13   43   0   0     2  222     2   0   0
2     42     3   416   25   0   2    12  148   287   0  80
3      0     0     0    0   0   0     0    0     0   0   0
4      1     0  1603    0   0   0     5    3    18   0   3
5     22     4     0  149   0  39    15   95   199   0  69
6      0     0     1   10   0   0  3047    3     6   0   0
7      2     0     3  198   0   1     0  959     1   0   0
8      0     0     2  197   0   0     2    8  1161   0   0
9    167     6   111  213   0  20    26  368   165   0  61
10     0     0  1644    0   0   0     1    0     1   0   0
better model found
persisted
after epoch: 6,now: 2024-07-28 17:26:34.004260,epoch time: 0:51:32.454087,used: 5:08:00.753147,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.59206444, 'precision': 0.558398, 'recall': 0.5822427, 'specificity': 0.961784, 'f1': 0.504397, 'auroc': 0.96242994}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   428     3     31     1   0   0     3    11     5   0   1
1     0  1299      2     5   0   0     0    23     3   0   0
2    43     0    205     0   0   0     1    33    19   0  11
3     2     3      0  8104   0   1     2   195   129   0   0
4     6     1    440     0   0   1     2    10    56   0  23
5     9    21      3    24   0  16    39    20   329   0  60
6    28     2      9     3   0   0  1851     5     7   0   3
7     4    28      7   100   0   0     0  7089    34   0   0
8     1     4     38    48   0   0     1    79  3123   0   2
9   146    17     42     3   0   2    20   142    44   0  77
10   14    10  12669     5   0   0     4    19    59   0  14
---- Validation: 
scalar performance:
{'acc': 0.59144044, 'precision': 0.54825103, 'recall': 0.5836586, 'specificity': 0.9617257, 'f1': 0.5040923, 'auroc': 0.96238995}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   425     1     35     2   0   0     4     8     7   0   1
1     0  1302      1     8   0   0     0    18     3   0   0
2    48     3    213     1   0   0     3    25    15   0   4
3     2     3      1  8111   0   1     2   183   137   0   0
4     9     3    436     0   0   0     0     6    58   0  27
5    13    16      2    27   0  17    36    22   331   0  57
6    29     1     13     2   0   0  1846     5     7   0   5
7     4    23     14   113   0   0     1  7067    43   0   0
8     1     1     31    65   0   0     1    80  3115   0   2
9   141    21     44     3   0   7    16   155    38   0  68
10   14     6  12681     7   0   0     3    19    51   0  15
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56440216, 'precision': 0.39692128, 'recall': 0.4487366, 'specificity': 0.95716643, 'f1': 0.39535248, 'auroc': 0.8340659}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9   10
0   1036     4     2   24   0   1    21    78     3   0   1
1      0  1333     6   31   0   0     1   124     4   0   0
2     40    12   275   20   0   4     6   118   478   0  62
3      0     0     0    0   0   0     0     0     0   0   0
4      0     3  1529    0   0   1    10     5    65   0  20
5     16     5     0  200   0   9    11    52   205   0  94
6      1     3     1   16   0   0  3029     3    14   0   0
7      0     0     2   24   0   0     1  1136     1   0   0
8      0     0     0   96   0   0     1    23  1249   0   1
9    161    13   110  149   0  10    36   271   314   0  73
10     0     2  1636    1   0   0     2     0     5   0   0
early stop counter: 1
val acc:0.5914404392242432, best validation acc: 0.592858076095581, corresponding to test acc:                         0.5551668405532837 / 0.5906387567520142
after epoch: 7,now: 2024-07-28 18:18:28.190344,epoch time: 0:51:54.186084,used: 5:59:54.939231,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.5930811, 'precision': 0.56671154, 'recall': 0.5863303, 'specificity': 0.96200836, 'f1': 0.5097964, 'auroc': 0.9678213}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   403     1     44     2   0   0    10    10    11   0   2
1     0  1295      2     6   0   0     0    24     5   0   0
2    28     2    212     2   0   1     4    40    17   0   6
3     4     1      0  8139   0   1     3   222    68   0   1
4     7     1    451     0   0   0     4    10    44   0  22
5    30     2      3    33   0  54   122    12   263   0   2
6     9     0     15     2   0   0  1875     2     3   0   2
7     4    12      6   101   0   0     3  7095    43   0   0
8     0     0     24   117   0   1     1    72  3077   0   0
9   232     6     42     2   0  11    60   107    18   0  15
10    6     2  12656     6   0   1     7    13    85   0  17
---- Validation: 
scalar performance:
{'acc': 0.59293836, 'precision': 0.57176733, 'recall': 0.5860309, 'specificity': 0.96201575, 'f1': 0.50937533, 'auroc': 0.96725154}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   396     0     43     4   0   0    19     3    18   0   0
1     0  1295      2     5   0   0     1    22     7   0   0
2    27     0    214     2   0   0     3    43    18   0   5
3     2     3      0  8142   0   2     2   217    72   0   0
4     4     2    446     0   0   0     5    12    48   0  22
5    34     4      3    35   0  59   122    14   250   0   0
6    16     0     17     3   0   0  1865     2     5   0   0
7     1    18      8    96   0   0     2  7099    41   0   0
8     1     0     25   113   0   2     3    70  3080   0   2
9   239     5     42     3   0   8    72    97    13   0  14
10    7     1  12665     5   0   0     5    14    82   0  17
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5543973, 'precision': 0.43743557, 'recall': 0.44746882, 'specificity': 0.9562174, 'f1': 0.40052167, 'auroc': 0.82529896}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9   10
0   1021     0     6   17   0   0    60    56    10   0   0
1      0  1298    15   29   0   0     1   149     6   0   1
2     65     6   358   28   0   0    15    88   429   0  26
3      0     0     0    0   0   0     0     0     0   0   0
4      2     0  1598    0   0   0     2     1    28   0   2
5     50     0     0  192   0  46    89    64   108   0  43
6      1     0    23   70   0   0  2944     3    26   0   0
7      2     0     3   26   0   0     2  1129     2   0   0
8      2     0     0  230   0   0     0    10  1128   0   0
9    256     8    94  219   0   8    75   253   213   0  11
10     0     0  1643    0   0   0     1     0     2   0   0
better model found
persisted
after epoch: 8,now: 2024-07-28 19:10:27.149928,epoch time: 0:51:58.959584,used: 6:51:53.898815,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.5896297, 'precision': 0.56376004, 'recall': 0.5675692, 'specificity': 0.9614004, 'f1': 0.50586045, 'auroc': 0.96390283}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   417     0     51     3   0   0     3     7     1   0    1
1     0  1296      3     4   0   0     0    27     2   0    0
2    34     0    168     1   0   0     5    79     1   0   24
3     2     2      1  8193   0   2     4   160    71   0    2
4    12     0    306     0   0   0     1    19     6   0  195
5    21     0      1    15   0  27    40    34   373   0   10
6    17     0     13     7   0   0  1857     7     7   0    0
7     1    18     19   110   0   0     0  7099    14   0    1
8     0     3    146    90   0   1     2    99  2938   0   17
9   178     0     25     3   0   5    31   212    33   0    6
10   13     3  12710     7   0   0     2    10     5   0   43
---- Validation: 
scalar performance:
{'acc': 0.5888458, 'precision': 0.5481086, 'recall': 0.56659305, 'specificity': 0.9613274, 'f1': 0.504387, 'auroc': 0.9633082}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   420     1     48     2   0   0     2     5     2   0    3
1     0  1298      4     4   0   0     0    23     3   0    0
2    33     0    167     0   0   0     2    78     2   0   30
3     2     2      2  8192   0   4     1   155    79   0    3
4     9     1    321     0   0   0     4    17     4   0  183
5    20     0      1    14   0  22    43    27   387   0    7
6    17     1     14     4   0   1  1860     6     3   0    2
7     0    17     20   111   0   0     1  7097    18   0    1
8     1     0    149    95   0   0     2   114  2919   0   16
9   178     3     21     3   0   9    38   198    28   0   15
10   10     1  12715     7   0   0     2    16     6   0   39
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58210313, 'precision': 0.42114982, 'recall': 0.4749356, 'specificity': 0.95881236, 'f1': 0.40672645, 'auroc': 0.8515946}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9   10
0   1111     1     6    8   0   0     6    37     1   0   0
1      2  1345    15   23   0   0     1   111     1   0   1
2     75     8   550    6   0   0     7   169   131   0  69
3      0     0     0    0   0   0     0     0     0   0   0
4      2     0  1602    0   0   0     2     0     3   0  24
5     46     1     0   41   0  14    55   168   198   0  69
6      1     7    48   19   0   0  2973     3    11   0   5
7      6     2     4   29   0   1     4  1116     2   0   0
8      1     1    14  114   0   0     6    23  1210   0   1
9    229    21   146   42   0  10    50   516   106   0  17
10     0     0  1645    0   0   0     0     0     0   0   1
early stop counter: 1
val acc:0.5888457894325256, best validation acc: 0.5929383635520935, corresponding to test acc:                         0.5543972849845886 / 0.5906387567520142
after epoch: 9,now: 2024-07-28 20:01:11.324226,epoch time: 0:50:44.174298,used: 7:42:38.073113,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.6069135, 'precision': 0.6119396, 'recall': 0.58813703, 'specificity': 0.96293503, 'f1': 0.52643716, 'auroc': 0.97117877}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   405     0     19     2   0   0    27     8     6   0   16
1     0  1298      1     6   0   0     0    23     4   0    0
2    16     1    183     3   0   0     5    45    32   0   27
3     2     3      0  8210   0   3     7   155    59   0    0
4    11     3    158     4   0   0     3     9   107   0  244
5    27     4      2    22   0  80   179    12   189   0    6
6     7     0      3     1   0   0  1886     1     4   0    4
7     0    14     18   116   0   0     3  7076    34   0    1
8     0     2     22    83   0   1     9    58  3119   0    2
9   141     6     41    13   0   2    79   173    15   0   23
10   13     2  12164     8   0   0    27    10   142   0  427
---- Validation: 
scalar performance:
{'acc': 0.6070884, 'precision': 0.60985005, 'recall': 0.586742, 'specificity': 0.96293914, 'f1': 0.5240954, 'auroc': 0.9699643}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   405     0     17     4   0   0    30     6     6   0   15
1     0  1302      1     6   0   0     1    20     2   0    0
2    16     0    184     5   0   0     7    35    30   0   35
3     2     1      0  8232   0   1    10   135    59   0    0
4    10     5    159     3   0   0     3    12    98   0  249
5    20     4      1    17   0  67   181    12   212   0    7
6     5     1      4     0   0   0  1890     1     3   0    4
7     0    12     12   110   0   0     1  7092    36   0    2
8     0     0     19    98   0   1     3    54  3118   0    3
9   143    11     37    14   0   4    64   177    13   0   30
10    6     6  12194     5   0   0    33    10   136   0  406
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5665011, 'precision': 0.4511043, 'recall': 0.4475491, 'specificity': 0.95670784, 'f1': 0.4015238, 'auroc': 0.8420967}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9    10
0   1068     0     1    5   0   0    65    22     4   0    5
1      0  1197    16   28   0   0     5   245     2   0    6
2     87     4   220   23   0   0    32   166   345   0  138
3      0     0     0    0   0   0     0     0     0   0    0
4      4     0   716    0   0   0    13     1    44   0  855
5     60    18     0  111   0  20   162    50   118   0   53
6      0     0     0    2   0   0  3059     2     3   0    1
7      0     0     2   25   0   0     9  1126     0   0    2
8      1     0     1  183   0   0    11    17  1157   0    0
9    256     8    92  118   0   2   101   359   170   0   31
10     0     0  1390    0   0   0     3     0     3   0  250
better model found
persisted
after epoch: 10,now: 2024-07-28 20:51:45.942658,epoch time: 0:50:34.618432,used: 8:33:12.691545,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:33:12.691545 at 2024-07-28 20:51:45.942658
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5665011, 'precision': 0.4511043, 'recall': 0.4475491, 'specificity': 0.95670784, 'f1': 0.4015238, 'auroc': 0.8420967}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9    10
0   1068     0     1    5   0   0    65    22     4   0    5
1      0  1197    16   28   0   0     5   245     2   0    6
2     87     4   220   23   0   0    32   166   345   0  138
3      0     0     0    0   0   0     0     0     0   0    0
4      4     0   716    0   0   0    13     1    44   0  855
5     60    18     0  111   0  20   162    50   118   0   53
6      0     0     0    2   0   0  3059     2     3   0    1
7      0     0     2   25   0   0     9  1126     0   0    2
8      1     0     1  183   0   0    11    17  1157   0    0
9    256     8    92  118   0   2   101   359   170   0   31
10     0     0  1390    0   0   0     3     0     3   0  250
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59063876, 'precision': 0.43165618, 'recall': 0.49600488, 'specificity': 0.95957655, 'f1': 0.4386632, 'auroc': 0.8373065}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1115     3    14   0   0    1    14    19     4   0   0
1      1  1246    17  19   0    0     4   210     2   0   0
2    129    11   523   7   0    6    15    44   265   0  15
3      0     0     0   0   0    0     0     0     0   0   0
4      3     0  1607   0   0    0     2     0    20   0   1
5    210     0     3  23   0  186    69    37    46   0  18
6      1     0     7   2   0   10  3029     5    13   0   0
7      7     0     5  13   0    0    20  1119     0   0   0
8     11     0     3  94   0    7    11    20  1224   0   0
9    455    38   209  36   0   47    61   110   166   0  15
10     0     0  1645   0   0    0     0     0     1   0   0
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_12_18_32_seed_1_23104521_instance_wise_predictions.txt
accuracy from prediction file 0.566501084446932
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |   8647 MiB |    793 TiB |    793 TiB |
|       from large pool |   1652 MiB |   8632 MiB |    787 TiB |    787 TiB |
|       from small pool |      7 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |   8647 MiB |    793 TiB |    793 TiB |
|       from large pool |   1652 MiB |   8632 MiB |    787 TiB |    787 TiB |
|       from small pool |      7 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |   8622 MiB |    790 TiB |    790 TiB |
|       from large pool |   1647 MiB |   8607 MiB |    784 TiB |    784 TiB |
|       from small pool |      6 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9026 MiB |   9086 MiB |  16238 MiB |   7212 MiB |
|       from large pool |   9008 MiB |   9068 MiB |  16220 MiB |   7212 MiB |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 239702 KiB | 533927 KiB | 173099 GiB | 173099 GiB |
|       from large pool | 228640 KiB | 531040 KiB | 167063 GiB | 167063 GiB |
|       from small pool |  11062 KiB |  16594 KiB |   6035 GiB |   6035 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   63622 K  |   63619 K  |
|       from large pool |     247    |     398    |   28485 K  |   28484 K  |
|       from small pool |    2419    |    3627    |   35137 K  |   35134 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   63622 K  |   63619 K  |
|       from large pool |     247    |     398    |   28485 K  |   28484 K  |
|       from small pool |    2419    |    3627    |   35137 K  |   35134 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     263    |     266    |     430    |     167    |
|       from large pool |     254    |     257    |     421    |     167    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     110    |    1249    |   33117 K  |   33117 K  |
|       from large pool |      89    |     184    |   17882 K  |   17881 K  |
|       from small pool |      21    |    1160    |   15235 K  |   15235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8647 MiB |    793 TiB |    793 TiB |
|       from large pool |  16640 KiB |   8632 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8647 MiB |    793 TiB |    793 TiB |
|       from large pool |  16640 KiB |   8632 MiB |    787 TiB |    787 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB |    790 TiB |    790 TiB |
|       from large pool |  16640 KiB |   8607 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1894 MiB |   9086 MiB |  16238 MiB |  14344 MiB |
|       from large pool |   1876 MiB |   9068 MiB |  16220 MiB |  14344 MiB |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 533927 KiB | 173100 GiB | 173100 GiB |
|       from large pool |  24320 KiB | 531040 KiB | 167064 GiB | 167064 GiB |
|       from small pool |      0 KiB |  16594 KiB |   6035 GiB |   6035 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   63622 K  |   63622 K  |
|       from large pool |       2    |     398    |   28485 K  |   28485 K  |
|       from small pool |       0    |    3627    |   35137 K  |   35137 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   63622 K  |   63622 K  |
|       from large pool |       2    |     398    |   28485 K  |   28485 K  |
|       from small pool |       0    |    3627    |   35137 K  |   35137 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     266    |     430    |     331    |
|       from large pool |      90    |     257    |     421    |     331    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1249    |   33118 K  |   33118 K  |
|       from large pool |       3    |     184    |   17882 K  |   17882 K  |
|       from small pool |       0    |    1160    |   15236 K  |   15236 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 21:02:11 2024]
Finished job 0.
1 of 1 steps (100%) done
