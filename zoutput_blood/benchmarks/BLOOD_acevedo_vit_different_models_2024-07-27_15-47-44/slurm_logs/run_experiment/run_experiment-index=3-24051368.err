Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 01:49:59 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368

 Experiment start at: 2024-08-04 02:05:12.303030
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.044287413358688354
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9307042, 'precision': 0.83587617, 'recall': 0.7474455, 'specificity': 0.9923584, 'f1': 0.7764052, 'auroc': 0.99176615}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   273     0   0    14    1    6    66     1    13   12     97
1     0  1244   0    26    0    0     2    39    11    0      9
2     0     3  88     5   57    7     0    16    37   90      9
3     0     1   1  8102    0    9     2   148   168    2      2
4     0     0  17     5  221    4     3     2    78   13    196
5     0     0   2    61    0  388     0     0     8   61      1
6     3     0   0    14    2    6  1811     5    15    2     50
7     0    21   2   336    1    0     5  6724   148    2     25
8     0     2   2   155    7    2     4    45  3025    0     52
9     0     1  28    17    0  157     0     1    21  268      0
10    1     0   0     8   25    3    25    18    72    2  12642
---- Validation: 
scalar performance:
{'acc': 0.93141633, 'precision': 0.84435177, 'recall': 0.75786865, 'specificity': 0.9924508, 'f1': 0.7872117, 'auroc': 0.9915035}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   268     0    0    12    2   11    65     3    22   11     89
1     0  1241    0    19    1    1     0    44    19    0      7
2     0     3  112     8   58    8     1     6    32   81      3
3     0     1    0  8125    0   15     5   138   155    0      1
4     0     0   14     4  226    0     1     3    76   14    201
5     0     0    0    62    0  399     0     0     8   51      1
6     4     0    0    14    2    7  1810     3    19    3     46
7     0    25    0   370    4    0     6  6669   170    0     21
8     0     1    2   156    4    4     3    40  3047    2     37
9     1     2   31    22    0  139     0     2    16  278      2
10    2     2    1     6   32    3    21    19    64    0  12646
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6311481, 'precision': 0.62529546, 'recall': 0.55022544, 'specificity': 0.962884, 'f1': 0.53841877, 'auroc': 0.86561984}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   573     0   0   74    0   56   302   13    75   49    28
1     0  1206   1   54    1    1    14  165     8    7    42
2     1     2  46   49  251   32    18   24   397   68   127
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   0    0  261    0     0    0    25    1  1345
5     0     0   0   76    0  458     3    0     8   46     1
6     0     0   0    5   48    0  2304    2   107    0   601
7     0     0   0  213    0    0     5  938     3    0     5
8     0     0   0  164    1    9     5    3  1184    1     3
9     1    12  52  173   26  217     5   16   213  412    10
10    0     0   0    0    7    0     0    0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 02:50:14.663462,epoch time: 0:45:02.360432,used: 0:45:02.360432,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94314533, 'precision': 0.85420275, 'recall': 0.8180251, 'specificity': 0.99372596, 'f1': 0.8282716, 'auroc': 0.9945781}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     2    0    0     2     2     5    3     47
1     1  1253    0    16    0    0     3    46     9    1      3
2     4     0  164     2   39    0     0     4     9   82      8
3    11     0    0  7957    0   32    11   240   176   10      1
4     4     0   34     2  236    0     1     2    15   17    226
5     1     0    0    19    0  337     0     0     5  157      2
6    31     0    0     2    3    1  1822     0     3    6     40
7    11    10    6   174    1    0    14  6929    84    5     28
8     8     0    5    77    9    6     8    58  3023   10     92
9     5     0   29     5    0   46     0     1     6  399      2
10   20     0    0    10   18    1     5    14    13    4  12709
---- Validation: 
scalar performance:
{'acc': 0.9425438, 'precision': 0.84989613, 'recall': 0.81613076, 'specificity': 0.9936619, 'f1': 0.82572323, 'auroc': 0.994338}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    0     3    0    0     1     4     2    7     55
1     2  1253    0    15    0    0     2    46    11    0      3
2     4     0  168     0   43    1     0     4     9   76      7
3    11     1    1  7963    0   34    16   228   173   12      1
4     4     1   32     1  238    0     4     2    20   18    219
5     1     0    0    20    0  335     0     0     6  158      1
6    39     0    0     1    1    1  1814     1     3    4     44
7    11    10    4   169    1    0    15  6937    79    7     32
8    14     0    4    70   16    8     6    62  3001   10    105
9     4     0   32     6    0   43     0     1     7  399      1
10   21     1    0     8   19    0     1    14     9    5  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75869304, 'precision': 0.6902062, 'recall': 0.637735, 'specificity': 0.97559214, 'f1': 0.6278501, 'auroc': 0.87980956}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1132     0    0   4    0    1     2     3     1   27     0
1     29  1207   10  28    0    1    21   172     3   15    13
2     33     9  144   3  333    1    20    19    98  217   138
3      0     0    0   0    0    0     0     0     0    0     0
4      3     0    2   0  344    0     3     1     6    1  1273
5      7     0    0  15    1  213     0     0     6  349     1
6      1     0    0   1    4    0  3042     0     0    1    18
7      8     0    1  56    0    0    55  1024     1   15     4
8      8     0    1  39   18    4    11     6  1235   43     5
9     40    11   87  11    8   20     1    13    63  869    14
10     0     0    0   0   12    0     0     0     0    0  1634
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 03:37:21.345527,epoch time: 0:47:06.682065,used: 1:32:09.042497,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9562821, 'precision': 0.87919784, 'recall': 0.84412384, 'specificity': 0.9952217, 'f1': 0.85811424, 'auroc': 0.9968295}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     1    0     6    0    0    10     6     3    6     26
1     0  1295    0     7    0    0     0    26     3    0      1
2     0     1  169     3   47    1     3     9     7   69      3
3     0     3    0  8200    0   15     0   134    86    0      0
4     3     3   24     2  287    4     3     3    32    9    169
5     0     0    2    19    0  441     0     0     7   51      1
6    12     1    0    11    2    3  1860     2     5    2     10
7     0    19    0   185    1    0     2  7012    39    0      6
8     1     4    6   107    5    4     2    86  3048    2     30
9     1     0   36     7    1  104     1     1     4  338      0
10   27     0    1     8   20    4    13    19    31    1  12668
---- Validation: 
scalar performance:
{'acc': 0.95559716, 'precision': 0.8787086, 'recall': 0.84198755, 'specificity': 0.9951422, 'f1': 0.85659826, 'auroc': 0.9965727}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     1    0     6    1    1    13     7     6    3     20
1     0  1285    0    15    0    0     0    29     2    0      1
2     0     5  166     3   46    4     0     9     7   69      3
3     1     2    0  8198    0   19     0   124    93    3      0
4     6     2   26     3  282    3     3     3    29    5    177
5     0     0    0    23    0  429     1     0     4   63      1
6    14     0    1    11    1    3  1855     4     6    2     11
7     0    10    1   197    1    0     1  7015    33    1      6
8     1     4    4   102    4    1     5    84  3059    1     31
9     1     0   32    10    2   92     0     0     5  351      0
10   26     0    2     8   21    3    19    15    41    1  12660
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72951794, 'precision': 0.6521797, 'recall': 0.6249738, 'specificity': 0.9728445, 'f1': 0.61089754, 'auroc': 0.86904615}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   939     2    0   74    0   42    55    19     6   26     7
1     1  1358    0   24    0    1     2    89     1    1    22
2     4     7  101   18  301   30    40    32   203  100   179
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    0    0  164    0     4     1    11    1  1451
5     1     0    0   64    0  442     4     0     7   73     1
6     0     0    0   10    1    0  2989     2     1    0    64
7     0     0    1  128    0    1     8  1022     1    0     3
8     0     0    0   91    5    4     8    12  1248    1     1
9     5    18  132   91   19  147    11    39   130  520    25
10    0     0    0    0    2    0     0     0     0    0  1644
better model found
persisted
after epoch: 3,now: 2024-08-04 04:20:05.796431,epoch time: 0:42:44.450904,used: 2:14:53.493401,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95572025, 'precision': 0.88073575, 'recall': 0.86801386, 'specificity': 0.9952346, 'f1': 0.8733789, 'auroc': 0.9973377}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    0     5    1    1     8     0    11    6     40
1     0  1280    0    11    0    1     0    32     8    0      0
2     0     0  207     1   18    2     1     3     8   71      1
3     1     3    1  8244    0   21     4    61   104    0      0
4     1     0   45     1  349    1     1     3    26    6    106
5     0     0    1    23    0  458     0     0     4   34      1
6     7     0    1     2    2    2  1869     0     8    1     15
7     1    12    6   290    1    0     5  6800   134    1     12
8     0     0    7    75   14    2     0    41  3132    2     22
9     0     0   24     7    0  103     0     0     6  353      0
10    6     1    2     9  102    2    12    12    29    0  12618
---- Validation: 
scalar performance:
{'acc': 0.95696133, 'precision': 0.8802488, 'recall': 0.86421674, 'specificity': 0.9953655, 'f1': 0.8709415, 'auroc': 0.99724853}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    1     6    0    1    14     2     7    3     44
1     0  1274    0     9    0    0     0    43     5    1      0
2     0     0  208     1   16    2     0     2     8   75      0
3     1     5    0  8245    0   18     1    48   122    0      0
4     2     0   58     3  340    1     0     3    17    3    112
5     0     0    0    17    0  456     0     0     7   40      1
6     6     0    1     4    1    1  1874     0     6    1     14
7     0    11    3   270    1    0     2  6854   115    2      7
8     0     0    4    77    9    2     0    39  3141    2     22
9     0     0   28     6    2  109     0     2     3  343      0
10    9     0    4     8   84    2    10    12    31    0  12636
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7366543, 'precision': 0.694131, 'recall': 0.6356318, 'specificity': 0.97384334, 'f1': 0.64121103, 'auroc': 0.8774118}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   986     0    2   10    1   35    60    2    21   42    11
1     3  1232   12   39    2    2    11  128    20   22    28
2     4     0  321    3  246   23    13    2   214  109    80
3     0     0    0    0    0    0     0    0     0    0     0
4     1     0    9    0  533    0     1    0    13    1  1075
5     2     0    0   17    2  500     3    0     3   62     3
6     0     0    1    0    6    1  2966    0    13    2    78
7     0     0   19  561    0    1    30  502    25   21     5
8     0     0    0   74    2   12     6    0  1267    8     1
9     4     1  147   33   11  226     4    1    87  614     9
10    0     0    0    0   37    0     1    0     0    0  1608
better model found
persisted
after epoch: 4,now: 2024-08-04 05:00:44.814629,epoch time: 0:40:39.018198,used: 2:55:32.511599,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95930547, 'precision': 0.8974796, 'recall': 0.8452451, 'specificity': 0.9954641, 'f1': 0.866189, 'auroc': 0.9970139}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     6    0    0     7     1     3    1     11
1     0  1271    0    12    0    0     1    40     4    0      3
2     4     0  170     3   47    1     2    18    14   47      6
3     0     0    0  8238    0    6     1    96    97    0      1
4     6     0   18     2  288    0     3     6    24    2    190
5     3     0    0    58    0  395     0     0    15   49      1
6    11     0    0     2    1    0  1878     0     3    0     12
7     0     7    0   179    1    0     1  7014    42    0     19
8     1     0    3    70    3    0     0    58  3107    0     54
9     8     0   29    17    1   65     3     4    17  347      2
10   49     0    0    10   10    2    13     4    10    1  12693
---- Validation: 
scalar performance:
{'acc': 0.9591815, 'precision': 0.90024585, 'recall': 0.84549475, 'specificity': 0.99543595, 'f1': 0.86731976, 'auroc': 0.9971433}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     7    0    1    10     0     2    0     17
1     0  1270    0    11    0    0     0    42     5    0      4
2     3     0  167     2   40    2     3    22    17   48      8
3     1     0    0  8257    0    2     1    83    94    2      0
4     7     0   13     1  294    1     5     4    23    3    188
5     0     0    0    56    0  401     0     0    12   51      1
6    14     0    0     6    0    0  1875     0     7    0      6
7     0     8    0   201    1    0     2  6986    38    0     29
8     2     0    3    65    3    0     1    50  3112    1     59
9     7     0   24    15    0   73     1     4    16  352      1
10   43     1    1     8   15    2     9     6    12    0  12699
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70587003, 'precision': 0.65691936, 'recall': 0.5936805, 'specificity': 0.97051466, 'f1': 0.5730089, 'auroc': 0.8692642}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1035     0   0   48    0    9    48    12     7    4     7
1      1  1150   0   35    0    0     2   259     1    0    51
2     13     0  38   25  154   29    99    51   347   41   218
3      0     0   0    0    0    0     0     0     0    0     0
4      3     0   1    0  184    0     9     2    12    0  1422
5      7     0   0  137    0  379     5     0     8   51     5
6      0     0   0    7    0    0  3047     1     2    0    10
7      0     0   0   62    0    1     3  1092     1    0     5
8      0     0   0  150    1    0     7     4  1205    2     1
9     26     1  38  238    6  149    47    76   207  320    29
10     0     0   0    0    4    0     3     0     0    0  1639
better model found
persisted
after epoch: 5,now: 2024-08-04 05:41:16.993555,epoch time: 0:40:32.178926,used: 3:36:04.690525,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9564159, 'precision': 0.89239305, 'recall': 0.85659105, 'specificity': 0.9951043, 'f1': 0.86973304, 'auroc': 0.9974929}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    1    11    1    0     1     3     1    0     37
1     0  1291    0    10    0    0     0    29     1    0      0
2     1     0  243     1   18    3     0    11     1   32      2
3     0     2    1  8297    0    4     0   110    24    0      0
4     4     1   52     3  316    3     0     6     5    2    147
5     0     0    1    44    0  437     0     1     4   33      1
6    34     2    2    16    2    1  1804     7     3    1     36
7     0     9    0   159    1    0     1  7084     5    0      5
8     1     2    8   180   13    3     0   194  2834    2     58
9     1     0   80    12    0   92     0     6     3  298      1
10   10     1    1    10   23    1     1    17    13    0  12715
---- Validation: 
scalar performance:
{'acc': 0.9568276, 'precision': 0.8932736, 'recall': 0.8592448, 'specificity': 0.99515855, 'f1': 0.87167275, 'auroc': 0.9973375}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     5    0    2     2     5     0    1     32
1     0  1286    0     8    0    0     0    37     1    0      0
2     1     0  243     2   16    2     0    13     2   31      2
3     0     1    0  8293    0    6     0   113    27    0      0
4     3     1   51     1  323    2     0     8     4    1    145
5     1     0    2    45    0  437     0     0     3   32      1
6    31     3    2    15    6    1  1804    10     2    1     33
7     0    14    1   158    1    0     1  7079     4    0      7
8     1     1   10   185   14    0     0   189  2845    0     51
9     5     0   79    16    1   85     0     7     0  299      1
10   11     2    3     9   23    2     3    12     5    0  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7304974, 'precision': 0.67718446, 'recall': 0.6257504, 'specificity': 0.97331583, 'f1': 0.61698616, 'auroc': 0.8734414}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1074     0    0   34    1   12     8    29     2    4     6
1      0  1249    0   33    1    0     0   204     0    1    11
2      2     1  280   44  280   44     9    87   128   35   105
3      0     0    0    0    0    0     0     0     0    0     0
4      1     2    5    0  313    0     3     1    11    0  1297
5      3     0    1  146    0  413     1     1     1   22     4
6      1     0    0   30    4    0  2985     6    14    0    27
7      0     0    0   34    0    1     0  1126     0    0     3
8      0     0    3  200    3    2     1    33  1126    1     1
9     13     8  259  204   10  213     1   128    41  240    20
10     0     0    0    0    8    0     2     0     1    0  1635
early stop counter: 1
val acc:0.9568275809288025, best validation acc: 0.9591814875602722, corresponding to test acc:                         0.7058700323104858 / 0.7586930394172668
after epoch: 6,now: 2024-08-04 06:22:01.471333,epoch time: 0:40:44.477778,used: 4:16:49.168303,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9666631, 'precision': 0.90420806, 'recall': 0.89190316, 'specificity': 0.99632955, 'f1': 0.89743775, 'auroc': 0.9985347}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    1     4    1    0     0     3     0    1     25
1     0  1300    0     5    0    0     0    21     3    0      2
2     0     0  216     2   46    3     1     5     1   36      2
3     1     7    0  8303    0   10     1    67    49    0      1
4     2     0   18     0  406    2     0     1     9    1    100
5     0     0    1     9    0  464     0     0     4   41      1
6    23     1    1     3    0    3  1862     3     1    1     10
7     0    14    3   205    1    1     1  6996    32    0      9
8     2     1    3    79   12    3     0    47  3072    2     74
9     2     0   44     3    0   83     0     1     5  355      0
10   11     0    1     7   50    2     6     5     4    0  12708
---- Validation: 
scalar performance:
{'acc': 0.96597564, 'precision': 0.9058528, 'recall': 0.89165384, 'specificity': 0.99624074, 'f1': 0.89802206, 'auroc': 0.9985398}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     1    1     2    1    0     0     1     0    3     25
1     0  1303    0     1    0    0     0    25     3    0      0
2     1     0  207     1   43    2     0     3     3   49      3
3     0     4    2  8286    0   13     1    67    65    1      1
4     4     1   15     0  405    2     3     4     4    1    100
5     0     0    1    16    0  464     0     0     3   36      1
6    27     1    1     5    1    0  1856     1     2    1     13
7     0     7    1   217    2    0     1  6988    32    1     16
8     1     1    1    80   15    3     0    31  3083    0     81
9     1     0   34     5    1   78     0     0     4  370      0
10    9     0    1     8   52    2    10     3     9    0  12702
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76149166, 'precision': 0.6838639, 'recall': 0.65596056, 'specificity': 0.9760705, 'f1': 0.65066993, 'auroc': 0.87999696}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1084     0    0   12    0   19    16    13     2   16     8
1      1  1260    1   39    0    0     8   156     3    4    27
2      4     0  206   11  382   42    63    16   111   72   108
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    4    0  454    0    11     0     9    1  1152
5      4     0    0   47    0  459     4     0     1   71     6
6      0     0    0    1    0    0  3061     1     1    0     3
7      1     0    1   83    0    1     5  1066     1    0     6
8      0     0    0  133    5    8    20     3  1191    5     5
9      9     3  227   68   13  212    12    13    78  483    19
10     0     0    0    0   25    0     1     0     0    0  1620
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-04 07:02:32.186641,epoch time: 0:40:30.715308,used: 4:57:19.883611,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9694992, 'precision': 0.92393184, 'recall': 0.88976216, 'specificity': 0.9966421, 'f1': 0.9050392, 'auroc': 0.9985077}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     2    0    0     1     2     3    1     40
1     0  1301    0     0    0    0     0    25     5    0      1
2     0     0  200     3   48    2     0     4     9   42      4
3     0     1    0  8171    0    8     1   174    83    1      0
4     1     0   11     1  383    0     1     2    18    1    121
5     0     0    1    15    0  436     0     0     6   62      1
6     4     0    1     1    1    0  1876     3     5    0     17
7     0    14    0    65    2    0     1  7153    22    1      4
8     1     0    2    47    6    0     0    65  3155    1     18
9     0     0   22     5    3   43     0     1     6  412      1
10    6     0    1     8   30    1     2     4    25    0  12715
---- Validation: 
scalar performance:
{'acc': 0.9693192, 'precision': 0.92144287, 'recall': 0.8885894, 'specificity': 0.99663305, 'f1': 0.9035821, 'auroc': 0.99836475}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     3    0    0     2     1     5    2     41
1     0  1302    0     1    0    0     0    25     3    0      1
2     0     0  216     2   38    0     0     7     4   41      4
3     1     3    0  8160    0   12     0   173    91    0      0
4     2     0   13     0  375    1     1     3    17    0    127
5     0     0    0    18    1  425     0     0     4   70      3
6     7     0    0     1    1    0  1878     2     4    0     15
7     0    11    0    63    1    0     2  7152    29    0      7
8     1     0    4    33    7    0     0    56  3185    0     10
9     0     0   26     3    4   51     0     3     7  399      0
10    5     0    1     6   22    0     4    10    31    0  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7252501, 'precision': 0.6656621, 'recall': 0.6076649, 'specificity': 0.9725082, 'f1': 0.5951394, 'auroc': 0.867037}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1070     0    0   34    0    1    15    23     7   14     6
1      0  1252    0   29    0    0     0   164    10    0    44
2      9     1   82   21  191   15    25    27   412   39   193
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    0  310    0    10     0    31    0  1281
5      7     0    0  179    0  296     2     0    21   82     5
6      1     0    0    8    1    0  2973     5    37    0    42
7      0     0    1   31    0    0     1  1118    10    0     3
8      1     0    0   75    0    0     1     2  1289    2     0
9     15     3  106  167   17   97    11    39   313  341    28
10     0     0    0    0    9    0     1     0     1    0  1635
better model found
persisted
after epoch: 8,now: 2024-08-04 07:43:20.259221,epoch time: 0:40:48.072580,used: 5:38:07.956191,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97169304, 'precision': 0.92979866, 'recall': 0.8836351, 'specificity': 0.9968371, 'f1': 0.90389097, 'auroc': 0.99851465}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     1    0    0     9     1     3    0     36
1     0  1309    0     3    0    0     0    16     2    0      1
2     1     0  208     0   37    0     1     8     8   46      2
3     2     0    0  8295    0    2     0    81    58    2      0
4     3     0   14     2  338    1     3     4    20    2    152
5     2     0    1    37    0  435     0     0     6   38      2
6     3     0    0     1    0    0  1885     2     4    1     11
7     0    13    0    89    1    0     2  7133    21    0      4
8     2     0    0    67    3    1     0    57  3145    1     18
9     6     0   24     9    0   52     2     0     3  397      0
10    4     0    1     7    9    0     7     9    17    0  12740
---- Validation: 
scalar performance:
{'acc': 0.97097766, 'precision': 0.9311569, 'recall': 0.87971544, 'specificity': 0.9967368, 'f1': 0.9019405, 'auroc': 0.99837893}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     0    0    0     5     2     2    0     43
1     0  1311    0     4    0    0     0    15     2    0      0
2     1     0  201     1   36    0     1     7    10   51      4
3     1     2    0  8307    0    1     0    73    56    0      0
4     2     0    7     2  338    2     0     3    21    3    161
5     0     0    0    40    0  433     0     0     5   42      1
6     7     0    1     2    2    0  1882     2     4    0      8
7     0    16    0    89    1    0     1  7132    19    1      6
8     0     0    0    75    1    1     5    61  3126    1     26
9     2     0   21     9    0   55     4     0     6  395      1
10    5     0    1     7   11    0     9    10     9    0  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.703981, 'precision': 0.6514716, 'recall': 0.58555675, 'specificity': 0.9700737, 'f1': 0.55587995, 'auroc': 0.84730244}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1017     0   0   15   0    1    81    36    12    1     7
1      1  1250   0   29   0    0     2   188     4    0    25
2      8     0  46   15  94   11    97    75   416   18   235
3      0     0   0    0   0    0     0     0     0    0     0
4      0     0   0    0  62    0    17     2    26    0  1526
5     14     0   0  180   0  293    15     0    28   45    17
6      0     0   0    3   0    0  3041     2     1    0    20
7      0     0   0   26   0    0     0  1133     2    0     3
8      0     0   0   70   0    0     8    17  1272    2     1
9     31     2  35  129   2  101    52   124   322  305    34
10     0     0   0    0   0    0     2     0     1    0  1643
better model found
persisted
after epoch: 9,now: 2024-08-04 08:24:13.003240,epoch time: 0:40:52.744019,used: 6:19:00.700210,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97332513, 'precision': 0.9268949, 'recall': 0.9046332, 'specificity': 0.99707556, 'f1': 0.9124125, 'auroc': 0.99901074}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    0    0     4     1     0    1     11
1     0  1302    1     4    0    0     0    19     5    0      1
2     2     0  216     0   28    0     0     1     3   55      7
3     0     2    0  8267    0   36     2    64    59    4      1
4     3     0   13     0  357    2     3     2    14    1    144
5     0     0    0     2    0  430     0     0     2   86      1
6     8     0    0     2    0    1  1887     0     2    1      7
7     1     5    0   132    1    0     2  7065    46    6      5
8     1     0    2    30    3    8     0    23  3199    6     24
9     0     0   18     1    0   14     0     0     2  455      3
10   11     0    0     7   14    2     7     4    11    2  12736
---- Validation: 
scalar performance:
{'acc': 0.9736793, 'precision': 0.92961997, 'recall': 0.90481436, 'specificity': 0.99710065, 'f1': 0.9138502, 'auroc': 0.9989587}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    0    0     8     0     0    2      9
1     0  1301    0     5    0    0     0    20     4    0      2
2     3     0  211     0   32    0     1     4     1   51      9
3     2     1    0  8278    0   28     0    55    70    5      1
4     4     0   11     1  358    1     2     1     9    1    151
5     0     0    0     3    0  439     0     0     1   77      1
6     8     0    0     0    0    0  1889     0     2    1      8
7     0     6    1   125    1    0     2  7067    51    4      8
8     2     1    1    31    3    2     0    23  3198    9     26
9     0     0   18     0    1   17     0     0     0  455      2
10    9     0    1     7   12    1    14     2     8    1  12741
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7166445, 'precision': 0.66705143, 'recall': 0.60087776, 'specificity': 0.9714214, 'f1': 0.5910369, 'auroc': 0.85907835}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   981     0   0   43    0    3    78    23     2   33     7
1     1  1189   0   36    0    0    15   222     7    1    28
2     5     0  85   32  171   18   126    27   283   66   202
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  184    0    28     1    19    0  1401
5     4     0   0   82    0  316     5     0     6  175     4
6     1     0   0    6    0    0  3054     0     1    0     5
7     0     0   0   95    0    1     5  1054     6    0     3
8     0     0   0  129    0    0     8    10  1219    3     1
9     9     1  54  155    7  105    34    52   159  529    32
10    0     0   0    0    4    0     9     0     1    0  1632
better model found
persisted
after epoch: 10,now: 2024-08-04 09:04:41.078545,epoch time: 0:40:28.075305,used: 6:59:28.775515,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:59:28.775515 at 2024-08-04 09:04:41.078545
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7166445, 'precision': 0.66705143, 'recall': 0.60087776, 'specificity': 0.9714214, 'f1': 0.5910369, 'auroc': 0.85907835}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   981     0   0   43    0    3    78    23     2   33     7
1     1  1189   0   36    0    0    15   222     7    1    28
2     5     0  85   32  171   18   126    27   283   66   202
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  184    0    28     1    19    0  1401
5     4     0   0   82    0  316     5     0     6  175     4
6     1     0   0    6    0    0  3054     0     1    0     5
7     0     0   0   95    0    1     5  1054     6    0     3
8     0     0   0  129    0    0     8    10  1219    3     1
9     9     1  54  155    7  105    34    52   159  529    32
10    0     0   0    0    4    0     9     0     1    0  1632
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76149166, 'precision': 0.6838639, 'recall': 0.65596056, 'specificity': 0.9760705, 'f1': 0.65066993, 'auroc': 0.87999696}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1084     0    0   12    0   19    16    13     2   16     8
1      1  1260    1   39    0    0     8   156     3    4    27
2      4     0  206   11  382   42    63    16   111   72   108
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    4    0  454    0    11     0     9    1  1152
5      4     0    0   47    0  459     4     0     1   71     6
6      0     0    0    1    0    0  3061     1     1    0     3
7      1     0    1   83    0    1     5  1066     1    0     6
8      0     0    0  133    5    8    20     3  1191    5     5
9      9     3  227   68   13  212    12    13    78  483    19
10     0     0    0    0   25    0     1     0     0    0  1620
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051368_instance_wise_predictions.txt
accuracy from prediction file 0.7166445112992373
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/3.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4044 MiB |  18021 MiB | 779092 GiB | 779088 GiB |
|       from large pool |   4021 MiB |  17987 MiB | 775089 GiB | 775085 GiB |
|       from small pool |     23 MiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   4044 MiB |  18021 MiB | 779092 GiB | 779088 GiB |
|       from large pool |   4021 MiB |  17987 MiB | 775089 GiB | 775085 GiB |
|       from small pool |     23 MiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  17985 MiB | 777591 GiB | 777587 GiB |
|       from large pool |   4013 MiB |  17952 MiB | 773592 GiB | 773588 GiB |
|       from small pool |     22 MiB |     35 MiB |   3999 GiB |   3999 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19670 MiB |  19670 MiB |  19670 MiB |      0 B   |
|       from large pool |  19632 MiB |  19632 MiB |  19632 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 685581 KiB |   2223 MiB | 357524 GiB | 357523 GiB |
|       from large pool | 672384 KiB |   2216 MiB | 353477 GiB | 353477 GiB |
|       from small pool |  13197 KiB |     18 MiB |   4046 GiB |   4046 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   47215 K  |   47212 K  |
|       from large pool |     502    |     727    |   20667 K  |   20667 K  |
|       from small pool |    3168    |    4690    |   26547 K  |   26544 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   47215 K  |   47212 K  |
|       from large pool |     502    |     727    |   20667 K  |   20667 K  |
|       from small pool |    3168    |    4690    |   26547 K  |   26544 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     414    |     414    |     414    |       0    |
|       from large pool |     395    |     395    |     395    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     218    |    1220    |   23372 K  |   23371 K  |
|       from large pool |     181    |     283    |   12318 K  |   12317 K  |
|       from small pool |      37    |    1039    |   11053 K  |   11053 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18021 MiB | 779092 GiB | 779092 GiB |
|       from large pool |  16640 KiB |  17987 MiB | 775089 GiB | 775089 GiB |
|       from small pool |      0 KiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18021 MiB | 779092 GiB | 779092 GiB |
|       from large pool |  16640 KiB |  17987 MiB | 775089 GiB | 775089 GiB |
|       from small pool |      0 KiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  17985 MiB | 777591 GiB | 777591 GiB |
|       from large pool |  16640 KiB |  17952 MiB | 773592 GiB | 773592 GiB |
|       from small pool |      0 KiB |     35 MiB |   3999 GiB |   3999 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4714 MiB |  19670 MiB |  19670 MiB |  14956 MiB |
|       from large pool |   4678 MiB |  19632 MiB |  19632 MiB |  14954 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2223 MiB | 357526 GiB | 357526 GiB |
|       from large pool |  24320 KiB |   2216 MiB | 353480 GiB | 353480 GiB |
|       from small pool |      0 KiB |     30 MiB |   4046 GiB |   4046 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20667 K  |   20667 K  |
|       from small pool |       0    |    4690    |   26547 K  |   26547 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20667 K  |   20667 K  |
|       from small pool |       0    |    4690    |   26547 K  |   26547 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     202    |     414    |     414    |     212    |
|       from large pool |     184    |     395    |     395    |     211    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   23373 K  |   23373 K  |
|       from large pool |       3    |     283    |   12318 K  |   12318 K  |
|       from small pool |       0    |    1039    |   11054 K  |   11054 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18021 MiB | 779092 GiB | 779092 GiB |
|       from large pool |  16640 KiB |  17987 MiB | 775089 GiB | 775089 GiB |
|       from small pool |      0 KiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18021 MiB | 779092 GiB | 779092 GiB |
|       from large pool |  16640 KiB |  17987 MiB | 775089 GiB | 775089 GiB |
|       from small pool |      0 KiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  17985 MiB | 777591 GiB | 777591 GiB |
|       from large pool |  16640 KiB |  17952 MiB | 773592 GiB | 773592 GiB |
|       from small pool |      0 KiB |     35 MiB |   3999 GiB |   3999 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4714 MiB |  19670 MiB |  19670 MiB |  14956 MiB |
|       from large pool |   4678 MiB |  19632 MiB |  19632 MiB |  14954 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2223 MiB | 357526 GiB | 357526 GiB |
|       from large pool |  24320 KiB |   2216 MiB | 353480 GiB | 353480 GiB |
|       from small pool |      0 KiB |     30 MiB |   4046 GiB |   4046 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20667 K  |   20667 K  |
|       from small pool |       0    |    4690    |   26547 K  |   26547 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20667 K  |   20667 K  |
|       from small pool |       0    |    4690    |   26547 K  |   26547 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     202    |     414    |     414    |     212    |
|       from large pool |     184    |     395    |     395    |     211    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   23373 K  |   23373 K  |
|       from large pool |       3    |     283    |   12318 K  |   12318 K  |
|       from small pool |       0    |    1039    |   11054 K  |   11054 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368

 Experiment start at: 2024-08-04 09:19:40.587233
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.06940460950136185
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92535317, 'precision': 0.8169868, 'recall': 0.7760531, 'specificity': 0.9918172, 'f1': 0.7852811, 'auroc': 0.99199075}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   328     0    8    21    0    0     8    20    13    4     81
1     0  1225    0    19    0    0     0    84     0    0      3
2     2     0  238     2    6    5     1    14    12   32      0
3     0     0    1  7992    0   12     1   363    70    0      0
4     1     0  163     2  169    2     1    11    48   16    126
5     1     0   10    72    0  363     0     0     6   68      1
6    35     1    2    19    0    0  1777    23    12    5     34
7     0     7    2   228    2    1     2  6967    38    0     15
8     0     0   10   335    1    3     0   142  2766    1     38
9     0     0  118    12    1   99     0     5     6  251      1
10    9     1   20     7  102    2     7    51    81    2  12510
---- Validation: 
scalar performance:
{'acc': 0.9261201, 'precision': 0.81365776, 'recall': 0.7752484, 'specificity': 0.99190664, 'f1': 0.7835912, 'auroc': 0.9914397}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   340     0    7    14    1    1     5    22    11    9     73
1     0  1221    0    20    0    0     0    83     3    0      5
2     0     0  238     1    7    5     1    15    10   32      3
3     0     0    0  8010    0   12     0   350    66    2      0
4     1     1  158     1  164    2     0    13    57   13    129
5     2     0   10    61    0  366     0     0     8   73      1
6    35     1    3    14    0    0  1789    22     8    4     32
7     0     6    1   233    2    1     1  6984    25    1     11
8     2     0    7   338    2    3     0   146  2757    0     41
9     3     0  121    15    1  104     1     3    10  234      1
10   11     0   15     9   98    1     6    48    84    4  12520
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.690198, 'precision': 0.6458926, 'recall': 0.57277083, 'specificity': 0.9690837, 'f1': 0.55443174, 'auroc': 0.8667348}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   893     1    5   56    0    0    53    68    50    6    38
1     0  1173    0   34    0    0     1   253     7    0    31
2    16     0  139   15   68   23     4    59   600   19    72
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    3    0  321    0     3     2    83    0  1220
5    20     0    1  173    0  284     6     1    48   56     3
6     0     3    0   27    0    0  2918    16    65    0    38
7     0     0    0    9    0    0     0  1152     0    0     3
8     0     0    0  118    0    0     1    21  1229    0     1
9    34     3  177  140    7  115     9    76   427  134    15
10    0     0    0    0   24    0     0     0     0    0  1622
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 10:02:23.303470,epoch time: 0:42:42.716237,used: 0:42:42.716237,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9461419, 'precision': 0.87025696, 'recall': 0.81464815, 'specificity': 0.99397916, 'f1': 0.8345759, 'auroc': 0.99474144}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   399     0    0    10    1    0     5    14     4    6     44
1     0  1246    0    20    0    0     0    62     0    0      4
2     3     0  127     1   50    0     1    14     4  107      5
3     0     0    0  8154    0   20     0   205    54    2      0
4     3     0   24     0  251    1     0     8    20   25    207
5     2     0    1    25    0  407     0     0     3   82      1
6    18     0    0    11    0    2  1835     9     7    4     22
7     0     6    0   200    1    0     2  6999    38    2     15
8     1     0    2   210    9    5     0   132  2880    9     48
9     1     0   28     4    2   57     1     3     6  389      2
10   18     0    1     7   19    1    10    30    30    2  12676
---- Validation: 
scalar performance:
{'acc': 0.94476396, 'precision': 0.8665637, 'recall': 0.81099206, 'specificity': 0.9938177, 'f1': 0.83108556, 'auroc': 0.99462944}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     0    1    13    0    0     6    13     4    7     41
1     0  1246    0    18    0    0     0    64     1    1      2
2     2     0  130     0   52    2     2    15     2  101      6
3     1     0    0  8134    0   23     0   219    62    1      0
4     4     1   26     0  245    0     0     4    21   24    214
5     0     0    1    28    0  397     0     0     3   91      1
6    20     2    0    19    0    0  1823     8     8    5     23
7     1     4    1   202    1    0     1  7008    32    1     14
8     3     1    6   222    5    5     0   119  2868    5     62
9     3     0   24     7    4   61     1     4     2  386      1
10   19     0    0     7   19    0     5    23    35    3  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.701952, 'precision': 0.62595105, 'recall': 0.59262574, 'specificity': 0.970231, 'f1': 0.57741416, 'auroc': 0.8642724}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   996     1    0   62    1    0    33    42    17    7    11
1     0  1276    0   36    0    0     0   166     1    0    20
2    31     0   95   18  198    6     2    58   285   91   231
3     0     0    0    0    0    0     0     0     0    0     0
4     3     0    0    0   77    0     1     2    14    0  1536
5    11     0    0   91    0  335     1     1    14  135     4
6     0     0    0   45    1    0  2933     3    29    0    56
7     0     0    0   87    0    1     0  1071     1    0     4
8     0     0    0  168    0    2     1     7  1186    2     4
9    31     6  145  123    9   86     5    82   197  418    35
10    0     0    0    0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 10:42:57.004782,epoch time: 0:40:33.701312,used: 1:23:16.417549,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94450986, 'precision': 0.86474425, 'recall': 0.85101855, 'specificity': 0.9941253, 'f1': 0.8538602, 'auroc': 0.9962238}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    0     9    1    0    17     3    10    4     21
1     0  1271    0    11    0    0     0    41     9    0      0
2     2     0  166     2   48    2     0     7    11   74      0
3     1     0    0  8294    0    6     5    66    66    0      0
4     5     1   13     0  368    1     3     1    57   17     73
5     1     0    0    27    0  388     1     0     3  100      1
6    11     0    0     2    1    0  1874     3     7    3      6
7     0    15    0   375    1    0     1  6747   119    2      4
8     2     1    1   194    3    1     0    29  3053    3      8
9     1     0   27     8    3   55     1     1     4  393      0
10   25     0    1     7  204    0    34    19   168    4  12330
---- Validation: 
scalar performance:
{'acc': 0.9439615, 'precision': 0.8604359, 'recall': 0.85199875, 'specificity': 0.9940611, 'f1': 0.85310805, 'auroc': 0.9961877}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     9    2    0    20     3     7    2     18
1     0  1273    0     9    0    0     0    41     9    0      0
2     2     0  165     3   44    2     0     6    11   79      0
3     2     0    1  8294    0   10     5    65    63    0      0
4     5     0   16     1  366    3     2     6    53   18     69
5     0     0    0    26    0  400     0     0     5   89      1
6    10     0    0     2    0    0  1870     3     6    4     13
7     2    15    1   388    1    0     3  6738   111    3      3
8     3     0    4   204    5    4     1    28  3038    0      9
9     2     0   29     9    0   54     1     2     6  390      0
10   24     0    2     8  209    0    28    18   168    5  12334
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7206325, 'precision': 0.66674966, 'recall': 0.5922563, 'specificity': 0.97206235, 'f1': 0.58704317, 'auroc': 0.86167747}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   749     3   0   69    0    0   165    88    62   27     7
1     0  1268   0   31    0    0     0   186    10    0     4
2    11     0  75   19  135   11     9    36   631   57    31
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   1    0  743    0    25     2    99    1   760
5     0     0   1  193    2  289     1     0    37   69     0
6     0     0   0   25    0    0  3015     4    23    0     0
7     0     0   0   39    0    0     2  1115     7    0     1
8     0     0   0   78    0    0     2     2  1288    0     0
9     3     4  66  163   12  135     2    70   450  230     2
10    0     1   0    0   95    0    19     0     3    0  1528
new oracle model saved
early stop counter: 1
val acc:0.943961501121521, best validation acc: 0.9447639584541321, corresponding to test acc:                         0.7019519805908203 / 0.7206324934959412
after epoch: 3,now: 2024-08-04 11:23:32.875133,epoch time: 0:40:35.870351,used: 2:03:52.287900,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95374036, 'precision': 0.8675646, 'recall': 0.8293119, 'specificity': 0.9949086, 'f1': 0.8439637, 'auroc': 0.9967537}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     7    1    0     1     1     0    0     38
1     0  1279    0    10    0    0     0    37     4    0      1
2     5     1  146     0  119    1     1     7     4   24      4
3     0     1    0  8125    1    1     2   264    41    2      0
4     4     0    3     3  374    0     0     2     9    5    139
5     0     0    2    32    2  304     0     0     5  174      2
6    21     0    1    11    1    1  1844     2     3    1     21
7     2     9    1    92    1    0     2  7108    25    1     23
8     3     1    2   152   11    2     0    99  2969    2     54
9     2     0   85     7   10   25     1     5     1  351      6
10    7     0    1     7   48    1     2     9     8    0  12712
---- Validation: 
scalar performance:
{'acc': 0.95220006, 'precision': 0.8648658, 'recall': 0.8245335, 'specificity': 0.99472994, 'f1': 0.8400263, 'auroc': 0.9966833}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0    10    0    0     3     5     1    0     30
1     0  1277    0     9    0    0     0    41     4    0      1
2     3     0  145     2  130    1     1     5     0   18      7
3     0     0    0  8124    0    4     1   253    55    3      0
4     4     0    5     2  358    0     0     2    14    4    150
5     3     0    0    31    1  302     0     0     5  178      1
6    15     0    1     9    1    1  1853     5     3    0     20
7     2     8    1   104    3    0     1  7099    17    2     28
8     4     0    3   153    9    1     0    93  2972    0     61
9     5     0   85    10   11   19     1     4     4  345      9
10   12     0    0     8   52    1     3    15    16    0  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68711954, 'precision': 0.62479365, 'recall': 0.5676272, 'specificity': 0.96884984, 'f1': 0.5546391, 'auroc': 0.85654324}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1020     2    0   49    3    0    16    42    21    5    12
1      0  1269    0   22    0    0     0   190     2    0    16
2     23     0   31   28  339    3     3    56   292   19   221
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    0    0  380    0     1     0    10    0  1242
5      7     0    3  253    1  192     0     1    23  111     1
6      1     1    0  129    5    0  2717     9    33    0   172
7      1     0    0   23    0    0     1  1136     0    0     3
8      0     0    0  101    0    0     1    26  1241    0     1
9     16     3  143  200   53   36     2   142   289  204    49
10     0     0    0    0   15    0     0     0     0    0  1631
better model found
persisted
after epoch: 4,now: 2024-08-04 12:04:14.766107,epoch time: 0:40:41.890974,used: 2:44:34.178874,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95475703, 'precision': 0.87541926, 'recall': 0.8721329, 'specificity': 0.9951747, 'f1': 0.8697527, 'auroc': 0.9973993}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     1    2     2    0    0    29     2     2    0     39
1     0  1302    0     5    0    0     0    18     7    0      0
2     1     0  269     1   19    0     1     1     1   19      0
3     0     5    1  8205    2    5     1   109   110    1      0
4     4     1   48     0  366    0     1     5    19    3     92
5     1     0    5    17    0  378     0     0     4  115      1
6     5     1    1     2    1    0  1884     1     3    0     10
7     1    87    9   321    2    0     4  6796    40    0      3
8     0     2    9    64    6    1     2    50  3138    0     21
9     1     0  114     2    2   28     2     2     8  332      1
10    2     2    3     5  115    0    10    17    30    1  12609
---- Validation: 
scalar performance:
{'acc': 0.95230705, 'precision': 0.86744726, 'recall': 0.86263937, 'specificity': 0.9949192, 'f1': 0.8609758, 'auroc': 0.9974506}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    1     2    2    0    32     3     4    2     50
1     0  1306    0     5    0    0     0    16     5    0      0
2     3     0  258     0   26    0     2     1     4   18      0
3     0     7    0  8192    1    6     1   115   117    1      0
4     3     0   51     1  375    1     2     1    15    2     88
5     5     0    3    20    0  371     0     0     6  115      1
6     5     1    1     2    2    0  1873     3     4    0     17
7     0    94    6   309    1    0     3  6794    49    1      8
8     1     4    8    67    9    0     0    43  3139    1     24
9     2     0  124     5    4   29     1     2     6  320      0
10    3     1    3     7  122    0     8    17    47    1  12587
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76205134, 'precision': 0.68817925, 'recall': 0.6318661, 'specificity': 0.9758271, 'f1': 0.6347741, 'auroc': 0.8816829}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   840     0    1   5    6    0   258     9    20   10    21
1     0  1352    2  15    0    0     1   108    12    0     9
2     3     0  383   1  258    2     7    18   263   27    53
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    3   0  688    0     5     0    14    0   923
5     5     0    5  79    1  208     4     0    61  227     2
6     0     0    0   0    0    0  3061     1     2    0     3
7     0     0    0  24    0    1     1  1132     3    0     3
8     0     0    0  19    0    1     2    15  1332    1     0
9    10     1  396  28   12   32     7    50   275  316    10
10    0     0    0   0   65    0     1     0     0    0  1580
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 12:45:06.223710,epoch time: 0:40:51.457603,used: 3:25:25.636477,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9632384, 'precision': 0.9014873, 'recall': 0.88470757, 'specificity': 0.99601245, 'f1': 0.89192027, 'auroc': 0.9978694}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     5    1    0    11     2     1    1     20
1     0  1291    0    10    0    0     0    27     2    0      0
2     2     0  193     0   29    1     1     9     7   70      0
3     0     0    0  8335    0   13     0    56    31    2      0
4     4     0   30     1  398    2     1     3    19    7     73
5     0     0    0    18    0  447     0     0     3   52      1
6     6     0    0     1    1    0  1887     1     3    2      5
7     2     7    0   231    1    0     1  6995    23    2      3
8     2     2    3   203    6    2     2    42  3013    0     21
9     0     0   17     4    0   66     1     6     9  389      1
10   15     2    1     7   83    0    10    19    43    3  12612
---- Validation: 
scalar performance:
{'acc': 0.96233785, 'precision': 0.9004633, 'recall': 0.8809467, 'specificity': 0.99591756, 'f1': 0.88939047, 'auroc': 0.9978576}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     4    0    0     7     3     3    3     17
1     0  1290    0    13    0    0     0    28     1    0      0
2     0     0  194     2   30    0     0     6     6   74      0
3     0     0    0  8337    0   11     0    61    30    1      0
4     3     0   23     0  390    1     1     5    27   11     78
5     1     0    0    18    0  450     0     0     5   46      1
6     9     0    1     3    2    0  1881     0     4    2      6
7     0    11    0   241    1    0     1  6979    27    0      5
8     1     0    1   194    7    3     0    59  3021    0     10
9     0     0   20     7    1   79     2     4     8  371      1
10   15     1    1     9   79    0    15    18    37    3  12618
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7302176, 'precision': 0.6714931, 'recall': 0.6096832, 'specificity': 0.9731391, 'f1': 0.61311966, 'auroc': 0.8753425}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1030     0    0   20    2    0   100    2     3   11     2
1      0  1217    0   29    0    0     2  241     3    0     7
2      7     0  159   24  304    5     8   43   329  100    36
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0    2    0  484    0    11    1    16    1  1116
5      5     0    0  132    1  308     0    0    12  134     0
6      0     0    0   16    1    0  3048    2     0    0     0
7      0     0    0  169    0    1     1  991     1    0     1
8      0     0    0  144    1    1     3   18  1201    1     1
9     10     1  118  191    7  115     4   93   201  385    12
10     0     0    0    0   26    0     5    0     1    0  1614
better model found
persisted
after epoch: 6,now: 2024-08-04 13:26:03.784520,epoch time: 0:40:57.560810,used: 4:06:23.197287,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96599424, 'precision': 0.90735877, 'recall': 0.8840756, 'specificity': 0.99625903, 'f1': 0.8935827, 'auroc': 0.9984956}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0    1    0    10     0     0    1     14
1     0  1281    0    10    0    0     0    34     4    0      3
2     3     0  185     0   70    0     1     1     1   49      2
3     4     0    1  8170    1    9     6   124   120    0      1
4     7     0    5     0  382    0     5     1     4    4    131
5     1     0    0    17    0  427     1     0     2   72      1
6     8     0    0     2    0    0  1883     0     1    3     10
7     5     5    2   102    1    0     6  7053    56    3     29
8     2     0    4    35    8    1     4    25  3131    1     84
9     4     0   30     3    5   39     3     2     0  406      1
10   22     0    1     4   19    1     7     7     4    1  12730
---- Validation: 
scalar performance:
{'acc': 0.96661764, 'precision': 0.90878457, 'recall': 0.8862543, 'specificity': 0.9963287, 'f1': 0.8958727, 'auroc': 0.99843574}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     1    1    0     7     2     0    0     17
1     0  1282    0     6    0    0     1    39     3    0      1
2     2     0  191     0   64    0     1     0     4   49      1
3     2     0    1  8190    1   11     5   109   120    0      1
4     4     0    2     0  381    0     3     1     3    6    139
5     1     0    1    18    0  432     0     0     2   66      1
6     5     0    0     0    0    0  1890     2     2    1      8
7     7     8    3   101    1    0     7  7053    58    2     25
8     5     0    5    33    9    1     7    24  3132    1     79
9     7     0   34     2    4   35     2     2     1  404      2
10   16     0    1     4   25    1    12     5     4    1  12727
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7239208, 'precision': 0.63871056, 'recall': 0.6067838, 'specificity': 0.9723095, 'f1': 0.58949554, 'auroc': 0.8693019}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1096     0   0   13    1    0    47     6     1    5     1
1      3  1193   0   33    0    0     2   243     5    0    20
2     70     0  92   18  257    7    12    35   215   88   221
3      0     0   0    0    0    0     0     0     0    0     0
4      3     0   1    0  137    0    15     1     7    0  1469
5     20     0   0  148    0  286     2     0     4  130     2
6      0     0   0    2    0    0  3062     1     0    0     2
7      2     0   0   59    0    1     2  1097     1    0     2
8      0     0   0   76    0    1     6    18  1257    1    11
9     54     2  99  134   17  133    11    75    94  492    26
10     0     0   0    0    6    0     5     0     0    0  1635
better model found
persisted
after epoch: 7,now: 2024-08-04 14:07:58.386285,epoch time: 0:41:54.601765,used: 4:48:17.799052,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9598673, 'precision': 0.90628326, 'recall': 0.86453986, 'specificity': 0.9954188, 'f1': 0.882237, 'auroc': 0.99790436}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    0     1    2    1     0     0     1    4     47
1     0  1298    0     8    0    0     0    20     3    0      3
2     1     0  188     0   62    1     0     0     6   49      5
3     0     1    1  8352    0    6     0    28    49    0      0
4     4     0    5     1  305    1     0     0    10    2    211
5     0     0    0    12    0  471     0     0     2   34      1
6    30     0    0     3    5    2  1749     2     5    4    108
7     0     9   11   268    8    0     0  6793   145    2     27
8     0     0    3    69    5    1     0     9  3165    4     40
9     0     0   21     2   10   69     0     0     6  384      1
10    4     0    0     8    7    1     1     4    22    2  12744
---- Validation: 
scalar performance:
{'acc': 0.9591547, 'precision': 0.90077615, 'recall': 0.862125, 'specificity': 0.9953654, 'f1': 0.87831974, 'auroc': 0.9979654}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     3    1    1     1     1     2    4     39
1     0  1294    0     6    0    0     0    22     8    0      2
2     2     0  191     0   61    3     0     0     3   46      6
3     0     0    1  8354    0    7     0    25    53    0      0
4     2     0    7     0  294    2     0     1    15    1    217
5     0     0    1    15    0  458     0     0     3   43      1
6    44     0    1     3    2    1  1756     1     4    4     92
7     1     8   16   295    6    0     1  6766   144    0     28
8     0     0    2    59    3    4     0    13  3177    2     36
9     0     0   23     2    7   71     0     0     4  385      1
10    3     0    0     7    8    2     2     0    21    1  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67284685, 'precision': 0.6142196, 'recall': 0.5779325, 'specificity': 0.96743375, 'f1': 0.5645534, 'auroc': 0.8375238}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   985     0    0   59    1   14     1    3    13   70    24
1     3  1190   10   42    2    1     0  172    13    3    63
2    11     0   65   22  185   22     0    7   187   86   430
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    1    1   47    0     1    0     7    1  1575
5     0     0    0  132    2  403     0    0     7   47     1
6     1     0    0   91    0    0  2692    1    15    0   267
7     2     0    0  227    0    1     0  919     9    0     6
8     0     0    0   99    0    2     1    1  1261    1     5
9     8     0  117  156   26  214     0   18   132  411    55
10    0     0    0    0    2    0     0    0     0    0  1644
early stop counter: 1
val acc:0.9591547250747681, best validation acc: 0.9666176438331604, corresponding to test acc:                         0.7239208221435547 / 0.7620513439178467
after epoch: 8,now: 2024-08-04 14:51:26.917479,epoch time: 0:43:28.531194,used: 5:31:46.330246,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9697399, 'precision': 0.92439246, 'recall': 0.9086542, 'specificity': 0.99669445, 'f1': 0.91571546, 'auroc': 0.9988017}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     3    0    0     1     1     9    1     24
1     0  1308    0     8    0    0     0    15     1    0      0
2     1     0  253     1   15    0     1     5     8   27      1
3     0     2    0  8355    0   11     1    22    48    0      0
4     2     0   34     1  402    1     0     2    18    2     77
5     0     0    0    17    0  460     0     0     4   39      1
6     6     0    1     5    0    0  1874     0     5    0     16
7     0    12    0   296    1    0     1  6903    43    0      4
8     0     0    2    57    4    0     1    34  3195    0      2
9     1     0   40     5    1   59     0     3     4  380      0
10    4     1    3    10   40    0     4    10    52    0  12671
---- Validation: 
scalar performance:
{'acc': 0.969239, 'precision': 0.92651844, 'recall': 0.91082066, 'specificity': 0.99662626, 'f1': 0.9176034, 'auroc': 0.99887884}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     3    0    0     0     1     6    1     23
1     0  1305    0     7    0    0     0    16     4    0      0
2     1     0  261     1   14    2     0     2     5   26      0
3     0     3    0  8360    0    5     0    21    51    0      0
4     4     0   36     1  391    2     0     1    20    1     83
5     0     0    0    15    0  467     0     0     4   34      1
6     7     0    0     6    1    0  1874     0     5    2     13
7     0    12    0   315    1    0     1  6879    53    0      4
8     0     0    2    59    3    1     0    41  3183    0      7
9     0     0   34     6    1   63     0     1     5  382      1
10    5     0    2     9   36    2     2     8    48    0  12684
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7125166, 'precision': 0.65963346, 'recall': 0.5966966, 'specificity': 0.9714003, 'f1': 0.57558155, 'auroc': 0.86024064}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1101     0   0   14    1    0    20   18     6    5     5
1      0  1248   0   29    0    0     0  205     6    0    11
2     28     0  95   23   90   13     1   55   520   42   148
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   1    0  195    0     4    2    33    0  1398
5     13     0   3  133    0  349     0    0    21   72     1
6      1     0   0   16    0    0  3041    3     3    0     3
7      2     0   0  192    0    1     0  967     0    0     2
8      0     0   0   66    0    1     1   10  1291    0     1
9     27     0  89  177    2  161     0  115   283  259    24
10     0     0   0    0    6    0     1    0     1    0  1638
better model found
persisted
after epoch: 9,now: 2024-08-04 15:33:23.701628,epoch time: 0:41:56.784149,used: 6:13:43.114395,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9672785, 'precision': 0.8963282, 'recall': 0.91423947, 'specificity': 0.9965883, 'f1': 0.9025816, 'auroc': 0.998895}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    3    0     3     2     1    2     15
1     1  1313    0     0    0    0     2    12     4    0      0
2     1     0  276     0   28    0     0     1     0    4      2
3    17     3    1  8019    1   35    65   137   158    2      0
4     4     1   19     0  460    0     0     1     3    0     51
5     2     0    2     5    1  452     0     0     3   54      1
6     9     0    1     0    4    0  1862     0     6    1     25
7     8    23    5    44    1    0     9  7116    49    0      9
8     1     0   12    20   21    1     1    41  3158    0     40
9     2     0  104     2    8   45     1     0     4  326      1
10    7     1    1     4   47    0     3     9     5    0  12715
---- Validation: 
scalar performance:
{'acc': 0.96816903, 'precision': 0.90164995, 'recall': 0.9182868, 'specificity': 0.9966613, 'f1': 0.90772545, 'auroc': 0.99897575}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     1    2    0     2     0     1    1     24
1     1  1310    0     0    0    0     3    14     4    0      0
2     1     0  277     0   29    0     1     0     1    3      0
3    14     5    4  8020    1   32    58   147   157    2      0
4     2     0   18     0  458    0     1     1     2    1     56
5     0     0    4     3    1  456     0     0     6   51      0
6     9     0    1     0    2    0  1871     1     3    1     20
7    11    24    4    49    2    0     6  7114    47    0      8
8     1     0   14    19   16    1     1    33  3167    1     43
9     2     0   93     0    4   43     0     1     2  347      1
10    6     0    2     4   48    0     1     9     3    0  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72993773, 'precision': 0.6532301, 'recall': 0.6199366, 'specificity': 0.9724664, 'f1': 0.6063934, 'auroc': 0.86597687}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   925     0    0   0    2    0   226     1     1   11     4
1     2  1188    0  14    0    2     3   265    14    0    11
2    17     2  193   4  265    9    20    39   274   45   147
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    2   0  242    0     9     1    10    0  1369
5     5     0    1  47   10  396    14     0    16  101     2
6     0     0    0   0    0    0  3064     1     0    0     2
7     1     0    0  14    0    1    38  1104     4    0     2
8     0     0    0  50    1    1     6     9  1300    1     2
9    23     3  201  57   18  135    42    47   202  385    24
10    0     0    0   0    8    0     2     0     0    0  1636
early stop counter: 1
val acc:0.9681690335273743, best validation acc: 0.9692389965057373, corresponding to test acc:                         0.7125166058540344 / 0.7620513439178467
after epoch: 10,now: 2024-08-04 16:18:34.818407,epoch time: 0:45:11.116779,used: 6:58:54.231174,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:58:54.231174 at 2024-08-04 16:18:34.818407
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7125166, 'precision': 0.65963346, 'recall': 0.5966966, 'specificity': 0.9714003, 'f1': 0.57558155, 'auroc': 0.86024064}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1101     0   0   14    1    0    20   18     6    5     5
1      0  1248   0   29    0    0     0  205     6    0    11
2     28     0  95   23   90   13     1   55   520   42   148
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   1    0  195    0     4    2    33    0  1398
5     13     0   3  133    0  349     0    0    21   72     1
6      1     0   0   16    0    0  3041    3     3    0     3
7      2     0   0  192    0    1     0  967     0    0     2
8      0     0   0   66    0    1     1   10  1291    0     1
9     27     0  89  177    2  161     0  115   283  259    24
10     0     0   0    0    6    0     1    0     1    0  1638
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76205134, 'precision': 0.68817925, 'recall': 0.6318661, 'specificity': 0.9758271, 'f1': 0.6347741, 'auroc': 0.8816829}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   840     0    1   5    6    0   258     9    20   10    21
1     0  1352    2  15    0    0     1   108    12    0     9
2     3     0  383   1  258    2     7    18   263   27    53
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    3   0  688    0     5     0    14    0   923
5     5     0    5  79    1  208     4     0    61  227     2
6     0     0    0   0    0    0  3061     1     2    0     3
7     0     0    0  24    0    1     1  1132     3    0     3
8     0     0    0  19    0    1     2    15  1332    1     0
9    10     1  396  28   12   32     7    50   275  316    10
10    0     0    0   0   65    0     1     0     0    0  1580
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_19_39_seed_1_24051368_instance_wise_predictions.txt
accuracy from prediction file 0.712516616525572
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4046 MiB |  18021 MiB |   1521 TiB |   1521 TiB |
|       from large pool |   4023 MiB |  17987 MiB |   1513 TiB |   1513 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4046 MiB |  18021 MiB |   1521 TiB |   1521 TiB |
|       from large pool |   4023 MiB |  17987 MiB |   1513 TiB |   1513 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  17985 MiB |   1518 TiB |   1518 TiB |
|       from large pool |   4013 MiB |  17952 MiB |   1510 TiB |   1510 TiB |
|       from small pool |     22 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19774 MiB |  19774 MiB |  34730 MiB |  14956 MiB |
|       from large pool |  19736 MiB |  19736 MiB |  34690 MiB |  14954 MiB |
|       from small pool |     38 MiB |     38 MiB |     40 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1241 MiB |   2223 MiB |    770 TiB |    770 TiB |
|       from large pool |   1228 MiB |   2216 MiB |    762 TiB |    762 TiB |
|       from small pool |     12 MiB |     30 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   94431 K  |   94427 K  |
|       from large pool |     502    |     727    |   41335 K  |   41335 K  |
|       from small pool |    3168    |    4690    |   53095 K  |   53092 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   94431 K  |   94427 K  |
|       from large pool |     502    |     727    |   41335 K  |   41335 K  |
|       from small pool |    3168    |    4690    |   53095 K  |   53092 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     414    |     620    |     212    |
|       from large pool |     389    |     395    |     600    |     211    |
|       from small pool |      19    |      19    |      20    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     223    |    1220    |   47718 K  |   47718 K  |
|       from large pool |     183    |     285    |   25434 K  |   25434 K  |
|       from small pool |      40    |    1039    |   22284 K  |   22284 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18021 MiB |   1521 TiB |   1521 TiB |
|       from large pool |  16640 KiB |  17987 MiB |   1513 TiB |   1513 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18021 MiB |   1521 TiB |   1521 TiB |
|       from large pool |  16640 KiB |  17987 MiB |   1513 TiB |   1513 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  17985 MiB |   1518 TiB |   1518 TiB |
|       from large pool |  16640 KiB |  17952 MiB |   1510 TiB |   1510 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5288 MiB |  19774 MiB |  34730 MiB |  29442 MiB |
|       from large pool |   5252 MiB |  19736 MiB |  34690 MiB |  29438 MiB |
|       from small pool |     36 MiB |     38 MiB |     40 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2223 MiB |    770 TiB |    770 TiB |
|       from large pool |  24320 KiB |   2216 MiB |    762 TiB |    762 TiB |
|       from small pool |      0 KiB |     30 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   94431 K  |   94431 K  |
|       from large pool |       2    |     727    |   41335 K  |   41335 K  |
|       from small pool |       0    |    4690    |   53095 K  |   53095 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   94431 K  |   94431 K  |
|       from large pool |       2    |     727    |   41335 K  |   41335 K  |
|       from small pool |       0    |    4690    |   53095 K  |   53095 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     204    |     414    |     620    |     416    |
|       from large pool |     186    |     395    |     600    |     414    |
|       from small pool |      18    |      19    |      20    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   47719 K  |   47719 K  |
|       from large pool |       3    |     285    |   25434 K  |   25434 K  |
|       from small pool |       0    |    1039    |   22284 K  |   22284 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 16:25:23 2024]
Finished job 0.
1 of 1 steps (100%) done
