Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 10:00:18 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313

 Experiment start at: 2024-07-28 10:09:07.037132
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8742508, 'precision': 0.663023, 'recall': 0.5841315, 'specificity': 0.9857551, 'f1': 0.56051004, 'auroc': 0.9669341}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    6     0   0     3   0   26   190    25     7   23    203
1    1  1162   0    11   0   12     5   112    14    2     13
2    0     0   0    23   0    0    14    50     2   85    138
3    0     0   0  6728   0  122    13   917   618   34      4
4    0     0   0     1   2    1    22    12    19   20    462
5    1     0   0    11   0   92     1     7    10  397      1
6    1     0   0     1   0    2  1820    11     6    1     66
7   18    12   0    38   0    2     8  6977   122    2     85
8    1     0   0    22   0    3    10   147  2770    8    334
9    1     0   0     7   0   15     3    24     9  401     33
10   0     1   0     5   0    2    49    11     7    1  12718
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8732112, 'precision': 0.58753246, 'recall': 0.5817583, 'specificity': 0.98564243, 'f1': 0.5588528, 'auroc': 0.96658325}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   16     0   0     2   0   20   190    14    10   18    213
1    0  1161   0     7   0   11    15   110    13    2     13
2    0     0   0    21   0    4     6    49     5   79    148
3    0     0   0  6760   1  131    16   866   632   31      3
4    1     0   0     2   0    2    39     7    22   13    453
5    0     0   0    15   0   79     2     6    13  405      1
6    4     0   0     1   0    5  1803    10     4    4     77
7   14    15   0    37   0    4     6  6973   113    5     98
8    0     0   0    30   0    3     9   143  2762    9    340
9    0     0   0    10   0   21     2    27     9  398     26
10   1     1   0     8   0    0    63    16    12    2  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59777516, 'precision': 0.45037606, 'recall': 0.4637953, 'specificity': 0.9584642, 'f1': 0.40823582, 'auroc': 0.8289058}
confusion matrix:
    0     1   2   3   4    5     6     7     8    9     10
0   62     0   0   1   3   28   606   202    31   52   185
1    1  1121   0   8   0  141    57   116     7   25    23
2    2     1   0   0   0    3    55    61    67   58   768
3    0     0   0   0   0    0     0     0     0    0     0
4    0     0   0   0   0    0    26     0     3    0  1604
5    2     0   0   1   0   53    16    20    11  487     2
6    0     0   0   0   0    0  2842     2     5    2   216
7    2     0   0   0   0    1     3  1152     1    2     3
8    2     0   0   3   0    0    17    73  1155   28    92
9   14     3   0   0   0   37    31   206   104  516   226
10   0     0   0   0   0    0     3     0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 10:52:25.216527,epoch time: 0:43:18.179395,used: 0:43:18.179395,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9118418, 'precision': 0.73923945, 'recall': 0.6708108, 'specificity': 0.9904927, 'f1': 0.6594735, 'auroc': 0.9760207}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   173     1   0     4   0    2   151    29    10   15     98
1     0  1298   0     9   0    3     1    19     2    0      0
2     0    19   0    89   5   12    16    16     3  139     13
3     0    22   0  8143   0   19     5   159    90    0      0
4     1     7   0    75  18    4   135    16    20   23    240
5     0     0   0    58   0  290     0     0     6  166      1
6     1     7   0     4   0    3  1866     6     5    2     14
7     0   363   0   269   1    9     5  6546    56    3      9
8     0     3   0   197   0    2     9   155  2874    8     47
9     0     5   0    12   0   84     0    10     2  376      4
10    2    21   0    20   2    2   188    21    37    4  12497
---- Validation: 
scalar performance:
{'acc': 0.9106594, 'precision': 0.7354653, 'recall': 0.6707149, 'specificity': 0.99039006, 'f1': 0.65810657, 'auroc': 0.9763489}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   175     1   0     8   0    3   151    30     7   12     96
1     0  1305   0    10   0    2     1    13     1    0      0
2     1    21   0    76   6    9    21    21     3  143     11
3     0    22   0  8133   0   16     1   166    99    2      1
4     2     5   0    68  19    6   141    15    17   25    241
5     0     0   0    66   0  283     0     0     5  166      1
6     3     5   0     5   0    1  1871     5     5    2     11
7     1   395   0   297   0    7     6  6500    47    5      7
8     0     4   0   192   1    4     9   140  2893    8     45
9     1     5   0    11   1   79     2    10     4  377      3
10    4    26   0    19   0    4   191    20    38    5  12489
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6762751, 'precision': 0.5687833, 'recall': 0.5564162, 'specificity': 0.9662932, 'f1': 0.5159116, 'auroc': 0.86751646}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   380    20   0    8   0   11   511   156     7   53    24
1     0  1430   0   10   0   19     3    33     0    1     3
2     4    69   0  102  11   13   223   183    61  171   178
3     0     0   0    0   0    0     0     0     0    0     0
4     1    36   0    2  10    2   343     1     6    0  1232
5     3     0   0   27   0  280    10    11     6  254     1
6     0    18   0    7   0   18  3009     9     5    1     0
7     0    22   0    5   0    0     2  1131     0    1     3
8     0     0   0   82   0   12    29    55  1178   11     3
9    14   122   0   21   0   87    21   148    36  678    10
10    0    11   0    0   0    0    65     0     0    0  1570
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 11:34:05.175253,epoch time: 0:41:39.958726,used: 1:24:58.138121,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92650366, 'precision': 0.78130805, 'recall': 0.68271714, 'specificity': 0.9919071, 'f1': 0.68895817, 'auroc': 0.9837016}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   237     1   0     6   0    1    23    39    66    5    105
1     0  1222   0    16   0    0     0    83     4    0      7
2     1     0   0   129   7    0    17    35    10  106      6
3     0     0   0  8076   0   12     0   180   168    1      0
4     0     0   0    67  41    3   191    13    24   13    187
5     0     0   0    55   0  201     1     0     4  259      1
6     4     0   0    10   0    2  1843     5    10    2     31
7     0     4   0   238   0    1     1  6964    47    3      5
8     1     0   0    98   0    0     2   150  3011    4     29
9     0     0   0    20   0   32     1     6    10  423      1
10    5     1   0    21   6    0    59    47    42    3  12611
---- Validation: 
scalar performance:
{'acc': 0.92577237, 'precision': 0.7825331, 'recall': 0.68190706, 'specificity': 0.9918177, 'f1': 0.68778986, 'auroc': 0.982798}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   229     0   0     7   0    2    21    32    79    7    106
1     0  1226   0    19   0    1     1    78     4    0      3
2     0     0   0   126   6    1    19    44    12   98      6
3     0     1   0  8073   0   13     0   181   169    3      0
4     0     0   0    71  35    2   177    20    23   13    198
5     0     0   0    48   0  209     0     0     8  255      1
6     3     0   0     8   0    0  1855     2    10    1     29
7     0     5   0   238   1    0     2  6958    51    4      6
8     1     0   0   112   0    1     4   155  2995    1     27
9     0     0   0    21   0   28     0    12     8  424      0
10    8     1   0    25   4    0    56    37    56    3  12606
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.656895, 'precision': 0.5305465, 'recall': 0.53099334, 'specificity': 0.96498936, 'f1': 0.49304783, 'auroc': 0.8684112}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   550     1   0   15   0    3   152   144   178   39    88
1     0  1254   0   40   2   18     5   158     7    4    11
2     3     3   0  180  32    7   228   101   246   84   131
3     0     0   0    0   0    0     0     0     0    0     0
4     1     1   0    5   3    0   240     3     8    0  1372
5     3     0   0   51   0  131     4     1    24  378     0
6     0     0   0   16   0    1  2854     5   153    0    38
7     0     0   0   50   0    0     5  1102     3    1     3
8     0     0   0   43   0    3     7     8  1304    3     2
9     4     8   0   76   2   22    25   125   305  555    15
10    0     0   0    0   0    0    10     0     0    0  1636
better model found
persisted
after epoch: 3,now: 2024-07-28 12:15:19.195696,epoch time: 0:41:14.020443,used: 2:06:12.158564,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9191727, 'precision': 0.8456649, 'recall': 0.69763225, 'specificity': 0.9912311, 'f1': 0.705931, 'auroc': 0.9843752}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   216     0   0     6   0    1    86    10    50    2    112
1     0  1261   0    18   0    0     1    44     5    0      3
2     0    21   7    65  49    2    30    31    22   85      0
3     0     0   0  8296   0    4     2    55    82    0      1
4     1     2   0    11  51    0   274    12    45    6    137
5     1     4   0    48   0  354     2     0     5  107      0
6     1     0   0     3   0    0  1884     3     6    1     10
7     0    13   0   583   0    0     4  6603    48    2     11
8     1     1   0   207   1    0    10   109  2950    2     14
9     1    11   0    15   1   78     4     7    10  365      0
10    1     0   0    20   5    2   272    18   103    1  12368
---- Validation: 
scalar performance:
{'acc': 0.9190852, 'precision': 0.8201068, 'recall': 0.6964176, 'specificity': 0.99124885, 'f1': 0.70278084, 'auroc': 0.98537177}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   230     1   0     7   1    2    86     3    52    2     99
1     0  1255   0    13   0    0     3    51     8    0      2
2     1    18   5    73  56    1    29    23    17   88      1
3     0     1   0  8271   0    7     3    59    98    1      0
4     1     2   0    18  41    1   291    13    34    7    131
5     1     3   0    59   0  337     2     1     6  109      3
6     2     0   0     2   0    0  1893     0     4    1      6
7     0     8   0   571   0    0    11  6615    48    1     11
8     0     1   0   200   0    1     9   111  2962    1     11
9     0     6   1    14   1   73     4    14     7  372      1
10    7     0   0    16   8    0   262    22   101    1  12379
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64716995, 'precision': 0.6200123, 'recall': 0.52543, 'specificity': 0.96298873, 'f1': 0.494882, 'auroc': 0.8661077}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   394     9   0   39   0    3   221    84   285   16   119
1     1  1264   0   33   2    3    40   138    10    0     8
2     1    14   1   21  44    6   458    93   291   60    26
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    3   2    0   651     1    18    0   957
5     2     5   0   64   0  286    22     4    16  192     1
6     0     1   0    3   0    0  3047     2    14    0     0
7     0     0   0  122   0    0     8  1022     9    1     2
8     0     0   0   60   0    0    18     5  1284    2     1
9     4    32   0   51   8   87    82   154   264  445    10
10    0     0   0    0   0    0   141     0     0    0  1505
early stop counter: 1
val acc:0.9190852046012878, best validation acc: 0.9257723689079285, corresponding to test acc:                         0.6568949818611145 / 0.6762750744819641
after epoch: 4,now: 2024-07-28 13:00:30.561857,epoch time: 0:45:11.366161,used: 2:51:23.524725,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9402825, 'precision': 0.8130214, 'recall': 0.71227336, 'specificity': 0.99324065, 'f1': 0.7359964, 'auroc': 0.9901106}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   235     0   0    14    0    0    10    20    66    4    134
1     0  1267   0    13    0    0     1    37    11    0      2
2     1     0   0   186   27    0     2    29     8   50      9
3     0     0   0  8213    0    5     0   120    98    2      0
4     0     0   0    79  109    0   116     4    16    4    211
5     0     0   0    61    0  296     0     0     6  156      1
6     1     0   0     9    1    0  1838     4     9    1     44
7     0     5   0   172    0    0     2  6991    86    1      6
8     0     0   0    85    0    0     2    68  3111    1     28
9     0     0   1    45    0   30     1    14     9  389      4
10    0     1   0    16    7    0    28    11    35    2  12695
---- Validation: 
scalar performance:
{'acc': 0.9411529, 'precision': 0.8164873, 'recall': 0.7176637, 'specificity': 0.99332273, 'f1': 0.74169135, 'auroc': 0.9903013}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   254     0   0    11    0    0     2    15    54    5    142
1     0  1270   0    14    0    0     0    38    10    0      0
2     0     1   0   172   19    0     4    39     6   61     10
3     0     0   0  8203    0    8     0   124   103    1      1
4     1     0   1    78  119    1    94     7    18    2    218
5     0     0   0    67    0  297     0     0     7  149      1
6     0     1   0    12    2    1  1843     2     6    1     40
7     0     8   0   149    0    0     0  7007    89    1     11
8     0     0   0    88    1    0     2    66  3115    1     23
9     0     1   0    46    0   32     0    15     8  387      4
10    1     1   0    15    7    1    23    14    43    1  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63597566, 'precision': 0.6241726, 'recall': 0.5073304, 'specificity': 0.96376145, 'f1': 0.47645468, 'auroc': 0.87013334}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   287     1   0   58   0    0    15   141   526   21   121
1     0  1336   0   41   0    1     8   101     6    0     6
2     0     4   2  308  52    1    20    32   237   41   318
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    3  10    0    80     0     8    0  1532
5     0     0   0  200   0  171     0     2    16  200     3
6     0     0   0  122   0    0  2887     1    26    0    31
7     0     1   0   13   0    0     1  1145     1    0     3
8     0     0   0   75   0    0     1     9  1278    2     5
9     0    10   1  271   8   29     3   112   346  331    26
10    0     0   0    0   1    0     2     0     0    0  1643
better model found
persisted
after epoch: 5,now: 2024-07-28 13:46:00.821711,epoch time: 0:45:30.259854,used: 3:36:53.784579,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94212866, 'precision': 0.8819966, 'recall': 0.73554945, 'specificity': 0.99358654, 'f1': 0.7458259, 'auroc': 0.99096936}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   250     0   0     3    0    1    23    43     7    2    154
1     0  1272   0     8    0    0     2    38     5    0      6
2     0     2   1   116   48    4    11    11     4  110      5
3     0     2   0  8086    0   26     3   199   120    3      1
4     0     0   0    20  123    3   182     6     9    7    189
5     0     0   0    20    0  425     0     0     2   73      1
6     1     0   0     1    0    0  1881     2     3    1     19
7     0    13   0   106    0    0     3  7080    47    3     10
8     1     1   0    60    2    3    12    97  3069    7     43
9     0     0   0    16    1  106     3     3     4  360      0
10    2     0   0    11    5    2    64    24    18    0  12666
---- Validation: 
scalar performance:
{'acc': 0.9413936, 'precision': 0.78895897, 'recall': 0.7283453, 'specificity': 0.9934988, 'f1': 0.73863184, 'auroc': 0.99116397}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   219     0   0     6    0    0    31    51     9    6    161
1     0  1279   0     6    0    0     1    37     5    0      4
2     0     4   0   115   52    1     9    12     6  105      8
3     0     3   0  8074    0   28     5   207   120    3      0
4     0     0   0    24  117    1   180     6    10    8    193
5     0     0   0    17    0  421     1     0     3   78      1
6     1     0   0     2    0    0  1891     1     2    0     11
7     0    12   0    99    1    0     1  7086    51    3     12
8     0     1   0    73    2    1    11    90  3068    5     45
9     0     1   0    22    0  104     1     3     2  359      1
10    1     1   0    11    6    2    66    16    13    0  12680
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6696285, 'precision': 0.5530462, 'recall': 0.56647515, 'specificity': 0.9666636, 'f1': 0.5235218, 'auroc': 0.8682321}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   424     5   0   20   0   20    50   187    92   94   278
1     0  1309   0   36   1    4     0   133     0    0    16
2     1     3   0  130  48   32   188    78   176   70   289
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    2   5    1    86     1     7    0  1531
5     0     1   0   74   0  465     2     0     6   43     1
6     0     0   0   75   0    0  2924     8    16    0    44
7     0     1   0    9   0    1     0  1150     0    0     3
8     0     0   0  101   0    2     4    18  1241    1     3
9     1     6   0  152   1  227    18    99   186  414    33
10    0     0   0    0   0    0     5     1     1    0  1639
better model found
persisted
after epoch: 6,now: 2024-07-28 14:31:08.110153,epoch time: 0:45:07.288442,used: 4:22:01.073021,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9444296, 'precision': 0.898113, 'recall': 0.72038066, 'specificity': 0.99377143, 'f1': 0.7340541, 'auroc': 0.9933394}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   201     0   0     5    1    1     3   141    27    6     98
1     0  1278   0     6    0    0     0    41     1    0      6
2     0     2   1   117   40    0     2    25     5  107     12
3     0     1   0  8206    0   15     0   123    87    5      1
4     1     0   0    22  133    0   134     3    11   12    223
5     0     0   0    25    0  268     0     0     5  222      1
6     1     0   0     6    0    0  1861     6     3    1     30
7     0    10   0   120    1    0     1  7074    36    1     18
8     1     0   0    67    4    1     2    98  3067    5     51
9     0     0   0    10    0   15     0     7     0  461      0
10    2     0   0    11    3    0    11     8     7    3  12749
---- Validation: 
scalar performance:
{'acc': 0.943801, 'precision': 0.85273194, 'recall': 0.7187938, 'specificity': 0.99369514, 'f1': 0.7338429, 'auroc': 0.99319685}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   195     0   0     2    0    0     1   132    34    4    115
1     0  1284   0     8    0    0     1    35     1    1      2
2     0     4   1   111   53    0     2    26     3  105      7
3     0     1   0  8199    0   10     0   140    85    5      0
4     0     0   0    24  144    1   118     3    17    9    223
5     0     0   0    28    0  264     0     0     2  226      1
6     1     1   0     5    0    0  1857     7     3    2     32
7     0     9   0   116    1    0     1  7088    30    3     17
8     0     1   0    75    3    0     1   118  3046    3     49
9     0     2   1    12    0   13     1     8     2  454      0
10    1     0   0     7    4    1     8     5    12    6  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6203736, 'precision': 0.6375139, 'recall': 0.5097848, 'specificity': 0.9620028, 'f1': 0.4694934, 'auroc': 0.85895765}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   197     3   0   24   0    0    17   450   239   91   149
1     0  1294   0   27   1    2     1   148     0    0    26
2     0     7   1  118  67    2    41    93   243  100   343
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1  11    0    43     1     7    1  1569
5     0     0   0  127   0  225     1     1    10  226     2
6     0     0   0  161   0    0  2590    13    41    1   261
7     0     0   0   14   0    0     0  1146     0    1     3
8     0     0   0   96   0    0     0    26  1244    2     2
9     0    14   0  147   3   56     2   216   153  513    33
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 7,now: 2024-07-28 15:19:05.041833,epoch time: 0:47:56.931680,used: 5:09:58.004701,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94255674, 'precision': 0.86564267, 'recall': 0.7205965, 'specificity': 0.9934842, 'f1': 0.7384219, 'auroc': 0.9953832}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   163     0   0     6    1    0    11    47     2    2    251
1     0  1292   0    10    0    0     0    28     1    0      1
2     0     5   2   156   56    2     5    16     1   67      2
3     0     1   0  8293    0    6     1    97    35    0      2
4     0     2   0    21  125    1   234     2     8    2    144
5     0     0   0    24    0  399     1     0     1   95      1
6     1     1   0     0    1    0  1882     0     2    0     21
7     0    10   0   127    2    0     1  7083    24    0     17
8     0     2   0   202    0    0    13   110  2921    3     45
9     0     1   1    28    2   59     0     7     0  391      4
10    0     1   0    11    3    1    87     7     5    0  12678
---- Validation: 
scalar performance:
{'acc': 0.94155407, 'precision': 0.8930722, 'recall': 0.7182296, 'specificity': 0.9933788, 'f1': 0.7354752, 'auroc': 0.9947593}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   167     0   0     8    1    1    13    46     2    1    244
1     0  1295   0     8    0    0     0    26     1    0      2
2     0     4   2   162   50    2     4    13     1   72      2
3     0     2   0  8304    0   14     1    83    33    3      0
4     0     0   0    22  121    1   239     1     8    3    144
5     0     0   0    32    0  383     0     0     1  103      2
6     0     0   0     4    0    0  1880     2     1    1     20
7     0    11   0   157    1    0     3  7058    20    1     14
8     0     2   0   195    3    2    15   126  2903    3     47
9     0     3   0    29    1   53     0     6     1  396      4
10    0     3   0     9    8    1    71     8     5    0  12691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60903937, 'precision': 0.59992284, 'recall': 0.48949003, 'specificity': 0.96030325, 'f1': 0.45234662, 'auroc': 0.8549479}
confusion matrix:
    0     1   2    3    4    5     6     7    8    9     10
0   88     3   0   15    0   12    82   148   11   37   774
1    0  1347   0   27    1    0     3   117    0    0     4
2    0    16   2  197  128   20   323    96  111   57    65
3    0     0   0    0    0    0     0     0    0    0     0
4    0     1   0    1    8    0   541     2    5    1  1074
5    0     0   0  180    0  371     6     1    1   31     2
6    0     0   0   31    0    0  3030     1    1    0     4
7    0     0   0   78    0    0     1  1082    0    0     3
8    0     0   0  334    0    2    37    14  982    0     1
9    0    21   1  439   12  224    21   184   26  192    17
10   0     0   0    0    0    0    43     0    0    0  1603
early stop counter: 1
val acc:0.941554069519043, best validation acc: 0.9438009858131409, corresponding to test acc:                         0.6203736066818237 / 0.6762750744819641
after epoch: 8,now: 2024-07-28 16:03:51.543667,epoch time: 0:44:46.501834,used: 5:54:44.506535,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9346372, 'precision': 0.83105475, 'recall': 0.6722072, 'specificity': 0.99248374, 'f1': 0.69389784, 'auroc': 0.99470955}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   96     0   0     2   1    0     8    24     7    1    344
1    0  1270   0    13   0    0     3    38     2    0      5
2    0     0   4   188  66    0     9    19     3   11     12
3    0     2   0  8153   0   36     4   144    88    2     10
4    0     0   0    18  92    1   238     2     5    0    183
5    0     2   0    20   0  360     3     1     4  127      4
6    1     0   0     2   1    0  1877     2     2    0     22
7    0     4   0    78   1    0     4  7086    42    3     44
8    1     0   1    60   5    6    41    82  3015    4     79
9    0     1   2   119   5   46     0    39     5  262     14
10   0     0   0     8   2    0    54     2    11    0  12718
---- Validation: 
scalar performance:
{'acc': 0.93566936, 'precision': 0.8236147, 'recall': 0.67657983, 'specificity': 0.9926236, 'f1': 0.69625604, 'auroc': 0.99420106}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   88     0   0     3   0    1    22    26     9    0    334
1    0  1269   0     8   1    0     2    45     1    0      6
2    0     0   3   194  57    0    18    18     1   13      8
3    0     2   0  8152   0   38     4   160    80    2      2
4    0     0   0    15  87    1   247     2     4    0    183
5    0     1   1    16   0  377     1     3     2  115      5
6    1     0   0     2   1    0  1885     0     1    0     18
7    0     6   0    87   1    0     5  7080    46    2     38
8    0     0   1    54   8    3    24    97  3041    3     65
9    0     0   2   126   6   38     4    25     3  280      9
10   0     0   0     7   3    1    52     2    13    0  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60386205, 'precision': 0.54426646, 'recall': 0.4931768, 'specificity': 0.9596126, 'f1': 0.4421652, 'auroc': 0.85726357}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   59     0   0    4   0    1    88    56    49    4   909
1    0  1039   0   43   0    2    22   348     9    0    36
2    0     4   0  110  50   29   242    83   192   34   271
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   0    0   4    0   197     1     6    0  1425
5    0     0   0   70   0  463     6     1     5   24    23
6    0     0   0    9   0    1  3051     1     2    0     3
7    0     0   0  118   0    1     9  1031     2    0     3
8    0     0   0  141   0    6   110     8  1100    0     5
9    0     7   0  166   2  262    34   166   139  253   108
10   0     0   0    0   0    0    15     0     0    0  1631
early stop counter: 2
val acc:0.9356693625450134, best validation acc: 0.9438009858131409, corresponding to test acc:                         0.6203736066818237 / 0.6762750744819641
after epoch: 9,now: 2024-07-28 16:48:47.851828,epoch time: 0:44:56.308161,used: 6:39:40.814696,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94236946, 'precision': 0.8743134, 'recall': 0.7009995, 'specificity': 0.9935008, 'f1': 0.7032751, 'auroc': 0.996693}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   24     0   0     1    0    0     1   108     8    2    339
1    0  1275   0     5    0    0     0    47     3    1      1
2    0     3  14    72   56    0     1    73     2   86      5
3    0     6   0  8104    0   49     1   139   128    6      4
4    0     2   2    19  155    1   178     5     8    1    168
5    0     2   0     7    1  290     0     1     2  216      1
6    0     0   0     0    1    0  1861     1     2    0     43
7    0     8   0    64    2    0     1  7121    59    2      7
8    0     0   0    23    3    0     2    51  3179    7     29
9    0     2   1     2    4    6     0    10     3  462      3
10   0     0   0     9    7    0    18     7    16    0  12737
---- Validation: 
scalar performance:
{'acc': 0.9413134, 'precision': 0.8657364, 'recall': 0.6953312, 'specificity': 0.99339247, 'f1': 0.6962437, 'auroc': 0.9965692}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   18     0   0     1    1    0     2   115    10    2    334
1    0  1279   0     5    0    0     3    43     2    0      0
2    0     1  11    80   48    1     5    69     3   88      6
3    0     6   0  8094    0   49     0   145   134    9      3
4    0     0   0    16  152    0   187     7     6    1    170
5    0     0   0     4    0  280     0     0     6  229      2
6    0     0   0     3    0    0  1859     4     4    0     38
7    0     4   1    68    1    0     1  7131    51    1      7
8    0     0   0    26    6    2     1    49  3175    3     34
9    0     0   3     8    1    8     1    13     3  455      1
10   0     0   0     6    7    0    19     6    20    1  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6242216, 'precision': 0.6484367, 'recall': 0.504481, 'specificity': 0.96196365, 'f1': 0.45359325, 'auroc': 0.86027116}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0    7     3   0    5   0    5    78   193    68   17   794
1    0  1128   0   16   1    3     3   327     5    0    16
2    0     1   1   70  93    8    90   156   238   64   294
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   0    3  38    0   136     3     5    0  1448
5    0     1   0   59   1  341     4     2    11  159    14
6    0     0   0    6   0    1  3025     2     5    0    28
7    0     0   0   64   0    0     1  1094     2    0     3
8    0     0   0  128   0    1     9    17  1211    1     3
9    0     2   0  125   5  142     5   233   150  436    39
10   0     0   0    0   0    0     4     1     0    0  1641
early stop counter: 3
val acc:0.9413133859634399, best validation acc: 0.9438009858131409, corresponding to test acc:                         0.6203736066818237 / 0.6762750744819641
after epoch: 10,now: 2024-07-28 17:31:30.919434,epoch time: 0:42:43.067606,used: 7:22:23.882302,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:22:23.882302 at 2024-07-28 17:31:30.919434
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6203736, 'precision': 0.6375139, 'recall': 0.5097848, 'specificity': 0.9620028, 'f1': 0.4694934, 'auroc': 0.85895765}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   197     3   0   24   0    0    17   450   239   91   149
1     0  1294   0   27   1    2     1   148     0    0    26
2     0     7   1  118  67    2    41    93   243  100   343
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1  11    0    43     1     7    1  1569
5     0     0   0  127   0  225     1     1    10  226     2
6     0     0   0  161   0    0  2590    13    41    1   261
7     0     0   0   14   0    0     0  1146     0    1     3
8     0     0   0   96   0    0     0    26  1244    2     2
9     0    14   0  147   3   56     2   216   153  513    33
10    0     0   0    0   0    0     0     0     0    0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6762751, 'precision': 0.5687833, 'recall': 0.5564162, 'specificity': 0.9662932, 'f1': 0.5159116, 'auroc': 0.86751646}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   380    20   0    8   0   11   511   156     7   53    24
1     0  1430   0   10   0   19     3    33     0    1     3
2     4    69   0  102  11   13   223   183    61  171   178
3     0     0   0    0   0    0     0     0     0    0     0
4     1    36   0    2  10    2   343     1     6    0  1232
5     3     0   0   27   0  280    10    11     6  254     1
6     0    18   0    7   0   18  3009     9     5    1     0
7     0    22   0    5   0    0     2  1131     0    1     3
8     0     0   0   82   0   12    29    55  1178   11     3
9    14   122   0   21   0   87    21   148    36  678    10
10    0    11   0    0   0    0    65     0     0    0  1570
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_10_09_06_seed_0_23121313_instance_wise_predictions.txt
accuracy from prediction file 0.6203736094591759
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/7.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1657 MiB |   8645 MiB | 424335 GiB | 424334 GiB |
|       from large pool |   1650 MiB |   8630 MiB | 421340 GiB | 421338 GiB |
|       from small pool |      7 MiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1657 MiB |   8645 MiB | 424335 GiB | 424334 GiB |
|       from large pool |   1650 MiB |   8630 MiB | 421340 GiB | 421338 GiB |
|       from small pool |      7 MiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |   8622 MiB | 422422 GiB | 422421 GiB |
|       from large pool |   1647 MiB |   8607 MiB | 419430 GiB | 419428 GiB |
|       from small pool |      6 MiB |     16 MiB |   2992 GiB |   2992 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9114 MiB |   9114 MiB |   9114 MiB |      0 B   |
|       from large pool |   9096 MiB |   9096 MiB |   9096 MiB |      0 B   |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 236182 KiB | 494347 KiB |  74110 GiB |  74109 GiB |
|       from large pool | 227168 KiB | 491072 KiB |  71087 GiB |  71087 GiB |
|       from small pool |   9014 KiB |  13085 KiB |   3022 GiB |   3022 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   31810 K  |   31807 K  |
|       from large pool |     247    |     398    |   14165 K  |   14164 K  |
|       from small pool |    2419    |    3627    |   17645 K  |   17642 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   31810 K  |   31807 K  |
|       from large pool |     247    |     398    |   14165 K  |   14164 K  |
|       from small pool |    2419    |    3627    |   17645 K  |   17642 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     265    |     265    |       0    |
|       from large pool |     256    |     256    |     256    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     110    |    1225    |   16260 K  |   16259 K  |
|       from large pool |      91    |     181    |    8615 K  |    8615 K  |
|       from small pool |      19    |    1134    |    7644 K  |    7644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB | 424335 GiB | 424335 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421340 GiB | 421340 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB | 424335 GiB | 424335 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421340 GiB | 421340 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB | 422422 GiB | 422422 GiB |
|       from large pool |  16640 KiB |   8607 MiB | 419430 GiB | 419430 GiB |
|       from small pool |      0 KiB |     16 MiB |   2992 GiB |   2992 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1888 MiB |   9114 MiB |   9114 MiB |   7226 MiB |
|       from large pool |   1872 MiB |   9096 MiB |   9096 MiB |   7224 MiB |
|       from small pool |     16 MiB |     18 MiB |     18 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 494347 KiB |  74111 GiB |  74111 GiB |
|       from large pool |  24320 KiB | 491072 KiB |  71088 GiB |  71088 GiB |
|       from small pool |      0 KiB |  14546 KiB |   3022 GiB |   3022 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   31810 K  |   31810 K  |
|       from large pool |       2    |     398    |   14165 K  |   14165 K  |
|       from small pool |       0    |    3627    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   31810 K  |   31810 K  |
|       from large pool |       2    |     398    |   14165 K  |   14165 K  |
|       from small pool |       0    |    3627    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      98    |     265    |     265    |     167    |
|       from large pool |      90    |     256    |     256    |     166    |
|       from small pool |       8    |       9    |       9    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1225    |   16261 K  |   16261 K  |
|       from large pool |       3    |     181    |    8616 K  |    8616 K  |
|       from small pool |       0    |    1134    |    7644 K  |    7644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB | 424335 GiB | 424335 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421340 GiB | 421340 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB | 424335 GiB | 424335 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421340 GiB | 421340 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB | 422422 GiB | 422422 GiB |
|       from large pool |  16640 KiB |   8607 MiB | 419430 GiB | 419430 GiB |
|       from small pool |      0 KiB |     16 MiB |   2992 GiB |   2992 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1888 MiB |   9114 MiB |   9114 MiB |   7226 MiB |
|       from large pool |   1872 MiB |   9096 MiB |   9096 MiB |   7224 MiB |
|       from small pool |     16 MiB |     18 MiB |     18 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 494347 KiB |  74111 GiB |  74111 GiB |
|       from large pool |  24320 KiB | 491072 KiB |  71088 GiB |  71088 GiB |
|       from small pool |      0 KiB |  14546 KiB |   3022 GiB |   3022 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   31810 K  |   31810 K  |
|       from large pool |       2    |     398    |   14165 K  |   14165 K  |
|       from small pool |       0    |    3627    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   31810 K  |   31810 K  |
|       from large pool |       2    |     398    |   14165 K  |   14165 K  |
|       from small pool |       0    |    3627    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      98    |     265    |     265    |     167    |
|       from large pool |      90    |     256    |     256    |     166    |
|       from small pool |       8    |       9    |       9    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1225    |   16261 K  |   16261 K  |
|       from large pool |       3    |     181    |    8616 K  |    8616 K  |
|       from small pool |       0    |    1134    |    7644 K  |    7644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313

 Experiment start at: 2024-07-28 17:50:31.595555
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5205747, 'precision': 0.48004317, 'recall': 0.44216198, 'specificity': 0.9547849, 'f1': 0.39853907, 'auroc': 0.9075055}
confusion matrix:
     0   1      2     3   4    5     6     7     8   9   10
0   332   0     48     8   0    5    51    13    24   0   2
1     0  81   1134    34   0    0     3    63    17   0   0
2    47   0     77    10   0   26    15    33   101   0   3
3     2   0      4  8093   0   15     7   188   128   0   0
4    13   0    326     3   0   13    16     4   161   0   3
5    31   0      2    69   0  279    78     2    54   0   6
6    31   2     39    32   0  524  1147     7   126   0   0
7     2   1     38   547   0    2     2  6588    82   0   0
8     2   0     53   304   0   23     4    58  2850   0   1
9   171   0     25    14   0  101    94    15    52   0  21
10   39   2  12319    15   0   28    35    19   327   0  10
---- Validation: 
scalar performance:
{'acc': 0.5216263, 'precision': 0.48288113, 'recall': 0.44377416, 'specificity': 0.9548591, 'f1': 0.4023001, 'auroc': 0.9076976}
confusion matrix:
     0   1      2     3   4    5     6     7     8   9   10
0   323   0     56    11   0   11    44    14    20   0   4
1     0  99   1116    30   0    2     2    74     9   0   0
2    47   0     77     7   1   22    15    28   109   0   6
3     1   0      1  8111   0   14     2   182   128   0   1
4    11   0    321     8   0   17    10     3   164   0   5
5    43   0      6    73   0  281    79     1    35   0   3
6    17   0     32    32   0  505  1183     7   132   0   0
7     0   2     38   580   0    3     1  6557    83   0   1
8     2   0     54   294   0   20     5    59  2861   0   1
9   170   0     32    20   0  110    90    12    43   0  16
10   35   1  12318    19   0   26    32    26   330   0   9
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.30007696, 'precision': 0.30596077, 'recall': 0.2900781, 'specificity': 0.9306171, 'f1': 0.2620244, 'auroc': 0.7658031}
confusion matrix:
     0    1     2   3   4     5    6     7     8   9   10
0   884    0     9  27   0     2  208    38     2   0   0
1     5  311   904  49   0    11   65   138    16   0   0
2   161    1   125  11   0   140  165    24   387   0   1
3     0    0     0   0   0     0    0     0     0   0   0
4     8    0  1433   0   0     8    4     1   179   0   0
5   268    0     0   7   0   108  202     0     6   0   1
6     0    0     4   2   0  2162  756     2   141   0   0
7     2    0    12  58   0     1    9  1078     4   0   0
8     1    0     1  45   0   211   85     0  1027   0   0
9   381    1    35  12   0   254  329    24    99   0   2
10    0    0  1629   0   0     0    0     0    17   0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 18:34:25.295601,epoch time: 0:43:53.700046,used: 0:43:53.700046,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5726937, 'precision': 0.5429013, 'recall': 0.5617992, 'specificity': 0.95967984, 'f1': 0.5118712, 'auroc': 0.9266735}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   405     1     42     6   0    0    14    14     0   0   1
1     1  1229      7    14   0    0     0    80     1   0   0
2    87     4    141     2   0    0     3    56     5   0  14
3     4     3      1  8143   0    1     6   228    52   0   2
4    31     8    454     3   0    1     5    15    18   0   3
5    93     0      6    78   0  167    16    20    76   0  65
6    41     3     16     4   0    0  1835     3     6   0   0
7     1    10     18   229   0    0     2  6988    15   0   1
8     3     6    221   355   0    1     3   209  2495   0   1
9   295     1     33    17   0   15     8    55     6   0  63
10   62    39  12600    11   0    0    37    29    11   0   2
---- Validation: 
scalar performance:
{'acc': 0.57386655, 'precision': 0.5469589, 'recall': 0.56199664, 'specificity': 0.9598163, 'f1': 0.51470363, 'auroc': 0.92680186}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   393     1     49     6   0    0    10    24     0   0   0
1     0  1236      4    10   0    0     0    81     1   0   0
2    85     9    137     3   0    0     2    59     4   0  13
3     5     3      0  8169   0    0     1   206    56   0   0
4    29     8    461     2   0    0     2    15    18   0   4
5    98     1      5    74   0  181    12    19    69   0  62
6    30     3     13    13   0    0  1841     6     1   0   1
7     1    10     25   224   0    0     2  6992    11   0   0
8     4     7    228   348   0    2     8   198  2499   0   2
9   298     1     33    16   0   14     3    54    11   0  63
10   65    37  12593     7   0    0    38    29    21   0   6
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5377458, 'precision': 0.37673354, 'recall': 0.4233483, 'specificity': 0.95384514, 'f1': 0.3724825, 'auroc': 0.81191444}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9   10
0   1018     1     0    6   0   0   118    26     1   0   0
1      9  1235     7   30   0   0     8   210     0   0   0
2    377    70   155   10   0  11   170   108   111   0   3
3      0     0     0    0   0   0     0     0     0   0   0
4     28    87  1389    0   0   0    92     2    34   0   1
5    378     0     0   57   0  56    35    20    27   0  19
6      0     0     0    0   0   0  3062     4     1   0   0
7      3     1     2   67   0   0     3  1088     0   0   0
8     26     5     2  126   0  18    82    38  1072   0   1
9    667    53    24   39   0  18   112   171    44   0   9
10     1    23  1592    0   0   0    29     0     1   0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 19:16:57.282506,epoch time: 0:42:31.986905,used: 1:26:25.686951,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5864191, 'precision': 0.5502304, 'recall': 0.5960221, 'specificity': 0.9613336, 'f1': 0.5296348, 'auroc': 0.9402034}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   369     3     47     8   0    0    43     9     3   0   1
1     0  1259      6     7   0    0     0    52     5   0   0
2    57     2    195     1   0    1     3    35    16   0   2
3     2     1      0  7953   0    1     6   357   119   0   0
4    14     6    460     0   0    1     8     5    42   0   3
5    78     4      7    41   0  218    24    20   124   0   5
6    13     2     13     3   0    1  1872     2     2   0   0
7     1    13     13   122   0    0     3  7066    45   0   0
8     2     3     89   134   0    0     4    81  2981   0   1
9   282     5     60    16   0   28    10    48    20   0  24
10   36    61  12595     7   0    1    36    24    29   0   5
---- Validation: 
scalar performance:
{'acc': 0.58651865, 'precision': 0.5465872, 'recall': 0.5942588, 'specificity': 0.9613573, 'f1': 0.5277037, 'auroc': 0.94082296}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   373     1     42     5   0    0    53     7     2   0   0
1     0  1265     10     9   0    0     0    40     8   0   0
2    57     1    194     1   0    0     3    33    23   0   0
3     1     1      1  7951   0    0    14   372   100   0   0
4    19     4    470     0   0    0     4     6    35   0   1
5    81     3      5    37   0  202    28    20   132   0  13
6    13     5      7     3   0    1  1868     6     4   0   1
7     0    12     14   111   0    0     4  7069    55   0   0
8     1     3     86   119   0    0     5    79  3003   0   0
9   287     5     67    18   0   20     8    50    16   0  22
10   35    69  12598     6   0    0    32    27    27   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.556846, 'precision': 0.39598447, 'recall': 0.4469272, 'specificity': 0.9556625, 'f1': 0.39718628, 'auroc': 0.82475215}
confusion matrix:
     0     1     2   3   4   5     6     7     8   9   10
0   780     1     1   5   0   0   374     7     2   0   0
1     2  1301     7  23   0   0    32   128     6   0   0
2   204    10   408   7   0   7    67    47   259   0   6
3     0     0     0   0   0   0     0     0     0   0   0
4     4    38  1548   0   0   1    16     0    25   0   1
5   287     0     4  49   0  92    50    57    48   0   5
6     0     0     1   0   0   0  3063     2     1   0   0
7     1     1     4  90   0   1    14  1051     2   0   0
8     5     1     3  51   0  13    31     2  1264   0   0
9   527    11   130  41   0  42   119    89   175   0   3
10    0    15  1628   0   0   0     2     0     1   0   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-28 19:58:44.671012,epoch time: 0:41:47.388506,used: 2:08:13.075457,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.58080053, 'precision': 0.57103646, 'recall': 0.5959171, 'specificity': 0.9601588, 'f1': 0.5602602, 'auroc': 0.9424251}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   379     1     41    13   0    0    23    21     2   0    2
1     0  1266      3    14   0    1     0    47     1   0    0
2    22     0    140     4   0    4     2    93     7   0   39
3     0     1      1  8278   0    1     6   123    25   0    0
4     6     0    451     1   0    2     1    27    27   0   24
5     4     0      2    30   0  372    14     8    60   0   31
6    13     2     18     5   0    1  1848     6     7   0    7
7     0     9      6   295   0    0     1  6946     8   0    0
8     1     2     81   537   0    6     0   208  2459   0    2
9    56     2     21    11   0  103    29    95    12   0  164
10   13     5  12636    10   0    1     7    58    45   0   20
---- Validation: 
scalar performance:
{'acc': 0.58183765, 'precision': 0.5747534, 'recall': 0.59734845, 'specificity': 0.96021014, 'f1': 0.5633018, 'auroc': 0.942548}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   384     0     34    12   0    0    18    26     4   0    5
1     0  1260      1    12   0    0     0    57     2   0    0
2    29     1    139     7   0    2     4    78     4   0   48
3     0     0      0  8276   0    3     5   128    28   0    0
4     6     0    448     2   0    2     1    28    29   0   23
5     4     0      2    31   0  373    15     5    57   0   34
6     9     1     21     4   0    1  1852     7     7   0    6
7     0     9      5   301   0    0     1  6942     7   0    0
8     1     1     60   504   0    4     3   215  2505   0    3
9    46     2     20    13   0   91    23    98    13   0  187
10   15     3  12632    13   0    0     5    69    38   0   21
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5660113, 'precision': 0.4148273, 'recall': 0.46955314, 'specificity': 0.95688117, 'f1': 0.42643446, 'auroc': 0.8365531}
confusion matrix:
     0     1     2    3   4    5     6     7     8   9   10
0   917     1     4   14   0    0   188    43     2   0   1
1     0  1249     6   26   0    0     3   213     2   0   0
2    78    16   351   20   0   16    45   175   255   0  59
3     0     0     0    0   0    0     0     0     0   0   0
4     3     2  1581    0   0    0     2     3    36   0   6
5    73     0     2   53   0  229    75    73    45   0  42
6     0     0     3    2   0    3  3046     2    11   0   0
7     0     0     1   37   0    0     3  1122     1   0   0
8     1     0     1  146   0    8     7    31  1176   0   0
9   237    33    58   62   0   95   145   326    92   0  89
10    0     2  1640    0   0    0     0     0     4   0   0
new oracle model saved
early stop counter: 1
val acc:0.5818376541137695, best validation acc: 0.5865186452865601, corresponding to test acc:                         0.556846022605896 / 0.5660113096237183
after epoch: 4,now: 2024-07-28 20:40:05.329269,epoch time: 0:41:20.658257,used: 2:49:33.733714,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.59281355, 'precision': 0.56585824, 'recall': 0.628675, 'specificity': 0.9620547, 'f1': 0.55772233, 'auroc': 0.9520742}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   411     0     55     2   0    0     1    12     2   0   0
1     0  1237      3     6   0    0     0    84     2   0   0
2    46     1    225     2   0    2     2    25     8   0   1
3     1     0      2  8123   0    5     2   200   104   0   1
4    11     1    493     0   0    1     0     9    16   0   8
5    29     7      7    33   0  332    43    11    50   0   9
6    44     9     29     5   0    1  1810     5     0   0   5
7     0     3     20   138   0    0     2  7076    25   0   0
8     2     0    140    86   0    0     2   127  2939   0   0
9   219     8     80     8   0   44    65    38    11   0  20
10   20     2  12732     8   0    0     5     8    11   0   4
---- Validation: 
scalar performance:
{'acc': 0.5921359, 'precision': 0.55820674, 'recall': 0.6238836, 'specificity': 0.96198654, 'f1': 0.5539197, 'auroc': 0.95303684}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   410     0     56     2   0    0     4     8     2   0   1
1     0  1249      4     7   0    0     1    70     1   0   0
2    44     1    223     2   0    0     1    30     9   0   2
3     5     0      4  8138   0    3     2   187   101   0   0
4     9     3    498     0   0    1     1     8    13   0   6
5    29     8      4    31   0  305    58    13    60   0  13
6    50     4     23     3   0    0  1813     9     3   0   3
7     2     7     22   138   0    0     1  7070    25   0   0
8     4     1    141    86   0    1     0   133  2928   0   2
9   222     6     82     5   0   48    58    36    10   0  26
10   13     1  12738     8   0    0     3    19    13   0   1
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5825229, 'precision': 0.45700407, 'recall': 0.48434642, 'specificity': 0.9589679, 'f1': 0.42762136, 'auroc': 0.8281115}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9   10
0   1119     0    12   20   0    0     3    10     6   0   0
1      1  1089    22   25   0    0     0   357     5   0   0
2    120     2   650   13   0    1     3    65   125   0  36
3      0     0     0    0   0    0     0     0     0   0   0
4      2     0  1621    0   0    0     2     1     6   0   1
5    134     0     2   83   0  113    72   110    28   0  50
6      0     1     3   11   0    0  3048     1     3   0   0
7      1     0     6  102   0    0     1  1052     2   0   0
8      2     0    14   80   0    1     9     9  1255   0   0
9    447    11   244   81   0   10    50   164   104   0  26
10     0     0  1646    0   0    0     0     0     0   0   0
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-28 21:20:49.017843,epoch time: 0:40:43.688574,used: 3:30:17.422288,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5939105, 'precision': 0.5738441, 'recall': 0.6122915, 'specificity': 0.96181345, 'f1': 0.5572747, 'auroc': 0.957941}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   390     2     60     4   0    0     4     6     7   0   10
1     0  1296      4     4   0    0     1    23     4   0    0
2     9     0    224     5   0    1     1    36    14   0   22
3     0     3      0  8285   0    6     0    96    45   0    1
4     2     0    474     1   0    2     1     6    32   0   21
5     9     2      2    14   0  222    24    10   205   0   33
6    19     0     16     4   0    0  1858     6     2   0    2
7     0    13     14   239   0    0     0  6966    32   0    0
8     0     0     57   210   0    0     5    73  2949   0    2
9    52     2     62     8   0   67    13   126    16   0  147
10    6     3  12701     8   0    1    13    14    39   0    8
---- Validation: 
scalar performance:
{'acc': 0.59344655, 'precision': 0.57660717, 'recall': 0.6130341, 'specificity': 0.9617301, 'f1': 0.55981445, 'auroc': 0.958023}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   397     0     52     4   0    0     5     7     4   0   14
1     0  1294      2     9   0    0     0    25     2   0    0
2     8     1    218     0   0    1     2    41    15   0   26
3     1     1      1  8270   0    6     1   109    49   0    2
4     4     0    468     0   0    2     0     6    41   0   18
5    10     1      4    11   0  231    21    10   196   0   37
6    20     0     20     4   0    0  1850     5     4   0    5
7     1    20     12   255   0    0     1  6942    34   0    0
8     0     2     57   192   0    1     0    69  2973   0    2
9    40     3     56     6   0   66    17   126    17   0  162
10    4     2  12705    11   0    0    12    14    37   0   11
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58895963, 'precision': 0.46750158, 'recall': 0.490679, 'specificity': 0.9596321, 'f1': 0.45199943, 'auroc': 0.8406377}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9    10
0   1104     0    18   14   0    0     4    21     9   0    0
1      2  1366    11   35   0    0     0    80     5   0    0
2     24    12   520   28   0    1     6    62   246   0  116
3      0     0     0    0   0    0     0     0     0   0    0
4      1     0  1611    0   0    0     2     1    16   0    2
5     46     0     1   83   0  151    38    74    49   0  150
6      0     3     7   22   0    0  3006     2    27   0    0
7      0     0     7   91   0    0     1  1064     1   0    0
8      0     0     3  144   0    1     1    12  1207   0    2
9    124    25   159  146   0   28    22   237   173   0  223
10     0     0  1646    0   0    0     0     0     0   0    0
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-28 22:05:42.114396,epoch time: 0:44:53.096553,used: 4:15:10.518841,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.59420484, 'precision': 0.5777033, 'recall': 0.5996861, 'specificity': 0.9619195, 'f1': 0.55204296, 'auroc': 0.9546854}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   410     1     31     1   0    0     4    18     4   0  14
1     0  1285      0    13   0    0     0    31     3   0   0
2    40     0    154     1   0    0    11    47    44   0  15
3     1     0      0  8104   0    2     0   228   101   0   0
4     2     2    375     0   0    2     7    21    71   0  59
5     8     1      2    21   0  237    67    12   167   0   6
6    17     2      7     6   0    1  1864     5     3   0   3
7     1    11      6   120   0    0     1  7096    27   0   0
8     2     1     28    86   0    1     1   153  3022   0   2
9   108     0     20     4   0   49    74   187    26   0  25
10    9    12  12609     4   0    0    16    22    85   0  37
---- Validation: 
scalar performance:
{'acc': 0.5937943, 'precision': 0.57720923, 'recall': 0.59901845, 'specificity': 0.96185625, 'f1': 0.54996204, 'auroc': 0.95430994}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   406     1     29     4   0    1     8    13     6   0  15
1     0  1293      1    10   0    0     1    23     4   0   0
2    36     0    159     1   0    0     8    49    41   0  18
3     0     0      0  8103   0    0     2   219   116   0   0
4     8     1    364     0   0    2     7    14    76   0  67
5    17     1      1    20   0  223    59    15   174   0  11
6     8     1      5     5   0    1  1877     3     5   0   3
7     0    17      8   155   0    0     3  7053    28   0   1
8     0     0     28    69   0    3     2   151  3039   0   4
9   106     4     26     5   0   47    81   174    20   0  30
10   13     7  12611     4   0    0    14    27    74   0  46
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57482684, 'precision': 0.4285513, 'recall': 0.46929753, 'specificity': 0.95781267, 'f1': 0.42889094, 'auroc': 0.8398479}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9    10
0   1064     0     3  23   0    0    23    52     3   0    2
1      3  1332     6  28   0    0    12   114     4   0    0
2     37     5   233   8   0    8    76   193   333   0  122
3      0     0     0   0   0    0     0     0     0   0    0
4      2     2  1510   0   0    1    13     3    36   0   66
5     17     0     0  92   0  153    64    99    72   0   95
6      0     0     0   8   0    0  3056     2     0   0    1
7      0     0     2  35   0    1     1  1124     0   0    1
8      0     0     1  83   0    3     4    33  1245   0    1
9     93     3    69  58   0   68   150   427   213   0   56
10     0     1  1633   0   0    0     2     0     1   0    9
better model found
persisted
after epoch: 7,now: 2024-07-28 22:49:53.902222,epoch time: 0:44:11.787826,used: 4:59:22.306667,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.59436536, 'precision': 0.59023523, 'recall': 0.60635096, 'specificity': 0.9620416, 'f1': 0.54608655, 'auroc': 0.96787596}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   402     4     45     2   0    0     8     9     8   0   5
1     0  1299      4     6   0    0     0    21     2   0   0
2    13     0    227     4   0    0     4    46    13   0   5
3     0     2      0  8124   0    1     1   231    80   0   0
4     3     1    459     1   0    0     3    11    19   0  42
5    13     0      2    44   0  155    71    24   204   0   8
6    11     2     10     1   0    0  1874     4     3   0   3
7     0    19     10    86   0    0     3  7106    40   0   0
8     0     2     96    93   0    0     1    95  3003   0   2
9    77     0     61    10   0   31    66   211    12   0  25
10    3     5  12713     6   0    0     8    15    18   0  25
---- Validation: 
scalar performance:
{'acc': 0.59515846, 'precision': 0.5913305, 'recall': 0.6052227, 'specificity': 0.9621521, 'f1': 0.5457378, 'auroc': 0.96872073}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   385     0     41     3   0    0    13    17    14   0  10
1     0  1299      5     5   0    0     1    17     5   0   0
2    13     0    227     0   0    0     3    56    10   0   3
3     0     2      0  8144   0    0     3   202    89   0   0
4     2     0    462     0   0    0     3    17    23   0  32
5    15     0      3    37   0  162    74    19   207   0   4
6    10     3      9     2   0    0  1876     3     2   0   3
7     0    16     10    85   0    0     3  7115    35   0   1
8     1     2     82    94   0    0     3    89  3025   0   0
9    86     0     59    12   0   21    73   210    16   0  16
10    3     3  12725     5   0    0     8    20    15   0  17
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5817533, 'precision': 0.45275998, 'recall': 0.4768293, 'specificity': 0.95852846, 'f1': 0.4293463, 'auroc': 0.8450928}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9   10
0   1040     0     4    4   0    0    95    23     4   0   0
1      0  1324    20   20   0    0    17   112     6   0   0
2     53     7   450    9   0    0    40    79   335   0  42
3      0     0     0    0   0    0     0     0     0   0   0
4      0     3  1567    0   0    0    20     1    15   0  27
5     39     0     1  104   0  114    94   115    84   0  41
6      0     2     0    6   0    0  3056     1     1   0   1
7      0     0     2   68   0    1     3  1086     4   0   0
8      1     0     6  108   0    0    10     9  1236   0   0
9    161    11   154  118   0   19   125   258   285   0   6
10     0     1  1634    0   0    0     2     0     0   0   9
better model found
persisted
after epoch: 8,now: 2024-07-28 23:48:01.504272,epoch time: 0:58:07.602050,used: 5:57:29.908717,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.59431183, 'precision': 0.57667357, 'recall': 0.58028704, 'specificity': 0.961866, 'f1': 0.50645995, 'auroc': 0.9704231}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   430     2     38     1   0   0     6     3     1   0    2
1     0  1296      3     2   0   0     0    26     5   0    0
2    34     0    189     1   0   0     4    50     9   0   25
3     0     2      1  8162   0   1     3   145   122   0    1
4    12     3    267     0   0   0     3    12    49   0  193
5    27    14      1    13   0  23    98    48   283   0   14
6    11     3     10     3   0   0  1876     3     2   0    0
7     1    26     25   111   0   0     1  7063    34   0    1
8     2     3     42    78   0   0     1    65  3102   0    3
9   166    10     38     3   0   2    30   210    13   0   21
10   17    12  12625     8   0   0    17     8    34   0   72
---- Validation: 
scalar performance:
{'acc': 0.5948375, 'precision': 0.669203, 'recall': 0.579918, 'specificity': 0.9619436, 'f1': 0.50494677, 'auroc': 0.9706109}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   423     1     38     4   0   0     7     5     3   0    2
1     0  1303      3     1   0   0     0    20     5   0    0
2    38     1    189     0   0   0     5    39    12   0   28
3     1     2      3  8185   0   0     0   134   115   0    0
4    13    12    261     0   1   0     2    11    46   0  193
5    40     5      1    11   0  23   100    38   291   0   12
6    13     2     10     2   0   0  1874     3     1   0    3
7     2    29     17   107   0   0     2  7069    38   0    1
8     2     3     41    68   0   0     2    63  3110   0    7
9   179    10     36     3   0   1    28   198    17   0   21
10   13    13  12644     5   0   0    16    11    33   0   61
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5780452, 'precision': 0.43475533, 'recall': 0.46335518, 'specificity': 0.95803356, 'f1': 0.40643674, 'auroc': 0.85202116}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9    10
0   1120     1     3   10   0   0    20    14     2   0    0
1      5  1336    17   19   0   0    10   109     3   0    0
2    113    20   392    7   0   0    28   102   220   0  133
3      0     0     0    0   0   0     0     0     0   0    0
4      2     8  1159    0   0   0    12     1    19   0  432
5     97     5     0   41   0  19   142   144    84   0   60
6      2     2     0    4   0   0  3055     0     4   0    0
7      6     0     3  119   0   0     2  1031     3   0    0
8      2     0     5   85   0   0    10    17  1250   0    1
9    316    36   181   40   0   7   105   327   117   0    8
10     0     1  1584    0   0   0     2     0     0   0   59
early stop counter: 1
val acc:0.594837486743927, best validation acc: 0.5951584577560425, corresponding to test acc:                         0.5817533135414124 / 0.5889596343040466
after epoch: 9,now: 2024-07-29 00:51:36.425963,epoch time: 1:03:34.921691,used: 7:01:04.830408,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.60726136, 'precision': 0.60853994, 'recall': 0.5784936, 'specificity': 0.96286505, 'f1': 0.49674147, 'auroc': 0.9674102}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   443     3      9     3   0   0     2    10     7   0    6
1     0  1301      0     5   0   0     0    25     1   0    0
2    41     3    180     1   0   0     2    47     4   0   34
3     3     1      0  8251   0   0     0   142    42   0    0
4    32     6    140     1   0   0     0    12    29   0  319
5    94    12      3    27   0  10   149    32   192   0    2
6    50     3      4     1   0   0  1837     3     5   0    3
7     1    13      7   142   0   0     2  7084    12   0    1
8     4     4     32   123   0   0     2   117  3000   0   14
9   259     6     36     3   0   0    19   159     3   0    8
10   80    27  11992     6   0   0     5    27    65   0  591
---- Validation: 
scalar performance:
{'acc': 0.60834557, 'precision': 0.6090015, 'recall': 0.5816371, 'specificity': 0.96301425, 'f1': 0.49687248, 'auroc': 0.96866924}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   450     2      5     9   0   0     1     8     2   0    6
1     0  1295      0     6   0   0     2    28     1   0    0
2    43     2    186     0   0   0     2    36     7   0   36
3     3     0      0  8266   0   0     1   129    41   0    0
4    24     8    147     0   0   0     1    14    35   0  310
5    89    14      1    23   0   6   150    23   208   0    7
6    43     5      4     3   0   0  1841     3     5   0    4
7     1    10      5   122   0   0     1  7115    10   0    1
8    10     2     29   111   0   0     1   103  3031   0    9
9   260     7     32     8   0   0    16   156     4   0   10
10   84    24  12046     8   0   0     4    19    58   0  553
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5565662, 'precision': 0.45981124, 'recall': 0.43578094, 'specificity': 0.95636797, 'f1': 0.39526558, 'auroc': 0.8216026}
confusion matrix:
     0     1     2    3   4   5     6     7     8   9    10
0   997     3     1   39   0   0     1   123     5   0    1
1     0  1319     4   32   0   0     2   142     0   0    0
2   138    32   214   43   0   0     4   118   261   0  205
3     0     0     0    0   0   0     0     0     0   0    0
4     4     8   708    0   0   0     2     2    24   0  885
5   105    69     0  270   0   2    33    23    38   0   52
6     2     1     0   11   0   0  3046     2     3   0    2
7     8     2     0   46   0   0     0  1106     0   0    2
8     2     2     3  256   0   0     1    29  1077   0    0
9   327    41    99  254   0   0    15   274    88   0   39
10    0     1  1450    0   0   0     0     0     1   0  194
better model found
persisted
after epoch: 10,now: 2024-07-29 01:58:46.237916,epoch time: 1:07:09.811953,used: 8:08:14.642361,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:08:14.642361 at 2024-07-29 01:58:46.237916
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5565662, 'precision': 0.45981124, 'recall': 0.43578094, 'specificity': 0.95636797, 'f1': 0.39526558, 'auroc': 0.8216026}
confusion matrix:
     0     1     2    3   4   5     6     7     8   9    10
0   997     3     1   39   0   0     1   123     5   0    1
1     0  1319     4   32   0   0     2   142     0   0    0
2   138    32   214   43   0   0     4   118   261   0  205
3     0     0     0    0   0   0     0     0     0   0    0
4     4     8   708    0   0   0     2     2    24   0  885
5   105    69     0  270   0   2    33    23    38   0   52
6     2     1     0   11   0   0  3046     2     3   0    2
7     8     2     0   46   0   0     0  1106     0   0    2
8     2     2     3  256   0   0     1    29  1077   0    0
9   327    41    99  254   0   0    15   274    88   0   39
10    0     1  1450    0   0   0     0     0     1   0  194
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58895963, 'precision': 0.46750158, 'recall': 0.490679, 'specificity': 0.9596321, 'f1': 0.45199943, 'auroc': 0.8406377}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9    10
0   1104     0    18   14   0    0     4    21     9   0    0
1      2  1366    11   35   0    0     0    80     5   0    0
2     24    12   520   28   0    1     6    62   246   0  116
3      0     0     0    0   0    0     0     0     0   0    0
4      1     0  1611    0   0    0     2     1    16   0    2
5     46     0     1   83   0  151    38    74    49   0  150
6      0     3     7   22   0    0  3006     2    27   0    0
7      0     0     7   91   0    0     1  1064     1   0    0
8      0     0     3  144   0    1     1    12  1207   0    2
9    124    25   159  146   0   28    22   237   173   0  223
10     0     0  1646    0   0    0     0     0     0   0    0
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_17_50_30_seed_1_23121313_instance_wise_predictions.txt
accuracy from prediction file 0.5565661512628559
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1657 MiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |   1650 MiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      7 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1657 MiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |   1650 MiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      7 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |   8622 MiB |    825 TiB |    825 TiB |
|       from large pool |   1647 MiB |   8607 MiB |    819 TiB |    819 TiB |
|       from small pool |      6 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9114 MiB |   9114 MiB |  16340 MiB |   7226 MiB |
|       from large pool |   9096 MiB |   9096 MiB |  16320 MiB |   7224 MiB |
|       from small pool |     18 MiB |     18 MiB |     20 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 236182 KiB | 494347 KiB | 148385 GiB | 148385 GiB |
|       from large pool | 227168 KiB | 491072 KiB | 142333 GiB | 142333 GiB |
|       from small pool |   9014 KiB |  14546 KiB |   6051 GiB |   6051 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   63622 K  |   63619 K  |
|       from large pool |     247    |     398    |   28330 K  |   28330 K  |
|       from small pool |    2419    |    3627    |   35291 K  |   35289 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   63622 K  |   63619 K  |
|       from large pool |     247    |     398    |   28330 K  |   28330 K  |
|       from small pool |    2419    |    3627    |   35291 K  |   35289 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     265    |     432    |     167    |
|       from large pool |     256    |     256    |     422    |     166    |
|       from small pool |       9    |       9    |      10    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     111    |    1251    |   32549 K  |   32549 K  |
|       from large pool |      91    |     181    |   17319 K  |   17319 K  |
|       from small pool |      20    |    1160    |   15229 K  |   15229 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB |    825 TiB |    825 TiB |
|       from large pool |  16640 KiB |   8607 MiB |    819 TiB |    819 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1888 MiB |   9114 MiB |  16340 MiB |  14452 MiB |
|       from large pool |   1872 MiB |   9096 MiB |  16320 MiB |  14448 MiB |
|       from small pool |     16 MiB |     18 MiB |     20 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 494347 KiB | 148386 GiB | 148386 GiB |
|       from large pool |  24320 KiB | 491072 KiB | 142334 GiB | 142334 GiB |
|       from small pool |      0 KiB |  14546 KiB |   6051 GiB |   6051 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   63622 K  |   63622 K  |
|       from large pool |       2    |     398    |   28330 K  |   28330 K  |
|       from small pool |       0    |    3627    |   35291 K  |   35291 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   63622 K  |   63622 K  |
|       from large pool |       2    |     398    |   28330 K  |   28330 K  |
|       from small pool |       0    |    3627    |   35291 K  |   35291 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      98    |     265    |     432    |     334    |
|       from large pool |      90    |     256    |     422    |     332    |
|       from small pool |       8    |       9    |      10    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1251    |   32550 K  |   32550 K  |
|       from large pool |       3    |     181    |   17319 K  |   17319 K  |
|       from small pool |       0    |    1160    |   15230 K  |   15230 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 29 02:18:32 2024]
Finished job 0.
1 of 1 steps (100%) done
