Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 04:28:40 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369

 Experiment start at: 2024-08-04 04:38:52.554199
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.044287413358688354
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9192262, 'precision': 0.8396337, 'recall': 0.69739926, 'specificity': 0.99089336, 'f1': 0.7356988, 'auroc': 0.98925984}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   227     0   0    21    1   10   117     5    10    9     83
1     0  1233   0    30    0    0     2    50     6    0     10
2     0    11  62    31   39    9     4    32    26   85     13
3     0     2   0  8200    0    3     5   120   103    0      2
4     0     0   6     6  149    7     8     6    99    7    251
5     0     0   1   129    0  335     0     0     6   49      1
6     1     0   0    20    0    3  1826     3    11    2     42
7     0    31   1   507    1    0     8  6617    76    0     23
8     0     4   0   333    2    0    14    57  2816    0     68
9     0     4  16    70    0  153     1     5     8  233      3
10    1     1   0    11    8    3    29    22    61    1  12659
---- Validation: 
scalar performance:
{'acc': 0.9190317, 'precision': 0.83922094, 'recall': 0.70310724, 'specificity': 0.99090433, 'f1': 0.74089575, 'auroc': 0.9886785}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   227     0   1    16    1   12   127     4    12    4     79
1     0  1238   0    26    0    0     1    51     6    0     10
2     0    12  64    35   42    5     1    23    35   84     11
3     0     2   0  8215    0    6     4   119    94    0      0
4     0     0   7    12  163    4     9     4    89   11    240
5     0     0   0   126    0  337     0     0     7   50      1
6     1     0   0    15    1    3  1832     0    13    2     41
7     0    34   0   547    2    0    17  6560    83    0     22
8     0     7   1   333    1    0    11    57  2830    1     55
9     1     5  18    61    1  143     0     6    10  245      3
10    1     2   0    13    8    1    35    20    69    0  12647
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59147835, 'precision': 0.605646, 'recall': 0.49159378, 'specificity': 0.95858234, 'f1': 0.4696875, 'auroc': 0.8548193}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   260     0   0   86    0   56   718    8    17   14    11
1     0  1197   0   45    2    0    17  187     3    0    48
2     1     5  11   93  225   50   104   48   317   18   143
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   0    0  159    0     6    1    17    0  1449
5     0     0   0  181    0  396     6    0     1    7     1
6     0     0   0    3   25    0  2563    2    40    0   434
7     0     0   0  163    0    0     8  989     0    0     4
8     0     0   0  259    2    2    26    2  1074    0     5
9     0    38  17  419   31  253    55   43   109  161    11
10    0     0   0    0    1    0     1    0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 05:07:50.775337,epoch time: 0:28:58.221138,used: 0:28:58.221138,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93656355, 'precision': 0.8451638, 'recall': 0.7995659, 'specificity': 0.9929528, 'f1': 0.8086454, 'auroc': 0.99305314}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     1    0    0     1     3     4    4     44
1     2  1233    0    19    0    0     0    56    11    0     11
2     7     0  140     2   39    0     0     3     4  105     12
3    10     0    0  7911    0   29     6   288   174   18      2
4     5     0   23     3  232    0     3     2     9   18    242
5     3     0    0    21    0  278     0     0     4  214      1
6    52     0    0     3    1    1  1814     0     3    2     32
7    16     5    6   213    2    0    12  6886    71    1     50
8    14     0    4    86   22    5     5    61  2932   22    145
9    13     1   24     3    0   28     0     1     2  420      1
10   20     0    1     8    9    1     4     6     7    5  12733
---- Validation: 
scalar performance:
{'acc': 0.9356159, 'precision': 0.83404005, 'recall': 0.7958, 'specificity': 0.99285597, 'f1': 0.80373216, 'auroc': 0.99273163}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     3    0    0     1     2     3    3     45
1     3  1214    0    23    1    0     1    65     9    0     16
2     5     0  141     3   44    2     0     9     6   89     13
3    16     0    0  7917    0   36     5   286   168   10      2
4     4     0   30     2  223    0     3     3    13   18    243
5     3     0    0    23    0  290     0     0     3  201      1
6    63     0    0     2    0    0  1800     1     1    2     39
7    14     7    2   178    1    0     9  6925    75    4     50
8    23     0    7    90   35    6     7    59  2904   22    143
9    14     0   28     8    0   31     0     0     2  408      2
10   22     0    0     7   14    0     3     6    10    4  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7318268, 'precision': 0.6433213, 'recall': 0.61047703, 'specificity': 0.97285575, 'f1': 0.5969961, 'auroc': 0.8713133}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1166     0    0   2    0    0     0     0     0    2     0
1     30  1055    6  26    1    0     7   312     5    4    53
2     83     4  134   3  312   13    25    28    49  109   255
3      0     0    0   0    0    0     0     0     0    0     0
4      3     0    0   0  328    0     2     2     2    0  1296
5     43     0    1  18    0  208     5     0     3  311     3
6      2     0    0   0    2    0  3041     1     0    0    21
7     14     0    1   5    0    0    20  1116     0    2     6
8     14     0    9  29   35   11    54     6  1172   15    25
9    145     8  200  15   16   38    10    27    53  603    22
10     0     0    0   0    9    0     0     0     0    0  1637
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 05:36:06.682344,epoch time: 0:28:15.907007,used: 0:57:14.128145,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.951814, 'precision': 0.8706153, 'recall': 0.8360267, 'specificity': 0.99481535, 'f1': 0.84758747, 'auroc': 0.9959853}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     3    0    0     3     4     8    4     20
1     0  1261    0    12    0    0     0    54     4    0      1
2     0     0  149     1   45    5     0    22    13   74      3
3     3     2    0  8141    0   12     0   147   133    0      0
4     4     2   22     3  286    3     0    10    42   12    155
5     0     0    1    19    0  455     0     0    11   34      1
6    29     1    0     8    3    4  1836     3     8    1     15
7     0     8    0   175    1    0     1  7019    57    0      3
8     1     1    4    73    1    3     1    86  3114    1     10
9     1     1   24     5    0  134     0     3    12  313      0
10   44     3    2     9   29    2    12    32    97    1  12561
---- Validation: 
scalar performance:
{'acc': 0.9494985, 'precision': 0.8653147, 'recall': 0.8306109, 'specificity': 0.99458843, 'f1': 0.8416265, 'auroc': 0.9954796}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     4    0    2     4     4    13    4     11
1     0  1266    0    12    0    0     0    47     7    0      0
2     1     4  147     2   41    5     0    12    21   77      2
3     0     0    0  8128    0   25     0   152   134    1      0
4     5     3   21     3  272    3     2     6    57    9    158
5     0     0    0    25    0  450     0     0     7   38      1
6    31     0    1     8    3    3  1843     3     9    0      7
7     0     5    0   200    1    0     2  6991    63    0      3
8     2     0    2    74    2    2     1   101  3101    1     10
9     1     1   31     6    0  133     0     2    13  306      0
10   43     2    1     9   27    4    14    33   110    1  12552
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74057233, 'precision': 0.65843827, 'recall': 0.63682663, 'specificity': 0.9739416, 'f1': 0.6109656, 'auroc': 0.87086}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1050     2    0  21    0   35    17     7    14   17     7
1      3  1293    0  21    0    2     4   155     8    0    13
2      6     7  118   7  277   29    15    55   279   60   162
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    0   0  282    0     1     2    12    1  1335
5      5     0    0  63    1  471     3     0    12   33     4
6      0     0    0   6    3    0  3002     2    10    0    44
7      1     1    0  60    0    1     2  1095     0    0     4
8      0     0    0  44    1    3     8    16  1294    3     1
9      9    28  123  59   18  227    11    71   234  344    13
10     0     0    0   0   10    0     0     0     0    0  1636
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 06:04:34.058863,epoch time: 0:28:27.376519,used: 1:25:41.504664,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95275044, 'precision': 0.88044775, 'recall': 0.85362136, 'specificity': 0.99483603, 'f1': 0.86524034, 'auroc': 0.996607}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    0     7    0    0    20     0    11    2     38
1     0  1237    0    16    0    1     1    71     4    0      2
2     0     0  188     1   18    1     0     2     8   92      2
3     1     0    0  8261    0   20     3    86    68    0      0
4     2     1   43     2  317    3     5     5    34   11    116
5     0     0    1    25    0  446     0     0     5   43      1
6     9     0    1     1    2    1  1877     0     5    0     11
7     0     5    4   390    1    0     4  6809    41    1      7
8     0     0    4   116    6    2     0    47  3095    4     21
9     0     0   18    12    1   86     0     0     6  370      0
10    6     0    4    10   92    1    17    13    42    3  12605
---- Validation: 
scalar performance:
{'acc': 0.9534038, 'precision': 0.8804004, 'recall': 0.85501206, 'specificity': 0.99492526, 'f1': 0.8659153, 'auroc': 0.9964948}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    0     7    0    1    15     3     7    5     39
1     0  1238    0    15    0    0     0    68     9    1      1
2     0     0  187     2   16    3     0     4     7   91      2
3     0     1    0  8250    0   19     6    76    88    0      0
4     3     0   55     1  320    4     1     8    30    9    108
5     0     0    1    21    0  446     0     0     8   44      1
6     7     0    1     5    0    0  1876     0     4    2     13
7     0     3    2   360    1    0     1  6843    50    1      4
8     0     0    3   110    7    1     0    54  3097    2     22
9     0     0   20     8    0   85     1     1     4  374      0
10    6     0    3    10   85    1    22    18    42    3  12606
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73070735, 'precision': 0.67787325, 'recall': 0.624248, 'specificity': 0.97313386, 'f1': 0.6257881, 'auroc': 0.874835}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   980     0    0   18    1   16    76    3    11   45    20
1     2  1015    5   34    1    2     2  393    20    3    22
2     2     0  212    7  233   14    14   31   348   76    78
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    4    0  520    0     1    3    18    1  1086
5     2     0    1   48    2  434     1    0    15   88     1
6     0     0    0    3    1    1  3008    1    13    0    40
7     0     0    1  301    0    1     1  852     5    0     3
8     0     0    0   71    0    1     2    1  1292    3     0
9     3     3  163   72    9  146     8   27   179  519     8
10    0     0    0    0   32    0     1    0     1    0  1612
better model found
persisted
after epoch: 4,now: 2024-08-04 06:33:30.822280,epoch time: 0:28:56.763417,used: 1:54:38.268081,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9536066, 'precision': 0.87804294, 'recall': 0.8363341, 'specificity': 0.99489796, 'f1': 0.8505447, 'auroc': 0.99573606}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     3    0    0     6     2     1    1     11
1     0  1269    0     7    0    0     1    47     4    0      3
2     8     0  201     4   47    1     1    12     7   24      7
3     2     0    0  8020    0    2     2   261   149    0      3
4     8     0   17     0  278    0     6     6    24    3    197
5     9     0    5    61    0  316     0     0    13  116      1
6    10     0    1     2    1    0  1877     0     2    0     14
7     2    11    0    73    1    0     2  7119    35    0     20
8     3     0    2    41    3    0     0    95  3093    0     59
9    20     1   69    12    1   33     2     6    11  338      0
10   73     1    1     8    8    1     9     8    11    0  12672
---- Validation: 
scalar performance:
{'acc': 0.95482147, 'precision': 0.8834398, 'recall': 0.84147763, 'specificity': 0.9950266, 'f1': 0.8556384, 'auroc': 0.9958328}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     1    0    0     7     3     2    1      9
1     0  1272    0     7    0    0     0    44     5    0      4
2     9     0  201     0   40    1     2    18     8   26      7
3     4     1    0  8050    0    1     2   239   141    1      1
4     8     0   21     1  271    0     4     3    26    2    203
5     6     0    3    54    0  338     1     1    17  100      1
6    17     0    1     1    1    0  1869     3     6    0     10
7     3    13    0    68    1    0     1  7112    43    0     24
8     2     0    4    34    4    0     3    83  3100    1     65
9    13     0   70     8    0   25     2     6    18  350      1
10   70     1    1     6    9    0     7    14    15    0  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71069753, 'precision': 0.6297134, 'recall': 0.5830045, 'specificity': 0.97070324, 'f1': 0.5585643, 'auroc': 0.8687854}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1061     0    0    5    0    0    94     2     6    2     0
1      2  1290    0   18    0    0     4   168     9    0     8
2     25     7   93    9  163    5    74    78   382   29   150
3      0     0    0    0    0    0     0     0     0    0     0
4      4     0    1    0  185    0     6     3    13    0  1421
5     29     0    3  169    0  216    28     0    32  114     1
6      0     0    0    2    0    0  3063     1     0    0     1
7      1     0    0   34    0    0     1  1122     2    0     4
8      0     0    0   60    0    0    14     9  1286    1     0
9     66    20  165  102    7   47    86   100   331  204     9
10     0     0    0    0    4    0     3     0     1    0  1638
better model found
persisted
after epoch: 5,now: 2024-08-04 07:01:47.011833,epoch time: 0:28:16.189553,used: 2:22:54.457634,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9624893, 'precision': 0.8904922, 'recall': 0.8698557, 'specificity': 0.99590737, 'f1': 0.8770631, 'auroc': 0.997446}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    1     5    0    0     3     1     2    2     17
1     0  1289    0    11    0    1     0    25     5    0      0
2     5     0  218     1   20    0     0     5     6   51      6
3     0     1    0  8232    1    8     0   111    84    0      1
4     5     1   40     0  309    2     1     2    21    3    155
5     2     0    2    26    0  429     0     0     6   55      1
6    28     1    1     8    1    1  1851     0     5    0     12
7     0    18    0   142    1    0     1  7069    28    0      5
8     1     1    8    62    4    2     0    80  3102    0     35
9     6     1   44     5    0   72     1     5     4  354      1
10   59     4    0     8   23    1     5     7    16    0  12669
---- Validation: 
scalar performance:
{'acc': 0.96284604, 'precision': 0.8959218, 'recall': 0.87358606, 'specificity': 0.9959272, 'f1': 0.88227916, 'auroc': 0.9974027}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    0    0     1     1     1    2     14
1     0  1287    0     8    0    0     0    34     2    0      1
2     2     0  215     1   26    0     2     8     6   50      2
3     0     4    0  8227    0   11     0   109    89    0      0
4     7     0   31     1  318    2     0     3    16    3    158
5     2     0    0    24    0  430     0     0     6   58      1
6    18     2    1     9    2    0  1861     1     3    0     11
7     0    18    1   150    1    0     2  7050    35    0      8
8     2     1    4    65    6    1     1    82  3098    0     36
9     3     0   48    10    0   64     0     5     2  359      2
10   44     4    2     7   21    1     6     7    15    1  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72210175, 'precision': 0.6530536, 'recall': 0.6076832, 'specificity': 0.97223556, 'f1': 0.59201276, 'auroc': 0.8660449}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1113     2    0   29    0    0     4     8     6    3     5
1      2  1274    0   25    0    0     1   185     7    0     5
2     16     5  181   22  126    9    21    48   282   39   266
3      0     0    0    0    0    0     0     0     0    0     0
4      1     1    1    0  110    0     4     2    15    0  1499
5     10     0    3  155    1  311     1     0     5  101     5
6      1     0    0   12    0    0  3040     1     4    0     9
7      1     0    0   54    0    0     0  1105     0    0     4
8      1     0    0  107    0    0     1    22  1236    2     1
9     26    12  220  160   10   94    13    96   168  310    28
10     0     0    0    0    3    0     1     0     1    0  1641
better model found
persisted
after epoch: 6,now: 2024-08-04 07:30:19.961188,epoch time: 0:28:32.949355,used: 2:51:27.406989,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9646565, 'precision': 0.89837295, 'recall': 0.87169135, 'specificity': 0.99614716, 'f1': 0.8829825, 'auroc': 0.99725723}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     5    1    0     5     2     1    0     26
1     0  1294    0     8    0    1     0    26     1    0      1
2     3     2  191     2   55    2     3     8     7   33      6
3     0     5    0  8273    1    6     0    72    81    0      1
4     5     1    9     2  388    2     0     2    22    2    106
5     1     0    0    23    1  457     1     0     6   30      1
6     7     1    1     2    0    0  1883     2     2    0     10
7     1    19    0   181    2    0     1  7012    34    2     10
8     1     1    3    75    7    1     4    45  3112    1     45
9     7     0   54    10    1  101     6     1     8  305      0
10    9     0    0     7   53    2    11     5    10    0  12697
---- Validation: 
scalar performance:
{'acc': 0.9639695, 'precision': 0.8986981, 'recall': 0.8696098, 'specificity': 0.9960541, 'f1': 0.882195, 'auroc': 0.99777}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     5    1    1     4     2     2    0     29
1     0  1298    0     5    0    0     0    25     4    0      0
2     5     1  196     3   48    2     3     5    11   34      4
3     1     2    0  8280    0    9     0    73    75    0      0
4     4     2   10     2  369    1     2     3    25    2    119
5     3     0    1    25    0  452     1     0     8   30      1
6    10     0    1     2    1    0  1880     0     1    0     13
7     0    18    0   193    1    0     2  7001    41    0      9
8     1     0    1    71    8    0     0    44  3123    0     48
9     7     0   52     9    2   94     2     2    11  312      2
10   15     0    0     9   54    1    10     4    15    0  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7160848, 'precision': 0.638937, 'recall': 0.59159404, 'specificity': 0.9712087, 'f1': 0.5714625, 'auroc': 0.86768544}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1104     0    0   13    0    0    40     2     2    2     7
1      4  1312    0   26    0    0    12   124     7    0    14
2     13     0   34   21  148   21   171    22   302   20   263
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    0  247    0    35     2    17    0  1331
5     10     0    0  202    2  280    13     0    10   69     6
6      0     0    0    1    0    0  3065     0     0    0     1
7      1     0    0   60    0    0    15  1081     2    0     5
8      0     0    0   71    0    0    18     4  1270    2     5
9     23     6  116  175   12  116   122    37   280  209    41
10     0     0    0    0    5    0     8     0     0    0  1633
better model found
persisted
after epoch: 7,now: 2024-08-04 07:58:17.450971,epoch time: 0:27:57.489783,used: 3:19:24.896772,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9667166, 'precision': 0.9123214, 'recall': 0.88237876, 'specificity': 0.99634147, 'f1': 0.89619994, 'auroc': 0.9978858}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     1    0     3    0    0     7     1     1    1     35
1     0  1297    1     1    0    0     1    28     3    0      1
2     1     1  203     3   57    1     0     3     4   34      5
3     0     2    0  8183    0    7     1   190    55    1      0
4     1     0    9     1  391    0     0     2    15    0    120
5     0     0    0    25    1  448     1     0     3   42      1
6     4     0    0     2    2    0  1885     2     4    0      9
7     1    11    1    74    2    0     1  7150    15    2      5
8     2     0    3    67   14    1     1    95  3088    0     24
9     0     0   36     8    4   75     0     2     6  358      4
10    7     0    0     6   47    1    10    10    16    0  12695
---- Validation: 
scalar performance:
{'acc': 0.9669654, 'precision': 0.9104738, 'recall': 0.87770295, 'specificity': 0.9963603, 'f1': 0.8929502, 'auroc': 0.99799705}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     4    0    0     5     0     3    0     35
1     0  1294    0     4    0    0     0    30     3    0      1
2     0     1  201     4   52    2     1     4     2   38      7
3     1     3    0  8203    0    6     0   184    43    0      0
4     1     0   11     2  383    1     1     2    14    0    124
5     0     0    0    30    1  437     0     0     4   46      3
6     6     0    1     2    1    0  1883     3     2    1      9
7     0    13    1    73    2    0     1  7149    14    1     11
8     0     0    3    54   18    1     0    92  3109    0     19
9     0     0   39     9    7   75     1     2     6  349      5
10    7     0    0     7   35    1    16     7    17    0  12706
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71146715, 'precision': 0.65588546, 'recall': 0.5758003, 'specificity': 0.97129524, 'f1': 0.56493443, 'auroc': 0.86373574}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1056     2    0   38    1    1    42    11     4   10     5
1      1  1307    0   15    0    0     3   138    11    0    24
2      3     4   83   45  262    5    22    21   348   15   207
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    0  269    0     9     0    16    0  1338
5      5     0    0  392    0  133     3     0    12   46     1
6      0     0    1    5    0    0  3054     0     6    0     1
7      1     0    1   22    0    0     0  1132     4    0     4
8      0     0    0   67    0    0     2     8  1290    2     1
9      7     7  179  330   23   43    16    41   241  211    39
10     0     0    0    0    8    0     3     0     1    0  1634
better model found
persisted
after epoch: 8,now: 2024-08-04 08:26:44.043121,epoch time: 0:28:26.592150,used: 3:47:51.488922,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9699807, 'precision': 0.9134375, 'recall': 0.8913424, 'specificity': 0.99673593, 'f1': 0.8998277, 'auroc': 0.9983348}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     0    0    0     5     0     0    1     39
1     0  1312    1     0    0    0     0    12     6    0      0
2     0     0  195     0   27    1     0     1     3   82      2
3     1     6    0  8282    0   17     4    63    62    5      0
4     1     0   28     1  364    2     1     2    12    4    124
5     2     0    0     8    0  456     0     0     2   52      1
6     7     0    0     0    2    1  1876     0     1    1     19
7     0    35    2   135    1    0     2  7046    34    3      5
8     2     0    1    67    4    0     2    43  3156   12      7
9     1     0   13     1    0   57     2     0     1  418      0
10   11     0    2     7   24    0     3    13    23    0  12711
---- Validation: 
scalar performance:
{'acc': 0.9700682, 'precision': 0.9156491, 'recall': 0.8944297, 'specificity': 0.9967314, 'f1': 0.9028075, 'auroc': 0.9983991}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     1    0    0     3     0     0    2     42
1     0  1313    2     5    0    1     0     7     3    0      1
2     1     0  205     1   24    3     0     2     1   74      1
3     3    10    1  8287    0   16     1    65    55    2      0
4     1     0   25     0  368    2     1     2    16    3    121
5     1     0    0    10    0  451     0     0     3   55      1
6    10     0    1     0    3    1  1875     0     0    0     18
7     2    35    1   136    2    0     2  7040    35    5      7
8     1     0    2    61    4    2     6    46  3149    7     18
9     2     0   11     0    0   51     1     0     2  426      0
10    6     0    2     7   27    0     7     8    21    1  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7428811, 'precision': 0.65388846, 'recall': 0.6359153, 'specificity': 0.9739239, 'f1': 0.61467427, 'auroc': 0.85012716}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1109     0    0   5    0    1    22     9     2    8    14
1     10  1292   13  18    0    2    13    96    15    8    32
2     17     0  106  12  176   16    84    12   264   77   251
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0   73    0     6     0    19    0  1533
5     11     0    0  67    1  376    11     0     7  116     3
6      2     0    1   3    0    0  3032     0     2    0    27
7      7     0    3  31    0    1     7  1100     4    6     5
8      0     0    0  69    0    3    15     5  1271    5     2
9     47     1  103  64   11  106    42    13   103  615    32
10     0     0    0   0    1    0     0     0     1    0  1644
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 08:54:42.420377,epoch time: 0:27:58.377256,used: 4:15:49.866178,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96872324, 'precision': 0.9166665, 'recall': 0.88027596, 'specificity': 0.9964889, 'f1': 0.8929188, 'auroc': 0.9979236}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     3    1    0     2     0     0    2     24
1     0  1301    1     4    0    0     0    19     4    0      3
2     3     0  218     1   23    3     2     1     1   54      6
3     1     2    1  8308    0   30     0    52    37    3      1
4     3     0   21     2  288    0     0     3    20    3    199
5     0     0    0     5    0  408     0     0     2  105      1
6     6     0    0     1    0    1  1876     1     2    2     19
7     0    10    5   141    1    0     1  7060    32    2     11
8     1     0    2    77    2    6     0    45  3116   11     36
9     1     0   25     1    1   30     1     0     2  431      1
10   10     0    0     7    4    1     2     7    13    0  12750
---- Validation: 
scalar performance:
{'acc': 0.9698007, 'precision': 0.91924137, 'recall': 0.8828646, 'specificity': 0.9965978, 'f1': 0.8962771, 'auroc': 0.9979798}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     2    0    0     1     1     0    1     28
1     0  1301    0     8    0    0     0    16     3    0      4
2     1     0  223     1   23    1     0     2     1   51      9
3     0     3    0  8319    0   27     0    55    32    3      1
4     3     0   23     3  300    1     1     2     9    1    196
5     1     0    0     5    0  406     0     0     3  105      1
6     5     0    0     2    1    0  1882     0     2    1     15
7     0    14    2   143    1    0     1  7073    22    3      6
8     3     1    2    74    3    7     1    46  3117    8     34
9     1     1   22     0    1   36     1     0     2  426      3
10   10     0    0     8    6    1     1     4     7    0  12759
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71090746, 'precision': 0.63288, 'recall': 0.5873497, 'specificity': 0.97087246, 'f1': 0.57792544, 'auroc': 0.8413471}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1069     0    0   11    0    0    42    10     1    9    28
1      3  1278    8   23    2    0     7    77    12    0    89
2     11     1  113   22  180    7    69    16   215   39   342
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    2    0   58    0     4     1    11    0  1557
5     15     0    2  137    0  197     8     0     1  229     3
6      0     0    0    4    0    0  3038     0     1    0    24
7      2     0    2   76    0    0     3  1067     4    1     9
8      0     0    1  111    0    0    10     9  1227    3     9
9     24     3  202  164   27   49    41    23    97  470    37
10     0     0    0    0    2    0     0     0     0    0  1644
early stop counter: 1
val acc:0.9698007106781006, best validation acc: 0.9700682163238525, corresponding to test acc:                         0.7428811192512512 / 0.7428811192512512
after epoch: 10,now: 2024-08-04 09:23:07.254802,epoch time: 0:28:24.834425,used: 4:44:14.700603,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:44:14.700603 at 2024-08-04 09:23:07.254802
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7428811, 'precision': 0.65388846, 'recall': 0.6359153, 'specificity': 0.9739239, 'f1': 0.61467427, 'auroc': 0.85012716}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1109     0    0   5    0    1    22     9     2    8    14
1     10  1292   13  18    0    2    13    96    15    8    32
2     17     0  106  12  176   16    84    12   264   77   251
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0   73    0     6     0    19    0  1533
5     11     0    0  67    1  376    11     0     7  116     3
6      2     0    1   3    0    0  3032     0     2    0    27
7      7     0    3  31    0    1     7  1100     4    6     5
8      0     0    0  69    0    3    15     5  1271    5     2
9     47     1  103  64   11  106    42    13   103  615    32
10     0     0    0   0    1    0     0     0     1    0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7428811, 'precision': 0.65388846, 'recall': 0.6359153, 'specificity': 0.9739239, 'f1': 0.61467427, 'auroc': 0.85012716}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1109     0    0   5    0    1    22     9     2    8    14
1     10  1292   13  18    0    2    13    96    15    8    32
2     17     0  106  12  176   16    84    12   264   77   251
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0   73    0     6     0    19    0  1533
5     11     0    0  67    1  376    11     0     7  116     3
6      2     0    1   3    0    0  3032     0     2    0    27
7      7     0    3  31    0    1     7  1100     4    6     5
8      0     0    0  69    0    3    15     5  1271    5     2
9     47     1  103  64   11  106    42    13   103  615    32
10     0     0    0   0    1    0     0     0     1    0  1644
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_04_38_51_seed_0_24051369_instance_wise_predictions.txt
accuracy from prediction file 0.7428811306233821
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/5.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4092 MiB |  18068 MiB |    789 TiB |    789 TiB |
|       from large pool |   4069 MiB |  18034 MiB |    785 TiB |    785 TiB |
|       from small pool |     23 MiB |     35 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4092 MiB |  18068 MiB |    789 TiB |    789 TiB |
|       from large pool |   4069 MiB |  18034 MiB |    785 TiB |    785 TiB |
|       from small pool |     23 MiB |     35 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4084 MiB |  18033 MiB |    788 TiB |    788 TiB |
|       from large pool |   4061 MiB |  18000 MiB |    784 TiB |    784 TiB |
|       from small pool |     22 MiB |     35 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19654 MiB |  19654 MiB |  19654 MiB |      0 B   |
|       from large pool |  19616 MiB |  19616 MiB |  19616 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1203 MiB |   1985 MiB | 489307 GiB | 489306 GiB |
|       from large pool |   1190 MiB |   1978 MiB | 485286 GiB | 485285 GiB |
|       from small pool |     12 MiB |     18 MiB |   4020 GiB |   4020 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   47092 K  |   47088 K  |
|       from large pool |     502    |     727    |   20625 K  |   20625 K  |
|       from small pool |    3168    |    4690    |   26466 K  |   26463 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   47092 K  |   47088 K  |
|       from large pool |     502    |     727    |   20625 K  |   20625 K  |
|       from small pool |    3168    |    4690    |   26466 K  |   26463 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     403    |     403    |     403    |       0    |
|       from large pool |     384    |     384    |     384    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     223    |    1223    |   23186 K  |   23186 K  |
|       from large pool |     185    |     282    |   12044 K  |   12044 K  |
|       from small pool |      38    |    1038    |   11141 K  |   11141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  18068 MiB |    789 TiB |    789 TiB |
|       from large pool |  65536 KiB |  18034 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     35 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  18068 MiB |    789 TiB |    789 TiB |
|       from large pool |  65536 KiB |  18034 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     35 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  18033 MiB |    788 TiB |    788 TiB |
|       from large pool |  65536 KiB |  18000 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     35 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5296 MiB |  19654 MiB |  19654 MiB |  14358 MiB |
|       from large pool |   5260 MiB |  19616 MiB |  19616 MiB |  14356 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 411648 KiB |   1985 MiB | 489309 GiB | 489309 GiB |
|       from large pool | 411648 KiB |   1978 MiB | 485288 GiB | 485288 GiB |
|       from small pool |      0 KiB |     30 MiB |   4020 GiB |   4020 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   47092 K  |   47092 K  |
|       from large pool |       2    |     727    |   20625 K  |   20625 K  |
|       from small pool |       0    |    4690    |   26466 K  |   26466 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   47092 K  |   47092 K  |
|       from large pool |       2    |     727    |   20625 K  |   20625 K  |
|       from small pool |       0    |    4690    |   26466 K  |   26466 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     204    |     403    |     403    |     199    |
|       from large pool |     186    |     384    |     384    |     198    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1223    |   23187 K  |   23187 K  |
|       from large pool |       3    |     282    |   12044 K  |   12044 K  |
|       from small pool |       0    |    1038    |   11142 K  |   11142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  18068 MiB |    789 TiB |    789 TiB |
|       from large pool |  65536 KiB |  18034 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     35 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  18068 MiB |    789 TiB |    789 TiB |
|       from large pool |  65536 KiB |  18034 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     35 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  18033 MiB |    788 TiB |    788 TiB |
|       from large pool |  65536 KiB |  18000 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     35 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5296 MiB |  19654 MiB |  19654 MiB |  14358 MiB |
|       from large pool |   5260 MiB |  19616 MiB |  19616 MiB |  14356 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 411648 KiB |   1985 MiB | 489309 GiB | 489309 GiB |
|       from large pool | 411648 KiB |   1978 MiB | 485288 GiB | 485288 GiB |
|       from small pool |      0 KiB |     30 MiB |   4020 GiB |   4020 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   47092 K  |   47092 K  |
|       from large pool |       2    |     727    |   20625 K  |   20625 K  |
|       from small pool |       0    |    4690    |   26466 K  |   26466 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   47092 K  |   47092 K  |
|       from large pool |       2    |     727    |   20625 K  |   20625 K  |
|       from small pool |       0    |    4690    |   26466 K  |   26466 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     204    |     403    |     403    |     199    |
|       from large pool |     186    |     384    |     384    |     198    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1223    |   23187 K  |   23187 K  |
|       from large pool |       3    |     282    |   12044 K  |   12044 K  |
|       from small pool |       0    |    1038    |   11142 K  |   11142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369

 Experiment start at: 2024-08-04 09:35:27.262104
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92150044, 'precision': 0.8033607, 'recall': 0.75693166, 'specificity': 0.99140954, 'f1': 0.76990074, 'auroc': 0.9910302}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   331     0    6    23    2    3    40     7     4   10     57
1     0  1221    0    22    0    0     0    84     0    0      4
2     2     1  183     2   23    5     3    29    10   51      3
3     1     0    0  8067    0   14     1   292    64    0      0
4     1     2  104     2  195    1     8    23    46   14    143
5     0     0    9    66    0  408     1     0     7   28      2
6    12     0    0    17    0    0  1835    13     9    9     13
7     0     7    3   313    2    0     3  6892    30    0     12
8     2     3   11   388    5    4    10   155  2677    1     40
9     4     1  103    13    1  180     1    12     8  167      3
10   16     2   19    12   76    3    63    61    72    2  12466
---- Validation: 
scalar performance:
{'acc': 0.9212251, 'precision': 0.81486595, 'recall': 0.76222086, 'specificity': 0.991351, 'f1': 0.77732205, 'auroc': 0.9905124}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   321     0    7    26    2    1    40     9     6   12     59
1     0  1212    0    23    0    0     0    92     0    0      5
2     0     0  195     3   22    6     2    33     9   39      3
3     1     0    1  8046    0   15     1   314    60    2      0
4     0     3   98     3  191    3     8    25    46   15    147
5     0     0    7    61    0  413     1     0    11   27      1
6    13     4    0    15    1    0  1846    15     3    5      6
7     1     8    3   336    2    0     1  6879    26    0      9
8     3     0   11   392    2    3     8   156  2677    2     42
9     4     0   77    14    3  181     2    12    11  189      0
10   15     2   13    10   58    3    85    57    78    4  12471
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72007275, 'precision': 0.65692997, 'recall': 0.6040482, 'specificity': 0.9718011, 'f1': 0.5967767, 'auroc': 0.8734497}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   825     2   11   46    0    1   215    36    15    7    12
1     0  1214    1   37    0    1     9   215     6    0    16
2    12     5  281   14  107   29    55    56   388   25    43
3     0     0    0    0    0    0     0     0     0    0     0
4     0     2    4    0  485    0    49     4    39    0  1050
5    13     0    7  102    0  363    11     1    23   70     2
6     0     0    0    6    0    0  3053     4     3    0     1
7     0     0    0   17    0    0     2  1143     0    0     2
8     0     2    0  161    0    2    11     7  1184    2     1
9    18    15  353  149   13  151    25    59   196  152     6
10    0     0    0    0   39    0    15     0     0    0  1592
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 10:04:52.474413,epoch time: 0:29:25.212309,used: 0:29:25.212309,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9395602, 'precision': 0.866328, 'recall': 0.78482187, 'specificity': 0.9932572, 'f1': 0.8077883, 'auroc': 0.99396455}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   392     0   0    16    0    0     4     8     9    7     47
1     0  1219   0    23    0    0     0    84     1    0      5
2     2     0  70     1   94    1     3    23    12   98      8
3     0     0   0  8231    1    9     0   131    62    1      0
4     3     0   4     0  260    0     0     8    32   22    210
5     1     0   0    48    0  336     0     0     7  126      3
6    19     0   0    17    1    1  1814     8    12    2     34
7     1     3   0   374    2    0     1  6823    50    1      8
8     1     0   0   208   15    2     0    84  2957    5     24
9     2     0  18    11    8   37     1     5    11  397      3
10   12     0   0     8   17    1    10    37    91    0  12618
---- Validation: 
scalar performance:
{'acc': 0.938692, 'precision': 0.87232155, 'recall': 0.78119844, 'specificity': 0.9931509, 'f1': 0.8030604, 'auroc': 0.99397945}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   391     0   0    16    0    0     5    12    10    6     43
1     0  1217   0    20    0    0     0    87     4    0      4
2     1     0  54     2  104    1     2    30     6  105      7
3     0     0   0  8216    0    6     0   143    74    1      0
4     4     0   1     2  264    0     0     7    32   20    209
5     0     0   0    42    0  349     0     0     5  124      1
6    15     2   0    22    0    0  1802     8    13    3     43
7     0     3   0   388    1    0     1  6814    47    1     10
8     2     1   1   205    6    0     0    86  2964    4     27
9     2     0   9    10   12   44     2    16     5  392      1
10   14     0   0     7   19    0     3    32    88    3  12630
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6747359, 'precision': 0.6082761, 'recall': 0.5529816, 'specificity': 0.9676356, 'f1': 0.5390283, 'auroc': 0.8622837}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   988     1   0   79    0    0    25    34    19    6    18
1     0  1192   0   42    0    1     0   237     7    0    20
2    19     0   2   33  228    2     2    43   339   60   287
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    0   95    0     1     2    16    0  1518
5     6     0   0  161    0  204     0     0    13  203     5
6     0     0   0   56    0    0  2920     3    22    0    66
7     0     0   0  154    0    0     0  1004     2    0     4
8     0     0   0  178    0    0     1     3  1185    2     1
9    19     5   6  215   59   35     2    73   264  408    51
10    0     0   0    0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 2,now: 2024-08-04 10:32:52.108137,epoch time: 0:27:59.633724,used: 0:57:24.846033,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9508241, 'precision': 0.8702054, 'recall': 0.8502915, 'specificity': 0.9946637, 'f1': 0.858692, 'auroc': 0.99633235}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     9    1    0    11     3     6    2     26
1     0  1259    0    14    0    0     0    53     6    0      0
2     2     0  219     1   44    0     1     5    10   29      1
3     1     0    1  8223    0   15     2   112    84    0      0
4     8     1   30     0  319    1     1     2    36   11    130
5     2     0    3    23    0  381     0     0     6  105      1
6    11     0    1     3    0    0  1871     2     5    2     12
7     1    11    1   289    1    0     2  6880    70    3      6
8     2     1    8   168    4    3     0    48  3034    1     26
9     2     0   88    12    2   37     1     2     5  343      1
10   21     1    4     8   65    1    22    18    67    1  12584
---- Validation: 
scalar performance:
{'acc': 0.9508091, 'precision': 0.86580044, 'recall': 0.84629714, 'specificity': 0.99467355, 'f1': 0.8547923, 'auroc': 0.996375}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     9    0    0    10     5     2    2     23
1     0  1263    0     9    0    0     0    49    10    0      1
2     2     0  210     4   48    1     1     5     5   36      0
3     2     0    2  8235    0   16     2   106    75    2      0
4     8     1   31     1  320    2     1     4    40   11    120
5     2     0    4    25    0  370     0     0     7  112      1
6    12     0    1     2    0    1  1867     3     7    1     14
7     0    11    2   273    1    0     2  6916    54    0      6
8     3     0    6   190    6    3     2    61  2998    0     27
9     4     0   81    10    1   46     2     2     7  340      0
10   20     0    1     8   68    0    18    18    66    2  12595
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70503044, 'precision': 0.6712799, 'recall': 0.5822507, 'specificity': 0.9705807, 'f1': 0.575222, 'auroc': 0.86413735}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   864     1    0   71    0    2   133    39    43    9     8
1     0  1234    0   40    0    0     0   201    15    0     9
2    15     1  110   22   74   14     4    33   590   26   126
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    1    0  411    0     9     2    57    1  1151
5     3     0    2  178    0  313     3     0    35   55     3
6     0     0    0   11    0    0  3038     3    12    0     3
7     1     0    0  104    0    0     0  1055     2    0     2
8     0     0    0  118    0    1     1     1  1247    1     1
9    14     4  126  196    5  102     4    63   421  186    16
10    0     0    0    0   23    0     3     0     1    0  1619
better model found
persisted
after epoch: 3,now: 2024-08-04 11:01:11.189871,epoch time: 0:28:19.081734,used: 1:25:43.927767,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9535263, 'precision': 0.8728036, 'recall': 0.82645106, 'specificity': 0.9948333, 'f1': 0.8463673, 'auroc': 0.99602175}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     8    1    0     0     2     0    0     43
1     1  1266    0    12    0    0     0    46     5    0      1
2     5     0  145     3  121    2     1     9     1   22      3
3     2     0    1  8228    1    1     0   155    49    0      0
4     3     0    3     3  358    1     0     1    15    1    154
5     2     0    1    74    4  346     0     0     4   88      2
6    34     0    1     9    1    0  1836     1     3    3     18
7     1     4    0   193    2    0     2  7003    38    0     21
8     4     0    1   152   12    0     0    83  2997    0     46
9     7     0   66    19   16   47     2     5     6  322      3
10   15     0    1     6   37    1     2    14    10    0  12709
---- Validation: 
scalar performance:
{'acc': 0.953912, 'precision': 0.8761424, 'recall': 0.82817125, 'specificity': 0.9948695, 'f1': 0.84896344, 'auroc': 0.995828}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0    11    1    0     1     2     1    0     39
1     0  1268    0     8    0    0     0    51     5    0      0
2     5     0  150     2  119    1     1     6     2   21      5
3     1     1    0  8250    0    1     0   139    48    0      0
4     7     0    4     2  353    1     0     1    10    1    160
5     4     0    1    70    2  345     0     0     6   92      1
6    21     0    1     7    1    1  1848     4     5    0     20
7     4     7    0   189    4    0     1  7001    39    0     20
8     5     0    3   149   10    0     0    84  2995    0     50
9     6     0   69    23   18   36     2     5     5  327      2
10   14     0    0    10   32    0     3    13    27    0  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65955365, 'precision': 0.6104934, 'recall': 0.5311563, 'specificity': 0.9661499, 'f1': 0.5084093, 'auroc': 0.8530826}
confusion matrix:
      0     1    2    3    4   5     6     7     8    9     10
0   1004     1    0   65    1   0    22    31    25    2    19
1      0  1243    0   25    0   0     0   215     1    0    15
2     18     0   15   32  268   1     2    55   257    8   359
3      0     0    0    0    0   0     0     0     0    0     0
4      1     0    0    0  208   0     0     1     8    0  1415
5     10     0    3  382    1  83     0     1    29   76     7
6      0     0    1  101    2   0  2746     5    31    0   181
7      0     0    0   50    0   0     1  1109     0    0     4
8      0     0    0   92    0   0     1    41  1230    0     6
9     25     3  115  263   59  12     3   138   306  148    65
10     0     0    0    0    5   0     0     0     0    0  1641
better model found
persisted
after epoch: 4,now: 2024-08-04 11:28:52.288173,epoch time: 0:27:41.098302,used: 1:53:25.026069,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95154643, 'precision': 0.8529551, 'recall': 0.86367583, 'specificity': 0.99495435, 'f1': 0.84990007, 'auroc': 0.99705285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     1    1     3    2    0    11     3     1    4     38
1     0  1300    0     4    1    0     0    15     7    0      5
2     1     0  259     0   33    0     1     1     1   16      0
3     0     7    1  8140    0   11     1   155   116    7      1
4     3     0   39     1  422    0     0     3    13    6     52
5     1     0   10    12    0  295     1     0     8  193      1
6     3     0    1     3    1    0  1876     2     3    1     18
7     1    80    7   192    4    0     1  6945    27    0      6
8     3     2   14    61   11    1     1    84  3082    3     31
9     4     0  146     3    2    9     0     1     2  325      0
10    6     0    3     6  224    0    11    15    24    3  12502
---- Validation: 
scalar performance:
{'acc': 0.9508359, 'precision': 0.8544758, 'recall': 0.8652073, 'specificity': 0.9948614, 'f1': 0.85187, 'auroc': 0.9968952}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     1    0     5    1    0     9     4     4    3     40
1     0  1300    0     5    0    0     0    15     6    0      6
2     2     0  253     0   35    0     1     2     2   17      0
3     0     8    2  8113    0   13     2   172   128    2      0
4     3     0   41     1  433    0     0     1     9    3     48
5     2     0    9    15    0  304     0     0     6  184      1
6     5     0    1     3    2    0  1873     2     3    1     18
7     0    79    5   202    1    0     2  6939    27    1      9
8     2     7   13    72   13    1     0    67  3085    1     35
9     2     0  146     4    2    5     0     1     1  331      1
10   10     0    2     6  227    0    10    14    25    2  12500
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7476387, 'precision': 0.6758454, 'recall': 0.60888183, 'specificity': 0.9744966, 'f1': 0.6093169, 'auroc': 0.8765275}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   865     1    5  10    7    0   158    18    11   57    38
1     0  1334    2   9    2    1     0    88    16    3    44
2     1     0  293   2  349    0     5    34   207   31    93
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  680    0     4     0    11    0   934
5     1     0    9  45    6  110     0     0    31  388     2
6     0     0    0   0    0    0  3055     1     1    0    10
7     0     1    0  42    0    0     0  1114     0    1     6
8     0     0    3  27    2    1     1    20  1310    3     3
9     3     4  487  37   22    5     3    53   142  363    18
10    0     0    0   0   83    0     1     0     0    0  1562
new oracle model saved
early stop counter: 1
val acc:0.9508358836174011, best validation acc: 0.9539120197296143, corresponding to test acc:                         0.6595536470413208 / 0.7476387023925781
after epoch: 5,now: 2024-08-04 11:56:43.492968,epoch time: 0:27:51.204795,used: 2:21:16.230864,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9595462, 'precision': 0.87496144, 'recall': 0.87081444, 'specificity': 0.99572027, 'f1': 0.8700855, 'auroc': 0.9976106}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     3    1    0    10     2     1    1     13
1     0  1291    0     8    0    0     1    26     3    0      1
2     5     0  164     0   19    9     1     3     2  108      1
3     0     3    1  8253    0   19     1   120    40    0      0
4     7     0   43     0  381    1     0     3    19   18     66
5     0     0    0    17    0  470     0     0     5   28      1
6     7     1    0     2    0    2  1884     0     4    1      5
7     2    15    2   204    1    2     2  6978    54    2      3
8     2     2    1   141    5    5     1    42  3075    4     18
9     1     0    6     2    0  136     0     1     4  342      1
10   36     0    2     6   95    1     9    17    51    4  12574
---- Validation: 
scalar performance:
{'acc': 0.95939547, 'precision': 0.8711877, 'recall': 0.8657146, 'specificity': 0.99572027, 'f1': 0.86506426, 'auroc': 0.9976715}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     4    2    0     9     4     1    2     13
1     0  1298    0     8    0    0     0    23     2    0      1
2     1     0  146     0   29    6     1     1     7  121      0
3     0     4    0  8248    0   18     0   125    45    0      0
4     4     0   45     0  383    1     1     0    25   15     65
5     0     0    0    12    0  476     0     0     6   26      1
6     9     0    0     1    1    0  1882     0     4    2      9
7     1    16    1   197    1    0     3  6987    51    3      5
8     1     4    1   130    4    4     1    51  3089    2      9
9     0     0    8     4    0  138     0     1     4  337      1
10   32     1    1     6  104    2    14    18    43    2  12573
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.737214, 'precision': 0.6776298, 'recall': 0.6262383, 'specificity': 0.973724, 'f1': 0.60908103, 'auroc': 0.8700489}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1037     5   0   12    1    4    85     4     6   14     2
1      0  1306   0   26    0    0     2   144     8    0    13
2     20     1  99   17  207   17     3    29   492   64    66
3      0     0   0    0    0    0     0     0     0    0     0
4      2     0   2    0  415    0     3     2    34    1  1174
5      3     0   0   87    1  426     0     0    23   52     0
6      0     0   0   26    0    0  3019     1     4    0    17
7      0     0   0   80    0    1    11  1066     3    0     3
8      1     0   0  123    0    1     1     6  1237    1     0
9     10     5  61  127    7  228     3    61   319  305    11
10     0     0   0    0   17    0     2     0     0    0  1627
better model found
persisted
after epoch: 6,now: 2024-08-04 12:24:26.920094,epoch time: 0:27:43.427126,used: 2:48:59.657990,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96251607, 'precision': 0.9105952, 'recall': 0.8617202, 'specificity': 0.9958801, 'f1': 0.8796554, 'auroc': 0.9977218}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     3    1    0    29     1     0    2     18
1     0  1265    0    10    0    0     1    50     6    0      0
2     2     0  165     2   53    0     0     9     2   78      1
3     1     0    0  8179    0    8     4   192    50    2      0
4     5     0   13     0  352    1     2     3    10    4    149
5     0     0    0    30    0  376     1     0     6  107      1
6     2     0    0     0    1    0  1890     1     2    2      9
7     0     8    0    74    1    0     4  7153    17    0      5
8     3     0    2    76    4    0     5    80  3070    1     54
9     2     0   10     9    4   28     2     6     2  429      1
10    9     0    1     4   28    0    49    18    18    2  12667
---- Validation: 
scalar performance:
{'acc': 0.9634613, 'precision': 0.91293377, 'recall': 0.8669337, 'specificity': 0.9959901, 'f1': 0.8836317, 'auroc': 0.9979862}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     2    3    0    20     5     0    0     14
1     0  1270    0     9    0    0     0    50     3    0      0
2     3     0  170     1   49    0     1     5     7   75      1
3     1     1    0  8176    1    3     2   193    60    3      0
4     2     0   10     1  349    0     4     4     8    7    154
5     0     0    0    26    1  380     1     0     6  106      1
6     6     0    1     0    1    0  1888     2     2    1      7
7     1     6    0    78    1    0     3  7151    19    1      5
8     1     0    3    65    7    1     4    82  3088    2     43
9     4     0   13     8    4   21     2     3     2  435      1
10   10     0    1     7   23    0    54    15    10    3  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71006787, 'precision': 0.66211224, 'recall': 0.58516216, 'specificity': 0.97070265, 'f1': 0.57139534, 'auroc': 0.8659}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   977     0   0    8    0    1   159    12     3    7     3
1     0  1134   0   30    0    0     2   309     6    0    18
2    17     1  75   12  194    1    44   114   191  106   260
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   1    0  201    0    32     2     7    0  1388
5     9     0   0   90    1  207     2     0    23  252     8
6     0     0   0    2    0    0  3064     1     0    0     0
7     0     0   0   56    0    0     3  1103     0    0     2
8     0     0   0  100    0    1     5    28  1226    3     7
9    25     1  44  129    8   42    18   183   129  528    30
10    0     0   0    0    5    0     7     0     0    0  1634
better model found
persisted
after epoch: 7,now: 2024-08-04 12:52:13.687917,epoch time: 0:27:46.767823,used: 3:16:46.425813,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96337223, 'precision': 0.9159617, 'recall': 0.87179315, 'specificity': 0.9959231, 'f1': 0.8878678, 'auroc': 0.99821234}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     2    2    0     7     0     2    2     21
1     0  1302    0    10    0    0     1    18     1    0      0
2     2     0  155     1   52    1     0     2     5   92      2
3     0     1    0  8354    0    2     2    43    34    1      0
4     5     0    7     2  353    2     1     0    18    7    144
5     0     0    0    26    0  454     0     0     2   37      1
6     5     0    2     2    0    1  1879     0     2    2     15
7     2    26    2   313    1    0     1  6856    52    2      8
8     0     1    1   150    3    3     3    30  3082    3     20
9     0     0   10     7    4   67     0     2     2  401      0
10    7     0    0     8   12    1     7     9    22    3  12724
---- Validation: 
scalar performance:
{'acc': 0.96217734, 'precision': 0.91397107, 'recall': 0.8671505, 'specificity': 0.9957624, 'f1': 0.8840662, 'auroc': 0.99815094}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     2    2    0     5     1     1    4     22
1     0  1298    0     9    0    0     0    20     3    0      2
2     1     0  150     2   58    1     0     3     3   93      1
3     0     3    1  8348    0    4     2    47    35    0      0
4     3     0    8     1  341    1     0     1    18    9    157
5     0     0    0    30    0  452     0     0     3   35      1
6     9     0    0     1    0    0  1866     1     2    6     23
7     1    16    1   336    1    0     2  6851    46    2      9
8     0     0    3   138    2    4     0    29  3091    2     27
9     0     0   10     8    3   65     0     2     1  403      1
10    8     0    0     8   11    1     7     6    26    4  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69985306, 'precision': 0.65057576, 'recall': 0.58107185, 'specificity': 0.9701757, 'f1': 0.57945454, 'auroc': 0.85519844}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   976     2    0   44    1   12    40    7    19   43    26
1     0  1255    0   41    1    0     0  161     9    0    32
2     5     0  114   24  203    8     4   35   268   75   279
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    1   96    0     2    1    10    1  1522
5     1     0    0  183    0  269     0    0     9  128     2
6     0     0    0   22    0    0  3023    2     2    0    18
7     0     0    0  165    0    0     1  991     3    0     4
8     0     0    0  161    1    1     0    4  1198    2     3
9     4     0  106  276   20   64     1   59   134  438    35
10    0     0    0    0    3    0     0    0     0    0  1643
early stop counter: 1
val acc:0.9621773362159729, best validation acc: 0.9634612798690796, corresponding to test acc:                         0.710067868232727 / 0.7476387023925781
after epoch: 8,now: 2024-08-04 13:20:01.947204,epoch time: 0:27:48.259287,used: 3:44:34.685100,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96968645, 'precision': 0.9071055, 'recall': 0.90935624, 'specificity': 0.99676675, 'f1': 0.9074911, 'auroc': 0.998591}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     5    3    0     1     2     0    0     10
1     0  1301    0    10    0    0     0    18     3    0      0
2     1     0  235     0   42    0     0     6     2   26      0
3     1     1    0  8310    0   14     1    68    44    0      0
4     4     0   16     1  448    1     1     1     6    4     57
5     1     0    0    10    0  468     0     0     3   38      1
6     8     0    0    10    0    0  1873     2     3    3      8
7     1    13    1   169    1    0     1  7042    27    0      5
8     2     1    4    82   20    2     2    61  3103    2     16
9     2     0   53     7    2   68     1     2     3  355      0
10   14     0    1     8   95    1     4     8    17    1  12646
---- Validation: 
scalar performance:
{'acc': 0.9704962, 'precision': 0.9123217, 'recall': 0.9171813, 'specificity': 0.9968514, 'f1': 0.9139033, 'auroc': 0.998591}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     8    1    1     0     2     0    1      8
1     0  1297    0    11    0    0     0    24     0    0      0
2     1     0  244     1   37    2     1     1     0   24      1
3     0     1    0  8308    0   20     0    67    44    0      0
4     5     0   14     1  463    1     1     1     3    3     47
5     0     0    0    10    0  474     0     0     4   32      1
6     8     0    0    11    0    0  1873     2     4    5      5
7     0    16    1   174    2    0     1  7046    21    0      4
8     2     0    6    91   20    2     1    68  3094    0     12
9     0     0   52     6    2   64     0     1     1  367      0
10   11     0    1     7   93    2     2    11    15    0  12654
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71993285, 'precision': 0.6668798, 'recall': 0.60723996, 'specificity': 0.97215205, 'f1': 0.60629034, 'auroc': 0.8617829}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   998     1    0   60    2    6    44   24     7   21     7
1     0  1267    0   39    1    0     1  168     3    0    20
2    18     2  132   34  286   15    28   49   195   37   219
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    1  305    0    10    2     5    0  1308
5     2     0    3  114    2  401     0    0    10   59     1
6     0     0    0    4    0    0  3054    3     2    0     4
7     0     0    0  172    0    0     2  987     0    0     3
8     0     2    0  149    2    0     5   13  1193    2     4
9    15     7  183  259   12  115     6   78   117  317    28
10    0     0    0    0    9    0     1    0     0    0  1636
better model found
persisted
after epoch: 9,now: 2024-08-04 13:49:46.866391,epoch time: 0:29:44.919187,used: 4:14:19.604287,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96639556, 'precision': 0.89356816, 'recall': 0.9080885, 'specificity': 0.99645895, 'f1': 0.89715135, 'auroc': 0.998565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    3     1    3    0     5     0     1    7     38
1     0  1294    1     8    0    1     1    22     5    0      0
2     0     0  271     0   25    0     0     0     1   14      1
3     0     1    2  8047    0   70     3   144   168    2      1
4     2     0   35     0  440    2     0     0     4    1     55
5     0     0    3     2    0  477     0     0     1   36      1
6     3     0    2     0    3    1  1876     1     3    3     16
7     0     5    7    54    1    0     1  7134    45    2     15
8     0     0   14    22   30    9     2    31  3133    2     52
9     0     0   91     1    2   66     0     0     1  332      0
10    0     0    5     7   76    1     3     5     4    0  12691
---- Validation: 
scalar performance:
{'acc': 0.9654407, 'precision': 0.89117885, 'recall': 0.9078312, 'specificity': 0.9963536, 'f1': 0.8951412, 'auroc': 0.9983879}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    2     2    6    0     4     0     0    4     42
1     0  1292    1     6    0    1     1    24     4    0      3
2     0     0  278     0   19    1     0     0     1   13      0
3     0     0    2  8032    1   80     3   145   174    2      1
4     1     0   37     0  429    1     0     1     2    4     64
5     0     0    2     3    1  476     0     0     1   38      0
6     2     0    1     0    3    2  1879     1     3    1     16
7     0     6   18    59    1    0     1  7123    42    1     14
8     0     0   23    16   24   10     0    31  3137    1     54
9     0     0   87     0    2   68     0     0     1  335      0
10    0     0    5     5   82    1     2     5     5    2  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73756385, 'precision': 0.6630579, 'recall': 0.639022, 'specificity': 0.9735112, 'f1': 0.62939924, 'auroc': 0.86374354}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   822     0    0   9    9   10    71     5     8  189    47
1     0  1111   16  21    0    7     0   283     8    5    48
2     0     0  388   1  262    7     2    22   109   73   151
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    3   0  190    0     2     1     4    1  1432
5     0     0    4  12    0  426     0     0     5  143     2
6     0     0    1   0    0    0  2997     0     1    1    67
7     0     0    4  20    0    1     2  1131     1    1     4
8     0     0    3  31    2   18     1    13  1292    3     7
9     0     0  362  15    9  107     0    19    55  544    26
10    0     0    0   0    5    0     0     0     0    0  1641
early stop counter: 1
val acc:0.9654406905174255, best validation acc: 0.9704961776733398, corresponding to test acc:                         0.7199328541755676 / 0.7476387023925781
after epoch: 10,now: 2024-08-04 14:17:47.627615,epoch time: 0:28:00.761224,used: 4:42:20.365511,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:42:20.365511 at 2024-08-04 14:17:47.627615
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71993285, 'precision': 0.6668798, 'recall': 0.60723996, 'specificity': 0.97215205, 'f1': 0.60629034, 'auroc': 0.8617829}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   998     1    0   60    2    6    44   24     7   21     7
1     0  1267    0   39    1    0     1  168     3    0    20
2    18     2  132   34  286   15    28   49   195   37   219
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    1  305    0    10    2     5    0  1308
5     2     0    3  114    2  401     0    0    10   59     1
6     0     0    0    4    0    0  3054    3     2    0     4
7     0     0    0  172    0    0     2  987     0    0     3
8     0     2    0  149    2    0     5   13  1193    2     4
9    15     7  183  259   12  115     6   78   117  317    28
10    0     0    0    0    9    0     1    0     0    0  1636
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7476387, 'precision': 0.6758454, 'recall': 0.60888183, 'specificity': 0.9744966, 'f1': 0.6093169, 'auroc': 0.8765275}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   865     1    5  10    7    0   158    18    11   57    38
1     0  1334    2   9    2    1     0    88    16    3    44
2     1     0  293   2  349    0     5    34   207   31    93
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  680    0     4     0    11    0   934
5     1     0    9  45    6  110     0     0    31  388     2
6     0     0    0   0    0    0  3055     1     1    0    10
7     0     1    0  42    0    0     0  1114     0    1     6
8     0     0    3  27    2    1     1    20  1310    3     3
9     3     4  487  37   22    5     3    53   142  363    18
10    0     0    0   0   83    0     1     0     0    0  1562
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_35_26_seed_1_24051369_instance_wise_predictions.txt
accuracy from prediction file 0.7199328342545301
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4093 MiB |  18068 MiB |   1578 TiB |   1578 TiB |
|       from large pool |   4070 MiB |  18034 MiB |   1570 TiB |   1570 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4093 MiB |  18068 MiB |   1578 TiB |   1578 TiB |
|       from large pool |   4070 MiB |  18034 MiB |   1570 TiB |   1570 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4084 MiB |  18033 MiB |   1576 TiB |   1576 TiB |
|       from large pool |   4061 MiB |  18000 MiB |   1568 TiB |   1568 TiB |
|       from small pool |     22 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19730 MiB |  19730 MiB |  34088 MiB |  14358 MiB |
|       from large pool |  19692 MiB |  19692 MiB |  34048 MiB |  14356 MiB |
|       from small pool |     38 MiB |     38 MiB |     40 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2054 MiB |   2549 MiB |    986 TiB |    986 TiB |
|       from large pool |   2041 MiB |   2542 MiB |    978 TiB |    978 TiB |
|       from small pool |     12 MiB |     30 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   94182 K  |   94178 K  |
|       from large pool |     502    |     727    |   41251 K  |   41250 K  |
|       from small pool |    3168    |    4690    |   52931 K  |   52928 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   94182 K  |   94178 K  |
|       from large pool |     502    |     727    |   41251 K  |   41250 K  |
|       from small pool |    3168    |    4690    |   52931 K  |   52928 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     391    |     403    |     590    |     199    |
|       from large pool |     372    |     384    |     570    |     198    |
|       from small pool |      19    |      19    |      20    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     230    |    1223    |   46790 K  |   46789 K  |
|       from large pool |     192    |     282    |   24470 K  |   24470 K  |
|       from small pool |      38    |    1038    |   22319 K  |   22319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  18068 MiB |   1578 TiB |   1578 TiB |
|       from large pool |  65536 KiB |  18034 MiB |   1570 TiB |   1570 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  18068 MiB |   1578 TiB |   1578 TiB |
|       from large pool |  65536 KiB |  18034 MiB |   1570 TiB |   1570 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  18033 MiB |   1576 TiB |   1576 TiB |
|       from large pool |  65536 KiB |  18000 MiB |   1568 TiB |   1568 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6148 MiB |  19730 MiB |  34088 MiB |  27940 MiB |
|       from large pool |   6112 MiB |  19692 MiB |  34048 MiB |  27936 MiB |
|       from small pool |     36 MiB |     38 MiB |     40 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 411648 KiB |   2549 MiB |    986 TiB |    986 TiB |
|       from large pool | 411648 KiB |   2542 MiB |    978 TiB |    978 TiB |
|       from small pool |      0 KiB |     30 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   94182 K  |   94182 K  |
|       from large pool |       2    |     727    |   41251 K  |   41251 K  |
|       from small pool |       0    |    4690    |   52931 K  |   52931 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   94182 K  |   94182 K  |
|       from large pool |       2    |     727    |   41251 K  |   41251 K  |
|       from small pool |       0    |    4690    |   52931 K  |   52931 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     206    |     403    |     590    |     384    |
|       from large pool |     188    |     384    |     570    |     382    |
|       from small pool |      18    |      19    |      20    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1223    |   46791 K  |   46791 K  |
|       from large pool |       3    |     282    |   24471 K  |   24471 K  |
|       from small pool |       0    |    1038    |   22320 K  |   22320 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 14:23:01 2024]
Finished job 0.
1 of 1 steps (100%) done
