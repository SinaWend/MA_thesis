Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 14:58:44 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362

 Experiment start at: 2024-08-03 15:12:30.093135
before training, model accuracy: 0.044287413358688354
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9208583, 'precision': 0.83227265, 'recall': 0.6765094, 'specificity': 0.9912312, 'f1': 0.6872337, 'auroc': 0.9869487}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   131     0   0     9    0    2   205     6     7   18    105
1     0  1270   0    14    0    0     2    38     6    0      2
2     2    14   5     5   39   15    23     8    38  124     39
3     0     4   0  8024    0    3     7   205   186    5      3
4     1     4   0     3  106    4    35     5    49   15    316
5     0     0   0    61    0  292     6     0    15  144      3
6     2     3   0     7    0    0  1860     7    11    3     14
7     0    58   0   266    1    1    10  6768   114    4     41
8     1     5   0   126    0    4    22    61  2959    5    112
9     0     2   1    14    3   78    16     1    27  344      7
10    5     7   0     7    5    0    49    27    33    3  12659
---- Validation: 
scalar performance:
{'acc': 0.9209041, 'precision': 0.8311682, 'recall': 0.6780237, 'specificity': 0.9912197, 'f1': 0.687678, 'auroc': 0.9872197}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   132     0   0    10    0    1   194    11    11   18    106
1     0  1265   0    17    0    1     1    37     8    0      3
2     1    15   4     4   37   14    15    14    35  129     44
3     0     6   0  8017    1   10     8   192   195    5      6
4     1     2   0     3  105    4    14     3    61   22    324
5     0     0   0    58    0  296     6     0    16  143      2
6     2     2   0     6    0    0  1866     4    10    2     16
7     0    59   0   278    1    1    13  6761   115    2     35
8     0     6   0   124    1    2    19    49  2972    4    119
9     0     2   1     9    1   79    19     0    23  350      9
10    5    16   0    10    4    1    48    18    32    2  12660
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6495487, 'precision': 0.58837444, 'recall': 0.5146887, 'specificity': 0.9634484, 'f1': 0.47835302, 'auroc': 0.86221254}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   164     3   0  46    0    0   849    23    32   50     3
1     0  1319   0  26    2    0    20   104    11    3    14
2     5    12   0   6   90    1   168    32   330  160   211
3     0     0   0   0    0    0     0     0     0    0     0
4     0     5   0   0  120    0    29     1    22    0  1456
5     4     0   0  87    0  124    47     0    29  300     1
6     0     1   0   2    1    0  2950     4    45    1    63
7     0     8   0  51    0    0     9  1089     1    2     4
8     0     0   0  44    0    0    43     4  1268    7     4
9     2    25   0  51    6   23    80    35   279  620    16
10    0     5   0   0    1    0     9     0     1    0  1630
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 16:09:25.771278,epoch time: 0:56:55.678143,used: 0:56:55.678143,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.940122, 'precision': 0.8505079, 'recall': 0.77905744, 'specificity': 0.99343526, 'f1': 0.79828715, 'auroc': 0.9939213}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   384     0   0    13    0    3     2    10     7   22     42
1     0  1216   0    18    0    0     0    81    13    0      4
2     0     0  85     7   17    8     1    20    28  140      6
3     0     1   0  8204    0   12     0   126    96    0      0
4     2     0  38     2  187    5     0    11    81   23    190
5     0     0   0    40    0  429     0     0     7   44      1
6    26     0   0    18    1    1  1803     9    13    7     29
7     2     3   0   324    1    0     1  6859    66    2      4
8     1     0   2   140    0    3     0    72  3067    1     10
9     0     0   7    21    0  130     0     5    12  316      1
10   21     0   5     9   17    4     4    40   101    4  12588
---- Validation: 
scalar performance:
{'acc': 0.9393607, 'precision': 0.8505445, 'recall': 0.7807324, 'specificity': 0.993377, 'f1': 0.7998087, 'auroc': 0.9936813}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   383     0   0    16    0    2     3     6     9   25     39
1     1  1209   0    18    0    0     0    79    20    0      5
2     0     0  93     5   14    4     1    21    30  142      2
3     1     0   0  8186    0   15     0   123   114    1      0
4     3     0  41     7  190    5     0    16    87   21    169
5     0     0   0    48    0  420     0     0     6   46      1
6    26     0   0    13    1    3  1805     3    10    8     39
7     1     2   0   332    1    0     1  6851    72    0      5
8     2     0   2   130    1    3     0    59  3085    0     14
9     1     0   6    23    0  128     0     5     7  322      1
10   24     0   4     9   18    4     5    40   115    3  12574
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64416146, 'precision': 0.6628411, 'recall': 0.56999916, 'specificity': 0.9644338, 'f1': 0.53019863, 'auroc': 0.87430143}
confusion matrix:
      0    1   2    3    4    5     6     7     8    9     10
0   1030    0   0   31    0    1     1    22    57   27     1
1      0  992   0   28    0    2     4   393    49    0    31
2     16    0  21   24   18   39     3    64   560  150   120
3      0    0   0    0    0    0     0     0     0    0     0
4      3    0   1    0  130    0     0     6    59    1  1433
5      5    0   0   87    0  423     0     0    22   54     1
6     22    0   0   13    7    0  2237     8   532    1   247
7      2    0   0  116    0    1     2  1037     2    1     3
8      0    0   0   51    0    4     1     2  1311    1     0
9     26    2   6  105    1  220     0    55   321  386    15
10     0    0   0    0    5    0     0     0     1    0  1640
better model found
persisted
after epoch: 2,now: 2024-08-03 17:03:53.305864,epoch time: 0:54:27.534586,used: 1:51:23.212729,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9505565, 'precision': 0.8856578, 'recall': 0.81958276, 'specificity': 0.994694, 'f1': 0.84066945, 'auroc': 0.9956147}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    0     1    0    0    18     1    16    4     37
1     0  1273    0     7    0    0     0    35    14    0      3
2     3     0  129     3   42    0     4     7    41   82      1
3     1     1    0  8011    0   16     2   143   264    1      0
4     2     0   14     0  260    2     6     2    67    6    179
5     3     0    0    25    0  351     2     0    16  123      1
6     8     0    0     3    1    0  1872     3    10    1      9
7     0     6    0   150    2    0     4  6975   109    2     15
8     0     0    1    26    1    0     0    40  3208    1     19
9     4     0   11     8    2   45     4     0    26  392      1
10   13     0    1     7   21    2    19    13    65    0  12651
---- Validation: 
scalar performance:
{'acc': 0.9491775, 'precision': 0.88488674, 'recall': 0.81563425, 'specificity': 0.9945588, 'f1': 0.8364023, 'auroc': 0.9956379}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   400     0    0     3    0    0    15     2    18    3     42
1     0  1277    0     5    0    0     0    32    18    0      0
2     2     1  126     1   36    1     4     6    33  100      2
3     2     0    0  7983    0   13     2   170   268    2      0
4     3     0   13     1  254    2     7     2    72    9    176
5     3     0    0    23    0  342     1     0    17  134      1
6     5     1    0     1    1    0  1878     1    13    1      7
7     0     6    0   150    2    0     1  6981   113    1     11
8     1     0    0    26    1    0     0    46  3200    1     21
9     6     0   10     5    0   47     6     2    21  396      0
10    8     1    1     6   24    1    15    14    75    3  12648
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69985306, 'precision': 0.6660257, 'recall': 0.5726806, 'specificity': 0.96966493, 'f1': 0.5518418, 'auroc': 0.8723457}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1011     0   0    4    1    0    64    8    69    6     7
1      0  1250   0   26    0    0     7  152    52    0    12
2      9     2   8    2   98    3    29   23   721   61    59
3      0     0   0    0    0    0     0    0     0    0     0
4      1     0   0    0  307    0     8    0    98    0  1219
5     32     0   0   59    0  188    15    0    74  223     1
6      0     0   0    3    0    0  2921    0   110    0    33
7      3     0   0  128    0    0    30  984    16    0     3
8      0     0   0   16    0    0     4    0  1350    0     0
9     34     3   6   22    7   40    17   20   610  366    12
10     0     0   0    0   21    0     6    0     1    0  1618
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 17:58:52.470493,epoch time: 0:54:59.164629,used: 2:46:22.377358,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9552654, 'precision': 0.87431216, 'recall': 0.8516904, 'specificity': 0.9951949, 'f1': 0.8589337, 'auroc': 0.9965247}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     7    0    1     6     3     8    6     21
1     0  1284    0    13    0    0     0    29     5    0      1
2     0     1  189     1   12    4     2     3    12   86      2
3     1     1    0  8292    0   10     1    70    59    2      0
4     3     2   74     3  259    3     7     1    52   15    120
5     0     0    1    28    0  432     0     0     7   52      1
6     9     0    0     4    1    1  1880     3     4    1      5
7     1    17    0   260    2    0     2  6906    66    3      7
8     1     0    4   145    1    5     0    42  3087    2      9
9     1     1   18     4    0   89     0     0     6  374      0
10   30     5    4     9   47    2    12    13    97    3  12570
---- Validation: 
scalar performance:
{'acc': 0.95522267, 'precision': 0.8757719, 'recall': 0.8496336, 'specificity': 0.9952136, 'f1': 0.8588872, 'auroc': 0.9967315}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     6    0    0     7     6    11    4     16
1     0  1287    0    13    0    0     0    29     3    0      0
2     4     1  178     1   11    3     2     5    20   87      0
3     0     3    1  8296    0    9     0    64    65    2      0
4     5     3   70     4  268    2     5     4    57   12    109
5     1     0    0    31    1  425     0     0     7   56      0
6     7     0    0     5    0    0  1880     2     5    3      6
7     1    18    1   253    1    0     1  6920    64    1      5
8     1     0    1   134    2    2     1    52  3096    2      5
9     0     0   16     6    0   86     1     1     9  374      0
10   20     6    5     8   50    3    23    17   109    1  12554
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7232911, 'precision': 0.6912817, 'recall': 0.6078763, 'specificity': 0.9724459, 'f1': 0.59922457, 'auroc': 0.87384737}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1019     0   0   46    0    0    37    30    26    8     4
1      3  1295   0   37    1    0     1   147     7    0     8
2      9    18  98   38   66   20    43    48   525   84    66
3      0     0   0    0    0    0     0     0     0    0     0
4      2     4   0    0  395    0    16     2    70    1  1143
5      7     0   0  161    0  331     3     0    19   70     1
6      0     0   0   41    0    0  2948     2    40    0    36
7      0     0   0  109    0    0     1  1049     2    0     3
8      0     0   0  125    0    0     2     4  1238    1     0
9     22    25  50  149    2  140    12    80   307  347     3
10     0     1   0    0   18    0     8     0     1    0  1618
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 18:53:33.236334,epoch time: 0:54:40.765841,used: 3:41:03.143199,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95572025, 'precision': 0.8651654, 'recall': 0.86582774, 'specificity': 0.9953331, 'f1': 0.86333925, 'auroc': 0.9968841}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    0     2    1    0    17     2     9    4     31
1     0  1304    0     7    0    0     1    16     3    1      0
2     1     0  217     0    5    0     1     2     4   81      1
3     1    13    1  8231    0    8     5   111    69    1      0
4     2     0   96     1  304    1     4     1    28   14     88
5     0     0    0    21    1  399     1     0     4   95      0
6     3     0    0     1    1    0  1888     2     3    1      8
7     1    80    8   172    0    0     4  6933    56    3      6
8     0     6    4   139    8    1     6    40  3071    4     17
9     1     0   17     5    0   60     0     1     3  406      0
10   12     2   13     8  117    1    21    12    50    3  12551
---- Validation: 
scalar performance:
{'acc': 0.9549552, 'precision': 0.8628032, 'recall': 0.864381, 'specificity': 0.9952655, 'f1': 0.86130977, 'auroc': 0.99665123}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    1     2    0    2    25     1    10    2     22
1     0  1308    0     5    0    0     0    14     5    0      0
2     0     0  207     0    8    2     0     2     4   89      0
3     1    10    1  8228    0    8     3   121    66    2      0
4     2     1  102     2  301    2     4     1    26   11     87
5     1     0    0    28    0  394     0     0     7   90      1
6     6     1    0     1    2    0  1886     0     3    2      7
7     1    76   10   195    2    0     8  6909    55    4      5
8     0     7    5   134    9    0     5    37  3085    3     11
9     0     0   12     7    0   49     2     0     3  420      0
10    9     3   12    10  125    1    26    10    50    5  12545
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7739453, 'precision': 0.71183753, 'recall': 0.6439229, 'specificity': 0.97725356, 'f1': 0.66004807, 'auroc': 0.88659513}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   941     0    1   14    2    2   165    6    11   20     8
1     0  1334    0   24    2    0     3  113     7    2    14
2     1     0  319    9  304    5    38   11   207   92    29
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    8    0  825    0     2    0    14    1   783
5     3     0    0   83    1  201     5    0     7  291     1
6     0     0    0    2    2    0  3046    1     4    0    12
7     0     0    1  197    0    0    11  950     2    0     3
8     0     0    0   76    0    0     8    5  1279    2     0
9     6     4  181   59   12   54    16   16   157  627     5
10    0     0    1    0  102    0     2    0     1    0  1540
new oracle model saved
early stop counter: 1
val acc:0.9549552202224731, best validation acc: 0.9552226662635803, corresponding to test acc:                         0.7232910990715027 / 0.7739452719688416
after epoch: 5,now: 2024-08-03 19:47:54.221916,epoch time: 0:54:20.985582,used: 4:35:24.128781,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9626766, 'precision': 0.90129316, 'recall': 0.8638833, 'specificity': 0.9959023, 'f1': 0.87780625, 'auroc': 0.997912}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    0     5    0    0     3     6    11    5     30
1     0  1277    0     8    0    0     0    43     4    0      0
2     1     0  190     2   18    3     0    11     3   84      0
3     0     1    1  8276    0   23     1    70    59    4      0
4     1     0   52     2  290    4     2     7    20    8    153
5     1     0    0    13    0  466     0     0     6   33      1
6     4     0    0     2    1    1  1875     7     5    3      9
7     0     3    0   159    1    0     2  7076    19    2      3
8     1     1    2   124    7    7     1    78  3057    4     14
9     1     0   10     2    0   92     0     6     3  379      0
10   11     0    2     9   16    2     8    30    44    0  12672
---- Validation: 
scalar performance:
{'acc': 0.9623111, 'precision': 0.9037588, 'recall': 0.86398244, 'specificity': 0.9958418, 'f1': 0.87855697, 'auroc': 0.9978418}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     3    0    0     4     5     8    3     38
1     0  1272    0    10    0    1     0    48     1    0      0
2     0     0  194     4   12    5     0    10     5   81      1
3     0     1    0  8272    0   22     1    75    66    3      0
4     3     0   53     1  281    2     0     4    26   10    159
5     0     0    0    12    0  470     0     0     3   35      1
6     5     1    0     2    0    3  1868     4    11    1     13
7     0     3    0   163    1    0     1  7077    16    1      3
8     0     0    2   113    7    5     0    86  3063    7     13
9     0     0    9     5    0   89     0     5     2  383      0
10    9     0    3    10   19    2     4    32    43    0  12674
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72049254, 'precision': 0.6738546, 'recall': 0.62980914, 'specificity': 0.97204274, 'f1': 0.61289835, 'auroc': 0.87054646}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1025     0    0   13    2   12    44   15    27   25     7
1      0  1236    0   24    0    2     1  211    13    0    12
2      4     0  219   10  151   32     9   43   363   81   103
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    6    0  298    0     1    1    32    1  1294
5      2     0    0   41    0  464     1    0     8   73     3
6      0     0    1   15    1    0  2713    6   215    0   116
7      0     0    0  171    0    1     1  988     1    0     2
8      0     0    0   65    0    4     0    8  1291    1     1
9      9     3  113   57    6  244     2   77   189  425    12
10     0     0    0    0    6    0     0    0     1    0  1639
better model found
persisted
after epoch: 6,now: 2024-08-03 20:43:24.792103,epoch time: 0:55:30.570187,used: 5:30:54.698968,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9666898, 'precision': 0.91013145, 'recall': 0.87503266, 'specificity': 0.9963168, 'f1': 0.89116794, 'auroc': 0.9982229}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     1    1     5    0    0     5     1     8    4     40
1     0  1286    0     7    0    0     0    35     4    0      0
2     0     0  211     3   38    2     0     4     5   47      2
3     0     1    0  8265    0    9     0   114    50    0      0
4     1     0   18     2  361    1     0     2    18    4    132
5     0     0    1    28    0  447     0     0     2   42      1
6     7     0    0     2    4    1  1870     3     8    1     12
7     0     5    2   109    1    0     1  7120    15    1      8
8     1     1    5    85    5    1     0    83  3087    3     23
9     1     0   35     9    2   86     0     2     3  355      0
10    5     0    2     8   28    2     4    15    18    0  12712
---- Validation: 
scalar performance:
{'acc': 0.96739334, 'precision': 0.91217035, 'recall': 0.8810665, 'specificity': 0.99639875, 'f1': 0.89556134, 'auroc': 0.99826133}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     3    1    0     2     1     9   11     34
1     0  1286    0     4    0    0     0    37     5    0      0
2     1     0  221     1   36    3     0     7     2   39      2
3     1     2    0  8292    0    4     0    99    39    3      0
4     1     0   18     1  368    1     0     3    14    5    128
5     0     0    1    27    0  447     0     0     5   40      1
6     5     0    0     3    5    0  1871     3     5    4     12
7     0     6    0   129    1    0     2  7106    14    0      7
8     0     0    3    98    9    3     0    82  3081    2     18
9     0     0   34     7    3   84     0     0     3  362      0
10    9     0    4     6   28    2     3    11    23    0  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71930313, 'precision': 0.6795413, 'recall': 0.6059319, 'specificity': 0.97205347, 'f1': 0.60587, 'auroc': 0.8712103}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   993     0    1   13    2    0    30    20    55   28    28
1     2  1138    0   28    1    0     1   286    13    0    30
2     2     0  174   23  191   21    13    29   344   62   156
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  337    0     2     1    27    0  1265
5     3     0    0  155    0  325     2     0     2  103     2
6     0     0    0   10    4    0  2995     2    31    0    25
7     0     0    0  144    0    0     3  1011     2    0     4
8     0     0    0  142    1    0     2    12  1211    2     0
9     4     2   86  160   11  150     6    42   185  469    22
10    0     0    0    0   16    0     1     0     1    0  1628
better model found
persisted
after epoch: 7,now: 2024-08-03 21:41:19.950477,epoch time: 0:57:55.158374,used: 6:28:49.857342,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96821487, 'precision': 0.9158196, 'recall': 0.8890889, 'specificity': 0.9965296, 'f1': 0.90063286, 'auroc': 0.9983438}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     2    1    0     9     1     2    6     29
1     0  1287    0     8    0    0     0    31     5    0      1
2     0     0  230     0   32    3     0     2     2   41      2
3     0     0    1  8237    1    5     0    71   119    1      1
4     2     0   16     1  358    2     1     2    21    3    133
5     0     0    0    17    0  473     0     0     5   25      1
6     2     0    1     6    1    0  1883     2     5    1      6
7     2     8    2   170    1    0     3  7013    55    3      6
8     0     0    5    38    5    3     0    19  3205    0     20
9     0     0   38     4    0   96     1     3     0  351      0
10    7     0    1     8   24    1     8     3    25    0  12718
---- Validation: 
scalar performance:
{'acc': 0.96758056, 'precision': 0.9094114, 'recall': 0.88283545, 'specificity': 0.99647665, 'f1': 0.8940907, 'auroc': 0.99827665}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     3    1    0    17     0     1    4     28
1     0  1286    0    11    0    0     0    27     6    0      2
2     0     0  223     0   36    2     0     1     6   44      0
3     0     0    0  8262    1    7     0    73    96    1      0
4     3     0   16     0  365    2     1     2    15    5    130
5     0     0    0    17    0  472     0     0     6   25      1
6     1     0    1     5    3    1  1881     2     3    1     10
7     1     8    3   152    1    0     2  7021    65    2     10
8     1     0    2    37    3    4     1    27  3197    1     23
9     0     0   45     3    0  113     0     1     3  328      0
10    8     0    1     8   25    1     9     3    32    0  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7334359, 'precision': 0.67851776, 'recall': 0.62156993, 'specificity': 0.9733552, 'f1': 0.6154655, 'auroc': 0.86908644}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   969     0    0   30    1   11   102    6    19   24     8
1     3  1290    0   23    1    0    10  115    12    0    45
2     5     0  177   21  203   37    26   19   362   72    93
3     0     0    0    0    0    0     0    0     0    0     0
4     3     0    3    0  378    0     5    0    19    0  1225
5     2     0    0  140    0  406     2    0     8   33     1
6     0     0    0    8    0    0  3032    0     9    0    18
7     1     0    0  175    0    0    10  970     5    0     3
8     0     0    0   81    0    0     4    1  1282    2     0
9     8     2  129  120   18  254     7   28   211  356     4
10    0     0    0    0   20    0     2    0     1    0  1623
better model found
persisted
after epoch: 8,now: 2024-08-03 22:55:41.363451,epoch time: 1:14:21.412974,used: 7:43:11.270316,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9695794, 'precision': 0.9254223, 'recall': 0.89785886, 'specificity': 0.9966409, 'f1': 0.90948296, 'auroc': 0.9982143}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     4    0    0     2     3     1    5     12
1     0  1285    0    10    0    0     0    33     3    0      0
2     2     0  224     0   25    0     1    11     2   47      0
3     0     1    0  8318    0    6     0    97    15    2      0
4     5     0   17     4  375    0     1     8    13    6    110
5     0     0    0    23    0  422     0     0     2   73      1
6    12     0    1     5    1    0  1880     0     2    0      7
7     0     4    0   114    1    0     1  7132     8    0      4
8     1     0    5   141    7    4     1    82  3035    3     17
9     1     0   14     3    0   38     0     2     2  433      0
10   21     0    2     9   19    2     6    18    34    0  12679
---- Validation: 
scalar performance:
{'acc': 0.969346, 'precision': 0.9195717, 'recall': 0.89373744, 'specificity': 0.99662673, 'f1': 0.90454507, 'auroc': 0.9983581}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     1    0    0     2     5     1    5     10
1     0  1286    0    11    0    0     0    29     5    0      1
2     2     0  213     1   28    0     0    11     3   54      0
3     0     0    1  8315    0    7     0   101    14    2      0
4     5     0   21     1  372    0     1     4    13    6    116
5     0     0    0    27    0  417     0     0     2   74      1
6     6     0    1     1    1    0  1886     0     1    2     10
7     0     3    0   123    1    0     1  7125     7    1      4
8     3     0    3   133    6    3     1    85  3053    3      6
9     0     0   19     4    1   34     0     5     1  429      0
10   24     0    2     8   32    2     4    17    22    1  12684
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7186035, 'precision': 0.6619084, 'recall': 0.6049639, 'specificity': 0.9717683, 'f1': 0.59908503, 'auroc': 0.85359627}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1003     0    0   15    1    1    95     8     9   32     6
1      3  1198    0   26    1    0     7   221    18    2    23
2      7     0  140   13  199   15    37    34   345   99   126
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    2    0  231    0     8     2    23    1  1366
5      4     0    0   90    0  323     4     0     0  169     2
6      0     0    0    5    1    0  3024     1     8    0    28
7      0     0    0  143    0    0     7  1008     3    0     3
8      0     0    0  179    0    0     5     9  1175    2     0
9      8     2   94   88    7  130    18    69   167  536    18
10     0     0    0    0    8    0     4     0     1    0  1633
better model found
persisted
after epoch: 9,now: 2024-08-04 00:25:17.583480,epoch time: 1:29:36.220029,used: 9:12:47.490345,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9684022, 'precision': 0.91084206, 'recall': 0.8912226, 'specificity': 0.9964764, 'f1': 0.8997483, 'auroc': 0.9986465}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     4    1    0     1     1     0    3     17
1     0  1285    0    13    0    1     0    28     4    0      1
2     1     0  232     1   39    1     0     2     1   32      3
3     2     0    1  8344    0   12     0    37    40    4      0
4     8     0   15     2  354    1     0     2     9    1    147
5     0     0    0    11    0  442     0     0     2   65      1
6    29     0    1     8    2    0  1839     4     1    1     20
7     1     4    2   200    2    0     1  7012    34    1      7
8     1     0    2   103    9    2     0    21  3102   10     44
9     0     0   58     3    0   41     0     0     2  389      0
10   14     1    0    12   12    2     2     5     4    1  12740
---- Validation: 
scalar performance:
{'acc': 0.96806204, 'precision': 0.9154017, 'recall': 0.8946711, 'specificity': 0.9964058, 'f1': 0.9037193, 'auroc': 0.99862623}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     3    0    1     1     0     0    3     16
1     0  1279    0    15    0    0     0    34     1    0      3
2     1     0  230     1   37    2     0     3     2   31      5
3     0     0    0  8355    0   14     0    40    30    1      0
4     5     0   12     1  366    1     0     1     6    2    145
5     0     0    0     8    0  453     0     0     1   58      1
6    36     0    0     7    1    0  1832     2     2    1     27
7     3     1    0   220    1    0     1  6990    42    0      7
8     5     0    2   115    9    4     0    12  3083   10     56
9     1     0   54     3    2   37     0     0     0  395      1
10   13     0    1     8    8    2     2     6     6    1  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7120968, 'precision': 0.6713985, 'recall': 0.6123915, 'specificity': 0.9713162, 'f1': 0.6062517, 'auroc': 0.8588804}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1100     0    0   24    1    3     8   14     5   11     4
1      0  1157    3   42    1    0     0  234     9    6    47
2     13     0  155   28  183   29    41   29   212   94   231
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0    0    0  150    0     1    1    13    0  1466
5      6     0    1  101    0  389     2    0     2   88     3
6      4     0    0    8    0    0  2878    2    11    0   164
7      0     0    0  191    0    1     0  966     3    0     3
8      0     0    0  191    0    1     4    0  1168    1     5
9     20     0   93  145    6  165     4   39    68  574    23
10     0     0    0    0    4    0     0    0     1    0  1641
early stop counter: 1
val acc:0.9680620431900024, best validation acc: 0.9693459868431091, corresponding to test acc:                         0.7186034917831421 / 0.7739452719688416
after epoch: 10,now: 2024-08-04 01:37:54.163107,epoch time: 1:12:36.579627,used: 10:25:24.069972,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 10:25:24.069972 at 2024-08-04 01:37:54.163107
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7186035, 'precision': 0.6619084, 'recall': 0.6049639, 'specificity': 0.9717683, 'f1': 0.59908503, 'auroc': 0.85359627}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1003     0    0   15    1    1    95     8     9   32     6
1      3  1198    0   26    1    0     7   221    18    2    23
2      7     0  140   13  199   15    37    34   345   99   126
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    2    0  231    0     8     2    23    1  1366
5      4     0    0   90    0  323     4     0     0  169     2
6      0     0    0    5    1    0  3024     1     8    0    28
7      0     0    0  143    0    0     7  1008     3    0     3
8      0     0    0  179    0    0     5     9  1175    2     0
9      8     2   94   88    7  130    18    69   167  536    18
10     0     0    0    0    8    0     4     0     1    0  1633
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7739453, 'precision': 0.71183753, 'recall': 0.6439229, 'specificity': 0.97725356, 'f1': 0.66004807, 'auroc': 0.88659513}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   941     0    1   14    2    2   165    6    11   20     8
1     0  1334    0   24    2    0     3  113     7    2    14
2     1     0  319    9  304    5    38   11   207   92    29
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    8    0  825    0     2    0    14    1   783
5     3     0    0   83    1  201     5    0     7  291     1
6     0     0    0    2    2    0  3046    1     4    0    12
7     0     0    1  197    0    0    11  950     2    0     3
8     0     0    0   76    0    0     8    5  1279    2     0
9     6     4  181   59   12   54    16   16   157  627     5
10    0     0    1    0  102    0     2    0     1    0  1540
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_15_12_27_seed_0_24051362_instance_wise_predictions.txt
accuracy from prediction file 0.7186035122087735
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/8.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2613 MiB |  16815 MiB | 396509 GiB | 396507 GiB |
|       from large pool |   2599 MiB |  16783 MiB | 393438 GiB | 393436 GiB |
|       from small pool |     14 MiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2613 MiB |  16815 MiB | 396509 GiB | 396507 GiB |
|       from large pool |   2599 MiB |  16783 MiB | 393438 GiB | 393436 GiB |
|       from small pool |     14 MiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2607 MiB |  16770 MiB | 395433 GiB | 395430 GiB |
|       from large pool |   2594 MiB |  16737 MiB | 392365 GiB | 392363 GiB |
|       from small pool |     13 MiB |     33 MiB |   3067 GiB |   3067 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17514 MiB |  17514 MiB |  17514 MiB |      0 B   |
|       from large pool |  17478 MiB |  17478 MiB |  17478 MiB |      0 B   |
|       from small pool |     36 MiB |     36 MiB |     36 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 426213 KiB | 762121 KiB |  86039 GiB |  86038 GiB |
|       from large pool | 405824 KiB | 759808 KiB |  82964 GiB |  82963 GiB |
|       from small pool |  20389 KiB |  23171 KiB |   3075 GiB |   3075 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3082    |    4805    |   31278 K  |   31275 K  |
|       from large pool |     349    |     697    |   13475 K  |   13475 K  |
|       from small pool |    2733    |    4255    |   17803 K  |   17800 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3082    |    4805    |   31278 K  |   31275 K  |
|       from large pool |     349    |     697    |   13475 K  |   13475 K  |
|       from small pool |    2733    |    4255    |   17803 K  |   17800 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     510    |     510    |     510    |       0    |
|       from large pool |     492    |     492    |     492    |       0    |
|       from small pool |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     172    |    1222    |   16650 K  |   16650 K  |
|       from large pool |     133    |     343    |    8589 K  |    8589 K  |
|       from small pool |      39    |    1088    |    8061 K  |    8061 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16815 MiB | 396509 GiB | 396509 GiB |
|       from large pool |  16640 KiB |  16783 MiB | 393438 GiB | 393438 GiB |
|       from small pool |      0 KiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16815 MiB | 396509 GiB | 396509 GiB |
|       from large pool |  16640 KiB |  16783 MiB | 393438 GiB | 393438 GiB |
|       from small pool |      0 KiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB | 395433 GiB | 395433 GiB |
|       from large pool |  16640 KiB |  16737 MiB | 392365 GiB | 392365 GiB |
|       from small pool |      0 KiB |     33 MiB |   3067 GiB |   3067 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3030 MiB |  17514 MiB |  17514 MiB |  14484 MiB |
|       from large pool |   2996 MiB |  17478 MiB |  17478 MiB |  14482 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 762121 KiB |  86040 GiB |  86040 GiB |
|       from large pool |  24320 KiB | 759808 KiB |  82965 GiB |  82965 GiB |
|       from small pool |      0 KiB |  28880 KiB |   3075 GiB |   3075 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31278 K  |   31278 K  |
|       from large pool |       2    |     697    |   13475 K  |   13475 K  |
|       from small pool |       0    |    4255    |   17803 K  |   17803 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31278 K  |   31278 K  |
|       from large pool |       2    |     697    |   13475 K  |   13475 K  |
|       from small pool |       0    |    4255    |   17803 K  |   17803 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     153    |     510    |     510    |     357    |
|       from large pool |     136    |     492    |     492    |     356    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1222    |   16651 K  |   16651 K  |
|       from large pool |       3    |     343    |    8589 K  |    8589 K  |
|       from small pool |       0    |    1088    |    8062 K  |    8062 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16815 MiB | 396509 GiB | 396509 GiB |
|       from large pool |  16640 KiB |  16783 MiB | 393438 GiB | 393438 GiB |
|       from small pool |      0 KiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16815 MiB | 396509 GiB | 396509 GiB |
|       from large pool |  16640 KiB |  16783 MiB | 393438 GiB | 393438 GiB |
|       from small pool |      0 KiB |     33 MiB |   3070 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB | 395433 GiB | 395433 GiB |
|       from large pool |  16640 KiB |  16737 MiB | 392365 GiB | 392365 GiB |
|       from small pool |      0 KiB |     33 MiB |   3067 GiB |   3067 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3030 MiB |  17514 MiB |  17514 MiB |  14484 MiB |
|       from large pool |   2996 MiB |  17478 MiB |  17478 MiB |  14482 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 762121 KiB |  86040 GiB |  86040 GiB |
|       from large pool |  24320 KiB | 759808 KiB |  82965 GiB |  82965 GiB |
|       from small pool |      0 KiB |  28880 KiB |   3075 GiB |   3075 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31278 K  |   31278 K  |
|       from large pool |       2    |     697    |   13475 K  |   13475 K  |
|       from small pool |       0    |    4255    |   17803 K  |   17803 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31278 K  |   31278 K  |
|       from large pool |       2    |     697    |   13475 K  |   13475 K  |
|       from small pool |       0    |    4255    |   17803 K  |   17803 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     153    |     510    |     510    |     357    |
|       from large pool |     136    |     492    |     492    |     356    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1222    |   16651 K  |   16651 K  |
|       from large pool |       3    |     343    |    8589 K  |    8589 K  |
|       from small pool |       0    |    1088    |    8062 K  |    8062 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362

 Experiment start at: 2024-08-04 02:05:12.252279
before training, model accuracy: 0.06940460950136185
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91994864, 'precision': 0.82486516, 'recall': 0.71206343, 'specificity': 0.9911077, 'f1': 0.73825014, 'auroc': 0.9855626}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   270     0    0    15   0    0    16    35    19    9    118
1     0  1176    0    20   0    0     0   117    11    0      6
2     2     0  182     2  13    0     3    25    49   26     10
3     0     0    2  7939   0    5     0   329   164    0      0
4     1     1   76     3  70    0     2    13   138    9    226
5     3     0   23    87   0  293     0     1     9  104      1
6    25     2    0    19   0    1  1686    22    30    7    116
7     0     4    1   186   1    0     0  6979    83    0      8
8     0     0    2   144   0    0     0   103  3018    0     29
9     3     0  128    16   0   89     0    14    24  212      7
10    3     0    1     9   1    0     8    58   154    1  12559
---- Validation: 
scalar performance:
{'acc': 0.9210646, 'precision': 0.8331528, 'recall': 0.71799225, 'specificity': 0.991237, 'f1': 0.7449274, 'auroc': 0.98592395}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   278     0    1    19   0    0    12    28    29    7    109
1     0  1186    0    19   0    0     0   110    10    0      7
2     2     0  187     3   7    2     4    26    43   29      9
3     0     0    0  7907   0    6     0   367   160    0      0
4     0     0   67     2  73    2     3    12   146   10    224
5     2     0   18    86   0  288     0     0    15  111      1
6    18     0    0    20   0    1  1701    29    28    6    105
7     0     2    1   175   1    0     1  6982    91    0     12
8     0     0    1   130   0    1     0    99  3040    0     25
9     4     0  113    15   1   86     1    12    30  222      9
10    4     0    1     8   3    2     6    55   146    1  12570
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5317988, 'precision': 0.56440425, 'recall': 0.49030724, 'specificity': 0.9530446, 'f1': 0.45011145, 'auroc': 0.8052017}
confusion matrix:
     0    1    2    3   4    5     6     7     8    9     10
0   817    0    0   66   0    0    20   186    54   10    17
1     2  903    0   42   0    0     1   494    13    0    44
2    46    0   68   23  13    9     3    75   573   63   142
3     0    0    0    0   0    0     0     0     0    0     0
4     2    0    0    0  29    0     0     8    67    0  1527
5    37    0    0  131   0  312     1     1    22   87     1
6     2    3    0   21  38    0  1220    46   700    0  1037
7     0    0    0   27   0    1     0  1132     0    1     3
8     0    0    0  109   0    5     0    11  1242    1     2
9    84    3  108  145   2   89     0   113   342  232    19
10    0    0    0    0   0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 03:07:12.278192,epoch time: 1:02:00.025913,used: 1:02:00.025913,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94068384, 'precision': 0.85839653, 'recall': 0.78192186, 'specificity': 0.99335843, 'f1': 0.8094587, 'auroc': 0.9922821}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     1    0    10    0    0    23     3    14    2     56
1     0  1260    0    24    0    0     0    38     5    0      5
2     5     1  105     2   75    2     2    12    30   68     10
3     1     1    0  8219    0    8     0    94   114    0      0
4     2     0    3     1  210    1     4     6    59   10    243
5     0     0    2    49    0  416     2     0     6   45      1
6    11     0    0     8    0    0  1851     2    11    2     23
7     2    21    0   408    1    0     1  6710    96    0     23
8     3     1    1   146    2    0     0    53  3042    0     48
9     5     0   39    17    7  118     1     5    14  282      4
10   11     0    1     7    7    0    17    18    40    3  12690
---- Validation: 
scalar performance:
{'acc': 0.93992245, 'precision': 0.8546182, 'recall': 0.7768676, 'specificity': 0.9932754, 'f1': 0.8053347, 'auroc': 0.99226695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   370     0    0     6    0    0    23     9     4    3     68
1     0  1265    0    19    0    0     0    36     7    0      5
2     3     1  108     4   82    2     2    12    25   66      7
3     2     2    0  8213    0    8     1   101   113    0      0
4     2     0    6     2  209    1     4     6    57    8    244
5     1     0    2    57    0  407     1     0     6   46      1
6     6     1    0     8    1    0  1857     1    10    2     22
7     0    20    0   423    1    1     2  6708    92    0     18
8     1     0    0   147    4    0     2    58  3043    0     41
9     9     0   38    14    8  130     8     3    17  261      5
10    8     1    0     9   10    0    11    18    40    1  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62709016, 'precision': 0.607764, 'recall': 0.55083704, 'specificity': 0.96268094, 'f1': 0.51668787, 'auroc': 0.8230815}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1057     1   0   32    0    1    25   11    22    5    16
1      0  1104   0   44    0    0     1  273    20    0    57
2     23     0  20   29  141   16     1   24   450   68   243
3      0     0   0    0    0    0     0    0     0    0     0
4      1     0   0    0   63    0     0    0    23    0  1546
5     15     0   0  131    0  404     0    0    17   24     1
6      0     1   0    7    5    0  2199    5   295    0   555
7      2     0   0  183    0    0     1  968     5    0     5
8      0     0   0   88    0    0     0    1  1279    0     2
9     46     0  19  164   25  202     0   31   396  224    30
10     0     0   0    0    1    0     0    0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 04:10:44.706901,epoch time: 1:03:32.428709,used: 2:05:32.454622,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94774723, 'precision': 0.86906165, 'recall': 0.8431426, 'specificity': 0.9942996, 'f1': 0.8527883, 'auroc': 0.99579996}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     9    2    0     4     4     2    7     15
1     0  1250    0    14    0    0     0    62     4    0      2
2     2     1  166     0   35    1     1     7     5   94      0
3     1     1    0  8307    1    8     0    81    36    2      0
4     9     0   25     2  346    1     2     5    30   14    105
5     2     0    1    48    0  378     0     0     5   86      1
6    12     0    0     4    2    1  1868     2     5    6      8
7     0     8    0   344    1    0     2  6884    20    0      5
8     2     0    1   293    8    3     1    99  2865    2     20
9     3     0   26    10    1   64     0     6     5  377      0
10   61     0    0    10   82    1    14    25    54    4  12543
---- Validation: 
scalar performance:
{'acc': 0.94717133, 'precision': 0.8695203, 'recall': 0.8437004, 'specificity': 0.99423695, 'f1': 0.85282004, 'auroc': 0.99597204}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     4    1    0     6     6     3    6     14
1     0  1242    0    19    0    0     0    67     2    0      2
2     2     1  160     1   39    2     0     7     5   95      0
3     2     2    0  8317    0    7     1    65    43    3      0
4     7     0   25     0  343    2     1     7    32   14    108
5     0     0    0    44    0  391     0     0     3   82      1
6    16     0    0     4    3    0  1866     3     4    4      8
7     1     6    0   371    1    0     2  6852    27    1      4
8     4     0    2   295   11    0     3    86  2874    1     20
9     0     0   21     9    3   70     0     3     6  381      0
10   64     0    1     9   73    1    23    30    50    4  12541
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7048205, 'precision': 0.6810099, 'recall': 0.584226, 'specificity': 0.9708868, 'f1': 0.5880959, 'auroc': 0.855293}
confusion matrix:
      0    1   2    3    4    5     6     7     8    9     10
0   1058    1   0   61    0    0    14    18     2   16     0
1      2  975   0   41    0    0     0   472     1    0     8
2     21    0  93   60  195    4     4   111   375  102    50
3      0    0   0    0    0    0     0     0     0    0     0
4      5    0   1    0  591    0     1     6    37    1   991
5      5    0   0  168    1  239     0     0     9  170     0
6      6    0   0   44    1    0  2939     9    52    0    16
7      1    0   0   99    0    0     0  1062     0    1     1
8      0    0   0  207    0    0     2    27  1131    2     1
9     22    3  52  273   11   38     3   145   168  411    11
10     0    0   0    0   66    0     2     2     1    0  1575
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 05:05:30.134133,epoch time: 0:54:45.427232,used: 3:00:17.881854,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9540347, 'precision': 0.89411116, 'recall': 0.83804274, 'specificity': 0.99489427, 'f1': 0.85917175, 'auroc': 0.99622416}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     7    0    0    10     4     5    7     34
1     0  1251    0    11    0    0     0    68     2    0      0
2     1     0  194     1   13    2     0    12     6   81      2
3     0     1    2  8219    0    6     0   178    34    0      0
4     3     1   43     0  252    1     3     6    47   12    170
5     0     0    0    49    0  392     0     0     5   74      1
6     7     0    0     2    0    0  1862     7     5    7     18
7     0     5    0   131    1    1     1  7092    25    0      6
8     1     0    4   201    0    0     0   109  2949    3     27
9     2     0   20     7    1   74     0     7     5  377      0
10   13     0    3     7   19    0    13    27    51    6  12654
---- Validation: 
scalar performance:
{'acc': 0.9555437, 'precision': 0.89584476, 'recall': 0.8402573, 'specificity': 0.9950657, 'f1': 0.8605984, 'auroc': 0.9962894}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     3    1    1     9     8     5    5     29
1     0  1257    0     9    0    0     0    62     4    0      0
2     1     0  193     1   13    0     0    11     7   82      4
3     0     1    0  8216    0    6     0   180    36    1      0
4     5     1   52     0  244    1     0     9    38   15    174
5     0     0    0    45    0  395     0     0     3   77      1
6     4     0    0     3    0    1  1870     7     5    5     13
7     0     6    0   127    1    0     1  7098    28    0      4
8     1     0    3   188    2    0     0   113  2965    1     23
9     1     0   20     6    0   72     0     6     6  382      0
10    9     0    2     6   15    1     7    25    45    5  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6781641, 'precision': 0.6657819, 'recall': 0.57920945, 'specificity': 0.9681411, 'f1': 0.57206273, 'auroc': 0.83977044}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   982     1    1   35    0    1    41    31     4   67     7
1     0  1002    0   38    0    0     0   447     2    0    10
2     4     0  134   36   94   16     1    89   423  115   103
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    1    0  262    0     1     8    48    2  1310
5     2     0    0  133    1  375     0     0     2   79     0
6     1     0    0   31    3    0  2784    10   138    1    99
7     0     0    0   91    0    0     0  1072     0    0     1
8     0     0    0  299    0    0     1    11  1057    2     0
9     8     2   58  237    2  165     1    97   157  394    16
10    0     0    0    0   12    0     0     1     2    0  1631
better model found
persisted
after epoch: 4,now: 2024-08-04 05:59:33.800122,epoch time: 0:54:03.665989,used: 3:54:21.547843,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.960991, 'precision': 0.8825826, 'recall': 0.87762636, 'specificity': 0.9958421, 'f1': 0.87729776, 'auroc': 0.9975265}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     6    0    0     6     0     2    2      9
1     0  1290    0    12    0    0     0    26     3    0      0
2     5     0  241     1   30    1     0     1     3   30      0
3     1     1    0  8227    0    4     1   119    82    1      0
4     9     1   39     0  336    2     1     2    34    8    107
5     1     0    0    25    0  443     0     0     4   47      1
6    28     0    1     2    2    1  1858     3     4    0      9
7     0    12    4   170    2    0     1  7013    56    0      5
8     1     0    6    90    4    1     0    43  3137    0     13
9     5     0   79     5    2   78     0     3     6  315      0
10   57     0    2     6   38    3    11    18    60    0  12600
---- Validation: 
scalar performance:
{'acc': 0.9610807, 'precision': 0.88617575, 'recall': 0.87806237, 'specificity': 0.9958369, 'f1': 0.87964135, 'auroc': 0.9975664}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     7    0    0     4     2     5    2      4
1     0  1289    0     9    0    0     0    29     5    0      0
2     3     0  243     1   29    2     1     0     7   26      0
3     1     3    0  8256    0    3     0   105    71    1      0
4     9     0   37     1  337    1     1     2    23    6    122
5     3     0    2    37    0  423     0     0     7   48      1
6    25     0    1     5    2    0  1859     3     6    1      6
7     0    15    1   161    2    0     1  7025    57    0      3
8     1     0    6    99    6    1     1    52  3118    0     12
9     5     0   74     6    3   64     0     1     7  333      0
10   62     1    2     7   41    0    10    16    68    1  12588
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7142657, 'precision': 0.6543565, 'recall': 0.60692436, 'specificity': 0.9716385, 'f1': 0.588238, 'auroc': 0.8494729}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1108     0    1   18    1    2     1    11    22    6     0
1      1  1293    1   33    0    0     1   157     7    0     6
2     42     2  177   29  194   23     3    22   400   34    89
3      0     0    0    0    0    0     0     0     0    0     0
4      4     1    3    0  305    0     1     2    27    1  1289
5     27     0    2  181    1  356     0     0     5   20     0
6     19     0    0   43    4    0  2847     3    60    0    91
7      5     4    1   57    0    0     4  1085     4    1     3
8      1     0    0  131    0    1     1     4  1231    1     0
9     52     5  193  186   13  220     0    29   251  174    14
10     0     0    0    0   12    0     0     1     0    0  1633
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 06:53:40.811340,epoch time: 0:54:07.011218,used: 4:48:28.559061,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.90411437, 'recall': 0.87016636, 'specificity': 0.99615145, 'f1': 0.8818275, 'auroc': 0.9978557}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     4    0    0     4     2     2    6     20
1     0  1290    0     8    0    0     0    30     4    0      0
2     1     0  189     0   40    0     0     2     2   74      4
3     1     1    1  8255    0   16     0   108    50    3      0
4     5     1   17     1  326    0     1     2    19   13    154
5     1     0    1    15    0  378     0     0     2  123      1
6    19     0    1     5    1    0  1865     2     2    1     12
7     0    14    1   107    1    0     1  7085    40    5      9
8     1     0    4   115    3    2     1    49  3087    4     29
9     1     0   19     4    1   30     0     2     0  436      0
10   18     0    1     8   19    0     7    12    22    2  12706
---- Validation: 
scalar performance:
{'acc': 0.96509296, 'precision': 0.9081672, 'recall': 0.8749386, 'specificity': 0.9961683, 'f1': 0.88634294, 'auroc': 0.9979345}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     2    0    0     2     3     1    5     17
1     0  1283    0    10    0    0     0    34     5    0      0
2     1     0  195     0   36    1     0     2     8   67      2
3     1     2    0  8251    0   20     0   106    58    2      0
4     5     1   18     1  329    0     0     3    11   15    156
5     0     0    0    13    0  385     0     0     3  119      1
6    12     0    0     4    1    0  1869     1     1    2     18
7     0    11    0   104    1    0     1  7076    53    2     17
8     2     2    3   107    1    8     0    49  3083   11     30
9     1     0   19     4    2   26     0     2     1  438      0
10   16     0    1     7   16    0     8     6    19    5  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71748406, 'precision': 0.6657037, 'recall': 0.6090772, 'specificity': 0.9718041, 'f1': 0.5979324, 'auroc': 0.8494608}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1084     1    1   27    1    0     2    18     9   24     3
1      0  1240    0   35    0    0     1   204     5    0    14
2     15     0  120   24  152    6     1    42   283  139   233
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    0  148    0     1     1    16    1  1464
5      6     0    0   77    0  277     0     0     2  229     1
6     10     0    0   36    4    0  2852     3    21    1   140
7      0     0    0   70    0    0     0  1091     0    1     2
8      1     0    0  149    0    3     1    11  1201    2     2
9     24     3   96  160    3   66     0    55    99  601    30
10     0     0    0    0    4    0     0     1     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-04 07:46:53.614201,epoch time: 0:53:12.802861,used: 5:41:41.361922,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9669306, 'precision': 0.90598154, 'recall': 0.8837426, 'specificity': 0.9964304, 'f1': 0.89296067, 'auroc': 0.9981433}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     3    0    2     5     5     1    1      7
1     0  1285    0     4    0    0     0    41     2    0      0
2     4     0  228     0   27    1     2     5     5   39      1
3     1     0    0  8260    1    1     0   112    64    0      0
4    11     1   28     0  352    1     5     7    19    4    111
5     4     0    1    26    0  432     0     1     6   50      1
6    12     1    1     1    1    0  1878     3     3    0      6
7     0     5    1    83    1    0     2  7158    10    0      3
8     5     0    3    74    4    1     2   105  3086    1     13
9     4     0   40     7    1   76     0     3     7  354      1
10   33     1    2     7   14    0    23    32    33    1  12648
---- Validation: 
scalar performance:
{'acc': 0.96707237, 'precision': 0.9121909, 'recall': 0.885466, 'specificity': 0.99641836, 'f1': 0.8969269, 'auroc': 0.99820095}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     6    0    0     6     3     1    2     11
1     0  1289    0     5    0    0     0    37     1    0      0
2     5     0  229     2   25    3     2     9     5   32      0
3     1     4    0  8254    1    4     0   113    63    0      0
4     9     1   26     0  350    1     2     5    24    3    118
5     2     0    1    34    0  436     0     0     6   41      1
6    10     0    1     2    1    0  1880     5     3    0      6
7     0     7    0    90    1    0     2  7146    14    0      5
8     1     1    4    79    4    1     3   103  3090    1      9
9     6     0   39     4    0   63     2     4     8  364      3
10   29     2    2     8   17    1    17    25    33    0  12662
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70545024, 'precision': 0.6581894, 'recall': 0.5934236, 'specificity': 0.9706665, 'f1': 0.5646529, 'auroc': 0.8498298}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1077     1   0   15    0    2    18    37    14    4     2
1      0  1148   0   38    0    0     2   302     3    0     6
2     25     1  75   33  124   25     9    96   399   57   171
3      0     0   0    0    0    0     0     0     0    0     0
4      2     1   1    0  205    0    15     4    30    0  1375
5     14     0   0  155    1  380     1     0    15   25     1
6      1     0   0    6    0    0  3032     5    11    0    12
7      0     0   0   90    0    0     0  1073     0    0     1
8      0     0   0   92    0    2     0    23  1253    0     0
9     36     3  44  195    5  196     2   130   296  210    20
10     0     0   0    0    7    0     7     1     1    0  1630
better model found
persisted
after epoch: 7,now: 2024-08-04 08:40:37.617477,epoch time: 0:53:44.003276,used: 6:35:25.365198,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96658283, 'precision': 0.91869426, 'recall': 0.8944802, 'specificity': 0.9963109, 'f1': 0.9044801, 'auroc': 0.99868023}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     4    2    1     8     3     1    6     29
1     0  1276    0     3    1    0     0    43     4    0      4
2     0     0  235     0   25    2     0     1     1   48      0
3     0     4    0  8105    1   42     0   188    94    5      1
4     1     0   15     0  374    1     0     1     6    3    138
5     0     0    0     9    0  483     0     0     2   26      1
6     6     0    1     3    2    0  1872     5     2    2     15
7     0     7    0    95    2    0     1  7124    27    2      5
8     1     0    5    41    8    5     0    65  3123    4     43
9     1     0   16     0    3   97     0     0     3  371      2
10    3     0    2     5   16    0     8    13     7    2  12735
---- Validation: 
scalar performance:
{'acc': 0.9657884, 'precision': 0.9179523, 'recall': 0.8934969, 'specificity': 0.99622285, 'f1': 0.9039234, 'auroc': 0.99856883}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     3    2    0     7     3     1    4     37
1     0  1273    0     3    1    0     0    48     4    0      3
2     0     0  231     0   25    2     0     1     2   51      0
3     1     3    1  8077    0   43     0   220    93    2      0
4     2     0   13     0  380    1     1     2     5    4    131
5     0     0    1     5    1  470     0     0     4   39      1
6     5     0    1     0    1    0  1876     4     1    0     20
7     0     8    0    85    2    0     1  7141    22    0      6
8     1     1    6    42   12    6     1    70  3111    4     42
9     0     0   11     2    3   87     1     1     3  385      0
10    4     0    3     4   19    0     8    13     8    1  12736
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.723571, 'precision': 0.6377909, 'recall': 0.6239238, 'specificity': 0.97221756, 'f1': 0.59570456, 'auroc': 0.85913056}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1008     0    1  16    4   14    29    14    18   60     6
1      0  1031    1  22    0    6     1   355    19    3    61
2      4     0  149   4  308   25     5    23   292   50   155
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    2   0  220    0     1     0    12    1  1396
5      2     0    1  30    1  496     1     0     8   52     1
6      0     0    0   2    1    0  3043     2     4    0    15
7      0     0    0  44    0    1     0  1106    10    1     2
8      0     0    0  47    0    5     4     3  1306    1     4
9      2     0  168  36   22  263     0    29   248  346    23
10     0     0    0   0    6    0     2     1     0    0  1637
new oracle model saved
early stop counter: 1
val acc:0.9657884240150452, best validation acc: 0.9670723676681519, corresponding to test acc:                         0.7054502367973328 / 0.7235710024833679
after epoch: 8,now: 2024-08-04 09:34:43.102317,epoch time: 0:54:05.484840,used: 7:29:30.850038,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9691781, 'precision': 0.89790547, 'recall': 0.9121762, 'specificity': 0.99678564, 'f1': 0.9026143, 'auroc': 0.9987678}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    2     6    0    0     0     7     1    4     10
1     0  1307    0     6    0    0     0    12     7    0      0
2     0     0  264     0   32    0     0     0     3   13      0
3     0     1    1  8222    2    2     0   122    87    2      0
4     6     1   21     0  468    1     0     1     6    2     33
5     0     0    3    18    1  454     0     0     3   41      1
6    23     3    2     6    6    2  1833    10     6    3     14
7     0    33    1    66    3    0     1  7100    50    1      7
8     0     0   11    44   25    1     0    26  3151    0     35
9     0     1   95     2    5   56     0     3     0  331      0
10   14     1    4     7   91    1     4    16    14    1  12641
---- Validation: 
scalar performance:
{'acc': 0.96958673, 'precision': 0.89631003, 'recall': 0.9095194, 'specificity': 0.9968301, 'f1': 0.9003183, 'auroc': 0.9987931}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    2     6    1    0     0     4     1    4     10
1     0  1307    0     3    0    0     0    18     4    0      0
2     0     0  263     0   30    0     0     1     2   16      0
3     0     1    1  8215    0    3     0   143    77    0      0
4     6     1   19     0  472    0     0     1     4    1     35
5     0     0    4    19    2  444     0     0     4   48      0
6    25     2    1     4    5    0  1841    13     1    1     15
7     0    29    2    62    5    0     1  7103    57    0      6
8     3     0    7    34   17    3     0    26  3172    0     34
9     0     0  104     1    5   63     1     0     2  317      0
10   13     1    4     6   88    0     4     9    11    1  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75435525, 'precision': 0.6806859, 'recall': 0.6457603, 'specificity': 0.9754735, 'f1': 0.64661247, 'auroc': 0.86551285}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   994     7    8   32    4    0    10    51     3   57     4
1     0  1322    3   31    1    0     3   130     1    0     8
2     3     5  296    5  418   14     2    24    97   52    99
3     0     0    0    0    0    0     0     0     0    0     0
4     0     2    2    0  434    0     2     0     5    1  1187
5     2     0    3  108    6  396     1     0     6   69     1
6     0     0    0    1    1    0  3015     2     0    1    47
7     0     2    0   43    0    1     1  1115     1    0     1
8     2     1    1  134   11    1     5     5  1201    2     7
9     8    15  309   89   18  158     0    48    89  395     8
10    0     0    0    0   29    0     2     1     0    0  1614
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 10:28:33.834008,epoch time: 0:53:50.731691,used: 8:23:21.581729,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9740208, 'precision': 0.92456055, 'recall': 0.908916, 'specificity': 0.9971651, 'f1': 0.9162111, 'auroc': 0.9989028}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     5    2    0     5     3     1    1     30
1     0  1304    0     4    0    0     0    18     5    0      1
2     1     0  254     1   30    2     0     1     4   18      1
3     0     1    0  8249    1    7     0   107    72    1      0
4     2     0   15     0  435    1     0     0     5    2     79
5     0     0    0    16    1  442     0     0     2   59      1
6     2     0    1     0    2    0  1867     2     3    0     31
7     0    14    0    68    1    0     1  7122    41    0     15
8     0     0    6    39    5    1     0    33  3188    1     21
9     0     0   61     2    3   54     1     1     3  368      0
10    3     0    1     7   24    1     1     4    13    0  12740
---- Validation: 
scalar performance:
{'acc': 0.9745352, 'precision': 0.9240773, 'recall': 0.9117713, 'specificity': 0.99721414, 'f1': 0.91734934, 'auroc': 0.9990141}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     4    0    0     2     2     1    3     31
1     0  1305    0     5    0    1     0    17     3    0      1
2     1     0  255     0   26    3     0     0     5   20      2
3     0     1    1  8253    1    7     0   118    58    1      0
4     2     0   23     0  433    0     0     0     8    2     71
5     0     0    2    11    0  454     0     0     3   50      1
6     7     0    1     2    2    0  1863     1     2    0     30
7     0     7    1    66    2    0     1  7141    34    0     13
8     2     0    6    36    6    1     0    27  3183    0     35
9     0     0   56     2    4   56     0     0     3  370      2
10    4     0    0     6   24    1     2     5    16    1  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7416917, 'precision': 0.6742867, 'recall': 0.6367961, 'specificity': 0.9742404, 'f1': 0.6336821, 'auroc': 0.8647617}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1030     1    1   16    3   10    32   22     5   32    18
1      0  1245    2   30    2    7     2  176     5    3    27
2      4     0  196   11  382   23     3   19   182   68   127
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0  456    0     1    0    13    0  1161
5      4     0    2   78    3  455     1    0     1   46     2
6      0     0    0    1    7    0  2993    1     3    1    61
7      5     0    0  167    0    0     5  976     2    3     6
8      0     0    0  141    0    5    15    2  1200    2     5
9      7     1  204   85   28  258     5   21    79  431    18
10     0     0    0    0   27    0     0    0     0    0  1619
better model found
persisted
after epoch: 10,now: 2024-08-04 11:22:09.737151,epoch time: 0:53:35.903143,used: 9:16:57.484872,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 9:16:57.484872 at 2024-08-04 11:22:09.737151
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7416917, 'precision': 0.6742867, 'recall': 0.6367961, 'specificity': 0.9742404, 'f1': 0.6336821, 'auroc': 0.8647617}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1030     1    1   16    3   10    32   22     5   32    18
1      0  1245    2   30    2    7     2  176     5    3    27
2      4     0  196   11  382   23     3   19   182   68   127
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0  456    0     1    0    13    0  1161
5      4     0    2   78    3  455     1    0     1   46     2
6      0     0    0    1    7    0  2993    1     3    1    61
7      5     0    0  167    0    0     5  976     2    3     6
8      0     0    0  141    0    5    15    2  1200    2     5
9      7     1  204   85   28  258     5   21    79  431    18
10     0     0    0    0   27    0     0    0     0    0  1619
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75435525, 'precision': 0.6806859, 'recall': 0.6457603, 'specificity': 0.9754735, 'f1': 0.64661247, 'auroc': 0.86551285}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   994     7    8   32    4    0    10    51     3   57     4
1     0  1322    3   31    1    0     3   130     1    0     8
2     3     5  296    5  418   14     2    24    97   52    99
3     0     0    0    0    0    0     0     0     0    0     0
4     0     2    2    0  434    0     2     0     5    1  1187
5     2     0    3  108    6  396     1     0     6   69     1
6     0     0    0    1    1    0  3015     2     0    1    47
7     0     2    0   43    0    1     1  1115     1    0     1
8     2     1    1  134   11    1     5     5  1201    2     7
9     8    15  309   89   18  158     0    48    89  395     8
10    0     0    0    0   29    0     2     1     0    0  1614
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_1_24051362_instance_wise_predictions.txt
accuracy from prediction file 0.7416917372140208
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2616 MiB |  16816 MiB |    774 TiB |    774 TiB |
|       from large pool |   2602 MiB |  16784 MiB |    768 TiB |    768 TiB |
|       from small pool |     14 MiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   2616 MiB |  16816 MiB |    774 TiB |    774 TiB |
|       from large pool |   2602 MiB |  16784 MiB |    768 TiB |    768 TiB |
|       from small pool |     14 MiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2607 MiB |  16770 MiB |    772 TiB |    772 TiB |
|       from large pool |   2594 MiB |  16737 MiB |    766 TiB |    766 TiB |
|       from small pool |     13 MiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17528 MiB |  17528 MiB |  32012 MiB |  14484 MiB |
|       from large pool |  17492 MiB |  17492 MiB |  31974 MiB |  14482 MiB |
|       from small pool |     36 MiB |     36 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 546117 KiB | 776029 KiB | 175925 GiB | 175925 GiB |
|       from large pool | 525728 KiB | 773280 KiB | 169772 GiB | 169772 GiB |
|       from small pool |  20389 KiB |  28880 KiB |   6153 GiB |   6153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3082    |    4805    |   62559 K  |   62556 K  |
|       from large pool |     349    |     697    |   26951 K  |   26950 K  |
|       from small pool |    2733    |    4255    |   35608 K  |   35606 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3082    |    4805    |   62559 K  |   62556 K  |
|       from large pool |     349    |     697    |   26951 K  |   26950 K  |
|       from small pool |    2733    |    4255    |   35608 K  |   35606 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     505    |     510    |     862    |     357    |
|       from large pool |     487    |     492    |     843    |     356    |
|       from small pool |      18    |      18    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     178    |    1233    |   33335 K  |   33334 K  |
|       from large pool |     138    |     343    |   17154 K  |   17154 K  |
|       from small pool |      40    |    1094    |   16180 K  |   16180 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16816 MiB |    774 TiB |    774 TiB |
|       from large pool |  16640 KiB |  16784 MiB |    768 TiB |    768 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16816 MiB |    774 TiB |    774 TiB |
|       from large pool |  16640 KiB |  16784 MiB |    768 TiB |    768 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB |    772 TiB |    772 TiB |
|       from large pool |  16640 KiB |  16737 MiB |    766 TiB |    766 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3150 MiB |  17528 MiB |  32012 MiB |  28862 MiB |
|       from large pool |   3116 MiB |  17492 MiB |  31974 MiB |  28858 MiB |
|       from small pool |     34 MiB |     36 MiB |     38 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 776029 KiB | 175927 GiB | 175927 GiB |
|       from large pool |  24320 KiB | 773280 KiB | 169773 GiB | 169773 GiB |
|       from small pool |      0 KiB |  28880 KiB |   6153 GiB |   6153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   62559 K  |   62559 K  |
|       from large pool |       2    |     697    |   26951 K  |   26951 K  |
|       from small pool |       0    |    4255    |   35608 K  |   35608 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   62559 K  |   62559 K  |
|       from large pool |       2    |     697    |   26951 K  |   26951 K  |
|       from small pool |       0    |    4255    |   35608 K  |   35608 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     156    |     510    |     862    |     706    |
|       from large pool |     139    |     492    |     843    |     704    |
|       from small pool |      17    |      18    |      19    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1233    |   33335 K  |   33335 K  |
|       from large pool |       3    |     343    |   17154 K  |   17154 K  |
|       from small pool |       0    |    1094    |   16180 K  |   16180 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 11:33:23 2024]
Finished job 0.
1 of 1 steps (100%) done
