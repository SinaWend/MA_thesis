Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 15:50:05 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/26.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=26
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507

 Experiment start at: 2024-07-27 16:14:25.487477
before training, model accuracy: 0.12012873589992523
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94378746, 'precision': 0.8800125, 'recall': 0.8138453, 'specificity': 0.99381113, 'f1': 0.83543706, 'auroc': 0.99604183}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   367     0    0     2    0    0    34     5     7    2     65
1     0  1260    0    14    0    0     1    47     5    0      5
2     2     0  177     0   30    1     2     8     8   71     13
3     1     1    0  7828    0   22    12   321   248    3      0
4     1     0   20     0  254    1     2     2    29   16    214
5     1     0    2    28    0  295     2     0    14  178      1
6     7     0    0     0    0    0  1865     4     6    3     22
7     2    14    3   110    2    0     4  7037    74    3     16
8     0     0    4    57    7    1     7    79  3074    5     61
9     0     0   27     5    0   27     4     4     8  414      4
10    9     0    2     8    9    0    15    14    32    1  12704
---- Validation: 
scalar performance:
{'acc': 0.9424636, 'precision': 0.8777451, 'recall': 0.8156539, 'specificity': 0.9936685, 'f1': 0.83590424, 'auroc': 0.99603647}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   370     0    0     2    0    0    35     4     5    6     61
1     0  1251    0    11    0    0     1    57     5    0      7
2     3     0  190     0   26    1     4     7     4   64     13
3     1     1    0  7826    0   15    20   320   253    4      0
4     1     0   26     0  240    1     4     4    32   14    217
5     1     0    2    23    0  311     0     0    13  170      1
6     5     0    0     1    0    0  1868     2     6    1     25
7     1    12    1   123    0    0     3  7009    93    3     20
8     1     0    7    46    7    2     5    88  3069    6     65
9     3     0   32     4    1   32     3     2     8  405      3
10    6     1    3     6   12    0    23    13    34    3  12695
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.741202, 'precision': 0.66791695, 'recall': 0.6342945, 'specificity': 0.973763, 'f1': 0.61427665, 'auroc': 0.8867919}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1079     0    0   1    0    0    58    10     7    8     7
1      1  1227    0  26    0    0     1   197     3    7    37
2     24     3  170   7  155   14    41    48   220  131   202
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    2   0  156    0     1     1    14    0  1457
5     47     0    0  21    1  355     9     0    14  144     1
6      0     0    0   1    2    0  2994     4    40    0    26
7      4     2    0  24    0    0    16  1110     0    2     6
8      2     0    1  42    1    5    29     7  1278    3     2
9     64    10   89  38    3  107    19    81   112  586    28
10     0     0    0   0    7    0     0     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 17:26:27.788906,epoch time: 1:12:02.301429,used: 1:12:02.301429,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9527772, 'precision': 0.89059174, 'recall': 0.8481339, 'specificity': 0.99473083, 'f1': 0.8611289, 'auroc': 0.99752456}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    1     3    2    0    10     0     0    2     71
1     0  1255    0    10    0    0     0    52     5    1      9
2     2     0  248     0   30    1     1     3     1   21      4
3     1     0    2  8068    1    8     3   213   139    1      1
4     0     0   23     0  352    0     2     2    11    4    145
5     1     0    6    44    0  269     1     0     5  194      1
6     9     0    0     2    1    0  1866     1     2    1     25
7     0     4    1   138    1    0     1  7026    54    6     33
8     0     0    7    68   12    1     2    76  3023    3    103
9     1     0   77     5    3    7     1     3     3  390      3
10    2     0    2     6   41    0     5     4    12    2  12720
---- Validation: 
scalar performance:
{'acc': 0.954019, 'precision': 0.8912873, 'recall': 0.8475793, 'specificity': 0.99486965, 'f1': 0.86132157, 'auroc': 0.99751925}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    0     1    1    0     6     4     2    5     70
1     0  1254    0    11    0    0     0    53     6    0      8
2     0     0  247     0   28    1     1     4     3   22      6
3     0     0    3  8093    0    6     4   203   129    1      1
4     1     0   30     0  345    0     0     2     9    5    147
5     2     0    3    43    0  278     0     0     7  187      1
6     4     0    1     2    1    0  1877     0     4    1     18
7     0     5    5   141    1    0     2  7021    53    3     34
8     2     0    7    70   12    0     1    57  3046    3     98
9     1     0   84     3    2   10     1     1     6  381      4
10    1     0    1     7   37    0     8     6     4    2  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7306374, 'precision': 0.67588043, 'recall': 0.6105045, 'specificity': 0.9729555, 'f1': 0.61306465, 'auroc': 0.88550043}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1086     1    0   11    0    0    34    6     5   13    14
1      2  1218    0   32    1    0     1  173     2    6    64
2      7     0  216    9  276    4     7   13   130   59   294
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    4    0  268    0     1    1     6    0  1353
5     14     0    2  113    2  229     9    0    19  202     2
6      0     0    0    1    2    0  3003    3     2    0    56
7      4     0    1  150    0    0     1  999     2    1     6
8      0     0    1   53    3    0     9    4  1289    4     7
9     22     1  244   98   12   37    13   36   135  499    40
10     0     0    0    0   10    0     0    0     0    0  1636
better model found
persisted
after epoch: 2,now: 2024-07-27 18:36:21.125262,epoch time: 1:09:53.336356,used: 2:21:55.637785,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.962088, 'precision': 0.9088992, 'recall': 0.87754273, 'specificity': 0.9957689, 'f1': 0.8904692, 'auroc': 0.998488}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     3    2    0     2     3     0    0     28
1     0  1292    0    10    0    0     0    28     1    0      0
2     1     0  234     0   33    0     0     8     2   31      3
3     1     1    0  8292    0    4     1   108    30    1      1
4     3     0   14     0  375    1     1     4    10    3    127
5     2     0    1    37    1  351     0     0     3  123      3
6    12     0    0     4    1    0  1875     0     2    2     11
7     1    11    1   142    2    0     1  7078    17    1      9
8     2     1    5   175   28    0     2   124  2905    0     53
9     0     1   42     8    3   21     1     4     3  406      3
10   10     0    2    12   33    0     8    15     8    1  12706
---- Validation: 
scalar performance:
{'acc': 0.9623111, 'precision': 0.91120917, 'recall': 0.87716067, 'specificity': 0.9957888, 'f1': 0.89111763, 'auroc': 0.9985658}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    1     1    3    0     2     4     1    1     34
1     0  1290    0     9    0    0     0    32     1    0      0
2     2     1  226     0   34    2     0     8     1   35      3
3     4     1    0  8300    0    3     2    98    28    3      1
4     3     1   21     0  378    0     0     3    10    1    122
5     0     0    1    36    2  356     1     0     5  119      1
6     6     0    2     1    0    0  1880     2     2    2     13
7     1    12    1   145    1    0     1  7084    12    1      7
8     1     1    3   182   16    0     2   131  2909    0     51
9     1     0   42     6    2   14     1     3     1  419      4
10    5     0    1    10   39    0     8    21    13    1  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7279088, 'precision': 0.6780662, 'recall': 0.60387397, 'specificity': 0.9729167, 'f1': 0.6026318, 'auroc': 0.8868959}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1138     1    0    8    1    0     8    5     1    6     2
1      0  1266    0   25    1    0     1  200     0    0     6
2     13     9  177   23  235    7     5   77   229   46   194
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    1    0  309    0     1    3    11    0  1308
5     23     0    1  166    2  214     3    0    13  160    10
6      2     4    0    2    1    0  3022    4    12    0    20
7      1     1    0  161    0    0     0  998     0    0     3
8      0     0    1  118    0    0     5   20  1222    1     3
9     24    20  114  177    5   52     4  140   136  424    41
10     0     0    0    0   12    0     0    0     0    0  1634
better model found
persisted
after epoch: 3,now: 2024-07-27 19:45:37.999512,epoch time: 1:09:16.874250,used: 3:31:12.512035,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9637468, 'precision': 0.9098612, 'recall': 0.8885156, 'specificity': 0.99608564, 'f1': 0.8944965, 'auroc': 0.9986179}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     1    0     2    1    0     6     0     2    1     17
1     0  1315    0     4    0    0     0     6     6    0      1
2     1     0  174     1   50    1     0     0     3   81      1
3     2     2    1  8266    0    9     4    81    71    2      0
4     4     0    5     0  396    0     1     2    15   10    106
5     1     0    0    15    1  440     0     0     5   58      1
6     6     1    0     0    1    1  1881     1     3    3     11
7     0    90    0   201    2    0     1  6869    86    1     13
8     2     1    1    82    8    6     0    50  3102    4     38
9     2     0    7     2    3   46     1     1     3  427      1
10   17     0    2     7   50    0     4     4    10    1  12698
---- Validation: 
scalar performance:
{'acc': 0.96442425, 'precision': 0.9146521, 'recall': 0.8911782, 'specificity': 0.9961553, 'f1': 0.89754176, 'auroc': 0.99873996}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     0    0    0     5     0     0    0     17
1     0  1316    0     4    0    0     0     6     5    0      1
2     3     0  170     0   56    2     0     1     4   74      2
3     1     7    0  8258    2   16     2    66    87    1      0
4     5     0    2     1  405    1     0     2    12    6    105
5     0     0    0    13    0  440     0     0     4   63      1
6     8     0    0     1    2    0  1879     0     2    1     15
7     0    95    2   188    2    0     2  6871    91    2     12
8     0     0    0    90    7    2     1    46  3107    3     40
9     1     0    7     3    0   46     1     0     4  431      0
10   11     1    1     7   35    0     5     3    14    2  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7561743, 'precision': 0.6633065, 'recall': 0.6459302, 'specificity': 0.97529984, 'f1': 0.6245847, 'auroc': 0.88316727}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1131     1   0   5    1    0    13     2     3    9     5
1      1  1415   0  15    1    4     1    31     9    0    22
2     14     1  89   3  347   12     1     8   220   93   227
3      0     0   0   0    0    0     0     0     0    0     0
4      1     0   1   0  154    0     1     0    12    0  1464
5     12     0   0  21    3  373     2     0    17  163     1
6      1     1   0   0    1    0  3025     2     5    0    32
7      1    28   0  40    0    1    14  1066     6    1     7
8      0     0   0  19    1    6     5     2  1331    4     2
9     26     9  81  26   22  104    11    22   222  580    34
10     0     0   0   0    2    0     0     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 20:54:13.765923,epoch time: 1:08:35.766411,used: 4:39:48.278446,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9661815, 'precision': 0.9316008, 'recall': 0.86504245, 'specificity': 0.99626076, 'f1': 0.8843019, 'auroc': 0.99904054}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     1    1    0    18     4     1    3     35
1     0  1277    0    12    0    0     0    37     3    0      2
2     0     0  120     0   50    1     0     7     6  121      7
3     1     1    0  8332    0    0     1    37    63    1      0
4     4     0    0     0  363    1     0     3    17    7    144
5     0     0    0    23    0  440     0     0     9   48      1
6     3     0    0     2    1    0  1880     2     5    0     15
7     0     4    0   217    1    0     1  6913   123    0      5
8     0     0    1    66    4    0     3    13  3187    1     21
9     0     0    2     5    1   39     0     1     3  442      0
10    3     0    0     7   12    0     3     5    23    2  12738
---- Validation: 
scalar performance:
{'acc': 0.96536046, 'precision': 0.9300202, 'recall': 0.864753, 'specificity': 0.9961696, 'f1': 0.882536, 'auroc': 0.9990011}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     2    2    0    16     1     0    3     39
1     0  1286    0     7    0    0     0    33     5    0      1
2     1     0  117     0   44    1     1     8     6  124     10
3     3     2    0  8345    0    1     1    30    58    0      0
4     1     0    1     0  369    1     0     1    16   10    140
5     0     0    0    23    1  434     0     0     8   54      1
6     4     0    0     2    1    0  1875     2     3    1     20
7     0     6    0   223    1    0     1  6906   120    1      7
8     1     0    0    82    2    0     0    18  3170    4     19
9     0     0    1     4    2   33     0     0     6  447      0
10    4     0    0     7   24    0     4    11    23    2  12721
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7134262, 'precision': 0.66720307, 'recall': 0.6028277, 'specificity': 0.9712481, 'f1': 0.58400834, 'auroc': 0.88045186}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1070     0   0    9    0    0    16    33     9   21    12
1      0  1199   0   27    1    0     0   229     7    0    36
2     18     0  93   13  116    7     1    74   268   96   329
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   2    0  125    0     1     2    14    0  1489
5      6     0   0  129    1  282     0     0    25  145     4
6      8     0   0    4    0    0  2895     5    18    1   136
7      0     0   0   39    0    0     0  1122     0    1     2
8      0     0   0   85    0    0     2    16  1264    2     1
9     12     0  55  112    5   76     1   123   211  505    37
10     0     0   0    0    3    0     0     1     0    0  1642
better model found
persisted
after epoch: 5,now: 2024-07-27 22:03:20.930987,epoch time: 1:09:07.165064,used: 5:48:55.443510,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97736514, 'precision': 0.93283087, 'recall': 0.93653536, 'specificity': 0.9976037, 'f1': 0.93372667, 'auroc': 0.99939764}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     1    0     2    3    0    12     1     0    2      8
1     0  1325    0     1    0    0     0     5     1    0      0
2     0     0  290     0    9    2     0     0     0   11      0
3     0    10    1  8238    0    5     0   110    72    1      0
4     5     0   23     0  432    0     2     2     9    2     64
5     0     0    2     7    0  454     0     0     3   54      1
6     1     1    0     0    0    0  1899     2     1    0      4
7     0    41    3    45    1    0     4  7131    30    0      8
8     3     1    4    31    5    2     2    35  3194    1     18
9     0     0   49     1    1   21     0     0     2  419      0
10   13     1    2     8   39    1    22     3     9    0  12694
---- Validation: 
scalar performance:
{'acc': 0.9763809, 'precision': 0.92839074, 'recall': 0.9336945, 'specificity': 0.99750787, 'f1': 0.92958194, 'auroc': 0.999321}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    1     0    2    0    11     3     0    1      6
1     0  1321    0     1    0    0     0     9     1    0      0
2     0     0  288     1   10    2     0     0     1   10      0
3     1     7    1  8228    0   11     0   109    80    3      0
4     8     0   31     0  426    1     3     0     7    2     61
5     0     0    2     6    0  467     0     0     4   41      1
6     0     2    0     0    0    0  1898     1     1    1      5
7     0    38    3    60    1    0     3  7113    43    1      3
8     2     3    5    38    5    0     0    24  3196    1     22
9     1     0   58     2    0   32     1     0     1  398      0
10   22     0    2     6   26    0    16     3    13    0  12708
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.762681, 'precision': 0.70158136, 'recall': 0.64814365, 'specificity': 0.9757695, 'f1': 0.6456864, 'auroc': 0.8863531}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   944     2    2   6    0    1   153    31     8   20     3
1     0  1426    1  10    0    0     1    44     3    1    13
2     8     3  354   9  137    7    92    30   125   81   169
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    6   0  198    0    10     0    13    0  1405
5     4     0    6  68    1  287    13     0    13  199     1
6     0     0    0   1    0    0  3062     2     0    0     2
7     0     5    1  15    0    0     3  1136     0    0     4
8     0     0    4  47    0    1    44    17  1249    4     4
9     6     9  226  59    1   60    32    33    84  613    14
10    0     0    0   0    8    0     4     0     2    0  1632
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 23:12:58.376268,epoch time: 1:09:37.445281,used: 6:58:32.888791,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9779805, 'precision': 0.9446595, 'recall': 0.9414756, 'specificity': 0.9975855, 'f1': 0.941473, 'auroc': 0.9995965}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    3    0     3     0     0    2      7
1     0  1317    0     4    0    0     0     9     1    0      1
2     0     0  289     0    5    0     0     0     1   16      1
3     0     0    0  8398    0    1     0    21    14    4      0
4     1     0   20     1  450    0     0     0     7    0     60
5     0     0    0    17    1  418     1     0     1   81      1
6     3     0    0     1    0    0  1893     0     2    0      8
7     1    11    7   157    3    0     3  7039    31    5      6
8     0     2    2   140    4    0     0    19  3111    5     12
9     0     0   19     1    0    8     0     0     1  464      0
10    8     0    6     7   42    0     6     3    14    1  12707
---- Validation: 
scalar performance:
{'acc': 0.9777718, 'precision': 0.9477636, 'recall': 0.9422767, 'specificity': 0.99754065, 'f1': 0.94351697, 'auroc': 0.99964523}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    3    0     3     0     0    2      9
1     0  1318    0     6    0    0     0     8     0    0      0
2     0     0  292     1    3    0     0     0     1   15      0
3     0     0    0  8402    0    1     0    22    14    0      1
4     2     0   23     0  442    0     0     0     8    0     64
5     0     0    0    21    0  425     0     0     1   73      1
6     3     0    1     2    1    0  1895     0     0    1      5
7     0    12    4   157    1    0     3  7047    32    4      5
8     0     0    4   149    7    1     0    19  3092    1     23
9     0     0   17     1    0    6     0     0     0  469      0
10    8     0    5     7   38    0     8     1    22    0  12707
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73539495, 'precision': 0.7009973, 'recall': 0.6138565, 'specificity': 0.973729, 'f1': 0.620803, 'auroc': 0.88238865}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1040     0    6   21    2    1    47    29     2   20     2
1      3  1284    2   27    1    0     1   155     5    2    19
2      9     2  477   36   89    8    18    21   227   60    68
3      0     0    0    0    0    0     0     0     0    0     0
4      1     1   20    0  242    0     4     0    32    0  1333
5      4     0   28  175    0  162     3     0     1  217     2
6      1     0    1    1    0    0  3028     3    16    0    17
7      3     0    5  123    0    0     2  1024     1    1     5
8      0     0    1  195    0    0    23    11  1134    3     3
9      7     8  239  224    2   41     6    45    64  487    14
10     0     0    0    0   10    0     2     0     1    0  1633
better model found
persisted
after epoch: 7,now: 2024-07-28 00:24:36.865614,epoch time: 1:11:38.489346,used: 8:10:11.378137,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9786494, 'precision': 0.9616474, 'recall': 0.9480853, 'specificity': 0.99762905, 'f1': 0.95418423, 'auroc': 0.9996849}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    2    0     2     1     1    0      2
1     0  1300    0    11    0    0     0    20     1    0      0
2     0     0  293     1    3    0     0     1     7    7      0
3     0     1    0  8396    0    2     0    17    20    0      0
4     4     0   12     0  446    0     0     1    19    1     56
5     0     0    0    19    0  474     0     0     5   21      1
6     1     0    0     0    1    0  1895     0     2    0      9
7     0     2    0   272    0    0     4  6940    43    0      4
8     0     0    0    55    0    0     1     4  3232    0      2
9     3     0   30     5    0   19     0     0     4  432      0
10    2     0    1     6   22    0     1    10    56    0  12696
---- Validation: 
scalar performance:
{'acc': 0.9775846, 'precision': 0.9595633, 'recall': 0.94316494, 'specificity': 0.99751085, 'f1': 0.9507873, 'auroc': 0.999691}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    2    0     8     0     1    0      5
1     0  1296    0    14    0    0     0    21     1    0      0
2     0     0  282     2   10    1     0     2     9    5      1
3     0     0    0  8405    0    1     0    10    24    0      0
4     2     0    9     0  457    0     0     0    17    1     53
5     0     0    0    20    0  468     0     0     3   29      1
6     1     0    0     2    1    0  1894     0     2    0      8
7     2     0    0   285    1    0     4  6930    38    0      5
8     0     0    0    59    0    0     0     8  3225    0      4
9     0     0   36     4    0   17     1     1     3  431      0
10    2     0    3     7   13    0     2     9    67    0  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66990834, 'precision': 0.6416052, 'recall': 0.55198586, 'specificity': 0.9668538, 'f1': 0.5538518, 'auroc': 0.87525004}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   801     0    1   15    4    0   298   25     8    7    11
1     2  1202    1   30    1    0     3  217    10    0    33
2     7     2  177   28  172    8     7   30   369   47   168
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    6    0  105    0     1    0    35    0  1486
5     8     0    3  149    1  264     3    0    26  124    14
6     2     0    1    3    1    0  2944    3    30    0    83
7     0     0    0  347    0    0     5  805     0    1     6
8     0     0    0  102    0    0     7    7  1251    2     1
9    10    10   95  203    6   88    13   58   235  387    32
10    0     0    0    0    5    0     1    0     1    0  1639
early stop counter: 1
val acc:0.9775846004486084, best validation acc: 0.9777718186378479, corresponding to test acc:                         0.7353949546813965 / 0.7626810073852539
after epoch: 8,now: 2024-07-28 01:36:37.073359,epoch time: 1:12:00.207745,used: 9:22:11.585882,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9877461, 'precision': 0.9710051, 'recall': 0.9634705, 'specificity': 0.99866176, 'f1': 0.9668597, 'auroc': 0.99981934}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     0     0     0    0      2
1     0  1312    0     2    0    0     0    16     0    0      0
2     0     0  273     0   17    0     0     0     3   16      3
3     0     0    0  8376    0    1     0    30    26    2      0
4     3     0    4     0  494    1     0     0     1    0     36
5     0     0    0     2    1  512     0     0     0    6      0
6     6     0    0     1    1    1  1888     3     2    0      6
7     0     1    0    78    0    0     1  7156    25    0      3
8     0     0    0    28    5    0     0    20  3233    0     10
9     0     0    5     1    3   39     2     0     0  443      0
10    6     0    0     6   12    0     8     6     6    0  12751
---- Validation: 
scalar performance:
{'acc': 0.98855156, 'precision': 0.9722998, 'recall': 0.962886, 'specificity': 0.9987432, 'f1': 0.9671935, 'auroc': 0.9998508}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    1    1     0     0     0    0      5
1     0  1321    0     1    0    0     0    10     0    0      0
2     1     0  264     0   23    0     0     0     3   20      1
3     1     0    0  8382    0    3     0    27    27    0      0
4     5     0    1     0  494    0     0     0     2    0     37
5     0     0    0     1    1  506     0     0     2   10      1
6     6     0    0     4    0    0  1890     2     2    0      4
7     0     3    0    78    1    0     1  7168    11    0      3
8     1     0    0    33    2    0     0    14  3237    0      9
9     0     0    8     0    0   23     0     0     2  460      0
10    5     0    0     7   10    1     3     5     5    0  12760
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70538026, 'precision': 0.6584069, 'recall': 0.60452557, 'specificity': 0.9706031, 'f1': 0.57389426, 'auroc': 0.8720102}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1052     0   0   20    2   15    29    30     3   11     8
1      2  1218   0   28    2    1     3   215     3    1    26
2      8     3  89   27  200   49    12    45   340   53   189
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   1    0  137    0     1     1    29    0  1464
5      2     0   0   93    0  456     2     0    11   25     3
6      1     0   0    3    1    0  2937     4    53    0    68
7      0     0   0  122    0    1     0  1036     0    1     4
8      0     0   0  117    0    6    11    13  1222    0     1
9      8     9  28  147   10  341     5    92   174  298    25
10     0     0   0    0    5    0     3     0     1    0  1637
better model found
persisted
after epoch: 9,now: 2024-07-28 02:48:21.864361,epoch time: 1:11:44.791002,used: 10:33:56.376884,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98680973, 'precision': 0.96470046, 'recall': 0.9640814, 'specificity': 0.9986331, 'f1': 0.9640841, 'auroc': 0.9998237}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    1     2    3    2    24     0     3    1      2
1     0  1317    0     0    0    0     0    13     0    0      0
2     0     0  294     0    5    0     2     0     2    8      1
3     0     1    0  8327    0    6     1    38    64    0      0
4     1     0    3     0  517    0     0     1     1    2     14
5     0     0    0     5    0  469     0     0     3   43      1
6     0     0    0     0    0    0  1903     1     0    0      4
7     0     2    0    46    1    0     1  7151    60    0      3
8     0     0    0     5    8    0     0     0  3273    0     10
9     0     0   16     1    0   12     1     0     2  461      0
10    5     0    0     6   28    0    14     2    12    0  12726
---- Validation: 
scalar performance:
{'acc': 0.98694664, 'precision': 0.96456563, 'recall': 0.9630729, 'specificity': 0.998631, 'f1': 0.9636153, 'auroc': 0.9998237}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    1     0    5    0    21     0     1    1      3
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     0  290     0    8    0     0     2     3    8      1
3     0     0    1  8344    0    2     0    39    54    0      0
4     0     1    3     0  510    0     1     1     1    1     21
5     0     0    0     7    0  475     0     0     1   38      0
6     0     0    0     0    0    0  1901     1     1    0      5
7     1     3    0    45    1    0     0  7156    56    0      3
8     0     0    0    10    5    0     0     4  3262    0     15
9     0     0   17     2    1   15     1     0     2  455      0
10    5     0    1     5   30    0    18     4     4    2  12727
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6950955, 'precision': 0.67637527, 'recall': 0.577118, 'specificity': 0.9692372, 'f1': 0.55951416, 'auroc': 0.8742038}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   803     0   0   24    0   13   173    81    40   34     2
1     3  1107   0   25    1    0     1   335     9    0    18
2     8     2  64   23   94   16    97    62   460   75   114
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    0  248    0     9     4    42    0  1329
5     4     0   0  132    0  311     0     0    24  119     2
6     0     0   0    3    0    0  3016     5    32    0    11
7     0     0   0   46    0    0     1  1110     3    0     4
8     0     0   0   69    0    0    19     2  1278    2     0
9     7     2  14  195    1  120    44    89   291  366     8
10    0     0   0    0   12    0     1     0     1    0  1632
early stop counter: 1
val acc:0.9869466423988342, best validation acc: 0.9885515570640564, corresponding to test acc:                         0.7053802609443665 / 0.7626810073852539
after epoch: 10,now: 2024-07-28 04:00:15.292471,epoch time: 1:11:53.428110,used: 11:45:49.804994,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:45:49.804994 at 2024-07-28 04:00:15.292471
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70538026, 'precision': 0.6584069, 'recall': 0.60452557, 'specificity': 0.9706031, 'f1': 0.57389426, 'auroc': 0.8720102}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1052     0   0   20    2   15    29    30     3   11     8
1      2  1218   0   28    2    1     3   215     3    1    26
2      8     3  89   27  200   49    12    45   340   53   189
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   1    0  137    0     1     1    29    0  1464
5      2     0   0   93    0  456     2     0    11   25     3
6      1     0   0    3    1    0  2937     4    53    0    68
7      0     0   0  122    0    1     0  1036     0    1     4
8      0     0   0  117    0    6    11    13  1222    0     1
9      8     9  28  147   10  341     5    92   174  298    25
10     0     0   0    0    5    0     3     0     1    0  1637
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.762681, 'precision': 0.70158136, 'recall': 0.64814365, 'specificity': 0.9757695, 'f1': 0.6456864, 'auroc': 0.8863531}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   944     2    2   6    0    1   153    31     8   20     3
1     0  1426    1  10    0    0     1    44     3    1    13
2     8     3  354   9  137    7    92    30   125   81   169
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    6   0  198    0    10     0    13    0  1405
5     4     0    6  68    1  287    13     0    13  199     1
6     0     0    0   1    0    0  3062     2     0    0     2
7     0     5    1  15    0    0     3  1136     0    0     4
8     0     0    4  47    0    1    44    17  1249    4     4
9     6     9  226  59    1   60    32    33    84  613    14
10    0     0    0   0    8    0     4     0     2    0  1632
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104507_instance_wise_predictions.txt
accuracy from prediction file 0.7053802560694046
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/26.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/26.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/26.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15814 MiB | 677064 GiB | 677062 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 672109 GiB | 672108 GiB |
|       from small pool |      7 MiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15814 MiB | 677064 GiB | 677062 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 672109 GiB | 672108 GiB |
|       from small pool |      7 MiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15770 MiB | 675223 GiB | 675221 GiB |
|       from large pool |   1647 MiB |  15745 MiB | 670272 GiB | 670270 GiB |
|       from small pool |      6 MiB |     26 MiB |   4951 GiB |   4951 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16410 MiB |  16410 MiB |  16410 MiB |      0 B   |
|       from large pool |  16382 MiB |  16382 MiB |  16382 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 225344 KiB | 686056 KiB |  93991 GiB |  93991 GiB |
|       from large pool | 216320 KiB | 683904 KiB |  88850 GiB |  88850 GiB |
|       from small pool |   9024 KiB |  13093 KiB |   5141 GiB |   5141 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   44767 K  |   44764 K  |
|       from large pool |     247    |     593    |   22816 K  |   22816 K  |
|       from small pool |    2399    |    3599    |   21950 K  |   21948 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   44767 K  |   44764 K  |
|       from large pool |     247    |     593    |   22816 K  |   22816 K  |
|       from small pool |    2399    |    3599    |   21950 K  |   21948 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     462    |     462    |     462    |       0    |
|       from large pool |     448    |     448    |     448    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     114    |     561    |   25619 K  |   25619 K  |
|       from large pool |      94    |     302    |   15928 K  |   15928 K  |
|       from small pool |      20    |     452    |    9691 K  |    9691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 677064 GiB | 677064 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 672109 GiB | 672109 GiB |
|       from small pool |      0 KiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 677064 GiB | 677064 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 672109 GiB | 672109 GiB |
|       from small pool |      0 KiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 675223 GiB | 675223 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 670272 GiB | 670272 GiB |
|       from small pool |      0 KiB |     26 MiB |   4951 GiB |   4951 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |  16410 MiB |  16410 MiB |  14534 MiB |
|       from large pool |   1860 MiB |  16382 MiB |  16382 MiB |  14522 MiB |
|       from small pool |     16 MiB |     28 MiB |     28 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 686056 KiB |  93992 GiB |  93992 GiB |
|       from large pool |  24320 KiB | 683904 KiB |  88851 GiB |  88851 GiB |
|       from small pool |      0 KiB |  15452 KiB |   5141 GiB |   5141 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44767 K  |   44767 K  |
|       from large pool |       2    |     593    |   22816 K  |   22816 K  |
|       from small pool |       0    |    3599    |   21950 K  |   21950 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44767 K  |   44767 K  |
|       from large pool |       2    |     593    |   22816 K  |   22816 K  |
|       from small pool |       0    |    3599    |   21950 K  |   21950 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     101    |     462    |     462    |     361    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       8    |      14    |      14    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     561    |   25620 K  |   25620 K  |
|       from large pool |       3    |     302    |   15928 K  |   15928 K  |
|       from small pool |       0    |     452    |    9691 K  |    9691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 677064 GiB | 677064 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 672109 GiB | 672109 GiB |
|       from small pool |      0 KiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 677064 GiB | 677064 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 672109 GiB | 672109 GiB |
|       from small pool |      0 KiB |     26 MiB |   4954 GiB |   4954 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 675223 GiB | 675223 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 670272 GiB | 670272 GiB |
|       from small pool |      0 KiB |     26 MiB |   4951 GiB |   4951 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |  16410 MiB |  16410 MiB |  14534 MiB |
|       from large pool |   1860 MiB |  16382 MiB |  16382 MiB |  14522 MiB |
|       from small pool |     16 MiB |     28 MiB |     28 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 686056 KiB |  93992 GiB |  93992 GiB |
|       from large pool |  24320 KiB | 683904 KiB |  88851 GiB |  88851 GiB |
|       from small pool |      0 KiB |  15452 KiB |   5141 GiB |   5141 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44767 K  |   44767 K  |
|       from large pool |       2    |     593    |   22816 K  |   22816 K  |
|       from small pool |       0    |    3599    |   21950 K  |   21950 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44767 K  |   44767 K  |
|       from large pool |       2    |     593    |   22816 K  |   22816 K  |
|       from small pool |       0    |    3599    |   21950 K  |   21950 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     101    |     462    |     462    |     361    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       8    |      14    |      14    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     561    |   25620 K  |   25620 K  |
|       from large pool |       3    |     302    |   15928 K  |   15928 K  |
|       from small pool |       0    |     452    |    9691 K  |    9691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507

 Experiment start at: 2024-07-28 04:18:25.429424
before training, model accuracy: 0.09438186883926392
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93292487, 'precision': 0.8435684, 'recall': 0.8197777, 'specificity': 0.99286515, 'f1': 0.8248246, 'auroc': 0.9953964}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    0     7    0    1    11     8    23    7     34
1     0  1280    0    14    0    0     0    32     4    0      1
2     0     0  185     3   47    9     2    13    16   36      1
3     1     2    1  8259    0    9     0    70    94    1      0
4     2     0   12     3  341    3     0    10    75    8     85
5     0     0    1    45    0  450     0     0     5   19      1
6    10     2    0     9    1    5  1825     3    26    2     25
7     0    40    0   442    1    0     1  6683    89    0      7
8     1     1    1   180    4    0     0    43  3062    0      4
9     1     0   50    11    3  202     1     1    17  206      1
10   13     0    4     7  196    3     9    57   317    1  12186
---- Validation: 
scalar performance:
{'acc': 0.9322723, 'precision': 0.8416463, 'recall': 0.8178507, 'specificity': 0.992799, 'f1': 0.8221744, 'auroc': 0.995248}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     0    1     9    1    3     9    11    23    5     28
1     0  1278    0    15    0    0     0    34     4    0      1
2     0     1  187     3   47   10     1    13    11   37      2
3     0     2    0  8249    0   13     0    71   105    0      0
4     2     0   20     3  332    5     0    12    69    6     90
5     0     0    1    39    0  455     0     0     9   17      0
6     9     1    1     9    1    8  1826     6    24    0     23
7     0    34    0   453    1    0     1  6680    92    0      4
8     1     0    3   165    3    2     0    52  3067    0      3
9     0     0   56    12    3  204     0     5    16  196      1
10    7     0    3    10  187    1    12    62   321    3  12190
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6796334, 'precision': 0.6677506, 'recall': 0.58691335, 'specificity': 0.9679012, 'f1': 0.5664242, 'auroc': 0.87991387}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   836     2   0   47    0   18   192    9    32   25     9
1     0  1349   0   39    1    0     0   62    19    0    29
2     1     2  28   12  190   53    15   22   579   39    74
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    0  582    0     1    0    74    1   974
5     3     0   0   72    0  464     2    0    27   21     3
6     0     2   0    2    4    0  2466    4   463    0   126
7     0     2   0  219    0    0     1  923    17    0     2
8     0     0   0   80    0    2     2    0  1285    1     0
9     4    21  16  130   21  299    10   23   394  209    10
10    0     1   0    0   67    0     0    0     6    0  1572
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 05:32:05.942504,epoch time: 1:13:40.513080,used: 1:13:40.513080,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95077056, 'precision': 0.8768444, 'recall': 0.858546, 'specificity': 0.9946821, 'f1': 0.8609025, 'auroc': 0.9976308}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     0    1    0    13     3     2    2     20
1     0  1293    1     6    0    0     0    30     2    0      0
2     3     0  219     0   41    0     0     6     2   40      1
3     2     3    1  7934    1   11     6   425    47    8      0
4     6     0   20     0  371    0     1     3     5    2    131
5     0     0    1    16    1  286     0     0     4  212      1
6     7     0    0     1    5    1  1882     1     2    1      6
7     1    16    4    57    3    0     5  7166     8    0      4
8     2     4    8    88   31    3    10   211  2890    9     39
9     4     0   56     4    4    5     1     3     1  414      1
10   23     0    4     7   59    0    25    14    20    2  12639
---- Validation: 
scalar performance:
{'acc': 0.95104986, 'precision': 0.8835312, 'recall': 0.86340195, 'specificity': 0.9946953, 'f1': 0.8665332, 'auroc': 0.99759436}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     0    4    0    11     4     1    3     17
1     0  1294    1     7    0    0     0    25     3    0      2
2     2     0  231     0   42    0     0     4     2   30      1
3     4     3    0  7925    0   10    12   411    68    7      0
4     7     0   19     0  362    1     2     3     7    3    135
5     0     0    2    16    0  290     0     0     2  210      1
6     6     0    0     0    2    0  1884     2     2    3      9
7     2    12    3    65    1    0     6  7148    18    1      9
8     4     4    8   101   22    3     7   209  2896   10     32
9     1     0   51     2    6    3     0     4     0  425      1
10   20     0    0     6   53    0    26    16    17    1  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7544252, 'precision': 0.67543054, 'recall': 0.6270232, 'specificity': 0.97504956, 'f1': 0.62911963, 'auroc': 0.8833329}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1051     0    1   2    5    0    87     5     1   14     4
1      2  1341    2   8    0    0     9   105     2   10    20
2      2     3  209   6  549    2    25    25    75   57    62
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    4   0  436    0     5     0     8    0  1178
5      7     0    7  36   13  186    14     0     4  316     9
6      0     0    0   1    1    0  3058     3     1    0     3
7      0     0    1  32    0    0     5  1123     0    1     2
8      0     0    2  69   19   10    55    35  1170    7     3
9     12    16  318  23   41   16    19    48    45  586    13
10     0     0    0   0   21    0     2     0     0    0  1623
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 06:43:49.907793,epoch time: 1:11:43.965289,used: 2:25:24.478369,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9506635, 'precision': 0.8933525, 'recall': 0.8647894, 'specificity': 0.9948008, 'f1': 0.87273216, 'auroc': 0.9977981}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     3    0    0     9     0    10    0      5
1     0  1293    0    12    0    0     0    21     6    0      0
2     1     1  231     1   24    0     2     2    18   31      1
3     0     3    0  8177    0    7     0   147   103    1      0
4     7     1   25     1  291    1     3     2    81    8    118
5     0     0    0    39    0  355     0     0     7  120      0
6     4     0    0     1    0    0  1891     2     4    1      5
7     1    21    0   162    1    0     2  6907   163    1      5
8     1     0    1    90    1    1     0    28  3171    2      1
9     9     0   55     5    1   14     1     1    15  392      0
10   34     0    3     7   15    1    26     7   329    2  12368
---- Validation: 
scalar performance:
{'acc': 0.9497659, 'precision': 0.8855633, 'recall': 0.857864, 'specificity': 0.9947254, 'f1': 0.86541975, 'auroc': 0.9977544}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    1     2    0    0    13     0     4    0      6
1     0  1293    0    12    0    0     1    23     3    0      0
2     6     0  223     0   27    0     2     4    23   27      0
3     1     5    0  8194    0    2     0   127   110    1      0
4     6     0   24     1  296    1     1     2    92    3    113
5     2     0    0    36    0  340     0     0     5  137      1
6     5     0    0     1    0    0  1888     1     7    1      5
7     0    29    2   168    1    0     2  6903   156    1      3
8     1     1    2    97    1    2     1    30  3160    1      0
9     8     0   60     7    2   21     2     1    13  378      1
10   40     1    2     9   16    0    27     8   317    1  12375
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7041209, 'precision': 0.6850892, 'recall': 0.58842707, 'specificity': 0.9704824, 'f1': 0.57091105, 'auroc': 0.87959015}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1008     1   0   78   0    0    40    10    23    8     2
1      0  1354   0   36   0    0     4    86    10    0     9
2      3    10  87   32  25    9    21    19   579   82   148
3      0     0   0    0   0    0     0     0     0    0     0
4      1     0   3    0  76    0    10     0   103    1  1439
5      4     0   0  194   0  282     1     0    19   90     2
6      0     0   0    1   0    0  2945     3   117    0     1
7      0     2   0   89   0    0     1  1062     8    0     2
8      0     0   0  110   0    0     2     3  1254    0     1
9      6    37  53  204   1   94    18    41   301  363    19
10     0     1   0    0   3    0     3     1     5    0  1633
early stop counter: 1
val acc:0.9497659206390381, best validation acc: 0.9510498642921448, corresponding to test acc:                         0.7544252276420593 / 0.7544252276420593
after epoch: 3,now: 2024-07-28 07:55:35.128278,epoch time: 1:11:45.220485,used: 3:37:09.698854,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96551263, 'precision': 0.9175427, 'recall': 0.86460936, 'specificity': 0.996183, 'f1': 0.8827882, 'auroc': 0.99866074}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0     1    2    0    13     0     2    0     51
1     0  1290    0     8    0    0     1    24     5    0      3
2     3     0  150     0   91    0     2     2     5   51      8
3     4     1    0  8288    0   17     4    53    72    0      1
4     2     0    1     0  368    1     1     1    13    1    151
5     1     0    0    14    0  495     0     0     2    8      1
6     4     0    0     2    2    0  1879     0     2    0     19
7     6     5    0   162    2    0     3  6957   104    1     20
8     1     0    1    68    4    4     0    24  3173    0     21
9     5     0    9     2    9  107     5     6     5  339      6
10    0     0    0     6   18    1     3     5    25    1  12734
---- Validation: 
scalar performance:
{'acc': 0.96576166, 'precision': 0.9127641, 'recall': 0.8667121, 'specificity': 0.99623626, 'f1': 0.8822952, 'auroc': 0.9986205}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     1    3    0    10     0     0    0     44
1     0  1293    0     8    0    0     0    21     4    0      6
2     4     0  150     0   93    2     0     3     6   49      5
3     3     0    0  8283    0   16     1    49    87    0      1
4     3     0    1     0  369    1     0     0    17    0    148
5     2     0    0     9    0  492     0     0     4   12      2
6     4     0    1     0    1    1  1886     0     1    0     14
7     5     8    2   150    3    0     3  6985    90    0     19
8     0     0    1    69    6    9     2    25  3158    0     26
9    11     0   11     1   15  103     0     3     6  340      3
10    4     0    0     7   12    1     4     6    38    0  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7057301, 'precision': 0.6216864, 'recall': 0.5940368, 'specificity': 0.97013605, 'f1': 0.5687112, 'auroc': 0.87317276}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1044     0   0    3    4    0    94     0     2    1    22
1      2  1232   0   21    0    0     4   146     6    0    88
2     14     1  41    2  320   10    30    17   250   16   314
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0   67    0     2     1    11    0  1552
5     33     0   1   65   11  374     6     0    18   59    25
6      0     0   0    1    0    0  3031     2     0    0    33
7      2     0   0  101    0    1     2  1045     4    0     9
8      0     0   0   41    1    1    18    12  1286    3     8
9     50     9  68   53   58  127    31    75   249  321    96
10     0     0   0    0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 4,now: 2024-07-28 09:07:05.760885,epoch time: 1:11:30.632607,used: 4:48:40.331461,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664758, 'precision': 0.9215827, 'recall': 0.88198954, 'specificity': 0.99626684, 'f1': 0.8888231, 'auroc': 0.9990956}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     0    0     0    0    0     7     1     2    1     75
1     0  1286    0     7    0    0     0    34     3    0      2
2     0     0  289     0    6    0     0     0     1    6     10
3     0     0    0  8186    0   46     0    91   111    0      4
4     0     0   35     0  322    1     1     3    11    1    165
5     0     0    2     2    0  506     0     0     2    8      1
6     1     0    0     1    0    0  1878     0     2    0     25
7     0     3    2    84    1    0     1  7086    76    0     12
8     0     0    6    23    1    8     0    27  3185    0     44
9     0     0   96     2    0  127     2     1     2  260      3
10    2     0    1     6   12    0     3     5    35    0  12728
---- Validation: 
scalar performance:
{'acc': 0.96471846, 'precision': 0.9183743, 'recall': 0.87939537, 'specificity': 0.9960781, 'f1': 0.88864005, 'auroc': 0.9990713}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     0    0     1    1    2     1     2     2    2     75
1     0  1279    0     5    0    1     0    37     7    0      3
2     0     0  275     0   11    4     0     0     2    6     14
3     0     0    1  8181    0   38     1    94   119    3      3
4     0     0   30     0  333    0     1     2    15    0    158
5     0     0    1     3    0  501     0     0     2   13      1
6     2     0    0     0    0    0  1873     1     2    0     30
7     0     1    0   101    1    0     1  7053    94    0     14
8     0     0    6    37    1   11     0    30  3179    0     32
9     0     0   83     1    0  129     1     3     1  271      4
10    1     0    0     7   14    1     3     8    38    0  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72930807, 'precision': 0.66646135, 'recall': 0.62514246, 'specificity': 0.9727283, 'f1': 0.60600203, 'auroc': 0.8839195}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1031     0    1   12    1    5    64     4     9   17    26
1      2  1219    0   27    0    1     5   195    15    1    34
2      1     0  222    4  125   25    31    27   296   26   258
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    6    0  230    0     1     0    27    0  1369
5      5     0    8   40    1  452     8     0    10   56    12
6      0     0    0    1    0    0  3028     3     6    0    29
7      1     0    1  112    0    1     0  1034     7    0     8
8      0     0    0   45    0    8    21     5  1285    0     6
9      6     4  277   48    5  205    17    85   157  284    49
10     0     0    0    0    6    0     0     0     1    0  1639
early stop counter: 1
val acc:0.9647184610366821, best validation acc: 0.965761661529541, corresponding to test acc:                         0.7057300806045532 / 0.7544252276420593
after epoch: 5,now: 2024-07-28 10:17:12.501798,epoch time: 1:10:06.740913,used: 5:58:47.072374,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97570634, 'precision': 0.9306378, 'recall': 0.938908, 'specificity': 0.9974388, 'f1': 0.93340766, 'auroc': 0.99942815}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     1     0     0    0      1
1     1  1304    0     2    0    0     0    22     3    0      0
2     2     0  282     0    7    0     0     4     2   15      0
3     4     3    1  8182    1    9     6    87   145    0      1
4     7     1   39     0  425    0     0     2     7    2     55
5     0     0    1     4    0  463     0     0     3   49      1
6     8     0    0     0    0    0  1888     1     0    0      9
7     1     2    1    95    0    0     5  7124    33    1      3
8     3     0    2    14    6    1     3    42  3212    2     11
9     2     0   36     3    1   17     1     2     3  427      1
10   44     0    3     6   25    0     6     8    18    0  12681
---- Validation: 
scalar performance:
{'acc': 0.97573894, 'precision': 0.92982984, 'recall': 0.9362919, 'specificity': 0.9974488, 'f1': 0.93177783, 'auroc': 0.99944687}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    2    0     6     0     1    0      1
1     0  1302    0     5    0    0     0    24     1    0      0
2     1     0  276     0    8    1     0     1     3   22      0
3     4     4    0  8204    0    5     2    65   155    1      0
4     7     0   34     0  420    1     1     1    10    2     63
5     0     0    0     9    1  462     0     0     3   45      1
6     7     0    1     2    0    0  1890     0     1    0      7
7     2     6    2   103    0    0     6  7118    24    0      4
8     4     0    3     7    7    2     2    37  3226    1      7
9     2     0   33     3    1   16     1     1     2  434      0
10   54     0    2     7   22    0    11     6    19    2  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7150353, 'precision': 0.66005576, 'recall': 0.6011426, 'specificity': 0.9713166, 'f1': 0.5967465, 'auroc': 0.87849706}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1059     1    0    2    0    0    96    4     1    6     1
1      3  1182    0   25    0    0     8  248     4    1    28
2     16     0  194    5  180   14    45   54   282   63   162
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    7    0  234    0     4    2    24    0  1362
5     15     0    3   53    5  336    15    0    12  148     5
6      0     0    0    1    1    0  3033    5    11    0    16
7      3     1    0  321    0    1     5  832     0    0     1
8      1     0    1   43    0    4    41   17  1258    1     4
9     39     4  115   64   11  111    31  122   159  456    25
10     0     0    0    0    6    0     2    1     1    0  1636
better model found
persisted
after epoch: 6,now: 2024-07-28 11:26:57.524788,epoch time: 1:09:45.022990,used: 7:08:32.095364,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97361946, 'precision': 0.94207096, 'recall': 0.93065035, 'specificity': 0.99710727, 'f1': 0.93355376, 'auroc': 0.9996198}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    6    0     1     0     1    1      7
1     0  1295    0    14    0    0     0    20     1    0      1
2     0     0  212     0   27    0     0     7     1   65      0
3     0     0    0  8408    0    9     0    16     6    1      0
4     2     0    4     1  508    0     0     0     2    1     21
5     0     0    0    13    2  477     0     0     0   28      1
6     5     1    0     2    0    0  1884     1     2    2     10
7     1     6    0   250    0    0     1  6985    16    1      5
8     1     0    0   215    9    0     0    24  3034    4      8
9     0     0    6     2    0   37     0     2     0  445      0
10    5     0    2     7   68    1     6    11    15    0  12676
---- Validation: 
scalar performance:
{'acc': 0.97373277, 'precision': 0.94079363, 'recall': 0.9271915, 'specificity': 0.99712586, 'f1': 0.93014383, 'auroc': 0.9996044}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     2    4    0     2     0     0    2      5
1     0  1310    0     8    0    0     0    14     0    0      0
2     1     0  197     1   37    2     0     7     3   63      1
3     0     1    0  8413    0    2     0    16     7    1      0
4     4     0    5     0  502    0     0     0     4    2     22
5     0     0    0     7    1  482     0     0     1   29      1
6     7     0    0     4    2    1  1879     0     2    2     11
7     2     5    0   245    1    0     2  6988    14    2      6
8     0     0    0   210    8    2     0    31  3029    4     12
9     1     0    3     4    0   37     0     0     2  446      0
10    8     0    1     7   64    1     6     8    11    1  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70894843, 'precision': 0.6633643, 'recall': 0.58740187, 'specificity': 0.97118616, 'f1': 0.59415376, 'auroc': 0.88212615}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1087     0   0   13    4    0    10    4     2   47     3
1      3  1182   0   34    0    1     5  239     3    2    30
2      7     1  74   32  471   16     4   31   162  113   104
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   2    0  428    0     4    2    10    1  1186
5      4     0   0   87    6  269     0    0     1  220     5
6      1     0   0    2    7    0  2992    3     8    0    54
7      2     0   0  435    0    1     1  723     0    0     2
8      0     0   0  178    6    6    13    7  1154    2     4
9      9     3  40  152   33  135     1   76    66  604    18
10     0     0   0    0   21    0     4    0     1    0  1620
early stop counter: 1
val acc:0.9737327694892883, best validation acc: 0.9757389426231384, corresponding to test acc:                         0.7150353193283081 / 0.7544252276420593
after epoch: 7,now: 2024-07-28 12:36:34.773826,epoch time: 1:09:37.249038,used: 8:18:09.344402,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9798534, 'precision': 0.9445539, 'recall': 0.94199806, 'specificity': 0.9977894, 'f1': 0.9409696, 'auroc': 0.9996437}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     0    7    0     1     4     1    0     12
1     0  1327    0     2    0    0     0     3     0    0      0
2     0     0  290     0   18    0     0     3     0    0      1
3     1     4    0  8291    0    0     0   121    21    1      0
4     1     0    2     0  501    0     0     1     6    0     27
5     0     0    0    17    0  482     0     0     1   20      1
6     4     0    0     3    2    1  1881     3     2    0     12
7     0    24    0    34    1    0     1  7162    15    0     27
8     1     1    1    55    8    0     0    44  3135    0     50
9     1     0   95     3    1   30     0     2     0  360      1
10    4     1    1     4   34    0     3     2     6    0  12736
---- Validation: 
scalar performance:
{'acc': 0.9799385, 'precision': 0.94590616, 'recall': 0.9439893, 'specificity': 0.9977818, 'f1': 0.9433435, 'auroc': 0.9996681}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     2    6    0     0     0     0    0     16
1     0  1329    0     3    0    0     0     0     0    0      0
2     0     0  289     0   17    0     0     3     0    1      2
3     1     1    0  8299    0    2     0   103    31    0      3
4     1     0    4     1  504    0     0     0     5    0     24
5     0     0    4    17    0  474     0     0     2   24      0
6     4     0    0     2    4    0  1876     6     1    0     15
7     0    30    0    35    0    0     0  7153    20    1     26
8     1     1    0    57    7    0     0    34  3127    0     69
9     1     0   81     1    0   28     1     1     1  379      0
10    3     0    0     3   35    0     1     2     6    0  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72769886, 'precision': 0.6759096, 'recall': 0.61623526, 'specificity': 0.97302395, 'f1': 0.6134643, 'auroc': 0.87980473}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1040     1    0   26    5    2     7    66     7   12     4
1      0  1309    0   31    1    1     1   132     5    1    18
2      4     5  193   42  272   28     4    54   298   32    83
3      0     0    0    0    0    0     0     0     0    0     0
4      1     1    5    0  443    0     2     1    24    0  1156
5      2     0    1  202    0  338     0     0     4   44     1
6     12     1    0   10    4    1  2892     4    41    0   102
7      0     0    1   58    0    0     0  1100     1    0     4
8      0     0    0  149    0    1     3    32  1179    3     3
9     12    10  166  250   14  155     0    98   135  283    14
10     0     0    0    0   19    0     2     0     1    0  1624
better model found
persisted
after epoch: 8,now: 2024-07-28 13:47:03.480785,epoch time: 1:10:28.706959,used: 9:28:38.051361,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9815122, 'precision': 0.9641834, 'recall': 0.9485181, 'specificity': 0.9978979, 'f1': 0.9554753, 'auroc': 0.9997848}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     1    0     1    0    0     0     1     0    1      9
1     0  1324    0     6    0    0     0     2     0    0      0
2     0     0  271     0    5    0     1     0     2   31      2
3     0     0    0  8396    0    1     0    23    17    1      0
4     6     0    9     0  435    0     0     0     1    5     83
5     0     0    0     7    0  497     0     0     0   16      0
6     1     0    0     2    0    0  1893     0     0    0     11
7     0    42    3   162    1    0     0  7031    13    3     10
8     0     3    0    75    4    3     2    39  3138    3     28
9     0     0    7     0    0   25     2     1     0  458      0
10    2     0    2     6    5    0     3     1     1    0  12773
---- Validation: 
scalar performance:
{'acc': 0.9812759, 'precision': 0.9650735, 'recall': 0.94965965, 'specificity': 0.9978869, 'f1': 0.9562999, 'auroc': 0.9997787}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    1    0     2     0     0    0      4
1     0  1327    0     5    0    0     0     0     0    0      0
2     0     0  261     0    7    0     1     0     1   40      2
3     0     2    0  8403    0    3     0    19    13    0      0
4     6     0    7     0  439    0     0     1     5    3     78
5     0     0    0     8    0  495     0     0     0   18      0
6     1     0    0     2    1    0  1898     0     0    0      6
7     0    59    2   171    1    0     1  7001    19    0     11
8     0     1    0    79    1    3     0    40  3145    1     26
9     1     0    5     0    0   14     0     0     0  473      0
10    0     1    2     7    8    0     1     1     7    1  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7034912, 'precision': 0.6691733, 'recall': 0.5890834, 'specificity': 0.9703369, 'f1': 0.5955823, 'auroc': 0.8771097}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1067     1    0   23    1    0    44    3     0   22     9
1      2  1416    0   22    0    0     4   16     2    6    31
2      4     8  224   23  158   11    38    7   153   80   309
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    5    0   80    0     1    0     6    0  1541
5      5     0    1  143    1  251     5    0     3  167    16
6      4     3    0    1    1    0  2906    3     3    0   146
7      2    29    5  364    0    0     4  748     1    0    11
8      0     2    2  126    1    2    61   14  1144    4    14
9      7    22  139  149    6   93    15   25    56  575    50
10     0     0    0    0    0    0     1    0     1    0  1644
better model found
persisted
after epoch: 9,now: 2024-07-28 14:56:23.261534,epoch time: 1:09:19.780749,used: 10:37:57.832110,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98400044, 'precision': 0.9603431, 'recall': 0.96324813, 'specificity': 0.99827373, 'f1': 0.96039605, 'auroc': 0.99984026}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    5    0     1     0     0    0      2
1     0  1309    0     4    0    0     0    18     0    0      0
2     0     0  295     0   13    0     0     0     2    1      1
3     0     0    0  8420    0    0     0    16     2    0      0
4     0     0    5     2  521    0     0     0     4    0      7
5     0     0    0     6    0  510     0     0     3    2      0
6     1     0    0     0    0    0  1903     1     2    0      1
7     0     2    0   148    1    0     0  7106     5    0      3
8     0     0    0    86    4    1     0    47  3158    0      0
9     0     0   42     1    0   42     0     1     2  402      2
10    1     0    1     7   66    0     4     9    23    0  12680
---- Validation: 
scalar performance:
{'acc': 0.98344254, 'precision': 0.9597899, 'recall': 0.96473056, 'specificity': 0.9982077, 'f1': 0.961136, 'auroc': 0.9998281}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    1     2    5    0     1     0     0    0      0
1     0  1309    0     2    0    0     0    20     0    0      1
2     0     0  298     0   13    0     0     0     0    0      1
3     0     0    0  8408    0    4     0    22     6    0      0
4     1     0    0     2  527    0     0     0     3    2      4
5     0     0    0    11    0  501     0     0     1    7      1
6     0     0    0     1    1    0  1901     1     1    0      3
7     0     2    1   154    1    0     0  7100     4    1      2
8     0     0    3    96    2    1     0    46  3145    0      3
9     0     0   38     0    2   38     0     1     1  413      0
10    2     0    0    10   66    0     4     6    18    0  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7497376, 'precision': 0.68857765, 'recall': 0.63708377, 'specificity': 0.97517216, 'f1': 0.64050907, 'auroc': 0.88274854}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1030     0    3   24   19   12    43    14     1   19     5
1      0  1234    1   26    3    0     3   201     4    4    23
2      1     1  257   27  461   32    11    23   133   22    47
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    4    0  700    0     3     0    19    0   907
5      3     0    8  134    1  413     1     0     4   27     1
6      0     0    1    1    3    0  3044     2     6    0    10
7      0     1    1  115    0    0     1  1045     0    0     1
8      0     0    4  167    5    4    19    27  1138    4     2
9      3     6  240  190   35  238     5    60    62  283    15
10     0     0    0    0   72    0     1     0     1    0  1572
better model found
persisted
after epoch: 10,now: 2024-07-28 16:07:13.796021,epoch time: 1:10:50.534487,used: 11:48:48.366597,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:48:48.366597 at 2024-07-28 16:07:13.796021
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7497376, 'precision': 0.68857765, 'recall': 0.63708377, 'specificity': 0.97517216, 'f1': 0.64050907, 'auroc': 0.88274854}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1030     0    3   24   19   12    43    14     1   19     5
1      0  1234    1   26    3    0     3   201     4    4    23
2      1     1  257   27  461   32    11    23   133   22    47
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    4    0  700    0     3     0    19    0   907
5      3     0    8  134    1  413     1     0     4   27     1
6      0     0    1    1    3    0  3044     2     6    0    10
7      0     1    1  115    0    0     1  1045     0    0     1
8      0     0    4  167    5    4    19    27  1138    4     2
9      3     6  240  190   35  238     5    60    62  283    15
10     0     0    0    0   72    0     1     0     1    0  1572
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7544252, 'precision': 0.67543054, 'recall': 0.6270232, 'specificity': 0.97504956, 'f1': 0.62911963, 'auroc': 0.8833329}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1051     0    1   2    5    0    87     5     1   14     4
1      2  1341    2   8    0    0     9   105     2   10    20
2      2     3  209   6  549    2    25    25    75   57    62
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    4   0  436    0     5     0     8    0  1178
5      7     0    7  36   13  186    14     0     4  316     9
6      0     0    0   1    1    0  3058     3     1    0     3
7      0     0    1  32    0    0     5  1123     0    1     2
8      0     0    2  69   19   10    55    35  1170    7     3
9     12    16  318  23   41   16    19    48    45  586    13
10     0     0    0   0   21    0     2     0     0    0  1623
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_04_18_24_seed_1_23104507_instance_wise_predictions.txt
accuracy from prediction file 0.7497376338067585
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/26.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/26.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15814 MiB |   1322 TiB |   1322 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1312 TiB |   1312 TiB |
|       from small pool |      7 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15814 MiB |   1322 TiB |   1322 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1312 TiB |   1312 TiB |
|       from small pool |      7 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15770 MiB |   1318 TiB |   1318 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1309 TiB |   1309 TiB |
|       from small pool |      6 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16390 MiB |  16410 MiB |  30924 MiB |  14534 MiB |
|       from large pool |  16362 MiB |  16382 MiB |  30884 MiB |  14522 MiB |
|       from small pool |     28 MiB |     28 MiB |     40 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 225344 KiB | 686056 KiB | 188029 GiB | 188028 GiB |
|       from large pool | 216320 KiB | 683904 KiB | 177723 GiB | 177723 GiB |
|       from small pool |   9024 KiB |  15452 KiB |  10305 GiB |  10305 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   89533 K  |   89531 K  |
|       from large pool |     247    |     593    |   45632 K  |   45632 K  |
|       from small pool |    2399    |    3599    |   43900 K  |   43898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   89533 K  |   89531 K  |
|       from large pool |     247    |     593    |   45632 K  |   45632 K  |
|       from small pool |    2399    |    3599    |   43900 K  |   43898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     461    |     462    |     822    |     361    |
|       from large pool |     447    |     448    |     802    |     355    |
|       from small pool |      14    |      14    |      20    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     114    |     561    |   51267 K  |   51267 K  |
|       from large pool |      95    |     302    |   31903 K  |   31903 K  |
|       from small pool |      19    |     452    |   19363 K  |   19363 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1312 TiB |   1312 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB |   1322 TiB |   1322 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1312 TiB |   1312 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1318 TiB |   1318 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1309 TiB |   1309 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1876 MiB |  16410 MiB |  30924 MiB |  29048 MiB |
|       from large pool |   1860 MiB |  16382 MiB |  30884 MiB |  29024 MiB |
|       from small pool |     16 MiB |     28 MiB |     40 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 686056 KiB | 188030 GiB | 188030 GiB |
|       from large pool |  24320 KiB | 683904 KiB | 177724 GiB | 177724 GiB |
|       from small pool |      0 KiB |  15452 KiB |  10305 GiB |  10305 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   89533 K  |   89533 K  |
|       from large pool |       2    |     593    |   45632 K  |   45632 K  |
|       from small pool |       0    |    3599    |   43900 K  |   43900 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   89533 K  |   89533 K  |
|       from large pool |       2    |     593    |   45632 K  |   45632 K  |
|       from small pool |       0    |    3599    |   43900 K  |   43900 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     101    |     462    |     822    |     721    |
|       from large pool |      93    |     448    |     802    |     709    |
|       from small pool |       8    |      14    |      20    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     561    |   51267 K  |   51267 K  |
|       from large pool |       3    |     302    |   31903 K  |   31903 K  |
|       from small pool |       0    |     452    |   19363 K  |   19363 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 16:17:53 2024]
Finished job 0.
1 of 1 steps (100%) done
