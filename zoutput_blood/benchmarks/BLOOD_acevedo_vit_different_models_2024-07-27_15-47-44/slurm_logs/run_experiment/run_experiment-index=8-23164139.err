Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 21:33:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139

 Experiment start at: 2024-07-28 21:43:59.887265
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86205053, 'precision': 0.6078878, 'recall': 0.6080916, 'specificity': 0.9856391, 'f1': 0.58806616, 'auroc': 0.9547159}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   89     1   0    15   0   16   269    31    24   15     23
1    6  1178   0     9   0    5    16   106     7    1      3
2    2     3   0     3   0   25    23    47    33  105     71
3    0     0   0  7795   0    3     1   434   202    1      2
4    6     0   0     4   0    6   158     9    73   13    270
5    0     0   0   129   0  286     2     1     8   94      1
6    3     2   0     5   1    4  1844    16    26    2      5
7    6    24   0   190   1    2     7  6876   145    0     13
8    5     1   0   123   0    3    17   113  3006    6     22
9    0     1   0    23   0  194     9    16    12  231      7
10  26     0   0    13   0    2  1688    22   122    3  10915
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.86243147, 'precision': 0.61128336, 'recall': 0.6061955, 'specificity': 0.9856663, 'f1': 0.58652675, 'auroc': 0.95334387}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   84     0   0    15   0   13   273    39    21   11     27
1    0  1178   0    15   0    5    14   106     7    0      7
2    3     1   0     5   0   35    27    47    36   92     66
3    1     1   0  7822   0    6     0   404   205    1      0
4    4     0   0     3   0   12   150    13    71   13    273
5    0     0   0   125   0  279     1     3    15   97      1
6    3     3   0     7   0    6  1840    13    32    0      4
7   10    23   0   173   0    3     6  6867   165    1     17
8    0     1   0   128   0    3    13   108  3010    2     31
9    0     1   0    28   0  194     8    13     9  232      8
10  21     2   0     9   0    4  1671    23   133    3  10930
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6284195, 'precision': 0.48037654, 'recall': 0.5182257, 'specificity': 0.96162045, 'f1': 0.46490178, 'auroc': 0.84340656}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   223     0   0  35   0   73   555   111    46   85    42
1     7  1189   0  27   0   26    48   153    19    8    22
2    26     5   0   4   0   36   178    69   322  122   253
3     0     0   0   0   0    0     0     0     0    0     0
4     0     0   0   0   0    0   187     1    13    1  1431
5     0     0   0  70   0  314    20     5    26  155     2
6     0     0   0   4   0    1  2783     1   270    0     8
7     2     2   0   8   0    5     5  1116    23    1     2
8     0     0   0  45   0   10     7     1  1304    3     0
9    18     2   0  41   0  218    44   143   174  445    52
10    0     0   0   0   0    0    38     0     0    0  1608
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 22:32:18.540703,epoch time: 0:48:18.653438,used: 0:48:18.653438,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9159621, 'precision': 0.7460307, 'recall': 0.6910974, 'specificity': 0.99094063, 'f1': 0.68621284, 'auroc': 0.97689086}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   235     3   0     3   0    1   101    23    22    9     86
1     0  1285   0     9   0    1    14    18     3    0      2
2     0    24   0    87  16    4    23    26    23   87     22
3     0     6   0  7831   0   26    40   259   268    4      1
4     1     3   0    39  30    3   112    16    37   14    284
5     0     1   0    40   0  323     0     0    10  146      1
6     6     0   0     0   0    1  1867     1     5    3     25
7     0   151   0   148   0    2    17  6752   180    1     13
8     1     9   0    55   0    5    27    69  3085    3     42
9     0     8   0    23   0   75     2    11     6  359      9
10    7     9   0    18   0    2   216    18    51    4  12468
---- Validation: 
scalar performance:
{'acc': 0.9158486, 'precision': 0.7320205, 'recall': 0.6906328, 'specificity': 0.9909554, 'f1': 0.6847138, 'auroc': 0.97731966}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   242     3   0     3   0    0    91    29    17    6     92
1     0  1287   0     7   0    2     9    19     5    1      2
2     0    24   0    85  23    7    17    22    16   96     22
3     0     9   0  7830   0   32    40   251   277    1      0
4     1     1   0    45  26    4   123    12    45   10    272
5     0     1   0    33   0  325     1     0    14  145      2
6     5     0   0     2   0    1  1866     0     5    0     29
7     0   149   0   139   0    0    23  6742   199    2     11
8     0     9   0    54   0    5    25    69  3095    2     37
9     1    13   0    22   0   82     3     8     6  350      8
10    8     5   0    17   1    0   213    15    56    5  12476
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6936262, 'precision': 0.53120065, 'recall': 0.57973707, 'specificity': 0.9687264, 'f1': 0.53541833, 'auroc': 0.8630028}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   681    15   0   6   0    9    82   202   103   53    19
1     0  1376   0  15   0   15    13    67     4    0     9
2    11    46   0  50  63   11   179   112   189  138   216
3     0     0   0   0   0    0     0     0     0    0     0
4     2     2   0   0   6    0    95     1    10    1  1516
5     2     1   0  26   0  332     6    10    17  194     4
6     0     4   0   3   2    0  2961     7    45    0    45
7     0     1   0  40   0    1     5  1107     3    2     5
8     1     3   0  24   0   13    22     5  1292   10     0
9    12   177   0  20   5  146    32    96   108  520    21
10    0     0   0   0   0    0     7     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 23:28:56.098102,epoch time: 0:56:37.557399,used: 1:44:56.210837,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93217576, 'precision': 0.7728857, 'recall': 0.69125473, 'specificity': 0.9921127, 'f1': 0.70726293, 'auroc': 0.9880151}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   283     1   0     1   0    0    14    35    10    0    139
1     0  1229   0     9   0    1     3    81     2    0      7
2     3     1   0   125  15    6    22    63     4   36     37
3     0     0   0  8038   0   15     0   261   122    0      3
4     1     0   0    28  16    3   101     9    12    1    368
5     1     0   0    35   0  415     0     3     4   61      2
6     2     0   0     2   0    0  1863     5     5    0     31
7     1     5   0   131   1    0     1  7054    48    0     21
8     1     0   0    99   0    5     1   114  2979    3     94
9     3     0   0    39   1  133     3    55     2  231     25
10    2     1   0    14   0    1    14    13    14    0  12733
---- Validation: 
scalar performance:
{'acc': 0.9299452, 'precision': 0.77814287, 'recall': 0.69095683, 'specificity': 0.9918573, 'f1': 0.7080651, 'auroc': 0.9879527}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   284     0   0     1   0    1    11    28     5    1    152
1     1  1228   0     7   0    3     0    83     3    0      7
2     1     1   0   125  12    4    21    69     5   23     51
3     0     0   0  8007   0   18     2   276   136    0      1
4     2     0   0    25  17    1   103    11    15    2    363
5     0     0   0    35   1  405     1     8     5   63      3
6     5     0   0     2   0    1  1863     9     1    0     27
7     0     7   0   153   0    0     1  7039    51    0     14
8     1     0   0   109   0    3     0   140  2946    2     95
9     3     2   0    40   2  128     3    47     4  246     18
10    2     0   0     9   0    2    22    14    16    0  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66011333, 'precision': 0.53334206, 'recall': 0.55054915, 'specificity': 0.96536237, 'f1': 0.5032915, 'auroc': 0.8656455}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   719     0   0   5   0    7   131   131    17    1   159
1     0  1117   0  27   0    4    14   293     5    0    39
2     8     1   0  44  10   19   223   103   207   26   374
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   0   0    0    20     2     9    0  1600
5     5     0   0  85   0  390    27     4    22   43    16
6     0     0   0  14   0    0  2959     3    29    0    62
7     0     0   0  36   0    0     0  1119     4    0     5
8     0     0   0  49   0    3     7     5  1303    0     3
9    19     4   0  57   4  206    55   296   184  183   129
10    0     0   0   0   0    0     1     0     0    0  1645
better model found
persisted
after epoch: 3,now: 2024-07-29 00:32:27.294417,epoch time: 1:03:31.196315,used: 2:48:27.407152,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93442315, 'precision': 0.8608057, 'recall': 0.72690016, 'specificity': 0.99282575, 'f1': 0.736119, 'auroc': 0.98834264}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   312     0   0     4   0    0    19     7    11    0    129
1     0  1261   0    16   0    4     5    36     4    1      5
2     1     2   1   119  68    2    20    14    12   64      9
3     0     1   0  8109   0   16     7   147   156    1      1
4     1     1   0    32  82    1   200     3    28    3    188
5     0     0   0    28   0  360     0     1     5  124      3
6     2     0   0     3   0    0  1886     1     0    0     16
7     2    16   0   214   1    1     3  6837   178    2     10
8     1     0   0    73   0    1     5    49  3143    4     20
9     1     5   0    40   5   57     4     6     7  359      9
10    5     0   0    15   8    1   113     8    65    1  12575
---- Validation: 
scalar performance:
{'acc': 0.9337435, 'precision': 0.861755, 'recall': 0.7273716, 'specificity': 0.99275887, 'f1': 0.73643756, 'auroc': 0.9885311}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   314     0   0     3   0    2    19     7    13    2    123
1     0  1260   0    15   0    2     3    42     4    0      6
2     1     4   1   116  71    1    25    15     9   60      9
3     0     1   0  8131   0   15     4   138   149    1      1
4     1     0   0    36  78    2   195     7    28    2    190
5     0     0   0    26   0  360     0     0     7  126      2
6     1     0   0     2   0    0  1885     0     3    1     16
7     0    12   0   216   1    2     6  6811   204    2     11
8     1     0   0    90   0    0     8    46  3125    4     22
9     1     5   0    33   3   51     4    16    10  368      2
10    4     0   0    16   7    0   128     7    57    2  12575
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68068284, 'precision': 0.5715333, 'recall': 0.5742951, 'specificity': 0.96789336, 'f1': 0.5466182, 'auroc': 0.87109107}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   823     4   0    9   0   10    52   24    83   35   130
1     0  1114   0   44   1   11    20  255    14    3    37
2     7     0   0  274  60   19   117   55   266   96   121
3     0     0   0    0   0    0     0    0     0    0     0
4     2     0   0   13  24    0   211    2    17    0  1364
5     1     0   0   67   0  409     2    0     8  105     0
6     0     0   0   21   0    0  2987    2    31    0    26
7     0     0   0  171   0    1    11  951    24    0     6
8     0     0   0   75   0    7     6    0  1279    3     0
9     6     3   0  166   6  201     6   51   164  512    22
10    0     0   0    0   0    0    16    0     0    0  1630
better model found
persisted
after epoch: 4,now: 2024-07-29 01:41:44.454895,epoch time: 1:09:17.160478,used: 3:57:44.567630,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93632275, 'precision': 0.8677279, 'recall': 0.7107159, 'specificity': 0.9927361, 'f1': 0.73339874, 'auroc': 0.9897372}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   199     0   0     7    1    1    14    24    23    7    207
1     0  1268   0    10    0    1     0    44     2    0      6
2     0     8   6   113   67    2     7    32     6   60     11
3     0     0   0  8026    0   16     0   234   161    2      0
4     0     2   0    22  106    1   125     8    20    3    252
5     0     0   0    30    0  376     0     0     7  106      1
6     3     2   0    11    2    0  1775     8    12    1     94
7     0    18   0   101    1    1     1  7070    62    2      7
8     0     1   0    69    2    1     0   101  3086    1     34
9     0     5   1    35    1   47     0    25    15  359      5
10    2     0   0    14    5    2     5    18    22    0  12725
---- Validation: 
scalar performance:
{'acc': 0.93679285, 'precision': 0.84049475, 'recall': 0.71211475, 'specificity': 0.9928237, 'f1': 0.7325019, 'auroc': 0.98957175}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   215     0   0     5   0    3    23    27    30    3    177
1     0  1274   0    13   0    0     0    38     3    0      4
2     0     5   3   109  83    0     8    32     9   54      9
3     0     2   0  8017   0   18     0   235   167    1      0
4     1     0   0    23  92    0   134     7    28    3    251
5     0     0   0    29   0  369     0     0     6  116      1
6     1     1   0     8   2    1  1777     8    13    1     96
7     0    15   0    89   0    0     2  7095    55    0      9
8     0     1   0    62   0    4     0   101  3087    0     41
9     0     1   2    38   1   42     0    19    12  372      6
10    1     2   0    11   3    0     6    17    33    2  12721
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5779752, 'precision': 0.58316463, 'recall': 0.50005555, 'specificity': 0.9573458, 'f1': 0.46394712, 'auroc': 0.8478316}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   271     3   0   44   0   40   129    79   138   39   427
1     0  1245   0   21   0    5     4   180    12    4    28
2     0     4   3  210  98    7    46   105   301   38   203
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    2  14    0    56     2    15    0  1544
5     0     0   0   89   0  281     2     0    28  190     2
6     0     0   0   22   1    0  1896     3   296    0   849
7     0     0   0   17   0    0     0  1136     5    1     5
8     0     0   0   36   0    3     0     5  1322    3     1
9     1     7   3  136  11   47     2   158   301  447    24
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 5,now: 2024-07-29 03:06:56.623175,epoch time: 1:25:12.168280,used: 5:22:56.735910,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93902504, 'precision': 0.80143404, 'recall': 0.7345679, 'specificity': 0.9931779, 'f1': 0.748802, 'auroc': 0.99251056}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   279     1   0     0    0    1     3    52     6    1    139
1     0  1262   0    13    0    0     3    39    10    1      4
2     0     2   0   139   33    1     7    22     9   89     10
3     0     1   0  7916    0    9     0   199   312    0      2
4     0     0   0    32  106    3   135     5    21    4    233
5     0     1   0    26    0  434     0     1     9   48      1
6     2     0   0     2    1    1  1864     2     2    0     34
7     1     9   0   130    1    0     3  7002   106    1     11
8     2     0   0    28    0    0     0    55  3168    3     40
9     1     0   0    22    0  108     1    13     4  339      5
10    2     0   0    14    3    1     9    10    24    1  12727
---- Validation: 
scalar performance:
{'acc': 0.938585, 'precision': 0.890921, 'recall': 0.733536, 'specificity': 0.99312377, 'f1': 0.7478466, 'auroc': 0.9929202}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   266     0   0     3    0    0     2    51     6    5    150
1     0  1265   0    12    0    2     1    40     8    0      4
2     0     0   1   146   37    3     5    32     7   72      9
3     1     0   0  7905    0   11     0   185   333    2      3
4     0     0   0    27  100    2   141     4    21    5    239
5     0     1   0    28    0  429     0     0     4   58      1
6     2     0   0     4    1    0  1863     2     2    0     34
7     0    11   0   109    1    0     2  7025   105    1     11
8     1     0   0    29    1    2     2    63  3158    3     37
9     0     0   0    14    1   92     1    14     5  357      9
10    3     0   0    13    2    2    19    10    27    0  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65661514, 'precision': 0.5970094, 'recall': 0.54566073, 'specificity': 0.9655572, 'f1': 0.51456213, 'auroc': 0.8659944}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   585     4   0   30   0   19    18   76    48   25   365
1     0  1106   0   44   2    2    12  245    44    1    43
2     2     0   1  143  47   28   102   27   291   90   284
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    0   7    0    83    2    15    0  1526
5     0     1   0  103   0  417     4    0    10   53     4
6     0     0   0    5   0    0  3040    2    12    0     8
7     0     0   0  167   0    1     1  955    30    0    10
8     0     0   0   94   0    3     3    0  1267    1     2
9     2     6   1  165   0  241     9   74   221  364    54
10    0     0   0    0   0    0     2    0     1    0  1643
better model found
persisted
after epoch: 6,now: 2024-07-29 04:34:39.177474,epoch time: 1:27:42.554299,used: 6:50:39.290209,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93300515, 'precision': 0.7849509, 'recall': 0.703269, 'specificity': 0.9923734, 'f1': 0.7181864, 'auroc': 0.9898819}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   143     2   0    25    0    3     2   122    12    3    171
1     0  1272   0    21    0    0     0    37     1    0      1
2     0     2   0   101   74    9     8    12     6   90     10
3     0     1   0  8349    0    7     0    38    42    1      0
4     0     1   0    22  112    2   183     7     8    2    202
5     0     0   0    35    0  451     0     0     1   33      1
6     2     2   0     8    0    3  1857     3     2    0     31
7     0    10   0   494    0    0     3  6732    17    1      5
8     1     0   0   202    1    2     3   106  2930    5     45
9     0     5   0    17    2  147     1     0     1  315      5
10    0     0   0    19    4    2    22    17    18    0  12711
---- Validation: 
scalar performance:
{'acc': 0.9333155, 'precision': 0.8783923, 'recall': 0.7053231, 'specificity': 0.99240524, 'f1': 0.72026694, 'auroc': 0.99016947}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   143     0   0    17    0    1     5   122     9    8    178
1     0  1274   0    21    0    1     2    32     2    0      0
2     0     6   1   103   68   11    11    16     2   88      6
3     0     1   0  8358    0   10     0    38    33    0      0
4     0     2   0    20  118    4   174     6     9    2    204
5     0     0   0    34    0  455     0     0     1   30      1
6     1     0   0    11    1    2  1859     2     2    1     29
7     0    10   0   507    1    0     1  6724    18    1      3
8     0     2   0   208    1    4     5   103  2925    5     43
9     0     1   0    19    0  151     0     1     2  315      4
10    1     2   0    18    6    1    20    12    16    0  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59238786, 'precision': 0.6315521, 'recall': 0.47301012, 'specificity': 0.959703, 'f1': 0.45762825, 'auroc': 0.8460945}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   189     7   0  163    0   40    43  140    53   33   502
1     0  1200   0   68    1   16     2  194     3    0    15
2     0     3   1  235  112   47   189   52    94   69   213
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    2    5    0   128    1     5    0  1492
5     0     0   0  184    0  372     4    0     1   30     1
6     0     0   0   35    0    0  3019    2     1    0    10
7     0     0   0  503    0    1     0  654     1    2     3
8     0     0   0  322    0    5     6    3  1032    0     2
9     1     7   0  309    5  322     9   60    41  357    26
10    0     0   0    0    0    0     8    0     0    0  1638
early stop counter: 1
val acc:0.9333155155181885, best validation acc: 0.9385849833488464, corresponding to test acc:                         0.656615138053894 / 0.6936262249946594
after epoch: 7,now: 2024-07-29 05:58:24.525026,epoch time: 1:23:45.347552,used: 8:14:24.637761,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92610234, 'precision': 0.788133, 'recall': 0.66572046, 'specificity': 0.99147385, 'f1': 0.6792747, 'auroc': 0.989752}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   54     0   0     0   0    1     1   325     8    2     92
1    0  1253   0     7   0    0     0    66     3    0      3
2    0     1   0   109  34    1     3    41     3   97     23
3    0     0   0  7978   0    6     2   383    64    2      3
4    0     0   0    20  98    1   100    13    10   10    286
5    0     0   0    60   0  255     0     0     1  204      1
6   10     0   0     0   0    3  1715     7     2    3    167
7    0     4   0    51   0    0     4  7177    13    2     13
8    2     1   0    80   0    1     3   227  2886    1     92
9    0     0   0    10   0   17     0    23     1  440      2
10   2     1   0     9   1    1     2    12     9    0  12758
---- Validation: 
scalar performance:
{'acc': 0.928153, 'precision': 0.7875453, 'recall': 0.67238885, 'specificity': 0.9917315, 'f1': 0.68500876, 'auroc': 0.9892254}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   65     0   0     2   0    0     2   310     8    1     95
1    0  1261   0     3   0    1     0    62     2    0      3
2    0     1   0   104  40    2     3    36     2  104     20
3    1     0   0  7972   0    3     4   380    74    1      5
4    2     0   0    26  97    2   103    13     7    9    280
5    0     0   0    53   0  259     0     0     3  205      1
6   10     0   0     0   0    4  1724     5     2    4    159
7    0     5   0    48   1    0     2  7178    16    0     15
8    1     0   0    74   1    0     1   205  2933    1     80
9    0     0   0     6   0   14     0    17     1  451      4
10   1     0   0     7   2    1     1    15     9    1  12759
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59623593, 'precision': 0.5322629, 'recall': 0.48986107, 'specificity': 0.95955086, 'f1': 0.44707966, 'auroc': 0.85006005}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   124     3   0   22   0    1     1   823   124   23    49
1     0  1208   0   27   0    3     4   229     6    1    21
2     1     5   0  119  81    9    31   139   197   99   334
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    3   6    1    58     2     5    0  1556
5     0     0   0  137   0  215     2     7     6  223     2
6     1     1   0   24   0    0  2480     3    27    0   531
7     0     0   0   12   0    1    12  1131     1    0     7
8     0     0   0  165   0    0     1    13  1178    5     8
9     0     9   1  141   1   59     2   200   162  534    28
10    0     0   0    0   0    0     0     0     0    0  1646
early stop counter: 2
val acc:0.9281529784202576, best validation acc: 0.9385849833488464, corresponding to test acc:                         0.656615138053894 / 0.6936262249946594
after epoch: 8,now: 2024-07-29 07:25:40.617846,epoch time: 1:27:16.092820,used: 9:41:40.730581,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93573415, 'precision': 0.8298623, 'recall': 0.6889669, 'specificity': 0.992337, 'f1': 0.7097747, 'auroc': 0.99449664}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   62     0   0     1    0    0     0    45     4    1    370
1    0  1271   0     8    0    0     1    43     4    1      3
2    0     2   0   179   18    0     1    32     5   62     13
3    0     1   0  8181    0   14     1   121   116    1      2
4    0     0   0    39  174    0    46     6    20    2    252
5    0     0   0    22    0  283     0     0     6  209      1
6    0     1   0     3    1    0  1619     2     5    1    276
7    0     5   0   126    1    0     0  7058    65    0      8
8    0     0   0    41    0    0     0    72  3147    1     34
9    0     0   0    19    0   12     0     8     6  438     10
10   0     0   0     7    3    0     1     9    33    0  12741
---- Validation: 
scalar performance:
{'acc': 0.93708706, 'precision': 0.8294302, 'recall': 0.6884299, 'specificity': 0.9924867, 'f1': 0.70792115, 'auroc': 0.994638}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   53     0   0     2    0    0     1    30    11    1    385
1    0  1270   0     6    0    0     0    45     8    0      3
2    0     1   0   167   26    0     0    33     5   64     16
3    0     0   0  8209    0    9     1   111   106    3      1
4    0     1   0    40  166    1    52     8    16    1    254
5    0     0   0    18    0  293     0     0     7  201      2
6    0     0   0     2    0    2  1633     2     6    0    263
7    0     6   0    96    1    0     0  7081    74    1      6
8    0     0   0    43    0    0     1    72  3142    0     38
9    0     0   0    25    0   11     0    10     1  437      9
10   0     0   0     9    0    1     2    11    24    0  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49597704, 'precision': 0.531187, 'recall': 0.42858553, 'specificity': 0.94934034, 'f1': 0.3925337, 'auroc': 0.833854}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   37     3   0   16   0    8     2   140    19   15   930
1    0  1123   0   35   0    1     0   298    12    2    28
2    0     2   0  118  29   14    17    55   250   33   497
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   0    0   3    0    17     3    12    0  1598
5    0     1   0  147   0  199     1     0     4  223    17
6    0     0   0   55   0    0  1428    10   253    0  1321
7    0     0   0   66   0    1     0  1092     2    0     3
8    0     0   0  147   0    0     1     7  1210    3     2
9    0     5   0  337   2   65     0    92   161  351   124
10   0     0   0    0   0    0     0     0     0    0  1646
early stop counter: 3
val acc:0.9370870590209961, best validation acc: 0.9385849833488464, corresponding to test acc:                         0.656615138053894 / 0.6936262249946594
after epoch: 9,now: 2024-07-29 08:48:59.662790,epoch time: 1:23:19.044944,used: 11:04:59.775525,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94231594, 'precision': 0.8228217, 'recall': 0.70863044, 'specificity': 0.99334514, 'f1': 0.7162499, 'auroc': 0.9957675}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   26     0   0     2    0    0     3   219     9    3    221
1    0  1303   0    12    0    0     0     8     4    0      4
2    0     2   0   157   36    0     5    22     1   78     11
3    0     3   0  8337    0   12     0    32    50    2      0
4    0     0   0    27  168    3   122     7     6    2    204
5    0     1   0    24    0  405     0     0     0   89      2
6    0     0   0     5    1    1  1851     8     2    0     40
7    0    32   0   242    1    0     1  6914    63    0     11
8    0     0   0   122    0    0     2    63  3063    1     45
9    0     0   0    16    0   53     1     3     2  413      5
10   0     1   0    12    2    1    16     7    14    0  12740
---- Validation: 
scalar performance:
{'acc': 0.94203556, 'precision': 0.8201828, 'recall': 0.7052042, 'specificity': 0.9933087, 'f1': 0.7116382, 'auroc': 0.99579346}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   14     1   0     5    0    0     2   226    13    0    222
1    0  1299   0    15    0    0     0    12     2    0      4
2    0     0   0   156   44    0     2    20     4   75     11
3    0     2   0  8341    0    7     0    43    46    1      0
4    0     0   0    24  171    1   125     3     5    2    208
5    0     0   0    28    0  402     0     0     0   89      2
6    0     1   0     5    0    0  1859     4     0    0     39
7    0    27   0   236    1    0     1  6919    63    3     15
8    0     0   0   108    2    1     2    70  3065    2     46
9    0     0   0    19    0   58     0     5     2  406      3
10   0     0   0    11    4    0    17     6    15    1  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58301264, 'precision': 0.5996568, 'recall': 0.47662708, 'specificity': 0.958156, 'f1': 0.44371396, 'auroc': 0.8543965}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   36     2   0   12    0    4     4  428    80   22   582
1    0  1286   0   53    3    9     1  109     3    4    31
2    0     2   2  121  120    8   158   79   139   45   341
3    0     0   0    0    0    0     0    0     0    0     0
4    0     0   0    1    7    0   104    1     4    0  1516
5    0     0   0  121    0  298     3    1     6  151    12
6    0     0   0   55    0    0  2562    2    66    0   382
7    0     3   0  210    0    1     0  941     2    0     7
8    0     0   0  227    0    3     8    7  1117    2     6
9    0     6   1  237   21  105    10  130   128  439    60
10   0     0   0    0    0    0     1    0     0    0  1645
better model found
persisted
after epoch: 10,now: 2024-07-29 10:03:16.936184,epoch time: 1:14:17.273394,used: 12:19:17.048919,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 12:19:17.048919 at 2024-07-29 10:03:16.936184
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58301264, 'precision': 0.5996568, 'recall': 0.47662708, 'specificity': 0.958156, 'f1': 0.44371396, 'auroc': 0.8543965}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   36     2   0   12    0    4     4  428    80   22   582
1    0  1286   0   53    3    9     1  109     3    4    31
2    0     2   2  121  120    8   158   79   139   45   341
3    0     0   0    0    0    0     0    0     0    0     0
4    0     0   0    1    7    0   104    1     4    0  1516
5    0     0   0  121    0  298     3    1     6  151    12
6    0     0   0   55    0    0  2562    2    66    0   382
7    0     3   0  210    0    1     0  941     2    0     7
8    0     0   0  227    0    3     8    7  1117    2     6
9    0     6   1  237   21  105    10  130   128  439    60
10   0     0   0    0    0    0     1    0     0    0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6936262, 'precision': 0.53120065, 'recall': 0.57973707, 'specificity': 0.9687264, 'f1': 0.53541833, 'auroc': 0.8630028}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   681    15   0   6   0    9    82   202   103   53    19
1     0  1376   0  15   0   15    13    67     4    0     9
2    11    46   0  50  63   11   179   112   189  138   216
3     0     0   0   0   0    0     0     0     0    0     0
4     2     2   0   0   6    0    95     1    10    1  1516
5     2     1   0  26   0  332     6    10    17  194     4
6     0     4   0   3   2    0  2961     7    45    0    45
7     0     1   0  40   0    1     5  1107     3    2     5
8     1     3   0  24   0   13    22     5  1292   10     0
9    12   177   0  20   5  146    32    96   108  520    21
10    0     0   0   0   0    0     7     0     0    0  1639
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_21_43_59_seed_0_23164139_instance_wise_predictions.txt
accuracy from prediction file 0.5830126635415938
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/8.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1658 MiB |   8645 MiB | 424327 GiB | 424326 GiB |
|       from large pool |   1650 MiB |   8630 MiB | 421332 GiB | 421331 GiB |
|       from small pool |      8 MiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1658 MiB |   8645 MiB | 424327 GiB | 424326 GiB |
|       from large pool |   1650 MiB |   8630 MiB | 421332 GiB | 421331 GiB |
|       from small pool |      8 MiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1655 MiB |   8622 MiB | 422415 GiB | 422413 GiB |
|       from large pool |   1647 MiB |   8607 MiB | 419422 GiB | 419421 GiB |
|       from small pool |      7 MiB |     16 MiB |   2992 GiB |   2992 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9114 MiB |   9114 MiB |   9114 MiB |      0 B   |
|       from large pool |   9096 MiB |   9096 MiB |   9096 MiB |      0 B   |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 233216 KiB | 494347 KiB |  74124 GiB |  74123 GiB |
|       from large pool | 227168 KiB | 491072 KiB |  71087 GiB |  71087 GiB |
|       from small pool |   6048 KiB |  13085 KiB |   3036 GiB |   3036 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3608    |    4670    |   31810 K  |   31806 K  |
|       from large pool |     247    |     398    |   14165 K  |   14164 K  |
|       from small pool |    3361    |    4370    |   17645 K  |   17641 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3608    |    4670    |   31810 K  |   31806 K  |
|       from large pool |     247    |     398    |   14165 K  |   14164 K  |
|       from small pool |    3361    |    4370    |   17645 K  |   17641 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     265    |     265    |       0    |
|       from large pool |     256    |     256    |     256    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     113    |    1235    |   16186 K  |   16186 K  |
|       from large pool |      91    |     181    |    8615 K  |    8615 K  |
|       from small pool |      22    |    1144    |    7570 K  |    7570 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB | 424327 GiB | 424327 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421332 GiB | 421332 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB | 424327 GiB | 424327 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421332 GiB | 421332 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB | 422415 GiB | 422414 GiB |
|       from large pool |  16640 KiB |   8607 MiB | 419422 GiB | 419422 GiB |
|       from small pool |      0 KiB |     16 MiB |   2992 GiB |   2992 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |   9114 MiB |   9114 MiB |   7228 MiB |
|       from large pool |   1872 MiB |   9096 MiB |   9096 MiB |   7224 MiB |
|       from small pool |     14 MiB |     18 MiB |     18 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 494347 KiB |  74125 GiB |  74125 GiB |
|       from large pool |  24320 KiB | 491072 KiB |  71088 GiB |  71088 GiB |
|       from small pool |      0 KiB |  13085 KiB |   3036 GiB |   3036 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4670    |   31810 K  |   31810 K  |
|       from large pool |       2    |     398    |   14165 K  |   14165 K  |
|       from small pool |       0    |    4370    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4670    |   31810 K  |   31810 K  |
|       from large pool |       2    |     398    |   14165 K  |   14165 K  |
|       from small pool |       0    |    4370    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      97    |     265    |     265    |     168    |
|       from large pool |      90    |     256    |     256    |     166    |
|       from small pool |       7    |       9    |       9    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1235    |   16187 K  |   16187 K  |
|       from large pool |       3    |     181    |    8615 K  |    8615 K  |
|       from small pool |       0    |    1144    |    7571 K  |    7571 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB | 424327 GiB | 424327 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421332 GiB | 421332 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB | 424327 GiB | 424327 GiB |
|       from large pool |  16640 KiB |   8630 MiB | 421332 GiB | 421332 GiB |
|       from small pool |      0 KiB |     16 MiB |   2995 GiB |   2995 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB | 422415 GiB | 422414 GiB |
|       from large pool |  16640 KiB |   8607 MiB | 419422 GiB | 419422 GiB |
|       from small pool |      0 KiB |     16 MiB |   2992 GiB |   2992 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |   9114 MiB |   9114 MiB |   7228 MiB |
|       from large pool |   1872 MiB |   9096 MiB |   9096 MiB |   7224 MiB |
|       from small pool |     14 MiB |     18 MiB |     18 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 494347 KiB |  74125 GiB |  74125 GiB |
|       from large pool |  24320 KiB | 491072 KiB |  71088 GiB |  71088 GiB |
|       from small pool |      0 KiB |  13085 KiB |   3036 GiB |   3036 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4670    |   31810 K  |   31810 K  |
|       from large pool |       2    |     398    |   14165 K  |   14165 K  |
|       from small pool |       0    |    4370    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4670    |   31810 K  |   31810 K  |
|       from large pool |       2    |     398    |   14165 K  |   14165 K  |
|       from small pool |       0    |    4370    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      97    |     265    |     265    |     168    |
|       from large pool |      90    |     256    |     256    |     166    |
|       from small pool |       7    |       9    |       9    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1235    |   16187 K  |   16187 K  |
|       from large pool |       3    |     181    |    8615 K  |    8615 K  |
|       from small pool |       0    |    1144    |    7571 K  |    7571 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139

 Experiment start at: 2024-07-29 10:54:41.368456
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5604131, 'precision': 0.47764152, 'recall': 0.53139365, 'specificity': 0.9580654, 'f1': 0.47106138, 'auroc': 0.9213192}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   274     0     92    12   0   0    85     9     5   0    6
1     0  1214     14    21   0   0     0    79     4   0    0
2    20     1    234     3   1   0     1    18    13   0   21
3     0     0      5  8046   0   0     3   206   178   0    1
4     2     0    489     2   0   0     2     4    18   0   22
5    18     0      9   273   0   0     3     9    17   0  192
6    52    19     54    24   0   0  1737     8     8   0    6
7     3     6     62   411   0   0     2  6689    88   0    0
8     3     1    316   170   0   0     3    66  2736   0    0
9    61     0     93    52   0   0     2    20    26   0  238
10   28     6  12647    13   0   0    21    27    36   0   16
---- Validation: 
scalar performance:
{'acc': 0.56067944, 'precision': 0.4782605, 'recall': 0.5314075, 'specificity': 0.9580709, 'f1': 0.47199333, 'auroc': 0.920486}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   274     0     88    12   0   0    80    11     6   0   12
1     0  1212     18    18   0   0     0    76     8   0    0
2    15     1    232     6   0   0     3    16    10   0   29
3     2     1      2  8043   0   0     5   204   183   0    0
4     2     0    490     2   0   0     1     7    21   0   16
5    21     0     11   279   0   0     4     8    19   0  179
6    49    22     40    33   0   0  1740    10     7   0    7
7     2     4     63   423   1   0     4  6684    83   0    1
8     0     0    290   170   0   0     3    67  2765   0    1
9    59     0     91    63   0   0     2    14    23   0  241
10   19    15  12667    14   1   0    20    21    28   0   11
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44210452, 'precision': 0.3819804, 'recall': 0.38420683, 'specificity': 0.9450305, 'f1': 0.36293453, 'auroc': 0.7657112}
confusion matrix:
     0     1     2    3   4   5     6     7     8   9    10
0   711     2    35   81   0   0   236    56    19   0   30
1    13  1058    70   53   0   0     1   284    19   0    1
2    32     0   580   34   0   0    12    16   113   0  228
3     0     0     0    0   0   0     0     0     0   0    0
4     1     0  1604    0   0   0     2     1    11   0   14
5    22     0     0  228   0   0    33    12    15   0  282
6     8    47   427  465   0   0  1721     7    76   0  316
7     4     0     2   76   0   0     2  1073     4   0    3
8     5     0    67  115   0   0     2     1  1176   0    4
9    82     1   249  179   0   0    29    40   137   0  420
10    0     0  1645    0   0   0     0     0     1   0    0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 12:26:39.354180,epoch time: 1:31:57.985724,used: 1:31:57.985724,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.57280076, 'precision': 0.46303722, 'recall': 0.5320147, 'specificity': 0.95941913, 'f1': 0.47150746, 'auroc': 0.9277883}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   350     0     43     4   0   0    45    34     7   0    0
1     0  1251      1    14   0   0     4    60     2   0    0
2    59     0    149     3   0   0     1    88    11   0    1
3     2     0      0  8140   0   0     9   236    49   0    0
4    24     5    440     2   0   0     2    31    31   0    4
5    96     1      6   217   0   0     2    45     6   0  148
6    21     2     15     3   0   1  1843     9     9   0    4
7     1     7      7   254   0   0     1  6970    24   0    0
8     2     9     70   314   0   0     4   195  2700   0    1
9   255     1     36    32   0   0     0    93    12   0   64
10   54    11  12562    15   0   1    18    71    56   0    6
---- Validation: 
scalar performance:
{'acc': 0.5720476, 'precision': 0.4647807, 'recall': 0.52989453, 'specificity': 0.9593357, 'f1': 0.47169226, 'auroc': 0.9292747}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   361     0     38     8   0   0    43    26     7   0    0
1     0  1238      1    13   0   0     2    77     1   0    0
2    56     1    141     4   0   0     1    94    10   0    5
3     0     3      0  8139   0   0    10   222    66   0    0
4    19     2    446     3   0   0     4    22    41   0    2
5    87     1     10   221   0   0     1    48     6   0  147
6    24     3     18     8   0   0  1838     7     9   0    1
7     0     9      7   236   0   0     5  6993    15   0    0
8     1     4     69   349   0   1     6   198  2667   0    1
9   260     0     48    37   0   0     0    78     5   0   65
10   53    11  12561    17   0   0    22    68    55   0    9
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53235847, 'precision': 0.3603871, 'recall': 0.42354906, 'specificity': 0.9540583, 'f1': 0.36689377, 'auroc': 0.80975395}
confusion matrix:
     0     1     2    3   4   5     6     7     8   9   10
0   844     4    13   25   0   2   133   144     5   0   0
1     0  1105     6   31   0   0     1   345    10   0   1
2   169     3   410   19   0   1     3    86   308   0  16
3     0     0     0    0   0   0     0     0     0   0   0
4     4     3  1594    0   0   0     1     5    26   0   0
5   202     0     0  206   0   2     3    65    23   0  91
6     2     3    43   59   0   2  2927     6    23   0   2
7     1     1     1   41   0   0     0  1120     0   0   0
8     1     0     6  132   0   1     3    25  1201   0   1
9   382     3   137  118   0   3     1   226   221   0  46
10    0     2  1642    0   0   0     0     1     1   0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 13:39:56.585044,epoch time: 1:13:17.230864,used: 2:45:15.216588,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5755565, 'precision': 0.5110094, 'recall': 0.55098665, 'specificity': 0.9594983, 'f1': 0.49614316, 'auroc': 0.9420554}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   356     0     86     8   0   0    21     5     1   0    6
1     0  1238      4     8   0   0     1    78     2   0    1
2    30     2    197     2   0   0     1    36     4   0   40
3     1     0      2  7995   0   0     1   335   102   0    3
4     2     2    491     3   0   0     1     3    25   0   11
5    12     1      3   254   0   1     5    27    12   0  206
6     9    12     19     5   0   0  1856     1     2   0    3
7     2     6     23   237   0   0     2  6952    37   0    4
8     0     1    120   135   0   1     0   129  2909   0    1
9    70     0     55    30   0   4     2    68     6   0  258
10    5    23  12682     7   0   0    14    12    41   0    8
---- Validation: 
scalar performance:
{'acc': 0.5756319, 'precision': 0.49756396, 'recall': 0.554747, 'specificity': 0.9595071, 'f1': 0.49730235, 'auroc': 0.9413829}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   363     7     74     4   0   0    20     8     5   0    2
1     0  1241      1    12   0   0     0    75     3   0    0
2    26     1    206     1   0   0     1    38     4   0   35
3     2     1      2  8000   0   0     1   330   102   0    2
4     4     4    492     1   0   1     0     3    21   0   13
5    11     0      5   244   0   0     3    25    13   0  220
6     8     8     12     5   0   3  1861     2     6   0    3
7     0     8     30   249   0   0     1  6942    32   0    3
8     0     0    120   140   0   0     2   132  2898   0    4
9    76     0     55    30   0   3     5    64    10   0  250
10    1    16  12713     9   0   0     7    15    26   0    9
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5488001, 'precision': 0.38894022, 'recall': 0.44065517, 'specificity': 0.9555595, 'f1': 0.39852822, 'auroc': 0.8282015}
confusion matrix:
     0     1     2    3   4   5     6    7     8   9    10
0   884     6    23   16   0  11   150   57    16   0    7
1     6  1261     6   28   0   0     0  194     4   0    0
2    25    21   563   12   0   1     2   43   203   0  145
3     0     0     0    0   0   0     0    0     0   0    0
4     1     5  1610    0   0   0     1    1    13   0    2
5    38     1     2  246   0   2     4   42    26   0  231
6     0    63    27   30   0   2  2930    4    11   0    0
7     4     2     2  157   0   0     4  993     1   0    1
8     2     0     7  127   0   4     1   16  1211   0    2
9   134    27   167  112   0   6     9  145   159   0  378
10    0     1  1644    0   0   0     0    0     1   0    0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 14:46:10.002349,epoch time: 1:06:13.417305,used: 3:51:28.633893,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5812554, 'precision': 0.5224087, 'recall': 0.5520824, 'specificity': 0.96028805, 'f1': 0.48887894, 'auroc': 0.94531685}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   415     2     36     8   0   0    10     2     9   0    1
1     0  1226      6    16   0   0     0    80     4   0    0
2    37     1    155     3   0   0     2    88    20   0    6
3     0     1      0  8236   0   0     1   109    89   0    1
4    10     2    433     2   0   1     2    16    67   0    6
5    27     2      7   231   0   1    10    73    16   0  154
6    15     6     16     7   0   0  1853     2     8   0    1
7     1    20     16   316   0   0     1  6854    54   0    0
8     4     0     44   199   0   0     1    73  2975   0    0
9   205     1     30    35   0   0     7   123    11   0   81
10   37    10  12534    10   0   0    13    35   144   0   10
---- Validation: 
scalar performance:
{'acc': 0.5811422, 'precision': 0.54463834, 'recall': 0.5522556, 'specificity': 0.9602833, 'f1': 0.4894363, 'auroc': 0.94454074}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   416     2     33     5   0   0    13     2    11   0    1
1     0  1208      7    18   0   0     1    92     6   0    0
2    41     2    158     3   0   0     1    80    23   0    4
3     1     0      0  8234   0   0     2   102   101   0    0
4    10     0    435     2   0   1     5    17    66   0    3
5    33     1      4   240   0   3     9    67    15   0  149
6    19     7     13     9   0   0  1848     1     8   0    3
7     5    14     11   314   0   0     1  6875    45   0    0
8     2     0     47   192   0   0     2    75  2978   0    0
9   190     0     36    29   0   0    10   132    11   0   85
10   30     6  12555    14   0   0    12    35   138   0    6
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5453719, 'precision': 0.35507697, 'recall': 0.43086007, 'specificity': 0.9554497, 'f1': 0.38103682, 'auroc': 0.82145035}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9    10
0   1088     1     0   14   0   0    57    7     3   0    0
1     11  1328    18   42   0   0     2   92     4   0    2
2    235    30   341   20   0   0    12   52   297   0   28
3      0     0     0    0   0   0     0    0     0   0    0
4      5     2  1604    1   0   0     1    0    19   0    1
5    134     5     0  167   0   0    12   91    14   0  169
6      9    14    27    5   0   0  2986    1    23   0    2
7      8     0     1  250   0   0     1  900     1   0    3
8     15     0     2  191   0   0     8    2  1152   0    0
9    501    39    49  136   0   3    23  165   165   0   56
10     0     1  1644    0   0   0     0    0     1   0    0
better model found
persisted
after epoch: 4,now: 2024-07-29 15:53:50.562581,epoch time: 1:07:40.560232,used: 4:59:09.194125,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.58548266, 'precision': 0.5398283, 'recall': 0.582965, 'specificity': 0.9611807, 'f1': 0.49537617, 'auroc': 0.96317947}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   390     1     80     1   0   0     0     7     4   0   0
1     0  1290      4     4   0   0     0    29     5   0   0
2    22     0    251     0   0   0     1    17    19   0   2
3     4     2      1  7901   0   1     1   287   240   0   0
4     7     0    488     1   0   0     2     4    34   0   3
5    41     0      8   259   0   4     8   119    51   0  31
6    27     4     31     4   0   0  1831     7     4   0   0
7     1    15     25    65   0   0     1  7067    89   0   0
8     1     0     63    30   0   0     0    52  3149   0   1
9   210     0    111    20   0   1     5   103    18   0  25
10   10     0  12732     4   0   0     4    12    30   0   0
---- Validation: 
scalar performance:
{'acc': 0.58486027, 'precision': 0.47829938, 'recall': 0.5839001, 'specificity': 0.96110964, 'f1': 0.49349087, 'auroc': 0.9631496}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   392     0     79     0   0   0     5     3     4   0   0
1     0  1285      4     3   0   0     0    33     7   0   0
2    24     0    257     0   0   0     1    11    19   0   0
3     4     3      2  7880   0   0     2   308   241   0   0
4     6     0    490     1   0   0     0     6    34   0   2
5    41     0     11   270   0   0     8   114    43   0  34
6    30     5     29     1   0   0  1832    10     1   0   0
7     1    22     24    64   0   0     1  7067    86   0   0
8     1     0     53    37   0   0     0    53  3152   0   0
9   208     0    108    25   0   1     7   113    12   0  19
10    9     1  12737     5   0   0     4     8    32   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5776254, 'precision': 0.39185584, 'recall': 0.46817836, 'specificity': 0.9584113, 'f1': 0.39806342, 'auroc': 0.8356403}
confusion matrix:
      0     1     2   3   4   5     6     7     8   9   10
0   1093     0    12   1   0   0    20     9    35   0   0
1     13  1287    34  23   0   1     0   111    30   0   0
2     84     0   496   0   0   0     2    22   407   0   4
3      0     0     0   0   0   0     0     0     0   0   0
4      1     0  1591   0   0   0     1     1    39   0   0
5    106     0    17  91   0   3    11   255    39   0  70
6      7     5    49   1   0   0  2974     2    29   0   0
7     20     0     5  43   0   0     0  1082    14   0   0
8      9     0     2  25   0   1     2    10  1321   0   0
9    319     4   278  19   0   5     8   115   374   0  15
10     0     0  1644   0   0   0     0     0     2   0   0
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 16:53:04.739789,epoch time: 0:59:14.177208,used: 5:58:23.371333,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.584466, 'precision': 0.55896425, 'recall': 0.5652491, 'specificity': 0.96075094, 'f1': 0.5281575, 'auroc': 0.95188427}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   426     1     23     6   0    0    12    10     3   0   2
1     0  1280      1    11   0    0     1    37     2   0   0
2    40     0    111     0   0    2     4   119    12   0  24
3     1     0      0  8213   0    2     2   139    80   0   0
4    15     3    402     1   0    1     5    36    31   0  44
5     6     0      1     7   0  133    33     8   313   0  20
6    13     0     11     4   0    1  1870     1     5   0   3
7     3     8      8   261   0    0     1  6962    19   0   1
8     2     0     38   320   0    1     3   134  2791   0   6
9    70     0      8     4   0   88    60   178    30   0  55
10   34    18  12568     5   0    0    16    40    54   0  59
---- Validation: 
scalar performance:
{'acc': 0.5858767, 'precision': 0.5629737, 'recall': 0.5652611, 'specificity': 0.96091074, 'f1': 0.5269059, 'auroc': 0.95098484}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   434     1     27     3   0    0     9     7     0   0   2
1     0  1271      1     9   0    0     1    45     5   0   0
2    32     0    111     1   0    2     9   128     8   0  21
3     1     0      0  8225   0    3     3   120    88   0   0
4    16     0    403     3   0    2     5    31    28   0  51
5     9     0      2     8   0  124    38    14   304   0  22
6     9     2      9     5   0    0  1866     8     6   0   3
7     2     6      7   237   0    0     1  6999    13   0   0
8     4     1     44   310   0    3     2   131  2801   0   0
9    86     0     11     2   0   76    63   168    34   0  53
10   38    13  12536     6   0    0    25    43    63   0  72
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5362765, 'precision': 0.40539682, 'recall': 0.42726773, 'specificity': 0.9540678, 'f1': 0.39131105, 'auroc': 0.83384323}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9    10
0   1108     0     0    2   0    0    50    9     1   0    0
1     23  1222     8   41   0    0    10  186     9   0    0
2    115     9   198   15   0    0    32  165   350   0  131
3      0     0     0    0   0    0     0    0     0   0    0
4      5     4  1518    0   0    0     6    4    78   0   18
5     51     1     0   17   0  100   103   58   161   0  101
6      8     5     1   18   0    1  3019    1    13   0    1
7     66     0     2  167   0    0    27  901     0   0    1
8     17     2     2  197   0    2    16   11  1117   0    6
9    205     7    38   85   0   37    95  309   227   0  134
10     0     1  1640    0   0    0     3    0     2   0    0
better model found
persisted
after epoch: 6,now: 2024-07-29 17:52:10.348157,epoch time: 0:59:05.608368,used: 6:57:28.979701,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.58872, 'precision': 0.5908247, 'recall': 0.611459, 'specificity': 0.96134317, 'f1': 0.5443353, 'auroc': 0.95551574}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   446     0     23     4   0    0     1     2     2   0   5
1     1  1262      3    18   0    0     0    42     6   0   0
2    79     0    193     0   0    1     3    25     5   0   6
3     3     0      0  8333   0    4     5    51    39   0   2
4    20     1    440     1   0    1     1    16    18   0  41
5    16     0      1    25   0  245    58    33   135   0   8
6    42     2     10     1   0    0  1844     6     2   0   1
7    20     8     36   456   0    0     1  6697    43   0   3
8     6     0     59   242   0    3     8    60  2916   0   1
9   175     0     25     2   0   34    57   179     3   0  17
10   87     2  12577    11   0    0     3    14    31   0  68
---- Validation: 
scalar performance:
{'acc': 0.5886318, 'precision': 0.5898863, 'recall': 0.61066914, 'specificity': 0.96134436, 'f1': 0.5453577, 'auroc': 0.9556814}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   443     0     24     4   0    0     4     2     3   0   3
1     1  1259      3    14   0    0     0    48     6   0   1
2    83     0    186     1   0    1     4    20     7   0  10
3     3     0      0  8339   0    5     7    48    37   0   1
4    17     1    446     2   0    0     1    22    20   0  30
5    12     0      2    21   0  255    48    45   136   0   2
6    34     2      7     5   0    0  1846     5     3   0   6
7    22     5     32   468   0    0     2  6693    41   0   2
8    11     0     56   237   0    6     3    53  2927   0   3
9   183     0     23     4   0   42    53   174     2   0  12
10   75     1  12600    11   0    0     7    22    22   0  58
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53872526, 'precision': 0.42867273, 'recall': 0.43625554, 'specificity': 0.9547514, 'f1': 0.40249678, 'auroc': 0.8225339}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9   10
0   1121     0     5   20   0    0     4    7    13   0   0
1     24  1166    22   76   0    0     5  188    14   0   4
2    115     1   368   32   0    3    12  141   263   0  80
3      0     0     0    0   0    0     0    0     0   0   0
4      4     0  1593    0   0    0     1    2    22   0  11
5     81     1     0  109   0  102    95   77    47   0  80
6     10     4    12   60   0    0  2956    3    19   0   3
7     14     0     2  263   0    0     1  881     1   0   2
8      6     0     3  241   0    0     4    9  1106   0   1
9    252     2    98  135   0   25   105  291   161   0  68
10     0     0  1643    0   0    0     0    0     3   0   0
better model found
persisted
after epoch: 7,now: 2024-07-29 18:50:38.162246,epoch time: 0:58:27.814089,used: 7:55:56.793790,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.59824485, 'precision': 0.6099559, 'recall': 0.62404954, 'specificity': 0.9622539, 'f1': 0.567144, 'auroc': 0.9716523}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   414     0     39     2   0    0     5     9     1   0  13
1     0  1283      2     9   0    0     0    35     3   0   0
2    11     0    234     0   0    0     1    52     0   0  14
3     0     0      1  8270   0    2     1   109    55   0   0
4     2     0    443     0   0    1     2    11     6   0  74
5     3     0      3    18   0  242    41    51   141   0  22
6    10     1     11     3   0    0  1876     2     1   0   4
7     0     7     11   199   0    0     1  7031    14   0   1
8     2     1     82   152   0    1     1   111  2942   0   2
9    60     0     46     3   0   39    35   277     1   0  32
10    7     5  12669     6   0    0     7    13    17   0  68
---- Validation: 
scalar performance:
{'acc': 0.59836835, 'precision': 0.60590935, 'recall': 0.6219313, 'specificity': 0.96229315, 'f1': 0.5648307, 'auroc': 0.9721195}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   410     0     41     0   0    0     7    11     1   0  13
1     0  1287      2     9   0    0     1    31     2   0   0
2    11     0    234     1   0    0     3    51     1   0  11
3     3     0      0  8285   0    0     1    99    52   0   0
4     4     1    442     0   0    1     2    12     9   0  68
5     3     0      3     6   0  229    47    58   157   0  18
6    12     3     11     2   0    0  1874     1     2   0   3
7     0     7     14   206   0    0     1  7020    17   0   0
8     0     0     74   152   0    1     1    87  2973   0   8
9    56     0     54     5   0   44    29   268     0   0  37
10    6     3  12694     7   0    0     5    11    12   0  58
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.570629, 'precision': 0.43984312, 'recall': 0.47340313, 'specificity': 0.95766807, 'f1': 0.42874765, 'auroc': 0.84269494}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9   10
0   1092     1     3    2   0    0    34    35     2   0   1
1      4  1267    18   33   0    0     1   172     3   0   1
2     38     1   498   15   0    5    22   161   198   0  77
3      0     0     0    0   0    0     0     0     0   0   0
4      1     0  1609    1   0    0     1     2    17   0   2
5     37     0     0   59   0  137   115   107    97   0  40
6      1     1    15   37   0    1  2973     3    34   0   2
7      1     0     3   77   0    0     1  1082     0   0   0
8      2     0     4  231   0    0     3    23  1106   0   1
9    127     2   161   92   0   45   108   448   125   0  29
10     0     0  1643    0   0    0     0     0     2   0   1
better model found
persisted
after epoch: 8,now: 2024-07-29 19:41:12.329162,epoch time: 0:50:34.166916,used: 8:46:30.960706,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.5986729, 'precision': 0.59678435, 'recall': 0.6056161, 'specificity': 0.9621602, 'f1': 0.5574008, 'auroc': 0.9643335}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   453     0     21     1   0    0     1     3     0   0    4
1     1  1290      0     4   0    0     1    31     3   0    2
2    38     0    162     0   0    0     3    68     2   0   39
3     5     0      0  8188   0    0     3   115   125   0    3
4    10     0    275     0   0    0     0    14    11   0  228
5     9     0      1     7   0  199   111    65   116   0   12
6    15     1      7     0   0    0  1874     2     1   0    7
7     5     6     10   123   0    0     1  7091    24   0    3
8    12     1    112    60   0    0     3    70  3021   0   17
9    71     0     18     3   0   13    33   326     1   0   28
10   47     2  12621     6   0    0     7     9     3   0   98
---- Validation: 
scalar performance:
{'acc': 0.5979671, 'precision': 0.5972473, 'recall': 0.6041748, 'specificity': 0.96205556, 'f1': 0.55902547, 'auroc': 0.9643857}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   450     0     20     0   0    0     2     6     0   0    5
1     1  1293      0     5   0    0     2    27     3   0    1
2    29     0    153     0   0    0     3    76     2   0   49
3     8     0      0  8182   0    1     5   118   122   0    4
4     9     0    267     2   0    0     2    15    11   0  233
5    11     0      1     5   0  210   102    65   116   0   11
6    23     1      6     0   0    0  1870     2     0   0    6
7    10     4     12   146   0    0     3  7056    32   0    2
8     7     0    102    57   0    0     4    76  3036   0   14
9    72     0     15     0   0   12    39   319     2   0   34
10   36     4  12623     7   0    0     7    10     4   0  105
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5914084, 'precision': 0.46218193, 'recall': 0.49420273, 'specificity': 0.95948267, 'f1': 0.43575555, 'auroc': 0.8487737}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9    10
0   1139     0     1   4   0    0    19     6     1   0    0
1     18  1251     4  19   0    0    13   187     1   0    6
2     73     2   607   5   0    1     8   125    55   0  139
3      0     0     0   0   0    0     0     0     0   0    0
4      2     0  1602   0   0    0     1     0     2   0   26
5     46     0     2  23   0  102   150   181    34   0   54
6     22     9    32   0   0    0  2963     3     8   0   30
7      0     0     3  26   0    0     0  1135     0   0    0
8      7     0    16  48   0    3     5    34  1255   0    2
9    218     6   188  16   0   10    91   523    53   0   32
10     0     0  1645   0   0    0     0     0     0   0    1
new oracle model saved
early stop counter: 1
val acc:0.5979670882225037, best validation acc: 0.5983683466911316, corresponding to test acc:                         0.5706290006637573 / 0.591408371925354
after epoch: 9,now: 2024-07-29 20:41:19.892891,epoch time: 1:00:07.563729,used: 9:46:38.524435,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.5930008, 'precision': 0.62257373, 'recall': 0.6360334, 'specificity': 0.9613247, 'f1': 0.58070457, 'auroc': 0.9750928}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   402     1     27     0   0    0     9    12     2   0   30
1     0  1316      1     0   0    0     0    12     3   0    0
2     0     1    216     0   0    1     1    42     5   0   46
3     2     9      8  7504   0   12     6   355   539   0    3
4     1     2    134     0   0    0     2    13    18   0  369
5     0     0      1     0   0  348    61    46    58   0    7
6     7     4      6     0   0    1  1875     5     1   0    9
7     0    63     77    29   0    0     1  6906   184   0    3
8     1     3     69     2   0    1     2    31  3159   0   27
9     0     0     41     0   0   34    59   319     5   0   35
10    3     9  12292     2   0    0    11     8    29   0  438
---- Validation: 
scalar performance:
{'acc': 0.5920824, 'precision': 0.618049, 'recall': 0.63600844, 'specificity': 0.9612777, 'f1': 0.57989985, 'auroc': 0.9733143}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   402     2     22     0   0    0    10    13     3   0   31
1     0  1316      1     1   0    0     0    11     3   0    0
2     1     1    212     0   0    0     3    42     5   0   48
3     4    12      5  7502   0   14     5   344   551   0    3
4     2     2    152     0   0    1     4     6    18   0  354
5     0     0      3     1   0  356    52    42    57   0   10
6     6     5      4     1   0    2  1876     3     4   0    7
7     0    74     94    25   0    0     1  6909   160   0    2
8     0     1     70     7   0    3     1    27  3159   0   28
9     1     0     46     0   0   40    61   304     4   0   37
10    5     7  12337     3   0    1    12     4    24   0  403
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59070873, 'precision': 0.4758936, 'recall': 0.5018189, 'specificity': 0.9589955, 'f1': 0.47069243, 'auroc': 0.85243976}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9    10
0   1010    12     4   2   0    1    71    33    27   0   10
1      4  1398    16   6   0    1     2    64     5   0    3
2     10     3   386   0   0    4     9    96   111   0  396
3      0     0     0   0   0    0     0     0     0   0    0
4      0     3   946   0   0    0     1     0    11   0  672
5      6     0     2   4   0  247   125   130    36   0   42
6      6    10    49   1   0    0  2824     5    92   0   80
7      2     1    14  22   0    0     1  1116     5   0    3
8      1     1    21   6   0    5     7    27  1298   0    4
9     17     8   320   1   0   39   102   505    84   0   61
10     0     1  1479   0   0    0     0     0     2   0  164
early stop counter: 2
val acc:0.5920823812484741, best validation acc: 0.5983683466911316, corresponding to test acc:                         0.5706290006637573 / 0.591408371925354
after epoch: 10,now: 2024-07-29 21:42:26.945245,epoch time: 1:01:07.052354,used: 10:47:45.576789,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 10:47:45.576789 at 2024-07-29 21:42:26.945245
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.570629, 'precision': 0.43984312, 'recall': 0.47340313, 'specificity': 0.95766807, 'f1': 0.42874765, 'auroc': 0.84269494}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9   10
0   1092     1     3    2   0    0    34    35     2   0   1
1      4  1267    18   33   0    0     1   172     3   0   1
2     38     1   498   15   0    5    22   161   198   0  77
3      0     0     0    0   0    0     0     0     0   0   0
4      1     0  1609    1   0    0     1     2    17   0   2
5     37     0     0   59   0  137   115   107    97   0  40
6      1     1    15   37   0    1  2973     3    34   0   2
7      1     0     3   77   0    0     1  1082     0   0   0
8      2     0     4  231   0    0     3    23  1106   0   1
9    127     2   161   92   0   45   108   448   125   0  29
10     0     0  1643    0   0    0     0     0     2   0   1
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5914084, 'precision': 0.46218193, 'recall': 0.49420273, 'specificity': 0.95948267, 'f1': 0.43575555, 'auroc': 0.8487737}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9    10
0   1139     0     1   4   0    0    19     6     1   0    0
1     18  1251     4  19   0    0    13   187     1   0    6
2     73     2   607   5   0    1     8   125    55   0  139
3      0     0     0   0   0    0     0     0     0   0    0
4      2     0  1602   0   0    0     1     0     2   0   26
5     46     0     2  23   0  102   150   181    34   0   54
6     22     9    32   0   0    0  2963     3     8   0   30
7      0     0     3  26   0    0     0  1135     0   0    0
8      7     0    16  48   0    3     5    34  1255   0    2
9    218     6   188  16   0   10    91   523    53   0   32
10     0     0  1645   0   0    0     0     0     0   0    1
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_10_54_40_seed_1_23164139_instance_wise_predictions.txt
accuracy from prediction file 0.5706289792205975
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1658 MiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |   1650 MiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      8 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1658 MiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |   1650 MiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      8 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1655 MiB |   8622 MiB |    825 TiB |    825 TiB |
|       from large pool |   1647 MiB |   8607 MiB |    819 TiB |    819 TiB |
|       from small pool |      7 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9114 MiB |   9114 MiB |  16342 MiB |   7228 MiB |
|       from large pool |   9096 MiB |   9096 MiB |  16320 MiB |   7224 MiB |
|       from small pool |     18 MiB |     18 MiB |     22 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 237312 KiB | 494347 KiB | 148378 GiB | 148378 GiB |
|       from large pool | 227168 KiB | 491072 KiB | 142333 GiB | 142332 GiB |
|       from small pool |  10144 KiB |  13085 KiB |   6045 GiB |   6045 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3608    |    4670    |   63621 K  |   63617 K  |
|       from large pool |     247    |     398    |   28330 K  |   28329 K  |
|       from small pool |    3361    |    4370    |   35291 K  |   35287 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3608    |    4670    |   63621 K  |   63617 K  |
|       from large pool |     247    |     398    |   28330 K  |   28329 K  |
|       from small pool |    3361    |    4370    |   35291 K  |   35287 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     265    |     433    |     168    |
|       from large pool |     256    |     256    |     422    |     166    |
|       from small pool |       9    |       9    |      11    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     114    |    1238    |   32527 K  |   32527 K  |
|       from large pool |      91    |     181    |   17319 K  |   17319 K  |
|       from small pool |      23    |    1147    |   15208 K  |   15208 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8645 MiB |    828 TiB |    828 TiB |
|       from large pool |  16640 KiB |   8630 MiB |    822 TiB |    822 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8622 MiB |    825 TiB |    825 TiB |
|       from large pool |  16640 KiB |   8607 MiB |    819 TiB |    819 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1890 MiB |   9114 MiB |  16342 MiB |  14452 MiB |
|       from large pool |   1872 MiB |   9096 MiB |  16320 MiB |  14448 MiB |
|       from small pool |     18 MiB |     18 MiB |     22 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 494347 KiB | 148379 GiB | 148379 GiB |
|       from large pool |  24320 KiB | 491072 KiB | 142334 GiB | 142334 GiB |
|       from small pool |      0 KiB |  15676 KiB |   6045 GiB |   6045 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4670    |   63621 K  |   63621 K  |
|       from large pool |       2    |     398    |   28330 K  |   28330 K  |
|       from small pool |       0    |    4370    |   35291 K  |   35291 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4670    |   63621 K  |   63621 K  |
|       from large pool |       2    |     398    |   28330 K  |   28330 K  |
|       from small pool |       0    |    4370    |   35291 K  |   35291 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     265    |     433    |     334    |
|       from large pool |      90    |     256    |     422    |     332    |
|       from small pool |       9    |       9    |      11    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1238    |   32529 K  |   32529 K  |
|       from large pool |       3    |     181    |   17319 K  |   17319 K  |
|       from small pool |       0    |    1147    |   15209 K  |   15209 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 29 21:59:04 2024]
Finished job 0.
1 of 1 steps (100%) done
