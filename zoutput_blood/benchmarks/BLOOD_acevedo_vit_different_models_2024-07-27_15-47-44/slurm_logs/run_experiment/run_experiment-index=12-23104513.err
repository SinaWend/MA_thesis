Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 15:53:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/12.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=12
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513

 Experiment start at: 2024-07-27 16:14:25.487538
before training, model accuracy: 0.12012873589992523
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9323898, 'precision': 0.8452205, 'recall': 0.78704774, 'specificity': 0.9926499, 'f1': 0.80236185, 'auroc': 0.9949417}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   350     0    0     1    0    1    30     2     8    3     87
1     0  1269    0     7    0    1     2    43     4    0      6
2     5     3  135     1   80   10     1    10     7   51      9
3     2     3    0  7642    0   29     9   326   424    2      1
4     2     0   10     1  283    3     0     1    28    5    205
5     3     0    1    27    1  467     1     0     7   13      1
6    17     0    0     0    0    2  1847     3    11    1     27
7     1    28    0   123    3    1     4  6884   176    1     43
8     2     2    1    49   20    7     4    46  3084    1     79
9    14     1   21     1   11  229     2     6    17  184      7
10    3     0    2     6   21    2    16    12    27    0  12704
---- Validation: 
scalar performance:
{'acc': 0.9322991, 'precision': 0.841655, 'recall': 0.7889227, 'specificity': 0.99263453, 'f1': 0.80358803, 'auroc': 0.99502844}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   360     0    0     3    1    0    23     4     7    1     84
1     0  1265    0     7    0    0     0    46     7    0      7
2     7     2  133     1   71   12     1     7    12   50     16
3     2     2    0  7668    3   38     6   310   409    0      2
4     2     0    7     0  289    1     1     3    31    8    197
5     5     0    0    25    1  454     1     0    10   24      1
6    21     1    1     0    0    0  1849     3     7    0     26
7     1    24    2   141    4    0     6  6855   179    0     53
8     1     2    3    46   15    3     6    49  3094    0     77
9    10     1   30     3    6  225     1     3    11  196      7
10    8     0    0     6   33    1    10     9    38    0  12691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6851606, 'precision': 0.625874, 'recall': 0.59775305, 'specificity': 0.9683484, 'f1': 0.5600331, 'auroc': 0.8824335}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1010     2    0   10    0    4    93     9    20    2    20
1      2  1212    0   32    1    0     3   195    19    0    35
2     19     6  119   12  238   68     5    26   305   59   158
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    2    0  212    0     0     0    30    0  1388
5     32     0    0   71    1  459     1     0    12   15     1
6      0     2    0    1    5    0  2577     1   349    0   132
7      1     0    0   23    0    1     9  1113    10    1     6
8      5     0    0   72    2    4     8     2  1274    2     1
9     52    16   92  105   16  341    13    67   216  187    32
10     0     0    0    0   15    0     0     0     1    0  1630
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 17:09:41.669502,epoch time: 0:55:16.181964,used: 0:55:16.181964,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9520548, 'precision': 0.8783331, 'recall': 0.8449367, 'specificity': 0.99477416, 'f1': 0.85056734, 'auroc': 0.9973039}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     1    1     7    1    0    14     3     3    1     41
1     0  1291    0     9    0    0     0    29     1    0      1
2     4     0  247     1   24    3     0     7     3   17      6
3     0     2    1  7984    0   15     2   259   174    0      0
4     2     1   48     0  286    3     0     7    17    3    172
5     0     0    2    23    0  471     0     1     8   15      1
6    10     1    1     7    2    1  1854     7     3    2     20
7     1    40    1   108    1    0     1  7053    51    2      7
8     1     3    6    49   10    2     1    86  3094    1     41
9     2     0   94     9    0  160     1     7     6  211      3
10   13     0    5     5   26    2     7    22    31    0  12683
---- Validation: 
scalar performance:
{'acc': 0.9528688, 'precision': 0.8870172, 'recall': 0.85076505, 'specificity': 0.9948435, 'f1': 0.8569534, 'auroc': 0.9974451}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     1    0     5    1    1     9     4     1    5     38
1     0  1292    0    11    0    0     0    27     1    0      1
2     3     0  255     1   16    4     0     9     2   16      6
3     0     2    0  7981    0   18     1   272   166    0      0
4     3     1   35     1  300    1     2     4    19    2    171
5     0     0    2    19    0  475     0     0     7   17      1
6    10     1    2     4    1    1  1860     9     6    0     14
7     0    32    2   112    1    0     2  7060    47    0      9
8     0     3    5    46    7    3     1   102  3083    0     46
9     0     0   87     6    0  172     1     8     8  206      5
10   18     1    4     6   15    2     6    18    33    0  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6988036, 'precision': 0.6765323, 'recall': 0.60331666, 'specificity': 0.9699964, 'f1': 0.5740576, 'auroc': 0.88521475}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1041     3    0   28   0   12    34    16    18    8    10
1      3  1332    0   35   1    0     0   103     6    0    19
2     11     4  242   33  46   47     3    26   344   24   235
3      0     0    0    0   0    0     0     0     0    0     0
4      0     0    5    0  97    0     1     0    27    0  1503
5      5     0    0  137   0  421     0     0    22    5     2
6      1     2    1    1   2    0  2749     3   199    0   109
7      2     0    0   84   0    0     2  1065     7    0     4
8      0     0    0   94   0    1     3     2  1269    1     0
9     15    18  143  255   1  249     4    60   237  129    26
10     0     0    0    0   2    0     0     0     1    0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 17:59:56.794426,epoch time: 0:50:15.124924,used: 1:45:31.306888,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96066993, 'precision': 0.9066048, 'recall': 0.8693962, 'specificity': 0.99569637, 'f1': 0.886544, 'auroc': 0.99804795}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    1     3    1    0    20     3     5    2     32
1     0  1281    0    16    0    0     1    29     2    0      3
2     3     1  198     1   40    4     0     6     6   50      3
3     1     0    0  8213    0    5     4   152    62    0      0
4     2     1   17     1  372    1     1     3    31    6    104
5     0     0    0    43    0  428     0     0     6   43      1
6     3     0    1     0    0    0  1885     2     6    1     10
7     1    10    2   163    1    0     3  7033    44    1      5
8     1     0    2   122    2    4     6    77  3062    0     20
9     1     1   29    11    4   65     3     3     7  368      1
10    6     0    3     6   39    0    17    15    55    1  12650
---- Validation: 
scalar performance:
{'acc': 0.9589675, 'precision': 0.9019985, 'recall': 0.8631237, 'specificity': 0.9955112, 'f1': 0.88095784, 'auroc': 0.9980996}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     5    1    0    21     5     3    0     36
1     0  1286    0     9    0    0     1    32     2    0      2
2     3     1  198     1   46    2     1     8     6   43      3
3     2     1    0  8181    0   11     5   177    62    1      0
4     4     0   15     0  367    2     2     2    33    5    109
5     1     0    0    47    1  411     0     0     6   54      1
6     3     0    1     2    0    1  1888     1     4    0      8
7     0    13    0   159    1    0     3  7046    34    1      8
8     1     1    1   135    4    2     1    87  3052    1     11
9     0     1   33    10    0   76     4     4     4  359      2
10    9     0    2     7   35    0    20    17    54    1  12651
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7335759, 'precision': 0.66114974, 'recall': 0.63425857, 'specificity': 0.9732334, 'f1': 0.61418676, 'auroc': 0.88656366}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1059     1    0   6    0    6    55    15    14    8     6
1      0  1250    0  35    2    0     1   180    10    0    21
2      7     0  163  14  280   25    14    32   278   67   135
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0  246    0     1     0    28    0  1356
5      8     0    2  64    3  459     1     0     4   49     2
6      0     0    1   3    3    0  2931     4    69    0    56
7      0     0    0  36    0    0     3  1119     2    1     3
8      0     0    0  99    0    2    12    10  1245    2     0
9     20     6  133  99   31  216    13    78   152  377    12
10     0     0    0   0    8    0     0     1     1    0  1636
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 18:49:53.768729,epoch time: 0:49:56.974303,used: 2:35:28.281191,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96120507, 'precision': 0.894258, 'recall': 0.8922876, 'specificity': 0.995869, 'f1': 0.8914577, 'auroc': 0.9984808}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    2     2    2    1    40     0     3    3     24
1     0  1300    0     9    0    0     1    17     2    0      3
2     1     0  242     0   25    4     2     1     3   34      0
3     1     1    2  8220    1   26     7    57   120    1      1
4     3     0   23     0  408    1     5     1     9    5     84
5     0     0    0    11    1  481     1     0     3   23      1
6     1     0    1     1    0    0  1893     1     3    1      6
7     1    18   10   222    6    0    12  6880   104    1     10
8     0     2    9    70   23    9     7    24  3106    1     45
9     0     0   31     2    2  109     1     2     1  344      1
10    5     0    4     7   85    1    32     2    10    0  12646
---- Validation: 
scalar performance:
{'acc': 0.9621239, 'precision': 0.8907649, 'recall': 0.88879824, 'specificity': 0.99596703, 'f1': 0.8878697, 'auroc': 0.99848413}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    0     1    3    0    42     1     1    6     28
1     0  1304    0     8    0    0     0    15     4    0      1
2     0     1  240     0   25    1     2     1     2   40      0
3     3     1    3  8246    0   24     7    56    99    1      0
4     4     0   21     0  409    1     5     1     7    8     83
5     0     0    0     8    1  482     0     0     4   25      1
6     4     0    1     0    0    0  1889     1     3    3      7
7     0    27   12   228    1    0     9  6867   102    0     19
8     1     0   10    57   22    9     1    21  3133    2     40
9     0     0   38     2    1  124     1     1     0  326      0
10    4     0    6     7   68    0    24     3    10    2  12672
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7211222, 'precision': 0.67664194, 'recall': 0.62690246, 'specificity': 0.97187746, 'f1': 0.62400395, 'auroc': 0.88849294}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   933     1    0    7    0    9   179     3     8   25     5
1     1  1286    0   34    2    1     1   138     8    1    27
2     3     0  312   13  212   18    21    19   192   98   127
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    7    0  326    0     1     0    11    0  1288
5     2     0    3   64    2  427     3     0     2   86     3
6     0     0    2    3    2    0  2741     3    82    0   234
7     0     0    1  114    0    0    23  1017     3    1     5
8     0     0    2  110    4    5    11     5  1228    4     1
9     5     3  159  112    4  225    23    47   130  408    21
10    0     0    0    0   16    0     1     0     0    0  1629
better model found
persisted
after epoch: 4,now: 2024-07-27 19:39:46.009075,epoch time: 0:49:52.240346,used: 3:25:20.521537,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9675995, 'precision': 0.92605203, 'recall': 0.8800646, 'specificity': 0.9963547, 'f1': 0.8985672, 'auroc': 0.99888706}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     2    1    0     2     1     0    0      4
1     0  1277    0     6    0    0     0    46     1    0      2
2     4     0  189     2   51    3     0    11     9   38      5
3     0     0    0  8347    0    2     0    50    35    0      0
4    10     0    5     0  347    0     0     2    17    0    158
5     0     0    0    40    1  451     0     0     4   24      1
6    22     0    0     3    1    0  1857     1     5    1     18
7     0     5    0   191    1    0     2  7043    18    0      5
8     1     0    0   109    4    0     0    62  3085    0     34
9     5     0   14    13    3   67     0     5     7  377      2
10   36     0    1     8    7    1     3     6    13    0  12719
---- Validation: 
scalar performance:
{'acc': 0.9677143, 'precision': 0.9263788, 'recall': 0.87830764, 'specificity': 0.99637085, 'f1': 0.8982546, 'auroc': 0.99885404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     3    0    0     1     1     0    0     11
1     0  1285    0     6    0    0     0    40     1    0      0
2     4     0  193     3   53    1     0     9     5   40      4
3     0     0    0  8357    0    3     0    51    29    0      0
4     8     0    3     1  350    1     0     1    24    0    151
5     1     0    0    46    0  443     1     0     3   26      1
6     9     0    0     7    0    0  1869     0     4    3     16
7     0     5    0   197    1    0     2  7031    23    0      6
8     2     0    1   108    3    0     0    70  3088    0     24
9     4     0   17    16    3   74     0     6     6  366      1
10   33     0    0     8    4    1     2     4    14    1  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68264186, 'precision': 0.64585197, 'recall': 0.59077126, 'specificity': 0.96835154, 'f1': 0.5801424, 'auroc': 0.88019085}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1129     0    0   11    0    3     4    10     2    8     3
1      2  1171    1   33    1    0     1   246     4    1    39
2     23     1  159   33  187   14     1    51   224   85   237
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    2    0  109    0     0     2    15    0  1502
5      6     0    0  121    1  327     0     0     5  130     2
6      9     0    0    6    3    0  2554     4   144    0   347
7      1     0    0  129    0    0     1  1024     2    1     6
8      1     0    1  163    0    0     4     6  1191    3     1
9     33     4   97  216    7  128     3    84    84  453    28
10     0     0    0    0    5    0     0     0     1    0  1640
better model found
persisted
after epoch: 5,now: 2024-07-27 20:29:42.821007,epoch time: 0:49:56.811932,used: 4:15:17.333469,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97444886, 'precision': 0.92702425, 'recall': 0.9262987, 'specificity': 0.9972299, 'f1': 0.9250589, 'auroc': 0.99929607}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    0    0     2     1     0    1     10
1     0  1307    1     3    0    1     0    19     1    0      0
2     0     0  266     0   11    0     0     1     2   31      1
3     5     1    2  8286    0    6     1    87    47    3      1
4     5     0   30     0  416    1     1     1     7    2     76
5     0     0    1     9    0  427     0     0     3   80      1
6    14     0    0     0    1    0  1872     0     2    4     13
7     9     8    3   124    1    0     1  7091    18    4      6
8     0     0    8    67    9    2     0    44  3133    7     24
9     0     0   22     2    0   19     0     0     1  449      0
10   23     1    3     7   22    0     4     6    20    0  12707
---- Validation: 
scalar performance:
{'acc': 0.9750435, 'precision': 0.92949593, 'recall': 0.9294402, 'specificity': 0.9973024, 'f1': 0.92780054, 'auroc': 0.99934494}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    0    0     1     0     1    1      5
1     0  1305    0     5    0    0     0    21     1    0      0
2     0     0  264     0   10    0     1     1     0   35      1
3     3     0    3  8274    0   10     3    87    55    4      1
4     6     1   25     0  423    2     0     1     5    4     72
5     1     0    1    16    0  424     0     0     4   74      1
6    13     0    0     1    2    0  1880     0     0    2     10
7     7    14    5   124    1    0     1  7085    17    4      7
8     1     1   10    52    7    0     0    41  3153    7     24
9     2     0   20     1    0   12     0     0     1  457      0
10   13     0    6     7   24    0     4     5    23    1  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7455398, 'precision': 0.69021976, 'recall': 0.6424464, 'specificity': 0.9744704, 'f1': 0.63752943, 'auroc': 0.8838153}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1132     0    0   4    1    0     6     8     5   11     3
1      6  1196    5  26    0    0     2   212     6   19    27
2     12     0  423  11  129   12     8    21   157   96   146
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0   10   0  217    0     1     0    23    0  1380
5     10     0   14  71    1  263     2     0     6  224     1
6      3     1    5   7    2    0  2841     4    76    0   128
7      3     0    9  40    0    0     4  1102     0    2     4
8      0     0   10  89    1    0    20    12  1221   16     1
9     21     2  239  76    3   69     3    25    52  624    23
10     0     0    0   0    8    0     0     0     1    0  1637
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 21:20:11.082353,epoch time: 0:50:28.261346,used: 5:05:45.594815,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9743418, 'precision': 0.9429641, 'recall': 0.92321324, 'specificity': 0.9971713, 'f1': 0.9310955, 'auroc': 0.99944395}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     1    0     1    1    0     0     1     0    0     17
1     0  1310    0     2    0    0     0    17     3    0      0
2     4     0  287     0    5    0     0     2     0   12      2
3     1     2    0  8155    1    4     0   121   154    1      0
4     3     0   22     0  388    1     0     2    13    0    110
5     2     0    1    20    0  437     0     0     5   55      1
6     8     0    0     2    1    0  1882     0     0    0     15
7     0     8    1    53    1    0     1  7130    59    1      8
8     0     0    1    25    2    0     0    35  3191    2     37
9     2     0   39     3    3   25     2     1     4  412      2
10    0     0    1     6    8    0     2     5     9    0  12763
---- Validation: 
scalar performance:
{'acc': 0.9758727, 'precision': 0.9473001, 'recall': 0.92640126, 'specificity': 0.9973253, 'f1': 0.9348688, 'auroc': 0.9994278}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    1     1    0    0     1     2     0    0     15
1     0  1309    0     0    0    0     0    21     1    0      1
2     0     0  280     0    7    2     0     1     2   17      3
3     1     2    1  8179    0    4     0   111   138    1      3
4     5     0   20     0  386    0     0     2    12    0    114
5     2     0    1    17    0  449     0     0     6   45      1
6     3     0    0     0    1    0  1888     2     0    0     14
7     0    11    1    52    1    0     1  7135    57    0      7
8     1     0    2    23    2    0     0    32  3201    1     34
9     2     0   35     3    2   18     1     1     3  426      2
10    4     0    3     7    5    0     1     4     4    1  12767
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71965295, 'precision': 0.68065536, 'recall': 0.627195, 'specificity': 0.9717884, 'f1': 0.6063091, 'auroc': 0.8840146}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1069     3    0    7   0    2    26    34    11    7    11
1      2  1266    1   19   0    1     1   173    10    3    23
2     10     0  370   13  28   26    24    27   263   61   193
3      0     0    0    0   0    0     0     0     0    0     0
4      2     0   16    0  45    0     1     0    17    0  1552
5     14     0    2  135   0  350     3     1    12   71     4
6      2     0    3    3   0    0  2702     3    58    0   296
7      0     0    2   25   0    0     0  1125     7    1     4
8      0     0    2   29   0    0     9     6  1319    2     3
9     20     3  138   94   2  166    11    62   220  397    24
10     0     0    0    0   2    0     0     0     1    0  1643
better model found
persisted
after epoch: 7,now: 2024-07-27 22:11:09.824172,epoch time: 0:50:58.741819,used: 5:56:44.336634,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97955906, 'precision': 0.9578526, 'recall': 0.9322845, 'specificity': 0.9976915, 'f1': 0.94239634, 'auroc': 0.99960625}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     9    2    1     7     6     0    4     17
1     0  1299    0     7    0    0     0    24     2    0      0
2     0     0  291     1    2    0     1     2     1   14      0
3     0     0    0  8395    0    1     0    32     9    0      0
4     1     0   35     0  384    0     0     3    17    3     96
5     0     0    1    13    0  455     0     0     2   48      1
6     3     0    1     4    0    0  1894     1     1    0      4
7     0     4    1   164    0    0     1  7079    10    1      3
8     0     0    1    79    1    0     1    25  3176    3     10
9     0     0   14     2    1   14     0     1     0  460      1
10    7     0    3     7    1    0     3     5    24    1  12742
---- Validation: 
scalar performance:
{'acc': 0.978708, 'precision': 0.9594947, 'recall': 0.93051964, 'specificity': 0.99758637, 'f1': 0.9420903, 'auroc': 0.9995801}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     5    2    0     8     3     0    3     23
1     0  1304    0     6    0    0     0    22     0    0      0
2     0     0  293     0    1    0     0     2     1   13      2
3     0     0    0  8397    0    1     0    26    16    0      0
4     4     0   24     2  388    1     0     2    14    3    101
5     0     0    0    16    0  433     0     0     3   68      1
6     1     0    0     1    1    0  1895     2     1    0      7
7     0     3    0   185    0    0     1  7046    24    1      5
8     0     0    0    76    0    0     0    27  3186    0      7
9     0     0   18     3    0    9     0     1     0  462      0
10    2     0    3     8    3    0     2     5    26    1  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6885189, 'precision': 0.6564399, 'recall': 0.57009995, 'specificity': 0.96881557, 'f1': 0.560696, 'auroc': 0.87152135}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   806     3    0   34   2    3   106   117    13   66    20
1     0  1266    0   29   0    0     2   172     8    4    18
2     2     0  174   48  79    7    26    26   370   87   196
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    8    0  68    0     2     2    50    0  1503
5     0     0    0  197   0  183     3     1     5  197     6
6     0     0    2    7   0    0  2872     3    65    0   118
7     0     0    1   57   0    0     2  1096     4    2     2
8     0     0    0  105   0    0    15     7  1238    4     1
9     3     3   68  249   8   54    15    69   148  496    24
10    0     0    0    0   1    0     0     0     3    0  1642
better model found
persisted
after epoch: 8,now: 2024-07-27 23:02:08.459801,epoch time: 0:50:58.635629,used: 6:47:42.972263,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9844553, 'precision': 0.9631748, 'recall': 0.9590373, 'specificity': 0.9983163, 'f1': 0.96091735, 'auroc': 0.9997654}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    2    0     0     0     0    1      6
1     0  1326    0     3    0    0     0     3     0    0      0
2     0     1  272     0   16    0     0     1     1   20      1
3     0     4    0  8352    0    1     0    40    37    1      1
4     5     0    1     0  499    0     0     1     5    1     27
5     0     0    0     8    0  487     0     0     4   21      1
6     3     2    0     0    2    0  1887     1     1    0     12
7     0    28    0   113    1    0     1  7079    38    0      4
8     0     1    1    27    7    0     1    13  3229    0     16
9     1     0   12     2    1   25     0     1     1  449      1
10    2     1    1     9   26    0     2     4     7    0  12741
---- Validation: 
scalar performance:
{'acc': 0.9832018, 'precision': 0.9579333, 'recall': 0.9537895, 'specificity': 0.99819255, 'f1': 0.9556656, 'auroc': 0.9997409}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    1    0     2     1     0    0     13
1     0  1328    0     1    0    0     0     2     1    0      0
2     2     1  270     0   20    0     0     1     1   16      1
3     0     2    0  8339    0    0     1    47    49    2      0
4     5     0    0     0  496    0     0     1     5    2     30
5     0     0    1     7    0  484     0     0     4   24      1
6     1     2    2     1    2    0  1883     2     1    2     12
7     0    27    0    97    1    0     2  7093    42    1      2
8     0     0    1    21    7    0     0    20  3225    1     21
9     1     0   14     1    2   30     0     0     4  440      1
10    4     1    0     7   33    1     3     0    13    0  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69481564, 'precision': 0.6666148, 'recall': 0.6065639, 'specificity': 0.9691468, 'f1': 0.5982934, 'auroc': 0.88130605}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1041     1    0    5    0    2    76    10     7   25     3
1      0  1387    0   16    2    0     1    78     5    0    10
2      7     5  159   15  199   11    46    29   337   71   136
3      0     0    0    0    0    0     0     0     0    0     0
4      0     1    1    0  351    0     2     1    36    0  1241
5      4     0    3  104    1  301     9     0    28  139     3
6      7     6    2    8    1    0  2259     3   151    0   630
7      0     2    1   57    0    0     4  1094     2    1     3
8      0     0    1   60    0    0    13     6  1286    3     1
9      6    19  107  124    9  106    41    68   218  422    17
10     0     1    0    0   13    0     0     0     1    0  1631
better model found
persisted
after epoch: 9,now: 2024-07-27 23:52:31.305101,epoch time: 0:50:22.845300,used: 7:38:05.817563,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98400044, 'precision': 0.96851814, 'recall': 0.9431575, 'specificity': 0.99819815, 'f1': 0.9538368, 'auroc': 0.9998008}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    4    0     1     1     0    2      7
1     0  1303    0    10    0    0     0    15     4    0      0
2     0     0  251     0    4    2     0     5     1   47      2
3     1     0    0  8345    0    8     0    39    43    1      0
4     1     0    5     0  427    0     0     0    10    6     90
5     0     0    0     8    0  479     0     0     0   32      1
6     3     0    0     0    0    0  1889     1     0    2     13
7     0     1    0    96    0    0     0  7127    29    2      8
8     0     0    1    21    0    0     2    14  3242    1     15
9     0     0    2     2    0    9     0     1     1  476      1
10    0     0    1     5    4    1     1     1    10    0  12771
---- Validation: 
scalar performance:
{'acc': 0.98419154, 'precision': 0.9685834, 'recall': 0.94024086, 'specificity': 0.9982111, 'f1': 0.9518682, 'auroc': 0.9997831}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    2    0     1     0     1    2     10
1     0  1304    0     7    0    0     0    18     3    0      0
2     0     0  253     0    1    1     0     1     0   54      2
3     0     0    0  8360    0    6     0    36    36    0      2
4     2     0    3     2  420    0     1     1    10    4     96
5     0     0    0     9    0  466     0     0     0   45      1
6     2     0    1     2    1    0  1879     0     1    3     19
7     0     1    0    76    0    0     2  7145    34    0      7
8     1     0    0    21    0    0     1    11  3240    2     20
9     0     0    4     1    0    9     0     0     0  479      0
10    0     0    0     4    2    1     1     1     5    1  12781
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6869097, 'precision': 0.669672, 'recall': 0.5980048, 'specificity': 0.96864957, 'f1': 0.5801655, 'auroc': 0.87046367}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   916     0    0   40   0    8    34    38    27   90    17
1     1  1233    0   44   0    2     2   152    17   11    37
2     2     0  173   20  35   35    14    23   316  144   253
3     0     0    0    0   0    0     0     0     0    0     0
4     1     0   10    0  48    0     1     1    16    0  1556
5     3     0    0   94   0  391     0     0     7   93     4
6     3     0    2    5   0    1  2599     3    84    0   370
7     0     0    0  116   0    0     2  1035     4    1     6
8     0     0    1   89   0    4     9     3  1255    7     2
9     3     3   50  149   1  192     7    36   149  524    23
10    0     0    0    0   1    0     0     0     1    0  1644
better model found
persisted
after epoch: 10,now: 2024-07-28 00:42:17.499760,epoch time: 0:49:46.194659,used: 8:27:52.012222,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:27:52.012222 at 2024-07-28 00:42:17.499760
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6869097, 'precision': 0.669672, 'recall': 0.5980048, 'specificity': 0.96864957, 'f1': 0.5801655, 'auroc': 0.87046367}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   916     0    0   40   0    8    34    38    27   90    17
1     1  1233    0   44   0    2     2   152    17   11    37
2     2     0  173   20  35   35    14    23   316  144   253
3     0     0    0    0   0    0     0     0     0    0     0
4     1     0   10    0  48    0     1     1    16    0  1556
5     3     0    0   94   0  391     0     0     7   93     4
6     3     0    2    5   0    1  2599     3    84    0   370
7     0     0    0  116   0    0     2  1035     4    1     6
8     0     0    1   89   0    4     9     3  1255    7     2
9     3     3   50  149   1  192     7    36   149  524    23
10    0     0    0    0   1    0     0     0     1    0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7455398, 'precision': 0.69021976, 'recall': 0.6424464, 'specificity': 0.9744704, 'f1': 0.63752943, 'auroc': 0.8838153}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1132     0    0   4    1    0     6     8     5   11     3
1      6  1196    5  26    0    0     2   212     6   19    27
2     12     0  423  11  129   12     8    21   157   96   146
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0   10   0  217    0     1     0    23    0  1380
5     10     0   14  71    1  263     2     0     6  224     1
6      3     1    5   7    2    0  2841     4    76    0   128
7      3     0    9  40    0    0     4  1102     0    2     4
8      0     0   10  89    1    0    20    12  1221   16     1
9     21     2  239  76    3   69     3    25    52  624    23
10     0     0    0   0    8    0     0     0     1    0  1637
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104513_instance_wise_predictions.txt
accuracy from prediction file 0.6869096760652067
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/12.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15860 MiB | 396352 GiB | 396350 GiB |
|       from large pool |   1652 MiB |  15835 MiB | 393448 GiB | 393447 GiB |
|       from small pool |      7 MiB |     26 MiB |   2903 GiB |   2903 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15860 MiB | 396352 GiB | 396350 GiB |
|       from large pool |   1652 MiB |  15835 MiB | 393448 GiB | 393447 GiB |
|       from small pool |      7 MiB |     26 MiB |   2903 GiB |   2903 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB | 395262 GiB | 395260 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 392361 GiB | 392360 GiB |
|       from small pool |      6 MiB |     26 MiB |   2900 GiB |   2900 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16492 MiB |  16492 MiB |  16492 MiB |      0 B   |
|       from large pool |  16464 MiB |  16464 MiB |  16464 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 375136 KiB | 695368 KiB |  87834 GiB |  87834 GiB |
|       from large pool | 355872 KiB | 692256 KiB |  84916 GiB |  84915 GiB |
|       from small pool |  19264 KiB |  23335 KiB |   2918 GiB |   2918 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   30048 K  |   30045 K  |
|       from large pool |     247    |     595    |   13474 K  |   13474 K  |
|       from small pool |    2399    |    3599    |   16573 K  |   16571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   30048 K  |   30045 K  |
|       from large pool |     247    |     595    |   13474 K  |   13474 K  |
|       from small pool |    2399    |    3599    |   16573 K  |   16571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     466    |     466    |     466    |       0    |
|       from large pool |     452    |     452    |     452    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     119    |     570    |   16553 K  |   16552 K  |
|       from large pool |      97    |     307    |    8576 K  |    8576 K  |
|       from small pool |      22    |     460    |    7976 K  |    7976 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 396352 GiB | 396352 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 393448 GiB | 393448 GiB |
|       from small pool |      0 KiB |     26 MiB |   2903 GiB |   2903 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 396352 GiB | 396352 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 393448 GiB | 393448 GiB |
|       from small pool |      0 KiB |     26 MiB |   2903 GiB |   2903 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 395262 GiB | 395262 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 392361 GiB | 392361 GiB |
|       from small pool |      0 KiB |     26 MiB |   2900 GiB |   2900 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2026 MiB |  16492 MiB |  16492 MiB |  14466 MiB |
|       from large pool |   2000 MiB |  16464 MiB |  16464 MiB |  14464 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 695368 KiB |  87835 GiB |  87835 GiB |
|       from large pool |  24320 KiB | 692256 KiB |  84917 GiB |  84917 GiB |
|       from small pool |      0 KiB |  25544 KiB |   2918 GiB |   2918 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13474 K  |   13474 K  |
|       from small pool |       0    |    3599    |   16573 K  |   16573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13474 K  |   13474 K  |
|       from small pool |       0    |    3599    |   16573 K  |   16573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     109    |     466    |     466    |     357    |
|       from large pool |      96    |     452    |     452    |     356    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     570    |   16553 K  |   16553 K  |
|       from large pool |       3    |     307    |    8576 K  |    8576 K  |
|       from small pool |       0    |     460    |    7977 K  |    7977 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 396352 GiB | 396352 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 393448 GiB | 393448 GiB |
|       from small pool |      0 KiB |     26 MiB |   2903 GiB |   2903 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 396352 GiB | 396352 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 393448 GiB | 393448 GiB |
|       from small pool |      0 KiB |     26 MiB |   2903 GiB |   2903 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 395262 GiB | 395262 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 392361 GiB | 392361 GiB |
|       from small pool |      0 KiB |     26 MiB |   2900 GiB |   2900 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2026 MiB |  16492 MiB |  16492 MiB |  14466 MiB |
|       from large pool |   2000 MiB |  16464 MiB |  16464 MiB |  14464 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 695368 KiB |  87835 GiB |  87835 GiB |
|       from large pool |  24320 KiB | 692256 KiB |  84917 GiB |  84917 GiB |
|       from small pool |      0 KiB |  25544 KiB |   2918 GiB |   2918 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13474 K  |   13474 K  |
|       from small pool |       0    |    3599    |   16573 K  |   16573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13474 K  |   13474 K  |
|       from small pool |       0    |    3599    |   16573 K  |   16573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     109    |     466    |     466    |     357    |
|       from large pool |      96    |     452    |     452    |     356    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     570    |   16553 K  |   16553 K  |
|       from large pool |       3    |     307    |    8576 K  |    8576 K  |
|       from small pool |       0    |     460    |    7977 K  |    7977 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513

 Experiment start at: 2024-07-28 01:00:30.487252
before training, model accuracy: 0.09438186883926392
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9261558, 'precision': 0.84458435, 'recall': 0.744738, 'specificity': 0.99195904, 'f1': 0.77524495, 'auroc': 0.9948807}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   191     0    1     4    2    1   184     8     9    9     74
1     0  1240    0    18    0    0     4    60     2    0      8
2     0     1  117     2   67    3     9    27    20   62      3
3     1     0    0  7668    1    7    20   558   182    1      1
4     0     1    7     2  265    3    14     8    50   10    179
5     0     0    0    67    0  397     5     0    14   37      1
6     4     0    0     3    2    1  1867     4     9    0     18
7     0     8    0   103    1    0    11  7052    71    0     16
8     0     1    1   109    4    1    27   115  2988    1     49
9     1     1   37    14    5  141    17    12    20  240      5
10    1     1    3     6   23    1    79    28    58    1  12591
---- Validation: 
scalar performance:
{'acc': 0.9260399, 'precision': 0.84517765, 'recall': 0.74458873, 'specificity': 0.99195355, 'f1': 0.7744074, 'auroc': 0.9948226}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   176     0    1     6    0    2   195    10     8    6     79
1     0  1243    0    15    0    0     3    62     3    0      6
2     1     2  131     0   65    4     9    18    13   61      8
3     0     0    0  7675    0    7    28   551   177    0      2
4     0     1    8     2  257    1    14    13    58   10    175
5     1     0    2    68    0  386     7     0    13   43      1
6     1     0    0     0    1    0  1882     3     5    0     16
7     0    13    0   109    1    0    15  7055    57    1     14
8     0     1    2    99    4    1    26   117  2987    2     57
9     2     1   35     9    4  145    19    12    14  246      6
10    0     0    1     5   30    2    88    23    64    1  12582
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64164275, 'precision': 0.6060079, 'recall': 0.508871, 'specificity': 0.96256393, 'f1': 0.47980994, 'auroc': 0.8749147}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   329     0   0   49    0    0   742    37     2    4     7
1     0  1366   0   29    0    0    10    60     2    0    32
2     0    20   7   21  127    8   256    53   379   24   120
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  114    0    50     2    22    0  1445
5     2     0   0  195    1  234   112     1    18   29     0
6     0     1   0    1    0    0  3044     3    11    0     7
7     0     4   0   27    0    0    10  1120     0    0     3
8     0     1   0  107    1    0    66    13  1180    0     2
9     2    57  16  172   19   98   270   107   246  138    12
10    0     0   0    0    3    0     3     1     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 01:52:48.493932,epoch time: 0:52:18.006680,used: 0:52:18.006680,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9474529, 'precision': 0.8811881, 'recall': 0.84581774, 'specificity': 0.9941859, 'f1': 0.8605647, 'auroc': 0.99695945}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     0    0     4    1    1     5     7     3    4     50
1     0  1245    0     7    0    0     0    68     6    1      5
2     2     0  218     0   35    3     1     7     6   35      5
3     3     0    1  7834    0   20     2   439   137    3      0
4     2     0   31     0  293    2     0     4    16    8    183
5     0     0    1    13    0  409     0     0     8   89      1
6    18     0    0     4    0    0  1840    10     7    3     25
7     1     8    4    86    1    0     1  7074    69    3     15
8     1     1    8    69    9    2     1   118  3044    1     42
9     5     0   51     1    3   61     1     6     7  352      6
10   11     0    3     8   15    2     9    14    34    1  12695
---- Validation: 
scalar performance:
{'acc': 0.9500334, 'precision': 0.88761705, 'recall': 0.8504885, 'specificity': 0.99446464, 'f1': 0.8661091, 'auroc': 0.99692506}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     2    1    0     5     4     5    3     43
1     0  1250    0    10    0    0     2    62     5    0      3
2     3     0  220     2   30    4     1     7     4   33      8
3     1     1    0  7875    0   23     0   392   146    2      0
4     2     0   26     0  297    2     2     3    18    7    182
5     1     0    1    19    0  403     0     0     8   88      1
6    21     0    0     1    1    2  1841     8     9    2     23
7     0    10    2    83    1    0     2  7099    53    1     14
8     0     1    6    76    6    2     0   110  3051    2     42
9     6     0   50     3    0   57     0     5     8  357      7
10    6     0    3     7   20    1     3    16    35    1  12704
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71916324, 'precision': 0.6218363, 'recall': 0.60835135, 'specificity': 0.97161174, 'f1': 0.58851445, 'auroc': 0.87927777}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1073     0    0  23    0    0    20    21    14    4    15
1      1  1333    1  21    0    1     5    82     7    3    45
2     16     3   94   4  258   10    10    21   211   69   319
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    0   0  100    0     1     0    10    0  1521
5     24     0    0  59    1  313     6     0    13  170     6
6      0     0    0   2    1    0  2921     3    19    0   121
7      1     2    1  32    0    1     5  1111     6    0     5
8      0     1    1  51    7    6    19     9  1264    3     9
9     53    19  204  37   19  100    16    34   181  426    48
10     0     0    0   0    1    0     0     0     1    0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 02:42:26.835133,epoch time: 0:49:38.341201,used: 1:41:56.347881,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9579677, 'precision': 0.8916714, 'recall': 0.8667953, 'specificity': 0.9953624, 'f1': 0.8770455, 'auroc': 0.99789256}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     1    0     3    2    0     5     3     1    6     51
1     0  1299    1    11    0    0     0    17     2    0      2
2     0     0  222     1   44    0     0     1     4   38      2
3     1     4    1  8237    1    1     0   119    69    3      0
4     4     0   17     1  358    0     0     2    14    5    138
5     0     0    2    44    1  370     0     0     2  101      1
6     6     1    4     1    3    0  1860     0     6    2     24
7     3    54   15   168    5    0     3  6898    85    3     28
8     3     1    5   132   10    3     4    30  3048    9     51
9     0     0   57     5    1   31     0     0     1  396      2
10    4     0    3     6   38    0     5     5    26    2  12706
---- Validation: 
scalar performance:
{'acc': 0.95899427, 'precision': 0.88858795, 'recall': 0.87022024, 'specificity': 0.9955125, 'f1': 0.8774388, 'auroc': 0.99778455}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     3    4    0     3     1     1    8     44
1     0  1295    0    13    0    0     0    18     4    0      2
2     0     0  233     0   45    0     1     0     1   30      2
3     0     3    2  8237    1    4     1   113    77    2      0
4     3     0   16     1  363    0     1     1    12    5    137
5     0     0    1    38    0  372     0     0     4  105      1
6     5     1    3     4    4    0  1851     4     4    3     29
7     1    42   22   138    2    0     3  6921   108    4     24
8     3     1    9   111   12    4     3    38  3071    3     41
9     0     0   69     3    3   32     0     2     2  382      0
10    7     1    4     5   42    0     2     5    19    3  12708
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7022319, 'precision': 0.6507212, 'recall': 0.5739582, 'specificity': 0.9702516, 'f1': 0.57966805, 'auroc': 0.8741824}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   968     3    5   53    2    0    46     3     5   37    48
1     1  1401    3   30    0    0     2    21     2    3    36
2     0    14  175   24  341    0    10     9   178   46   218
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  187    0     1     0     7    1  1437
5     2     0    5  211    3  142     2     0     2  221     4
6     0     2    1    1    2    0  2959     1     5    0    96
7     3     9   20   79    1    0     4  1029    12    0     7
8     0     2    4  181    7    0    28     0  1138    3     7
9     3    28  361  182   27   31     6     6    77  394    22
10    0     0    0    0    2    0     0     0     0    0  1644
better model found
persisted
after epoch: 3,now: 2024-07-28 03:32:33.279722,epoch time: 0:50:06.444589,used: 2:32:02.792470,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95761985, 'precision': 0.903178, 'recall': 0.8883288, 'specificity': 0.99532783, 'f1': 0.8949179, 'auroc': 0.99853927}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     4    1    0     1     7     1    4     15
1     0  1244    0     9    0    0     0    77     1    0      1
2     1     0  229     0   31    1     0    11     1   38      0
3     0     0    0  8104    0   16     1   299    15    3      0
4     4     1   22     0  404    3     0     3     9    4     88
5     0     0    0    14    0  461     0     0     4   41      1
6    12     0    1     2    2    1  1862     8     3    3     14
7     1     4    0    65    1    0     1  7174    10    1      4
8     1     0    3   246   15   13     1   152  2827    3     35
9     1     0   36     4    0   72     0     2     0  377      1
10   18     0    1     5   60    1     7    23    16    3  12660
---- Validation: 
scalar performance:
{'acc': 0.95805806, 'precision': 0.90201813, 'recall': 0.8875541, 'specificity': 0.9953794, 'f1': 0.89410627, 'auroc': 0.998435}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     5    0    0     1     9     1    2     11
1     0  1254    0     5    0    0     0    71     1    0      1
2     1     0  231     1   33    1     0     6     2   37      0
3     0     0    0  8119    0   18     0   280    23    0      0
4     5     1   18     0  395    1     1     7    12    6     93
5     0     0    1    14    0  453     0     1     2   49      1
6    10     0    1     3    3    0  1866     4     3    3     15
7     0     2    1    65    1    0     1  7180    11    0      4
8     1     0    3   242   17   12     0   158  2822    7     34
9     1     0   41     4    0   66     0     4     0  377      0
10   17     0    4     6   61    0     2    25    14    1  12666
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7018121, 'precision': 0.6575533, 'recall': 0.5948827, 'specificity': 0.97033757, 'f1': 0.5926989, 'auroc': 0.8821458}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   964     1    0   60    1    1    16    77    13   23    14
1     0  1131    0   30    1    0     0   286     2    0    49
2     2     1  112   34  302   10     3    70   262   58   161
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    3    0  384    0     2     2    11    1  1229
5     1     0    0  159    2  329     1     0     2   96     2
6     0     0    0    9    2    0  2813     7    23    0   213
7     0     0    0   26    0    0     0  1135     0    0     3
8     0     0    0  212    1    1     3    22  1126    2     3
9     6     5  120  194   22  141     2   110   108  413    16
10    0     0    0    0   21    0     0     1     0    0  1624
early stop counter: 1
val acc:0.9580580592155457, best validation acc: 0.9589942693710327, corresponding to test acc:                         0.7022318840026855 / 0.7191632390022278
after epoch: 4,now: 2024-07-28 04:22:37.254636,epoch time: 0:50:03.974914,used: 3:22:06.767384,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96631527, 'precision': 0.9196765, 'recall': 0.8924979, 'specificity': 0.9963065, 'f1': 0.9033283, 'auroc': 0.9987956}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     2    1    0     0     3     0    2     11
1     0  1280    0     7    0    0     0    41     2    0      1
2     3     0  197     2   17    0     1    11     3   77      1
3     3     0    0  8138    0    6     0   225    63    1      0
4     6     0   22     2  374    1     0    10    22    2     98
5     0     0    0    11    0  467     0     0     5   37      1
6    17     0    0     1    0    0  1851     9     7    3     20
7     0     4    0    64    1    0     1  7179    10    1      4
8     4     0    1    60    2    2     0   141  3057    4     25
9     1     0   13     4    0   56     0     6     4  408      1
10   22     0    1     7   28    2     2    14    17    0  12702
---- Validation: 
scalar performance:
{'acc': 0.96784806, 'precision': 0.9237495, 'recall': 0.90359104, 'specificity': 0.9964882, 'f1': 0.9119538, 'auroc': 0.99893105}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    2    0     1     3     1    1      9
1     0  1277    0     8    0    0     0    44     1    0      2
2     2     0  212     0   16    1     0    10     4   65      2
3     2     0    0  8159    0    7     0   205    66    1      0
4     5     0   15     0  412    1     1     5    18    4     78
5     0     0    0    15    0  461     0     1     4   39      1
6    17     0    0     0    2    1  1850     9     8    2     19
7     0     5    0    54    1    0     1  7188    10    1      5
8     3     0    4    65    2    2     0   129  3061    0     30
9     3     0   13     2    0   53     0     4     3  415      0
10   23     0    1     6   34    1     3    23    22    1  12682
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71874344, 'precision': 0.65983856, 'recall': 0.6198562, 'specificity': 0.97179484, 'f1': 0.59906936, 'auroc': 0.88416934}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1034     0   0  32    1    6     7    36    20   20    14
1      1  1235   0  29    0    0     0   171     5    0    58
2      4     3  36  10  232   21     0    35   381   71   222
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0  368    0     1     1    21    1  1241
5      3     0   0  87    3  394     0     0    10   88     7
6      0     0   0   2    2    0  2706     8   123    0   226
7      1     0   0  39    0    1     0  1119     0    0     4
8      0     0   0  83    0    0     1    13  1267    2     4
9      9     6  40  84   20  193     1    68   194  484    38
10     0     0   0   0   15    0     0     0     1    0  1630
better model found
persisted
after epoch: 5,now: 2024-07-28 05:14:01.408178,epoch time: 0:51:24.153542,used: 4:13:30.920926,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96960616, 'precision': 0.92642045, 'recall': 0.9058408, 'specificity': 0.99663097, 'f1': 0.91339004, 'auroc': 0.9991848}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     3    1    0     7     0     0    4     14
1     0  1291    0     6    0    0     0    35     0    0      0
2     0     0  268     1    2    3     0     3     2   32      1
3     0     0    0  8378    0    4     0    34    20    0      0
4     6     0   50     0  364    1     0     2    10    4    102
5     0     0    0    27    0  473     0     1     4   15      1
6     6     0    1     3    0    0  1891     0     0    0      7
7     0     5    0   230    1    0     1  6984    33    1      9
8     1     5    3   138    8    2     0    69  3055    3     12
9     2     0   28     6    0   87     0     1     1  368      0
10    6     0    8     7   18    1     8     7    22    1  12714
---- Validation: 
scalar performance:
{'acc': 0.9699077, 'precision': 0.9279808, 'recall': 0.9076894, 'specificity': 0.99665004, 'f1': 0.91497356, 'auroc': 0.99915045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    2     6    1    0     4     0     3    1     19
1     0  1296    0     4    0    0     0    32     0    0      0
2     1     0  275     0    3    3     1     2     2   25      0
3     1     1    0  8379    0    2     0    33    23    1      0
4     2     0   47     0  366    3     0     2     9    1    109
5     0     0    1    23    0  479     1     1     3   12      1
6     2     0    0     3    0    0  1890     0     2    2      9
7     0     5    1   220    0    0     2  7001    30    1      5
8     0     5    6   141   11    3     1    65  3042    1     21
9     0     0   28     5    1   91     0     1     1  366      0
10    4     0    8    10   27    1     8     5    12    2  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69656473, 'precision': 0.6685906, 'recall': 0.58333313, 'specificity': 0.96993524, 'f1': 0.59587556, 'auroc': 0.8825153}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   921     2    0   71    4   25    84    5     2   44    12
1     1  1245    0   34    0    0     6  168     3    0    42
2     1     5  199   44  265   26    45   17   219   73   121
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    5    0  242    0     3    0    14    1  1368
5     0     0    0  154    3  363     3    0     1   62     6
6     0     0    0    4    1    0  3034    3     3    0    22
7     2     0    0  359    0    0     1  796     2    0     4
8     0     0    3  236    5    0    35    2  1080    2     7
9     2    14  121  243   11  178    12   30    70  437    19
10    0     0    0    0    6    0     0    0     1    0  1639
better model found
persisted
after epoch: 6,now: 2024-07-28 06:04:56.520797,epoch time: 0:50:55.112619,used: 5:04:26.033545,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9731646, 'precision': 0.9269266, 'recall': 0.9154776, 'specificity': 0.9971781, 'f1': 0.91617095, 'auroc': 0.9993324}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    2    0     3     3     3    1     14
1     0  1297    0     8    0    0     0    25     2    0      0
2     1     0  177     0   28    2     2    11     6   83      1
3     1     0    0  8327    0    3     0    52    54    0      0
4     2     1    8     0  477    1     0     4    16    2     27
5     0     0    0    16    0  482     0     0     6   16      1
6    12     0    0     2    0    0  1874     3     1    1     14
7     0     5    0   124    1    0     1  7106    24    0      3
8     0     0    0    40    4    0     0    31  3208    0     13
9     1     0    2     1    0   53     1     1     5  429      0
10    4     2    2     6  150    0     4    30    56    0  12540
---- Validation: 
scalar performance:
{'acc': 0.9727431, 'precision': 0.9264405, 'recall': 0.9134401, 'specificity': 0.99714607, 'f1': 0.9145025, 'auroc': 0.9993045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     3    2    1     3     1     4    1     11
1     1  1298    0    10    0    0     0    22     1    0      0
2     1     0  175     2   26    1     1    11    11   84      0
3     1     0    0  8333    0    1     0    45    60    0      0
4     4     0    8     1  475    1     0     1    19    4     26
5     2     0    0    14    0  480     0     0     7   17      1
6     9     0    0     0    0    0  1878     0     4    1     16
7     0     5    0   116    1    0     1  7099    40    0      3
8     0     0    0    42    0    0     0    40  3207    0      7
9     0     0    1     3    0   51     1     3     8  425      1
10    5     1    1     9  161    0     1    30    49    0  12539
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7240607, 'precision': 0.6618024, 'recall': 0.6094814, 'specificity': 0.9724827, 'f1': 0.589597, 'auroc': 0.88209414}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1043     0   0   15    1    9    23    17    28   11    23
1      0  1297   0   31    0    0     1   148     8    1    13
2      5     4  13   22  220   26    16    32   465   45   167
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  541    0     1     1    22    1  1067
5      8     0   0  139    3  377     6     0    23   31     5
6      0     0   0    5    1    0  2911     3    36    0   111
7      3     0   0  134    0    0     0  1021     4    0     2
8      0     0   0   81    0    2     3     9  1274    0     1
9     11     9  16  161   21  237    13    68   311  269    21
10     0     1   0    0   40    0     0     1     1    0  1603
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-28 06:55:54.600727,epoch time: 0:50:58.079930,used: 5:55:24.113475,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96888375, 'precision': 0.9143333, 'recall': 0.9293364, 'specificity': 0.99683094, 'f1': 0.9172181, 'auroc': 0.9993781}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    1     1    6    0    11     6     2    1      5
1     0  1323    0     1    0    0     0     5     2    0      0
2     1     0  281     0   21    0     0     0     3    6      0
3     0     5    0  8082    0    1     5   197   150    0      0
4     2     0    9     0  508    0     0     0    13    0      7
5     1     0    1    35    0  372     0     0     8  102      1
6     1     0    1     1    1    0  1890     1     5    1      6
7     0    24    3    40    2    0     4  7140    45    0      4
8     0     1    3     8   11    0     3    32  3231    0      7
9     0     0   54     5    2    2     0     4     8  418      0
10    4     1    3     7  199    0    24     6    30    1  12518
---- Validation: 
scalar performance:
{'acc': 0.970095, 'precision': 0.91879934, 'recall': 0.9334243, 'specificity': 0.99696064, 'f1': 0.92150843, 'auroc': 0.9994041}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     2   10    0    16     2     4    0      6
1     0  1327    0     0    0    0     0     4     1    0      0
2     0     0  284     0   22    0     0     0     0    6      0
3     1     3    0  8094    0    1     8   183   150    0      0
4     0     0    6     0  513    0     1     1    11    0      7
5     0     0    1    35    0  383     0     1     8   92      1
6     0     0    0     0    1    0  1896     1     6    0      4
7     0    23    5    34    1    0     4  7158    37    0      3
8     0     1    2     8   12    0     4    34  3226    1      8
9     0     0   49     4    0    2     1     4     8  425      0
10    4     0    1     4  213    0    22     8    26    0  12518
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7378437, 'precision': 0.6736962, 'recall': 0.6015191, 'specificity': 0.97361106, 'f1': 0.6008074, 'auroc': 0.88525647}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   864     0    2   41    7    0   161    28    24   30    13
1     0  1340    1   13    2    0     2   114     7    0    20
2     0     4  129    9  349    3    17    20   368   51    65
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  822    0     2     0    19    1   788
5     3     0    5  232    2  123    12     1    38  172     4
6     0     1    0    1    3    0  2901     3   117    0    41
7     0     0    0   24    0    0     3  1123    10    1     3
8     0     1    0   26    2    0     9    13  1313    3     3
9     4    21  177  132   21   22    18    71   273  382    16
10    0     0    0    0   95    0     1     0     1    0  1549
new oracle model saved
early stop counter: 1
val acc:0.9700949788093567, best validation acc: 0.9727430939674377, corresponding to test acc:                         0.7240607142448425 / 0.7378436923027039
after epoch: 8,now: 2024-07-28 07:46:36.192245,epoch time: 0:50:41.591518,used: 6:46:05.704993,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9805223, 'precision': 0.94528997, 'recall': 0.949929, 'specificity': 0.9979907, 'f1': 0.9470234, 'auroc': 0.99971426}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     1    1    0    20     0     3    0      4
1     0  1317    0     3    0    0     0    10     2    0      0
2     1     0  273     0    8    2     1     0     0   27      0
3     0     0    0  8303    0    4     0    41    88    1      1
4     5     0   13     0  491    2     0     0     7    1     20
5     0     0    0     7    0  505     1     0     2    5      1
6     1     0    0     2    0    0  1900     0     2    1      2
7     0     2    2    98    2    0     2  7088    66    2      3
8     0     1    4    14    5    0     0     8  3260    0      3
9     0     0   13     2    0   67     1     0     0  410      0
10    3     0    6     6   57    0    27     5    39    0  12647
---- Validation: 
scalar performance:
{'acc': 0.98084795, 'precision': 0.9476145, 'recall': 0.9489658, 'specificity': 0.9980202, 'f1': 0.9475095, 'auroc': 0.9996654}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    1     3    1    0    17     0     2    0      3
1     0  1316    0     3    0    0     0    11     2    0      0
2     0     0  272     0    8    1     2     2     1   26      0
3     0     0    1  8308    0    2     0    36    92    1      0
4     5     0   11     0  494    1     4     0     6    1     17
5     0     0    1     5    0  509     1     0     1    3      1
6     1     0    0     1    0    0  1901     0     0    0      5
7     0     4    2    95    2    1     1  7084    69    1      6
8     0     0    1    19    6    3     0     7  3255    2      3
9     0     0   20     2    0   72     0     0     1  398      0
10    2     0    2     6   39    0    21     2    48    0  12676
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7141258, 'precision': 0.6628549, 'recall': 0.58945835, 'specificity': 0.970479, 'f1': 0.5838781, 'auroc': 0.8824937}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   690     1    0   28    1    3   368    33    23   16     7
1     0  1332    0   25    0    0    11   110     7    0    14
2     1     9  112   14  299   31   189    13   235   30    82
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  554    0    42     0    23    1  1011
5     4     0    0  146    2  340    50     0     7   36     7
6     0     0    0    1    0    0  3060     1     4    0     1
7     0     0    0   53    0    1     9  1091     6    0     4
8     0     1    0   58    3    0    69    11  1226    0     2
9     2    26   91  136   23  239   210    49   135  210    16
10    0     0    0    0   43    0     9     0     2    0  1592
better model found
persisted
after epoch: 9,now: 2024-07-28 08:37:19.456289,epoch time: 0:50:43.264044,used: 7:36:48.969037,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9819135, 'precision': 0.9479321, 'recall': 0.9419308, 'specificity': 0.99808735, 'f1': 0.94139165, 'auroc': 0.9997533}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     1    1     7    5    3     6     1     0    2      9
1     0  1330    0     1    0    0     0     1     0    0      0
2     0     0  287     0    8    5     0     0     0   12      0
3     0     1    0  8391    0   10     0    20    14    0      0
4     3     0    8     0  492    3     0     0     8    2     23
5     0     0    0     2    0  516     0     0     0    3      0
6     0     1    2     0    0    1  1898     1     0    0      5
7     0    29    1   140    2    0     0  7070    17    1      3
8     2     2    2    64    1   11     2    10  3188    1     11
9     0     0   12     0    0  143     0     0     0  338      0
10    5     0    2     6   19    2     2     6    11    0  12742
---- Validation: 
scalar performance:
{'acc': 0.98135614, 'precision': 0.94858336, 'recall': 0.94243336, 'specificity': 0.99801475, 'f1': 0.9424911, 'auroc': 0.99971634}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     5    4    3     6     0     0    3      6
1     0  1328    0     2    0    0     0     2     0    0      0
2     0     0  279     0    8    8     0     0     3   14      0
3     0     1    0  8404    0    8     0    19     8    0      0
4     4     0    7     0  492    2     1     0     8    2     23
5     0     0    0     0    0  519     0     0     0    1      1
6     2     0    0     2    0    0  1897     1     0    1      5
7     0    24    1   152    1    0     1  7064    17    0      5
8     2     3    2    80    2    8     2    15  3168    2     12
9     0     0   12     1    0  131     0     1     1  347      0
10    5     1    2     6   25    2     5     2    14    0  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7321766, 'precision': 0.67653835, 'recall': 0.61695325, 'specificity': 0.9732021, 'f1': 0.62210524, 'auroc': 0.8840849}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   799     1    0   79    3   15   138    79     4   28    24
1     1  1357    0   32    1    0     4    83     3    2    16
2     1     2  213   16  419   38    34    24   131   29   108
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  597    0     3     0     8    0  1021
5     3     0    4  124    4  407     7     0     4   35     4
6     0     0    0    2    2    0  3030     3     2    0    28
7     0     0    2  128    0    1     3  1023     4    0     3
8     0     1    2  159    4    6    56    10  1125    0     7
9     5     9  253  150   23  260    26    42    38  311    20
10    0     0    0    0   40    0     1     1     1    0  1603
better model found
persisted
after epoch: 10,now: 2024-07-28 09:28:09.762285,epoch time: 0:50:50.305996,used: 8:27:39.275033,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:27:39.275033 at 2024-07-28 09:28:09.762285
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7321766, 'precision': 0.67653835, 'recall': 0.61695325, 'specificity': 0.9732021, 'f1': 0.62210524, 'auroc': 0.8840849}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   799     1    0   79    3   15   138    79     4   28    24
1     1  1357    0   32    1    0     4    83     3    2    16
2     1     2  213   16  419   38    34    24   131   29   108
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  597    0     3     0     8    0  1021
5     3     0    4  124    4  407     7     0     4   35     4
6     0     0    0    2    2    0  3030     3     2    0    28
7     0     0    2  128    0    1     3  1023     4    0     3
8     0     1    2  159    4    6    56    10  1125    0     7
9     5     9  253  150   23  260    26    42    38  311    20
10    0     0    0    0   40    0     1     1     1    0  1603
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7378437, 'precision': 0.6736962, 'recall': 0.6015191, 'specificity': 0.97361106, 'f1': 0.6008074, 'auroc': 0.88525647}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   864     0    2   41    7    0   161    28    24   30    13
1     0  1340    1   13    2    0     2   114     7    0    20
2     0     4  129    9  349    3    17    20   368   51    65
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  822    0     2     0    19    1   788
5     3     0    5  232    2  123    12     1    38  172     4
6     0     1    0    1    3    0  2901     3   117    0    41
7     0     0    0   24    0    0     3  1123    10    1     3
8     0     1    0   26    2    0     9    13  1313    3     3
9     4    21  177  132   21   22    18    71   273  382    16
10    0     0    0    0   95    0     1     0     1    0  1549
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_00_29_seed_1_23104513_instance_wise_predictions.txt
accuracy from prediction file 0.732176589939131
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1662 MiB |  15861 MiB |    774 TiB |    774 TiB |
|       from large pool |   1654 MiB |  15836 MiB |    768 TiB |    768 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1662 MiB |  15861 MiB |    774 TiB |    774 TiB |
|       from large pool |   1654 MiB |  15836 MiB |    768 TiB |    768 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB |    771 TiB |    771 TiB |
|       from large pool |   1647 MiB |  15791 MiB |    766 TiB |    766 TiB |
|       from small pool |      6 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16432 MiB |  16492 MiB |  30898 MiB |  14466 MiB |
|       from large pool |  16404 MiB |  16464 MiB |  30868 MiB |  14464 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 493472 KiB | 695368 KiB | 177016 GiB | 177016 GiB |
|       from large pool | 476256 KiB | 692256 KiB | 171178 GiB | 171178 GiB |
|       from small pool |  17216 KiB |  25544 KiB |   5837 GiB |   5837 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   60095 K  |   60093 K  |
|       from large pool |     247    |     595    |   26948 K  |   26948 K  |
|       from small pool |    2399    |    3599    |   33147 K  |   33145 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   60095 K  |   60093 K  |
|       from large pool |     247    |     595    |   26948 K  |   26948 K  |
|       from small pool |    2399    |    3599    |   33147 K  |   33145 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     460    |     466    |     817    |     357    |
|       from large pool |     446    |     452    |     802    |     356    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     123    |     570    |   33194 K  |   33194 K  |
|       from large pool |     101    |     307    |   17187 K  |   17187 K  |
|       from small pool |      22    |     460    |   16007 K  |   16007 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15861 MiB |    774 TiB |    774 TiB |
|       from large pool |  16640 KiB |  15836 MiB |    768 TiB |    768 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15861 MiB |    774 TiB |    774 TiB |
|       from large pool |  16640 KiB |  15836 MiB |    768 TiB |    768 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |  15791 MiB |    766 TiB |    766 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2144 MiB |  16492 MiB |  30898 MiB |  28754 MiB |
|       from large pool |   2120 MiB |  16464 MiB |  30868 MiB |  28748 MiB |
|       from small pool |     24 MiB |     28 MiB |     30 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 695368 KiB | 177017 GiB | 177017 GiB |
|       from large pool |  24320 KiB | 692256 KiB | 171179 GiB | 171179 GiB |
|       from small pool |      0 KiB |  25544 KiB |   5837 GiB |   5837 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   60095 K  |   60095 K  |
|       from large pool |       2    |     595    |   26948 K  |   26948 K  |
|       from small pool |       0    |    3599    |   33147 K  |   33147 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   60095 K  |   60095 K  |
|       from large pool |       2    |     595    |   26948 K  |   26948 K  |
|       from small pool |       0    |    3599    |   33147 K  |   33147 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     111    |     466    |     817    |     706    |
|       from large pool |      99    |     452    |     802    |     703    |
|       from small pool |      12    |      14    |      15    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     570    |   33195 K  |   33195 K  |
|       from large pool |       3    |     307    |   17187 K  |   17187 K  |
|       from small pool |       0    |     460    |   16007 K  |   16007 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 09:38:52 2024]
Finished job 0.
1 of 1 steps (100%) done
