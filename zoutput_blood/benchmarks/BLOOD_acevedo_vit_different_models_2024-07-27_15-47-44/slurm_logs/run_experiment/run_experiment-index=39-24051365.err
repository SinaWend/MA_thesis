Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 01:35:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/14.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=14
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365

 Experiment start at: 2024-08-04 01:51:31.256094
before training, model accuracy: 0.044287413358688354
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92166096, 'precision': 0.8362284, 'recall': 0.7158973, 'specificity': 0.99126196, 'f1': 0.75231236, 'auroc': 0.99016285}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   275     0   0    30    0    0    50     9    22   22     75
1     0  1108   0    23    0    0     0   179    14    0      8
2     0     0  93     7   29    5     4    38    29   89     18
3     0     0   0  8124    0    4     0   164   144    1      1
4     0     0  32     3  116    0     3     7   101   21    256
5     2     0   2   106    0  314     0     0     7   89      1
6     4     0   1    30    0    0  1822    10    19    5     17
7     0     2   0   411    1    0     1  6728   107    0     14
8     0     0   3   204    0    2     1    69  2985    2     29
9     0     0  33    49    1   79     1     7    12  308      3
10   10     0   3    14    5    1    29    25   125    4  12575
---- Validation: 
scalar performance:
{'acc': 0.9211181, 'precision': 0.8433994, 'recall': 0.719306, 'specificity': 0.9912047, 'f1': 0.7566105, 'auroc': 0.9902847}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   275     0    0    28    0    2    50    11    29   22     66
1     0  1097    0    23    0    0     0   190    14    0      8
2     0     1  102     8   27    7     0    34    26   85     22
3     0     0    0  8116    0    6     0   172   146    0      0
4     0     0   28     5  126    1     2     5   106   19    247
5     1     0    0   115    0  314     0     0     5   85      1
6     6     0    0    37    0    0  1818    10    13    4     20
7     0     2    0   435    0    0     1  6692   112    0     23
8     0     0    1   183    0    2     0    65  3008    4     33
9     0     0   28    34    1  100     0     4    15  308      3
10    4     0    3    11    3    0    37    21   126   11  12580
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5690898, 'precision': 0.5827353, 'recall': 0.48700556, 'specificity': 0.9574058, 'f1': 0.46993437, 'auroc': 0.84039336}
confusion matrix:
     0    1   2    3   4    5     6     7     8    9     10
0   526    0   0  304   0    0    54   116    92   72     6
1     0  857   0   57   0    1     2   527    16    0    39
2     2    1  43   74  92   20     3    57   474   85   164
3     0    0   0    0   0    0     0     0     0    0     0
4     1    0   0    0  62    0     0     2    42    2  1524
5     0    0   0  229   0  297     1     0    10   53     2
6     0    0   0  133   3    0  2134     5   519    0   273
7     0    0   0   90   0    0     0  1071     0    0     3
8     0    0   0  160   0    1     0     7  1201    1     0
9     1    4  80  333  10  137     0    88   161  297    26
10    0    0   0    0   0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 02:50:13.779700,epoch time: 0:58:42.523606,used: 0:58:42.523606,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94651645, 'precision': 0.86449647, 'recall': 0.8068325, 'specificity': 0.99405813, 'f1': 0.82856286, 'auroc': 0.9939773}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0     4    0    1    20     3     8    7     54
1     0  1247    0    12    0    0     0    54    12    0      7
2     5     0  179     2   72    1     1     5    12   31      4
3     1     2    1  8177    0    9     1   112   133    3      0
4     2     0   11     1  231    0     0     2    37   15    240
5     2     0    5    36    0  307     1     0     7  162      1
6    10     0    0     3    0    0  1868     3     4    3     17
7     0     5    1   285    1    0     2  6855    90    2     21
8     2     0    4    97    4    3     0    48  3078    3     56
9     3     0   73     6    2   29     0     1    14  360      5
10   22     0    1     8    9    0    10    13    36    4  12689
---- Validation: 
scalar performance:
{'acc': 0.9462351, 'precision': 0.8638508, 'recall': 0.80717134, 'specificity': 0.99404806, 'f1': 0.82834965, 'auroc': 0.99392927}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     0    0     6    0    0    21     2     5    6     46
1     0  1251    0    14    1    0     0    50    10    0      6
2     0     0  170     3   74    2     0     7    11   37      8
3     0     1    1  8158    0   12     0   112   152    4      0
4     1     0   13     0  227    1     2     3    37   11    244
5     2     0    1    33    0  310     0     0     9  165      1
6    13     0    0     3    0    0  1862     8     6    1     15
7     1     6    3   296    1    0     2  6838    98    1     19
8     2     0    1    79    4    2     1    48  3108    3     48
9     3     0   69     7    2   36     0     0     9  364      3
10   18     0    1     8    4    0    14    10    47    4  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70146227, 'precision': 0.6170012, 'recall': 0.5838747, 'specificity': 0.9701209, 'f1': 0.5672072, 'auroc': 0.8664074}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1051     1    0   33    0    0     6    34    27   16     2
1      1  1175    2   31    3    2     3   237    21    0    24
2     20     0   94   17  209    3     2    37   343  114   176
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    1    0   60    0     2     1    13    1  1553
5      7     0    1   72    0  228     1     0    12  269     2
6      0     0    0    8    2    0  2968     3    26    0    60
7      0     0    1  137    0    0     2  1017     1    2     4
8      0     0    0  103    1    1     1     3  1251    8     2
9     17     2  149   88   14   44     1    42   220  536    24
10     0     0    0    0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 03:47:11.252314,epoch time: 0:56:57.472614,used: 1:55:39.996220,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94889766, 'precision': 0.87057674, 'recall': 0.7982296, 'specificity': 0.9943964, 'f1': 0.8252566, 'auroc': 0.9952005}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     0    0     3    0    0    37     5     7    2     30
1     0  1282    0    13    0    0     0    34     2    0      1
2     0     1  137     4   68    3     3    34    20   32     10
3     0     1    0  8104    0    3     4   227   100    0      0
4     4     2   10     2  247    1     5     7    66    3    192
5     8     0    0    70    0  400     2     0     9   30      1
6     6     0    0     4    0    0  1882     3     3    0      9
7     0    12    0   135    1    0     2  7067    39    0      7
8     0     0    1   103    1    1     1    74  3093    0     22
9    12     0   56    22    1  122     6    13    24  237      0
10   17     6    1    12    4    2    28    17    87    0  12619
---- Validation: 
scalar performance:
{'acc': 0.948696, 'precision': 0.8719363, 'recall': 0.7989129, 'specificity': 0.9943877, 'f1': 0.82635176, 'auroc': 0.9953771}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0     4    0    0    50     5     8    1     29
1     0  1281    0    13    0    0     0    36     1    0      1
2     2     3  141     3   69    5     2    35    20   29      3
3     0     1    0  8087    0    1     0   240   110    0      1
4     4     1   10     3  248    1     6     7    67    4    188
5     5     0    2    66    0  410     1     0     6   29      2
6     6     0    0     0    0    0  1880     3     8    1     10
7     0    12    0   139    1    0     3  7055    50    0      5
8     0     0    1    81    1    0     0    91  3102    0     20
9     7     0   52    21    1  133     8    12    18  239      2
10   12     1    1    13   11    1    22    19    78    0  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7004827, 'precision': 0.63122374, 'recall': 0.5886185, 'specificity': 0.9701565, 'f1': 0.546684, 'auroc': 0.87527764}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1100     1   0    7    0    1    32    10    15    1     3
1      1  1327   0   33    0    0     5   116     9    0     8
2     19     5  28   45  137   52    23    28   480   14   184
3      0     0   0    0    0    0     0     0     0    0     0
4      2     0   0    1   62    0     2     1    36    0  1529
5     16     0   0  156    0  401     1     0     3   12     3
6      0     0   0    4    0    0  3036     3    12    0    12
7      0     0   0  115    0    0     2  1040     6    0     1
8      0     0   0  135    0    1     1     1  1231    1     0
9     35    21  31  208   11  283     9    42   327  143    27
10     0     0   0    0    0    0     2     0     0    0  1644
better model found
persisted
after epoch: 3,now: 2024-08-04 04:40:33.980902,epoch time: 0:53:22.728588,used: 2:49:02.724808,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9570045, 'precision': 0.88686603, 'recall': 0.86786973, 'specificity': 0.9954137, 'f1': 0.8758612, 'auroc': 0.9968106}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     4    0    0     6     8     1    1     29
1     0  1272    0    11    0    0     0    43     6    0      0
2     0     0  193     1   31    1     1     6    11   67      0
3     1     1    0  8094    0    7     1   219   114    1      0
4     2     0   31     1  368    1     2    10    29    3     92
5     0     0    0    31    0  391     0     0     4   94      1
6     4     0    1     1    1    0  1876     4    10    3      7
7     1     8    0   114    1    0     2  7089    44    0      4
8     3     0    1    61    6    2     1    64  3147    1     10
9     4     0   21    10    0   54     0     5    10  388      1
10   13     0    2     9  124    0    19    35    74    0  12517
---- Validation: 
scalar performance:
{'acc': 0.9570951, 'precision': 0.88862824, 'recall': 0.8670089, 'specificity': 0.9954213, 'f1': 0.87611896, 'auroc': 0.9968784}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    1     2    1    0    11     9     6    1     24
1     0  1273    1     7    0    0     0    44     6    0      1
2     1     0  191     1   36    0     1     9     9   64      0
3     1     1    0  8082    0    7     2   212   135    0      0
4     5     0   32     1  363    0     1     7    33    4     93
5     1     0    0    35    0  389     0     0     6   89      1
6     7     0    2     2    1    0  1879     2     6    0      9
7     2     6    1   103    1    0     2  7102    45    0      3
8     0     0    1    63    8    4     0    78  3129    2     11
9     1     0   19    12    0   43     0     4    11  401      2
10   13     0    3     6  107    1    14    36    70    2  12544
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.768558, 'precision': 0.7000083, 'recall': 0.6587045, 'specificity': 0.9769225, 'f1': 0.65336823, 'auroc': 0.8880243}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1076     1    0   13    1    2     9    12    14   40     2
1      2  1265    0   32    0    1     3   183     8    0     5
2      8     4  196   22  292   14     3    40   258  106    72
3      0     0    0    0    0    0     0     0     0    0     0
4      2     1    4    0  481    0     3     1    17    1  1123
5      1     0    0   77    0  406     0     0     2  104     2
6      0     0    0    5    1    0  3050     2     1    0     8
7      1     0    1   58    0    1     0  1100     1    0     2
8      0     0    0  105    0    1     1     7  1253    2     1
9      4    11   89  125   10  170     2    43   146  528     9
10     0     0    0    0   13    0     2     0     1    0  1630
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 05:32:19.678669,epoch time: 0:51:45.697767,used: 3:40:48.422575,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9556667, 'precision': 0.89550376, 'recall': 0.85433924, 'specificity': 0.99499893, 'f1': 0.86490124, 'auroc': 0.9966315}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     1    0    0     1     3     0    2     38
1     0  1295    0     3    0    0     0    24     6    0      3
2     4     1  209     0   14    0     1     0     5   73      5
3     1     1    2  8048    0   21     2   236   123    2      0
4     5     0   60     0  211    1     0     2    15   12    233
5     4     0    0    16    0  413     0     0     5   82      1
6    24     0    1     1    0    0  1824     4     1    1     52
7     3    29    2   118    1    0     2  7015    56    3     32
8     5     1    1    72    4    2     0    40  3088    5     78
9     4     0   16     3    0   44     0     1     3  421      1
10    9     1    2     6    5    0     1     6     7    2  12757
---- Validation: 
scalar performance:
{'acc': 0.9567741, 'precision': 0.89574164, 'recall': 0.8542192, 'specificity': 0.9951339, 'f1': 0.86507756, 'auroc': 0.9965671}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     1    0    0     0     4     1    3     41
1     0  1298    0     5    0    0     0    22     4    0      3
2     2     0  209     0   15    1     2     4     1   74      4
3     3     3    1  8075    0   17     1   228   110    2      0
4     5     1   54     0  211    0     0     2    13   12    241
5     5     0    0    12    0  418     0     0     4   81      1
6    17     0    1     0    0    0  1843     4     2    2     39
7     2    37    4   121    1    1     1  7016    55    5     22
8     4     0    2    60    2    3     1    42  3102    4     76
9     6     1   20     3    0   45     0     1     5  412      0
10   12     0    1     6    6    0     2     6     8    3  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7370041, 'precision': 0.66193354, 'recall': 0.6251323, 'specificity': 0.9735781, 'f1': 0.6067652, 'auroc': 0.8650077}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1112     2    0    5    0    1     7    17    11    8     7
1      6  1371    0   31    0    1     3    59    10    3    15
2     19    11  126    9  111    6     5     9   291  102   326
3      0     0    0    0    0    0     0     0     0    0     0
4      2     1    1    0   52    0     2     0    10    1  1564
5      7     0    0   74    0  308     0     0     8  191     4
6      0     0    0    1    0    0  3014     0     4    0    48
7      4     1    1   26    0    0     2  1114     9    1     6
8      0     0    0  154    1    0     1     2  1202    4     6
9     22    14   89   90    8   88     4    17   183  589    33
10     0     0    0    0    0    0     0     0     0    0  1646
early stop counter: 1
val acc:0.956774115562439, best validation acc: 0.9570950865745544, corresponding to test acc:                         0.7685580253601074 / 0.7685580253601074
after epoch: 5,now: 2024-08-04 06:23:44.940998,epoch time: 0:51:25.262329,used: 4:32:13.684904,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96281034, 'precision': 0.8816417, 'recall': 0.89346224, 'specificity': 0.9960235, 'f1': 0.88616997, 'auroc': 0.99792004}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    1     3    0    1     5     0     3    7     19
1     0  1297    0     9    0    0     2    19     2    0      3
2     0     0  232     0   30    2     1     0     2   45      0
3     0     2    6  8327    0   25     3    50    26    0      0
4     5     0   48     0  389    0     0     3     8    5     81
5     0     0    0     9    0  479     0     0     1   31      1
6     9     0    1     3    5    0  1875     0     2    1     10
7     2    32   28   229    2    0     7  6920    32    5      6
8     0     1   18   139   22   19     3    47  3012    5     30
9     0     0   33     3    0   97     1     0     2  357      0
10   17     0    8     8   71    1     8     7    16    2  12654
---- Validation: 
scalar performance:
{'acc': 0.9622843, 'precision': 0.88268894, 'recall': 0.8907296, 'specificity': 0.995959, 'f1': 0.8854544, 'auroc': 0.99785626}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    2     1    0    4    13     0     1    5     20
1     0  1292    0     7    0    0     2    26     3    0      2
2     0     0  236     0   25    3     0     0     1   47      0
3     0     2    3  8331    1   19     5    44    33    2      0
4     3     0   47     0  380    2     0     3     8    7     89
5     0     0    0    10    0  471     0     0     2   37      1
6     6     0    0     1    1    0  1885     0     4    2      9
7     2    36   24   235    4    0     9  6912    34    3      6
8     1     2   19   142   18   12     6    49  3012    4     31
9     0     0   34     2    0   97     0     1     0  359      0
10   18     0    7     8   68    2    10     5    15    3  12660
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74225146, 'precision': 0.67589104, 'recall': 0.6375767, 'specificity': 0.9742597, 'f1': 0.6378176, 'auroc': 0.8622495}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1044     0    4    6    1   17    12    7    17   59     3
1      3  1296    3   27    1    1    10   95     8    8    47
2      4     0  269   20  321   17    14    5   151   91   123
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    6    0  253    0     2    0     8    1  1363
5      1     0    0   70    0  412     0    0     2  105     2
6      3     0    0    7    0    0  3018    0     0    0    39
7      0     0    5  126    0    1    27  995     5    3     2
8      0     0    0  184    4    1     5    1  1163    5     7
9      4     3  233  105   16  185     5    7    49  519    11
10     0     0    0    0    6    0     0    0     0    0  1640
better model found
persisted
after epoch: 6,now: 2024-08-04 07:15:22.457993,epoch time: 0:51:37.516995,used: 5:23:51.201899,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9694992, 'precision': 0.9018809, 'recall': 0.901787, 'specificity': 0.9967739, 'f1': 0.901062, 'auroc': 0.998666}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     0    0    1    21     0     1    0     20
1     0  1305    0     6    1    0     1    16     3    0      0
2     4     0  218     0   34    0     2     2     2   50      0
3     0     1    0  8269    0   27     3    66    70    3      0
4     8     0   20     0  418    0     0     1     5    5     81
5     1     0    0     5    0  423     1     0     3   87      1
6     5     0    0     1    1    0  1891     1     1    0      6
7     1    28    4   128    2    0     2  7053    32    1     12
8     3     0    6    55   11    9     4    36  3149    1     21
9     2     0   22     1    1   41     1     1     2  421      1
10   16     0    0     7   86    1    16     3    16    0  12649
---- Validation: 
scalar performance:
{'acc': 0.9688645, 'precision': 0.89974296, 'recall': 0.9056711, 'specificity': 0.9966954, 'f1': 0.902435, 'auroc': 0.9986135}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     1    0    1    14     0     0    1     14
1     0  1306    0     5    1    0     1    15     4    0      0
2     2     0  230     0   29    1     1     1     1   47      0
3     0     1    2  8278    1   27     3    61    64    3      0
4    10     0   24     0  410    0     0     2    10    1     82
5     0     0    1     6    0  431     1     0     3   78      1
6     5     0    0     1    0    0  1890     1     2    0      9
7     0    24    5   141    3    0     4  7035    34    1     18
8     2     1    7    65   17   10     2    37  3129    3     23
9     0     0   30     3    2   39     1     0     2  416      0
10   22     0    2     6   79    1    23     5    14    0  12644
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7658994, 'precision': 0.68993205, 'recall': 0.65121096, 'specificity': 0.9763007, 'f1': 0.656301, 'auroc': 0.8823689}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1095     0    2    5    1    2    37    5     7   16     0
1     10  1355    0   22    2    2    24   54     5   16     9
2     35     1  162    6  467   13    91    5    77   94    64
3      0     0    0    0    0    0     0    0     0    0     0
4      4     0    1    0  548    0    28    0     6    0  1046
5     12     0    0   23    7  384     9    0     3  152     2
6      0     0    0    1    0    0  3066    0     0    0     0
7      4     0    7  220    0    0    29  890     8    4     2
8      0     0    0   84   16   15    42    1  1200   11     1
9     25     3  179   36   35  122    38    4    44  641    10
10     0     0    0    0   34    0     6    0     0    0  1606
better model found
persisted
after epoch: 7,now: 2024-08-04 08:06:46.736366,epoch time: 0:51:24.278373,used: 6:15:15.480272,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9689373, 'precision': 0.9212227, 'recall': 0.89689773, 'specificity': 0.9967198, 'f1': 0.9065798, 'auroc': 0.9982494}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     0    0    0    21     0     3    4     13
1     0  1285    0    10    0    0     0    30     7    0      0
2     0     0  195     1   26    0     2     8    17   63      0
3     0     0    0  8240    0    7     1    86   100    2      1
4     4     0   20     1  398    0     2     3    41    1     69
5     0     0    0    12    0  445     1     0     5   57      1
6     3     0    0     2    0    0  1887     0     5    1     10
7     0     4    1   119    1    0     6  7048    80    1      3
8     1     0    2    32    1    1     3    27  3222    1      6
9     0     0    9     1    0   42     2     0    11  428      0
10   16     0    1     8   45    1    14    12    69    1  12626
---- Validation: 
scalar performance:
{'acc': 0.96814233, 'precision': 0.9166226, 'recall': 0.89095724, 'specificity': 0.9966562, 'f1': 0.90092367, 'auroc': 0.9984289}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    1     1    0    0    30     1     6    4     11
1     0  1285    0     9    0    0     1    26    11    0      0
2     0     0  193     2   24    1     1     2    19   70      0
3     0     0    2  8231    0    5     6    91   104    0      1
4     3     0   22     0  393    0     1     4    45    4     67
5     0     0    0    11    0  432     2     0     6   69      1
6     6     0    0     0    1    0  1891     0     4    1      5
7     0     6    0   124    1    0     4  7048    76    3      3
8     1     0    1    31    2    1     2    35  3216    1      6
9     1     0    9     2    0   44     1     0     7  429      0
10   16     0    1     7   39    0    15     5    64    2  12647
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72133213, 'precision': 0.6760845, 'recall': 0.5905522, 'specificity': 0.97180533, 'f1': 0.5920538, 'auroc': 0.8744313}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1054     0    0    1    0    0    72    2     5   35     1
1      5  1195    0   25    1    0    20  207    11   17    18
2     14     0  114   17  292    2   116   10   280  100    70
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    1    0  386    0    31    1    26    1  1186
5      7     0    0   53    0  161    14    0     4  351     2
6      0     0    0    0    0    0  3065    0     0    0     2
7      1     0    0  232    0    0    56  859     6    7     3
8      0     0    0  139    0    1    46    0  1171   11     2
9     14     5   68  107   16   36    51    9   136  680    15
10     0     0    0    0   13    0     7    0     1    0  1625
early stop counter: 1
val acc:0.9681423306465149, best validation acc: 0.9688645005226135, corresponding to test acc:                         0.7658994197845459 / 0.7685580253601074
after epoch: 8,now: 2024-08-04 08:58:02.399367,epoch time: 0:51:15.663001,used: 7:06:31.143273,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9726295, 'precision': 0.9220003, 'recall': 0.91817945, 'specificity': 0.99705315, 'f1': 0.9190442, 'auroc': 0.9988685}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     1    0    0     0     2     3    3     21
1     0  1266    0     5    2    0     0    52     0    0      6
2     0     0  235     1   21    0     0     2     1   51      0
3     0     0    1  8208    1    9     0   133    83    2      0
4     2     0   25     0  453    1     0     2     4    3     49
5     1     0    1     5    0  432     0     0     4   77      1
6     8     0    0     4    2    0  1872     3     2    1     16
7     0     6    3    64    1    0     1  7174    10    1      5
8     0     0    2    18   16    2     0    70  3140    1     47
9     1     0   17     1    0   28     0     1     1  444      0
10    6     0    1     6   82    0     4     8     8    1  12676
---- Validation: 
scalar performance:
{'acc': 0.97156614, 'precision': 0.92096865, 'recall': 0.9152638, 'specificity': 0.99692297, 'f1': 0.91678077, 'auroc': 0.9989139}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     0    1    0     4     2     3    4     29
1     0  1270    1     7    0    0     0    46     1    0      7
2     0     0  234     0   20    2     0     1     1   54      0
3     0     0    1  8220    0   10     0   120    87    2      0
4     0     0   21     0  457    2     1     3     5    3     47
5     1     0    0     9    0  429     0     0     4   77      1
6    10     0    2     0    1    0  1874     4     2    0     15
7     0     3    1    64    1    0     1  7174    12    0      9
8     1     0    2    19   25    1     0    80  3103    2     63
9     1     0   15     3    0   25     0     2     0  447      0
10    6     0    3     6   88    0     3    10     5    1  12674
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7639404, 'precision': 0.68195593, 'recall': 0.64983183, 'specificity': 0.9762616, 'f1': 0.6524639, 'auroc': 0.8708629}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1090     0    1   1    2    1    23     9     2   38     3
1      3  1215    2  13    1    1     0   209     4   15    36
2     13     3  254   8  475    8    10    24    48   64   108
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0  529    0     5     2     3    1  1091
5      4     0    2  36    4  320     0     0    11  212     3
6      0     0    0   0    5    0  3012     1     0    2    47
7      7     0    1  60    0    0     2  1086     0    4     4
8      1     0    3  67   17    1     3    17  1242   10     9
9     12     4  308  38   19   86     2    33    63  554    18
10     0     0    0   0   28    0     1     0     0    0  1617
better model found
persisted
after epoch: 9,now: 2024-08-04 09:49:29.612790,epoch time: 0:51:27.213423,used: 7:57:58.356696,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97217464, 'precision': 0.91497, 'recall': 0.91879636, 'specificity': 0.99707127, 'f1': 0.91526407, 'auroc': 0.99902475}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     0    0    0    10     0     1    3     17
1     0  1317    0     1    1    0     2     8     3    0      0
2     0     0  269     1   18    0     0     0     3   21      0
3     0     4    1  8132    0    7     3   197    93    2      0
4     2     0   34     0  429    1     2     1     6    0     64
5     1     0    3     5    0  398     0     0     4  109      1
6     9     0    0     0    0    0  1888     0     2    0      9
7     0    33    2    35    2    0     4  7161    20    1      7
8     2     0    5    18    9    1     1    38  3199    3     19
9     0     0   47     1    1   17     1     0     2  424      0
10   10     0    1     6   60    0     8     5    31    1  12667
---- Validation: 
scalar performance:
{'acc': 0.97338504, 'precision': 0.91434073, 'recall': 0.91986763, 'specificity': 0.9972305, 'f1': 0.91523206, 'auroc': 0.99907565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    2     0    0    0    11     1     0    1     12
1     0  1314    1     2    0    0     0    11     4    0      0
2     0     0  264     0   17    0     1     0     3   27      0
3     1     2    1  8147    1   12     7   178    90    1      0
4     5     0   36     2  434    0     2     1     3    2     54
5     0     0    3     2    0  399     0     0     6  110      1
6     4     0    0     1    3    0  1892     1     2    0      5
7     0    29    1    28    1    0     3  7172    24    1      6
8     1     0    7    21   11    1     0    29  3210    3     13
9     0     0   56     1    0    9     0     0     2  425      0
10    8     0    1     5   55    0    14     6    30    0  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7836004, 'precision': 0.7063881, 'recall': 0.65988344, 'specificity': 0.97800815, 'f1': 0.669045, 'auroc': 0.881768}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1069     0    0   3    3    0    72     1     2   19     1
1      7  1293    1  10    1    1    23   123     6   19    15
2      9     2  345   0  412    3    60     8    74   63    39
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    4   0  659    0    36     1    10    1   921
5      7     0    8  26    2  233     1     0     7  306     2
6      0     0    0   0    0    0  3066     0     0    1     0
7      2     1    3  69    0    0    34  1044     8    3     0
8      0     0    2  51   15    0    17     1  1264   17     3
9      9     3  314  24   21   45    12     7    56  637     9
10     0     0    0   0   41    0    15     0     0    0  1590
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-04 10:41:10.792351,epoch time: 0:51:41.179561,used: 8:49:39.536257,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:49:39.536257 at 2024-08-04 10:41:10.792351
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7836004, 'precision': 0.7063881, 'recall': 0.65988344, 'specificity': 0.97800815, 'f1': 0.669045, 'auroc': 0.881768}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1069     0    0   3    3    0    72     1     2   19     1
1      7  1293    1  10    1    1    23   123     6   19    15
2      9     2  345   0  412    3    60     8    74   63    39
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    4   0  659    0    36     1    10    1   921
5      7     0    8  26    2  233     1     0     7  306     2
6      0     0    0   0    0    0  3066     0     0    1     0
7      2     1    3  69    0    0    34  1044     8    3     0
8      0     0    2  51   15    0    17     1  1264   17     3
9      9     3  314  24   21   45    12     7    56  637     9
10     0     0    0   0   41    0    15     0     0    0  1590
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7836004, 'precision': 0.7063881, 'recall': 0.65988344, 'specificity': 0.97800815, 'f1': 0.669045, 'auroc': 0.881768}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1069     0    0   3    3    0    72     1     2   19     1
1      7  1293    1  10    1    1    23   123     6   19    15
2      9     2  345   0  412    3    60     8    74   63    39
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    4   0  659    0    36     1    10    1   921
5      7     0    8  26    2  233     1     0     7  306     2
6      0     0    0   0    0    0  3066     0     0    1     0
7      2     1    3  69    0    0    34  1044     8    3     0
8      0     0    2  51   15    0    17     1  1264   17     3
9      9     3  314  24   21   45    12     7    56  637     9
10     0     0    0   0   41    0    15     0     0    0  1590
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_01_51_30_seed_0_24051365_instance_wise_predictions.txt
accuracy from prediction file 0.7836003638144546
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/14.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4043 MiB |  28233 MiB |   1176 TiB |   1176 TiB |
|       from large pool |   4020 MiB |  28184 MiB |   1170 TiB |   1170 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4043 MiB |  28233 MiB |   1176 TiB |   1176 TiB |
|       from large pool |   4020 MiB |  28184 MiB |   1170 TiB |   1170 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   1174 TiB |   1174 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   1167 TiB |   1167 TiB |
|       from small pool |     22 MiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29226 MiB |  29226 MiB |  29226 MiB |      0 B   |
|       from large pool |  29174 MiB |  29174 MiB |  29174 MiB |      0 B   |
|       from small pool |     52 MiB |     52 MiB |     52 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 720965 KiB |   2135 MiB | 344201 GiB | 344200 GiB |
|       from large pool | 703672 KiB |   2134 MiB | 337135 GiB | 337134 GiB |
|       from small pool |  17293 KiB |     22 MiB |   7065 GiB |   7065 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   69699 K  |   69696 K  |
|       from large pool |     502    |    1018    |   33866 K  |   33865 K  |
|       from small pool |    3168    |    4690    |   35833 K  |   35830 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   69699 K  |   69696 K  |
|       from large pool |     502    |    1018    |   33866 K  |   33865 K  |
|       from small pool |    3168    |    4690    |   35833 K  |   35830 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     707    |     707    |     707    |       0    |
|       from large pool |     681    |     681    |     681    |       0    |
|       from small pool |      26    |      26    |      26    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     220    |    1252    |   37199 K  |   37198 K  |
|       from large pool |     185    |     459    |   21681 K  |   21681 K  |
|       from small pool |      35    |    1067    |   15517 K  |   15517 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28233 MiB |   1176 TiB |   1176 TiB |
|       from large pool |  16640 KiB |  28184 MiB |   1170 TiB |   1170 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28233 MiB |   1176 TiB |   1176 TiB |
|       from large pool |  16640 KiB |  28184 MiB |   1170 TiB |   1170 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1174 TiB |   1174 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1167 TiB |   1167 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4748 MiB |  29226 MiB |  29226 MiB |  24478 MiB |
|       from large pool |   4708 MiB |  29174 MiB |  29174 MiB |  24466 MiB |
|       from small pool |     40 MiB |     52 MiB |     52 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2135 MiB | 344203 GiB | 344203 GiB |
|       from large pool | 134912 KiB |   2134 MiB | 337137 GiB | 337137 GiB |
|       from small pool |      0 KiB |     34 MiB |   7065 GiB |   7065 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69699 K  |   69699 K  |
|       from large pool |       2    |    1018    |   33866 K  |   33866 K  |
|       from small pool |       0    |    4690    |   35833 K  |   35833 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69699 K  |   69699 K  |
|       from large pool |       2    |    1018    |   33866 K  |   33866 K  |
|       from small pool |       0    |    4690    |   35833 K  |   35833 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     214    |     707    |     707    |     493    |
|       from large pool |     194    |     681    |     681    |     487    |
|       from small pool |      20    |      26    |      26    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1252    |   37199 K  |   37199 K  |
|       from large pool |       4    |     459    |   21681 K  |   21681 K  |
|       from small pool |       0    |    1067    |   15518 K  |   15518 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28233 MiB |   1176 TiB |   1176 TiB |
|       from large pool |  16640 KiB |  28184 MiB |   1170 TiB |   1170 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28233 MiB |   1176 TiB |   1176 TiB |
|       from large pool |  16640 KiB |  28184 MiB |   1170 TiB |   1170 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1174 TiB |   1174 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1167 TiB |   1167 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4748 MiB |  29226 MiB |  29226 MiB |  24478 MiB |
|       from large pool |   4708 MiB |  29174 MiB |  29174 MiB |  24466 MiB |
|       from small pool |     40 MiB |     52 MiB |     52 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2135 MiB | 344203 GiB | 344203 GiB |
|       from large pool | 134912 KiB |   2134 MiB | 337137 GiB | 337137 GiB |
|       from small pool |      0 KiB |     34 MiB |   7065 GiB |   7065 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69699 K  |   69699 K  |
|       from large pool |       2    |    1018    |   33866 K  |   33866 K  |
|       from small pool |       0    |    4690    |   35833 K  |   35833 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69699 K  |   69699 K  |
|       from large pool |       2    |    1018    |   33866 K  |   33866 K  |
|       from small pool |       0    |    4690    |   35833 K  |   35833 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     214    |     707    |     707    |     493    |
|       from large pool |     194    |     681    |     681    |     487    |
|       from small pool |      20    |      26    |      26    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1252    |   37199 K  |   37199 K  |
|       from large pool |       4    |     459    |   21681 K  |   21681 K  |
|       from small pool |       0    |    1067    |   15518 K  |   15518 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365

 Experiment start at: 2024-08-04 10:55:21.782931
before training, model accuracy: 0.06940460950136185
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92505884, 'precision': 0.83029604, 'recall': 0.7535982, 'specificity': 0.9918072, 'f1': 0.77414095, 'auroc': 0.99076}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   221     0    3     6    0    0   154    12     7    6     74
1     0  1194    1    13    0    0     2   115     2    0      2
2     1     0  218     3   22    2     7     9    16   31      3
3     2     0    3  7876    0   19     5   437    95    2      0
4     1     2   72     2  195    1    11     6    66   11    172
5     0     0   15    48    0  340     0     0     9  107      1
6     4     0    1     1    0    1  1863    12     8    3     15
7     2     7    0   178    1    0     7  7005    50    2     12
8     1     0    7   203    2    3     9   141  2851    0     79
9     2     1  125     8    1   84     5     5    11  245      5
10    2     1    9     7   27    2    68    42    69    0  12567
---- Validation: 
scalar performance:
{'acc': 0.9251571, 'precision': 0.83055997, 'recall': 0.76176155, 'specificity': 0.99181086, 'f1': 0.7783321, 'auroc': 0.99071366}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   207     0    0     7    0    0   169    12     3   10     75
1     0  1209    0    13    0    0     1   100     4    1      4
2     1     0  238     1    9    5     4     9    15   25      5
3     7     0    0  7850    1   24     0   462    96    0      0
4     1     2   74     1  204    3    19     8    40   11    176
5     0     0   14    42    0  354     1     0     8  101      1
6     2     0    0     1    1    0  1869    10     9    4     12
7     2     9    1   170    2    0     3  7014    49    1     14
8     4     1   10   197   11    1     8   139  2838    1     86
9     0     0  120    10    0   92     4     5    10  249      3
10    1     0    8     8   35    1    80    52    52    4  12555
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6537466, 'precision': 0.61068124, 'recall': 0.539181, 'specificity': 0.96468073, 'f1': 0.51306844, 'auroc': 0.8467529}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   619     0    1   13    0    6   444    17    20   28    22
1     0  1162    1   37    0    0    16   264     4    0    15
2     1    12   69   23   42   16    77    75   591   28    81
3     0     0    0    0    0    0     0     0     0    0     0
4     0     5    0    0  118    0    59     4    50    0  1397
5     6     0    5  116    0  342    28     1    27   67     0
6     0     3    0   14    0    0  2962     5    48    0    35
7     0     0    0   13    0    0    13  1135     1    0     2
8     0     0    0  173    0    4    10    14  1167    1     1
9    12    23  149  152    9  112    58    87   382  150     3
10    0     1    0    0    3    0    22     0     0    0  1620
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 11:48:24.518440,epoch time: 0:53:02.735509,used: 0:53:02.735509,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94279754, 'precision': 0.8611371, 'recall': 0.8011335, 'specificity': 0.99353254, 'f1': 0.8240983, 'auroc': 0.9939637}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     0    0    18    0    0     6    12     3    8     57
1     0  1274    0    20    0    0     0    35     2    0      1
2     9     0  165     1   46    1     3    13     1   55     18
3     0     2    1  8096    1   21     0   210   101    4      1
4     1     4   28     1  206    1     0     9    10   15    264
5     0     0    3    36    0  360     1     0     5  114      2
6    12     1    0    21    1    0  1840     6     2    2     23
7     0    50    0   201    1    0     1  6968    31    0     10
8     4     0    4   140   10    4     0   136  2888    4    105
9     6     1   48     3    2   62     1     4     4  353      9
10    9     1    2     8   10    1    10    25    16    3  12709
---- Validation: 
scalar performance:
{'acc': 0.9437475, 'precision': 0.868451, 'recall': 0.80385697, 'specificity': 0.99362314, 'f1': 0.8281286, 'auroc': 0.9942112}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    0    10    0    0     6    18     0    2     60
1     0  1276    0    15    0    0     0    40     1    0      0
2     8     1  164     0   41    0     2    15     1   61     19
3     1     1    1  8121    0   16     0   206    92    2      0
4     1     0   24     4  211    0     2     7    18   16    256
5     2     0    4    36    1  357     0     0     4  116      1
6    12     2    1    16    0    0  1838     7     2    3     27
7     1    51    0   196    1    0     1  6978    24    0     13
8     4     2    5   143    7    1     1   150  2878    6     99
9     8     0   42     7    3   52     4     5     2  359     11
10   10     1    1     8    8    1     9    29    13    3  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7245505, 'precision': 0.6166176, 'recall': 0.6185999, 'specificity': 0.9720201, 'f1': 0.59438294, 'auroc': 0.86349994}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   993     2    0   24    0    2    92    21     3   21    12
1     0  1380    0   29    0    2     5    76     0    0     7
2     6    23   82   10  168   12    78    43   167   97   329
3     0     0    0    0    0    0     0     0     0    0     0
4     1     6    0    0   46    0     9     3     9    0  1559
5     9     0    5   32    0  430    16     0     4   95     1
6     0     6    0    6    0    0  3042     0     2    0    11
7     0     4    0   14    0    0     4  1139     0    1     2
8     0     0    0  105    2    4    32    29  1183    2    13
9    15    33  268   56   15  122    45    54    74  419    36
10    0     4    0    0    0    0     0     0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 12:40:53.743774,epoch time: 0:52:29.225334,used: 1:45:31.960843,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9440818, 'precision': 0.8612578, 'recall': 0.8385729, 'specificity': 0.994037, 'f1': 0.8473123, 'auroc': 0.99599737}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   399     0    0     5    1    0    31     6     4    4     33
1     0  1239    0    10    0    0     0    80     3    0      0
2     2     0  163     1   60    2     1    20    14   47      2
3     0     0    0  7895    0    7     5   408   123    0      0
4     5     2   13     0  387    1     4     7    38    8     74
5     0     0    2    49    0  391     0     1     9   67      1
6     8     0    0     0    1    0  1874     6     6    3     10
7     0     6    0    87    1    0     2  7133    31    0      5
8     1     0    2    79    9    1     0   153  3033    1     17
9     3     0   53    10    1   63     0    11    14  337      1
10   18     3    2     6  219    1    28    34    44    0  12435
---- Validation: 
scalar performance:
{'acc': 0.9449244, 'precision': 0.86459297, 'recall': 0.84046435, 'specificity': 0.99410796, 'f1': 0.8501841, 'auroc': 0.9958953}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     1    0     4    0    0    21     8     2    4     31
1     0  1236    0    13    0    0     0    82     1    0      0
2     0     1  164     2   55    2     2    22    14   48      2
3     1     0    0  7908    0    8     4   396   122    1      0
4     4     1   11     0  387    1     4     9    29    8     85
5     0     0    2    53    0  393     1     1     8   62      1
6     9     0    0     1    1    0  1864     6    12    4     11
7     1     7    0    87    2    0     2  7127    34    0      5
8     1     0    2    64    9    1     3   148  3047    0     21
9     1     1   51    13    3   67     4    10    11  332      0
10   18     7    2     6  193    0    21    30    62    1  12456
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7064297, 'precision': 0.64664674, 'recall': 0.57750285, 'specificity': 0.9703037, 'f1': 0.5589489, 'auroc': 0.8585202}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   800     2   0   40    0    1   271    22     4   29     1
1     0  1168   0   19    1    0     3   306     0    0     2
2     2    15  14   25  217    8    89   139   425   34    47
3     0     0   0    0    0    0     0     0     0    0     0
4     0     5   0    0  708    0    12    10    15    0   883
5     2     0   0  193    1  292    33     4    24   43     0
6     0     2   0    2    2    0  3036    11     4    0    10
7     0     0   0   11    0    0     4  1147     0    0     2
8     0     0   0   66    0    0     4    58  1241    0     1
9     6    21  13  172   16  114    49   322   274  149     1
10    0     4   0    0   94    0     5     1     0    0  1542
better model found
persisted
after epoch: 3,now: 2024-08-04 13:31:37.495927,epoch time: 0:50:43.752153,used: 2:36:15.712996,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9561751, 'precision': 0.9028485, 'recall': 0.8561821, 'specificity': 0.9950796, 'f1': 0.8761941, 'auroc': 0.99687093}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    0     4    2    0     2     7     0    2     49
1     0  1287    0     4    0    0     0    32     5    0      4
2     2     0  202     2   36    0     1     2     5   54      8
3     0     3    1  7994    0    7     1   330   101    3      0
4     3     0   18     1  317    0     0     1     9    8    182
5     2     0    0    38    1  386     1     0     5   87      1
6    11     0    0     1    2    0  1841    12     4    3     31
7     0    12    0    64    1    0     1  7147    23    0     14
8     0     2    4    56   13    2     0   137  3026    2     53
9     7     0   27     6    2   44     2     2     5  395      3
10    9     0    1     6   18    0     2    14    17    1  12726
---- Validation: 
scalar performance:
{'acc': 0.9560251, 'precision': 0.8976155, 'recall': 0.8523825, 'specificity': 0.99508584, 'f1': 0.87163764, 'auroc': 0.9968288}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    1     4    0    0     3     4     1    2     47
1     0  1278    0     5    0    0     1    43     2    0      3
2     2     0  187     0   45    0     1     6     5   61      5
3     1     2    0  7986    0    9     1   341    99    1      0
4     2     0   18     0  321    1     1     4     8    6    178
5     3     0    0    42    0  380     1     0     4   90      1
6    11     0    1     1    3    0  1853     2     4    2     31
7     0    15    1    51    4    0     1  7155    29    1      8
8     1     1    3    49   16    1     0   130  3034    1     60
9     8     0   28     2    2   42     2     3     6  396      4
10   11     0    0     7   19    0     3    11    15    0  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71776396, 'precision': 0.6131089, 'recall': 0.60135144, 'specificity': 0.97124374, 'f1': 0.57742023, 'auroc': 0.8557001}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1086     0    0   3    2    0    36    16     5    6    16
1      1  1228    0  17    0    0     5   215     2    0    31
2      9     2   65   2  299    5    51    47   155   67   313
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    0   0   60    0     2     3     8    0  1559
5     21     0    0  49    5  293    73     0    14  134     3
6      0     0    0   0    0    0  3049     3     3    0    12
7      0     0    0  22    0    0     1  1137     0    0     4
8      0     0    0  56    3    0    12    22  1270    2     5
9     46     8  140  31   25   77    83    69   186  425    47
10     0     0    0   0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 4,now: 2024-08-04 14:23:34.754148,epoch time: 0:51:57.258221,used: 3:28:12.971217,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96131206, 'precision': 0.90524673, 'recall': 0.8669339, 'specificity': 0.99573004, 'f1': 0.88211846, 'auroc': 0.9975305}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0     5    1    0    11     3     2    6     31
1     0  1257    0     8    0    0     0    53    10    0      4
2     0     0  200     1   33    1     1     1     2   67      6
3     1     0    0  8227    0   11     0   127    68    2      0
4     5     0   20     0  316    1     4     4    14   11    164
5     0     0    0    16    0  406     0     0     2   96      1
6     7     0    1     1    0    0  1881     4     4    0     10
7     0     5    1   155    1    0     1  7014    75    3      8
8     1     0    4   106    7    4     1    55  3080    6     31
9     0     0   23     2    1   40     2     1     2  420      1
10   11     0    3     6   21    0     7     9    29    4  12705
---- Validation: 
scalar performance:
{'acc': 0.96150863, 'precision': 0.9039798, 'recall': 0.8663198, 'specificity': 0.99576145, 'f1': 0.8812556, 'auroc': 0.9976721}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    1     5    0    0     7     3     3    4     27
1     0  1263    0     8    0    0     0    55     5    0      1
2     0     0  193     0   40    1     1     2     1   72      2
3     0     0    1  8217    0   10     0   141    68    3      0
4     3     0   17     0  323    1     3     1    16   10    165
5     0     0    1    17    0  399     0     0     2  101      1
6     6     0    0     1    1    0  1882     6     2    2      8
7     0     3    1   162    2    0     1  7013    70    4      9
8     1     0    2   107    5    2     0    47  3102    5     25
9     0     0   29     4    1   42     0     0     1  415      1
10   11     0    3     8   17    0    12     6    30    3  12706
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72559994, 'precision': 0.64186996, 'recall': 0.61249566, 'specificity': 0.9720105, 'f1': 0.5947067, 'auroc': 0.85877436}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   976     0    1  12    1    2    93    21     4   45    15
1     1  1222    1  24    0    0    10   209    10    0    22
2     2     0  122   3  157    6   102    18   175   73   357
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0   75    0     8     0     8    0  1541
5     6     0    0  39    0  322    15     0    12  197     1
6     0     0    0   4    0    0  3052     2     5    0     4
7     0     0    0   9    0    1     0  1150     0    1     3
8     0     0    0  46    0    1    10     7  1297    2     7
9    10     0  178  38    8   59    62    46   163  511    62
10    0     0    0   0    0    0     2     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 15:18:37.561635,epoch time: 0:55:02.807487,used: 4:23:15.778704,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9642819, 'precision': 0.9041523, 'recall': 0.874082, 'specificity': 0.9960668, 'f1': 0.8872097, 'auroc': 0.9980296}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     4    2    0     1     0     0    1     29
1     0  1283    0    10    0    0     0    34     2    0      2
2     3     0  179     1   70    0     1     0     6   50      2
3     0     1    0  8276    0   12     0    94    53    2      0
4     6     0    7     3  385    0     0     1     8    4    125
5     1     0    0    24    0  409     0     0     5   81      1
6     5     0    0     2    3    0  1879     1     5    0     12
7     1     8    2   179    7    0     3  7016    32    2     15
8     1     0    4   107    7    3     0    88  3065    1     20
9     1     0   35     4    4   42     0     6     7  394      0
10   13     0    2     7   30    1     4    10    15    0  12709
---- Validation: 
scalar performance:
{'acc': 0.9652535, 'precision': 0.91205156, 'recall': 0.8821052, 'specificity': 0.9961619, 'f1': 0.8948867, 'auroc': 0.99808264}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     5    2    0     6     3     0    3     20
1     0  1285    0     9    0    0     0    37     1    0      0
2     3     0  192     1   60    0     0     3     4   47      2
3     0     0    0  8281    0    7     1   106    43    2      0
4     6     1    6     0  388    1     0     1     8    6    122
5     0     0    0    23    0  415     0     0     4   78      1
6     6     0    0     6    1    0  1878     1     3    2     11
7     3     5    0   173    2    0     3  7032    31    1     15
8     2     0    2    94   11    2     0   103  3049    2     31
9     1     0   28     6    4   39     0     3     0  412      0
10   16     1    2     4   32    0     3     8    17    3  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7029315, 'precision': 0.6226689, 'recall': 0.58954614, 'specificity': 0.9702313, 'f1': 0.5781642, 'auroc': 0.85706383}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1021     0    0   52    1    0    50    5     9   17    15
1      1  1277    0   37    0    1    10  157     3    0    13
2      2     0   61   13  355    7    31   26   192   67   261
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    1    0  127    0     1    0     6    0  1498
5      7     0    0  109    3  357     4    0    16   95     1
6      0     0    0    5    1    0  3007    3     5    0    46
7      0     0    0  210    0    1     3  945     0    0     5
8      0     0    0  107    2    2     2   10  1242    0     5
9     11     1  130  113   43  150    19   63   192  366    49
10     0     0    0    0    2    0     0    0     0    0  1644
better model found
persisted
after epoch: 6,now: 2024-08-04 16:18:32.104727,epoch time: 0:59:54.543092,used: 5:23:10.321796,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9667166, 'precision': 0.9123907, 'recall': 0.88603234, 'specificity': 0.9963197, 'f1': 0.8974114, 'auroc': 0.9983621}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     2    3    0     8     1     0    0     36
1     0  1270    0    14    0    0     0    43     2    0      3
2     1     0  199     0   64    1     0     2     4   39      2
3     0     0    0  8289    1    5     0    92    49    1      0
4     4     0    6     1  436    0     0     2     2    1     87
5     0     0    0    27    0  466     0     0     4   23      1
6     8     0    0     5    2    1  1866     2     2    0     22
7     0     7    1   162    1    0     2  7034    47    0     10
8     0     0    1    88   21    0     1    47  3079    0     57
9     0     0   40     5    6   97     0     0     0  344      1
10    6     0    4     7   43    1     2     6     8    0  12716
---- Validation: 
scalar performance:
{'acc': 0.96586865, 'precision': 0.9131055, 'recall': 0.8870963, 'specificity': 0.9962239, 'f1': 0.89794093, 'auroc': 0.99836445}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     1    1    0     5     2     0    1     44
1     0  1266    0    16    0    0     0    43     5    0      2
2     0     0  196     0   61    1     1     5     4   40      4
3     0     0    0  8269    0    6     0    97    67    1      0
4     3     0    6     0  432    1     0     2     6    2     87
5     0     0    0    13    1  472     0     0     5   29      1
6     5     0    1     2    1    1  1872     4     2    0     20
7     0     7    0   182    4    0     1  7030    30    0     11
8     1     0    3    84   25    2     0    38  3079    1     63
9     0     0   28     6    5   93     0     1     1  359      0
10    7     0    1     7   59    1     4     2     9    1  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6812426, 'precision': 0.6437032, 'recall': 0.57895285, 'specificity': 0.96822214, 'f1': 0.5705769, 'auroc': 0.84500515}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1001     0    0   25    1   10    54     7     7   17    48
1      3  1209    2   51    0    0     7   172     5    0    50
2      6     0   90   28  331   22    17    16   196   29   280
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    0  246    0     1     1     6    0  1378
5      4     0    0  168    6  388     0     0     2   19     5
6      0     0    0   14    1    0  2766     1     3    0   282
7      1     0    0  136    0    0     0  1019     5    0     3
8      0     0    0  196    1    1     2     1  1161    0     8
9     16     0  143  241   39  232    11    32   156  216    51
10     0     0    0    0    5    0     0     0     0    0  1641
better model found
persisted
after epoch: 7,now: 2024-08-04 17:20:47.051054,epoch time: 1:02:14.946327,used: 6:25:25.268123,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9675995, 'precision': 0.91687715, 'recall': 0.89270693, 'specificity': 0.99640894, 'f1': 0.90235126, 'auroc': 0.9982059}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    2     2    2    0     6     2     1    3     37
1     0  1289    0    11    0    0     0    27     4    0      1
2     0     0  266     1   26    0     0     0     4   13      2
3     0     0    2  8326    0   10     0    41    56    2      0
4     4     0   17     1  356    0     0     0    23    0    137
5     0     0    2    20    0  432     0     0     2   64      1
6     4     0    1     0    4    0  1858     2     2    2     34
7     1    10    7   188    4    0     1  6959    76    0     18
8     2     0    4    76    2    1     0    22  3176    1     12
9     0     0   80     4    3   36     0     0     2  368      0
10    7     0    2     6   14    1     1     3    51    1  12707
---- Validation: 
scalar performance:
{'acc': 0.9686505, 'precision': 0.91623443, 'recall': 0.89227796, 'specificity': 0.9965421, 'f1': 0.9021694, 'auroc': 0.99820983}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    2     1    2    0     7     1     1    3     35
1     0  1294    1     8    0    0     0    25     2    0      2
2     1     0  258     0   28    0     0     1     3   19      2
3     0     1    0  8304    0    9     0    58    66    2      0
4     3     0   21     0  355    0     0     0    18    2    140
5     0     0    2    15    0  428     0     0     7   68      1
6     5     0    1     1    3    0  1862     2     4    1     29
7     0     9   10   158    2    0     1  7004    70    1     10
8     1     1    5    68    1    1     0    26  3183    0     10
9     0     0   67     3    6   36     1     0     2  375      3
10    4     0    3     7   17    1     2     1    42    0  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68662983, 'precision': 0.6577295, 'recall': 0.57262325, 'specificity': 0.9689179, 'f1': 0.5879389, 'auroc': 0.8380794}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   939     0    1   49    1    0    78    0     2   54    46
1     4  1258    7   71    0    0    14   98     4    0    43
2     5     0  211   28  286    5    11    1   262   44   162
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  145    0     1    1    32    0  1452
5     3     0    0  133    9  311     1    0     5  128     2
6     0     0    1   10    2    0  2964    0    28    0    62
7     0     0    3  431    0    1     3  718     3    1     4
8     0     0    0  192    0    1     2    0  1172    1     2
9     4     0  246  198   25   77     6    7    89  452    33
10    0     0    0    0    1    0     0    0     1    0  1644
better model found
persisted
after epoch: 8,now: 2024-08-04 18:18:00.760517,epoch time: 0:57:13.709463,used: 7:22:38.977586,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.970168, 'precision': 0.9060879, 'recall': 0.91469526, 'specificity': 0.9968179, 'f1': 0.90842974, 'auroc': 0.9989229}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     0    0    0     2     1     0    2      5
1     0  1312    0     2    0    0     0    15     2    0      0
2     2     0  254     1   20    0     0     3     1   28      3
3     1     3    0  8271    0    6     0   133    23    2      0
4    11     1   28     1  390    0     0     1     8    5     93
5     1     0    1     4    1  450     0     0     3   60      0
6    32     0    1     1    1    0  1860     3     2    3      5
7     1    23    3   102    1    0     2  7090    36    0      6
8     3     2    7   107    8    3     1    35  3117    2     10
9     1     0   48     0    0   33     0     2     0  409      0
10   86     0    4     6   29    0     2     7    22    1  12636
---- Validation: 
scalar performance:
{'acc': 0.9716196, 'precision': 0.91228306, 'recall': 0.92079777, 'specificity': 0.99695855, 'f1': 0.9147468, 'auroc': 0.99891317}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     2    0    0     1     1     0    1      2
1     0  1313    0     4    0    0     0    12     2    0      1
2     1     0  267     1   16    0     0     0     1   24      2
3     1     6    0  8276    0   13     1   118    24    1      0
4     7     1   31     1  395    0     0     0     7    6     91
5     0     0    0     5    0  461     0     0     1   53      1
6    26     0    1     3    0    1  1861     7     3    0      6
7     0    27    2    92    2    1     1  7113    21    0      6
8     2     0    4   118    8    2     0    43  3108    2      9
9     4     0   50     3    0   33     0     0     0  403      0
10   73     0    3     6   29    0     4     8    20    2  12651
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74057233, 'precision': 0.67610353, 'recall': 0.6317748, 'specificity': 0.9741673, 'f1': 0.6239711, 'auroc': 0.85099196}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1126     0    0   13    0    0     6     5     0   20     0
1      4  1372    0   29    0    0     4    78     3    0     9
2     30     3  184   30  213   15    30    24   255   65   166
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    2    1  247    0     5     2    15    0  1359
5     15     0    1  115    0  387     2     0     1   69     2
6      9     0    0   11    0    0  3022     1     4    0    20
7      0     1    0   54    0    1     0  1105     1    0     2
8      2     0    0  237    0    2     2     6  1118    3     0
9     40     4  176  171    4  162    19    57    90  387    27
10     0     0    0    0    8    0     0     1     0    0  1637
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 19:24:26.798876,epoch time: 1:06:26.038359,used: 8:29:05.015945,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9754388, 'precision': 0.94433475, 'recall': 0.9045943, 'specificity': 0.99726653, 'f1': 0.92112225, 'auroc': 0.9991395}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     0    1    0     9     2     1    2     38
1     0  1299    0     7    0    0     0    24     2    0      0
2     0     0  204     1   33    0     0     6     4   62      2
3     1     2    0  8324    0    7     0    57    44    2      0
4     3     0    4     0  388    1     0     2    14    6    121
5     0     0    0     5    0  479     0     0     6   30      1
6     1     0    0     0    0    0  1894     0     2    1      9
7     1     7    0   121    1    0     1  7102    25    0      5
8     0     0    4    55    1    0     0    45  3182    0      9
9     0     0    7     3    2   47     0     2     1  431      0
10    2     0    1     7    9    1     9     4    34    1  12725
---- Validation: 
scalar performance:
{'acc': 0.97525746, 'precision': 0.94267684, 'recall': 0.9033278, 'specificity': 0.9972505, 'f1': 0.9197966, 'auroc': 0.9990541}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     0    1    0    15     2     1    1     32
1     0  1303    0     1    0    0     0    24     4    0      0
2     1     0  212     1   25    0     0     3     1   69      0
3     0     0    0  8346    0    8     0    47    39    0      0
4     2     1    8     1  379    0     2     1    19    1    125
5     0     0    0     5    0  474     0     0     4   37      1
6     2     0    0     0    0    1  1886     2     3    1     13
7     0     7    0   134    1    0     2  7091    25    0      5
8     1     0    2    63    2    0     0    38  3181    0      9
9     1     0    6     1    2   53     1     2     3  424      0
10    2     1    1     7    9    1     7     6    27    2  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7108375, 'precision': 0.63848054, 'recall': 0.60467875, 'specificity': 0.9704608, 'f1': 0.57607704, 'auroc': 0.85309017}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   782     0   0   6    0    1   321    11     2   16    31
1     0  1296   0  25    0    5    15   136     4    0    18
2     6     0  80   5  210   23    39    31   351   61   209
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   1   0  122    0    16     2    24    0  1468
5    13     0   0  45    2  465    11     0    11   42     3
6     0     0   0   2    0    0  3043     1     6    0    15
7     1     0   0  37    0    1    12  1107     2    0     4
8     0     0   0  78    0    7    10     7  1267    0     1
9    22     1  73  62   10  257    52    46   216  359    39
10    0     0   0   0    3    0     3     0     1    0  1639
better model found
persisted
after epoch: 10,now: 2024-08-04 20:28:36.580897,epoch time: 1:04:09.782021,used: 9:33:14.797966,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 9:33:14.797966 at 2024-08-04 20:28:36.580897
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7108375, 'precision': 0.63848054, 'recall': 0.60467875, 'specificity': 0.9704608, 'f1': 0.57607704, 'auroc': 0.85309017}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   782     0   0   6    0    1   321    11     2   16    31
1     0  1296   0  25    0    5    15   136     4    0    18
2     6     0  80   5  210   23    39    31   351   61   209
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   1   0  122    0    16     2    24    0  1468
5    13     0   0  45    2  465    11     0    11   42     3
6     0     0   0   2    0    0  3043     1     6    0    15
7     1     0   0  37    0    1    12  1107     2    0     4
8     0     0   0  78    0    7    10     7  1267    0     1
9    22     1  73  62   10  257    52    46   216  359    39
10    0     0   0   0    3    0     3     0     1    0  1639
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74057233, 'precision': 0.67610353, 'recall': 0.6317748, 'specificity': 0.9741673, 'f1': 0.6239711, 'auroc': 0.85099196}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1126     0    0   13    0    0     6     5     0   20     0
1      4  1372    0   29    0    0     4    78     3    0     9
2     30     3  184   30  213   15    30    24   255   65   166
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    2    1  247    0     5     2    15    0  1359
5     15     0    1  115    0  387     2     0     1   69     2
6      9     0    0   11    0    0  3022     1     4    0    20
7      0     1    0   54    0    1     0  1105     1    0     2
8      2     0    0  237    0    2     2     6  1118    3     0
9     40     4  176  171    4  162    19    57    90  387    27
10     0     0    0    0    8    0     0     1     0    0  1637
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_10_55_20_seed_1_24051365_instance_wise_predictions.txt
accuracy from prediction file 0.7108374728888267
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4044 MiB |  28233 MiB |   2353 TiB |   2353 TiB |
|       from large pool |   4021 MiB |  28184 MiB |   2340 TiB |   2340 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4044 MiB |  28233 MiB |   2353 TiB |   2353 TiB |
|       from large pool |   4021 MiB |  28184 MiB |   2340 TiB |   2340 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   2348 TiB |   2348 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   2335 TiB |   2335 TiB |
|       from small pool |     22 MiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29984 MiB |  29984 MiB |  54462 MiB |  24478 MiB |
|       from large pool |  29932 MiB |  29932 MiB |  54398 MiB |  24466 MiB |
|       from small pool |     52 MiB |     52 MiB |     64 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    849 MiB |   2234 MiB | 705317 GiB | 705316 GiB |
|       from large pool |    834 MiB |   2232 MiB | 691161 GiB | 691160 GiB |
|       from small pool |     14 MiB |     34 MiB |  14155 GiB |  14155 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |  139401 K  |  139397 K  |
|       from large pool |     502    |    1018    |   67732 K  |   67732 K  |
|       from small pool |    3168    |    4690    |   71668 K  |   71665 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |  139401 K  |  139397 K  |
|       from large pool |     502    |    1018    |   67732 K  |   67732 K  |
|       from small pool |    3168    |    4690    |   71668 K  |   71665 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     704    |     707    |    1197    |     493    |
|       from large pool |     678    |     681    |    1165    |     487    |
|       from small pool |      26    |      26    |      32    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     223    |    1252    |   74404 K  |   74404 K  |
|       from large pool |     187    |     459    |   43088 K  |   43088 K  |
|       from small pool |      36    |    1067    |   31315 K  |   31315 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28233 MiB |   2353 TiB |   2353 TiB |
|       from large pool |  16640 KiB |  28184 MiB |   2340 TiB |   2340 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28233 MiB |   2353 TiB |   2353 TiB |
|       from large pool |  16640 KiB |  28184 MiB |   2340 TiB |   2340 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   2348 TiB |   2348 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   2335 TiB |   2335 TiB |
|       from small pool |      0 KiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4894 MiB |  29984 MiB |  54462 MiB |  49568 MiB |
|       from large pool |   4856 MiB |  29932 MiB |  54398 MiB |  49542 MiB |
|       from small pool |     38 MiB |     52 MiB |     64 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2234 MiB | 705319 GiB | 705319 GiB |
|       from large pool | 134912 KiB |   2232 MiB | 691163 GiB | 691163 GiB |
|       from small pool |      0 KiB |     34 MiB |  14155 GiB |  14155 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |  139401 K  |  139401 K  |
|       from large pool |       2    |    1018    |   67732 K  |   67732 K  |
|       from small pool |       0    |    4690    |   71668 K  |   71668 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |  139401 K  |  139401 K  |
|       from large pool |       2    |    1018    |   67732 K  |   67732 K  |
|       from small pool |       0    |    4690    |   71668 K  |   71668 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     213    |     707    |    1197    |     984    |
|       from large pool |     194    |     681    |    1165    |     971    |
|       from small pool |      19    |      26    |      32    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1252    |   74405 K  |   74405 K  |
|       from large pool |       4    |     459    |   43088 K  |   43088 K  |
|       from small pool |       0    |    1067    |   31316 K  |   31316 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 20:35:06 2024]
Finished job 0.
1 of 1 steps (100%) done
