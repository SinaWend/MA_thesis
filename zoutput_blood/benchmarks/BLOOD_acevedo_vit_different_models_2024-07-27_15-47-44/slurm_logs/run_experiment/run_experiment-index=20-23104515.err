Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 19:15:16 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/20.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=20
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515

 Experiment start at: 2024-07-27 19:24:34.863059
before training, model accuracy: 0.1378297060728073
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.56260705, 'precision': 0.5447093, 'recall': 0.5061862, 'specificity': 0.95706475, 'f1': 0.43744892, 'auroc': 0.9277105}
confusion matrix:
    0     1   2     3   4    5      6     7     8    9   10
0   19     3   0    42   2   16    177    72   138   14   0
1    0  1144   0    24   0    1     18   127    17    0   0
2    1     1   0     6   1   22     31    62   109   79   0
3    0     0   0  8125   0    7      0   150   157    0   0
4    3     0   0     3   0    6    307    19   188   12   1
5    0     0   0   122   0  264      3     0    12  120   0
6    0     1   0    40   1    5   1744    25    91    0   0
7    0     4   0   576   0    1      9  6513   160    0   0
8    0     0   0   228   0    5      9    84  2968    1   0
9    0     6   0    34   0  143      4    26    40  240   0
10  18     3   0    11   0    4  11945    43   754    4  11
---- Validation: 
scalar performance:
{'acc': 0.564451, 'precision': 0.53911734, 'recall': 0.5102804, 'specificity': 0.95727485, 'f1': 0.44104254, 'auroc': 0.92791146}
confusion matrix:
    0     1   2     3   4    5      6     7     8    9   10
0   18     4   0    53   1    9    170    68   141   16   3
1    0  1142   0    19   0    2     21   129    19    0   0
2    1     4   0     5   0   20     29    60   112   81   0
3    0     0   0  8147   0    6      0   136   151    0   0
4    1     0   0     2   0    9    306    12   199   10   0
5    0     3   0   111   0  275      4     1    17  110   0
6    0     3   0    39   1    3   1738    21   102    1   0
7    1     4   0   541   0    0      8  6556   153    2   0
8    0     0   0   218   0    0     18    99  2959    2   0
9    0     5   0    30   0  151      5    19    30  253   0
10  18     2   0    11   0    5  11943    54   745    4  14
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40439376, 'precision': 0.38168666, 'recall': 0.33926916, 'specificity': 0.93663836, 'f1': 0.28270116, 'auroc': 0.7824361}
confusion matrix:
    0    1   2    3   4    5     6     7     8    9   10
0   18   13   0   78   5   11   339   292   380   31   3
1    1  896   0   48   1    1    99   384    68    1   0
2    0    1   0   13   0   16   107    79   762   37   0
3    0    0   0    0   0    0     0     0     0    0   0
4    2    0   0    0   0    0  1509     1   121    0   0
5    0    4   0  157   0  240    14     5    88   84   0
6    0    0   0   33   0    0  2059     5   970    0   0
7    0    0   0   33   0    1     2  1117    11    0   0
8    0    0   0   71   0    1     5     3  1289    1   0
9    0    6   0   94   0   96    49   166   563  161   2
10   0    0   0    0   0    0  1638     0     8    0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 19:48:13.050653,epoch time: 0:23:38.187594,used: 0:23:38.187594,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5989137, 'precision': 0.5964885, 'recall': 0.591969, 'specificity': 0.961055, 'f1': 0.5141199, 'auroc': 0.9721626}
confusion matrix:
     0     1   2     3   4    5      6     7     8    9    10
0   262     0   0     7   0    1     83    24    73   18   15
1     1  1257   0    21   0    1     22    24     4    1    1
2     7     3   0     7   0    9     60    19    45  153    9
3     0     1   0  8136   0   43      5   103   141    8    1
4    10     0   0     3   0   14    418     4    59   20   11
5     0     0   0    24   0  155      2     0     6  333    0
6     2     0   0    12   0    4   1873     0    11    6    0
7     6    30   0   427   0    2     20  6620   148    8    1
8     1     0   0   119   0    5     47    63  3050    8    3
9     2     0   0     5   0   25      2     2    14  443    0
10   46     1   0    12   0    4  11982    11   140    8  589
---- Validation: 
scalar performance:
{'acc': 0.59810084, 'precision': 0.58917546, 'recall': 0.59044236, 'specificity': 0.96096647, 'f1': 0.5115999, 'auroc': 0.97131455}
confusion matrix:
     0     1   2     3   4    5      6     7     8    9    10
0   269     0   0    11   0    3     74    20    70   15   21
1     0  1253   0    24   1    3     18    25     8    0    0
2     5     3   0    13   0   13     60    17    44  146   11
3     1     1   0  8165   0   47      4    88   125    8    1
4    12     0   0     5   0   16    408     4    62   22   10
5     0     0   0    21   0  149      1     0     6  344    0
6     5     1   0     9   0    3   1876     1    10    3    0
7     2    35   0   433   0    1     17  6616   154    4    3
8     1     0   0   136   0    2     49    55  3039   10    4
9     1     1   0     5   0   33      2     2    13  436    0
10   52     2   0     9   0    8  12012    12   136    8  557
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5341076, 'precision': 0.4333497, 'recall': 0.41555807, 'specificity': 0.94941366, 'f1': 0.36702767, 'auroc': 0.8534925}
confusion matrix:
     0     1   2   3   4   5     6     7     8    9   10
0   424     0   0   6   1   1   178   106   414   34   6
1     0  1227   0  17   1   4    66   122    51   11   0
2    13     1   0  26   0   3   234    21   569  143   5
3     0     0   0   0   0   0     0     0     0    0   0
4     1     0   0   0   0   1  1583     0    46    0   2
5     1     0   0  22   0  21     4     0    27  517   0
6     0     0   0   1   0   0  3020     1    45    0   0
7     0     0   0  79   0   0     9  1029    43    4   0
8     0     0   0  24   0   2    24     2  1308   10   0
9     4     6   0  29   0   7    29    25   430  602   5
10    0     0   0   0   0   0  1640     0     3    0   3
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 20:10:47.776122,epoch time: 0:22:34.725469,used: 0:46:12.913063,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7890625, 'precision': 0.6221888, 'recall': 0.6514176, 'specificity': 0.97912216, 'f1': 0.6066643, 'auroc': 0.98269355}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9     10
0   326     0   0     2   0    1    45    18     9    2    79
1     0  1233   0     8   0    1     8    66    11    1     3
2    11     0   0     1   0   35   100    22     6  118    19
3     1     0   0  7751   0   24     1   317   335    8     3
4     3     0   0     1   0   10   438     2    14    8    63
5     0     0   0    33   0  199     1     0     7  279     2
6    13     0   0     3   1    4  1854    12     7    0    14
7    14     9   0   119   0    1     4  6950   146    7    11
8     3     0   0    37   0    4    33    69  3070    9    71
9     3     0   0     2   0   64     4     6     8  394    12
10   15     0   0     7   0    1  5018     7    27    3  7715
---- Validation: 
scalar performance:
{'acc': 0.7897552, 'precision': 0.6222115, 'recall': 0.65525633, 'specificity': 0.9792261, 'f1': 0.60811985, 'auroc': 0.98231506}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9     10
0   332     0   0     4   0    2    28    17     6    1    93
1     0  1245   0     9   0    1     9    57     7    1     3
2    13     0   0     1   0   28   104    28     4  112    22
3     0     0   0  7733   0   26     0   305   357   18     1
4     6     0   0     0   0   10   441     4    18    9    51
5     0     0   0    24   0  201     1     0     5  290     0
6    10     0   0     3   2    1  1861     8    10    0    13
7    11     6   0   121   0    1     6  6953   148    6    13
8     1     0   0    31   0    7    39    68  3081   13    56
9     4     0   0     1   0   65     2    10     6  401     4
10   22     0   0     7   0    1  5006     7    31    4  7718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55600643, 'precision': 0.46697038, 'recall': 0.45482802, 'specificity': 0.9517131, 'f1': 0.41962492, 'auroc': 0.8444343}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9    10
0   735     0   0   7   3    3    75   182    91   24   50
1    12  1012   0  15   0    0    35   359    27    5   34
2    28     0   0   4   0   19   373    84   326   79  102
3     0     0   0   0   0    0     0     0     0    0    0
4     2     0   0   0   0    0  1580     2    18    0   31
5     4     0   0  51   0  153     7     6    38  333    0
6     0     0   0   4   0    0  2928     5   130    0    0
7     0     0   0   3   0    0     0  1150     7    1    3
8     0     0   0  15   0    1    13    10  1329    2    0
9    28     1   0  16   0   30    28   180   315  514   25
10    0     0   0   0   0    0  1519     0     1    0  126
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-27 20:33:27.441046,epoch time: 0:22:39.664924,used: 1:08:52.577987,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9005779, 'precision': 0.72406936, 'recall': 0.7112508, 'specificity': 0.9897886, 'f1': 0.68754804, 'auroc': 0.98061883}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   362     0   0     8   0    1    14    19    19    4     56
1     0  1257   0    13   0    0     5    49     5    1      2
2     2     0   0     1   0    2    35   116    42   93     21
3     0     1   0  7864   0   11     0   312   249    1      1
4     5     0   0     3   1    5   316    31    77   11     89
5     0     0   0    53   0  337     1     0     9  120      1
6    20     0   0     6   0    1  1858     3    10    0     10
7     1     3   0    87   1    0     3  7039   126    1      3
8     3     0   0    50   0    0     5    62  3168    2      6
9     1     0   0     8   0   66     0    19    26  372      1
10   40     1   0    12   0    3  1076    21   232    3  11402
---- Validation: 
scalar performance:
{'acc': 0.90204626, 'precision': 0.67964876, 'recall': 0.71214134, 'specificity': 0.98993975, 'f1': 0.68861455, 'auroc': 0.98022187}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   374     0   0     6   0    0     8    17    21    5     52
1     0  1263   0    12   0    2     3    42     7    0      3
2     6     1   0     1   0    5    32   107    58   79     23
3     0     1   0  7890   0   12     1   292   242    2      0
4     3     2   0     3   0    6   306    31    87    8     93
5     0     0   0    49   0  330     1     0    11  130      0
6    12     0   0     8   0    2  1863     2    11    1      9
7     2     5   0   109   0    0     2  7024   117    1      5
8     2     0   0    45   0    0     5    66  3175    1      2
9     1     0   0     7   0   72     1    19    27  366      0
10   34     1   0     7   1    2  1069    33   210    1  11438
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62268245, 'precision': 0.52132666, 'recall': 0.5252458, 'specificity': 0.95988786, 'f1': 0.4984737, 'auroc': 0.8500709}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9    10
0   885     0   0  12   0    3    36   109    96   13   16
1     0  1274   0  32   0    1    14   141    35    0    2
2     6     0   0   6   0    8   201   176   524   53   41
3     0     0   0   0   0    0     0     0     0    0    0
4     2     0   0   0   0    0  1301     5    78    0  247
5     3     0   0  79   0  320     5     6    35  143    1
6     0     0   0  16   0    0  2801     4   246    0    0
7     0     0   0  65   0    0     2  1075    21    0    1
8     0     0   0  38   0    2     4     2  1323    1    0
9    19     4   0  56   0   74    19   190   446  316   13
10    0     1   0   0   0    0   735     0     4    0  906
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 20:56:14.633144,epoch time: 0:22:47.192098,used: 1:31:39.770085,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9326573, 'precision': 0.73005104, 'recall': 0.73283803, 'specificity': 0.99286246, 'f1': 0.71276665, 'auroc': 0.98326737}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   371     0   0     2   0    2     7     8     1    7     85
1     0  1236   0    13   0    2     1    73     4    0      3
2     3     2   0     0   2    7    48    57    19  159     14
3     1     3   0  8201   0   22     0   125    83    3      0
4     3     7   0     0   1    9   347    13    23   17    119
5     0     0   0    23   0  431     0     0     4   61      1
6     8     0   0    10   0    5  1852     5     5    0     22
7     2     6   0   139   0    0     2  7073    31    2      8
8     3     0   0    89   0    3    17   127  2988   10     58
9     1     0   0     3   0  114     1     3     3  368      0
10   28     0   0     9   0    2   381    18    16    3  12338
---- Validation: 
scalar performance:
{'acc': 0.93146986, 'precision': 0.7886062, 'recall': 0.7290665, 'specificity': 0.9927219, 'f1': 0.7103237, 'auroc': 0.98377454}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   372     0   0     2   0    2     5    13     0    7     82
1     0  1242   0    11   0    1     1    71     0    1      5
2     4     5   0     0   0    8    53    60    22  154      6
3     0     1   0  8195   0   21     0   134    83    5      1
4     4     7   0     0   3   13   333    11    20   19    129
5     0     0   0    20   0  422     0     0     3   75      1
6     9     0   0    13   0    8  1851     2     3    4     18
7     2     4   0   140   0    1     3  7077    29    1      8
8     3     1   0   110   0    4    14   151  2949    6     58
9     0     0   0     4   0  118     0    11     2  358      0
10   20     1   0     8   0    2   371    22    13    5  12354
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66829914, 'precision': 0.5268316, 'recall': 0.56459594, 'specificity': 0.9656644, 'f1': 0.52657115, 'auroc': 0.8409607}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   888     0   0  10   1    2    26   126     3   44    70
1     1  1068   0  25   0    2     5   379     6    2    11
2    15     0   0   5   8   20   282   155   240  118   172
3     0     0   0   0   0    0     0     0     0    0     0
4     3     0   0   0   0    0   651     3     8    0   968
5     1     0   0  57   0  297     0     3    14  218     2
6     1     0   0  36   0    0  2810    18   123    0    79
7     0     0   0  10   0    0     0  1150     0    1     3
8     0     0   0  88   0    0     2    30  1245    3     2
9     8     1   0  35   1   75     7   236   186  560    28
10    0     0   0   0   0    0   111     0     1    0  1534
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 21:19:13.779612,epoch time: 0:22:59.146468,used: 1:54:38.916553,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9429313, 'precision': 0.76588047, 'recall': 0.73796517, 'specificity': 0.99374783, 'f1': 0.7305149, 'auroc': 0.98877805}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   382     0   0     1   0    1     2    33     2    7     55
1     0  1270   0    11   0    1     1    43     2    1      3
2     2     0   0    84  20    1    33    43     4  117      8
3     0     0   0  8236   0    9     0    90    98    4      1
4     4     2   1    21  16    2   267    15    10    8    193
5     1     0   0    25   0  327     1     1     4  160      1
6    10     1   0     7   0    1  1857    11     2    0     19
7     0     7   0   184   0    0     2  7041    19    3      5
8     4     1   0    95   0    2     5   141  3002    8     38
9     0     0   0    10   1   29     0     9     3  441      0
10   31     0   0     9   0    1    37    20    24    1  12671
---- Validation: 
scalar performance:
{'acc': 0.94224954, 'precision': 0.7730792, 'recall': 0.7370244, 'specificity': 0.99365014, 'f1': 0.73166597, 'auroc': 0.9882804}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   378     0   0     5   0    1     1    32     3    5     58
1     0  1273   0     9   1    0     0    40     2    2      5
2     1     0   0    89  17    1    41    51     3  100      9
3     0     1   0  8243   0    8     0    88    98    1      1
4     5     1   0    24  19    2   254    10    16    9    199
5     1     0   0    25   0  335     0     0     3  156      1
6    12     0   0    11   0    0  1854     8     4    1     18
7     0     9   0   210   0    0     2  7012    25    0      7
8     2     0   0    83   0    1     7   137  3025    3     38
9     1     0   0    14   0   39     1     5     2  429      2
10   28     1   0    11   0    1    53    17    24    3  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6858602, 'precision': 0.5564714, 'recall': 0.5652127, 'specificity': 0.968193, 'f1': 0.52813643, 'auroc': 0.864989}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   902     0   0   7   0    1     8   200     9   26    17
1     0  1287   0  17   0    5     1   170     3    2    14
2    25     3   0  55   3    0   144   227    69  118   371
3     0     0   0   0   0    0     0     0     0    0     0
4     3     0   0   0   0    0    64     2     4    0  1560
5     2     0   0  43   0  148     2    17    20  355     5
6     8     0   0   8   0    1  2833     4     8    0   205
7     0     0   0  92   0    0     0  1068     0    1     3
8     0     0   0  29   0    1     7    31  1289    5     8
9    10    10   0  31   0   12     5   313    76  636    44
10    0     0   0   0   0    0     5     0     1    0  1640
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 21:41:59.006816,epoch time: 0:22:45.227204,used: 2:17:24.143757,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9422089, 'precision': 0.88508797, 'recall': 0.73706305, 'specificity': 0.99357986, 'f1': 0.74721974, 'auroc': 0.98956466}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   336     1   0     5   0    1    38    29     5    2     66
1     0  1268   0    15   0    1     1    41     2    1      2
2     2     0   1   159  38    0    16    21     3   65      7
3     0     1   0  8308   0   11     0    80    39    0      1
4     2     0   0    33  75    3   224     4    12    8    178
5     0     0   0    30   0  361     0     0     3  126      1
6     2     0   0     9   0    0  1872     3     4    0     18
7     0     4   0   232   0    0     3  6994    22    1      7
8     1     0   0   148   0    1     9   123  2968    4     42
9     0     0   0    32   0   55     0     5     2  398      1
10    8     0   0    11   3    2    90    21    19    1  12635
---- Validation: 
scalar performance:
{'acc': 0.9423833, 'precision': 0.7907609, 'recall': 0.7371929, 'specificity': 0.99359256, 'f1': 0.7469499, 'auroc': 0.9900548}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   333     0   0     4   0    0    30    31     3    5     77
1     0  1261   0    17   0    0     1    45     4    0      4
2     0     0   0   155  42    1    14    27     3   66      4
3     0     0   0  8307   0    9     0    83    41    0      0
4     2     0   0    34  70    2   220     8    15    7    181
5     0     0   0    20   0  384     0     0     3  113      1
6     4     1   0     5   0    0  1881     3     2    0     12
7     0     6   0   223   1    0     1  7005    20    2      7
8     1     0   0   159   2    2    10   116  2963    1     42
9     0     0   0    32   0   57     2     9     4  387      2
10   10     0   0    14   3    0   103    10    14    2  12640
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6610229, 'precision': 0.55066824, 'recall': 0.54306734, 'specificity': 0.9657084, 'f1': 0.52007675, 'auroc': 0.8597345}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   662     0   0   18   0    4   170   156    13   14   133
1     0  1215   0   34   0    1     5   234     2    0     8
2     2     0   0  251  55    6   167   154   205   83    92
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    6   2    0   312     3    14    0  1294
5     2     0   0  146   0  312     6     4    12  106     4
6     0     0   0   24   0    0  3035     3     4    0     1
7     0     0   0   59   0    0     0  1102     0    0     3
8     0     0   0  182   0    1    18    19  1148    1     1
9     5     3   0  250   0   72    11   221   200  356    19
10    0     0   0    0   0    0    29     0     1    0  1616
better model found
persisted
after epoch: 7,now: 2024-07-27 22:05:10.221811,epoch time: 0:23:11.214995,used: 2:40:35.358752,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94271725, 'precision': 0.8936269, 'recall': 0.7414704, 'specificity': 0.9935355, 'f1': 0.7560332, 'auroc': 0.990198}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   350     0   0     1   0    1     7    37     1    3     83
1     0  1229   0    11   0    0     1    83     1    0      6
2     0     0   1   152  45    2     8    25     2   67     10
3     0     0   0  8209   0    7     1   174    46    1      1
4     1     1   0    20  95    1   197     7     8    2    206
5     0     1   0    27   0  355     0     1     1  133      2
6     3     0   0     8   1    2  1848    14     3    0     29
7     0     3   0    80   0    1     2  7157    12    0      9
8     3     0   0   147   3    0     6   203  2866    9     56
9     0     1   0    28   0   30     0     5     2  422      5
10    9     0   0     8   4    1    37    19    14    0  12703
---- Validation: 
scalar performance:
{'acc': 0.9423566, 'precision': 0.88783467, 'recall': 0.73657393, 'specificity': 0.9934909, 'f1': 0.75112635, 'auroc': 0.98954666}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   349     0   0     5   0    1     5    43     0    1     79
1     0  1237   0     9   0    0     1    78     1    0      6
2     0     0   1   156  43    1    10    22     3   65     11
3     0     0   0  8218   0    8     1   158    53    1      1
4     1     1   0    25  84    0   198     4    10    3    213
5     0     0   0    26   0  357     0     0     2  135      1
6     6     0   0     6   1    2  1848    12     1    0     32
7     0     2   0    89   1    0     0  7149    13    2      9
8     1     0   0   142   2    5     3   207  2873    6     57
9     0     0   0    29   2   42     1     5     3  402      9
10    6     0   0     8   5    0    33    18    14    0  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6598335, 'precision': 0.5542732, 'recall': 0.54925585, 'specificity': 0.96586347, 'f1': 0.5216813, 'auroc': 0.84932154}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   946     0   0   12   0    0     3   165     4    6    34
1     0  1228   0   24   0    0     4   221     1    0    21
2     4     2   0  146  78    6   128   118   201   43   289
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    1   1    0    61     1     8    0  1560
5     5     0   0  147   0  202     4     7    14  203    10
6     1     2   0   53   0    1  2682     9    34    1   284
7     0     0   0   18   0    0     0  1141     1    0     4
8     0     0   0  158   0    1     3    24  1180    1     3
9     7     3   0  197   5   32     1   206   228  405    53
10    0     0   0    0   0    0     0     0     0    0  1646
early stop counter: 1
val acc:0.9423565864562988, best validation acc: 0.9423832893371582, corresponding to test acc:                         0.6610229015350342 / 0.6858602166175842
after epoch: 8,now: 2024-07-27 22:28:12.789035,epoch time: 0:23:02.567224,used: 3:03:37.925976,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9416738, 'precision': 0.76243806, 'recall': 0.7123036, 'specificity': 0.9935431, 'f1': 0.7176346, 'auroc': 0.9945072}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   304     0   0     0   0    1     5    13     1    0    159
1     0  1266   0     9   0    1     0    44     6    0      5
2     1     1   0   143  66    7    33    11     4   37      9
3     1     0   0  8146   0   11     1   175   106    0      0
4     2     1   0     9  40    2   296     2     6    0    181
5     0     1   0    18   1  479     1     0     2   17      2
6     1     0   0     3   0    2  1863     1     2    0     35
7     1     6   0    97   1    0     5  7081    59    0     11
8     0     0   0    64   3    0    15    64  3104    0     46
9     0     1   0    37   2  236     4     1     3  201      7
10    2     0   0     8   2    0    49    10    11    0  12712
---- Validation: 
scalar performance:
{'acc': 0.9421693, 'precision': 0.84664464, 'recall': 0.714455, 'specificity': 0.99363804, 'f1': 0.7178899, 'auroc': 0.9940919}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   322     0   0     3   1    1     4    11     1    0    140
1     0  1274   0     8   1    0     1    38     3    1      6
2     0     2   1   130  73    7    32     8     5   43     11
3     0     1   0  8150   0    9     0   164   115    1      0
4     1     0   0     9  37    1   312     1     6    0    172
5     0     1   0    20   0  477     1     0     2   17      3
6     1     0   0     2   0    2  1867     1     0    0     35
7     1     5   0    94   1    0     3  7092    58    0     11
8     0     0   0    53   4    0    13    69  3104    0     53
9     0     0   0    36   2  242     6     3     6  194      4
10    4     1   0     8   2    1    56     6    13    0  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66361153, 'precision': 0.5423045, 'recall': 0.5473237, 'specificity': 0.9659201, 'f1': 0.50403297, 'auroc': 0.8473491}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   737     0   0   23   0    2    20   127    20    3   238
1     0  1254   0   21   0    0     9   180    18    1    16
2     1     0   0  100  26   21   243    54   363   17   190
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    0   0    0   100     0    15    0  1516
5     4     0   0  146   0  343    10     2    54   25     8
6     0     0   0    7   0    0  2981     3    14    0    62
7     0     0   0   77   0    0     1  1074     9    0     3
8     0     0   0   49   0    1     6     4  1307    1     2
9     8     1   0  129   6  152    22   126   506  144    43
10    0     0   0    0   0    0     1     0     0    0  1645
early stop counter: 2
val acc:0.9421693086624146, best validation acc: 0.9423832893371582, corresponding to test acc:                         0.6610229015350342 / 0.6858602166175842
after epoch: 9,now: 2024-07-27 22:51:04.451952,epoch time: 0:22:51.662917,used: 3:26:29.588893,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9505565, 'precision': 0.81577134, 'recall': 0.75390685, 'specificity': 0.99444604, 'f1': 0.76394653, 'auroc': 0.9903673}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   352     0   0     5   0    0     0    53     3    3     67
1     0  1270   0     8   0    1     0    48     4    0      1
2     0     0   0   141  21    2     2    16     5  116      9
3     0     1   0  8260   0    5     0   102    70    0      0
4     2     0   0    39  94    3   152     9    14   13    213
5     0     0   0    36   0  384     0     0     2   98      1
6     7     0   0    10   0    3  1832     8     6    2     39
7     0     3   0   102   1    0     1  7119    33    1      4
8     0     0   0    83   0    1     2    96  3075    4     34
9     0     0   0    10   0   47     0     7     9  420      0
10    3     0   0     8   5    0     9    11    29    5  12722
---- Validation: 
scalar performance:
{'acc': 0.9511034, 'precision': 0.91007096, 'recall': 0.75472987, 'specificity': 0.99451697, 'f1': 0.7657548, 'auroc': 0.988865}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   350     0   0     1    0    2     1    53     6    5     65
1     0  1267   0     4    0    1     0    52     5    0      3
2     0     0   1   140   18    2     1    24     4  114      8
3     0     1   0  8269    0    6     0   106    58    0      0
4     1     0   0    37  100    2   153    13    18   11    204
5     0     0   0    30    0  382     0     0     6  101      2
6     5     0   0     6    0    1  1847     5     4    2     38
7     0     3   0   102    0    0     2  7113    38    1      6
8     2     0   0    84    1    0     1   100  3081    3     24
9     0     0   0     7    0   51     0     9     7  418      1
10    6     0   0     8    3    0     6    19    25    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6443014, 'precision': 0.6256347, 'recall': 0.5261099, 'specificity': 0.9644287, 'f1': 0.49113414, 'auroc': 0.8281694}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   750     0   0   25   0    0     3   329    21    8    34
1     0  1106   0   18   0    0     0   348    12    0    15
2     4     0   1   72  33    3    35   174   331   62   300
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    1   1    0    38     3    12    0  1576
5     1     0   0  173   0  209     0     8    58  141     2
6     0     0   0   85   0    0  2832    11    46    0    93
7     0     0   0   57   0    0     0  1104     1    0     2
8     0     0   0   67   0    0     1    27  1273    2     0
9     6     1   0  118   0   52     0   280   357  288    35
10    0     0   0    0   0    0     0     0     1    0  1645
better model found
persisted
after epoch: 10,now: 2024-07-27 23:13:49.771284,epoch time: 0:22:45.319332,used: 3:49:14.908225,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 3:49:14.908225 at 2024-07-27 23:13:49.771284
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6443014, 'precision': 0.6256347, 'recall': 0.5261099, 'specificity': 0.9644287, 'f1': 0.49113414, 'auroc': 0.8281694}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   750     0   0   25   0    0     3   329    21    8    34
1     0  1106   0   18   0    0     0   348    12    0    15
2     4     0   1   72  33    3    35   174   331   62   300
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    1   1    0    38     3    12    0  1576
5     1     0   0  173   0  209     0     8    58  141     2
6     0     0   0   85   0    0  2832    11    46    0    93
7     0     0   0   57   0    0     0  1104     1    0     2
8     0     0   0   67   0    0     1    27  1273    2     0
9     6     1   0  118   0   52     0   280   357  288    35
10    0     0   0    0   0    0     0     0     1    0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6858602, 'precision': 0.5564714, 'recall': 0.5652127, 'specificity': 0.968193, 'f1': 0.52813643, 'auroc': 0.864989}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   902     0   0   7   0    1     8   200     9   26    17
1     0  1287   0  17   0    5     1   170     3    2    14
2    25     3   0  55   3    0   144   227    69  118   371
3     0     0   0   0   0    0     0     0     0    0     0
4     3     0   0   0   0    0    64     2     4    0  1560
5     2     0   0  43   0  148     2    17    20  355     5
6     8     0   0   8   0    1  2833     4     8    0   205
7     0     0   0  92   0    0     0  1068     0    1     3
8     0     0   0  29   0    1     7    31  1289    5     8
9    10    10   0  31   0   12     5   313    76  636    44
10    0     0   0   0   0    0     5     0     1    0  1640
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_19_24_34_seed_0_23104515_instance_wise_predictions.txt
accuracy from prediction file 0.6443014062827958
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/20.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1702 MiB |  15906 MiB | 436897 GiB | 436895 GiB |
|       from large pool |   1695 MiB |  15881 MiB | 433941 GiB | 433939 GiB |
|       from small pool |      7 MiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1702 MiB |  15906 MiB | 436897 GiB | 436895 GiB |
|       from large pool |   1695 MiB |  15881 MiB | 433941 GiB | 433939 GiB |
|       from small pool |      7 MiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1702 MiB |  15864 MiB | 435749 GiB | 435748 GiB |
|       from large pool |   1695 MiB |  15839 MiB | 432796 GiB | 432795 GiB |
|       from small pool |      6 MiB |     26 MiB |   2953 GiB |   2953 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16624 MiB |  16624 MiB |  16624 MiB |      0 B   |
|       from large pool |  16596 MiB |  16596 MiB |  16596 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 233017 KiB | 684311 KiB |  57891 GiB |  57890 GiB |
|       from large pool | 213760 KiB | 682176 KiB |  54922 GiB |  54922 GiB |
|       from small pool |  19257 KiB |  23296 KiB |   2968 GiB |   2968 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2660    |    3967    |   30338 K  |   30335 K  |
|       from large pool |     247    |     595    |   13421 K  |   13420 K  |
|       from small pool |    2413    |    3621    |   16917 K  |   16915 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2660    |    3967    |   30338 K  |   30335 K  |
|       from large pool |     247    |     595    |   13421 K  |   13420 K  |
|       from small pool |    2413    |    3621    |   16917 K  |   16915 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     466    |     466    |     466    |       0    |
|       from large pool |     452    |     452    |     452    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     124    |    1244    |   17188 K  |   17188 K  |
|       from large pool |      95    |     302    |    9250 K  |    9250 K  |
|       from small pool |      29    |    1148    |    7937 K  |    7937 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15906 MiB | 436897 GiB | 436897 GiB |
|       from large pool |  65536 KiB |  15881 MiB | 433941 GiB | 433941 GiB |
|       from small pool |      0 KiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15906 MiB | 436897 GiB | 436897 GiB |
|       from large pool |  65536 KiB |  15881 MiB | 433941 GiB | 433941 GiB |
|       from small pool |      0 KiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15864 MiB | 435749 GiB | 435749 GiB |
|       from large pool |  65536 KiB |  15839 MiB | 432796 GiB | 432796 GiB |
|       from small pool |      0 KiB |     26 MiB |   2953 GiB |   2953 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1930 MiB |  16624 MiB |  16624 MiB |  14694 MiB |
|       from large pool |   1904 MiB |  16596 MiB |  16596 MiB |  14692 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 684311 KiB |  57892 GiB |  57892 GiB |
|       from large pool |      0 B   | 682176 KiB |  54923 GiB |  54923 GiB |
|       from small pool |      0 B   |  24786 KiB |   2968 GiB |   2968 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   30338 K  |   30338 K  |
|       from large pool |       2    |     595    |   13421 K  |   13421 K  |
|       from small pool |       0    |    3621    |   16917 K  |   16917 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   30338 K  |   30338 K  |
|       from large pool |       2    |     595    |   13421 K  |   13421 K  |
|       from small pool |       0    |    3621    |   16917 K  |   16917 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     107    |     466    |     466    |     359    |
|       from large pool |      94    |     452    |     452    |     358    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1244    |   17189 K  |   17189 K  |
|       from large pool |       0    |     302    |    9250 K  |    9250 K  |
|       from small pool |       0    |    1148    |    7938 K  |    7938 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15906 MiB | 436897 GiB | 436897 GiB |
|       from large pool |  65536 KiB |  15881 MiB | 433941 GiB | 433941 GiB |
|       from small pool |      0 KiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15906 MiB | 436897 GiB | 436897 GiB |
|       from large pool |  65536 KiB |  15881 MiB | 433941 GiB | 433941 GiB |
|       from small pool |      0 KiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15864 MiB | 435749 GiB | 435749 GiB |
|       from large pool |  65536 KiB |  15839 MiB | 432796 GiB | 432796 GiB |
|       from small pool |      0 KiB |     26 MiB |   2953 GiB |   2953 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1930 MiB |  16624 MiB |  16624 MiB |  14694 MiB |
|       from large pool |   1904 MiB |  16596 MiB |  16596 MiB |  14692 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 684311 KiB |  57892 GiB |  57892 GiB |
|       from large pool |      0 B   | 682176 KiB |  54923 GiB |  54923 GiB |
|       from small pool |      0 B   |  24786 KiB |   2968 GiB |   2968 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   30338 K  |   30338 K  |
|       from large pool |       2    |     595    |   13421 K  |   13421 K  |
|       from small pool |       0    |    3621    |   16917 K  |   16917 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   30338 K  |   30338 K  |
|       from large pool |       2    |     595    |   13421 K  |   13421 K  |
|       from small pool |       0    |    3621    |   16917 K  |   16917 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     107    |     466    |     466    |     359    |
|       from large pool |      94    |     452    |     452    |     358    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1244    |   17189 K  |   17189 K  |
|       from large pool |       0    |     302    |    9250 K  |    9250 K  |
|       from small pool |       0    |    1148    |    7938 K  |    7938 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515

 Experiment start at: 2024-07-27 23:24:51.928605
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.4587971, 'precision': 0.41443783, 'recall': 0.3246239, 'specificity': 0.94838804, 'f1': 0.26106778, 'auroc': 0.85108066}
confusion matrix:
     0   1      2     3   4   5   6     7     8   9    10
0   323   0    126    14   0   0   4    14     1   0    1
1     0  14   1074    69   0   0   6    92    13   0   64
2    56   0    168    36   0   0   1    29     5   0   17
3     4   0      8  8024   0   0   0   319    83   0    0
4    10   1    400    27   0   0   0    12    27   0   62
5    84   0    264   149   0   0   4     1    19   0    0
6   526   0   1249    48   0   0  19    30     6   0   30
7     2   1     25   440   1   0   1  6771    13   0    9
8     4   0    765   902   0   0   1   134  1407   0   82
9   150   0    279    41   0   0   3     9     7   0    4
10   54   6  12150    28   0   1   2    40    89   0  422
---- Validation: 
scalar performance:
{'acc': 0.45662698, 'precision': 0.38468167, 'recall': 0.32534918, 'specificity': 0.9481343, 'f1': 0.2587413, 'auroc': 0.85020745}
confusion matrix:
     0   1      2     3   4   5   6     7     8   9    10
0   324   0    121    12   0   0   6    17     1   0    2
1     0  10   1074    59   0   0   8    96     9   0   76
2    46   0    175    27   0   0   2    30     7   0   25
3     3   0     11  7993   0   0   1   339    92   0    1
4    11   0    378    41   0   0   0    14    21   0   74
5    75   1    265   151   0   0   7     0    22   0    0
6   557   0   1220    47   0   0  11    33    10   0   30
7     5   0     30   436   0   0   1  6768    13   0   12
8     8   0    763   905   0   0   1   148  1400   0   71
9   135   0    295    39   0   0   4    11     7   0    2
10   57   7  12189    27   0   0   1    49    76   0  390
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20128734, 'precision': 0.26885042, 'recall': 0.22687474, 'specificity': 0.92205775, 'f1': 0.1541511, 'auroc': 0.68490314}
confusion matrix:
      0   1     2    3   4   5   6     7    8   9    10
0   1041   0    33   40   0   0   2    51    0   0    3
1     53   1   993   92   3   0   2   189    9   0  157
2    321   0   482   75   0   0   0    33   14   0   90
3      0   0     0    0   0   0   0     0    0   0    0
4      9   0  1583    5   0   0   0     0   12   0   24
5    322   0   200   67   0   0   0     1    2   0    0
6   1152   0  1810   23   0   0   0    12    7   0   63
7     36   0     6   16   0   0   0  1105    0   0    1
8    157   0    99  820   0   0   0     5  248   0   41
9    625   0   369  107   0   0   0    29    4   0    3
10     0   0  1645    0   0   0   0     0    1   0    0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 23:48:11.665750,epoch time: 0:23:19.737145,used: 0:23:19.737145,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5778039, 'precision': 0.52751625, 'recall': 0.6220417, 'specificity': 0.96061283, 'f1': 0.54575396, 'auroc': 0.9275851}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   393     1     47     2   0    1    21     5    13   0   0
1     0  1208     50    11   0    0     1    52     9   0   0
2    38     0    199     0   0   10    13     2    49   0   1
3     1     4     12  7902   0    9     2   186   320   0   0
4     6     7    428     0   0    9     9     2    78   0   0
5     6     0      6    16   0  400    33     0    60   0   0
6    30    32     31    12   0    1  1776     5    19   0   1
7     1    16    132   264   0    1     1  6642   207   0   0
8     1     1     98    82   0    5     2    31  3076   0   0
9    57     1     69     2   0  200   104     1    57   0   1
10   38    67  12514     7   0    2    23     8   136   0   0
---- Validation: 
scalar performance:
{'acc': 0.57921624, 'precision': 0.57085526, 'recall': 0.61908925, 'specificity': 0.9607483, 'f1': 0.5439198, 'auroc': 0.9301857}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   383     4     55     6   0    2    17     5    11   0   0
1     0  1221     49    13   0    0     0    40     9   0   0
2    33     1    192     1   0   18    11     7    49   0   0
3     1     3     11  7921   0   14     4   187   299   0   0
4    14     3    426     0   0    9     6     2    79   0   0
5     5     0      4    16   0  396    33     0    67   0   0
6    28    33     40    13   0    2  1770     4    18   0   0
7     5     8    116   283   0    1     1  6670   181   0   0
8     2     0     84    77   0    3     1    29  3100   0   0
9    74     1     64     1   0  199    92     2    59   0   1
10   52    50  12526    10   0    3    20     6   128   0   1
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56713074, 'precision': 0.41146398, 'recall': 0.48748398, 'specificity': 0.9568125, 'f1': 0.43655634, 'auroc': 0.8206992}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1011     2    36  22   0    0    53    44     2   0   0
1      1  1210    72  29   0    2     7   166    12   0   0
2    133     1   435   5   0   43   108    15   275   0   0
3      0     0     0   0   0    0     0     0     0   0   0
4      5     4  1593   0   0    0     4     0    27   0   0
5     70     0    10  25   0  295   163     0    29   0   0
6     11    16   123  27   0   14  2820     3    53   0   0
7     25     3     5  38   0    0     3  1086     4   0   0
8     12     1    20  39   0   24    19     6  1249   0   0
9    245     7   114  23   0  231   291    22   204   0   0
10     0     2  1642   0   0    0     0     0     2   0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 00:11:57.455537,epoch time: 0:23:45.789787,used: 0:47:05.526932,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.58195096, 'precision': 0.5633713, 'recall': 0.59274864, 'specificity': 0.960814, 'f1': 0.53221184, 'auroc': 0.93677074}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   379     0     48     8   0    0    21    20     5   0   2
1     0  1218      6    13   0    0     1    91     2   0   0
2    57     1    179     3   0    2     5    44    19   0   2
3     1     0      0  8036   0    7     1   312    79   0   0
4    23     2    465     2   0    0     3    10    33   0   1
5    97     4      5    33   0  269    50     2    59   0   1
6    21     1     12    15   0    3  1840    10     6   0   0
7     1     6     12   172   0    0     2  7053    18   0   1
8     4     3     97   236   0    2     1   180  2772   0   0
9   285     1     68    12   0   42    43    26    10   0   6
10   58     4  12629    13   0    1    11    39    34   0   5
---- Validation: 
scalar performance:
{'acc': 0.58288085, 'precision': 0.56742704, 'recall': 0.60017365, 'specificity': 0.9608996, 'f1': 0.53632224, 'auroc': 0.9380107}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   394     1     39     6   0    1    15    19     5   0   3
1     0  1218      7    16   0    0     0    89     2   0   0
2    54     0    189     2   0    2     3    43    19   0   0
3     2     0      1  8054   0    5     1   299    78   0   0
4    19     0    468     3   0    0     0    12    36   0   1
5   101     3      7    33   0  281    45     2    48   0   1
6    22     1     12    15   0    3  1841     7     6   0   1
7     1     7     12   168   0    0     2  7055    20   0   0
8     5     1     87   249   0    0     1   197  2756   0   0
9   284     3     80    11   0   35    37    26    15   0   2
10   57     2  12615     9   0    1    12    43    54   0   3
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5665011, 'precision': 0.40725356, 'recall': 0.46167564, 'specificity': 0.95713353, 'f1': 0.40484458, 'auroc': 0.81787807}
confusion matrix:
     0     1     2   3   4   5     6     7     8   9   10
0   964     5     2  15   0   0   140    41     3   0   0
1     2  1266    10  25   0   1    17   177     1   0   0
2   269    15   506  18   0  11    19    60   110   0   7
3     0     0     0   0   0   0     0     0     0   0   0
4     8     3  1607   0   0   0     3     2    10   0   0
5   329     1     4  78   0  68    63    15    31   0   3
6     8     2    13  16   0  17  2993     3    12   0   3
7     4     1     3  50   0   0     7  1099     0   0   0
8     6     0    20  91   0  12    21    20  1200   0   0
9   598    41   128  47   0  38    67   123    94   0   1
10    0     2  1643   0   0   0     0     0     0   0   1
better model found
persisted
after epoch: 3,now: 2024-07-28 00:35:45.449671,epoch time: 0:23:47.994134,used: 1:10:53.521066,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5842787, 'precision': 0.5534915, 'recall': 0.6248719, 'specificity': 0.96133715, 'f1': 0.5454456, 'auroc': 0.94821507}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   389     1     45     1   0    0    36     4     7   0   0
1     0  1269     11     4   0    0     4    35     9   0   0
2    30     1    233     0   0    1     5    16    25   0   1
3    11     0     11  7751   0    6   176   267   218   0   0
4    16     1    480     0   0    0     7     3    32   0   0
5    52     0     16    24   0  301    73     2    51   0   2
6     8     0     20     0   0    0  1873     0     6   0   0
7     4    11     44   132   0    0    16  6942   111   0   0
8     3     0     86    59   0    3    24    42  3079   0   0
9   220     0    143     3   0   39    55     6    23   0   4
10   23     2  12671     5   0    1    27    12    51   0   1
---- Validation: 
scalar performance:
{'acc': 0.5840043, 'precision': 0.5421148, 'recall': 0.6240881, 'specificity': 0.9613058, 'f1': 0.5447043, 'auroc': 0.94678664}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   382     0     49     1   0    0    37     8     6   0   0
1     0  1274      7     4   0    0     7    36     4   0   0
2    29     0    235     0   0    1     8    14    25   0   0
3     5     1      8  7731   0    7   191   283   214   0   0
4     8     0    486     0   0    0     9     4    32   0   0
5    62     1     18    19   0  297    69     1    53   0   1
6     7     1     12     1   0    0  1881     2     4   0   0
7     4     9     50   119   0    0    19  6947   117   0   0
8     4     1     81    61   0    0    19    44  3086   0   0
9   214     0    139     2   0   38    55     9    31   0   5
10   24     2  12669     5   0    1    32    14    49   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56867, 'precision': 0.42758262, 'recall': 0.46013534, 'specificity': 0.9561825, 'f1': 0.41087985, 'auroc': 0.81847906}
confusion matrix:
     0     1     2   3   4   5     6    7     8   9   10
0   749     5     5   0   0   0   404    2     5   0   0
1     1  1382    26   4   0   0    17   66     3   0   0
2    92     5   594   0   0  13   156   12   143   0   0
3     0     0     0   0   0   0     0    0     0   0   0
4     3     3  1602   0   0   0    12    0    13   0   0
5   257     1     4   7   0  80   186    0    55   0   2
6     0     2     5   0   0   0  3058    0     2   0   0
7     0    11     7  93   0   0    55  996     2   0   0
8     0     0     9  10   0   1    79    2  1269   0   0
9   331    16   249   0   0  21   300   19   201   0   0
10    0     1  1640   0   0   0     2    0     3   0   0
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 00:58:19.461281,epoch time: 0:22:34.011610,used: 1:33:27.532676,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5935092, 'precision': 0.5587436, 'recall': 0.6336459, 'specificity': 0.9620247, 'f1': 0.5616486, 'auroc': 0.9497975}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   410     2     52     3   0    0     4     9     3   0   0
1     0  1262      2    13   0    0     0    52     3   0   0
2    79     0    204     0   0    2     2    20     3   0   2
3     4     0      1  8119   0   10     1   235    66   0   0
4    12     0    490     1   0    3     0     9    16   0   8
5    34     1      3    19   0  388    14    13    23   0  26
6    32     5     16    11   0    0  1827     8     4   0   3
7     6     6     18   152   0    0     1  7065    16   0   0
8     4     1    118   161   0    0     2   104  2904   0   1
9   249     0     38     2   0   74    22    50     4   0  54
10   24     3  12719     6   0    0     6    20    13   0   4
---- Validation: 
scalar performance:
{'acc': 0.5935803, 'precision': 0.5590011, 'recall': 0.6350752, 'specificity': 0.9620178, 'f1': 0.5636088, 'auroc': 0.9502261}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   408     2     52     2   0    0     5    13     0   0   1
1     0  1262      3    12   0    0     0    52     3   0   0
2    76     0    204     0   0    2     2    20     6   0   2
3     1     0      3  8108   0    9     3   240    76   0   0
4    21     0    490     2   0    2     0     7    12   0   5
5    25     0      5    15   0  398    20    11    20   0  27
6    27     2     21    11   0    0  1838     5     1   0   3
7     5     7     14   139   0    0     1  7078    21   0   0
8     4     1    114   177   0    3     0   101  2892   0   4
9   228     0     39     1   0   74    23    70     4   0  54
10   23     2  12716     6   0    0    10    20    16   0   3
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5937872, 'precision': 0.4441569, 'recall': 0.5070306, 'specificity': 0.95998585, 'f1': 0.45527303, 'auroc': 0.8353608}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9   10
0   1075     3    11    3   0    1    40    33     3   0   1
1      3  1304    11   40   0    0     7   132     2   0   0
2    157     0   611   13   0   12    16    70    91   0  45
3      0     0     0    0   0    0     0     0     0   0   0
4      2     1  1620    0   0    0     2     1     7   0   0
5    164     0     1   22   0  275    58    24    24   0  24
6      4     7    19    4   0    1  3024     2     3   0   3
7     13     3     2  115   0    0     9  1020     1   0   1
8      5     0    28  111   0   20    20     8  1178   0   0
9    624     2   101   49   0   87    69   121    41   0  43
10     0     0  1646    0   0    0     0     0     0   0   0
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-28 01:22:23.424464,epoch time: 0:24:03.963183,used: 1:57:31.495859,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5783123, 'precision': 0.54380953, 'recall': 0.6353624, 'specificity': 0.9608562, 'f1': 0.5488093, 'auroc': 0.9455411}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   404     2     54     1   0    0    20     2     0   0   0
1     0  1279      7     9   0    0     6    29     2   0   0
2    71     0    230     0   0    0     6     3     0   0   2
3    14     1      9  8096   0   49    14   120   135   0   0
4    21     0    502     0   0    2     6     2     3   0   3
5    29     0      5     5   0  421    44     6     5   0   6
6     9     1     12     2   0    0  1881     1     0   0   2
7    55    17    187   212   0    0     9  6765    18   0   0
8    18     3    508   105   0   22    48    52  2537   0   1
9   262     1     56     0   0   73    55    28     2   0  16
10   25    11  12699     7   0    2    36     3     8   0   2
---- Validation: 
scalar performance:
{'acc': 0.5778521, 'precision': 0.5444139, 'recall': 0.6340615, 'specificity': 0.9608176, 'f1': 0.5479548, 'auroc': 0.9455118}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   409     1     49     0   0    0    23     1     0   0   0
1     0  1278     11    11   0    1     2    28     1   0   0
2    70     0    229     0   0    2     5     5     0   0   1
3    12     2     11  8121   0   42    14   123   115   0   0
4    16     0    508     0   0    3     4     3     3   0   2
5    23     0      5     6   0  415    55     8     5   0   4
6    10     0     12     0   0    0  1883     0     1   0   2
7    57    21    162   208   0    2    16  6773    25   0   1
8    24     3    540   114   0   31    36    55  2493   0   0
9   258     0     59     1   0   78    56    25     0   0  16
10   26     6  12720     7   0    1    28     2     4   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57006925, 'precision': 0.44489157, 'recall': 0.4843856, 'specificity': 0.95722795, 'f1': 0.4385392, 'auroc': 0.8292524}
confusion matrix:
      0     1     2    3   4    5     6    7    8   9   10
0   1044     0    17    6   0    0    95    7    1   0   0
1     12  1330    22   21   0    3    39   71    0   0   1
2    124     1   777    3   0   13    24   35   15   0  23
3      0     0     0    0   0    0     0    0    0   0   0
4      2     0  1620    0   0    0     6    0    5   0   0
5    132     0     2    8   0  286   107   30    9   0  18
6      1     0     3    0   0    0  3063    0    0   0   0
7     40     1     7  277   0    0    77  762    0   0   0
8     10     0   126   71   0   91   177    7  886   0   2
9    589     0   259    4   0   49   112   81   17   0  26
10     0     0  1642    0   0    1     0    0    3   0   0
early stop counter: 1
val acc:0.5778520703315735, best validation acc: 0.5935803055763245, corresponding to test acc:                         0.5937871932983398 / 0.5937871932983398
after epoch: 6,now: 2024-07-28 01:46:38.730564,epoch time: 0:24:15.306100,used: 2:21:46.801959,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.5962917, 'precision': 0.577977, 'recall': 0.6412746, 'specificity': 0.9622426, 'f1': 0.5738778, 'auroc': 0.9640121}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   399     0     56     5   0    0     4    16     2   0   1
1     0  1287      0     8   0    0     0    33     2   0   0
2    14     1    245     0   0    0     3    41     4   0   4
3     2     1      0  8205   0    5     0   147    80   0   0
4     6     1    508     0   0    1     0    10     7   0   6
5    15     7     12    22   0  352    11    14    55   0  33
6    15     3     18     4   0    0  1860     5     1   0   1
7     0     6     13   214   0    0     1  7022     7   0   0
8     1     0    104   143   0    0     0   131  2916   0   0
9   126     8    122    11   0   47     5   111    12   0  51
10   15     2  12740     9   0    0     6    14     6   0   1
---- Validation: 
scalar performance:
{'acc': 0.59657615, 'precision': 0.57931626, 'recall': 0.64333135, 'specificity': 0.96224254, 'f1': 0.57375574, 'auroc': 0.96253407}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   410     3     52     5   0    0     1    11     1   0   0
1     0  1284      1    10   0    0     0    35     2   0   0
2    14     0    248     0   0    0     1    39     6   0   4
3     2     0      0  8229   0    3     1   127    78   0   0
4     7     0    501     2   0    0     1     7    15   0   6
5    16     3      9    30   0  349     9    12    54   0  39
6    14     3     19     6   0    0  1858     2     4   0   2
7     0     9     12   231   0    0     2  7000    11   0   0
8     2     1     82   147   0    0     0   141  2922   0   1
9   146     6    115    11   0   39     7    89    19   0  61
10   15     3  12727     8   0    0     7    15    18   0   3
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60638076, 'precision': 0.47492975, 'recall': 0.51032776, 'specificity': 0.96123827, 'f1': 0.4590515, 'auroc': 0.8338134}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9    10
0   1034     4    22   22   0    0    38    44     6   0    0
1      2  1335     9   18   0    1     4   121     9   0    0
2     22    13   727   13   0    2    11    70   119   0   38
3      0     0     0    0   0    0     0     0     0   0    0
4      1     1  1622    0   0    0     2     0     7   0    0
5     38    14     3  115   0  142    19    27    71   0  163
6      1     3    17    4   0    0  3034     1     7   0    0
7      1     1     3   30   0    0     0  1128     1   0    0
8      0     1    13   61   0    1     5    22  1267   0    0
9    119    40   322   60   0   23    24   177   206   0  166
10     0     0  1643    0   0    0     0     1     2   0    0
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-28 02:09:39.333518,epoch time: 0:23:00.602954,used: 2:44:47.404913,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.5995826, 'precision': 0.57520354, 'recall': 0.65778685, 'specificity': 0.9628, 'f1': 0.57596684, 'auroc': 0.9696447}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   423     0     52     2   0    0     1     5     0   0   0
1     0  1283      2     7   0    0     0    35     4   0   0
2    16     0    264     0   0    1     3    21     5   0   2
3     3     0      2  8145   0    4     0   160   124   0   0
4     9     0    513     0   0    0     1     3     9   0   4
5    16     2      7    14   0  379    14    13    66   0  10
6    19     1     20     6   0    0  1853     5     0   0   1
7     1     6     42   110   0    0     1  7050    53   0   0
8     3     1    160    73   0    0     0    48  3011   0   0
9   176     1     96     4   0   70    17    94    13   0  22
10   18     0  12754     7   0    0     4     6     4   0   2
---- Validation: 
scalar performance:
{'acc': 0.5986358, 'precision': 0.5797247, 'recall': 0.6508639, 'specificity': 0.96269464, 'f1': 0.5721047, 'auroc': 0.96817505}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   413     0     60     4   0    0     3     3     0   0   0
1     0  1271      5     8   0    0     0    45     3   0   0
2    17     0    259     1   0    1     1    23     7   0   3
3     0     0      1  8164   0    4     1   163   106   0   1
4     5     0    514     0   0    2     0     4     8   0   6
5    19     0      7    14   0  365    15    23    73   0   5
6    17     0     23    10   0    0  1856     2     0   0   0
7     2     5     29   124   0    0     1  7055    49   0   0
8     4     1    153    85   0    0     0    59  2993   0   1
9   184     1    101     3   0   67    30    82    12   0  13
10   18     2  12750     4   0    0     6     8     4   0   4
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5937172, 'precision': 0.4640534, 'recall': 0.50478846, 'specificity': 0.9601928, 'f1': 0.45245928, 'auroc': 0.83963656}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9   10
0   1092     1     7   30   0    0     9    30     1   0   0
1      0  1188    51   31   0    0     1   221     7   0   0
2     53     0   750   15   0    3     7    68    85   0  34
3      0     0     0    0   0    0     0     0     0   0   0
4      2     0  1627    0   0    0     1     0     3   0   0
5     57     0     3   96   0  182    19    96    86   0  53
6      3     1    50    8   0    1  2994     2     8   0   0
7      2     0     4   71   0    0     1  1084     2   0   0
8      0     1    27  129   0    2     6     7  1196   0   2
9    245     2   295   85   0   36    33   289   109   0  43
10     0     0  1646    0   0    0     0     0     0   0   0
better model found
persisted
after epoch: 8,now: 2024-07-28 02:32:45.503862,epoch time: 0:23:06.170344,used: 3:07:53.575257,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.5959707, 'precision': 0.57586384, 'recall': 0.61225635, 'specificity': 0.9622909, 'f1': 0.54124296, 'auroc': 0.96526814}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   423     0     42     7   0    0     0    11     0   0   0
1     0  1290      5     7   0    0     0    27     3   0   0
2    30     2    220     2   0    0     1    54     2   0   1
3     1     1      0  8271   0    2     0   118    44   0   0
4    21     1    487     0   0    0     0    12    15   0   3
5    74     0      5    85   0  187    24    42    94   0  10
6    20     2     18    10   0    0  1849     6     2   0   0
7     0    12     24   159   0    0     1  7045    23   0   0
8     2     1     73   132   0    0     0    99  2987   0   1
9   297     0     26    12   0    7     5   135     2   0   9
10   31     0  12702     7   0    0     1    12    37   0   3
---- Validation: 
scalar performance:
{'acc': 0.59542596, 'precision': 0.56620955, 'recall': 0.60846174, 'specificity': 0.962249, 'f1': 0.5379243, 'auroc': 0.9618207}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   417     0     47     5   0    0     0    13     1   0   0
1     0  1293      7     6   0    0     0    24     2   0   0
2    24     0    217     1   0    0     1    65     3   0   1
3     1     1      0  8271   0    3     0   110    54   0   0
4    23     0    474     1   0    0     0    10    25   0   6
5    83     1      1    75   0  178    28    55    95   0   5
6    17     2     25     8   0    0  1845     9     2   0   0
7     0    14     16   146   0    0     1  7063    24   0   1
8     2     2     74   142   0    1     0    99  2975   0   1
9   303     0     30    17   0   10     7   115     5   0   6
10   25     0  12709    10   0    0     4    12    35   0   1
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5180858, 'precision': 0.444655, 'recall': 0.4170459, 'specificity': 0.9533608, 'f1': 0.38281658, 'auroc': 0.80922616}
confusion matrix:
     0     1     2    3   4   5     6    7     8   9   10
0   958     3     5  117   0   0    15   69     3   0   0
1     1  1141    74   39   0   0     0  241     3   0   0
2    91     1   555   85   0   0     2  119   106   0  56
3     0     0     0    0   0   0     0    0     0   0   0
4     3     1  1616    0   0   0     3    1     7   0   2
5    54     0     0  295   0  19     5  131    62   0  26
6     1     1    62  145   0   0  2820   15    18   0   5
7     1     1     3  278   0   0     2  879     0   0   0
8     2     0    16  303   0   0     2   14  1033   0   0
9   264     2   124  295   0   5     5  378    39   0  25
10    0     0  1643    0   0   0     0    1     2   0   0
early stop counter: 1
val acc:0.5954259634017944, best validation acc: 0.5986357927322388, corresponding to test acc:                         0.5937172174453735 / 0.6063807606697083
after epoch: 9,now: 2024-07-28 02:56:53.313519,epoch time: 0:24:07.809657,used: 3:32:01.384914,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.5985124, 'precision': 0.5674174, 'recall': 0.6136207, 'specificity': 0.96264267, 'f1': 0.5441668, 'auroc': 0.96498466}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   424     1     38     9   0    0     1     9     1   0   0
1     0  1280      1     8   0    0     0    38     5   0   0
2    64     0    202     0   0    0     3    31    10   0   1
3     1     0      0  8309   0    2     0    98    27   0   0
4    19     1    462     1   0    0     5     5    37   0   9
5    23     1      2    23   0  219    82     8   162   0   0
6    14     3     10     7   0    0  1867     4     3   0   0
7     0     7      8   130   0    0     3  7104    10   0   1
8     2     0     52   184   0    0     0    94  2962   0   2
9   290     2     32     7   0   33    90    30     5   0   4
10   26     3  12727     7   0    0     2    11    15   0   3
---- Validation: 
scalar performance:
{'acc': 0.59959877, 'precision': 0.6659826, 'recall': 0.619226, 'specificity': 0.9627505, 'f1': 0.5474026, 'auroc': 0.9656019}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   426     1     36     6   0    0     3     9     2   0   0
1     0  1281      1     6   0    0     0    41     3   0   0
2    58     0    213     1   0    0     6    28     5   0   1
3     1     0      0  8315   0    2     0    95    27   0   0
4    19     0    469     1   1    0     1     8    31   0   9
5    27     1      1    29   0  228    81     4   150   0   0
6    13     3      9     2   0    0  1874     2     3   0   2
7     0     4     12   129   0    0     1  7110     9   0   0
8     1     0     48   188   0    1     1    92  2964   0   1
9   292     1     32     4   0   27    87    37    10   0   3
10   25     4  12723     6   0    0     7    11    16   0   4
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5536976, 'precision': 0.43329525, 'recall': 0.4549868, 'specificity': 0.9561864, 'f1': 0.40729105, 'auroc': 0.82582545}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9   10
0   1006     1     7   40   0    0    49   55    12   0   0
1      2  1148    22   36   0    0     5  275    11   0   0
2    128     2   601   18   0    1     5   57   183   0  20
3      0     0     0    0   0    0     0    0     0   0   0
4      4     0  1617    0   0    0     2    0    10   0   0
5    128     2     1   98   0  103    96   53    99   0  12
6      6     2    22   39   0    2  2962    4    26   0   4
7      4     0     4  231   0    0     3  920     2   0   0
8      3     0     5  180   0    0     3    5  1174   0   0
9    468     6   164  106   0   20    70  160   136   0   7
10     0     0  1643    0   0    0     0    0     3   0   0
better model found
persisted
after epoch: 10,now: 2024-07-28 03:19:58.846994,epoch time: 0:23:05.533475,used: 3:55:06.918389,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 3:55:06.918389 at 2024-07-28 03:19:58.846994
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5536976, 'precision': 0.43329525, 'recall': 0.4549868, 'specificity': 0.9561864, 'f1': 0.40729105, 'auroc': 0.82582545}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9   10
0   1006     1     7   40   0    0    49   55    12   0   0
1      2  1148    22   36   0    0     5  275    11   0   0
2    128     2   601   18   0    1     5   57   183   0  20
3      0     0     0    0   0    0     0    0     0   0   0
4      4     0  1617    0   0    0     2    0    10   0   0
5    128     2     1   98   0  103    96   53    99   0  12
6      6     2    22   39   0    2  2962    4    26   0   4
7      4     0     4  231   0    0     3  920     2   0   0
8      3     0     5  180   0    0     3    5  1174   0   0
9    468     6   164  106   0   20    70  160   136   0   7
10     0     0  1643    0   0    0     0    0     3   0   0
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60638076, 'precision': 0.47492975, 'recall': 0.51032776, 'specificity': 0.96123827, 'f1': 0.4590515, 'auroc': 0.8338134}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9    10
0   1034     4    22   22   0    0    38    44     6   0    0
1      2  1335     9   18   0    1     4   121     9   0    0
2     22    13   727   13   0    2    11    70   119   0   38
3      0     0     0    0   0    0     0     0     0   0    0
4      1     1  1622    0   0    0     2     0     7   0    0
5     38    14     3  115   0  142    19    27    71   0  163
6      1     3    17    4   0    0  3034     1     7   0    0
7      1     1     3   30   0    0     0  1128     1   0    0
8      0     1    13   61   0    1     5    22  1267   0    0
9    119    40   322   60   0   23    24   177   206   0  166
10     0     0  1643    0   0    0     0     1     2   0    0
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_23_24_51_seed_1_23104515_instance_wise_predictions.txt
accuracy from prediction file 0.5536976142167495
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1702 MiB |  15906 MiB |    853 TiB |    853 TiB |
|       from large pool |   1695 MiB |  15881 MiB |    847 TiB |    847 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1702 MiB |  15906 MiB |    853 TiB |    853 TiB |
|       from large pool |   1695 MiB |  15881 MiB |    847 TiB |    847 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1702 MiB |  15864 MiB |    851 TiB |    851 TiB |
|       from large pool |   1695 MiB |  15839 MiB |    845 TiB |    845 TiB |
|       from small pool |      6 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16644 MiB |  16644 MiB |  31338 MiB |  14694 MiB |
|       from large pool |  16616 MiB |  16616 MiB |  31308 MiB |  14692 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 235065 KiB | 710032 KiB | 115713 GiB | 115713 GiB |
|       from large pool | 213760 KiB | 708064 KiB | 109775 GiB | 109774 GiB |
|       from small pool |  21305 KiB |  24786 KiB |   5938 GiB |   5938 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2660    |    3967    |   60676 K  |   60674 K  |
|       from large pool |     247    |     595    |   26842 K  |   26841 K  |
|       from small pool |    2413    |    3621    |   33834 K  |   33832 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2660    |    3967    |   60676 K  |   60674 K  |
|       from large pool |     247    |     595    |   26842 K  |   26841 K  |
|       from small pool |    2413    |    3621    |   33834 K  |   33832 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     826    |     359    |
|       from large pool |     453    |     453    |     811    |     358    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     125    |    1244    |   34320 K  |   34320 K  |
|       from large pool |      95    |     305    |   18523 K  |   18523 K  |
|       from small pool |      30    |    1148    |   15796 K  |   15796 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15906 MiB |    853 TiB |    853 TiB |
|       from large pool |  65536 KiB |  15881 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15906 MiB |    853 TiB |    853 TiB |
|       from large pool |  65536 KiB |  15881 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15864 MiB |    851 TiB |    851 TiB |
|       from large pool |  65536 KiB |  15839 MiB |    845 TiB |    845 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1932 MiB |  16644 MiB |  31338 MiB |  29406 MiB |
|       from large pool |   1904 MiB |  16616 MiB |  31308 MiB |  29404 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 710032 KiB | 115714 GiB | 115714 GiB |
|       from large pool |      0 B   | 708064 KiB | 109776 GiB | 109776 GiB |
|       from small pool |      0 B   |  26834 KiB |   5938 GiB |   5938 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   60676 K  |   60676 K  |
|       from large pool |       2    |     595    |   26842 K  |   26842 K  |
|       from small pool |       0    |    3621    |   33834 K  |   33834 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   60676 K  |   60676 K  |
|       from large pool |       2    |     595    |   26842 K  |   26842 K  |
|       from small pool |       0    |    3621    |   33834 K  |   33834 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     108    |     467    |     826    |     718    |
|       from large pool |      94    |     453    |     811    |     717    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1244    |   34321 K  |   34321 K  |
|       from large pool |       0    |     305    |   18523 K  |   18523 K  |
|       from small pool |       0    |    1148    |   15797 K  |   15797 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 03:24:28 2024]
Finished job 0.
1 of 1 steps (100%) done
