Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 16:22:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382

 Experiment start at: 2024-07-28 16:33:48.948103
before training, model accuracy: 0.1378297060728073
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8829998, 'precision': 0.58005, 'recall': 0.5856954, 'specificity': 0.98753023, 'f1': 0.57060343, 'auroc': 0.94401205}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   11     0   0    39   0   84   231    44    32   16     26
1    3  1122   0    22   0    4     4   162     4    1      9
2    1     0   0     5   0   21    20    68    68  101     28
3    0     0   0  7975   0    2     1   327   133    0      0
4    3     0   0     7   0    7   114    22   124   16    246
5    0     0   0   161   0  243     0     2    13  101      1
6    0     2   0    27   0    4  1802    32    37    1      3
7    1     3   0   226   0    1     3  6874   143    0     13
8    0     0   0   223   0    1     8   148  2892    3     21
9    0     0   0    39   0  167     4    22    25  232      4
10  25     0   0    13   0    7   625    36   232    1  11852
---- Validation: 
scalar performance:
{'acc': 0.88163704, 'precision': 0.66266155, 'recall': 0.5814638, 'specificity': 0.9873835, 'f1': 0.5663274, 'auroc': 0.94219357}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    7     0   0    35   0   97   220    44    31   14     35
1    2  1118   0    21   0    6     2   167     6    0     10
2    0     0   0     7   0   23    19    59    77   97     30
3    0     0   0  7962   0    4     0   328   146    0      0
4    5     0   0     5   1    6   118    19   141   14    230
5    0     0   0   172   0  237     3     3    15   90      1
6    0     1   0    25   0    9  1795    30    41    3      4
7    3     7   0   239   0    1     3  6852   143    0     17
8    0     0   0   226   0    0     8   150  2886    2     24
9    1     0   0    42   0  176     3    21    24  224      2
10  19     1   0    11   0    6   622    43   213    3  11878
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5727279, 'precision': 0.4266433, 'recall': 0.45974803, 'specificity': 0.9564105, 'f1': 0.3922193, 'auroc': 0.82113886}
confusion matrix:
    0    1   2    3   4    5     6     7     8    9     10
0    8    0   0  131   0  118   528   140   169   51    25
1   10  929   0   36   0    5    25   420    20    2    52
2    0    0   0    5   0   30   116    50   589   48   177
3    0    0   0    0   0    0     0     0     0    0     0
4    0    0   0    0   0    0   122     0    27    0  1484
5    0    0   0  139   0  255    25     1    98   74     0
6    0    0   0   22   0    0  2687     9   344    0     5
7    0    0   0   19   0    0     1  1124    15    0     5
8    0    0   0   47   0    2     1     0  1320    0     0
9    2    1   0   84   1  143    21   144   476  231    34
10   0    0   0    0   0    0    14     0     0    0  1632
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 17:15:51.512052,epoch time: 0:42:02.563949,used: 0:42:02.563949,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9237746, 'precision': 0.7410209, 'recall': 0.688824, 'specificity': 0.9915764, 'f1': 0.6828333, 'auroc': 0.9782175}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   284     6   0     5   0    7    45    24    10   10     92
1     0  1285   0    12   0    0     3    23     6    0      3
2     2    13   0    65   3   18    18    56    13  102     22
3     1    10   0  8031   0   16     3   223   149    0      2
4     4     5   0    43   5   13   109    13    37   15    295
5     0     0   0    45   0  413     1     0     7   54      1
6     2     3   0     2   0    4  1859     5     6    1     26
7     1    71   0   202   0    2     1  6920    55    2     10
8     1     5   0   127   0    4     2   147  2936    2     72
9     1     1   0    10   0  225     1    16     3  232      4
10   22    20   0    14   0    1   108    24    36    6  12562
---- Validation: 
scalar performance:
{'acc': 0.9258526, 'precision': 0.7517843, 'recall': 0.690557, 'specificity': 0.99181104, 'f1': 0.68433195, 'auroc': 0.9795337}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   277     6   0     7   0    5    39    22     9   11    107
1     0  1287   0     9   0    2     0    25     5    0      4
2     1    16   0    66   2   20    18    42    20  106     21
3     0    12   0  8041   0   13     2   221   151    0      0
4     0     6   0    40   5   13   112    17    31   12    303
5     0     0   0    34   0  424     0     0    10   50      3
6     3     5   0     4   0    2  1862     3     9    0     20
7     0    74   0   185   0    0     1  6932    63    1      9
8     2     6   0   113   0    7     6   124  2976    2     60
9     0     2   0    17   0  224     3    13     4  229      1
10   24    12   0    14   0    4    88    21    49    4  12580
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6692787, 'precision': 0.5267126, 'recall': 0.55485994, 'specificity': 0.96619666, 'f1': 0.51425046, 'auroc': 0.8571554}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   587     5   0   22   0   10   300    76    31   30   109
1     0  1345   0   41   0    7    11    72     8    1    14
2    14    19   0   54   1   46   204    97   244   56   280
3     0     0   0    0   0    0     0     0     0    0     0
4     2     2   0    1   0    0    46     1     9    0  1572
5     2     1   0   68   0  385    32     1    14   73    16
6     0     0   0   17   0    0  3007     3     8    0    32
7     0     6   0  128   0    1     2  1019     3    0     5
8     0     0   0   58   0    6    31     2  1267    0     6
9    13    35   0   70   0  254    57   129   214  313    52
10    0     0   0    0   0    0     3     0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 17:56:32.360911,epoch time: 0:40:40.848859,used: 1:22:43.412808,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92447025, 'precision': 0.75010616, 'recall': 0.666238, 'specificity': 0.9914046, 'f1': 0.6666238, 'auroc': 0.98373526}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   175     0   0     5   0    5    48     8     4   15    223
1     0  1238   0    22   0    1     4    53     6    0      8
2     0     1   0   147   9   27    33     2     7   71     15
3     1     1   0  8272   1   21     1    82    58    2      0
4     0     0   0    58  15    6   130     1    10   13    306
5     0     0   0    25   0  476     0     0     1   18      1
6     0     0   0     6   1    7  1876     1     2    0     15
7     1    12   0   311   0    2     5  6805    91    7     28
8     0     0   0   261   1   16    10    48  2857   12     91
9     0     0   0    32   0  285     1     0     4  166      4
10    1     1   0    20   0    3    70    11    12    1  12673
---- Validation: 
scalar performance:
{'acc': 0.9236592, 'precision': 0.7640289, 'recall': 0.6683878, 'specificity': 0.99131477, 'f1': 0.6682762, 'auroc': 0.9836046}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   177     0   0     7   0    8    49     5     2   14    221
1     0  1237   0    19   0    5     4    47     9    2      9
2     0     0   0   143   6   29    37     3     3   74     17
3     0     0   0  8257   0   24     3    84    70    0      2
4     1     0   0    48  14   10   130     4    13   10    309
5     0     0   0    26   0  476     0     0     2   14      3
6     1     0   0     1   0    4  1883     2     1    0     16
7     0    11   0   350   0    3     4  6785    80    9     23
8     2     0   0   258   0   18    13    55  2851    8     91
9     0     0   0    30   0  278     0     0     3  179      3
10    1     1   0    19   0    3    75     6    18    1  12672
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66641015, 'precision': 0.54570615, 'recall': 0.55634654, 'specificity': 0.9662385, 'f1': 0.52758396, 'auroc': 0.8698076}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   729     0   0   16   0    2    88    45    53   41   196
1     0  1081   0   72   0    8    44   237    16    1    40
2     2     0   0  162  15   42   274    52   205   78   185
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    1   1    0    80     2     9    0  1539
5     2     0   0   81   0  393     9     0     1  104     2
6     0     0   0   25   0    0  3041     1     0    0     0
7     0     0   0  129   0    1     8  1013     3    2     8
8     0     0   0  144   0    3    18     3  1199    1     2
9     7     1   0  125   0  217    33    60   220  433    41
10    0     0   0    0   0    0    11     0     0    0  1635
early stop counter: 1
val acc:0.9236592054367065, best validation acc: 0.9258525967597961, corresponding to test acc:                         0.6692786812782288 / 0.6692786812782288
after epoch: 3,now: 2024-07-28 18:39:37.163819,epoch time: 0:43:04.802908,used: 2:05:48.215716,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9378478, 'precision': 0.7969029, 'recall': 0.7405261, 'specificity': 0.9930109, 'f1': 0.7424825, 'auroc': 0.98811436}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   362     0   0     2   0    0     0     9     8    2     99
1     0  1267   0     7   0    4     1    41     6    1      5
2     1     0   0   134  10    1     3    32    10  109     12
3     2     0   0  8093   0   19     0   135   183    2      4
4     1     0   0    65  46    2   102     8    31    7    277
5     0     0   0    27   0  424     0     0     6   62      2
6     9     0   0     3   0    3  1801     4     5    2     81
7     0    21   0   180   1    0     2  6853   195    3      9
8     1     0   0    64   0    3     0    37  3158    4     29
9     0     0   0    12   0   94     0     6     6  369      6
10   14     2   0    14   3    1     9    14    53    1  12680
---- Validation: 
scalar performance:
{'acc': 0.937515, 'precision': 0.79045707, 'recall': 0.7397392, 'specificity': 0.9929936, 'f1': 0.73950833, 'auroc': 0.98831725}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   364     0   0     2   0    2     0    11    10    5     89
1     0  1258   0    12   0    0     0    47     8    0      7
2     2     1   0   127  12    1     3    28    11  114     13
3     0     0   0  8090   0   21     1   161   164    0      3
4     2     0   0    77  37    3   104     6    29    8    273
5     0     0   0    24   0  422     0     0     5   69      1
6    11     1   0     0   1    3  1799     3     6    2     82
7     0    11   0   157   0    1     3  6873   207    5      8
8     2     0   0    66   0    3     0    42  3149    4     30
9     0     0   0    11   0   86     0     8     6  378      4
10   17     0   0    12   2    1    15    11    58    1  12679
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6739663, 'precision': 0.5806358, 'recall': 0.56623834, 'specificity': 0.96759117, 'f1': 0.5356581, 'auroc': 0.86675006}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   991     0   0    5   0    5     0   53    71   22    23
1     4  1005   0   58   0    9     2  337    42   10    32
2    21     0   0  141   1   13     7  139   288  126   279
3     0     0   0    0   0    0     0    0     0    0     0
4     2     0   0    8   1    0    17    2    21    0  1582
5     5     0   0   42   0  346     2    2     8  187     0
6     1     0   0   18   0    1  2952    2    20    1    72
7     2     0   0  325   0    7     0  762    47   16     5
8     0     0   0   92   0   12     0    0  1262    4     0
9     8     1   0   67   0  165     0   76   129  669    22
10    0     0   0    0   0    0     0    0     1    0  1645
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 19:22:32.140833,epoch time: 0:42:54.977014,used: 2:48:43.192730,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94354665, 'precision': 0.8461587, 'recall': 0.75724685, 'specificity': 0.9937587, 'f1': 0.7726993, 'auroc': 0.9921813}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   362     0   0     1    0    1     6     7     6    4     96
1     0  1285   0     6    0    0     0    28     6    1      5
2     0    35  36    48   85    4     4    27    16   47     10
3     0     7   0  8047    0   38     2   227   115    0      3
4     1     3   4    13  108    1   134     8    24    4    239
5     0     1   0    12    0  437     1     0     6   61      2
6     7     0   0     2    2    1  1849     1     5    1     40
7     0    27   0   123    1    0     2  7008    93    2      7
8     1     0   0    71    1    5     2    72  3122    1     20
9     0    16   9    18    4  105     2    15     9  311      4
10    9     0   0    14    4    2    11    13    39    0  12701
---- Validation: 
scalar performance:
{'acc': 0.94412196, 'precision': 0.84985185, 'recall': 0.7575716, 'specificity': 0.9938388, 'f1': 0.7730736, 'auroc': 0.9920614}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   367     0   0     3    0    2     4    11     7    1     88
1     0  1296   0     7    0    0     0    20     5    1      3
2     0    40  36    42   97    1     4    22    14   48      8
3     1     5   0  8058    0   38     1   218   116    1      2
4     1     5   1    16  103    2   142    11    28    1    229
5     0     1   0    15    0  446     0     0     7   49      3
6     3     1   0     1    0    0  1855     1     9    0     38
7     0    24   0   126    0    0     3  7003    98    1     10
8     1     2   0    60    0   10     3    70  3122    1     27
9     0    17  10    22    1  111     1    17    11  299      4
10    2     0   0     8    5    1    14    11    44    0  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70845866, 'precision': 0.64301026, 'recall': 0.60353124, 'specificity': 0.9705565, 'f1': 0.56718683, 'auroc': 0.8713743}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   974     0   0    1    0    2     5   67    77   18    26
1     0  1266   0   34    0   11     5  147    13    4    19
2     7    15  14   89  116    9    65   87   329   73   211
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    3   13    0   126    1    20    0  1469
5     1     0   0   21    0  421     2    6     9  128     4
6     0     0   0    5    0    0  2985    1     8    1    67
7     0     1   0  149    0    2     2  984    14    6     6
8     0     0   0   49    0   13     4    2  1298    3     1
9     7    21   2   31   11  130     6  128   252  529    20
10    0     0   0    0    0    0     4    0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-28 20:07:04.048918,epoch time: 0:44:31.908085,used: 3:33:15.100815,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93985444, 'precision': 0.81264985, 'recall': 0.7395068, 'specificity': 0.9931941, 'f1': 0.75908434, 'auroc': 0.99256676}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   259     0   0     2    0    0    17    13     1    2    188
1     0  1268   0    13    0    0     3    42     5    0      1
2     2     1   0   145   22    0     5    43     1   82     11
3     0     2   0  8027    0   12    16   150   229    1      2
4     0     0   0    50  159    0   112     9     6    4    199
5     0     0   0    29    0  405     0     1     7   71      7
6     3     0   0     3    0    0  1864     3     3    0     32
7     0     5   0   174    1    0     4  7023    50    1      6
8     3     0   0    42    3    0     2   103  3092    5     46
9     0     0   0    22    0   70     2    21     2  369      7
10    4     2   0    18    9    0    55    21    20    0  12662
---- Validation: 
scalar performance:
{'acc': 0.93912, 'precision': 0.8070633, 'recall': 0.73806566, 'specificity': 0.9931466, 'f1': 0.7547297, 'auroc': 0.9924315}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   263     0   0     0    0    0    17    11     3    3    186
1     0  1266   0    12    1    0     3    43     5    0      2
2     0     0   0   147   28    1     3    32     2   93      6
3     0     1   0  8025    0   12    17   138   242    3      2
4     1     0   0    66  141    1   113    11     6    3    197
5     0     0   0    27    0  397     1     2     6   85      3
6     2     0   0     1    0    0  1869     4     1    1     30
7     0     7   0   172    1    0     4  7025    48    3      5
8     0     0   0    50    2    1     6   118  3072    4     43
9     2     0   1    13    0   66     3    12     3  385      8
10    3     1   0    21    9    0    57    17    22    0  12666
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6889386, 'precision': 0.5868873, 'recall': 0.5775579, 'specificity': 0.96880996, 'f1': 0.5589588, 'auroc': 0.87887144}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   808     1   0    6    0    0     8  124    27   17   179
1     0  1144   0   61    1    6     4  233    19    8    23
2     5     1   0  349  117    5    56  109    76  111   186
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0   10   44    0   254    2     2    0  1320
5     3     2   0   36    0  367     3    4     7  152    18
6     0     0   0   11    0    1  3028    1     5    1    20
7     0     0   0  229    0    1     3  915     4    3     9
8     0     0   0   72    3    7     6    1  1272    2     7
9     4     2   0   90    1  130     2  140    88  633    47
10    0     0   0    1    0    0     9    0     0    0  1636
early stop counter: 1
val acc:0.9391199946403503, best validation acc: 0.9441219568252563, corresponding to test acc:                         0.708458662033081 / 0.708458662033081
after epoch: 6,now: 2024-07-28 20:52:02.972827,epoch time: 0:44:58.923909,used: 4:18:14.024724,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9448844, 'precision': 0.7937894, 'recall': 0.7309692, 'specificity': 0.99375373, 'f1': 0.74360764, 'auroc': 0.9938795}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   261     0   0    13   0    1     7    19    13    3    166
1     0  1260   0    18   0    0     0    47     5    0      2
2     1     1   0   128  52    2    15    23     7   71     12
3     0     1   0  8325   0   11     1    43    56    1      0
4     0     0   0    17  68    1   215     3    17    3    215
5     0     0   0    23   0  445     0     0     3   48      2
6     1     0   0     5   0    0  1874     0     0    1     27
7     0     5   0   262   0    0     2  6940    44    1      8
8     0     0   0   129   1    4     0    67  3069    3     22
9     0     2   0    18   0  106     3     1     1  357      5
10    1     0   0    12   2    2    28    11    20    0  12717
---- Validation: 
scalar performance:
{'acc': 0.943694, 'precision': 0.8803382, 'recall': 0.7258934, 'specificity': 0.993611, 'f1': 0.7388687, 'auroc': 0.99394256}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   245     0   0     8   0    0     4     8    16    6    196
1     0  1263   0    19   0    0     0    45     3    0      2
2     0     0   1   118  54    2    19    18    10   79     11
3     0     1   0  8311   0   19     0    56    53    0      0
4     0     1   0    15  67    2   221     5    13    0    215
5     0     0   0    26   0  446     1     0     3   44      1
6     1     0   0     6   0    1  1875     1     1    0     23
7     0     6   0   257   0    0     2  6947    45    2      6
8     0     0   0   143   2    4     2    64  3051    3     27
9     0     0   0    27   0  108     2     3     2  346      5
10    2     0   0     9   3    1    23    10    20    0  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63639545, 'precision': 0.54453075, 'recall': 0.52177536, 'specificity': 0.9635865, 'f1': 0.50697464, 'auroc': 0.86668354}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   527     0   0   34   0    2     9  118   194   26   260
1     0  1066   0  107   0    1    13  284    11    0    17
2     0     1   0  159  87   16   217   45   150   81   259
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    0   5    0   207    1     8    0  1412
5     1     0   0   73   0  379     7    0     4  127     1
6     0     0   0   20   0    0  3043    1     1    0     2
7     0     0   0  468   0    1     0  685     4    0     6
8     0     0   0  137   0    5     4    1  1219    1     3
9     1     2   0  185   5  178     5   60   126  532    43
10    0     0   0    0   0    0     6    0     0    0  1640
early stop counter: 2
val acc:0.943693995475769, best validation acc: 0.9441219568252563, corresponding to test acc:                         0.708458662033081 / 0.708458662033081
after epoch: 7,now: 2024-07-28 21:37:38.230824,epoch time: 0:45:35.257997,used: 5:03:49.282721,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.91879815, 'precision': 0.8230466, 'recall': 0.69150805, 'specificity': 0.99057853, 'f1': 0.7214243, 'auroc': 0.9856014}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   201     0   0     4    0    0     0    77    17    9    175
1     0  1165   0     4    0    0     0   157     1    0      5
2     0     0   0    80    8    1     0    99     0  112     12
3     0     0   0  7854    0    6     0   542    34    2      0
4     0     0   0    50  113    0    20    38    15   20    282
5     0     0   0    67    0  340     0     1     0  112      1
6     1     1   0     5    1    3  1747    19     8    4    118
7     0     1   0    51    0    0     0  7198     4    1      9
8     0     0   0   154    0    2     0   499  2594    1     43
9     0     0   0     6    0   44     0    31     1  411      0
10    0     0   0     7    1    1     2    38    25    3  12718
---- Validation: 
scalar performance:
{'acc': 0.91988766, 'precision': 0.8707446, 'recall': 0.6919848, 'specificity': 0.9907001, 'f1': 0.72146285, 'auroc': 0.9848478}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   192     0   0     6    0    0     1    79    16    8    181
1     0  1164   0     2    0    0     0   161     1    0      4
2     0     0   1    80    9    1     0    97     1  110     13
3     0     0   0  7864    0    5     0   532    36    1      2
4     0     1   1    52  107    0    23    37    14   24    280
5     0     0   0    69    0  338     0     4     3  106      1
6     1     1   0     9    0    4  1753    23     6    7    104
7     0     0   0    53    1    0     0  7197     5    0      9
8     0     1   0   161    0    0     0   459  2633    4     38
9     0     0   0     8    0   33     0    28     0  422      2
10    0     0   0     7    1    1     1    48    14    5  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62562096, 'precision': 0.6653924, 'recall': 0.52976006, 'specificity': 0.962469, 'f1': 0.49764416, 'auroc': 0.86256254}
confusion matrix:
     0    1   2    3   4    5     6     7     8    9     10
0   433    0   0   19   0    1     0   375    85   63   194
1     0  977   0   27   0    1     0   467     1    0    26
2     0    0   1   97  46    4    11   251    77  158   370
3     0    0   0    0   0    0     0     0     0    0     0
4     0    0   0    3  23    0    18     1     4    1  1583
5     0    0   0   43   0  272     0     2     1  272     2
6     0    0   0  108   0    0  2490     6    61    2   400
7     0    0   0   11   0    1     0  1146     0    0     6
8     0    0   0   96   0    8     1    23  1230    1    11
9     0    0   0   52   1   79     0   202    45  724    34
10    0    0   0    0   0    0     0     0     0    0  1646
early stop counter: 3
val acc:0.9198876619338989, best validation acc: 0.9441219568252563, corresponding to test acc:                         0.708458662033081 / 0.708458662033081
after epoch: 8,now: 2024-07-28 22:04:26.022807,epoch time: 0:26:47.791983,used: 5:30:37.074704,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9326573, 'precision': 0.8179536, 'recall': 0.69520473, 'specificity': 0.9920821, 'f1': 0.70550686, 'auroc': 0.9953664}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   44     0   0     0    0    0     1     9     0    1    428
1    0  1268   0     3    0    0     0    54     2    2      2
2    0     1   0   156   24    0     2    32     2   71     24
3    0     1   0  7830    0   33     5   233   316   14      5
4    0     0   0    37  151    0    30     6     7    1    307
5    0     0   0     9    0  337     0     0     7  164      4
6    0     0   0     2    0    1  1766     2     2    1    134
7    0     9   0    43    1    0     1  7088   102    2     17
8    0     0   0    11    0    2     0    44  3181   11     46
9    0     0   0     9    0   24     0     7     3  436     14
10   0     0   0     7    3    0     2     9    15    0  12758
---- Validation: 
scalar performance:
{'acc': 0.9326468, 'precision': 0.8226595, 'recall': 0.69525564, 'specificity': 0.9920609, 'f1': 0.705667, 'auroc': 0.99551123}
confusion matrix:
    0     1   2     3    4    5     6     7     8    9      10
0   35     0   0     1    0    0     1     9     2    0    435
1    0  1272   0     4    0    0     0    46     4    1      5
2    0     0   0   163   24    0     0    31     1   63     30
3    0     0   0  7808    0   28     3   232   341   20      8
4    0     1   0    29  150    0    41     5     5    2    306
5    0     0   0    11    0  348     0     2     6  151      3
6    0     0   0     1    0    1  1777     3     2    0    124
7    0     5   0    35    1    0     1  7098   106    5     14
8    0     0   0    12    0    1     0    54  3171    1     57
9    0     0   0    12    0   21     0    14     1  434     11
10   0     0   0     8    0    0     2     4     8    0  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.639264, 'precision': 0.5732379, 'recall': 0.51657486, 'specificity': 0.96334505, 'f1': 0.47669, 'auroc': 0.86000586}
confusion matrix:
    0     1   2   3   4    5     6     7     8    9     10
0   96     0   0   1   0    0     1   125    10   18   919
1    0  1277   0  20   0    3     2   158     6   13    20
2    1     2   0  47  32    4    32    83   101   55   658
3    0     0   0   0   0    0     0     0     0    0     0
4    0     0   0   0   3    0    21     1     4    0  1604
5    0     0   0  26   0  210     2     3    21  312    18
6    0     0   0   8   0    0  2859     2    13    0   185
7    0     1   0   9   0    1     3  1118    10   11    11
8    0     0   0  19   0    1     6     2  1314    7    21
9    0     4   0  40   1   22     2   193   134  614   127
10   0     0   0   0   0    0     0     0     0    0  1646
early stop counter: 4
val acc:0.9326468110084534, best validation acc: 0.9441219568252563, corresponding to test acc:                         0.708458662033081 / 0.708458662033081
after epoch: 9,now: 2024-07-28 22:27:56.995608,epoch time: 0:23:30.972801,used: 5:54:08.047505,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9400417, 'precision': 0.8587349, 'recall': 0.6796651, 'specificity': 0.99293774, 'f1': 0.6864342, 'auroc': 0.99432516}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    2     0   0     2   0    0     3    21     1    2    452
1    0  1297   0     8   0    0     0    17     3    0      6
2    0     0   2   114  82    0     6    34     6   49     19
3    0     6   0  8254   0    4     0    67   101    0      4
4    0     2   0    10  92    0   201     4     8    0    222
5    0     0   0    65   0  374     1     0     7   73      1
6    0     0   0     4   1    0  1851     3     3    0     46
7    0    19   0   126   1    0     2  7045    53    0     18
8    0     1   0    50   0    0     3    71  3086    0     85
9    0     0   1    28   3   59     0    13    10  370      9
10   0     1   0     7   2    0     8     7     6    0  12762
---- Validation: 
scalar performance:
{'acc': 0.9409121, 'precision': 0.8468499, 'recall': 0.6808996, 'specificity': 0.9930241, 'f1': 0.6880617, 'auroc': 0.99502236}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    3     0   0     4   0    1     4    17     1    0    453
1    0  1303   0     8   0    0     0    14     3    0      4
2    0     4   1   134  75    0     7    26    13   40     12
3    0     2   0  8268   0    3     0    81    84    0      2
4    0     2   0    13  90    0   200     2     3    0    229
5    0     0   0    58   0  383     0     0     7   71      2
6    0     0   0     3   0    0  1869     1     1    0     34
7    0    16   0   131   1    0     0  7048    51    0     18
8    0     1   1    39   2    0     1    73  3090    0     89
9    0     0   0    26   3   59     1    24     8  363      9
10   0     0   0     7   3    0    14     7     7    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57209826, 'precision': 0.6306961, 'recall': 0.4617076, 'specificity': 0.95697415, 'f1': 0.42236766, 'auroc': 0.8318882}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0    1     0   0   32   0    5     6   203    25   20   878
1    0  1178   0   54   0    0     0   244     5    0    18
2    0     7   1   54  73    8    96    64   170   19   523
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   0    1   1    0    54     1     5    0  1571
5    0     0   0  178   0  274     1     1    19  103    16
6    0     0   0   77   0    0  2591     6    39    0   354
7    0     0   0  157   0    0     0  1000     2    0     5
8    0     0   0  128   0    1     1     7  1219    1    13
9    0    11   0  193  14   75     6   186   281  266   105
10   0     0   0    0   0    0     0     0     0    0  1646
early stop counter: 5
val acc:0.940912127494812, best validation acc: 0.9441219568252563, corresponding to test acc:                         0.708458662033081 / 0.708458662033081
after epoch: 10,now: 2024-07-28 22:53:07.994418,epoch time: 0:25:10.998810,used: 6:19:19.046315,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 6:19:19.046315 at 2024-07-28 22:53:07.994418
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70845866, 'precision': 0.64301026, 'recall': 0.60353124, 'specificity': 0.9705565, 'f1': 0.56718683, 'auroc': 0.8713743}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   974     0   0    1    0    2     5   67    77   18    26
1     0  1266   0   34    0   11     5  147    13    4    19
2     7    15  14   89  116    9    65   87   329   73   211
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    3   13    0   126    1    20    0  1469
5     1     0   0   21    0  421     2    6     9  128     4
6     0     0   0    5    0    0  2985    1     8    1    67
7     0     1   0  149    0    2     2  984    14    6     6
8     0     0   0   49    0   13     4    2  1298    3     1
9     7    21   2   31   11  130     6  128   252  529    20
10    0     0   0    0    0    0     4    0     0    0  1642
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70845866, 'precision': 0.64301026, 'recall': 0.60353124, 'specificity': 0.9705565, 'f1': 0.56718683, 'auroc': 0.8713743}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   974     0   0    1    0    2     5   67    77   18    26
1     0  1266   0   34    0   11     5  147    13    4    19
2     7    15  14   89  116    9    65   87   329   73   211
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    3   13    0   126    1    20    0  1469
5     1     0   0   21    0  421     2    6     9  128     4
6     0     0   0    5    0    0  2985    1     8    1    67
7     0     1   0  149    0    2     2  984    14    6     6
8     0     0   0   49    0   13     4    2  1298    3     1
9     7    21   2   31   11  130     6  128   252  529    20
10    0     0   0    0    0    0     4    0     0    0  1642
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_16_33_48_seed_0_23121382_instance_wise_predictions.txt
accuracy from prediction file 0.7084586860701042
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/9.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1704 MiB |   8691 MiB | 446968 GiB | 446966 GiB |
|       from large pool |   1697 MiB |   8677 MiB | 443974 GiB | 443972 GiB |
|       from small pool |      7 MiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1704 MiB |   8691 MiB | 446968 GiB | 446966 GiB |
|       from large pool |   1697 MiB |   8677 MiB | 443974 GiB | 443972 GiB |
|       from small pool |      7 MiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1702 MiB |   8670 MiB | 446010 GiB | 446008 GiB |
|       from large pool |   1695 MiB |   8654 MiB | 443019 GiB | 443017 GiB |
|       from small pool |      6 MiB |     16 MiB |   2990 GiB |   2990 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9218 MiB |   9218 MiB |   9218 MiB |      0 B   |
|       from large pool |   9200 MiB |   9200 MiB |   9200 MiB |      0 B   |
|       from small pool |     18 MiB |     18 MiB |     18 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 343606 KiB | 550187 KiB | 109367 GiB | 109367 GiB |
|       from large pool | 336640 KiB | 546048 KiB | 106335 GiB | 106334 GiB |
|       from small pool |   6966 KiB |  13085 KiB |   3032 GiB |   3032 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   31755 K  |   31753 K  |
|       from large pool |     247    |     398    |   14188 K  |   14188 K  |
|       from small pool |    2419    |    3627    |   17567 K  |   17565 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   31755 K  |   31753 K  |
|       from large pool |     247    |     398    |   14188 K  |   14188 K  |
|       from small pool |    2419    |    3627    |   17567 K  |   17565 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     264    |     264    |     264    |       0    |
|       from large pool |     255    |     255    |     255    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     113    |    1238    |   16756 K  |   16755 K  |
|       from large pool |      94    |     180    |    9186 K  |    9186 K  |
|       from small pool |      19    |    1144    |    7569 K  |    7569 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   8691 MiB | 446968 GiB | 446968 GiB |
|       from large pool |  65536 KiB |   8677 MiB | 443974 GiB | 443974 GiB |
|       from small pool |      0 KiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   8691 MiB | 446968 GiB | 446968 GiB |
|       from large pool |  65536 KiB |   8677 MiB | 443974 GiB | 443974 GiB |
|       from small pool |      0 KiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   8670 MiB | 446010 GiB | 446009 GiB |
|       from large pool |  65536 KiB |   8654 MiB | 443019 GiB | 443019 GiB |
|       from small pool |      0 KiB |     16 MiB |   2990 GiB |   2990 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2040 MiB |   9218 MiB |   9218 MiB |   7178 MiB |
|       from large pool |   2026 MiB |   9200 MiB |   9200 MiB |   7174 MiB |
|       from small pool |     14 MiB |     18 MiB |     18 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 550187 KiB | 109368 GiB | 109368 GiB |
|       from large pool |      0 B   | 546048 KiB | 106336 GiB | 106336 GiB |
|       from small pool |      0 B   |  13085 KiB |   3032 GiB |   3032 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   31755 K  |   31755 K  |
|       from large pool |       2    |     398    |   14188 K  |   14188 K  |
|       from small pool |       0    |    3627    |   17567 K  |   17567 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   31755 K  |   31755 K  |
|       from large pool |       2    |     398    |   14188 K  |   14188 K  |
|       from small pool |       0    |    3627    |   17567 K  |   17567 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     264    |     264    |     165    |
|       from large pool |      92    |     255    |     255    |     163    |
|       from small pool |       7    |       9    |       9    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1238    |   16757 K  |   16757 K  |
|       from large pool |       0    |     180    |    9186 K  |    9186 K  |
|       from small pool |       0    |    1144    |    7570 K  |    7570 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   8691 MiB | 446968 GiB | 446968 GiB |
|       from large pool |  65536 KiB |   8677 MiB | 443974 GiB | 443974 GiB |
|       from small pool |      0 KiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   8691 MiB | 446968 GiB | 446968 GiB |
|       from large pool |  65536 KiB |   8677 MiB | 443974 GiB | 443974 GiB |
|       from small pool |      0 KiB |     16 MiB |   2993 GiB |   2993 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   8670 MiB | 446010 GiB | 446009 GiB |
|       from large pool |  65536 KiB |   8654 MiB | 443019 GiB | 443019 GiB |
|       from small pool |      0 KiB |     16 MiB |   2990 GiB |   2990 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2040 MiB |   9218 MiB |   9218 MiB |   7178 MiB |
|       from large pool |   2026 MiB |   9200 MiB |   9200 MiB |   7174 MiB |
|       from small pool |     14 MiB |     18 MiB |     18 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 550187 KiB | 109368 GiB | 109368 GiB |
|       from large pool |      0 B   | 546048 KiB | 106336 GiB | 106336 GiB |
|       from small pool |      0 B   |  13085 KiB |   3032 GiB |   3032 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   31755 K  |   31755 K  |
|       from large pool |       2    |     398    |   14188 K  |   14188 K  |
|       from small pool |       0    |    3627    |   17567 K  |   17567 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   31755 K  |   31755 K  |
|       from large pool |       2    |     398    |   14188 K  |   14188 K  |
|       from small pool |       0    |    3627    |   17567 K  |   17567 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     264    |     264    |     165    |
|       from large pool |      92    |     255    |     255    |     163    |
|       from small pool |       7    |       9    |       9    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1238    |   16757 K  |   16757 K  |
|       from large pool |       0    |     180    |    9186 K  |    9186 K  |
|       from small pool |       0    |    1144    |    7570 K  |    7570 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382

 Experiment start at: 2024-07-28 23:05:04.504883
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.51369864, 'precision': 0.43684012, 'recall': 0.4604714, 'specificity': 0.9536419, 'f1': 0.3549575, 'auroc': 0.9056167}
confusion matrix:
      0     1      2     3   4   5   6     7     8   9    10
0    409     1     50     8   0   0   0    11     2   0    2
1      1  1230     11    20   3   0   0    64     3   0    0
2     49     6    200     3   2   0   0    26    17   0    9
3     11     2      6  8160   0   0   0   186    73   0    1
4     18    15    437     2   1   0   0     6    48   0   12
5    117     0     12   268   0   0   1    12    11   0  100
6   1184   109    205    28   0   0  14    46    50   0  272
7     12    26     38   454   3   0   0  6676    52   0    0
8      4     8    376   325   1   0   0    86  2495   0    0
9    237     3     75    59   0   0   0    24    21   0   73
10    71    58  12562    14   0   0   0    21    53   0   15
---- Validation: 
scalar performance:
{'acc': 0.512719, 'precision': 0.42664504, 'recall': 0.4565592, 'specificity': 0.9534708, 'f1': 0.3541989, 'auroc': 0.9040885}
confusion matrix:
      0     1      2     3   4   5   6     7     8   9    10
0    402     3     52    10   0   0   1    10     3   0    2
1      0  1231      6    20   1   0   0    71     3   0    0
2     52    12    191     6   0   0   0    21    21   0    9
3      7     2      4  8138   0   0   0   204    85   0    0
4     16    12    447     7   0   0   0     6    40   0   11
5    117     0     14   258   0   0   0    12    18   0  102
6   1129   110    204    26   0   0  16    59    44   0  320
7     15    27     41   470   1   0   0  6663    47   0    1
8      9    12    349   332   1   0   0    79  2514   0    0
9    239     4     78    60   0   0   0    22    24   0   66
10    72    58  12563    13   0   0   0    20    57   0   13
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3538795, 'precision': 0.28391108, 'recall': 0.3675046, 'specificity': 0.93646926, 'f1': 0.28993192, 'auroc': 0.75148267}
confusion matrix:
      0     1     2    3   4   5   6     7     8   9     10
0   1099    10    11   24   0   0   3    19     2   0     2
1     28  1165    13   54   8   0   0   222     6   0     3
2    195     8   571   27   0   0   0    27   149   0    38
3      0     0     0    0   0   0   0     0     0   0     0
4     10     8  1598    0   0   0   0     0    14   0     3
5    288     0     1  230   0   0   5    13     4   0    51
6    248    49  1182  108   0   0   5    49   346   0  1080
7     13     1     2   40   0   0   0  1107     0   0     1
8     15     0    34  199   0   0   0    11  1110   0     1
9    463    17   146  212   0   0   6    52   154   0    87
10     0     3  1641    0   0   0   0     0     1   0     1
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 23:39:58.134399,epoch time: 0:34:53.629516,used: 0:34:53.629516,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5638645, 'precision': 0.4797079, 'recall': 0.5158679, 'specificity': 0.9578037, 'f1': 0.47799882, 'auroc': 0.92329425}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   351     0     36     5   0   0    60    23     5   0    3
1     0  1227     13    16   0   0     4    70     1   0    1
2    25     6    127     4   0   0     4    74    18   0   54
3     0     1      1  8211   0   0     6   181    32   0    4
4     8     5    411     6   0   0     7    28    48   0   26
5     7     1      4   164   0   0    21    17     4   0  303
6    12     3     16    11   0   0  1845     9     7   0    4
7     1     5      4   351   0   0     3  6883    15   0    2
8     5     4     95   560   0   1     5   217  2402   0    6
9    53     1     17    23   0   0    14    56     7   0  322
10   34    37  12365    16   0   2    71    69   171   0   29
---- Validation: 
scalar performance:
{'acc': 0.5641568, 'precision': 0.4827168, 'recall': 0.5131725, 'specificity': 0.95784456, 'f1': 0.47937617, 'auroc': 0.9254657}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   359     0     36     4   0   0    56    22     2   0    4
1     0  1228      9    14   0   0     3    77     1   0    0
2    26     1    112     4   0   0     1    88    24   0   56
3     0     1      0  8207   0   0     8   180    42   0    2
4     7     5    416     5   0   0     3    28    37   0   38
5    10     0      4   158   0   0    33    19     3   0  294
6    18     2     18    11   0   0  1843     8     4   0    4
7     2     6      6   339   0   0     8  6890    12   0    2
8     1     1     84   593   0   0     7   199  2408   0    3
9    59     0     21    26   0   0    13    54    12   0  308
10   29    29  12395    19   0   1    54    62   163   0   44
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.521584, 'precision': 0.3911261, 'recall': 0.41248506, 'specificity': 0.9524273, 'f1': 0.3747568, 'auroc': 0.8044648}
confusion matrix:
     0     1     2    3   4   5     6     7     8   9    10
0   722     2    11   21   0   2   339    68     2   0    3
1     5  1110    44   36   0   0    49   251     4   0    0
2    55     2   555   30   0   1    23    83   151   0  115
3     0     0     0    0   0   0     0     0     0   0    0
4     4     3  1603    1   0   0     2     2    18   0    0
5    49     0     1  144   0   1    73    61     2   0  261
6     1    29    28   26   0   0  2973     2     6   0    2
7     0     0     0  116   0   0    15  1033     0   0    0
8     1     0    11  255   0   0    15    20  1061   0    7
9   156     9   134  122   0   0    64   220    81   0  351
10    0     1  1636    0   0   0     3     1     5   0    0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 00:21:28.326472,epoch time: 0:41:30.192073,used: 1:16:23.821589,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5767605, 'precision': 0.48456192, 'recall': 0.56382215, 'specificity': 0.9597982, 'f1': 0.49191952, 'auroc': 0.9366576}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   381     4     66     4   0   0    15     4     5   0    4
1     0  1263      4    12   0   0     0    51     2   0    0
2    32    10    227     0   0   0     2    16    15   0   10
3     1     1      5  8102   0   1     1   197   120   0   11
4     6    15    481     2   0   0     1     1    24   0    8
5    34     2     19    69   0   0     3    23    14   0  357
6    11     8     15     5   0   0  1861     0     7   0    0
7     2    24     41   239   0   0     9  6922    22   0    4
8     1     8    230   144   0   0     0   115  2795   0    3
9   128     2    103     9   0   1     3    27    29   0  191
10   12    38  12642     7   0   2    28    14    43   0    6
---- Validation: 
scalar performance:
{'acc': 0.5756319, 'precision': 0.49767607, 'recall': 0.56156105, 'specificity': 0.95969814, 'f1': 0.48975676, 'auroc': 0.9356367}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   364     5     62     2   0   1    31     6     8   0    4
1     0  1261      2    14   0   1     0    52     2   0    0
2    34    12    230     0   0   0     2    12    12   0   10
3     2     4      4  8078   0   0     5   203   134   0   10
4     7    11    484     1   0   0     3     4    22   0    7
5    37     2     17    65   0   1     2    22    20   0  355
6    12     7     10     2   0   0  1865     0     9   0    3
7     3    25     38   258   0   0     7  6904    28   0    2
8     0    11    231   124   0   0     0   120  2809   0    1
9   118     3    103     8   0   0     5    39    34   0  183
10   10    35  12659     7   0   3    24    12    38   0    8
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.54949975, 'precision': 0.37223786, 'recall': 0.44839746, 'specificity': 0.95549583, 'f1': 0.39611343, 'auroc': 0.8083472}
confusion matrix:
     0     1     2    3   4   5     6    7     8   9    10
0   998    13    23   23   0   2    56   36    14   0    5
1    20  1329     7   23   0   0    13  102     1   0    4
2    69    16   596   15   0   1     4   21   215   0   78
3     0     0     0    0   0   0     0    0     0   0    0
4     2    18  1594    0   0   0     2    0    17   0    0
5    83     1     1   84   0   0     1   48    23   0  351
6     0   186    43    3   0   4  2769    0    59   0    3
7    54     6     2  110   0   0    23  965     1   0    3
8     2     3    30  106   0   1     3    3  1197   0   25
9   202    25   250   68   0   0     8   89   181   0  314
10    0     3  1637    0   0   0     0    0     6   0    0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 00:55:02.439006,epoch time: 0:33:34.112534,used: 1:49:57.934123,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5785531, 'precision': 0.48450512, 'recall': 0.56302375, 'specificity': 0.96021265, 'f1': 0.48803622, 'auroc': 0.94110805}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   396     1     68     4   0   0     4     9     1   0    0
1     0  1139     27    11   0   0     0   149     6   0    0
2    38     0    235     1   0   0     1    36     1   0    0
3     3     0      0  8089   0   0     7   232   100   0    6
4     5     1    512     1   0   0     0     5    10   0    5
5    69     0     29   110   0   0     0    52    14   0  247
6    20     2     25     4   0   0  1849     4     2   0    2
7     2     1     17   142   0   0     1  7066    33   0    0
8     4     1    195   117   0   0     1   129  2848   0    1
9   196     0    126     6   0   0     0    74    15   0   76
10   11     2  12716     8   0   0     7    20    27   0    2
---- Validation: 
scalar performance:
{'acc': 0.57908255, 'precision': 0.48616427, 'recall': 0.56537676, 'specificity': 0.96026045, 'f1': 0.4890506, 'auroc': 0.94111574}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   399     1     64     2   0   0     6     9     2   0    0
1     2  1142     28     9   0   0     0   140    11   0    0
2    30     0    242     0   0   0     1    38     0   0    1
3    10     0      4  8130   0   0     4   204    87   0    1
4     6     0    514     0   0   0     1     7     9   0    2
5    65     0     28   114   0   0     2    55    13   0  244
6    17     3     21     2   0   0  1852     6     4   0    3
7     6     1     20   143   0   0     1  7072    20   0    2
8     1     0    205   138   0   0     0   141  2810   0    1
9   190     0    128     6   0   0     0    68    10   0   91
10   15     3  12727     7   0   0     5    19    18   0    2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5154271, 'precision': 0.35028267, 'recall': 0.42527664, 'specificity': 0.9524766, 'f1': 0.36141622, 'auroc': 0.8029666}
confusion matrix:
      0    1     2    3   4   5     6    7     8   9    10
0   1110    2    12   12   0   0     5   24     3   0    2
1     15  778   102   40   0   0    53  484    20   0    7
2    144    1   742   11   0   0     0   49    58   0   10
3      0    0     0    0   0   0     0    0     0   0    0
4      3    1  1624    0   0   0     1    0     4   0    0
5    191    0     3  106   0   0     3   92    11   0  186
6     45  200    49    5   0   0  2711    6    34   0   17
7      9    0     3  248   0   0     1  902     1   0    0
8     10    2    52  152   0   0     1   21  1124   0    8
9    507    1   286   57   0   0     0  162    55   0   69
10     0    0  1646    0   0   0     0    0     0   0    0
better model found
persisted
after epoch: 4,now: 2024-07-29 01:21:18.013019,epoch time: 0:26:15.574013,used: 2:16:13.508136,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.57009846, 'precision': 0.44534847, 'recall': 0.5834068, 'specificity': 0.9599633, 'f1': 0.4679659, 'auroc': 0.9533525}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   421     3     54     0   0   0     2     1     2   0   0
1     1  1295      0     3   0   0     2    25     6   0   0
2    36     5    258     0   0   0     1     3     8   0   1
3    74    33     10  7444   0   0    16   466   384   0  10
4    16     6    488     0   0   0     0     2    27   0   0
5    73   325      9     9   0   0     4     2    90   0   9
6    39     5     14     0   0   0  1849     1     0   0   0
7    42    33     60    56   0   0     2  6945   125   0   0
8    10     6    101    34   0   0     0    50  3095   0   0
9   233   116    116     1   0   0     2     8    13   0   4
10   40     4  12674     5   0   0     7    12    49   0   1
---- Validation: 
scalar performance:
{'acc': 0.5706834, 'precision': 0.44328922, 'recall': 0.5839882, 'specificity': 0.9600227, 'f1': 0.46938124, 'auroc': 0.95296305}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   418     3     55     0   0   0     5     1     1   0   0
1     3  1293      1     2   0   0     0    27     6   0   0
2    34     3    261     0   0   0     1     1    12   0   0
3    73    31      8  7460   0   0    18   458   383   0   9
4    17     2    498     0   0   0     0     2    19   0   1
5    68   327     15    13   0   0     2     5    85   0   6
6    36     3     17     0   0   0  1849     1     2   0   0
7    39    35     57    53   0   0     4  6951   126   0   0
8    10     1     96    31   0   0     0    55  3103   0   0
9   221   109    128     1   0   0     1    10    17   0   6
10   28     7  12685     6   0   0    14    11    45   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5741972, 'precision': 0.34432283, 'recall': 0.458257, 'specificity': 0.9577974, 'f1': 0.38396376, 'auroc': 0.8414306}
confusion matrix:
      0     1     2   3   4   5     6    7     8   9   10
0   1127    10     3   1   0   0    26    0     3   0   0
1     20  1322     7  10   0   0     7  111    22   0   0
2    167    75   396   1   0   0    14    3   359   0   0
3      0     0     0   0   0   0     0    0     0   0   0
4      5     3  1574   0   0   0    20    0    31   0   0
5     87   415     0  13   0   0     3    0    72   0   2
6      4     2     1   0   0   0  3060    0     0   0   0
7    111     3    15  18   0   0    10  987    20   0   0
8     15    22     2  13   0   0     3    0  1315   0   0
9    450   250   146   0   0   0     7    3   278   0   3
10     0     1  1627   1   0   0    15    0     2   0   0
new oracle model saved
early stop counter: 1
val acc:0.5706834197044373, best validation acc: 0.5790825486183167, corresponding to test acc:                         0.5154271125793457 / 0.5741971731185913
after epoch: 5,now: 2024-07-29 01:46:31.138636,epoch time: 0:25:13.125617,used: 2:41:26.633753,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5872485, 'precision': 0.49749076, 'recall': 0.56126475, 'specificity': 0.961262, 'f1': 0.48211595, 'auroc': 0.9572671}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   430     0     19     6   0   0    13     8     6   0   1
1     0  1284      2     9   0   0     1    32     4   0   0
2    73     3    163     1   0   0     4    47    18   0   3
3     1     1      0  8292   0   0     2   110    31   0   0
4    24     5    412     2   0   0     0    14    66   0  15
5    18   146      1    47   0   0     2    13   286   0   8
6    13     3     10     7   0   0  1867     5     2   0   1
7     1     6      3   224   0   0     1  7019     9   0   0
8     2     0     26   296   0   0     1   110  2855   0   5
9   219   117     25    11   0   0     3    63    41   0  14
10   38     0  12462     8   0   0    26    45   176   0  39
---- Validation: 
scalar performance:
{'acc': 0.5873211, 'precision': 0.4934286, 'recall': 0.5632986, 'specificity': 0.96127427, 'f1': 0.4806411, 'auroc': 0.95857924}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   423     0     30     2   0   0    12    12     4   0   0
1     0  1271      1    11   0   0     1    43     5   0   0
2    71     2    177     0   0   0     3    38    15   0   6
3     1     0      0  8295   0   0     1   103    40   0   0
4    24     6    394     2   0   0     4    14    73   0  22
5    30   143      3    50   0   0     1     2   281   0  11
6    12     2      8     3   0   0  1877     3     3   0   0
7     0     6      5   206   0   0     1  7036    10   0   1
8     3     0     25   323   0   0     0   105  2837   0   3
9   222   127     28    11   0   0     5    53    34   0  13
10   38     5  12472    11   0   0    30    37   162   0  41
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55600643, 'precision': 0.34752142, 'recall': 0.44087428, 'specificity': 0.9563696, 'f1': 0.38026127, 'auroc': 0.8426172}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9   10
0   1043     0     3    8   0   0    81   33     2   0   0
1      4  1282    15   37   0   0    10  146     5   0   0
2    169    24   423    7   0   0     4   47   331   0  10
3      0     0     0    0   0   0     0    0     0   0   0
4      4     0  1593    0   0   0     5    1    29   0   1
5    122   104     0  112   0   0     3   19   219   0  13
6      1     1     2   12   0   0  3050    0     1   0   0
7      3     0     3  190   0   0    15  953     0   0   0
8      9     0     2  147   0   1     7    7  1196   0   1
9    450    79   146   92   0   0     4  105   249   0  12
10     0     0  1643    0   0   0     1    0     2   0   0
better model found
persisted
after epoch: 6,now: 2024-07-29 02:11:44.525720,epoch time: 0:25:13.387084,used: 3:06:40.020837,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.5750214, 'precision': 0.49891478, 'recall': 0.55982643, 'specificity': 0.95979595, 'f1': 0.48687378, 'auroc': 0.9549227}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   421     0     28     5   0   0     6     5    16   0   2
1     0  1283      1    17   0   0     1    20    10   0   0
2    26    10    171     3   0   0     1    53    34   0  14
3     0     0      0  8335   0   0     4    32    66   0   0
4    15     6    374     0   0   0     0    13    99   0  32
5    13   106      2    92   0   0     0    10   278   0  20
6     8     7      5     4   0   0  1870     3     7   0   4
7     8    12     16   654   0   0     4  6223   347   0   0
8     2     3     25   136   0   0     1    12  3112   0   4
9   100   105     17    23   0   0     4   142    50   0  51
10   15     3  12448    12   0   0    13    12   213   0  77
---- Validation: 
scalar performance:
{'acc': 0.57541794, 'precision': 0.49656683, 'recall': 0.55783165, 'specificity': 0.9598298, 'f1': 0.4865678, 'auroc': 0.955072}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   416     2     26     5   0   0    10     5    12   0   7
1     0  1286      0    11   0   0     2    22    11   0   0
2    34     3    165     5   0   0     1    55    42   0   7
3     0     0      1  8332   0   0     2    20    85   0   0
4     8     5    378     1   0   0     0    15    96   0  36
5     9   115      1    81   0   0     2    15   277   0  21
6    11     3      2     2   0   0  1877     1     9   0   3
7     5    11      9   650   0   0     2  6258   330   0   0
8     2     0     20   150   0   0     0    11  3107   0   6
9   101   110     16    22   0   0     2   146    47   0  49
10   18     4  12449    14   0   0    10    19   211   0  71
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5033933, 'precision': 0.35681587, 'recall': 0.38174406, 'specificity': 0.95171136, 'f1': 0.36152232, 'auroc': 0.8000398}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9   10
0   1018    17     5   25   0   0    71   21    12   0   1
1      4  1250     7   57   0   0    13  133    35   0   0
2     55    66   111   79   0   0     7   27   605   0  65
3      0     0     0    0   0   0     0    0     0   0   0
4      2     4  1477    0   0   0     2    2   125   0  21
5     13    16     0  433   0   0     2   23    85   0  20
6      0     2     2   44   0   0  3011    1     5   0   2
7     15     0     1  414   0   0    18  676    39   0   1
8      0     0     0  245   0   0     1    0  1123   0   1
9     67    78    25  444   0   0    10   98   357   0  58
10     0     0  1625    0   0   0     1    0    14   0   6
early stop counter: 1
val acc:0.5754179358482361, best validation acc: 0.5873211026191711, corresponding to test acc:                         0.5560064315795898 / 0.5741971731185913
after epoch: 7,now: 2024-07-29 02:38:20.122830,epoch time: 0:26:35.597110,used: 3:33:15.617947,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.59254605, 'precision': 0.5110003, 'recall': 0.5736375, 'specificity': 0.96155393, 'f1': 0.50642395, 'auroc': 0.967962}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   435     0     22     1   0   0     7     6     6   0   6
1     0  1281      2     6   0   0     0    38     5   0   0
2     9     2    185     0   0   0     1    92    11   0  12
3     0     0      0  8260   0   0     2    98    77   0   1
4     5     2    374     1   0   0     3    25    68   0  61
5    11    96      1    35   0   0     4    85   235   0  54
6     3     1      5     0   0   0  1882     5     5   0   7
7     0     5      6   220   0   0     1  7014    17   0   1
8     2     1     33   120   0   0     0   105  3027   0   6
9    78    29     22     4   0   0     4   291     9   0  56
10   15     1  12564     8   0   0     9    27   105   0  63
---- Validation: 
scalar performance:
{'acc': 0.5931791, 'precision': 0.50568926, 'recall': 0.57539564, 'specificity': 0.96161413, 'f1': 0.5061356, 'auroc': 0.96851456}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   426     0     19     2   0   0     9    15     7   0   5
1     0  1288      0     4   0   0     0    35     5   0   0
2    12     3    193     2   0   0     1    83     6   0  12
3     0     1      1  8268   0   0     2    98    70   0   0
4     6     1    361     1   0   0     4    20    71   0  75
5    12    84      1    41   0   0     3    89   226   0  65
6     2     1      7     3   0   0  1885     2     5   0   3
7     1     5      5   208   0   0     1  7026    19   0   0
8     3     2     32   115   0   0     0    95  3044   0   5
9    75    29     23     5   0   0     4   297    10   0  50
10   19     0  12589     7   0   0    10    28    97   0  46
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5115791, 'precision': 0.36907727, 'recall': 0.40129143, 'specificity': 0.95234007, 'f1': 0.37173766, 'auroc': 0.811996}
confusion matrix:
     0     1     2    3   4   5     6     7     8   9    10
0   869     1     8   54   0   0    86   136    13   0    3
1     0  1124    16   46   0   0     1   304     8   0    0
2    23     5   291   64   0   0    10   113   330   0  179
3     0     0     0    0   0   0     0     0     0   0    0
4     1     0  1568    1   0   0     1     1    43   0   18
5     9    11     0  318   0   0     3    76   109   0   66
6     0     3    23  112   0   0  2889     4    34   0    2
7     0     0     2  138   0   0     0  1023     1   0    0
8     0     0     2  237   0   0     1    17  1112   0    1
9    43    18    76  355   0   0    19   367   135   0  124
10    0     0  1638    0   0   0     0     0     4   0    4
better model found
persisted
after epoch: 8,now: 2024-07-29 03:04:34.551812,epoch time: 0:26:14.428982,used: 3:59:30.046929,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.59254605, 'precision': 0.52472734, 'recall': 0.5538056, 'specificity': 0.9611014, 'f1': 0.50799704, 'auroc': 0.9611938}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   411     0     19     0   0   0     2    20     3   0   28
1     0  1272      1     0   0   0     1    52     5   0    1
2    14     1    139     0   0   0     1   105     6   0   46
3     1     0      0  8081   0   0     3   271    79   0    4
4     2     0    207     0   0   0     0    17    34   0  278
5    13   110      0    27   0   0     8    74   214   0   74
6    13     0      5     0   0   0  1858    11     3   0   17
7     1     2      5    76   0   0     1  7150    24   0    4
8     0     0     54   111   0   0     1   121  2980   0   29
9    21    32      9     3   0   0     2   355     6   0   65
10    5     2  12381     5   0   0     6    23   115   0  256
---- Validation: 
scalar performance:
{'acc': 0.59152067, 'precision': 0.52557564, 'recall': 0.5509688, 'specificity': 0.9609946, 'f1': 0.50769234, 'auroc': 0.96052235}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   413     0     22     0   0   0     0    19     2   0   27
1     0  1271      0     1   0   0     2    52     4   0    2
2    17     0    130     0   0   0     1   111     2   0   51
3     3     0      0  8054   0   0     2   276    97   0    8
4     3     1    215     1   0   0     0    20    33   0  266
5     4   128      0    33   0   0     5    76   214   0   61
6    11     3      6     0   0   0  1856    12     3   0   17
7     0     2      5    88   0   0     1  7146    21   0    2
8     0     0     54   117   0   0     0   116  2977   0   32
9    20    31      8     1   0   0     3   352     7   0   71
10    5     1  12370     6   0   0     4    21   122   0  267
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5299797, 'precision': 0.38207537, 'recall': 0.4237221, 'specificity': 0.9533802, 'f1': 0.38984036, 'auroc': 0.83706945}
confusion matrix:
     0     1     2   3   4   5     6     7     8   9    10
0   973     3    15   3   0   0    10   125     6   0   35
1     2  1195    11  17   0   0     4   241    12   0   17
2     3     1   251   2   0   0     0    93   144   0  521
3     0     0     0   0   0   0     0     0     0   0    0
4     0     0  1495   0   0   0     2     1    72   0   63
5     3    35     0  43   0   0     7   103    89   0  312
6     0    80    15  42   0   0  2786     3    12   0  129
7     1     0     0  20   0   0     0  1139     0   0    4
8     0     0    13  81   0   0     1    23  1226   0   26
9    11    10    86  29   0   0     0   557    55   0  389
10    0     0  1635   0   0   0     0     0     6   0    5
early stop counter: 1
val acc:0.5915206670761108, best validation acc: 0.5931791067123413, corresponding to test acc:                         0.5115790963172913 / 0.5741971731185913
after epoch: 9,now: 2024-07-29 03:30:14.687185,epoch time: 0:25:40.135373,used: 4:25:10.182302,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.5938035, 'precision': 0.52765703, 'recall': 0.5864182, 'specificity': 0.9613203, 'f1': 0.5057832, 'auroc': 0.97410405}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   429     0     18     0   0   0     6    10     1   0   19
1     0  1310      2     2   0   0     0    14     4   0    0
2     6     0    229     0   0   0     1    25     3   0   48
3     7     8      2  7527   0   0     0   478   404   0   12
4     7     1    171     0   0   0     2    13     2   0  343
5    91   163      7     7   0   0     5   104   100   0   44
6     9     2      2     0   0   0  1880     2     0   0   13
7     0    19     44    21   0   0     1  7091    78   0    9
8     1     0    113     8   0   0     2    41  3106   0   24
9    54    13     68     0   0   0     0   312     2   0   44
10    8     2  12130     2   0   0    10    16     2   0  622
---- Validation: 
scalar performance:
{'acc': 0.59325933, 'precision': 0.5252447, 'recall': 0.58408666, 'specificity': 0.9612812, 'f1': 0.5044453, 'auroc': 0.97441787}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   432     0     11     0   0   0     5    14     1   0   20
1     0  1308      2     2   0   0     0    14     5   0    1
2     7     0    219     0   0   0     1    28     3   0   54
3     3     7      2  7542   0   0     1   474   404   0    7
4     5     1    165     0   0   0     2    13     5   0  348
5    94   167      3     5   0   0     6   105   106   0   35
6     8     0      3     0   0   0  1889     1     1   0    6
7     3    33     44    23   0   0     2  7078    74   0    8
8     1     2    112    10   0   0     0    37  3102   0   32
9    53    16     67     1   0   0     4   318     2   0   32
10   16     0  12136     2   0   0    20     9     4   0  609
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58161336, 'precision': 0.4045118, 'recall': 0.4562194, 'specificity': 0.9579674, 'f1': 0.42354167, 'auroc': 0.8462531}
confusion matrix:
      0     1     2   3   4   5     6     7     8   9    10
0   1001     8     3   5   0   0   117    27     6   0    3
1      4  1334    15  10   0   0    20    89     9   0   18
2     26     3   233   2   0   0    18    51    57   0  625
3      0     0     0   0   0   0     0     0     0   0    0
4      1     1   666   0   0   0    11     0     1   0  953
5     38    31     0  23   0   0     4   150    30   0  316
6      0     0     0   1   0   0  3063     1     0   0    2
7      9     1    13  81   0   0     6  1045     8   0    1
8      2     4    36  10   0   0    18    17  1245   0   38
9     83     8   233   6   0   0    15   419    73   0  300
10     0     0  1250   0   0   0     3     0     1   0  392
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-29 03:56:37.775585,epoch time: 0:26:23.088400,used: 4:51:33.270702,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:51:33.270702 at 2024-07-29 03:56:37.775585
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58161336, 'precision': 0.4045118, 'recall': 0.4562194, 'specificity': 0.9579674, 'f1': 0.42354167, 'auroc': 0.8462531}
confusion matrix:
      0     1     2   3   4   5     6     7     8   9    10
0   1001     8     3   5   0   0   117    27     6   0    3
1      4  1334    15  10   0   0    20    89     9   0   18
2     26     3   233   2   0   0    18    51    57   0  625
3      0     0     0   0   0   0     0     0     0   0    0
4      1     1   666   0   0   0    11     0     1   0  953
5     38    31     0  23   0   0     4   150    30   0  316
6      0     0     0   1   0   0  3063     1     0   0    2
7      9     1    13  81   0   0     6  1045     8   0    1
8      2     4    36  10   0   0    18    17  1245   0   38
9     83     8   233   6   0   0    15   419    73   0  300
10     0     0  1250   0   0   0     3     0     1   0  392
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58161336, 'precision': 0.4045118, 'recall': 0.4562194, 'specificity': 0.9579674, 'f1': 0.42354167, 'auroc': 0.8462531}
confusion matrix:
      0     1     2   3   4   5     6     7     8   9    10
0   1001     8     3   5   0   0   117    27     6   0    3
1      4  1334    15  10   0   0    20    89     9   0   18
2     26     3   233   2   0   0    18    51    57   0  625
3      0     0     0   0   0   0     0     0     0   0    0
4      1     1   666   0   0   0    11     0     1   0  953
5     38    31     0  23   0   0     4   150    30   0  316
6      0     0     0   1   0   0  3063     1     0   0    2
7      9     1    13  81   0   0     6  1045     8   0    1
8      2     4    36  10   0   0    18    17  1245   0   38
9     83     8   233   6   0   0    15   419    73   0  300
10     0     0  1250   0   0   0     3     0     1   0  392
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_23_05_04_seed_1_23121382_instance_wise_predictions.txt
accuracy from prediction file 0.5816133771776394
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1704 MiB |   8691 MiB |    873 TiB |    873 TiB |
|       from large pool |   1697 MiB |   8677 MiB |    867 TiB |    867 TiB |
|       from small pool |      7 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1704 MiB |   8691 MiB |    873 TiB |    873 TiB |
|       from large pool |   1697 MiB |   8677 MiB |    867 TiB |    867 TiB |
|       from small pool |      7 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1702 MiB |   8670 MiB |    871 TiB |    871 TiB |
|       from large pool |   1695 MiB |   8654 MiB |    865 TiB |    865 TiB |
|       from small pool |      6 MiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9216 MiB |   9218 MiB |  16394 MiB |   7178 MiB |
|       from large pool |   9198 MiB |   9200 MiB |  16372 MiB |   7174 MiB |
|       from small pool |     18 MiB |     18 MiB |     22 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 290358 KiB | 550187 KiB | 191306 GiB | 191306 GiB |
|       from large pool | 279296 KiB | 546048 KiB | 185266 GiB | 185266 GiB |
|       from small pool |  11062 KiB |  13085 KiB |   6039 GiB |   6039 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   63513 K  |   63510 K  |
|       from large pool |     247    |     398    |   28376 K  |   28376 K  |
|       from small pool |    2419    |    3627    |   35136 K  |   35133 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   63513 K  |   63510 K  |
|       from large pool |     247    |     398    |   28376 K  |   28376 K  |
|       from small pool |    2419    |    3627    |   35136 K  |   35133 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     263    |     264    |     428    |     165    |
|       from large pool |     254    |     255    |     417    |     163    |
|       from small pool |       9    |       9    |      11    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     116    |    1239    |   33102 K  |   33102 K  |
|       from large pool |      92    |     180    |   17989 K  |   17989 K  |
|       from small pool |      24    |    1147    |   15113 K  |   15113 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   8691 MiB |    873 TiB |    873 TiB |
|       from large pool |  65536 KiB |   8677 MiB |    867 TiB |    867 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   8691 MiB |    873 TiB |    873 TiB |
|       from large pool |  65536 KiB |   8677 MiB |    867 TiB |    867 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   8670 MiB |    871 TiB |    871 TiB |
|       from large pool |  65536 KiB |   8654 MiB |    865 TiB |    865 TiB |
|       from small pool |      0 KiB |     16 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1988 MiB |   9218 MiB |  16394 MiB |  14406 MiB |
|       from large pool |   1970 MiB |   9200 MiB |  16372 MiB |  14402 MiB |
|       from small pool |     18 MiB |     18 MiB |     22 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 550187 KiB | 191307 GiB | 191307 GiB |
|       from large pool |      0 B   | 546048 KiB | 185267 GiB | 185267 GiB |
|       from small pool |      0 B   |  16594 KiB |   6039 GiB |   6039 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   63513 K  |   63513 K  |
|       from large pool |       2    |     398    |   28376 K  |   28376 K  |
|       from small pool |       0    |    3627    |   35136 K  |   35136 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   63513 K  |   63513 K  |
|       from large pool |       2    |     398    |   28376 K  |   28376 K  |
|       from small pool |       0    |    3627    |   35136 K  |   35136 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     100    |     264    |     428    |     328    |
|       from large pool |      91    |     255    |     417    |     326    |
|       from small pool |       9    |       9    |      11    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1239    |   33103 K  |   33103 K  |
|       from large pool |       0    |     180    |   17989 K  |   17989 K  |
|       from small pool |       0    |    1147    |   15113 K  |   15113 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 29 04:01:30 2024]
Finished job 0.
1 of 1 steps (100%) done
