Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 29 12:43:40 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/18.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=18
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621

 Experiment start at: 2024-07-29 13:05:45.429048
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5504067, 'precision': 0.46882018, 'recall': 0.5105382, 'specificity': 0.95614606, 'f1': 0.42306283, 'auroc': 0.93286055}
confusion matrix:
    0     1   2     3   4    5      6     7     8    9   10
0    8    13   0     7   0   97    294    18    12   32   1
1    1  1108   0     9   0    5     48   158     3    0   0
2    3    16   0     3   0   74     47    37    26  102   4
3    0     0   0  7106   0  112      4   991   212   12   0
4   10     3   0     1   0   50    376    13    63   21   1
5    0     0   0    19   0  244      2     0     8  248   0
6    0     2   0     5   1   23   1848    16    12    0   1
7   10     5   0    59   0    6     15  7119    47    4   0
8    1     0   0    97   1   16     75   282  2803   18   1
9    0     5   0     4   0  139      2     9    10  323   0
10  42     4   0     6   0   65  12510    33   109   13  13
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.55099636, 'precision': 0.48117948, 'recall': 0.5091301, 'specificity': 0.9561962, 'f1': 0.42358768, 'auroc': 0.93404686}
confusion matrix:
    0     1   2     3   4    5      6     7     8    9   10
0   10    11   0    11   1   90    290    23    17   26   4
1    1  1110   0    10   0    7     47   147     9    1   0
2    2    14   0     3   1   74     60    30    20  104   4
3    0     1   0  7124   0  105      3   988   210    8   1
4    6     3   0     0   0   48    392    13    57   20   0
5    0     0   0    22   0  234      2     0     8  255   0
6    0     1   0     4   0   11   1855    25     9    3   0
7    8     6   0    59   1    2     12  7121    54    2   0
8    2     1   0    86   0   22     70   299  2801   15   0
9    0     7   0     4   0  138      1     9    14  320   0
10  49     4   0     7   0   55  12517    38    87   15  24
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49149933, 'precision': 0.31126192, 'recall': 0.38191304, 'specificity': 0.9442123, 'f1': 0.32543904, 'auroc': 0.7946191}
confusion matrix:
    0    1   2   3   4    5     6     7     8    9   10
0    0   75   0  11   2  221   624    58    12  151  16
1   12  939   0   6   0   41   184   289    12   13   3
2   13   23   0   1   1   95   477    80    97  208  20
3    0    0   0   0   0    0     0     0     0    0   0
4    1    0   0   0   1    4  1619     1     7    0   0
5    0    9   0   2   1  105     4     0     1  469   1
6    1    5   0   0   1    0  3044     5     9    0   2
7    0    8   0   0   1    0     5  1148     0    2   0
8    0   19   0  14   6   34   138    50  1034   74   1
9    2   82   0   2   0  134    52    68    38  754   5
10   0    0   0   0   0    1  1645     0     0    0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 14:22:54.087370,epoch time: 1:17:08.658322,used: 1:17:08.658322,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6205586, 'precision': 0.6048641, 'recall': 0.5893385, 'specificity': 0.96285355, 'f1': 0.53357357, 'auroc': 0.9690812}
confusion matrix:
     0     1   2     3   4    5      6     7     8    9     10
0   274     0   0     6   0    1     71    52    26   15    38
1     0  1225   0     8   0    2      3    87     2    0     5
2    18    11   0     1   0   13     60    69    23   94    23
3     0     0   0  7659   0    9      1   582   187    2     0
4    14     2   0     1   0    5    399    14    54   20    30
5     2     0   0    50   0  209      1     4    12  243     0
6     7     3   0     9   0    2   1840    27    10    3     6
7     8     5   0    69   0    1      5  7148    20    0     8
8     3     0   0    55   0    1     47   293  2884    1    10
9     4     1   0    12   0   55      3    24    25  364     5
10   47     2   0     8   0    3  11029    35    72    4  1591
---- Validation: 
scalar performance:
{'acc': 0.6213722, 'precision': 0.6017464, 'recall': 0.5863049, 'specificity': 0.96293914, 'f1': 0.5301136, 'auroc': 0.9698272}
confusion matrix:
     0     1   2     3   4    5      6     7     8    9     10
0   275     0   0     9   0    2     65    51    18   18    45
1     1  1214   0    12   0    3      4    91     3    0     4
2    23    13   0     4   0    9     57    61    26  105    14
3     0     0   0  7657   0   11      0   578   192    2     0
4    18     2   0     0   0    5    398    18    52   17    29
5     0     0   0    59   0  192      1     0    14  255     0
6     6     2   0    12   0    3   1842    31     9    1     2
7     4     5   0    72   0    1      5  7141    28    0     9
8     3     0   0    52   0    1     40   300  2890    1     9
9     5     1   0     8   0   58      4    23    28  364     2
10   41     1   0     6   0    5  10989    29    67    3  1655
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5518786, 'precision': 0.43516403, 'recall': 0.44092673, 'specificity': 0.9514738, 'f1': 0.39344925, 'auroc': 0.8435167}
confusion matrix:
     0     1   2   3   4   5     6     7     8    9   10
0   556     1   0  15   1   5    69   242   205   68   8
1     0  1253   0  26   0  14    22   167     6    2   9
2    60    23   0   3   0   7   246   162   332  130  52
3     0     0   0   0   0   0     0     0     0    0   0
4     4     1   0   0   0   0  1552     3    16    0  57
5     1     0   0  35   0  90     1     6    39  420   0
6     0     1   0  21   0   0  2989    17    38    0   1
7     0     1   0   2   0   0     1  1155     1    1   3
8     0     0   0  21   0   0     6    55  1279    8   1
9     9    24   0  28   0  22    19   194   305  525  11
10    0     0   0   0   0   0  1605     0     0    0  41
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 15:32:33.113481,epoch time: 1:09:39.026111,used: 2:26:47.684433,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92554045, 'precision': 0.71413064, 'recall': 0.6905434, 'specificity': 0.99156237, 'f1': 0.6909656, 'auroc': 0.984472}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   304     0   0     5   0    0    13     9    15    2    135
1     0  1263   0     8   0    3     2    38     6    2     10
2     2     9   0    55  13    1    76     9     8   79     60
3     1     1   0  8041   0   13     5   278    94    3      2
4     2     0   0     6   2    6   239     1     8    3    272
5     0     0   0    40   0  272     1     0     5  201      1
6     5     0   0     2   0    2  1870     3     1    0     25
7    16    51   0   103   2    3     8  6978    34    3     66
8     2     1   0   134   0    2    22   142  2805    3    182
9     3     1   0    30   0   51     4     5     5  372     22
10    9     2   0     8   0    0    74     9     3    3  12686
---- Validation: 
scalar performance:
{'acc': 0.9244082, 'precision': 0.7189622, 'recall': 0.6873535, 'specificity': 0.9914298, 'f1': 0.68754643, 'auroc': 0.98457825}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   309     0   0     4   0    1    10    12    10    3    134
1     0  1258   0    10   1    4     6    39     4    1      9
2     3     6   0    74   8    1    84    15     5   71     45
3     2     1   0  8048   0   15     7   258   105    0      4
4     2     1   0     7   3    8   214     1     7    4    292
5     1     0   0    39   0  254     0     0     3  222      2
6    10     0   0     1   0    2  1866     4     2    1     22
7    12    60   0   131   0    0     8  6952    33    0     69
8     2     2   0   119   0    3    25   143  2812    2    188
9     2     1   0    25   2   50     7     6     6  370     24
10   10     0   0     7   0    1    74     4    10    3  12687
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7026516, 'precision': 0.54454577, 'recall': 0.5761097, 'specificity': 0.9695069, 'f1': 0.5369747, 'auroc': 0.86742705}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   851     0   0   9   0    4    17    53   181   34    21
1     0  1338   0  19   0    9    22    70    10    7    24
2    40     6   0  23   4    6   272    96   196   86   286
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   0   0    0   180     2     6    0  1443
5     3     0   0  41   0  179     2     1    27  337     2
6     2     0   0  19   0    0  3033     1     5    0     7
7     0     3   0  19   1    1     3  1128     3    2     4
8     0     0   0  49   0    2    10    11  1289    5     4
9    21    22   0  43   0   26    19   121   235  604    46
10    0     0   0   0   0    0    25     0     0    0  1621
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 16:40:25.020227,epoch time: 1:07:51.906746,used: 3:34:39.591179,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92941993, 'precision': 0.75548065, 'recall': 0.7112732, 'specificity': 0.9925058, 'f1': 0.70524156, 'auroc': 0.9802711}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   317     0   0     8   0    3     8    48    48    4     45
1     0  1245   0     5   0    2     3    62    11    0      4
2     3     1   0    58  26    2    10    28    17  156     11
3     1     0   0  7956   0   35     1   251   190    2      0
4     3     2   0    28  69    5   165    16    47   15    189
5     0     0   0    17   0  219     0     0     8  275      1
6    10     0   0     7   1    1  1837    13    19    2     18
7     0     7   0   106   0    0     2  7012   127    8      3
8     1     0   0    59   1    4     2    71  3137    9     12
9     1     0   0     7   0   38     1     2     7  434      3
10   29     0   0     9   3    3    87    21   126    4  12512
---- Validation: 
scalar performance:
{'acc': 0.92975795, 'precision': 0.81054604, 'recall': 0.71391237, 'specificity': 0.9925151, 'f1': 0.70810425, 'auroc': 0.9816217}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   335     0   0     7   0    3    10    32    45    5     46
1     0  1239   0    11   0    1     2    65     9    0      5
2     4     6   1    59  13    2    15    25    19  154     14
3     0     0   0  7939   0   37     0   248   212    4      0
4     3     1   1    36  67    7   153    19    39   17    196
5     0     0   0    16   0  221     0     0     6  277      1
6    11     0   0     2   0    2  1856     7    11    1     18
7     0     6   0   122   1    0     1  7013   109    7      6
8     1     0   0    55   0    5     2    60  3147    6     20
9     1     0   0    11   0   42     2     3     6  427      1
10   21     1   0    11   4    1    92    20   129    3  12514
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6700483, 'precision': 0.5334531, 'recall': 0.5512175, 'specificity': 0.96563995, 'f1': 0.513621, 'auroc': 0.857897}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   748     1   0   4   0    1    29   107   257   19     4
1     1  1228   0  12   0    1    14   176    37   15    15
2    14     7   0  18  42   16   205   105   491   73    44
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   0   4    0   700     2    50    0   875
5     2     1   0  30   0  209     9     3    44  293     1
6     1     0   0  20   0    0  2943     3   100    0     0
7     0     0   0   2   0    0     1  1146    13    0     2
8     0     0   0  12   0    0     0     1  1355    2     0
9    13    11   0  30   5   39    17    87   427  497    11
10    0     0   0   0   0    0   197     1     1    0  1447
better model found
persisted
after epoch: 4,now: 2024-07-29 17:44:43.324151,epoch time: 1:04:18.303924,used: 4:38:57.895103,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9365101, 'precision': 0.7899036, 'recall': 0.7115878, 'specificity': 0.9926686, 'f1': 0.7346598, 'auroc': 0.9868402}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   320     0   0     1   0    0     0    45     1    1    114
1     0  1252   0    19   0    0     1    48     5    1      6
2     3     1   0   192  40    1     8    15     7   28     17
3     0     1   0  8273   0   10     0    91    59    1      2
4     2     0   0    35  91    2   137     3    14    4    251
5     2     0   0    36   0  363     0     1     1  116      2
6    30     0   0     4   0    3  1780     7     1    0     83
7     1     4   0   207   0    0     2  7002    34    0     14
8     2     0   0   218   0    2     2   115  2890    2     65
9     6     0   0    93   0   72     0    12     3  300      7
10    7     0   0     8   2    1    15    18     8    1  12732
---- Validation: 
scalar performance:
{'acc': 0.93652534, 'precision': 0.78463155, 'recall': 0.71002215, 'specificity': 0.99265957, 'f1': 0.7320955, 'auroc': 0.9869522}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   320     0   0     3   0    1     0    42     0    2    115
1     0  1251   0    17   0    0     3    49     5    0      7
2     2     1   0   192  41    1     5    12     6   27     25
3     0     1   0  8296   0    9     0    87    45    0      2
4     6     0   0    30  79    3   153     5    10    0    253
5     1     0   0    31   0  371     0     0     4  113      1
6    33     0   0     5   2    2  1768     3     2    0     93
7     1     6   0   208   1    0     1  7003    34    0     11
8     2     0   0   191   1    1     3   135  2889    2     72
9     5     0   0    99   0   71     2     8     4  298      6
10    8     0   0    10   3    2    13    16     7    0  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6636815, 'precision': 0.5488113, 'recall': 0.5542182, 'specificity': 0.96625566, 'f1': 0.52919257, 'auroc': 0.855264}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   999     0   0    5    1    5     1   120    20    6    13
1     0  1188   0   43    1    0    13   214     8    2    30
2    29     1   0  143  104   12   209   118   219   31   149
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    1    6    0   222     3    21    0  1378
5    13     0   0  116    0  327    10     2     5  116     3
6    23     0   0   35    0    0  2903     8    30    0    68
7     0     0   0   87    0    0     0  1069     2    1     5
8     1     0   0  266    0    1     6    13  1079    2     2
9    39     9   0  385   14   89    13   138   124  287    39
10    0     0   0    0    1    0    17     0     0    0  1628
better model found
persisted
after epoch: 5,now: 2024-07-29 18:44:53.934496,epoch time: 1:00:10.610345,used: 5:39:08.505448,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9413795, 'precision': 0.8447317, 'recall': 0.7244122, 'specificity': 0.9934201, 'f1': 0.7395331, 'auroc': 0.9870248}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   358     0   0     6   0    0     1    41    10    1     66
1     0  1278   0    11   0    0     1    31     6    0      5
2     1     1   3   126  58    0    22    27    22   36     16
3     0     2   0  8212   0    3     0   132    86    0      0
4     1     0   0    20  49    2   179     3    23    3    259
5     2     0   0    72   0  368     1     0     6   70      2
6     9     0   0     6   0    0  1839     3    10    0     41
7     0    13   0   135   0    0     2  6978   125    0     10
8     1     0   0   120   1    0     1    53  3090    1     29
9     4     3   1    49   2   79     1    14    23  312      5
10   15     0   0    14   1    2     4     4    56    0  12698
---- Validation: 
scalar performance:
{'acc': 0.9409389, 'precision': 0.77279896, 'recall': 0.7195386, 'specificity': 0.99337786, 'f1': 0.733217, 'auroc': 0.9865388}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   346     0   0     4   0    1     0    52    16    1     63
1     0  1281   0    11   0    0     0    28     7    0      5
2     1     4   0   130  55    1    22    23    18   42     16
3     0     1   0  8205   0    5     0   143    86    0      0
4     5     0   0    21  45    3   176     3    32    3    251
5     0     0   0    73   0  361     0     0     9   74      4
6     9     0   0     3   0    0  1828     2     8    1     57
7     0    15   0   136   0    0     2  6995   109    0      8
8     0     0   0   112   0    0     1    43  3114    0     26
9     6     2   0    47   0   85     1    18    17  311      6
10   11     1   0    12   2    1     9     5    64    0  12691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68110263, 'precision': 0.5507246, 'recall': 0.57298315, 'specificity': 0.9678217, 'f1': 0.5339365, 'auroc': 0.8529438}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   952     0   0   15   0    5    21    73    67   13    24
1     1  1340   0   30   0    0     8    92    10    0    18
2    14    15   0   73  60   17   250    44   311   24   207
3     0     0   0    0   0    0     0     0     0    0     0
4     2     1   0    0   2    0    69     2    19    0  1538
5     6     0   0  159   0  352     7     2    11   51     4
6     0     0   0   57   0    0  2851     2    67    0    90
7     0     0   0   37   0    0     0  1118     4    0     5
8     0     0   0  103   0    1     3     5  1256    1     1
9    20    36   1  242  14  153    25   120   265  221    40
10    0     0   0    0   0    0     3     0     0    0  1643
better model found
persisted
after epoch: 6,now: 2024-07-29 19:37:57.987098,epoch time: 0:53:04.052602,used: 6:32:12.558050,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9406304, 'precision': 0.82973874, 'recall': 0.74194086, 'specificity': 0.9933677, 'f1': 0.7576802, 'auroc': 0.990538}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   292     0   0     5    0    0     3    96    15    1     71
1     0  1297   0     8    0    0     1    20     1    0      5
2     1     1   1   160   34    0     1    23    13   71      7
3     0     3   0  7909    0   15     0   370   141    0      1
4     0     2   2    43  130    1   124     1    13    2    221
5     0     0   0    24    0  366     0     0     9  119      2
6     9     0   0    13    1    0  1853     3     5    1     22
7     0    24   0    59    2    0     1  7102    61    2     13
8     1     0   0    61    0    0     4    81  3113    3     33
9     0     1   1    26    0   43     0    10    10  400      2
10   11     1   0    14    2    0    28    10    30    1  12694
---- Validation: 
scalar performance:
{'acc': 0.94005615, 'precision': 0.80035067, 'recall': 0.7334851, 'specificity': 0.9933046, 'f1': 0.7486317, 'auroc': 0.9902019}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   277     0   0     8    0    0     6    93    18    2     79
1     0  1295   0     4    0    1     1    24     3    0      4
2     1     4   0   158   32    0     4    28    11   67      7
3     0     4   0  7928    0   15     0   340   153    0      0
4     2     1   0    40  111    1   138     4    14    3    225
5     0     0   0    21    0  370     0     1     3  125      1
6     5     0   0     9    1    0  1855     6     7    2     23
7     0    21   0    58    1    0     1  7123    47    1     13
8     1     2   0    51    3    0     1    85  3111    2     40
9     0     1   0    34    0   48     0    18     8  384      0
10   12     0   0    13    5    0    29    21    25    1  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69250685, 'precision': 0.61788046, 'recall': 0.5730771, 'specificity': 0.9687785, 'f1': 0.5371375, 'auroc': 0.8692811}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   620     5   0   11    1    4    28   281   169   30    21
1     0  1392   0    8    0    4     3    81     2    0     9
2     1    56  14  104  189    4   130    91   304   68    54
3     0     0   0    0    0    0     0     0     0    0     0
4     2     4   0    2   20    0   197     2    15    0  1391
5     1     1   0   76    0  285     1     4    27  195     2
6     0     5   0   41    0    0  2990     3    22    0     6
7     0     1   0    1    0    0     0  1159     1    0     2
8     0     0   0   35    0    1     2    17  1313    2     0
9     2    72   6   77    6   50     5   147   287  478     7
10    0     1   0    0    0    0    18     0     0    0  1627
early stop counter: 1
val acc:0.9400561451911926, best validation acc: 0.9409388899803162, corresponding to test acc:                         0.6811026334762573 / 0.7026516199111938
after epoch: 7,now: 2024-07-29 20:41:11.729817,epoch time: 1:03:13.742719,used: 7:35:26.300769,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94493794, 'precision': 0.85538375, 'recall': 0.74851215, 'specificity': 0.9940668, 'f1': 0.75306207, 'auroc': 0.9869489}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   367     0   0     5   0    0     4    27    19    4     57
1     0  1229   0     7   0    0     2    80    11    0      2
2     0     0   4    76  50    2    17    61    18   82      2
3     0     0   0  8132   0   17     0   170   118    0      1
4     3     1   0     4  73    0   241     8    42    7    160
5     0     0   0    17   0  446     1     0     6   49      2
6     2     0   0     1   0    1  1874     4     9    1     16
7     0     5   0    88   1    0     1  7105    59    0      6
8     0     0   1    60   1    0     3    52  3165    1     12
9     0     1   0     8   1  122     0    14    12  334      1
10   10     0   0    12   2    2    54    17   104    1  12589
---- Validation: 
scalar performance:
{'acc': 0.94334626, 'precision': 0.84671855, 'recall': 0.7501273, 'specificity': 0.9939011, 'f1': 0.7543387, 'auroc': 0.9877248}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   370     0   0     3   0    0     5    23    19    4     59
1     0  1233   0     6   0    0     3    78     9    0      3
2     0     2   8    69  48    1    15    50    20   95      4
3     0     0   0  8109   0   18     1   200   112    0      0
4     2     0   1    15  73    3   237     5    39    3    161
5     0     0   0    14   0  452     1     0     6   47      1
6     4     0   1     2   0    1  1869     4    11    0     16
7     0     3   0    93   0    0     2  7101    61    0      5
8     1     0   0    62   3    1     1    60  3158    1      9
9     0     1   1     7   1  120     3    17     9  332      2
10   11     0   0    11   2    2    75    20   113    0  12562
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.688239, 'precision': 0.5951753, 'recall': 0.5766584, 'specificity': 0.96781653, 'f1': 0.53475463, 'auroc': 0.85545033}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   869     0   0   5   1    3    81    51    59   25    76
1     0  1172   0  20   0    3     9   260    23    0    12
2     1     7   3  35  82   11   299    79   392   55    51
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   1   6    0   393     3    30    0  1198
5     2     0   0  61   0  369    28     3    19  108     2
6     0     0   0   8   0    0  3031     2    26    0     0
7     0     0   0  25   1    0     0  1127     8    0     3
8     0     0   0  38   0    1     4     2  1323    1     1
9     9    15   2  75  11  135    32   140   373  330    15
10    0     0   0   0   0    0    38     1     0    0  1607
better model found
persisted
after epoch: 8,now: 2024-07-29 21:42:27.496893,epoch time: 1:01:15.767076,used: 8:36:42.067845,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.943841, 'precision': 0.7585769, 'recall': 0.71879685, 'specificity': 0.9937294, 'f1': 0.72878766, 'auroc': 0.99318445}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   331     1   0     1   0    2     4    17     1    0    126
1     0  1267   0     7   0    0     2    46     2    0      8
2     1     1   0   146  58    2    40    14     3   36     11
3     0     1   0  8215   0   16     3   104    99    0      0
4     0     0   0     6  22    0   302     2    11    0    196
5     0     3   0    26   0  409     0     0     4   77      2
6     2     0   0     4   0    0  1868     3     0    0     30
7     0     5   0   115   0    0     2  7107    29    0      5
8     0     0   0    68   5    0    18    94  3052    0     56
9     1     0   0    59   7   92    10    17     1  292     14
10    5     0   0    10   1    1    41     9    14    0  12714
---- Validation: 
scalar performance:
{'acc': 0.94476396, 'precision': 0.7641563, 'recall': 0.7217761, 'specificity': 0.9938441, 'f1': 0.7318803, 'auroc': 0.99303436}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   327     0   0     1   0    2     7    18     2    1    125
1     0  1265   0    11   0    0     2    46     1    0      7
2     3     1   0   135  59    0    48    19     3   37      7
3     1     1   0  8230   0   15     3   101    88    0      1
4     0     0   0     5  29    2   294     2     5    0    202
5     0     0   0    24   1  412     0     1     5   74      4
6     4     1   0     3   1    0  1874     2     3    0     20
7     0     6   0   103   0    0     2  7122    25    0      7
8     0     0   0    79   4    1    19   106  3039    2     46
9     1     2   0    64   4   93     7     7     1  303     11
10    2     1   0    10   1    1    48     7     7    0  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6703981, 'precision': 0.62364346, 'recall': 0.56224316, 'specificity': 0.96633935, 'f1': 0.5349983, 'auroc': 0.86640483}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   820     0   0    6   0    9     3    46     1   15   270
1     1  1120   0   43   0    1     8   278     5    0    43
2     4     2   3  137  80   12   393    72   141   37   134
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    3   2    0   291     1     5    0  1331
5     1     0   0   81   0  373    18     2     8   99    10
6     0     0   0   28   0    0  2963     3     8    0    65
7     0     0   0   40   0    0     0  1121     0    0     3
8     0     0   0  118   0    1    20    13  1216    1     1
9     7    11   1  250  13  137    34   201    77  340    66
10    0     0   0    0   0    0    22     0     0    0  1624
better model found
persisted
after epoch: 9,now: 2024-07-29 22:51:20.538249,epoch time: 1:08:53.041356,used: 9:45:35.109201,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94450986, 'precision': 0.7951044, 'recall': 0.7467729, 'specificity': 0.9939058, 'f1': 0.7542819, 'auroc': 0.9928003}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   290     3   0     3    0    3    26     4     1    6    147
1     0  1305   0     7    0    0     1    14     2    3      0
2     0     2   0   137   45    0     5     6     1  112      4
3     0     4   0  8257    0    2     1   129    40    5      0
4     2     1   0    31  133    1   209     4     3    7    148
5     0     1   0    32    1  360     0     0     1  125      1
6     1     0   0     2    0    0  1890     1     1    1     12
7     2    38   0   100    1    2     3  7053    41   11     11
8     0     0   0   159    9    1    16    73  2990   12     35
9     0     2   0    20    0   40     1     1     2  426      1
10    3     1   0    13   12    1   140    12     9    4  12598
---- Validation: 
scalar performance:
{'acc': 0.9448442, 'precision': 0.7959545, 'recall': 0.7469232, 'specificity': 0.993912, 'f1': 0.75523853, 'auroc': 0.9937975}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   288     0   0     1    0    3    14     5     2    8    162
1     0  1307   0     6    0    0     1    13     4    1      0
2     0     2   0   145   45    0     4     8     1  106      1
3     0     4   0  8248    0    9     1   135    41    1      1
4     0     0   0    31  133    0   215     1     4    5    150
5     0     2   0    28    0  365     0     0     2  123      1
6     1     0   0     1    0    0  1891     1     1    0     13
7     1    43   0   105    2    0     4  7064    26    9     11
8     0     2   0   151   11    1    19    78  2980   11     43
9     0     2   0    15    2   48     0     2     0  424      0
10    1     0   0    15   10    0   118     7    18    4  12623
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68278176, 'precision': 0.63306534, 'recall': 0.5720536, 'specificity': 0.9669164, 'f1': 0.55791867, 'auroc': 0.8680288}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   561     1   0    7    1   16    65    18     4  109   388
1     1  1387   0   24    0    5     8    58     4    6     6
2     1    15  13  163  193   12   375    24    73  117    29
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    4   12    0   736     0     5    1   875
5     0     2   0   80    0  369    11     0     1  129     0
6     0     1   0   24    0    0  3040     1     0    0     1
7     1     0   0   87    0    2     1  1052     2   11     8
8     0     0   0  121    1    3    42     7  1193    3     0
9     1    34   7  153   22  128    12    24    73  674     9
10    0     0   0    1    0    0   187     0     0    0  1458
better model found
persisted
after epoch: 10,now: 2024-07-30 00:00:01.328200,epoch time: 1:08:40.789951,used: 10:54:15.899152,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 10:54:15.899152 at 2024-07-30 00:00:01.328200
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68278176, 'precision': 0.63306534, 'recall': 0.5720536, 'specificity': 0.9669164, 'f1': 0.55791867, 'auroc': 0.8680288}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   561     1   0    7    1   16    65    18     4  109   388
1     1  1387   0   24    0    5     8    58     4    6     6
2     1    15  13  163  193   12   375    24    73  117    29
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    4   12    0   736     0     5    1   875
5     0     2   0   80    0  369    11     0     1  129     0
6     0     1   0   24    0    0  3040     1     0    0     1
7     1     0   0   87    0    2     1  1052     2   11     8
8     0     0   0  121    1    3    42     7  1193    3     0
9     1    34   7  153   22  128    12    24    73  674     9
10    0     0   0    1    0    0   187     0     0    0  1458
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7026516, 'precision': 0.54454577, 'recall': 0.5761097, 'specificity': 0.9695069, 'f1': 0.5369747, 'auroc': 0.86742705}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   851     0   0   9   0    4    17    53   181   34    21
1     0  1338   0  19   0    9    22    70    10    7    24
2    40     6   0  23   4    6   272    96   196   86   286
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   0   0    0   180     2     6    0  1443
5     3     0   0  41   0  179     2     1    27  337     2
6     2     0   0  19   0    0  3033     1     5    0     7
7     0     3   0  19   1    1     3  1128     3    2     4
8     0     0   0  49   0    2    10    11  1289    5     4
9    21    22   0  43   0   26    19   121   235  604    46
10    0     0   0   0   0    0    25     0     0    0  1621
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_13_05_43_seed_0_23229621_instance_wise_predictions.txt
accuracy from prediction file 0.6827817812915413
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/18.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1656 MiB |  15860 MiB | 414191 GiB | 414190 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411234 GiB | 411232 GiB |
|       from small pool |      8 MiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1656 MiB |  15860 MiB | 414191 GiB | 414190 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411234 GiB | 411232 GiB |
|       from small pool |      8 MiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1655 MiB |  15816 MiB | 412626 GiB | 412624 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 409672 GiB | 409670 GiB |
|       from small pool |      7 MiB |     26 MiB |   2954 GiB |   2954 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  16520 MiB |      0 B   |
|       from large pool |  16492 MiB |  16492 MiB |  16492 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 232611 KiB | 631707 KiB |  63171 GiB |  63171 GiB |
|       from large pool | 216320 KiB | 628608 KiB |  60198 GiB |  60198 GiB |
|       from small pool |  16291 KiB |  23329 KiB |   2973 GiB |   2973 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3602    |    4664    |   30482 K  |   30478 K  |
|       from large pool |     247    |     595    |   13397 K  |   13397 K  |
|       from small pool |    3355    |    4364    |   17084 K  |   17081 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3602    |    4664    |   30482 K  |   30478 K  |
|       from large pool |     247    |     595    |   13397 K  |   13397 K  |
|       from small pool |    3355    |    4364    |   17084 K  |   17081 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     467    |       0    |
|       from large pool |     453    |     453    |     453    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     124    |    1242    |   16684 K  |   16683 K  |
|       from large pool |      95    |     303    |    8723 K  |    8723 K  |
|       from small pool |      29    |    1146    |    7960 K  |    7960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414191 GiB | 414191 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414191 GiB | 414191 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412626 GiB | 412626 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409672 GiB | 409672 GiB |
|       from small pool |      0 KiB |     26 MiB |   2954 GiB |   2954 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1884 MiB |  16520 MiB |  16520 MiB |  14636 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     24 MiB |     28 MiB |     28 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 631707 KiB |  63173 GiB |  63173 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60199 GiB |  60199 GiB |
|       from small pool |      0 KiB |  23329 KiB |   2973 GiB |   2973 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4664    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    4364    |   17084 K  |   17084 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4664    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    4364    |   17084 K  |   17084 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     105    |     467    |     467    |     362    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      12    |      14    |      14    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1242    |   16685 K  |   16685 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |    1146    |    7961 K  |    7961 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414191 GiB | 414191 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414191 GiB | 414191 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412626 GiB | 412626 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409672 GiB | 409672 GiB |
|       from small pool |      0 KiB |     26 MiB |   2954 GiB |   2954 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1884 MiB |  16520 MiB |  16520 MiB |  14636 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     24 MiB |     28 MiB |     28 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 631707 KiB |  63173 GiB |  63173 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60199 GiB |  60199 GiB |
|       from small pool |      0 KiB |  23329 KiB |   2973 GiB |   2973 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4664    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    4364    |   17084 K  |   17084 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4664    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    4364    |   17084 K  |   17084 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     105    |     467    |     467    |     362    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      12    |      14    |      14    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1242    |   16685 K  |   16685 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |    1146    |    7961 K  |    7961 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621

 Experiment start at: 2024-07-30 00:38:21.160713
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8232021, 'precision': 0.4937189, 'recall': 0.53321064, 'specificity': 0.98129195, 'f1': 0.49820435, 'auroc': 0.88641256}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   280    30   0    17   0   17    93     2     5   0     39
1     1  1200   0    46  11    0     0    70     1   0      3
2    31    28   0    20   0   69    16    25    20   0    103
3     3     3   0  8217   1    5     1   100   108   0      0
4     2    79   0    12   2  123    46     3    66   0    206
5    28    11   0   199   0  152    68     4    39   0     20
6    72   447   0    15   1   47  1176     6    33   0    111
7     7    24   2  1016   9   12     6  6096    75   0     16
8     2     8   0   465   0  106    11    35  2633   0     36
9    94    28   1    51   1  125    88     7    19   0     79
10   21  1055   0    30   1  387   132    25   128   0  11012
---- Validation: 
scalar performance:
{'acc': 0.8241273, 'precision': 0.48898947, 'recall': 0.5338444, 'specificity': 0.9814044, 'f1': 0.49874926, 'auroc': 0.88459396}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   272    32   0    16   0   17   101     4     2   0     39
1     0  1203   0    48  12    2     1    63     0   0      3
2    34    38   0    21   0   57    26    24    28   0     84
3     0     3   0  8238   0    4     0    86   107   0      2
4     3    75   0    14   0  111    45     5    65   0    221
5    32     4   0   192   0  163    61     0    42   0     27
6    67   446   1    20   0   63  1182     6    28   0     95
7     6    24   0  1007  11   16     4  6092    92   0     13
8     2    12   0   461   1  103    12    45  2626   0     34
9    88    28   0    52   0  134    78    10    17   0     86
10   16  1045   0    32   1  427   113    22   106   0  11034
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.45161968, 'precision': 0.3366382, 'recall': 0.4061669, 'specificity': 0.9451605, 'f1': 0.33610618, 'auroc': 0.7218708}
confusion matrix:
     0     1   2    3   4    5    6     7     8   9     10
0   985    11   2   58   0    4   84    23     1   0     2
1    61  1202   0   59  19    4    2   136     2   0    14
2   115   122   0  117   0   60   21    15    92   0   473
3     0     0   0    0   0    0    0     0     0   0     0
4     4   243   0    2   0   15    3     0    23   0  1343
5   166    43   0  204   0   34   35     6    14   0    90
6    31  1344   1   51   7  271  669     4   274   0   415
7    50     1   0  107   0    0    0  1002     0   0     4
8    13     1   0  244   1   29    2     3  1067   0    10
9   319    86   0  310   0   23   32    29    17   0   321
10    0   147   0    0   0    2    1     0     0   0  1496
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-30 01:53:40.129262,epoch time: 1:15:18.968549,used: 1:15:18.968549,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90448415, 'precision': 0.6220581, 'recall': 0.63632417, 'specificity': 0.9889537, 'f1': 0.62301564, 'auroc': 0.9195264}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   395     1   0    22   0    0    12     6     0   0     47
1     0  1261   7    27   0    0     1    30     2   0      4
2    43     5   9    15   0   20     7    31    15   0    167
3     2     1   1  8210   0    9     0   137    78   0      0
4    12     4   1    35   0   10     5    20    24   0    428
5    35     0   0    75   0  319    44     3    34   0     11
6    42    10   4    24   0   14  1761     6    10   0     37
7     4    58  15   435   0    0     2  6697    38   0     13
8     3     3  18   490   0   14     0    85  2624   0     58
9   147     1   3    29   0  108    32    13    16   0    144
10   45     9  12   106   0    3    21    48    19   0  12530
---- Validation: 
scalar performance:
{'acc': 0.9017788, 'precision': 0.61562896, 'recall': 0.6317126, 'specificity': 0.9886631, 'f1': 0.6191182, 'auroc': 0.91816604}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   378     1   0    12   0    0    24    13     4   0     51
1     0  1256   8    24   0    0     1    38     1   0      4
2    51     2   7    20   0   18     2    24     8   0    180
3     0     1   1  8215   0    7     3   144    68   0      1
4    13     5   1    42   0    8     4    17    23   0    426
5    27     0   1    70   0  325    43     1    36   0     18
6    44    10   3    30   0   17  1760     6     8   0     30
7     1    64  20   471   0    1     1  6659    33   0     15
8     2     2  28   507   0   16     0   106  2591   0     44
9   152     2   0    34   0  110    43     7    16   0    129
10   41    11  17   111   0    2    18    48    26   0  12522
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5986147, 'precision': 0.446942, 'recall': 0.49686533, 'specificity': 0.96010023, 'f1': 0.4431756, 'auroc': 0.78300923}
confusion matrix:
      0     1   2    3   4    5     6     7     8   9     10
0   1052     8   3   41   0    1    28    33     1   0     3
1     10  1359  17   36   0    1     6    56     1   0    13
2    183    13  29  142   0   22     6    64    57   0   499
3      0     0   0    0   0    0     0     0     0   0     0
4      5     2   1    8   0    1     1     3     6   0  1606
5    232     1   0  148   0  121    36     5    24   0    25
6     58    23   4   83   0  389  2203     9    82   0   216
7     13     5   0   38   0    0     5  1099     0   0     4
8      6     0   5  239   0   46     7     9  1048   0    10
9    475    24  40  192   0   57    27    81    60   0   181
10     0     0   0    1   0    0     0     0     0   0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-30 03:03:21.017221,epoch time: 1:09:40.887959,used: 2:24:59.856508,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90587544, 'precision': 0.6352082, 'recall': 0.6690476, 'specificity': 0.9893516, 'f1': 0.6470488, 'auroc': 0.9313001}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   404     3    3     3   0    0    26     8     0   0     36
1     0  1281    3     9   0    0     3    34     2   0      0
2    54     8   77     0   0    8     8    61     3   0     93
3     7     5    4  8039   0   21    20   279    59   0      4
4    13    14   35     1   0    3     9    26     4   0    434
5    15     0    0    18   0  392    53     4    19   0     20
6    13    10    1     1   0    1  1862     5     0   0     14
7     2    27   11   165   0    1     8  7035     6   0      9
8     5    34  196   246   0   35    17   306  2264   0    192
9   144     3   18     4   0  101    54    40     8   0    121
10   34    21   86    12   0    0    25   108     2   0  12504
---- Validation: 
scalar performance:
{'acc': 0.9071553, 'precision': 0.6343734, 'recall': 0.67269945, 'specificity': 0.9895245, 'f1': 0.64824635, 'auroc': 0.9302526}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   405     3    5     4   0    0    21     9     0   0     36
1     0  1285    2     7   0    0     3    35     0   0      0
2    58     9   83     0   0    6     8    51     2   0     95
3     6     3    2  8042   0   17    28   276    63   0      3
4    15    13   39     1   0    4    10    25     5   0    427
5    19     0    1    23   0  394    46     4    16   0     18
6    15     7    1     1   0    1  1868     2     0   0     13
7     2    32    7   168   0    0     6  7032     7   0     11
8     5    31  162   248   0   50    21   296  2297   0    186
9   146     1   32     3   0  109    49    33    13   0    107
10   42    25   91    10   0    0    24    93     3   0  12508
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6727069, 'precision': 0.4977041, 'recall': 0.5514042, 'specificity': 0.9667548, 'f1': 0.5044703, 'auroc': 0.8232005}
confusion matrix:
      0     1    2    3   4    5     6     7     8   9     10
0   1016    22    3   10   0    0   107    11     1   0     0
1      2  1367    9   28   0    0     1    87     0   0     5
2    190    41  213   10   0   19    36    96    59   0   351
3      0     0    0    0   0    0     0     0     0   0     0
4      5     3   19    0   0    0     3    15     4   0  1584
5    147     6    0   37   0  236   115     4    18   0    29
6      1    11    1    9   0   11  3004     2     7   0    21
7      7     1    0   60   0    0    15  1078     0   0     3
8      2     9   39  118   0   42    45    15  1063   0    37
9    406    82  164   40   0  104    87    85    45   0   124
10     0     1    4    0   0    0     1     2     0   0  1638
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-30 04:15:36.487145,epoch time: 1:12:15.469924,used: 3:37:15.326432,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92018944, 'precision': 0.635694, 'recall': 0.6641911, 'specificity': 0.99120563, 'f1': 0.63790274, 'auroc': 0.9397035}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   413     1   1    12   0    1    17     8     4   0     26
1     0  1286   1    14   0    0     0    27     3   0      1
2    82     5  26     3   0   10     7   107    18   0     54
3     1     2   0  8229   0    3     4   107    91   0      0
4    22     8  11     4   0   23    10    38    53   0    370
5    24     1   1    62   0  336    66     1    22   0      8
6    12     5   0    12   0    4  1861     0     9   0      5
7     1    32   3   289   0    0     2  6904    25   0      6
8     1    13   3   201   0   31     9   106  2916   0     15
9   212    12  17    20   0   81    59    44    17   0     31
10   56    26  11    20   0   78    22    73    86   0  12422
---- Validation: 
scalar performance:
{'acc': 0.9207436, 'precision': 0.64567924, 'recall': 0.6682364, 'specificity': 0.9912729, 'f1': 0.6437485, 'auroc': 0.93845683}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   415     1   1     7   0    4    16     8     6   0     25
1     0  1283   1    18   0    0     1    25     3   0      1
2    79     5  40     2   0   10     7    96    17   0     56
3     0     2   0  8235   0    3     2   109    89   0      0
4    21     9   6     2   0   25     7    46    49   0    374
5    24     3   3    71   0  333    56     2    25   0      4
6    17     2   0    10   0    4  1859     1     8   0      7
7     0    39   3   268   0    1     4  6919    27   0      4
8     1     8   5   203   0   29     7    99  2929   0     15
9   208    13  12    16   0   78    71    47    17   0     31
10   56    28  15    17   0   79    40    76    76   0  12409
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62534106, 'precision': 0.44853526, 'recall': 0.49993882, 'specificity': 0.9625585, 'f1': 0.449472, 'auroc': 0.8095684}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   913     6   2   98   0    0   117   29     5   0     0
1     1  1341   4   52   0    0     4   90     2   0     5
2   154    25  39   49   0   57    37  128   255   0   271
3     0     0   0    0   0    0     0    0     0   0     0
4     4     6   0    0   0   31     2    4    22   0  1564
5    92    12   0  193   0  130   109    8    32   0    16
6     0     4   0   34   0  206  2745    4    73   0     1
7     0     3   0  224   0    0     4  930     1   0     2
8     0     1   0  159   0    4     2    3  1201   0     0
9   306    82  53  217   0   42   109  143   113   0    72
10    0     1   0    0   0    3     1    1     1   0  1639
better model found
persisted
after epoch: 4,now: 2024-07-30 05:31:53.392298,epoch time: 1:16:16.905153,used: 4:53:32.231585,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9250856, 'precision': 0.6525399, 'recall': 0.7137451, 'specificity': 0.99189025, 'f1': 0.6771203, 'auroc': 0.9345506}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   427     3    0     7   0    5    22     3     5   0     11
1     0  1265    3     7   0    1     1    48     7   0      0
2    38     0  101     0   0   26    10    66    23   0     48
3     2     0    1  8120   0   13     0   154   146   0      0
4    14     4   33     1   0   22    19    54    50   0    342
5     3     0    1    12   0  466     5     0    27   0      7
6     8     2    0     6   0    5  1878     1     2   0      6
7     0     5   17   168   0    1     1  6981    83   0      7
8     6     0   15    86   0   23     3    65  3074   0     24
9    75     7   28     2   0  244    46    34    25   0     32
10   71    34   62    12   0   62    97   130    61   0  12264
---- Validation: 
scalar performance:
{'acc': 0.9238197, 'precision': 0.64906675, 'recall': 0.7139816, 'specificity': 0.9917561, 'f1': 0.675316, 'auroc': 0.9342624}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   426     1    1     7   0    7    17     5     1   0     18
1     0  1263    3     9   0    2     2    47     6   0      0
2    46     3  106     0   0   26     6    59    23   0     43
3     1     1    1  8091   0   18     0   172   156   0      0
4    14     4   43     0   0   25     9    45    46   0    353
5     2     0    1     8   0  464     6     1    35   0      4
6    13     0    0     3   0    7  1879     0     1   0      5
7     0     8   18   188   0    2     1  6963    81   0      4
8     3     0   20    84   0   27     5    61  3073   0     23
9    78     8   32     0   0  244    48    23    18   0     42
10   81    28   60    10   0   54   103   137    51   0  12272
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6932065, 'precision': 0.4976199, 'recall': 0.5873707, 'specificity': 0.9689797, 'f1': 0.5194182, 'auroc': 0.83267266}
confusion matrix:
      0     1    2   3   4    5     6     7     8   9     10
0   1038     6    0  24   0    5    66    28     3   0     0
1     14  1287   18  20   0    1    19   129     6   0     5
2     99    21  150   4   0  115    67   106   169   0   284
3      0     0    0   0   0    0     0     0     0   0     0
4      2     0    4   0   0   22     7     8    24   0  1566
5     30     8    0  29   0  450    27     2    36   0    10
6      0     0    0   1   0   23  3040     0     2   0     1
7     11     0    4  71   0    1     2  1070     3   0     2
8      4     0    6  48   0   48    18     3  1238   0     5
9    245    50  127  12   0  326   111    80   136   0    50
10     0     0    0   0   0    2     5     0     4   0  1635
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-30 06:45:16.547194,epoch time: 1:13:23.154896,used: 6:06:55.386481,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.928216, 'precision': 0.66401166, 'recall': 0.67147756, 'specificity': 0.99200237, 'f1': 0.6515809, 'auroc': 0.9459888}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   420     1   0    12   0    0     2    21     8   0     19
1     0  1273   3    10   0    0     0    38     6   0      2
2   125     1  34     1   0    1     7    70    15   0     58
3     1     1   0  8225   0    0     0   135    76   0      0
4    43     4   4     1   0    4     0    38    22   0    423
5     5     2   0    32   0  342    17     3   116   0      4
6    38     1   0    12   0    5  1826     8     9   0      9
7     1    12   3   206   0    0     1  6950    83   0      7
8     4     0  12   142   0    8     0    48  3044   0     38
9   193     6   6    13   0  114    46    45    33   0     36
10   78     4  10    15   0    7     7    62    30   0  12579
---- Validation: 
scalar performance:
{'acc': 0.92930317, 'precision': 0.664049, 'recall': 0.6736757, 'specificity': 0.99211293, 'f1': 0.65429324, 'auroc': 0.94554055}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   428     2   1    12   0    0     5    14     5   0     16
1     0  1279   3    12   0    0     0    32     5   0      1
2   113     1  37     5   0    6     6    78    11   0     55
3     1     1   0  8246   0    2     0   125    64   0      1
4    32     6  10     3   0   10     0    41    22   0    415
5    13     1   0    30   0  336    13     1   123   0      4
6    33     3   0    12   0    3  1839     4     6   0      8
7     2    13   3   192   0    0     1  6977    70   0      7
8     5     3  10   161   0    7     1    52  3020   0     37
9   181     7   7    18   0  110    50    53    29   0     38
10   75     2  10    12   0    3     6    75    33   0  12580
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6468901, 'precision': 0.4647315, 'recall': 0.5207707, 'specificity': 0.9648049, 'f1': 0.46867356, 'auroc': 0.8118674}
confusion matrix:
     0     1   2    3   4    5     6     7     8   9     10
0   951    14   3   95   0    1     4    79    20   0     3
1     7  1278  21   42   0    0     0   133     6   0    12
2   168    16  45   45   0   24     5   116   123   0   473
3     0     0   0    0   0    0     0     0     0   0     0
4     3     0   1    0   0    0     2     7     6   0  1614
5    44     9   0  163   0  167     9     7   168   0    25
6    11     4   0   49   0   74  2893     4    16   0    16
7     5     0   0   72   0    0     0  1078     5   0     4
8     0     1   2  147   0    7     1    11  1189   0    12
9   270    24  93  154   0   85    33   137   192   0   149
10    0     0   0    0   0    1     0     0     0   0  1645
better model found
persisted
after epoch: 6,now: 2024-07-30 07:59:06.944564,epoch time: 1:13:50.397370,used: 7:20:45.783851,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9219553, 'precision': 0.6843628, 'recall': 0.66008633, 'specificity': 0.99118924, 'f1': 0.65462285, 'auroc': 0.94869167}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   436     1   0     2   0    0     2    17     4   0     21
1     1  1280   0     3   0    0     0    43     5   0      0
2    21     2  72     0   0    0     1   174     6   0     36
3     4     2   0  7905   0    1     6   466    54   0      1
4    25     7  30     1   0    1     0    76    18   0    381
5    48     0   2    47   0  200    12    32   148   0     32
6    22     2   0     0   0    0  1864     4     3   0     12
7     2     5   3    55   0    0     2  7173    18   0      6
8     2     3   5   143   0    1     2   154  2961   0     25
9   213     0  27     5   0   24     4   158    13   0     49
10   51     9  12     9   0    1     8   111    21   0  12568
---- Validation: 
scalar performance:
{'acc': 0.92256254, 'precision': 0.6814954, 'recall': 0.65676045, 'specificity': 0.9912639, 'f1': 0.65039736, 'auroc': 0.9476161}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   439     1   2     0   0    0     2    17     0   0     22
1     0  1281   1     5   0    0     0    39     5   0      1
2    21     7  66     0   0    0     1   173     7   0     37
3     5     2   0  7928   0    0     5   454    43   0      3
4    20     4  31     2   0    1     0    87    18   0    376
5    53     0   4    37   0  187    18    39   157   0     26
6    24     4   1     0   0    2  1853     3     5   0     16
7     0    11   4    54   0    1     1  7169    21   0      4
8     1     2   6   143   0    0     1   137  2972   0     34
9   213     2  19     6   0   23     5   170    14   0     41
10   56     4  13    11   0    0     4   100    13   0  12595
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64066327, 'precision': 0.48313344, 'recall': 0.5220949, 'specificity': 0.9638199, 'f1': 0.45587772, 'auroc': 0.8134505}
confusion matrix:
      0     1    2   3   4   5     6     7     8   9     10
0   1126    12    2   1   0   1     9    15     1   0     3
1      4  1214    5  12   0   0     0   250     5   0     9
2    120    24  113   2   0   1     1   299   121   0   334
3      0     0    0   0   0   0     0     0     0   0     0
4      3     1    3   0   0   0     1     8     8   0  1609
5    162     0    1  39   0  86     7    76    50   0   171
6     75    53    0   3   0  32  2619    31    37   0   217
7     11     0    0  40   0   0     5  1103     2   0     3
8      3     1    2  81   0   0     2    23  1252   0     6
9    304    35  132  15   0   8     7   425   102   0   109
10     0     0    0   0   0   0     1     1     0   0  1644
early stop counter: 1
val acc:0.9225625395774841, best validation acc: 0.9293031692504883, corresponding to test acc:                         0.6468901038169861 / 0.6932064890861511
after epoch: 7,now: 2024-07-30 09:11:54.692147,epoch time: 1:12:47.747583,used: 8:33:33.531434,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.59872645, 'precision': 0.6009418, 'recall': 0.61241627, 'specificity': 0.9623246, 'f1': 0.5620154, 'auroc': 0.9570814}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   397     0     52    10   0    0     0    12     6   0    6
1     0  1286      4    10   0    1     0    30     1   0    0
2     4     1    224     1   0    1     1    66     9   0    5
3     0     0      1  8249   0    0     0   128    59   0    1
4     1     0    477     1   0    1     1    11    34   0   13
5     8     2      9    55   0  197     9    21   158   0   62
6    10     1     17    10   0    0  1849     8    10   0    3
7     0     9      7   127   0    0     1  7097    24   0    0
8     0     0     25   112   0    0     0    99  3056   0    2
9    56     0    135    10   0   17     4   134    15   0  122
10    4     0  12676    11   0    0     4    21    52   0   23
---- Validation: 
scalar performance:
{'acc': 0.5985288, 'precision': 0.6008092, 'recall': 0.61165357, 'specificity': 0.9622842, 'f1': 0.5632452, 'auroc': 0.95599955}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   390     0     55     8   0    0     1    16     7   0    6
1     0  1287      4     6   0    0     0    29     6   0    0
2     5     0    217     1   0    1     1    70    11   0    6
3     0     0      0  8243   0    0     0   141    55   0    1
4     1     0    477     1   0    0     0    12    34   0   14
5     9     0      9    53   0  213    10    18   146   0   63
6    17     0     17    14   0    0  1844     2     9   0    5
7     0    12      7   125   0    0     1  7098    22   0    0
8     1     2     22   112   0    0     0   100  3059   0    0
9    56     0    113     9   0   16     2   144    21   0  132
10    3     0  12673     7   0    0     4    20    64   0   25
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47988525, 'precision': 0.3868413, 'recall': 0.41145808, 'specificity': 0.9489828, 'f1': 0.37484062, 'auroc': 0.78321016}
confusion matrix:
     0     1     2    3   4    5     6    7     8   9    10
0   907     7     9  135   0    0    23   60    13   0   16
1     1  1236    80   39   0    0     0  125    18   0    0
2     7     0   479   15   0    0     0   78   291   0  145
3     0     0     0    0   0    0     0    0     0   0    0
4     1     0  1606    0   0    0     0    0    22   0    4
5    14     0     1  234   0   13     0   46    58   0  226
6     0     4   190   71   0  146  1930   21   607   0   98
7     0     0     3  159   0    0     0  996     6   0    0
8     0     0     2   68   0    0     0    1  1298   0    1
9    31     0   207  145   0    1     0  239   276   0  238
10    0     0  1646    0   0    0     0    0     0   0    0
early stop counter: 2
val acc:0.5985288023948669, best validation acc: 0.9293031692504883, corresponding to test acc:                         0.6468901038169861 / 0.6932064890861511
after epoch: 8,now: 2024-07-30 10:36:32.345938,epoch time: 1:24:37.653791,used: 9:58:11.185225,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.588506, 'precision': 0.57183635, 'recall': 0.58246845, 'specificity': 0.96121347, 'f1': 0.52205783, 'auroc': 0.9534303}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   428     0     31     2   0   0     5     5     5   0    7
1     0  1285      2    10   0   0     0    25     9   0    1
2    28     1    190     2   0   0     2    41    22   0   26
3     0     0      1  8337   0   0     0    35    62   0    0
4     6     0    457     2   0   1     0     3    32   0   38
5     3     0      3    27   0  57     2    12   382   0   35
6     9     2     10     2   0   0  1875     2     3   0    3
7     3    13     19   405   0   0     2  6656   165   0    1
8     1     0     40   116   0   0     0    20  3115   0    3
9   107     0     30    21   0  20     1    81    72   0  161
10   17     1  12653     9   0   0     6    12    45   0   53
---- Validation: 
scalar performance:
{'acc': 0.58823055, 'precision': 0.57408094, 'recall': 0.5821495, 'specificity': 0.9611743, 'f1': 0.5217174, 'auroc': 0.9545362}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   421     0     33     7   0   0     8     3     5   0    6
1     0  1287      2    13   0   0     1    23     6   0    0
2    34     0    193     0   0   0     1    38    27   0   19
3     1     0      1  8342   0   0     0    31    65   0    0
4     5     0    451     0   0   1     1     8    37   0   36
5     1     0      1    30   0  58     1     8   385   0   37
6     7     0      6     2   0   0  1878     1    12   0    2
7     1    14     15   437   0   0     1  6635   161   0    1
8     2     0     38   123   0   0     0    16  3115   0    2
9    99     0     31     6   0  19     4    82    85   0  167
10   17     4  12645     9   0   1     4    14    40   0   62
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51829565, 'precision': 0.3956682, 'recall': 0.4028024, 'specificity': 0.9526098, 'f1': 0.38194585, 'auroc': 0.8179801}
confusion matrix:
     0     1     2    3   4   5     6    7     8   9    10
0   912     6     1   29   0   2   191   12    11   0    6
1    14  1256    26   59   0   0     4  121    17   0    2
2    58    11   268   46   0   4    10   59   294   0  265
3     0     0     0    0   0   0     0    0     0   0    0
4     3     1  1546    0   0   1     3    1    24   0   54
5     9     0     0  167   0  20     4   38   179   0  175
6     0     0     2   46   0  35  2955    0    25   0    4
7    22     1     4  353   0   0    20  738    25   0    1
8     0     0     1  114   0   1     2    0  1252   0    0
9   115     4    73  256   0   7     6  142   235   0  299
10    0     0  1637    0   0   0     1    0     1   0    7
early stop counter: 3
val acc:0.588230550289154, best validation acc: 0.9293031692504883, corresponding to test acc:                         0.6468901038169861 / 0.6932064890861511
after epoch: 9,now: 2024-07-30 11:59:16.580614,epoch time: 1:22:44.234676,used: 11:20:55.419901,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.59348243, 'precision': 0.5908567, 'recall': 0.58180887, 'specificity': 0.96195704, 'f1': 0.51515484, 'auroc': 0.9544971}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   457     0     14     4   0    0     3     2     0   0   3
1     0  1294      0    12   0    0     0    24     2   0   0
2    83     2    147     0   0    0     2    72     3   0   3
3     2     1      0  8312   0    0     0   103    22   0   0
4    35     3    427     1   0    1     2    30    24   0  16
5    46     0      2    27   0  103    36    21   280   0   6
6    28     1      6     9   0    0  1858     4     1   0   1
7     1    11      4   172   0    0     1  7070     5   0   0
8     6     4     28   235   0    0     2   125  2893   0   3
9   334     1     11     7   0   20    23    78    11   0   8
10   93    15  12514    18   0    0     9    54    37   0  48
---- Validation: 
scalar performance:
{'acc': 0.59259063, 'precision': 0.5880591, 'recall': 0.5773797, 'specificity': 0.9618515, 'f1': 0.5157734, 'auroc': 0.9548835}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   453     0     12     5   0    0     4     5     0   0   4
1     0  1297      0     7   0    0     1    24     3   0   0
2    81     1    133     0   0    0     1    89     3   0   4
3     2     0      0  8304   0    0     0   106    28   0   0
4    26     4    436     1   0    1     3    35    19   0  14
5    52     0      1    21   0  105    31    25   278   0   8
6    26     0      6     7   0    0  1864     2     1   0   2
7     0    14      5   169   0    0     1  7070     6   0   0
8     5     2     31   237   0    1     0   139  2881   0   0
9   332     0     10     7   0   17    13    86    13   0  15
10   90    10  12529    15   0    1    19    51    34   0  47
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5453719, 'precision': 0.408032, 'recall': 0.43145677, 'specificity': 0.9556912, 'f1': 0.38757843, 'auroc': 0.8230947}
confusion matrix:
      0     1     2    3   4   5     6     7     8   9   10
0   1023     4     0   80   0   0    43    14     6   0   0
1      2  1296     7   51   0   0     0   139     4   0   0
2    191    21   286   77   0   0    13   152   217   0  58
3      0     0     0    0   0   0     0     0     0   0   0
4      6     3  1578    1   0   1     8     3    24   0   9
5     75     1     0  182   0  16    14    71   206   0  27
6      3     6     2   51   0   4  2995     1     5   0   0
7      1     0     2  142   0   0     1  1017     0   0   1
8      0     0     2  202   0   1     2     2  1161   0   0
9    338     7    43  356   0   7    12   241   118   0  15
10     0     0  1638    0   0   0     4     1     2   0   1
early stop counter: 4
val acc:0.5925906300544739, best validation acc: 0.9293031692504883, corresponding to test acc:                         0.6468901038169861 / 0.6932064890861511
after epoch: 10,now: 2024-07-30 13:41:27.050383,epoch time: 1:42:10.469769,used: 13:03:05.889670,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 13:03:05.889670 at 2024-07-30 13:41:27.050383
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6468901, 'precision': 0.4647315, 'recall': 0.5207707, 'specificity': 0.9648049, 'f1': 0.46867356, 'auroc': 0.8118674}
confusion matrix:
     0     1   2    3   4    5     6     7     8   9     10
0   951    14   3   95   0    1     4    79    20   0     3
1     7  1278  21   42   0    0     0   133     6   0    12
2   168    16  45   45   0   24     5   116   123   0   473
3     0     0   0    0   0    0     0     0     0   0     0
4     3     0   1    0   0    0     2     7     6   0  1614
5    44     9   0  163   0  167     9     7   168   0    25
6    11     4   0   49   0   74  2893     4    16   0    16
7     5     0   0   72   0    0     0  1078     5   0     4
8     0     1   2  147   0    7     1    11  1189   0    12
9   270    24  93  154   0   85    33   137   192   0   149
10    0     0   0    0   0    1     0     0     0   0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6932065, 'precision': 0.4976199, 'recall': 0.5873707, 'specificity': 0.9689797, 'f1': 0.5194182, 'auroc': 0.83267266}
confusion matrix:
      0     1    2   3   4    5     6     7     8   9     10
0   1038     6    0  24   0    5    66    28     3   0     0
1     14  1287   18  20   0    1    19   129     6   0     5
2     99    21  150   4   0  115    67   106   169   0   284
3      0     0    0   0   0    0     0     0     0   0     0
4      2     0    4   0   0   22     7     8    24   0  1566
5     30     8    0  29   0  450    27     2    36   0    10
6      0     0    0   1   0   23  3040     0     2   0     1
7     11     0    4  71   0    1     2  1070     3   0     2
8      4     0    6  48   0   48    18     3  1238   0     5
9    245    50  127  12   0  326   111    80   136   0    50
10     0     0    0   0   0    2     5     0     4   0  1635
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_30_00_38_20_seed_1_23229621_instance_wise_predictions.txt
accuracy from prediction file 0.6468900860561114
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/18.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/18.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |   1647 MiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      6 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16500 MiB |  16520 MiB |  31136 MiB |  14636 MiB |
|       from large pool |  16472 MiB |  16492 MiB |  31104 MiB |  14632 MiB |
|       from small pool |     28 MiB |     28 MiB |     32 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 233529 KiB | 631707 KiB | 126370 GiB | 126369 GiB |
|       from large pool | 216320 KiB | 628608 KiB | 120421 GiB | 120421 GiB |
|       from small pool |  17209 KiB |  23329 KiB |   5948 GiB |   5948 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2660    |    4664    |   60963 K  |   60960 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2413    |    4364    |   34168 K  |   34165 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2660    |    4664    |   60963 K  |   60960 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2413    |    4364    |   34168 K  |   34165 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     466    |     467    |     828    |     362    |
|       from large pool |     452    |     453    |     812    |     360    |
|       from small pool |      14    |      14    |      16    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     123    |    1250    |   33377 K  |   33376 K  |
|       from large pool |      95    |     303    |   17475 K  |   17475 K  |
|       from small pool |      28    |    1154    |   15901 K  |   15901 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |  16640 KiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1884 MiB |  16520 MiB |  31136 MiB |  29252 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  31104 MiB |  29244 MiB |
|       from small pool |     24 MiB |     28 MiB |     32 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 631707 KiB | 126371 GiB | 126371 GiB |
|       from large pool |  24320 KiB | 628608 KiB | 120422 GiB | 120422 GiB |
|       from small pool |      0 KiB |  23329 KiB |   5948 GiB |   5948 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4664    |   60963 K  |   60963 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    4364    |   34168 K  |   34168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4664    |   60963 K  |   60963 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    4364    |   34168 K  |   34168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     105    |     467    |     828    |     723    |
|       from large pool |      93    |     453    |     812    |     719    |
|       from small pool |      12    |      14    |      16    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1250    |   33378 K  |   33378 K  |
|       from large pool |       3    |     303    |   17475 K  |   17475 K  |
|       from small pool |       0    |    1154    |   15902 K  |   15902 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 30 14:06:04 2024]
Finished job 0.
1 of 1 steps (100%) done
