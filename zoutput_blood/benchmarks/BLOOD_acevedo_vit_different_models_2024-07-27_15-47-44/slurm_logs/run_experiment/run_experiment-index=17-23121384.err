Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 19:46:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/17.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=17
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384

 Experiment start at: 2024-07-28 19:56:17.548869
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5642926, 'precision': 0.37372473, 'recall': 0.41852367, 'specificity': 0.95744836, 'f1': 0.33346057, 'auroc': 0.9378768}
confusion matrix:
    0   1   2     3   4     5      6     7     8    9     10
0    2   0   0     2   1   137    267    32    10   23     8
1    7   0   0    14   0  1031    108   154     6    8     4
2    4   0   0     0   0    86     74    21    12   96    19
3    0   0   0  7014   0    22      4   975   375   45     2
4    5   0   0     1   0    33    371    15    38   20    55
5    0   0   0    34   0   148      3     0    10  326     0
6    1   0   0     1   1    31   1828    26    20    0     0
7   14   0   0    53   0     8     17  7089    68   10     6
8   18   0   0    46   0     4     70   266  2791   47    52
9    0   0   0     6   0   187      7     6     9  271     6
10  43   0   0     8   1    32  10665    36    57    5  1948
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.565093, 'precision': 0.3949235, 'recall': 0.42113468, 'specificity': 0.9574828, 'f1': 0.3366714, 'auroc': 0.93787575}
confusion matrix:
    0   1   2     3   4     5      6     7     8    9     10
0    4   0   0     3   1   133    261    38     8   17    18
1    8   0   0    17   0  1028    104   154     9    7     5
2    2   0   0     1   0    87     82    16    13   93    18
3    0   0   0  6999   0    18      2   995   383   40     3
4    8   0   0     0   1    44    367    16    32   10    61
5    0   0   0    38   0   147      2     0     8  326     0
6    2   0   0     1   2    21   1825    31    24    1     1
7   14   0   0    62   0    11     14  7079    69    9     7
8    8   0   0    48   1     2     97   266  2779   47    48
9    1   0   0     4   0   179      4     6     7  286     6
10  45   0   0     8   0    31  10611    35    53    7  2006
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43321905, 'precision': 0.2382313, 'recall': 0.33799332, 'specificity': 0.9388186, 'f1': 0.26258707, 'auroc': 0.80500954}
confusion matrix:
    0   1   2   3   4    5     6     7     8    9   10
0    0   0   0   1   3  433   550    91     1   91   0
1    9   0   0  20   0  769   304   344     9   37   7
2    5   0   0   0   1  172   451    41    90  208  47
3    0   0   0   0   0    0     0     0     0    0   0
4    0   0   0   0   0    6  1591     0     6    0  30
5    0   0   0   1   0  174    10     0     3  404   0
6    0   0   0   0   0    7  3043     3    11    3   0
7    0   0   0   1   0    4     3  1145     1   10   0
8    1   0   0   6   0    4   136    23  1055  144   1
9    3   0   0   1   0  247    49    24    44  762   7
10   0   0   0   0   0    0  1633     0     0    0  13
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 20:40:07.763034,epoch time: 0:43:50.214165,used: 0:43:50.214165,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.91058433, 'precision': 0.6714622, 'recall': 0.6188611, 'specificity': 0.9899149, 'f1': 0.61060494, 'auroc': 0.9621533}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   34     0   0    25   2    2    77   122    31   52    138
1    0  1175   0    15   0    9     1   122     3    2      5
2    0     0   0    16   2    1     4    57    33  106     93
3    0     0   0  7823   0   13     0   406   196    2      0
4    2     1   0     7   0    1    25    24    45   23    411
5    0     0   0    47   0  161     0     1    10  301      1
6    2     1   0     8   1    0  1823    23    17    5     27
7    3     3   0   116   0    0     2  7105    25    1      9
8    2     0   0    77   0    1     0   226  2923    3     62
9    0     0   0    16   0   19     1    19    30  401      7
10  12     0   0     9   0    1    62    55    54    9  12589
---- Validation: 
scalar performance:
{'acc': 0.9109536, 'precision': 0.6888322, 'recall': 0.6213516, 'specificity': 0.9899602, 'f1': 0.6127192, 'auroc': 0.962096}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   35     0   0    26   4    3    76   125    26   47    141
1    0  1175   0    17   0    8     2   118     5    2      5
2    0     0   0    18   1    3    10    54    33   99     94
3    0     0   0  7818   0   13     0   410   195    4      0
4    1     0   0     5   1    1    28    26    46   19    412
5    0     0   0    53   0  160     0     0    10  297      1
6    2     0   0    10   1    1  1833    23    15    2     21
7    1     4   0   104   0    1     1  7102    41    2      9
8    2     0   0    80   0    2     1   232  2922    2     55
9    0     0   0    14   0   16     0    21    27  412      3
10  12     0   0    10   0    0    72    48    48    8  12598
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59833485, 'precision': 0.45715842, 'recall': 0.46642822, 'specificity': 0.95927083, 'f1': 0.39244038, 'auroc': 0.83055496}
confusion matrix:
    0     1   2   3   4   5     6     7     8    9     10
0   27     1   0  16   0   5   147   662   112  143    57
1    1  1148   0  28   0  23     9   272     2    7     9
2    6     3   0   6   0   0    50   362   288  120   180
3    0     0   0   0   0   0     0     0     0    0     0
4    2     1   0   0   0   0   176     8    18    1  1427
5    0     0   0  34   0  58     1    10    46  443     0
6    0     0   0  30   1   0  2797    71   165    1     2
7    0     0   0   1   0   0     0  1160     0    1     2
8    0     0   0  15   0   0     1    72  1272    6     4
9    4     6   0  14   0   6     5   277   306  504    15
10   0     0   0   0   0   0    58     1     1    0  1586
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 21:22:45.413292,epoch time: 0:42:37.650258,used: 1:26:27.864423,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9148117, 'precision': 0.758217, 'recall': 0.6702963, 'specificity': 0.99029326, 'f1': 0.6768282, 'auroc': 0.9799722}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   203     0   0     6   0    1     9   130    24    8    102
1     1  1245   0     9   0    5     2    62     3    0      5
2     1     6   0    49   5    5    20    55     4  118     49
3     0     0   0  7810   0   18     0   527    80    1      2
4     2     0   0    17   7    1   137    25     4   16    330
5     0     0   0    41   0  290     0     1     6  181      1
6     6     3   0     6   0    0  1851    15     4    1     22
7     1    10   0    50   0    0     2  7174     4    3     20
8     1     0   0   119   0    4     3   493  2518    6    149
9     2     1   0    10   0   54     0    18     3  398      7
10   16     1   0     8   0    2    38    23     9    1  12696
---- Validation: 
scalar performance:
{'acc': 0.91384244, 'precision': 0.7144779, 'recall': 0.6689639, 'specificity': 0.9901898, 'f1': 0.67459065, 'auroc': 0.97944194}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   218     0   0     5   0    0    11   123    21    8     97
1     0  1233   0    12   0    5     0    76     2    0      4
2     2     2   0    42   6    5    21    52     5  126     51
3     0     1   0  7828   0   18     2   506    84    0      1
4     4     1   0    15   1    0   128    22     7   19    342
5     0     0   0    35   0  294     0     1     2  188      1
6    10     4   0     4   0    0  1845    20     6    2     17
7     0    15   0    70   0    0     2  7153     4    2     19
8     2     0   0    90   0    1     9   514  2500   10    170
9     2     2   0     6   0   60     0    27     2  387      7
10   11     2   0     6   1    2    37    22     8    2  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6550759, 'precision': 0.5242282, 'recall': 0.53759533, 'specificity': 0.9647477, 'f1': 0.49818638, 'auroc': 0.85471797}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   563     0   0   5   0    5    36   380   153   19     9
1     1  1254   0  21   0   15     8   188     1    2     9
2    35     4   0  42  10    6   144   336   133   71   234
3     0     0   0   0   0    0     0     0     0    0     0
4     3     0   0   0   1    0   378     7     6    0  1238
5     4     0   0  57   0  263     4     9    37  217     1
6     1     2   0  35   1    1  2947    35    34    1    10
7     0     0   0   2   0    0     0  1158     0    1     3
8     1     0   0  53   0    0     5    96  1208    3     4
9    19    17   0  44   1   46    11   357   187  431    24
10    0     0   0   0   0    0   108     0     0    0  1538
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-28 22:04:42.170458,epoch time: 0:41:56.757166,used: 2:08:24.621589,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9290186, 'precision': 0.85204816, 'recall': 0.7018562, 'specificity': 0.99242127, 'f1': 0.6875106, 'auroc': 0.9839952}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   309     0   0     3   0    2    47    31    28    7     54
1     1  1273   0     5   0    2     3    37     6    0      5
2     2     4   1    73   9    1    19    32     5  155     11
3     1     1   0  7927   0   28    10   301   162    6      0
4     3     1   0    56  27    3   175    11    28   14    221
5     0     1   0    18   0  163     3     0     3  331      1
6     4     0   0     0   0    1  1886     5     3    1      8
7     1    20   0    77   0    0     3  7026   124    7      7
8     0     0   0    69   0    3     8    76  3108    9     23
9     1     0   0     9   0    9     3     4     3  462      2
10   29     0   0    15   2    1   127    15    61    3  12541
---- Validation: 
scalar performance:
{'acc': 0.92855424, 'precision': 0.75069517, 'recall': 0.70041734, 'specificity': 0.9923483, 'f1': 0.6861583, 'auroc': 0.9848409}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   319     0   0     2   0    0    51    27    28   10     46
1     0  1273   0    11   0    1     3    34     5    0      5
2     1     8   0    64  15    1    20    36     7  144     16
3     1     4   0  7927   0   22     2   310   167    6      1
4     1     4   0    56  22    2   166    13    26   15    234
5     0     1   0    15   0  158     0     0     5  341      1
6     2     0   0     1   0    0  1884     7     3    1     10
7     0    16   0    84   1    0     4  7026   116    7     11
8     0     0   0    65   0    5     8    69  3111    6     32
9     1     1   0    11   0   12     3     2     4  457      2
10   22     1   0    10   2    1   137    18    63    5  12537
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6559155, 'precision': 0.5225067, 'recall': 0.52661514, 'specificity': 0.9637391, 'f1': 0.48985812, 'auroc': 0.85312843}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   509     0   0   1   4    1   403   109   105   24    14
1     0  1273   0  20   1    3    22   151    16    3    10
2     4     7   0  43  22    8   455   116   233   48    79
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   0   0    0   481     1    16    0  1133
5     3     9   0  52   0  182    32     2    25  285     2
6     0     1   0  13   0    0  3033     3    17    0     0
7     0     0   0   6   0    0     5  1141    10    1     1
8     0     0   0  22   0    0    14     2  1330    2     0
9     8    31   0  49   4   33   100   196   313  377    26
10    0     0   0   0   0    0   115     0     1    0  1530
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 22:46:42.220633,epoch time: 0:42:00.050175,used: 2:50:24.671764,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9401488, 'precision': 0.8304869, 'recall': 0.7236887, 'specificity': 0.99334, 'f1': 0.73502475, 'auroc': 0.98999876}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   346     1   0     1   0    0     6    27     0    1    100
1     0  1284   0    10   0    0     3    25     7    0      3
2     4     6   2   149  54    2    19    13    14   39     10
3     1     0   0  8174   0   22     5   152    77    3      3
4     2     0   0    15  68    1   224     5     8    5    211
5     0     0   0    23   0  357     2     0     3  135      1
6     4     0   0     3   0    1  1865     6     2    0     27
7     0    16   0   135   0    0     3  7058    43    0      9
8     5     1   1   128   5    2    17   110  2972    6     49
9     3     2   0    61   2   82     4     8     5  320      6
10    5     0   0     8   4    0    58    14     9    1  12693
---- Validation: 
scalar performance:
{'acc': 0.9406446, 'precision': 0.855654, 'recall': 0.72257775, 'specificity': 0.9934172, 'f1': 0.7327043, 'auroc': 0.9897926}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   345     0   0     2   0    1    15    23     2    2     93
1     1  1275   0    13   0    0     3    31     6    0      3
2     0     6   3   139  57    3    22    13    16   42     11
3     2     4   0  8182   0   23    10   148    69    1      1
4     2     1   0    11  56    3   239     8    10    2    207
5     1     1   0    14   0  358     0     0     5  141      1
6     7     0   0     1   1    0  1871     3     0    0     25
7     0    16   0   125   0    1     5  7060    49    0      9
8     2     0   0    95   4    0    23   115  2987    3     67
9     2     1   0    64   1   76     7    10     6  323      3
10    6     0   0     9   4    1    44    17     9    0  12706
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6872595, 'precision': 0.5916307, 'recall': 0.57408774, 'specificity': 0.96773046, 'f1': 0.5373999, 'auroc': 0.8580806}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   979     1   0    3    1    8    79    39    20   16    24
1     1  1194   0   26    2    2     6   247    10    2     9
2    15    17   3   56  135    5   369   122   189   35    69
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    1    2    0   332     4     9    0  1284
5     6     4   0   50    0  344    23     0     7  158     0
6     2     0   0    1    0    0  3042     8     6    0     8
7     0     1   0   12    1    0     1  1145     0    1     3
8     0     0   0  129    0    4    40    15  1178    3     1
9    39    46   2  125   33   90    59   137   279  312    15
10    0     0   0    0    0    0    22     0     0    0  1624
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-28 23:28:35.084804,epoch time: 0:41:52.864171,used: 3:32:17.535935,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9393996, 'precision': 0.7861221, 'recall': 0.71745765, 'specificity': 0.99317193, 'f1': 0.7348968, 'auroc': 0.98648024}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   317     0   0     8   0    0     7    65     6    1     79
1     0  1269   0    15   0    0     2    38     5    0      3
2     1     1   0   147  44    1    18    24     7   58     11
3     0     1   0  8280   0    3     1   103    46    0      1
4     1     0   0    28  74    6   178     2    17    9    224
5     0     0   0    71   0  401     0     0     5   43      1
6     9     0   0    15   0    1  1850     8     5    2     18
7     0    10   0   190   1    0     1  7007    42    0     12
8     1     0   0   214   1    1     6   100  2941    1     31
9     0     2   0    53   0  134     0     6    10  284      4
10    7     1   0    12   2    2    27    16    39    0  12688
---- Validation: 
scalar performance:
{'acc': 0.9387455, 'precision': 0.87101793, 'recall': 0.7192224, 'specificity': 0.9931451, 'f1': 0.734861, 'auroc': 0.9873241}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   312     1   0     5   0    0     6    72     1    4     82
1     0  1271   0    16   0    0     2    36     5    0      2
2     1     3   1   141  52    2    15    15     4   70      8
3     0     0   0  8269   0    5     1   112    53    0      0
4     3     1   0    31  76    3   187     5    17   10    206
5     0     0   0    71   0  400     0     0     6   43      1
6     6     0   0    16   0    1  1856     3     6    1     19
7     0    16   0   190   0    0     2  7010    36    0     11
8     1     0   0   224   0    2     6    82  2948    1     32
9     1     2   0    39   1  131     3    12     8  295      1
10    8     1   0    13   3    2    44    14    54    0  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6719373, 'precision': 0.55715156, 'recall': 0.5639777, 'specificity': 0.9669697, 'f1': 0.5368694, 'auroc': 0.8573284}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   763    10   0   27    1   27    76   151    49   47    19
1     1  1303   0   62    0    0     7   110     6    0    10
2     9    19   0  183  155   34   308    35   144   62    66
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    2   13    0   284     0    13    0  1320
5     1     0   0  123    0  433     5     1     3   26     0
6     0     0   0   55    0    0  3001     2     8    0     1
7     1     0   0   67    0    1     1  1089     2    0     3
8     0     0   0  221    0    2     6     4  1136    0     1
9     3    26   0  457   23  238    23    50    58  243    16
10    0     0   0    0    0    0    23     0     0    0  1623
early stop counter: 1
val acc:0.9387454986572266, best validation acc: 0.9406446218490601, corresponding to test acc:                         0.6872594952583313 / 0.6872594952583313
after epoch: 6,now: 2024-07-29 00:09:50.904880,epoch time: 0:41:15.820076,used: 4:13:33.356011,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9425835, 'precision': 0.89656436, 'recall': 0.73609895, 'specificity': 0.99358636, 'f1': 0.7570172, 'auroc': 0.99061465}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   311     0   0     5    0    0     3    76    25    0     63
1     0  1288   0     9    0    0     1    26     4    0      4
2     1     1   2   199   32    0     4    19     6   37     11
3     0     5   0  8034    0   19     1   228   152    0      0
4     2     0   0    48  136    0   117     3    15    1    217
5     0     0   0    32    0  354     0     0     6  126      2
6     7     0   0     5    1    0  1859     5     8    1     21
7     0    24   0    83    0    0     2  7070    77    1      7
8     1     1   0    56    3    0     0    71  3140    0     24
9     1     0   0    67    1   50     0    10    14  346      4
10    7     0   0    14    8    1    15    17    39    0  12690
---- Validation: 
scalar performance:
{'acc': 0.9421961, 'precision': 0.8470671, 'recall': 0.736521, 'specificity': 0.99356, 'f1': 0.7557544, 'auroc': 0.99053645}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   310     0   0     2    0    0     3    74    23    2     69
1     0  1292   0    10    1    0     0    21     4    0      4
2     1     1   1   192   36    1     4    24     6   37      9
3     0     3   0  8037    0   15     0   232   153    0      0
4     1     0   0    39  142    0   118     3    18    3    215
5     0     0   0    21    0  353     0     1     5  140      1
6     7     0   0     5    1    2  1854     7     7    1     24
7     0    20   0    79    2    0     1  7076    80    0      7
8     1     1   0    49    1    0     5    78  3127    1     33
9     1     1   1    67    0   50     0    12    12  349      0
10   14     0   0    12    8    1    20    16    41    1  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65997344, 'precision': 0.5471345, 'recall': 0.54211146, 'specificity': 0.9657558, 'f1': 0.50218046, 'auroc': 0.85842645}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   428     2   0   11    0    4    37   376   247   51    14
1     0  1310   0   20    0    2     1   146     8    0    12
2     0     5   0  173  130    2    97   104   315   53   136
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    4   14    0    77     3    25    0  1508
5     0     1   0   81    0  284     1     6    43  175     1
6     0     0   0   19    1    0  2891     5   110    0    41
7     0     0   0    3    0    0     0  1156     2    1     2
8     0     0   0   21    0    0     1     5  1341    2     0
9     0    14   5  138    2   50     1   159   382  368    18
10    0     0   0    0    0    0     5     0     0    0  1641
better model found
persisted
after epoch: 7,now: 2024-07-29 00:54:27.268968,epoch time: 0:44:36.364088,used: 4:58:09.720099,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94378746, 'precision': 0.8416273, 'recall': 0.73597896, 'specificity': 0.99389, 'f1': 0.7487714, 'auroc': 0.98668146}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   357     0   0     2   0    2    12    24    13    1     72
1     0  1215   0     4   0    0     2    99     8    1      2
2     0     1   3   108  54    1    15    62    19   43      6
3     0     0   0  8086   0    8     2   220   122    0      0
4     2     0   1     9  74    0   229     7    53    4    160
5     0     0   0    35   0  400     0     1     7   76      2
6     3     0   0     0   1    1  1880     4     8    0     11
7     0     4   0    59   1    0     1  7138    58    0      4
8     0     1   0    28   1    1     0    62  3189    0     13
9     0     1   1    26   0   93     2    25    23  320      2
10    6     0   0    12   1    0    48    24    87    0  12613
---- Validation: 
scalar performance:
{'acc': 0.9420623, 'precision': 0.8318894, 'recall': 0.73694956, 'specificity': 0.99368715, 'f1': 0.7493571, 'auroc': 0.98681194}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   353     0   0     3   0    0    15    27    18    1     66
1     0  1225   0     4   0    0     0    93     7    0      3
2     0     1   1   102  57    3    14    63    25   40      6
3     0     0   0  8054   0    5     0   249   132    0      0
4     2     2   1     6  72    1   219    15    45    1    175
5     0     0   0    26   0  419     1     1     7   66      1
6     4     0   0     1   1    1  1879     4     6    0     12
7     0     4   0    64   1    0     1  7128    63    0      4
8     1     1   0    42   1    0     2    74  3167    0      8
9     0     1   0    32   1   85     3    25    22  320      4
10    3     0   0     8   7    1    45    25   105    1  12601
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6427622, 'precision': 0.55061257, 'recall': 0.5220213, 'specificity': 0.96336794, 'f1': 0.48096097, 'auroc': 0.8378785}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   517     0   0    4   0   20   189   144    58   61   177
1     0  1093   0   20   0    0     5   362    11    0     8
2     0     7   1   41  66   10   245   106   452   26    61
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1   2    0   345     3    27    0  1255
5     1     0   0  168   0  290    18     1    32   80     2
6     0     0   0   14   0    0  3021     3    29    0     0
7     0     0   0    5   0    0     2  1151     4    0     2
8     0     0   0   67   0    0     4     2  1296    1     0
9     2    20   2  140   9   68    24   137   510  206    19
10    0     0   0    0   0    0    34     1     1    0  1610
early stop counter: 1
val acc:0.9420623183250427, best validation acc: 0.9421960711479187, corresponding to test acc:                         0.6599734425544739 / 0.6872594952583313
after epoch: 8,now: 2024-07-29 01:59:52.285477,epoch time: 1:05:25.016509,used: 6:03:34.736608,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9398812, 'precision': 0.78113365, 'recall': 0.71681803, 'specificity': 0.9933806, 'f1': 0.7327283, 'auroc': 0.9941936}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   340     1   0     1   0    0    12    12     1    0    116
1     0  1283   0     5   0    0     6    33     4    0      1
2     1     1   0   191  55    1    19    22     2   12      8
3     0     1   0  8096   0   13     1   179   143    5      0
4     1     0   0    13  80    0   290     2     4    0    149
5     0     1   0    25   2  297     3     1     5  184      3
6     2     0   0     1   0    0  1879     1     1    0     23
7     0     8   0    68   1    0     2  7140    31    0     13
8     0     0   0    34   5    0    27   113  3051    0     63
9     2     0   0    96   1   32     8    14     5  324     11
10    2     0   0     9   2    1   129     8     5    0  12639
---- Validation: 
scalar performance:
{'acc': 0.9410191, 'precision': 0.78128994, 'recall': 0.71556133, 'specificity': 0.9935141, 'f1': 0.73168063, 'auroc': 0.99398685}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   333     0   0     2   0    0     8    12     1    0    127
1     0  1279   0     8   0    0     2    40     3    0      0
2     0     0   0   191  50    1    23    18     5   17      7
3     0     1   0  8104   1   15     3   178   133    4      1
4     0     0   0    16  78    0   296     3     4    1    141
5     1     1   0    20   1  299     4     0     5  186      4
6     4     0   0     0   1    0  1880     2     3    0     18
7     0     9   0    51   0    0     2  7173    21    0      9
8     2     0   0    44   3    0    21   110  3059    2     55
9     1     0   0   104   5   28     7    12     7  322      7
10    2     2   0     6   3    0   116     7     7    0  12653
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6841111, 'precision': 0.55754167, 'recall': 0.5575497, 'specificity': 0.96719086, 'f1': 0.5306261, 'auroc': 0.874269}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   799     0   0    1    0    2    34   108    10   22   194
1     0  1240   0   25    3    3     6   207     3    0    12
2     2     1   0  179  150    2   399    99    81   32    70
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    3    6    0   595     1     2    0  1026
5     2     0   0   44    0  192    33     3    21  290     7
6     0     0   0    3    1    0  3052     2     2    0     7
7     0     0   0    5    0    0     0  1155     0    1     3
8     0     0   0   29    1    0    25    17  1291    2     5
9     4     5   1  173   20   34    33   231   146  456    34
10    0     0   0    0    0    0    59     0     0    0  1587
early stop counter: 2
val acc:0.9410191178321838, best validation acc: 0.9421960711479187, corresponding to test acc:                         0.6599734425544739 / 0.6872594952583313
after epoch: 9,now: 2024-07-29 03:07:20.217088,epoch time: 1:07:27.931611,used: 7:11:02.668219,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94970036, 'precision': 0.82447004, 'recall': 0.7645814, 'specificity': 0.99440026, 'f1': 0.77998185, 'auroc': 0.99324036}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   383     0   0     3    0    0     6    21     5    2     63
1     0  1287   0    10    0    0     1    26     8    0      0
2     2     0   0   162   22    0     2    38     7   76      3
3     0     0   0  8255    0    2     1   123    55    0      2
4     3     0   0    57  196    1   108    14     9    3    148
5     0     0   0    63    0  306     1     0     5  145      1
6     2     0   0     1    0    0  1886     1     1    0     17
7     0     9   0    86    1    0     6  7119    34    2      5
8     1     0   0   118    2    0     4   109  3028    0     33
9     0     0   0    25    0   29     0    11     9  418      1
10   17     0   0    21    5    0    78    32    20    2  12618
---- Validation: 
scalar performance:
{'acc': 0.9503544, 'precision': 0.8211801, 'recall': 0.76429737, 'specificity': 0.99447703, 'f1': 0.77847254, 'auroc': 0.9929595}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   391     0   0     2    0    0     8    26     3    3     50
1     0  1284   0     9    0    1     0    29     9    0      0
2     2     1   0   159   20    1     3    35     6   81      4
3     1     0   0  8252    0    4     1   126    55    1      0
4     3     1   0    49  197    0    97    10     7    5    170
5     0     0   0    71    0  296     0     0     3  150      1
6     3     0   0     1    1    0  1888     1     2    0     12
7     0    10   0    82    1    0     4  7128    36    1      3
8     2     0   0   105    0    0     5   102  3040    2     40
9     0     0   0    25    0   30     0    11    10  415      2
10   17     2   0    20   11    0    67    17    22    2  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6631918, 'precision': 0.6286628, 'recall': 0.53613794, 'specificity': 0.9659614, 'f1': 0.5167911, 'auroc': 0.8527335}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   812     1   0   17    0    2    41   112    64   35    86
1     0  1184   0   30    1    1     3   267     8    1     4
2     1     0   2  208  114    3   141   179   216   65    86
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    9   38    0   471     4     8    0  1101
5     2     0   0  289    0  174     4     2    11  110     0
6     0     0   0   25    0    0  3027     2     9    0     4
7     0     0   0   42    0    0     0  1120     0    0     2
8     0     0   0  189    0    0     6     6  1169    0     0
9     2     6   1  241    7   49     7   167   261  388     8
10    0     0   0    1    2    0    76     1     1    0  1565
better model found
persisted
after epoch: 10,now: 2024-07-29 04:13:13.434591,epoch time: 1:05:53.217503,used: 8:16:55.885722,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:16:55.885722 at 2024-07-29 04:13:13.434591
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6631918, 'precision': 0.6286628, 'recall': 0.53613794, 'specificity': 0.9659614, 'f1': 0.5167911, 'auroc': 0.8527335}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   812     1   0   17    0    2    41   112    64   35    86
1     0  1184   0   30    1    1     3   267     8    1     4
2     1     0   2  208  114    3   141   179   216   65    86
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    9   38    0   471     4     8    0  1101
5     2     0   0  289    0  174     4     2    11  110     0
6     0     0   0   25    0    0  3027     2     9    0     4
7     0     0   0   42    0    0     0  1120     0    0     2
8     0     0   0  189    0    0     6     6  1169    0     0
9     2     6   1  241    7   49     7   167   261  388     8
10    0     0   0    1    2    0    76     1     1    0  1565
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6872595, 'precision': 0.5916307, 'recall': 0.57408774, 'specificity': 0.96773046, 'f1': 0.5373999, 'auroc': 0.8580806}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   979     1   0    3    1    8    79    39    20   16    24
1     1  1194   0   26    2    2     6   247    10    2     9
2    15    17   3   56  135    5   369   122   189   35    69
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    1    2    0   332     4     9    0  1284
5     6     4   0   50    0  344    23     0     7  158     0
6     2     0   0    1    0    0  3042     8     6    0     8
7     0     1   0   12    1    0     1  1145     0    1     3
8     0     0   0  129    0    4    40    15  1178    3     1
9    39    46   2  125   33   90    59   137   279  312    15
10    0     0   0    0    0    0    22     0     0    0  1624
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_19_56_16_seed_0_23121384_instance_wise_predictions.txt
accuracy from prediction file 0.66319177219618
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/17.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB | 414191 GiB | 414190 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411234 GiB | 411232 GiB |
|       from small pool |      7 MiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB | 414191 GiB | 414190 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411234 GiB | 411232 GiB |
|       from small pool |      7 MiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB | 412626 GiB | 412624 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 409672 GiB | 409670 GiB |
|       from small pool |      6 MiB |     26 MiB |   2954 GiB |   2954 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  16520 MiB |      0 B   |
|       from large pool |  16492 MiB |  16492 MiB |  16492 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231481 KiB | 630835 KiB |  63174 GiB |  63174 GiB |
|       from large pool | 216320 KiB | 628608 KiB |  60198 GiB |  60198 GiB |
|       from small pool |  15161 KiB |  21845 KiB |   2975 GiB |   2975 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2660    |    3967    |   30482 K  |   30479 K  |
|       from large pool |     247    |     595    |   13397 K  |   13397 K  |
|       from small pool |    2413    |    3621    |   17084 K  |   17082 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2660    |    3967    |   30482 K  |   30479 K  |
|       from large pool |     247    |     595    |   13397 K  |   13397 K  |
|       from small pool |    2413    |    3621    |   17084 K  |   17082 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     467    |       0    |
|       from large pool |     453    |     453    |     453    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     118    |    1242    |   16743 K  |   16742 K  |
|       from large pool |      95    |     303    |    8723 K  |    8723 K  |
|       from small pool |      23    |    1146    |    8019 K  |    8019 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414191 GiB | 414191 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414191 GiB | 414191 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412626 GiB | 412626 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409672 GiB | 409672 GiB |
|       from small pool |      0 KiB |     26 MiB |   2954 GiB |   2954 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  16520 MiB |  16520 MiB |  14638 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     22 MiB |     28 MiB |     28 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630835 KiB |  63175 GiB |  63175 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60199 GiB |  60199 GiB |
|       from small pool |      0 KiB |  21845 KiB |   2975 GiB |   2975 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3621    |   17084 K  |   17084 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3621    |   17084 K  |   17084 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     467    |     467    |     363    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      11    |      14    |      14    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1242    |   16743 K  |   16743 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |    1146    |    8020 K  |    8020 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414191 GiB | 414191 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414191 GiB | 414191 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2957 GiB |   2957 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412626 GiB | 412626 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409672 GiB | 409672 GiB |
|       from small pool |      0 KiB |     26 MiB |   2954 GiB |   2954 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  16520 MiB |  16520 MiB |  14638 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     22 MiB |     28 MiB |     28 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630835 KiB |  63175 GiB |  63175 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60199 GiB |  60199 GiB |
|       from small pool |      0 KiB |  21845 KiB |   2975 GiB |   2975 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3621    |   17084 K  |   17084 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3621    |   17084 K  |   17084 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     467    |     467    |     363    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      11    |      14    |      14    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1242    |   16743 K  |   16743 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |    1146    |    8020 K  |    8020 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384

 Experiment start at: 2024-07-29 04:49:57.641383
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8306935, 'precision': 0.5112244, 'recall': 0.54974777, 'specificity': 0.9828783, 'f1': 0.5044181, 'auroc': 0.8979057}
confusion matrix:
    0     1    2     3   4    5     6     7     8   9      10
0   94    12    1     6   1   19   328     1     5   0     16
1    0  1213    9    17   3    3     8    72     7   0      0
2   29     7    6     7   0  120    70    21    11   0     41
3    0     4    1  8102   0   31    19   171   110   0      0
4    4    27    5     2   1  227    73     7    32   0    161
5    9     0    1    59   0  308   127     0    16   0      1
6    4    11    0     5   0   97  1772     4     5   0     10
7    6    34   11   612   4   27    13  6466    82   0      8
8    0     6    5   349   0  468    30    84  2342   0     12
9   57     7    3    13   1  187   192     9     8   0     16
10  20   328  224    11   3  899   372    58   132   0  10744
---- Validation: 
scalar performance:
{'acc': 0.8308145, 'precision': 0.5073333, 'recall': 0.55498016, 'specificity': 0.98286486, 'f1': 0.50776696, 'auroc': 0.8998064}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   109     9    3     3   0   21   312     4     5   0     17
1     1  1226    6    21   0    5     2    65     4   0      2
2    30    13    4     3   0  125    70    27    11   0     29
3     0     4    0  8096   1   35    12   173   117   0      2
4     5    26    6     1   0  216    75     9    31   0    170
5     9     0    1    65   0  320   110     0    12   0      4
6     5    11    0     3   0   93  1782     2     5   0      7
7     7    34    7   620   5   23    16  6467    79   0      7
8     0     5    6   376   0  440    44    64  2344   0     17
9    50     4    1    11   0  192   202    10     6   0     17
10   20   357  232     9   2  893   377    69   125   0  10712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5115791, 'precision': 0.3818771, 'recall': 0.4135457, 'specificity': 0.949724, 'f1': 0.37981695, 'auroc': 0.75499505}
confusion matrix:
     0     1   2    3   4    5     6    7    8   9     10
0   471     1   1    7   0    1   683    4    1   0     1
1    43  1203  12   37   2    9    26  159    5   0     3
2    97    60  12   19   0  321   326   23   48   0   109
3     0     0   0    0   0    0     0    0    0   0     0
4     8   101  20    0   0  141    44    3   23   0  1293
5   107     1   1   18   0  129   330    0    5   0     1
6     3    11   0    0   1  962  2048    1   26   0    15
7    57     0   3  115   0    0    26  958    1   0     4
8    10     0   6   87   0  266   101    1  899   0     0
9   328    26  12   61   0  237   384   32   30   0    27
10    1    10  10    0   0   22     8    2    1   0  1592
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 06:07:09.111935,epoch time: 1:17:11.470552,used: 1:17:11.470552,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9126712, 'precision': 0.655078, 'recall': 0.66310817, 'specificity': 0.9901403, 'f1': 0.6539849, 'auroc': 0.92593527}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   362     1    7    26   0    1    18    10     3   0     55
1     0  1258    5    21   0    0     0    38     7   0      3
2    26     4  136     6   0   12     4    55    23   0     46
3     1     1    0  8208   0    4     0   125    98   0      1
4     8     3   66    17   0    7     5    22    46   0    365
5    31     1    8    77   0  240    55    10    48   0     51
6    23    15    1    21   0    1  1814     3    16   0     14
7     0    22   17   384   0    0     4  6745    76   0     14
8     2     1   34   261   0    6     0    60  2892   0     39
9   145     2   71    26   0   43    17    43    26   0    120
10   22    12   77    64   0    4    45    59    53   0  12457
---- Validation: 
scalar performance:
{'acc': 0.9123713, 'precision': 0.6529231, 'recall': 0.6627435, 'specificity': 0.9901455, 'f1': 0.6525006, 'auroc': 0.9247419}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   345     2    5    26   0    2    25    12     5   0     61
1     0  1256    5    13   0    0     2    48     5   0      3
2    32     2  143     5   0    5     5    54    23   0     43
3     3     1    2  8199   0    1     1   134    99   0      0
4     9     2   73     9   0    5     5    22    52   0    362
5    39     1    3    74   0  244    56     8    46   0     50
6    19    13    1    23   0    4  1815     5    14   0     14
7     1    17   23   397   0    0     2  6727    83   0     15
8     0     0   40   244   0    3     1    69  2911   0     28
9   144     2   76    27   0   51    26    37    18   0    112
10   23    12   84    70   0    7    33    37    61   0  12469
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6358357, 'precision': 0.48459548, 'recall': 0.5135622, 'specificity': 0.9636913, 'f1': 0.4693443, 'auroc': 0.80189115}
confusion matrix:
     0     1    2    3   4   5     6     7     8   9     10
0   981    13    5   80   0   0    48    25    11   0     7
1     1  1236   28   39   0   0     3   170     5   0    17
2   147     5  222   43   0  10     9   107   192   0   280
3     0     0    0    0   0   0     0     0     0   0     0
4     3     1   13    6   0   2     6     7    19   0  1576
5   154     5    2  129   0  82    31    22    36   0   131
6     3    33    7   87   0  43  2722     5   105   0    62
7     1     0    0  114   0   0     3  1042     1   0     3
8     2     0    0  189   0   2     2     4  1171   0     0
9   345    10  154  172   0  22    17   176   108   0   133
10    0     0    2    7   0   0     5     0     0   0  1632
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 07:00:39.990528,epoch time: 0:53:30.878593,used: 2:10:42.349145,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9095944, 'precision': 0.6446017, 'recall': 0.65748346, 'specificity': 0.989746, 'f1': 0.6368925, 'auroc': 0.9386071}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   442     2    0     2   0    0     3     5     0   0     29
1     0  1287    1     7   0    1     3    31     1   0      1
2    83     2   69     0   0    2     3    78     0   0     75
3    36    11    2  8049   0   11    19   224    84   0      2
4    18     9   16     4   0    1     0    14     2   0    475
5    81    31    1    16   0  274    27    10    21   0     60
6    37    11    0     2   1    1  1835     1     0   0     19
7    15    26   24   186   0    0    10  6983    11   0      9
8    30    45  101   209   0   14    17   200  2438   0    241
9   284    30   19     6   0   20     7    48     3   0     76
10   63    18   16    11   0    0    13    48     3   0  12620
---- Validation: 
scalar performance:
{'acc': 0.91031164, 'precision': 0.64405155, 'recall': 0.65700495, 'specificity': 0.98981196, 'f1': 0.63674474, 'auroc': 0.9379571}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   436     3   1     1   0    0     4     8     0   0     30
1     0  1296   3     9   0    0     1    21     1   0      1
2    77     1  70     0   0    1     3    76     0   0     84
3    28     8   2  8070   0   17    25   230    56   0      4
4    24     4  24     1   0    2     1    10     2   0    471
5    91    25   2    21   0  270    35     9    24   0     44
6    37     8   0     0   0    0  1846     0     0   0     17
7    12    35  22   196   0    0     6  6976     9   0      9
8    27    43  84   213   0   16    24   205  2430   0    254
9   277    32  17     4   0   23     5    51     6   0     78
10   70    17  20     8   0    0     6    35     2   0  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6447912, 'precision': 0.5038678, 'recall': 0.519732, 'specificity': 0.9642974, 'f1': 0.46718603, 'auroc': 0.8083166}
confusion matrix:
      0     1    2    3   4    5     6     7    8   9     10
0   1146     2    1    3   0    0    10     4    1   0     3
1      7  1365   13   21   0    0     0    86    0   0     7
2    250    28  132   12   0    4     1    93   34   0   461
3      0     0    0    0   0    0     0     0    0   0     0
4      4     3    3    2   0    1     1     8    0   0  1611
5    222     1    0   21   0  103     7    45   32   0   161
6     46   110    0    5   0    3  2803     5    2   0    93
7     20     0    0  106   0    0     1  1034    0   0     3
8     68    15   15  175   0   17    16    12  989   0    63
9    583    29   98   31   1   26     7   135   33   0   194
10     0     0    2    0   0    0     0     0    0   0  1644
new oracle model saved
early stop counter: 1
val acc:0.9103116393089294, best validation acc: 0.9123712778091431, corresponding to test acc:                         0.6358357071876526 / 0.6447911858558655
after epoch: 3,now: 2024-07-29 07:55:05.061503,epoch time: 0:54:25.070975,used: 3:05:07.420120,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9195741, 'precision': 0.6574459, 'recall': 0.68075204, 'specificity': 0.9910964, 'f1': 0.66462415, 'auroc': 0.9428609}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   412     5   0     5   0    0    10    13     2   0     36
1     0  1283   0    11   0    0     0    32     4   0      2
2    34     4  98     4   0    6     3   117    26   0     20
3     1     2   1  8274   0    0     0    75    84   0      0
4     5    15  27     4   0   19     6    41    76   0    346
5    25     1   1    56   0  314    24     9    81   0     10
6    26     4   0     8   0    8  1844     1     6   0     11
7     3    20   0   415   0    0     3  6758    57   0      6
8     1     8   4   178   0   20     1    74  2995   0     14
9   165     3  32    13   0   91    25    76    36   0     52
10   35    33  32    20   0   77     9    80   116   0  12392
---- Validation: 
scalar performance:
{'acc': 0.92066336, 'precision': 0.6603338, 'recall': 0.68421894, 'specificity': 0.9912084, 'f1': 0.6686175, 'auroc': 0.9419885}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   413     4    1     4   0    1     8     7     6   0     39
1     0  1288    0    12   0    0     0    29     2   0      1
2    23     1  104     8   0    3     2   114    32   0     25
3     0     2    0  8270   0    1     3    71    93   0      0
4     8    15   23    10   0   19     0    40    78   0    346
5    20     1    4    56   0  317    19     8    88   0      8
6    26     3    0     6   0    8  1847     1     4   0     13
7     0    30    3   413   0    0     3  6768    43   0      5
8     2     5    2   186   0   10     2    65  3013   0     11
9   155     8   39    21   0   94    22    80    30   0     44
10   31    45   31    19   0   78    14    68   111   0  12399
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5596446, 'precision': 0.43889618, 'recall': 0.4725962, 'specificity': 0.9566205, 'f1': 0.42021874, 'auroc': 0.7955529}
confusion matrix:
      0     1   2    3   4    5     6    7     8   9     10
0   1073     3   0   43   0    0     8   33     4   0     6
1      0  1251   5   39   0    0     0  195     2   0     7
2     88     7  56   84   0   37     1  181   295   0   266
3      0     0   0    0   0    0     0    0     0   0     0
4      3     3   1    1   0   22     1    4    32   0  1566
5     80     0   0  159   0  143    15   30   149   0    16
6     14     1   1   46   1  665  1868    9   399   0    63
7      0     0   0  319   0    1     1  840     0   0     3
8      1     0   0  234   0    1     0    8  1126   0     0
9    223     8  53  260   0   70    11  235   176   0   101
10     0     0   1    0   0    0     0    1     2   0  1642
better model found
persisted
after epoch: 4,now: 2024-07-29 08:48:28.698366,epoch time: 0:53:23.636863,used: 3:58:31.056983,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9246575, 'precision': 0.6511881, 'recall': 0.70511246, 'specificity': 0.9919342, 'f1': 0.67377204, 'auroc': 0.94253856}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   437    10    2     5   0    0     2    11     3   0     13
1     0  1253    4    13   0    0     2    46    11   0      3
2    49     8  107     0   0    2    12   112    10   0     12
3     0     0    1  8081   0    7     1   160   186   0      0
4    20    36   53     0   0    8    15    69    39   0    299
5    15     1    0    11   0  405    30     1    57   0      1
6    43     4    1    11   0    5  1829     2     6   0      7
7     1     5    5   159   0    0     1  6995    93   0      4
8     5     5   15    62   0    4     2    70  3121   0     12
9   158     9   19     2   0  133   107    52     9   0      4
10   58    98   72     9   0    3     7   172    42   0  12332
---- Validation: 
scalar performance:
{'acc': 0.9229103, 'precision': 0.64558774, 'recall': 0.70078313, 'specificity': 0.9917419, 'f1': 0.6681986, 'auroc': 0.94276536}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   439     7   1     5   0    1     3     7     4   0     16
1     1  1246   5     6   0    0     0    59    11   0      4
2    54    11  91     0   0    5    10   120    10   0     11
3     3     0   0  8054   0    9     0   175   199   0      0
4    18    39  59     0   0    7     7    69    37   0    303
5    10     1   0    13   0  412    22     0    62   0      1
6    46     6   1     9   0    6  1825     3     4   0      8
7     4     7   5   171   0    2     1  6989    82   0      4
8     5     9  11    70   0    7     2    62  3116   0     14
9   163    10  17     0   0  128   115    48     9   0      3
10   68    88  74     8   0    5     9   180    33   0  12331
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63051844, 'precision': 0.46666056, 'recall': 0.534114, 'specificity': 0.9631091, 'f1': 0.47238815, 'auroc': 0.8086028}
confusion matrix:
      0     1    2    3   4    5     6    7     8   9     10
0   1006     2    2   59   0    1     8   74    14   0     4
1      9  1137   31   29   0    0     1  257    12   0    23
2    134    13  139   12   0   60    45  196   153   0   263
3      0     0    0    0   0    0     0    0     0   0     0
4      4     0    3    0   0    6     1    4     9   0  1606
5     46     0    0   89   0  318    26    9   102   0     2
6     28     1    0    7   0  419  2531    2    58   0    21
7      5     0    1  177   0    0     1  974     3   0     3
8      5     0    0   69   0   21     3    6  1264   0     2
9    276     4   96   61   0  220   131  184   135   0    30
10     0     0    0    0   0    1     0    1     1   0  1643
better model found
persisted
after epoch: 5,now: 2024-07-29 09:38:29.993800,epoch time: 0:50:01.295434,used: 4:48:32.352417,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93049014, 'precision': 0.6745699, 'recall': 0.67719615, 'specificity': 0.9922706, 'f1': 0.66466093, 'auroc': 0.9464319}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   410     2   0     4   0    2    24     8     7   0     26
1     0  1272   3     7   0    0     3    36     7   0      4
2    74     0  62     2   0    5     3   116    18   0     32
3     0     2   0  8178   0    3     0   153   102   0      0
4    22     5  21     2   0    8     4    52    36   0    389
5     5     2   2    26   0  320    10     3   147   0      6
6    12     3   0     3   0    4  1874     1     6   0      5
7     1    17   2   169   0    1     2  6983    79   0      9
8     1     2   5   105   0    8     0    52  3081   0     42
9   142     7   4     8   0  143    36    62    41   0     49
10   31    23   6    15   0    9    42    44    24   0  12598
---- Validation: 
scalar performance:
{'acc': 0.9317106, 'precision': 0.677997, 'recall': 0.67979586, 'specificity': 0.99239504, 'f1': 0.6684153, 'auroc': 0.94623315}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   415     1   0     5   0    2    27     5     2   0     26
1     0  1270   4     8   0    0     0    38     5   0      7
2    65     0  69     3   0    6     3   118    17   0     31
3     0     1   0  8184   0    4     1   152    98   0      0
4    23     7  20     3   0    5     3    49    39   0    390
5     8     2   0    21   0  313    15     0   157   0      5
6     6     2   0     1   0    4  1881     1     5   0      8
7     0    15   3   168   0    0     2  6993    78   0      6
8     1     0   5    95   0    6     1    49  3097   0     42
9   137    10   6    11   0  141    43    67    30   0     48
10   37    14   7    10   0   11    36    49    22   0  12610
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62541103, 'precision': 0.46637756, 'recall': 0.5036795, 'specificity': 0.962723, 'f1': 0.45120105, 'auroc': 0.80437213}
confusion matrix:
      0     1   2    3   4    5     6     7     8   9     10
0   1026     1   0   30   0    1    58    36    16   0     2
1      3  1090  20   53   0    0    11   245    18   0    59
2     72     7  23   63   0   98    18    81   301   0   352
3      0     0   0    0   0    0     0     0     0   0     0
4      4     0   0    1   0    7     5     2    13   0  1601
5     21     1   0  179   0  141     5     8   231   0     6
6      2     0   0   81   0   88  2773     4   106   0    13
7      3     0   0   93   0    0     4  1052     8   0     4
8      0     0   0  169   0    6     1     1  1192   0     1
9    112    12  10  264   0  171    28    90   350   0   100
10     0     0   0    0   0    0     3     0     1   0  1642
better model found
persisted
after epoch: 6,now: 2024-07-29 10:28:42.959293,epoch time: 0:50:12.965493,used: 5:38:45.317910,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9261558, 'precision': 0.6637984, 'recall': 0.6416956, 'specificity': 0.99180007, 'f1': 0.6253464, 'auroc': 0.9549137}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   451     0   0     3   0    0     1    13     0   0     15
1     0  1273   0    10   0    0     0    43     5   0      1
2    57     0  29     0   0    3     2   194     6   0     21
3     1     0   0  8262   0    0     0   135    41   0      0
4    34     1  18     1   0    1     1    77    18   0    388
5    44     0   1    37   0  142    24    10   260   0      3
6    29     2   0     1   0    0  1860     4     2   0      9
7     3     6   3   155   0    0     2  7062    28   0      5
8     2     0   6   219   0    0     1    98  2941   0     29
9   291     0   1     8   0   47    33    89    18   0      6
10   51     0   7    11   0    0     7    94    24   0  12596
---- Validation: 
scalar performance:
{'acc': 0.92729706, 'precision': 0.6670357, 'recall': 0.64629436, 'specificity': 0.9919175, 'f1': 0.6317658, 'auroc': 0.9557378}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   448     0   0     1   0    0     2    14     0   0     18
1     0  1278   1     7   0    0     0    41     5   0      0
2    57     0  36     0   0    3     1   193     3   0     19
3     2     0   0  8265   0    1     0   139    32   0      1
4    33     3  20     0   0    2     1    80    16   0    384
5    38     0   1    31   0  158    34    11   246   0      2
6    35     2   0     2   0    2  1847     5     3   0     12
7     1     6   0   165   0    0     1  7055    31   0      6
8     3     0   4   205   0    1     0    83  2964   0     36
9   278     0   2     9   0   53    33    95    19   0      4
10   50     1  10     9   0    0     2    94    14   0  12616
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59525645, 'precision': 0.45454216, 'recall': 0.48106685, 'specificity': 0.9597348, 'f1': 0.42656258, 'auroc': 0.8011344}
confusion matrix:
      0     1   2    3   4    5     6    7     8   9     10
0   1069     1   1   29   0    0     4   55     5   0     6
1      2  1155   8   30   0    0     1  284     4   0    15
2    255     0  56   22   0    4     4  272   118   0   284
3      0     0   0    0   0    0     0    0     0   0     0
4      6     0   0    0   0    0     1    6    10   0  1610
5    112     0   0  152   0   95    80   40    96   0    17
6     58     6   3   74   0  132  2472   31   138   0   153
7      7     0   0  259   0    0     1  891     2   0     4
8      3     0   0  231   0    1     0    7  1124   0     4
9    521     0  39  125   0   18    47  280    73   0    34
10     0     0   0    0   0    0     0    0     0   0  1646
early stop counter: 1
val acc:0.927297055721283, best validation acc: 0.9317106008529663, corresponding to test acc:                         0.6254110336303711 / 0.6447911858558655
after epoch: 7,now: 2024-07-29 11:25:01.066545,epoch time: 0:56:18.107252,used: 6:35:03.425162,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.934878, 'precision': 0.7189703, 'recall': 0.68213975, 'specificity': 0.99243236, 'f1': 0.6875465, 'auroc': 0.9496989}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   415     0    1     5   0    0     2    18     2   0     40
1     0  1290    1    11   0    0     0    27     2   0      1
2    11     1  119     0   0    1     1   130    10   0     39
3     0     1    0  8292   0    1     0    98    44   0      2
4     5     0   15     0   0    2     0    34    25   0    458
5    44     3    1    31   0  241    27    45    87   0     42
6    11     1    0     6   0    0  1861     5     4   0     20
7     0    11    3   165   0    0     1  7050    26   0      9
8     1     1    5   167   0    2     0    76  3008   0     34
9   193     1   22     3   0   14     5   188    11   0     56
10   10     2    8    13   0    0     4    67    21   0  12666
---- Validation: 
scalar performance:
{'acc': 0.93459946, 'precision': 0.71722806, 'recall': 0.6807296, 'specificity': 0.9924127, 'f1': 0.684486, 'auroc': 0.9503835}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   421     0    0     7   0    0     1     8     3   0     43
1     0  1294    1    10   0    0     0    22     4   0      1
2     8     1  120     1   0    1     1   127     7   0     46
3     2     1    0  8290   0    3     0   108    36   0      0
4     6     1   12     1   0    3     0    41    18   0    457
5    42     1    0    37   0  221    39    44    89   0     48
6    12     0    0     7   0    1  1867     4     4   0     13
7     1    12    3   162   0    0     2  7058    21   0      6
8     2     1    6   163   0    0     0    80  3016   0     28
9   204     0   24     5   0   15     3   179     6   0     57
10   16     2    8     7   0    0     2    72    36   0  12653
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6396138, 'precision': 0.48253566, 'recall': 0.521942, 'specificity': 0.9638925, 'f1': 0.46678597, 'auroc': 0.7979124}
confusion matrix:
      0     1    2    3   4   5     6     7     8   9     10
0   1087     1    0   22   0   0     5    39     6   0    10
1      0  1302   10   37   0   0     0   133     7   0    10
2     36     0  132    8   0   1     1   247   189   0   401
3      0     0    0    0   0   0     0     0     0   0     0
4      0     0    1    0   0   1     1    13    13   0  1604
5     36     0    0  105   0  76     2    85    68   0   220
6      2     0    1   91   0  87  2549     7   127   0   203
7      3     0    0   84   0   0     0  1074     2   0     1
8      1     0    0   82   0   1     1     6  1277   0     2
9    164     2  147   91   0  10     1   351   190   0   181
10     0     0    0    0   0   1     0     0     0   0  1645
better model found
persisted
after epoch: 8,now: 2024-07-29 12:31:34.026618,epoch time: 1:06:32.960073,used: 7:41:36.385235,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.5952215, 'precision': 0.57305527, 'recall': 0.5950934, 'specificity': 0.96208715, 'f1': 0.5266725, 'auroc': 0.95820135}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   440     0     28     2   0   0     2     2     4   0   5
1     0  1276      3     4   0   0     1    46     2   0   0
2    30     0    200     0   0   1     2    59     9   0  11
3     1     1      0  8261   0   1     1    98    72   0   0
4     9     2    459     1   0   1     0    10    33   0  24
5    33     1      4    22   0  93    13    24   270   0  61
6    23     6     12     2   1   0  1854     0     3   0   5
7     2     5      8   213   0   0     1  6998    37   0   0
8     2     0     46   107   0   0     0    42  3097   0   1
9   232     0     46     8   0  13     7   103    19   0  65
10   20     1  12687     8   0   0     4    15    33   0  28
---- Validation: 
scalar performance:
{'acc': 0.59475726, 'precision': 0.6665883, 'recall': 0.5894134, 'specificity': 0.96201754, 'f1': 0.5238091, 'auroc': 0.95937854}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   434     0     31     6   0   0     2     3     5   0   2
1     0  1281      2     5   0   0     1    42     1   0   0
2    40     0    188     0   0   0     1    64    11   0   8
3     0     0      1  8274   0   0     1    96    67   0   1
4     9     1    458     0   1   1     1    12    32   0  24
5    28     2      2    24   0  85    14    24   278   0  64
6    23     4     14     1   0   0  1856     2     6   0   2
7     2     9     11   218   0   0     1  6993    31   0   0
8     2     1     32   116   0   0     0    53  3090   0   2
9   236     2     44     7   0  10     8    94    15   0  77
10   24     0  12675     7   0   0     2    18    37   0  33
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.54222345, 'precision': 0.44113114, 'recall': 0.43979186, 'specificity': 0.9548814, 'f1': 0.3954113, 'auroc': 0.8197316}
confusion matrix:
      0     1     2    3   4   5     6    7     8   9    10
0   1119     5    10    2   0   0     8   14     7   0    5
1      4  1086    32   27   0   0     0  342     8   0    0
2     67     0   458   17   0   0     2  115   142   0  214
3      0     0     0    0   0   0     0    0     0   0    0
4      1     0  1612    0   0   0     1    0     7   0   12
5     28     0     0   39   0  23     2   55   114   0  331
6     14    43    42   11   0   2  2850    5    52   0   48
7     23     0     4  190   0   0     3  940     3   0    1
8      3     1     8   75   0   0     1    6  1274   0    2
9    259     0    99   76   1   5     4  268   106   0  319
10     0     0  1645    0   0   0     0    0     1   0    0
early stop counter: 1
val acc:0.5947572588920593, best validation acc: 0.9345994591712952, corresponding to test acc:                         0.6396138072013855 / 0.6447911858558655
after epoch: 9,now: 2024-07-29 13:34:52.642282,epoch time: 1:03:18.615664,used: 8:44:55.000899,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.5932684, 'precision': 0.57740134, 'recall': 0.601974, 'specificity': 0.9622203, 'f1': 0.50905395, 'auroc': 0.9626089}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   448     0     28     0   0   0     2     4     0   0   1
1     0  1295      2     3   0   0     0    26     6   0   0
2    59     0    234     0   0   0     3    13     2   0   1
3     5     1      0  8038   0   2     1   235   158   0   0
4    23     1    475     0   0   2     1     8    20   0   9
5    43     0      3     4   0  64    43     4   360   0   0
6    33     1     11     5   0   0  1852     2     2   0   2
7     5     8     13    87   0   0     1  7097    53   0   0
8     8     1     66    40   0   2     1    56  3122   0   0
9   322     0     51     1   0  36    47    11    21   0   4
10   53     1  12655     6   0   0     5    16    28   0  24
---- Validation: 
scalar performance:
{'acc': 0.5930186, 'precision': 0.58400446, 'recall': 0.6002803, 'specificity': 0.9622142, 'f1': 0.50982904, 'auroc': 0.96252394}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   447     0     28     1   0   0     2     3     1   0   1
1     0  1295      4     3   0   1     0    26     3   0   0
2    67     0    225     0   0   0     2    14     4   0   0
3     4     1      0  8040   0   1     0   215   179   0   0
4    24     1    476     0   0   0     1     6    22   0   9
5    52     0      3     7   0  70    37     4   347   0   1
6    34     2      8     3   0   1  1853     1     4   0   2
7     3    11     15    82   0   0     1  7092    60   0   1
8     9     0     66    40   0   2     1    53  3125   0   0
9   333     1     56     0   0  33    39     9    22   0   0
10   48     0  12660     9   0   0     5    14    37   0  23
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56405234, 'precision': 0.39449745, 'recall': 0.46194524, 'specificity': 0.9570714, 'f1': 0.40387195, 'auroc': 0.8308088}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1120     2     3  11   0    0    16    13     5   0   0
1      4  1163    18  24   0    0     0   264    24   0   2
2    209     0   364   9   0   14    34    59   313   0  13
3      0     0     0   0   0    0     0     0     0   0   0
4      6     0  1595   0   0    0     1     2    20   0   9
5     97     0     4  52   0   93    20    43   281   0   2
6      6     0     4  13   0    8  2946     1    89   0   0
7      9     0     2  75   0    1     0  1067    10   0   0
8      3     0     3  50   0    0     0     6  1308   0   0
9    397     0   104  84   0  113    51   136   250   0   2
10     0     1  1642   0   0    0     1     0     1   0   1
early stop counter: 2
val acc:0.5930185914039612, best validation acc: 0.9345994591712952, corresponding to test acc:                         0.6396138072013855 / 0.6447911858558655
after epoch: 10,now: 2024-07-29 14:28:02.377369,epoch time: 0:53:09.735087,used: 9:38:04.735986,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 9:38:04.735986 at 2024-07-29 14:28:02.377369
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6396138, 'precision': 0.48253566, 'recall': 0.521942, 'specificity': 0.9638925, 'f1': 0.46678597, 'auroc': 0.7979124}
confusion matrix:
      0     1    2    3   4   5     6     7     8   9     10
0   1087     1    0   22   0   0     5    39     6   0    10
1      0  1302   10   37   0   0     0   133     7   0    10
2     36     0  132    8   0   1     1   247   189   0   401
3      0     0    0    0   0   0     0     0     0   0     0
4      0     0    1    0   0   1     1    13    13   0  1604
5     36     0    0  105   0  76     2    85    68   0   220
6      2     0    1   91   0  87  2549     7   127   0   203
7      3     0    0   84   0   0     0  1074     2   0     1
8      1     0    0   82   0   1     1     6  1277   0     2
9    164     2  147   91   0  10     1   351   190   0   181
10     0     0    0    0   0   1     0     0     0   0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6447912, 'precision': 0.5038678, 'recall': 0.519732, 'specificity': 0.9642974, 'f1': 0.46718603, 'auroc': 0.8083166}
confusion matrix:
      0     1    2    3   4    5     6     7    8   9     10
0   1146     2    1    3   0    0    10     4    1   0     3
1      7  1365   13   21   0    0     0    86    0   0     7
2    250    28  132   12   0    4     1    93   34   0   461
3      0     0    0    0   0    0     0     0    0   0     0
4      4     3    3    2   0    1     1     8    0   0  1611
5    222     1    0   21   0  103     7    45   32   0   161
6     46   110    0    5   0    3  2803     5    2   0    93
7     20     0    0  106   0    0     1  1034    0   0     3
8     68    15   15  175   0   17    16    12  989   0    63
9    583    29   98   31   1   26     7   135   33   0   194
10     0     0    2    0   0    0     0     0    0   0  1644
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_29_04_49_56_seed_1_23121384_instance_wise_predictions.txt
accuracy from prediction file 0.6396137969635486
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |   1647 MiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      6 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16500 MiB |  16520 MiB |  31138 MiB |  14638 MiB |
|       from large pool |  16472 MiB |  16492 MiB |  31104 MiB |  14632 MiB |
|       from small pool |     28 MiB |     28 MiB |     34 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 235577 KiB | 630835 KiB | 126371 GiB | 126371 GiB |
|       from large pool | 216320 KiB | 628608 KiB | 120421 GiB | 120421 GiB |
|       from small pool |  19257 KiB |  23289 KiB |   5950 GiB |   5950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2660    |    3967    |   60963 K  |   60960 K  |
|       from large pool |     247    |     595    |   26795 K  |   26794 K  |
|       from small pool |    2413    |    3621    |   34168 K  |   34165 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2660    |    3967    |   60963 K  |   60960 K  |
|       from large pool |     247    |     595    |   26795 K  |   26794 K  |
|       from small pool |    2413    |    3621    |   34168 K  |   34165 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     466    |     467    |     829    |     363    |
|       from large pool |     452    |     453    |     812    |     360    |
|       from small pool |      14    |      14    |      17    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     123    |    1242    |   33420 K  |   33420 K  |
|       from large pool |      95    |     303    |   17475 K  |   17475 K  |
|       from small pool |      28    |    1146    |   15944 K  |   15944 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |  16640 KiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  31138 MiB |  29252 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  31104 MiB |  29244 MiB |
|       from small pool |     26 MiB |     28 MiB |     34 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630835 KiB | 126372 GiB | 126372 GiB |
|       from large pool |  24320 KiB | 628608 KiB | 120422 GiB | 120422 GiB |
|       from small pool |      0 KiB |  23357 KiB |   5950 GiB |   5950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   60963 K  |   60963 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3621    |   34168 K  |   34168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   60963 K  |   60963 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3621    |   34168 K  |   34168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     829    |     723    |
|       from large pool |      93    |     453    |     812    |     719    |
|       from small pool |      13    |      14    |      17    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1242    |   33421 K  |   33421 K  |
|       from large pool |       3    |     303    |   17475 K  |   17475 K  |
|       from small pool |       0    |    1146    |   15945 K  |   15945 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 29 14:37:37 2024]
Finished job 0.
1 of 1 steps (100%) done
