Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  1 05:37:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_missing16_2024-08-01_00-27-47/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_missing16_2024-08-01_00-27-47/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979

 Experiment start at: 2024-08-01 06:01:34.814248
before training, model accuracy: 0.13810956478118896
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.73581976, 'precision': 0.52281183, 'recall': 0.53908944, 'specificity': 0.973874, 'f1': 0.49572414, 'auroc': 0.9398139}
confusion matrix:
    0    1   2     3   4    5     6     7     8    9     10
0    3    4   0     6   0   35   335    35    32   10    22
1    2  912   0    22   0   13   251   107    19    1     5
2    0    0   0    17   0   48    93    19    61   63    11
3    0    0   0  7339   0   26     3   707   356    5     1
4    3    0   0     4   0   11   387     4    73   15    41
5    0    0   0    45   0  187     3     0    30  256     0
6    0    1   0     8   0   10  1820    41    27    0     1
7    6    3   0    80   0    5    15  6967   182    0     7
8    4    0   0    60   0    1    71   123  2994    5    36
9    0    2   0    14   0   95    10    14    37  317     3
10  19    1   0     8   0   10  5665    22   102    5  6963
---- Validation: 
scalar performance:
{'acc': 0.7338505, 'precision': 0.51836467, 'recall': 0.53426385, 'specificity': 0.9736748, 'f1': 0.49175185, 'auroc': 0.9391211}
confusion matrix:
    0    1   2     3   4    5     6     7     8    9     10
0    3    0   0     8   0   42   312    50    30   11    27
1    2  910   0    19   0   10   255   114    17    1     4
2    1    2   0    23   0   36    91     7    60   77    15
3    0    0   0  7356   0   15     1   682   380    6     0
4    2    2   0     2   0   13   375     6    71    9    59
5    1    0   0    51   0  178     0     3    30  257     1
6    2    0   0     7   0    8  1822    41    25    1     2
7   10   10   0    78   0    2    16  6964   178    2     5
8    8    0   0    59   0    0    81   133  2986    4    25
9    0    2   0    11   0  104     5    10    58  303     0
10  21    0   0     8   0    7  5734    20    85    8  6913
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5239628, 'precision': 0.38658, 'recall': 0.40725887, 'specificity': 0.9482321, 'f1': 0.36505875, 'auroc': 0.81544626}
confusion matrix:
    0    1   2   3   4    5     6     7     8    9    10
0    1   25   0  16   5  162   607   200    20  117   17
1    3  644   0  68   0  100   457   192    13   13    9
2    1    5   0  66   3   51   434    14   184  174   83
3    0    0   0   0   0    0     0     0     0    0    0
4    0    0   0   0   0    2  1360     1     7    0  263
5    0   15   0   4   0  105     7     3    16  442    0
6    0    1   0   3   1    1  3048     3    10    0    0
7    0    0   0   2   0    2     2  1140    16    1    1
8    0    5   0  15   5    2    77    19  1216   29    2
9    1   16   0  46   0   75    45    25   183  736   10
10   0    0   0   0   0    0  1047     0     0    0  599
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 07:08:53.563027,epoch time: 1:07:18.748779,used: 1:07:18.748779,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9171929, 'precision': 0.69999325, 'recall': 0.6569629, 'specificity': 0.9905567, 'f1': 0.66120076, 'auroc': 0.97093344}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   216     1   0     5   0    0    18    43    58   14    128
1     3  1171   0     9   0   11     1   120     4    3     10
2     2     0   0    37   0    4     8    46     8   93    114
3     1     0   0  7803   0   12     1   428   192    2      1
4     0     0   0     4   0    0    42    18    31   27    417
5     1     0   0    50   0  180     0     3    11  275      1
6     5     0   0     9   0    1  1854    10     7    3     18
7     2     3   0    92   0    1     2  7123    19    2     20
8     1     0   0    68   0    1     3   253  2891    1     76
9     3     0   0    14   0   27     1    18    16  400     14
10   19     0   0    11   0    0    45    31    36    6  12643
---- Validation: 
scalar performance:
{'acc': 0.91619635, 'precision': 0.7018527, 'recall': 0.6557482, 'specificity': 0.9904287, 'f1': 0.66073084, 'auroc': 0.97227204}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   214     0   0     5   0    2    19    49    45   13    136
1     1  1171   0    12   0   11     0   120     6    2      9
2     0     0   0    40   0    2     9    44     8   93    116
3     0     0   0  7778   0   12     1   434   210    5      0
4     7     0   0     4   0    1    38    10    28   14    437
5     1     0   0    50   0  178     0     0    15  276      1
6     5     1   0     5   0    0  1845    15    11    3     23
7     2     3   0    95   0    3     2  7113    33    1     13
8     2     0   0    66   0    0     6   253  2899    2     68
9     2     0   0    18   1   19     0    22    13  401     17
10   16     0   0    10   2    0    54    28    28    5  12653
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64500105, 'precision': 0.4980103, 'recall': 0.51229113, 'specificity': 0.9641921, 'f1': 0.4609009, 'auroc': 0.8512071}
confusion matrix:
     0     1   2   3   4   5     6     7     8    9     10
0   400     0   0  19   0   4    22   248   433   20    24
1     1  1063   0  22   0  66     7   290     8   12    30
2     5     0   0  19   1   2    51   198   219  143   377
3     0     0   0   0   0   0     0     0     0    0     0
4     3     0   0   0   0   0    36     3     9    1  1581
5     1     0   0  35   0  95     2     9    38  412     0
6     1     0   0  22   0   0  2990    20    25    1     8
7     0     0   0   5   0   0     0  1155     0    1     3
8     0     0   0  24   0   1     4    61  1265    9     6
9     1     1   0  25   0  19     4   208   228  609    42
10    0     0   0   0   0   0     4     0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 08:09:29.404006,epoch time: 1:00:35.840979,used: 2:07:54.589758,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9223031, 'precision': 0.7464081, 'recall': 0.67881656, 'specificity': 0.9911362, 'f1': 0.6846055, 'auroc': 0.9830907}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   223     0   0    11   0    0     5    92    11    8    133
1     0  1267   0    13   0    3     7    33     3    0      6
2     0    18   0    80  12    4    38    18     3   99     40
3     0     1   0  8039   0   14     1   299    81    3      0
4     0     0   0    21   9    3   192     6     7    7    294
5     0     0   0    46   0  285     0     0     3  185      1
6     2     2   0    13   0    2  1826     6     7    2     48
7     6    58   0   118   0    1     6  7023    16    5     31
8     1     2   0   143   1    2    11   258  2685    9    181
9     0     3   0    21   0   52     3     4     5  396      9
10    3     1   0    10   1    1    36    12    10    1  12719
---- Validation: 
scalar performance:
{'acc': 0.92283, 'precision': 0.7358627, 'recall': 0.6806237, 'specificity': 0.99122435, 'f1': 0.6837095, 'auroc': 0.983257}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   232     1   0    11   0    2     9    92     2    6    128
1     0  1269   0    16   0    2     5    32     2    0      6
2     1    14   0    86  12    3    43    10     2  109     32
3     0     1   0  8026   0   16     1   309    83    3      1
4     0     0   0    16   7    2   183     5     8   13    305
5     0     0   0    41   0  276     0     0     1  202      1
6    10     3   0    13   0    1  1831     6     4    2     38
7     2    57   0   120   2    1     3  7032    21    2     25
8     2     4   0   127   1    2    12   251  2707    8    182
9     1     2   0    16   0   50     1     5     4  403     11
10    5     3   0     7   0    2    39    11     9    3  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68404114, 'precision': 0.5513916, 'recall': 0.56752276, 'specificity': 0.96788853, 'f1': 0.53239554, 'auroc': 0.8590683}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   589     0   0   30   0    1    23   369    84   52    22
1     0  1369   0   17   0   11    21    58     2   14     7
2    10    16   0  100  25    2   166   115    78  120   383
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    1   0    0   147     1     3    0  1480
5     1     0   0   54   0  233     2     2    14  284     2
6    12    10   0   20   2    1  2873    10     6    1   132
7     0     4   0   14   0    3     0  1132     1    5     5
8     0     1   0   50   1    2     6    58  1216   21    15
9     1    33   0   73   3   33    23   131    81  731    28
10    0     0   0    0   0    0    12     0     0    0  1634
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 09:15:27.990205,epoch time: 1:05:58.586199,used: 3:13:53.175957,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93562716, 'precision': 0.7763748, 'recall': 0.713484, 'specificity': 0.99296576, 'f1': 0.7176051, 'auroc': 0.98253757}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   284     0   0     8   0    1     5    55    53    6     69
1     0  1256   0     6   1    1     1    50    11    0      6
2     0     2   0    45  24    0    15    52    20  140     14
3     0     0   0  8124   0   12     0   147   152    1      0
4     2     0   0    22  42    2   155    15    50    9    242
5     0     0   0    34   0  304     0     0    10  170      2
6     4     0   0     6   0    1  1818    14    27    2     36
7     0     6   0   151   0    0     2  6951   147    3      5
8     0     0   0    63   0    1     3    60  3147    3     19
9     1     1   0    16   0   42     1     5    10  413      4
10   11     0   0    12   2    2    23    20    93    0  12631
---- Validation: 
scalar performance:
{'acc': 0.93574965, 'precision': 0.7781042, 'recall': 0.7160944, 'specificity': 0.99297947, 'f1': 0.7201388, 'auroc': 0.982549}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   290     0   0    11   0    1     5    43    50   10     73
1     0  1247   0    11   0    1     3    57     8    0      5
2     0     5   0    45  26    2    14    56    21  125     18
3     0     1   0  8132   0   14     0   151   141    1      0
4     1     1   1    19  46    3   153    15    49   14    237
5     0     0   0    32   0  304     0     0     8  176      1
6     5     0   0     6   0    0  1829    12    27    1     28
7     0     9   0   166   0    0     2  6947   134    3      4
8     0     0   0    69   2    2     1    49  3148    1     24
9     0     1   0    15   0   40     2     8     7  420      0
10    7     0   0    11   1    1    27    17   111    1  12620
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64751977, 'precision': 0.53183067, 'recall': 0.5327543, 'specificity': 0.9643173, 'f1': 0.49166363, 'auroc': 0.8485408}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   576     0   0  21   0    4    41   211   271   34    12
1     3  1072   0  29   1    3    10   294    40    3    44
2     7     0   0  23  20    8   134   125   432   73   193
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   0   1    0    37     2    38    0  1553
5     1     0   0  59   0  236     5     3    50  238     0
6     1     0   0  10   0    0  2813     4   197    0    42
7     0     0   0   6   0    0     0  1136    19    0     3
8     0     0   0  21   0    0     0     0  1347    2     0
9     2     1   0  51   5   30    11   198   386  431    22
10    0     0   0   0   0    0     2     0     1    0  1643
better model found
persisted
after epoch: 4,now: 2024-08-01 10:35:22.199831,epoch time: 1:19:54.209626,used: 4:33:47.385583,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93835616, 'precision': 0.83442307, 'recall': 0.7192217, 'specificity': 0.993255, 'f1': 0.7377904, 'auroc': 0.9908782}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   291     0   0     1    1    0    17    73     1    1     97
1     0  1279   0     9    0    0     5    31     5    1      2
2     1     7   5   110  101    0    24    22    11   27      4
3     0     1   0  8186    0   29     1   120    95    4      1
4     2     0   0     9  137    1   218     3    11    0    158
5     0     2   0    22    1  343     1     0     6  143      3
6     4     0   0     2    0    1  1874     7     2    0     18
7     0    11   0   124    3    0     2  7071    42    0     11
8     1     0   0    79    9    5    11   124  3001    4     62
9     3     2   2   100    9   53     5    11     9  295      4
10    5     0   0     7    9    1   153    15    11    1  12590
---- Validation: 
scalar performance:
{'acc': 0.9377825, 'precision': 0.82934284, 'recall': 0.7162354, 'specificity': 0.99319124, 'f1': 0.73443574, 'auroc': 0.99044776}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   288     0   0     2    0    1    16    79     2    1     94
1     1  1274   0    10    2    1     2    34     5    0      3
2     1     9   5   111  111    1    20    20     9   21      4
3     0     0   0  8191    0   28     3   134    82    0      2
4     2     1   0    10  123    1   228     5     8    1    160
5     1     2   0    20    0  347     0     0     4  146      1
6     9     1   0     4    0    0  1873     5     0    0     16
7     0    11   0   133    4    0     2  7066    42    0      7
8     1     0   0    70   15    0    14   132  2999    3     62
9     1     1   2   101    6   51     4    17    10  294      6
10    8     1   0     9   11    1   146    10    11    0  12599
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6927867, 'precision': 0.62436205, 'recall': 0.5820569, 'specificity': 0.9683314, 'f1': 0.5511731, 'auroc': 0.8663864}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   933     0   0    4    1    3    27   162    25    8     7
1     0  1276   0   20    0    4     8   170     7    6     8
2    12    10   4   53  249    6   268    83   242   45    43
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    0   18    0   520     2    10    0  1081
5     5     2   0   54    0  354    10     2     9  156     0
6    16     1   0   12    2    0  2998     8     9    1    20
7     0     0   0   53    0    0     0  1107     0    1     3
8     0     0   0  113    0    7    17    16  1211    5     1
9    25    36   1  125   39   84    16   130   254  415    12
10    0     0   0    0    0    0    60     0     0    0  1586
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-01 12:09:22.167699,epoch time: 1:33:59.967868,used: 6:07:47.353451,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9421821, 'precision': 0.87110883, 'recall': 0.7252966, 'specificity': 0.9935798, 'f1': 0.7409214, 'auroc': 0.98722816}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   318     0   0     5   1    0     0    83    12    1     63
1     0  1267   0    10   0    0     4    46     3    0      2
2     0     1   1   111  63    1    14    38    15   55     13
3     0     1   0  8212   0    6     0   137    79    0      0
4     1     0   0    13  81    1   182    10    25   11    215
5     0     0   0    53   0  409     0     1     6   51      1
6    11     1   0    11   0    0  1845     7    14    0     19
7     1     8   0   121   1    0     1  7076    52    0      3
8     1     0   0   117   2    0     3   116  3033    1     23
9     2     2   0    31   1  116     3    24    12  298      4
10   11     1   0    12   4    1    20    16    53    1  12675
---- Validation: 
scalar performance:
{'acc': 0.94278455, 'precision': 0.8165279, 'recall': 0.7276529, 'specificity': 0.9936613, 'f1': 0.7421677, 'auroc': 0.98736566}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   320     0   0     5   0    1     2    80    15    2     58
1     0  1268   0     7   0    0     2    47     5    0      3
2     1     2   2   106  63    2    18    38    11   62      7
3     0     0   0  8213   0    9     0   141    77    0      0
4     3     1   1    14  73    0   190     9    29   10    209
5     0     0   0    54   0  407     0     0     8   51      1
6    10     2   0     9   0    0  1841     9     9    1     27
7     0     8   0   129   0    0     2  7078    43    0      5
8     1     0   0   101   1    1     2   102  3064    0     24
9     0     1   2    29   1  102     1    23    18  313      3
10   11     1   0    10   3    1    25    15    63    0  12667
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6733366, 'precision': 0.630841, 'recall': 0.56514084, 'specificity': 0.96709406, 'f1': 0.5283113, 'auroc': 0.8584407}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   805     1   0   10   0    5     7   220    98   18     6
1     0  1268   0   33   1    1     8   173     6    0     9
2    12     4   1   85  96    9   234    92   258   53   171
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    0   1    0    83     3    15    0  1530
5     2     0   0   98   0  371     2     3    18   97     1
6     3     0   0   84   0    0  2894     4    32    0    50
7     0     0   0   66   0    0     0  1094     1    0     3
8     0     0   0  100   0    1     1     8  1258    1     1
9     4    13   0  181  21  131    11   215   252  290    19
10    0     0   0    0   0    0     4     0     0    0  1642
better model found
persisted
after epoch: 6,now: 2024-08-01 13:37:43.017498,epoch time: 1:28:20.849799,used: 7:36:08.203250,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9362425, 'precision': 0.89657605, 'recall': 0.74110174, 'specificity': 0.9927927, 'f1': 0.75438297, 'auroc': 0.9911111}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   335     0   0     2    0    0     2    57     0    0     87
1     0  1293   0     5    0    0     1    29     1    1      2
2     1     3   1   176   23    1     2    12     1   74     18
3     0     2   0  7691    0   16     0   566   162    2      0
4     2     0   0    49  106    1   131     4     1    3    242
5     0     0   0    19    0  349     0     0     4  146      2
6     3     0   0     2    1    0  1862     6     1    0     32
7     0    23   0    30    0    0     3  7159    37    2     10
8     0     2   0    42    7    1     4   111  3052    4     73
9     0     1   0    27    1   41     2     3     6  405      7
10    5     0   0    12    2    0    17    10     4    1  12740
---- Validation: 
scalar performance:
{'acc': 0.9354286, 'precision': 0.80291444, 'recall': 0.73952544, 'specificity': 0.99271554, 'f1': 0.7516494, 'auroc': 0.9914045}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   327     0   0     1    0    0     1    55     0    2     97
1     0  1286   0     7    0    0     1    32     2    0      4
2     1     2   0   175   23    1     2    12     1   79     16
3     0     3   0  7694    0   23     0   560   157    2      1
4     1     0   0    40  108    2   133     3     5    6    241
5     0     0   0    17    0  357     0     1     4  139      3
6     3     0   0     2    0    0  1866     9     2    1     25
7     1    23   0    36    1    0     2  7159    34    1      8
8     0     4   0    41    5    1     6   117  3044    3     75
9     0     2   0    30    0   48     0     6     4  401      2
10   10     0   0    12    2    0    21    12     9    1  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7004827, 'precision': 0.6013361, 'recall': 0.5735637, 'specificity': 0.96978176, 'f1': 0.5380056, 'auroc': 0.8738756}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   779     4   0    3   0    1    24   248    61   21    29
1     0  1329   0   14   0    8     3   122     8    2    13
2     2    11   2  216  96    1    82   101   210   72   222
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    3  10    0    91     3     9    0  1516
5     2     0   0   50   0  192     4     8    35  297     4
6     0     0   0    8   1    0  3036     5    12    0     5
7     0     0   0    0   0    0     0  1159     2    1     2
8     0     0   0   15   0    0     3    17  1330    2     3
9     1    24   3  115   3   26     3   186   211  539    26
10    0     0   0    0   0    0     9     0     1    0  1636
new oracle model saved
early stop counter: 1
val acc:0.9354286193847656, best validation acc: 0.9427845478057861, corresponding to test acc:                         0.6733366250991821 / 0.7004827260971069
after epoch: 7,now: 2024-08-01 15:06:31.325398,epoch time: 1:28:48.307900,used: 9:04:56.511150,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94648975, 'precision': 0.8473629, 'recall': 0.74801826, 'specificity': 0.99423045, 'f1': 0.7592704, 'auroc': 0.98908013}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   382     1   0     0   0    0     9    19    11    0     61
1     0  1247   0     3   0    0     5    63    12    0      1
2     2     1  15    71  76    0    20    61    22   41      3
3     0     0   0  8148   0    9     2   168   111    0      0
4     1     3   1     2  70    1   245     9    40    2    165
5     0     0   0    21   0  430     2     0     6   60      2
6     2     0   0     0   1    0  1885     2     4    0     14
7     1     5   0    79   0    0     1  7108    66    0      5
8     1     0   0    35   2    0     4    60  3179    0     14
9     4     2   4    23   2   97     7    25    24  303      2
10    9     1   0    11   2    0    79    15    65    0  12609
---- Validation: 
scalar performance:
{'acc': 0.9452989, 'precision': 0.8463669, 'recall': 0.7488709, 'specificity': 0.99410737, 'f1': 0.7604521, 'auroc': 0.989975}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   388     0   0     2   0    0    11    18     8    0     56
1     0  1248   0     5   0    0     2    65     8    0      4
2     0     3  16    59  84    1    15    64    23   40      7
3     0     0   0  8125   0    9     3   190   113    0      0
4     2     4   0     4  72    0   254     7    32    1    163
5     0     1   0    23   0  434     2     0     5   54      2
6     4     0   0     1   1    0  1888     2     4    0      8
7     0     4   0    79   0    0     2  7103    73    0      4
8     0     0   0    48   2    1    10    70  3156    0      9
9     2     2   5    14   7   92     6    35    27  299      4
10   11     1   0     8   5    1    70    19    70    0  12611
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66682994, 'precision': 0.60666096, 'recall': 0.5460613, 'specificity': 0.96540153, 'f1': 0.50657713, 'auroc': 0.852252}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   802     0   0    5    0    5   157    75    51    3    72
1     0  1162   0   27    0    0     5   277    19    1     8
2     2     4   7   33  121    3   334    88   345   21    57
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    1    9    0   427     3    19    0  1173
5     5     2   0  101    0  296    57     1    41   88     1
6     0     0   0    3    0    0  3060     2     2    0     0
7     0     0   0   32    0    0     4  1123     3    0     2
8     0     0   0   29    0    0    13     3  1322    2     1
9     8     8   2  103   26   69    89   160   491  158    23
10    0     0   0    0    0    0    53     0     1    0  1592
better model found
persisted
after epoch: 8,now: 2024-08-01 16:34:09.548652,epoch time: 1:27:38.223254,used: 10:32:34.734404,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94611514, 'precision': 0.7746802, 'recall': 0.7315461, 'specificity': 0.9940602, 'f1': 0.7389476, 'auroc': 0.9947646}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   313     0   0     0   0    5    17     6     0    1    141
1     0  1277   0    11   0    0     4    37     1    0      2
2     0     0   0   141  62    1    26    14     2   63      3
3     0     0   0  8245   0   24     2    86    79    2      0
4     0     1   0    13  51    1   301     3     2    1    166
5     0     0   0    16   0  380     0     0     2  121      2
6     1     0   0     2   0    1  1879     3     1    0     20
7     1     9   0    96   0    0     3  7113    33    0      8
8     0     0   0    81   1    1    26    88  3044    4     48
9     0     0   1    35   2   58     7     8     2  374      6
10    2     0   0     8   4    0    74    11     9    1  12686
---- Validation: 
scalar performance:
{'acc': 0.9470376, 'precision': 0.7787751, 'recall': 0.7335737, 'specificity': 0.9941547, 'f1': 0.74173445, 'auroc': 0.994143}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   299     0   0     3   0    2    16     7     1    0    155
1     0  1278   0    15   0    0     3    35     1    0      0
2     0     0   0   146  69    2    21     9     3   57      5
3     1     0   0  8260   0   23     2    82    68    4      0
4     0     0   0    10  57    0   304     3     3    3    159
5     0     0   1    20   0  380     1     0     1  117      1
6     1     0   0     1   0    0  1878     2     3    0     23
7     1     8   0    94   0    0     2  7123    26    3      8
8     1     1   0    77   3    1    28    88  3051    4     42
9     1     0   0    34   1   49     8     6     1  392      1
10    2     0   0    10   1    1    79     9     7    0  12687
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6680893, 'precision': 0.5534849, 'recall': 0.54816204, 'specificity': 0.9658867, 'f1': 0.5218829, 'auroc': 0.87384796}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   459     0   0    4    0   34   130    33     1   19   490
1     0  1268   0   27    0   10     5   175     3    0    11
2     2     0   0  166  154   10   348    82    96   45   112
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    2    4    0   301     1     3    0  1322
5     0     0   0   66    0  306    18     1     8  190     3
6     0     0   0    7    0    0  3041     3     2    0    14
7     0     0   0   19    0    1     1  1140     0    0     3
8     0     0   0   66    1    2    35    17  1244    2     3
9     1     6   0  213   13   99    28   165   121  461    30
10    0     0   0    0    0    0    20     0     0    0  1626
better model found
persisted
after epoch: 9,now: 2024-08-01 17:28:05.668045,epoch time: 0:53:56.119393,used: 11:26:30.853797,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9511451, 'precision': 0.8169556, 'recall': 0.75941145, 'specificity': 0.9945558, 'f1': 0.7729614, 'auroc': 0.99189854}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   347     1   0     7    0    2    12    16    11    4     83
1     0  1287   0    12    0    0     3    23     7    0      0
2     0     1   0   131   28    0     2    31     8  108      3
3     0     1   0  8288    0    1     2   112    34    0      0
4     3     0   0    44  141    0   135     8    20    9    179
5     0     0   0    48    0  397     0     0     2   73      1
6     2     0   0     2    1    1  1887     1     3    0     11
7     0    10   0    96    1    0     3  7108    37    1      6
8     1     0   0   142    1    0     3    84  3046    1     17
9     0     0   0    19    0   72     0     7     9  385      1
10    9     0   0    13    2    0    45    25    33    2  12664
---- Validation: 
scalar performance:
{'acc': 0.9515046, 'precision': 0.90949094, 'recall': 0.7588651, 'specificity': 0.9945914, 'f1': 0.7742876, 'auroc': 0.99116087}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   345     0   0     4    0    1    14    22    13    3     81
1     0  1288   0    12    0    0     1    25     6    0      0
2     0     1   1   139   24    2     5    21     6  110      3
3     0     0   0  8290    0    3     4   103    40    0      0
4     0     0   0    45  153    0   129     9    18    7    178
5     0     0   0    58    0  376     0     0     2   84      1
6     1     0   0     1    0    0  1885     2     4    0     15
7     0     9   0    95    1    0     3  7119    32    0      6
8     1     0   0   144    1    0     1    76  3052    2     19
9     0     1   0    20    0   72     1     4     5  390      0
10    4     0   0    14    8    1    34    14    46    2  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6328273, 'precision': 0.5540673, 'recall': 0.5060764, 'specificity': 0.96334463, 'f1': 0.48485416, 'auroc': 0.8433332}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   484     2   0   23   0   41   127    61    27   54   351
1     0  1270   0   51   0    0     3   159     8    0     8
2     3     0   0  208  53   14    90   139   340   66   102
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    7  26    0   224     4    14    0  1356
5     0     0   0  315   0  224     5     0     2   45     1
6     0     0   0   52   0    0  2986     5    12    0    12
7     0     0   0   61   0    0     4  1097     0    0     2
8     0     0   0  246   0    0     5    16  1102    0     1
9     3     6   0  404   1  122     6   137   213  234    11
10    0     0   0    1   0    0    23     0     0    0  1622
better model found
persisted
after epoch: 10,now: 2024-08-01 18:20:28.570942,epoch time: 0:52:22.902897,used: 12:18:53.756694,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 12:18:53.756694 at 2024-08-01 18:20:28.570942
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6328273, 'precision': 0.5540673, 'recall': 0.5060764, 'specificity': 0.96334463, 'f1': 0.48485416, 'auroc': 0.8433332}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   484     2   0   23   0   41   127    61    27   54   351
1     0  1270   0   51   0    0     3   159     8    0     8
2     3     0   0  208  53   14    90   139   340   66   102
3     0     0   0    0   0    0     0     0     0    0     0
4     2     0   0    7  26    0   224     4    14    0  1356
5     0     0   0  315   0  224     5     0     2   45     1
6     0     0   0   52   0    0  2986     5    12    0    12
7     0     0   0   61   0    0     4  1097     0    0     2
8     0     0   0  246   0    0     5    16  1102    0     1
9     3     6   0  404   1  122     6   137   213  234    11
10    0     0   0    1   0    0    23     0     0    0  1622
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7004827, 'precision': 0.6013361, 'recall': 0.5735637, 'specificity': 0.96978176, 'f1': 0.5380056, 'auroc': 0.8738756}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   779     4   0    3   0    1    24   248    61   21    29
1     0  1329   0   14   0    8     3   122     8    2    13
2     2    11   2  216  96    1    82   101   210   72   222
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    3  10    0    91     3     9    0  1516
5     2     0   0   50   0  192     4     8    35  297     4
6     0     0   0    8   1    0  3036     5    12    0     5
7     0     0   0    0   0    0     0  1159     2    1     2
8     0     0   0   15   0    0     3    17  1330    2     3
9     1    24   3  115   3   26     3   186   211  539    26
10    0     0   0    0   0    0     9     0     1    0  1636
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_06_01_34_seed_0_23919979_instance_wise_predictions.txt
accuracy from prediction file 0.6328272580983698
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_missing16_2024-08-01_00-27-47/rule_results/0.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_missing16_2024-08-01_00-27-47/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_missing16_2024-08-01_00-27-47/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15860 MiB | 396386 GiB | 396384 GiB |
|       from large pool |   1652 MiB |  15835 MiB | 393430 GiB | 393428 GiB |
|       from small pool |      7 MiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15860 MiB | 396386 GiB | 396384 GiB |
|       from large pool |   1652 MiB |  15835 MiB | 393430 GiB | 393428 GiB |
|       from small pool |      7 MiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB | 395306 GiB | 395305 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 392353 GiB | 392352 GiB |
|       from small pool |      6 MiB |     26 MiB |   2952 GiB |   2952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16492 MiB |  16492 MiB |  16492 MiB |      0 B   |
|       from large pool |  16464 MiB |  16464 MiB |  16464 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 396089 KiB | 694703 KiB |  86046 GiB |  86045 GiB |
|       from large pool | 376832 KiB | 692736 KiB |  83073 GiB |  83072 GiB |
|       from small pool |  19257 KiB |  22941 KiB |   2973 GiB |   2973 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2660    |    3967    |   30482 K  |   30480 K  |
|       from large pool |     247    |     595    |   13474 K  |   13473 K  |
|       from small pool |    2413    |    3621    |   17008 K  |   17006 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2660    |    3967    |   30482 K  |   30480 K  |
|       from large pool |     247    |     595    |   13474 K  |   13473 K  |
|       from small pool |    2413    |    3621    |   17008 K  |   17006 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     466    |     466    |     466    |       0    |
|       from large pool |     452    |     452    |     452    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     126    |    1245    |   16532 K  |   16531 K  |
|       from large pool |      98    |     307    |    8553 K  |    8553 K  |
|       from small pool |      28    |    1146    |    7978 K  |    7978 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 396386 GiB | 396386 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 393430 GiB | 393430 GiB |
|       from small pool |      0 KiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 396386 GiB | 396386 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 393430 GiB | 393430 GiB |
|       from small pool |      0 KiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 395306 GiB | 395306 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 392353 GiB | 392353 GiB |
|       from small pool |      0 KiB |     26 MiB |   2952 GiB |   2952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2046 MiB |  16492 MiB |  16492 MiB |  14446 MiB |
|       from large pool |   2020 MiB |  16464 MiB |  16464 MiB |  14444 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 694703 KiB |  86047 GiB |  86047 GiB |
|       from large pool |  24320 KiB | 692736 KiB |  83074 GiB |  83074 GiB |
|       from small pool |      0 KiB |  24786 KiB |   2973 GiB |   2973 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13474 K  |   13474 K  |
|       from small pool |       0    |    3621    |   17008 K  |   17008 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13474 K  |   13474 K  |
|       from small pool |       0    |    3621    |   17008 K  |   17008 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     110    |     466    |     466    |     356    |
|       from large pool |      97    |     452    |     452    |     355    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1245    |   16532 K  |   16532 K  |
|       from large pool |       3    |     307    |    8553 K  |    8553 K  |
|       from small pool |       0    |    1146    |    7979 K  |    7979 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 396386 GiB | 396386 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 393430 GiB | 393430 GiB |
|       from small pool |      0 KiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 396386 GiB | 396386 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 393430 GiB | 393430 GiB |
|       from small pool |      0 KiB |     26 MiB |   2956 GiB |   2956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 395306 GiB | 395306 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 392353 GiB | 392353 GiB |
|       from small pool |      0 KiB |     26 MiB |   2952 GiB |   2952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2046 MiB |  16492 MiB |  16492 MiB |  14446 MiB |
|       from large pool |   2020 MiB |  16464 MiB |  16464 MiB |  14444 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 694703 KiB |  86047 GiB |  86047 GiB |
|       from large pool |  24320 KiB | 692736 KiB |  83074 GiB |  83074 GiB |
|       from small pool |      0 KiB |  24786 KiB |   2973 GiB |   2973 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13474 K  |   13474 K  |
|       from small pool |       0    |    3621    |   17008 K  |   17008 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   30482 K  |   30482 K  |
|       from large pool |       2    |     595    |   13474 K  |   13474 K  |
|       from small pool |       0    |    3621    |   17008 K  |   17008 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     110    |     466    |     466    |     356    |
|       from large pool |      97    |     452    |     452    |     355    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1245    |   16532 K  |   16532 K  |
|       from large pool |       3    |     307    |    8553 K  |    8553 K  |
|       from small pool |       0    |    1146    |    7979 K  |    7979 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979

 Experiment start at: 2024-08-01 18:48:20.147979
before training, model accuracy: 0.03799062594771385
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8232823, 'precision': 0.4838842, 'recall': 0.5606751, 'specificity': 0.98166454, 'f1': 0.5050608, 'auroc': 0.90092576}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   214     2   0     9   0   14   229     1     3   0     11
1     8  1146   0    62   4   12    15    73     8   0      4
2    56    13   0    11   0   87    60     8     4   0     73
3     9     2   1  8181   1   31    13    60   139   0      1
4    17    38   0     9   0  159    94     2    34   0    186
5    30     1   3    53   0  278   106     1    36   0     13
6     9     4   0     8   0   34  1842     2     5   0      4
7    74    16  10  1292   1   50    36  5668    96   0     20
8     4     0   1   353   1  352    39    21  2505   0     20
9   130    16   0    14   0  129   144     4     8   0     48
10  103   622  23    12   0  507   489    21    77   0  10937
---- Validation: 
scalar performance:
{'acc': 0.82078373, 'precision': 0.48263478, 'recall': 0.55947113, 'specificity': 0.98143345, 'f1': 0.5033294, 'auroc': 0.90087354}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   210     2   0     7   0   12   233     1     5   0     13
1     6  1158   0    52   3   13    15    76     5   0      4
2    61    17   0    11   0   85    60    10    10   0     58
3     5     1   1  8180   0   30    13    64   144   0      2
4    10    39   0     8   0  172    90     2    25   0    193
5    34     0   1    58   0  278   102     1    33   0     14
6    10     6   1     4   0   48  1829     0     7   0      3
7    93    14  12  1302   2   61    40  5630    96   0     15
8     9     1   1   348   0  348    34    15  2515   0     25
9   122    10   0    14   0  132   145     6    10   0     54
10   95   619  34    10   0  546   508    29    70   0  10885
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55425733, 'precision': 0.3743763, 'recall': 0.41650334, 'specificity': 0.95367956, 'f1': 0.37628755, 'auroc': 0.7557994}
confusion matrix:
     0     1   2    3   4    5     6    7    8   9     10
0   787     0   0    7   0    0   372    3    1   0     0
1   136  1036   0   54   6   10   101  148    2   0     6
2   234    28   1   10   0  175   419    6   51   0    91
3     0     0   0    0   0    0     0    0    0   0     0
4    28   150   0    0   0  145   157    2   24   0  1127
5   231     3   1   16   0   75   257    2    3   0     4
6     6     1   0    0   0   60  2987    0   12   0     1
7   228     1   4  239   0    0    42  647    2   0     1
8    47     0  10   64   0  174   184    0  890   0     1
9   550    16   2   42   0  130   353    1   13   0    30
10    1   100   0    0   0   11    31    0    4   0  1499
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-01 20:02:12.281143,epoch time: 1:13:52.133164,used: 1:13:52.133164,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9054741, 'precision': 0.627118, 'recall': 0.6349827, 'specificity': 0.9892342, 'f1': 0.6178619, 'auroc': 0.92288905}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   416     0   0    14   0    0     4    16     0   0     33
1     0  1248   2    20   0    0     0    56     4   0      2
2    72     2  10    19   0   13     4    59    18   0    115
3     3     1   1  8219   0    4     0   146    64   0      0
4    24     6   4    44   0    9     3    14    34   0    401
5    49     0   3    69   0  303    26     3    48   0     20
6   121    35   1    31   0   12  1668     9     5   0     26
7     3    25   6   381   0    0     1  6811    24   0     11
8     5     1  16   429   0    3     0   124  2668   0     49
9   196     2   6    34   0   72    20    32    24   0    107
10   89    17   4   110   0    5     5    40    23   0  12500
---- Validation: 
scalar performance:
{'acc': 0.9046409, 'precision': 0.640049, 'recall': 0.6381583, 'specificity': 0.9891531, 'f1': 0.6234015, 'auroc': 0.9223079}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   417     2   1    19   0    0     1    12     2   0     29
1     0  1247   3    24   0    0     0    54     2   0      2
2    82     1  22    21   0    9     5    50    13   0    109
3     1     1   0  8228   0    3     1   147    59   0      0
4    28     7   4    47   0    6     4    13    35   0    395
5    48     1   1    72   0  307    19     5    44   0     24
6   110    33   0    39   0   12  1665     7     8   0     34
7     4    20   4   400   0    0     1  6800    27   0      9
8     3     1  22   463   0    5     0   129  2638   0     35
9   209     5   5    40   0   69    25    24    21   0     95
10   96    10   8   111   0    4     5    37    29   0  12496
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5822431, 'precision': 0.43396327, 'recall': 0.4770369, 'specificity': 0.9586264, 'f1': 0.42352995, 'auroc': 0.7709713}
confusion matrix:
      0     1   2    3   4    5     6    7     8   9     10
0   1027     2   1   91   0    0     4   43     1   0     1
1     15  1264  16   55   0    0     0  135     1   0    13
2    297     7  26  116   0   18     5   61   123   0   362
3      0     0   0    0   0    0     0    0     0   0     0
4     14     3   1    6   0    1     1    3    12   0  1592
5    260     0   1  127   0   84    27   20    26   0    47
6    269    71   0   56   0  207  2199   12   101   0   152
7     10     0   0  174   0    0     0  977     0   0     3
8      8     0   0  241   0   12     1    3  1102   0     3
9    542     9  42  230   0   29    20   68   103   0    94
10     0     0   0    1   0    0     1    1     0   0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-01 21:13:35.054600,epoch time: 1:11:22.773457,used: 2:25:14.906621,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90614295, 'precision': 0.63751256, 'recall': 0.6537555, 'specificity': 0.9893533, 'f1': 0.6341021, 'auroc': 0.9369049}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   440     2    0     1   0    0    10     6     0   0     24
1     1  1279    3    13   0    0     3    31     1   0      1
2    95     2   59     0   0    1     2    61     1   0     91
3    14     3    7  8078   0   10    12   246    67   0      1
4    18     4   21     3   0    2     1    30     2   0    458
5    52    15    0    24   0  296    21     9    36   0     68
6    25     7    0     0   0    0  1857     3     0   0     15
7    11    14   18   173   0    0    13  7023     3   0      9
8    13    13  254   257   0   28    25   286  2242   0    177
9   238    10   15     5   0   26     7    55     6   0    131
10   68    13   29     7   0    1    18    59     3   0  12594
---- Validation: 
scalar performance:
{'acc': 0.9064063, 'precision': 0.63972855, 'recall': 0.65809715, 'specificity': 0.98937154, 'f1': 0.63773155, 'auroc': 0.93529195}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   441     2    0     1   0    0     8     7     0   0     24
1     0  1282    6    14   0    0     2    27     0   0      1
2    82     3   67     0   0    2     4    62     2   0     90
3    11     4    3  8086   0   13    20   247    53   0      3
4    26     5   23     1   0    3     3    19     2   0    457
5    59    14    1    27   0  302    23     8    33   0     54
6    30     5    0     1   0    0  1856     3     0   0     13
7    13    25   16   182   0    0     6  7010     6   0      7
8    10    13  226   271   0   22    32   261  2280   0    181
9   230    14   18     7   0   28     7    46     5   0    138
10   68    13   28    12   0    0    16    95     2   0  12562
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64800954, 'precision': 0.4929604, 'recall': 0.5174785, 'specificity': 0.96462756, 'f1': 0.46672788, 'auroc': 0.8010706}
confusion matrix:
      0     1    2    3   4   5     6    7     8   9     10
0   1145     1    1    3   0   0    10    7     1   0     2
1     12  1286   15   25   0   0    11  143     0   0     7
2    194    18  190    4   0   5     6  122    53   0   423
3      0     0    0    0   0   0     0    0     0   0     0
4      4     2    6    0   0   0     1    6     2   0  1612
5    223     3    0   30   0  73    12   51    29   0   171
6     39    50    0    0   0   4  2890    4     1   0    79
7     16     0    0  221   0   0     1  923     0   0     3
8     31     3   35   94   0  22    31   16  1113   0    25
9    530    13  179   23   0  16    15  146    45   0   170
10     0     0    0    0   0   0     0    4     0   0  1642
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-01 22:22:10.377949,epoch time: 1:08:35.323349,used: 3:33:50.229970,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9236676, 'precision': 0.65986466, 'recall': 0.67642474, 'specificity': 0.99153364, 'f1': 0.65693647, 'auroc': 0.9475887}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   435     0   0     5   0    0     5     6     1   0     31
1     0  1283   2    13   0    1     1    28     2   0      2
2    82     1  70     3   0    1     3   103    14   0     35
3     4     1   0  8218   0    2     5   123    84   0      0
4    28     4  24     3   0    5     2    35    43   0    395
5    68     0   1    47   0  301    36     5    47   0     16
6    25     2   0     5   0    5  1851     3     2   0     15
7     6    16   2   262   0    1     3  6937    30   0      5
8     3     4  16   156   0   20     3    99  2971   0     23
9   285     3  14     9   0   46    15    75    14   0     32
10   70     2  38    15   0   21    10   122    59   0  12457
---- Validation: 
scalar performance:
{'acc': 0.92323124, 'precision': 0.65601367, 'recall': 0.67157304, 'specificity': 0.9915171, 'f1': 0.6518731, 'auroc': 0.9480825}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   436     0   0     4   0    1     6    11     0   0     25
1     0  1285   3    19   0    0     1    21     2   0      1
2    84     3  66     1   0    2     2   103    17   0     34
3     4     1   1  8230   0    2     3   120    79   0      0
4    25     8  23     3   0    7     4    46    42   0    381
5    61     0   3    50   0  277    48    12    59   0     11
6    21     0   0     7   0    4  1857     3     4   0     12
7     5    24   3   261   0    0     2  6929    36   0      5
8     3     2   7   168   0   25     3    96  2967   0     25
9   293     2  11    11   0   44    15    71    15   0     31
10   72     8  42    13   0   19    15   107    52   0  12468
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6007836, 'precision': 0.43984187, 'recall': 0.48153314, 'specificity': 0.9604374, 'f1': 0.4295097, 'auroc': 0.7958062}
confusion matrix:
      0     1   2    3   4    5     6    7     8   9     10
0   1104     1   1   26   0    0    10   22     5   0     1
1      2  1193  25   57   0    0     2  200     5   0    15
2    127     5  76   38   1   26     1  140   241   0   360
3      0     0   0    0   0    0     0    0     0   0     0
4      3     0   3    0   0   14     1    8    19   0  1585
5    157     0   0  139   0   67     9   64    65   0    91
6     96     2   1   23   0  235  2516   10   121   0    63
7      4     0   0  380   0    0     1  774     1   0     4
8      6     0   0  142   0    5     2    1  1212   0     2
9    384     4  61  188   0   15     9  219   125   0   132
10     0     0   0    0   0    0     0    0     1   0  1645
better model found
persisted
after epoch: 4,now: 2024-08-01 23:28:05.998755,epoch time: 1:05:55.620806,used: 4:39:45.850776,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.91665775, 'precision': 0.64207435, 'recall': 0.7166279, 'specificity': 0.99127, 'f1': 0.67078924, 'auroc': 0.93625486}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   417     3    1     5   0    1    40     3     4   0      9
1     0  1222   11    10   0    1     1    81     6   0      0
2    44     7  176     0   0    1     9    69     4   0      2
3     8     0    2  8094   0   11     4   160   157   0      0
4    25    21  175     0   0    8    14    70    22   0    204
5    10     1    4     8   0  400    48     4    45   0      1
6     9     1    2     2   0    0  1883     1     6   0      4
7     5     3    8   187   0    0     2  7000    55   0      3
8    11    11   48    82   0    5     2    96  3029   0     12
9   133     5   63     1   0   94   125    49    19   0      4
10   71    89  196    10   0   17    55   273    42   0  12040
---- Validation: 
scalar performance:
{'acc': 0.9162498, 'precision': 0.6395028, 'recall': 0.7135601, 'specificity': 0.99125326, 'f1': 0.6677242, 'auroc': 0.9363303}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   423     7    1     2   0    2    30     4     3   0     11
1     0  1219    7     8   0    0     2    86     9   0      1
2    45     7  164     0   0    2     5    81     7   0      1
3     5     1    0  8112   0   17     6   144   155   0      0
4    25    24  181     0   0    7     8    72    23   0    199
5     9     0    7     5   0  398    52     2    47   0      1
6    12     0    0     1   0    1  1887     1     1   0      5
7     6     5    6   186   0    1     3  6998    57   0      3
8    11    14   48    82   0    5     7   103  3014   0     12
9   130     8   65     0   0   82   142    48    18   0      0
10  102    83  206     9   0   12    50   254    41   0  12039
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.649129, 'precision': 0.4876927, 'recall': 0.53253907, 'specificity': 0.96449757, 'f1': 0.4895946, 'auroc': 0.8284909}
confusion matrix:
      0    1    2    3   4    5     6    7     8   9     10
0   1064    2    1    7   0    0    80   15     1   0     0
1     27  962   82   17   0    2     9  381    10   0     9
2    162   78  262    1   0   13    32  176   137   0   154
3      0    0    0    0   0    0     0    0     0   0     0
4      5    2   13    0   0    1     3   20    12   0  1577
5     83    2    0   21   0  289   166    1    24   0     6
6      3    0    0    0   0   14  3037    1     8   0     4
7     17    0    2  385   0    0     4  750     2   0     4
8      5    0    7   34   0   22    23    6  1271   0     2
9    456   24  158   13   0   56   175  145    96   0    14
10     0    0    1    0   0    1     0    0     1   0  1643
new oracle model saved
early stop counter: 1
val acc:0.9162498116493225, best validation acc: 0.9232312440872192, corresponding to test acc:                         0.6007835865020752 / 0.6491289734840393
after epoch: 5,now: 2024-08-02 00:19:39.947621,epoch time: 0:51:33.948866,used: 5:31:19.799642,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93244326, 'precision': 0.6846261, 'recall': 0.6789553, 'specificity': 0.9923467, 'f1': 0.6640349, 'auroc': 0.9440694}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   417     7   0     3   0    1    20     7     5   0     23
1     0  1298   0    11   0    0     1    17     5   0      0
2    76     1  39     1   0    7     6    99    13   0     70
3     0     3   0  8220   0    7     1   139    68   0      0
4    10     6   7     0   0    4     5    19    27   0    461
5     4     3   0    25   0  352    18     2   108   0      9
6     7     1   0    11   0    6  1873     0     3   0      7
7     0    44   3   205   0    0     1  6927    72   0     11
8     2     3   3   116   0    5     0    50  3069   0     48
9   135    26   6     6   0  143    44    44    27   0     61
10   23    13   3    14   0    4    23    26    30   0  12656
---- Validation: 
scalar performance:
{'acc': 0.9322188, 'precision': 0.6863952, 'recall': 0.6773857, 'specificity': 0.9922906, 'f1': 0.66510135, 'auroc': 0.94332117}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   415     5   0     7   0    1    17     7     3   0     28
1     0  1290   1    14   0    0     0    22     5   0      0
2    68     2  42     2   0    5     5   105    15   0     68
3     1     2   1  8232   0    2     1   123    78   0      0
4    18     5   5     1   0    4     2    18    22   0    464
5     7     4   1    24   0  343    19     0   113   0     10
6     6     2   0     9   0    1  1876     0     7   0      7
7     0    41   1   206   0    0     2  6932    70   0     13
8     2     0   4   118   0    8     3    57  3060   0     44
9   122    30   7    10   0  133    43    52    24   0     72
10   30    16   4    25   0    3    20    22    15   0  12661
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67382634, 'precision': 0.4872787, 'recall': 0.5485674, 'specificity': 0.9672099, 'f1': 0.49001765, 'auroc': 0.82359314}
confusion matrix:
      0     1   2    3   4    5     6     7     8   9     10
0   1039    14   0   22   0    0    28    33    25   0     9
1      1  1351   5   39   0    0     0    89     5   0     9
2     87    14  17   19   0   59    18    75   160   0   566
3      0     0   0    0   0    0     0     0     0   0     0
4      2     2   1    0   0    2     3     1     5   0  1617
5     51     4   0  104   0  259    17    15   101   0    41
6      1     0   0   15   0    1  3033     1    11   0     5
7      4     2   2  117   0    0     2  1028     3   0     6
8      1     1   0   78   0   14     5     3  1261   0     7
9    217    13  25   95   0  166    44   146   241   0   190
10     0     0   0    0   0    0     2     0     1   0  1643
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-02 01:16:00.744989,epoch time: 0:56:20.797368,used: 6:27:40.597010,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9258883, 'precision': 0.667716, 'recall': 0.6579722, 'specificity': 0.9917842, 'f1': 0.6472372, 'auroc': 0.95079076}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   419     0   1     3   0    0     8    24     0   0     28
1     0  1287   0     8   0    0     0    32     4   0      1
2    27     1  98     0   0    1     1   154     8   0     22
3     0     1   1  8081   0    0     1   301    53   0      1
4    18     4  46     0   0    2     1    73    19   0    376
5    45     0   3    47   0  150    47    12   215   0      2
6    15     5   0     1   0    0  1865     9     2   0     10
7     0    44   9    66   0    0     1  7118    19   0      7
8     3     4  17   138   0    5     3   121  2965   0     40
9   265     0  21     6   0   37    25   123    11   0      5
10   30    13  16    10   0    1    11    73    13   0  12623
---- Validation: 
scalar performance:
{'acc': 0.92729706, 'precision': 0.6778782, 'recall': 0.6601804, 'specificity': 0.9919214, 'f1': 0.6515347, 'auroc': 0.9513387}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   421     0   0     2   0    0     3    28     0   0     29
1     0  1294   0     6   0    0     0    26     5   0      1
2    22     3  99     1   0    1     3   157     7   0     19
3     0     2   1  8089   0    1     0   295    51   0      1
4    24     3  35     2   0    2     0    76    27   0    370
5    50     0   1    43   0  155    49    11   210   0      2
6    18     9   0     4   0    1  1860     4     2   0     10
7     0    28   7    73   0    0     1  7134    17   0      5
8     1     4   9   143   0    2     2   121  2968   0     46
9   251     0  22     9   0   27    42   122    15   0      5
10   28    11  21     7   0    0    10    64     8   0  12647
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63856435, 'precision': 0.49442518, 'recall': 0.5053795, 'specificity': 0.9640003, 'f1': 0.45572793, 'auroc': 0.8130148}
confusion matrix:
     0     1    2    3   4   5     6    7     8   9     10
0   980     4    5   50   0   0    35   75    13   0     8
1     1  1288    7   35   0   0     0  157     0   0    11
2   150     5  144   29   0   9     2  248   189   0   239
3     0     0    0    0   0   0     0    0     0   0     0
4     1     0    4    0   0   1     1    9    10   0  1607
5   176     0    3  145   0  72    58   67    55   0    16
6     9    21    0   58   0  10  2889    9    35   0    36
7     3     2    0  238   0   0     2  913     1   0     5
8     3     0    0  153   0   1     2   12  1197   0     2
9   389    12   95  132   0  12    26  320   127   0    24
10    0     0    0    0   0   0     1    1     0   0  1644
early stop counter: 1
val acc:0.927297055721283, best validation acc: 0.9322187900543213, corresponding to test acc:                         0.6738263368606567 / 0.6738263368606567
after epoch: 7,now: 2024-08-02 02:08:21.970087,epoch time: 0:52:21.225098,used: 7:20:01.822108,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93014234, 'precision': 0.7088519, 'recall': 0.6543817, 'specificity': 0.99193513, 'f1': 0.66155326, 'auroc': 0.9335761}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   408     3   0     7   0    1     2    12    10   0     40
1     0  1291   3    12   0    0     0    22     3   0      1
2    10     0  78     5   0    4     1   136    22   0     56
3     0     1   0  8203   0    0     0   133   101   0      0
4     4     0   2     3   0    3     0    30    63   0    434
5    14     0   0   121   0  147    19    20   154   0     46
6     8     1   0     9   0    2  1860     5     5   0     18
7     0    28   1   123   0    0     1  7062    43   0      7
8     0     1   2    74   0    1     1    75  3125   0     15
9   113     1  25    29   0   22     7   165    39   0     92
10    5     3   5    24   0    9    11    69    74   0  12591
---- Validation: 
scalar performance:
{'acc': 0.9305604, 'precision': 0.7155242, 'recall': 0.65432304, 'specificity': 0.9919888, 'f1': 0.6632467, 'auroc': 0.93491036}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   394     7   0     7   0    0     7    16     8   0     44
1     0  1294   2     6   0    0     0    23     6   0      1
2    10     0  83     5   0    1     1   120    36   0     56
3     0     1   0  8205   0    0     0   143    91   0      0
4     3     0   2     2   0    4     0    35    63   0    430
5    12     3   0   117   0  151    23    16   146   0     53
6     9     2   0    15   0    3  1857     4     5   0     13
7     0    23   1   115   0    0     1  7075    46   0      4
8     1     1   2    74   0    2     0    70  3134   0     12
9   112     2  18    27   0   16    11   169    38   0    100
10    8     6   2    14   0   15    11    59    85   0  12596
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6066606, 'precision': 0.43614298, 'recall': 0.482384, 'specificity': 0.9608828, 'f1': 0.42967257, 'auroc': 0.7665256}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   932    13   3   83   0    0    10   98    20   0    11
1     0  1305  33   36   0    0     0   91    13   0    21
2    12     3  30   31   0    9     0  102   410   0   418
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   2    0   0   12     1    2    28   0  1588
5    19     1   0  291   0   20     1   34    83   0   143
6     0     1   0   33   0  179  2488    2   308   0    56
7     0     0   0  217   0    0     0  941     2   0     4
8     0     0   0   56   0    0     0    0  1314   0     0
9    56     2  48  233   0    2     2  187   403   0   204
10    0     0   0    0   0    1     1    1     2   0  1641
early stop counter: 2
val acc:0.9305604100227356, best validation acc: 0.9322187900543213, corresponding to test acc:                         0.6738263368606567 / 0.6738263368606567
after epoch: 8,now: 2024-08-02 03:00:52.812508,epoch time: 0:52:30.842421,used: 8:12:32.664529,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9264769, 'precision': 0.6990581, 'recall': 0.6369161, 'specificity': 0.9916107, 'f1': 0.6319745, 'auroc': 0.9530605}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   423     0   0     1   0   0     4     1     5   0     49
1     0  1283   0     9   0   1     0    31     5   0      3
2    31     0  54     2   0   1     2   146    18   0     58
3     0     1   1  8268   0   1     0    56   107   0      1
4     6     0   3     1   0   4     0    33    36   0    456
5    13     1   0    18   0  76    10    30   331   0     42
6    12     4   0     4   0   1  1863     3     5   0     14
7     1     7   1   277   0   0     2  6820   150   0      6
8     1     0   0    70   0   3     0    25  3167   0     29
9   185     1   6     4   0  23    13   140    34   0     87
10   12     0   2    11   0   6     5    26    60   0  12674
---- Validation: 
scalar performance:
{'acc': 0.9261201, 'precision': 0.6991054, 'recall': 0.63588, 'specificity': 0.99157256, 'f1': 0.6303194, 'auroc': 0.95534414}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   428     3   0     4   0   0     2     7     4   0     35
1     0  1282   1    13   0   0     0    28     6   0      2
2    38     0  55     1   0   2     1   146    19   0     50
3     1     0   1  8283   0   0     1    62    91   0      1
4     5     0   3     0   0   5     1    44    27   0    454
5     6     0   0    15   0  67    10    24   346   0     53
6    13     2   0     4   0   3  1856     2    12   0     16
7     0     6   2   277   0   0     1  6838   134   0      7
8     2     1   2    87   0   6     0    26  3152   0     20
9   182     1   5     4   0  13    14   144    39   0     91
10   14     0   0     9   0   5     4    37    65   0  12662
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64073324, 'precision': 0.49091643, 'recall': 0.5085465, 'specificity': 0.9639821, 'f1': 0.4542578, 'auroc': 0.8104732}
confusion matrix:
      0     1   2    3   4    5     6    7     8   9     10
0   1101     3   0    7   0    0    12   13    24   0    10
1      3  1241  10   41   0    0     2  167    17   0    18
2     43     1  22   21   0    6     4   98   338   0   482
3      0     0   0    0   0    0     0    0     0   0     0
4      1     0   1    0   0    2     1    2    21   0  1605
5     54     0   0   40   0  126     9   69   130   0   164
6      0     0   0   10   0   25  2921    0   103   0     8
7     15     0   1  317   0    0     1  807    16   0     7
8      0     0   0   68   0    0     2    1  1297   0     2
9    216     2  18  100   0   25    11  232   311   0   222
10     0     0   0    0   0    2     0    0     1   0  1643
early stop counter: 3
val acc:0.9261201024055481, best validation acc: 0.9322187900543213, corresponding to test acc:                         0.6738263368606567 / 0.6738263368606567
after epoch: 9,now: 2024-08-02 03:56:22.987473,epoch time: 0:55:30.174965,used: 9:08:02.839494,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9278949, 'precision': 0.704678, 'recall': 0.63335055, 'specificity': 0.9917863, 'f1': 0.61998916, 'auroc': 0.9562144}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   416     1   0     0   0    0    11    14     0   0     41
1     0  1304   0     4   0    0     1    20     3   0      0
2    36     0  17     0   0    1     3   160     4   0     91
3     0     1   1  8059   0    1     2   232   144   0      0
4     3     3   0     0   0    3     4    20     9   0    497
5    27     0   1    10   0  123   123    14   216   0      7
6     8     4   0     4   0    0  1873     3     0   0     16
7     3    25   0    72   0    0     2  7132    18   0     12
8     2     4   0    28   0   12     2   102  3044   0    102
9   248     0   1     3   0   14    83    94     3   0     47
10   19    17   0     7   0    2    10    17     3   0  12713
---- Validation: 
scalar performance:
{'acc': 0.928474, 'precision': 0.69994724, 'recall': 0.6366519, 'specificity': 0.99185383, 'f1': 0.6239561, 'auroc': 0.9554992}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   418     0   0     2   0    0     8    14     0   0     41
1     0  1307   0     4   0    1     1    18     1   0      0
2    41     0  20     0   0    1     4   153     3   0     90
3     2     2   0  8073   0    1     1   212   148   0      1
4     7     4   1     0   0    2     3    14     9   0    499
5    35     0   0     8   0  132   119    10   208   0      9
6     5     2   0     5   0    1  1880     2     2   0     11
7     3    23   0    79   0    0     1  7128    22   0      9
8     1     3   3    37   0    8     0   105  3041   0     98
9   242     0   2     2   0   16    73    99    12   0     47
10   17    25   0     7   0    0    10    22     3   0  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6485692, 'precision': 0.46841186, 'recall': 0.507558, 'specificity': 0.9644808, 'f1': 0.45156288, 'auroc': 0.8174855}
confusion matrix:
      0     1   2    3   4    5     6    7     8   9     10
0   1009     5   0   40   0    0    78   22     8   0     8
1      5  1345   0   21   0    0     3  112     6   0     7
2     45    18   8   13   0   23    33  122   200   0   553
3      0     0   0    0   0    0     0    0     0   0     0
4      1     2   0    0   0    0     2    2    11   0  1615
5     64     0   0   85   0  105   114   89   114   0    21
6      1     4   0    8   0    0  3047    1     4   0     2
7      6     0   0  340   0    0     4  806     5   0     3
8      1     0   0   50   0    2     4    2  1308   0     3
9    239    18  21   87   0   43   131  252   241   0   105
10     0     0   0    0   0    0     3    0     1   0  1642
early stop counter: 4
val acc:0.9284740090370178, best validation acc: 0.9322187900543213, corresponding to test acc:                         0.6738263368606567 / 0.6738263368606567
after epoch: 10,now: 2024-08-02 04:49:25.461348,epoch time: 0:53:02.473875,used: 10:01:05.313369,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 10:01:05.313369 at 2024-08-02 04:49:25.461348
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67382634, 'precision': 0.4872787, 'recall': 0.5485674, 'specificity': 0.9672099, 'f1': 0.49001765, 'auroc': 0.82359314}
confusion matrix:
      0     1   2    3   4    5     6     7     8   9     10
0   1039    14   0   22   0    0    28    33    25   0     9
1      1  1351   5   39   0    0     0    89     5   0     9
2     87    14  17   19   0   59    18    75   160   0   566
3      0     0   0    0   0    0     0     0     0   0     0
4      2     2   1    0   0    2     3     1     5   0  1617
5     51     4   0  104   0  259    17    15   101   0    41
6      1     0   0   15   0    1  3033     1    11   0     5
7      4     2   2  117   0    0     2  1028     3   0     6
8      1     1   0   78   0   14     5     3  1261   0     7
9    217    13  25   95   0  166    44   146   241   0   190
10     0     0   0    0   0    0     2     0     1   0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67382634, 'precision': 0.4872787, 'recall': 0.5485674, 'specificity': 0.9672099, 'f1': 0.49001765, 'auroc': 0.82359314}
confusion matrix:
      0     1   2    3   4    5     6     7     8   9     10
0   1039    14   0   22   0    0    28    33    25   0     9
1      1  1351   5   39   0    0     0    89     5   0     9
2     87    14  17   19   0   59    18    75   160   0   566
3      0     0   0    0   0    0     0     0     0   0     0
4      2     2   1    0   0    2     3     1     5   0  1617
5     51     4   0  104   0  259    17    15   101   0    41
6      1     0   0   15   0    1  3033     1    11   0     5
7      4     2   2  117   0    0     2  1028     3   0     6
8      1     1   0   78   0   14     5     3  1261   0     7
9    217    13  25   95   0  166    44   146   241   0   190
10     0     0   0    0   0    0     2     0     1   0  1643
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_01_18_48_19_seed_1_23919979_instance_wise_predictions.txt
accuracy from prediction file 0.6738263485622332
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_missing16_2024-08-01_00-27-47/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_missing16_2024-08-01_00-27-47/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1662 MiB |  15861 MiB |    774 TiB |    774 TiB |
|       from large pool |   1655 MiB |  15836 MiB |    768 TiB |    768 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1662 MiB |  15861 MiB |    774 TiB |    774 TiB |
|       from large pool |   1655 MiB |  15836 MiB |    768 TiB |    768 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB |    772 TiB |    772 TiB |
|       from large pool |   1647 MiB |  15791 MiB |    766 TiB |    766 TiB |
|       from small pool |      6 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16412 MiB |  16492 MiB |  30858 MiB |  14446 MiB |
|       from large pool |  16384 MiB |  16464 MiB |  30828 MiB |  14444 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 472505 KiB | 694703 KiB | 178190 GiB | 178189 GiB |
|       from large pool | 455296 KiB | 692736 KiB | 172239 GiB | 172239 GiB |
|       from small pool |  17209 KiB |  24786 KiB |   5950 GiB |   5950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2660    |    3967    |   60964 K  |   60961 K  |
|       from large pool |     247    |     595    |   26947 K  |   26947 K  |
|       from small pool |    2413    |    3621    |   34016 K  |   34013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2660    |    3967    |   60964 K  |   60961 K  |
|       from large pool |     247    |     595    |   26947 K  |   26947 K  |
|       from small pool |    2413    |    3621    |   34016 K  |   34013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     459    |     466    |     815    |     356    |
|       from large pool |     445    |     452    |     800    |     355    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     125    |    1253    |   33207 K  |   33207 K  |
|       from large pool |     100    |     307    |   17255 K  |   17255 K  |
|       from small pool |      25    |    1152    |   15951 K  |   15951 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15861 MiB |    774 TiB |    774 TiB |
|       from large pool |  16640 KiB |  15836 MiB |    768 TiB |    768 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15861 MiB |    774 TiB |    774 TiB |
|       from large pool |  16640 KiB |  15836 MiB |    768 TiB |    768 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB |    772 TiB |    772 TiB |
|       from large pool |  16640 KiB |  15791 MiB |    766 TiB |    766 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2124 MiB |  16492 MiB |  30858 MiB |  28734 MiB |
|       from large pool |   2100 MiB |  16464 MiB |  30828 MiB |  28728 MiB |
|       from small pool |     24 MiB |     28 MiB |     30 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 694703 KiB | 178191 GiB | 178191 GiB |
|       from large pool |  24320 KiB | 692736 KiB | 172240 GiB | 172240 GiB |
|       from small pool |      0 KiB |  24786 KiB |   5950 GiB |   5950 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3967    |   60964 K  |   60964 K  |
|       from large pool |       2    |     595    |   26947 K  |   26947 K  |
|       from small pool |       0    |    3621    |   34016 K  |   34016 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3967    |   60964 K  |   60964 K  |
|       from large pool |       2    |     595    |   26947 K  |   26947 K  |
|       from small pool |       0    |    3621    |   34016 K  |   34016 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     110    |     466    |     815    |     705    |
|       from large pool |      98    |     452    |     800    |     702    |
|       from small pool |      12    |      14    |      15    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1253    |   33208 K  |   33208 K  |
|       from large pool |       3    |     307    |   17255 K  |   17255 K  |
|       from small pool |       0    |    1152    |   15952 K  |   15952 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 05:00:15 2024]
Finished job 0.
1 of 1 steps (100%) done
