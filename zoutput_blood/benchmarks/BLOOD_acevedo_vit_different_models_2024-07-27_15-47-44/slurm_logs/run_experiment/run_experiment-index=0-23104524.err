Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 09:35:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524

 Experiment start at: 2024-07-28 09:46:26.340558
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.12040859460830688
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9420216, 'precision': 0.870755, 'recall': 0.81599385, 'specificity': 0.9934996, 'f1': 0.8362587, 'auroc': 0.9957123}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     0    1     2    2    0     8     8     4    4     69
1     0  1259    0    13    0    0     0    50     6    0      4
2     1     0  160     0   37    3     1     4     5   84     17
3     2     0    1  7911    2   21     3   263   227    6      2
4     1     0   16     0  250    2     0     4    18   16    232
5     3     0    1    23    0  368     0     0     4  120      2
6    14     2    0     2    2    0  1829     7    11    3     38
7     3     7    1   176    2    0     2  6979    59    6     24
8     1     0   11    76   16    4     1   107  2961    8    111
9     4     0   16     6    1   58     0     4     4  395      5
10    8     0    3     7   23    0     6    16    19    1  12712
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94307876, 'precision': 0.87155837, 'recall': 0.82092565, 'specificity': 0.9936368, 'f1': 0.84031355, 'auroc': 0.9957477}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    0     3    0    1    11     9     4    5     56
1     0  1257    1     9    0    0     0    57     3    0      5
2     3     0  160     0   38    1     0     6     4   82     18
3     1     1    2  7907    2   17     2   280   220    7      1
4     1     0   19     0  270    2     0     3    15   17    212
5     4     0    2    27    0  374     0     0     4  109      1
6    16     1    0     1    7    0  1831     4     8    2     38
7     1     8    2   165    1    0     4  7004    54    6     20
8     2     0    5    76   14    2     0   102  2969   12    114
9     5     0   25     4    0   55     0     2     9  387      6
10    8     0    3     8   19    0    10    21    22    1  12704
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72504026, 'precision': 0.65205705, 'recall': 0.61023414, 'specificity': 0.9721446, 'f1': 0.59585303, 'auroc': 0.8836443}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1032     2    0   3    0    0    43    24    40    7    19
1      2  1182    0  16    1    1     1   229     6    4    57
2     21     6  245   1  176    2    13    39   135   51   326
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    3   0  143    0     2     2     6    0  1475
5     73     0    4  27    0  262     3     0    34  176    13
6      2     0    0   1    3    0  3004     3    17    0    37
7      0     1    1  20    0    0     7  1126     0    1     8
8      3     0    2  29    3    2    12    16  1289    4    10
9     67     7  239  19    2   47    21    54   190  438    53
10     0     0    0   0    4    0     0     0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 10:24:20.525744,epoch time: 0:37:54.185186,used: 0:37:54.185186,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9434129, 'precision': 0.8777422, 'recall': 0.84001255, 'specificity': 0.9937799, 'f1': 0.85286045, 'auroc': 0.99738014}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     1    1     3    0    0     2     7     1    1     58
1     0  1288    0     7    0    0     0    35     2    0      0
2     5     1  238     0   21    0     1    13     8   18      7
3     2     9    0  7661    0   19     1   571   175    1      0
4     2     0   46     0  277    3     0     8    33    5    164
5     0     0    4    22    1  396     0     0    11   86      1
6    14     1    1     1    1    3  1817     7    15    1     46
7     1    22    2    54    1    0     1  7136    43    1      4
8     0     1    2    42    5    6     0   144  3069    0     26
9     3     1  105     4    0   53     0     5    10  308      4
10    7     0    1     7   14    0     2    32    64    2  12663
---- Validation: 
scalar performance:
{'acc': 0.94361377, 'precision': 0.87903845, 'recall': 0.84476924, 'specificity': 0.9938021, 'f1': 0.8566052, 'auroc': 0.9973604}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     1    3     0    0    0     2    12     1    2     46
1     0  1293    0     5    0    0     0    32     2    0      0
2     3     1  241     0   18    2     0    12     7   21      7
3     0     7    0  7662    0   15     1   570   185    0      0
4     4     0   39     0  293    2     0     7    34    3    157
5     1     0    1    16    0  407     0     0     7   88      1
6    14     1    3     2    0    1  1798     8    13    1     67
7     0    20    0    47    1    0     1  7146    44    0      6
8     1     2    2    48    5    4     0   139  3065    0     30
9     7     2  100     3    2   59     0     7    11  301      1
10    8     0    5     5   17    0     2    30    72    2  12655
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7290282, 'precision': 0.64425015, 'recall': 0.62741053, 'specificity': 0.9726912, 'f1': 0.60163176, 'auroc': 0.884526}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1058     5    1   6    1    0    30    22    23    5    19
1      1  1338    0  13    1    2     0   113     3    0    28
2      9     7  285   9  120   14     2    81   237   36   215
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    2   0  101    0     1     2    26    0  1501
5     15     0    7  32    0  378     0     0    18  137     5
6      1     1    0   2    2    0  2888     8    60    0   105
7      0     1    0   9    0    0     1  1145     2    1     5
8      0     0    0  40    0    3     3    28  1293    3     0
9     28    19  293  46    5  131     1   111   180  292    31
10     0     0    0   0    3    0     0     0     1    0  1642
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 11:00:19.514480,epoch time: 0:35:58.988736,used: 1:13:53.173922,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95858306, 'precision': 0.88173974, 'recall': 0.86248, 'specificity': 0.99556804, 'f1': 0.86493784, 'auroc': 0.99815595}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   396     0    2     2    1    0    41     8     0    7     26
1     0  1290    0    11    0    0     0    30     0    0      1
2     1     0  247     1    3    6     1     5     4   42      2
3     0     0    0  8298    0   20     5    57    57    1      0
4     3     1   84     0  304    3     2     5    25   10    101
5     0     0    0     8    0  497     0     0     1   14      1
6     3     0    0     4    1    0  1883     0     6    4      7
7     0    10    2   240    1    0     2  6961    41    1      6
8     1     3    4   116    3   12     1    65  3071    2     17
9     0     0   34     5    0  182     1     0     4  267      0
10    3     1   10     8   58    2    23    18    55    0  12614
---- Validation: 
scalar performance:
{'acc': 0.95722884, 'precision': 0.8805411, 'recall': 0.86087686, 'specificity': 0.9954084, 'f1': 0.8630204, 'auroc': 0.99814314}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   391     0    2     2    0    0    37     3     7    8     33
1     0  1291    0    11    0    0     0    29     1    0      0
2     0     0  246     1    5    8     1     6     4   40      1
3     0     0    0  8290    0   26     3    60    61    0      0
4     4     1   94     1  301    3     3     3    25    7     97
5     0     0    0    12    0  493     0     0     2   13      1
6     1     0    1     4    0    2  1885     0     6    0      9
7     0     9    1   269    1    1     2  6934    43    1      4
8     1     3    6   115    5    7     0    73  3063    0     23
9     0     0   38     5    0  173     0     1     1  275      0
10    4     4   17     7   59    2    14    23    48    1  12617
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71398586, 'precision': 0.6788721, 'recall': 0.6106479, 'specificity': 0.9711898, 'f1': 0.6016583, 'auroc': 0.88878876}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   581     3    0   26    2   14   449    6     7   78     4
1     1  1345    1   25    0    8     2  105     3    1     8
2     0     9  399   19  100   62    24   31   252   45    74
3     0     0    0    0    0    0     0    0     0    0     0
4     1     1   13    0  443    0     2    1    25    0  1147
5     1     0    1   33    0  533     3    0     1   20     0
6     0     2    0    3    1    0  3036    2    16    0     7
7     0     0    0  298    0    1     8  853     1    0     3
8     0     0    1  140    0   17    11    2  1199    0     0
9     0    31  166   93    1  441    22   35   127  211    10
10    0     0    0    0   39    0     1    1     0    0  1605
better model found
persisted
after epoch: 3,now: 2024-07-28 11:36:20.733157,epoch time: 0:36:01.218677,used: 1:49:54.392599,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9588506, 'precision': 0.9035499, 'recall': 0.89553225, 'specificity': 0.9955491, 'f1': 0.896081, 'auroc': 0.99872714}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     2    2    0     7     1     2    1     25
1     0  1296    0     3    0    0     0    29     3    0      1
2     0     0  265     0   18    2     1     3     2   21      0
3     1     4    3  7791    1   17     2   489   130    1      0
4     2     0   35     0  379    2     0     5    12    0    104
5     1     0    1     6    1  477     0     1     7   26      1
6     5     0    3     3    3    0  1866     5     6    1     16
7     0    19    0    38    1    0     4  7105    85    1      9
8     1     0    4    23   13    2     0    38  3185    1     29
9     1     0   80     1    4   83     0     0     2  322      0
10    9     0    9     4   26    0     5     9    20    0  12709
---- Validation: 
scalar performance:
{'acc': 0.95856625, 'precision': 0.90923506, 'recall': 0.9001535, 'specificity': 0.99549717, 'f1': 0.9004556, 'auroc': 0.998721}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     1    0     0    1    0     5     5     1    1     27
1     0  1299    0     4    0    0     0    25     3    0      1
2     0     0  280     1   15    2     0     2     3    9      0
3     1     5    1  7772    0   18     1   496   144    2      0
4     3     0   31     0  379    2     0     4    15    1    104
5     0     0    2    12    0  481     0     0     7   18      1
6     6     0    3     2    2    3  1852     7     6    1     26
7     0    16    1    32    1    0     3  7132    70    1      9
8     3     0    2    25    8    3     1    41  3181    1     31
9     1     0   80     1    4   79     0     2     2  324      0
10    4     0    8     3   40    1     9    10    27    0  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7614217, 'precision': 0.6912912, 'recall': 0.6630838, 'specificity': 0.97591937, 'f1': 0.6479893, 'auroc': 0.88613105}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   966     0    3  22    2   16    74    14    40   23    10
1     2  1355    0   8    2    4     4    86     7    3    28
2     2     3  394   0  199   25    10    22   221   34   105
3     0     0    0   0    0    0     0     0     0    0     0
4     2     0    8   0  318    0     1     0     9    0  1295
5     3     0    8  37    2  481     0     0    13   48     0
6     1     0    0   1    1    0  2980     3    39    0    42
7     0     1    1  29    0    1    22  1095     7    1     7
8     0     0    3  38    4   10    10     0  1302    1     2
9     8    11  278  33    6  208     6    29   185  353    20
10    0     0    0   0    7    0     0     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 12:13:06.505981,epoch time: 0:36:45.772824,used: 2:26:40.165423,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9681614, 'precision': 0.9248826, 'recall': 0.895392, 'specificity': 0.9965396, 'f1': 0.9045429, 'auroc': 0.99903744}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    0    1     5     4     2    0      3
1     0  1296    1     5    0    0     0    28     2    0      0
2     7     0  234     0   14    0     1     6     5   40      5
3     0     0    0  8184    0    6     1   169    75    2      0
4    11     0   14     0  287    1     4     6    53    2    161
5     1     0    0    15    0  451     0     0     4   49      1
6    15     0    0     3    0    0  1874     2     4    1      8
7     0     4    0    55    1    0     1  7157    41    1      3
8     1     0    2    42    1    3     5    43  3192    0      5
9     4     0   18     3    1   31     1     4     4  427      0
10   58     0    1     7   11    0    23    18    61    0  12616
---- Validation: 
scalar performance:
{'acc': 0.96859705, 'precision': 0.9220228, 'recall': 0.8945474, 'specificity': 0.9965936, 'f1': 0.90334177, 'auroc': 0.99897337}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    0    0     7     5     1    0      3
1     0  1297    1     3    0    0     0    29     2    0      0
2     5     0  227     0   22    0     3     6     4   41      4
3     0     0    0  8201    0    2     1   147    87    2      0
4    13     0   18     1  300    0     2     6    42    3    154
5     1     0    0    17    0  445     0     0     5   52      1
6    13     0    1     0    0    0  1883     2     3    0      6
7     0     6    0    74    0    0     1  7154    27    0      3
8     4     0    2    44    0    2     0    35  3197    2     10
9     6     0   17     3    1   32     2     3     3  426      0
10   62     0    1     6   10    1    24    16    61    0  12615
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7193731, 'precision': 0.6351731, 'recall': 0.60577464, 'specificity': 0.9714062, 'f1': 0.58720756, 'auroc': 0.87344277}
confusion matrix:
      0     1    2   3   4    5     6     7     8    9     10
0   1007     1    0  17   0    0    85    24    27    7     2
1      3  1323    1  23   0    0     5   117     5    2    20
2     28     0  175   7  90   10   138    39   278   65   185
3      0     0    0   0   0    0     0     0     0    0     0
4      2     0    3   0  33    0    20     1    22    0  1552
5     11     0    1  89   0  316    30     0     9  134     2
6      0     0    0   1   0    0  3058     2     4    0     2
7      0     0    0  53   0    0    11  1096     0    1     3
8      0     0    1  85   0    1    83     8  1190    1     1
9     29     4  135  86   4  123    72    69   145  443    27
10     0     0    0   0   1    0     2     1     1    0  1641
better model found
persisted
after epoch: 5,now: 2024-07-28 12:59:33.623482,epoch time: 0:46:27.117501,used: 3:13:07.282924,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9732181, 'precision': 0.9204037, 'recall': 0.9144271, 'specificity': 0.9971725, 'f1': 0.91320467, 'auroc': 0.99931943}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    0     1     0     0    1      4
1     0  1304    0     4    0    0     0    22     1    0      1
2     2     0  274     0   16    0     0     3     3   14      0
3     2     0    1  8286    0    5     1    88    54    1      0
4     6     0   13     0  443    0     1     1    11    1     63
5     0     0    2    22    0  334     1     0     5  156      1
6    16     0    0     0    0    0  1882     0     2    0      7
7     0     5    0   103    2    0     2  7111    37    1      3
8     0     2    2    46    4    0     2    43  3189    0      7
9     0     0   60     4    0    6     1     4     0  418      0
10   24     0    3     5   32    0    12    12    46    0  12658
---- Validation: 
scalar performance:
{'acc': 0.9746422, 'precision': 0.9261703, 'recall': 0.9181015, 'specificity': 0.9973145, 'f1': 0.9181386, 'auroc': 0.9993822}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    1    0     3     1     0    2      4
1     0  1303    0     4    0    0     0    22     2    0      1
2     2     0  275     1   17    0     1     4     3    9      0
3     0     2    0  8310    0    0     0    79    49    0      0
4     7     0    8     0  448    0     0     1    12    0     63
5     1     0    1    24    0  343     0     0     4  147      1
6    17     0    1     1    0    0  1880     0     2    0      7
7     1     7    1   103    1    0     2  7115    32    0      3
8     1     1    2    44    3    0     1    33  3203    1      7
9     3     0   52     2    2    3     1     1     2  425      2
10   22     0    4     6   34    0    15    10    42    0  12663
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7517666, 'precision': 0.68488836, 'recall': 0.6348353, 'specificity': 0.97515893, 'f1': 0.64114857, 'auroc': 0.8866691}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1077     0    0   13    2    6    32    6     5   28     1
1      6  1309    1   22    2    0     1  127     6    3    22
2      6     2  332    9  296    6    16   33   203   56    56
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    4    0  434    0     4    0    14    0  1176
5      3     0    8   67    3  278     4    0    13  216     0
6      0     0    0    2    5    0  2997    3    33    0    27
7      6     0    0  172    0    0     6  972     2    1     5
8      0     0    2   88    3    0    18    9  1248    2     0
9     11     5  293   86    7   60    10   77   100  475    13
10     0     0    0    0   19    0     2    1     1    0  1623
better model found
persisted
after epoch: 6,now: 2024-07-28 13:46:01.024096,epoch time: 0:46:27.400614,used: 3:59:34.683538,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96789384, 'precision': 0.91336524, 'recall': 0.911487, 'specificity': 0.9966896, 'f1': 0.90754694, 'auroc': 0.9992606}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     3    4    2     2     0     2    1      3
1     0  1296    0    10    0    0     0    21     4    1      0
2     0     0  214     0   12    6     0     0     7   73      0
3     0     0    0  8320    0    9     0    19    89    1      0
4     2     0   11     1  486    3     0     2    16    4     14
5     0     0    0     3    0  512     0     0     2    2      1
6     6     0    0     1    2    2  1885     1     6    1      4
7     1     3    0   274    1    0     2  6790   188    1      3
8     0     0    0    17    2    1     0     4  3265    0      4
9     0     0    1     2    0  173     0     0     7  310      0
10   14     0    4     7   96    2     3     5    32    0  12632
---- Validation: 
scalar performance:
{'acc': 0.9672328, 'precision': 0.90832335, 'recall': 0.9048224, 'specificity': 0.9966115, 'f1': 0.9018763, 'auroc': 0.9992803}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     6    3    1     3     0     1    1      6
1     0  1293    0     8    0    0     0    23     8    0      0
2     0     0  203     0    9    5     0     0     6   89      0
3     0     0    0  8323    0    6     0    16    94    1      0
4     2     0   15     1  478    2     0     2    17    6     16
5     0     0    0     5    0  512     0     0     1    2      1
6     2     0    0     4    1    2  1892     1     4    0      2
7     0     4    1   278    0    0     1  6799   176    0      6
8     1     0    1    14    1    2     0     5  3264    0      8
9     0     0    2     4    0  178     0     0     6  303      0
10   14     0    4     9  101    0     2     4    31    0  12631
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7223816, 'precision': 0.6878171, 'recall': 0.61414623, 'specificity': 0.9724965, 'f1': 0.60659987, 'auroc': 0.8870614}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   844     0    0   84    3   69    74   15    57   15     9
1     7  1197    1   28    2    2     3  210    19    3    27
2     1     0  216   20  227   66    36   20   303   57    69
3     0     0    0    0    0    0     0    0     0    0     0
4     1     0    9    0  667    0     5    1    17    0   933
5     0     0    1   79    0  494     2    0    14    2     0
6     2     0    0    1    1    0  2989    3    40    0    31
7     1     0    0  318    0    3     3  817    15    2     5
8     0     0    1   77    1    5    11    0  1274    0     1
9     3     1   64  130    5  407    12   59   212  234    10
10    0     0    0    0   49    0     3    0     1    0  1593
early stop counter: 1
val acc:0.9672328233718872, best validation acc: 0.9746422171592712, corresponding to test acc:                         0.7517666220664978 / 0.7614216804504395
after epoch: 7,now: 2024-07-28 14:31:07.807237,epoch time: 0:45:06.783141,used: 4:44:41.466679,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9845355, 'precision': 0.9572476, 'recall': 0.9573388, 'specificity': 0.99832976, 'f1': 0.9571978, 'auroc': 0.99972713}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    4    0     0     0     0    0      2
1     0  1322    0     3    0    0     0     6     0    0      0
2     1     0  284     0   11    1     0     1     2   12      0
3     0     0    0  8297    0    7     0    98    35    0      1
4     0     0    6     0  494    0     0     0     5    2     32
5     0     0    0     8    1  483     0     0     3   26      0
6     7     0    0     0    2    0  1878     2     3    0     15
7     0     7    0    46    1    0     1  7193    10    1      4
8     2     1    3    28    5    0     0    41  3202    1     12
9     2     0   29     3    3   26     1     0     0  429      0
10    6     1    2     7   21    0     1     6    11    0  12740
---- Validation: 
scalar performance:
{'acc': 0.9834158, 'precision': 0.95014614, 'recall': 0.95452976, 'specificity': 0.9982321, 'f1': 0.95203304, 'auroc': 0.99972916}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    3    0     1     0     0    2      2
1     0  1324    0     1    0    0     0     7     0    0      0
2     0     0  288     0   15    0     0     1     0    8      0
3     1     1    0  8284    0   12     0   106    36    0      0
4     1     0   10     0  482    1     0     0     6    0     39
5     0     0    0     2    1  487     0     0     2   28      1
6     8     0    1     1    2    0  1881     1     3    0     11
7     0    13    1    53    1    0     1  7179    13    0      4
8     1     1    3    33    6    0     0    30  3217    2      3
9     0     0   36     1    0   37     0     1     1  417      0
10    6     0    2     6   28    0     3     5    14    0  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73875326, 'precision': 0.6614031, 'recall': 0.6382283, 'specificity': 0.97375727, 'f1': 0.6172936, 'auroc': 0.88116103}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1066     1    0  11    3    2    12    18    33   18     6
1      2  1346    1   7    0    2     0   126     5    0    10
2      8     8  207   7  208   35    10    44   295   68   125
3      0     0    0   0    0    0     0     0     0    0     0
4      2     1    8   0  225    0     2     0    27    0  1368
5      9     0    1  33    2  412     2     0    22  109     2
6      7     0    1   2    2    0  2873     3    70    0   109
7      1     1    0  80    0    1     1  1074     3    0     3
8      0     0    1  59    0    4    10    12  1282    2     0
9     10    17  127  43    4  240    11    81   149  436    19
10     0     0    0   0    7    0     0     0     1    0  1638
better model found
persisted
after epoch: 8,now: 2024-07-28 15:19:05.172553,epoch time: 0:47:57.365316,used: 5:32:38.831995,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9829035, 'precision': 0.95293224, 'recall': 0.95377535, 'specificity': 0.9981667, 'f1': 0.95150536, 'auroc': 0.99974823}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    2     2    3    1    21     2     0    1     18
1     0  1327    0     1    0    0     0     4     0    0      0
2     0     0  305     0    1    0     0     0     1    5      0
3     0     2    0  8330    0    0     0    47    60    0      1
4     1     0   27     0  473    0     0     0     5    2     31
5     0     0    2     8    0  480     0     0     2   28      1
6     0     0    1     0    0    0  1899     0     2    2      3
7     0    18   12    81    0    0     6  7076    57    2     12
8     0     1    6    10    2    1     0    15  3230    0     29
9     0     0   42     2    0   11     0     0     0  438      0
10    0     0   10     4   19    0     4     1     5    2  12746
---- Validation: 
scalar performance:
{'acc': 0.9820516, 'precision': 0.95168877, 'recall': 0.9491259, 'specificity': 0.99805063, 'f1': 0.9484, 'auroc': 0.99973476}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    3     2    4    0    14     0     0    6     16
1     0  1317    0     2    0    0     0    10     2    0      1
2     0     0  305     0    0    0     0     0     0    7      0
3     0     0    2  8343    0    0     0    45    50    0      0
4     1     0   25     1  472    0     0     0     3    4     33
5     0     0    3    17    0  461     0     0     2   36      2
6     0     0    1     1    0    0  1893     1     2    0     10
7     0    16    5    96    1    0     3  7068    61    1     14
8     0     0    6    13    2    1     0    12  3222    3     37
9     0     0   46     1    0   12     0     0     1  433      0
10    0     0   13     3   11    0     4     0     3    0  12762
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74700904, 'precision': 0.6911967, 'recall': 0.64237034, 'specificity': 0.9745431, 'f1': 0.6407589, 'auroc': 0.8849052}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   904     0    9  22    1    8   127    18     3   62    16
1     1  1240    5  13    1    0     3   199     1    0    36
2     1     1  548  10  130    9    22    18   140   57    79
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0   25   0  274    0    12     0    10    0  1311
5     3     0   20  89    0  343     0     0    19  117     1
6     0     0    7   4    2    0  2975     2    12    0    65
7     0     1    4  77    0    0     6  1064     3    1     8
8     0     1   15  58    1    4    11    14  1258    2     6
9     3    11  340  77    1  128     6    43    77  436    15
10    0     0    0   0   10    0     1     0     0    0  1635
early stop counter: 1
val acc:0.9820516109466553, best validation acc: 0.9834157824516296, corresponding to test acc:                         0.7387532591819763 / 0.7614216804504395
after epoch: 9,now: 2024-07-28 16:03:51.642796,epoch time: 0:44:46.470243,used: 6:17:25.302238,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9857663, 'precision': 0.95527315, 'recall': 0.95162785, 'specificity': 0.99849224, 'f1': 0.9525558, 'auroc': 0.99975866}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    2    0     2     0     0    0      1
1     0  1323    0     1    0    0     0     7     1    0      0
2     0     0  269     0    1    1     0     0     1   38      2
3     0     0    0  8395    0    3     1    26    12    1      0
4     3     0   19     1  473    1     0     0    12    3     27
5     0     0    0     2    0  516     0     0     0    3      0
6     2     0    0     0    0    0  1899     0     4    0      3
7     1     5    0    89    0    0     1  7133    28    3      4
8     0     0    1    49    0    3     0     7  3221    2     12
9     0     0    6     0    0   86     0     0     2  399      0
10    9     0    0     3   22    0     7     0    12    0  12738
---- Validation: 
scalar performance:
{'acc': 0.9848067, 'precision': 0.95553833, 'recall': 0.9491134, 'specificity': 0.99838233, 'f1': 0.95120883, 'auroc': 0.99975866}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    2    0     1     1     0    0      2
1     0  1317    0     2    0    0     0    11     2    0      0
2     0     0  270     0    0    1     1     0     3   35      2
3     0     0    0  8398    0    4     0    26    11    0      1
4     4     0   18     0  479    0     0     1    12    2     23
5     0     0    0     4    0  511     0     0     1    5      0
6     1     0    0     2    0    0  1899     0     2    0      4
7     3     5    0   108    0    0     2  7120    23    0      4
8     0     0    1    62    0    1     0    10  3217    0      5
9     0     0    3     0    1   99     0     1     0  389      0
10    8     0    2     4   20    0     6     2    13    0  12741
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7539355, 'precision': 0.70094216, 'recall': 0.64713144, 'specificity': 0.9753459, 'f1': 0.6452372, 'auroc': 0.8872566}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1071     0    0   23    0    9    28    13     4   17     5
1     10  1222    0   28    1    0     4   197     5   11    21
2     17     2  272   12  140   39    58    48   224  105    98
3      0     0    0    0    0    0     0     0     0    0     0
4      1     1    8    0  419    0    33     1    23    1  1146
5      6     0    2   63    1  371     1     0     2  143     3
6      3     0    1    3    1    0  2989     4    28    0    38
7      3     0    0  127    0    0     3  1027     0    2     2
8      1     0    2  115    3    9    30    20  1175   13     2
9     11     6   67   83    2  203    13    80    40  615    17
10     0     0    0    0   21    0     9     0     1    0  1615
better model found
persisted
after epoch: 10,now: 2024-07-28 16:48:48.620892,epoch time: 0:44:56.978096,used: 7:02:22.280334,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:02:22.280334 at 2024-07-28 16:48:48.620892
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7539355, 'precision': 0.70094216, 'recall': 0.64713144, 'specificity': 0.9753459, 'f1': 0.6452372, 'auroc': 0.8872566}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1071     0    0   23    0    9    28    13     4   17     5
1     10  1222    0   28    1    0     4   197     5   11    21
2     17     2  272   12  140   39    58    48   224  105    98
3      0     0    0    0    0    0     0     0     0    0     0
4      1     1    8    0  419    0    33     1    23    1  1146
5      6     0    2   63    1  371     1     0     2  143     3
6      3     0    1    3    1    0  2989     4    28    0    38
7      3     0    0  127    0    0     3  1027     0    2     2
8      1     0    2  115    3    9    30    20  1175   13     2
9     11     6   67   83    2  203    13    80    40  615    17
10     0     0    0    0   21    0     9     0     1    0  1615
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7614217, 'precision': 0.6912912, 'recall': 0.6630838, 'specificity': 0.97591937, 'f1': 0.6479893, 'auroc': 0.88613105}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   966     0    3  22    2   16    74    14    40   23    10
1     2  1355    0   8    2    4     4    86     7    3    28
2     2     3  394   0  199   25    10    22   221   34   105
3     0     0    0   0    0    0     0     0     0    0     0
4     2     0    8   0  318    0     1     0     9    0  1295
5     3     0    8  37    2  481     0     0    13   48     0
6     1     0    0   1    1    0  2980     3    39    0    42
7     0     1    1  29    0    1    22  1095     7    1     7
8     0     0    3  38    4   10    10     0  1302    1     2
9     8    11  278  33    6  208     6    29   185  353    20
10    0     0    0   0    7    0     0     0     0    0  1639
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_09_46_25_seed_0_23104524_instance_wise_predictions.txt
accuracy from prediction file 0.7539354928986217
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/0.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1657 MiB |   5046 MiB | 273941 GiB | 273939 GiB |
|       from large pool |   1650 MiB |   5036 MiB | 271714 GiB | 271712 GiB |
|       from small pool |      7 MiB |     14 MiB |   2227 GiB |   2227 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1657 MiB |   5046 MiB | 273941 GiB | 273939 GiB |
|       from large pool |   1650 MiB |   5036 MiB | 271714 GiB | 271712 GiB |
|       from small pool |      7 MiB |     14 MiB |   2227 GiB |   2227 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |   5034 MiB | 272863 GiB | 272862 GiB |
|       from large pool |   1647 MiB |   5024 MiB | 270639 GiB | 270637 GiB |
|       from small pool |      6 MiB |     13 MiB |   2224 GiB |   2224 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5424 MiB |   5424 MiB |   5424 MiB |      0 B   |
|       from large pool |   5408 MiB |   5408 MiB |   5408 MiB |      0 B   |
|       from small pool |     16 MiB |     16 MiB |     16 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 284864 KiB | 434522 KiB |  58859 GiB |  58859 GiB |
|       from large pool | 279936 KiB | 432718 KiB |  56623 GiB |  56623 GiB |
|       from small pool |   4928 KiB |   6949 KiB |   2235 GiB |   2235 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   22188 K  |   22185 K  |
|       from large pool |     247    |     352    |    9002 K  |    9002 K  |
|       from small pool |    2399    |    3599    |   13185 K  |   13183 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   22188 K  |   22185 K  |
|       from large pool |     247    |     352    |    9002 K  |    9002 K  |
|       from small pool |    2399    |    3599    |   13185 K  |   13183 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     166    |     166    |     166    |       0    |
|       from large pool |     158    |     158    |     158    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     557    |   10480 K  |   10480 K  |
|       from large pool |      87    |     121    |    5458 K  |    5458 K  |
|       from small pool |      15    |     451    |    5021 K  |    5021 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5046 MiB | 273941 GiB | 273941 GiB |
|       from large pool |  16640 KiB |   5036 MiB | 271714 GiB | 271713 GiB |
|       from small pool |      0 KiB |     14 MiB |   2227 GiB |   2227 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5046 MiB | 273941 GiB | 273941 GiB |
|       from large pool |  16640 KiB |   5036 MiB | 271714 GiB | 271713 GiB |
|       from small pool |      0 KiB |     14 MiB |   2227 GiB |   2227 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5034 MiB | 272863 GiB | 272863 GiB |
|       from large pool |  16640 KiB |   5024 MiB | 270639 GiB | 270639 GiB |
|       from small pool |      0 KiB |     13 MiB |   2224 GiB |   2224 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1936 MiB |   5424 MiB |   5424 MiB |   3488 MiB |
|       from large pool |   1924 MiB |   5408 MiB |   5408 MiB |   3484 MiB |
|       from small pool |     12 MiB |     16 MiB |     16 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 434522 KiB |  58860 GiB |  58860 GiB |
|       from large pool |  24320 KiB | 432718 KiB |  56624 GiB |  56624 GiB |
|       from small pool |      0 KiB |  11346 KiB |   2235 GiB |   2235 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   22188 K  |   22188 K  |
|       from large pool |       2    |     352    |    9002 K  |    9002 K  |
|       from small pool |       0    |    3599    |   13185 K  |   13185 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   22188 K  |   22188 K  |
|       from large pool |       2    |     352    |    9002 K  |    9002 K  |
|       from small pool |       0    |    3599    |   13185 K  |   13185 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     166    |     166    |      71    |
|       from large pool |      89    |     158    |     158    |      69    |
|       from small pool |       6    |       8    |       8    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     557    |   10480 K  |   10480 K  |
|       from large pool |       3    |     121    |    5458 K  |    5458 K  |
|       from small pool |       0    |     451    |    5021 K  |    5021 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5046 MiB | 273941 GiB | 273941 GiB |
|       from large pool |  16640 KiB |   5036 MiB | 271714 GiB | 271713 GiB |
|       from small pool |      0 KiB |     14 MiB |   2227 GiB |   2227 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5046 MiB | 273941 GiB | 273941 GiB |
|       from large pool |  16640 KiB |   5036 MiB | 271714 GiB | 271713 GiB |
|       from small pool |      0 KiB |     14 MiB |   2227 GiB |   2227 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5034 MiB | 272863 GiB | 272863 GiB |
|       from large pool |  16640 KiB |   5024 MiB | 270639 GiB | 270639 GiB |
|       from small pool |      0 KiB |     13 MiB |   2224 GiB |   2224 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1936 MiB |   5424 MiB |   5424 MiB |   3488 MiB |
|       from large pool |   1924 MiB |   5408 MiB |   5408 MiB |   3484 MiB |
|       from small pool |     12 MiB |     16 MiB |     16 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 434522 KiB |  58860 GiB |  58860 GiB |
|       from large pool |  24320 KiB | 432718 KiB |  56624 GiB |  56624 GiB |
|       from small pool |      0 KiB |  11346 KiB |   2235 GiB |   2235 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   22188 K  |   22188 K  |
|       from large pool |       2    |     352    |    9002 K  |    9002 K  |
|       from small pool |       0    |    3599    |   13185 K  |   13185 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   22188 K  |   22188 K  |
|       from large pool |       2    |     352    |    9002 K  |    9002 K  |
|       from small pool |       0    |    3599    |   13185 K  |   13185 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     166    |     166    |      71    |
|       from large pool |      89    |     158    |     158    |      69    |
|       from small pool |       6    |       8    |       8    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     557    |   10480 K  |   10480 K  |
|       from large pool |       3    |     121    |    5458 K  |    5458 K  |
|       from small pool |       0    |     451    |    5021 K  |    5021 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524

 Experiment start at: 2024-07-28 17:06:58.549838
before training, model accuracy: 0.09417197853326797
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93942636, 'precision': 0.8531947, 'recall': 0.84333754, 'specificity': 0.99353755, 'f1': 0.8434841, 'auroc': 0.996047}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    1     6    1    0    18     6     4    7     30
1     0  1257    0    20    0    0     0    51     3    0      0
2     2     1  158     2   66    1     2    12     8   59      1
3     1     0    0  8164    0   23     0    86   163    1      0
4     2     1   10     2  383    1     3     4    25   15     93
5     0     0    3    32    2  378     0     0     7   98      1
6    13     2    0     5    4    2  1857     3     7    5     10
7     1    14    0   473    3    0     4  6678    78    5      9
8     2     3    1   103   28    3     1    77  3041    9     26
9     1     0   30    10    4   53     1     3     2  388      0
10   19     8    3    11  243    1    41    19    45    5  12398
---- Validation: 
scalar performance:
{'acc': 0.9371673, 'precision': 0.850807, 'recall': 0.8377435, 'specificity': 0.99329627, 'f1': 0.83825314, 'auroc': 0.9959579}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0     9    4    1    19     2     3    3     28
1     0  1263    0    20    0    0     0    45     2    0      2
2     2     1  153     1   66    1     1     9     7   71      0
3     1     0    0  8161    0   22     1    98   155    2      0
4     6     3    6     2  371    2     3     3    30   16     97
5     0     0    0    36    1  370     0     0     5  108      1
6    16     2    0     9    1    2  1856     3     8    6      5
7     1    17    0   475    4    1     2  6674    78    6      7
8     1     0    4   114   20    2     3    79  3032    5     36
9     2     0   23     8    6   56     0     6     7  383      2
10   19    10    2     9  260    1    47    31    54    4  12359
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77226615, 'precision': 0.6982659, 'recall': 0.6456636, 'specificity': 0.9772147, 'f1': 0.6539571, 'auroc': 0.88740414}
confusion matrix:
      0     1   2    3     4    5     6    7     8    9     10
0   1025     3   1   30     5    2    40   11    24   26     3
1      0  1380   1   30     1    0     2   73     2    8     2
2      4    26  71    7   601    4     5   26   154  108     9
3      0     0   0    0     0    0     0    0     0    0     0
4      1    17   1    0  1086    0    12    0    11    1   504
5      7     0   1   39     0  291     2    0    18  232     2
6      0    11   0    5     3    0  3034    3     9    0     2
7      0     6   0  239     0    1     2  910     2    0     4
8      0     0   0   83    11    3     4    4  1259    4     2
9      7    36  94   63    54   36     6   30   131  680     0
10     0    13   0    0   317    0    12    1     1    0  1302
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 17:43:29.387238,epoch time: 0:36:30.837400,used: 0:36:30.837400,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94962007, 'precision': 0.884342, 'recall': 0.84675705, 'specificity': 0.9944713, 'f1': 0.864146, 'auroc': 0.997403}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    0     9    1    1    12    20     2    2     44
1     0  1283    0     6    0    0     0    40     3    0      0
2     6     0  205     1   34    0     2    29     6   27      2
3     0     2    0  7948    0   13     0   358   118    0      0
4     1     0   25     0  345    2     1    16    24    4    121
5     4     0    1    25    0  391     0     1     9   89      1
6    10     2    0    11    2    0  1844    17     9    2     11
7     0    11    0    69    1    0     1  7158    17    0      6
8     1     1    4    80    8    2     0   175  2983    0     40
9     6     1   60    11    1   36     2    20     7  349      0
10   12     1    3     7   64    1    17    72    20    0  12595
---- Validation: 
scalar performance:
{'acc': 0.9513976, 'precision': 0.8900579, 'recall': 0.8548777, 'specificity': 0.99466425, 'f1': 0.8712636, 'auroc': 0.9973067}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     0    0     5    2    0    10    20     1    0     37
1     0  1290    0     9    0    0     0    31     2    0      0
2     1     0  204     2   38    1     3    29     4   24      6
3     0     1    0  7961    0   13     0   358   106    1      0
4     2     0   22     1  357    1     3    13    19    3    118
5     4     0    3    24    0  395     0     0     9   85      1
6     6     2    1    14    1    0  1849    11     6    0     18
7     0    11    0    65    1    0     1  7158    23    1      5
8     1     5    4    75   10    1     0   172  2993    2     33
9     6     0   57     7    1   34     4    19     6  358      1
10    8     1    2     6   66    0    19    73    26    0  12595
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.739173, 'precision': 0.681128, 'recall': 0.6219431, 'specificity': 0.97396654, 'f1': 0.61458504, 'auroc': 0.8888296}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   971     5    0   91    0    0    22    61    10    4     6
1     0  1358    0   12    0    1     1   114     2    0    11
2    13    16  143   18  238   10    18    80   335   36   108
3     0     0    0    0    0    0     0     0     0    0     0
4     2     3    3    0  479    0     4     3    19    0  1120
5    11     0    1  139    2  341     7     0    26   64     1
6     0    10    0    6    1    0  2993     4    24    0    29
7     0     0    0   42    0    0     0  1121     0    0     1
8     0     1    0  106    0    0     0    19  1240    2     2
9    19    54  106  132   13  102     5   161   222  314     9
10    0     2    0    0   36    0     2     1     0    0  1605
better model found
persisted
after epoch: 2,now: 2024-07-28 18:19:51.766594,epoch time: 0:36:22.379356,used: 1:12:53.216756,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9625963, 'precision': 0.9000505, 'recall': 0.88733286, 'specificity': 0.99597085, 'f1': 0.89145815, 'auroc': 0.99819005}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     1    0    0     2     1     3    0     15
1     0  1283    0     6    0    0     1    37     5    0      0
2     3     0  248     1   29    1     2     7     3   16      2
3     2     0    0  8072    0    6     0   227   128    2      0
4     4     0   29     0  372    0     1     6    17    6    104
5     1     0    2    27    0  449     0     0     7   34      1
6    18     0    1     4    0    0  1866     2     4    0     13
7     0     6    1    73    1    0     2  7125    49    0      6
8     0     1    3    48    9    1     2    74  3132    3     23
9     1     0   79     6    0   74     1     5    11  316      0
10   17     2    5     7   47    1     7    21    31    0  12654
---- Validation: 
scalar performance:
{'acc': 0.96166915, 'precision': 0.89513457, 'recall': 0.8826642, 'specificity': 0.99588823, 'f1': 0.88644964, 'auroc': 0.99827194}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    1     2    1    0     4     1     1    0     16
1     0  1282    0     8    0    0     1    37     2    0      2
2     1     0  242     0   25    3     1    10     6   22      2
3     2     1    0  8073    0    9     2   221   131    0      1
4     4     0   33     1  367    1     1     6    23    4     99
5     2     0    3    23    0  448     0     0     8   36      1
6    12     0    1     1    0    0  1873     1     4    1     15
7     5     9    1    81    1    0     3  7111    49    0      5
8     0     1    3    52    8    2     3    78  3128    0     21
9     6     0   78     2    0   79     2     3    13  310      0
10   27     2    1     7   42    0    13    12    30    1  12661
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7630308, 'precision': 0.6954539, 'recall': 0.65257025, 'specificity': 0.9764372, 'f1': 0.64297384, 'auroc': 0.88925433}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1134     0    0    6    3    9     5    0     5    7     1
1      2  1371    0   22    0    0     2   87     5    1     9
2     12     5  203    6  286   29     7   20   317   28   102
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    6    0  682    0     4    1    17    1   921
5      7     0    1   67    2  479     0    0    18   14     4
6      0     0    0    2    1    0  3041    2     5    0    16
7      4     0    0  248    0    1     3  888    18    0     2
8      0     0    0   60    0    3     1    1  1301    2     2
9     24    12  210   96   12  218     3   28   277  242    15
10     0     1    0    0   77    0     2    0     1    0  1565
better model found
persisted
after epoch: 3,now: 2024-07-28 18:55:43.247280,epoch time: 0:35:51.480686,used: 1:48:44.697442,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9655394, 'precision': 0.89562464, 'recall': 0.90321314, 'specificity': 0.9963828, 'f1': 0.89605963, 'auroc': 0.9987689}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    1     2    0    1     7     0     1    1     19
1     0  1293    0     7    0    0     0    27     2    0      2
2     0     0  284     0   11    1     1     0     2   13      0
3     1     0    2  8236    0   19     0    66   112    2      0
4     2     0   61     1  387    0     2     1    14    1     70
5     1     0    2     7    1  413     0     0     6   91      0
6     5     0    2     4    1    1  1869     1     7    0     18
7     2    12    7   146    1    0     2  6964   121    0      8
8     0     0    9    41   11    3     0    27  3193    1     11
9     1     0   86     3    0   32     0     0     7  364      0
10   18     0   12     8   59    1     4     6    50    0  12634
---- Validation: 
scalar performance:
{'acc': 0.9662967, 'precision': 0.89905727, 'recall': 0.90573955, 'specificity': 0.99645555, 'f1': 0.8992411, 'auroc': 0.9987275}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    2     2    2    1     3     1     2    0     20
1     0  1295    0     7    0    0     0    25     2    0      3
2     0     0  288     0    8    2     2     0     3    9      0
3     1     1    1  8232    0   22     0    70   113    0      0
4     3     1   57     1  390    0     0     0    16    0     71
5     0     0    4     4    0  416     1     0     6   88      2
6     5     0    1     2    1    0  1878     0     7    0     14
7     0    12    6   140    1    0     1  6992   106    0      7
8     1     0    7    46   11    2     0    30  3185    3     11
9     1     0   86     4    1   30     1     0     6  364      0
10   12     0    8     9   67    0     8     4    53    0  12635
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7430211, 'precision': 0.68317443, 'recall': 0.63606125, 'specificity': 0.97420657, 'f1': 0.635426, 'auroc': 0.882473}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1088     0    1    5    3   13    33    1     8    4    14
1      2  1339    6   17    2    5     1   58     6    2    61
2      2     0  249    0  402   12     4    4   184   21   137
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    3    0  377    0     1    0    10    0  1242
5      7     0    6   23    8  435     0    0    32   74     7
6      0     0    1    0    2    1  2983    0    15    0    65
7      1     0    5  304    0    1     5  807    32    0     9
8      0     0    0   19    3    8     2    1  1333    1     3
9     17     2  309   20   38  112     3    3   219  379    35
10     0     0    0    0   15    0     0    0     1    0  1630
better model found
persisted
after epoch: 4,now: 2024-07-28 19:30:49.615630,epoch time: 0:35:06.368350,used: 2:23:51.065792,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9685092, 'precision': 0.9313637, 'recall': 0.9019292, 'specificity': 0.99652195, 'f1': 0.9110261, 'auroc': 0.9991733}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     3    1    0     7     0     0    0     15
1     0  1305    0     5    0    0     0    19     2    0      0
2     0     0  272     0    6    1     0     0     2   25      6
3     0     0    0  8224    0    8     2    67   132    4      0
4     5     0   27     0  298    1     0     0    23    3    182
5     0     0    1    15    0  440     0     0    10   54      1
6     8     0    0     1    0    0  1873     1     4    2     19
7     1    18    2   135    1    0     1  6959   139    0      7
8     2     0    2    31    1    0     0    16  3224    0     20
9     0     0   44     4    0   27     0     0     2  412      3
10   18     0    1     7    2    1     4     4    22    0  12736
---- Validation: 
scalar performance:
{'acc': 0.9686773, 'precision': 0.9292528, 'recall': 0.9004197, 'specificity': 0.99653536, 'f1': 0.9095635, 'auroc': 0.9992156}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     1    0     1    0    0     7     0     2    1     15
1     0  1303    0     5    0    1     0    18     4    0      1
2     0     0  269     0   10    1     0     1     4   20      7
3     0     3    0  8238    0    9     2    71   115    2      0
4     6     0   30     1  302    1     1     1    14    1    182
5     0     0    2     9    0  439     0     0    11   60      0
6     5     0    1     0    0    0  1877     0     4    2     19
7     2    13    3   140    1    0     2  6958   136    1      9
8     1     0    2    25    1    0     0    14  3225    1     27
9     0     0   47     2    0   27     1     0     6  407      3
10   18     0    0     7    2    0     1     3    25    0  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72867835, 'precision': 0.6675693, 'recall': 0.62197304, 'specificity': 0.97254163, 'f1': 0.60531795, 'auroc': 0.8816519}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1082     0    1   8    0    0    37     9    13   13     7
1      0  1345    1  14    0    0     0   106     3    3    27
2      8     3  177   1   99    6    10    17   256   38   400
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0  134    0     1     1    15    0  1480
5      6     0   12  56    1  324     0     0    43  142     8
6      2     0    0   2    0    0  2857     3    15    0   188
7      0     0    0  28    0    1     1  1118    15    0     1
8      0     0    1  14    1    3     5     0  1344    0     2
9     10     5  266  35    2   68     7    34   257  394    59
10     0     0    0   0    6    0     0     0     0    0  1640
better model found
persisted
after epoch: 5,now: 2024-07-28 20:06:33.070135,epoch time: 0:35:43.454505,used: 2:59:34.520297,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97217464, 'precision': 0.9187758, 'recall': 0.92275393, 'specificity': 0.99712825, 'f1': 0.9137796, 'auroc': 0.99936914}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     1    0     1    5    0     0     0     0    0      8
1     0  1324    1     1    0    0     0     3     3    0      0
2     1     0  291     1    9    2     1     0     4    3      0
3     0    14    1  8239    0    3     3    71   105    0      0
4     0     0   19     0  449    0     3     1    11    0     56
5     1     0    2    15    0  492     0     0     3    7      0
6    11     1    0     0    0    0  1888     1     3    0      4
7     3   104    1    75    2    0     1  7012    55    0     12
8     0     0    3    31    5    1     0    15  3232    0      9
9     1     0  110     3    2   85     1     2     6  283      0
10   14     0    2     7   29    0    52     1    29    0  12658
---- Validation: 
scalar performance:
{'acc': 0.9715394, 'precision': 0.9136373, 'recall': 0.9197104, 'specificity': 0.9970749, 'f1': 0.9088923, 'auroc': 0.9993528}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    4    0     3     0     0    1      8
1     0  1328    0     0    0    0     0     3     1    0      0
2     2     0  290     1   11    0     1     0     1    4      2
3     2    14    1  8238    0    3     1    71   110    0      0
4     0     0   20     0  444    1     4     0    15    0     55
5     2     0    2    13    1  494     0     0     3    5      1
6    20     0    0     0    0    0  1883     0     1    0      4
7     1   106    3    72    2    0     1  7015    55    0     10
8     0     4    2    24    3    1     1    20  3230    0     11
9     4     0  118     2    3   85     1     1     4  274      1
10   19     0    3     7   30    1    47     0    30    0  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7413419, 'precision': 0.6882098, 'recall': 0.61860025, 'specificity': 0.9740424, 'f1': 0.6098813, 'auroc': 0.88619053}
confusion matrix:
      0     1    2    3    4    5     6    7     8   9     10
0   1044     6    1   19    2    6    41   29    15   5     2
1      1  1435    1   10    1    0    12   26     5   0     8
2      4    10  255   23  114   27    71   11   464  10    26
3      0     0    0    0    0    0     0    0     0   0     0
4      1     3   17    0  603    0   106    0    76   0   827
5      8     1    3  207    1  325    14    1    23   8     1
6      0     0    0    3    1    0  3050    3    10   0     0
7      0    15    0  132    0    0     2  994    20   0     1
8      0     4    0   63    0    2    11    3  1286   0     1
9     11    51  232  180    1  219    34   22   292  88     7
10     0     1    0    0   60    0    65    1     3   0  1516
better model found
persisted
after epoch: 6,now: 2024-07-28 20:41:41.893411,epoch time: 0:35:08.823276,used: 3:34:43.343573,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97498393, 'precision': 0.94744635, 'recall': 0.91537917, 'specificity': 0.99719965, 'f1': 0.92711985, 'auroc': 0.99953014}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     0    0    0     6     2     0    1     41
1     0  1313    0     2    0    0     0    13     3    0      0
2     0     0  245     0   17    0     2     0     0   43      5
3     0     3    0  8204    0    6     0   113   110    2      0
4     1     0    5     0  420    0     2     0     2    1    108
5     0     0    0     3    0  388     0     0     5  124      1
6     3     1    0     0    0    0  1886     1     0    0     17
7     0    13    2    53    3    0     1  7136    38    3     15
8     0     0    4    21    6    0     1    15  3172    3     74
9     0     0    9     1    0    2     1     0     0  480      0
10    1     0    0     6   11    0     4     1     4    0  12764
---- Validation: 
scalar performance:
{'acc': 0.97354555, 'precision': 0.9423953, 'recall': 0.91181165, 'specificity': 0.99704856, 'f1': 0.9227952, 'auroc': 0.9995429}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     0    1    1     7     3     1    2     48
1     0  1314    0     1    0    0     0    15     2    0      0
2     0     0  252     0   13    0     3     0     1   37      6
3     4     3    0  8193    0    7     1   129    99    2      2
4     1     0    5     0  411    0     1     1     0    3    117
5     0     0    0     7    0  380     1     0     3  129      1
6     3     0    0     1    0    0  1891     2     2    0      9
7     0    16    4    48    1    0     2  7117    51    1     25
8     1     0    7    20   13    1     1    17  3177    2     57
9     0     0    9     1    0    3     0     0     0  479      1
10    1     1    2     6    9    0     6     1     6    2  12762
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74232143, 'precision': 0.6719467, 'recall': 0.6152319, 'specificity': 0.97385, 'f1': 0.61811537, 'auroc': 0.8851603}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   862     4    1   21    4    1   127    51    21   45    33
1     0  1430    0    8    0    0     1    44     3    4     9
2     2     7  214    4  349    4    46     8   178   49   154
3     0     0    0    0    0    0     0     0     0    0     0
4     0     2    7    0  363    0    27     0    10    0  1224
5     2     0    5   90    4  227    17     0    30  215     2
6     0     0    0    1    1    0  3058     2     3    0     2
7     0     6    3  101    0    1     1  1035    14    0     3
8     0     0    0   36    8    0    14     2  1300    4     6
9     4    20  247   43   21   47    26    24   177  502    26
10    0     1    0    0   16    0    10     0     0    0  1619
better model found
persisted
after epoch: 7,now: 2024-07-28 21:16:58.374130,epoch time: 0:35:16.480719,used: 4:09:59.824292,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97891694, 'precision': 0.95246273, 'recall': 0.9428899, 'specificity': 0.99770945, 'f1': 0.9462243, 'auroc': 0.999604}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     3    3    0     0     0     0    2      9
1     0  1317    0     4    0    0     0    10     0    0      0
2     0     0  251     0    7    1     0     0     1   51      1
3     0     0    1  8343    0    4     1    24    61    1      0
4     2     1   17     0  446    0     0     0    11    3     59
5     0     0    0     4    0  467     0     0     4   46      0
6     2     0    0     2    0    0  1895     1     0    2      6
7     4    15    2   197    1    0     2  6975    60    3      6
8     1     1    2    34    4    0     0    11  3226    4     13
9     0     0    0     1    0   12     0     0     0  480      0
10    4     0    3     6   16    0    19     6    15    2  12722
---- Validation: 
scalar performance:
{'acc': 0.9792163, 'precision': 0.9532685, 'recall': 0.94276446, 'specificity': 0.99774355, 'f1': 0.9462302, 'auroc': 0.9996948}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    3    0     4     0     0    1     10
1     0  1317    0     3    0    0     0    12     0    0      0
2     1     0  250     0    2    1     0     0     0   56      2
3     0     1    0  8347    0    5     0    25    59    3      0
4     3     0   10     0  447    1     0     0     9    4     65
5     0     0    0     1    0  471     0     0     1   48      0
6     1     0    0     1    2    0  1894     1     1    3      5
7     2    14    3   173    1    0     2  6988    62   11      9
8     0     0    2    34    4    0     1    13  3226    3     13
9     0     0    3     2    1    9     0     0     0  478      0
10    4     0    1     7   15    1    16     2    21    3  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77737355, 'precision': 0.72181374, 'recall': 0.654417, 'specificity': 0.9778134, 'f1': 0.6663213, 'auroc': 0.8892332}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   967     3    5   25   10    3    10   20    27   81    19
1     1  1321    1   20    1    0     0  120     6   13    16
2     2     0  307    8  251    8     1    4   220  132    82
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    9    0  650    0     4    0    18    0   952
5     1     0    2   85    4  238     0    0    13  247     2
6     1     0    0    6    3    0  3026    2    19    0    10
7     0     1    1  165    0    0     0  975    17    2     3
8     0     2    1   75    0    4     1    1  1279    7     0
9     2     3  134   69    7   41     1    8   105  750    17
10    0     0    0    0   45    0     2    0     1    0  1598
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-28 21:58:55.816641,epoch time: 0:41:57.442511,used: 4:51:57.266803,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9847228, 'precision': 0.9632246, 'recall': 0.9497938, 'specificity': 0.9983208, 'f1': 0.9553931, 'auroc': 0.999772}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    2    0     0     0     1    0      4
1     0  1327    0     0    0    0     0     4     1    0      0
2     0     0  247     1   12    0     0     0     1   48      3
3     0     1    0  8359    1    2     0    33    41    2      1
4     4     0    3     0  468    0     0     0     1    1     62
5     0     0    0     3    0  507     0     0     4    7      0
6     0     0    0     1    1    0  1897     0     0    0      8
7     2     9    1    95    1    0     2  7114    34    1      4
8     1     1    0    26    9    1     0     8  3220    1     28
9     1     0    1     2    0   47     1     0     0  440      0
10    5     2    0     5   10    0    13     2     4    1  12750
---- Validation: 
scalar performance:
{'acc': 0.9850742, 'precision': 0.965144, 'recall': 0.95311016, 'specificity': 0.9983654, 'f1': 0.9580708, 'auroc': 0.99978036}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    2    1     3     1     1    0      8
1     0  1329    0     1    0    0     0     2     0    0      0
2     3     0  250     0   13    2     0     0     2   41      1
3     1     2    0  8364    0    6     0    29    38    0      0
4     2     0    1     0  475    0     1     0     0    0     60
5     0     0    0     4    0  503     0     0     2   12      0
6     3     0    0     0    0    0  1901     1     1    0      2
7     2    15    0   106    2    0     2  7094    35    1      8
8     0     1    0    30    7    3     0     6  3230    3     16
9     0     0    1     0    0   32     1     0     0  459      0
10    4     0    1     5   12    1     8     4     6    0  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75904286, 'precision': 0.68440175, 'recall': 0.64574957, 'specificity': 0.97581935, 'f1': 0.6386297, 'auroc': 0.88242275}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1075     0    0    8    6    2    22    24    16    9     8
1      2  1335    0   15    1    0     1   113     7   13    12
2      6     4  159    9  386   18    11    18   264   70    70
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    6    0  417    0    12     0    19    0  1179
5      9     0    3  103    4  366     8     2    11   85     1
6      1     0    0    2    1    0  3032     2     7    0    22
7      0     2    0   60    1    1     0  1085    11    1     3
8      0     0    0   77    8    3     6    11  1258    4     3
9     13    12   88   95   26  167     9    39   178  498    12
10     0     1    0    0   16    0     4     0     1    0  1624
better model found
persisted
after epoch: 9,now: 2024-07-28 22:46:43.006924,epoch time: 0:47:47.190283,used: 5:39:44.457086,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9871843, 'precision': 0.9681581, 'recall': 0.95499575, 'specificity': 0.9986487, 'f1': 0.95968574, 'auroc': 0.99985653}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    1    0     8     0     0    0      1
1     0  1316    0     0    0    0     0    14     1    0      1
2     0     0  236     0   13    1     1     1     0   60      0
3     0     2    0  8336    0    3     2    50    45    1      0
4     3     0    0     0  499    0     2     0    10    3     22
5     0     0    0     4    0  491     0     0     2   24      0
6     0     0    0     0    0    0  1902     1     1    2      2
7     1     3    0    50    1    0     1  7170    30    1      5
8     0     0    0     7    1    0     2    19  3252    2     12
9     0     0    0     1    0   18     1     0     1  472      0
10    4     0    1     4   11    1     4     5    12    0  12750
---- Validation: 
scalar performance:
{'acc': 0.9855557, 'precision': 0.9636574, 'recall': 0.9515296, 'specificity': 0.99848485, 'f1': 0.95576304, 'auroc': 0.9998218}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     1    0    1    11     0     1    0      0
1     0  1314    0     0    0    0     1    17     0    0      0
2     0     0  237     0    8    0     0     3     0   64      0
3     0     1    0  8323    1    2     2    53    57    0      1
4     8     0    3     0  492    0     1     0    10    3     22
5     0     0    0     8    0  484     0     0     3   26      0
6     0     0    0     0    1    0  1902     0     0    2      3
7     1     3    0    51    2    0     3  7174    26    1      4
8     0     0    0    14    0    0     1    23  3247    4      7
9     0     0    0     1    0   19     0     0     1  472      0
10    4     0    1     7   16    1    11     7    16    2  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72636956, 'precision': 0.6666888, 'recall': 0.62037456, 'specificity': 0.97251606, 'f1': 0.59955364, 'auroc': 0.8740974}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1017     0    1  10    4   30    43    28     9   21     7
1      1  1266    0  14    0    2     2   173     4    0    37
2      2     1  108   4  183   18     4    19   502   77    97
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   0  253    0     4     1    54    1  1317
5      2     0    2  83    4  387     0     1    28   79     6
6      3     0    0   3    1    0  2918     4    45    0    93
7      0     0    0  48    1    1     0  1097    14    0     3
8      0     0    0  68    0    7     6    16  1271    1     1
9      5     7   52  75   13  174     2    87   264  438    20
10     0     0    0   0   17    0     0     1     1    0  1627
better model found
persisted
after epoch: 10,now: 2024-07-28 23:44:17.480065,epoch time: 0:57:34.473141,used: 6:37:18.930227,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:37:18.930227 at 2024-07-28 23:44:17.480065
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72636956, 'precision': 0.6666888, 'recall': 0.62037456, 'specificity': 0.97251606, 'f1': 0.59955364, 'auroc': 0.8740974}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1017     0    1  10    4   30    43    28     9   21     7
1      1  1266    0  14    0    2     2   173     4    0    37
2      2     1  108   4  183   18     4    19   502   77    97
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   0  253    0     4     1    54    1  1317
5      2     0    2  83    4  387     0     1    28   79     6
6      3     0    0   3    1    0  2918     4    45    0    93
7      0     0    0  48    1    1     0  1097    14    0     3
8      0     0    0  68    0    7     6    16  1271    1     1
9      5     7   52  75   13  174     2    87   264  438    20
10     0     0    0   0   17    0     0     1     1    0  1627
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77737355, 'precision': 0.72181374, 'recall': 0.654417, 'specificity': 0.9778134, 'f1': 0.6663213, 'auroc': 0.8892332}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   967     3    5   25   10    3    10   20    27   81    19
1     1  1321    1   20    1    0     0  120     6   13    16
2     2     0  307    8  251    8     1    4   220  132    82
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    9    0  650    0     4    0    18    0   952
5     1     0    2   85    4  238     0    0    13  247     2
6     1     0    0    6    3    0  3026    2    19    0    10
7     0     1    1  165    0    0     0  975    17    2     3
8     0     2    1   75    0    4     1    1  1279    7     0
9     2     3  134   69    7   41     1    8   105  750    17
10    0     0    0    0   45    0     2    0     1    0  1598
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_17_06_58_seed_1_23104524_instance_wise_predictions.txt
accuracy from prediction file 0.7263695515287204
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1658 MiB |   5047 MiB | 547579 GiB | 547577 GiB |
|       from large pool |   1651 MiB |   5038 MiB | 543125 GiB | 543123 GiB |
|       from small pool |      7 MiB |     14 MiB |   4454 GiB |   4454 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1658 MiB |   5047 MiB | 547579 GiB | 547577 GiB |
|       from large pool |   1651 MiB |   5038 MiB | 543125 GiB | 543123 GiB |
|       from small pool |      7 MiB |     14 MiB |   4454 GiB |   4454 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |   5034 MiB | 545727 GiB | 545726 GiB |
|       from large pool |   1647 MiB |   5024 MiB | 541278 GiB | 541276 GiB |
|       from small pool |      6 MiB |     13 MiB |   4449 GiB |   4449 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5382 MiB |   5424 MiB |   8870 MiB |   3488 MiB |
|       from large pool |   5366 MiB |   5408 MiB |   8850 MiB |   3484 MiB |
|       from small pool |     16 MiB |     16 MiB |     20 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 261248 KiB | 434522 KiB | 143652 GiB | 143651 GiB |
|       from large pool | 256320 KiB | 432718 KiB | 139179 GiB | 139179 GiB |
|       from small pool |   4928 KiB |  11346 KiB |   4472 GiB |   4472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   44376 K  |   44374 K  |
|       from large pool |     247    |     352    |   18005 K  |   18005 K  |
|       from small pool |    2399    |    3599    |   26371 K  |   26369 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   44376 K  |   44374 K  |
|       from large pool |     247    |     352    |   18005 K  |   18005 K  |
|       from small pool |    2399    |    3599    |   26371 K  |   26369 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     163    |     166    |     234    |      71    |
|       from large pool |     155    |     158    |     224    |      69    |
|       from small pool |       8    |       8    |      10    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     557    |   21364 K  |   21364 K  |
|       from large pool |      85    |     121    |   11285 K  |   11285 K  |
|       from small pool |      17    |     451    |   10079 K  |   10079 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5047 MiB | 547579 GiB | 547579 GiB |
|       from large pool |  16640 KiB |   5038 MiB | 543125 GiB | 543125 GiB |
|       from small pool |      0 KiB |     14 MiB |   4454 GiB |   4454 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5047 MiB | 547579 GiB | 547579 GiB |
|       from large pool |  16640 KiB |   5038 MiB | 543125 GiB | 543125 GiB |
|       from small pool |      0 KiB |     14 MiB |   4454 GiB |   4454 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5034 MiB | 545727 GiB | 545727 GiB |
|       from large pool |  16640 KiB |   5024 MiB | 541278 GiB | 541278 GiB |
|       from small pool |      0 KiB |     13 MiB |   4449 GiB |   4449 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1914 MiB |   5424 MiB |   8870 MiB |   6956 MiB |
|       from large pool |   1902 MiB |   5408 MiB |   8850 MiB |   6948 MiB |
|       from small pool |     12 MiB |     16 MiB |     20 MiB |      8 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 434522 KiB | 143653 GiB | 143653 GiB |
|       from large pool |  24320 KiB | 432718 KiB | 139180 GiB | 139180 GiB |
|       from small pool |      0 KiB |  11365 KiB |   4472 GiB |   4472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44376 K  |   44376 K  |
|       from large pool |       2    |     352    |   18005 K  |   18005 K  |
|       from small pool |       0    |    3599    |   26371 K  |   26371 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44376 K  |   44376 K  |
|       from large pool |       2    |     352    |   18005 K  |   18005 K  |
|       from small pool |       0    |    3599    |   26371 K  |   26371 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     166    |     234    |     141    |
|       from large pool |      87    |     158    |     224    |     137    |
|       from small pool |       6    |       8    |      10    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     557    |   21365 K  |   21365 K  |
|       from large pool |       3    |     121    |   11285 K  |   11285 K  |
|       from small pool |       0    |     451    |   10079 K  |   10079 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 23:58:35 2024]
Finished job 0.
1 of 1 steps (100%) done
