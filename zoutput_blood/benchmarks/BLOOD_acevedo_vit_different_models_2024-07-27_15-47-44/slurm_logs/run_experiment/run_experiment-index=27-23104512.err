Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 15:50:05 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/27.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=27
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512

 Experiment start at: 2024-07-27 16:14:25.184958
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.12040859460830688
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94282424, 'precision': 0.8811907, 'recall': 0.8101938, 'specificity': 0.99371517, 'f1': 0.83233744, 'auroc': 0.99601716}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   368     0    0     3    0    0    34     5     9    2     61
1     0  1249    0    15    0    0     0    57     4    0      7
2     3     0  175     0   29    0     1    10     9   74     11
3     1     1    0  7828    0   20     7   308   269    2      0
4     1     0   22     0  234    1     2     3    35   19    222
5     1     0    2    25    0  295     2     0    13  182      1
6     6     0    0     0    0    0  1862     7     7    3     22
7     0    11    2   114    2    0     4  7027    89    3     13
8     0     0    3    58    6    1     5    77  3083    5     57
9     1     0   25     5    0   23     4     4     9  419      3
10    8     0    2     8    8    0    17    13    38    1  12699
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.942945, 'precision': 0.88282895, 'recall': 0.81467766, 'specificity': 0.99372816, 'f1': 0.8361477, 'auroc': 0.9960723}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   372     0    0     2    0    0    34     5     5    7     58
1     0  1237    0    12    0    0     1    70     5    0      7
2     2     0  187     0   23    1     3    10     5   68     13
3     2     0    0  7835    0   15    13   300   272    3      0
4     0     0   23     0  229    1     3     5    37   20    221
5     1     0    2    23    0  313     0     0    12  169      1
6     6     0    0     1    0    0  1865     3     7    1     25
7     0     8    1   131    0    0     3  7009    94    2     17
8     1     0    5    48    7    2     5    72  3095    8     53
9     2     0   29     3    1   28     3     3    10  412      2
10    5     1    2     4    8    0    22    16    37    3  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7463794, 'precision': 0.67704463, 'recall': 0.63901603, 'specificity': 0.974293, 'f1': 0.6229354, 'auroc': 0.8875776}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1048     0    0   2    0    0    78    10     6   20     6
1      2  1212    0  25    1    1     1   202     4   10    41
2     10     1  210   6  152   13    32    52   229  152   158
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    3   0  179    0     1     1    16    0  1431
5     31     0    0  20    1  342     8     0    13  176     1
6      0     0    0   1    2    0  3000     4    45    0    15
7      2     1    0  25    0    0    13  1117     0    2     4
8      0     0    1  43    1    4    21     8  1286    4     2
9     33     8   99  31    3   94    18    75   116  635    25
10     0     0    0   0    7    0     0     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 17:11:05.662817,epoch time: 0:56:40.477859,used: 0:56:40.477859,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9542755, 'precision': 0.8915764, 'recall': 0.8522315, 'specificity': 0.9949111, 'f1': 0.8644987, 'auroc': 0.9975869}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    1     2    2    0     8     0     0    3     66
1     0  1258    0     9    0    0     0    48     7    1      9
2     1     0  247     0   32    0     1     2     1   24      3
3     1     0    2  8098    1    8     2   185   136    3      1
4     1     0   24     0  354    0     1     2     8    5    144
5     1     0    4    41    0  277     0     0     4  193      1
6     8     0    0     3    1    0  1866     3     0    1     25
7     0     4    1   140    1    0     2  7023    60    4     29
8     0     0    6    71   11    1     2    69  3035    3     97
9     1     0   69     3    4   11     1     4     4  393      3
10    1     0    4     6   43    0     7     4    12    2  12715
---- Validation: 
scalar performance:
{'acc': 0.95519596, 'precision': 0.89135605, 'recall': 0.8520698, 'specificity': 0.9950301, 'f1': 0.86467004, 'auroc': 0.9975442}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    0     3    1    0     4     3     2    4     65
1     0  1253    0    11    0    0     0    54     6    0      8
2     1     0  239     0   31    1     1     3     2   29      5
3     0     0    2  8114    0    7     4   171   137    4      1
4     1     0   26     0  354    0     0     2     8    6    142
5     1     0    2    40    0  284     0     0     9  184      1
6     6     0    1     3    1    0  1874     0     4    1     18
7     0     5    5   151    2    0     2  7015    56    4     25
8     2     0    7    71   15    0     2    56  3056    2     85
9     0     0   71     2    2   12     1     1     5  396      3
10    3     0    2     7   41    0     5     5     7    2  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73798364, 'precision': 0.68067086, 'recall': 0.6163799, 'specificity': 0.9737466, 'f1': 0.62328005, 'auroc': 0.88658047}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1073     1    0   13    2    0    32    9     4   24    12
1      3  1258    2   26    1    0     2  139     2   13    53
2      3     0  248   10  380    5     6   11   104   66   182
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    5    0  299    0     1    1     6    0  1321
5     11     0    1  119    6  220     6    0    10  217     2
6      0     0    0    1    2    0  3019    3     3    0    39
7      0     0    2  177    0    0     3  971     4    1     6
8      0     0    1   57    7    0     8    3  1281    5     8
9     14     2  250  108   17   37     7   28   107  542    25
10     0     0    0    0    9    0     0    0     0    0  1637
better model found
persisted
after epoch: 2,now: 2024-07-27 18:05:23.637255,epoch time: 0:54:17.974438,used: 1:50:58.452297,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9621682, 'precision': 0.9105411, 'recall': 0.87687504, 'specificity': 0.99577564, 'f1': 0.89106923, 'auroc': 0.9985324}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     4    0    0     1     5     1    1     27
1     0  1284    0    10    0    0     0    36     1    0      0
2     1     0  233     0   27    0     0    11     3   34      3
3     2     0    0  8312    0    3     1    91    28    1      1
4     3     0   21     0  362    2     0     6    15    4    125
5     3     0    0    39    0  363     0     0     4  111      1
6    12     0    0     8    1    0  1867     1     4    3     11
7     2    10    1   164    2    0     2  7060    16    1      5
8     3     1    5   179   16    0     1   113  2931    0     46
9     0     1   35     7    2   27     1     7     2  407      3
10   12     0    3    12   31    0     6    20    10    2  12699
---- Validation: 
scalar performance:
{'acc': 0.96244484, 'precision': 0.91299945, 'recall': 0.8800163, 'specificity': 0.99579966, 'f1': 0.8937696, 'auroc': 0.9985929}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    1     2    0    0     1     5     1    1     28
1     0  1285    0    10    0    0     0    36     1    0      0
2     1     1  232     0   20    2     0     9     3   39      5
3     5     0    0  8310    1    3     3    89    28    1      0
4     4     1   30     1  355    0     0     5    15    1    127
5     1     0    1    37    1  378     0     0     4   98      1
6     9     0    1     2    0    0  1876     1     3    4     12
7     1    11    0   153    1    0     1  7074    16    1      7
8     1     0    2   188   13    0     1   129  2918    1     43
9     1     0   38     6    2   19     0     3     2  419      3
10   10     1    3    11   34    0     7    20    19    1  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71818376, 'precision': 0.6746218, 'recall': 0.5962487, 'specificity': 0.9719173, 'f1': 0.5876068, 'auroc': 0.88627815}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1130     1    0    8    1    0     9    12     1    6     2
1      0  1260    0   27    0    0     0   203     1    0     8
2     13     8  162   18  155    5     3    97   278   50   226
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    2    0  195    0     1     3    16    0  1416
5     22     0    1  177    1  215     1     0    20  149     6
6      4     3    0    3    1    0  3001     3    17    0    35
7      1     1    0  128    0    0     0  1031     0    0     3
8      0     0    1  109    0    0     3    16  1236    1     4
9     25    17   89  184    3   48     2   156   179  395    39
10     0     0    0    0    5    0     0     1     0    0  1640
better model found
persisted
after epoch: 3,now: 2024-07-27 18:59:39.563620,epoch time: 0:54:15.926365,used: 2:45:14.378662,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9649508, 'precision': 0.9117378, 'recall': 0.89236665, 'specificity': 0.99620426, 'f1': 0.89872813, 'auroc': 0.99869746}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     1    0     1    1    1    11     0     2    2     21
1     0  1313    0     5    0    0     0     6     7    0      1
2     1     0  188     1   42    1     0     0     1   77      1
3     0     2    1  8255    0   22     2    69    85    2      0
4     3     1    6     0  393    1     1     2    12   13    107
5     0     0    1    12    0  461     0     0     4   42      1
6     5     1    0     0    2    1  1885     1     3    2      8
7     0    64    1   209    2    0     1  6891    77    3     15
8     0     1    1    74   10    8     1    42  3110    7     40
9     2     0    7     3    1   60     1     1     2  416      0
10    8     0    4     7   42    0     6     3    11    1  12711
---- Validation: 
scalar performance:
{'acc': 0.9660559, 'precision': 0.91610587, 'recall': 0.8956406, 'specificity': 0.996322, 'f1': 0.90219283, 'auroc': 0.9987996}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     0    0    2    12     0     0    3     20
1     0  1315    0     4    0    0     0     7     5    0      1
2     2     0  188     0   44    2     0     0     2   73      1
3     1     3    0  8264    2   22     0    52    95    1      0
4     5     0    5     0  402    3     0     2    10    7    105
5     0     0    0     8    0  461     0     0     4   47      1
6     5     0    0     1    2    0  1883     0     2    1     14
7     0    64    5   194    1    0     1  6898    84    6     12
8     1     1    0    77    7    4     1    41  3112    8     44
9     1     0    5     2    0   61     1     0     2  421      0
10    6     0    2     7   29    1     7     3    14    1  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75904286, 'precision': 0.6675929, 'recall': 0.6559511, 'specificity': 0.97561556, 'f1': 0.6343785, 'auroc': 0.88417387}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1058     1    0   5    3    3    41     3     7   37    12
1      0  1406    0  19    1    6     1    31     7    3    25
2      2     0  132   1  372   26     3     6   193   95   185
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    2   0  168    0     2     0     8    0  1453
5      2     0    0  14    2  470     0     0    12   91     1
6      0     0    0   0    1    0  3044     1     5    0    16
7      1    20    1  55    0    1    16  1056     8    0     6
8      0     0    1  18    2    9     5     2  1327    5     1
9      7     7  109  29   15  191     4    15   179  547    34
10     0     0    0   0    4    0     1     0     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-27 19:53:57.915080,epoch time: 0:54:18.351460,used: 3:39:32.730122,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96500427, 'precision': 0.9337562, 'recall': 0.85249746, 'specificity': 0.9960861, 'f1': 0.87853634, 'auroc': 0.9990009}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   368     0    0     2    2    0    42     4     1    3     61
1     0  1280    0    10    0    0     0    33     5    0      3
2     1     0  132     0   48    0     2     5     7  100     17
3     1     1    0  8312    0    0     2    43    75    1      1
4     1     0    0     0  315    1     0     3    26    6    187
5     0     0    0    19    0  431     1     0    13   56      1
6     1     0    0     2    1    0  1883     0     5    1     15
7     0     5    0   180    1    0     1  6932   138    0      7
8     0     0    1    41    2    0     3    12  3215    1     21
9     0     0    2     4    2   25     0     1     4  454      1
10    2     0    1     7    7    0     2     3    22    3  12746
---- Validation: 
scalar performance:
{'acc': 0.96306, 'precision': 0.9310434, 'recall': 0.8488617, 'specificity': 0.99588734, 'f1': 0.87494624, 'auroc': 0.998965}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   350     0    0     3    2    0    60     4     0    5     59
1     0  1290    0     8    0    0     0    28     5    0      1
2     1     0  134     0   39    1     2    10     6  103     16
3     2     1    0  8302    0    0     3    43    89    0      0
4     1     0    0     0  323    1     0     0    22    5    187
5     0     0    0    19    0  419     0     0    12   70      1
6     1     0    0     2    1    0  1877     2     3    1     21
7     0     5    0   184    1    0     1  6911   152    1     10
8     0     0    0    50    1    0     0    18  3205    2     20
9     0     0    5     3    1   22     1     0     5  456      0
10    3     0    0     7   12    0     2     8    25    2  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6936262, 'precision': 0.6500273, 'recall': 0.5772852, 'specificity': 0.9689673, 'f1': 0.5561516, 'auroc': 0.8769069}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   805     0   0   12   0    0   209    49    15   43    37
1     0  1217   0   29   1    0     0   209     8    0    35
2     4     0  77   12  69    3     6    57   319   76   392
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    0  49    0     1     1    14    0  1567
5     4     0   0  112   1  263     2     0    46  161     3
6     1     0   0    3   0    0  2954     4    24    0    81
7     0     0   0   19   0    0     0  1141     0    1     3
8     0     0   0   64   0    0     2     9  1292    2     1
9     4     0  53  101   2   53     4   104   293  471    52
10    0     0   0    0   0    0     0     0     1    0  1645
early stop counter: 1
val acc:0.9630600214004517, best validation acc: 0.9660559296607971, corresponding to test acc:                         0.7590428590774536 / 0.7590428590774536
after epoch: 5,now: 2024-07-27 20:48:18.939028,epoch time: 0:54:21.023948,used: 4:33:53.754070,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9775257, 'precision': 0.9277073, 'recall': 0.93638796, 'specificity': 0.9976372, 'f1': 0.9314053, 'auroc': 0.99936134}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     1    0     1    3    0    10     3     0    2      7
1     0  1327    0     0    0    0     0     4     0    0      1
2     0     0  284     0   17    2     0     0     0    8      1
3     0     6    2  8236    0   13     0    94    84    2      0
4     4     0   13     0  450    0     1     1     9    2     59
5     0     0    1     5    0  449     0     0     2   63      1
6     2     1    0     2    0    1  1894     1     2    0      5
7     0    30    3    53    2    0     4  7125    36    1      9
8     3     1    6    21    8    0     0    31  3207    2     17
9     0     0   55     0    1   21     0     2     1  413      0
10   23     0    3     7   43    0    13     2     5    1  12695
---- Validation: 
scalar performance:
{'acc': 0.9764612, 'precision': 0.9244333, 'recall': 0.9340414, 'specificity': 0.99753344, 'f1': 0.92856693, 'auroc': 0.9993377}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    1    0     9     4     0    1      4
1     0  1321    0     2    0    0     0     9     0    0      0
2     0     0  274     0   22    2     1     0     1   11      1
3     1     4    2  8226    0   14     1    92    94    6      0
4     8     0   13     0  457    0     0     0     6    3     52
5     0     0    0     4    0  465     0     0     3   48      1
6     2     1    1     0    1    0  1892     2     1    1      7
7     0    28    4    68    2    0     4  7101    49    0      9
8     1     3    3    25   10    1     0    26  3210    0     17
9     1     0   70     1    0   27     0     1     1  392      0
10   21     0    3     6   37    0     9     3    13    0  12704
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7702372, 'precision': 0.7034495, 'recall': 0.6547667, 'specificity': 0.9764836, 'f1': 0.65524733, 'auroc': 0.8865915}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   943     1    2   7    0    1   157    35     3   20     1
1     1  1425    1   9    0    0     3    46     2    2    10
2     4     1  305   4  216    7    84    28   121   87   158
3     0     0    0   0    0    0     0     0     0    0     0
4     2     0    5   0  320    0     7     0    11    0  1288
5     6     0    1  39    2  306    14     0     9  214     1
6     0     0    0   1    0    0  3061     2     1    0     2
7     0    11    1  13    0    0    11  1123     1    0     4
8     0     0    3  41    0    1    43    15  1258    5     4
9     6    10  210  43    5   60    41    42    63  638    19
10    0     0    0   0   12    0     4     0     0    0  1630
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-27 21:42:37.449489,epoch time: 0:54:18.510461,used: 5:28:12.264531,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9797196, 'precision': 0.94887096, 'recall': 0.94000804, 'specificity': 0.9977869, 'f1': 0.94261295, 'auroc': 0.99963284}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    2     1    5    0     1     0     0    5     14
1     0  1320    0     2    0    0     0     9     1    0      0
2     0     0  277     0    9    0     0     0     1   25      0
3     0     0    0  8382    0    1     0    39    13    3      0
4     0     0   10     1  465    0     0     0     9    1     53
5     0     0    1    14    1  412     0     0     0   91      1
6     3     0    0     1    0    0  1895     0     2    0      6
7     0    16    1   116    4    0     2  7083    34    1      6
8     0     1    3   105    7    0     0    20  3138    4     17
9     0     0   15     1    0    5     0     0     1  471      0
10    5     0    4     8   32    0     6     4    14    1  12720
---- Validation: 
scalar performance:
{'acc': 0.9800455, 'precision': 0.9520135, 'recall': 0.94493806, 'specificity': 0.9978007, 'f1': 0.94702995, 'auroc': 0.999677}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     3    4    0     2     0     1    3     16
1     0  1318    0     4    0    0     0    10     0    0      0
2     0     0  288     1    4    0     0     0     2   17      0
3     0     0    0  8390    0    0     0    33    14    1      2
4     1     0   22     0  454    0     0     0     7    2     53
5     0     0    0    13    0  432     0     0     1   74      1
6     0     0    0     3    1    0  1898     0     1    0      5
7     0    16    4   125    1    0     3  7076    31    5      4
8     0     1    4   113    6    1     0    16  3130    2     23
9     0     0   13     1    1    3     0     0     0  475      0
10    6     0    3     7   30    1     9     2    14    0  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73546493, 'precision': 0.7000612, 'recall': 0.6062738, 'specificity': 0.9736241, 'f1': 0.61418533, 'auroc': 0.883476}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   925     1    5   37    2    0   104    56     3   33     4
1     2  1305    0   24    1    0     1   146     3    1    16
2     1     2  402   36  162    5    23    31   193   87    73
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1   14    0  311    0     7     0    24    0  1276
5     1     0   16  178    2  105     0     0     0  289     1
6     0     0    0    1    0    0  3052     3     5    0     6
7     1     2    2   93    0    0     4  1054     1    2     5
8     0     0    2  201    0    0    25    14  1120    5     3
9     2     5  182  188    3   23     9    59    42  611    13
10    0     0    0    0   16    0     2     0     1    0  1627
better model found
persisted
after epoch: 7,now: 2024-07-27 22:37:05.060602,epoch time: 0:54:27.611113,used: 6:22:39.875644,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9813249, 'precision': 0.9599667, 'recall': 0.9476514, 'specificity': 0.9979543, 'f1': 0.952634, 'auroc': 0.99971426}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    1     1    2    0     1     2     3    0      2
1     0  1313    0     6    0    0     0    12     1    0      0
2     0     0  292     0    0    1     0     1     9    9      0
3     0     1    0  8396    0    2     0    16    21    0      0
4     4     0   23     0  423    0     1     1    19    2     66
5     0     0    0    11    0  480     0     0     5   23      1
6     2     0    0     4    1    0  1893     0     2    0      6
7     0     4    0   185    0    0     1  7017    54    0      4
8     0     0    0    33    0    0     0     2  3259    0      0
9     0     0   27     3    0   23     0     0     4  436      0
10    4     0    4     6   14    0     3     9    56    0  12698
---- Validation: 
scalar performance:
{'acc': 0.9811957, 'precision': 0.95939916, 'recall': 0.94660485, 'specificity': 0.99793655, 'f1': 0.95183134, 'auroc': 0.9996867}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    3     0    2    0     3     0     1    2      3
1     0  1307    0    11    0    0     0    14     0    0      0
2     0     0  289     1    1    1     0     2    11    7      0
3     0     0    0  8402    0    2     0    17    19    0      0
4     4     0   23     0  424    0     1     0    18    3     66
5     0     0    0     9    0  480     0     0     6   25      1
6     3     0    1     2    1    0  1891     0     4    0      6
7     0     4    1   184    0    0     1  7030    39    0      6
8     1     0    0    32    0    0     0     7  3254    0      2
9     0     0   28     2    0   19     1     0     3  440      0
10    2     0    3     5   12    0     2     8    68    0  12696
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7253201, 'precision': 0.6709175, 'recall': 0.6052896, 'specificity': 0.97253716, 'f1': 0.6028455, 'auroc': 0.8782806}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1038     0    3    9    1    0    81   16     2   16     4
1      3  1286    0   23    1    0     1  160    10    1    14
2      5     3  299   29  145    6    17   33   328   66    84
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0   18    0  164    0     4    0    34    0  1413
5     10     0    8  122    0  225     2    0    20  200     5
6      0     0    0    3    0    0  3031    3    16    0    14
7      0     0    1  175    0    0     2  979     1    1     5
8      1     0    0   84    0    1     8    7  1268    1     0
9     10     9  122  169    2   85     4   44   234  446    12
10     0     2    0    0    8    0     3    0     2    0  1631
better model found
persisted
after epoch: 8,now: 2024-07-27 23:31:30.637616,epoch time: 0:54:25.577014,used: 7:17:05.452658,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9858465, 'precision': 0.9673397, 'recall': 0.9562894, 'specificity': 0.99846345, 'f1': 0.96105146, 'auroc': 0.99982023}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    1    0     0     0     0    0      5
1     0  1311    0     4    0    0     0    14     1    0      0
2     0     0  277     0   15    1     0     0     7    9      3
3     0     0    0  8343    0    2     0    44    45    1      0
4     4     0    4     0  478    0     0     0     8    0     45
5     0     0    0     2    0  514     0     0     0    4      1
6     4     0    0     9    2    0  1881     2     2    0      8
7     0     2    2    78    0    0     1  7141    38    0      2
8     0     0    0    22    1    1     0    12  3257    0      3
9     0     0   14     1    2   59     0     0     2  415      0
10    2     0    1     6    8    0     2     5    18    0  12753
---- Validation: 
scalar performance:
{'acc': 0.9855557, 'precision': 0.96695364, 'recall': 0.95464927, 'specificity': 0.99843276, 'f1': 0.9601548, 'auroc': 0.99981517}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     1    0     1    2    0     0     0     0    0      6
1     0  1316    0     5    0    0     0    10     0    0      1
2     0     0  273     0   21    1     0     0     6   10      1
3     0     0    0  8344    0    5     0    47    44    0      0
4     2     0    2     0  475    0     0     0    17    0     43
5     0     0    0     2    0  511     0     0     2    5      1
6     5     0    0    11    0    0  1880     1     3    0      8
7     0     4    1    83    0    0     1  7140    33    0      3
8     1     0    0    23    1    0     0     5  3262    0      4
9     1     0   16     1    3   50     0     0     1  421      0
10    3     0    0     7    7    0     3     5    21    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70111245, 'precision': 0.65442944, 'recall': 0.5965569, 'specificity': 0.9702982, 'f1': 0.56301737, 'auroc': 0.8733665}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1054     0   0   13    0   15    26    32     9   17     4
1      2  1150   0   31    0    0     0   290     5    0    21
2     11     1  99   32  149   58    14    54   451   40   106
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   3    0  176    0     4     3    57    0  1390
5      5     0   0  120    0  430     1     0    14   20     2
6      5     0   0    5    0    1  2975     4    43    0    34
7      0     0   1   70    0    1     0  1088     0    1     3
8      0     0   0  146    0    6     6    12  1200    0     0
9     10     6  37  196    6  395     3    84   168  215    17
10     0     0   0    0    8    0     3     0     1    0  1634
better model found
persisted
after epoch: 9,now: 2024-07-28 00:24:59.959293,epoch time: 0:53:29.321677,used: 8:10:34.774335,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98729134, 'precision': 0.9713599, 'recall': 0.96642756, 'specificity': 0.99864995, 'f1': 0.9686667, 'auroc': 0.99986833}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     3    3    0    20     0     2    0      4
1     0  1309    0     1    0    0     1    18     1    0      0
2     1     0  300     0    2    0     3     2     1    2      1
3     0     0    0  8303    0    2     0    53    79    0      0
4     2     0    5     0  508    0     1     2     3    0     18
5     0     0    0     6    0  494     0     0     4   16      1
6     0     0    0     0    0    0  1904     1     0    0      3
7     0     0    0    46    3    0     1  7179    30    0      5
8     0     0    0     3    7    0     1     1  3269    0     15
9     0     0   19     2    0   21     3     1     2  445      0
10    2     0    0     8   18    0    20     2     4    0  12739
---- Validation: 
scalar performance:
{'acc': 0.9876689, 'precision': 0.96950364, 'recall': 0.96662205, 'specificity': 0.9986956, 'f1': 0.9677139, 'auroc': 0.999876}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    3    0    10     0     2    0      4
1     0  1309    0     1    0    0     0    21     1    0      0
2     0     0  299     0    5    0     2     3     1    1      1
3     0     0    0  8327    0    0     0    47    65    0      1
4     2     1    5     0  507    0     4     1     1    0     18
5     0     0    1     7    0  495     0     0     5   12      1
6     0     0    0     0    0    0  1903     0     0    0      5
7     0     1    0    47    0    0     2  7179    31    0      5
8     1     0    0     3    4    0     1     8  3272    0      7
9     0     0   30     0    1   22     1     1     3  435      0
10    4     0    0     5   20    0    24     2     6    0  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6974743, 'precision': 0.67926323, 'recall': 0.58039665, 'specificity': 0.9693285, 'f1': 0.56598616, 'auroc': 0.8780048}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   862     0    0   11    0   10   203    59    11   13     1
1     2  1181    0   27    0    0     3   266     4    1    15
2     7     1  111   33   92   25   188    81   353   41    83
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    2    0  224    0    40     5    34    0  1327
5     5     0    0  175    0  339    15     0    16   40     2
6     0     0    0    3    0    0  3048     5     8    0     3
7     0     1    0   88    0    0     5  1066     0    0     4
8     0     0    1   88    0    0    31    10  1239    1     0
9     5     3   33  222    1  166    86   126   215  268    12
10    0     0    0    0    7    0     7     0     1    0  1631
better model found
persisted
after epoch: 10,now: 2024-07-28 01:19:21.766891,epoch time: 0:54:21.807598,used: 9:04:56.581933,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 9:04:56.581933 at 2024-07-28 01:19:21.766891
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6974743, 'precision': 0.67926323, 'recall': 0.58039665, 'specificity': 0.9693285, 'f1': 0.56598616, 'auroc': 0.8780048}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   862     0    0   11    0   10   203    59    11   13     1
1     2  1181    0   27    0    0     3   266     4    1    15
2     7     1  111   33   92   25   188    81   353   41    83
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    2    0  224    0    40     5    34    0  1327
5     5     0    0  175    0  339    15     0    16   40     2
6     0     0    0    3    0    0  3048     5     8    0     3
7     0     1    0   88    0    0     5  1066     0    0     4
8     0     0    1   88    0    0    31    10  1239    1     0
9     5     3   33  222    1  166    86   126   215  268    12
10    0     0    0    0    7    0     7     0     1    0  1631
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7702372, 'precision': 0.7034495, 'recall': 0.6547667, 'specificity': 0.9764836, 'f1': 0.65524733, 'auroc': 0.8865915}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   943     1    2   7    0    1   157    35     3   20     1
1     1  1425    1   9    0    0     3    46     2    2    10
2     4     1  305   4  216    7    84    28   121   87   158
3     0     0    0   0    0    0     0     0     0    0     0
4     2     0    5   0  320    0     7     0    11    0  1288
5     6     0    1  39    2  306    14     0     9  214     1
6     0     0    0   1    0    0  3061     2     1    0     2
7     0    11    1  13    0    0    11  1123     1    0     4
8     0     0    3  41    0    1    43    15  1258    5     4
9     6    10  210  43    5   60    41    42    63  638    19
10    0     0    0   0   12    0     4     0     0    0  1630
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104512_instance_wise_predictions.txt
accuracy from prediction file 0.6974742881130623
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/27.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/27.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/27.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15814 MiB | 692963 GiB | 692962 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 688007 GiB | 688005 GiB |
|       from small pool |      7 MiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15814 MiB | 692963 GiB | 692962 GiB |
|       from large pool |   1648 MiB |  15788 MiB | 688007 GiB | 688005 GiB |
|       from small pool |      7 MiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15770 MiB | 690707 GiB | 690705 GiB |
|       from large pool |   1647 MiB |  15745 MiB | 685754 GiB | 685753 GiB |
|       from small pool |      6 MiB |     26 MiB |   4952 GiB |   4952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16412 MiB |  16412 MiB |  16412 MiB |      0 B   |
|       from large pool |  16384 MiB |  16384 MiB |  16384 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 227392 KiB | 680312 KiB | 102366 GiB | 102366 GiB |
|       from large pool | 216320 KiB | 677984 KiB |  97209 GiB |  97209 GiB |
|       from small pool |  11072 KiB |  13093 KiB |   5156 GiB |   5156 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   44744 K  |   44741 K  |
|       from large pool |     247    |     593    |   22680 K  |   22680 K  |
|       from small pool |    2399    |    3599    |   22063 K  |   22060 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   44744 K  |   44741 K  |
|       from large pool |     247    |     593    |   22680 K  |   22680 K  |
|       from small pool |    2399    |    3599    |   22063 K  |   22060 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     462    |     462    |     462    |       0    |
|       from large pool |     448    |     448    |     448    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     115    |     565    |   25222 K  |   25222 K  |
|       from large pool |      94    |     301    |   15425 K  |   15425 K  |
|       from small pool |      21    |     456    |    9796 K  |    9796 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 690707 GiB | 690707 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 685754 GiB | 685754 GiB |
|       from small pool |      0 KiB |     26 MiB |   4952 GiB |   4952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1878 MiB |  16412 MiB |  16412 MiB |  14534 MiB |
|       from large pool |   1860 MiB |  16384 MiB |  16384 MiB |  14524 MiB |
|       from small pool |     18 MiB |     28 MiB |     28 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680312 KiB | 102367 GiB | 102367 GiB |
|       from large pool |  24320 KiB | 677984 KiB |  97210 GiB |  97210 GiB |
|       from small pool |      0 KiB |  17267 KiB |   5156 GiB |   5156 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     102    |     462    |     462    |     360    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       9    |      14    |      14    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     565    |   25222 K  |   25222 K  |
|       from large pool |       3    |     301    |   15426 K  |   15426 K  |
|       from small pool |       0    |     456    |    9796 K  |    9796 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB | 692963 GiB | 692963 GiB |
|       from large pool |  16640 KiB |  15788 MiB | 688007 GiB | 688007 GiB |
|       from small pool |      0 KiB |     26 MiB |   4956 GiB |   4956 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB | 690707 GiB | 690707 GiB |
|       from large pool |  16640 KiB |  15745 MiB | 685754 GiB | 685754 GiB |
|       from small pool |      0 KiB |     26 MiB |   4952 GiB |   4952 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1878 MiB |  16412 MiB |  16412 MiB |  14534 MiB |
|       from large pool |   1860 MiB |  16384 MiB |  16384 MiB |  14524 MiB |
|       from small pool |     18 MiB |     28 MiB |     28 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680312 KiB | 102367 GiB | 102367 GiB |
|       from large pool |  24320 KiB | 677984 KiB |  97210 GiB |  97210 GiB |
|       from small pool |      0 KiB |  17267 KiB |   5156 GiB |   5156 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   44744 K  |   44744 K  |
|       from large pool |       2    |     593    |   22680 K  |   22680 K  |
|       from small pool |       0    |    3599    |   22063 K  |   22063 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     102    |     462    |     462    |     360    |
|       from large pool |      93    |     448    |     448    |     355    |
|       from small pool |       9    |      14    |      14    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     565    |   25222 K  |   25222 K  |
|       from large pool |       3    |     301    |   15426 K  |   15426 K  |
|       from small pool |       0    |     456    |    9796 K  |    9796 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512

 Experiment start at: 2024-07-28 01:37:30.975859
before training, model accuracy: 0.09417197853326797
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9330854, 'precision': 0.84320545, 'recall': 0.82412744, 'specificity': 0.99286085, 'f1': 0.8273108, 'auroc': 0.99557334}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     0    0     6    0    2     9     8    20    8     40
1     0  1277    0    13    0    0     0    35     4    0      2
2     0     0  184     3   53    9     2    10    14   36      1
3     1     2    1  8261    0   11     0    63    97    1      0
4     1     0   15     2  351    3     1    10    61   10     85
5     0     0    1    38    0  459     0     0     7   15      1
6    10     1    0    10    2    5  1831     2    19    2     26
7     0    36    1   488    2    0     2  6621   105    0      8
8     1     1    2   184    5    0     0    47  3052    1      3
9     0     0   56     9    3  190     1     2    12  219      1
10   11     0    4     8  215    3     8    54   258    2  12230
---- Validation: 
scalar performance:
{'acc': 0.932834, 'precision': 0.8394609, 'recall': 0.82167196, 'specificity': 0.9928502, 'f1': 0.82345873, 'auroc': 0.9954368}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    3     9    1    3     8     8    21    5     33
1     0  1274    0    12    1    0     0    38     5    0      2
2     0     1  186     2   57    9     1     9     7   39      1
3     0     2    0  8259    0   17     0    64    97    1      0
4     2     0   23     3  346    5     0    10    57    5     88
5     0     0    1    36    0  459     0     0     7   17      1
6     7     0    0     7    2    6  1834     6    23    2     21
7     0    33    2   499    1    0     1  6623   102    0      4
8     1     0    3   163    4    2     0    52  3066    0      5
9     1     0   59     7    3  199     0     4    15  204      1
10    6     0    5    12  207    2    10    57   263    3  12231
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7025817, 'precision': 0.67769086, 'recall': 0.6014261, 'specificity': 0.97025007, 'f1': 0.5837082, 'auroc': 0.8814812}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   910     2   0   42    0   17   131    5    28   21    14
1     0  1329   0   42    1    0     0   79    20    0    28
2     1     3  31   10  206   44    17   23   553   50    77
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    0  630    0     1    0    63    1   937
5     3     0   0   69    0  461     2    0    34   20     3
6     0     0   0    2    1    0  2679    4   274    0   107
7     0     2   0  235    0    0     2  904    19    0     2
8     0     0   0   77    0    2     2    0  1288    1     0
9     5    15  17  106   23  278    12   20   404  244    13
10    0     0   0    0   75    0     0    0     5    0  1566
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 02:33:33.744915,epoch time: 0:56:02.769056,used: 0:56:02.769056,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.951814, 'precision': 0.8776435, 'recall': 0.85945505, 'specificity': 0.99479806, 'f1': 0.86276686, 'auroc': 0.99768156}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     0    1    0    15     3     3    2     21
1     0  1281    1     6    0    0     0    40     2    0      2
2     3     0  207     0   44    0     0     8     2   46      2
3     4     1    1  7984    1   15    10   348    62   12      0
4     6     0   19     0  370    0     1     3     8    2    130
5     0     0    0    17    1  306     0     0     4  192      1
6     8     0    1     1    4    1  1879     1     2    1      8
7     1     7    3    68    3    0     6  7159    12    0      5
8     4     1    7    91   26    3    10   210  2898   10     35
9     2     0   45     3    5    6     1     3     1  426      1
10   28     0    4     7   66    0    24    14    21    2  12627
---- Validation: 
scalar performance:
{'acc': 0.9523606, 'precision': 0.882016, 'recall': 0.8627428, 'specificity': 0.9948521, 'f1': 0.86599636, 'auroc': 0.99764585}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    1     0    3    0    13     2     1    3     17
1     0  1282    1     7    0    0     0    38     3    0      1
2     2     0  215     0   45    0     0     4     2   43      1
3     5     1    0  7989    0   11     9   348    67   10      0
4     7     0   20     0  361    1     2     4     7    2    135
5     0     0    2    15    0  304     1     0     2  196      1
6     6     0    0     0    1    0  1887     1     3    2      8
7     3     8    2    76    2    0     6  7140    21    1      6
8     6     1    9   108   23    4     9   192  2905   12     27
9     3     0   42     2    5    4     0     3     0  434      0
10   27     0    1     6   53    0    21    24    19    1  12644
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74512, 'precision': 0.66897535, 'recall': 0.6175829, 'specificity': 0.97399825, 'f1': 0.6186743, 'auroc': 0.88272256}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1006     1    0   2    5    0   125     4     1   21     5
1      2  1320    2   9    0    1    12   118     2    9    24
2      2     3  173   3  547    2    37    28    74   67    79
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    2   0  384    0     5     0     7    1  1233
5      5     0    4  27   13  181    14     0     4  336     8
6      0     0    0   1    1    0  3060     2     0    0     3
7      0     0    2  41    0    0    10  1105     0    2     4
8      0     0    2  71   17   12    85    25  1144   12     2
9      6    15  246  23   40   17    23    50    51  648    18
10     0     0    0   0   16    0     1     0     0    0  1629
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 03:28:16.278055,epoch time: 0:54:42.533140,used: 1:50:45.302196,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9522956, 'precision': 0.89408576, 'recall': 0.8633313, 'specificity': 0.99493027, 'f1': 0.8710162, 'auroc': 0.99788755}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    1     4    0    0     7     0     9    0      4
1     0  1284    0    11    0    1     1    30     5    0      0
2     2     0  234     0   20    0     2     4    12   36      2
3     0     3    0  8184    0    7     1   133   109    1      0
4     7     0   29     1  275    1     2     3    64    8    148
5     0     0    0    35    0  347     0     0     6  132      1
6     4     0    0     1    0    0  1891     2     3    2      5
7     0    19    0   166    1    0     1  6943   126    2      5
8     1     0    2    93    1    1     0    37  3158    2      1
9     8     0   49     6    1   12     2     3    12  400      0
10   43     0    3     7   13    1    14     5   283    4  12419
---- Validation: 
scalar performance:
{'acc': 0.95209306, 'precision': 0.8877444, 'recall': 0.8555081, 'specificity': 0.9949318, 'f1': 0.8639296, 'auroc': 0.9977922}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     5    0    0    11     0     5    1      6
1     0  1288    0    14    0    0     1    27     2    0      0
2     7     0  220     0   25    1     1     5    20   33      0
3     1     4    0  8220    0    3     0   115    96    1      0
4     7     0   32     0  275    2     0     2    78    5    138
5     2     0    0    32    0  337     0     0     4  145      1
6     5     0    0     2    0    1  1886     1     7    1      5
7     0    27    0   169    1    0     2  6937   124    1      4
8     1     2    2    97    1    2     1    33  3157    0      0
9    10     0   48     6    2   19     2     2    12  391      1
10   46     0    2     9    9    0    21     9   271    1  12428
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69264674, 'precision': 0.68084216, 'recall': 0.57698596, 'specificity': 0.96935964, 'f1': 0.560436, 'auroc': 0.87923}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   947     0   0   93   0    1    73   11    28   15     2
1     1  1332   0   39   0    0     3   88    16    0    20
2     5     5  76   29  17   14    21   15   588  101   144
3     0     0   0    0   0    0     0    0     0    0     0
4     1     0   3    0  41    0     9    0   111    1  1467
5     3     0   0  174   0  300     1    0    18   94     2
6     0     0   0    2   0    0  2968    3    92    0     2
7     0     1   0  188   0    0     2  961     9    0     3
8     0     0   0  115   0    0     3    4  1246    1     1
9     3    18  35  185   1  114    17   42   309  392    21
10    0     1   0    0   1    0     1    1     5    0  1637
early stop counter: 1
val acc:0.9520930647850037, best validation acc: 0.9523605704307556, corresponding to test acc:                         0.7451199889183044 / 0.7451199889183044
after epoch: 3,now: 2024-07-28 04:22:56.524770,epoch time: 0:54:40.246715,used: 2:45:25.548911,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96551263, 'precision': 0.9182854, 'recall': 0.87476224, 'specificity': 0.9961558, 'f1': 0.8918811, 'auroc': 0.99865586}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     1    0    0    10     0     1    1     39
1     0  1268    0     8    0    0     2    40     9    0      4
2     4     0  176     0   67    0     1     2     4   50      8
3     5     1    1  8297    0   23     4    48    60    1      0
4     2     0    3     0  358    1     1     2    13    2    157
5     3     0    0    11    0  492     0     0     2   12      1
6     5     0    0     2    2    0  1875     0     2    0     22
7     4     2    0   182    1    0     4  6964    84    1     18
8     1     0    2    98    5    8     1    27  3132    0     22
9     8     0   16     3    6   85     3     3     2  362      5
10    1     0    2     6   10    1     2     5    34    0  12732
---- Validation: 
scalar performance:
{'acc': 0.9657884, 'precision': 0.91501963, 'recall': 0.8778384, 'specificity': 0.99622715, 'f1': 0.89185536, 'auroc': 0.9986381}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     1    2    0     7     0     0    0     34
1     0  1285    0     8    0    0     1    30     6    0      2
2     4     0  178     0   70    2     0     2     5   46      5
3     2     0    0  8295    0   20     2    53    67    1      0
4     3     0    3     0  365    2     1     0    14    0    151
5     3     0    0     8    0  490     0     0     3   15      2
6     6     0    1     0    1    1  1881     0     2    0     16
7     6    11    4   169    4    0     3  6973    81    0     14
8     2     0    1    96    7   10     1    30  3124    2     23
9    11     0   13     2    8   95     0     3     2  357      2
10    4     0    0     7   11    0     3     7    44    1  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71573496, 'precision': 0.6311377, 'recall': 0.6078713, 'specificity': 0.9711977, 'f1': 0.5863962, 'auroc': 0.87445694}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1066     0    0    5    5    1    65     0     3    1    24
1      1  1219    0   24    0    0     7   148     8    1    91
2      6     0   78    2  301   10    16    15   260   36   291
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    0    0   75    0     2     1    10    0  1545
5     25     0    3   46    9  389     3     0    16   79    22
6      0     0    0    1    0    0  3013     1     0    0    52
7      2     0    1  102    0    1     3  1037     7    0    11
8      0     0    0   39    1    7    19     8  1285    3     8
9     36     3  106   34   34  140    23    57   209  422    73
10     0     0    0    0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 4,now: 2024-07-28 05:17:27.436399,epoch time: 0:54:30.911629,used: 3:39:56.460540,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664758, 'precision': 0.92426145, 'recall': 0.8862299, 'specificity': 0.9962606, 'f1': 0.8972912, 'auroc': 0.99913496}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     0    0     1    0    0     5     4     3    2     83
1     0  1275    0     6    0    0     0    47     3    0      1
2     0     0  276     0    7    1     0     4     2   15      7
3     0     0    0  8169    0   34     0   119   113    0      3
4     0     0   33     0  355    1     1     4    12    0    133
5     0     0    1     3    0  506     0     0     2    8      1
6     2     0    0     3    0    0  1857     1     4    0     40
7     0     3    1    88    1    0     1  7099    62    0     10
8     0     0    3    20    1    4     0    37  3198    0     31
9     1     0   63     2    1  118     1     4     4  294      5
10    2     0    1     5   22    1     4    10    38    0  12709
---- Validation: 
scalar performance:
{'acc': 0.9655209, 'precision': 0.92023957, 'recall': 0.88571835, 'specificity': 0.9961759, 'f1': 0.8960828, 'auroc': 0.99910533}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   389     0    1     2    1    2     5     4     2    2     75
1     0  1273    0     5    0    0     0    45     8    0      1
2     0     0  275     0   10    3     0     3     2   14      5
3     0     0    0  8161    0   34     0   119   121    3      2
4     0     0   31     0  357    0     1     2    15    1    132
5     0     0    1     4    0  498     0     0     2   15      1
6     2     0    0     0    0    0  1851     4     3    0     48
7     0     2    0    92    1    0     1  7083    78    0      8
8     0     0    1    29    1    6     0    34  3198    0     27
9     0     0   59     1    0  124     1     4     1  299      4
10    1     0    2     7   25    1     2    11    34    1  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73497516, 'precision': 0.6830153, 'recall': 0.63608396, 'specificity': 0.9734516, 'f1': 0.61664164, 'auroc': 0.88571084}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   988     0    0   28    2   29    68    5     9   23    18
1     1  1233    0   32    0    1     3  189    17    0    23
2     0     0  241    4  126   37    15   37   351   37   167
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    7    0  353    0     1    1    31    0  1240
5     1     0    2   31    1  513     3    0    10   28     3
6     0     0    0    2    1    0  2975    4    41    0    44
7     1     0    0  155    0    1     0  995     7    0     5
8     0     0    0   53    0   15    10    3  1282    1     6
9     3     3  170   54    4  287     7   79   206  293    31
10    0     0    0    0   13    0     0    0     1    0  1632
early stop counter: 1
val acc:0.9655209183692932, best validation acc: 0.9657884240150452, corresponding to test acc:                         0.7157349586486816 / 0.7451199889183044
after epoch: 5,now: 2024-07-28 06:11:26.966117,epoch time: 0:53:59.529718,used: 4:33:55.990258,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9758401, 'precision': 0.9305753, 'recall': 0.93551195, 'specificity': 0.99745065, 'f1': 0.9316181, 'auroc': 0.9994306}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    0     0     0     1    0      2
1     1  1315    0     2    0    0     0    11     2    1      0
2     2     0  270     0    8    0     0     4     3   25      0
3     5     1    0  8208    1    7     2    68   146    1      0
4     7     0   37     0  417    0     0     2     7    2     66
5     0     0    1     7    0  454     0     0     5   53      1
6     7     0    1     0    1    0  1884     1     2    0     10
7     2     3    1   105    0    0     2  7102    44    2      4
8     4     0    1    14    4    1     0    30  3229    4      9
9     4     0   26     3    0   16     1     1     3  439      0
10   46     0    3     6   22    0     4     7    26    1  12676
---- Validation: 
scalar performance:
{'acc': 0.97611344, 'precision': 0.9304414, 'recall': 0.9317888, 'specificity': 0.9974918, 'f1': 0.92948127, 'auroc': 0.99945116}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    2    0     7     0     1    0      2
1     0  1311    0     2    0    0     0    18     1    0      0
2     2     0  266     0    6    1     0     1     4   32      0
3     1     3    0  8219    0    3     4    59   149    2      0
4     9     0   40     0  403    1     0     2    15    2     67
5     0     0    0    14    1  452     0     0     4   49      1
6     9     0    1     2    0    0  1887     0     1    0      8
7     4     9    3   101    0    0     3  7107    35    0      3
8     5     0    2     6    4    1     1    21  3249    2      5
9     3     0   22     4    0   15     1     0     2  446      0
10   43     0    2     7   22    0     7     6    26    2  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7338557, 'precision': 0.67558956, 'recall': 0.61719203, 'specificity': 0.973273, 'f1': 0.61090696, 'auroc': 0.8798841}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1128     0    0    1    1    0    27    4     3    5     1
1      3  1278    0   22    0    0     4  168     6    1    17
2     14     1  194    3  179   10    40   46   264   83   181
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    5    0  201    0     3    1    24    1  1398
5     17     0    4   52    2  286     3    0    10  215     3
6      1     0    0    1    0    0  3037    4     6    0    18
7      1     0    0  282    0    0     1  877     1    1     1
8      0     0    1   44    0    2    27    8  1279    3     6
9     41     7   85   48   12   77    12   99   159  573    24
10     0     0    0    0    5    0     2    1     2    0  1636
better model found
persisted
after epoch: 6,now: 2024-07-28 07:05:24.231457,epoch time: 0:53:57.265340,used: 5:27:53.255598,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9707299, 'precision': 0.93882656, 'recall': 0.9277722, 'specificity': 0.9967932, 'f1': 0.928524, 'auroc': 0.99955595}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    3    0     0     0     1    1      1
1     0  1287    0    13    0    1     0    28     1    0      1
2     0     1  192     0   27    0     0     4     1   87      0
3     0     0    0  8398    0   14     0    13    14    1      0
4     3     0    2     0  505    0     0     0     3    3     23
5     0     0    0     7    0  477     0     0     0   36      1
6     6     0    0     3    2    0  1885     0     1    2      8
7     1     2    0   354    2    0     1  6879    19    4      3
8     2     0    1   204    4    6     0    18  3048    2     10
9     0     0    2     1    0   27     0     0     0  462      0
10   12     0    2     7   59    1     8     9    18    2  12673
---- Validation: 
scalar performance:
{'acc': 0.9705764, 'precision': 0.9392785, 'recall': 0.9235008, 'specificity': 0.99676514, 'f1': 0.92673093, 'auroc': 0.99955034}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     3    3    0     2     0     0    4      3
1     0  1287    0    11    0    0     0    33     0    0      1
2     1     0  192     0   27    3     0     6     4   78      1
3     0     0    0  8407    0    9     0    12    11    1      0
4     4     0    2     0  498    0     0     1     5    3     26
5     0     0    0     4    0  486     0     0     0   30      1
6     6     0    0     5    1    1  1882     0     1    2     10
7     3     4    0   349    0    0     2  6885    14    2      6
8     0     0    0   195    7    8     0    23  3049    3     11
9     1     0    2     4    0   38     0     0     1  446      1
10   10     0    0     8   57    1    10     9    14    2  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7091583, 'precision': 0.6737793, 'recall': 0.5876503, 'specificity': 0.9712445, 'f1': 0.594761, 'auroc': 0.8825266}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1070     0   0   47    4    1     8    1     2   36     1
1      5  1166   0   43    0    0     6  244     3    2    30
2      5     2  68   43  399   25    27   41   198  126    81
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   2    0  430    0     9    2    22    1  1167
5      3     0   0   87    4  291     0    0     2  203     2
6      1     0   0    1    2    0  3037    4     1    0    21
7      1     0   0  472    0    1     0  682     0    1     7
8      0     0   0  178    7    7    27    3  1142    4     2
9      5     6  23  153   23  140     5   69    65  637    11
10     0     1   0    0   24    0     7    0     1    0  1613
early stop counter: 1
val acc:0.9705764055252075, best validation acc: 0.9761134386062622, corresponding to test acc:                         0.7338557243347168 / 0.7451199889183044
after epoch: 7,now: 2024-07-28 07:59:23.247912,epoch time: 0:53:59.016455,used: 6:21:52.272053,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98105735, 'precision': 0.9483017, 'recall': 0.94723773, 'specificity': 0.99793255, 'f1': 0.94585174, 'auroc': 0.99969304}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     1    0     0    6    0     1     2     1    0      7
1     0  1330    0     2    0    0     0     0     0    0      0
2     0     0  296     0    9    0     0     4     1    0      2
3     0     8    0  8335    0    1     0    75    19    1      0
4     0     0    2     0  491    0     0     1     5    0     39
5     0     0    0    13    0  491     0     0     2   14      1
6     4     0    0     2    1    0  1888     1     1    0     11
7     0    48    0    46    1    0     1  7139    19    1      9
8     0     2    1    68    3    1     0    38  3133    0     49
9     1     1   75     1    1   41     0     2     1  369      1
10    6     1    0     5   38    1     3     1     5    0  12731
---- Validation: 
scalar performance:
{'acc': 0.9814899, 'precision': 0.9506918, 'recall': 0.95075136, 'specificity': 0.9979662, 'f1': 0.9487924, 'auroc': 0.99970317}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     1    0     0    6    0     0     0     0    0     15
1     0  1330    0     1    0    0     0     1     0    0      0
2     0     0  300     1    7    0     0     1     0    2      1
3     0     1    0  8331    0    6     0    79    22    1      0
4     0     0    6     1  507    0     0     1     5    0     19
5     0     0    2    17    0  488     0     0     1   12      1
6     3     0    0     2    3    0  1881     4     1    0     14
7     0    43    1    54    1    0     0  7139    14    1     12
8     0     2    0    70    6    1     0    28  3131    0     58
9     0     1   72     2    2   36     0     1     2  377      0
10    2     1    0     6   33    0     0     1     5    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7402225, 'precision': 0.67938495, 'recall': 0.63246727, 'specificity': 0.97423625, 'f1': 0.6231352, 'auroc': 0.88276213}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1054     1    1   20    3    6     7    49     6   21     2
1      0  1405    0   27    0    0     0    55     3    1     8
2      3    23  223   38  226   43     6    37   300   27    89
3      0     0    0    0    0    0     0     0     0    0     0
4      2     6    5    1  458    0     4     1    24    0  1132
5      1     0    3  158    0  392     0     0     2   35     1
6      9     3    0    6    2    0  2901     3    35    0   108
7      0     1    1   52    0    1     0  1105     1    0     3
8      1     1    1  159    1   10     8    22  1161    3     3
9     12    44  167  186   11  257     1    81   103  262    13
10     0     3    0    0   21    0     1     1     1    0  1619
better model found
persisted
after epoch: 8,now: 2024-07-28 08:54:05.106553,epoch time: 0:54:41.858641,used: 7:16:34.130694,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9820741, 'precision': 0.96231985, 'recall': 0.9547532, 'specificity': 0.9980272, 'f1': 0.9578696, 'auroc': 0.9997668}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    1    0     0     1     0    0      5
1     0  1326    0     0    0    0     0     6     0    0      0
2     2     0  291     0    2    0     0     3     4    8      2
3     0     3    0  8390    0    0     0    29    16    0      0
4     7     1    6     0  455    0     0     0     6    0     64
5     0     0    1    10    0  495     0     0     0   13      1
6     3     1    0     4    0    0  1887     0     0    0     12
7     0    92    1   105    1    0     0  7030    29    1      6
8     0     2    0    65    3    2     1    30  3178    0     14
9     1     0   25     3    0   25     2     1     1  434      1
10    3     4    2     7   10    0     2     1    19    0  12745
---- Validation: 
scalar performance:
{'acc': 0.98218536, 'precision': 0.96037924, 'recall': 0.9561184, 'specificity': 0.99806523, 'f1': 0.9577384, 'auroc': 0.9997672}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    1    0     1     0     0    0      4
1     0  1328    0     1    0    0     0     3     0    0      0
2     1     0  290     1    3    0     1     0     4   12      0
3     0     7    0  8383    0    0     1    35    14    0      0
4     7     1    7     0  459    0     0     1    12    1     51
5     0     0    0    10    0  495     0     0     0   15      1
6     2     0    0     3    1    0  1895     0     0    0      7
7     0   106    1   110    0    0     1  7014    26    0      7
8     1     0    0    54    1    1     0    33  3194    0     12
9     2     0   27     5    1   20     0     0     2  436      0
10    0     1    1     7   19    0     1     3    16    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7201427, 'precision': 0.6791129, 'recall': 0.6030593, 'specificity': 0.9721188, 'f1': 0.61225, 'auroc': 0.881299}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1103     0    0   21    2    1    15    6     1   12     9
1      1  1443    0   20    0    0     3   20     2    1     9
2      9    16  309   22  216   11    22   16   203   39   152
3      0     0    0    0    0    0     0    0     0    0     0
4      0     5   10    1  270    0     4    1    14    1  1327
5     11     0    9  162    1  246     5    0     5  141    12
6      3     1    0    1    1    0  2911    3     5    0   142
7      2    67    7  273    0    0     1  809     0    1     4
8      0     2    2  142    2    1    41   12  1160    4     4
9     22    31  223  166    8   83    12   48   105  410    29
10     0     2    0    0    9    0     2    0     1    0  1632
better model found
persisted
after epoch: 9,now: 2024-07-28 09:48:12.963771,epoch time: 0:54:07.857218,used: 8:10:41.987912,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98547196, 'precision': 0.95693374, 'recall': 0.9624982, 'specificity': 0.99847156, 'f1': 0.95777035, 'auroc': 0.999866}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    2    0     3     0     0    0      1
1     0  1322    0     1    0    0     0     8     0    0      0
2     0     0  294     0    9    1     0     0     2    6      0
3     0     0    0  8406    1    5     0    21     5    0      0
4     1     0    6     1  517    1     0     0     3    0     10
5     0     0    0     0    0  519     0     0     1    0      1
6     1     0    0     1    0    0  1901     0     4    0      1
7     0     2    0   108    2    0     1  7140     8    1      3
8     0     0    0    66    1    1     0    18  3206    0      4
9     0     0   19     0    1   86     1     2     3  380      0
10   12     0    3     6   64    0     5     4    25    0  12672
---- Validation: 
scalar performance:
{'acc': 0.98568946, 'precision': 0.9623221, 'recall': 0.9665284, 'specificity': 0.9984791, 'f1': 0.9628737, 'auroc': 0.9998568}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    4    0     0     1     0    0      1
1     0  1320    0     2    0    0     0     7     2    0      1
2     0     0  295     0    7    2     0     1     1    5      1
3     0     0    0  8400    0    3     0    27    10    0      0
4     1     0    0     1  529    0     0     1     2    1      4
5     0     0    0     3    0  516     0     0     1    0      1
6     1     0    0     0    0    0  1902     1     3    0      1
7     0     3    0   113    1    0     1  7141     3    1      2
8     0     0    0    80    1    1     0    19  3192    0      3
9     0     0   16     0    1   78     0     2     1  395      0
10   10     0    1     7   61    0     5     5    24    0  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76324075, 'precision': 0.6970211, 'recall': 0.6591325, 'specificity': 0.9764607, 'f1': 0.64796287, 'auroc': 0.8858579}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   983     0    0   13   11   49    52    16     5   35     6
1     0  1282    0   25    0    3     5   160     5    4    15
2     0     1  262   18  342   71    21    19   187   42    52
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    6    0  709    0     6     1    20    1   890
5     2     0    2   41    1  532     1     0     3    8     2
6     0     0    1    1    1    0  3055     2     4    0     3
7     0     1    3  133    0    1     0  1023     0    1     2
8     0     0    2  135    1   24    22     7  1174    3     2
9     2     7  138   85   12  447    10    33    77  311    15
10    0     0    0    0   63    0     3     0     2    0  1578
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-28 10:42:43.365119,epoch time: 0:54:30.401348,used: 9:05:12.389260,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 9:05:12.389260 at 2024-07-28 10:42:43.365119
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76324075, 'precision': 0.6970211, 'recall': 0.6591325, 'specificity': 0.9764607, 'f1': 0.64796287, 'auroc': 0.8858579}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   983     0    0   13   11   49    52    16     5   35     6
1     0  1282    0   25    0    3     5   160     5    4    15
2     0     1  262   18  342   71    21    19   187   42    52
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    6    0  709    0     6     1    20    1   890
5     2     0    2   41    1  532     1     0     3    8     2
6     0     0    1    1    1    0  3055     2     4    0     3
7     0     1    3  133    0    1     0  1023     0    1     2
8     0     0    2  135    1   24    22     7  1174    3     2
9     2     7  138   85   12  447    10    33    77  311    15
10    0     0    0    0   63    0     3     0     2    0  1578
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76324075, 'precision': 0.6970211, 'recall': 0.6591325, 'specificity': 0.9764607, 'f1': 0.64796287, 'auroc': 0.8858579}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   983     0    0   13   11   49    52    16     5   35     6
1     0  1282    0   25    0    3     5   160     5    4    15
2     0     1  262   18  342   71    21    19   187   42    52
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    6    0  709    0     6     1    20    1   890
5     2     0    2   41    1  532     1     0     3    8     2
6     0     0    1    1    1    0  3055     2     4    0     3
7     0     1    3  133    0    1     0  1023     0    1     2
8     0     0    2  135    1   24    22     7  1174    3     2
9     2     7  138   85   12  447    10    33    77  311    15
10    0     0    0    0   63    0     3     0     2    0  1578
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_01_37_30_seed_1_23104512_instance_wise_predictions.txt
accuracy from prediction file 0.7632407472189183
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/27.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/27.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1656 MiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      8 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1656 MiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |   1648 MiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      8 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1655 MiB |  15770 MiB |   1349 TiB |   1349 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1339 TiB |   1339 TiB |
|       from small pool |      7 MiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16392 MiB |  16412 MiB |  30926 MiB |  14534 MiB |
|       from large pool |  16364 MiB |  16384 MiB |  30888 MiB |  14524 MiB |
|       from small pool |     28 MiB |     28 MiB |     38 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 226474 KiB | 680312 KiB | 204762 GiB | 204762 GiB |
|       from large pool | 216320 KiB | 677984 KiB | 194442 GiB | 194442 GiB |
|       from small pool |  10154 KiB |  17267 KiB |  10320 GiB |  10320 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3588    |    4646    |   89487 K  |   89483 K  |
|       from large pool |     247    |     593    |   45361 K  |   45361 K  |
|       from small pool |    3341    |    4346    |   44125 K  |   44122 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3588    |    4646    |   89487 K  |   89483 K  |
|       from large pool |     247    |     593    |   45361 K  |   45361 K  |
|       from small pool |    3341    |    4346    |   44125 K  |   44122 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     461    |     462    |     821    |     360    |
|       from large pool |     447    |     448    |     802    |     355    |
|       from small pool |      14    |      14    |      19    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     118    |     565    |   50415 K  |   50415 K  |
|       from large pool |      95    |     301    |   30898 K  |   30898 K  |
|       from small pool |      23    |     456    |   19516 K  |   19516 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15814 MiB |   1353 TiB |   1353 TiB |
|       from large pool |  16640 KiB |  15788 MiB |   1343 TiB |   1343 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1349 TiB |   1349 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1339 TiB |   1339 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1878 MiB |  16412 MiB |  30926 MiB |  29048 MiB |
|       from large pool |   1860 MiB |  16384 MiB |  30888 MiB |  29028 MiB |
|       from small pool |     18 MiB |     28 MiB |     38 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680312 KiB | 204763 GiB | 204763 GiB |
|       from large pool |  24320 KiB | 677984 KiB | 194443 GiB | 194443 GiB |
|       from small pool |      0 KiB |  17267 KiB |  10320 GiB |  10320 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4646    |   89487 K  |   89487 K  |
|       from large pool |       2    |     593    |   45361 K  |   45361 K  |
|       from small pool |       0    |    4346    |   44125 K  |   44125 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4646    |   89487 K  |   89487 K  |
|       from large pool |       2    |     593    |   45361 K  |   45361 K  |
|       from small pool |       0    |    4346    |   44125 K  |   44125 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     102    |     462    |     821    |     719    |
|       from large pool |      93    |     448    |     802    |     709    |
|       from small pool |       9    |      14    |      19    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     565    |   50415 K  |   50415 K  |
|       from large pool |       3    |     301    |   30898 K  |   30898 K  |
|       from small pool |       0    |     456    |   19517 K  |   19517 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 10:51:24 2024]
Finished job 0.
1 of 1 steps (100%) done
