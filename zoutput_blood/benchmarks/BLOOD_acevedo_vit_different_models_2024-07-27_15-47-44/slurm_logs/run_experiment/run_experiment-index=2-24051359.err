Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 08:48:48 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359

 Experiment start at: 2024-08-03 09:02:34.987756
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.044287413358688354
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9255137, 'precision': 0.83915967, 'recall': 0.7369098, 'specificity': 0.99178815, 'f1': 0.7654187, 'auroc': 0.99101216}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   289     0   0    23    1    3    68     7    10   11     71
1     0  1234   0    31    1    0     1    49     7    1      7
2     0     1  52     8   45    5     7    26    43  118      7
3     0     0   0  8186    0    5     3   138   101    0      2
4     0     0   6     7  219    3    10     4   104   11    175
5     0     0   1    92    0  369     0     0     9   49      1
6     3     0   0    20    3    2  1819     4    16    6     35
7     0    28   2   437    1    1     9  6665   102    1     18
8     0     4   3   269    3    4    14    58  2914    1     24
9     0     1  11    34    0  134     1     1    18  292      1
10    6     2   0    12   37    2    44    28   112    0  12553
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.92662835, 'precision': 0.84140337, 'recall': 0.74430376, 'specificity': 0.99193335, 'f1': 0.7728325, 'auroc': 0.9908824}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   295     0   0    18    0    4    69     7    17   10     63
1     0  1240   0    22    2    0     1    52     5    2      8
2     0     1  65     9   45    7     1    18    36  122      8
3     0     2   0  8191    0    5     3   135   104    0      0
4     1     0  10     9  225    2     7     3    96   12    174
5     0     0   0    88    0  374     0     0     7   51      1
6     3     0   0    17    4    3  1829     2    20    6     24
7     0    22   0   450    3    0    12  6656   110    0     12
8     0     4   2   271    5    2    11    59  2917    1     24
9     2     1  11    34    0  130     0     3    19  291      2
10    4     2   1     9   46    2    35    24   114    0  12559
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6009935, 'precision': 0.60775644, 'recall': 0.5010526, 'specificity': 0.9602597, 'f1': 0.50447583, 'auroc': 0.85938346}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   525     0   0  160    0   10   273   41    53   80    28
1     0  1163   0   56    2    0     7  234     4    1    32
2     2     4  13  101  191    9    19   42   439   77   118
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    0  237    0     0    1    36    0  1358
5     0     0   0  232    0  229     1    0     4  124     2
6     0     0   0   16  106    0  2308    4   227    0   406
7     0     0   0  208    0    0     4  948     1    0     3
8     0     0   0  246    4    1     8    2  1106    1     2
9     2     9  22  400   33   73    10   31   120  426    11
10    0     0   0    0    9    0     0    0     2    0  1635
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 09:56:31.832425,epoch time: 0:53:56.844669,used: 0:53:56.844669,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9379816, 'precision': 0.85934967, 'recall': 0.7992599, 'specificity': 0.99302965, 'f1': 0.81495714, 'auroc': 0.99392986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     1    0    0     6     3     3    3     45
1     4  1220    0    13    1    0     1    76     6    1     10
2     8     0  126     0   46    0     0    10     5  106     11
3     8     0    0  7878    0   24    12   409    95   10      2
4     6     0   18     0  212    0     3     4     9   28    257
5     2     0    1    18    0  334     0     0     4  161      1
6    20     0    0     1    2    0  1849     1     3    1     31
7     4     4    2   125    1    0    10  7030    41    3     42
8    13     0    3   148   10   10     9   111  2853   12    127
9    16     0   16     6    0   36     0     2     4  410      3
10   23     0    0     7    7    0     6    12     8    7  12724
---- Validation: 
scalar performance:
{'acc': 0.93708706, 'precision': 0.8579129, 'recall': 0.7973435, 'specificity': 0.9929151, 'f1': 0.8124661, 'auroc': 0.99373734}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    0     2    0    0     3     7     1    4     43
1     4  1212    0    15    0    0     2    80     7    1     11
2     9     0  118     2   48    1     0    12     6  103     13
3     7     0    0  7892    0   33    11   400    87    8      2
4     4     0   21     0  214    0     2     8    11   23    256
5     3     0    0    21    0  333     0     0     3  160      1
6    26     0    0     1    0    0  1843     0     2    3     33
7    10     6    0   124    1    0     4  7035    45    5     35
8    15     0    3   151   11    6    13   115  2818   15    149
9    11     0   15     6    0   32     0     2     3  420      4
10   22     0    0     8    8    0     8    11     9    5  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72692925, 'precision': 0.65772355, 'recall': 0.60371506, 'specificity': 0.97243714, 'f1': 0.5822268, 'auroc': 0.8795951}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1140     0   0    6    0    0    15     5     0    4     0
1     36  1118   2   33    0    1    16   243     3    7    40
2     53     1  75   21  290    1    48    71    92  218   145
3      0     0   0    0    0    0     0     0     0    0     0
4      3     0   0    0  166    0     4     2     8    1  1449
5     19     0   0   52    0  162     2     0     2  355     0
6      0     0   0    7    0    0  3047     1     0    0    12
7      0     0   0   12    0    0    32  1113     0    3     4
8     11     0   1  132    7    1    39    17  1133   21     8
9     98     6  61   36    9   20     3    52    41  790    21
10     0     0   0    0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 10:48:17.277069,epoch time: 0:51:45.444644,used: 1:45:42.289313,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95363337, 'precision': 0.8672272, 'recall': 0.8432607, 'specificity': 0.99499774, 'f1': 0.85157186, 'auroc': 0.99663275}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     4    0    0     1     2     9    3     21
1     0  1281    0     8    0    0     0    35     5    0      3
2     1     0  160     2   47    5     1     6     8   80      2
3     1     1    0  8197    0    9     0   106   124    0      0
4     5     0   24     3  310    3     0     4    23   10    157
5     0     0    0    29    0  446     0     0     4   41      1
6    43     0    0     9    7    5  1804     3    14    3     20
7     1    10    1   217    1    0     1  6945    83    0      5
8     0     1    7    87    9    3     0    53  3110    4     21
9     0     0   22     9    0  133     0     2     7  320      0
10   41     0    5     8   35    2     6    15    49    3  12628
---- Validation: 
scalar performance:
{'acc': 0.95428646, 'precision': 0.8766081, 'recall': 0.8474549, 'specificity': 0.9950525, 'f1': 0.85784566, 'auroc': 0.9963327}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     5    0    1     2     3    11    3     16
1     0  1277    0    12    0    0     0    34     5    0      4
2     0     3  166     2   40    5     0     3    11   81      1
3     2     1    1  8216    0   10     0   102   106    2      0
4     7     1   22     5  311    3     1     2    28    7    152
5     0     0    0    33    0  446     0     0     5   36      1
6    41     0    0     6    4    2  1816     5    12    3     19
7     0     9    2   234    1    0     1  6910    99    2      7
8     1     2    5    95    7    2     0    48  3115    1     20
9     2     0   19    11    0  123     0     0     6  332      0
10   38     1    2     8   27    2     3    14    55    1  12645
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7197929, 'precision': 0.6626927, 'recall': 0.62682986, 'specificity': 0.97194314, 'f1': 0.6160947, 'auroc': 0.87489444}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1060     1    0   36    1   21     8     8    14   19     2
1      2  1311    1   22    1    2     0   121     9    5    25
2     18     8  115   20  307   18     5    25   245   96   158
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    1    0  291    0     0     0    14    1  1324
5      6     0    0   94    1  413     2     0    11   63     2
6      2     0    0   13   31    0  2637     3    62    0   319
7      2     0    1  120    0    1     3  1029     3    0     5
8      0     0    0   70    2    4     0     5  1283    5     1
9     16    20  124  113   24  139     0    37   136  513    15
10     0     0    0    0   10    0     0     0     0    0  1636
better model found
persisted
after epoch: 3,now: 2024-08-03 11:41:06.879809,epoch time: 0:52:49.602740,used: 2:38:31.892053,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9517337, 'precision': 0.871791, 'recall': 0.85774714, 'specificity': 0.99476564, 'f1': 0.86282116, 'auroc': 0.99703026}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    0     6    0    1     3     1     7    3     56
1     0  1245    0     8    0    2     1    63    13    0      0
2     0     0  201     1   11    1     0     2     8   87      1
3     8     2    1  8249    0   41     4    48    84    2      0
4     1     0   61     0  308    2     0     3    34   12    118
5     0     0    1    14    0  442     0     0     5   58      1
6    31     0    1     1    3    0  1844     0     6    1     20
7     1     5    7   381    1    1     5  6710   141    2      8
8     3     0    5    84    5    4     0    32  3138    2     22
9     0     0   16     7    0   73     0     0     7  388      2
10    3     0    6     8   78    1     4    16    34    2  12641
---- Validation: 
scalar performance:
{'acc': 0.9526281, 'precision': 0.87488115, 'recall': 0.8595531, 'specificity': 0.99486786, 'f1': 0.86508745, 'auroc': 0.99689}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     0    0     6    0    1     4     3     6    6     60
1     0  1247    0     6    0    1     0    64    13    0      1
2     0     0  210     0    9    3     0     0    11   78      1
3     3     3    0  8249    0   40     3    41    97    3      1
4     2     0   70     1  314    1     0     3    27    6    115
5     0     0    1    10    0  441     0     0     5   63      1
6    26     0    1     3    0    3  1843     0     6    2     24
7     1     6    3   352    2    0     2  6736   151    3      9
8     1     0    2    91    6    5     0    20  3149    1     21
9     1     0   20     2    1   79     0     1     3  385      1
10    5     0    3     9   71    1     6    12    45    1  12643
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74952775, 'precision': 0.6910176, 'recall': 0.63903886, 'specificity': 0.9750025, 'f1': 0.6469028, 'auroc': 0.87875366}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1068     0    0    5    1    5    33    3    11   24    20
1      3  1083    8   20    2    5     6  331    13    7    21
2      6     0  277   11  213   15    15   15   240   99   124
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    8    0  583    0     2    2    13    1  1024
5      6     0    1   34    2  388     2    0     5  152     2
6      0     0    0    3    0    1  3044    1     2    0    16
7      2     0    4  314    0    1    39  787    10    3     4
8      0     0    0   90    0    4     7    0  1264    4     1
9     15     2  175   48   11  123     5   16   109  623    10
10     0     0    1    0   47    0     2    0     0    0  1596
new oracle model saved
early stop counter: 1
val acc:0.9526280760765076, best validation acc: 0.9542864561080933, corresponding to test acc:                         0.719792902469635 / 0.7495277523994446
after epoch: 4,now: 2024-08-03 12:33:44.431134,epoch time: 0:52:37.551325,used: 3:31:09.443378,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.960777, 'precision': 0.9043752, 'recall': 0.8590367, 'specificity': 0.9955448, 'f1': 0.8763272, 'auroc': 0.99725604}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     3    0    0     1     2     1    1     21
1     0  1295    0     3    0    0     2    26     4    0      1
2     3     1  202     2   34    0     0     9     3   49      9
3     1     1    0  8208    0    8     1   134    83    1      2
4     5     0   21     0  270    1     0     5    14    8    215
5     2     0    1    37    0  402     0     0     8   70      1
6    16     0    1     0    0    0  1872     0     0    0     18
7     0    25    0   127    1    0     2  7065    22    0     21
8     1     4    2    74    2    0     1    74  3031    0    107
9    10     0   40     9    0   44     0     2     5  382      1
10   29     0    0     8    4    2     5     7     6    2  12729
---- Validation: 
scalar performance:
{'acc': 0.9606794, 'precision': 0.9040084, 'recall': 0.8585131, 'specificity': 0.9955442, 'f1': 0.87574685, 'auroc': 0.99739903}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     3    0    0     2     1     2    4     17
1     0  1298    0     6    0    0     0    24     2    0      2
2     2     0  203     1   30    1     1    16     6   42     10
3     0     4    0  8231    0    6     1   121    76    1      0
4     6     0   28     0  260    1     3     4    14    7    216
5     2     0    1    36    0  408     0     0     8   65      1
6    19     0    1     1    0    0  1865     1     4    1     16
7     0    19    1   145    1    0     1  7045    29    1     23
8     2     1    5    70    2    1     1    77  3043    3     91
9     2     1   32     8    0   53     0     4     8  381      4
10   23     0    1     7    8    1     7    10    10    2  12727
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74057233, 'precision': 0.6677582, 'recall': 0.62211484, 'specificity': 0.97390306, 'f1': 0.613371, 'auroc': 0.8773157}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1093     1    0    8    0    2    45    10     1    4     6
1      1  1345    0   18    1    0     2   104     3    2    23
2     18     7  151   27  200   18    58    54   217   72   193
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    1    0  193    0     3     2     8    0  1423
5     19     0    0  126    0  275     5     0     2  163     2
6      0     0    0    3    0    0  3050     1     1    0    12
7      0     0    1   37    0    0     4  1115     1    1     5
8      0     1    0  109    1    1    15    13  1225    3     2
9     41    20  175  141    6   59    26    62    88  496    23
10     0     0    0    0    4    0     0     0     0    0  1642
better model found
persisted
after epoch: 5,now: 2024-08-03 13:26:00.730608,epoch time: 0:52:16.299474,used: 4:23:25.742852,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9625963, 'precision': 0.9007813, 'recall': 0.87067527, 'specificity': 0.9958304, 'f1': 0.8825408, 'auroc': 0.99799037}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     7    0    0     1     0     1    2     44
1     0  1318    0     3    0    0     0     6     4    0      0
2     1     1  203     0   19    1     0     2     4   73      8
3     0    11    2  8282    0    4     0    72    65    1      1
4     2     1   35     3  317    2     0     1     4    5    169
5     2     0    2    26    0  423     0     0     4   62      2
6    23     2    1     5    4    1  1835     0     4    0     33
7     0   102    2   155    2    0     1  6950    34    1     17
8     2    10    7    66   10    3     0    47  3073    5     72
9     5     1   16     7    1   55     0     0     1  405      2
10    5     4    1     7   17    1     4     3     6    0  12744
---- Validation: 
scalar performance:
{'acc': 0.9618296, 'precision': 0.8994273, 'recall': 0.87079364, 'specificity': 0.99574876, 'f1': 0.88193864, 'auroc': 0.9979564}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     1    0     1    0    1     2     0     0    2     47
1     0  1320    0     4    0    0     0     6     2    0      0
2     3     0  206     1   20    0     1     1     5   72      3
3     0    15    2  8283    0    9     0    62    69    0      0
4     3     0   33     1  318    1     0     2     5    4    172
5     3     0    1    26    0  419     0     0     4   67      1
6    23     3    1     5    5    1  1834     1     1    0     34
7     0   123    2   163    1    0     2  6920    31    0     23
8     0     9    6    74   10    2     0    43  3080    1     71
9     5     0   21    10    0   48     0     0     1  404      4
10    9     4    1     7   17    0     5     3     5    0  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.737214, 'precision': 0.6704867, 'recall': 0.6119894, 'specificity': 0.9736763, 'f1': 0.60847783, 'auroc': 0.8771587}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1086     3    0   16    1    0    37     3     6    3    15
1      1  1430    0   14    0    0     0    42     5    0     7
2     14    22  122   21  240   13    28    19   231   60   245
3      0     0    0    0    0    0     0     0     0    0     0
4      0     2    1    0  285    0     3     0     7    0  1335
5     22     0    0  161    0  246     4     0     4  149     6
6      0     0    0    5    0    0  3054     1     2    0     5
7      0     6    1  130    0    0     8  1011     3    0     5
8      0     0    0  106    3    0     8     9  1240    2     2
9     43    38  144  144   14   70    19    44   164  429    28
10     0     1    0    0    8    0     2     0     1    0  1634
better model found
persisted
after epoch: 6,now: 2024-08-03 14:19:52.313296,epoch time: 0:53:51.582688,used: 5:17:17.325540,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96896404, 'precision': 0.90618014, 'recall': 0.89743614, 'specificity': 0.99664116, 'f1': 0.89996195, 'auroc': 0.99823284}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     2    1    0     2     1     0    3     13
1     0  1298    1     4    0    0     0    24     3    0      1
2     0     0  189     0   58    3     2     3     2   52      3
3     2     3    0  8230    0   21     1   115    64    1      2
4     5     0   12     0  404    2     3     2    10    3     98
5     0     0    1     4    0  464     1     0     4   45      1
6    45     0    0     0    0    0  1849     0     1    3     10
7     2    15    2   108    2    0     2  7089    33    2      7
8     3     1    5    57   15    1     5    39  3106    1     62
9     0     0   21     1    1   55     0     0     2  413      0
10   19     0    0     7   34    2    10     4     5    0  12713
---- Validation: 
scalar performance:
{'acc': 0.9680888, 'precision': 0.8997003, 'recall': 0.89466244, 'specificity': 0.9965669, 'f1': 0.89544845, 'auroc': 0.9983312}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    1     1    1    1     2     0     0    2     15
1     0  1303    1     1    0    0     0    23     4    0      0
2     2     0  190     1   56    2     2     2     3   53      1
3     1     2    1  8223    0   21     1   111    74    5      1
4     6     2   11     0  399    2     3     2     7    4    103
5     1     0    1     9    0  460     0     0     3   46      1
6    46     1    1     0    1    0  1842     0     1    3     13
7     0    13    3   100    3    0     3  7105    28    2      8
8     5     1    6    58   16    3     3    34  3109    4     57
9     0     0   20     1    2   62     0     0     1  407      0
10   20     0    0     7   42    3    19     4     6    1  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75687397, 'precision': 0.6680826, 'recall': 0.6434769, 'specificity': 0.97515047, 'f1': 0.6350224, 'auroc': 0.8784752}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1120     0    0   5    0    4    18     5     1   16     1
1      7  1307    3  18    1    1    19   105     2   16    20
2      6     0  136   4  352   18   154    15   109   81   140
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0  268    0    24     0     7    1  1331
5      8     0    0  36    0  335    11     0     1  199     2
6      0     0    0   0    0    0  3065     0     0    1     1
7      5     1    1  14    0    0    26  1111     0    2     4
8      0     0    0  81    2    3    53     6  1217    4     4
9     23     1  182  27   22   87    46    19    82  627    21
10     0     0    0   0    7    0     7     0     0    0  1632
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-03 15:13:05.392425,epoch time: 0:53:13.079129,used: 6:10:30.404669,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9652986, 'precision': 0.91855514, 'recall': 0.89919496, 'specificity': 0.9962228, 'f1': 0.9070854, 'auroc': 0.99837947}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    1    0     2     2     1    2     15
1     0  1292    1     0    0    0     0    35     3    0      1
2     1     0  211     1   39    1     0     2     6   51      0
3     2     1    0  7971    0    8     2   332   119    4      0
4     3     0   17     0  382    1     0     3    14    5    114
5     0     0    0    14    0  436     0     0     3   67      1
6     7     0    0     0    2    0  1879     5     4    0     11
7     0    11    1    50    1    0     1  7168    24    1      5
8     3     0    6    30    8    2     0    75  3149    1     21
9     0     0   14     3    2   38     0     1     0  435      0
10   17     0    1     5   28    0     3    18    24    0  12696
---- Validation: 
scalar performance:
{'acc': 0.9657884, 'precision': 0.9174221, 'recall': 0.8962798, 'specificity': 0.9962734, 'f1': 0.905054, 'auroc': 0.99838084}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     1    0    0     2     2     1    2     16
1     0  1296    0     0    0    0     0    34     2    0      0
2     1     0  220     2   26    0     0     5     3   53      2
3     2     1    0  7984    0   12     1   328   111    1      0
4     5     0   20     0  363    2     0     4    14    2    129
5     0     0    0    13    0  434     0     0     2   71      1
6     8     0    1     0    1    0  1877     7     5    0      9
7     0    10    1    42    1    0     2  7183    21    0      5
8     1     0    4    29    8    1     0    73  3168    3      9
9     0     0   21     1    1   46     0     2     2  420      0
10   15     0    1     5   24    1     7    19    22    0  12702
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74183166, 'precision': 0.6652202, 'recall': 0.6292194, 'specificity': 0.9739138, 'f1': 0.6172816, 'auroc': 0.8699766}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1001     1    0   12    1    4    57    62    10   18     4
1      0  1194    0   12    0    0     1   255     7    6    24
2      5     2  148    9  229   15    60    46   236   70   195
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    0    0  269    0    11     2    19    0  1331
5      4     0    0  103    0  347     9     0     3  125     1
6      0     0    0    4    0    0  3056     2     4    0     1
7      0     0    0    5    0    0     1  1155     0    1     2
8      0     0    0   73    2    0     3    12  1275    3     2
9     12     0  174   55   11  109    39    55   132  523    27
10     0     0    0    0    9    0     1     0     1    0  1635
early stop counter: 1
val acc:0.9657884240150452, best validation acc: 0.9680888056755066, corresponding to test acc:                         0.7568739652633667 / 0.7568739652633667
after epoch: 8,now: 2024-08-03 16:06:08.595008,epoch time: 0:53:03.202583,used: 7:03:33.607252,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9719606, 'precision': 0.9286253, 'recall': 0.8910571, 'specificity': 0.9969034, 'f1': 0.9074434, 'auroc': 0.998614}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     4    0    0     8     0     2    2     21
1     0  1315    0     5    1    0     0     9     1    0      0
2     0     0  202     2   45    1     0     5     7   47      2
3     0     0    0  8329    0    5     0    77    25    3      1
4     3     0   12     2  361    0     0     4    23    2    132
5     1     0    1    25    0  440     1     0     4   47      2
6     2     0    0     2    1    0  1885     1     5    1     10
7     0    31    0   107    1    0     1  7104    15    0      4
8     1     0    2    86    2    0     0    63  3130    2      8
9     5     0   18     9    2   48     0     0     2  409      0
10    7     0    1     7   11    1    11    12    37    0  12707
---- Validation: 
scalar performance:
{'acc': 0.9722081, 'precision': 0.9262754, 'recall': 0.8904513, 'specificity': 0.99694264, 'f1': 0.9061034, 'auroc': 0.9986244}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     1    0     4    0    0     6     0     3    0     20
1     0  1313    1     6    1    0     0    10     1    0      0
2     1     0  194     2   48    1     0     9     4   50      3
3     0     4    0  8329    0    4     0    76    27    0      0
4     5     0    9     2  364    1     2     5    22    1    128
5     1     0    0    19    0  458     1     0     3   38      1
6     5     0    1     2    2    1  1880     4     3    0     10
7     0    31    0    94    1    0     1  7124    10    1      3
8     0     0    1    74    3    3     1    74  3133    1      6
9     5     0   25    12    2   48     0     1     2  398      0
10    5     0    0    10   16    0    13    16    32    0  12704
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7053103, 'precision': 0.65667504, 'recall': 0.5838771, 'specificity': 0.9706016, 'f1': 0.5791513, 'auroc': 0.8517913}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   992     0   0   29    0    0    67    53     5    1    23
1     1  1308   0   26    1    0     1   137     3    0    22
2    12     2  92   41  258   11    31    78   207   37   246
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  119    0     5     2    12    0  1495
5    18     0   0  240    0  262     4     0     1   62     5
6     0     0   0    7    0    0  3050     1     0    0     9
7     0     0   0  104    0    0     4  1051     1    0     4
8     0     0   0  174    0    0    10    14  1168    1     3
9    32     2  90  261   18   80    23   114    75  395    47
10    0     0   0    0    1    0     0     0     1    0  1644
better model found
persisted
after epoch: 9,now: 2024-08-03 16:58:44.270103,epoch time: 0:52:35.675095,used: 7:56:09.282347,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97217464, 'precision': 0.9255642, 'recall': 0.8930615, 'specificity': 0.9969198, 'f1': 0.90420836, 'auroc': 0.9987205}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     2    0    0     2     4     1    2     18
1     0  1318    0     2    0    0     0     8     4    0      0
2     1     0  201     0   28    0     1     1     4   70      6
3     0     2    0  8297    0   34     0    52    46    3      1
4     5     0   16     1  315    1     4     2    16    2    177
5     0     0    0     4    0  445     0     0     2   69      1
6    10     0    1     4    1    0  1870     1     2    0     19
7     2    14    2   118    1    0     1  7033    79    2     11
8     1     1    3    43    3    1     0    14  3204    8     18
9     0     0   11     0    0   29     1     0     2  449      1
10    8     0    1     7    5    1     1     2    18    1  12750
---- Validation: 
scalar performance:
{'acc': 0.9721011, 'precision': 0.9309089, 'recall': 0.8945715, 'specificity': 0.99688995, 'f1': 0.9075607, 'auroc': 0.99865806}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     3    0    0     4     1     1    1     23
1     0  1312    0     6    0    0     0    12     2    0      0
2     3     0  210     1   23    0     1     1     2   66      5
3     1     6    0  8310    0   27     0    51    39    5      1
4     4     0   10     1  325    0     3     0    11    4    181
5     0     0    0     5    0  438     0     0     2   75      1
6     7     0    1     5    1    0  1875     2     2    0     15
7     2    18    0   117    1    0     1  7025    86    3     12
8     2     1    2    44    2    2     0    16  3194    7     26
9     0     0   12     0    0   30     0     0     1  447      3
10    6     0    0     8    4    1     5     2    14    0  12756
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6944658, 'precision': 0.6615537, 'recall': 0.5807529, 'specificity': 0.96939814, 'f1': 0.5721279, 'auroc': 0.84221303}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   942     3   0   82    0    0    27    43    18   16    39
1     1  1307   0   17    0    0     1   132     6    1    34
2     6     1  60   38  174    9    44    18   271   71   323
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  103    0     2     0    12    0  1515
5     6     0   0  156    0  213     5     0     3  207     2
6     4     0   0   51    0    0  2788     1    18    0   205
7     0     0   0   63    0    0     2  1088     7    0     4
8     0     0   0  161    0    0     1     2  1203    2     1
9    11     4  45  176   10   44    28    28   166  579    46
10    0     0   0    0    2    0     0     0     1    0  1643
early stop counter: 1
val acc:0.972101092338562, best validation acc: 0.9722080826759338, corresponding to test acc:                         0.7053102850914001 / 0.7568739652633667
after epoch: 10,now: 2024-08-03 17:53:54.048997,epoch time: 0:55:09.778894,used: 8:51:19.061241,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:51:19.061241 at 2024-08-03 17:53:54.048997
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7053103, 'precision': 0.65667504, 'recall': 0.5838771, 'specificity': 0.9706016, 'f1': 0.5791513, 'auroc': 0.8517913}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   992     0   0   29    0    0    67    53     5    1    23
1     1  1308   0   26    1    0     1   137     3    0    22
2    12     2  92   41  258   11    31    78   207   37   246
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  119    0     5     2    12    0  1495
5    18     0   0  240    0  262     4     0     1   62     5
6     0     0   0    7    0    0  3050     1     0    0     9
7     0     0   0  104    0    0     4  1051     1    0     4
8     0     0   0  174    0    0    10    14  1168    1     3
9    32     2  90  261   18   80    23   114    75  395    47
10    0     0   0    0    1    0     0     0     1    0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75687397, 'precision': 0.6680826, 'recall': 0.6434769, 'specificity': 0.97515047, 'f1': 0.6350224, 'auroc': 0.8784752}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1120     0    0   5    0    4    18     5     1   16     1
1      7  1307    3  18    1    1    19   105     2   16    20
2      6     0  136   4  352   18   154    15   109   81   140
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0  268    0    24     0     7    1  1331
5      8     0    0  36    0  335    11     0     1  199     2
6      0     0    0   0    0    0  3065     0     0    1     1
7      5     1    1  14    0    0    26  1111     0    2     4
8      0     0    0  81    2    3    53     6  1217    4     4
9     23     1  182  27   22   87    46    19    82  627    21
10     0     0    0   0    7    0     7     0     0    0  1632
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_02_33_seed_0_24051359_instance_wise_predictions.txt
accuracy from prediction file 0.7053102917512069
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/2.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4046 MiB |  18149 MiB | 702705 GiB | 702701 GiB |
|       from large pool |   4023 MiB |  18115 MiB | 698690 GiB | 698687 GiB |
|       from small pool |     23 MiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   4046 MiB |  18149 MiB | 702705 GiB | 702701 GiB |
|       from large pool |   4023 MiB |  18115 MiB | 698690 GiB | 698687 GiB |
|       from small pool |     23 MiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  18113 MiB | 701420 GiB | 701416 GiB |
|       from large pool |   4013 MiB |  18080 MiB | 697410 GiB | 697406 GiB |
|       from small pool |     22 MiB |     35 MiB |   4009 GiB |   4009 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18948 MiB |  18948 MiB |  18948 MiB |      0 B   |
|       from large pool |  18910 MiB |  18910 MiB |  18910 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    781 MiB |   1826 MiB | 322161 GiB | 322161 GiB |
|       from large pool |    768 MiB |   1820 MiB | 318102 GiB | 318101 GiB |
|       from small pool |     12 MiB |     18 MiB |   4059 GiB |   4059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   47215 K  |   47211 K  |
|       from large pool |     502    |     727    |   20508 K  |   20508 K  |
|       from small pool |    3168    |    4690    |   26706 K  |   26703 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   47215 K  |   47211 K  |
|       from large pool |     502    |     727    |   20508 K  |   20508 K  |
|       from small pool |    3168    |    4690    |   26706 K  |   26703 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     413    |     413    |     413    |       0    |
|       from large pool |     394    |     394    |     394    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     216    |    1220    |   23767 K  |   23766 K  |
|       from large pool |     182    |     279    |   12598 K  |   12598 K  |
|       from small pool |      34    |    1038    |   11168 K  |   11168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18149 MiB | 702705 GiB | 702705 GiB |
|       from large pool |  16640 KiB |  18115 MiB | 698690 GiB | 698690 GiB |
|       from small pool |      0 KiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18149 MiB | 702705 GiB | 702705 GiB |
|       from large pool |  16640 KiB |  18115 MiB | 698690 GiB | 698690 GiB |
|       from small pool |      0 KiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  18113 MiB | 701420 GiB | 701420 GiB |
|       from large pool |  16640 KiB |  18080 MiB | 697410 GiB | 697410 GiB |
|       from small pool |      0 KiB |     35 MiB |   4009 GiB |   4009 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4828 MiB |  18948 MiB |  18948 MiB |  14120 MiB |
|       from large pool |   4792 MiB |  18910 MiB |  18910 MiB |  14118 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1826 MiB | 322164 GiB | 322164 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 318104 GiB | 318104 GiB |
|       from small pool |      0 KiB |     30 MiB |   4059 GiB |   4059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20508 K  |   20508 K  |
|       from small pool |       0    |    4690    |   26706 K  |   26706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20508 K  |   20508 K  |
|       from small pool |       0    |    4690    |   26706 K  |   26706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     205    |     413    |     413    |     208    |
|       from large pool |     187    |     394    |     394    |     207    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   23768 K  |   23768 K  |
|       from large pool |       3    |     279    |   12599 K  |   12599 K  |
|       from small pool |       0    |    1038    |   11169 K  |   11169 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18149 MiB | 702705 GiB | 702705 GiB |
|       from large pool |  16640 KiB |  18115 MiB | 698690 GiB | 698690 GiB |
|       from small pool |      0 KiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18149 MiB | 702705 GiB | 702705 GiB |
|       from large pool |  16640 KiB |  18115 MiB | 698690 GiB | 698690 GiB |
|       from small pool |      0 KiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  18113 MiB | 701420 GiB | 701420 GiB |
|       from large pool |  16640 KiB |  18080 MiB | 697410 GiB | 697410 GiB |
|       from small pool |      0 KiB |     35 MiB |   4009 GiB |   4009 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4828 MiB |  18948 MiB |  18948 MiB |  14120 MiB |
|       from large pool |   4792 MiB |  18910 MiB |  18910 MiB |  14118 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1826 MiB | 322164 GiB | 322164 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 318104 GiB | 318104 GiB |
|       from small pool |      0 KiB |     30 MiB |   4059 GiB |   4059 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20508 K  |   20508 K  |
|       from small pool |       0    |    4690    |   26706 K  |   26706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20508 K  |   20508 K  |
|       from small pool |       0    |    4690    |   26706 K  |   26706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     205    |     413    |     413    |     208    |
|       from large pool |     187    |     394    |     394    |     207    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   23768 K  |   23768 K  |
|       from large pool |       3    |     279    |   12599 K  |   12599 K  |
|       from small pool |       0    |    1038    |   11169 K  |   11169 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359

 Experiment start at: 2024-08-03 18:13:44.163546
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92674446, 'precision': 0.81198806, 'recall': 0.7768086, 'specificity': 0.9919916, 'f1': 0.78659624, 'auroc': 0.9920337}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   293     0    5    16    0    0    42     8     8   16     95
1     0  1236    0    21    0    0     0    70     0    0      4
2     0     0  206     2   29    9     2    11     7   44      2
3     3     0    1  8067    1   14     1   280    70    1      1
4     1     1   80     2  254    3     1     9    47   16    125
5     1     0    7    57    0  423     1     0     8   23      1
6     9     1    1    10    0    0  1850     8     7    6     16
7     1    11    0   309    2    1     2  6882    39    1     14
8     2     3    6   331   12    4     6   114  2772    1     45
9     2     0   89     9    4  193     1     2     5  186      2
10    5     1    5     7  169    2    20    59    49    6  12469
---- Validation: 
scalar performance:
{'acc': 0.9260399, 'precision': 0.8152446, 'recall': 0.77697146, 'specificity': 0.99191374, 'f1': 0.787233, 'auroc': 0.991357}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   293     0    9    12    2    4    47    10     9   14     83
1     1  1226    0    22    0    0     0    76     1    0      6
2     0     1  206     4   25   12     1    11    13   39      0
3     3     1    0  8063    0   18     4   283    68    0      0
4     1     1   74     1  263    3     2    11    44   13    126
5     1     0    5    59    0  428     0     0     8   19      1
6    14     1    2     4    1    0  1846    10     9    5     16
7     0     9    0   320    3    1     3  6885    34    2      8
8     1     3    5   346   12    5     3   105  2762    0     54
9     1     0   78    13    2  201     3     4     7  181      3
10    6     1    9    10  158    3    28    52    60    2  12467
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74064225, 'precision': 0.6653321, 'recall': 0.6205274, 'specificity': 0.97358453, 'f1': 0.62281287, 'auroc': 0.879073}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   685     1    4   24    1    0   374    14     7   46    14
1     2  1268    0   26    3    2     5   163     5    1    24
2     8     0  195    6  231   18    23    32   371   74    57
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  738    0    13     1    21    0   856
5     3     0    0   51    0  362     6     0    15  153     2
6     0     0    0    1    1    0  3053     3     4    1     4
7     0     0    0   19    0    0     1  1138     3    0     3
8     0     0    0  107    0    3    26     1  1230    1     2
9    15    17  245   62   25  109    15    32   227  380    10
10    0     0    0    0  103    0     6     0     0    0  1537
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 19:08:23.514937,epoch time: 0:54:39.351391,used: 0:54:39.351391,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9476937, 'precision': 0.877568, 'recall': 0.81074536, 'specificity': 0.9941135, 'f1': 0.8370614, 'auroc': 0.9951505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    0    11    0    0    26     9     6   10     50
1     0  1256    0    22    0    0     0    49     1    0      4
2     0     0  138     1   60    0     3    10     2   86     12
3     0     1    1  8226    0   14     1   133    58    1      0
4     3     0   16     1  266    0     0     5    19   15    214
5     2     0    1    36    0  378     0     0     5   98      1
6     6     0    0    10    0    0  1852     5     5    3     27
7     0     6    0   248    1    0     2  6940    45    1     20
8     0     0    5   228   10    1     1    77  2926    4     44
9     0     0   36     5    1   54     3     2     8  377      7
10    6     0    0     9   18    1    12    20    36    1  12691
---- Validation: 
scalar performance:
{'acc': 0.9467166, 'precision': 0.8772161, 'recall': 0.8075908, 'specificity': 0.99400234, 'f1': 0.83404183, 'auroc': 0.9952111}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    1    12    0    0    29     7     8    3     52
1     0  1261    0    20    0    0     0    47     1    1      2
2     1     0  125     0   67    1     2    16     0   89     11
3     0     0    0  8210    0   11     0   151    65    3      0
4     0     0   12     1  267    0     0     3    20   19    217
5     0     0    0    33    0  381     0     0     5  101      1
6     7     1    0    13    0    0  1853     4     8    1     21
7     1     6    1   254    1    0     1  6929    49    2     21
8     2     1    5   216    5    1     1    80  2923    4     58
9     0     0   29     8    5   57     3     4     5  377      5
10    7     0    1     8   16    0     9    19    38    2  12696
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6987336, 'precision': 0.65440935, 'recall': 0.57741946, 'specificity': 0.9698364, 'f1': 0.57918984, 'auroc': 0.87036026}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   831     1    0   75    1    0   162   16    48   21    15
1     0  1325    0   34    0    1     0  121     5    0    13
2     8     4   85   19  235    4     9   31   321   68   231
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    0  256    0     2    1    14    0  1360
5     2     0    0  103    0  262     1    0    17  204     3
6     0     1    1   41    1    0  2955    3    40    0    25
7     0     0    0  184    0    0     0  971     4    0     5
8     0     0    1  154    0    0     1    0  1211    2     1
9    10     8  133  148   17   38     5   49   245  450    34
10    0     0    0    0    5    0     0    0     0    0  1641
better model found
persisted
after epoch: 2,now: 2024-08-03 20:03:01.063659,epoch time: 0:54:37.548722,used: 1:49:16.900113,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94887096, 'precision': 0.8725438, 'recall': 0.8578013, 'specificity': 0.9945171, 'f1': 0.86433315, 'auroc': 0.9963616}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     8    1    0     6     7     9    2     19
1     0  1277    0     7    0    0     0    41     7    0      0
2     2     0  204     2   24    1     0     5    10   60      4
3     1     0    0  8242    0    7     4   112    72    0      0
4     5     1   41     0  317    1     1     3    55   16     99
5     0     0    0    33    0  409     0     0     6   72      1
6    10     0    1     4    0    0  1869     4     8    1     10
7     0     9    0   291    1    0     2  6877    78    2      4
8     1     0    4   186    0    3     0    39  3056    1      5
9     2     0   33    10    0   67     0     0     8  373      0
10   24     5    3     7  112    1    14    35   178    3  12410
---- Validation: 
scalar performance:
{'acc': 0.9475458, 'precision': 0.8695876, 'recall': 0.8516611, 'specificity': 0.9943594, 'f1': 0.8597608, 'auroc': 0.99617136}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     6    0    0     5     4    11    2     22
1     0  1278    0     5    0    0     0    40     9    0      0
2     2     0  198     3   29    2     1     3    12   59      3
3     1     0    1  8254    0    6     2   110    66    0      0
4     5     2   40     2  306    2     1     5    63   13    100
5     0     0    0    39    0  409     0     0     4   67      2
6    11     0    1     4    0    0  1862     4     8    2     16
7     0    12    0   296    1    0     2  6874    75    1      4
8     1     1    4   196    3    3     1    46  3034    0      7
9     0     0   34     8    0   77     0     3     9  362      0
10   23     9    4     9  105    1     8    43   179    1  12414
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7286084, 'precision': 0.68843675, 'recall': 0.6099836, 'specificity': 0.9729208, 'f1': 0.60071445, 'auroc': 0.8624534}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   873     1    0   74    0    1    79    50    49   34     9
1     0  1284    0   27    1    0     0   170    14    0     3
2     4     2  120   11   63   20     1    36   647   41    70
3     0     0    0    0    0    0     0     0     0    0     0
4     2     3    9    0  610    0    11     2    91    1   904
5     1     0    0  145    2  371     0     0    27   46     0
6     0     1    0   10    0    0  3021     3    21    0    11
7     0     0    0   40    0    0     1  1115     7    0     1
8     0     0    0  100    0    1     2     1  1266    0     0
9     3     9   48  119    3  163     0    51   530  206     5
10    0     2    1    0   87    0     4     2     2    0  1548
better model found
persisted
after epoch: 3,now: 2024-08-03 20:57:56.896899,epoch time: 0:54:55.833240,used: 2:44:12.733353,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9548373, 'precision': 0.88302255, 'recall': 0.83703107, 'specificity': 0.9949899, 'f1': 0.857164, 'auroc': 0.99666977}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    0     7    0    0     8     3     1    0     41
1     0  1275    0     6    0    0     0    43     4    0      3
2     5     0  141     3  105    3     0    10     9   29      7
3     0     0    1  8103    0    2     0   276    54    1      0
4     4     0    2     3  365    0     0     2    18    6    139
5     0     0    2    51    0  383     0     0     6   78      1
6    12     0    1     8    2    2  1845     6     7    2     21
7     2     7    0   112    1    0     1  7093    31    0     17
8     3     0    2   139    9    0     0    92  3011    0     39
9     7     0   57    11    6   53     1     4     8  344      2
10    6     0    0     7   45    1     3    14    14    0  12705
---- Validation: 
scalar performance:
{'acc': 0.9550622, 'precision': 0.88650596, 'recall': 0.8370403, 'specificity': 0.99499726, 'f1': 0.8584235, 'auroc': 0.9966954}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     8    0    0     3     5     1    1     35
1     0  1270    0     6    0    0     0    50     2    0      4
2     7     0  139     1  114    1     0     9     9   27      5
3     0     1    0  8127    0    3     1   258    50    0      0
4     5     0    4     2  356    0     0     3    17    4    148
5     0     0    0    47    1  387     0     0     5   80      1
6    11     0    1     9    1    1  1844     4     9    1     27
7     0    10    0   114    1    0     1  7092    30    0     17
8     1     0    2   138   10    0     0    96  3008    0     41
9     4     0   53    15   12   44     1     7     6  347      4
10    8     0    0     8   33    1     4    15    22    0  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6435318, 'precision': 0.6197449, 'recall': 0.5330143, 'specificity': 0.9644122, 'f1': 0.517779, 'auroc': 0.8457212}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   838     2   0   67    1    1   112   101    26    5    17
1     0  1289   0   13    0    0     0   166     1    0    30
2    11     1  30   36  255    2     4    47   310   14   305
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  289    0     1     0     8    0  1335
5     2     0   2  343    1  160     0     1    28   55     0
6     0     4   0  130    1    0  2411     5    98    0   418
7     0     0   0   12    0    0     0  1149     0    0     3
8     0     0   0  102    0    0     1    29  1235    0     3
9    13     7  92  263   24   52     3   149   323  161    50
10    0     0   0    0   10    0     0     0     0    0  1636
better model found
persisted
after epoch: 4,now: 2024-08-03 21:57:47.583748,epoch time: 0:59:50.686849,used: 3:44:03.420202,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9575396, 'precision': 0.86897516, 'recall': 0.86571497, 'specificity': 0.9955039, 'f1': 0.86217016, 'auroc': 0.9974908}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     1    0     2    0    0    13     4     3    4     49
1     0  1299    1    10    0    0     0    17     3    0      2
2     0     0  260     0   34    0     0     1     1   16      0
3     0     3    1  8155    3   17     1   120   134    5      0
4     3     0   40     0  391    0     0     4     9    4     88
5     0     0    4    12    1  327     0     0     7  169      1
6     3     0    1     5    2    0  1879     2     2    0     14
7     0    42    8   166    2    0     1  7007    28    3      6
8     0     1   14    44   16    3     1    71  3105    1     37
9     0     0  132     3    5   17     0     0     4  331      0
10    4     0    2     5  110    0    10    12    21    2  12628
---- Validation: 
scalar performance:
{'acc': 0.9573626, 'precision': 0.870304, 'recall': 0.8684474, 'specificity': 0.9954934, 'f1': 0.8643075, 'auroc': 0.9975309}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     0    2     4    3    0    20     6     4    4     47
1     0  1304    0     7    0    0     0    15     5    0      1
2     0     0  263     0   33    0     0     1     3   12      0
3     0     2    2  8151    0   18     1   129   134    3      0
4     3     0   36     0  406    0     0     1     9    3     81
5     0     0    5    12    1  342     0     0     5  155      1
6     5     0    1     5    2    0  1873     3     3    1     15
7     0    43    7   153    1    0     1  7009    41    2      8
8     0     3   17    52   18    2     1    68  3097    2     36
9     1     0  132     3    8   17     1     0     1  330      0
10    3     0    2     7  114    0     8    13    24    2  12623
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75911283, 'precision': 0.69208395, 'recall': 0.6346637, 'specificity': 0.9755055, 'f1': 0.6457468, 'auroc': 0.8812726}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   637     1    6  31    7    1   330    26    10   85    36
1     0  1357    1  17    3    2     2    99     8    0    10
2     0     0  346   4  371    3     8    25   156   44    58
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  745    0     5     0    10    0   869
5     1     0    6  59    4  286     1     0    13  222     0
6     0     0    0   2    0    0  3057     1     2    0     5
7     0     0    1  37    0    0     0  1121     0    1     4
8     0     0    1  49    1    2     3    19  1291    2     2
9     2     2  396  43   22   44     2    47    95  471    13
10    0     0    0   0  104    0     3     0     0    0  1539
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-03 23:04:30.722079,epoch time: 1:06:43.138331,used: 4:50:46.558533,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96270335, 'precision': 0.89221793, 'recall': 0.8938049, 'specificity': 0.99599564, 'f1': 0.89271045, 'auroc': 0.9981057}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     2    3    0    19     3     0    2     21
1     0  1302    0     8    0    0     0    19     1    0      0
2     2     0  225     0   35    2     2     4     2   40      0
3     0     8    1  8329    0   10     3    50    34    2      0
4     6     0   28     2  412    1     3     1     7    5     73
5     1     0    0    18    0  443     0     0     2   56      1
6     4     0    0     3    1    0  1887     0     3    3      5
7     0    47    6   222    2    0     1  6955    25    2      5
8     2     9    7   171   17    3     2    38  3009    3     35
9     1     0   32     5    4   59     0     1     2  388      1
10   23     0    2     8  110    0    25    10    17    1  12599
---- Validation: 
scalar performance:
{'acc': 0.9629798, 'precision': 0.8969145, 'recall': 0.894622, 'specificity': 0.9960042, 'f1': 0.89547944, 'auroc': 0.99803156}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     5    3    0    17     1     0    1     14
1     0  1307    0     8    0    0     0    16     1    0      0
2     2     0  223     1   39    0     3     1     1   42      0
3     0     8    2  8333    0   10     0    52    34    1      0
4     3     0   24     2  410    1     4     1     9    5     80
5     0     0    0    21    0  449     0     0     4   46      1
6     6     0    1     1    4    0  1889     2     0    0      5
7     2    45    2   247    1    0     2  6923    28    1     14
8     2     6    6   153   16    1     3    53  3026    1     29
9     1     0   36     7    1   64     0     2     1  381      0
10   16     0    1     8  101    0    30     8    12    2  12618
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7239208, 'precision': 0.6812539, 'recall': 0.61063147, 'specificity': 0.9724865, 'f1': 0.6271082, 'auroc': 0.87242615}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   859     3    2   31    2    4   235    1     1   29     3
1     0  1326    1   32    0    0     1  120     5    0    14
2     7     3  251   35  390   10    19   10   160   91    39
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    4    0  506    0    10    1     8    1  1103
5     3     0    1  120    1  378     1    0     3   85     0
6     0     0    1   54    2    0  2983    1     4    0    22
7     0     0    0  248    0    1     3  907     2    0     3
8     0     0    0  216    2    1     1    3  1145    1     1
9     9     2  212  198   12  166     3   26   113  385    11
10    0     0    0    0   33    0     5    0     1    0  1607
better model found
persisted
after epoch: 6,now: 2024-08-04 00:25:16.427396,epoch time: 1:20:45.705317,used: 6:11:32.263850,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.966021, 'precision': 0.9111673, 'recall': 0.86827475, 'specificity': 0.9962695, 'f1': 0.8847915, 'auroc': 0.99826515}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     2    0    0    10     3     1    2     12
1     0  1280    0    10    0    0     0    40     2    0      0
2     1     0  168     1   48    3     1     6     4   77      3
3     1     0    0  8171    0    5     0   136   123    0      0
4     4     1    8     1  348    0     1     3    10    4    159
5     0     0    0    31    0  457     0     0     5   27      1
6     4     0    0     3    0    1  1880     3     2    4     10
7     0     6    0    71    1    0     1  7140    32    0     11
8     0     0    1    30    6    1     0    59  3150    1     47
9     1     0   14     7    2  115     0     2     4  347      1
10   14     0    1     7   20    1    17    11    13    0  12712
---- Validation: 
scalar performance:
{'acc': 0.9648522, 'precision': 0.906664, 'recall': 0.8660443, 'specificity': 0.9961462, 'f1': 0.88237345, 'auroc': 0.99807316}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     3    1    0     8     4     0    2     18
1     0  1276    0     9    0    0     0    46     1    0      0
2     1     0  169     2   52    2     1     5     7   71      2
3     2     0    1  8168    0    4     0   138   126    0      1
4     4     0   10     2  352    1     1     1    10    4    154
5     0     0    0    37    0  457     0     0     5   21      1
6     4     0    0     2    0    1  1879     6     3    3     10
7     0     5    0    73    1    0     1  7135    35    1     14
8     1     0    6    40   10    1     1    62  3136    1     38
9     0     0   17     6    3  116     0     4     4  341      2
10   13     0    0     8   19    1    22     8    13    1  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69383615, 'precision': 0.65343726, 'recall': 0.57848155, 'specificity': 0.9693564, 'f1': 0.56291956, 'auroc': 0.86096734}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   860     6    0   46    1    1   152    48    28   20     8
1     0  1153    0   36    0    0     1   292     6    0    11
2    13     0  102   32  170   20    39    57   272   87   223
3     0     0    0    0    0    0     0     0     0    0     0
4     2     0    1    0  139    0    15     2    12    1  1461
5     4     0    0  215    0  320     3     0    13   36     1
6     0     0    0   28    0    0  3018     3     9    0     9
7     0     0    0   56    0    0     1  1105     0    0     2
8     0     0    0   94    0    0     1    17  1257    0     1
9     9     1   42  234    3  203     8    98   180  329    30
10    0     0    0    0    6    0     6     0     0    0  1634
better model found
persisted
after epoch: 7,now: 2024-08-04 01:24:42.440146,epoch time: 0:59:26.012750,used: 7:10:58.276600,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9693386, 'precision': 0.9227959, 'recall': 0.8896932, 'specificity': 0.9965602, 'f1': 0.90299857, 'auroc': 0.99844015}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     1    1    0     6     0     2    3     23
1     0  1302    0     5    0    0     1    21     2    0      1
2     1     0  219     0   31    1     1     2     5   48      4
3     0     2    1  8308    0   23     1    55    47    0      0
4     7     0   15     0  321    0     0     0     5    5    186
5     0     0    0    10    0  460     0     0     2   47      1
6     2     0    1     1    0    1  1888     2     0    2     11
7     1    14    3   178    1    0     1  7000    51    4     10
8     1     0    5    69    0    3     5    31  3146    1     35
9     0     0   19     1    0   66     0     0     4  401      2
10    8     0    1     8    8    2     6     4    17    1  12738
---- Validation: 
scalar performance:
{'acc': 0.96899825, 'precision': 0.92013514, 'recall': 0.8862057, 'specificity': 0.99653196, 'f1': 0.899899, 'auroc': 0.9984714}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     1    0    0     6     1     1    4     23
1     0  1296    0     5    0    1     0    25     5    0      0
2     1     0  211     1   36    2     1     1     3   51      5
3     0     2    1  8311    0   20     1    56    49    0      0
4     4     0   16     0  315    1     1     1    11    3    187
5     1     0    0     8    0  455     0     0     2   54      1
6     4     0    1     2    0    0  1887     1     0    1     12
7     0    11    3   181    1    0     2  7004    52    2      9
8     0     0    4    65    5    4     2    27  3154    3     32
9     0     0   23     0    2   59     0     0     1  407      1
10    7     0    0     9    4    0    15     2    18    2  12739
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7134961, 'precision': 0.6529545, 'recall': 0.6046282, 'specificity': 0.97117966, 'f1': 0.5946498, 'auroc': 0.8551927}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   969     0    0   29    1    2   112    1     9   38     9
1     0  1179    0   30    0    1     7  250     7    1    24
2    22     0  141   17  142    8    33   12   181   98   361
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    1   67    0    18    1     9    1  1536
5     2     0    0   68    0  361     2    0     4  153     2
6     0     0    0   19    0    0  3044    1     1    0     2
7     1     0    0  158    0    1     3  992     7    0     2
8     0     0    0  135    0    5     6    2  1216    1     5
9     8     0  109   99    2  116    11   21   145  588    38
10    0     0    0    0    1    0     4    0     0    0  1641
better model found
persisted
after epoch: 8,now: 2024-08-04 02:24:30.899112,epoch time: 0:59:48.458966,used: 8:10:46.735566,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9712115, 'precision': 0.91891026, 'recall': 0.9024074, 'specificity': 0.9968878, 'f1': 0.90967196, 'auroc': 0.99890554}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     3    1    0     4     1     4    1     22
1     0  1313    0     7    0    0     0    10     2    0      0
2     0     0  234     1   17    2     0     3    11   42      2
3     0     5    0  8348    0   10     1    33    42    0      0
4     3     0   27     1  399    1     0     1    16    6     85
5     0     0    0    18    0  473     0     0     5   24      1
6     4     0    0     6    0    0  1880     0     6    3      8
7     0    26    0   197    1    0     1  6994    35    0      6
8     0     2    4    62    7    1     0    37  3175    0      7
9     0     0   34     5    0   92     0     2     3  357      0
10    3     0    2     9   44    0     4     8    45    0  12680
---- Validation: 
scalar performance:
{'acc': 0.9722616, 'precision': 0.9245493, 'recall': 0.90973365, 'specificity': 0.9969834, 'f1': 0.9159125, 'auroc': 0.99890536}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     6    0    0     4     0     3    1     23
1     0  1312    0     7    0    0     0    10     3    0      0
2     0     0  248     0   17    3     0     3     7   34      0
3     0     2    0  8359    0    9     0    34    36    0      0
4     4     0   32     1  395    2     0     2    12    4     87
5     0     0    0    13    0  487     0     0     1   19      1
6     3     0    0     5    0    1  1878     1     4    1     15
7     0    29    0   198    1    0     1  6996    33    1      6
8     0     2    3    63    6    1     0    44  3173    0      4
9     1     1   20     6    0   95     0     1     2  367      0
10    7     0    2     6   47    1     2     8    36    0  12687
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70377105, 'precision': 0.6792338, 'recall': 0.5911694, 'specificity': 0.9707108, 'f1': 0.58260465, 'auroc': 0.8606897}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1007     9   0   57    1    0    48   22    13    6     7
1      0  1282   0   33    1    0     0  168     5    0    10
2     23     4  97   48  124   24    28   46   402   78   141
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   1    1  222    0     9    2    27    0  1371
5      8     0   0  167    0  365     0    0     3   49     0
6      1     0   1   60    0    0  2984    3     8    0    10
7      1     0   0  182    0    0     1  978     0    0     2
8      0     0   0  184    0    0     1    6  1179    0     0
9     19     7  42  312    2  193     2   75   145  307    33
10     0     1   0    0    2    0     4    0     1    0  1638
better model found
persisted
after epoch: 9,now: 2024-08-04 03:22:39.753400,epoch time: 0:58:08.854288,used: 9:08:55.589854,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97110444, 'precision': 0.9124593, 'recall': 0.91382205, 'specificity': 0.99688864, 'f1': 0.91112477, 'auroc': 0.9990945}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     1    3    1     5     2     0    3     32
1     0  1315    0     0    0    0     0    13     4    0      0
2     0     1  258     0   35    0     0     0     0   17      1
3     0     3    1  8137    1   22     8   149   114    1      2
4     1     0   20     0  466    0     0     0     1    2     49
5     1     0    2     7    1  479     0     0     0   29      1
6     3     1    1     0    3    0  1872     0     2    2     24
7     0    13    1    48    1    0     2  7167    22    0     10
8     0     0   11    23   32    1     0    47  3108    0     73
9     0     0   69     1    2   83     0     0     2  335      1
10    2     0    1     5   47    0     2     9     3    0  12723
---- Validation: 
scalar performance:
{'acc': 0.9712719, 'precision': 0.9177061, 'recall': 0.9179782, 'specificity': 0.99688625, 'f1': 0.91542095, 'auroc': 0.99903584}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     2    5    0     2     0     0    2     36
1     0  1314    0     1    0    0     0    13     3    0      1
2     0     0  264     0   34    0     0     0     1   12      1
3     0     1    0  8142    1   15     7   163   111    0      0
4     1     0   13     0  472    0     0     0     0    2     51
5     0     0    1     5    0  490     0     0     1   23      1
6     4     0    1     1    2    0  1869     1     2    1     27
7     0    11    2    49    1    0     3  7157    30    0     12
8     1     1   11    23   30    1     0    46  3108    1     74
9     0     0   69     0    3   84     0     0     2  335      0
10    0     0    1     4   57    0     1     7     1    1  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7270692, 'precision': 0.66265726, 'recall': 0.6258245, 'specificity': 0.9726845, 'f1': 0.6052282, 'auroc': 0.8638734}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   870     5    0   40    2   17   145     8    11   56    16
1     0  1228    0   24    0    5     0   226     3    2    11
2     6     2  165   18  318   51     7    50   180   80   138
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  317    0     2     2     8    0  1302
5     1     0    0   58    1  516     0     0     1   13     2
6     0     0    0    2    1    1  3039     1     3    0    20
7     0     0    0   24    0    1     3  1131     2    0     3
8     0     0    0  176    1    4     2    12  1172    0     3
9     3     7  104  121    9  404     3    49    94  323    20
10    0     0    0    0   15    0     0     0     0    0  1631
early stop counter: 1
val acc:0.9712718725204468, best validation acc: 0.9722616076469421, corresponding to test acc:                         0.7037710547447205 / 0.7591128349304199
after epoch: 10,now: 2024-08-04 04:18:30.848685,epoch time: 0:55:51.095285,used: 10:04:46.685139,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 10:04:46.685139 at 2024-08-04 04:18:30.848685
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70377105, 'precision': 0.6792338, 'recall': 0.5911694, 'specificity': 0.9707108, 'f1': 0.58260465, 'auroc': 0.8606897}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1007     9   0   57    1    0    48   22    13    6     7
1      0  1282   0   33    1    0     0  168     5    0    10
2     23     4  97   48  124   24    28   46   402   78   141
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   1    1  222    0     9    2    27    0  1371
5      8     0   0  167    0  365     0    0     3   49     0
6      1     0   1   60    0    0  2984    3     8    0    10
7      1     0   0  182    0    0     1  978     0    0     2
8      0     0   0  184    0    0     1    6  1179    0     0
9     19     7  42  312    2  193     2   75   145  307    33
10     0     1   0    0    2    0     4    0     1    0  1638
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75911283, 'precision': 0.69208395, 'recall': 0.6346637, 'specificity': 0.9755055, 'f1': 0.6457468, 'auroc': 0.8812726}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   637     1    6  31    7    1   330    26    10   85    36
1     0  1357    1  17    3    2     2    99     8    0    10
2     0     0  346   4  371    3     8    25   156   44    58
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  745    0     5     0    10    0   869
5     1     0    6  59    4  286     1     0    13  222     0
6     0     0    0   2    0    0  3057     1     2    0     5
7     0     0    1  37    0    0     0  1121     0    1     4
8     0     0    1  49    1    2     3    19  1291    2     2
9     2     2  396  43   22   44     2    47    95  471    13
10    0     0    0   0  104    0     3     0     0    0  1539
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_13_43_seed_1_24051359_instance_wise_predictions.txt
accuracy from prediction file 0.703771076750857
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4045 MiB |  18149 MiB |   1372 TiB |   1372 TiB |
|       from large pool |   4022 MiB |  18115 MiB |   1364 TiB |   1364 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4045 MiB |  18149 MiB |   1372 TiB |   1372 TiB |
|       from large pool |   4022 MiB |  18115 MiB |   1364 TiB |   1364 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  18113 MiB |   1369 TiB |   1369 TiB |
|       from large pool |   4013 MiB |  18080 MiB |   1362 TiB |   1362 TiB |
|       from small pool |     22 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18984 MiB |  18984 MiB |  33104 MiB |  14120 MiB |
|       from large pool |  18946 MiB |  18946 MiB |  33064 MiB |  14118 MiB |
|       from small pool |     38 MiB |     38 MiB |     40 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1354 MiB |   2441 MiB | 644319 GiB | 644318 GiB |
|       from large pool |   1341 MiB |   2436 MiB | 636209 GiB | 636208 GiB |
|       from small pool |     12 MiB |     30 MiB |   8110 GiB |   8110 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   94430 K  |   94426 K  |
|       from large pool |     502    |     727    |   41017 K  |   41017 K  |
|       from small pool |    3168    |    4690    |   53412 K  |   53409 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   94430 K  |   94426 K  |
|       from large pool |     502    |     727    |   41017 K  |   41017 K  |
|       from small pool |    3168    |    4690    |   53412 K  |   53409 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     409    |     413    |     617    |     208    |
|       from large pool |     390    |     394    |     597    |     207    |
|       from small pool |      19    |      19    |      20    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     225    |    1220    |   47225 K  |   47224 K  |
|       from large pool |     188    |     284    |   24935 K  |   24935 K  |
|       from small pool |      37    |    1038    |   22289 K  |   22289 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18149 MiB |   1372 TiB |   1372 TiB |
|       from large pool |  16640 KiB |  18115 MiB |   1364 TiB |   1364 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18149 MiB |   1372 TiB |   1372 TiB |
|       from large pool |  16640 KiB |  18115 MiB |   1364 TiB |   1364 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  18113 MiB |   1369 TiB |   1369 TiB |
|       from large pool |  16640 KiB |  18080 MiB |   1362 TiB |   1362 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5400 MiB |  18984 MiB |  33104 MiB |  27704 MiB |
|       from large pool |   5364 MiB |  18946 MiB |  33064 MiB |  27700 MiB |
|       from small pool |     36 MiB |     38 MiB |     40 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2441 MiB | 644322 GiB | 644322 GiB |
|       from large pool |  24320 KiB |   2436 MiB | 636211 GiB | 636211 GiB |
|       from small pool |      0 KiB |     30 MiB |   8110 GiB |   8110 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   94430 K  |   94430 K  |
|       from large pool |       2    |     727    |   41017 K  |   41017 K  |
|       from small pool |       0    |    4690    |   53412 K  |   53412 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   94430 K  |   94430 K  |
|       from large pool |       2    |     727    |   41017 K  |   41017 K  |
|       from small pool |       0    |    4690    |   53412 K  |   53412 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     208    |     413    |     617    |     409    |
|       from large pool |     190    |     394    |     597    |     407    |
|       from small pool |      18    |      19    |      20    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   47226 K  |   47226 K  |
|       from large pool |       3    |     284    |   24936 K  |   24936 K  |
|       from small pool |       0    |    1038    |   22290 K  |   22290 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 04:27:17 2024]
Finished job 0.
1 of 1 steps (100%) done
