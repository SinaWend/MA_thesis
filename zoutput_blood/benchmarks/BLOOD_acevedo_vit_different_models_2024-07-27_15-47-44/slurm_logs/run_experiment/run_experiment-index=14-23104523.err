Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 06:50:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/14.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=14
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523

 Experiment start at: 2024-07-28 07:01:32.543888
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.12040859460830688
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93129283, 'precision': 0.8433614, 'recall': 0.7879339, 'specificity': 0.9925583, 'f1': 0.80187637, 'auroc': 0.99504423}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   357     0    0     1    0    1    33     2     8    3     77
1     0  1257    0     8    0    0     2    56     3    0      6
2     3     1  137     1   71   15     2    12     7   54      9
3     2     1    0  7598    0   42    15   345   432    2      1
4     3     0   11     1  269    7     1     1    30    6    209
5     4     0    1    21    0  472     1     0     9   12      1
6    14     0    0     0    0    2  1851     7     9    1     24
7     0    17    0   122    3    2     7  6903   172    2     36
8     2     2    3    49   16    9     6    49  3083    2     74
9    11     1   21     0    8  234     3     4    14  192      5
10    9     0    2     6   23    2    21    12    29    0  12689
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.93208504, 'precision': 0.83728945, 'recall': 0.7877096, 'specificity': 0.99264896, 'f1': 0.80024433, 'auroc': 0.99508107}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   367     0    0     3    0    0    26     4     7    1     75
1     0  1261    0     9    0    0     0    51     7    0      4
2     7     2  133     1   64   14     1     8    10   55     17
3     1     1    0  7643    1   45     9   318   420    1      1
4     3     0   10     0  267    3     2     3    33    9    209
5     5     0    1    18    1  464     1     0     8   22      1
6    19     1    1     0    0    3  1852     4     7    0     21
7     3    16    1   129    4    1     3  6890   182    0     36
8     1     2    4    41   15    9     8    58  3086    0     72
9    10     1   32     2    3  232     0     3    10  194      6
10   13     0    0     6   27    2    15    11    33    0  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68928844, 'precision': 0.62675256, 'recall': 0.59870875, 'specificity': 0.96873987, 'f1': 0.5596508, 'auroc': 0.8825607}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   996     2    0  10    0    4    97    21    17    1    22
1     1  1158    0  30    1    0     4   257    19    0    29
2    22    10  150  14  221   71     6    35   271   41   174
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    3   0  181    0     1     0    27    0  1420
5    32     0    0  68    1  463     3     0    13   10     2
6     0     1    0   2    3    0  2702     5   248    0   106
7     1     0    1  11    0    0     7  1134     6    0     4
8     5     0    1  68    3    5    12     8  1265    2     1
9    54    26  113  93   18  341    17    81   188  174    32
10    0     0    0   0   15    0     1     0     1    0  1629
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 07:45:35.498261,epoch time: 0:44:02.954373,used: 0:44:02.954373,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95194775, 'precision': 0.87797505, 'recall': 0.84029543, 'specificity': 0.99476796, 'f1': 0.8462715, 'auroc': 0.9973344}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     1    0     5    3    1    11     3     3    1     42
1     0  1285    0    10    0    0     0    32     2    0      2
2     1     0  247     1   23    5     1    10     4   15      5
3     0     2    1  8034    0   14     0   228   158    0      0
4     2     1   42     1  288    3     0     6    25    2    169
5     0     0    3    27    0  466     0     1    10   13      1
6    10     1    1     7    2    2  1854     7     4    1     19
7     1    34    1   117    2    0     1  7050    52    2      5
8     1     2    5    63    7    1     1    89  3085    1     39
9     1     0   99     7    1  178     1     6    10  188      2
10   11     0    3     7   30    2    12    22    36    0  12671
---- Validation: 
scalar performance:
{'acc': 0.9526281, 'precision': 0.88498545, 'recall': 0.84542483, 'specificity': 0.9948187, 'f1': 0.8510715, 'auroc': 0.9973951}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     1    0     4    2    1    12     4     1    3     38
1     0  1292    0    10    0    0     0    28     1    0      1
2     2     0  254     1   13    3     2     8     2   19      8
3     0     2    0  8026    0   17     0   244   151    0      0
4     3     1   36     1  295    1     2     5    22    1    172
5     0     0    2    24    0  476     0     0     6   12      1
6     9     1    2     2    0    1  1861     8     6    0     18
7     0    30    2   126    1    0     2  7049    46    1      8
8     0     3    3    59    5    2     1   101  3080    0     42
9     0     0   90     6    1  194     1     8     8  182      3
10   16     0    4     5   21    2     8    22    36    0  12682
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7055202, 'precision': 0.6737597, 'recall': 0.6122568, 'specificity': 0.9706691, 'f1': 0.5863786, 'auroc': 0.88471407}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1039     4    1   35    1   20    31    15     9    6     9
1      3  1337    1   36    1    0     1    93     7    0    20
2     11     6  278   30   97   46     4    23   320   18   182
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    6    0  160    0     1     0    25    0  1441
5      3     0    0  121    0  438     0     0    22    7     1
6      0     3    1    1    2    0  2725     3   213    0   119
7      1     0    0  100    0    0     2  1051     6    1     3
8      0     0    0   85    0    1     3     6  1274    1     0
9     12    22  191  216    5  272     5    50   203  144    17
10     0     0    0    0    7    0     0     0     1    0  1638
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 08:27:16.114601,epoch time: 0:41:40.616340,used: 1:25:43.570713,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9612586, 'precision': 0.90433306, 'recall': 0.8684449, 'specificity': 0.9957637, 'f1': 0.88512886, 'auroc': 0.9980724}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    0     4    0    0    17     2     7    3     33
1     0  1284    0    12    0    0     1    31     3    0      1
2     1     0  198     1   42    3     0    10     5   49      3
3     1     1    0  8236    0    5     4   141    49    0      0
4     3     1   17     1  376    0     2     3    31    6     99
5     0     0    0    44    0  425     0     0     4   47      1
6     5     1    1     0    1    0  1879     4     6    0     11
7     1    10    0   151    1    0     1  7046    46    2      5
8     1     0    2   141    5    4     4    73  3048    0     18
9     0     1   33    11    4   68     2     4     6  361      3
10    9     0    2     6   46    0    10    13    47    1  12658
---- Validation: 
scalar performance:
{'acc': 0.96073294, 'precision': 0.90471905, 'recall': 0.86898065, 'specificity': 0.99569356, 'f1': 0.8855732, 'auroc': 0.9981204}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    0     5    1    0    11     4     4    0     35
1     0  1290    0    10    0    0     1    28     1    0      2
2     3     0  197     1   48    1     1    13     5   40      3
3     1     1    0  8217    0    9     2   164    45    1      0
4     4     0   16     0  379    2     1     2    29    5    101
5     1     0    0    45    0  411     1     0     5   57      1
6     6     0    1     3    0    1  1883     1     4    0      9
7     0    10    0   148    1    0     3  7061    34    1      7
8     1     0    2   154    3    1     1    83  3038    0     13
9     0     0   32    10    0   67     4     5     4  369      2
10    9     0    1     7   49    0    12    17    51    1  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7339257, 'precision': 0.6660814, 'recall': 0.6316468, 'specificity': 0.97333133, 'f1': 0.6182308, 'auroc': 0.88636714}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1084     2    0   10    0    6    31    12    11   11     3
1      0  1214    0   35    2    0     1   212    10    0    25
2     10     0  153   15  329   18     5    28   269   68   120
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    1    0  292    0     1     0    27    0  1310
5      6     0    3   80    2  411     2     0     4   81     3
6      0     0    0    3    4    0  2913     3    79    0    65
7      0     0    0   43    0    0     4  1111     2    1     3
8      0     0    0  106    1    2     6     9  1243    2     1
9     15     3  114  119   29  163     5    83   152  439    15
10     0     0    0    0   14    0     1     0     1    0  1630
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-28 09:09:39.779930,epoch time: 0:42:23.665329,used: 2:08:07.236042,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9595462, 'precision': 0.8982147, 'recall': 0.8929295, 'specificity': 0.9956672, 'f1': 0.8940206, 'auroc': 0.9985538}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     2    2    1    27     0     2    2     21
1     0  1299    0    10    0    0     1    16     2    0      4
2     1     0  237     0   20    3     2     2     5   41      1
3     1     2    1  8205    1   25     7    49   145    1      0
4     5     0   18     0  405    1     5     1    12    7     85
5     0     0    0    10    0  484     1     0     4   21      1
6     2     0    1     1    0    0  1892     1     2    0      8
7     1    22    5   303    4    0    11  6777   127    3     11
8     0     1    6    56   14    6     4    24  3146    1     38
9     1     0   30     3    1  111     1     3     3  337      3
10   11     0    2     7   66    0    31     2    15    2  12656
---- Validation: 
scalar performance:
{'acc': 0.9610004, 'precision': 0.8966215, 'recall': 0.8931968, 'specificity': 0.9958374, 'f1': 0.89326525, 'auroc': 0.9985229}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     1    2    0    23     1     1    4     19
1     0  1308    0     6    0    0     0    14     4    0      0
2     1     0  232     0   29    3     2     2     2   39      2
3     3     3    2  8222    2   27    12    43   124    2      0
4     5     0   20     0  408    1     3     1    10    5     86
5     0     0    0     9    1  482     0     0     5   23      1
6     3     0    1     0    0    0  1891     0     4    2      7
7     2    26    2   289    1    0     6  6791   129    1     18
8     4     0    5    50   21    4     1    20  3155    1     35
9     0     0   26     2    1  125     3     0     3  333      0
10    8     1    3     7   59    0    23     5    14    3  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71279645, 'precision': 0.67832005, 'recall': 0.6103053, 'specificity': 0.9712737, 'f1': 0.6138698, 'auroc': 0.8886268}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1049     0    0    8    0    4    80    1     6   16     6
1      2  1246    0   39    1    0     0  168     7    0    36
2     12     0  227   16  227   15    17   26   231   86   158
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0    6    0  362    0     1    0    11    0  1251
5      5     0    2   87    3  377     3    0     6  104     5
6      0     0    0    3    3    0  2792    3    46    0   220
7      4     0    0  254    0    0    24  870     4    2     6
8      0     0    0  114    6    0    11    4  1230    4     1
9     10     2  109  171    5  166    22   59   155  410    28
10     0     0    0    0   19    0     1    0     1    0  1625
better model found
persisted
after epoch: 4,now: 2024-07-28 09:50:57.407584,epoch time: 0:41:17.627654,used: 2:49:24.863696,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9678403, 'precision': 0.928267, 'recall': 0.8760144, 'specificity': 0.9964014, 'f1': 0.896484, 'auroc': 0.9989076}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     2    0    0     3     1     0    0      9
1     0  1276    0     7    0    0     0    47     1    0      1
2     4     1  193     2   40    4     0    18     9   39      2
3     1     0    0  8314    0    2     0    69    48    0      0
4     9     0    6     0  324    0     0     4    26    5    165
5     0     0    0    40    0  461     0     0     5   14      1
6    11     0    1     0    0    0  1881     1     3    1     10
7     1     5    0   138    1    0     2  7100    13    0      5
8     1     1    0    93    1    0     0    83  3092    0     24
9     2     0   11    11    0   95     0     7     8  357      2
10   29     0    1     8    5    1     8     9    25    0  12708
---- Validation: 
scalar performance:
{'acc': 0.9687575, 'precision': 0.93048465, 'recall': 0.8785977, 'specificity': 0.9965087, 'f1': 0.8993566, 'auroc': 0.99884963}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     3    0    0     1     2     1    0      9
1     0  1291    0     7    0    0     0    33     1    0      0
2     4     0  207     3   32    1     0    15     7   39      4
3     0     0    0  8340    0    4     0    67    29    0      0
4     8     0    6     1  324    1     1     3    36    3    156
5     1     0    0    43    0  452     1     0     4   19      1
6     9     0    0     2    0    1  1884     0     4    1      7
7     0     4    0   134    1    0     2  7101    17    0      6
8     2     0    1    99    2    0     0    91  3084    0     17
9     2     0   10    14    2   96     0     7    10  352      0
10   28     0    0     8    5    0     6     9    24    1  12715
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6988736, 'precision': 0.6409924, 'recall': 0.5989012, 'specificity': 0.9699351, 'f1': 0.58007085, 'auroc': 0.8798439}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1110     1    0    8   0    3    11    20     2   11     4
1      2  1180    0   29   1    0     1   249     3    1    33
2     16     1  188   29  77   18     4    72   254   65   291
3      0     0    0    0   0    0     0     0     0    0     0
4      2     0    3    0  29    0     1     2    24    0  1572
5      6     0    1  115   0  345     1     0     6  111     7
6      0     0    0    6   0    0  2824     3    66    0   168
7      0     0    0   88   0    0     1  1069     0    1     5
8      0     0    1  151   0    0     7    11  1196    3     1
9     21     4   96  186   2  150     7   147    91  404    29
10     0     0    0    0   0    0     1     0     1    0  1644
better model found
persisted
after epoch: 5,now: 2024-07-28 10:32:12.654719,epoch time: 0:41:15.247135,used: 3:30:40.110831,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97586685, 'precision': 0.93694454, 'recall': 0.9271295, 'specificity': 0.9973695, 'f1': 0.93099046, 'auroc': 0.9993545}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    0    0     5     1     0    1     10
1     0  1299    0     4    0    1     0    27     1    0      0
2     0     0  259     0   12    0     0     1     2   35      3
3     3     1    2  8284    0    6     3    83    51    5      1
4     5     0   15     0  421    1     0     2    12    1     82
5     0     0    1     8    0  441     0     0     5   65      1
6     5     0    0     0    0    0  1885     0     1    2     13
7     8     6    2   106    0    0     1  7113    20    2      7
8     0     0    4    53    8    2     1    46  3161    3     16
9     1     0   20     2    0   23     0     0     3  444      0
10   17     1    3     7   16    1     8    10    27    0  12703
---- Validation: 
scalar performance:
{'acc': 0.9762204, 'precision': 0.9383282, 'recall': 0.9277004, 'specificity': 0.99740624, 'f1': 0.93176556, 'auroc': 0.9994052}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    0    0     2     0     0    1      8
1     0  1301    0     4    0    0     0    24     3    0      0
2     0     0  254     0   19    0     2     2     0   33      2
3     2     1    3  8274    0    4     3    95    52    5      1
4     6     1   18     0  415    2     1     1     6    3     86
5     1     0    1    19    0  438     0     0     4   57      1
6     8     0    0     0    2    0  1887     0     0    2      9
7     8    12    0   104    2    0     2  7104    24    2      7
8     0     0    3    49    4    0     0    41  3177    6     16
9     4     0   17     1    1   14     1     0     1  454      0
10   12     0    3     7   19    0     5     5    25    0  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75337577, 'precision': 0.6956465, 'recall': 0.6466233, 'specificity': 0.9752599, 'f1': 0.6443092, 'auroc': 0.88644016}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1123     0    0   4    1    1    12     7     8   10     4
1      7  1208    4  24    0    0     1   208     8   18    21
2     10     0  386  12  149   11     8    17   189   82   151
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    9   0  276    0     1     0    23    0  1323
5      9     0   13  75    0  273     2     0     5  214     1
6      1     1    2   7    2    0  2910     3    61    0    80
7      4     0    4  55    0    0     5  1085     4    3     4
8      0     0    8  86    1    0    17     5  1241   11     1
9     17     2  211  66    2   72     2    27    83  637    18
10     0     0    0   0   16    0     0     0     1    0  1629
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-28 11:13:21.111797,epoch time: 0:41:08.457078,used: 4:11:48.567909,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97570634, 'precision': 0.94496244, 'recall': 0.92102134, 'specificity': 0.997324, 'f1': 0.9296355, 'auroc': 0.99950826}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     1    1     2    1    0     9     6     0    0     41
1     0  1310    0     2    0    0     0    14     4    0      2
2     1     0  295     0    1    0     1     0     2   11      1
3     0     1    0  8211    0    3     0   110   113    1      0
4     1     0   42     0  376    1     0     2    19    2     96
5     1     0    1    19    0  469     0     0     3   27      1
6     1     0    1     2    0    0  1893     0     0    0     11
7     0     6    4    61    1    0     1  7123    62    0      4
8     0     0    1    28    0    0     0    23  3216    2     23
9     1     0   37     3    1   46     1     0     4  400      0
10    0     0    3     6   11    0     1     4    16    0  12753
---- Validation: 
scalar performance:
{'acc': 0.97707635, 'precision': 0.9476418, 'recall': 0.92455566, 'specificity': 0.99746853, 'f1': 0.9333326, 'auroc': 0.99950707}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     2    1    0     4     4     1    1     30
1     0  1309    0     0    0    0     0    21     1    0      1
2     0     0  286     0    3    0     0     0     4   16      3
3     0     1    1  8237    1    3     0    96   100    0      1
4     2     0   41     1  380    0     1     2    16    0     96
5     0     0    0    21    0  471     1     0     4   23      1
6     1     0    1     0    0    0  1892     1     2    0     11
7     0     8    1    59    1    0     1  7126    63    0      6
8     0     0    2    20    1    0     0    25  3223    1     24
9     0     0   35     4    1   37     1     0     4  409      2
10    2     0    5     7    7    1     1     3    13    1  12756
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70580006, 'precision': 0.6846106, 'recall': 0.6105857, 'specificity': 0.9704212, 'f1': 0.58769536, 'auroc': 0.8852378}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   885     3    1   17   0    7    79    87    32   30    29
1     0  1192    2   20   0    0     1   234    16    4    30
2     1     0  383    9  15   26    23    24   320   45   169
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0   20    0  71    0     2     0    28    0  1512
5     3     0    4  144   0  378     3     1    16   41     2
6     0     0    6    1   0    0  2789     5    80    0   186
7     0     0    0   14   0    0     1  1140     5    0     4
8     0     0    1   44   0    0     9     7  1304    3     2
9     4     1  156   96   0  232     7    65   257  304    15
10    0     0    0    0   3    0     0     0     1    0  1642
better model found
persisted
after epoch: 7,now: 2024-07-28 11:55:43.885135,epoch time: 0:42:22.773338,used: 4:54:11.341247,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9796126, 'precision': 0.9579944, 'recall': 0.93263406, 'specificity': 0.9976872, 'f1': 0.9435892, 'auroc': 0.9995879}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    2     3    4    0     4     6     0    3     35
1     0  1317    0     7    0    0     0     8     0    0      0
2     0     0  283     1    3    0     0     1     2   22      0
3     0     2    0  8407    0    3     0    20     5    0      0
4     1     0   19     0  416    0     0     0    10    2     91
5     0     0    1    11    0  447     0     0     4   56      1
6     2     0    0     4    1    0  1893     2     0    0      6
7     0     6    1   180    1    0     1  7052    17    1      4
8     0     4    0    91    1    0     1    19  3167    3     10
9     0     0   16     2    1   14     0     0     0  460      0
10    2     0    1     7    8    0     2     3    24    0  12746
---- Validation: 
scalar performance:
{'acc': 0.9784138, 'precision': 0.95767146, 'recall': 0.9324305, 'specificity': 0.9975559, 'f1': 0.94301546, 'auroc': 0.9995407}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     6    5    0     4     2     0    3     25
1     0  1316    0     3    0    0     0    12     0    0      1
2     0     0  284     1    4    0     1     1     0   19      2
3     0     3    0  8396    0    5     0    24    10    2      0
4     1     0   16     0  408    0     0     1    15    3     95
5     0     0    0    10    0  438     0     0     1   71      1
6     4     0    0     2    1    0  1887     2     0    0     12
7     0     7    1   190    1    0     1  7039    22    1      3
8     0     0    1    99    3    0     0    25  3157    1     10
9     0     0   12     1    0   11     0     2     0  467      0
10    1     0    2     6    5    0     2     4    27    1  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7111173, 'precision': 0.653054, 'recall': 0.5977992, 'specificity': 0.9710405, 'f1': 0.59035677, 'auroc': 0.8745628}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   862     5    0   27    4    6    55    89    10   86    26
1     0  1271    1   27    2    0     2   158     6    4    28
2     3     0  215   27  193    9    11    32   294   87   144
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    9    0  132    0     2     1    38    0  1451
5     1     0    2   95    1  251     0     1     7  232     2
6     2     0    1    5    1    0  2909     2    42    0   105
7     0     0    0   56    0    0     3  1097     4    2     2
8     0     1    0  105    1    0    13    10  1235    5     0
9     2     1   93  149   13  101     6    77   118  553    24
10    0     0    0    0    6    0     0     0     1    0  1639
better model found
persisted
after epoch: 8,now: 2024-07-28 12:44:14.991034,epoch time: 0:48:31.105899,used: 5:42:42.447146,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9846158, 'precision': 0.9615306, 'recall': 0.9637548, 'specificity': 0.9983615, 'f1': 0.96243024, 'auroc': 0.9997734}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    0     2     0     0    0      6
1     0  1322    0     4    0    0     0     6     0    0      0
2     0     0  278     0   13    0     0     0     1   18      2
3     1     1    0  8329    0    8     0    32    65    0      0
4     5     0    3     0  502    0     0     2     4    1     22
5     0     0    0     6    0  485     0     0     2   28      0
6     1     2    0     2    2    0  1888     0     3    0     10
7     1    10    0   105    1    0     1  7100    44    0      2
8     0     0    1    16    2    1     1    11  3254    0      9
9     0     0   11     1    1   15     0     1     0  463      1
10    2     1    1     8   52    1     1     7    14    0  12706
---- Validation: 
scalar performance:
{'acc': 0.98381704, 'precision': 0.9575323, 'recall': 0.95837885, 'specificity': 0.9982894, 'f1': 0.95773757, 'auroc': 0.99974144}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     3    0    1     2     1     0    1      6
1     0  1324    0     2    0    0     0     4     2    0      0
2     0     1  271     0   13    1     0     1     1   23      1
3     0     2    0  8323    0    6     0    40    68    1      0
4     6     0    4     0  493    0     0     2     4    3     27
5     0     0    0     4    1  489     0     0     4   23      0
6     0     1    1     3    1    0  1887     2     4    2      7
7     0    15    0    92    2    0     1  7107    47    0      1
8     0     0    1    14    8    1     0    10  3248    1     13
9     0     0   12     1    1   21     1     0     2  455      0
10    3     2    0     7   46    1     4     3    15    1  12714
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74574965, 'precision': 0.6850072, 'recall': 0.64689267, 'specificity': 0.9744966, 'f1': 0.6378083, 'auroc': 0.8867946}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1022     2    0  14    1    8    39    25     6   45     8
1      1  1348    0  19    2    0     0   114     6    0     9
2      2     3  251  10  204   23    15    22   297   91    97
3      0     0    0   0    0    0     0     0     0    0     0
4      0     1    3   0  430    0     1     1    30    0  1167
5      2     0    2  73    0  405     1     0    13   95     1
6      2     1    3   8    2    0  2766     3   102    0   180
7      0     0    0  56    0    0     0  1100     3    2     3
8      0     1    3  64    0    1     7     5  1284    4     1
9      4    11  127  90    5  202    10    61   186  430    11
10     0     0    0   0   22    0     0     0     1    0  1623
better model found
persisted
after epoch: 9,now: 2024-07-28 13:36:46.474644,epoch time: 0:52:31.483610,used: 6:35:13.930756,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9829837, 'precision': 0.9527502, 'recall': 0.94234633, 'specificity': 0.99819076, 'f1': 0.9457073, 'auroc': 0.9997727}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    3    0     3     0     0    1      1
1     0  1303    0     5    0    0     0    20     4    0      0
2     0     0  247     0    0    0     1     0     2   61      1
3     4     0    0  8285    0    8     5    60    72    3      0
4     2     0   36     0  427    0     0     0    14    9     51
5     0     0    0     5    0  472     0     0     1   42      0
6     1     0    0     0    0    0  1897     0     1    2      7
7     1     2    1    57    0    0     2  7157    36    1      6
8     0     0    1    14    0    0     6    18  3245    1     11
9     0     0    2     0    0    9     0     1     1  478      1
10    6     0    1     6    8    2     1     0    15    0  12755
---- Validation: 
scalar performance:
{'acc': 0.98389727, 'precision': 0.95519114, 'recall': 0.9426124, 'specificity': 0.9982767, 'f1': 0.9468955, 'auroc': 0.99975467}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    1    0     0     0     0    0      4
1     0  1307    0     3    0    0     0    19     2    0      1
2     0     0  250     0    1    0     0     2     0   58      1
3     0     0    0  8310    0    6     2    50    69    3      0
4     4     0   33     1  426    0     1     1    17    7     49
5     0     0    0    12    0  462     0     0     0   47      0
6     0     0    1     1    0    0  1891     0     0    2     13
7     1     2    2    53    1    0     2  7175    25    0      4
8     0     0    0    11    0    0     5    17  3249    2     12
9     0     0    2     1    0    9     0     0     1  480      0
10    8     0    2     5    5    1     3     3    12    2  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72049254, 'precision': 0.68926144, 'recall': 0.61002326, 'specificity': 0.9717551, 'f1': 0.59728575, 'auroc': 0.8810805}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   944     0    0   18   0    7   101    19    23   55     3
1     2  1232    1   28   1    1     2   172    17   13    30
2     5     0  249    9  24   18    53    18   328  133   178
3     0     0    0    0   0    0     0     0     0    0     0
4     1     0   14    0  93    0     1     0    35    0  1489
5     3     0    2   59   0  306     4     0    20  196     2
6     1     0    0    2   0    0  2981     3    32    0    48
7     1     0    1  132   0    0     8  1007     9    2     4
8     0     0    1   32   0    1    27     2  1303    3     1
9     5     3   78   64   0  116    40    35   235  544    17
10    0     0    0    0   3    0     1     0     2    1  1639
better model found
persisted
after epoch: 10,now: 2024-07-28 14:31:08.516624,epoch time: 0:54:22.041980,used: 7:29:35.972736,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:29:35.972736 at 2024-07-28 14:31:08.516624
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72049254, 'precision': 0.68926144, 'recall': 0.61002326, 'specificity': 0.9717551, 'f1': 0.59728575, 'auroc': 0.8810805}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   944     0    0   18   0    7   101    19    23   55     3
1     2  1232    1   28   1    1     2   172    17   13    30
2     5     0  249    9  24   18    53    18   328  133   178
3     0     0    0    0   0    0     0     0     0    0     0
4     1     0   14    0  93    0     1     0    35    0  1489
5     3     0    2   59   0  306     4     0    20  196     2
6     1     0    0    2   0    0  2981     3    32    0    48
7     1     0    1  132   0    0     8  1007     9    2     4
8     0     0    1   32   0    1    27     2  1303    3     1
9     5     3   78   64   0  116    40    35   235  544    17
10    0     0    0    0   3    0     1     0     2    1  1639
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75337577, 'precision': 0.6956465, 'recall': 0.6466233, 'specificity': 0.9752599, 'f1': 0.6443092, 'auroc': 0.88644016}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1123     0    0   4    1    1    12     7     8   10     4
1      7  1208    4  24    0    0     1   208     8   18    21
2     10     0  386  12  149   11     8    17   189   82   151
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    9   0  276    0     1     0    23    0  1323
5      9     0   13  75    0  273     2     0     5  214     1
6      1     1    2   7    2    0  2910     3    61    0    80
7      4     0    4  55    0    0     5  1085     4    3     4
8      0     0    8  86    1    0    17     5  1241   11     1
9     17     2  211  66    2   72     2    27    83  637    18
10     0     0    0   0   16    0     0     0     1    0  1629
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_07_01_32_seed_0_23104523_instance_wise_predictions.txt
accuracy from prediction file 0.7204925488001119
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/14.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB | 414148 GiB | 414146 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411242 GiB | 411241 GiB |
|       from small pool |      7 MiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB | 414148 GiB | 414146 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411242 GiB | 411241 GiB |
|       from small pool |      7 MiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB | 412582 GiB | 412581 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 409680 GiB | 409679 GiB |
|       from small pool |      6 MiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  16520 MiB |      0 B   |
|       from large pool |  16492 MiB |  16492 MiB |  16492 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 235584 KiB | 630848 KiB |  63120 GiB |  63120 GiB |
|       from large pool | 216320 KiB | 628608 KiB |  60199 GiB |  60199 GiB |
|       from small pool |  19264 KiB |  23302 KiB |   2920 GiB |   2920 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   30048 K  |   30045 K  |
|       from large pool |     247    |     595    |   13398 K  |   13397 K  |
|       from small pool |    2399    |    3599    |   16650 K  |   16647 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   30048 K  |   30045 K  |
|       from large pool |     247    |     595    |   13398 K  |   13397 K  |
|       from small pool |    2399    |    3599    |   16650 K  |   16647 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     467    |       0    |
|       from large pool |     453    |     453    |     453    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     119    |     566    |   16680 K  |   16679 K  |
|       from large pool |      95    |     303    |    8723 K  |    8723 K  |
|       from small pool |      24    |     457    |    7956 K  |    7956 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414148 GiB | 414148 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414148 GiB | 414148 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412582 GiB | 412582 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409680 GiB | 409680 GiB |
|       from small pool |      0 KiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630848 KiB |  63121 GiB |  63121 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60201 GiB |  60201 GiB |
|       from small pool |      0 KiB |  25532 KiB |   2920 GiB |   2920 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3599    |   16650 K  |   16650 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3599    |   16650 K  |   16650 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     566    |   16680 K  |   16680 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |     457    |    7956 K  |    7956 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414148 GiB | 414148 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414148 GiB | 414148 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411242 GiB | 411242 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412582 GiB | 412582 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409680 GiB | 409680 GiB |
|       from small pool |      0 KiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630848 KiB |  63121 GiB |  63121 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60201 GiB |  60201 GiB |
|       from small pool |      0 KiB |  25532 KiB |   2920 GiB |   2920 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3599    |   16650 K  |   16650 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30048 K  |   30048 K  |
|       from large pool |       2    |     595    |   13398 K  |   13398 K  |
|       from small pool |       0    |    3599    |   16650 K  |   16650 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     566    |   16680 K  |   16680 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |     457    |    7956 K  |    7956 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523

 Experiment start at: 2024-07-28 14:56:57.154645
before training, model accuracy: 0.09417197853326797
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9260488, 'precision': 0.84728324, 'recall': 0.7463141, 'specificity': 0.99196166, 'f1': 0.7762833, 'auroc': 0.994906}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   175     0    0     4    2    0   193     9     9   10     81
1     0  1244    0    17    0    0     5    56     2    0      8
2     0     1  127     2   66    2     6    26    19   59      3
3     1     0    0  7627    1    8    24   559   217    1      1
4     0     1    8     1  265    4    14     7    51   10    178
5     0     0    0    66    0  387     5     0    13   49      1
6     3     0    0     0    1    1  1873     4     8    0     18
7     0     9    0    96    1    0    15  7038    84    0     19
8     0     1    1    86    4    1    28    98  3025    1     51
9     1     1   34    12    7  132    16    11    19  253      7
10    1     1    2     6   22    1    78    27    55    1  12598
---- Validation: 
scalar performance:
{'acc': 0.9254514, 'precision': 0.84944797, 'recall': 0.7471901, 'specificity': 0.9918866, 'f1': 0.7763145, 'auroc': 0.9947815}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   156     0    1     6    0    0   206     9     7    8     90
1     0  1247    0    14    0    0     4    58     4    0      5
2     1     2  134     0   61    3    10    17    15   60      9
3     0     0    0  7631    0    9    28   549   221    0      2
4     0     1    8     2  253    1    14    11    56   11    182
5     1     0    2    61    0  382     7     0    16   51      1
6     1     0    0     0    0    0  1880     4     5    1     17
7     0    15    0   103    2    0    18  7035    76    1     15
8     0     1    2    86    4    1    22   112  3006    1     61
9     2     1   36     8    3  114    17     8    16  283      5
10    0     0    1     5   28    2    83    21    64    1  12591
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6388442, 'precision': 0.5982218, 'recall': 0.50616485, 'specificity': 0.9621306, 'f1': 0.4774416, 'auroc': 0.8735916}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   285     0   0   42    0    0   794    33     2    4    10
1     0  1355   0   28    0    0    14    54     3    0    45
2     0    18   7   17  121    8   257    49   374   32   132
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  107    0    52     2    20    0  1452
5     2     0   0  171    1  235   116     1    21   44     1
6     0     1   0    1    0    0  3047     3     7    0     8
7     0     1   0   25    0    0    13  1120     1    0     4
8     0     1   0  100    1    0    73    14  1179    0     2
9     2    45  23  148   22   81   284    98   259  160    15
10    0     0   0    0    3    0     6     1     0    0  1636
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 15:49:47.950112,epoch time: 0:52:50.795467,used: 0:52:50.795467,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94806826, 'precision': 0.8819066, 'recall': 0.8491623, 'specificity': 0.99426806, 'f1': 0.8627813, 'auroc': 0.9968801}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    0     4    1    0     5     6     6    3     47
1     0  1246    0     6    0    0     0    67     8    1      4
2     2     0  220     0   32    2     1     4     7   37      7
3     2     0    1  7828    0   24     2   441   139    2      0
4     2     0   31     0  297    2     0     3    16    8    180
5     0     0    1    13    0  410     0     0     8   88      1
6    18     0    0     3    1    0  1850     5     7    2     21
7     1     8    6    89    1    0     1  7065    72    3     16
8     1     0    8    68   10    3     2   108  3060    0     36
9     4     0   52     1    3   56     1     6     9  355      6
10   11     0    3     8   18    1    10    14    32    2  12693
---- Validation: 
scalar performance:
{'acc': 0.9502207, 'precision': 0.8874121, 'recall': 0.853014, 'specificity': 0.9944963, 'f1': 0.86748654, 'auroc': 0.99688447}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     1    1    0     6     4     5    2     43
1     0  1255    0     8    0    0     2    57     7    0      3
2     4     0  221     2   27    4     2     5     7   33      7
3     1     1    0  7876    0   21     0   390   149    2      0
4     3     0   25     0  302    2     2     2    17    7    179
5     2     0    1    18    0  404     0     0    10   85      1
6    22     0    0     1    1    3  1839     6     8    2     26
7     0    10    2    88    1    1     2  7083    64    1     13
8     1     0    7    76    6    2     0    99  3060    2     43
9     5     0   52     3    1   53     0     3    10  361      5
10    8     0    2     7   23    1     5    13    33    2  12702
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7202127, 'precision': 0.62692595, 'recall': 0.6112514, 'specificity': 0.97170407, 'f1': 0.59218466, 'auroc': 0.8793659}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1087     0    0  16    0    0    23    15    13    3    13
1      1  1324    1  21    0    1     8    77    10    6    50
2     15     1  117   4  230   10    11    14   225   65   323
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    0   0  101    0     1     0    10    0  1520
5     25     0    0  51    2  324     6     0    15  162     7
6      0     0    1   1    1    0  2908     2    24    0   130
7      1     2    2  39    0    1     6  1100     8    0     5
8      0     0    1  46    6    7    20     5  1273    3     9
9     55    14  240  30   12  105    13    21   180  416    51
10     0     0    0   0    1    0     0     0     1    0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 16:40:32.556597,epoch time: 0:50:44.606485,used: 1:43:35.401952,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95786065, 'precision': 0.88978106, 'recall': 0.8639078, 'specificity': 0.99536103, 'f1': 0.87469065, 'auroc': 0.997887}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     1    0     3    2    0     6     2     1    3     55
1     0  1300    0    11    0    0     0    17     2    0      2
2     0     1  221     1   47    0     0     1     4   34      3
3     2     4    2  8237    1    1     0   114    73    2      0
4     3     0   17     1  361    0     0     2    11    3    141
5     1     0    3    47    1  363     0     0     3  102      1
6     5     1    4     0    3    0  1864     0     7    2     21
7     3    58   12   159    5    0     3  6884   103    3     32
8     1     1    6   121   10    2     4    29  3070    7     45
9     0     0   66     5    3   33     0     0     1  383      2
10    5     0    3     6   35    0     5     3    28    2  12708
---- Validation: 
scalar performance:
{'acc': 0.95904773, 'precision': 0.89161503, 'recall': 0.8677465, 'specificity': 0.9955084, 'f1': 0.8769283, 'auroc': 0.9977705}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    0     3    3    0     4     1     1    7     46
1     0  1296    0    13    0    0     0    17     4    0      2
2     0     0  235     0   46    0     1     0     2   26      2
3     0     3    0  8239    1    3     1   117    74    2      0
4     3     0   14     1  361    0     1     1    13    5    140
5     0     0    1    42    2  355     0     0     4  116      1
6     6     1    2     4    4    0  1856     4     4    2     25
7     2    41   19   145    2    0     2  6920   110    1     23
8     2     1    8   109   10    1     5    36  3081    1     42
9     0     0   77     5    5   22     0     1     2  381      0
10    6     1    3     5   39    0     2     4    22    2  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.699993, 'precision': 0.64430296, 'recall': 0.57133204, 'specificity': 0.97000915, 'f1': 0.57364947, 'auroc': 0.8734169}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   980     1    4   49    2    0    37     3     5   29    60
1     1  1400    1   30    0    0     2    20     2    3    40
2     0    10  157   23  311    0    10     9   192   42   261
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    1    0  149    0     1     0     9    0  1472
5     4     0    5  213    3  140     2     0     2  219     4
6     0     2    1    1    1    0  2966     1     4    0    91
7     3    11   14   78    1    0     5  1035    10    0     7
8     0     1    4  166    3    0    25     0  1160    3     8
9     4    30  362  179   26   31     8     8    87  374    28
10    0     0    0    0    2    0     0     0     0    0  1644
better model found
persisted
after epoch: 3,now: 2024-07-28 17:23:34.384575,epoch time: 0:43:01.827978,used: 2:26:37.229930,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.958369, 'precision': 0.90602934, 'recall': 0.8904635, 'specificity': 0.9953992, 'f1': 0.89750105, 'auroc': 0.9985482}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     4    1    0     1     8     1    4     18
1     0  1243    0     8    0    0     0    79     1    0      1
2     1     0  242     0   21    1     0    10     1   36      0
3     0     1    0  8122    0   18     0   284    12    1      0
4     3     1   27     1  400    2     0     3     9    3     89
5     0     0    0    16    0  451     0     0     3   50      1
6    11     0    2     2    2    0  1868     7     2    2     12
7     1     3    0    70    1    0     1  7173     7    1      4
8     1     0    3   254   14   13     1   148  2826    4     32
9     1     0   37     4    0   64     0     3     0  383      1
10   12     0    2     6   57    1     8    21    18    3  12666
---- Validation: 
scalar performance:
{'acc': 0.9575498, 'precision': 0.9025448, 'recall': 0.8857092, 'specificity': 0.9953078, 'f1': 0.8933845, 'auroc': 0.9984155}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     1    0     5    0    0     1     7     0    2     12
1     0  1252    0     6    0    0     0    72     1    0      1
2     1     0  230     0   31    1     0     7     2   40      0
3     0     0    0  8122    0   15     0   280    22    1      0
4     5     0   23     0  386    2     0     5    13    5    100
5     0     0    1    15    0  441     0     0     2   61      1
6     8     0    1     1    3    0  1867     7     3    3     15
7     0     2    1    66    1    0     1  7182     8    0      4
8     1     0    4   255   15   11     1   162  2803    6     38
9     1     0   39     4    0   56     0     3     0  390      0
10   14     1    4     6   56    0     1    24    19    1  12670
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69516546, 'precision': 0.6575898, 'recall': 0.59001696, 'specificity': 0.9696701, 'f1': 0.5895137, 'auroc': 0.88094705}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   969     0    0   53    1    1    14    81    14   20    17
1     0  1105    0   30    1    0     0   307     3    0    53
2     2     1  131   32  278    9     2    80   230   60   190
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    3    0  343    0     2     2    10    1  1271
5     3     0    1  158    2  316     0     0     1  108     3
6     0     0    0    6    2    0  2777    13    18    0   251
7     0     0    0   23    0    0     0  1139     0    0     2
8     0     0    0  232    0    0     1    25  1103    2     7
9     7     3  141  194   22  122     1   132    74  425    16
10    0     0    0    0   17    0     0     1     0    0  1628
early stop counter: 1
val acc:0.9575498104095459, best validation acc: 0.9590477347373962, corresponding to test acc:                         0.6999930143356323 / 0.7202126979827881
after epoch: 4,now: 2024-07-28 18:05:13.989620,epoch time: 0:41:39.605045,used: 3:08:16.834975,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9666898, 'precision': 0.91983557, 'recall': 0.8914776, 'specificity': 0.99635386, 'f1': 0.9024083, 'auroc': 0.9987733}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     3    1    0     0     3     0    2     13
1     0  1271    0    11    0    0     0    47     2    0      0
2     3     0  193     2   16    0     1     8     3   85      1
3     2     0    0  8176    0   11     0   185    61    1      0
4     5     0   17     3  380    1     0    10    22    5     94
5     0     0    0    11    0  473     0     0     5   31      1
6    14     0    0     2    1    0  1853     9     8    2     19
7     0     3    0    73    1    0     1  7171    10    1      4
8     4     0    1    73    2    3     0   125  3058    3     27
9     0     0    9     4    0   70     0     6     2  402      0
10   25     0    1     7   30    1     2    14    22    0  12693
---- Validation: 
scalar performance:
{'acc': 0.9677411, 'precision': 0.9213177, 'recall': 0.90057385, 'specificity': 0.9964882, 'f1': 0.9089194, 'auroc': 0.9989109}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    2    0     1     3     1    2     11
1     0  1268    0    10    0    0     0    51     1    0      2
2     1     0  203     0   18    3     0    11     4   71      1
3     1     0    0  8185    0   10     0   176    67    1      0
4     5     0   17     0  408    1     1     8    19    5     75
5     0     0    0    11    0  474     0     0     4   31      1
6    16     0    0     1    3    2  1849     7     9    2     19
7     0     4    0    64    1    0     1  7174    14    2      5
8     2     0    4    65    1    3     0   130  3063    1     27
9     1     0   11     2    0   64     0     3     2  410      0
10   20     0    1     7   36    0     2    22    25    1  12682
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7099979, 'precision': 0.66012645, 'recall': 0.61691535, 'specificity': 0.97090214, 'f1': 0.5970751, 'auroc': 0.88370913}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1021     0   0  35    1    7    12    37    18   28    11
1      1  1237   0  30    0    1     0   166     5    1    58
2      4     2  60   8  214   21     1    34   367   75   229
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0  328    0     1     1    20    1  1281
5      3     0   0  72    2  399     0     1    11   95     9
6      0     0   0   2    2    0  2595     8   190    0   270
7      1     0   0  59    0    1     1  1098     0    0     4
8      0     0   0  75    1    2     2    11  1273    2     4
9     10     5  55  80   13  201     1    56   172  505    39
10     0     0   0   0   13    0     0     0     1    0  1632
better model found
persisted
after epoch: 5,now: 2024-07-28 18:46:39.424060,epoch time: 0:41:25.434440,used: 3:49:42.269415,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96888375, 'precision': 0.9272468, 'recall': 0.89952976, 'specificity': 0.9965549, 'f1': 0.91047376, 'auroc': 0.9991495}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     5    1    0    10     0     1    4     16
1     0  1269    0     5    0    0     0    57     1    0      0
2     0     0  260     1    4    5     0     4     3   35      0
3     0     0    0  8367    0    7     0    39    23    0      0
4     6     0   38     1  371    1     0     4    14    3    101
5     0     0    0    22    0  480     0     0     6   12      1
6     4     0    1     2    0    0  1891     1     0    0      9
7     0     0    0   242    1    0     1  6979    34    0      7
8     0     1    3   111    8    2     0    75  3085    1     10
9     1     0   28     5    1  104     0     4     4  346      0
10    4     0    4     7   17    2     6     7    26    0  12719
---- Validation: 
scalar performance:
{'acc': 0.9690785, 'precision': 0.9288428, 'recall': 0.898666, 'specificity': 0.9965651, 'f1': 0.9101256, 'auroc': 0.9991169}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    1     7    1    1     7     1     3    1     21
1     0  1277    0     7    0    0     0    46     1    0      1
2     1     0  267     0    4    4     0     7     3   26      0
3     0     1    0  8368    0    3     0    39    29    0      0
4     2     1   43     0  358    3     0     2    17    2    111
5     0     0    0    23    1  478     1     0     5   12      1
6     2     0    0     4    1    0  1884     1     2    1     13
7     0     4    1   218    0    0     2  7004    32    0      4
8     0     1    4   107    7    3     0    77  3082    1     14
9     0     0   28     5    2  105     0     4     1  348      0
10    4     0    5     7   16    3     6     7    25    0  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6774645, 'precision': 0.65885603, 'recall': 0.5627897, 'specificity': 0.9681372, 'f1': 0.57156265, 'auroc': 0.88014257}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   837     0    0  102    3   44   103   12     6   46    17
1     1  1200    0   39    0    0     2  216     3    0    38
2     0     3  152   50  231   33    28   28   288   58   144
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    0  242    0     4    0    16    1  1367
5     0     0    0  177    1  365     4    0     1   39     5
6     0     0    0    4    1    0  3016    3     7    0    36
7     0     0    0  392    0    0     2  765     2    0     3
8     0     0    0  228    1    1    24    1  1110    0     5
9     1     8   93  282    8  211    10   39   108  356    21
10    0     0    0    0    5    0     0    0     1    0  1640
better model found
persisted
after epoch: 6,now: 2024-07-28 19:27:59.667149,epoch time: 0:41:20.243089,used: 4:31:02.512504,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97551906, 'precision': 0.92973334, 'recall': 0.92852044, 'specificity': 0.9974183, 'f1': 0.9260417, 'auroc': 0.9994455}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     1    2    0     0     1     1    3     15
1     0  1310    0     7    0    0     0    14     1    0      0
2     1     0  204     0   28    0     3     3     1   70      1
3     1     0    0  8332    0   12     0    35    57    0      0
4     2     1   11     0  484    1     0     2    10    1     26
5     1     0    0     7    0  473     1     0     3   35      1
6     9     0    0     2    1    0  1879     1     0    0     15
7     0    19    0   131    1    0     1  7085    21    2      4
8     0     0    1    43   10    1     1    39  3178    2     21
9     0     0    5     1    0   33     1     0     1  452      0
10    3     2    1     6  129    0     4    18    27    0  12604
---- Validation: 
scalar performance:
{'acc': 0.9752307, 'precision': 0.9296919, 'recall': 0.9283547, 'specificity': 0.9973887, 'f1': 0.92623085, 'auroc': 0.9993986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     2    2    1     2     0     3    2     14
1     0  1314    0     7    0    0     0    11     0    0      0
2     1     0  211     0   23    1     1     3     4   68      0
3     0     1    0  8335    0   10     0    36    57    1      0
4     3     0    9     0  481    1     1     3     7    3     31
5     1     0    0     5    0  473     0     0     5   36      1
6     8     0    0     0    0    0  1878     1     2    1     18
7     0    13    1   132    1    0     1  7081    31    1      4
8     1     0    0    45    5    1     0    44  3188    0     12
9     1     0    6     2    1   30     2     1     3  446      1
10    5     2    1     8  144    0     2    17    22    0  12595
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7547051, 'precision': 0.6766922, 'recall': 0.6424689, 'specificity': 0.9754156, 'f1': 0.6260128, 'auroc': 0.88613605}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1056     0   0   13    2    9    30    18    11   15    16
1      1  1355   0   16    0    4     0   103     4    3    13
2      5     5  48   14  349   34    20    35   320   57   128
3      0     0   0    0    0    0     0     0     0    0     0
4      0     1   0    0  638    0     3     1    17    1   972
5      8     0   0   77    6  429    11     0    12   43     6
6      0     0   0    1    1    1  2976     3    19    0    66
7      2     0   0  122    0    1     1  1033     3    0     2
8      0     0   0   70    1    4    11    14  1268    0     2
9     15    14  47   84   24  243    22    57   206  402    23
10     0     1   0    0   62    0     0     0     1    0  1582
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-28 20:08:36.725714,epoch time: 0:40:37.058565,used: 5:11:39.571069,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.967332, 'precision': 0.9111424, 'recall': 0.9221171, 'specificity': 0.9966633, 'f1': 0.91168034, 'auroc': 0.99925876}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    1     1    6    0     7     3     2    1     10
1     0  1313    0     2    0    0     0    11     3    0      2
2     1     0  268     0   31    1     0     2     4    5      0
3     1     3    0  8121    2    0    10   142   161    0      0
4     3     0    7     0  506    0     0     0    16    0      7
5     1     0    2    52    0  366     0     0    11   87      1
6     3     0    1     0    2    0  1888     0     6    1      6
7     1     9    2    68    2    0     7  7110    55    0      8
8     1     0    1    15    6    0     1    26  3239    0      7
9     0     0   56     6    4    4     0     4    10  409      0
10    8     0    2     7  227    0    20     5    40    1  12483
---- Validation: 
scalar performance:
{'acc': 0.9680353, 'precision': 0.91244495, 'recall': 0.924633, 'specificity': 0.9967637, 'f1': 0.9130782, 'auroc': 0.9993339}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     0    7    0     9     1     5    0      8
1     0  1317    0     0    0    0     0    11     4    0      0
2     0     0  273     0   28    0     0     1     3    6      1
3     1     1    0  8154    0    0    12   116   156    0      0
4     0     0    7     0  507    0     1     1    17    0      6
5     0     0    1    50    0  362     0     0    14   93      1
6     3     0    0     0    2    0  1891     1     5    0      6
7     1    10    1    61    7    0     4  7116    60    0      5
8     0     0    1    14    8    0     2    24  3242    1      4
9     0     0   51     5    1    6     0     5    11  414      0
10    8     0    1     5  251    0    21     6    43    0  12461
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7292381, 'precision': 0.6693974, 'recall': 0.59658897, 'specificity': 0.97296995, 'f1': 0.5914711, 'auroc': 0.8836761}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   981     1    1   34    6    1    54    33    34   19     6
1     1  1265    0   16    4    0     5   168    11    0    29
2     0     3  126   16  308    1     7    24   439   40    51
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  955    0     3     1    30    1   642
5    10     0   10  268    5  102     3     2    51  137     4
6     0     1    0    1    2    0  2753     5   284    0    21
7     0     0    0   29    0    0     4  1121     8    0     2
8     0     0    0   28    0    0     5    20  1314    0     3
9     8     9  165  158   27   24     8   104   322  301    11
10    0     0    0    0  138    0     1     0     2    0  1505
early stop counter: 1
val acc:0.9680352807044983, best validation acc: 0.9752306938171387, corresponding to test acc:                         0.7547050714492798 / 0.7547050714492798
after epoch: 8,now: 2024-07-28 20:50:01.379683,epoch time: 0:41:24.653969,used: 5:53:04.225038,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9807631, 'precision': 0.94995654, 'recall': 0.9440751, 'specificity': 0.9979536, 'f1': 0.9461907, 'auroc': 0.99969035}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     1    1    0     8     0     2    0     14
1     0  1310    0     5    0    0     0    14     2    0      1
2     1     0  279     0    4    1     1     0     1   25      0
3     0     0    0  8345    0    2     0    29    61    1      0
4     4     0   20     0  457    2     0     0    12    1     43
5     0     0    0     7    0  504     0     0     2    8      0
6     2     0    0     1    0    0  1899     0     3    0      3
7     0     1    1   121    2    0     2  7037    96    0      5
8     0     1    2    21    3    0     0     8  3253    0      7
9     0     0   14     3    0   75     0     1     0  400      0
10    3     0    5     7   29    0     9     2    19    0  12716
---- Validation: 
scalar performance:
{'acc': 0.98020595, 'precision': 0.9489563, 'recall': 0.9410627, 'specificity': 0.99789214, 'f1': 0.94392335, 'auroc': 0.9996413}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    1     3    0    0     8     0     4    2      6
1     0  1309    0     4    0    0     0    17     2    0      0
2     0     0  275     0    6    1     2     1     5   22      0
3     0     0    1  8342    0    2     0    22    73    0      0
4     6     0   15     0  463    0     0     0     9    1     45
5     0     0    1    10    0  502     0     0     2    5      1
6     1     0    0     3    0    0  1895     0     1    0      8
7     0     2    1   119    2    0     1  7037    89    0     14
8     0     0    1    23    5    3     0     3  3254    1      6
9     0     0   23     3    0   80     0     0     1  386      0
10    3     0    3     7   22    0     7     0    31    0  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70670956, 'precision': 0.6627377, 'recall': 0.5845475, 'specificity': 0.9704567, 'f1': 0.5831264, 'auroc': 0.87985665}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   790     1    0   76    2    4   215   36    19   20     7
1     0  1317    0   36    0    0     6  114     3    0    23
2     2    10  119   30  285   28    97   12   292   31   109
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    0  450    0    16    0    23    1  1140
5     1     0    1  191    2  335    22    0     8   29     3
6     0     0    0    2    1    0  3024    2    15    0    23
7     0     1    0  157    0    1     5  988     8    0     4
8     0     1    0   92    1    0    27   12  1234    1     2
9     3    26  104  224   19  227    80   44   161  227    22
10    0     0    0    0   24    0     4    0     1    0  1617
better model found
persisted
after epoch: 9,now: 2024-07-28 21:30:46.698407,epoch time: 0:40:45.318724,used: 6:33:49.543762,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9825556, 'precision': 0.9482634, 'recall': 0.9420316, 'specificity': 0.9981531, 'f1': 0.94147325, 'auroc': 0.99975085}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    1     2    2    1     8     0     0    1      3
1     0  1328    0     2    0    0     0     2     0    0      0
2     0     0  296     0    3    6     0     0     0    7      0
3     0     0    0  8394    0    3     0    26    13    0      0
4     6     0   17     0  448    2     4     0    16    2     44
5     0     0    0     3    0  515     0     0     0    3      0
6     2     0    1     0    0    0  1900     0     0    1      4
7     0    25    2    95    0    0     1  7121    16    0      3
8     2     2    1    71    0    3     3    14  3192    0      6
9     0     0   22     0    0  124     2     0     0  345      0
10   28     0    1     7    6    2     4     8    19    0  12720
---- Validation: 
scalar performance:
{'acc': 0.9818644, 'precision': 0.94834274, 'recall': 0.941736, 'specificity': 0.99806833, 'f1': 0.9420666, 'auroc': 0.99971515}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     3    1    0     8     0     0    2      2
1     0  1328    0     1    0    0     0     3     0    0      0
2     0     0  290     0    6    7     0     0     2    7      0
3     0     0    0  8399    0    3     0    23    14    1      0
4     6     0   10     0  457    3     3     1    12    1     46
5     0     0    0     5    0  511     0     0     1    3      1
6     3     0    1     1    0    1  1899     0     0    0      3
7     0    14    0   105    1    0     1  7124    17    0      3
8     4     2    2    73    0    2     5    22  3174    2     10
9     0     0   19     2    0  119     1     1     1  350      0
10   30     0    1     5   14    0    10     7    21    0  12708
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7158749, 'precision': 0.66723037, 'recall': 0.60308164, 'specificity': 0.97137654, 'f1': 0.60140836, 'auroc': 0.8824148}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   911     4    4   35    0    7   146   41     2   17     3
1     2  1359    1   24    0    0    11   69     2    5    26
2     5     2  234   19  241   38   106   17   192   24   137
3     0     0    0    0    0    0     0    0     0    0     0
4     1     0    6    0  348    0    23    1    14    0  1240
5    10     1   10  130    1  405    11    0     2   18     4
6     0     0    0    1    0    0  3057    1     1    0     7
7     1     1    2  154    0    1    11  988     3    0     3
8     0     1    2  178    1    6    89   10  1080    1     2
9     6     8  279  163   13  281    52   31    48  232    24
10    0     0    0    0   17    0     9    0     2    0  1618
better model found
persisted
after epoch: 10,now: 2024-07-28 22:22:55.220468,epoch time: 0:52:08.522061,used: 7:25:58.065823,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:25:58.065823 at 2024-07-28 22:22:55.220468
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7158749, 'precision': 0.66723037, 'recall': 0.60308164, 'specificity': 0.97137654, 'f1': 0.60140836, 'auroc': 0.8824148}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   911     4    4   35    0    7   146   41     2   17     3
1     2  1359    1   24    0    0    11   69     2    5    26
2     5     2  234   19  241   38   106   17   192   24   137
3     0     0    0    0    0    0     0    0     0    0     0
4     1     0    6    0  348    0    23    1    14    0  1240
5    10     1   10  130    1  405    11    0     2   18     4
6     0     0    0    1    0    0  3057    1     1    0     7
7     1     1    2  154    0    1    11  988     3    0     3
8     0     1    2  178    1    6    89   10  1080    1     2
9     6     8  279  163   13  281    52   31    48  232    24
10    0     0    0    0   17    0     9    0     2    0  1618
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7547051, 'precision': 0.6766922, 'recall': 0.6424689, 'specificity': 0.9754156, 'f1': 0.6260128, 'auroc': 0.88613605}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1056     0   0   13    2    9    30    18    11   15    16
1      1  1355   0   16    0    4     0   103     4    3    13
2      5     5  48   14  349   34    20    35   320   57   128
3      0     0   0    0    0    0     0     0     0    0     0
4      0     1   0    0  638    0     3     1    17    1   972
5      8     0   0   77    6  429    11     0    12   43     6
6      0     0   0    1    1    1  2976     3    19    0    66
7      2     0   0  122    0    1     1  1033     3    0     2
8      0     0   0   70    1    4    11    14  1268    0     2
9     15    14  47   84   24  243    22    57   206  402    23
10     0     1   0    0   62    0     0     0     1    0  1582
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_14_56_56_seed_1_23104523_instance_wise_predictions.txt
accuracy from prediction file 0.7158749037990625
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |   1647 MiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      6 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  31154 MiB |  14634 MiB |
|       from large pool |  16492 MiB |  16492 MiB |  31124 MiB |  14632 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 233536 KiB | 630848 KiB | 126228 GiB | 126228 GiB |
|       from large pool | 216320 KiB | 628608 KiB | 120387 GiB | 120386 GiB |
|       from small pool |  17216 KiB |  25532 KiB |   5841 GiB |   5841 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   60095 K  |   60093 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2399    |    3599    |   33299 K  |   33297 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   60095 K  |   60093 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2399    |    3599    |   33299 K  |   33297 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     828    |     361    |
|       from large pool |     453    |     453    |     813    |     360    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     118    |     568    |   33501 K  |   33501 K  |
|       from large pool |      95    |     304    |   17481 K  |   17481 K  |
|       from small pool |      23    |     459    |   16019 K  |   16019 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |  16640 KiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1884 MiB |  16520 MiB |  31154 MiB |  29270 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  31124 MiB |  29264 MiB |
|       from small pool |     24 MiB |     28 MiB |     30 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630848 KiB | 126229 GiB | 126229 GiB |
|       from large pool |  24320 KiB | 628608 KiB | 120388 GiB | 120388 GiB |
|       from small pool |      0 KiB |  25532 KiB |   5841 GiB |   5841 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   60095 K  |   60095 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3599    |   33299 K  |   33299 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   60095 K  |   60095 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3599    |   33299 K  |   33299 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     105    |     467    |     828    |     723    |
|       from large pool |      93    |     453    |     813    |     720    |
|       from small pool |      12    |      14    |      15    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     568    |   33502 K  |   33502 K  |
|       from large pool |       3    |     304    |   17482 K  |   17482 K  |
|       from small pool |       0    |     459    |   16020 K  |   16020 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 22:34:09 2024]
Finished job 0.
1 of 1 steps (100%) done
