Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 27 15:50:06 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/34.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=34
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509

 Experiment start at: 2024-07-27 16:14:25.204047
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.1378297060728073
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8701573, 'precision': 0.6355141, 'recall': 0.5865442, 'specificity': 0.9861444, 'f1': 0.5680499, 'auroc': 0.9522638}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   10     0   0    43   0   20   258    38    22   11     81
1    0  1101   0    39   0    1    11   167     4    0      9
2    0     0   0    64   2   43    56    40     4   80     23
3    0     0   0  8138   0   12     0   175   107    0      3
4    1     0   0    25   1    5   288    13    26   10    170
5    0     0   0   112   0  319     2     0     3   84      1
6    1     0   0    50   2    5  1814    12    13    1     10
7    0     1   0   414   0    2     4  6715    92    3     31
8    1     0   0   321   0   17    31   146  2662    6    111
9    0     0   0    28   0  221     6    17     1  217      3
10   3     1   0    18   0    0  1153    29    42    4  11546
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8706433, 'precision': 0.69212705, 'recall': 0.589623, 'specificity': 0.9861502, 'f1': 0.57430947, 'auroc': 0.95166737}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   29     0   0    41   0   26   233    40    14   11     89
1    0  1115   0    36   0    1     6   161     4    0      9
2    0     0   0    51   2   43    56    40     6   89     25
3    0     0   0  8126   0    8     2   201   101    0      2
4    0     0   0    20   4    8   259     9    32   16    191
5    0     0   0   114   0  319     0     1     3   82      2
6    0     0   0    44   0    2  1822    17    12    2      9
7    1     1   0   426   0    4     6  6710    85    4     28
8    0     0   0   324   0   10    31   151  2658   13    109
9    1     0   0    39   0  217     9    15     2  206      4
10   1     0   0    22   1    3  1128    30    43    8  11560
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56111383, 'precision': 0.5003059, 'recall': 0.45929915, 'specificity': 0.95477796, 'f1': 0.41219625, 'auroc': 0.81844175}
confusion matrix:
    0    1   2    3   4    5     6     7     8    9     10
0   40    0   0  133   1   86   569   247    24   44    26
1    1  715   0   55   0   14    25   660     7    0    22
2    0    0   0  210  12   41   190   137    89  152   184
3    0    0   0    0   0    0     0     0     0    0     0
4    0    1   0    3   0    1   748     2     6    1   871
5    0    0   0  103   0  405     5     1     2   76     0
6    0    0   0   89   0    1  2948    11    16    0     2
7    0    0   0   19   0    1     1  1137     1    0     5
8    0    0   0  259   0   13    32    33  1020    2    11
9    0    1   0  182   1  341    17   147    22  398    28
10   0    0   0    0   0    0   289     0     0    0  1357
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 17:15:45.147692,epoch time: 1:01:19.943645,used: 1:01:19.943645,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9150524, 'precision': 0.7392302, 'recall': 0.6471749, 'specificity': 0.99075997, 'f1': 0.64096415, 'auroc': 0.9675829}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   140     0   0     6   0    0    22    52   116   16    131
1     0  1227   0    12   0    0     3    73    11    0      6
2     0     3   0    64   8    1    18    34    38  133     13
3     0     0   0  7913   1    4     2   345   168    6      0
4     0     0   1    21  10    5   159    12    77   17    237
5     0     0   0    73   0  141     0     1    14  291      1
6     6     0   0     4   1    1  1857     8    13    2     16
7     0    18   0   150   0    1     4  6974    94    2     18
8     0     0   0    91   0    3     3   109  3054    3     32
9     0     1   0    20   0   20     3     8    23  417      1
10    9     3   0     9   0    1   120    28   152    3  12468
---- Validation: 
scalar performance:
{'acc': 0.9152334, 'precision': 0.7567287, 'recall': 0.6522078, 'specificity': 0.9907663, 'f1': 0.64811504, 'auroc': 0.96690595}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   149     1   0     8   0    2    19    54   108   15    127
1     0  1229   0    14   0    0     3    67    10    0      9
2     0     3   0    67   8    4    20    38    35  121     16
3     1     0   0  7892   0    7     1   363   174    2      0
4     0     0   0    28  17    6   148    13    80   18    229
5     0     0   0    72   0  149     1     0    18  281      0
6     3     0   0     3   1    2  1840    11    23    4     21
7     0    21   0   140   0    0     2  6984    98    3     17
8     0     0   0    97   0    0     1   109  3059    0     30
9     1     0   0    17   0   19     2     9    18  425      2
10    5     2   0    14   0    0   143    24   133    3  12472
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6692787, 'precision': 0.5239569, 'recall': 0.539684, 'specificity': 0.9663844, 'f1': 0.4964404, 'auroc': 0.86219}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   526     4   0  15   0    4   133   155   215   83    35
1     0  1272   0  40   1    2    15   150    10    5     4
2     3     4   0  93  10   15   106   107   352  183   142
3     0     0   0   0   0    0     0     0     0    0     0
4     1     1   0   3   1    0   209     2    21    1  1394
5     0     0   0  55   0  128     5     3    22  379     0
6     1     0   0  38   1    1  2967    10    45    0     4
7     0     1   0   6   0    0     1  1148     2    3     3
8     0     0   0  53   0    0     6    30  1267   11     3
9     2    11   1  70   1   57    13    91   246  632    13
10    0     0   0   0   0    0    21     0     0    0  1625
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-27 18:15:06.732566,epoch time: 0:59:21.584874,used: 2:00:41.528519,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9106111, 'precision': 0.74295855, 'recall': 0.66107196, 'specificity': 0.99011695, 'f1': 0.6684629, 'auroc': 0.9817165}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   249     0   0     6   0    1    35    38     5    3    146
1     1  1127   0    13   0    1     1   176     9    0      4
2     4     0   0   105  12    4    26    48    14   72     27
3     1     0   0  7781   0  103     4   339   191   17      2
4     1     0   0    48  50    8   134    21    13    3    261
5     0     0   0    17   0  234     0     1     3  264      2
6     3     0   0    14   0    2  1850    10     7    0     22
7     0     2   0   213   0    1     2  6964    63    5     12
8     1     0   0    99   0    4    11   135  2930   28     88
9     3     0   0    21   0  114     6    10     7  320     12
10    5     0   0    20   1    1   165    44    23    3  12530
---- Validation: 
scalar performance:
{'acc': 0.91076636, 'precision': 0.7354671, 'recall': 0.6606984, 'specificity': 0.99014086, 'f1': 0.66789484, 'auroc': 0.982234}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   258     0   0     8   0    3    35    42     4    3    130
1     0  1132   0    13   1    0     2   173     6    0      5
2     1     0   0   101  16    7    27    39    20   79     22
3     0     0   0  7794   0   95     2   342   180   22      5
4     1     0   0    45  47    8   144    18    14    3    259
5     0     0   0    18   0  224     0     0     2  274      3
6     5     0   0    13   0    2  1853    12     6    0     17
7     1     1   0   228   0    0     2  6960    55    5     13
8     2     0   0   110   0    5    18   136  2906   17    102
9     0     0   0    20   1  112     7     8    11  321     13
10    4     0   0    14   2    2   154    35    30    1  12554
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6425523, 'precision': 0.5252674, 'recall': 0.5268701, 'specificity': 0.96362096, 'f1': 0.49633923, 'auroc': 0.8766086}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   446     4   0   16   0  105   136  120    18   47   278
1     0  1010   0   71   1   19    23  356     9    2     8
2     2     0   0  256  33   84   241   59   133  141    66
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0   13   6    2   446    2     5    0  1158
5     0     0   0   10   0  323     3    0     1  255     0
6     0     0   0    6   0    1  3057    1     1    0     1
7     0     0   0  211   0   24     1  895    17   12     4
8     0     0   0   96   0   32    14    3  1173   39    13
9     1     1   0   64  10  188    18   36   121  691     7
10    0     0   0    0   0    0    63    0     0    0  1583
early stop counter: 1
val acc:0.9107663631439209, best validation acc: 0.9152333736419678, corresponding to test acc:                         0.6692786812782288 / 0.6692786812782288
after epoch: 3,now: 2024-07-27 19:14:50.368015,epoch time: 0:59:43.635449,used: 3:00:25.163968,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9329784, 'precision': 0.7499114, 'recall': 0.6907294, 'specificity': 0.9923377, 'f1': 0.7000153, 'auroc': 0.9829773}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   271     0   0     2   0    4    10    23     9    2    162
1     0  1204   0    15   0    0     0    94     8    0     11
2     1     0   0    82  13    9    14    40    10  104     39
3     0     0   0  8056   0    6     3   218   152    1      2
4     0     0   0    23   8    9   109    13    20    3    352
5     0     0   0    40   0  360     1     1     8  110      1
6     2     0   0     3   0    3  1847     5     7    0     41
7     0     9   0   111   0    0     4  7041    80    0     18
8     0     0   0    88   0    0     0    85  3058    3     62
9     1     0   0    16   0  141     3    14     5  302     11
10    0     0   0    10   1    1    19    11    26    1  12724
---- Validation: 
scalar performance:
{'acc': 0.93205833, 'precision': 0.7717875, 'recall': 0.686629, 'specificity': 0.99223053, 'f1': 0.6979953, 'auroc': 0.9851588}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   251     1   0     6   0    2     9    20     9    2    183
1     0  1195   0    10   0    0     0   106     9    0     12
2     1     1   0    85  10   10    22    37    10  100     36
3     1     1   0  8057   0    8     5   208   158    1      1
4     1     0   0    25  19   10    98     8    21    4    353
5     0     0   0    39   0  367     0     0     9  105      1
6     2     0   0     3   0    4  1855     2     8    0     34
7     0     6   0   123   0    1     3  7038    73    1     20
8     0     0   0    88   0    3     1   110  3036    1     57
9     0     0   0    16   0  154     4    11     9  288     11
10    0     1   0     7   1    2    16     8    22    0  12739
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63142794, 'precision': 0.5270971, 'recall': 0.52418125, 'specificity': 0.96277016, 'f1': 0.47763988, 'auroc': 0.8410076}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   348     1   0   39   0   25   268   181    36    8   264
1     0  1058   0   39   0    0     3   344     8    0    47
2     0     0   0   47   2   60    98   160   343   55   250
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0   0    0    10     2    19    1  1601
5     2     0   0  121   0  391     6     1    24   46     1
6     0     0   0  107   0    0  2880     9    48    0    23
7     0     0   0   15   0    0     0  1145     1    0     3
8     0     0   0   76   0    0     1    18  1269    2     4
9     3     4   0  140   0  157    22   192   298  288    33
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 4,now: 2024-07-27 20:14:43.354297,epoch time: 0:59:52.986282,used: 4:00:18.150250,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9213934, 'precision': 0.77147764, 'recall': 0.68538404, 'specificity': 0.99150825, 'f1': 0.70164824, 'auroc': 0.9856019}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   206     0   0     3    1    0    53    23    33    1    163
1     0  1292   0    12    1    0     3    14     6    0      4
2     2     6   1   115  101    2    10    19    30   21      5
3     0     6   0  7974    1   12     9   155   278    2      1
4     0     2   0    14  132    2   179     5    39    1    165
5     3     2   0    41    0  300     2     0    17  154      2
6     0     0   0     4    0    0  1881     0     9    0     14
7     0    85   0   266    7    0    10  6694   191    1     10
8     0     3   0    46    3    0     8    44  3159    1     31
9     2     6   3    77    9   61     7    19    43  259      5
10    2     3   0    14   19    0   134    19    61    1  12540
---- Validation: 
scalar performance:
{'acc': 0.92039585, 'precision': 0.8110298, 'recall': 0.68794423, 'specificity': 0.99139357, 'f1': 0.70450574, 'auroc': 0.98552865}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   215     0   0     7    0    0    51    23    26    0    161
1     0  1290   0     8    0    0     5    17     7    0      5
2     2     3   2   118  102    1    12    19    32   15      6
3     0     6   0  7965    0   16     8   158   283    2      2
4     0     1   0    14  136    2   171     8    39    0    168
5     0     1   0    45    0  296     1     0    21  154      3
6     1     1   0     2    0    0  1885     2     7    0     10
7     0    79   0   290    3    0    11  6677   193    0     12
8     0     6   0    51    4    0    10    47  3150    0     28
9     1     8   1    76   10   70    11    13    33  267      3
10    3     2   0    14   14    1   158    15    62    1  12526
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66829914, 'precision': 0.5536412, 'recall': 0.553481, 'specificity': 0.96614605, 'f1': 0.51606274, 'auroc': 0.8659328}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   449     4   0   24    0   14   219   113    69   12   266
1     0  1315   0   35    0    3    22    98    17    2     7
2     0     8   0   55  114   16   144    53   494   77    54
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    0   28    0   164     3    38    0  1399
5     1     0   0   52    0  409     3     0    23  104     0
6     0     0   0   12    0    0  3051     2     2    0     0
7     0     0   0  101    0    0    24  1012    25    0     2
8     0     0   0   72    0    4     3     4  1286    1     0
9     4     6   0   67   12  157    11    74   430  368     8
10    0     0   0    0    0    0    11     0     1    0  1634
early stop counter: 1
val acc:0.9203958511352539, best validation acc: 0.9320583343505859, corresponding to test acc:                         0.6314279437065125 / 0.6692786812782288
after epoch: 5,now: 2024-07-27 21:14:01.993985,epoch time: 0:59:18.639688,used: 4:59:36.789938,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9284568, 'precision': 0.87919825, 'recall': 0.6816759, 'specificity': 0.99180865, 'f1': 0.7142668, 'auroc': 0.9867222}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   223     0   0     8    0    0     4    81    23    1    143
1     0  1225   0     9    0    0     1    83     4    0      9
2     0     0   1   153   55    0    10    43     5   34     11
3     0     0   0  7906    0    4     1   354   171    0      2
4     0     0   0    31  100    0   108    12     9    1    277
5     0     0   0    84    0  303     0     2     8  121      3
6     2     0   0     5    2    0  1840    13     6    0     40
7     0     7   0    70    0    0     3  7120    50    0     14
8     0     0   0    51    4    0     1   176  2993    0     69
9     0     0   0   108    0   56     0    26    16  277     10
10    3     0   0    11    4    1    19    24    17    1  12714
---- Validation: 
scalar performance:
{'acc': 0.9268958, 'precision': 0.7856604, 'recall': 0.6740664, 'specificity': 0.9916283, 'f1': 0.70617056, 'auroc': 0.98705417}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   211     0   0     4   0    0     5    87    21    0    155
1     0  1227   0    11   0    0     0    78     6    0     10
2     0     0   0   161  51    0     8    48     8   23     13
3     0     0   0  7898   0    2     2   371   165    1      1
4     1     0   0    32  92    0   118    16     8    2    270
5     1     0   0   101   0  269     0     3    10  136      1
6     1     0   0     6   1    0  1834    12     9    0     45
7     0     6   0    79   1    0     1  7102    64    1     11
8     0     0   0    59   3    0     3   169  3000    2     60
9     0     0   0   107   1   55     0    22     5  291     12
10    3     0   0    12   5    0    12    25     9    2  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63268733, 'precision': 0.5446834, 'recall': 0.52072805, 'specificity': 0.96337557, 'f1': 0.4742676, 'auroc': 0.8556919}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   246     1   0   12    1    7     9   499   309   45    41
1     0  1132   0   27    1    0     0   284     6    0    49
2     0     1   0  168  103   12     7   292   159   59   214
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    2   23    0     7     9    11    0  1580
5     0     0   0  112    1  359     0     1    21   98     0
6     0     0   0   70    2    0  2893    43    38    0    21
7     0     0   0    1    0    0     0  1160     1    0     2
8     0     0   0   42    0    1     0    42  1278    1     6
9     0     1   0  163    5  127     0   276   233  307    25
10    0     0   0    0    0    0     0     0     1    0  1645
early stop counter: 2
val acc:0.926895797252655, best validation acc: 0.9320583343505859, corresponding to test acc:                         0.6314279437065125 / 0.6692786812782288
after epoch: 6,now: 2024-07-27 22:14:17.082626,epoch time: 1:00:15.088641,used: 5:59:51.878579,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9306507, 'precision': 0.8611897, 'recall': 0.6802559, 'specificity': 0.99201113, 'f1': 0.6979363, 'auroc': 0.98232836}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   146     0   0     9   0    1     3    27     7    2    288
1     0  1239   0    16   0    0     0    69     3    0      5
2     0     2   1    90  53    3    27    39     3   84     10
3     0     1   0  8268   0    8     0   104    57    0      0
4     1     0   0    14  53    6   183    16    15    4    246
5     0     1   0    53   0  386     0     1     4   74      2
6     0     0   0    18   4    1  1830     8     3    0     43
7     0     5   0   276   1    0     0  6941    34    0      7
8     0     0   0   176   2    2     3   171  2886    1     55
9     0     1   0    26   1  122     2    13     3  317      8
10    0     1   0    13   2    2    17    20    20    0  12717
---- Validation: 
scalar performance:
{'acc': 0.93026614, 'precision': 0.7715726, 'recall': 0.68212396, 'specificity': 0.9919824, 'f1': 0.6986525, 'auroc': 0.9824852}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   143     0   0     7   0    0     5    27     8    4    289
1     0  1242   0    17   0    0     0    65     5    0      3
2     0     2   0    81  58    6    22    42     5   82     14
3     0     2   0  8261   0    8     0   115    53    1      0
4     0     0   1    18  55    5   201    18     8    3    230
5     0     0   0    41   0  399     0     0     5   73      3
6     0     1   0    24   1    3  1829     3     5    0     42
7     0     6   0   282   1    0     0  6936    33    1      6
8     0     0   0   179   1    3     3   174  2882    2     52
9     0     2   0    29   0  109     3    15     5  319     11
10    2     0   0    15   1    2    27    25    12    0  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6435318, 'precision': 0.5409764, 'recall': 0.5386582, 'specificity': 0.96413386, 'f1': 0.49574265, 'auroc': 0.8512929}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   292     1   0   27   0   11    62   101    20   31   625
1     0  1185   0   38   0    1     1   256     4    0    14
2     1    12   0   55  51   55    96   165   205   96   279
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0   1    1    23     3    13    0  1592
5     0     0   0   73   0  453     3     1     4   54     4
6     0     0   0   62   0    0  2940     4     7    0    54
7     0     0   0   43   0    1     0  1117     0    0     3
8     0     1   0  158   0    1     3    26  1168    2    11
9     1    10   0  112   7  222    15   187   142  397    44
10    0     0   0    0   0    0     0     0     1    0  1645
early stop counter: 3
val acc:0.9302661418914795, best validation acc: 0.9320583343505859, corresponding to test acc:                         0.6314279437065125 / 0.6692786812782288
after epoch: 7,now: 2024-07-27 23:13:52.599364,epoch time: 0:59:35.516738,used: 6:59:27.395317,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92626286, 'precision': 0.81374276, 'recall': 0.67407215, 'specificity': 0.9915251, 'f1': 0.6863698, 'auroc': 0.98876035}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   109     0   0     6   0    1     1    81    19   11    255
1     0  1174   0     9   0    1     0   127    12    1      8
2     0     0   0   101   3    0     0    80    16  107      5
3     0     0   0  8177   0   15     0   164    78    2      2
4     0     0   0   194  34    2     5    26    31   15    232
5     0     0   0    38   0  378     0     0     2  102      1
6     0     0   0     6   0    1  1814    32     7    3     45
7     0     6   0   236   0    1     0  6845   159    6     11
8     0     0   0   136   0    2     0    72  3042    6     37
9     0     0   0    14   0   83     0    18    11  366      1
10    0     0   0    27   0    0     6    27    48    2  12681
---- Validation: 
scalar performance:
{'acc': 0.9268691, 'precision': 0.8195118, 'recall': 0.6721369, 'specificity': 0.991588, 'f1': 0.68385077, 'auroc': 0.9893338}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   93     0   0     4   0    1     3   100    21   13    248
1    0  1186   0     7   0    1     0   117    13    1      7
2    0     0   0   111   1    1     0    78    16  101      4
3    0     0   0  8202   0   12     0   151    67    7      1
4    0     0   0   186  39    1     4    28    37    9    235
5    0     0   0    36   0  367     0     0     2  115      1
6    0     0   0     3   0    0  1807    17    15    3     63
7    0     4   0   231   0    0     1  6856   156    8      9
8    0     0   0   142   0    0     0    77  3026    9     42
9    0     0   0    13   0   81     0     9    12  375      3
10   0     1   0    13   0    0     2    25    53    2  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62401175, 'precision': 0.6050603, 'recall': 0.5136475, 'specificity': 0.9626649, 'f1': 0.4536981, 'auroc': 0.8626758}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   54     5   0   11   0   13    15   630   187  150   105
1    0  1049   0   52   0    4     0   292    21    5    76
2    0     0   0  213   0   17     1   146   353  146   139
3    0     0   0    0   0    0     0     0     0    0     0
4    1     0   0   26   3    0     2     4    22    1  1574
5    0     0   0   86   0  419     0     0     1   86     0
6    0     0   0   31   0    0  2999     3     6    0    28
7    0     0   0   61   0    0     0  1091     7    2     3
8    0     0   0  155   0    3     1     7  1197    4     3
9    0     0   0  113   0  227     0    88   231  462    16
10   0     0   0    0   0    0     0     0     1    0  1645
early stop counter: 4
val acc:0.9268690943717957, best validation acc: 0.9320583343505859, corresponding to test acc:                         0.6314279437065125 / 0.6692786812782288
after epoch: 8,now: 2024-07-28 00:13:00.084589,epoch time: 0:59:07.485225,used: 7:58:34.880542,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9054206, 'precision': 0.7951634, 'recall': 0.6462528, 'specificity': 0.9891201, 'f1': 0.6541459, 'auroc': 0.98897743}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   21     9   0    11   0    6     1   168     9   22    236
1    0  1263   0    17   0    0     0    38     7    0      7
2    0     3   0   204   4    1     0     8     3   82      7
3    0     2   0  7671   0   32     0   230   498    3      3
4    0     2   0   139  88    2    33     6    12   12    245
5    0     0   0    49   0  359     0     0     8  104      1
6    0     2   0    21   1   23  1496     8     4   10    343
7    0    20   0   220   0    4     1  6816   180    5     17
8    0     2   0   114   0    3     0    56  3061    3     55
9    0     0   0    58   0   71     0     3    11  350      0
10   0     2   0    32   1    1     1    17    19    3  12716
---- Validation: 
scalar performance:
{'acc': 0.90528286, 'precision': 0.7955451, 'recall': 0.6457884, 'specificity': 0.98908234, 'f1': 0.6536909, 'auroc': 0.9891323}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   27     3   0     9   0    7     1   157     5   19    255
1    0  1254   0    20   0    0     0    46     6    1      5
2    0     1   0   211   4    4     0     8     4   72      8
3    0     1   0  7666   0   30     2   240   498    3      0
4    0     1   0   155  73    3    31     3    12    9    252
5    0     0   0    47   0  360     0     0     9  104      1
6    0     1   0    20   1   19  1504    12     6   15    330
7    0    19   0   237   0    2     0  6818   172    5     12
8    0     2   0   114   0    5     1    46  3068    2     58
9    0     1   0    56   0   74     0     1     5  355      1
10   0     1   0    26   1    4     1    18    23    3  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5544672, 'precision': 0.48175138, 'recall': 0.48012152, 'specificity': 0.95643306, 'f1': 0.424515, 'auroc': 0.8483906}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0    0    43   0   32   0  161     1  317    14  540    62
1    0  1112   0   89   0   64     0  206     3    1    24
2    0     0   0  561   1   60     0   37    80  212    64
3    0     0   0    0   0    0     0    0     0    0     0
4    0     0   0  103  13    0     1    1     7    6  1502
5    0     0   0   28   0  529     0    0     0   35     0
6    0     0   0  134   4    7  2266    2     5    0   649
7    0     0   0  232   0   22     0  900     7    0     3
8    0     0   0  250   0   54     1    1  1055    2     7
9    0     1   0  179   0  493     0   21    31  406     6
10   0     0   0    1   0    0     0    0     1    0  1644
early stop counter: 5
val acc:0.9052828550338745, best validation acc: 0.9320583343505859, corresponding to test acc:                         0.6314279437065125 / 0.6692786812782288
after epoch: 9,now: 2024-07-28 01:12:19.160741,epoch time: 0:59:19.076152,used: 8:57:53.956694,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 8:57:53.956694 at 2024-07-28 01:12:19.160741
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63142794, 'precision': 0.5270971, 'recall': 0.52418125, 'specificity': 0.96277016, 'f1': 0.47763988, 'auroc': 0.8410076}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   348     1   0   39   0   25   268   181    36    8   264
1     0  1058   0   39   0    0     3   344     8    0    47
2     0     0   0   47   2   60    98   160   343   55   250
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0   0    0    10     2    19    1  1601
5     2     0   0  121   0  391     6     1    24   46     1
6     0     0   0  107   0    0  2880     9    48    0    23
7     0     0   0   15   0    0     0  1145     1    0     3
8     0     0   0   76   0    0     1    18  1269    2     4
9     3     4   0  140   0  157    22   192   298  288    33
10    0     0   0    0   0    0     0     0     0    0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6692787, 'precision': 0.5239569, 'recall': 0.539684, 'specificity': 0.9663844, 'f1': 0.4964404, 'auroc': 0.86219}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   526     4   0  15   0    4   133   155   215   83    35
1     0  1272   0  40   1    2    15   150    10    5     4
2     3     4   0  93  10   15   106   107   352  183   142
3     0     0   0   0   0    0     0     0     0    0     0
4     1     1   0   3   1    0   209     2    21    1  1394
5     0     0   0  55   0  128     5     3    22  379     0
6     1     0   0  38   1    1  2967    10    45    0     4
7     0     1   0   6   0    0     1  1148     2    3     3
8     0     0   0  53   0    0     6    30  1267   11     3
9     2    11   1  70   1   57    13    91   246  632    13
10    0     0   0   0   0    0    21     0     0    0  1625
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_27_16_14_24_seed_0_23104509_instance_wise_predictions.txt
accuracy from prediction file 0.6314279717344154
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/34.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/34.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/34.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB | 756597 GiB | 756595 GiB |
|       from large pool |   1648 MiB |  19382 MiB | 751393 GiB | 751392 GiB |
|       from small pool |      7 MiB |     32 MiB |   5203 GiB |   5203 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB | 756597 GiB | 756595 GiB |
|       from large pool |   1648 MiB |  19382 MiB | 751393 GiB | 751392 GiB |
|       from small pool |      7 MiB |     32 MiB |   5203 GiB |   5203 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB | 754035 GiB | 754033 GiB |
|       from large pool |   1647 MiB |  19328 MiB | 748836 GiB | 748834 GiB |
|       from small pool |      6 MiB |     31 MiB |   5199 GiB |   5199 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20106 MiB |  20106 MiB |  20106 MiB |      0 B   |
|       from large pool |  20072 MiB |  20072 MiB |  20072 MiB |      0 B   |
|       from small pool |     34 MiB |     34 MiB |     34 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 231478 KiB | 777243 KiB | 108647 GiB | 108647 GiB |
|       from large pool | 216320 KiB | 775200 KiB | 103297 GiB | 103297 GiB |
|       from small pool |  15158 KiB |  17181 KiB |   5350 GiB |   5350 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   48324 K  |   48322 K  |
|       from large pool |     247    |     691    |   24588 K  |   24587 K  |
|       from small pool |    2419    |    3627    |   23736 K  |   23734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   48324 K  |   48322 K  |
|       from large pool |     247    |     691    |   24588 K  |   24587 K  |
|       from small pool |    2419    |    3627    |   23736 K  |   23734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     563    |     563    |     563    |       0    |
|       from large pool |     546    |     546    |     546    |       0    |
|       from small pool |      17    |      17    |      17    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     118    |    1241    |   27855 K  |   27855 K  |
|       from large pool |      94    |     363    |   16913 K  |   16913 K  |
|       from small pool |      24    |    1147    |   10942 K  |   10942 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB | 756597 GiB | 756597 GiB |
|       from large pool |  16640 KiB |  19382 MiB | 751393 GiB | 751393 GiB |
|       from small pool |      0 KiB |     32 MiB |   5203 GiB |   5203 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB | 756597 GiB | 756597 GiB |
|       from large pool |  16640 KiB |  19382 MiB | 751393 GiB | 751393 GiB |
|       from small pool |      0 KiB |     32 MiB |   5203 GiB |   5203 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB | 754035 GiB | 754035 GiB |
|       from large pool |  16640 KiB |  19328 MiB | 748836 GiB | 748836 GiB |
|       from small pool |      0 KiB |     31 MiB |   5199 GiB |   5199 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20106 MiB |  20106 MiB |  18224 MiB |
|       from large pool |   1860 MiB |  20072 MiB |  20072 MiB |  18212 MiB |
|       from small pool |     22 MiB |     34 MiB |     34 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 777243 KiB | 108648 GiB | 108648 GiB |
|       from large pool |  24320 KiB | 775200 KiB | 103298 GiB | 103298 GiB |
|       from small pool |      0 KiB |  20690 KiB |   5350 GiB |   5350 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   48324 K  |   48324 K  |
|       from large pool |       2    |     691    |   24588 K  |   24588 K  |
|       from small pool |       0    |    3627    |   23736 K  |   23736 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   48324 K  |   48324 K  |
|       from large pool |       2    |     691    |   24588 K  |   24588 K  |
|       from small pool |       0    |    3627    |   23736 K  |   23736 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     563    |     563    |     459    |
|       from large pool |      93    |     546    |     546    |     453    |
|       from small pool |      11    |      17    |      17    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1241    |   27856 K  |   27856 K  |
|       from large pool |       3    |     363    |   16913 K  |   16913 K  |
|       from small pool |       0    |    1147    |   10943 K  |   10943 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB | 756597 GiB | 756597 GiB |
|       from large pool |  16640 KiB |  19382 MiB | 751393 GiB | 751393 GiB |
|       from small pool |      0 KiB |     32 MiB |   5203 GiB |   5203 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB | 756597 GiB | 756597 GiB |
|       from large pool |  16640 KiB |  19382 MiB | 751393 GiB | 751393 GiB |
|       from small pool |      0 KiB |     32 MiB |   5203 GiB |   5203 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB | 754035 GiB | 754035 GiB |
|       from large pool |  16640 KiB |  19328 MiB | 748836 GiB | 748836 GiB |
|       from small pool |      0 KiB |     31 MiB |   5199 GiB |   5199 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |  20106 MiB |  20106 MiB |  18224 MiB |
|       from large pool |   1860 MiB |  20072 MiB |  20072 MiB |  18212 MiB |
|       from small pool |     22 MiB |     34 MiB |     34 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 777243 KiB | 108648 GiB | 108648 GiB |
|       from large pool |  24320 KiB | 775200 KiB | 103298 GiB | 103298 GiB |
|       from small pool |      0 KiB |  20690 KiB |   5350 GiB |   5350 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   48324 K  |   48324 K  |
|       from large pool |       2    |     691    |   24588 K  |   24588 K  |
|       from small pool |       0    |    3627    |   23736 K  |   23736 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   48324 K  |   48324 K  |
|       from large pool |       2    |     691    |   24588 K  |   24588 K  |
|       from small pool |       0    |    3627    |   23736 K  |   23736 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     104    |     563    |     563    |     459    |
|       from large pool |      93    |     546    |     546    |     453    |
|       from small pool |      11    |      17    |      17    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1241    |   27856 K  |   27856 K  |
|       from large pool |       3    |     363    |   16913 K  |   16913 K  |
|       from small pool |       0    |    1147    |   10943 K  |   10943 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509

 Experiment start at: 2024-07-28 01:30:27.673598
before training, model accuracy: 0.03820051997900009
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.552119, 'precision': 0.573715, 'recall': 0.51870716, 'specificity': 0.95768416, 'f1': 0.4636226, 'auroc': 0.9114049}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   348     2     42    10   0    0    60    15     6   0   0
1     0  1203     14    16   0    0     0    96     3   0   0
2    91    12    123     3   0    4    17    42    20   0   0
3     1     0      4  7861   0    1     1   457   114   0   0
4    26    13    355     2   1    5    33    15    88   0   0
5    58     0     28   114   0  116   164     5    36   0   0
6   171    45     47    34   0    8  1553    23    27   0   0
7     5    58     32   230   1    1     2  6898    35   0   0
8     6     2    210   275   1    6     2   263  2530   0   0
9   197     1     60    18   0   24   163    15    15   0   0
10  110    88  12201    11   9    7   116    74   174   0   3
---- Validation: 
scalar performance:
{'acc': 0.55289555, 'precision': 0.55201864, 'recall': 0.52190936, 'specificity': 0.9577527, 'f1': 0.46501166, 'auroc': 0.9113228}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   348     1     35    14   1    0    62    17     5   0   0
1     0  1202     11    18   0    0     0   101     0   0   0
2    94    11    127     1   0    2    16    40    20   0   1
3     2     0      8  7843   0    1     5   456   125   0   0
4    30    18    363     3   1    2    25    15    82   0   0
5    52     0     28    99   0  120   173     4    45   0   0
6   156    46     54    30   0   10  1571    19    22   0   0
7     3    44     18   264   2    0     1  6895    38   0   0
8    10     4    198   260   0    4     1   258  2561   0   0
9   207     3     63    22   0   22   156    15     5   0   0
10  128   104  12189    11   2   14   107    79   160   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4578465, 'precision': 0.34041125, 'recall': 0.39919448, 'specificity': 0.9458257, 'f1': 0.337572, 'auroc': 0.792154}
confusion matrix:
     0     1     2   3   4   5     6     7     8   9   10
0   996     3     0  26   0   0    80    64     1   0   0
1    16  1249    18  21   0   0     1   186     7   0   1
2   304    31   317   4   0   5   101    92   161   0   0
3     0     0     0   0   0   0     0     0     0   0   0
4    39    85  1457   0   0   0    10     4    38   0   0
5   184     0    10  19   0  30   323     4    22   0   0
6   552   125   372   6   3  83  1694    13   216   0   3
7     6     3     4  42   0   0     0  1109     0   0   0
8    19     1    46  87   0  12    31    26  1148   0   0
9   598    23   129  23   0   9   170   143    42   0   0
10    6    31  1598   0   0   0     3     1     6   0   1
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 02:31:19.759670,epoch time: 1:00:52.086072,used: 1:00:52.086072,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.58615154, 'precision': 0.544582, 'recall': 0.60800284, 'specificity': 0.9611959, 'f1': 0.543773, 'auroc': 0.937016}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   409     0     42     3   0    0    13     8     7   0   1
1     0  1223      7    13   0    0     0    74    15   0   0
2    70     0    163     0   0    3     3    25    38   0  10
3     4     0      3  8032   1    9     7   256   127   0   0
4    26     0    435     0   0    3     4     7    52   0  12
5    43     0      3    25   0  330    30    12    58   0  20
6    26     0     13    13   0    1  1840     3    11   0   1
7     5     7     15   217   0    0     3  6958    59   0   0
8     4     0     79   168   1    3     0    98  2941   0   2
9   214     0     54     4   0   94    31    23    24   0  49
10   66    11  12521    11   1    2    44    41    80   0  12
---- Validation: 
scalar performance:
{'acc': 0.5858232, 'precision': 0.54967046, 'recall': 0.606723, 'specificity': 0.9611377, 'f1': 0.54499817, 'auroc': 0.93617606}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   409     0     43     4   1    0    12     5     8   0   1
1     0  1215     12    15   1    0     0    78    11   0   0
2    69     0    158     0   0    4     5    29    31   0  16
3     2     1      1  8041   1    9     5   248   131   0   1
4    23     0    450     1   0    2     3     7    42   0  11
5    42     0      6    29   1  335    31     8    49   0  20
6    29     2      8     9   0    4  1837     4    15   0   0
7     6     5     13   228   3    0     1  6942    67   0   0
8     7     0     71   178   0    3     1    93  2943   0   0
9   198     0     50     5   0  106    28    22    21   0  63
10   55    10  12553    18   2    2    21    39    75   0  21
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58497167, 'precision': 0.4219194, 'recall': 0.49211073, 'specificity': 0.95880663, 'f1': 0.43706316, 'auroc': 0.8289203}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1103     0     1   4   0    0    44    17     1   0   0
1      4  1231    25  22   1    0     9   191    13   0   3
2    224     0   449  14   0   10    42    57   209   0  10
3      0     0     0   0   0    0     0     0     0   0   0
4      6     3  1587   5   0    1    11     3    16   0   1
5    178     0     5   6   0  210   162    12    19   0   0
6      2     1    23  12   0    7  3002     4    16   0   0
7      9     0     3  15   0    0     3  1133     1   0   0
8     10     0     7  86   0   10    14    10  1233   0   0
9    478     2   114  42   0   98   114    99   173   0  17
10     1     0  1632   6   0    0     7     0     0   0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 03:30:15.338985,epoch time: 0:58:55.579315,used: 1:59:47.665387,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5886665, 'precision': 0.5692103, 'recall': 0.60640514, 'specificity': 0.9615586, 'f1': 0.54218364, 'auroc': 0.93795717}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   369     0     58     5   0    0    27    12    11   0   1
1     0  1253      7    10   0    0     1    52     8   0   0
2    34     1    201     1   0    5     8    31    29   0   2
3     1     1      0  8101   1    1     1   167   165   0   0
4    14     0    455     1   0    6     5     8    46   0   4
5    17     0     13    34   0  273    35     3   146   0   0
6     9     1     12     5   0    2  1864     5     8   0   0
7     0     8     19   229   0    1     1  6975    32   0   0
8     1     1     97   133   0    3     2    98  2961   0   0
9   137     0     95    14   0  106    76    23    40   0   2
10   24     5  12482    10   0    2    37    32   195   0   5
---- Validation: 
scalar performance:
{'acc': 0.58980876, 'precision': 0.5518891, 'recall': 0.6141778, 'specificity': 0.9616858, 'f1': 0.54357344, 'auroc': 0.9362711}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   370     0     55     4   0    0    22    20    11   0   1
1     0  1244      7    12   0    0     1    62     6   0   0
2    31     0    220     0   0    5     7    22    25   0   2
3     1     0      1  8107   0    1     0   167   163   0   0
4    15     0    441     1   0    4     5     8    64   0   1
5    19     0     12    29   0  286    29     4   142   0   0
6    11     2     15     4   0    2  1863     4     7   0   0
7     0    12     18   203   0    0     1  6977    54   0   0
8     0     2     92   112   0    2     3   104  2981   0   0
9   142     0     87    12   0  112    77    17    40   0   6
10   22     7  12472    10   0    2    44    36   201   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5364164, 'precision': 0.4192672, 'recall': 0.43804926, 'specificity': 0.95408225, 'f1': 0.39505374, 'auroc': 0.7869406}
confusion matrix:
     0     1     2    3   4    5     6     7     8   9   10
0   780     0    19   36   0    0    53   248    34   0   0
1     2  1124    38   32   0    0     4   291     7   0   1
2    89     1   406   49   0    8    65    98   299   0   0
3     0     0     0    0   0    0     0     0     0   0   0
4     4     0  1583    0   0    0     5     3    38   0   0
5    41     0    25  108   0  108   181    57    72   0   0
6     0     0    26  110   0    1  2873     9    48   0   0
7     1     0     2   10   0    0     1  1150     0   0   0
8     0     0     1  125   0    0     3    15  1226   0   0
9   150     2   140  168   0   26   192   236   223   0   0
10    0     0  1637    0   0    0     3     1     5   0   0
better model found
persisted
after epoch: 3,now: 2024-07-28 04:29:22.586851,epoch time: 0:59:07.247866,used: 2:58:54.913253,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.58746254, 'precision': 0.5529208, 'recall': 0.62616897, 'specificity': 0.96127754, 'f1': 0.5562409, 'auroc': 0.9451639}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   426     1     30     2   0    0    14    10     0   0   0
1     0  1255      5     5   0    0     0    60     6   0   0
2    45     0    178     1   0    5     5    65     4   0   9
3     1     0      1  7936   0   13     4   419    66   0   0
4    20     0    453     0   0    3     6    17    27   0  13
5    15     0      4    21   0  390    17     7    65   0   2
6    19     3     10     4   0    1  1861     5     4   0   1
7     1    12     14   108   0    0     1  7104    21   0   0
8     2     3     84   235   0    4     3   165  2798   0   1
9   151     0     38     5   0  144    55    55     9   0  36
10   64     7  12577    12   0    3    28    43    50   0   9
---- Validation: 
scalar performance:
{'acc': 0.5875886, 'precision': 0.5565422, 'recall': 0.6257788, 'specificity': 0.9612981, 'f1': 0.557153, 'auroc': 0.9452419}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   427     1     29     3   0    0    17     6     0   0   0
1     0  1258      5     8   0    0     0    58     3   0   0
2    53     0    174     1   0    6     5    63     3   0   7
3     1     0      1  7950   0   10     4   399    75   0   0
4    14     0    465     1   0    7     4    22    17   0   9
5     9     0      5    17   0  396    14     3    70   0   7
6    20     2     10     3   0    3  1856     9     5   0   0
7     1     9     16   101   0    0     1  7120    17   0   0
8     4     1     99   227   0    2     7   182  2774   0   0
9   146     0     42     3   0  157    40    56     7   0  42
10   58     7  12576    11   0    1    26    52    53   0  12
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5779752, 'precision': 0.41920984, 'recall': 0.49770796, 'specificity': 0.95789695, 'f1': 0.44322678, 'auroc': 0.82766485}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9   10
0   1044     0     3   11   0    0    40    69     3   0   0
1      7  1121    31   26   0    1    17   293     3   0   0
2    172     0   428    6   0   57   135    64   125   0  28
3      0     0     0    0   0    0     0     0     0   0   0
4      5     1  1571    0   0    3    13     2    34   0   4
5     34     0     0   26   0  372   131    12    16   0   1
6      1     0     2   15   0    0  3044     2     3   0   0
7      5     0     2    5   0    1     1  1148     1   0   1
8     11     0     8  143   0   42    46    16  1104   0   0
9    304     1    98   43   0  223   294   113    45   0  16
10     0     0  1632    0   0    0     8     0     6   0   0
early stop counter: 1
val acc:0.5875886082649231, best validation acc: 0.5898087620735168, corresponding to test acc:                         0.5364164113998413 / 0.5849716663360596
after epoch: 4,now: 2024-07-28 05:28:58.310409,epoch time: 0:59:35.723558,used: 3:58:30.636811,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5856164, 'precision': 0.55449516, 'recall': 0.6204921, 'specificity': 0.9610486, 'f1': 0.55904406, 'auroc': 0.9453037}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9   10
0   403     0     55     3   0    1     9     4     5   0   3
1     0  1222     10    15   0    1     0    67    15   0   0
2    43     0    178     0   0    7     6    15    24   0  39
3     3     0      3  8233   0   13     5    79   101   0   0
4    10     0    465     0   0    5     0     7    31   0  21
5     1     0      1    10   0  384    12     5    95   0  13
6    20     2     19     6   0    2  1855     1     0   0   2
7    12     3     40   406   0    1     2  6623   175   0   3
8     2     0     71   191   0    5     4    42  2977   0   3
9    86     0     32     1   0  162    29    72    16   0  95
10   19     1  12659    10   0    2    11     7    72   0  13
---- Validation: 
scalar performance:
{'acc': 0.58611745, 'precision': 0.554297, 'recall': 0.6173238, 'specificity': 0.961095, 'f1': 0.5592745, 'auroc': 0.9451986}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   402     0     59     2   0    1     8     5     4   0    2
1     0  1212     15    14   0    0     0    75    16   0    0
2    47     0    168     0   0    7     6    19    21   0   44
3     2     0      5  8226   0   14     7    75   110   0    1
4     6     0    459     0   0    5     1     7    36   0   25
5     1     0      1     6   0  386    12     6    92   0   17
6    21     1     17     2   0    3  1852     3     8   0    1
7     6     6     41   377   0    3     3  6674   154   0    1
8     2     0     67   195   0    8     4    36  2980   0    4
9    71     0     32     3   0  160    35    80    12   0  100
10   28     4  12665     8   0    3     9     6    61   0   12
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5481005, 'precision': 0.40638277, 'recall': 0.47091162, 'specificity': 0.9551446, 'f1': 0.4237523, 'auroc': 0.8193908}
confusion matrix:
      0    1     2    3   4    5     6    7     8   9    10
0   1104    0     5    2   0    0    43   15     1   0    0
1     43  984   101   47   0    4    52  244    23   0    1
2    112    0   344    9   0   57    63   76   240   0  114
3      0    0     0    0   0    0     0    0     0   0    0
4      5    0  1593    0   0    2     2    0    27   0    4
5     37    0     0    7   0  406   127    2    12   0    1
6      2    0    36    5   0    2  3005    1    13   0    3
7     72    0     4  127   0    1     9  946     3   0    2
8      2    0     0  175   0  109    36    3  1045   0    0
9    237    0    63   29   0  324   239   92    82   0   71
10     0    1  1642    0   0    0     1    0     2   0    0
early stop counter: 2
val acc:0.5861174464225769, best validation acc: 0.5898087620735168, corresponding to test acc:                         0.5364164113998413 / 0.5849716663360596
after epoch: 5,now: 2024-07-28 06:28:30.339867,epoch time: 0:59:32.029458,used: 4:58:02.666269,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.58794415, 'precision': 0.57156634, 'recall': 0.5881572, 'specificity': 0.96115535, 'f1': 0.53323686, 'auroc': 0.9504705}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   409     1     39     3   0    0    10    11     5   0    5
1     0  1277     11    14   0    0     0    27     3   0    0
2    36     3    184     2   0    0     1    44    19   0   23
3     4     3      2  8160   0    1    12   152    99   0    4
4     8     2    456     1   0    0     2    11    33   0   26
5    10     0      4    44   0  143    36    22   182   0   80
6    19     1     15     1   0    0  1857     1     6   0    8
7    32    24     23   196   0    0    10  6909    58   0    9
8    15     2     90   123   0    2     5    77  2978   0    4
9   100     1     40    16   0   24     9   137    20   0  146
10   41     2  12593    11   0    0    16    28    45   0   58
---- Validation: 
scalar performance:
{'acc': 0.5882841, 'precision': 0.5731816, 'recall': 0.5917405, 'specificity': 0.96121657, 'f1': 0.53606534, 'auroc': 0.9489013}
confusion matrix:
     0     1      2     3   4    5     6     7     8   9    10
0   399     1     44     3   0    0    16    10     4   0    6
1     1  1275      9    13   0    0     2    28     3   0    1
2    36     4    193     2   0    1     2    34    18   0   22
3     7     3      0  8131   0    0    17   174   105   0    3
4     6     0    452     0   0    1     1     9    39   0   31
5    12     0      1    49   0  158    26    22   180   0   73
6    19     2     16     2   0    0  1859     2     3   0    5
7    33    29     21   185   0    0    11  6923    60   0    3
8     6     1     96   108   0    0     6    79  2995   0    5
9   104     1     46    16   0   27    13   119    22   0  145
10   24     7  12613    11   0    0    10    27    44   0   60
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5478206, 'precision': 0.42852652, 'recall': 0.4435202, 'specificity': 0.9553457, 'f1': 0.41092354, 'auroc': 0.8275007}
confusion matrix:
      0     1     2    3   4    5     6    7     8   9    10
0   1121     0     0    0   0    0    45    3     1   0    0
1     25  1220    28   37   0    0    43  122    18   0    6
2    119     5   241   37   0    3    40   97   360   0  113
3      0     0     0    0   0    0     0    0     0   0    0
4      3     0  1585    1   0    0     7    2    23   0   12
5    110     0     0   48   0  147    94   68    95   0   30
6      0     0    11   24   0    0  3027    1     3   0    1
7     49     1     3  128   0    1    48  932     1   0    1
8      4     0     0  196   0    1    23    6  1140   0    0
9    307     3    39  219   0   23    50  213   201   0   82
10     0     0  1640    2   0    0     1    0     1   0    2
early stop counter: 3
val acc:0.5882840752601624, best validation acc: 0.5898087620735168, corresponding to test acc:                         0.5364164113998413 / 0.5849716663360596
after epoch: 6,now: 2024-07-28 07:28:06.901710,epoch time: 0:59:36.561843,used: 5:57:39.228112,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.582058, 'precision': 0.5478779, 'recall': 0.581137, 'specificity': 0.96081424, 'f1': 0.50781137, 'auroc': 0.95259446}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   379     1     56     6   0   0    15     7    14   0   5
1     0  1297      1     8   0   1     0    18     7   0   0
2    14     3    224     1   0   1     4    41    21   0   3
3     2     4      0  8093   0   0     2   128   208   0   0
4     2     4    428     0   0   2     4     8    73   0  18
5    12     0      8    34   0  59    38    16   348   0   6
6    17     4      7     2   0   0  1852     6    17   0   2
7     0    77     31   255   0   0     3  6710   187   0   2
8     1     3     37    77   0   1     1    53  3123   0   0
9    93     1     71     9   0  36    37   161    61   0  24
10   18     8  12515     5   0   1     9    15   202   0  18
---- Validation: 
scalar performance:
{'acc': 0.58405775, 'precision': 0.55883276, 'recall': 0.5851094, 'specificity': 0.9610369, 'f1': 0.5111784, 'auroc': 0.9527006}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9   10
0   388     1     52     3   0   0    12     8    13   0   6
1     0  1299      2    10   0   0     0    14     7   0   0
2    18     2    228     1   0   1     2    38    19   0   3
3     1     4      1  8115   0   0     1   127   191   0   0
4     5     2    438     1   0   0     0    10    66   0  17
5    14     0      8    22   0  59    35    21   354   0   8
6     8     2     17     2   0   0  1860     5    11   0   3
7     1    80     29   222   0   0     3  6737   193   0   0
8     2     5     30    83   0   0     1    50  3125   0   0
9    82     1     87     8   0  33    55   138    60   0  29
10   13    13  12523     7   0   0     7    18   191   0  24
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.547121, 'precision': 0.42249963, 'recall': 0.4544788, 'specificity': 0.95527613, 'f1': 0.4038149, 'auroc': 0.8161316}
confusion matrix:
     0     1     2    3   4   5     6     7     8   9   10
0   984     0     9   14   0   0    58    89    16   0   0
1     0  1328     9   20   0   0     0   139     3   0   0
2    77     8   402   21   0   6    15   166   276   0  44
3     0     0     0    0   0   0     0     0     0   0   0
4     2     1  1601    0   0   0     0     4    25   0   0
5    62     0     0   97   0  89   111    40   191   0   2
6     4    21    90   33   0   1  2686     8   193   0  31
7     0     0     2    9   0   0     1  1151     1   0   0
8     0     0     0  161   0   0     0    29  1180   0   0
9   165    11   105  157   0  20   101   353   219   0   6
10    0     0  1644    0   0   0     0     0     2   0   0
early stop counter: 4
val acc:0.5840577483177185, best validation acc: 0.5898087620735168, corresponding to test acc:                         0.5364164113998413 / 0.5849716663360596
after epoch: 7,now: 2024-07-28 08:27:15.298229,epoch time: 0:59:08.396519,used: 6:56:47.624631,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.5855094, 'precision': 0.5638632, 'recall': 0.5691105, 'specificity': 0.96085835, 'f1': 0.51852685, 'auroc': 0.95150536}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   394     1     34     5   0   0    15     6     7   0   21
1     0  1272      3    13   0   0     1    37     5   0    1
2     9     1    185     6   0   1     4    29    39   0   38
3     1     2      1  8139   0   0     0   195    99   0    1
4     2     1    410     2   0   0     2     8    44   0   69
5     3     0      3    23   0  51    23     5   388   0   25
6    18     4     13     6   0   0  1857     2     2   0    6
7     5    15     14   188   0   0     3  6934    98   0    6
8     2     2    108   142   0   1     5    66  2964   0    6
9    16     1     55    17   0  40    50    66    79   0  169
10   16    10  12602    10   0   1     9    22    34   0   88
---- Validation: 
scalar performance:
{'acc': 0.585422, 'precision': 0.56337863, 'recall': 0.5676711, 'specificity': 0.9608372, 'f1': 0.51954573, 'auroc': 0.9505248}
confusion matrix:
     0     1      2     3   4   5     6     7     8   9    10
0   388     1     42     7   0   0     8     9     4   0   24
1     0  1269      4    17   0   0     1    37     4   0    0
2    12     0    182     5   0   0     3    31    35   0   44
3     1     2      0  8140   0   1     4   199    93   0    0
4     2     0    425     2   0   2     3     8    36   0   61
5     4     0      1    34   0  54    23     4   374   0   27
6    20     4     11     4   0   0  1854     3    10   0    2
7     2    15     20   177   0   0     2  6942   101   0    6
8     2     0     89   156   0   1     1    60  2978   0    9
9    13     2     51    16   0  43    43    72    78   0  175
10   11     7  12627    10   0   0     9    17    36   0   79
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5531379, 'precision': 0.44274274, 'recall': 0.45781228, 'specificity': 0.9558142, 'f1': 0.42881674, 'auroc': 0.8186998}
confusion matrix:
      0     1     2    3   4    5     6     7     8   9    10
0   1043     0     3    9   0    0    27    81     3   0    4
1      3  1179    23   35   0    0     1   252     0   0    6
2     15     0   361   27   0    9    27   120   154   0  302
3      0     0     0    0   0    0     0     0     0   0    0
4      0     0  1597    0   0    0     2     8     9   0   17
5      8     0     0   31   0  158    83    33   246   0   33
6      1     1    56   27   0    4  2931     5    28   0   14
7      2     0     0    2   0    0     1  1156     1   0    2
8      1     0     8  262   0    2     6    14  1076   0    1
9     27     2    51  145   0   59   109   252   209   0  283
10     0     1  1643    0   0    0     0     0     0   0    2
early stop counter: 5
val acc:0.5854219794273376, best validation acc: 0.5898087620735168, corresponding to test acc:                         0.5364164113998413 / 0.5849716663360596
after epoch: 8,now: 2024-07-28 09:25:31.948271,epoch time: 0:58:16.650042,used: 7:55:04.274673,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 7:55:04.274673 at 2024-07-28 09:25:31.948271
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5364164, 'precision': 0.4192672, 'recall': 0.43804926, 'specificity': 0.95408225, 'f1': 0.39505374, 'auroc': 0.7869406}
confusion matrix:
     0     1     2    3   4    5     6     7     8   9   10
0   780     0    19   36   0    0    53   248    34   0   0
1     2  1124    38   32   0    0     4   291     7   0   1
2    89     1   406   49   0    8    65    98   299   0   0
3     0     0     0    0   0    0     0     0     0   0   0
4     4     0  1583    0   0    0     5     3    38   0   0
5    41     0    25  108   0  108   181    57    72   0   0
6     0     0    26  110   0    1  2873     9    48   0   0
7     1     0     2   10   0    0     1  1150     0   0   0
8     0     0     1  125   0    0     3    15  1226   0   0
9   150     2   140  168   0   26   192   236   223   0   0
10    0     0  1637    0   0    0     3     1     5   0   0
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58497167, 'precision': 0.4219194, 'recall': 0.49211073, 'specificity': 0.95880663, 'f1': 0.43706316, 'auroc': 0.8289203}
confusion matrix:
      0     1     2   3   4    5     6     7     8   9   10
0   1103     0     1   4   0    0    44    17     1   0   0
1      4  1231    25  22   1    0     9   191    13   0   3
2    224     0   449  14   0   10    42    57   209   0  10
3      0     0     0   0   0    0     0     0     0   0   0
4      6     3  1587   5   0    1    11     3    16   0   1
5    178     0     5   6   0  210   162    12    19   0   0
6      2     1    23  12   0    7  3002     4    16   0   0
7      9     0     3  15   0    0     3  1133     1   0   0
8     10     0     7  86   0   10    14    10  1233   0   0
9    478     2   114  42   0   98   114    99   173   0  17
10     1     0  1632   6   0    0     7     0     0   0   0
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_07md_28_01_30_27_seed_1_23104509_instance_wise_predictions.txt
accuracy from prediction file 0.5364164276219128
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/34.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/34.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  19412 MiB |   1396 TiB |   1396 TiB |
|       from large pool |   1648 MiB |  19382 MiB |   1387 TiB |   1387 TiB |
|       from small pool |      7 MiB |     32 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  19412 MiB |   1396 TiB |   1396 TiB |
|       from large pool |   1648 MiB |  19382 MiB |   1387 TiB |   1387 TiB |
|       from small pool |      7 MiB |     32 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  19358 MiB |   1392 TiB |   1392 TiB |
|       from large pool |   1647 MiB |  19328 MiB |   1382 TiB |   1382 TiB |
|       from small pool |      6 MiB |     31 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20086 MiB |  20106 MiB |  38310 MiB |  18224 MiB |
|       from large pool |  20052 MiB |  20072 MiB |  38264 MiB |  18212 MiB |
|       from small pool |     34 MiB |     34 MiB |     46 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 229430 KiB | 777243 KiB | 205311 GiB | 205311 GiB |
|       from large pool | 216320 KiB | 775200 KiB | 195177 GiB | 195177 GiB |
|       from small pool |  13110 KiB |  20690 KiB |  10134 GiB |  10134 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2666    |    3973    |   91369 K  |   91366 K  |
|       from large pool |     247    |     691    |   46481 K  |   46481 K  |
|       from small pool |    2419    |    3627    |   44887 K  |   44885 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2666    |    3973    |   91369 K  |   91366 K  |
|       from large pool |     247    |     691    |   46481 K  |   46481 K  |
|       from small pool |    2419    |    3627    |   44887 K  |   44885 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     562    |     563    |    1021    |     459    |
|       from large pool |     545    |     546    |     998    |     453    |
|       from small pool |      17    |      17    |      23    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     116    |    1247    |   52584 K  |   52584 K  |
|       from large pool |      95    |     363    |   32012 K  |   32012 K  |
|       from small pool |      21    |    1152    |   20572 K  |   20572 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  19412 MiB |   1396 TiB |   1396 TiB |
|       from large pool |  16640 KiB |  19382 MiB |   1387 TiB |   1387 TiB |
|       from small pool |      0 KiB |     32 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  19412 MiB |   1396 TiB |   1396 TiB |
|       from large pool |  16640 KiB |  19382 MiB |   1387 TiB |   1387 TiB |
|       from small pool |      0 KiB |     32 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  19358 MiB |   1392 TiB |   1392 TiB |
|       from large pool |  16640 KiB |  19328 MiB |   1382 TiB |   1382 TiB |
|       from small pool |      0 KiB |     31 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1880 MiB |  20106 MiB |  38310 MiB |  36430 MiB |
|       from large pool |   1860 MiB |  20072 MiB |  38264 MiB |  36404 MiB |
|       from small pool |     20 MiB |     34 MiB |     46 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 777243 KiB | 205312 GiB | 205312 GiB |
|       from large pool |  24320 KiB | 775200 KiB | 195178 GiB | 195178 GiB |
|       from small pool |      0 KiB |  20690 KiB |  10134 GiB |  10134 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3973    |   91369 K  |   91369 K  |
|       from large pool |       2    |     691    |   46481 K  |   46481 K  |
|       from small pool |       0    |    3627    |   44887 K  |   44887 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3973    |   91369 K  |   91369 K  |
|       from large pool |       2    |     691    |   46481 K  |   46481 K  |
|       from small pool |       0    |    3627    |   44887 K  |   44887 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     103    |     563    |    1021    |     918    |
|       from large pool |      93    |     546    |     998    |     905    |
|       from small pool |      10    |      17    |      23    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1247    |   52585 K  |   52585 K  |
|       from large pool |       3    |     363    |   32012 K  |   32012 K  |
|       from small pool |       0    |    1152    |   20573 K  |   20573 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul 28 09:34:18 2024]
Finished job 0.
1 of 1 steps (100%) done
