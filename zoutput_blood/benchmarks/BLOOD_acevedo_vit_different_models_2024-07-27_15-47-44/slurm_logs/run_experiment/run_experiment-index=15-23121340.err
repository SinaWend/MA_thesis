Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 12:39:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/15.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=15
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340

 Experiment start at: 2024-07-28 12:50:31.446427
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.12040859460830688
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9354666, 'precision': 0.85201526, 'recall': 0.80845964, 'specificity': 0.9929023, 'f1': 0.82359326, 'auroc': 0.9949405}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   341     0    1    14    4    1    33    13     3   26     47
1     0  1201    1    20    2    0     0    94     3    0     10
2     1     0  166     2   55    1     1     7     2   74      3
3     1     1    0  8102    2   15     2   213    97    3      1
4     1     0   21     2  320    1     2     5    16   23    148
5     1     0    0    52    1  333     0     0     1  132      1
6     9     0    0     6    4    2  1851     7     5    8     16
7     0     6    2   280    4    0     5  6907    39    8     14
8     0     0    7   194   62    5    10   129  2760   17    110
9     1     0   25    12    3   42     0     4     3  403      0
10    5     0    5     8  102    0    36    22    22   13  12580
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.93564266, 'precision': 0.8470315, 'recall': 0.8086337, 'specificity': 0.9929352, 'f1': 0.82236415, 'auroc': 0.9948796}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   363     0    1     7    3    1    24     9     4   19     52
1     0  1203    0    16    3    0     2    99     2    1      6
2     1     0  159     4   54    1     0     7     1   82      3
3     2     0    0  8101    2   10     2   211   109    3      0
4     1     0   17     0  323    1     5     6    12   29    145
5     0     0    1    51    0  334     0     0     3  131      1
6     7     0    0     7    1    2  1849     7     7   12     16
7     0     4    3   285    3    0     6  6899    43    4     18
8     4     0    8   195   55    4    13   122  2772   21    102
9     0     0   34    11    1   52     1     4     2  388      0
10   13     0    6     8  100    1    34    21    14   11  12588
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6769747, 'precision': 0.63905346, 'recall': 0.57448745, 'specificity': 0.96771437, 'f1': 0.57578903, 'auroc': 0.8805121}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   813    0    1   91    4    0    93    78    11   63    16
1     0  883    3   38    6    0     1   512     2    2    52
2     1    0  166   21  406   17     1    60   102  152    89
3     0    0    0    0    0    0     0     0     0    0     0
4     1    0    1    0  296    0     1     2     6    1  1325
5     1    0    0   93    1  317     0     0     2  176     2
6     0    0    0   21   32    0  2787     9    47    0   171
7     0    0    0   45    0    0     0  1115     0    2     2
8     0    0    4  161   14    4     1    20  1145   15     6
9     3    1  159  152   31   96     4    90    57  530    14
10    0    0    0    0   21    0     1     0     0    0  1624
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 13:36:46.493925,epoch time: 0:46:15.047498,used: 0:46:15.047498,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9461419, 'precision': 0.89467573, 'recall': 0.82925534, 'specificity': 0.9939728, 'f1': 0.8534957, 'auroc': 0.99696386}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   347     0    0     3    0    0    46     4     2    6     75
1     0  1246    1     8    0    0     1    67     3    0      6
2     0     0  172     0   23    3     2    11     1   87     13
3     3     0    0  7818    0   25    21   441   121    4      5
4     1     0   23     0  290    3     2     6    18   11    184
5     0     0    0    20    0  412     3     0     4   81      1
6     1     0    0     0    0    0  1873     4     3    1     25
7     1     5    1    72    1    0     5  7125    33    5     13
8     0     0    0    85    9    4     9   134  2965   11     79
9     0     0   11     3    0   68     3     4     3  396      5
10    3     0    1     7   16    1    15    11    21    1  12719
---- Validation: 
scalar performance:
{'acc': 0.94687706, 'precision': 0.89660937, 'recall': 0.8255948, 'specificity': 0.99403703, 'f1': 0.85239905, 'auroc': 0.9970483}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   342     0    0     2    0    0    46     4     0    6     83
1     0  1234    0     7    0    0     1    82     2    0      6
2     1     0  164     0   32    1     1    10     3   83     17
3     3     0    0  7864    0   16    21   409   123    1      3
4     1     0   16     2  298    1     2     5    14   14    186
5     1     0    0    24    0  406     2     0     4   83      1
6     0     0    0     0    0    0  1883     2     3    1     19
7     0     6    0    74    1    0     3  7137    26    3     15
8     0     1    4    84    7    8    13   149  2956    2     72
9     0     0   13     2    0   72     1     2     3  393      7
10    4     0    3     7    9    0    11    19    20    1  12722
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68914855, 'precision': 0.6551732, 'recall': 0.57599986, 'specificity': 0.96811056, 'f1': 0.56051624, 'auroc': 0.8866445}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   524     1   0  24    0    0   525    22     9   28    37
1     0  1127   0  34    1    0     0   274     5    2    56
2     1     0  95   6  181   18    30    42   247  110   285
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   1   0  171    0     1     2    18    0  1440
5     1     0   0  71    0  344    20     0     9  141     6
6     0     0   0   1    1    0  2996     3    12    0    54
7     0     1   0  20    0    0     3  1132     0    2     6
8     0     0   0  67    0    1    12    12  1271    5     2
9     1     3  46  67    8  137    31    81   178  549    36
10    0     0   0   0    4    0     0     0     1    0  1641
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 14:19:19.568449,epoch time: 0:42:33.074524,used: 1:28:48.122022,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.959573, 'precision': 0.8935615, 'recall': 0.88969684, 'specificity': 0.9957274, 'f1': 0.89011717, 'auroc': 0.9980831}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     1    0    0     3     3     4    3     19
1     0  1280    0    13    0    0     1    33     4    0      1
2     1     0  218     0   22    0     0     4     9   56      2
3     2     1    0  8140    1    7     1   138   144    5      0
4     5     0   32     0  381    1     1     3    24    7     85
5     0     0    0    18    0  409     0     0     4   89      1
6    26     0    1     1    1    0  1857     1     4    1     15
7     1     7    1   123    1    0     1  6995   123    4      7
8     1     1    4    64    8    3     0    42  3160    3     10
9     1     0   24     3    2   30     0     0     8  425      0
10   20     0    3     7   90    0     6    18    93    4  12550
---- Validation: 
scalar performance:
{'acc': 0.959663, 'precision': 0.8915164, 'recall': 0.88802016, 'specificity': 0.99573207, 'f1': 0.88856894, 'auroc': 0.99804544}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     2    2    0     4     1     1    1     23
1     0  1279    0    10    0    0     0    37     4    0      2
2     3     0  223     0   21    1     0     5     7   48      4
3     2     1    0  8144    0   11     1   139   141    1      0
4     5     0   38     1  379    1     0     2    24    3     86
5     1     0    1    19    1  398     0     0     5   95      1
6    21     0    2     4    0    0  1862     1     3    3     12
7     0     9    0   134    2    0     1  6999   115    2      3
8     1     0    2    62    8    2     1    41  3168    4      7
9     0     0   26     6    2   33     0     1     5  419      1
10   19     0    2     7  101    0     4    15    87    4  12557
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7544952, 'precision': 0.7001153, 'recall': 0.64333236, 'specificity': 0.97564226, 'f1': 0.6500361, 'auroc': 0.8893875}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1029     2    0   22    6    0    14    12    27   55     3
1      1  1217    0   30    3    0     0   216    11    5    16
2      2     0  259   23  231   19     1    31   295  104    50
3      0     0    0    0    0    0     0     0     0    0     0
4      2     1    6    0  626    0     1     1    31    1   964
5      0     0    0  115    1  335     0     0     4  136     1
6      4     4    2   10   10    0  2925     3    53    1    55
7      2     1    0  102    0    0     1  1051     1    2     4
8      1     0    0  153    0    0     0     5  1208    3     0
9      4    15   98  144    9  138     1    51   132  537     8
10     0     0    0    0   48    0     0     0     1    0  1597
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-28 15:01:40.855017,epoch time: 0:42:21.286568,used: 2:11:09.408590,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9643354, 'precision': 0.91789377, 'recall': 0.8715421, 'specificity': 0.9959566, 'f1': 0.8901331, 'auroc': 0.9985582}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    2     5    0    0     3     1     1    1     28
1     0  1280    0    13    0    0     0    34     3    0      1
2     3     0  213     0   13    4     1     6     1   66      5
3     0     0    0  8316    0    2     0    73    46    0      1
4     5     0   32     1  296    2     1     3    13    9    176
5     0     0    0    45    0  439     0     0     3   33      1
6    15     0    0     2    1    1  1852     2     2    2     29
7     0     7    0   143    1    0     4  7052    49    0      8
8     2     0    2   138    4    3     0    64  3026    3     54
9     1     0   16    10    0   70     0     0     3  391      2
10   10     0    4     8    9    1     1     9    14    2  12736
---- Validation: 
scalar performance:
{'acc': 0.9654139, 'precision': 0.92217606, 'recall': 0.8770804, 'specificity': 0.9960783, 'f1': 0.8949641, 'auroc': 0.998604}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     3    0    0     2     1     1    1     30
1     0  1280    0    13    0    0     0    38     1    0      0
2     1     0  213     1    9    3     0     8     3   68      6
3     1     0    0  8307    0    1     1    90    39    1      0
4     5     0   26     1  305    3     0     3    18   10    168
5     0     0    0    34    0  445     0     0     2   39      1
6    16     0    1     2    0    0  1856     2     2    2     27
7     0     7    1   148    1    0     0  7063    33    1     11
8     1     0    2   129    2    2     0    69  3043    3     45
9     0     0   13     6    0   69     0     1     2  402      0
10   12     0    4     9   13    1     3    10    11    0  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6722172, 'precision': 0.70366055, 'recall': 0.55940217, 'specificity': 0.9679774, 'f1': 0.5766478, 'auroc': 0.8811859}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   982     2    0   97    1    1     3   29    18   28     9
1     1  1169    2   49    0    0     0  250     6    0    22
2     7     0  336  114   27   13     0   19   269   85   145
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1   11    0  181    0     1    2    28    0  1409
5     1     0    1  344    0  195     0    0     1   50     0
6     4     0    2   48    0    0  2784    5    69    0   155
7     0     0    0  244    0    0     0  915     2    0     3
8     0     0    1  269    0    0     1    3  1093    1     2
9     4     7   95  448    0  105     1   42   106  312    17
10    0     0    0    0    4    0     0    0     1    0  1641
better model found
persisted
after epoch: 4,now: 2024-07-28 15:44:42.359333,epoch time: 0:43:01.504316,used: 2:54:10.912906,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96944565, 'precision': 0.92922163, 'recall': 0.8841388, 'specificity': 0.99662507, 'f1': 0.90415025, 'auroc': 0.9988346}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     1    0    0     9     1     2    1     33
1     0  1288    0     6    0    0     1    30     7    0      0
2     3     0  200     0   49    2     1     2    12   38      5
3     0     1    0  8299    0    2     1    57    77    1      0
4     3     0    4     1  369    0     1     1    27    1    132
5     1     0    0    35    0  435     1     0     4   44      1
6     2     0    0     0    0    0  1890     2     3    2      8
7     0     4    0   149    1    0     5  7028    70    1      7
8     0     0    0    70    5    0     0    31  3175    0     14
9     3     0   25     5    3   50     2     2     8  392      3
10    5     0    1     7   12    1    10     6    27    0  12722
---- Validation: 
scalar performance:
{'acc': 0.96870404, 'precision': 0.92692703, 'recall': 0.8802927, 'specificity': 0.9965532, 'f1': 0.9009702, 'auroc': 0.99883014}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    0     2    3    0    12     2     1    0     36
1     0  1296    0     7    0    0     0    27     2    0      0
2     2     0  198     1   57    2     1     6     7   36      2
3     0     1    0  8294    0    1     1    54    89    0      0
4     5     0    4     2  367    0     1     1    23    2    134
5     1     0    0    34    0  440     0     0     9   36      1
6     4     0    0     1    1    0  1883     0     8    1     10
7     2     9    0   151    1    0     5  7016    77    0      4
8     0     0    1    57    3    0     0    29  3189    1     16
9     3     0   24    11    4   55     4     2    10  379      1
10    5     0    0     9   10    0     8     6    31    1  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7041209, 'precision': 0.6393152, 'recall': 0.58622974, 'specificity': 0.970407, 'f1': 0.57914925, 'auroc': 0.87797356}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1029     0    0   23    2    0    64    5    10   16    21
1      0  1202    1   29    1    0     2  218    12    2    32
2      6     0  112   27  283   13    17   16   311   56   174
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    0    0  123    0     2    0    30    0  1478
5      6     0    0  186    3  288     4    0     8   92     5
6      0     0    0    3    1    0  3033    2    14    0    14
7      0     2    1  186    0    1     3  956     8    1     6
8      0     0    0   97    1    0     6    1  1263    1     1
9      8     7  124  147   22  111    16   27   222  414    39
10     0     0    0    0    0    0     1    0     1    0  1644
better model found
persisted
after epoch: 5,now: 2024-07-28 16:28:05.403509,epoch time: 0:43:23.044176,used: 3:37:33.957082,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97008777, 'precision': 0.93481314, 'recall': 0.8958045, 'specificity': 0.99671876, 'f1': 0.9105704, 'auroc': 0.99919176}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     2    0    0    10     2     2    1      7
1     0  1317    0     2    0    0     0    11     2    0      0
2     2     1  205     1   23    1     0    15     3   52      9
3     0     8    0  8115    0    2     1   151   160    2      0
4     6     0    8     1  339    0     1     8    16    2    158
5     1     0    0    13    1  444     0     0     5   56      1
6     6     0    1     2    0    0  1886     1     3    0      7
7     2    24    0    58    1    0     1  7120    50    1      6
8     1     1    0    14    3    0     1    37  3208    1     29
9     4     0   12     1    0   31     2     4     6  432      1
10   21     0    1     7    1    0     8     8    14    0  12733
---- Validation: 
scalar performance:
{'acc': 0.9706567, 'precision': 0.93640876, 'recall': 0.8962039, 'specificity': 0.996778, 'f1': 0.9109101, 'auroc': 0.9992336}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    0    0     8     2     1    0      5
1     0  1314    0     1    0    0     0    15     2    0      0
2     3     0  198     1   23    0     0    13     7   60      7
3     0     4    0  8132    0    9     0   143   152    0      0
4     7     0    7     1  339    0     2     3    18    2    160
5     0     0    0    11    0  436     0     0    11   62      1
6     3     0    1     2    0    1  1889     1     3    0      8
7     0    11    0    63    1    0     1  7130    51    1      7
8     1     1    0    17    2    0     0    34  3211    1     29
9     1     1   12     0    0   26     1     3     4  444      1
10   19     1    1     6    2    0    11     9    19    0  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7444903, 'precision': 0.67661977, 'recall': 0.6200758, 'specificity': 0.9741549, 'f1': 0.6081602, 'auroc': 0.8876926}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   992     2    0   8    2    0   110    26     7   18     5
1     0  1347    0  12    0    0     1   120     5    1    13
2     7     2  141  15  273   11    23    56   266  109   112
3     0     0    0   0    0    0     0     0     0    0     0
4     0     3    2   0  266    0     3     2    17    0  1340
5     1     0    0  72    0  217     6     0    22  273     1
6     0     0    0   1    1    0  3038     3     8    0    16
7     0     4    0  50    0    0     3  1098     4    1     4
8     0     0    1  22    1    0     8     6  1328    3     1
9     4    17   56  76   11   62    10    93   209  580    19
10    0     0    0   0   10    0     1     0     1    0  1634
better model found
persisted
after epoch: 6,now: 2024-07-28 17:10:42.526817,epoch time: 0:42:37.123308,used: 4:20:11.080390,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97717786, 'precision': 0.940772, 'recall': 0.9241352, 'specificity': 0.99754214, 'f1': 0.92967147, 'auroc': 0.9995022}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     0    0    0    12     0     0    1     12
1     0  1307    0     3    0    0     0    18     3    0      1
2     2     0  235     0   28    0     1     1     1   42      2
3     2     2    0  8305    0    6     1    75    47    2      0
4     4     0    5     0  470    2     2     0     5    0     51
5     2     0    0    17    0  395     0     0     4  102      1
6     1     0    0     0    1    0  1903     0     0    0      3
7     0     9    0    86    1    0     4  7128    21    3     11
8     1     0    2    58    8    1     3    45  3147    1     30
9     3     0   13     0    1    8     2     0     1  464      1
10    5     0    0     7   33    1    21     2     8    1  12711
---- Validation: 
scalar performance:
{'acc': 0.97707635, 'precision': 0.94080734, 'recall': 0.92720854, 'specificity': 0.9975299, 'f1': 0.9312173, 'auroc': 0.9995345}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     0    0    0    13     2     0    1     18
1     0  1318    0     2    0    0     0    11     1    0      0
2     1     0  249     0   26    0     2     1     2   26      5
3     2     2    0  8301    0    3     0    80    48    3      1
4     5     0    4     0  465    1     2     0     3    1     58
5     2     0    0    12    1  394     0     0     2  109      1
6     1     0    0     0    1    0  1903     0     0    1      2
7     0     8    0    76    2    0     3  7146    20    3      7
8     3     0    2    57    9    0     3    46  3143    3     30
9     1     0   14     1    0    3     2     0     1  470      1
10    6     0    1     7   51    0    31     2     7    1  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77436507, 'precision': 0.7027259, 'recall': 0.65469503, 'specificity': 0.9773246, 'f1': 0.6584056, 'auroc': 0.88952845}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1047     0    0   16    3    0    74    11     2   14     3
1      0  1315    0   25    3    0     2   108    10    8    28
2     16     0  181   23  343   17    39    17   217  103    59
3      0     0    0    0    0    0     0     0     0    0     0
4      0     1    3    0  655    0    11     1    21    0   941
5      9     0    0   79    1  310     2     0     8  182     1
6      0     0    0    2    1    0  3036     2    14    0    12
7      0     1    3   93    0    0     8  1047     3    3     6
8      0     0    1   71    1    1    12     2  1275    6     1
9     13     7   95  100   14  126    13    17   110  620    22
10     0     0    0    0   60    0     3     0     1    0  1582
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-28 17:52:49.140152,epoch time: 0:42:06.613335,used: 5:02:17.693725,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9705694, 'precision': 0.926896, 'recall': 0.9448688, 'specificity': 0.9969083, 'f1': 0.93298167, 'auroc': 0.9995019}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0   11    0     1     3     0    1     10
1     0  1315    0     3    0    0     0    14     0    0      0
2     0     0  257     0   28    1     0     2     0   24      0
3     0     1    1  8025    3   17     0   314    74    3      1
4     1     0    6     0  507    0     0     1     2    1     21
5     0     0    0     3    0  505     0     0     3   10      0
6     6     0    0     0    2    2  1887     2     1    1      6
7     0    11    0    20    3    0     2  7204    14    3      7
8     1     1    4    16   38    1     1    96  3113    1     23
9     0     0   16     0    1   49     0     0     0  427      0
10    4     0    1     5  183    1     9     6     2    1  12579
---- Validation: 
scalar performance:
{'acc': 0.9703624, 'precision': 0.9274166, 'recall': 0.94407886, 'specificity': 0.99688613, 'f1': 0.93256557, 'auroc': 0.999518}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    7    1     6     3     0    0      9
1     0  1315    0     2    0    0     0    15     0    0      0
2     0     0  255     0   28    2     0     1     0   26      0
3     0     2    0  8021    2   15     0   307    88    5      0
4     0     0    4     0  509    0     0     0     2    2     22
5     0     0    0     5    0  504     0     0     0   11      1
6     2     0    0     0    3    0  1894     2     1    1      5
7     0     5    2    21    3    0     2  7214     8    2      8
8     0     1    4    14   38    0     0   102  3111    1     25
9     0     1   18     0    1   48     0     0     0  425      0
10    2     0    0     6  201    2     3     5     4    0  12573
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7829007, 'precision': 0.69925606, 'recall': 0.671723, 'specificity': 0.9783546, 'f1': 0.670617, 'auroc': 0.8897356}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   979     0    0  30    8   13    36    53     4   45     2
1     0  1268    1  22    4    0     0   182     2    3    17
2     0     0  251  13  410   44     6    35   125   96    35
3     0     0    0   0    0    0     0     0     0    0     0
4     0     2    4   0  876    0     6     1    10    0   734
5     0     0    3  80    3  421     0     0     7   77     1
6     1     3    2   6   12    0  3011     5    12    0    15
7     0     2    1  30    0    1     1  1123     0    2     4
8     0     0    1  74    8    0     4    27  1245   11     0
9     2     5  152  91   19  230     0    92    51  483    12
10    0     0    0   0  110    0     2     0     1    0  1533
new oracle model saved
early stop counter: 1
val acc:0.9703624248504639, best validation acc: 0.9770763516426086, corresponding to test acc:                         0.7743650674819946 / 0.7829006910324097
after epoch: 8,now: 2024-07-28 18:34:33.528703,epoch time: 0:41:44.388551,used: 5:44:02.082276,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98022795, 'precision': 0.9438091, 'recall': 0.93007797, 'specificity': 0.99791235, 'f1': 0.93189, 'auroc': 0.999695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     2    3    2     2     0     0    1      5
1     0  1322    0     1    0    0     0     7     1    0      1
2     0     0  257     0   24    4     0     1     2   23      1
3     0     0    0  8372    0    5     0    26    30    1      0
4     1     0    3     0  492    0     2     0     6    0     35
5     0     0    0     5    0  514     0     0     1    1      0
6     1     0    0     1    0    1  1897     1     2    0      5
7     0     7    0   134    6    0     3  7064    43    0      7
8     1     0    0    47    3    6     2     7  3214    0     16
9     0     0   10     2    0  177     0     0     0  304      0
10    4     0    0     7   34    1     6     2     7    0  12733
---- Validation: 
scalar performance:
{'acc': 0.9800722, 'precision': 0.9485046, 'recall': 0.93286175, 'specificity': 0.99787426, 'f1': 0.9361327, 'auroc': 0.9996904}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    3    0     5     0     0    2      8
1     0  1315    0     3    0    1     0    12     1    0      0
2     0     0  266     0   21    4     0     3     0   16      2
3     1     0    0  8381    0    5     0    24    29    0      0
4     3     0    1     0  492    0     2     0     6    1     34
5     0     0    0     6    0  514     0     0     0    1      0
6     2     0    0     1    0    1  1900     0     0    0      4
7     1     6    0   154    1    0     2  7042    51    1      7
8     3     0    1    54    1    3     1    12  3205    2     14
9     0     0    6     3    3  167     0     0     1  313      0
10    5     0    0     7   23    1     6     1     5    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70517033, 'precision': 0.67164147, 'recall': 0.59496516, 'specificity': 0.97082734, 'f1': 0.5894003, 'auroc': 0.882022}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   876     0    0   44    2   46    84   19     9   76    14
1     1  1382    0   26    3    6     5   47     7    5    17
2     3     0  119   41  289   70    15    3   283   83   109
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1    1    0  275    0     3    0    34    1  1318
5     0     0    0   94    2  457     0    0     0   39     0
6     1     0    0    5    1    1  3029    2    10    0    18
7     0     2    0  394    0    1    13  735    11    3     5
8     0     0    0  159    2    6     7    0  1190    5     1
9     2     5   48  204   10  361     8   16    78  382    23
10    0     0    0    0    9    0     1    0     2    0  1634
better model found
persisted
after epoch: 9,now: 2024-07-28 19:16:34.832440,epoch time: 0:42:01.303737,used: 6:26:03.386013,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97814107, 'precision': 0.95100945, 'recall': 0.9582824, 'specificity': 0.9976368, 'f1': 0.9537879, 'auroc': 0.9997209}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     2    5    0     0     0     1    0      3
1     0  1289    0     7    0    0     0    35     1    0      0
2     1     0  294     1    5    1     0     0     1    8      1
3     0     0    0  8422    0    0     0    12     4    0      0
4     3     0    9     1  504    0     0     0    10    0     12
5     0     0    0    13    0  491     0     0     0   17      0
6     1     0    0     3    0    0  1898     0     1    0      5
7     1     2    1   215    2    0     0  7004    35    0      3
8     1     0    0   126    6    0     0     9  3151    0      2
9     1     0   17    12    1   25     0     0     4  431      0
10   12     0    1    10  122    0     4     5    37    0  12603
---- Validation: 
scalar performance:
{'acc': 0.97972447, 'precision': 0.9550191, 'recall': 0.96248746, 'specificity': 0.9978053, 'f1': 0.95782983, 'auroc': 0.9997373}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    3    0     0     0     0    0      3
1     0  1291    0    11    0    0     0    29     1    0      0
2     0     0  294     3    4    0     0     0     2    8      1
3     0     0    0  8421    0    1     0    14     4    0      0
4     3     0    5     0  515    0     1     1     6    0      8
5     0     0    0    12    0  494     0     0     2   13      0
6     1     0    0     1    0    0  1902     0     1    1      2
7     0     1    0   224    1    0     2  7008    24    0      5
8     1     0    0   104    7    0     0     5  3174    1      4
9     0     0   17    12    0   28     0     0     3  433      0
10    7     0    1     8  121    2     3     1    34    0  12619
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69005805, 'precision': 0.69357467, 'recall': 0.55647147, 'specificity': 0.96981287, 'f1': 0.57565224, 'auroc': 0.8755471}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   954     1    0   77    1    0    29   60    28   17     3
1     1  1187    0   48    1    0     1  229    17    4    11
2    14     2  115  115  119   17    11   15   490   74    43
3     0     0    0    0    0    0     0    0     0    0     0
4     1     4    6    0  658    0     5    1    88    1   869
5     1     0    0  350    1  153     0    0     3   84     0
6     6     0    0   19    2    0  2939    4    84    0    13
7     0     0    0  279    0    0     1  874     4    2     4
8     0     0    0  203    0    0     3    3  1160    1     0
9     3     6   18  551    4   87     6   29   143  279    11
10    0     1    0    0   91    0     1    1     8    0  1544
early stop counter: 1
val acc:0.9797244668006897, best validation acc: 0.9800722002983093, corresponding to test acc:                         0.7051703333854675 / 0.7829006910324097
after epoch: 10,now: 2024-07-28 19:57:53.859906,epoch time: 0:41:19.027466,used: 7:07:22.413479,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:07:22.413479 at 2024-07-28 19:57:53.859906
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70517033, 'precision': 0.67164147, 'recall': 0.59496516, 'specificity': 0.97082734, 'f1': 0.5894003, 'auroc': 0.882022}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   876     0    0   44    2   46    84   19     9   76    14
1     1  1382    0   26    3    6     5   47     7    5    17
2     3     0  119   41  289   70    15    3   283   83   109
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1    1    0  275    0     3    0    34    1  1318
5     0     0    0   94    2  457     0    0     0   39     0
6     1     0    0    5    1    1  3029    2    10    0    18
7     0     2    0  394    0    1    13  735    11    3     5
8     0     0    0  159    2    6     7    0  1190    5     1
9     2     5   48  204   10  361     8   16    78  382    23
10    0     0    0    0    9    0     1    0     2    0  1634
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7829007, 'precision': 0.69925606, 'recall': 0.671723, 'specificity': 0.9783546, 'f1': 0.670617, 'auroc': 0.8897356}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   979     0    0  30    8   13    36    53     4   45     2
1     0  1268    1  22    4    0     0   182     2    3    17
2     0     0  251  13  410   44     6    35   125   96    35
3     0     0    0   0    0    0     0     0     0    0     0
4     0     2    4   0  876    0     6     1    10    0   734
5     0     0    3  80    3  421     0     0     7   77     1
6     1     3    2   6   12    0  3011     5    12    0    15
7     0     2    1  30    0    1     1  1123     0    2     4
8     0     0    1  74    8    0     4    27  1245   11     0
9     2     5  152  91   19  230     0    92    51  483    12
10    0     0    0   0  110    0     2     0     1    0  1533
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_12_50_30_seed_0_23121340_instance_wise_predictions.txt
accuracy from prediction file 0.7051703631148114
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/15.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB | 414139 GiB | 414138 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411234 GiB | 411232 GiB |
|       from small pool |      7 MiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB | 414139 GiB | 414138 GiB |
|       from large pool |   1648 MiB |  15835 MiB | 411234 GiB | 411232 GiB |
|       from small pool |      7 MiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB | 412574 GiB | 412572 GiB |
|       from large pool |   1647 MiB |  15791 MiB | 409672 GiB | 409670 GiB |
|       from small pool |      6 MiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  16520 MiB |      0 B   |
|       from large pool |  16492 MiB |  16492 MiB |  16492 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 235584 KiB | 630847 KiB |  63128 GiB |  63128 GiB |
|       from large pool | 216320 KiB | 628608 KiB |  60199 GiB |  60199 GiB |
|       from small pool |  19264 KiB |  23295 KiB |   2929 GiB |   2929 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   30138 K  |   30136 K  |
|       from large pool |     247    |     595    |   13397 K  |   13397 K  |
|       from small pool |    2399    |    3599    |   16741 K  |   16738 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   30138 K  |   30136 K  |
|       from large pool |     247    |     595    |   13397 K  |   13397 K  |
|       from small pool |    2399    |    3599    |   16741 K  |   16738 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     467    |       0    |
|       from large pool |     453    |     453    |     453    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     119    |     568    |   16934 K  |   16933 K  |
|       from large pool |      95    |     303    |    8723 K  |    8723 K  |
|       from small pool |      24    |     459    |    8210 K  |    8210 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414139 GiB | 414139 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414139 GiB | 414139 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412574 GiB | 412574 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409672 GiB | 409672 GiB |
|       from small pool |      0 KiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630847 KiB |  63129 GiB |  63129 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60200 GiB |  60200 GiB |
|       from small pool |      0 KiB |  25462 KiB |   2929 GiB |   2929 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30138 K  |   30138 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3599    |   16741 K  |   16741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30138 K  |   30138 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3599    |   16741 K  |   16741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     568    |   16934 K  |   16934 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |     459    |    8210 K  |    8210 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB | 414139 GiB | 414139 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB | 414139 GiB | 414139 GiB |
|       from large pool |  16640 KiB |  15835 MiB | 411234 GiB | 411234 GiB |
|       from small pool |      0 KiB |     26 MiB |   2905 GiB |   2905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB | 412574 GiB | 412574 GiB |
|       from large pool |  16640 KiB |  15791 MiB | 409672 GiB | 409672 GiB |
|       from small pool |      0 KiB |     26 MiB |   2901 GiB |   2901 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1886 MiB |  16520 MiB |  16520 MiB |  14634 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  16492 MiB |  14632 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630847 KiB |  63129 GiB |  63129 GiB |
|       from large pool |  24320 KiB | 628608 KiB |  60200 GiB |  60200 GiB |
|       from small pool |      0 KiB |  25462 KiB |   2929 GiB |   2929 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   30138 K  |   30138 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3599    |   16741 K  |   16741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   30138 K  |   30138 K  |
|       from large pool |       2    |     595    |   13397 K  |   13397 K  |
|       from small pool |       0    |    3599    |   16741 K  |   16741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     106    |     467    |     467    |     361    |
|       from large pool |      93    |     453    |     453    |     360    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     568    |   16934 K  |   16934 K  |
|       from large pool |       3    |     303    |    8723 K  |    8723 K  |
|       from small pool |       0    |     459    |    8210 K  |    8210 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340

 Experiment start at: 2024-07-28 20:15:27.322841
before training, model accuracy: 0.09417197853326797
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9307042, 'precision': 0.84542614, 'recall': 0.8030419, 'specificity': 0.99240065, 'f1': 0.8180829, 'auroc': 0.99485385}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   336     0    1     5    1    1    51    18    10    4     56
1     0  1253    0    13    0    0     0    59     1    0      6
2     1     0  224     1   34    3     1    14     5   23      6
3     0     1    1  7567    0   16     1   684   162    5      1
4     2     0   34     0  296    2     8    14    22    6    155
5     0     0   11    33    0  393     1     2     9   71      1
6     8     1    1    10    2    0  1839    16    10    3     18
7     0    15    2    59    2    0     2  7114    48    0     19
8     1     1    8    90   19    1     5   184  2910    0     76
9     2     0  132     7    2   91     7     7    11  229      4
10    3     3    3     4   56    0    31    30    38    2  12625
---- Validation: 
scalar performance:
{'acc': 0.9304534, 'precision': 0.84496987, 'recall': 0.8019553, 'specificity': 0.9923647, 'f1': 0.8176537, 'auroc': 0.9951297}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   331     0    1     3    1    0    47    17     6    4     73
1     0  1258    0    11    0    0     0    56     3    0      4
2     0     0  214     0   39    1     2    13     5   28     10
3     1     0    1  7559    1   13     0   712   149    3      1
4     1     0   39     0  277    3     6    14    23    5    171
5     0     0   12    34    0  398     1     0    10   65      1
6     5     1    2     7    1    0  1856    10     8    2     16
7     0    15    2    63    2    1     4  7117    50    0     11
8     3     3    8    80   22    8     4   194  2920    1     53
9     1     0  119     6    0   88     4     6    10  251      8
10    2     0    5     6   68    1    33    37    38    2  12604
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6907577, 'precision': 0.61139286, 'recall': 0.5596204, 'specificity': 0.96836394, 'f1': 0.54441357, 'auroc': 0.87819}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   747    21    0   71    0    0   270    32     6    6    17
1     0  1357    0   23    0    0     2    85     5    0    27
2     2    28   57    5  306    2    88    61   215   37   214
3     0     0    0    0    0    0     0     0     0    0     0
4     0     2    0    0  212    0    20     2    11    0  1386
5    12     0    3  100    1  197    48     1    56  171     3
6     0     8    0    1    1    0  3028     4     3    0    22
7     0     3    0   33    0    0     1  1122     1    0     4
8     0     3    0   74    6    0    18    19  1238    2    10
9    13    74  162   48   29   32    85   113   268  276    37
10    0     1    0    0    5    0     1     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 20:58:38.071923,epoch time: 0:43:10.749082,used: 0:43:10.749082,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.936082, 'precision': 0.86645925, 'recall': 0.81493425, 'specificity': 0.9933404, 'f1': 0.81744653, 'auroc': 0.99683225}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   436     0   0     5    1    0     2     1     9    1     28
1     0  1216   0    13    0    0     0    70    24    0      8
2     2     0  60     1  101    0     1     2    27  117      1
3     2     0   0  7898    0    9     2    96   430    0      1
4     5     0   1     0  367    1     0     1    38   10    116
5     1     0   0    31    0  430     0     0    20   38      1
6    27     0   0     6    3    1  1834     3    12    3     18
7     5     4   0   152    4    0     1  6552   526    1     19
8     1     0   0    32    9    0     0    11  3226    1     16
9     1     0   4     6    0  115     0     1    28  337      1
10   15     1   1     6   70    0     6     2    56    4  12631
---- Validation: 
scalar performance:
{'acc': 0.9337435, 'precision': 0.86867654, 'recall': 0.8138495, 'specificity': 0.99307716, 'f1': 0.81748843, 'auroc': 0.99700916}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   431     0   0     4    1    0     2     3    13    4     25
1     0  1215   0    18    0    0     0    72    21    0      6
2     3     0  68     1   92    1     0     3    30  114      0
3     0     0   0  7875    0    8     0   116   438    0      3
4     4     0   0     0  366    1     0     2    39    8    119
5     2     0   0    31    0  432     0     0    19   36      1
6    29     0   0     2    3    1  1832     1    14    4     22
7     1     4   0   158    2    0     3  6552   524    3     18
8     2     0   0    34   10    1     0    14  3205    1     29
9     3     0   2     7    3  123     0     1    23  330      1
10   19     0   0     7   81    1     6     9    69    2  12602
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71615475, 'precision': 0.7052855, 'recall': 0.59676135, 'specificity': 0.97160274, 'f1': 0.58183426, 'auroc': 0.88394994}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1049     1   0   62    3    1     2    6    37    6     3
1      1  1220   0   31    0    0     0  165    36    0    46
2      8     0   1    7  381   11     1    9   437   86    74
3      0     0   0    0    0    0     0    0     0    0     0
4      3     0   0    0  410    0     1    0    18    1  1200
5     10     0   0  144    4  311     0    0    52   68     3
6      0     2   0    9    5    0  2954    2    60    0    35
7      0     0   0  105    0    1     0  981    72    0     5
8      0     0   0   46    3    1     0    0  1317    1     2
9     14     4   0   95   42   97     1   16   491  362    15
10     0     0   0    0   15    0     0    0     0    0  1631
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 21:40:13.125145,epoch time: 0:41:35.053222,used: 1:24:45.802304,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9386505, 'precision': 0.8971095, 'recall': 0.8300171, 'specificity': 0.99310505, 'f1': 0.8563031, 'auroc': 0.9972056}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0    13    2    0    13     7     5    4     17
1     0  1254    0    24    0    0     0    50     3    0      1
2     0     0  161     4   41    2     2    24     5   73      0
3     0     0    0  8377    0    3     0    40    17    0      0
4     4     0   10     2  336    1     3    14    38   10    121
5     0     0    1    90    0  346     0     0     4   79      1
6     4     0    0    12    1    0  1864     1    10    2     14
7     0     4    0   663    1    0     1  6574    14    0      4
8     1     0    0   378    3    0     0   121  2776    4     13
9     0     0   12    23    2   44     0     8     4  400      0
10   22     0    2    10   50    0    28    40    66    3  12573
---- Validation: 
scalar performance:
{'acc': 0.9371673, 'precision': 0.8945158, 'recall': 0.82586014, 'specificity': 0.9929326, 'f1': 0.8539714, 'auroc': 0.9973391}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    0    24    0    1    22     6     4    3     22
1     0  1244    0    31    0    0     0    56     1    0      0
2     1     0  163     7   42    2     3    18     9   66      1
3     0     1    0  8375    0    2     0    41    20    1      0
4     3     1   17     3  335    0     1    10    44    6    119
5     0     0    0    86    0  356     1     0     5   72      1
6     4     0    0    13    1    0  1865     1     9    3     12
7     0     4    0   667    1    0     1  6568    20    0      4
8     1     0    0   396    6    0     0   126  2751    1     15
9     1     0   13    25    1   48     0     6     4  395      0
10   15     1    1    12   60    2    18    39    64    1  12583
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66340166, 'precision': 0.6352413, 'recall': 0.53351927, 'specificity': 0.9663833, 'f1': 0.5302084, 'auroc': 0.879883}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   777     3   0   94    0    0   256   26     3    7     4
1     0  1263   0   58    0    0     1  168     0    0     9
2     1    15  40   31  234    4    42  123   302   64   159
3     0     0   0    0    0    0     0    0     0    0     0
4     1     2   1    0  136    0     7    3    19    1  1463
5     2     0   1  240    2  201    16    1    18  109     2
6     0     1   0   15    0    0  3035    3     5    0     8
7     0     0   0  218    0    0     0  943     0    0     3
8     0     0   0  209    0    0     3   25  1129    0     4
9     4    25  31  304   17   52    27  177   167  318    15
10    0     2   0    0    4    0     0    0     0    0  1640
better model found
persisted
after epoch: 3,now: 2024-07-28 22:21:09.546356,epoch time: 0:40:56.421211,used: 2:05:42.223515,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96174014, 'precision': 0.884256, 'recall': 0.89546615, 'specificity': 0.9959529, 'f1': 0.8874184, 'auroc': 0.9983968}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     1    0     3    2    0     0     2     1    2     15
1     0  1320    0     6    0    0     0     3     2    0      0
2     4     0  235     2   50    1     0     3     2   14      1
3     1     6    0  8236    0   10     0   136    49    0      0
4     4     1    8     0  448    1     0     5     6    1     65
5     0     0    3    14    1  455     0     0     5   42      1
6    13     6    1     0    5    0  1864     2     1    2     13
7     1   115    3    91    2    0     1  7006    34    1     10
8     0    12    3   125   35    4     0    79  2989    0     48
9     2     0   95     2    8   66     0     3     0  317      0
10   17     6    0     8  118    1     5     7    11    1  12619
---- Validation: 
scalar performance:
{'acc': 0.9609469, 'precision': 0.88143647, 'recall': 0.89385337, 'specificity': 0.99586785, 'f1': 0.88530713, 'auroc': 0.9985275}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     1    0     1    3    0     4     1     0    1     19
1     0  1319    0     4    0    0     0     8     1    0      0
2     4     0  240     0   50    2     0     2     1   13      0
3     1     7    0  8227    0   18     0   126    60    0      1
4     4     1   10     0  449    1     0     3     6    1     64
5     0     0    5    18    0  443     1     0     5   48      1
6    11     2    1     3    5    0  1864     4     0    1     17
7     1   113    2   108    3    0     1  7005    26    1      5
8     5    10    2   140   31    5     0    69  2988    1     45
9     6     0   92     3    7   65     0     1     2  317      0
10   14     5    1     9  122    0     4     7    11    3  12620
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.754985, 'precision': 0.6670358, 'recall': 0.6353462, 'specificity': 0.9753777, 'f1': 0.63555753, 'auroc': 0.88494486}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1045     7    0   14    5    2    47    8     3   12    27
1      0  1411    0   19    1    1     0   53     3    2     9
2      4     2  148    2  544   12     8   13   156   46    80
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    3    0  566    0     1    0     6    0  1057
5      8     0    3   39   13  360    12    0    16  136     5
6      1     2    1    2    2    0  3040    2     2    1    14
7      0     5    2  190    0    1     0  948    12    0     6
8      0     2    2   50   13    6     9    0  1280    1     7
9     15    20  269   43   58  127     9   23   173  379    21
10     0     1    0    0   30    0     0    0     1    0  1614
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 23:02:57.544953,epoch time: 0:41:47.998597,used: 2:47:30.222112,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.967332, 'precision': 0.9131748, 'recall': 0.90018785, 'specificity': 0.9964988, 'f1': 0.9040895, 'auroc': 0.99888337}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     5    3    0     5     3     2    1     12
1     0  1291    0     6    0    0     0    33     1    0      1
2     1     0  239     2   31    4     0     7     8   19      1
3     0     0    0  8365    0    3     0    43    28    0      0
4     5     0   14     0  442    2     0     1    28    2     45
5     0     0    0    30    0  474     0     0     4   12      1
6     9     0    1     7    0    1  1866     2     6    1     14
7     0     8    0   160    1    0     1  7071    18    0      3
8     2     1    1   133    3    0     0    85  3065    0      6
9     3     0   37    10    0  115     0     4     6  318      0
10   15     1    1     9  110    2     6    23    53    0  12572
---- Validation: 
scalar performance:
{'acc': 0.9669386, 'precision': 0.9130406, 'recall': 0.9011071, 'specificity': 0.9964278, 'f1': 0.9048232, 'auroc': 0.99892586}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     4    3    0     4     4     0    0     13
1     0  1281    0     9    0    0     0    39     3    0      0
2     0     0  245     0   27    3     0     9     3   25      0
3     0     0    0  8361    0    3     0    48    27    1      0
4     5     0   18     0  429    3     0     4    25    1     54
5     0     0    1    25    0  482     0     0     3    9      1
6    11     0    0     6    1    0  1866     2     7    3     12
7     0     5    0   177    1    0     1  7068    10    0      3
8     0     0    5   146    1    2     0    91  3042    0      9
9     2     0   45     7    0  111     0     2     4  322      0
10    9     0    1    12   99    2     2    27    46    0  12598
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72993773, 'precision': 0.67673016, 'recall': 0.612741, 'specificity': 0.97318995, 'f1': 0.59786785, 'auroc': 0.88580316}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1026     1    0   46    2    9    25    43     6    7     5
1      0  1211    0   32    0    0     0   243     2    0    11
2      1     4  124   16  198   43     6    86   412   28    97
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    0  553    0     3     4    33    0  1038
5      5     0    2  159    2  378     8     0    17   21     0
6      0     0    0    4    0    0  3044     5     8    0     6
7      0     0    0   81    0    0     0  1081     1    0     1
8      0     0    0  119    0    0     3    20  1228    0     0
9      8     7   84  174   12  209     9   192   236  192    14
10     0     1    0    0   47    0     0     0     2    0  1596
better model found
persisted
after epoch: 5,now: 2024-07-28 23:44:36.260601,epoch time: 0:41:38.715648,used: 3:29:08.937760,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96936536, 'precision': 0.9148206, 'recall': 0.90481573, 'specificity': 0.9966782, 'f1': 0.9048599, 'auroc': 0.9991081}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    1     4    0    1     3     3     2    2     20
1     0  1317    0     5    0    0     0     8     1    0      0
2     0     0  266     0    0    1     0     1     1   43      0
3     2     1    1  8222    0    4     3   152    53    1      0
4     3     0  101     0  315    1     0     4    14    7     93
5     0     0    1    22    0  442     0     0     3   52      1
6     5     0    1     2    1    0  1879     3     2    4     11
7     0    23    4    66    0    0     2  7159     5    1      4
8     1     1   13    73    4    2     0   106  3069    1     25
9     0     0   16     6    0   31     0     2     2  436      0
10    7     0   20     5   31    0     7    14    27    2  12679
---- Validation: 
scalar performance:
{'acc': 0.9703624, 'precision': 0.9164986, 'recall': 0.9081951, 'specificity': 0.99679226, 'f1': 0.9075311, 'auroc': 0.9990709}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    2     4    1    0     2     2     0    2     12
1     0  1316    0     3    0    0     0    10     1    0      2
2     1     0  264     0    0    0     2     0     1   44      0
3     0     5    1  8231    0    5     1   149    47    1      0
4     5     0  102     1  323    1     1     4    11    8     83
5     0     0    0    17    0  448     0     0     2   53      1
6     5     0    0     1    0    0  1886     3     3    2      8
7     0    22    2    65    0    0     1  7158    10    1      6
8     0     1   15    77    4    1     0   103  3062    1     32
9     0     0   19     5    0   34     0     1     1  433      0
10    4     0   18     6   26    1     4    12    25    2  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7528161, 'precision': 0.70233214, 'recall': 0.64402145, 'specificity': 0.97515684, 'f1': 0.64365715, 'auroc': 0.88687086}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   998     0    1   24    1    2    50    30     2   38    24
1     0  1313    1   30    0    0     1   126     2    3    23
2     0     1  355    8  135   12    26    39   152  105   182
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    5    0  227    0     3     2    11    1  1384
5     4     0    5   97    1  316    12     0     3  152     2
6     0     0    0    2    0    0  2996     3     5    0    61
7     0     0    0   40    0    0     1  1115     0    1     7
8     0     0    0  110    0    2    16    20  1213    4     5
9     3     2  173   93    3  100    14    80    58  587    24
10    0     1    0    0    4    0     0     0     1    0  1640
better model found
persisted
after epoch: 6,now: 2024-07-29 00:26:10.608116,epoch time: 0:41:34.347515,used: 4:10:43.285275,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9762682, 'precision': 0.94572127, 'recall': 0.9120538, 'specificity': 0.9973133, 'f1': 0.92432785, 'auroc': 0.99947983}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     2    1    0     4     1     0    0     11
1     0  1301    0     4    0    0     0    24     3    0      0
2     1     0  253     0   12    1     1     1     3   27     13
3     1     0    0  8266    0   21     1    88    61    1      0
4     6     0   12     0  307    0     0     0    12    3    199
5     0     0    0     6    0  487     0     0     2   24      1
6     4     0    1     2    0    0  1892     1     1    1      6
7     0     4    3    73    1    0     1  7132    41    3      5
8     0     0    1    22    3    8     1    21  3218    4     17
9     1     0   16     2    0   53     0     0     0  420      1
10    8     0    1     6    1    0     5     9    13    0  12750
---- Validation: 
scalar performance:
{'acc': 0.9764879, 'precision': 0.94745255, 'recall': 0.91300833, 'specificity': 0.99734366, 'f1': 0.9252585, 'auroc': 0.9994046}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    1    0     5     0     1    1     10
1     0  1302    0     6    0    0     0    23     1    0      0
2     1     0  265     0    5    3     2     0     2   20     14
3     1     1    0  8290    0   17     1    67    62    1      0
4     4     0   14     0  310    0     2     2    12    2    193
5     0     0    0     6    0  491     0     0     1   22      1
6     3     0    0     0    0    0  1896     0     2    0      7
7     0     3    1    80    1    0     1  7126    48    1      4
8     0     0    1    24    2    8     0    25  3216    3     17
9     3     0   21     1    0   66     2     1     0  399      0
10    6     0    1     5    2    0     4    13    17    1  12747
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7162947, 'precision': 0.6348145, 'recall': 0.6092534, 'specificity': 0.9713409, 'f1': 0.5806279, 'auroc': 0.8752544}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1057     1   0   2    3    1    82     3     6    5    10
1      0  1265   0  23    0    0     0   177    12    0    22
2      3     1  73   1  114   14    10    19   327   69   384
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0   68    0     1     0    19    0  1545
5     15     0  10  65   14  391     4     0    10   77     6
6      1     0   0   1    0    0  2981     4    21    0    59
7      3     0   0  92    0    1     1  1056     9    0     2
8      0     0   0  43    0    6     8     2  1304    2     5
9     20     4  77  54   16  170    13    60   271  398    54
10     0     0   0   0    0    0     0     0     1    0  1645
better model found
persisted
after epoch: 7,now: 2024-07-29 01:13:48.227317,epoch time: 0:47:37.619201,used: 4:58:20.904476,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9762414, 'precision': 0.9444648, 'recall': 0.9187921, 'specificity': 0.9973818, 'f1': 0.92716295, 'auroc': 0.99952304}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    0    0     3     2     0    1      8
1     0  1323    0     5    0    0     0     4     0    0      0
2     1     0  260     1   22    0     2     4     0   17      5
3     0     3    0  8287    1    0     3    88    55    1      0
4     7     0    7     0  440    0     2     1     5    2     75
5     0     0    0    28    0  345     1     0     2  144      1
6     2     0    0     0    0    0  1896     0     1    0      9
7     0    27    0    73    1    0     1  7121    23    1     17
8     0     1    1    29    5    0     2    66  3130    1     60
9     2     0   22     2    1    3     3     1     2  457      0
10    4     2    1     7    6    0     4     3     2    2  12760
---- Validation: 
scalar performance:
{'acc': 0.9752307, 'precision': 0.94117725, 'recall': 0.9140257, 'specificity': 0.9972784, 'f1': 0.9228122, 'auroc': 0.999493}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    0    0     6     1     0    1     10
1     0  1318    0     5    0    0     0     9     0    0      0
2     1     0  247     0   28    0     4     1     0   28      3
3     1     2    0  8283    0    2     0   106    44    1      1
4     6     0    7     0  441    0     1     0     4    3     77
5     1     0    0    30    0  342     2     0     0  145      1
6     3     0    0     1    0    0  1898     0     1    0      5
7     0    16    0    82    1    0     1  7119    34    0     12
8     0     0    1    32   10    0     0    72  3122    3     56
9     2     0   19     3    1    3     1     1     1  461      1
10    4     0    1     7   10    0     7     2     2    0  12763
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73084724, 'precision': 0.67702043, 'recall': 0.6050707, 'specificity': 0.97283727, 'f1': 0.5953698, 'auroc': 0.88408786}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   981     2    0   14    3    0    96    36     6   19    13
1     0  1365    0   23    0    0     1    99     4    0     7
2     2    13  104   13  178    6    38    30   323   76   232
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  237    0     4     1    16    1  1374
5     5     0    4  141    4  221    26     0    13  176     2
6     1     0    0    1    0    0  3048     3     7    0     7
7     0     0    0   47    0    1     0  1114     1    0     1
8     0     0    0   75    0    0    14    13  1262    2     4
9     7    30   71  145   10   42    29    92   209  476    26
10    0     1    0    0    6    0     0     0     1    0  1638
early stop counter: 1
val acc:0.9752306938171387, best validation acc: 0.9764878749847412, corresponding to test acc:                         0.7162947058677673 / 0.754984974861145
after epoch: 8,now: 2024-07-29 02:16:40.929633,epoch time: 1:02:52.702316,used: 6:01:13.606792,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9800139, 'precision': 0.9359865, 'recall': 0.93428504, 'specificity': 0.99790347, 'f1': 0.9302837, 'auroc': 0.9995695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    1     1    4    0     0     1     1    0      2
1     0  1324    0     2    0    0     0     5     0    0      0
2     0     0  304     0    7    0     0     1     0    0      0
3     0     9    0  8243    0    3     1   108    73    1      0
4     7     0   20     1  443    0     0     0    12    0     56
5     1     0    7     9    0  466     0     1     2   35      0
6    11     0    1     0    0    0  1887     1     2    0      6
7     0    15    1    42    1    0     1  7171    29    0      2
8     1     0    4    12    0    0     0    27  3241    1      9
9     5     0  123     2    2   20     3     0     2  335      1
10    7     0    4     6    9    0     4     5    17    0  12742
---- Validation: 
scalar performance:
{'acc': 0.9800455, 'precision': 0.9394227, 'recall': 0.9375542, 'specificity': 0.9978881, 'f1': 0.933673, 'auroc': 0.9996007}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    3    0     0     0     1    0      1
1     0  1326    0     0    0    0     0     6     0    0      0
2     1     0  307     0    4    0     0     0     0    0      0
3     0     7    0  8234    0    2     1   113    82    1      0
4     5     0   14     0  446    0     1     0     9    0     64
5     2     0    3    12    0  472     1     0     4   27      0
6    13     0    0     1    1    0  1883     2     3    0      5
7     0    19    2    49    1    0     1  7178    12    0      3
8     0     0    2    17    2    1     0    27  3240    0      7
9     2     0  128     2    1   17     1     2     0  337      3
10    9     0    2     5   13    0     6     5    16    1  12739
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75904286, 'precision': 0.68051314, 'recall': 0.64121187, 'specificity': 0.9759255, 'f1': 0.637579, 'auroc': 0.8845873}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1096     0    2   18    3    0    20    17     4    5     5
1      1  1379    0   14    0    0     2    87     5    0    11
2     10     2  367    9  233   17    18    17   244   26    72
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0   15    0  436    0     6     1    23    0  1152
5     13     4   29  112    2  302     2     0    12  114     2
6      5     0    0    1    0    0  3040     3    12    0     6
7      1     0    0  107    0    0     0  1048     6    1     1
8      0     0    1   56    0    2    10    10  1286    1     4
9     14    19  299  104   15  137     3    58   194  281    13
10     0     1    1    0   27    0     1     1     1    0  1614
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-29 03:19:41.143572,epoch time: 1:03:00.213939,used: 7:04:13.820731,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9780608, 'precision': 0.9518459, 'recall': 0.94712275, 'specificity': 0.9976283, 'f1': 0.9477801, 'auroc': 0.99974096}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     3    1    0     1     0     1    2      3
1     0  1322    0     6    0    0     0     3     0    0      1
2     0     0  246     0   12    0     0     2     2   49      0
3     0     0    0  8420    0    2     0     7     9    0      0
4     3     0    8     0  496    0     0     0     9    2     20
5     0     0    0    24    0  451     0     0     2   44      0
6     4     1    0     4    0    0  1887     1     6    1      4
7     0    24    0   254    0    0     1  6945    33    0      6
8     0     1    0   101    4    0     0     3  3185    0      2
9     0     0    1     3    0   10     0     0     0  479      0
10    3     0    4     5   70    1     5     6    42    4  12653
---- Validation: 
scalar performance:
{'acc': 0.97801256, 'precision': 0.95254695, 'recall': 0.9471618, 'specificity': 0.9976256, 'f1': 0.9481492, 'auroc': 0.9997459}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     3    2    0     1     0     0    3      2
1     0  1328    0     4    0    0     0     0     0    0      0
2     0     0  250     0    8    1     0     1     2   50      0
3     0     0    0  8419    0    0     0     9    12    0      0
4     4     0    8     0  496    1     0     0    10    2     18
5     0     0    0    31    0  445     0     0     0   44      1
6     3     0    0     1    0    1  1892     0     5    0      6
7     0    22    0   250    0    0     1  6953    34    2      3
8     0     1    0    97    4    0     0     9  3179    2      4
9     0     0    2     3    0    8     0     0     2  478      0
10    7     1    2     6   58    1    12     7    46    5  12651
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69936335, 'precision': 0.6907309, 'recall': 0.56666625, 'specificity': 0.97054327, 'f1': 0.5814204, 'auroc': 0.87992525}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   928     6   0  114   12    1    41   23     9   25    11
1     2  1415   0   30    0    0     0   44     1    0     7
2     3     9  93   74  322   19     3   28   303   62    99
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   1    0  430    0     3    1    16    0  1182
5     2     1   0  335    4  196     4    0     4   44     2
6     1     2   0   10    0    0  2998    3    17    0    36
7     1     5   0  268    0    0     0  883     3    0     4
8     0     7   0  212    0    0     1    4  1145    0     1
9     1    35  34  455   16   96     1   45   145  291    18
10    0     1   0    0   27    0     0    0     1    0  1617
early stop counter: 1
val acc:0.9780125617980957, best validation acc: 0.98004549741745, corresponding to test acc:                         0.7590428590774536 / 0.7590428590774536
after epoch: 10,now: 2024-07-29 04:19:35.469952,epoch time: 0:59:54.326380,used: 8:04:08.147111,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:04:08.147111 at 2024-07-29 04:19:35.469952
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75904286, 'precision': 0.68051314, 'recall': 0.64121187, 'specificity': 0.9759255, 'f1': 0.637579, 'auroc': 0.8845873}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1096     0    2   18    3    0    20    17     4    5     5
1      1  1379    0   14    0    0     2    87     5    0    11
2     10     2  367    9  233   17    18    17   244   26    72
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0   15    0  436    0     6     1    23    0  1152
5     13     4   29  112    2  302     2     0    12  114     2
6      5     0    0    1    0    0  3040     3    12    0     6
7      1     0    0  107    0    0     0  1048     6    1     1
8      0     0    1   56    0    2    10    10  1286    1     4
9     14    19  299  104   15  137     3    58   194  281    13
10     0     1    1    0   27    0     1     1     1    0  1614
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75904286, 'precision': 0.68051314, 'recall': 0.64121187, 'specificity': 0.9759255, 'f1': 0.637579, 'auroc': 0.8845873}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1096     0    2   18    3    0    20    17     4    5     5
1      1  1379    0   14    0    0     2    87     5    0    11
2     10     2  367    9  233   17    18    17   244   26    72
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0   15    0  436    0     6     1    23    0  1152
5     13     4   29  112    2  302     2     0    12  114     2
6      5     0    0    1    0    0  3040     3    12    0     6
7      1     0    0  107    0    0     0  1048     6    1     1
8      0     0    1   56    0    2    10    10  1286    1     4
9     14    19  299  104   15  137     3    58   194  281    13
10     0     1    1    0   27    0     1     1     1    0  1614
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_07md_28_20_15_26_seed_1_23121340_instance_wise_predictions.txt
accuracy from prediction file 0.7590428881270552
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_2024-07-27_15-47-44/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1655 MiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |   1648 MiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      7 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |   1647 MiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      6 MiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16520 MiB |  16520 MiB |  31154 MiB |  14634 MiB |
|       from large pool |  16492 MiB |  16492 MiB |  31124 MiB |  14632 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 237632 KiB | 630847 KiB | 126244 GiB | 126244 GiB |
|       from large pool | 216320 KiB | 628608 KiB | 120386 GiB | 120386 GiB |
|       from small pool |  21312 KiB |  25462 KiB |   5858 GiB |   5858 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   60277 K  |   60275 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2399    |    3599    |   33482 K  |   33479 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   60277 K  |   60275 K  |
|       from large pool |     247    |     595    |   26795 K  |   26795 K  |
|       from small pool |    2399    |    3599    |   33482 K  |   33479 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     467    |     467    |     828    |     361    |
|       from large pool |     453    |     453    |     813    |     360    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     121    |     569    |   33851 K  |   33851 K  |
|       from large pool |      95    |     304    |   17481 K  |   17481 K  |
|       from small pool |      26    |     460    |   16370 K  |   16370 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15860 MiB |    808 TiB |    808 TiB |
|       from large pool |  16640 KiB |  15835 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15816 MiB |    805 TiB |    805 TiB |
|       from large pool |  16640 KiB |  15791 MiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1888 MiB |  16520 MiB |  31154 MiB |  29266 MiB |
|       from large pool |   1860 MiB |  16492 MiB |  31124 MiB |  29264 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 630847 KiB | 126245 GiB | 126245 GiB |
|       from large pool |  24320 KiB | 628608 KiB | 120387 GiB | 120387 GiB |
|       from small pool |      0 KiB |  25462 KiB |   5858 GiB |   5858 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   60277 K  |   60277 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3599    |   33482 K  |   33482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   60277 K  |   60277 K  |
|       from large pool |       2    |     595    |   26795 K  |   26795 K  |
|       from small pool |       0    |    3599    |   33482 K  |   33482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     107    |     467    |     828    |     721    |
|       from large pool |      93    |     453    |     813    |     720    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     569    |   33852 K  |   33852 K  |
|       from large pool |       3    |     304    |   17481 K  |   17481 K  |
|       from small pool |       0    |     460    |   16370 K  |   16370 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 29 04:37:48 2024]
Finished job 0.
1 of 1 steps (100%) done
