Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 23:26:48 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329

 Experiment start at: 2024-07-20 23:54:31.128455
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.53288203, 'precision': 0.20723997, 'recall': 0.1794995, 'specificity': 0.94011754, 'f1': 0.16162497, 'auroc': 0.6721218}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    53   0   0   1    98    3   0    328
1    0   2   0   194   0   0   0   403    9   1    723
2    0   0   0    54   0   0   1    32    7   0    218
3    0   3   0  5112   0   0   5  1405  121   0   1794
4    0   0   0    75   0   0   2    30    9   0    423
5    0   0   0   230   0   0   0    37    8   0    246
6    0   0   0   147   0   0   7   172   29   0   1553
7    0   1   0  1641   0   0   2  3192   39   0   2386
8    0   0   0   757   0   0   8   317   75   0   2138
9    0   0   0   164   0   0   0    51    9   0    269
10   0   0   0   541   0   1  18   594  109   0  11529
---- Validation: 
scalar performance:
{'acc': 0.53179085, 'precision': 0.1728907, 'recall': 0.17848185, 'specificity': 0.9399562, 'f1': 0.16007204, 'auroc': 0.67752033}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    46   0   0   2    98    2   0    335
1    0   0   0   185   0   0   2   436    7   0    702
2    0   0   0    51   0   0   0    41    3   0    217
3    1   3   0  5082   0   0   3  1391  129   0   1831
4    0   0   0    62   0   0   0    31    9   0    437
5    0   0   0   249   0   0   0    29   12   0    231
6    0   0   0   147   0   0   5   171   30   0   1555
7    0   2   0  1650   0   0   3  3171   49   0   2390
8    0   0   0   755   0   0   4   319   61   0   2157
9    0   0   0   152   0   1   0    53   10   0    277
10   0   0   0   560   0   1  15   564   94   0  11562
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1558805, 'precision': 0.03920524, 'recall': 0.13666096, 'specificity': 0.9138907, 'f1': 0.05579225, 'auroc': 0.5416521}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   0   0   4   0   0   0  355   0   0   811
1    0   0   0  56   0   0   0  699   0   0   744
2    0   0   0  62   0   0   0   59   0   0   894
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   3   0   0   0    6   0   0  1624
5    0   0   0  31   0   0   0   71   0   0   490
6    0   0   0   8   0   0   0   29   0   0  3030
7    0   0   0  12   0   0   0  595   0   0   557
8    0   0   0  24   0   0   0   38   0   0  1308
9    0   0   0  91   0   0   0  152   1   0   893
10   0   0   0   0   0   0   0   13   0   0  1633
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 00:22:28.381111,epoch time: 0:27:57.252656,used: 0:27:57.252656,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.63080585, 'precision': 0.32238215, 'recall': 0.22261183, 'specificity': 0.95357084, 'f1': 0.20332392, 'auroc': 0.81470275}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   1   0    71   0   0   4   112   1   0    294
1    0  44   0   176   0   0   3   780   3   0    326
2    0   1   0    88   0   0   1    35   1   0    186
3    0   1   0  6652   0   0   0  1196  56   0    534
4    0   0   0    81   0   0   1    14   9   0    434
5    0   1   0   400   0   0   0    16   3   0    101
6    0   1   0   188   0   0  42   129  25   0   1522
7    0   4   0  1917   0   0   2  4529  16   0    795
8    0   1   0  1033   0   0   4   227  87   0   1942
9    0   1   0   266   0   0   4    29   8   0    185
10   0   1   0   337   0   0  18   175  39   0  12223
---- Validation: 
scalar performance:
{'acc': 0.6306005, 'precision': 0.30737555, 'recall': 0.22196218, 'specificity': 0.9534526, 'f1': 0.20203927, 'auroc': 0.81578684}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    70   0   0   3   111   0   0    299
1    0  45   0   186   0   0   3   764   4   0    330
2    0   0   0    87   0   0   0    31   4   0    190
3    0   4   0  6670   0   0   1  1199  42   0    524
4    0   0   0    82   0   0   1    15   3   0    438
5    0   1   0   385   0   0   2    14   2   0    117
6    0   1   0   186   0   0  29   115  23   0   1554
7    0   7   0  1863   0   0   5  4532  23   0    835
8    0   0   0  1041   0   0   4   180  77   0   1994
9    0   2   0   259   0   0   3    30   4   0    195
10   0   0   0   324   0   0  19   182  49   0  12222
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1905828, 'precision': 0.03909167, 'recall': 0.1752845, 'specificity': 0.9179462, 'f1': 0.06330973, 'auroc': 0.63099134}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0    3   0   0   0   677   0   0   490
1    0   0   0   33   0   0   0  1255   0   0   211
2    0   0   0   50   0   0   0   195   0   0   770
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    16   0   0  1615
5    0   0   0   80   0   0   0   216   0   0   296
6    0   0   0   10   0   0   0    78   0   0  2979
7    0   0   0    9   0   0   0  1086   0   0    69
8    0   0   0   47   0   0   0   127   0   0  1196
9    0   0   0  131   0   0   0   475   1   0   530
10   0   0   0    0   0   0   0     8   0   0  1638
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 00:47:56.810575,epoch time: 0:25:28.429464,used: 0:53:25.682120,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.667835, 'precision': 0.35552508, 'recall': 0.26033315, 'specificity': 0.95850396, 'f1': 0.25897613, 'auroc': 0.8753586}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    3   0    79   0   0   13   101    3   0    284
1    0  294   0   115   0   0    4   736    3   0    180
2    0    5   0    95   0   0    7    27    9   0    169
3    0    6   0  6898   0   0    2  1110  111   0    310
4    0    1   0    76   0   0    6     8   12   0    436
5    0    3   0   419   0   0   13    12    9   0     65
6    0    6   0   170   0   0  178    83   36   0   1435
7    0   25   0  1659   0   0    4  4958   40   0    576
8    0    1   0   959   0   0    7   202  275   0   1850
9    0    5   0   279   0   0   25    26   13   0    145
10   0    2   0   225   0   0   43   116   51   0  12358
---- Validation: 
scalar performance:
{'acc': 0.6667113, 'precision': 0.3572919, 'recall': 0.2606321, 'specificity': 0.95835656, 'f1': 0.25923035, 'auroc': 0.8767072}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    9   0    74   0   0    7   109    6   0    278
1    0  314   0    94   0   0    3   726    4   0    191
2    0    3   0   101   0   0    5    29    8   0    166
3    0    8   0  6871   0   0    5  1132  107   0    317
4    0    1   0    78   0   0    6    10   13   0    431
5    0    2   0   420   0   0   14    10    9   0     66
6    0    7   0   168   0   0  176    90   33   0   1434
7    0   24   0  1651   0   0    5  4959   26   0    600
8    0    0   0  1010   0   0    9   201  254   0   1822
9    0    5   0   283   0   0   14    27    7   0    157
10   0    4   0   218   0   0   39   130   54   0  12351
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19310153, 'precision': 0.12911023, 'recall': 0.17798719, 'specificity': 0.91828865, 'f1': 0.06269626, 'auroc': 0.6813836}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0    3   0   0   0   722   0   0   445
1    0   1   0   20   0   0   0  1319   0   0   159
2    0   0   0   38   0   0   0   239   0   0   738
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    15   0   0  1616
5    0   0   0   97   0   0   0   268   0   0   227
6    0   0   0    9   0   0   0    99   0   0  2959
7    0   0   0    6   0   0   0  1117   0   0    41
8    0   0   0   52   0   0   0   174   0   0  1144
9    0   0   0  116   0   0   0   593   1   0   427
10   0   0   0    0   0   0   0     4   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 01:13:48.573038,epoch time: 0:25:51.762463,used: 1:19:17.444583,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.6981218, 'precision': 0.48638454, 'recall': 0.30050957, 'specificity': 0.9627155, 'f1': 0.30792022, 'auroc': 0.90901786}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    9   0    74   0   0   25   128    0   0    247
1    0  549   0    38   0   0    5   650    3   0     87
2    0   10   0    78   0   0   17    41   14   0    151
3    0   13   0  6761   0   0    9  1295  157   0    202
4    0    0   0    67   0   0   15    17   14   0    426
5    0    2   0   416   0   3   33    12   17   1     37
6    0   14   0   126   0   0  410    99   35   0   1224
7    0   49   0  1177   0   0   13  5569   35   1    419
8    0    3   0   876   0   0   16   282  445   0   1674
9    0    8   0   267   0   1   49    44   13   2    108
10   0    4   0   158   0   0   66   168   44   0  12354
---- Validation: 
scalar performance:
{'acc': 0.7001204, 'precision': 0.45252717, 'recall': 0.3016386, 'specificity': 0.9629256, 'f1': 0.3091402, 'auroc': 0.90770847}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    9   0    75   0   0   25   136    3   0    235
1    0  554   0    47   0   0    3   619    3   0    106
2    0   11   0    75   0   0   19    54   12   0    141
3    0   13   0  6749   0   0    7  1303  154   0    214
4    0    1   0    64   0   0   11    16   14   0    433
5    0    3   0   414   0   1   31    16   11   2     43
6    0   10   0   112   0   0  412   107   32   0   1235
7    0   45   0  1164   0   0    6  5619   35   0    396
8    0    0   0   815   0   0   21   295  470   0   1695
9    0   13   0   271   0   1   52    42   13   1    100
10   0    3   0   163   0   0   54   152   56   0  12368
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19457076, 'precision': 0.07459344, 'recall': 0.17967182, 'specificity': 0.9185537, 'f1': 0.061498933, 'auroc': 0.70792884}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   3   0    1   0   0   6   818   0   0   342
1    0   5   0   12   0   0   1  1383   0   0    98
2    0   0   0   25   0   0   0   324   0   0   666
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    33   0   0  1599
5    0   1   0  103   0   0   0   343   0   0   145
6    0   0   0    8   0   0   0   171   0   0  2888
7    0   1   0    3   0   0   0  1139   0   0    21
8    0   0   0   47   0   0   2   268   0   0  1053
9    0   2   0   72   0   0   1   772   0   0   290
10   0   0   0    0   0   0   0     9   0   0  1637
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 01:39:08.161112,epoch time: 0:25:19.588074,used: 1:44:37.032657,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7196597, 'precision': 0.59789634, 'recall': 0.32720327, 'specificity': 0.9656475, 'f1': 0.34081024, 'auroc': 0.9251626}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    7   0    71   0   0   36   159    0   0    210
1    0  632   0    30   0   0    4   592    0   0     74
2    0    4   1    80   0   0   24    65   14   1    123
3    0    7   0  6823   0   0    7  1272  170   0    158
4    0    2   0    64   0   0   15    15   20   0    423
5    0    2   0   409   0  11   43    14   16   2     24
6    0   11   0    99   0   0  598   102   30   0   1068
7    0   32   0  1036   0   0    7  5835   43   1    309
8    0    4   0   822   0   0    9   352  662   0   1446
9    0    7   0   280   0   5   78    38   10   5     70
10   0    7   0   151   0   0   68   182   54   0  12331
---- Validation: 
scalar performance:
{'acc': 0.7210111, 'precision': 0.49617624, 'recall': 0.3274527, 'specificity': 0.9657983, 'f1': 0.34054032, 'auroc': 0.9236454}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    6   0    71   0   0   43   149    4   0    210
1    0  647   0    32   0   0    4   579    0   0     70
2    0    5   0    83   0   0   27    63    9   2    123
3    0   10   0  6854   0   1   13  1226  193   0    143
4    0    1   0    66   0   0   15    18   15   0    424
5    0    2   0   416   0   4   35    18   19   4     23
6    0   10   0   108   0   0  575   113   33   0   1069
7    0   37   0  1006   0   0   12  5831   43   0    336
8    0    3   0   818   0   0    6   342  682   0   1445
9    0    7   0   278   0   3   67    37   17  10     74
10   0    4   0   150   0   0   53   184   53   0  12352
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19506052, 'precision': 0.17941763, 'recall': 0.18007405, 'specificity': 0.91868937, 'f1': 0.06190551, 'auroc': 0.72531164}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   3   0    1   0   0  12   848   0   0   306
1    0   9   0   12   0   0   1  1393   0   0    84
2    0   1   0   25   0   0   1   381   0   0   607
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    43   0   0  1589
5    0   1   0  112   0   0   1   363   0   0   115
6    0   0   0    7   0   0   2   217   0   0  2841
7    0   1   0    3   0   0   0  1140   0   0    20
8    0   0   0   59   0   0   2   304   2   0  1003
9    0   4   0   72   0   0   1   846   0   0   214
10   0   0   0    1   0   0   0    10   0   0  1635
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 02:04:29.789171,epoch time: 0:25:21.628059,used: 2:09:58.660716,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.74419415, 'precision': 0.5058657, 'recall': 0.36406454, 'specificity': 0.96898264, 'f1': 0.37588665, 'auroc': 0.93448305}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   10   0    77   0   0   76   137    1   0    182
1    0  853   0    27   0   0    4   395    4   0     48
2    0   10   0    87   0   0   61    46   16   1     91
3    0   14   0  7099   0   1   13   959  247   0    106
4    0    1   0    67   0   0   30    13   23   0    405
5    0    2   0   401   0  16   55     9   16   5     17
6    0   14   0    95   0   0  837    70   35   0    857
7    0   68   0  1135   0   0   16  5697   61   0    287
8    0    2   0   774   0   0   25   290  952   0   1252
9    0    7   0   278   0   8   97    33   16   7     47
10   0    8   0   127   0   0   77   146   79   0  12354
---- Validation: 
scalar performance:
{'acc': 0.7473853, 'precision': 0.522086, 'recall': 0.36807203, 'specificity': 0.96935815, 'f1': 0.3813409, 'auroc': 0.9349387}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   13   0    76   0   0   76   126     4   0    188
1    0  847   0    31   0   0    5   400     2   0     47
2    0    3   0    96   0   1   47    50    24   1     90
3    0   10   0  7131   0   1   10   935   249   0    104
4    0    2   0    63   0   0   30    22    22   0    400
5    0    2   0   413   0  16   47     6    21   3     13
6    0   12   0    89   0   1  879    78    32   0    817
7    0   54   0  1104   0   0   21  5709    62   0    315
8    0    1   0   743   0   0   26   281  1009   0   1236
9    0   11   0   261   0   8   94    35    24  10     50
10   0    9   0   143   0   0   77   150    77   0  12340
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20051773, 'precision': 0.1821128, 'recall': 0.18397152, 'specificity': 0.91919696, 'f1': 0.07093777, 'auroc': 0.74110943}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   5   0    5   0   0  52   808   1   0   299
1    0  55   0   12   0   0   3  1342   0   0    87
2    0   3   0   35   0   0   6   348   1   0   622
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    31   0   0  1601
5    0   3   0  152   0   0   8   326   2   0   101
6    0   2   0    7   0   0  25   175   0   0  2858
7    0   7   0    4   0   0   0  1133   0   0    20
8    0   1   0   85   0   0   9   272  10   0   993
9    0   6   0  111   0   0  18   785   0   0   217
10   0   0   0    1   0   0   0     2   0   0  1643
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 02:30:17.879865,epoch time: 0:25:48.090694,used: 2:35:46.751410,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7593643, 'precision': 0.5618247, 'recall': 0.38648635, 'specificity': 0.97104883, 'f1': 0.4027713, 'auroc': 0.9418082}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   15   0    59   0   1   89   139     5   0    174
1    0  892   0    19   0   0    2   372     3   0     44
2    0   10   1    69   0   1   50    55    27   5     94
3    0   13   0  6833   0   3   11  1167   322   0     90
4    0    1   1    58   0   1   25    22    34   0    397
5    0    0   0   375   0  37   50    11    26  10     12
6    0   20   0    69   0   1  901    89    34   0    794
7    0   59   0   761   0   1   12  6081    84   0    265
8    0    2   0   567   0   0   24   352  1248   0   1100
9    0    8   0   237   1  13  116    37    27  21     33
10   0    8   0    96   0   0   74   158    90   0  12368
---- Validation: 
scalar performance:
{'acc': 0.76086664, 'precision': 0.5438663, 'recall': 0.38894647, 'specificity': 0.97118497, 'f1': 0.40556276, 'auroc': 0.94049543}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   14   0    53   0   0   84   139     8   1    184
1    0  901   0    23   0   0    2   364     4   0     38
2    0    9   2    65   0   1   43    63    32   7     90
3    0   15   0  6887   0   9   15  1110   297   0    107
4    0    2   0    54   0   0   21    21    32   0    409
5    0    2   0   367   0  42   52    12    26  12      8
6    0   20   0    68   0   1  925    73    44   0    777
7    0   65   0   763   0   0   11  6070    84   0    272
8    0    2   0   575   0   0   20   346  1240   0   1113
9    0   14   3   242   0  14  101    38    23  18     40
10   0    4   0   110   0   0   66   163    93   0  12360
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20443574, 'precision': 0.28307667, 'recall': 0.18745738, 'specificity': 0.91955405, 'f1': 0.07680999, 'auroc': 0.75023335}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   6   0    2   0   0  58   830   2   0   272
1    0  76   0    6   0   0   1  1340   0   0    76
2    0   6   0   21   0   0   6   390   1   0   591
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    37   0   0  1595
5    0   3   0  123   0   1  12   358   4   0    91
6    0   2   0    6   0   0  31   211   1   0  2816
7    0   9   0    3   0   0   0  1134   0   0    18
8    0   1   0   57   0   0   8   316  38   0   950
9    0   7   0   69   0   0  22   853   2   0   184
10   0   0   0    1   0   0   0     3   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-21 02:55:57.751126,epoch time: 0:25:39.871261,used: 3:01:26.622671,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.77044094, 'precision': 0.5461986, 'recall': 0.40586194, 'specificity': 0.9724413, 'f1': 0.4270379, 'auroc': 0.94691056}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0   12   0    50   0   1   104   145     1   0    170
1    0  903   0    22   0   1     2   370     2   0     32
2    0    5   1    65   1   6    62    63    17   6     86
3    0   15   0  6885   0   4    18  1112   309   0     94
4    0    1   0    47   0   1    35    25    25   0    405
5    0    1   1   349   0  79    45     9    16  14      7
6    0   16   0    52   0   1  1006    92    42   1    698
7    0   48   0   659   1   2    16  6187    81   0    271
8    0    2   0   550   0   0    20   369  1317   0   1038
9    0    6   2   211   1  40   109    46    14  34     30
10   1    2   0    96   0   0    71   166    69   1  12384
---- Validation: 
scalar performance:
{'acc': 0.7699345, 'precision': 0.6518023, 'recall': 0.40722466, 'specificity': 0.97232187, 'f1': 0.43085134, 'auroc': 0.948143}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    3    7   0    55   0   0    97   137     3   0    181
1    0  895   0    15   0   0     5   375     2   0     40
2    0    4   2    64   0   2    56    71    18  11     84
3    0    8   0  6892   0   9    10  1109   310   1    101
4    0    2   0    55   0   0    34    22    34   0    392
5    0    0   0   346   0  77    42    14    15  20      7
6    0   15   0    60   0   1  1024    76    21   1    710
7    0   41   0   690   0   0    18  6158    71   2    285
8    0    2   0   544   0   2    28   368  1301   1   1050
9    0    9   1   233   1  31    93    39    13  41     32
10   1    5   0    76   0   0    74   169    80   0  12391
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20709439, 'precision': 0.2950337, 'recall': 0.18906128, 'specificity': 0.9197625, 'f1': 0.080062166, 'auroc': 0.7581932}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   6   0    2   0   0  92   813   2   0   255
1    0  74   0    6   0   0   3  1343   0   0    73
2    0   2   0   22   0   0  12   390   1   0   588
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    38   0   0  1594
5    0   2   0  131   0   2  24   347   3   0    83
6    0   2   0    6   0   0  59   214   1   0  2785
7    0   8   0    3   0   0   0  1135   0   0    18
8    0   1   0   58   0   0  17   325  48   0   921
9    0   6   0   68   0   0  33   850   1   0   179
10   0   0   0    1   0   0   0     3   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-21 03:21:22.301975,epoch time: 0:25:24.550849,used: 3:26:51.173520,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.77830696, 'precision': 0.6763253, 'recall': 0.41546384, 'specificity': 0.9734034, 'f1': 0.4398547, 'auroc': 0.9518485}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    7    8   0    76   0   0    98   131     3   0    160
1    0  946   0    17   0   0     2   333     1   0     33
2    0    4   7    86   5   3    62    56    11  12     66
3    1    7   0  7329   0   2    11   807   214   1     65
4    0    0   0    65   2   0    40    22    25   0    385
5    0    0   0   382   0  61    35     5    13  18      7
6    0   19   0    81   0   1  1083    90    22   1    610
7    0   44   0   926   0   1    14  6008    58   0    214
8    0    1   0   725   0   2    19   327  1278   2    942
9    1    6   5   252   3  24    94    26    16  43     23
10   0    1   0   120   0   0    75   182    87   0  12326
---- Validation: 
scalar performance:
{'acc': 0.77881503, 'precision': 0.6855417, 'recall': 0.41257718, 'specificity': 0.973442, 'f1': 0.43524548, 'auroc': 0.9492519}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    7    8   0    77   0   0   104   124     0   0    163
1    0  927   0    21   0   0     6   341     6   0     31
2    0    7   3    82   5   0    57    60    14   9     75
3    0    7   0  7327   0   7    15   787   224   0     73
4    0    1   0    69   2   0    33    24    29   1    380
5    0    1   0   366   0  59    44     6    17  22      6
6    0   14   0    94   0   1  1086    74    33   0    606
7    0   42   0   885   0   1    11  6046    54   0    226
8    0    2   1   710   0   0    20   315  1280   2    966
9    0    5   1   247   1  27   111    27    12  39     23
10   1    5   0   139   0   1    66   186    58   0  12340
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.211782, 'precision': 0.31004727, 'recall': 0.19172508, 'specificity': 0.9203267, 'f1': 0.08638031, 'auroc': 0.7659419}
confusion matrix:
    0   1   2    3   4   5    6     7   8   9     10
0    0   6   0    7   0   0  124   825   0   0   208
1    0  94   0   12   0   0    3  1324   0   0    66
2    0   1   0   36   0   0   24   416   1   0   537
3    0   0   0    0   0   0    0     0   0   0     0
4    0   0   0    1   0   0    1    40   0   0  1591
5    0   2   0  190   0   2   34   308   0   0    56
6    0   2   0   12   0   0  105   242   2   0  2704
7    0  10   0    6   0   0    0  1133   0   0    15
8    0   1   0  109   0   0   28   314  55   0   863
9    0   6   0  114   0   0   42   829   1   0   145
10   0   0   0    1   0   0    1     6   0   0  1638
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-21 03:47:04.403230,epoch time: 0:25:42.101255,used: 3:52:33.274775,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.7865208, 'precision': 0.70515335, 'recall': 0.4301977, 'specificity': 0.9744905, 'f1': 0.45428497, 'auroc': 0.9542449}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   10    9   0    69   0   0   115   115     4   0    160
1    0  975   0    24   0   0     2   299     3   1     28
2    0    8   7    74   1   6    60    59    13   8     76
3    0   10   0  7180   0   5    11   867   303   1     63
4    0    1   0    52   1   1    57    20    31   0    376
5    0    0   0   338   0  83    49     6    14  24      7
6    0   14   0    70   0   2  1144    77    25   3    571
7    0   47   0   759   0   1    14  6133    68   0    243
8    0    2   0   599   0   1    27   319  1426   1    920
9    1    2   3   220   1  41   100    37    15  49     24
10   0    6   0    84   0   1    83   154    73   1  12389
---- Validation: 
scalar performance:
{'acc': 0.7881503, 'precision': 0.6827867, 'recall': 0.43380854, 'specificity': 0.9747208, 'f1': 0.45853806, 'auroc': 0.953166}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   15   11   0    65   0   1   106   132     2   0    151
1    0  972   0    18   0   0     2   300     2   0     38
2    0    8   7    62   2   6    57    59    19  14     78
3    0   10   0  7223   0   8    13   853   270   1     62
4    0    2   1    60   0   0    42    15    33   0    386
5    0    0   0   345   0  90    40     7     9  24      6
6    0   15   0    60   0   3  1161    79    24   2    564
7    0   58   0   762   0   1    20  6118    79   1    226
8    0    1   0   595   0   1    29   344  1462   0    864
9    0    4   2   220   0  40   109    32    10  49     27
10   0    8   0    88   0   1    87   161    83   0  12368
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21996781, 'precision': 0.3960969, 'recall': 0.19779298, 'specificity': 0.92096204, 'f1': 0.09815141, 'auroc': 0.7710702}
confusion matrix:
    0    1   2    3   4   5    6     7   8   9     10
0    1   15   0    6   0   0  158   769   2   0   219
1    0  150   0    9   0   0    5  1264   0   0    71
2    0    7   0   26   0   0   29   382   1   0   570
3    0    0   0    0   0   0    0     0   0   0     0
4    0    0   0    1   0   0    1    34   0   0  1597
5    0    3   0  173   0   2   48   302   1   0    63
6    0    2   0    9   0   0  139   192   3   0  2722
7    0   19   0    5   0   0    0  1124   0   0    16
8    0    1   0   90   0   0   36   290  87   0   866
9    0    9   0   96   0   0   65   800   1   0   166
10   0    0   0    1   0   0    1     3   0   0  1641
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-21 04:12:53.415761,epoch time: 0:25:49.012531,used: 4:18:22.287306,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.79856056, 'precision': 0.68911505, 'recall': 0.4603506, 'specificity': 0.97603816, 'f1': 0.49455982, 'auroc': 0.9568095}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   37    9   0    71   0    1   101   111     3   0    150
1    0  993   0    17   0    0     2   288     1   0     31
2    2    2  15    59   8    3    52    61    17  27     66
3    0    8   0  7200   0    7    11   817   332   2     62
4    0    2   0    48   2    0    43    22    44   3    375
5    1    0   1   307   1  105    28     7    22  44      4
6    0   11   0    70   0    1  1194    71    32   2    526
7    0   40   0   722   1    1    11  6185    77   2    224
8    0    2   0   520   0    1    19   302  1652   2    795
9    3    4   9   207   1   37    77    26    18  93     18
10   0    6   0    79   0    1    78   148   112   0  12371
---- Validation: 
scalar performance:
{'acc': 0.7958272, 'precision': 0.71684676, 'recall': 0.45595244, 'specificity': 0.9757032, 'f1': 0.48988986, 'auroc': 0.95640004}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0   37   15   0    66   0   0   103   114     3    0    145
1    0  987   0    14   0   0     1   290     6    0     34
2    1    5  15    51   4   6    56    63    21   24     66
3    0    7   0  7199   0   9    12   816   337    1     59
4    0    2   1    46   4   1    43    24    35    1    382
5    0    0   0   327   0  87    29     5    16   53      4
6    0   11   0    65   1   2  1155    69    41    2    562
7    0   46   0   748   0   0    15  6133    90    0    233
8    0    1   0   504   1   1    17   308  1657    3    804
9    0    2   5   203   3  36    77    29    19  100     19
10   0    4   0    89   0   0    70   134   120    1  12378
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22409572, 'precision': 0.3999542, 'recall': 0.20159115, 'specificity': 0.92135996, 'f1': 0.10460286, 'auroc': 0.77630764}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   13   0    6   0   0  170   756    2   0   220
1    0  141   0    9   0   0    8  1272    0   0    69
2    0    4   0   26   0   0   29   377    3   0   576
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    33    0   0  1598
5    0    2   0  180   0   5   50   292    3   0    60
6    0    1   0   10   0   0  152   190    3   0  2711
7    0   15   0    6   0   0    0  1128    0   0    15
8    0    1   0   85   0   0   37   284  131   0   832
9    0    8   0  100   0   0   71   791    1   0   166
10   0    0   0    1   0   0    1     1    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-21 04:38:26.656728,epoch time: 0:25:33.240967,used: 4:43:55.528273,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8046072, 'precision': 0.7089231, 'recall': 0.46895567, 'specificity': 0.97693443, 'f1': 0.49832332, 'auroc': 0.95780045}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   27    13   0    73   0    1   107   115     5   0    142
1    0  1048   0    16   0    0     2   240     4   1     21
2    0     9  18    61   5    6    57    47    25  19     65
3    0     5   0  7252   1   12    10   767   346   1     44
4    0     0   1    53   4    1    45    19    52   1    362
5    0     1   0   302   0  128    29     2    25  32      2
6    0    14   0    49   0    3  1197    68    48   1    528
7    0    68   1   710   0    3    15  6151   109   2    203
8    0     3   0   465   0    2    15   298  1843   3    667
9    1     4   7   191   4   64    79    27    19  73     24
10   0     2   0    89   0    2    76   152   140   0  12332
---- Validation: 
scalar performance:
{'acc': 0.80441356, 'precision': 0.71547365, 'recall': 0.47163022, 'specificity': 0.97690177, 'f1': 0.5041206, 'auroc': 0.95855874}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   34     9   0    74   0    2   103   115     3   1    142
1    0  1037   0    13   0    0     1   250     5   0     26
2    0     6  26    54   6   11    47    56    27  21     58
3    0    10   0  7239   0    7    13   755   352   1     63
4    0     2   1    45   2    2    48    24    51   1    363
5    0     0   0   299   0  134    28     2    27  27      4
6    0    18   0    46   0    2  1188    70    64   1    519
7    0    66   0   723   0    0    10  6172   105   0    189
8    0     2   0   486   0    3    16   277  1827   0    685
9    1     7   9   192   0   62    79    31    19  72     21
10   0     4   0    69   0    1    76   160   144   0  12342
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23913804, 'precision': 0.39088726, 'recall': 0.21367377, 'specificity': 0.92283696, 'f1': 0.1256203, 'auroc': 0.78157884}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   32   0    8   0   0  207   730    2   0   188
1    0  230   0   11   0   0    7  1187    0   0    64
2    0   10   0   31   0   0   38   372    5   0   559
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    33    1   0  1596
5    0    6   0  196   0  11   57   267    5   0    50
6    0    4   0   10   0   0  209   195    6   0  2643
7    0   25   0    6   0   0    0  1118    0   0    15
8    0    2   0   91   0   0   45   275  205   0   752
9    0   14   0  111   0   1   84   773    1   0   153
10   0    0   0    1   0   0    1     2    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-21 05:03:57.313668,epoch time: 0:25:30.656940,used: 5:09:26.185213,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8079516, 'precision': 0.7137306, 'recall': 0.47888654, 'specificity': 0.9773133, 'f1': 0.5115373, 'auroc': 0.9593006}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   41     7   0    56   0    1   124   107     4    1    142
1    0  1042   0    16   0    0     6   245     8    0     15
2    0     2  18    58   7    6    72    40    23   27     59
3    0     7   1  7308   0    8    15   707   319    0     71
4    0     2   3    50   5    0    63    17    39    2    358
5    0     1   1   288   0  128    28     4    19   48      4
6    0    15   0    51   0    4  1268    66    32    0    472
7    0    38   1   720   0    4    20  6165   104    0    212
8    0     3   1   482   0    2    32   310  1746    4    715
9    2     5   7   184   0   57    78    17    16  104     22
10   1     7   0    77   0    1    87   117   129    2  12373
---- Validation: 
scalar performance:
{'acc': 0.804681, 'precision': 0.7006347, 'recall': 0.47358263, 'specificity': 0.976889, 'f1': 0.5070661, 'auroc': 0.95952123}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   47     9   0    70   0    3   103   102     3   2    144
1    0  1026   0    20   0    0     2   250     6   1     27
2    0     1  18    54   5    7    62    44    19  30     72
3    1    10   0  7270   1   11    16   738   346   0     47
4    0     0   2    41   3    2    57    22    46   2    364
5    0     0   0   305   0  119    25     3    15  48      6
6    0    13   0    57   0    2  1237    58    46   1    494
7    0    40   1   690   0    2    15  6179   105   2    231
8    0     1   0   506   0    2    29   287  1733   3    735
9    1     5  12   178   0   53    83    21    18  98     24
10   0     3   1    72   0    0    89   143   134   1  12353
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24382564, 'precision': 0.40055168, 'recall': 0.21495768, 'specificity': 0.9231541, 'f1': 0.12799075, 'auroc': 0.78548986}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    7   23   0    9   0   0  269   684    2   0   176
1    0  211   0   12   0   0   12  1198    0   0    66
2    0    6   0   28   0   0   55   360    3   0   563
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    31    0   0  1600
5    0    3   0  203   0  12   78   244    4   0    48
6    0    2   0    9   0   0  303   171    4   0  2578
7    0   19   0    7   0   0    0  1124    0   0    14
8    0    1   0   98   0   0   68   262  184   0   757
9    0   11   0  109   0   1  104   749    1   0   162
10   0    0   0    1   0   0    1     0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-21 05:29:41.866182,epoch time: 0:25:44.552514,used: 5:35:10.737727,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8125803, 'precision': 0.70856434, 'recall': 0.48889875, 'specificity': 0.9779752, 'f1': 0.52435094, 'auroc': 0.9616679}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   61     8   0    60   0    0   103   105     8    0    138
1    0  1042   0    20   0    0     3   236     8    0     23
2    0     3  19    55  13    6    56    55    25   29     51
3    0     7   0  7207   0   13    13   771   368    5     52
4    1     2   0    41   9    1    48    15    65    5    352
5    0     0   3   292   1  121    24     5    17   50      8
6    2    13   0    44   0    1  1277    58    52    1    460
7    0    47   0   621   1    0    13  6253   116    0    212
8    0     4   0   439   0    2    25   288  1928    0    610
9    7     6   8   177   2   47    78    28    14  111     15
10   0     2   0    77   3    0    81   132   153    2  12343
---- Validation: 
scalar performance:
{'acc': 0.8116892, 'precision': 0.70123214, 'recall': 0.48384702, 'specificity': 0.9778386, 'f1': 0.5164686, 'auroc': 0.96274793}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   43     7   0    63   0    0   111   108     6    2    143
1    0  1039   0    17   0    0     2   247     5    2     20
2    0     5  15    53  16    2    59    45    20   36     61
3    0     9   0  7226   0   10    18   762   366    1     48
4    0     0   2    36  10    0    52    25    57    6    351
5    1     0   1   293   0  120    24     3    15   59      5
6    2    12   0    56   0    1  1260    57    45    1    474
7    1    51   0   618   0    3     8  6261   112    1    210
8    0     2   0   465   0    2    24   262  1903    2    636
9    3     5   8   175   3   46    72    31    14  116     20
10   2     5   0    77   0    1    77   126   154    2  12352
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25145176, 'precision': 0.3942896, 'recall': 0.22115305, 'specificity': 0.9239273, 'f1': 0.1375946, 'auroc': 0.78915226}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   14   24   0    9   0   0  268   687    3   0   165
1    1  230   0   10   0   0   10  1187    0   0    61
2    0    6   0   26   0   0   56   369    5   0   553
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    34    1   0  1596
5    0    4   0  199   0  11   77   244    9   0    48
6    0    2   0    8   0   0  329   184    5   0  2539
7    0   21   0    6   0   0    0  1124    0   0    13
8    0    1   0   89   0   0   69   260  245   0   706
9    0   12   0  106   0   1  106   757    1   0   154
10   0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-21 05:55:30.732203,epoch time: 0:25:48.866021,used: 6:00:59.603748,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8132224, 'precision': 0.7342118, 'recall': 0.49395114, 'specificity': 0.97805804, 'f1': 0.5285987, 'auroc': 0.96395874}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   47     4   0    56   0    2   126   113     4    1    129
1    0  1035   0    11   0    0     5   254     5    0     22
2    0     4  23    42   7    7    66    54    20   30     59
3    0     4   0  7186   1   22    17   828   319    1     60
4    0     1   0    37  13    1    73    26    45    4    339
5    0     0   1   266   0  160    27     6    15   43      3
6    0    12   0    42   1    2  1332    70    39    2    407
7    0    38   0   578   1    2    23  6331    85    1    203
8    0     3   0   419   0    4    37   339  1795    6    693
9    3     3  10   160   1   60    86    27    17  109     17
10   1     5   1    54   1    1   112   145   109    1  12364
---- Validation: 
scalar performance:
{'acc': 0.8120904, 'precision': 0.7165165, 'recall': 0.49122208, 'specificity': 0.9779804, 'f1': 0.5226163, 'auroc': 0.9632664}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   49    10   1    54   0    2   142   100     5    0    120
1    0  1024   0    13   0    0     8   258     5    0     24
2    0     6  20    43   6   11    70    46    19   34     57
3    0     4   0  7117   1   20    18   882   341    1     56
4    0     3   2    39   6    4    70    25    41    3    346
5    0     0   0   263   0  164    29     4    14   46      1
6    1    13   0    40   0    1  1325    74    37    1    416
7    1    41   0   520   1    2    29  6388    84    0    199
8    2     2   0   411   0    6    42   325  1822    4    682
9    5     3   4   158   0   79    81    29    11  103     20
10   0     3   1    64   0    1    99   157   128    1  12342
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26068705, 'precision': 0.40864605, 'recall': 0.22325616, 'specificity': 0.9245732, 'f1': 0.1401191, 'auroc': 0.7930333}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   12   18   0    7   0   0  347   653    3   0   130
1    0  205   0    6   0   0   17  1213    0   0    58
2    0    3   0   23   0   0   99   371    4   0   515
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    35    1   0  1595
5    0    3   0  174   0  14  107   249    5   0    40
6    0    2   0    7   0   0  521   174    3   0  2360
7    0   17   0    3   0   0    6  1125    0   0    13
8    0    1   0   76   0   0  123   274  208   0   688
9    0    8   0   83   0   1  151   758    1   0   135
10   0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-21 06:21:09.432004,epoch time: 0:25:38.699801,used: 6:26:38.303549,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8195366, 'precision': 0.7202249, 'recall': 0.5094285, 'specificity': 0.9787663, 'f1': 0.5489738, 'auroc': 0.96365315}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   82    15   1    63   0    1    94    88     5    1    133
1    0  1084   0    14   0    0     4   202     7    2     19
2    1     7  28    43  13    6    51    49    17   35     62
3    2     6   0  7335   0   17    12   692   317    4     54
4    0     1   4    39  16    1    54    20    56    5    343
5    1     0   2   272   0  152    20     5    16   49      4
6    0    18   0    44   0    2  1286    68    40    4    445
7    1    49   1   664   0    2    11  6234    96    0    206
8    0     6   0   457   0    5    21   275  1938    3    591
9    5     5  16   165   3   56    59    28    13  125     18
10   2     7   0    65   2    0    74   146   142    1  12351
---- Validation: 
scalar performance:
{'acc': 0.8185101, 'precision': 0.7379917, 'recall': 0.5142575, 'specificity': 0.97871155, 'f1': 0.55463, 'auroc': 0.9654775}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   80    11   0    64   0    1    99    88     6    1    133
1    0  1084   0    18   0    0     3   202     7    0     18
2    3     4  40    42  13   11    51    53    19   32     44
3    0    15   0  7339   0   17    15   666   341    4     43
4    0     3   3    36  16    4    50    25    49    3    350
5    1     0   1   268   0  152    19     6    23   48      3
6    1    21   0    48   0    1  1301    59    46    4    427
7    1    77   0   695   0    3    19  6187    90    3    190
8    0     2   0   456   0    5    20   297  1927    3    586
9    3     4  10   162   2   69    42    27    18  136     20
10   0     9   1    81   1    1    65   145   153    2  12338
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.27495977, 'precision': 0.40021637, 'recall': 0.23818737, 'specificity': 0.9261731, 'f1': 0.16543025, 'auroc': 0.79651904}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   63   49   0    9   0   0  294   606    3   0   146
1    1  370   0   16   0   0   12  1043    0   0    57
2    0   15   0   29   0   0   79   338    7   0   547
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    30    1   0  1599
5    1    7   0  219   0  13   99   206    8   0    39
6    0    5   0    9   0   0  465   161    6   0  2421
7    0   30   0    8   0   0    5  1108    0   0    13
8    0    2   0  101   0   0   96   241  269   0   661
9    1   21   0  115   0   1  131   716    1   0   151
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-21 06:47:04.618586,epoch time: 0:25:55.186582,used: 6:52:33.490131,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.82165027, 'precision': 0.7472882, 'recall': 0.5147319, 'specificity': 0.9789609, 'f1': 0.5552267, 'auroc': 0.9657176}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   79    13   0    59   0    2   101    82     2    4    141
1    0  1082   1    15   0    0     0   204     6    0     24
2    1     5  32    54  13    5    50    39    10   47     55
3    0     3   1  7482   0   17    13   620   250    3     46
4    0     1   4    47  22    0    57    21    43    4    340
5    2     0   0   265   0  134    11     2    16   85      6
6    2    25   0    56   0    1  1318    53    36    2    415
7    0    49   1   724   0    3    11  6195    78    2    202
8    0     3   0   535   0    4    28   275  1820    5    625
9    2     5   7   159   2   46    56    18    16  165     17
10   0     5   0    68   2    0    87   122   123    6  12381
---- Validation: 
scalar performance:
{'acc': 0.820329, 'precision': 0.7401557, 'recall': 0.5140277, 'specificity': 0.9787648, 'f1': 0.5546621, 'auroc': 0.9645138}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   78    10   0    70   0    0    95    83     4    1    142
1    0  1075   0    19   0    0     3   213     6    1     15
2    1     5  29    54   8    4    52    43    10   48     58
3    0     5   0  7455   0   15    17   632   262    4     50
4    0     0   8    46  20    2    48    17    44    7    347
5    1     1   0   272   0  142    15     3    12   72      3
6    0    17   0    54   0    2  1320    56    35    2    422
7    0    60   1   734   1    1    18  6165    80    1    204
8    0     4   1   530   0    5    17   269  1810    6    654
9    2     5  13   160   4   49    49    19     9  168     15
10   1     4   1    76   2    0    81   119   103    3  12406
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.27474988, 'precision': 0.40622094, 'recall': 0.23526129, 'specificity': 0.9261709, 'f1': 0.16156833, 'auroc': 0.79861575}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   55   37   0   12   0   0  323   603    3   0   137
1    1  334   0   20   0   0   13  1072    0   0    59
2    0    9   0   37   0   0   91   335    5   0   538
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    29    1   0  1600
5    1    4   0  252   0  13   99   185    4   0    34
6    0    4   0   15   0   0  544   158    4   0  2342
7    0   25   0   10   0   0    3  1113    0   0    13
8    0    1   0  133   0   0  107   231  226   0   672
9    1   16   0  140   0   1  145   686    1   0   147
10   0    0   0    1   0   0    2     1    0   0  1642
better model found
persisted
after epoch: 17,now: 2024-07-21 07:12:52.511150,epoch time: 0:25:47.892564,used: 7:18:21.382695,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8223727, 'precision': 0.7185831, 'recall': 0.5208082, 'specificity': 0.97911525, 'f1': 0.5625613, 'auroc': 0.9666327}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   99     9   0    46   1    2    88    91     3    2    142
1    0  1070   0    14   0    0     2   223     4    1     18
2    3     3  43    38  10    4    51    45    14   43     58
3    2     9   0  7351   1   19    19   686   302    2     44
4    0     1  10    42  19    3    65    17    41    3    338
5    3     0   1   253   1  176    22     1    16   46      2
6    2    14   0    50   1    3  1333    56    34    2    412
7    1    51   1   613   3    2    22  6271    99    1    201
8    1     2   1   466   0    4    27   284  1874    4    631
9   10     2  17   155   0   81    61    23    11  118     15
10   3     6   0    66   2    2    78   143   110    2  12383
---- Validation: 
scalar performance:
{'acc': 0.8265882, 'precision': 0.74333507, 'recall': 0.5323311, 'specificity': 0.979568, 'f1': 0.57741934, 'auroc': 0.9669585}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   114     6   1    50   1    1    94    83     6    3    124
1     0  1073   0    11   0    0     2   221     5    0     20
2     3     5  47    47  12   10    45    38    10   40     55
3     0     8   0  7382   0   19    11   685   293    3     39
4     0     1  11    36  19    2    61    24    38    7    340
5     3     0   2   253   0  172    19     2    15   52      3
6     4    15   0    41   0    3  1349    64    32    1    399
7     2    51   2   591   0    2    11  6307    88    0    211
8     1     1   0   452   0    5    22   276  1897    1    641
9    11     1   7   141   0   63    57    27    17  150     19
10    2     5   0    70   2    1    82   134   107    1  12392
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28503463, 'precision': 0.4073626, 'recall': 0.24298692, 'specificity': 0.9270499, 'f1': 0.17348653, 'auroc': 0.8012321}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   101   34   0    9   0   0  331   568    3   0   124
1     1  333   0   16   0   0   18  1072    0   0    59
2     0    6   0   28   0   0  106   335    5   0   535
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    1   0   0    2    29    1   0  1600
5     4    4   0  230   0  14  115   183    6   0    36
6     0    4   0    7   0   0  616   150    5   0  2285
7     0   24   0    7   0   0    7  1113    0   0    13
8     0    1   0  100   0   0  122   239  255   0   653
9     2   16   0  112   0   1  169   695    1   0   141
10    0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-21 07:38:21.512577,epoch time: 0:25:29.001427,used: 7:43:50.384122,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8286066, 'precision': 0.74204206, 'recall': 0.53223634, 'specificity': 0.97994554, 'f1': 0.5746382, 'auroc': 0.9678787}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   87     9   1    52   0    3   117    81     4    3    126
1    0  1075   0    14   0    0     3   215     7    1     17
2    3     5  59    41   8    8    55    42    15   27     49
3    1     6   3  7375   1   25    16   660   314    0     35
4    1     0   7    32  24    0    69    20    53    5    328
5    2     0   2   249   0  169    18     4    16   56      4
6    1    11   0    36   0    2  1393    58    38    2    366
7    1    62   2   577   0    1    14  6317    96    2    193
8    0     1   0   437   0    5    20   269  1971    2    590
9    7     2  18   148   3   71    56    26    16  133     13
10   2     4   0    60   3    0    90   139   127    2  12367
---- Validation: 
scalar performance:
{'acc': 0.8287014, 'precision': 0.7367843, 'recall': 0.53196234, 'specificity': 0.9799565, 'f1': 0.57412714, 'auroc': 0.9680261}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   84    12   0    53   0    3   107    84     8    3    129
1    0  1083   0    12   0    0     7   215     6    0      9
2    1     3  61    44  13    6    43    37    14   37     53
3    0     7   0  7399   0   13    17   649   307    1     47
4    0     1   8    43  27    3    72    15    41    3    326
5    1     0   5   247   1  174    16     1    16   58      2
6    2    15   0    40   2    1  1386    57    40    2    363
7    0    51   3   599   2    5    20  6311    89    1    184
8    0     3   0   407   1    3    42   287  1961    3    589
9    5     3  27   157   1   74    52    21    17  124     12
10   1     2   0    61   1    2    93   153   111    1  12371
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29287064, 'precision': 0.40867108, 'recall': 0.2452991, 'specificity': 0.9277379, 'f1': 0.17473692, 'auroc': 0.80360925}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   61   35   0    9   0   0  380   567    3   0   115
1    1  344   0   14   0   0   22  1062    0   0    56
2    0    6   0   29   0   0  121   333    6   0   520
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    3    30    1   0  1598
5    2    4   0  235   0  13  124   176    7   0    31
6    0    4   0    7   0   0  739   151    9   0  2157
7    0   22   0    7   0   0   10  1113    0   0    12
8    0    1   0   99   0   0  141   247  274   0   608
9    1   15   0  110   0   1  193   686    1   0   130
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-21 08:03:51.209453,epoch time: 0:25:29.696876,used: 8:09:20.080998,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.82799125, 'precision': 0.7509852, 'recall': 0.5351311, 'specificity': 0.9797349, 'f1': 0.5806553, 'auroc': 0.96840256}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   108     5   0    62   0    1    77    72     6    7    145
1     1  1068   0    15   0    0     2   217     9    0     20
2     0     1  49    45  12    4    45    35    15   54     52
3     1     7   1  7398   0   16    22   643   294    6     49
4     0     2   7    35  31    1    41    16    47    7    352
5     2     0   0   254   0  139    12     2    13   96      3
6     4    19   0    43   0    1  1314    60    38    1    428
7     2    40   1   622   1    0    19  6274   104    5    195
8     1     2   0   432   1    3    20   271  1964    5    597
9     4     1  17   141   1   48    39    13    24  189     15
10    1     5   0    56   4    1    67   116   127    3  12413
---- Validation: 
scalar performance:
{'acc': 0.8275779, 'precision': 0.7306713, 'recall': 0.5297121, 'specificity': 0.97966915, 'f1': 0.5725194, 'auroc': 0.9669897}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   104     7   0    65   1    1    81    79     4    5    136
1     0  1082   0    12   0    0     2   207     4    0     25
2     5     3  40    40  15    3    45    43    21   50     47
3     1     7   1  7429   0   13    12   604   315    4     54
4     0     3   4    33  23    2    47    20    41   12    354
5     1     0   2   255   0  137    10     4    20   87      5
6     4    12   0    32   0    0  1319    52    44    6    439
7     0    45   1   615   0    3    10  6276    97    4    214
8     1     1   2   441   2    2    30   261  1943    7    606
9     5     3  23   152   2   41    41    17    13  183     13
10    1     5   0    53   3    1    65   131   131    3  12403
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28615406, 'precision': 0.40738934, 'recall': 0.24573572, 'specificity': 0.92728704, 'f1': 0.17787856, 'auroc': 0.8033511}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   100   38   0   13   0   0  305   557    4   0   153
1     1  376   0   20   0   0   12  1026    0   0    64
2     0    7   0   33   0   0   86   311    5   0   573
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    1   0   0    2    23    1   0  1606
5     5    4   0  262   0  12   99   160    8   0    42
6     0    4   0   10   0   0  558   137    9   0  2349
7     0   23   0    8   0   0    6  1113    0   0    14
8     0    1   0  109   0   0  103   222  288   0   647
9     1   17   0  133   0   1  149   673    1   0   162
10    0    0   0    1   0   0    2     0    0   0  1643
early stop counter: 1
val acc:0.8275778889656067, best validation acc: 0.828701376914978, corresponding to test acc:                         0.2928706407546997 / 0.2928706407546997
after epoch: 20,now: 2024-07-21 08:29:30.872478,epoch time: 0:25:39.663025,used: 8:34:59.744023,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8340379, 'precision': 0.74506736, 'recall': 0.5431094, 'specificity': 0.9805648, 'f1': 0.5905601, 'auroc': 0.9685688}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   116     4   0    56   0    1    96    69     4    4    133
1     0  1074   0    15   0    0     4   220     5    1     13
2     2     2  58    43  15    8    46    35    15   33     55
3     0     3   0  7480   1   13    12   614   272    4     39
4     0     1   7    37  35    2    62    20    48    5    322
5     6     0   2   243   1  174    14     6    15   56      4
6     4    13   0    48   1    5  1383    51    40    3    359
7     1    44   0   605   2    1    17  6347    90    1    154
8     0     1   0   464   2    3    40   283  1956    3    544
9     8     1  27   148   3   62    57    16    15  145     11
10    2     1   1    64   2    1    78   116   123    0  12405
---- Validation: 
scalar performance:
{'acc': 0.8316972, 'precision': 0.7342835, 'recall': 0.54285157, 'specificity': 0.9802963, 'f1': 0.58799434, 'auroc': 0.96911037}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   113     9   0    43   1    3    93    80     3    1    137
1     1  1082   0    17   0    0     5   204     3    0     20
2     1     2  57    45  14    7    44    44    15   38     45
3     0     6   0  7462   2   12    16   628   270    3     41
4     1     2  11    35  28    3    71    24    52    6    306
5     1     0   2   254   0  174    13     1    16   57      3
6     3    17   0    39   0    3  1381    57    29    0    379
7     3    47   1   627   4    4    17  6283    95    3    181
8     1     3   1   460   0    7    32   263  1977    2    550
9     9     1  20   144   3   66    47    20    15  156     12
10    3     4   0    57   7    1   107   118   117    2  12380
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.307843, 'precision': 0.41431016, 'recall': 0.25667495, 'specificity': 0.92930484, 'f1': 0.19327179, 'auroc': 0.80762017}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   144   30   0   14   0   0  362   510    3   0   107
1     1  354   0   19   0   0   23  1048    0   0    54
2     0    5   0   34   0   0  133   327    7   0   509
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    1   0   0    3    29    1   0  1599
5     6    4   0  264   0  13  123   150    6   0    26
6     0    3   0   13   0   0  840   136   12   0  2063
7     0   21   0    8   0   0   11  1112    0   0    12
8     0    1   0  119   0   0  148   223  296   0   583
9     3   13   0  140   0   1  201   654    1   0   124
10    0    0   0    1   0   0    3     1    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-21 08:55:11.827661,epoch time: 0:25:40.955183,used: 9:00:40.699206,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8356967, 'precision': 0.73239136, 'recall': 0.5493004, 'specificity': 0.98098695, 'f1': 0.5917572, 'auroc': 0.9698372}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   108     8   1    56   1    0   107    77     6    4    115
1     0  1091   0     9   0    0     5   207     3    0     17
2     1     0  64    35  22   10    66    34    13   38     29
3     0     4   0  7448   0   16    26   617   291    1     33
4     1     1  12    41  36    4    80    29    51    4    280
5     3     0   4   245   2  171    18     2    13   60      3
6     1    14   0    40   0    2  1456    55    37    3    300
7     1    36   0   577   4    4    20  6376    93    4    148
8     2     2   1   428   0    8    39   266  2045    4    501
9     5     2  28   150   1   61    58    16    17  145     10
10    3     3   2    49   5    2   115   154   164    1  12295
---- Validation: 
scalar performance:
{'acc': 0.83584327, 'precision': 0.74587363, 'recall': 0.5546317, 'specificity': 0.98099226, 'f1': 0.59829336, 'auroc': 0.9695249}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   112     7   1    58   0    0   107    83     7    3    105
1     0  1083   0    17   0    0     1   206     5    1     19
2     2     1  69    36  11   10    48    38    24   34     39
3     0     5   0  7450   0   16    18   611   292    4     44
4     0     1  15    40  37    2    78    23    47    3    293
5     2     0   1   242   0  174    15     1    18   65      3
6     4    15   0    43   1    2  1448    52    39    1    303
7     3    46   1   563   1    3    20  6365   107    3    153
8     1     3   1   437   2    5    41   281  2054    4    467
9     5     3  30   136   3   60    52    17    10  163     14
10    2     2   3    59   4    1   118   148   161    5  12293
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32967186, 'precision': 0.4200903, 'recall': 0.26559263, 'specificity': 0.931343, 'f1': 0.20165351, 'auroc': 0.81161}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   107   32   0   15   0   0   432   516    3   0    65
1     1  366   0   19   0   0    26  1042    0   0    45
2     0    6   0   35   0   0   176   345    7   0   446
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   0   0     7    38    1   0  1586
5     3    4   0  258   0  14   138   146    8   0    21
6     0    3   0   16   0   0  1151   154   12   0  1731
7     0   20   0    8   0   0    13  1113    0   0    10
8     0    1   0  119   0   0   205   238  322   0   485
9     2   13   1  135   0   1   240   648    2   0    95
10    0    0   0    1   0   0     4     2    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-21 09:21:03.327184,epoch time: 0:25:51.499523,used: 9:26:32.198729,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8349476, 'precision': 0.75093406, 'recall': 0.5513717, 'specificity': 0.9807979, 'f1': 0.59635234, 'auroc': 0.9706592}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   124     6   0    53   0    1    83    83     7    6    120
1     0  1081   0    15   0    0     3   209     7    1     16
2     2     2  53    35   8    9    47    47    24   38     47
3     2     6   0  7338   1   22    16   664   335    3     49
4     0     2  14    37  37    1    53    21    49    4    321
5     3     0   2   223   0  189    15     2    21   64      2
6     5    20   0    43   1    2  1365    61    52    3    355
7     0    44   1   519   2    2    12  6418   107    4    155
8     1     2   0   395   0    4    20   262  2117    3    492
9     8     2  21   138   1   71    36    23    22  158     13
10    0     4   0    41   4    1    81   147   184    4  12327
---- Validation: 
scalar performance:
{'acc': 0.836405, 'precision': 0.7535207, 'recall': 0.55460835, 'specificity': 0.98098093, 'f1': 0.59886676, 'auroc': 0.97025734}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   120     6   0    54   0    1    85    82     5    4    126
1     0  1078   0    16   0    0     3   206    10    1     18
2     0     4  59    36  11    9    43    43    20   43     44
3     2     5   0  7359   0   20    17   670   319    4     44
4     0     2  13    31  25    2    56    19    73    5    313
5     3     0   2   220   0  197    10     4    15   65      5
6     6     8   0    31   2    3  1399    60    48    4    347
7     0    34   0   533   2    3    12  6386   126    2    167
8     0     2   1   387   1    5    26   274  2143    1    456
9     3     2  13   140   2   77    44    18    20  163     11
10    0     5   0    45   1    2    67   149   183    4  12340
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3189673, 'precision': 0.4125765, 'recall': 0.26510006, 'specificity': 0.9304564, 'f1': 0.20384136, 'auroc': 0.8107387}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   144   31   0   14   0   1  353   520    5   0   102
1     1  382   0   17   0   0   22  1027    0   0    50
2     0    5   0   32   0   0  133   340   10   0   495
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    33    2   0  1595
5     5    4   0  256   0  17  120   155   11   0    24
6     0    3   0   11   0   0  904   150   16   0  1983
7     0   20   0    8   0   0    9  1115    0   0    12
8     0    1   0  105   0   0  139   239  356   0   530
9     4   14   0  127   0   1  198   673    2   0   118
10    0    0   0    1   0   0    3     1    0   0  1641
better model found
persisted
after epoch: 23,now: 2024-07-21 09:46:53.430324,epoch time: 0:25:50.103140,used: 9:52:22.301869,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8379977, 'precision': 0.7440387, 'recall': 0.56642187, 'specificity': 0.98131144, 'f1': 0.61049974, 'auroc': 0.9714191}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   134     7   1    56   0    1    97    71     7    1    108
1     0  1098   0    15   0    0     7   194     7    0     11
2     3     3  54    33  23   10    40    36    19   52     39
3     0     3   0  7312   1   25    15   676   357    5     43
4     1     0   9    31  55    2    65    24    60    6    286
5     4     0   2   206   0  196    13     2    22   74      2
6     3    17   0    32   1    3  1425    55    50    2    320
7     1    36   0   512   4    1    23  6393   124    2    167
8     1     1   1   357   1    4    33   281  2172    6    439
9     4     2  24   116   3   70    39    23    17  179     16
10    1     4   1    42   8    1    87   137   208    0  12303
---- Validation: 
scalar performance:
{'acc': 0.8400963, 'precision': 0.7414439, 'recall': 0.56569755, 'specificity': 0.9815445, 'f1': 0.6084258, 'auroc': 0.97047853}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   135     8   0    47   1    1    91    76     8    3    113
1     0  1095   0    14   0    0     2   198     8    0     15
2     1     2  51    38  21    8    43    40    17   43     48
3     0     1   0  7358   1   26    14   645   350    9     36
4     1     2  12    40  48    1    60    16    57    9    293
5     4     0   1   217   1  189    11     3    20   72      3
6     6    12   0    34   1    3  1436    52    46    1    317
7     3    45   1   512   2    2    18  6415   123    3    141
8     1     5   1   365   0    6    40   270  2177    3    428
9    10     2  20   115   3   75    34    15    19  185     15
10    2     3   0    44   4    2    86   146   188    3  12318
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3435248, 'precision': 0.41432643, 'recall': 0.28008324, 'specificity': 0.93275577, 'f1': 0.22257651, 'auroc': 0.8143421}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   184   37   0   13   0   1   391   466    5   0    73
1     1  406   0   17   0   0    26  1003    1   0    45
2     0    6   0   28   0   0   165   337   10   0   469
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     7    36    4   0  1586
5    11    4   0  245   0  19   135   144   12   0    22
6     0    3   0   10   0   0  1143   144   21   0  1746
7     0   20   0    8   0   0    13  1112    0   0    11
8     0    1   0   94   0   0   187   231  406   0   451
9     5   14   1  121   0   1   236   653    3   0   103
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-21 10:12:32.338279,epoch time: 0:25:38.907955,used: 10:18:01.209824,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.83949596, 'precision': 0.75016105, 'recall': 0.5704643, 'specificity': 0.98135763, 'f1': 0.61656654, 'auroc': 0.9709996}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   122     5   2    48   0    2   107    68     4    3    122
1     0  1070   0    20   0    0     4   217     4    0     16
2     1     0  89    30  15   14    41    37    14   30     41
3     0     3   1  7435   3   31    13   647   259    4     43
4     0     1  27    32  57    2    55    25    52    5    283
5     1     0   4   211   1  222     7     4    15   53      3
6     2    17   0    31   2    6  1432    64    41    3    310
7     1    31   2   521   1    3    17  6441    87    4    156
8     0     2   2   444   5   11    33   289  2017    4    488
9     3     2  39   129   0   86    36    27     9  151     11
10    4     4   1    52   7    4    90   142   143    3  12341
---- Validation: 
scalar performance:
{'acc': 0.83766216, 'precision': 0.7344049, 'recall': 0.5651264, 'specificity': 0.9811505, 'f1': 0.6107102, 'auroc': 0.9719398}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   126     8   1    46   0    2   108    78     3    3    108
1     1  1071   0    13   0    0     5   225     4    0     13
2     3     0  83    33  19    9    43    43    12   28     39
3     0     4   1  7407   2   33    16   664   273    4     36
4     0     2  23    35  59    5    58    16    57    8    276
5     2     0   6   218   0  209    11     3    13   55      4
6     5    14   0    31   1    4  1428    58    35    2    330
7     0    35   4   527   6    1    23  6413    83    2    171
8     1     0   6   430   5    6    35   274  2026    1    512
9     7     2  43   120   4   87    45    21    10  141     13
10    0     2   1    49  10    1    88   163   125    4  12353
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33303016, 'precision': 0.5590385, 'recall': 0.2701884, 'specificity': 0.9317119, 'f1': 0.20972091, 'auroc': 0.8146966}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   133   27   0   17   0   1   419   493    3   0    77
1     1  364   0   18   0   0    26  1044    0   0    46
2     0    4   2   30   0   0   165   335    7   0   472
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   1   0     7    37    1   0  1586
5     5    4   0  262   0  25   131   136    6   0    23
6     0    3   0   15   0   0  1149   144   12   0  1744
7     0   15   0    8   0   0    13  1117    0   0    11
8     0    1   0  119   0   0   194   234  329   0   493
9     3   11   2  127   0   1   232   651    1   0   109
10    0    0   0    1   0   0     4     1    0   0  1640
early stop counter: 1
val acc:0.8376621603965759, best validation acc: 0.8400962948799133, corresponding to test acc:                         0.3435248136520386 / 0.3435248136520386
after epoch: 25,now: 2024-07-21 10:38:07.864460,epoch time: 0:25:35.526181,used: 10:43:36.736005,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.8411815, 'precision': 0.7352884, 'recall': 0.56599224, 'specificity': 0.98153937, 'f1': 0.61059415, 'auroc': 0.97238684}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   146     4   1    45   0    1    75    83     7    1    120
1     0  1096   0    15   0    0     3   198     5    1     14
2     4     3  84    33  15    5    31    44    15   36     42
3     1     8   1  7446   0   13    17   625   294    3     30
4     0     0  21    32  32    0    65    20    50    6    313
5     3     0   5   232   1  177    12     3    13   72      3
6     7    15   0    45   2    0  1427    53    41    4    314
7     2    38   3   505   1    0    19  6418   106    3    167
8     0     0   2   398   1    2    43   258  2103    9    480
9    15     1  43   134   2   60    34    16    19  155     14
10    3     4   2    49   6    1    83   132   152    4  12356
---- Validation: 
scalar performance:
{'acc': 0.84089875, 'precision': 0.7512673, 'recall': 0.5747741, 'specificity': 0.9815016, 'f1': 0.6219793, 'auroc': 0.97234774}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   156     5   1    45   0    1    73    77    10    1    114
1     0  1092   0    12   0    0     4   199     8    1     16
2     4     0  90    32  10   11    33    38    21   28     45
3     1     4   0  7383   0   18    21   663   313    3     34
4     1     0  20    27  47    0    63    18    50   10    303
5     7     0   5   225   0  175     5     4    13   83      4
6     5     9   0    42   2    1  1442    49    36    4    318
7     2    35   3   521   3    1    17  6417    93    4    169
8     0     1   2   406   3    2    35   268  2101    6    472
9    10     1  40   127   1   53    40    22    12  173     14
10    3     1   4    54   7    0    84   133   147    2  12361
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34401456, 'precision': 0.42085505, 'recall': 0.2812803, 'specificity': 0.9328572, 'f1': 0.22573699, 'auroc': 0.81533766}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   253   34   0   16   0   0   364   422    4   0    77
1     1  422   0   18   0   0    26   986    1   0    45
2     0    5   0   30   0   0   161   325    7   0   487
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   0   0     6    32    1   0  1593
5    17    4   0  270   0  14   128   128    9   0    22
6     0    3   0   12   0   0  1130   133   13   0  1776
7     0   20   0    8   0   0    12  1112    0   0    12
8     0    1   0  117   0   0   191   219  346   0   496
9     7   14   2  133   0   1   236   628    1   0   115
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-21 11:04:00.141411,epoch time: 0:25:52.276951,used: 11:09:29.012956,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.841128, 'precision': 0.7512312, 'recall': 0.5670111, 'specificity': 0.98153454, 'f1': 0.6124563, 'auroc': 0.9723159}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   145     5   0    47   0    2    74    77     4    3    126
1     0  1083   0    11   0    0     4   214     6    0     14
2     3     4  61    26  13   10    41    49    12   45     48
3     0     3   0  7289   1   25    10   742   325    4     39
4     0     0  12    21  44    4    64    25    61    5    303
5     2     0   2   212   0  200     6     3    20   74      1
6     4    14   0    30   1    6  1417    53    40    4    338
7     4    27   1   408   2    3    19  6526   112    2    161
8     0     0   2   335   1   13    29   290  2123    4    498
9     8     2  26   117   0   77    44    21    18  170     10
10    2     2   1    39   5    2    76   156   128    1  12380
---- Validation: 
scalar performance:
{'acc': 0.8389461, 'precision': 0.75322783, 'recall': 0.56982267, 'specificity': 0.9812479, 'f1': 0.61633587, 'auroc': 0.9724775}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   142     6   0    45   0    1    69    77     3    5    135
1     0  1086   0    13   0    0     3   206     5    1     18
2     3     2  68    26  14   10    36    42    20   47     44
3     1     7   0  7252   0   27    15   759   329    3     47
4     0     0  15    29  46    4    48    34    47    8    308
5     3     0   3   211   0  214     7     5    14   62      2
6     6    10   0    27   0    3  1391    65    47    2    357
7     1    40   0   421   1    2    17  6515    88    3    177
8     0     1   2   358   2    5    26   312  2102    9    479
9     6     1  26   114   3   81    38    21    15  175     13
10    3     3   1    32   5    2    78   140   156    3  12373
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33603862, 'precision': 0.41960013, 'recall': 0.27634212, 'specificity': 0.93207, 'f1': 0.21852182, 'auroc': 0.8148351}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   195   28   0   10   0   1   351   488    5   0    92
1     1  395   0   12   0   0    25  1019    1   0    46
2     0    5   0   25   0   0   146   337    8   0   494
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     4    36    2   0  1591
5    10    4   0  241   0  23   127   153   10   0    24
6     0    3   0    8   0   0  1069   145   17   0  1825
7     0   15   0    6   0   0    10  1121    0   0    12
8     0    1   0   88   0   0   168   245  360   0   508
9     5   11   1  100   0   1   217   678    2   0   122
10    0    0   0    1   0   0     4     1    0   0  1640
early stop counter: 1
val acc:0.8389461040496826, best validation acc: 0.8408987522125244, corresponding to test acc:                         0.34401455521583557 / 0.34401455521583557
after epoch: 27,now: 2024-07-21 11:29:22.428338,epoch time: 0:25:22.286927,used: 11:34:51.299883,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8411012, 'precision': 0.74251807, 'recall': 0.57008016, 'specificity': 0.9813505, 'f1': 0.61576974, 'auroc': 0.9727602}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   139     6   1    47   0    2    86    66     4    4    128
1     0  1098   0    12   0    0     5   191     6    0     18
2     2     1  81    35  14   14    36    33    18   36     42
3     2     3   0  7541   1   31    19   545   250    2     42
4     1     3  26    34  41    1    46    12    39    8    328
5     2     0   3   212   0  223     6     3    10   56      6
6     3    12   0    42   1    2  1413    42    38    3    352
7     5    34   2   614   4    5    10  6289    96    4    202
8     0     0   2   422   4    7    40   249  2020    3    548
9     5     1  39   125   2   94    33    17     8  152     17
10    1     1   3    52   5    2    75   108   106    1  12440
---- Validation: 
scalar performance:
{'acc': 0.8420757, 'precision': 0.72896236, 'recall': 0.5682128, 'specificity': 0.9815427, 'f1': 0.61154556, 'auroc': 0.97346336}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   138     3   0    51   0    3    92    57     5    1    133
1     0  1098   0    16   0    0     4   192     4    0     18
2     3     2  84    38  20    7    39    37     9   33     40
3     0     2   0  7569   1   30    21   495   280    4     38
4     1     0  26    35  36    4    53    18    40    9    317
5     4     0   5   207   0  215     8     4    12   63      3
6     5     8   0    33   1    5  1429    45    37    3    342
7     4    32   6   575   1    5    16  6332    99    3    192
8     1     2   1   443   4    5    37   235  2033    1    534
9     9     2  36   123   3  102    38    13    11  142     14
10    4     3   1    49   5    3    86   108   131    1  12405
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34142587, 'precision': 0.42455134, 'recall': 0.28022245, 'specificity': 0.93256354, 'f1': 0.22674726, 'auroc': 0.81577945}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   247   28   0   22   0   1   372   403    3   0    94
1     1  415   0   21   0   0    28   975    0   0    59
2     1    3   0   38   0   0   158   286    7   0   522
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   0   0     4    24    1   0  1603
5    12    4   0  285   0  25   129   102    8   0    27
6     0    3   0   16   0   0  1117   100   10   0  1821
7     0   15   0   10   0   0    15  1112    0   0    12
8     0    0   0  132   0   0   193   186  323   0   536
9     7   11   2  156   0   1   256   572    1   0   131
10    0    0   0    1   0   0     4     0    0   0  1641
better model found
persisted
after epoch: 28,now: 2024-07-21 11:54:50.811670,epoch time: 0:25:28.383332,used: 12:00:19.683215,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.84527504, 'precision': 0.75136733, 'recall': 0.58239454, 'specificity': 0.982052, 'f1': 0.6293373, 'auroc': 0.97341454}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   153     6   1    49   0    1    80    65     5    3    119
1     1  1092   0    14   0    0     4   197     8    0     16
2     3     3  78    32  20   10    29    33    17   49     38
3     1     1   1  7449   2   22    15   597   312    2     38
4     0     0  19    32  63    2    55    18    55    6    289
5     4     0   1   206   0  208     8     1    15   75      3
6     7     9   0    34   1    4  1440    47    44    3    318
7     2    44   1   510   2    3    21  6405   114    3    158
8     0     1   3   368   0    9    44   245  2151    4    469
9     9     1  29   120   3   71    29    20    17  179     15
10    4     3   2    43   8    2    69   127   155    5  12375
---- Validation: 
scalar performance:
{'acc': 0.8446703, 'precision': 0.7499114, 'recall': 0.58011496, 'specificity': 0.98196965, 'f1': 0.62661254, 'auroc': 0.9730061}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   154     6   1    51   0    3    73    68     2    2    123
1     0  1083   0    14   0    0     4   212     5    0     14
2     3     2  87    30  13    3    30    35    12   51     46
3     0     4   0  7448   1   21    13   584   329    3     37
4     0     2  28    30  57    2    48    24    48    5    295
5     2     0   8   210   2  199     7     1    18   72      2
6     3    12   0    34   1    3  1443    49    51    5    307
7     1    49   2   512   3    5    15  6383   109    2    184
8     2     0   1   380   1    8    23   252  2180    7    442
9    11     0  35   126   1   80    25    19    15  166     15
10    5     1   0    40   7    1    71   135   156    2  12378
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3527601, 'precision': 0.51303816, 'recall': 0.28772262, 'specificity': 0.93373084, 'f1': 0.234281, 'auroc': 0.8179916}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   253   29   0   19   0   1   368   416    5   0    79
1     1  420   0   19   0   0    28   985    1   0    45
2     1    3   0   30   0   0   163   310   10   0   498
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    29    2   0  1595
5    13    4   0  279   0  20   127   114   12   0    23
6     0    3   0   15   0   0  1196   121   16   0  1716
7     0   16   0    9   0   0    12  1116    0   0    11
8     0    1   0  108   0   0   191   203  396   0   471
9     7   12   1  142   0   1   245   605    2   0   122
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-21 12:20:26.467978,epoch time: 0:25:35.656308,used: 12:25:55.339523,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8463988, 'precision': 0.75387895, 'recall': 0.58606356, 'specificity': 0.98220426, 'f1': 0.6332953, 'auroc': 0.973401}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   162     2   1    40   0    2    71    81     4    2    117
1     0  1078   0    13   0    0     5   210    10    0     16
2     4     0  81    30  17    7    28    45    20   41     39
3     0     3   1  7358   2   34    19   668   319    1     30
4     0     0  20    36  59    3    53    32    45    4    287
5     3     0   4   194   1  225     6     3    17   63      5
6     8     6   1    25   2    3  1462    59    42    1    299
7     3    24   3   457   2    2    22  6476   114    3    158
8     1     2   4   332   2    8    27   270  2188    4    457
9     6     1  30   119   2   82    44    18    10  167     14
10    2     1   1    41   9    3    82   120   155    2  12379
---- Validation: 
scalar performance:
{'acc': 0.8470777, 'precision': 0.7582978, 'recall': 0.5886286, 'specificity': 0.98224187, 'f1': 0.6368872, 'auroc': 0.9733081}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   158     1   2    37   1    3    83    69    11    6    112
1     1  1077   0    14   0    0     2   214     7    1     16
2     6     1  81    32  21    6    34    31    17   42     41
3     3     1   0  7376   1   33    18   656   312    6     34
4     0     0  15    29  65    3    56    25    50    6    290
5     5     0   5   202   0  217     5     4    15   65      3
6     6    12   0    25   1    2  1452    49    44    1    316
7     3    14   3   469   1    2    27  6488    98    2    158
8     1     2   2   349   1    7    30   254  2171    8    471
9     8     1  27   112   1   74    34    21     8  191     16
10    4     2   1    45   9    0    79   134   129    1  12392
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36122578, 'precision': 0.5615855, 'recall': 0.2918617, 'specificity': 0.9344919, 'f1': 0.23785019, 'auroc': 0.81907004}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   255   23   0   14   0   1   382   420    5   0    70
1     1  383   0   18   0   0    30  1023    1   0    43
2     1    2   1   27   0   0   175   318   11   0   480
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    29    3   0  1591
5    14    4   0  257   0  23   139   121   12   0    22
6     0    3   0   10   0   0  1318   125   18   0  1593
7     0   11   0    7   0   0    13  1122    0   0    11
8     0    0   0   97   0   0   206   210  420   0   437
9     7   10   1  119   0   1   263   617    3   0   116
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-21 12:46:08.063327,epoch time: 0:25:41.595349,used: 12:51:36.934872,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:51:36.934872 at 2024-07-21 12:46:08.063327
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36122578, 'precision': 0.5615855, 'recall': 0.2918617, 'specificity': 0.9344919, 'f1': 0.23785019, 'auroc': 0.81907004}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   255   23   0   14   0   1   382   420    5   0    70
1     1  383   0   18   0   0    30  1023    1   0    43
2     1    2   1   27   0   0   175   318   11   0   480
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    29    3   0  1591
5    14    4   0  257   0  23   139   121   12   0    22
6     0    3   0   10   0   0  1318   125   18   0  1593
7     0   11   0    7   0   0    13  1122    0   0    11
8     0    0   0   97   0   0   206   210  420   0   437
9     7   10   1  119   0   1   263   617    3   0   116
10    0    0   0    1   0   0     4     1    0   0  1640
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36122578, 'precision': 0.5615855, 'recall': 0.2918617, 'specificity': 0.9344919, 'f1': 0.23785019, 'auroc': 0.81907004}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   255   23   0   14   0   1   382   420    5   0    70
1     1  383   0   18   0   0    30  1023    1   0    43
2     1    2   1   27   0   0   175   318   11   0   480
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    29    3   0  1591
5    14    4   0  257   0  23   139   121   12   0    22
6     0    3   0   10   0   0  1318   125   18   0  1593
7     0   11   0    7   0   0    13  1122    0   0    11
8     0    0   0   97   0   0   206   210  420   0   437
9     7   10   1  119   0   1   263   617    3   0   116
10    0    0   0    1   0   0     4     1    0   0  1640
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562329_instance_wise_predictions.txt
accuracy from prediction file 0.36122577485482404
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/1.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193441 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 744792 GiB | 744791 GiB |
|       from small pool |  19041 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193441 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 744792 GiB | 744791 GiB |
|       from small pool |  19041 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 190583 KiB | 459649 KiB | 760391 GiB | 760391 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 744783 GiB | 744783 GiB |
|       from small pool |  17769 KiB |  37832 KiB |  15608 GiB |  15608 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 514048 KiB | 514048 KiB | 514048 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  40960 KiB |  40960 KiB |  40960 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37982 KiB |  74166 KiB | 411658 GiB | 411658 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 396009 GiB | 396009 GiB |
|       from small pool |   7582 KiB |   9471 KiB |  15648 GiB |  15648 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4034    |    6277    |  142891 K  |  142887 K  |
|       from large pool |      76    |     158    |   73409 K  |   73408 K  |
|       from small pool |    3958    |    6126    |   69482 K  |   69478 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4034    |    6277    |  142891 K  |  142887 K  |
|       from large pool |      76    |     158    |   73409 K  |   73408 K  |
|       from small pool |    3958    |    6126    |   69482 K  |   69478 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      41    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      20    |      20    |      20    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      24    |    1293    |   73402 K  |   73402 K  |
|       from large pool |       9    |      19    |   45567 K  |   45567 K  |
|       from small pool |      15    |    1285    |   27835 K  |   27835 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 744792 GiB | 744791 GiB |
|       from small pool |      0 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 744792 GiB | 744791 GiB |
|       from small pool |      0 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB | 760391 GiB | 760391 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 744783 GiB | 744783 GiB |
|       from small pool |      0 KiB |  37832 KiB |  15608 GiB |  15608 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 514048 KiB | 514048 KiB | 282624 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  40960 KiB |  40960 KiB |  14336 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82004 KiB | 411658 GiB | 411658 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 396009 GiB | 396009 GiB |
|       from small pool |      0 KiB |  21843 KiB |  15648 GiB |  15648 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  142891 K  |  142891 K  |
|       from large pool |       2    |     158    |   73409 K  |   73409 K  |
|       from small pool |       0    |    6126    |   69482 K  |   69482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  142891 K  |  142891 K  |
|       from large pool |       2    |     158    |   73409 K  |   73409 K  |
|       from small pool |       0    |    6126    |   69482 K  |   69482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      41    |      41    |      18    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      20    |      20    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1293    |   73403 K  |   73403 K  |
|       from large pool |       3    |      19    |   45567 K  |   45567 K  |
|       from small pool |       0    |    1285    |   27836 K  |   27836 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 744792 GiB | 744791 GiB |
|       from small pool |      0 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 744792 GiB | 744791 GiB |
|       from small pool |      0 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB | 760391 GiB | 760391 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 744783 GiB | 744783 GiB |
|       from small pool |      0 KiB |  37832 KiB |  15608 GiB |  15608 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 514048 KiB | 514048 KiB | 282624 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  40960 KiB |  40960 KiB |  14336 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82004 KiB | 411658 GiB | 411658 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 396009 GiB | 396009 GiB |
|       from small pool |      0 KiB |  21843 KiB |  15648 GiB |  15648 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  142891 K  |  142891 K  |
|       from large pool |       2    |     158    |   73409 K  |   73409 K  |
|       from small pool |       0    |    6126    |   69482 K  |   69482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  142891 K  |  142891 K  |
|       from large pool |       2    |     158    |   73409 K  |   73409 K  |
|       from small pool |       0    |    6126    |   69482 K  |   69482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      41    |      41    |      18    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      20    |      20    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1293    |   73403 K  |   73403 K  |
|       from large pool |       3    |      19    |   45567 K  |   45567 K  |
|       from small pool |       0    |    1285    |   27836 K  |   27836 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329

 Experiment start at: 2024-07-21 13:15:38.602096
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5332299, 'precision': 0.23361728, 'recall': 0.17441697, 'specificity': 0.9393531, 'f1': 0.15386799, 'auroc': 0.76789945}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    49   0   0   1    34   1   0    398
1    0   3   0    66   0   0   0   321   4   0    938
2    0   1   0    95   0   0   0    35   8   0    173
3    0   2   0  5299   0   0   0  1254  45   0   1839
4    0   0   0    80   0   0   1    24   5   0    429
5    0   0   0   399   0   0   0    38   7   0     77
6    0   0   0   314   0   0   4    47  20   0   1522
7    0   1   0  1650   0   0   1  2303  20   0   3287
8    0   0   0   881   0   0   0   150  27   0   2237
9    0   0   0   240   0   0   0    55   5   0    193
10   0   0   0   280   0   0   4   197  18   0  12294
---- Validation: 
scalar performance:
{'acc': 0.5339575, 'precision': 0.28256595, 'recall': 0.17447084, 'specificity': 0.9394089, 'f1': 0.15356578, 'auroc': 0.7715326}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    67   0   0   0    40   0   0    376
1    0   2   0    73   0   0   1   316   1   0    939
2    0   0   0    96   0   0   0    35   6   0    175
3    0   0   0  5355   0   0   1  1210  39   0   1835
4    0   0   0    83   0   0   0    20   4   0    432
5    0   0   0   389   0   0   0    44   4   0     84
6    0   0   0   291   0   0   5    54  20   0   1538
7    0   0   0  1661   0   0   2  2263  16   0   3323
8    0   0   0   851   0   0   5   178  22   0   2240
9    0   0   0   262   0   0   0    44   7   0    180
10   0   0   0   288   0   0   1   177  15   0  12315
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.13971874, 'precision': 0.030380232, 'recall': 0.12230183, 'specificity': 0.91227734, 'f1': 0.046027586, 'auroc': 0.5694421}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   0   0   8   0   0   0   86   1   0  1075
1    0   0   0  10   0   0   0  347   0   0  1142
2    0   0   0   3   0   0   0  138   0   0   874
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   0   0   0   0   97   0   0  1536
5    0   0   0  51   0   0   0   89   0   0   452
6    0   0   0   8   0   0   0  521   0   0  2538
7    0   0   0  14   0   0   0  525   0   0   625
8    0   0   0  49   0   0   0  266   0   0  1055
9    0   0   0  18   0   0   0  290   0   0   829
10   0   0   0   0   0   0   0  174   0   0  1472
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 13:42:56.013648,epoch time: 0:27:17.411552,used: 0:27:17.411552,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6291203, 'precision': 0.36528102, 'recall': 0.22541896, 'specificity': 0.952813, 'f1': 0.21293935, 'auroc': 0.8587976}
confusion matrix:
    0    1   2     3   4   5   6     7    8   9      10
0    0    0   0    74   0   0   1    57    2   0    349
1    0  126   0    84   0   0   0   715    3   0    403
2    0    0   0    99   0   0   1    27    6   0    179
3    0    4   0  6545   0   0   1  1211   35   0    643
4    0    0   0    72   0   0   2     6    8   0    451
5    0    0   0   446   0   0   0     9    7   0     58
6    0    5   0   261   0   0  52    31   30   0   1528
7    0    6   0  1780   0   0   2  4107   11   0   1356
8    0    0   0   947   0   0   6   160  112   0   2070
9    0    0   0   308   0   1   1    24   10   0    149
10   0    0   0   143   0   0   1    61   18   0  12572
---- Validation: 
scalar performance:
{'acc': 0.6282199, 'precision': 0.4822899, 'recall': 0.22486165, 'specificity': 0.9527004, 'f1': 0.21208352, 'auroc': 0.8607067}
confusion matrix:
    0    1   2     3   4   5   6     7   8   9      10
0    0    0   0    74   0   0   2    55   1   0    351
1    0  120   0    78   0   0   1   698   1   0    434
2    0    0   0   104   0   0   1    31   4   0    172
3    0    4   0  6540   0   1   1  1212  46   0    636
4    0    0   0    77   0   0   1     7   6   0    448
5    0    0   0   448   0   2   0     5   8   0     58
6    0    3   0   253   0   0  48    25  37   0   1542
7    0    4   0  1794   0   0   2  4120  15   0   1330
8    0    1   0   950   0   0   7   158  95   0   2085
9    0    0   0   297   0   2   2    30   6   1    155
10   0    1   0   158   0   0   3    62  12   0  12560
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18246694, 'precision': 0.062323604, 'recall': 0.1666407, 'specificity': 0.91688466, 'f1': 0.06192429, 'auroc': 0.65245503}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   3   0  10   0   0   0   362   1   0   794
1    0   5   0  10   0   0   0  1027   0   0   457
2    0   0   0   3   0   0   0   150   1   0   861
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    23   0   0  1610
5    0   0   0  84   0   0   0   195   1   0   312
6    0   0   0   5   0   0   0   202   0   0  2860
7    0  10   0   9   0   0   0   987   0   0   158
8    0   1   0  41   0   0   1   212   0   0  1115
9    0   0   0  33   0   0   0   514   0   0   590
10   0   0   0   0   0   0   0    30   0   0  1616
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 14:08:25.162876,epoch time: 0:25:29.149228,used: 0:52:46.560780,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.679527, 'precision': 0.5006449, 'recall': 0.2774237, 'specificity': 0.96018434, 'f1': 0.28457254, 'auroc': 0.8985089}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    2   0    67   0   0   12   131    2   0    269
1    0  360   0    43   0   0    1   795    2   0    131
2    0    0   0   100   0   0    4    51   15   1    141
3    0    3   0  6407   0   0    2  1657   76   0    294
4    0    0   0    67   0   0    4     8    6   0    454
5    0    0   0   419   0  12    5    21   22   1     41
6    0    9   0   183   0   0  277    85   49   0   1304
7    0   15   0  1189   0   0    5  5490   32   0    532
8    0    0   0   892   0   0    8   300  388   0   1708
9    0    1   0   275   0   8   19    55   18   3    114
10   0    2   0   150   0   0   12   126   40   0  12461
---- Validation: 
scalar performance:
{'acc': 0.68153, 'precision': 0.4903547, 'recall': 0.27606225, 'specificity': 0.9604226, 'f1': 0.28108704, 'auroc': 0.8985655}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    4   0    65   0   0   14   118    2   0    280
1    0  349   0    45   0   0    1   816    1   0    120
2    0    0   0    91   0   1    7    66   10   0    137
3    0    4   0  6448   0   1    4  1599   92   0    292
4    0    0   0    75   0   0    3    11    7   0    443
5    0    0   0   441   0   7    3    26   10   2     32
6    0   11   0   196   0   0  256    80   49   0   1316
7    0   21   0  1142   0   0    2  5576   34   0    490
8    0    2   0   843   0   0   13   294  382   0   1762
9    0    0   0   275   0   4   14    65   13   3    119
10   0    3   0   143   0   0   21   138   33   0  12458
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19261177, 'precision': 0.1596559, 'recall': 0.17759314, 'specificity': 0.918398, 'f1': 0.0633419, 'auroc': 0.6895831}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   9   0   6   0   0  11   764   2   0   378
1    0  23   0   7   0   0   0  1364   0   0   105
2    0   1   0   3   0   0   0   357   2   0   652
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    61   0   0  1572
5    0   1   0  61   0   0   1   399   3   0   127
6    0   0   0   4   0   0   7   466   1   0  2589
7    0  15   0   2   0   0   0  1112   0   0    35
8    0   2   0  33   0   0   4   393  15   0   923
9    0   1   0  19   0   0   0   878   1   0   238
10   0   0   0   0   0   0   0    50   0   0  1596
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 14:33:46.706883,epoch time: 0:25:21.544007,used: 1:18:08.104787,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7130779, 'precision': 0.5055183, 'recall': 0.32254213, 'specificity': 0.96461535, 'f1': 0.33851826, 'auroc': 0.9196163}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    8   0    89   0   0   25    98    5   0    258
1    0  663   0    36   0   0    2   561    2   0     68
2    0    2   0   107   0   0   18    44   18   1    122
3    0    4   0  7003   0   2    2  1081  178   0    168
4    0    0   0    84   0   0    6    11   13   0    425
5    0    2   0   450   0   7    9     7   19   6     21
6    0   26   0   166   0   0  484    59   70   0   1103
7    0   38   0  1385   0   0    2  5318   51   0    469
8    0    1   0   867   0   0   13   223  726   0   1464
9    0    2   0   291   0   5   35    38   30  14     78
10   0    4   0   156   0   0   23   107   66   0  12437
---- Validation: 
scalar performance:
{'acc': 0.71394944, 'precision': 0.59682804, 'recall': 0.32052884, 'specificity': 0.9647161, 'f1': 0.33560926, 'auroc': 0.9168468}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    1   11   0    79   0   0   19   115    7   0    251
1    0  655   0    46   0   0    0   557    6   0     68
2    0    1   0   121   0   0    3    40   19   2    126
3    0    8   0  7017   0   0    1  1072  165   0    177
4    0    0   0    66   0   0    6    17   28   0    422
5    0    2   0   446   0   8   10    10   23   3     19
6    0   15   0   185   0   1  450    68   76   0   1113
7    0   40   0  1354   0   0    4  5364   51   0    452
8    0    1   0   878   0   0    8   215  729   0   1465
9    0    5   1   300   0   6   33    42   31   8     67
10   0    2   0   153   1   0   26   101   54   0  12459
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2017771, 'precision': 0.17725968, 'recall': 0.18474147, 'specificity': 0.91927844, 'f1': 0.07844338, 'auroc': 0.7138906}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0  27   0   6   0   0  31   738   2   0   366
1    0  97   0  11   0   0   0  1297   0   0    94
2    0   5   0  12   0   0   0   317   7   0   674
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    39   1   0  1593
5    0   9   0  93   0   0   1   367   6   0   116
6    0   1   0   8   0   0  22   311   5   0  2720
7    0  38   0   4   0   0   0  1088   0   0    34
8    0   4   0  57   0   0   8   325  55   0   921
9    0   7   0  43   0   0   1   829   4   0   253
10   0   0   0   0   0   0   0    24   0   0  1622
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 14:59:09.014578,epoch time: 0:25:22.307695,used: 1:43:30.412482,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.73680973, 'precision': 0.6958544, 'recall': 0.3570236, 'specificity': 0.9677651, 'f1': 0.38106835, 'auroc': 0.9304908}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    1    7   0    65   0   0   48   123    3   0    236
1    0  719   0    36   0   0    1   521    3   0     51
2    0    1   1    92   0   4   25    46   19   1    123
3    0    7   0  6992   0   4    5  1067  210   2    150
4    0    0   0    71   0   0   18    12   25   0    413
5    0    1   0   406   0  44   18     9   15   9     19
6    0   17   0   128   0   0  738    56   47   2    920
7    0   37   0  1104   0   1    8  5674   52   0    389
8    0    1   0   780   0   1   22   228  918   0   1345
9    0    2   0   266   0  31   57    38   24  25     49
10   0    4   0   123   0   0   48   118   73   0  12427
---- Validation: 
scalar performance:
{'acc': 0.7363916, 'precision': 0.6878886, 'recall': 0.3550881, 'specificity': 0.96773314, 'f1': 0.3774266, 'auroc': 0.92995596}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    1    5   0    70   0   0   56   116    2   0    233
1    0  721   0    39   0   0    1   526    1   0     44
2    0    2   1    92   0   1   25    48   20   3    120
3    0    6   0  6961   0   5    6  1087  206   1    168
4    0    0   0    66   0   0   21     8   19   0    425
5    0    1   0   395   0  38   20     9   27  10     21
6    0   16   0   126   0   0  740    68   50   0    908
7    0   38   0  1095   0   2    6  5686   52   0    386
8    0    1   0   744   0   0   24   256  925   0   1346
9    0    2   0   271   0  27   59    38   27  19     50
10   0    5   0   112   0   1   49   105   86   0  12438
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20695445, 'precision': 0.32562223, 'recall': 0.18880957, 'specificity': 0.9197625, 'f1': 0.084962495, 'auroc': 0.7286314}
confusion matrix:
    0    1   2   3   4   5   6     7   8   9     10
0    1   26   0   5   0   1  71   759   1   0   306
1    0  116   0  10   0   0   1  1288   0   0    84
2    0    5   0  11   0   0   1   328   6   0   664
3    0    0   0   0   0   0   0     0   0   0     0
4    0    0   0   0   0   0   0    36   1   0  1596
5    0    7   0  91   0   1   2   371   8   1   111
6    0    0   0   8   0   0  46   289   4   0  2720
7    0   36   0   3   0   0   0  1095   0   0    30
8    0    4   0  54   0   0  13   324  74   0   901
9    0    6   0  42   0   0   1   851   3   0   234
10   0    0   0   0   0   0   1    20   0   0  1625
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 15:24:37.111433,epoch time: 0:25:28.096855,used: 2:08:58.509337,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7561537, 'precision': 0.6140065, 'recall': 0.38280335, 'specificity': 0.9704056, 'f1': 0.40459645, 'auroc': 0.9384601}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    2   11   0    62   0   1   61   137     2   0    207
1    0  840   0    24   0   0    1   424     3   0     39
2    0    7   0    79   0   7   42    60    20   2     95
3    0   10   0  6964   0   2   10  1111   223   0    118
4    0    0   0    65   0   0   30    21    34   0    389
5    0    0   0   379   0  53   25    11    25  14     14
6    0   19   0    93   0   0  898    69    48   0    781
7    0   56   0   829   0   0    7  5990    61   0    321
8    0    3   0   655   0   0   27   323  1066   1   1219
9    0    0   0   246   0  25   76    45    20  29     52
10   0   10   0    88   0   0   67   126    82   0  12420
---- Validation: 
scalar performance:
{'acc': 0.75372475, 'precision': 0.5096605, 'recall': 0.3802179, 'specificity': 0.97010833, 'f1': 0.40120196, 'auroc': 0.93984}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0    9   0    67   0   0   68   126     4   0    209
1    0  846   0    28   0   0    0   413     2   1     42
2    0    5   0    76   0   4   37    69    16   6     99
3    0    7   0  6973   0   3    7  1111   217   0    122
4    0    0   0    61   0   0   27    19    30   0    402
5    0    0   0   381   0  48   28     9    19  14     22
6    0   24   0   104   0   0  879    71    43   1    786
7    0   57   0   896   0   0    4  5934    70   2    302
8    0    1   0   683   0   0   27   290  1083   0   1212
9    1    2   0   251   0  33   62    52    25  27     40
10   0    7   0    98   0   0   61   155    87   0  12388
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21611978, 'precision': 0.28823236, 'recall': 0.1960396, 'specificity': 0.92069346, 'f1': 0.09673619, 'auroc': 0.7402474}
confusion matrix:
    0    1   2   3   4   5   6     7   8   9     10
0    1   58   0   2   0   0  89   768   1   0   251
1    0  214   0   8   0   0   0  1210   0   0    67
2    0   10   0   9   0   0   4   367   4   0   621
3    0    0   0   0   0   0   0     0   0   0     0
4    0    0   0   0   0   0   0    40   1   0  1592
5    0    9   0  90   0   0   8   395   6   1    83
6    0    4   0   9   0   0  66   339   4   0  2645
7    0   50   0   3   0   0   0  1089   0   0    22
8    0    8   0  54   0   0  16   353  93   0   846
9    0   16   0  28   0   0   5   897   2   0   189
10   0    0   0   0   0   0   1    19   0   0  1626
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 15:50:22.440310,epoch time: 0:25:45.328877,used: 2:34:43.838214,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7711366, 'precision': 0.5998059, 'recall': 0.4096206, 'specificity': 0.9724114, 'f1': 0.4314282, 'auroc': 0.9448736}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    9   11   0    71   0   0    93   112     2   0    185
1    0  945   0    20   0   0     2   328     1   0     36
2    0    5   0    75   0   7    62    52    19  11     81
3    0    9   0  7120   0   7    13   967   210   1    110
4    0    0   0    62   0   0    43    19    26   0    389
5    0    1   0   364   0  64    28     9    20  26      9
6    0   25   0    91   0   0  1072    53    26   1    638
7    0   56   0   874   0   1    11  5989    56   0    276
8    0    4   0   675   0   1    37   293  1205   0   1081
9    1    6   0   234   0  35    81    34    19  45     38
10   0    6   0   107   0   0    78   137    93   0  12373
---- Validation: 
scalar performance:
{'acc': 0.7684633, 'precision': 0.63745296, 'recall': 0.40739128, 'specificity': 0.9720963, 'f1': 0.4298185, 'auroc': 0.9445302}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   11   10   0    71   0   2    91   119     4   0    175
1    0  936   0    26   0   0     0   334     4   1     31
2    0    5   1    76   0   6    48    53    18  11     94
3    0   12   0  7156   0   5    12   933   218   0    104
4    0    1   0    55   0   0    43    18    29   0    393
5    0    0   0   370   0  70    27     5    23  20      6
6    0   24   0    88   0   0  1049    62    33   0    652
7    0   71   0   905   0   2     9  5912    70   1    295
8    0    2   0   680   0   2    43   302  1183   0   1084
9    0    7   2   245   0  39    72    44    15  40     29
10   0    9   0   115   0   0    82   140    79   0  12371
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22619464, 'precision': 0.35711962, 'recall': 0.20334645, 'specificity': 0.92161214, 'f1': 0.10991925, 'auroc': 0.75129986}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   81   0    2   0   1  160   699    1   0   223
1    0  295   0    8   0   0    1  1131    0   0    64
2    0   14   0   17   0   0   10   351    6   0   617
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    0    39    0   0  1593
5    0   12   0  120   0   3   19   357    6   1    74
6    0    8   0   11   0   0  117   299    3   0  2629
7    0   66   0    4   0   0    0  1075    0   0    19
8    0   11   0   73   0   0   37   314  111   0   824
9    0   25   0   56   0   0   14   855    2   0   185
10   0    0   0    0   0   0    2    15    0   0  1629
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-21 16:15:47.535844,epoch time: 0:25:25.095534,used: 3:00:08.933748,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.7768354, 'precision': 0.647552, 'recall': 0.42359933, 'specificity': 0.9731231, 'f1': 0.45110995, 'auroc': 0.9513778}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   19    9   0    55   0    0    74   126     7   0    193
1    0  960   0    12   0    0     1   326     4   0     29
2    0    4   7    73   1    7    45    52    19  10     94
3    0    6   0  7043   0   14    18   989   276   1     90
4    0    0   2    58   0    0    37    12    35   0    395
5    0    0   0   327   0  103    19     4    27  32      9
6    1   29   0    72   0    0  1024    65    41   0    676
7    0   66   0   767   1    1     8  6014    89   0    317
8    0    2   0   551   0    1    25   284  1412   1   1020
9    0    5   5   212   1   59    75    34    24  40     38
10   0    6   0    90   0    1    52   134    96   0  12413
---- Validation: 
scalar performance:
{'acc': 0.7799652, 'precision': 0.67598784, 'recall': 0.42647803, 'specificity': 0.9734667, 'f1': 0.4569223, 'auroc': 0.9490751}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   22   12   0    63   0    3    78   114     6   0    185
1    0  936   1    14   0    0     2   348     3   0     28
2    0    5   7    73   1    8    43    48    20  11     96
3    0    8   0  7078   0    7     6   962   279   0    100
4    0    0   1    57   0    0    34    20    30   1    396
5    0    0   0   340   0  101    20     8    19  25      8
6    0   23   0    73   0    0  1052    63    38   1    658
7    0   58   0   776   0    1     4  6075    80   0    271
8    0    2   0   553   0    0    20   284  1393   1   1043
9    2    3   1   207   0   58    67    40    27  52     36
10   0    5   0    79   0    0    47   120   102   0  12443
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23249143, 'precision': 0.3319198, 'recall': 0.20935619, 'specificity': 0.9222008, 'f1': 0.11926834, 'auroc': 0.7585885}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   73   0    1   0   1  155   703    2   0   232
1    0  303   0    8   0   0    1  1118    0   0    69
2    0   14   0   12   0   0   10   343    9   0   627
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    32    1   0  1600
5    0   11   0  113   0   5   20   349   15   1    78
6    0    7   0   10   0   0  118   249    6   0  2677
7    1   60   0    4   0   0    0  1077    0   0    22
8    0    9   0   60   0   0   36   286  181   0   798
9    0   23   0   47   0   1   16   849    4   0   197
10   0    0   0    0   0   0    2     8    0   0  1636
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-21 16:41:10.505082,epoch time: 0:25:22.969238,used: 3:25:31.902986,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.783872, 'precision': 0.7041426, 'recall': 0.4324472, 'specificity': 0.9740344, 'f1': 0.46109095, 'auroc': 0.95426214}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   17    9   0    57   0    1   106   115     6   0    172
1    0  938   0    18   0    0     3   341     3   0     29
2    0    3   4    72   2    8    57    57    11   9     89
3    0    7   0  7151   0    8    21   928   239   1     83
4    0    0   0    59   1    2    42    19    25   0    391
5    0    0   0   334   0  109    24     7    15  24      8
6    1   18   0    81   0    1  1144    54    40   1    568
7    0   42   0   767   0    2    12  6107    63   2    269
8    0    1   0   624   0    0    34   282  1349   0   1005
9    0    2   2   209   1   62    72    45    14  62     24
10   0    5   0    84   0    0    81   123    81   1  12416
---- Validation: 
scalar performance:
{'acc': 0.7852882, 'precision': 0.6913018, 'recall': 0.4361484, 'specificity': 0.97417724, 'f1': 0.4668277, 'auroc': 0.95182294}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   35   10   0    61   0   1    86   125     4   0    161
1    0  966   0    17   0   0     3   314     3   0     29
2    0    3   5    67   0   7    61    52    16  12     89
3    0    9   0  7181   0   8    15   910   231   2     84
4    0    0   0    56   0   1    41    18    24   3    396
5    2    0   0   339   0  99    30     4    18  23      6
6    0   19   0    70   0   1  1141    63    30   3    581
7    0   41   0   752   0   1    18  6106    62   2    283
8    0    1   0   606   0   2    26   305  1355   1   1000
9    1    3   1   217   1  53    73    39    18  61     26
10   0    6   0    82   0   0    79   134    85   1  12409
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23717904, 'precision': 0.34401393, 'recall': 0.2115438, 'specificity': 0.9226146, 'f1': 0.122789964, 'auroc': 0.7649417}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   62   0    1   0   1  210   703    2   0   188
1    0  304   0    8   0   0    3  1119    0   0    65
2    0   13   0   15   0   0   14   356    8   0   609
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    0    33    0   0  1599
5    0    8   0  131   0   6   36   340    7   1    63
6    0    4   0    9   0   0  184   255    5   0  2610
7    1   55   0    3   0   0    1  1086    0   0    18
8    0    8   0   71   0   0   52   290  169   0   780
9    0   20   0   56   0   1   32   847    3   0   178
10   0    0   0    0   0   0    2     6    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-21 17:06:39.253642,epoch time: 0:25:28.748560,used: 3:51:00.651546,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.7942262, 'precision': 0.6994339, 'recall': 0.45594254, 'specificity': 0.97542423, 'f1': 0.48863634, 'auroc': 0.9560924}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   40     9   0    66   0    0    97   105     5   2    159
1    0  1001   0    22   0    0     5   277     2   1     23
2    1     3  16    71   2    9    52    48    20  22     68
3    0     7   0  7188   0   12    12   880   270   1     69
4    0     1   4    56   2    0    52    26    32   2    364
5    0     0   1   307   0  112    23     4    22  48      4
6    0    16   0    62   0    3  1226    58    34   1    508
7    1    46   0   705   1    1    11  6174    68   2    254
8    0     2   0   556   0    0    36   300  1453   3    946
9    1     5   4   188   0   63    67    43    18  77     27
10   0     5   0    86   1    0    78   128    96   1  12396
---- Validation: 
scalar performance:
{'acc': 0.793928, 'precision': 0.69207835, 'recall': 0.45535755, 'specificity': 0.97541517, 'f1': 0.48833653, 'auroc': 0.9551841}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   41   10   0    54   0    0    92   131     2   1    152
1    0  989   0    23   0    0     2   292     5   0     21
2    2    0  14    71   1   11    51    45    13  27     77
3    0    6   1  7175   0   17    13   899   262   0     67
4    0    0   2    54   1    0    55    15    36   5    371
5    0    0   0   323   0  104    22     5    21  42      4
6    0   17   0    52   0    0  1200    72    30   4    533
7    0   45   0   730   0    1    10  6163    72   1    243
8    0    1   0   571   0    1    34   283  1521   3    882
9    2    3   6   191   0   70    62    32    18  88     21
10   0    4   1    90   1    1    80   134   100   0  12385
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24816343, 'precision': 0.36148965, 'recall': 0.21940556, 'specificity': 0.92363286, 'f1': 0.13503748, 'auroc': 0.7725303}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    6   72   0    2   0   1  255   676    3   0   155
1    0  362   0    8   0   0    5  1066    0   0    58
2    0   13   0   14   0   0   21   364    9   0   594
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    36    1   0  1596
5    0    8   0  137   0   8   49   323    9   1    57
6    0    5   0    9   0   0  249   258    4   0  2542
7    1   59   0    4   0   0    1  1082    0   0    17
8    0    9   0   75   0   0   71   283  202   0   730
9    0   22   0   55   0   1   50   841    4   0   164
10   0    0   0    0   0   0    2     6    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-21 17:32:20.176908,epoch time: 0:25:40.923266,used: 4:16:41.574812,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.80046016, 'precision': 0.6713491, 'recall': 0.4665856, 'specificity': 0.97635865, 'f1': 0.49945185, 'auroc': 0.9581355}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   48    8   0    60   0    1    94   125     5   0    142
1    0  990   0    20   0    0     1   300     6   0     15
2    0    4   9    71   2   15    49    55    21  30     56
3    0    6   0  7172   0   10    15   898   270   0     67
4    0    1   3    44   0    1    66    26    45   1    352
5    2    1   0   307   0  127    18     5    21  35      4
6    1   15   0    49   0    0  1243    74    38   4    484
7    0   47   1   673   0    2    11  6253    71   0    206
8    0    3   0   545   0    1    29   313  1636   1    764
9    4    1   2   192   1   68    56    41    15  95     18
10   0    4   0    77   0    1    82   163   122   1  12345
---- Validation: 
scalar performance:
{'acc': 0.80227363, 'precision': 0.68770045, 'recall': 0.4688569, 'specificity': 0.9766154, 'f1': 0.50191396, 'auroc': 0.9584815}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   53   10   0    61   0    1    87   112     5   1    153
1    0  986   0    17   0    0     5   300     4   0     20
2    1    4  10    69   3    8    53    59    20  25     60
3    0    9   0  7197   1   11    13   879   280   3     47
4    0    0   2    53   0    1    55    25    45   5    353
5    1    0   0   299   0  132    23     6    21  32      7
6    1   15   0    63   1    4  1234    71    44   1    474
7    1   52   0   635   0    0    16  6291    88   2    180
8    0    1   0   537   0    3    31   298  1661   3    762
9    1    0   1   189   0   80    61    34    19  93     15
10   0    4   0    79   0    2    89   172   113   1  12336
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2574687, 'precision': 0.37420547, 'recall': 0.22598332, 'specificity': 0.9246571, 'f1': 0.14456925, 'auroc': 0.77854425}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    9   68   0    2   0   1  266   700    3   0   121
1    0  347   0    7   0   0    5  1088    0   0    52
2    0   13   0   19   0   0   24   416   12   0   531
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    47    1   0  1584
5    0    8   0  144   0  10   51   326   10   1    42
6    0    4   0   10   0   0  327   354    9   0  2363
7    1   43   0    4   0   0    2  1099    0   0    15
8    0   10   0   81   0   0   82   317  261   0   619
9    0   20   0   59   0   1   52   885    6   0   114
10   0    0   0    0   0   0    2    17    0   0  1627
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-21 17:57:58.693398,epoch time: 0:25:38.516490,used: 4:42:20.091302,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.80412567, 'precision': 0.689524, 'recall': 0.47584, 'specificity': 0.9766618, 'f1': 0.5097575, 'auroc': 0.95935374}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   43     8   0    87   0    1   116    78     5   0    145
1    0  1050   0    27   0    0     1   230     1   0     23
2    0     0  26    63   3    8    60    53    14  25     60
3    0     6   0  7436   0    7    19   653   249   2     66
4    0     1   5    52   1    1    54    14    39   7    365
5    0     0   0   287   0  144    25     2    15  41      7
6    2    19   0    60   0    2  1269    47    27   2    480
7    0    51   1   850   0    2    13  6000    83   1    261
8    0     2   1   592   0    2    37   240  1597   2    822
9    3     3  15   193   0   75    60    18    24  83     19
10   0     3   0    87   0    4    87   116    88   2  12406
---- Validation: 
scalar performance:
{'acc': 0.80433327, 'precision': 0.7661247, 'recall': 0.4746436, 'specificity': 0.9767027, 'f1': 0.5087081, 'auroc': 0.9602094}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   40    11   0    77   0    2   102    96     2   2    151
1    0  1046   1    24   0    0     1   234     3   0     23
2    1     3  22    72   0   11    56    40    18  24     65
3    0    10   0  7422   0   12    15   653   261   3     64
4    0     1   6    53   5    0    64    11    32   4    363
5    1     1   2   298   0  133    23     5    21  34      3
6    0    16   0    65   0    2  1279    47    30   2    467
7    0    48   1   840   0    1    21  6020    84   1    249
8    0     2   0   639   0    2    27   228  1598   1    799
9    2     3   6   198   0   65    72    22    17  91     17
10   0     6   0    87   0    1    90   111    86   1  12414
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26726368, 'precision': 0.37683517, 'recall': 0.23271233, 'specificity': 0.92540574, 'f1': 0.155832, 'auroc': 0.7824432}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   11   96   0    5   0   1  345   570    3   0   139
1    0  475   0   12   0   0    9   942    0   0    61
2    0   14   0   30   0   0   32   319   10   0   610
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    24    0   0  1606
5    0    6   0  189   0  10   77   249    8   1    52
6    0    5   0   14   0   0  363   193    6   0  2486
7    1   63   0    8   0   0    5  1068    0   0    19
8    0   10   0  109   0   0   98   222  251   0   680
9    0   29   0   98   0   1   77   754    4   0   174
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-21 18:23:27.290888,epoch time: 0:25:28.597490,used: 5:07:48.688792,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8125, 'precision': 0.7184606, 'recall': 0.4944076, 'specificity': 0.9779492, 'f1': 0.5309684, 'auroc': 0.9620143}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   64     7   1    53   0    1   106   105     5    2    139
1    0  1029   0    16   0    0     0   265     6    0     16
2    1     1  29    59   0   11    41    52    22   41     55
3    0    12   0  7258   1   10    16   788   313    2     38
4    0     0   6    47   1    0    67    17    54    3    344
5    0     0   0   271   0  150    15     5    24   52      4
6    3    25   0    54   0    4  1265    59    46    3    448
7    2    51   1   634   0    2     9  6268   100    2    194
8    0     1   0   468   0    0    25   288  1838    4    672
9    5     4  11   164   0   67    59    28    22  119     14
10   0     2   0    69   0    1    84   134   154    1  12347
---- Validation: 
scalar performance:
{'acc': 0.81238467, 'precision': 0.735801, 'recall': 0.4968549, 'specificity': 0.97795296, 'f1': 0.53330714, 'auroc': 0.9614711}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   71     8   0    51   0    1   112    98     4    3    135
1    0  1048   0    16   0    0     0   244     9    0     15
2    2     2  23    55   2    6    55    49    28   33     57
3    0     6   0  7219   0   15    17   814   311    2     56
4    0     0   6    49   4    1    53    20    47    4    355
5    2     0   3   267   0  146    22     4    27   47      3
6    2    21   0    46   0    1  1314    64    45    3    412
7    0    40   0   667   0    2    12  6254    93    2    195
8    0     0   0   463   0    1    35   309  1840    2    646
9    4     2   9   173   0   63    55    33    20  120     14
10   0     7   0    59   0    2    87   145   163    1  12332
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28055692, 'precision': 0.37135416, 'recall': 0.24312896, 'specificity': 0.9268038, 'f1': 0.16857606, 'auroc': 0.7876601}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   21  100   0    3   0   1  326   607    3   0   109
1    1  485   0    7   0   0    6   947    0   0    53
2    0   15   0   21   0   0   36   372   15   0   556
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    39    2   0  1590
5    2    9   0  167   0  11   67   284   15   2    35
6    0    6   0   10   0   0  431   268   21   0  2331
7    1   60   0    5   0   0    4  1078    0   0    16
8    0    8   0   78   0   0   95   262  346   0   581
9    0   29   0   69   0   1   79   817    8   0   134
10   0    0   0    1   0   0    2     5    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-21 18:48:49.779029,epoch time: 0:25:22.488141,used: 5:33:11.176933,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8169681, 'precision': 0.7202636, 'recall': 0.5004471, 'specificity': 0.97847664, 'f1': 0.53438574, 'auroc': 0.96370304}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   77     7   0    52   0    4   112    91     4   1    134
1    0  1050   0    19   0    0     0   236    10   0     17
2    0     2  18    54   3   14    54    51    21  31     64
3    0     8   0  7238   0   21    19   762   328   0     63
4    0     1   5    39   3    1    68    19    40   8    354
5    1     0   0   265   0  176    22     5    19  29      4
6    2    17   0    46   0    4  1313    59    42   0    424
7    0    41   1   649   0    5    11  6237   112   0    207
8    0     1   0   431   0    3    27   276  1945   2    610
9    7     2   8   164   0   91    59    24    20  95     23
10   0     5   0    63   0    2    76   128   136   1  12383
---- Validation: 
scalar performance:
{'acc': 0.8167179, 'precision': 0.6976017, 'recall': 0.5056028, 'specificity': 0.9784682, 'f1': 0.54111683, 'auroc': 0.96278125}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   84     7   0    54   0    1   106   100     5    1    125
1    0  1063   0    17   0    0     0   223     9    0     20
2    1     1  18    51   7   16    53    49    26   28     62
3    1     7   0  7265   0   12    14   752   339    2     48
4    0     1   9    44   7    2    66    12    55    5    338
5    2     0   1   257   0  182    15     5    17   38      4
6    2    22   0    48   0    2  1312    51    42    3    426
7    1    49   1   621   2    2    18  6254   104    1    212
8    0     4   1   403   0    3    32   303  1885    2    663
9    5     3  13   159   2   85    50    28    20  110     18
10   0     7   0    59   1    1    89   142   144    0  12353
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29042187, 'precision': 0.38094252, 'recall': 0.2496698, 'specificity': 0.92767906, 'f1': 0.1791916, 'auroc': 0.79097575}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   39   85   0    3   0   1  352   573    3   0   114
1    1  490   0    7   0   0   11   935    0   0    55
2    0   12   0   23   0   0   57   345   15   0   563
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    32    2   0  1597
5    4    6   0  170   0  15   86   257   14   0    40
6    0    6   0   10   0   0  522   225   20   0  2284
7    1   56   0    5   0   0    5  1080    0   0    17
8    0    7   0   81   0   0  103   241  365   0   573
9    1   28   0   75   0   1  100   779    8   0   145
10   0    0   0    1   0   0    2     3    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-21 19:14:21.113626,epoch time: 0:25:31.334597,used: 5:58:42.511530,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8200182, 'precision': 0.7302064, 'recall': 0.51752603, 'specificity': 0.97891146, 'f1': 0.55622065, 'auroc': 0.9654201}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   93     7   0    57   0    2    98    86     3    2    135
1    0  1063   0    14   0    0     1   232     5    0     16
2    0     1  30    37   4   12    45    43    28   42     70
3    2     9   0  7201   0   14    12   780   371    5     44
4    1     1   5    45   9    0    61    16    58    6    337
5    0     0   1   244   1  182    12     3    21   52      5
6    5    21   0    39   1    1  1325    53    52    1    409
7    0    46   0   611   1    4    18  6268   115    3    197
8    0     1   0   387   1    3    23   268  2009    0    602
9    5     5   6   152   1   77    45    33    23  125     21
10   0     3   0    59   3    2    80   137   167    0  12344
---- Validation: 
scalar performance:
{'acc': 0.8190718, 'precision': 0.7470123, 'recall': 0.5134563, 'specificity': 0.978786, 'f1': 0.5502222, 'auroc': 0.9649192}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   77     6   0    45   0    0    98    89     7    2    159
1    0  1068   0    11   0    0     0   227     7    0     19
2    1     2  23    40   5    8    43    56    22   46     66
3    1     3   0  7217   0   17    18   773   354    4     53
4    0     1   4    43  11    0    64    12    63    4    337
5    3     0   0   247   0  186    11     6    21   45      2
6    3    21   0    51   0    2  1286    65    63    3    414
7    0    50   1   607   0    3    14  6260   126    0    204
8    0     0   0   408   0    7    32   254  2002    1    592
9    5     2   5   144   0   84    47    29    25  134     18
10   0     6   0    67   1    1    87   127   148    2  12357
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29755825, 'precision': 0.3827352, 'recall': 0.2559503, 'specificity': 0.9283956, 'f1': 0.18679523, 'auroc': 0.7933465}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   40  100   0    4   0   1  349   556    3   0   117
1    1  562   0    8   0   0   10   862    0   0    56
2    0   14   0   23   1   0   54   337   15   0   571
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    28    2   0  1601
5    4    6   0  175   0  18   78   247   20   3    41
6    0    6   0   10   0   0  529   213   26   0  2283
7    1   60   0    5   0   0    6  1074    0   0    18
8    0    9   0   77   0   0   98   229  388   0   569
9    1   35   0   77   0   1  103   763    9   0   148
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-21 19:39:44.960788,epoch time: 0:25:23.847162,used: 6:24:06.358692,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.81910855, 'precision': 0.720878, 'recall': 0.5111934, 'specificity': 0.9786252, 'f1': 0.5523559, 'auroc': 0.9663629}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   101     6   0    59   1    1    88    87     7    0    132
1     0  1071   0    17   0    0     1   218     5    0     20
2     2     4  22    57  13    8    42    60    14   32     58
3     0     7   0  7356   0   18    14   716   260    2     65
4     0     2   9    46  19    3    64    12    36    7    341
5     0     1   0   270   0  164    20     5    14   43      4
6     2    19   0    52   0    0  1336    62    30    4    401
7     1    39   1   664   0    4    14  6267    80    1    194
8     0     2   1   524   0    4    33   270  1765    4    693
9     5     4  13   147   2   76    57    27    19  123     20
10    1     6   0    76   3    5    72   125   113    0  12391
---- Validation: 
scalar performance:
{'acc': 0.81877756, 'precision': 0.71092784, 'recall': 0.5097174, 'specificity': 0.97856015, 'f1': 0.5506148, 'auroc': 0.96605545}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   103     6   0    50   0    1    89    84     8    2    140
1     1  1087   0    16   0    0     3   209     4    0     12
2     0     1  25    51  13   10    55    52    16   33     56
3     0     4   0  7419   1   11     7   683   254    3     58
4     1     2   7    52  21    1    64    17    36    3    335
5     4     0   2   261   1  166    13     5    11   51      7
6     2    17   0    54   0    0  1318    59    35    3    420
7     0    53   1   678   2    4    19  6227    78    0    203
8     0     3   0   512   0    2    27   292  1719    4    737
9     9     6  14   160   4   90    48    23    16  109     14
10    2     5   1    70   2    2    71   117   109    1  12416
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2988176, 'precision': 0.38174272, 'recall': 0.25524092, 'specificity': 0.92853236, 'f1': 0.18738127, 'auroc': 0.7954262}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   60  101   0    5   0   1  354   535    3   0   111
1    1  603   0    9   0   0   10   821    0   0    55
2    0   14   0   30   1   0   60   331    9   0   570
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    29    2   0  1600
5   14    8   0  193   0  17   78   232    9   1    40
6    0    6   0   13   0   0  577   201   11   0  2259
7    1   61   0    6   0   0    8  1070    0   0    18
8    0   11   0  110   0   0  111   230  302   0   606
9    2   38   0   96   0   1  108   741    3   0   148
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
early stop counter: 1
val acc:0.8187775611877441, best validation acc: 0.8190718293190002, corresponding to test acc:                         0.2975582480430603 / 0.29881760478019714
after epoch: 16,now: 2024-07-21 20:05:17.292605,epoch time: 0:25:32.331817,used: 6:49:38.690509,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8235766, 'precision': 0.7308331, 'recall': 0.51948494, 'specificity': 0.9793235, 'f1': 0.5613053, 'auroc': 0.9668838}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   81     8   1    52   0    2    90   108     4    1    136
1    0  1049   1    17   0    0     1   243     5    0     16
2    1     0  48    51   7    4    40    50    21   39     51
3    0     5   0  7208   0   16    13   831   320    3     43
4    0     1  11    45  12    2    56    20    49    8    335
5    3     0   0   258   0  175    10     4    19   48      3
6    3    20   0    38   0    1  1301    56    54    3    432
7    0    41   3   495   1    2    17  6448    89    2    165
8    0     2   0   407   0    5    24   328  1965    3    562
9    6     6  13   134   1   86    43    35    22  128     19
10   0     1   0    61   3    0    75   148   135    1  12367
---- Validation: 
scalar performance:
{'acc': 0.8232981, 'precision': 0.73249424, 'recall': 0.52263707, 'specificity': 0.979281, 'f1': 0.5649634, 'auroc': 0.96752167}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   91     6   0    59   0    0    82   105     8    1    131
1    0  1047   0    14   0    0     2   248     6    1     14
2    1     4  38    39   5    5    46    54    26   36     58
3    0     6   1  7210   0   12    17   835   314    2     43
4    0     0   8    34  13    1    59    29    48    8    339
5    3     0   0   242   0  185    17     5    16   52      1
6    3    20   0    37   1    1  1311    77    50    8    400
7    1    38   0   492   0    2    14  6428    92    1    197
8    0     1   0   390   1    2    26   313  1974    3    586
9    4     0  20   148   1   77    40    31    22  140     10
10   0     2   1    60   5    1    67   169   147    2  12342
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.30105647, 'precision': 0.39123002, 'recall': 0.25699508, 'specificity': 0.9288597, 'f1': 0.18658665, 'auroc': 0.7979476}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   31   78   0    3   0   1  335   623    3   0    96
1    1  499   0    5   0   0    8   939    1   0    46
2    0   13   0   18   1   0   55   395   17   0   516
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    42    2   0  1588
5    2    8   0  175   0  17   75   264   16   3    32
6    0    5   0    9   0   0  607   272   24   0  2150
7    1   38   0    4   0   0    1  1106    0   0    14
8    0    6   0   81   0   0  102   267  405   0   509
9    1   23   0   68   0   1   99   820    7   0   118
10   0    0   0    1   0   0    2     5    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-21 20:30:57.455668,epoch time: 0:25:40.163063,used: 7:15:18.853572,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.82742935, 'precision': 0.73728657, 'recall': 0.53332525, 'specificity': 0.9797946, 'f1': 0.57528055, 'auroc': 0.9672075}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   105     6   0    54   0    2   105    82     8    0    121
1     0  1059   0    14   0    0     2   237     3    0     17
2     2     1  45    41  11    9    48    56    16   38     45
3     1     4   1  7319   1   29    23   727   279    2     49
4     0     0  10    33  22    3    73    19    51    6    321
5     2     0   1   235   0  212     9     5    16   38      3
6     3    13   1    43   0    3  1387    59    34    2    363
7     1    29   0   571   1    2    14  6366    81    2    197
8     0     2   2   446   1    8    36   281  1929    2    588
9     3     2  12   145   4  103    49    25    19  118     13
10    0     5   0    62   3    2   103   135   121    0  12364
---- Validation: 
scalar performance:
{'acc': 0.8270162, 'precision': 0.73253787, 'recall': 0.5300411, 'specificity': 0.9797782, 'f1': 0.5675035, 'auroc': 0.9677452}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   106     5   0    49   0    1   106    87     7    1    121
1     0  1061   0    14   0    0     2   229     3    0     23
2     2     2  28    43   6    8    52    50    28   45     48
3     1     8   0  7313   0   32    16   743   274    1     52
4     0     0   7    40  17    2    73    24    46    4    326
5     1     0   2   229   0  219    11     2    20   34      3
6     1    15   0    30   1    4  1412    58    37    2    348
7     1    45   2   550   0    1    16  6347   108    1    194
8     1     3   0   443   0    3    36   273  1953    2    582
9    10     2  14   146   1  101    43    31    17  116     12
10    1     6   0    56   3    2    96   143   143    0  12346
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32190582, 'precision': 0.38955766, 'recall': 0.2672348, 'specificity': 0.9306774, 'f1': 0.20336682, 'auroc': 0.8024116}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   71   70   0    4   0   1  412   532    3   0    77
1    1  511   0    7   0   0   16   916    1   0    47
2    0   10   0   22   1   0  105   354   15   0   508
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    4    37    2   0  1590
5   12    5   0  182   0  24  101   226   11   1    30
6    0    4   0   11   0   0  890   208   16   0  1938
7    1   38   0    4   0   0   12  1096    0   0    13
8    0    5   0   90   0   0  160   245  369   0   501
9    4   21   0   81   0   3  153   753    4   0   118
10   0    0   0    1   0   0    3     2    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-21 20:56:20.429754,epoch time: 0:25:22.974086,used: 7:40:41.827658,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.82718855, 'precision': 0.7324743, 'recall': 0.5300634, 'specificity': 0.9798001, 'f1': 0.57218355, 'auroc': 0.96777344}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   99     8   1    54   1    0   113    84     1    3    119
1    0  1068   0    15   0    0     2   224     4    1     18
2    2     1  42    37  11    8    45    58    18   41     48
3    0     2   0  7360   1   14    23   700   286    6     47
4    1     0  13    39  21    1    78    19    51    6    310
5    2     1   1   253   0  165    17     4    18   57      3
6    2    16   0    44   0    1  1373    62    38    3    368
7    1    35   2   579   0    2    16  6348    91    3    186
8    0     2   2   450   5    5    46   280  1944    3    559
9    4     0   8   142   0   73    48    28    18  154     18
10   1     5   1    66   4    1    91   155   123    2  12343
---- Validation: 
scalar performance:
{'acc': 0.8294503, 'precision': 0.73961264, 'recall': 0.53403586, 'specificity': 0.9800737, 'f1': 0.5757851, 'auroc': 0.96987283}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   114     3   0    54   0    2   104    75     5    2    124
1     1  1073   0    16   0    0     3   217     5    1     16
2     3     1  42    38   6    7    51    53    18   42     51
3     0     4   1  7373   0   17    15   708   282    3     37
4     0     0  11    40  18    1    76    19    46    4    324
5     1     0   2   252   0  170    16     2    19   56      3
6     6    15   0    49   0    2  1412    48    41    5    330
7     1    31   1   613   0    2    17  6337    83    1    179
8     1     1   0   423   1    2    41   287  1975    4    561
9     5     1  16   137   3   74    46    32    19  142     18
10    2     2   1    54   1    1   108   133   138    3  12353
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32680333, 'precision': 0.3929265, 'recall': 0.27011666, 'specificity': 0.9311763, 'f1': 0.2061888, 'auroc': 0.8038729}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   73   82   0    5   0   1  408   519    3   0    79
1    1  565   0    9   0   0   16   861    1   0    46
2    0   10   0   24   1   0  108   348   14   0   510
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    5    36    2   0  1590
5   12    5   0  191   0  16  104   219   12   3    30
6    0    6   0   12   0   0  909   201   17   0  1922
7    1   45   0    4   0   0   12  1089    0   0    13
8    0    5   0   98   0   0  158   240  379   0   490
9    4   26   0   91   0   1  157   738    4   0   116
10   0    0   0    1   0   0    3     2    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-21 21:21:45.755854,epoch time: 0:25:25.326100,used: 8:06:07.153758,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.83195096, 'precision': 0.7362528, 'recall': 0.54329383, 'specificity': 0.98033905, 'f1': 0.5903357, 'auroc': 0.96887654}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   128     1   1    47   0    2    71    96     4    4    129
1     1  1063   0    13   0    0     4   229     5    0     17
2     2     0  42    45  20    6    28    52    13   58     46
3     0     5   0  7443   0   17     9   661   259    7     39
4     0     0  10    38  47    2    64    27    52    8    291
5     4     0   0   249   0  168     6     3    13   75      3
6     4     7   0    36   1    1  1382    63    49    6    359
7     1    32   0   599   2    2    11  6358    98    3    156
8     1     3   0   491   2    4    26   261  1954    3    548
9    10     0  23   141   3   61    38    30    10  162     15
10    1     4   1    60   7    2    76   156   135    3  12348
---- Validation: 
scalar performance:
{'acc': 0.83025277, 'precision': 0.73365074, 'recall': 0.5397836, 'specificity': 0.9801799, 'f1': 0.58533716, 'auroc': 0.9685342}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   117     8   1    53   0    0    82    85    10    3    124
1     0  1052   0    14   0    0     0   242     5    1     18
2     1     1  41    46  24    6    33    45    14   55     46
3     0     3   0  7428   2   16    20   656   278    5     32
4     0     1   7    44  40    0    66    22    40   10    309
5     3     1   3   236   2  169     8     6    16   74      3
6     5    16   0    46   0    2  1366    61    41    6    365
7     1    36   0   602   0    3    10  6360    94    4    155
8     0     2   0   479   4    3    24   290  1954    6    534
9     4     1  13   140   6   68    40    25    14  171     11
10    1     4   0    63  12    1    80   147   144    3  12341
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32211572, 'precision': 0.4252798, 'recall': 0.26901048, 'specificity': 0.930915, 'f1': 0.20757064, 'auroc': 0.80580974}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   114   62   0    6   0   2  361   545    3   0    77
1     1  477   0   10   0   0   13   952    1   0    45
2     0    7   0   32   2   0   88   372   12   0   502
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   1   0    5    40    2   0  1585
5    19    4   0  203   0  19   85   217   12   7    26
6     0    4   0   16   0   0  857   231   23   0  1936
7     1   30   0    7   0   0    9  1104    0   0    13
8     0    4   0  112   1   0  136   246  393   0   478
9     5   13   0  101   1   1  137   764    4   1   110
10    0    0   0    1   0   0    3     4    0   0  1638
better model found
persisted
after epoch: 20,now: 2024-07-21 21:47:27.606901,epoch time: 0:25:41.851047,used: 8:31:49.004805,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.833155, 'precision': 0.7340391, 'recall': 0.55427754, 'specificity': 0.98052317, 'f1': 0.5983157, 'auroc': 0.9701041}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   126     7   0    50   1    1    81    70     5    2    140
1     0  1101   1    13   0    0     1   193     9    0     14
2     4     2  64    41  14   16    33    40    16   35     47
3     2     6   1  7357   3   18    21   680   312    4     34
4     1     0  14    27  39    3    50    22    63    1    319
5     5     1   1   209   0  229    11     4    20   39      2
6     4    20   0    38   0    2  1343    63    50    5    383
7     1    57   0   591   2    2    21  6272   123    2    188
8     1     3   2   382   3    7    26   242  2083    2    545
9     6     4  21   124   5  119    36    22    21  124     11
10    2     5   1    52   7    1    61   112   149    3  12402
---- Validation: 
scalar performance:
{'acc': 0.8315635, 'precision': 0.72177094, 'recall': 0.5517439, 'specificity': 0.9803613, 'f1': 0.594422, 'auroc': 0.9696168}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   119    12   0    51   1    5    74    85     5    1    130
1     0  1110   1    14   0    0     4   182     9    0     12
2     4     4  67    36  23   12    25    40    19   34     48
3     0     4   0  7330   1   31    14   665   352    3     40
4     0     1  15    34  40    1    51    17    56    8    316
5     3     0   3   214   1  217    14     4    18   45      2
6     6    16   0    35   2    6  1363    55    55    1    369
7     1    46   2   563   4    4    15  6312   110    2    206
8     0     1   1   412   4    6    33   251  2020    4    564
9     5     3  26   119   3  123    27    26    28  124      9
10    3     3   0    43   7    3    80   122   146    3  12386
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33519906, 'precision': 0.38656366, 'recall': 0.28369987, 'specificity': 0.9321197, 'f1': 0.2256935, 'auroc': 0.80601054}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   136   99   0    6   0   2  347   474    4   0   102
1     1  695   0   10   0   0   11   726    1   0    55
2     0   19   0   25   1   0   82   306   17   0   565
3     0    0   0    0   0   0    0     0    0   0     0
4     0    1   0    0   0   0    2    26    3   0  1601
5    23    7   0  195   0  29   84   199   16   2    37
6     0    6   0   10   0   0  780   160   30   0  2081
7     1   58   0    5   0   0   11  1072    0   0    17
8     0   10   0   86   0   0  114   207  437   0   516
9     5   41   0   92   0   4  136   705    9   0   145
10    0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-21 22:13:08.155009,epoch time: 0:25:40.548108,used: 8:57:29.552913,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8340379, 'precision': 0.75494653, 'recall': 0.55024254, 'specificity': 0.9806485, 'f1': 0.59158087, 'auroc': 0.9702935}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   116     8   0    48   0    0   105    73     7    4    122
1     0  1067   1    18   0    0     1   219     7    1     18
2     1     4  47    42   6    6    45    37    16   59     49
3     0     8   1  7388   0   17    19   663   295    6     39
4     0     1  13    35  23    1    77    17    54   11    306
5     3     0   2   223   1  184    12     0    14   79      3
6     1    10   0    34   0    4  1413    49    41    5    350
7     1    33   1   563   0    3    28  6338   103    6    187
8     0     2   1   412   2    6    35   268  2026    7    537
9     2     0  12   127   0   70    33    20    19  194     16
10    0     4   1    58   3    0    85   115   151    1  12377
---- Validation: 
scalar performance:
{'acc': 0.83330214, 'precision': 0.7433803, 'recall': 0.55157256, 'specificity': 0.9805701, 'f1': 0.59354657, 'auroc': 0.9694184}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   120     9   0    58   1    0    98    69     7    5    116
1     0  1082   1    16   0    0     2   208     6    1     16
2     3     0  52    31   4    5    41    38    21   65     52
3     1     7   1  7381   2   19    22   651   305    6     45
4     0     1  14    38  24    1    68    17    55   15    306
5     1     0   3   211   0  195     9     1    19   80      2
6     5    13   0    38   0    2  1403    53    44    5    345
7     1    27   2   596   3    1    21  6327   109    5    173
8     2     0   0   420   3    6    41   263  2001    4    556
9     5     0  13   130   0   63    43    21    18  180     20
10    0     2   0    44   4    1    84   120   147    6  12388
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33967677, 'precision': 0.41678244, 'recall': 0.2804677, 'specificity': 0.9324235, 'f1': 0.22217363, 'auroc': 0.8086376}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   124   74   0    7   0   2  408   469    4   0    82
1     1  578   0   14   0   0   16   840    1   0    49
2     0    8   0   29   1   0  112   311   14   1   539
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    5    28    2   0  1598
5    19    4   0  207   0  21  112   176   13   9    31
6     0    5   0   12   0   0  987   152   19   0  1892
7     1   38   0    5   0   0   12  1092    0   0    16
8     0    3   0   97   0   0  154   213  409   0   494
9     5   22   0   95   0   2  184   693    6   3   127
10    0    0   0    1   0   0    3     1    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-21 22:38:45.131162,epoch time: 0:25:36.976153,used: 9:23:06.529066,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8379174, 'precision': 0.7403984, 'recall': 0.56373805, 'specificity': 0.9810249, 'f1': 0.6098856, 'auroc': 0.9717697}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   150     7   0    42   1    1    67    79     5    2    129
1     0  1095   0    14   0    0     2   202     7    1     11
2     4     3  64    38  12    8    32    35    17   49     48
3     1     6   1  7455   1   19    13   625   273    4     39
4     0     2  20    36  36    1    55    19    46    7    317
5     3     0   2   215   0  200    10     3    13   72      3
6     7    16   0    46   1    1  1378    49    47    5    358
7     6    38   1   562   3    3    13  6335   100    2    202
8     2     4   0   425   0    4    32   255  2035    5    534
9     6     3  20   119   5   85    25    28    16  171     15
10    2     6   1    62   6    2    72   107   133    2  12399
---- Validation: 
scalar performance:
{'acc': 0.8361107, 'precision': 0.73797953, 'recall': 0.5619158, 'specificity': 0.9807865, 'f1': 0.6084003, 'auroc': 0.9719863}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   143     6   0    50   1    1    69    70     9    1    133
1     0  1086   0    17   0    0     2   209     3    1     14
2     4     2  61    39  14    8    36    34    18   53     43
3     1     6   1  7455   0   19    11   617   278    4     48
4     1     0  15    36  39    2    61    23    39    6    317
5     4     0   3   219   0  200     8     2    20   63      2
6     9    18   0    39   1    4  1376    51    44    4    362
7     1    47   3   578   2    5    12  6317   101    1    198
8     3     1   1   426   3    6    29   245  2013    2    567
9     8     3  21   124   4   80    26    16    16  180     15
10    2     6   0    75   9    3    66   117   128    2  12388
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34401456, 'precision': 0.3885698, 'recall': 0.2905192, 'specificity': 0.9331167, 'f1': 0.23630148, 'auroc': 0.8095359}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   234   85   0    9   0   2  312   442    4   0    82
1     1  662   0   15   0   0   12   764    1   0    44
2     3   10   0   32   1   0   88   324   15   0   542
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    4    28    3   0  1598
5    39    5   0  214   0  24   81   178   13   5    33
6     1    6   0   15   0   0  850   171   24   0  2000
7     1   46   0    6   0   0   10  1086    0   0    15
8     2    8   0  104   0   0  121   219  419   0   497
9    17   34   0  103   0   4  133   702    7   0   137
10    0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-21 23:04:17.296300,epoch time: 0:25:32.165138,used: 9:48:38.694204,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8393086, 'precision': 0.72930133, 'recall': 0.56024754, 'specificity': 0.9813391, 'f1': 0.6015196, 'auroc': 0.9712486}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   126     7   0    57   0    1   114    65     4    1    108
1     0  1084   1    16   0    0     4   206     4    0     17
2     3     0  95    39  11    9    47    35    14   25     34
3     1     4   1  7508   1   23    22   599   238    1     39
4     0     1  21    39  25    1    82    20    47    5    297
5     4     0   7   224   0  197    17     3    15   50      4
6     3    11   1    33   1    0  1486    46    32    3    292
7     3    28   4   588   3    2    25  6358    95    1    157
8     1     2   2   438   1    3    43   252  2033    5    516
9     6     2  49   136   3   84    47    24    16  115     11
10    3     5   1    54   6    2   100   126   152    0  12343
---- Validation: 
scalar performance:
{'acc': 0.84194195, 'precision': 0.74427426, 'recall': 0.5643773, 'specificity': 0.9816275, 'f1': 0.60750294, 'auroc': 0.97206867}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   126     7   0    50   1    4   103    68     5    3    116
1     1  1081   0    17   0    0     3   215     3    1     11
2     3     2  88    40  11    3    50    37    10   23     45
3     0     2   1  7528   1   25    22   567   253    2     39
4     0     1  24    35  36    2    77    26    41    6    291
5     1     0   7   222   1  205    16     3    13   49      4
6     5     9   0    35   0    1  1480    45    39    3    291
7     2    36   6   560   0    4    21  6379    82    1    174
8     1     1   0   418   1    2    51   247  2089    3    483
9    11     0  41   131   1   88    45    19    13  123     21
10    2     3   1    53   5    3    90   154   143    1  12341
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36871195, 'precision': 0.405973, 'recall': 0.29538512, 'specificity': 0.9351898, 'f1': 0.23960939, 'auroc': 0.8136546}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   154   68   0   10   0   1   445   440    3   0    49
1     1  611   0   14   0   0    25   805    1   0    42
2     0    6   0   31   1   0   157   316   15   0   489
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     8    32    3   0  1590
5    23    5   0  219   0  21   134   156   13   0    21
6     0    6   0   13   0   0  1334   161   23   0  1530
7     1   35   0    9   0   0    19  1088    0   0    12
8     0    3   0  103   1   0   212   212  426   0   413
9     6   23   0  109   0   2   240   650    3   0   104
10    0    0   0    1   0   0     8     1    0   0  1636
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-21 23:29:47.418034,epoch time: 0:25:30.121734,used: 10:14:08.815938,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.84107447, 'precision': 0.7466794, 'recall': 0.5694627, 'specificity': 0.98142177, 'f1': 0.61499023, 'auroc': 0.9722077}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   149     2   1    48   0    1    77    78     3    3    121
1     0  1096   0    17   0    0     2   196     8    1     12
2     3     2  56    36  15   11    27    34    16   58     54
3     2     7   1  7518   0   23    19   541   287    4     35
4     0     1  19    34  40    1    46    23    53   14    308
5     4     1   1   211   2  194     7     6    18   75      2
6     5    16   0    38   0    3  1397    55    48    3    343
7     5    36   1   624   2    3    12  6274   110    1    196
8     1     3   1   422   3    4    19   242  2094    5    501
9     9     2  14   124   1   63    29    21    14  204     12
10    1     3   2    57   8    1    73   107   121    5  12414
---- Validation: 
scalar performance:
{'acc': 0.8411395, 'precision': 0.75110364, 'recall': 0.57224786, 'specificity': 0.9813859, 'f1': 0.61923826, 'auroc': 0.9712509}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   157     7   0    56   0    2    68    63     6    4    120
1     0  1093   0    15   0    0     1   203     4    0     16
2     7     2  66    36  18    6    28    40    23   47     39
3     1     3   0  7474   2   20    12   578   283   10     57
4     1     2  12    42  32    2    58    18    52    8    312
5     3     1   2   210   0  209     7     1    18   68      2
6     6    18   0    37   0    0  1384    55    49    7    352
7     4    35   3   581   1    1    11  6326    99    1    203
8     2     1   0   390   1    1    25   228  2103    6    539
9     5     1  22   118   5   70    23    23    23  191     12
10    0     5   2    56   1    2    76    96   146    1  12411
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.35807738, 'precision': 0.406472, 'recall': 0.29872748, 'specificity': 0.9344673, 'f1': 0.2467759, 'auroc': 0.81258535}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   233   77   0   13   0   2  339   424    5   0    77
1     1  673   0   19   0   0   14   748    1   0    43
2     2    8   0   33   1   0   99   304   18   1   549
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    4    27    4   0  1598
5    36    4   0  236   0  24   93   144   15   8    32
6     1    5   0   15   0   0  989   150   27   0  1880
7     1   42   0    8   0   0   10  1088    0   0    15
8     1    7   0  105   0   0  136   197  469   0   455
9    12   31   0  128   0   3  168   655    8   1   131
10    0    0   0    1   0   0    3     1    0   0  1641
early stop counter: 1
val acc:0.8411394953727722, best validation acc: 0.8419419527053833, corresponding to test acc:                         0.3687119483947754 / 0.3687119483947754
after epoch: 25,now: 2024-07-21 23:55:24.244295,epoch time: 0:25:36.826261,used: 10:39:45.642199,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.8438035, 'precision': 0.74240226, 'recall': 0.5783539, 'specificity': 0.9818648, 'f1': 0.6231584, 'auroc': 0.9726275}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   160     6   0    51   0    0    81    69     8    3    105
1     0  1104   2    15   0    0     1   193     3    0     14
2     2     1  66    29  25    4    35    44    21   50     35
3     1     7   0  7535   1   20    18   548   267    4     37
4     1     1  22    33  46    0    64    18    48    6    300
5     3     0   3   213   0  188     6     0    14   90      4
6     3    13   0    33   1    2  1453    50    44    7    302
7     2    45   3   579   2    2    16  6363   100    2    148
8     4     3   2   442   3    4    35   238  2079    2    482
9     6     1  26   117   3   61    26    24    11  206     12
10    1     2   4    55   7    3    88   142   152    2  12338
---- Validation: 
scalar performance:
{'acc': 0.8421827, 'precision': 0.74594176, 'recall': 0.5769831, 'specificity': 0.9816797, 'f1': 0.62165356, 'auroc': 0.97273415}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   161     5   0    41   0    1    72    77    12    7    107
1     0  1121   0    12   0    0     3   174     8    0     14
2     7     2  61    33  17    7    34    38    16   60     37
3     3     4   0  7567   1   18    20   547   243    3     34
4     1     2  16    36  52    1    71    14    52   11    283
5     3     0   2   212   1  189     8     4    15   82      5
6    10    18   0    32   2    3  1432    45    46    6    314
7     5    47   1   627   1    5    12  6308    95    4    160
8     1     2   0   438   7    3    30   262  2066    3    484
9     8     3  19   113   3   59    32    20    20  203     13
10    0     2   2    59   6    0    92   135   172    3  12325
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38053593, 'precision': 0.4364999, 'recall': 0.30862743, 'specificity': 0.9366058, 'f1': 0.25709745, 'auroc': 0.8161611}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   254   81   0   13   0   2   374   393    4   0    49
1     1  688   0   18   0   0    18   731    1   0    42
2     3    9   0   32   2   0   143   317   17   1   491
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     7    32    3   0  1590
5    34    4   0  242   0  17   111   140   14   8    22
6     1    6   0   15   0   0  1287   162   25   0  1571
7     1   43   0    9   0   0    14  1085    0   0    12
8     1    7   0  115   1   0   173   208  469   0   396
9    14   34   0  127   0   1   208   639    5   1   108
10    0    0   0    1   0   0     7     1    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-22 00:20:51.944380,epoch time: 0:25:27.700085,used: 11:05:13.342284,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.8449807, 'precision': 0.75571144, 'recall': 0.5802181, 'specificity': 0.98203206, 'f1': 0.6248225, 'auroc': 0.97290754}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   171     4   2    40   0    2    77    58    13    4    112
1     1  1101   0    13   0    0     2   191     7    0     15
2     5     2  70    41  10    4    32    41    21   47     39
3     1     4   0  7421   1   18    14   620   325    0     35
4     0     0  18    35  32    3    71    23    55    5    297
5     3     0   4   207   0  214     8     2    20   61      2
6     6    13   0    31   0    4  1453    51    37    2    311
7     3    30   0   526   0    1    21  6400   123    6    152
8     2     2   1   362   1    5    36   238  2190    4    455
9     8     0  31   119   1   69    36    18    22  174     14
10    0     5   0    47   6    1    87   127   165    0  12356
---- Validation: 
scalar performance:
{'acc': 0.84373415, 'precision': 0.7595947, 'recall': 0.57899225, 'specificity': 0.98186976, 'f1': 0.6248562, 'auroc': 0.97331727}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   170     6   1    48   1    0    75    71     8    2    101
1     1  1088   0    18   0    0     2   200     8    0     15
2     4     2  68    39   7    9    35    47    22   28     51
3     1     7   1  7438   0   25    14   602   317    1     34
4     1     1  15    27  39    2    73    19    54   10    298
5     4     0   0   197   0  219    10     0    24   65      2
6     6    16   0    30   1    5  1430    53    52    3    312
7     3    36   2   552   1    4    20  6367   107    1    172
8     1     1   1   382   3    2    31   231  2177    2    465
9     8     1  25   103   2   83    34    25    23  175     14
10    3     4   0    47   5    1    78   111   173    2  12372
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37752748, 'precision': 0.40636992, 'recall': 0.3096261, 'specificity': 0.93628544, 'f1': 0.25876063, 'auroc': 0.8159486}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   254   68   0   10   0   2   363   407    6   0    60
1     1  645   0   15   0   0    19   775    1   0    43
2     2    5   0   30   1   0   135   309   21   0   512
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     6    28    4   0  1595
5    35    4   0  224   0  26   111   142   19   4    27
6     1    5   0   12   0   0  1213   148   29   0  1659
7     1   31   0    8   0   0    13  1097    0   0    14
8     1    3   0   89   0   0   159   202  521   0   395
9    13   25   0  108   0   2   202   660   11   0   116
10    0    0   0    1   0   0     4     1    0   0  1640
better model found
persisted
after epoch: 27,now: 2024-07-22 00:46:14.041189,epoch time: 0:25:22.096809,used: 11:30:35.439093,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.84725493, 'precision': 0.7532048, 'recall': 0.587254, 'specificity': 0.9823771, 'f1': 0.633925, 'auroc': 0.9736328}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   174     5   0    41   1    0    82    70     4    3    103
1     0  1090   0    17   0    0     3   206     4    0     10
2     6     2  64    33  28    8    35    41    17   43     35
3     3     4   0  7401   1   21    12   667   297    2     32
4     0     1  15    27  67    0    70    25    64    7    261
5     4     0   3   192   1  239    10     3    13   54      2
6     7    15   0    28   0    3  1454    53    57    3    288
7     4    32   2   466   1    2    15  6485   103    3    151
8     3     1   0   370   4    7    24   272  2181    3    431
9    11     1  24   106   2   89    33    28    25  164     10
10    2     1   1    52   5    0    95   127   160    1  12348
---- Validation: 
scalar performance:
{'acc': 0.84622175, 'precision': 0.7506236, 'recall': 0.58543056, 'specificity': 0.98226625, 'f1': 0.63166267, 'auroc': 0.97293586}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   163     5   0    37   0    1    86    71     7    3    110
1     0  1099   0    11   0    0     1   201     9    0     11
2     6     0  72    29  26    7    30    41    20   37     44
3     0     5   0  7369   2   26    14   672   316    0     36
4     0     1  14    36  59    2    73    23    51    7    273
5     4     0   1   206   1  214     5     6    20   60      4
6     4    12   0    24   2    3  1488    50    51    5    269
7     1    29   2   488   0    1    18  6469   112    1    144
8     2     1   3   356   3    6    35   273  2195    2    420
9    11     4  27   102   6   84    29    27    18  174     11
10    2     3   1    44   8    4    87   153   158    2  12334
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3847338, 'precision': 0.4286092, 'recall': 0.31180307, 'specificity': 0.93700916, 'f1': 0.2599643, 'auroc': 0.81763476}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   227   67   0   10   0   2   375   436    5   0    48
1     1  639   0   13   0   0    18   787    1   0    40
2     1    6   0   25   2   0   142   345   18   1   475
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     8    37    3   0  1584
5    34    4   0  215   0  29   111   158   14   5    22
6     0    5   0   12   0   0  1344   180   28   0  1498
7     1   27   0    6   0   0    11  1107    0   0    12
8     0    3   0   88   1   0   179   220  517   0   362
9    12   24   0   93   0   4   201   694   11   0    98
10    0    0   0    1   0   0     7     3    0   0  1635
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-22 01:11:41.890508,epoch time: 0:25:27.849319,used: 11:56:03.288412,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.8481914, 'precision': 0.7513404, 'recall': 0.589358, 'specificity': 0.98236895, 'f1': 0.6379199, 'auroc': 0.97367}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   167     7   0    43   2    1    59    68     8    5    123
1     0  1114   0    12   0    0     1   184     7    0     12
2     3     1  76    29  24    7    30    45    18   42     37
3     1     5   0  7415   3   20    15   636   306    1     38
4     0     1  25    32  76    0    43    23    54    9    276
5     3     0   7   203   0  219     8     3    16   59      3
6    10    11   0    35   0    1  1424    56    55    3    312
7     3    33   4   467   1    2    21  6440   120    3    169
8     0     1   1   362   1    1    22   243  2195    7    462
9     9     0  35   110   7   83    18    23    22  171     15
10    2     6   1    47  12    2    62   113   140    3  12405
---- Validation: 
scalar performance:
{'acc': 0.8487094, 'precision': 0.7559794, 'recall': 0.5942834, 'specificity': 0.9823631, 'f1': 0.64431596, 'auroc': 0.9726922}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   179     3   1    43   1    1    66    64    11    2    112
1     0  1097   0    13   0    0     1   200     6    0     15
2     7     4  87    27  21    5    26    34    12   42     47
3     1     4   0  7473   1   21    12   605   276    4     43
4     1     0  17    33  68    1    48    14    52    7    298
5     5     0   2   196   1  214     9     4    16   71      3
6     9    13   0    30   2    3  1419    49    52    3    328
7     3    38   3   484   5    3    20  6439   103    0    167
8     2     1   1   383   6    6    21   225  2159    5    487
9    11     2  28   114   6   68    28    19    14  191     12
10    3     0   2    42  14    0    63   122   145    2  12403
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3768278, 'precision': 0.41882363, 'recall': 0.31093562, 'specificity': 0.9362962, 'f1': 0.26108333, 'auroc': 0.81694293}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   276   74   0   13   0   2   330   402    6   0    67
1     1  676   0   16   0   0    16   746    1   0    43
2     2    6   0   29   2   0   119   307   18   1   531
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    28    3   0  1596
5    37    4   0  230   0  27    98   142   17   7    30
6     1    5   0   12   0   0  1163   146   28   0  1712
7     1   33   0    8   0   0    11  1096    0   0    15
8     1    4   0   91   2   0   145   198  507   0   422
9    14   28   0  103   1   4   190   662    9   0   126
10    0    0   0    1   0   0     4     1    0   0  1640
better model found
persisted
after epoch: 29,now: 2024-07-22 01:37:09.030110,epoch time: 0:25:27.139602,used: 12:21:30.428014,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.84634525, 'precision': 0.74848866, 'recall': 0.5885049, 'specificity': 0.9821859, 'f1': 0.6355032, 'auroc': 0.9744041}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   164     5   2    49   1    3    59    74     8    6    112
1     0  1108   0    17   0    0     1   186     5    1     14
2     3     2  92    31  22    5    27    33    14   42     41
3     1     4   0  7477   0   25    11   593   292    2     34
4     0     1  27    33  60    2    53    22    64   11    266
5     5     0   6   202   0  196     6     2    20   81      3
6     8    13   0    38   0    2  1409    56    48    5    329
7     1    36   3   533   3    4    20  6407    95    2    159
8     2     1   2   369   7    6    26   275  2165    5    436
9     9     0  34   118   2   61    29    20    14  192     14
10    6     3   1    49   7    1    70   127   164    1  12363
---- Validation: 
scalar performance:
{'acc': 0.8474789, 'precision': 0.753952, 'recall': 0.58752203, 'specificity': 0.98229504, 'f1': 0.63595533, 'auroc': 0.9737908}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   165     7   1    46   1    2    71    66     6    2    116
1     0  1100   0    11   0    0     3   195     7    0     16
2     4     1  83    32  18    6    33    34    14   46     41
3     2     2   0  7475   1   20     8   613   283    4     32
4     2     0  22    36  65    0    59    26    45    4    280
5     3     0   5   220   2  191     9     4    14   71      2
6     9    11   0    36   1    1  1445    53    37    7    308
7     3    35   0   541   4    2    18  6391    99    1    171
8     0     1   0   386   4    4    33   242  2205    5    416
9     8     0  37   114   5   68    26    20    14  189     12
10    0     7   2    56   8    1    64   125   157    2  12374
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37948647, 'precision': 0.44996876, 'recall': 0.3112046, 'specificity': 0.93660414, 'f1': 0.26013047, 'auroc': 0.8180299}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   270   69   0   16   0   2   333   411    6   0    63
1     1  659   0   17   0   0    17   761    1   0    43
2     1    6   0   30   1   0   125   318   20   0   514
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    30    3   0  1593
5    36    4   0  250   0  17   101   133   18   7    26
6     1    5   0   15   0   0  1204   156   30   0  1656
7     1   27   0    9   0   0    11  1103    0   0    13
8     1    3   0  101   1   0   148   200  529   0   387
9    13   26   0  119   0   1   192   658   10   1   117
10    0    0   0    1   0   0     4     1    0   0  1640
early stop counter: 1
val acc:0.8474789261817932, best validation acc: 0.8487094044685364, corresponding to test acc:                         0.37682780623435974 / 0.38473379611968994
after epoch: 30,now: 2024-07-22 02:02:40.485724,epoch time: 0:25:31.455614,used: 12:47:01.883628,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:47:01.883628 at 2024-07-22 02:02:40.485724
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3768278, 'precision': 0.41882363, 'recall': 0.31093562, 'specificity': 0.9362962, 'f1': 0.26108333, 'auroc': 0.81694293}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   276   74   0   13   0   2   330   402    6   0    67
1     1  676   0   16   0   0    16   746    1   0    43
2     2    6   0   29   2   0   119   307   18   1   531
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    28    3   0  1596
5    37    4   0  230   0  27    98   142   17   7    30
6     1    5   0   12   0   0  1163   146   28   0  1712
7     1   33   0    8   0   0    11  1096    0   0    15
8     1    4   0   91   2   0   145   198  507   0   422
9    14   28   0  103   1   4   190   662    9   0   126
10    0    0   0    1   0   0     4     1    0   0  1640
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3847338, 'precision': 0.4286092, 'recall': 0.31180307, 'specificity': 0.93700916, 'f1': 0.2599643, 'auroc': 0.81763476}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   227   67   0   10   0   2   375   436    5   0    48
1     1  639   0   13   0   0    18   787    1   0    40
2     1    6   0   25   2   0   142   345   18   1   475
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     8    37    3   0  1584
5    34    4   0  215   0  29   111   158   14   5    22
6     0    5   0   12   0   0  1344   180   28   0  1498
7     1   27   0    6   0   0    11  1107    0   0    12
8     0    3   0   88   1   0   179   220  517   0   362
9    12   24   0   93   0   4   201   694   11   0    98
10    0    0   0    1   0   0     7     3    0   0  1635
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_13_15_38_seed_1_22562329_instance_wise_predictions.txt
accuracy from prediction file 0.3768278178129154
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193901 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |  20407 KiB |  39751 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 193901 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |  20407 KiB |  39751 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191313 KiB | 459649 KiB |   1485 TiB |   1485 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1454 TiB |   1454 TiB |
|       from small pool |  18499 KiB |  37832 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 528384 KiB | 528384 KiB |    792 MiB | 282624 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  40960 KiB |  40960 KiB |     54 MiB |  14336 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47763 KiB |  87899 KiB |    829 TiB |    829 TiB |
|       from large pool |  31306 KiB |  79555 KiB |    798 TiB |    798 TiB |
|       from small pool |  16457 KiB |  21843 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    5870    |    7848    |  285783 K  |  285777 K  |
|       from large pool |      76    |     158    |  146818 K  |  146818 K  |
|       from small pool |    5794    |    7730    |  138965 K  |  138959 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5870    |    7848    |  285783 K  |  285777 K  |
|       from large pool |      76    |     158    |  146818 K  |  146818 K  |
|       from small pool |    5794    |    7730    |  138965 K  |  138959 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      60    |      18    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      20    |      20    |      27    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    1293    |  151126 K  |  151126 K  |
|       from large pool |      10    |      22    |   88253 K  |   88253 K  |
|       from small pool |      24    |    1285    |   62873 K  |   62873 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  39751 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  39751 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  37832 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 241664 KiB | 528384 KiB |    792 MiB | 569344 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  36864 KiB |  40960 KiB |     54 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87899 KiB |    829 TiB |    829 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    798 TiB |    798 TiB |
|       from small pool |      0 KiB |  30718 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7848    |  285783 K  |  285783 K  |
|       from large pool |       2    |     158    |  146818 K  |  146818 K  |
|       from small pool |       0    |    7730    |  138965 K  |  138965 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7848    |  285783 K  |  285783 K  |
|       from large pool |       2    |     158    |  146818 K  |  146818 K  |
|       from small pool |       0    |    7730    |  138965 K  |  138965 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      42    |      60    |      32    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      18    |      20    |      27    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1293    |  151128 K  |  151128 K  |
|       from large pool |       3    |      22    |   88253 K  |   88253 K  |
|       from small pool |       0    |    1285    |   62874 K  |   62874 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  39751 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  39751 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  37832 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 241664 KiB | 528384 KiB |    792 MiB | 569344 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  36864 KiB |  40960 KiB |     54 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87899 KiB |    829 TiB |    829 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    798 TiB |    798 TiB |
|       from small pool |      0 KiB |  30718 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7848    |  285783 K  |  285783 K  |
|       from large pool |       2    |     158    |  146818 K  |  146818 K  |
|       from small pool |       0    |    7730    |  138965 K  |  138965 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7848    |  285783 K  |  285783 K  |
|       from large pool |       2    |     158    |  146818 K  |  146818 K  |
|       from small pool |       0    |    7730    |  138965 K  |  138965 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      42    |      60    |      32    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      18    |      20    |      27    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1293    |  151128 K  |  151128 K  |
|       from large pool |       3    |      22    |   88253 K  |   88253 K  |
|       from small pool |       0    |    1285    |   62874 K  |   62874 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329

 Experiment start at: 2024-07-22 02:32:28.991511
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.51482236, 'precision': 0.23385787, 'recall': 0.17237589, 'specificity': 0.9376426, 'f1': 0.15646105, 'auroc': 0.7406646}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   2   0    56   0   0   2    60    2   0    361
1    0  36   0    69   1   0   5   565    3   0    653
2    0   0   0    76   0   0   0    41    1   0    194
3    0   6   0  4444   2   0  17  1644   37   0   2288
4    0   0   0    79   0   0   0    30    8   0    422
5    0   1   0   286   0   0   0    28    1   0    205
6    0   7   0   369   0   0  10   122   15   0   1384
7    0   4   0  1322   0   0   7  2879    7   0   3046
8    0   0   0  1187   0   0   5   213   56   0   1835
9    0   0   0   208   1   0   0    45    2   0    237
10   0   0   0   439   1   0  10   408  115   0  11817
---- Validation: 
scalar performance:
{'acc': 0.51707906, 'precision': 0.2377508, 'recall': 0.17302856, 'specificity': 0.93792427, 'f1': 0.15697625, 'auroc': 0.74162227}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   1   0    61   0   0   1    60   1   0    359
1    0  31   0    62   0   1   6   559   2   0    671
2    0   0   0    81   0   0   0    40   0   0    191
3    0   9   0  4487   0   0  17  1618  43   0   2266
4    0   1   0    96   0   0   0    28   3   0    411
5    0   0   0   286   1   0   0    22   0   0    212
6    0   4   0   334   0   0  11   118  14   0   1427
7    0   2   0  1345   2   0  12  2878   9   0   3017
8    0   0   0  1178   1   0   5   255  65   0   1792
9    0   1   0   219   0   0   1    38   3   0    231
10   0   0   0   418   2   0   9   412  96   0  11859
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.13454138, 'precision': 0.05605084, 'recall': 0.11251947, 'specificity': 0.91155, 'f1': 0.038294755, 'auroc': 0.5874506}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   0   0   0   0   0   0  429   0   0   741
1    0   0   0   0   0   0   0  426   0   0  1073
2    0   0   0   4   0   0   0  114   1   0   896
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   0   0   0   0   10   0   0  1623
5    0   0   0  40   0   0   0  192   2   0   358
6    0   1   0   0   0   0   0   40   0   0  3026
7    0   0   0   0   0   0   0  275   0   0   889
8    0   0   0  15   0   0   0   77   2   0  1276
9    0   0   0  10   0   0   0  266   1   0   860
10   0   0   0   0   0   0   0    0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 02:58:51.502377,epoch time: 0:26:22.510866,used: 0:26:22.510866,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6281304, 'precision': 0.35297835, 'recall': 0.23488265, 'specificity': 0.9532381, 'f1': 0.22680295, 'auroc': 0.84804296}
confusion matrix:
    0    1   2     3   4   5   6     7    8   9      10
0    0    4   0    85   0   0   3    89    2   0    300
1    0  276   0    80   0   0   2   724    2   0    248
2    0    0   0   109   0   0   0    32    3   0    168
3    0   12   0  6451   0   0   5  1353   29   0    587
4    0    1   0    91   0   0   0    11    3   0    433
5    0    0   0   440   0   0   1     7    4   0     69
6    0    8   0   291   0   0  49    76   25   0   1459
7    0   21   0  1772   0   0   0  4246    9   0   1215
8    0    3   0  1286   0   0   2   160  125   0   1718
9    0    3   0   317   0   0   2    26    4   0    140
10   0    0   0   263   0   0   5   140   57   0  12330
---- Validation: 
scalar performance:
{'acc': 0.6273104, 'precision': 0.39963847, 'recall': 0.23484121, 'specificity': 0.9531734, 'f1': 0.22717512, 'auroc': 0.8504047}
confusion matrix:
    0    1   2     3   4   5   6     7    8   9      10
0    0    9   0    89   0   0   3    81    2   0    299
1    0  275   0    74   0   0   1   726    3   1    252
2    0    0   0   104   0   1   0    38    2   0    167
3    0   15   0  6395   1   0   2  1357   50   0    620
4    0    0   0    95   0   0   0    12    7   0    425
5    0    1   0   440   0   1   0     9    3   2     65
6    0    8   0   304   0   0  50    66   29   0   1451
7    0   17   0  1755   0   0   0  4272   14   0   1207
8    0    1   0  1319   0   0   2   160  130   0   1684
9    0    0   0   320   1   0   1    26    2   0    143
10   0    2   0   265   0   0   6   136   58   0  12329
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.17421116, 'precision': 0.09837666, 'recall': 0.15670858, 'specificity': 0.9160465, 'f1': 0.057138726, 'auroc': 0.6545399}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   4   0   0   0   0   0   650   0   0   516
1    0   4   0   3   0   0   0  1090   0   0   402
2    0   0   0   3   0   0   0   192   1   0   819
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    13   0   0  1620
5    0   0   0  79   0   0   0   271   4   0   238
6    0   3   0   1   0   0   0    43   0   0  3020
7    0   8   0   1   0   0   0   835   0   0   320
8    0   1   0  39   0   0   0   135   6   0  1189
9    0   0   0  21   0   0   0   503   1   0   612
10   0   0   0   0   0   0   0     1   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 03:24:16.389535,epoch time: 0:25:24.887158,used: 0:51:47.398024,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.67291844, 'precision': 0.41836056, 'recall': 0.27969566, 'specificity': 0.959246, 'f1': 0.28407326, 'auroc': 0.8957086}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   11   0    72   0   0   12   122    1   0    265
1    0  536   0    45   0   0    6   627    1   0    117
2    0    0   0   104   0   1    4    54    2   0    147
3    1   16   0  6492   1   0    4  1474   86   0    364
4    0    0   0    74   0   0    4    16   10   0    435
5    0    2   0   457   0   0    2     8    3   1     47
6    0   14   0   202   0   0  242    93   17   0   1340
7    0   31   0  1384   0   0    2  5135   21   0    689
8    1    2   0  1090   1   0    4   229  323   0   1644
9    0    2   0   314   0   1    7    38    9   1    121
10   0    4   0   159   1   0   14   146   48   1  12422
---- Validation: 
scalar performance:
{'acc': 0.6723017, 'precision': 0.45851892, 'recall': 0.27694285, 'specificity': 0.9591928, 'f1': 0.2803753, 'auroc': 0.89453924}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   14   0    83   0   0   10   110    1   0    265
1    0  507   0    43   0   0    2   665    3   0    112
2    0    3   0    96   0   1    6    56    2   0    148
3    0   13   0  6501   0   0    8  1495   82   0    341
4    0    1   0    74   0   0    1    13   11   0    439
5    0    1   0   439   0   1    6    10    7   4     53
6    0   16   0   199   0   0  210    95   27   0   1361
7    0   31   0  1380   0   0    3  5154   23   0    674
8    0    4   0  1040   0   0    8   252  315   0   1677
9    0    3   0   324   0   0    6    40    6   3    111
10   0    0   0   140   0   0   25   138   49   1  12443
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18995312, 'precision': 0.14004323, 'recall': 0.17363223, 'specificity': 0.9178467, 'f1': 0.06590757, 'auroc': 0.6893899}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0  13   0   0   0   0   1   752   0   0   404
1    0  25   0   3   0   0   0  1275   0   0   196
2    0   1   0   3   0   0   0   273   1   0   737
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    15   0   0  1618
5    0   1   0  75   0   0   0   332   6   0   178
6    0   4   0   2   0   0   0    66   1   0  2994
7    0  20   0   3   0   0   1  1014   0   0   126
8    0   1   0  37   0   0   1   210  32   0  1089
9    0   0   0  19   0   0   0   682   2   0   434
10   0   0   0   0   0   0   0     2   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-22 03:49:40.715935,epoch time: 0:25:24.326400,used: 1:17:11.724424,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7021618, 'precision': 0.45529246, 'recall': 0.31188703, 'specificity': 0.9632648, 'f1': 0.32254907, 'auroc': 0.9184656}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   11   0    83   0   0   26   133    0   0    230
1    0  677   0    34   0   0    4   559    2   0     56
2    0    0   0   108   0   1    6    60    8   0    129
3    0   12   0  6634   0   0    5  1430  130   0    225
4    0    1   0    70   0   0    6    13    7   0    442
5    0    4   0   441   0   7   12    11   11   3     32
6    0   22   0   164   0   0  403   101   26   0   1192
7    0   46   0  1203   0   0    3  5535   25   0    452
8    0    2   0   976   0   0   11   279  587   1   1440
9    0    3   0   316   0   7   27    49    7   1     83
10   0    6   0   142   0   0   22   166   55   1  12400
---- Validation: 
scalar performance:
{'acc': 0.70148456, 'precision': 0.48585564, 'recall': 0.31271693, 'specificity': 0.96317816, 'f1': 0.32379186, 'auroc': 0.917341}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   13   0    77   0   0   30   136    2   0    225
1    0  688   0    37   0   1    3   549    2   0     52
2    0    0   0    98   0   1   10    64    4   0    135
3    0   15   0  6635   0   2    3  1426  140   0    219
4    0    0   0    75   0   0    5    16   12   0    431
5    0    2   0   442   0   9   16    10   12   1     29
6    0   19   0   162   0   0  413    81   29   1   1203
7    0   42   0  1203   0   1    4  5500   31   0    484
8    0    1   0   988   0   0    7   277  569   0   1454
9    0    5   0   299   0   4   29    57   15   2     82
10   0    7   0   148   0   0   20   154   58   0  12409
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19841881, 'precision': 0.16893864, 'recall': 0.18198189, 'specificity': 0.9188335, 'f1': 0.07463967, 'auroc': 0.71017134}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0  28   0   0   0   0  13   801   0   0   328
1    0  58   0   3   0   0   0  1313   0   0   125
2    0   1   0   2   0   0   0   326   3   0   683
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    24   0   0  1609
5    0   3   0  91   0   0   0   363  10   0   125
6    0   4   0   4   0   0   4    96   1   0  2958
7    0  28   0   4   0   0   0  1067   0   0    65
8    0   2   0  44   0   0   2   271  66   0   985
9    0   3   0  24   0   0   1   790   2   0   317
10   0   0   0   0   0   0   0     5   0   0  1641
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-22 04:15:01.721312,epoch time: 0:25:21.005377,used: 1:42:32.729801,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7245023, 'precision': 0.47137266, 'recall': 0.33959854, 'specificity': 0.9661538, 'f1': 0.35399687, 'auroc': 0.9300659}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   11   0    79   0   0   54   108    1   0    230
1    0  790   0    31   0   0    1   463    3   0     43
2    0    1   0   103   0   3   19    60    5   0    121
3    0    8   0  6933   0   0    8  1154  182   2    149
4    0    0   0    75   0   0   16    10   13   0    425
5    0    1   0   438   0  13   28     7   12   7     15
6    0   16   0   154   0   0  613    66   30   0   1028
7    0   41   0  1233   1   0    6  5499   35   0    450
8    0    4   0   904   0   0   16   231  785   0   1356
9    0    6   0   304   1  10   57    31   17   3     64
10   0    6   0   123   0   0   41   122   58   0  12443
---- Validation: 
scalar performance:
{'acc': 0.72486293, 'precision': 0.48373586, 'recall': 0.3401687, 'specificity': 0.966163, 'f1': 0.3539392, 'auroc': 0.9307906}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   12   0    85   0   0   51   111    2   0    222
1    0  799   0    32   0   0    0   449    1   0     51
2    0    1   0   106   1   2   18    58   11   0    115
3    0   14   0  6943   0   0   12  1114  177   1    179
4    0    1   0    68   0   0   13     8   11   0    438
5    0    1   0   431   2  12   25     8   11  10     21
6    0   24   0   133   0   0  629    68   33   0   1021
7    0   51   0  1199   0   0    3  5520   43   0    449
8    0    1   0   900   0   0   17   255  745   0   1378
9    0    3   0   313   0   5   59    31   10   4     68
10   0    2   0   133   0   0   41   113   60   0  12447
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.203946, 'precision': 0.17746708, 'recall': 0.18658313, 'specificity': 0.9193423, 'f1': 0.08431694, 'auroc': 0.7238967}
confusion matrix:
    0    1   2    3   4   5   6     7   8   9     10
0    0   41   0    0   0   0  34   744   1   0   350
1    0  109   0    4   0   0   0  1253   0   0   133
2    0    3   0    5   0   0   1   291   3   0   712
3    0    0   0    0   0   0   0     0   0   0     0
4    0    0   0    0   0   0   0    19   0   0  1614
5    0    7   0  122   0   0   3   309  11   0   140
6    0    5   0    5   0   0  11    79   2   0  2965
7    0   35   0    4   0   0   0  1061   0   0    64
8    0    5   0   56   0   0   3   225  91   0   990
9    0    6   0   35   0   0   5   749   1   0   341
10   0    0   0    0   0   0   0     3   0   0  1643
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-22 04:40:27.638874,epoch time: 0:25:25.917562,used: 2:07:58.647363,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7425086, 'precision': 0.5213295, 'recall': 0.36156338, 'specificity': 0.96853435, 'f1': 0.3793856, 'auroc': 0.93947524}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    1   11   0    81   0   0   68   123    3   0    196
1    0  829   0    27   0   0    5   421    4   1     45
2    0    1   0    99   0   9   27    54   12   2    108
3    1   10   0  7056   0   1   14  1032  195   1    129
4    0    0   0    67   0   0   22    13   19   0    417
5    0    0   0   417   0  28   30     9   14  12     11
6    0   20   0   113   0   0  778    64   35   0    898
7    0   38   0  1066   1   1    5  5735   41   0    376
8    0    2   0   850   0   1   16   283  881   0   1263
9    0    7   0   284   1  24   64    28   12  13     60
10   1    4   0   120   0   0   40   132   63   0  12431
---- Validation: 
scalar performance:
{'acc': 0.7427043, 'precision': 0.5423818, 'recall': 0.36294413, 'specificity': 0.96854854, 'f1': 0.38192555, 'auroc': 0.9379878}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   10   0    68   0   1   71   126    5   0    202
1    0  823   0    28   0   0    1   435    1   0     44
2    0    3   0    94   0   2   31    56    9   2    115
3    0   11   0  7032   0   4    5  1077  180   0    131
4    0    0   0    68   1   0   14    12   15   0    429
5    0    0   0   408   0  38   34     5   14   6     16
6    0   13   0   111   0   1  773    76   28   0    906
7    0   54   0  1065   1   0    8  5750   45   0    342
8    0    1   0   844   0   1   19   262  920   1   1248
9    0    4   0   298   1  19   57    36   11  10     57
10   0    7   0   117   0   0   39   151   63   0  12419
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2091933, 'precision': 0.19285432, 'recall': 0.19121978, 'specificity': 0.91991544, 'f1': 0.09028546, 'auroc': 0.7344303}
confusion matrix:
    0    1   2    3   4   5   6     7    8   9     10
0    0   36   0    0   0   0  54   761    1   0   318
1    0  126   0    4   0   0   0  1265    0   0   104
2    0    2   0    6   0   0   1   316    3   0   687
3    0    0   0    0   0   0   0     0    0   0     0
4    0    0   0    0   0   0   0    21    0   0  1612
5    0    6   0  131   0   0   5   325   10   0   115
6    0    2   0    4   0   0  24    94    2   0  2941
7    0   32   0    3   0   0   0  1080    0   0    49
8    0    2   0   68   0   0   4   242  118   1   935
9    0    6   0   40   0   0   8   788    2   0   293
10   0    0   0    0   0   0   0     4    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-22 05:05:48.502459,epoch time: 0:25:20.863585,used: 2:33:19.510948,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.757866, 'precision': 0.5950561, 'recall': 0.3827674, 'specificity': 0.9706657, 'f1': 0.39960855, 'auroc': 0.94462776}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   16   0    85   0   0   84   116     1   0    181
1    0  925   0    25   0   0    0   353     3   0     25
2    0    2   1    90   0   9   30    75     7   0     98
3    0   10   0  7095   0   3    8  1002   207   0    113
4    0    0   0    62   0   0   21    24    22   1    408
5    0    2   0   405   0  32   30     6    16  15     15
6    0   29   0   109   0   1  886    77    31   1    774
7    0   59   0   985   0   0    9  5881    40   0    290
8    1    1   0   860   0   1   17   272  1097   0   1047
9    0    2   0   281   1  23   67    55     9  17     38
10   0    4   0   106   0   0   63   158    69   0  12392
---- Validation: 
scalar performance:
{'acc': 0.75714856, 'precision': 0.5919863, 'recall': 0.38170323, 'specificity': 0.97058785, 'f1': 0.3985455, 'auroc': 0.94491625}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    1   15   0    79   0   0   80   126     1   0    181
1    0  917   0    22   0   0    2   359     3   0     29
2    0    5   0    94   0   7   40    66    10   0     90
3    0    9   0  7145   0   3   13   962   210   1     97
4    0    2   0    68   0   0   24    17    15   0    413
5    0    0   0   393   0  38   40     9    14  19      8
6    0   20   0   109   0   0  896    73    30   1    779
7    0   55   0   989   0   1    5  5889    49   0    277
8    0    1   0   893   0   0   20   284  1032   0   1066
9    0    5   1   298   1  21   69    29    17  14     38
10   0    3   0   123   0   0   44   183    69   0  12374
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2172392, 'precision': 0.28230876, 'recall': 0.198133, 'specificity': 0.920773, 'f1': 0.10140908, 'auroc': 0.7437042}
confusion matrix:
    0    1   2    3   4   5   6     7    8   9     10
0    1   77   0    1   0   0  73   744    1   0   273
1    0  211   0    4   0   0   0  1195    1   0    88
2    0    5   0    9   0   0   3   344    4   0   650
3    0    0   0    0   0   0   0     0    0   0     0
4    0    0   0    0   0   0   0    26    0   0  1607
5    0    8   0  155   0   0  10   324    8   0    87
6    0    8   0    5   0   0  30   112    2   0  2910
7    0   42   0    4   0   0   0  1078    0   0    40
8    0    7   0   88   0   0   7   256  143   1   868
9    0    8   0   52   0   0  10   819    2   0   246
10   0    0   0    0   0   0   0     4    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-22 05:31:16.354129,epoch time: 0:25:27.851670,used: 2:58:47.362618,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.771966, 'precision': 0.6326597, 'recall': 0.40832037, 'specificity': 0.97256434, 'f1': 0.43238991, 'auroc': 0.948925}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    4   14   0    89   0   0  103   121     1   0    151
1    0  939   0    24   0   0    4   332     6   0     27
2    0    4  10    91   1   6   48    52    11   5     84
3    0    6   0  7231   0   9   10   866   229   0     88
4    0    0   1    56   0   0   24    26    32   0    400
5    1    0   0   375   0  65   29     5    17  21      8
6    1   27   0    92   0   0  998    73    38   0    677
7    0   50   0   968   0   2    7  5912    52   1    270
8    0    0   0   788   0   1   20   252  1297   0    938
9    1    4   2   250   0  46   78    35    14  33     30
10   1    5   0   116   1   0   57   148   101   0  12364
---- Validation: 
scalar performance:
{'acc': 0.7716464, 'precision': 0.6564931, 'recall': 0.40677428, 'specificity': 0.9725278, 'f1': 0.42998022, 'auroc': 0.9495904}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    4   16   0    87   0   1  106   104     4   0    161
1    0  928   0    30   0   0    1   339     7   0     27
2    1    6   7    83   0   7   42    58    13   7     88
3    0    6   0  7222   0   7   15   869   233   0     88
4    0    1   1    67   1   0   30    18    23   1    397
5    1    2   0   375   0  71   33     5    12  16      6
6    0   16   0    87   0   0  999    81    41   1    683
7    0   50   0   988   1   2    4  5906    52   1    261
8    0    1   0   778   0   1   17   255  1308   1    935
9    0    1   4   244   1  51   88    34    16  26     28
10   0    3   0   116   0   0   59   157    85   0  12376
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2233261, 'precision': 0.2836706, 'recall': 0.20325185, 'specificity': 0.92135, 'f1': 0.1099759, 'auroc': 0.7521675}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    1   72   0    2   0   0  122   724    1   0   248
1    0  216   0    4   0   0    2  1194    0   0    83
2    0    4   0   10   0   0    8   340    6   0   647
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    26    0   0  1607
5    0    8   0  174   0   0   19   300   15   0    76
6    0    5   0    9   0   0   48   111    4   0  2890
7    0   39   0    5   0   0    0  1081    0   0    39
8    0    4   0   94   0   0   10   245  204   1   812
9    0    8   0   66   0   0   17   810    2   0   234
10   0    0   0    0   0   0    0     4    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-22 05:56:52.346123,epoch time: 0:25:35.991994,used: 3:24:23.354612,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.7821597, 'precision': 0.6555624, 'recall': 0.42853197, 'specificity': 0.9741239, 'f1': 0.44904995, 'auroc': 0.9538139}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0    3   12   0    62   0    1   130   134     5   1    135
1    0  963   0    20   0    0     3   310     4   0     31
2    0    2   3    72   0   13    60    70    11  12     69
3    0   14   1  6979   0    8    12  1030   323   1     71
4    0    1   0    55   1    2    50    25    28   2    375
5    1    0   0   322   0  105    31    10    18  28      6
6    0   19   0    61   0    1  1135    76    42   1    573
7    0   60   0   754   0    1    13  6138    68   1    229
8    0    2   0   590   0    3    30   327  1496   1    846
9    0    4   2   206   1   64    91    41    15  41     28
10   0    6   0    74   1    0    69   168   103   0  12370
---- Validation: 
scalar performance:
{'acc': 0.7836833, 'precision': 0.6724246, 'recall': 0.43189517, 'specificity': 0.9743067, 'f1': 0.45528615, 'auroc': 0.95406884}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0    9   14   0    68   0    1   123   123     2   1    142
1    0  951   0    16   0    0     2   340     4   0     19
2    0    1   5    68   0   12    65    69    17   8     67
3    0    8   0  6984   0   14    18  1049   299   3     65
4    0    0   0    54   0    0    52    20    36   2    375
5    0    1   0   331   0  101    28     5    16  34      5
6    0   21   0    68   0    1  1144    71    36   1    566
7    0   51   0   706   0    2    11  6196    80   2    217
8    0    2   0   594   0    1    26   311  1510   4    848
9    0    3   1   230   1   59    70    39    15  52     23
10   1    6   0    88   0    1    83   168   102   1  12346
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23025256, 'precision': 0.34297362, 'recall': 0.20923105, 'specificity': 0.9218997, 'f1': 0.11875586, 'auroc': 0.75934637}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    2   77   0    2   0   0  193   697    1   0   198
1    1  242   0    4   0   0    2  1177    0   0    73
2    0    4   0    7   0   0   16   374    6   0   608
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    30    0   0  1603
5    0    9   0  145   0   6   31   319   19   0    63
6    0    6   0    5   0   0   79   130    6   0  2841
7    0   40   0    2   0   0    1  1091    0   0    30
8    0    6   0   72   0   0   30   265  233   1   763
9    0   10   0   48   0   0   36   834    5   0   204
10   0    0   0    0   0   0    1     7    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-22 06:22:24.739843,epoch time: 0:25:32.393720,used: 3:49:55.748332,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.78785855, 'precision': 0.66554976, 'recall': 0.4390575, 'specificity': 0.9748529, 'f1': 0.46426365, 'auroc': 0.9564332}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   10   11   0    64   0    0   140   113     4   1    140
1    0  964   0    16   0    0     1   318     5   0     28
2    0    1  21    59   2    8    59    70    16   7     69
3    0    8   0  6984   0   11    16  1027   325   1     65
4    0    1   0    46   0    0    49    22    36   0    385
5    1    1   0   319   0  112    43     4    25  12      4
6    0   20   0    70   0    1  1149    81    43   0    544
7    0   44   0   678   0    1    13  6211    86   1    229
8    0    0   0   545   0    3    23   329  1612   0    782
9    0    3   9   215   0   73    83    39    18  31     22
10   1    3   0    68   0    1    74   176   118   0  12353
---- Validation: 
scalar performance:
{'acc': 0.790317, 'precision': 0.6697231, 'recall': 0.44485295, 'specificity': 0.9751425, 'f1': 0.47199672, 'auroc': 0.95692223}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   14   11   0    55   0    0   123   124     4   0    152
1    0  981   0    15   0    0     4   304     6   0     22
2    1    3  25    53   0   10    55    66    20   8     71
3    0    8   0  6993   0   11    15  1013   329   3     68
4    0    0   0    49   0    1    56    22    45   1    365
5    0    1   1   316   0  107    34     9    25  25      3
6    0   19   0    61   0    1  1161    72    44   0    550
7    0   50   0   654   0    3    10  6236    72   0    240
8    0    3   0   526   1    4    31   328  1637   0    766
9    0    4  10   206   1   65    77    33    20  42     35
10   0    4   0    66   0    0    73   185   117   1  12350
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23473029, 'precision': 0.34482545, 'recall': 0.21289584, 'specificity': 0.922328, 'f1': 0.12397381, 'auroc': 0.7637574}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    2   80   0    2   0   0  202   684    1   0   199
1    1  260   0    4   0   0    4  1157    0   0    73
2    0    3   0    6   0   0   19   367    9   0   611
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    29    0   0  1604
5    0    9   0  152   0   4   33   307   22   0    65
6    0    5   0    6   0   0   87   126    7   0  2836
7    0   41   0    2   0   0    1  1091    0   0    29
8    0    5   0   69   0   0   28   257  272   1   738
9    0   10   0   47   0   0   41   831    6   0   202
10   0    0   0    0   0   0    1     6    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-22 06:47:53.471727,epoch time: 0:25:28.731884,used: 4:15:24.480216,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.7947881, 'precision': 0.71124524, 'recall': 0.4548353, 'specificity': 0.97558254, 'f1': 0.48011962, 'auroc': 0.95878637}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   24    14   0    59   0    0   126    99     3   1    157
1    0  1048   0    14   0    0     3   245     7   0     14
2    0     1  11    54   1   20    63    63    17  12     70
3    0    10   0  7068   0   13    12   943   322   1     70
4    0     0   1    47   2    0    46    21    40   1    381
5    0     0   1   302   0  137    31     3    18  22      7
6    2    24   0    56   0    1  1166    55    39   0    565
7    0    71   0   683   0    2     5  6161    92   0    249
8    0     2   0   499   0    3    22   283  1634   2    849
9    2     5   8   172   0   92    75    36    16  50     36
10   0     3   0    61   0    0    68   149   107   1  12405
---- Validation: 
scalar performance:
{'acc': 0.79371405, 'precision': 0.6665319, 'recall': 0.4520169, 'specificity': 0.97548294, 'f1': 0.47630268, 'auroc': 0.9572543}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   19    18   0    60   0    0   115   112     7   0    152
1    0  1024   0    18   0    1     2   262     3   0     22
2    0     4  12    60   0   20    65    56    16  12     67
3    0    18   0  7045   0   11    14   917   344   1     90
4    0     0   1    39   0    2    58    15    38   1    385
5    1     1   0   288   0  142    34     5    21  20      9
6    1    21   0    49   0    3  1154    65    44   0    571
7    1    69   0   670   1    1    11  6186    82   3    241
8    0     3   0   481   0    5    30   306  1639   1    831
9    1     4   3   188   0   82    85    26    26  47     31
10   0     7   0    72   0    0    63   149    99   1  12405
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24249633, 'precision': 0.3399441, 'recall': 0.21953109, 'specificity': 0.922984, 'f1': 0.13610488, 'auroc': 0.7675586}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   13  117   0    2   0   1  220   603    1   0   213
1    1  375   0    4   0   0    5  1030    0   0    84
2    0    7   0    8   0   0   21   314    9   0   656
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    21    0   0  1612
5    2    9   0  165   0   8   47   265   21   0    75
6    0    8   0    7   0   0   93    93    7   0  2859
7    0   56   0    3   0   0    3  1066    0   0    36
8    0   11   0   70   0   0   35   213  269   1   771
9    0   19   0   57   0   1   53   762    4   0   241
10   0    0   0    0   0   0    1     3    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-22 07:13:24.207086,epoch time: 0:25:30.735359,used: 4:40:55.215575,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.79981804, 'precision': 0.71056324, 'recall': 0.46073318, 'specificity': 0.97636956, 'f1': 0.488994, 'auroc': 0.9595642}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   18    8   0    62   0    0   143   104     4   1    143
1    0  999   0    15   0    0     2   291     5   0     20
2    0    1  19    58   2    9    65    52    21  19     66
3    0    4   0  7108   0   11    20   903   329   5     59
4    0    0   3    53   2    2    58    19    46   2    354
5    0    0   0   311   0  106    35     2    21  44      2
6    0   15   0    54   1    2  1257    63    37   3    476
7    0   42   0   684   1    2    10  6209    99   1    216
8    0    0   0   529   0    2    27   286  1724   1    727
9    0    2   4   200   1   64    75    35    13  82     16
10   0    6   0    75   0    0    78   135   125   1  12370
---- Validation: 
scalar performance:
{'acc': 0.8028621, 'precision': 0.7261896, 'recall': 0.4664535, 'specificity': 0.9767269, 'f1': 0.49652076, 'auroc': 0.9601085}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   24   10   0    70   0    0   132   109     1   0    137
1    0  993   0    15   0    0     6   292     6   0     20
2    0    3  19    52   1   14    59    59    22  22     61
3    0    7   0  7154   1   17    23   877   298   3     60
4    0    0   5    42   4    0    59    20    42   6    361
5    0    0   1   299   0  113    31     6    20  47      4
6    1   11   0    49   0    2  1263    68    38   1    475
7    0   37   1   668   0    2    14  6238    93   1    211
8    0    3   0   494   0    4    30   290  1752   0    723
9    0    2   7   194   0   59    67    39    21  91     13
10   1    5   1    69   0    0    81   146   128   1  12364
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24578466, 'precision': 0.35679847, 'recall': 0.22119404, 'specificity': 0.9232726, 'f1': 0.13867466, 'auroc': 0.77326614}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   14   78   0    3   0   1  275   627    2   0   170
1    1  306   0    5   0   0    6  1108    0   0    73
2    0    3   0   11   0   0   31   340   11   0   619
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    25    1   0  1607
5    0    8   0  186   0   7   66   254   17   0    54
6    0    5   0    8   0   0  148   104    8   0  2794
7    0   40   0    3   0   0    5  1085    0   0    31
8    0    6   0   79   0   0   54   230  313   1   687
9    0   10   0   63   0   1   80   780    6   0   197
10   0    0   0    0   0   0    2     4    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-22 07:38:56.924633,epoch time: 0:25:32.717547,used: 5:06:27.933122,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8084065, 'precision': 0.7224268, 'recall': 0.47578216, 'specificity': 0.97742176, 'f1': 0.50745314, 'auroc': 0.96197736}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   44    12   0    63   0    0   120   108     6   1    129
1    0  1040   0    19   0    0     3   242     6   0     22
2    1     2  21    55   2   17    56    56    19  20     63
3    0    12   0  7280   0   13    11   776   305   1     41
4    0     0   3    41   4    1    51    20    56   4    359
5    3     1   0   294   0  126    28     7    18  40      4
6    2    26   0    59   0    2  1252    64    41   2    460
7    0    50   0   687   0    2    12  6224    93   5    191
8    0     0   1   549   0    1    20   277  1790   0    657
9    1     2  10   184   0   70    66    39    19  79     23
10   2     3   0    73   0    0    83   156   116   2  12355
---- Validation: 
scalar performance:
{'acc': 0.8069279, 'precision': 0.72873217, 'recall': 0.4759736, 'specificity': 0.97722405, 'f1': 0.5095345, 'auroc': 0.9619512}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   47    13   0    62   1    2   125    97     4   0    132
1    0  1033   0    16   0    0     4   252     7   0     20
2    1     3  22    52   2    7    60    56    23  19     67
3    0     8   0  7254   0   13    16   800   300   1     48
4    0     1   2    49   4    1    58    17    40   4    363
5    4     0   0   293   0  134    19     7    26  33      5
6    1    22   0    50   0    4  1224    71    51   0    485
7    0    44   0   706   0    1    12  6211    80   0    211
8    0     0   1   495   0    4    24   328  1807   0    637
9    3     2   7   196   0   73    69    32    15  78     18
10   0     8   0    78   0    0    73   145   138   1  12353
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25732875, 'precision': 0.3540858, 'recall': 0.23196176, 'specificity': 0.92452335, 'f1': 0.15554376, 'auroc': 0.7778009}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   64  100   0    4   0   1  245   594    3   0   159
1    1  373   0    7   0   0    6  1045    0   0    67
2    0    5   0   16   0   0   35   339   10   0   610
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    25    1   0  1606
5    8    8   0  212   0   8   58   227   20   0    51
6    0    7   0    9   0   0  160   107   11   0  2773
7    0   47   0    4   0   0    3  1083    0   0    27
8    0    8   0   94   0   0   50   220  351   1   646
9    2   16   0   87   0   1   80   757    6   0   188
10   0    0   0    1   0   0    2     4    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-22 08:04:30.944890,epoch time: 0:25:34.020257,used: 5:32:01.953379,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8121522, 'precision': 0.71208155, 'recall': 0.49258208, 'specificity': 0.97784805, 'f1': 0.53075266, 'auroc': 0.96268576}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   71     5   0    51   0    0   130    94     5    2    125
1    0  1047   0    18   0    0     1   245     2    0     19
2    1     1  34    45   2    6    60    54    17   30     62
3    0     8   0  7336   1   10    25   751   253    0     55
4    0     0   5    49   6    2    63    17    45    5    347
5    3     1   1   291   0  113    29     3    17   61      1
6    4    15   0    53   0    2  1306    53    37    1    436
7    1    48   1   692   1    0    14  6205   101    0    200
8    0     1   0   512   2    5    37   281  1760    0    698
9    2     1  19   182   1   40    73    26    16  118     15
10   2     7   0    62   1    0    93   155   110    3  12359
---- Validation: 
scalar performance:
{'acc': 0.8127591, 'precision': 0.72494507, 'recall': 0.4941111, 'specificity': 0.97796154, 'f1': 0.5328726, 'auroc': 0.96258897}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   74     5   0    57   0    0   132    91     2    1    121
1    1  1045   0    12   0    0     4   248     7    0     15
2    2     1  43    44   1    6    62    57    14   21     61
3    0     4   1  7316   0    5    16   767   270    6     55
4    0     1   4    47   4    1    76    16    46    3    341
5    3     0   1   295   0  108    32     4    17   57      4
6    5    20   0    59   0    1  1304    60    34    1    424
7    1    54   0   687   0    1    16  6207    82    0    217
8    0     1   2   520   1    2    41   287  1792    2    648
9    6     3  19   180   0   47    68    25    17  113     15
10   1     5   0    61   1    0    88   134   125    2  12379
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.268663, 'precision': 0.36547214, 'recall': 0.24002033, 'specificity': 0.925519, 'f1': 0.17040837, 'auroc': 0.78256047}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   147   90   0    4   0   1  286   508    2   0   132
1     2  403   0    7   0   0    9  1011    0   0    67
2     1    6   0   16   0   0   41   324    9   0   618
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    2    23    1   0  1607
5    18    7   0  215   0   6   76   207   15   1    47
6     0    7   0    8   0   0  247    99    7   0  2699
7     0   50   0    3   0   0    7  1077    0   0    27
8     1    9   0   97   0   0   84   213  319   1   646
9     9   13   0   91   0   0  109   726    5   0   184
10    0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-22 08:30:02.479669,epoch time: 0:25:31.534779,used: 5:57:33.488158,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.81418556, 'precision': 0.717329, 'recall': 0.49240953, 'specificity': 0.9781078, 'f1': 0.5280852, 'auroc': 0.9623931}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   44    10   0    60   1    1   138    97     7   2    123
1    0  1042   0    13   0    0     4   248     5   0     20
2    0     2  38    51   4   12    57    48    15  29     56
3    0     8   0  7361   0   18    16   700   281   1     50
4    0     0   6    45  10    3    68    15    46   3    343
5    1     0   2   268   1  151    20     6    16  54      2
6    1    16   0    51   0    1  1289    52    53   4    441
7    0    51   1   703   0    0    12  6193    91   0    212
8    0     1   1   520   1    2    24   256  1815   1    675
9    5     2  16   179   1   72    64    23    16  95     20
10   0     3   0    58   1    1    81   139   115   3  12393
---- Validation: 
scalar performance:
{'acc': 0.8143908, 'precision': 0.72450286, 'recall': 0.49525288, 'specificity': 0.97815454, 'f1': 0.53110856, 'auroc': 0.96307963}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   45    12   0    67   0    0   132    96     2    5    124
1    0  1053   0    17   0    0     2   240     7    0     13
2    0     0  37    53   4   11    55    56    18   28     50
3    0     7   0  7366   1   18    17   693   295    1     42
4    0     1   3    44   6    2    64    19    47    2    351
5    2     2   1   276   0  153    24     5    13   39      6
6    2    14   0    49   0    2  1307    58    37    4    435
7    0    49   0   712   0    1    14  6165    99    0    225
8    0     1   1   520   1    4    35   276  1833    0    625
9    3     3  11   176   0   70    67    26    15  104     18
10   0     3   0    64   2    1    82   142   123    2  12377
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26495486, 'precision': 0.36032847, 'recall': 0.23578364, 'specificity': 0.9251552, 'f1': 0.16255292, 'auroc': 0.78430384}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   58   92   0   11   0   1  321   537    3   0   147
1    1  413   0    8   0   0    9   996    0   0    72
2    0    6   0   18   0   0   40   311   11   0   629
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    2    21    1   0  1609
5    8    7   0  240   0   8   74   188   16   0    51
6    0    7   0   10   0   0  242    92   12   0  2704
7    0   49   0    4   0   0    7  1077    0   0    27
8    0    8   0  103   0   0   67   194  347   1   650
9    2   12   0  104   0   1  106   714    6   0   192
10   0    0   0    1   0   0    2     1    0   0  1642
better model found
persisted
after epoch: 15,now: 2024-07-22 08:55:31.951850,epoch time: 0:25:29.472181,used: 6:23:02.960339,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8196436, 'precision': 0.72332287, 'recall': 0.5114534, 'specificity': 0.9788814, 'f1': 0.5522061, 'auroc': 0.96497506}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   68     9   0    58   0    0   132    93     4    2    117
1    0  1040   0    17   0    0     1   248     6    0     20
2    2     1  56    46   4   11    48    55    17   21     50
3    0     4   0  7253   0   15    16   764   331    1     55
4    0     0  12    38  10    2    59    18    47    4    349
5    4     1   3   262   0  159    13     5    24   48      2
6    3    13   0    46   0    3  1325    62    52    1    403
7    1    37   2   621   2    2    11  6293   107    0    186
8    0     0   0   460   3    5    30   271  1968    0    558
9    2     2  19   160   0   66    52    31    34  107     20
10   0     3   1    60   3    1    87   138   142    2  12356
---- Validation: 
scalar performance:
{'acc': 0.81941956, 'precision': 0.72700775, 'recall': 0.5095285, 'specificity': 0.9788455, 'f1': 0.5487097, 'auroc': 0.9651498}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   49     8   1    57   0    1   136   101     4    1    125
1    0  1047   0    11   0    0     1   248     6    1     18
2    1     1  55    41   6   11    46    54    19   21     57
3    1     5   2  7280   1   11    13   748   324    2     53
4    0     0  10    37  13    1    49    26    57    5    341
5    3     0   5   267   0  160    21     2    20   41      2
6    3    17   0    47   0    0  1319    51    62    1    408
7    0    40   1   627   2    1    12  6278   107    2    195
8    0     3   0   440   0    3    35   273  1969    4    569
9    3     3  16   167   1   72    58    27    18  113     15
10   3     3   0    55   1    0    86   157   139    1  12351
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.27558944, 'precision': 0.37186652, 'recall': 0.24515265, 'specificity': 0.92623657, 'f1': 0.17608728, 'auroc': 0.78818417}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   117   72   0   10   0   1  307   525    4   0   134
1     1  378   0    7   0   0   11  1036    1   0    65
2     0    3   0   16   0   0   49   331   13   0   603
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    2    24    2   0  1605
5    11    7   0  228   0  10   74   196   20   0    46
6     0    5   0    8   0   0  296   104   18   0  2636
7     0   36   0    3   0   0    7  1094    0   0    24
8     0    6   0   91   0   0   71   211  404   1   586
9     5   11   0   98   0   1  114   726    7   0   175
10    0    0   0    1   0   0    2     3    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-22 09:21:21.039950,epoch time: 0:25:49.088100,used: 6:48:52.048439,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.821784, 'precision': 0.7356003, 'recall': 0.5148118, 'specificity': 0.9791845, 'f1': 0.5540813, 'auroc': 0.9665146}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   87     8   0    56   0    1   121    93     3   2    112
1    1  1063   0    15   0    0     3   227     8   0     15
2    1     0  44    45   4   12    65    45    20  26     48
3    0     6   0  7411   1   18    18   659   285   1     39
4    0     0   6    44  14    2    72    18    53   4    326
5    2     0   3   266   0  165    20     3    18  41      2
6    4    15   0    50   0    2  1367    56    29   1    384
7    1    44   0   682   1    1    23  6237    96   3    176
8    0     2   0   506   0    6    37   263  1932   1    549
9    2     3  14   169   2   85    59    27    17  98     17
10   1     3   1    69   2    1   100   157   161   1  12297
---- Validation: 
scalar performance:
{'acc': 0.8229771, 'precision': 0.7446122, 'recall': 0.51558876, 'specificity': 0.97933316, 'f1': 0.55464584, 'auroc': 0.9660753}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   83     7   0    70   0    0   128    78     4    0    113
1    0  1070   0    17   0    0     1   225     3    1     15
2    0     3  44    50   2   10    63    48    16   28     48
3    1     7   0  7408   0   13    16   667   285    2     41
4    0     0   3    40  12    2    78    21    47    4    332
5    4     1   1   254   0  168    17     8    18   46      4
6    4    17   0    49   0    3  1360    63    43    0    369
7    2    42   1   692   0    1    11  6248    93    1    174
8    0     1   2   506   2    6    28   267  1961    2    521
9    3     1  14   177   2   75    69    24    15  100     13
10   3     5   0    53   0    2   102   160   158    0  12313
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.292171, 'precision': 0.3768197, 'recall': 0.25697753, 'specificity': 0.92784023, 'f1': 0.19471417, 'auroc': 0.7925094}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   180   88   0    9   0   1  336   456    2   0    98
1     2  470   0   13   0   0   13   941    1   0    59
2     0    7   0   23   0   0   72   330   11   0   572
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    27    2   0  1601
5    19    7   0  250   0  11   85   168   16   0    36
6     0    7   0   12   0   0  405   111   18   0  2514
7     0   50   0    8   0   0    8  1079    0   0    19
8     0    8   0  114   0   0  104   201  391   1   551
9     8   16   0  117   0   1  143   699    5   0   148
10    0    0   0    1   0   0    2     3    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-22 09:47:07.338058,epoch time: 0:25:46.298108,used: 7:14:38.346547,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8239244, 'precision': 0.7350733, 'recall': 0.52837807, 'specificity': 0.97933966, 'f1': 0.5706475, 'auroc': 0.96704835}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   80    12   0    57   0    0   123    91     3    1    116
1    0  1079   0    15   0    0     1   219     5    0     13
2    2     1  69    40   7    6    38    55    12   38     44
3    1     5   0  7272   0   19    20   785   278    5     52
4    0     1  15    33  20    1    70    24    46    5    324
5    4     0   3   251   0  136    14     7    18   86      2
6    2    16   0    44   1    2  1335    56    40    4    408
7    1    41   3   541   3    2    19  6407    56    3    188
8    1     1   1   437   1    1    28   327  1866    1    631
9    2     3  24   140   0   54    44    24    16  168     18
10   0     7   1    52   3    0    82   157   121    6  12363
---- Validation: 
scalar performance:
{'acc': 0.82525074, 'precision': 0.7273071, 'recall': 0.52451694, 'specificity': 0.97952676, 'f1': 0.56467646, 'auroc': 0.96677196}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   88     9   0    54   0    1   115    87     4    2    123
1    0  1065   0    12   0    0     3   232     7    0     13
2    1     3  55    30   5    8    53    51    16   42     48
3    0     8   1  7280   2   19    16   783   277    4     50
4    0     1  11    36  10    2    76    26    42    5    330
5    4     0   3   248   0  137    15     5    19   87      3
6    3    19   1    43   0    0  1354    51    32    4    401
7    1    40   0   531   0    0    18  6416    83    1    175
8    1     1   3   444   0    1    29   313  1891    4    609
9    4     2  24   143   2   51    50    26    16  164     11
10   0     6   1    48   0    0    77   141   129    2  12392
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28538445, 'precision': 0.3922754, 'recall': 0.25153196, 'specificity': 0.92713, 'f1': 0.18589033, 'auroc': 0.79254866}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   157   91   0    6   0   1  321   479    2   0   113
1     1  479   0    7   0   0   12   940    1   0    59
2     0    7   0   15   0   0   59   326   10   0   598
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    26    1   0  1603
5    18    7   0  226   0   9   84   187   15   3    43
6     0    6   0    9   0   0  368   107   13   0  2564
7     0   45   0    4   0   0    6  1088    0   0    21
8     0    7   0   94   0   0   93   224  337   1   614
9     6   14   0   87   0   1  133   727    5   1   163
10    0    0   0    1   0   0    2     3    0   0  1640
better model found
persisted
after epoch: 18,now: 2024-07-22 10:12:35.342154,epoch time: 0:25:28.004096,used: 7:40:06.350643,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.82659996, 'precision': 0.73250973, 'recall': 0.52310133, 'specificity': 0.9797028, 'f1': 0.56399304, 'auroc': 0.9684911}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   76    10   1    56   0    0   132    98     4    0    106
1    0  1063   1    15   0    0     1   228     5    0     19
2    2     0  52    56   7    7    54    44    12   31     47
3    0     6   1  7473   0   16    13   634   259    1     37
4    0     0  17    43  17    1    64    20    45    3    329
5    3     1   1   249   0  166    16     4    14   63      4
6    4    15   0    42   1    2  1382    48    38    4    372
7    0    38   0   688   1    2    21  6238    93    1    179
8    2     1   0   515   1    5    21   266  1932    1    549
9    4     1  20   161   1   71    54    23    16  128     14
10   1     4   0    57   1    1    90   134   137    1  12368
---- Validation: 
scalar performance:
{'acc': 0.8253845, 'precision': 0.73740804, 'recall': 0.52763224, 'specificity': 0.97957, 'f1': 0.57138836, 'auroc': 0.9689172}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   93     7   0    65   1    0   118    83     5    3    108
1    0  1067   0    15   0    0     2   225    10    1     12
2    0     1  54    54   9    2    45    50    17   34     46
3    0     5   1  7449   0   15    19   651   259    5     36
4    1     0  11    36  22    1    61    28    47    6    326
5    3     0   2   255   2  165    19     1    16   55      3
6    4    21   0    44   0    4  1372    54    44    1    364
7    2    53   1   659   1    0    22  6237   104    1    185
8    0     1   1   526   1    6    29   247  1914    1    570
9    4     0  18   166   1   66    47    25    22  135      9
10   0     6   0    67   4    1    89   153   126    1  12349
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2948996, 'precision': 0.40262744, 'recall': 0.2571874, 'specificity': 0.92808115, 'f1': 0.19475149, 'auroc': 0.79577017}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   151   93   0   13   0   1  353   450    2   0   107
1     1  501   0   14   0   0   15   908    1   0    59
2     0    8   0   25   0   0   78   308   11   0   585
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    23    1   0  1606
5    15    7   0  256   0  10   90   157   14   2    41
6     0    7   0   13   0   0  454    97   17   0  2479
7     0   49   0    8   0   0    8  1080    0   0    19
8     0    8   0  127   0   0  106   190  377   1   561
9     6   16   0  119   0   1  146   687    5   1   156
10    0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-22 10:38:11.527478,epoch time: 0:25:36.185324,used: 8:05:42.535967,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8305865, 'precision': 0.7386001, 'recall': 0.54222775, 'specificity': 0.9802186, 'f1': 0.5827828, 'auroc': 0.9686525}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   95     8   0    61   0    1   113    72    10    2    121
1    0  1094   0    15   0    0     4   203     6    0      9
2    2     2  47    50  12   10    32    43    20   46     48
3    0     4   0  7416   1   16     9   619   325    6     42
4    0     1  12    31  21    2    62    21    56    9    324
5    4     0   1   240   0  163     7     2    17   84      3
6    6    18   0    40   0    0  1391    46    42    5    359
7    1    53   0   648   4    2    15  6253   109    5    173
8    0     1   0   480   1    7    23   225  2013    3    542
9    4     3   9   149   3   51    35    18    11  196     14
10   2     4   0    69   2    1    86   113   160    2  12355
---- Validation: 
scalar performance:
{'acc': 0.82920957, 'precision': 0.72791815, 'recall': 0.53322536, 'specificity': 0.98010266, 'f1': 0.571251, 'auroc': 0.96858203}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   96    10   1    53   0    0   122    78     3    5    115
1    0  1083   0    16   0    1     2   205     8    0     17
2    3     2  38    43  10    5    55    37    10   58     51
3    1     4   0  7458   0   19    15   607   293    5     38
4    0     1   6    37  25    2    53    19    55   10    331
5    4     0   3   235   1  141     9     4    17  105      2
6    6    18   1    40   0    6  1348    60    56    5    368
7    0    52   1   655   1    1    24  6234   105    2    190
8    2     5   2   458   2    3    26   245  2037    5    511
9    1     1  12   147   3   51    38    22    17  189     12
10   2     7   0    50   3    1    87   129   164    2  12351
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.30833274, 'precision': 0.3922149, 'recall': 0.2703057, 'specificity': 0.92947316, 'f1': 0.21213734, 'auroc': 0.7979765}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   213  104   0   11   0   1  318   411    3   0   109
1     1  572   0   14   0   0   15   837    1   0    59
2     0   10   0   24   0   0   74   294   14   0   599
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    22    3   0  1605
5    20    7   0  255   0  11   82   147   21   7    42
6     0    8   0   14   0   0  451    90   23   0  2481
7     0   56   0    8   0   0    9  1070    0   0    21
8     1   10   0  111   0   0   91   174  448   1   534
9     9   22   0  127   0   1  142   666    5   1   164
10    0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-22 11:04:00.688720,epoch time: 0:25:49.161242,used: 8:31:31.697209,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.83310145, 'precision': 0.73861444, 'recall': 0.54912704, 'specificity': 0.98064554, 'f1': 0.59352994, 'auroc': 0.9694656}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   109     3   0    50   0    1   108    97     5    3    106
1     0  1077   0    16   1    0     3   218     4    0     13
2     3     1  77    38   9   11    38    42    24   29     40
3     0     4   1  7381   1   15    13   668   310    5     40
4     0     0  19    35  33    2    64    19    53    8    305
5     2     0   1   232   0  171    12     6    21   70      6
6     5    17   1    44   0    3  1378    58    56    2    344
7     1    41   1   580   2    2    15  6336   112    2    170
8     0     2   2   429   0    9    29   267  2095    3    459
9     7     2  23   130   2   78    47    22    23  148     11
10    4     3   1    47   7    1    84   135   179    1  12333
---- Validation: 
scalar performance:
{'acc': 0.83233917, 'precision': 0.7385387, 'recall': 0.55162823, 'specificity': 0.98053575, 'f1': 0.5971804, 'auroc': 0.9692666}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   123     6   1    58   0    0    91    85     7    2    110
1     0  1076   0    15   0    0     1   214     7    0     19
2     3     0  71    40  10    9    42    44    15   38     40
3     3     6   1  7337   2   20    14   703   313    6     35
4     0     3  13    39  36    1    68    24    48    7    300
5     6     0   1   242   0  171     7     5    16   71      2
6     6    17   1    38   1    2  1401    47    61    1    333
7     2    38   3   580   1    1    22  6347   115    1    155
8     0     1   2   439   1    7    15   255  2077    4    495
9     7     2  24   150   4   64    47    17    16  154      8
10    2     5   0    51   6    1    75   151   180    1  12324
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3192472, 'precision': 0.4102614, 'recall': 0.2794544, 'specificity': 0.9306801, 'f1': 0.22287305, 'auroc': 0.80132633}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   291   77   0   10   0   1  277   425    3   0    86
1     2  509   0   14   0   0   11   911    1   0    51
2     0    8   0   22   0   0   76   337   18   0   554
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    28    4   0  1598
5    27    6   0  248   0  11   81   159   24   2    34
6     1    7   0   15   0   0  525   124   32   0  2363
7     0   43   0    7   0   0    7  1092    0   0    15
8     1    6   0  110   0   0   93   196  494   1   469
9    13   16   0  118   0   1  143   698    6   1   141
10    0    0   0    1   0   0    2     3    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-22 11:29:43.436037,epoch time: 0:25:42.747317,used: 8:57:14.444526,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8351081, 'precision': 0.74685156, 'recall': 0.5585799, 'specificity': 0.98085487, 'f1': 0.6023623, 'auroc': 0.96982515}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   115    10   0    58   0    0   105    75     7    0    113
1     0  1103   0    16   0    0     2   190     7    0     14
2     0     0  81    32  10    7    43    43    17   37     42
3     0     8   1  7365   0   27    13   654   325    0     44
4     0     0  22    37  30    0    56    20    56    7    311
5     1     0   0   225   0  197    12     3    21   58      4
6     6    20   1    40   0    2  1374    53    56    2    354
7     0    57   2   576   1    4    19  6293   125    1    185
8     0     3   1   409   2    9    24   248  2145    3    451
9     5     3  24   133   5   76    40    19    22  152     14
10    2     6   2    50   3    0    81   126   160    5  12358
---- Validation: 
scalar performance:
{'acc': 0.83386385, 'precision': 0.73857737, 'recall': 0.55045354, 'specificity': 0.9807176, 'f1': 0.5918972, 'auroc': 0.9700132}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   110     7   1    55   0    2   112    78     7    4    107
1     1  1086   0    18   0    0     1   202     8    0     16
2     0     1  69    42   8   10    39    41    17   36     49
3     1     8   1  7396   0   16    14   639   326    0     39
4     0     3  14    31  25    3    75    22    61    4    301
5     3     0   4   230   0  190    16     4    14   55      5
6     8    18   0    41   0    5  1393    45    52    1    345
7     1    54   3   560   2    3    25  6288   119    2    208
8     0     4   3   390   1    4    35   220  2143    3    493
9     9     2  28   132   3   76    43    18    29  145      8
10    2     4   2    52   0    0    91   132   182    2  12329
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32743302, 'precision': 0.41780874, 'recall': 0.2840399, 'specificity': 0.931262, 'f1': 0.22964972, 'auroc': 0.80206007}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   269  101   0    9   0   1  324   365    3   0    98
1     1  605   0   14   0   0   15   807    1   0    56
2     1   10   0   19   0   0   95   283   17   0   590
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    22    3   0  1605
5    29    6   0  244   0  13   96   137   26   1    40
6     0    8   0    8   0   0  586    86   27   0  2352
7     0   57   0    7   0   0   13  1068    0   0    19
8     1    9   0   92   0   0  112   169  495   1   491
9    12   21   0  110   0   1  178   646    8   1   160
10    0    0   0    1   0   0    2     0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-22 11:55:41.048740,epoch time: 0:25:57.612703,used: 9:23:12.057229,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8358572, 'precision': 0.7537322, 'recall': 0.561224, 'specificity': 0.9808297, 'f1': 0.60792243, 'auroc': 0.9696126}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   129     8   1    53   0    0    86    82     7    4    113
1     0  1087   0    10   0    0     1   215     8    0     11
2     1     0  75    35  11    7    29    48    15   39     52
3     0     4   0  7345   0   39    10   714   276    2     49
4     0     0  11    30  33    4    63    20    52    5    321
5     5     1   2   211   0  225    10     4    17   44      2
6     5    15   0    42   0    3  1379    58    48    4    354
7     0    39   1   526   3    4    12  6414    87    1    175
8     0     2   0   429   1   10    28   273  2041    2    508
9     2     0  21   141   4   93    34    25    13  145     15
10    1     6   1    42   8    3    74   135   154    1  12368
---- Validation: 
scalar performance:
{'acc': 0.83739465, 'precision': 0.74845773, 'recall': 0.5612027, 'specificity': 0.981056, 'f1': 0.60707927, 'auroc': 0.9701044}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   113     8   0    54   0    1    96    88     5    4    114
1     0  1076   0    12   0    0     4   225     6    0      9
2     2     1  76    31  13    8    33    47    18   35     48
3     0     2   1  7386   0   26     9   689   290    0     37
4     1     1  13    36  36    1    57    25    55    5    309
5     5     0   2   205   1  225    10     6    13   51      3
6     7    14   0    36   0    3  1389    54    53    4    348
7     0    41   0   501   2    1    14  6401   125    3    177
8     2     0   0   403   3    7    26   281  2066    3    505
9     9     1  22   120   3   98    37    24    14  153     12
10    4     2   1    46   4    2    71   145   136    0  12385
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32050654, 'precision': 0.41126716, 'recall': 0.2800303, 'specificity': 0.93070024, 'f1': 0.22501911, 'auroc': 0.80300844}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   294   75   0   10   0   2  289   397    3   0   100
1     1  509   0   12   0   0   15   908    1   0    53
2     1    4   0   20   0   0   82   310   13   0   585
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    23    3   0  1604
5    29    6   0  241   0  17   85   152   20   2    40
6     0    7   0    9   0   0  558   109   22   0  2362
7     0   38   0    6   0   0    9  1096    0   0    15
8     1    5   0   94   0   0  102   194  465   1   508
9    11   13   0  105   0   2  152   691    6   1   156
10    0    0   0    1   0   0    2     2    0   0  1641
better model found
persisted
after epoch: 23,now: 2024-07-22 12:22:05.130624,epoch time: 0:26:24.081884,used: 9:49:36.139113,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.83639234, 'precision': 0.74225914, 'recall': 0.55506676, 'specificity': 0.9808853, 'f1': 0.6000504, 'auroc': 0.970601}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   117    11   0    54   2    1   101    74     3    3    117
1     1  1095   0    13   0    0     3   197     3    2     17
2     2     2  62    36  15    6    35    42    21   43     48
3     0     5   0  7522   1   23    16   572   260    0     38
4     0     1  17    35  36    1    57    18    43    5    326
5     2     0   2   236   0  181    11     2    10   74      3
6     2    16   0    41   1    2  1423    53    39    2    329
7     5    43   2   671   0    3    17  6251    93    1    179
8     1     0   1   453   2    8    42   254  2021    4    509
9     7     3  20   140   3   61    36    16    19  172     16
10    5     4   2    55   3    0    80   119   141    2  12381
---- Validation: 
scalar performance:
{'acc': 0.8377157, 'precision': 0.7526469, 'recall': 0.56137633, 'specificity': 0.9809487, 'f1': 0.61050963, 'auroc': 0.9708887}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   122     7   1    55   1    0    96    71     4    2    124
1     0  1091   0    20   0    0     2   202     5    0     12
2     3     1  80    33  12    6    38    37    15   39     48
3     2     5   0  7565   2   23     9   555   234    4     41
4     0     1  17    34  37    1    59    23    41    9    317
5     3     1   2   239   0  187    15     1    17   54      2
6     5    19   0    43   1    3  1403    41    44    2    347
7     1    34   1   652   5    2    16  6249   106    4    195
8     0     0   0   475   3    3    27   236  2009    3    540
9     5     1  23   143   1   60    36    20    14  172     18
10    0     3   2    69  10    1    79   114   113    2  12403
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32792276, 'precision': 0.4162473, 'recall': 0.28320235, 'specificity': 0.9314239, 'f1': 0.23033173, 'auroc': 0.80478203}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   290   85   0   19   0   1  314   363    2   0    96
1     1  577   0   14   0   0   15   836    1   0    55
2     2    8   0   31   0   0   92   278   12   0   592
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    22    2   0  1606
5    30    6   0  288   0  11   98   107   12   2    38
6     0    7   0   16   0   0  632    89   22   0  2301
7     0   46   0   10   0   0   12  1080    0   0    16
8     1    7   0  126   0   0  118   170  455   1   492
9    13   19   0  141   0   1  176   625    6   1   155
10    0    0   0    1   0   0    3     1    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-22 12:48:29.200305,epoch time: 0:26:24.069681,used: 10:16:00.208794,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.83992404, 'precision': 0.7417896, 'recall': 0.5695903, 'specificity': 0.9815091, 'f1': 0.6125008, 'auroc': 0.9718933}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   117     6   0    50   1    1   131    75     8    6     88
1     0  1096   0    14   0    0     6   195     3    0     17
2     3     0  72    37  15    8    47    37    13   46     33
3     2     9   0  7457   2   20    18   602   290    4     36
4     0     1  20    34  46    1    67    14    50   11    295
5     3     1   1   219   0  190    12     4    18   72      1
6     8    10   0    34   3    4  1468    47    37    2    295
7     1    52   2   578   2    2    19  6343   109    5    150
8     1     1   2   427   5    6    48   255  2069    7    474
9     6     1  25   128   2   47    46    14    15  197     12
10    4     3   1    49   6    2   101   124   163    1  12338
---- Validation: 
scalar performance:
{'acc': 0.8398823, 'precision': 0.7517606, 'recall': 0.5656074, 'specificity': 0.98148274, 'f1': 0.60839057, 'auroc': 0.97215664}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   115    11   0    48   1    0   119    75     4    2    108
1     0  1094   0    15   0    0     5   197     5    0     16
2     1     1  75    36  10    6    45    45    13   47     33
3     2     7   0  7469   0   21    24   588   289    5     35
4     0     0  23    38  43    2    67    18    37    9    302
5     5     0   1   220   0  177    11     3    15   87      2
6     3    17   1    39   2    2  1483    33    46    5    277
7     0    39   1   598   2    3    25  6338   100    2    157
8     1     1   0   449   3    6    48   228  2093    4    463
9     6     2  21   140   1   56    40    15    16  182     14
10    2     3   1    44   3    3   111   130   167    2  12330
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.35283005, 'precision': 0.5104426, 'recall': 0.2949169, 'specificity': 0.93361044, 'f1': 0.2439327, 'auroc': 0.80901337}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   269   87   0   14   0   1  405   333    3   0    58
1     1  618   0   13   0   0   23   797    1   0    46
2     0   10   0   26   0   0  142   291   16   0   530
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   1   0    5    25    3   0  1599
5    25    6   0  263   0  14  133   109   15   3    24
6     0    8   0   14   0   0  949    89   22   0  1985
7     0   50   0    8   0   0   18  1074    0   0    14
8     0    8   0  118   0   0  177   165  478   1   423
9     9   21   1  124   0   1  251   600    7   1   122
10    0    0   0    1   0   0    4     2    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-22 13:14:42.062156,epoch time: 0:26:12.861851,used: 10:42:13.070645,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.8407267, 'precision': 0.7488384, 'recall': 0.5760546, 'specificity': 0.9814261, 'f1': 0.62278795, 'auroc': 0.9715482}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   159     5   0    43   0    2    69    76     8    2    118
1     1  1085   0    17   0    0     2   208     7    1     11
2     5     1  81    36  15    6    26    49    12   41     40
3     4     4   1  7349   0   34    10   710   282    4     40
4     2     1  17    31  46    3    48    20    45   10    316
5     7     0   4   206   1  223     3     2    16   58      1
6     8    13   0    32   0    3  1413    44    51    4    340
7     1    34   1   509   1    6    16  6415    97    3    179
8     1     0   3   382   1    8    18   278  2116    1    487
9    12     1  31   119   3   86    26    31    13  155     16
10    4     0   1    40   3    1    75   145   142    2  12381
---- Validation: 
scalar performance:
{'acc': 0.84033704, 'precision': 0.7592393, 'recall': 0.5827271, 'specificity': 0.98136806, 'f1': 0.6326067, 'auroc': 0.97162294}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   167     6    0    41   0    0    76    69     8    2    114
1     1  1085    0    16   1    0     3   205     4    1     16
2     6     0  101    24   9   10    29    38    24   30     41
3     3     4    0  7337   1   26    13   720   288    5     43
4     0     0   14    34  52    1    49    27    53    8    301
5     3     0    2   214   0  217    10     4    12   56      3
6    17    17    0    32   2    3  1378    47    45    2    365
7     0    36    1   496   3    1    12  6436   105    3    172
8     2     3    1   395   2   12    23   261  2084    1    512
9    10     0   29   116   3   82    35    21    19  165     13
10    5     3    3    38   7    0    72   140   132    2  12394
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34261528, 'precision': 0.50874525, 'recall': 0.29917085, 'specificity': 0.93301713, 'f1': 0.24677937, 'auroc': 0.8078435}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   457   62   0   10   0   1  226   339    3   0    72
1     2  544   0   12   0   0   13   876    1   0    51
2     6    5   0   20   0   0   83   312   14   0   575
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   1   0    3    25    3   0  1601
5    58    5   0  240   0  17   82   131   21   2    36
6     2    7   0   11   0   0  654   113   23   0  2257
7     0   33   0    6   0   0   10  1100    0   0    15
8     4    4   0   96   0   0  107   191  483   1   484
9    43   17   1  106   0   2  148   668    7   1   144
10    0    0   0    1   0   0    3     2    0   0  1640
better model found
persisted
after epoch: 26,now: 2024-07-22 13:41:50.742996,epoch time: 0:27:08.680840,used: 11:09:21.751485,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.8414758, 'precision': 0.7586552, 'recall': 0.5786312, 'specificity': 0.981459, 'f1': 0.6286852, 'auroc': 0.9721828}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   160     7    0    49   1    0    76    78     5    3    104
1     0  1079    0    19   0    0     3   215     2    1     13
2     5     1  102    37  11    7    26    37    18   27     41
3     1     3    0  7478   1   18     9   632   259    5     31
4     0     0   32    27  47    2    39    24    55    8    305
5     2     0    3   224   0  184     8     6    10   80      4
6    10    15    0    38   1    3  1369    50    41    5    376
7     1    29    2   550   1    2    10  6425    93    1    149
8     1     1    3   441   2    4    27   266  2039    4    507
9    10     2   39   126   3   55    20    19    17  188     14
10    5     1    3    59   5    1    67   138   133    1  12380
---- Validation: 
scalar performance:
{'acc': 0.84204894, 'precision': 0.7565348, 'recall': 0.5776509, 'specificity': 0.98153174, 'f1': 0.62674963, 'auroc': 0.97255135}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   154     8    1    48   0    0    70    84     3    3    112
1     0  1087    0    14   0    0     1   205     6    1     18
2     3     0  104    33  13    6    22    42    18   30     41
3     3     4    1  7488   0   22    11   618   255    5     33
4     0     1   32    32  46    1    44    23    44    8    308
5     3     0    6   224   1  182     4     2    14   82      3
6     8    16    1    50   0    1  1395    50    44    5    338
7     2    30    1   534   1    1    18  6434    81    2    161
8     1     3    4   470   1    3    18   272  2016    4    504
9     8     0   42   128   3   55    26    23    15  181     12
10    2     2    1    49   7    0    62   131   148    1  12393
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33463934, 'precision': 0.511444, 'recall': 0.2900366, 'specificity': 0.93226796, 'f1': 0.23819798, 'auroc': 0.8085456}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   379   65   0   18   0   1  250   372    2   0    83
1     1  528   0   15   0   0   14   891    1   0    49
2     3    4   0   29   0   0   85   314   13   0   567
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   1   0    3    25    2   0  1602
5    37    5   0  285   0  13   82   117   13   3    37
6     1    6   0   17   0   0  665   113   21   0  2244
7     0   33   0    8   0   0   10  1098    0   0    15
8     1    4   0  129   0   0  109   187  458   1   481
9    21   14   1  135   0   1  154   660    5   1   145
10    0    0   0    1   0   0    3     2    0   0  1640
better model found
persisted
after epoch: 27,now: 2024-07-22 14:08:17.092959,epoch time: 0:26:26.349963,used: 11:35:48.101448,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_02_32_28_seed_2_22562329
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 22562329 ON gpusrv68 CANCELLED AT 2024-07-22T14:09:45 ***
