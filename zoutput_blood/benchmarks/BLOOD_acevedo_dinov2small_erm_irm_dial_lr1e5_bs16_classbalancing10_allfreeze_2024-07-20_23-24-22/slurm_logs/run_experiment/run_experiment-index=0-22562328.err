Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 23:26:48 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328

 Experiment start at: 2024-07-20 23:54:31.127032
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.61231804, 'precision': 0.27962717, 'recall': 0.21401072, 'specificity': 0.95119935, 'f1': 0.1928329, 'auroc': 0.7767574}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    45   0   0   1   133   1   0    303
1    0  15   0   149   0   0   1   792   4   0    370
2    0   1   0    66   0   0   1    47   2   0    195
3    0   2   0  5828   0   0   3  1754  63   0    788
4    0   0   0    73   0   0   2    28   8   0    428
5    0   1   0   329   0   0   3    34   6   0    148
6    0   0   0   146   0   0  34   164  29   0   1535
7    0   2   0  1428   0   0   5  4871  33   0    923
8    0   1   0   845   0   0   7   333  66   0   2044
9    0   1   0   208   0   0   5    57   3   0    218
10   0   0   0   300   0   0  32   328  62   0  12072
---- Validation: 
scalar performance:
{'acc': 0.6134546, 'precision': 0.28640527, 'recall': 0.21430753, 'specificity': 0.9513179, 'f1': 0.19307446, 'auroc': 0.77753675}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    50   0   0   6   141   1   0    285
1    0  19   0   150   0   0   4   799   4   0    356
2    0   1   0    63   0   0   3    49   3   0    193
3    0   1   0  5854   0   0   2  1768  72   0    743
4    0   0   0    66   0   0   2    25  10   0    436
5    0   1   0   330   0   0   2    32   7   0    149
6    0   1   0   148   0   0  31   163  21   0   1544
7    0   1   0  1403   0   0   6  4859  22   0    974
8    0   0   0   860   0   0   8   305  59   0   2064
9    0   1   0   207   0   0   4    52   4   0    225
10   0   0   0   282   0   0  24   320  58   0  12112
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18988316, 'precision': 0.038227566, 'recall': 0.17466359, 'specificity': 0.9177818, 'f1': 0.062186353, 'auroc': 0.6044687}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   0   0   1   0   0   0   686   0   0   483
1    0   0   0  17   0   0   0  1260   0   0   222
2    0   0   0  36   0   0   0   217   0   0   762
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   1   0   0   0    24   0   0  1608
5    0   0   0  46   0   0   0   226   0   0   320
6    0   0   0   7   0   0   0    92   0   0  2968
7    0   0   0   5   0   0   0  1083   0   0    76
8    0   0   0  27   0   0   0   147   0   0  1196
9    0   0   0  73   0   0   0   506   1   0   557
10   0   0   0   0   0   0   0    15   0   0  1631
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 00:22:28.473513,epoch time: 0:27:57.346481,used: 0:27:57.346481,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6686644, 'precision': 0.487488, 'recall': 0.2657753, 'specificity': 0.9584081, 'f1': 0.26531786, 'auroc': 0.8808279}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    9   0    66   0   0    9   125    3   0    271
1    0  403   0    76   0   0    4   682    1   0    166
2    0    4   0    79   0   0    3    34   12   0    180
3    0   12   0  6755   0   0    3  1180  115   0    372
4    0    1   0    61   0   0    3     8   10   0    456
5    0    7   0   400   0   1   14    11    9   0     79
6    0    9   0   134   0   0  158    85   43   0   1478
7    0   48   0  1463   0   0    4  4996   39   0    713
8    0    0   0   876   0   0    7   212  234   0   1967
9    0    6   0   264   0   1   21    31   12   2    156
10   0    3   0   161   0   0   33   107   46   0  12443
---- Validation: 
scalar performance:
{'acc': 0.6687709, 'precision': 0.35640478, 'recall': 0.2644906, 'specificity': 0.95840013, 'f1': 0.2636703, 'auroc': 0.88400304}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    5   0    60   0   0    6   105    5   0    302
1    0  392   0    74   0   0    1   668    3   0    194
2    0    2   0    87   0   0    8    34    9   0    172
3    0   13   0  6770   0   0    1  1186  118   0    352
4    0    0   0    69   0   0    4     9   14   0    443
5    0    7   0   421   0   0   16     7   13   1     56
6    0    8   0   151   0   0  144    83   29   0   1493
7    0   35   0  1491   0   0    5  4994   38   0    702
8    0    2   0   869   0   0    8   204  255   0   1958
9    0    6   0   270   0   0   15    28   14   0    160
10   0    2   0   163   0   0   25   114   45   0  12447
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19303155, 'precision': 0.068311356, 'recall': 0.17786336, 'specificity': 0.9182112, 'f1': 0.0624155, 'auroc': 0.68438256}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   0   0   2   0   0   0   721   0   0   447
1    0   1   0  14   0   0   0  1316   0   0   168
2    0   0   0  23   0   0   0   234   0   0   758
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    13   0   0  1620
5    0   1   0  80   0   0   0   276   0   0   235
6    0   0   0   6   0   0   0    93   0   0  2968
7    0   0   0   5   0   0   0  1114   0   0    45
8    0   0   0  38   0   0   0   179   0   0  1153
9    0   1   0  88   0   0   0   605   1   0   442
10   0   0   0   0   0   0   0     2   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 00:46:18.954031,epoch time: 0:23:50.480518,used: 0:51:47.826999,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.71401435, 'precision': 0.49706346, 'recall': 0.3270549, 'specificity': 0.9648561, 'f1': 0.33760148, 'auroc': 0.9200363}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   10   0    85   0   0   39   121    4   0    224
1    0  755   0    44   0   0    4   451    3   0     75
2    0    9   0   104   0   0   31    34   15   0    119
3    0   19   0  7099   0   0    6   968  185   0    161
4    0    1   0    71   0   0   16     7   25   0    419
5    0    2   0   424   0   7   39    11   18   2     18
6    0   15   0   121   0   0  521    81   41   0   1129
7    0   69   0  1441   0   0   12  5283   68   0    391
8    0    3   0   878   0   0   14   227  665   0   1508
9    0    6   0   299   0   5   71    26   18   4     64
10   0    9   0   177   0   0   53   132   67   0  12353
---- Validation: 
scalar performance:
{'acc': 0.71488565, 'precision': 0.47293803, 'recall': 0.32627627, 'specificity': 0.96502024, 'f1': 0.3356985, 'auroc': 0.91918707}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   18   0    73   0   0   40   124    5   0    223
1    0  737   0    54   0   0    4   468    1   0     68
2    0    8   0    94   0   1   35    46   13   1    114
3    0   12   0  7107   0   0   10   965  209   0    137
4    0    1   0    71   0   0   13    15   29   0    410
5    0    4   0   429   0   3   36     8   17   1     23
6    0   15   0   124   0   0  553    75   39   0   1102
7    0   76   0  1421   0   0    9  5297   63   0    399
8    0    4   0   895   0   0   20   246  652   0   1479
9    0   10   0   295   0   2   60    23   23   2     78
10   0    2   0   169   0   0   68   120   62   0  12375
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19638984, 'precision': 0.18297134, 'recall': 0.18113786, 'specificity': 0.91879547, 'f1': 0.06536785, 'auroc': 0.72092074}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   5   0    3   0   0  18   804   0   0   340
1    0  26   0   19   0   0   1  1353   0   0   100
2    0   3   0   38   0   0   1   300   0   0   673
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    20   0   0  1612
5    0   3   0  140   0   0   1   321   0   0   127
6    0   1   0   10   0   0   1   157   0   0  2898
7    0   2   0    5   0   0   0  1135   0   0    22
8    0   0   0   70   0   0   2   252   3   0  1043
9    0   6   0  126   0   0   4   731   0   0   270
10   0   0   0    1   0   0   0     3   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 01:10:25.857228,epoch time: 0:24:06.903197,used: 1:15:54.730196,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.74459547, 'precision': 0.5168937, 'recall': 0.3638721, 'specificity': 0.9689553, 'f1': 0.37748313, 'auroc': 0.9354209}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   16   0    71   0   0   52   149    4   0    191
1    0  851   0    23   0   0    2   399    1   0     55
2    0   10   0    72   0   0   40    65   19   5    101
3    0   11   0  6911   0   1   17  1142  236   0    119
4    0    2   0    58   0   0   33    20   26   0    400
5    0    1   1   385   0  16   61    10   18   8     21
6    0   18   0    72   0   0  780    90   38   0    908
7    0   63   0   900   0   0    5  5951   55   0    291
8    0    3   0   689   0   0   22   342  935   0   1305
9    0   12   0   258   0   5   96    38   16  17     51
10   0    8   0   114   0   0   73   158   71   0  12369
---- Validation: 
scalar performance:
{'acc': 0.7463689, 'precision': 0.515324, 'recall': 0.36780918, 'specificity': 0.9691984, 'f1': 0.3839857, 'auroc': 0.9364076}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   14   0    67   0   0   63   142    4   0    193
1    0  847   0    25   0   0    3   405    2   0     50
2    0    4   0    77   0   0   46    65   17   4     99
3    0   15   0  6899   0   2   11  1165  242   0    106
4    0    2   0    58   0   0   23    18   26   0    412
5    0    1   0   403   0  24   40    11   15  10     17
6    0   18   0    91   0   1  808    97   33   0    860
7    0   55   0   888   0   0   13  5962   64   0    283
8    0    4   0   685   0   0   14   341  964   0   1288
9    0    9   0   275   0  10   96    29   15  21     38
10   0    5   0   117   0   1   71   169   55   0  12378
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20079759, 'precision': 0.18944266, 'recall': 0.18434626, 'specificity': 0.9192439, 'f1': 0.07089476, 'auroc': 0.739597}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   6   0    4   0   0  43   847   0   0   270
1    0  65   0    7   0   0   1  1347   0   0    79
2    0   3   0   24   0   0   3   395   1   0   589
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    38   0   0  1594
5    0   3   0  123   0   0   6   365   2   0    93
6    0   2   0    6   0   0  22   229   0   0  2808
7    0   9   0    3   0   0   0  1134   0   0    18
8    0   1   0   65   0   0   8   329  10   0   957
9    0   6   0   76   0   0  14   852   0   0   189
10   0   0   0    1   0   0   0     6   0   0  1639
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 01:34:01.714470,epoch time: 0:23:35.857242,used: 1:39:30.587438,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.76238763, 'precision': 0.585228, 'recall': 0.39045992, 'specificity': 0.9713687, 'f1': 0.40946186, 'auroc': 0.94380206}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   13   0    67   0   0   75   142     5   0    181
1    0  879   0    22   0   0    4   383     6   0     37
2    0    5   4    60   0   2   51    65    22   7     95
3    0    7   0  6954   0   2   18  1060   297   0    101
4    0    2   0    55   0   1   31    23    32   0    394
5    0    1   0   375   0  35   61     9    19  11     10
6    0   15   0    71   0   0  949    96    31   0    746
7    0   58   0   832   0   0   17  6013    71   0    272
8    0    2   0   565   0   0   20   371  1247   0   1090
9    0    8   2   231   0  15   96    48    24  29     40
10   0    8   0    92   0   0   59   168    82   0  12385
---- Validation: 
scalar performance:
{'acc': 0.7629263, 'precision': 0.57006437, 'recall': 0.39190254, 'specificity': 0.97137797, 'f1': 0.41072428, 'auroc': 0.9448848}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0    8   0    71   0   0   71   150     4   0    179
1    0  914   0    17   0   0    2   362     1   0     36
2    0   11   4    72   0   3   39    64    20   4     95
3    0   12   0  6989   0   3   12  1020   301   2    101
4    0    0   0    55   0   0   30    24    28   0    402
5    0    1   0   381   0  35   42    11    22  20      9
6    0   15   0    75   0   0  938    89    31   1    759
7    0   54   0   814   0   1   14  6026    71   0    285
8    0    3   0   612   0   0   18   336  1212   1   1114
9    0    9   2   249   0  20   96    35    21  30     31
10   1    9   0   106   0   1   61   162    81   1  12374
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20597495, 'precision': 0.29243726, 'recall': 0.18850407, 'specificity': 0.9197222, 'f1': 0.07903652, 'auroc': 0.7532447}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   5   0    3   0   0  73   837   2   0   250
1    0  82   0    6   0   0   1  1337   0   0    73
2    0   3   0   24   0   0   9   400   1   0   578
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    35   0   0  1597
5    0   2   0  133   0   1  15   352   4   0    85
6    0   2   0    6   0   0  41   229   1   0  2788
7    0   9   0    4   0   0   0  1133   0   0    18
8    0   1   0   62   0   0  12   329  45   0   921
9    0   7   0   78   0   0  22   851   1   0   178
10   0   0   0    1   0   0   0     3   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 01:58:25.926952,epoch time: 0:24:24.212482,used: 2:03:54.799920,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.774695, 'precision': 0.711507, 'recall': 0.41494378, 'specificity': 0.9728427, 'f1': 0.44002137, 'auroc': 0.9506744}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    2    9   0    59   0   0    85   142     2   1    183
1    0  941   0    19   0   0     2   334     0   0     36
2    0    8   3    61   0   1    57    62    14  14     92
3    0   10   0  6986   0   5    10  1045   302   0     81
4    0    1   0    42   0   0    39    20    24   0    413
5    0    0   0   334   0  70    38    15    15  38     11
6    0   15   0    62   0   1  1014    82    42   1    690
7    0   55   0   661   0   1    16  6174    65   1    289
8    0    1   0   538   0   0    25   374  1285   1   1071
9    0    4   0   221   1  28    82    38    16  69     34
10   0    6   0    73   0   0    57   171    74   1  12411
---- Validation: 
scalar performance:
{'acc': 0.7776113, 'precision': 0.65331745, 'recall': 0.41604024, 'specificity': 0.9732116, 'f1': 0.44055355, 'auroc': 0.9507221}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    2    8   0    52   0   0    82   159     3   3    174
1    0  932   0    14   0   0     6   345     3   0     32
2    0    5   2    61   2   1    44    67    13  21     96
3    0    6   0  7003   0   4    14  1034   296   1     82
4    0    1   0    51   0   0    38    21    31   0    397
5    0    1   0   345   0  71    41     6    15  36      6
6    0   19   0    63   0   0  1037    86    23   1    679
7    0   47   0   678   0   0    14  6193    68   2    263
8    0    1   0   521   0   0    16   349  1334   1   1074
9    0    6   3   222   0  34    85    27    20  63     33
10   0    6   0    76   0   0    67   144    68   1  12434
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21241167, 'precision': 0.30491596, 'recall': 0.19315034, 'specificity': 0.9202657, 'f1': 0.088488854, 'auroc': 0.7621488}
confusion matrix:
    0    1   2    3   4   5    6     7   8   9     10
0    0    8   0    4   0   0  101   804   2   0   251
1    0  113   0    5   0   0    1  1302   0   0    78
2    0    3   0   18   0   0   15   384   1   0   594
3    0    0   0    0   0   0    0     0   0   0     0
4    0    0   0    0   0   0    0    31   0   0  1602
5    0    2   0  137   0   2   29   339   2   0    81
6    0    2   0    6   0   0   77   199   1   0  2782
7    0   13   0    4   0   0    0  1129   0   0    18
8    0    1   0   61   0   0   19   313  73   0   903
9    0    8   0   69   0   0   37   837   1   0   185
10   0    0   0    1   0   0    1     2   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 02:22:43.266170,epoch time: 0:24:17.339218,used: 2:28:12.139138,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7929152, 'precision': 0.7162063, 'recall': 0.44570902, 'specificity': 0.9753858, 'f1': 0.47227308, 'auroc': 0.9555095}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   16    9   0    68   0   0   121   109     4   1    155
1    0  987   0    24   0   0     2   282     4   0     33
2    0    2   7    63   1   5    67    50    18  22     76
3    0    8   0  7279   0   8    13   771   302   1     55
4    0    0   0    60   1   0    62    20    40   2    354
5    0    0   1   325   0  82    35     3    22  49      4
6    0   17   0    61   0   1  1176    70    39   2    542
7    0   41   0   772   0   3    17  6105    89   3    234
8    0    1   0   560   0   1    32   314  1549   4    833
9    0    7   5   199   0  31    91    29    15  95     21
10   0    5   0    86   0   2    89   161   112   0  12339
---- Validation: 
scalar performance:
{'acc': 0.794035, 'precision': 0.7513937, 'recall': 0.4477433, 'specificity': 0.97549534, 'f1': 0.4748325, 'auroc': 0.95494115}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   10    4   0    77   0   0   117   113     7   0    155
1    0  996   0    19   0   0     3   285     5   1     23
2    0    3   7    65   1   3    68    56    18  20     71
3    0    6   0  7240   1   7    13   803   312   2     56
4    0    1   0    57   3   0    54    19    37   2    366
5    0    0   0   327   0  85    30     6    13  54      6
6    0   15   0    62   0   0  1194    76    39   0    522
7    0   46   0   783   0   0    17  6080    92   2    245
8    0    1   0   550   0   0    28   313  1582   1    821
9    1    5   1   213   1  22    96    25    13  97     19
10   0    2   0    87   0   0    84   139    92   1  12391
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22654447, 'precision': 0.30991176, 'recall': 0.20228305, 'specificity': 0.92152894, 'f1': 0.10602242, 'auroc': 0.773471}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    0   13   0    6   0   0  209   745    2   0   195
1    0  154   0   12   0   0    9  1256    0   0    68
2    0    5   0   27   0   0   38   374    3   0   568
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    31    0   0  1600
5    0    3   0  183   0   2   60   289    1   0    54
6    0    2   0    9   0   0  186   191    3   0  2676
7    0   17   0    6   0   0    0  1126    0   0    15
8    0    1   0   87   0   0   49   285  128   0   820
9    0    8   0  101   0   0   87   781    1   0   159
10   0    0   0    1   0   0    1     2    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-21 02:46:59.909178,epoch time: 0:24:16.643008,used: 2:52:28.782146,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.7980255, 'precision': 0.689766, 'recall': 0.45889175, 'specificity': 0.97616506, 'f1': 0.48673505, 'auroc': 0.95824677}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   33   10   0    58   0    0   124   129     6   1    122
1    0  992   0    19   0    0     2   292     3   0     24
2    0    3  13    52   7    5    70    67    20  16     59
3    1   14   0  7128   0   12    26   892   294   0     72
4    1    1   2    44   4    3    68    24    38   0    353
5    0    1   0   295   0  129    30     8    20  34      4
6    1    9   0    55   0    3  1263    75    36   0    466
7    0   42   0   601   0    4    18  6321    66   3    206
8    0    2   0   522   0    6    32   366  1580   5    783
9    2    6   5   188   1   72    91    38    14  59     17
10   0    7   0    81   1    2    96   187   112   2  12305
---- Validation: 
scalar performance:
{'acc': 0.80157816, 'precision': 0.7173574, 'recall': 0.46523, 'specificity': 0.97655624, 'f1': 0.49438486, 'auroc': 0.9586754}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   30     8   0    61   0    1   121   132     5   0    125
1    0  1006   0    17   0    0     2   278     4   0     25
2    0     5  13    62   2    9    65    54    25  17     60
3    0     6   0  7169   0   17    13   894   289   1     51
4    0     2   0    50   3    2    64    28    40   1    349
5    0     1   2   300   1  142    35     5    13  19      3
6    0    18   0    45   0    2  1263    76    27   3    474
7    0    45   1   642   1    2    24  6287    61   0    202
8    0     0   0   510   0    2    37   345  1646   1    755
9    0     3   4   189   1   71    86    38    13  69     19
10   1     4   0    84   1    2    96   171    97   1  12339
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2384384, 'precision': 0.40165052, 'recall': 0.20919704, 'specificity': 0.92263293, 'f1': 0.11755812, 'auroc': 0.7813774}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    5   16   0    6   0   0  261   741    2   0   139
1    0  163   0    8   0   0   11  1257    0   0    60
2    0    5   0   23   0   0   60   414    2   0   511
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    38    0   0  1593
5    0    3   0  169   0  12   74   294    1   0    39
6    0    2   0    9   0   0  331   239    2   0  2484
7    0   17   0    4   0   0    1  1129    0   0    13
8    0    1   0   89   0   0   78   316  130   0   756
9    0    8   0   89   0   1  109   801    1   0   128
10   0    0   0    1   0   0    2     5    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-21 03:10:50.793729,epoch time: 0:23:50.884551,used: 3:16:19.666697,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.80827266, 'precision': 0.7372849, 'recall': 0.4894739, 'specificity': 0.9771774, 'f1': 0.52529085, 'auroc': 0.9604006}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   50    14   0    59   1    2    92   102     1    2    160
1    0  1062   0    22   0    0     3   217     4    0     23
2    0     6  16    50   8   11    47    41    18   49     66
3    0     9   0  7249   2   18    14   787   288    3     68
4    0     1   0    44  12    1    52    22    41    5    361
5    1     0   0   278   0  140    19     4    15   58      6
6    1    18   0    50   0    3  1232    62    32    3    506
7    0    59   1   638   2    1    18  6213    76    3    252
8    1     5   0   486   0    2    16   298  1680    2    804
9    3     6   2   173   2   49    55    26    12  148     17
10   2     9   0    64   1    1    73   145    91    1  12408
---- Validation: 
scalar performance:
{'acc': 0.8082386, 'precision': 0.7283319, 'recall': 0.48865014, 'specificity': 0.9772264, 'f1': 0.5240028, 'auroc': 0.9617075}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   54    13   0    58   0    1   101    95     2    2    157
1    0  1052   0    16   0    0     4   227     6    0     27
2    0     5  17    53   8    5    52    47    13   43     69
3    0    10   0  7271   1   18    18   771   286    5     60
4    1     1   1    44  10    2    49    16    40    5    370
5    0     0   0   281   0  135    23     3    17   58      4
6    0    17   0    55   0    1  1247    65    37    2    484
7    1    69   0   634   3    0    16  6207    78    3    254
8    0     2   0   468   0    5    26   309  1694    4    788
9    2     4   4   162   4   58    60    21    17  143     18
10   1    11   0    73   0    0    78   138   108    1  12386
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24802351, 'precision': 0.39731234, 'recall': 0.21849625, 'specificity': 0.9234989, 'f1': 0.1337737, 'auroc': 0.7855907}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   10   46   0    8   0   0  268   655    2   0   181
1    0  326   0   11   0   0   12  1080    0   0    70
2    0   14   0   26   0   0   53   338    3   0   581
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    26    0   0  1604
5    0    7   0  189   0  13   83   241    2   0    57
6    0    5   0    8   0   0  296   162    3   0  2593
7    0   30   0    5   0   0    1  1110    0   0    18
8    0    2   0   96   0   0   76   255  146   0   795
9    0   17   0  103   0   1  106   734    1   0   175
10   0    0   0    1   0   0    1     0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-21 03:34:46.049976,epoch time: 0:23:55.256247,used: 3:40:14.922944,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8148009, 'precision': 0.70669127, 'recall': 0.49572667, 'specificity': 0.97806585, 'f1': 0.53359115, 'auroc': 0.9636026}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   76     9   0    58   0    2   104    88     4   1    141
1    0  1052   0    16   0    0     6   228     5   0     25
2    3     7  27    55  11   10    54    47    14  25     59
3    0     7   0  7355   2   18    13   707   280   4     53
4    0     2   5    45   7    2    57    25    51   2    343
5    1     0   0   275   0  171    19     2    13  34      6
6    2    10   0    55   0    4  1274    64    31   1    467
7    0    49   1   646   0    4    16  6239    76   1    231
8    1     1   0   501   0    4    34   286  1757   0    711
9    6     0  12   175   1   86    72    24    12  87     18
10   0     5   0    79   0    1    78   123    96   0  12409
---- Validation: 
scalar performance:
{'acc': 0.814257, 'precision': 0.7267402, 'recall': 0.49645567, 'specificity': 0.9780454, 'f1': 0.5336601, 'auroc': 0.96225125}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   63    10   1    61   0    3   104   100     4    0    137
1    0  1054   0    18   0    0     2   227     7    1     23
2    0     3  25    57   9   10    58    51    16   25     58
3    1     6   0  7338   0   12    22   722   281    1     57
4    0     0   3    46  15    3    54    17    43    3    355
5    2     0   3   264   0  166    22     3    15   42      4
6    0    16   0    47   1    2  1306    61    35    1    439
7    1    51   0   651   1    3    20  6234    84    0    220
8    0     2   0   508   0    2    30   295  1744    2    713
9    2     3   9   160   3   95    65    21    17  100     18
10   0     8   0    70   1    0    89   128   103    1  12396
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2572588, 'precision': 0.40608624, 'recall': 0.22289109, 'specificity': 0.9243836, 'f1': 0.14164685, 'auroc': 0.7909551}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   23   23   0    8   0   0  317   644    3   0   152
1    0  258   0   15   0   0   16  1146    0   0    64
2    0    6   0   29   0   0   76   342    4   0   558
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    30    1   0  1600
5    0    4   0  220   0  13   94   214    3   0    44
6    0    3   0    9   0   0  432   161    4   0  2458
7    0   22   0    8   0   0    4  1117    0   0    13
8    0    1   0  106   0   0   95   252  191   0   725
9    0   13   0  113   0   1  127   729    1   0   153
10   0    0   0    1   0   0    2     0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-21 03:59:25.329008,epoch time: 0:24:39.279032,used: 4:04:54.201976,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.819162, 'precision': 0.7567978, 'recall': 0.50309527, 'specificity': 0.97885925, 'f1': 0.5394018, 'auroc': 0.96532077}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   51     7   0    62   0    0   132    98     4    1    128
1    0  1046   0    12   0    0     4   245     5    0     20
2    1     1  31    57   3    5    68    51    13   33     49
3    1     6   0  7327   0   13    24   750   271    1     45
4    0     2   1    42  18    3    88    26    44    2    312
5    0     0   2   282   0  154    23     6    12   40      2
6    2    13   0    48   0    1  1386    64    32    2    360
7    0    44   0   600   0    2    27  6353    79    3    157
8    0     0   1   497   0    2    39   337  1823    0    597
9    5     2  19   169   0   64    70    21    15  113     14
10   0     6   1    71   0    1   106   162   129    0  12315
---- Validation: 
scalar performance:
{'acc': 0.8197138, 'precision': 0.7442793, 'recall': 0.50571394, 'specificity': 0.97891855, 'f1': 0.5432727, 'auroc': 0.964541}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   53     7   0    57   0    2   134   111     4    1    114
1    0  1046   0    13   0    0     8   238     5    0     22
2    1     3  34    46   8    9    74    52    17   29     39
3    0     5   0  7378   0   11    16   716   275    1     38
4    0     0   4    41  17    2    80    30    46    3    316
5    1     0   0   283   0  156    24     3    13   40      1
6    1    14   0    42   0    1  1370    72    29    1    378
7    1    40   0   595   0    1    17  6354    79    3    175
8    0     2   0   497   0    5    44   319  1814    3    612
9    4     3  10   157   1   63    73    32    16  123     11
10   3     3   0    71   3    1   122   168   123    2  12300
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.282376, 'precision': 0.41578114, 'recall': 0.23469807, 'specificity': 0.92671067, 'f1': 0.15708005, 'auroc': 0.79773456}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   18   22   0    8   0   0  396   633    3   0    90
1    0  264   0   14   0   0   22  1149    0   0    50
2    0    4   0   30   0   0  131   376    4   0   470
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    4    38    1   0  1589
5    0    4   0  217   0  12  126   205    3   0    25
6    0    3   0   10   0   0  755   199    3   0  2097
7    0   20   0    8   0   0    7  1117    0   0    12
8    0    1   0  115   0   0  158   278  229   0   589
9    0    9   0  103   0   1  187   728    1   0   108
10   0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-21 04:23:35.288804,epoch time: 0:24:09.959796,used: 4:29:04.161772,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.82151645, 'precision': 0.7276678, 'recall': 0.51909375, 'specificity': 0.97911936, 'f1': 0.55691105, 'auroc': 0.966086}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   78     9   0    47   1    0   117   103     2    4    122
1    0  1067   0    11   0    0     3   226     8    0     17
2    0     2  29    41  19    3    51    47    18   48     53
3    0     6   0  7223   0   20    23   812   304    6     45
4    0     0   7    35  24    2    76    25    46    7    317
5    1     0   1   254   0  147    17     1    13   85      2
6    3    16   0    36   1    2  1376    64    23    1    386
7    0    43   0   510   1    3    24  6389    93    5    195
8    0     2   1   414   0    5    41   328  1863    4    638
9    4     1  10   154   1   50    54    23    16  168     12
10   0     5   0    61   3    3    87   161   126    4  12341
---- Validation: 
scalar performance:
{'acc': 0.8229771, 'precision': 0.7254016, 'recall': 0.5173207, 'specificity': 0.97931474, 'f1': 0.5548078, 'auroc': 0.9655365}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   77     7   0    46   0    1   114   111     6    2    119
1    0  1067   0    11   0    0     4   224     3    0     23
2    0     2  30    39  12    6    56    55    16   49     47
3    0     5   1  7196   1   19    22   831   308    3     54
4    0     1   4    31  24    0    63    29    54    5    328
5    3     0   1   258   1  132    15     4    13   90      4
6    0    16   0    33   0    3  1364    59    39    3    391
7    1    53   3   502   1    2    22  6405    99    3    174
8    0     2   0   402   0    4    35   320  1936    4    593
9    7     1  12   153   5   47    57    22    11  164     14
10   1     1   0    53   2    2    91   154   118    2  12372
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28692368, 'precision': 0.41226548, 'recall': 0.24056318, 'specificity': 0.92714226, 'f1': 0.1661596, 'auroc': 0.8004873}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   35   27   0    8   0   0  378   614    3   0   105
1    0  309   0    8   0   0   20  1109    0   0    53
2    0    6   0   24   0   0  118   369    5   0   493
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    3    37    1   0  1591
5    1    4   0  198   0  13  125   214    7   0    30
6    0    3   0    7   0   0  714   180    6   0  2157
7    0   20   0    5   0   0    8  1119    0   0    12
8    0    1   0   88   0   0  145   274  270   0   592
9    0   12   0   86   0   1  180   733    1   0   124
10   0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-21 04:47:27.975636,epoch time: 0:23:52.686832,used: 4:52:56.848604,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8257973, 'precision': 0.73287314, 'recall': 0.5188638, 'specificity': 0.9794184, 'f1': 0.55997264, 'auroc': 0.96820784}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   77     9   2    55   0    0   103    89     1    2    145
1    0  1070   0    20   0    0     1   212     6    1     22
2    1     3  47    37   7    3    47    53    19   39     56
3    0     8   0  7417   0   12     9   650   286    4     52
4    0     1  12    42   8    2    60    22    41    9    341
5    0     0   2   263   0  138    14     3    13   83      5
6    0    12   0    51   0    2  1334    61    31    1    415
7    0    34   1   603   1    4    19  6303    90    1    208
8    0     2   1   422   0    3    30   285  1886    4    662
9    1     2  22   153   2   43    48    32    13  160     17
10   0     2   0    51   1    1    74   116   120    3  12425
---- Validation: 
scalar performance:
{'acc': 0.8244483, 'precision': 0.7527836, 'recall': 0.5191624, 'specificity': 0.97925794, 'f1': 0.5623231, 'auroc': 0.96657896}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   86    13   1    56   0    0    90    88     4    1    144
1    0  1063   0    13   0    0     3   228     3    0     22
2    0     2  52    45   6    4    46    41    16   40     60
3    0     6   0  7380   1    8    16   697   281    6     45
4    0     0  10    40  15    1    44    25    37    6    361
5    1     0   0   255   0  123    14     7    25   94      2
6    3    12   0    43   0    2  1344    53    40    3    408
7    2    48   2   593   0    0    14  6314    79    1    212
8    0     1   0   449   0    4    24   306  1861    6    645
9    2     1  19   163   1   41    49    24    17  158     18
10   1     4   0    57   0    1    85   123    99    0  12426
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28321555, 'precision': 0.41143602, 'recall': 0.24042997, 'specificity': 0.92686534, 'f1': 0.16810101, 'auroc': 0.8011039}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   47   33   0   10   0   0  359   582    3   0   136
1    0  343   0   16   0   0   19  1059    0   0    62
2    0    6   0   31   0   0   99   324    5   0   550
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    2    26    1   0  1603
5    1    4   0  246   0  12  111   172    7   0    39
6    0    4   0    8   0   0  616   144    6   0  2289
7    0   21   0    8   0   0    7  1115    0   0    13
8    0    1   0  106   0   0  119   233  272   0   639
9    0   15   0  115   0   1  165   688    1   0   152
10   0    0   0    1   0   0    2     0    0   0  1643
better model found
persisted
after epoch: 13,now: 2024-07-21 05:11:31.064205,epoch time: 0:24:03.088569,used: 5:16:59.937173,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.83106804, 'precision': 0.74238694, 'recall': 0.53906375, 'specificity': 0.98027503, 'f1': 0.5837741, 'auroc': 0.9681617}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   88     9   0    61   0    0    97    96     6    1    125
1    0  1098   0    17   0    0     2   193     8    0     14
2    1     2  71    39  15    6    38    51    15   31     43
3    0     7   0  7360   0   12    17   693   319    1     30
4    0     1  19    36  35    3    56    21    45    6    317
5    2     0   5   255   1  141    10     6    21   78      2
6    1    18   0    41   1    1  1356    65    56    3    366
7    1    38   3   549   0    1    11  6383    99    3    177
8    0     1   1   409   2    1    22   298  2034    3    524
9    5     1  33   149   2   41    44    24    16  156     22
10   2     8   2    57   5    1    73   147   152    2  12340
---- Validation: 
scalar performance:
{'acc': 0.8318042, 'precision': 0.7329738, 'recall': 0.5417408, 'specificity': 0.9803562, 'f1': 0.5862324, 'auroc': 0.96856433}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   93     8   2    57   0    1    85    96     7    1    133
1    0  1089   0    13   0    0     2   203     6    0     19
2    0     4  75    41  20    6    40    47    13   21     45
3    0     4   0  7389   0   16    16   683   290    6     36
4    0     2  20    42  30    1    51    20    62    2    309
5    3     0   5   256   0  143    13     4    20   75      2
6    3    15   0    44   2    1  1360    67    43    1    372
7    1    47   1   585   1    4    19  6344    96    0    167
8    0     2   2   403   0    1    16   278  2069    2    523
9    7     3  39   147   1   50    33    20    21  160     12
10   2     3   1    53   6    2    86   128   169    1  12345
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3005667, 'precision': 0.4109852, 'recall': 0.2524282, 'specificity': 0.92871606, 'f1': 0.18378407, 'auroc': 0.8061155}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   58   38   0   14   0   0  349   597    4   0   110
1    1  395   0   16   0   0   14  1025    0   0    48
2    0    7   0   34   0   0  111   360    9   0   494
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    3    37    1   0  1591
5    2    4   0  261   0  12  106   170   11   0    26
6    0    4   0   12   0   0  734   177   16   0  2124
7    0   22   0    8   0   0    5  1118    0   0    11
8    0    1   0  106   0   0  123   256  337   0   547
9    0   18   2  123   0   1  161   706    2   0   124
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-21 05:35:49.673331,epoch time: 0:24:18.609126,used: 5:41:18.546299,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8349743, 'precision': 0.74294484, 'recall': 0.55036664, 'specificity': 0.980692, 'f1': 0.59560543, 'auroc': 0.9695917}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   121     3   1    51   0    1    87    78    10    3    128
1     0  1086   0    11   0    0     3   207     6    0     19
2     2     2  63    38  12    6    41    43    13   46     46
3     0     6   0  7389   0   22    16   635   324    2     43
4     1     0  18    29  34    4    48    25    54    6    320
5     3     0   6   234   0  174     9     1    18   74      2
6     5    13   0    40   1    6  1366    54    39    3    381
7     1    53   0   541   2    1    17  6341   113    2    193
8     1     1   1   390   1    6    21   263  2053    4    553
9     7     1  20   128   3   69    46    21    18  163     17
10    2     3   2    36   0    2    64   126   137    3  12418
---- Validation: 
scalar performance:
{'acc': 0.83453256, 'precision': 0.7425997, 'recall': 0.5525058, 'specificity': 0.9806603, 'f1': 0.5972566, 'auroc': 0.96989816}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   117     6   1    36   0    3    92    87     5    2    134
1     0  1085   0    13   0    0     6   203     3    0     22
2     1     3  62    40  15    6    39    40    13   45     48
3     0     4   0  7367   0   20    19   667   317    4     42
4     0     2  11    33  30    1    60    26    51    7    318
5     4     0   4   233   0  174    10     5    12   77      2
6     5    15   0    36   2    2  1383    43    41    3    378
7     0    47   1   533   1    3    22  6354   108    2    194
8     0     3   2   393   1    7    36   257  2060    4    533
9     7     2  24   138   3   51    43    16    15  181     13
10    0     3   0    45   4    0    75   129   150    4  12386
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.31015182, 'precision': 0.40925056, 'recall': 0.25981945, 'specificity': 0.92949843, 'f1': 0.19728327, 'auroc': 0.8081022}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   133   31   0   13   0   1  365   508    5   0   114
1     1  380   0   18   0   0   23  1018    0   0    59
2     0    5   0   30   0   0  126   319    8   0   527
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    28    2   0  1600
5     5    4   0  253   0  16  126   151   11   0    26
6     0    3   0    8   0   0  814   133   14   0  2095
7     0   20   0    8   0   0   11  1113    0   0    12
8     0    1   0  101   0   0  139   225  336   0   568
9     4   13   2  121   0   1  198   662    1   0   135
10    0    0   0    1   0   0    3     1    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-21 05:59:59.191485,epoch time: 0:24:09.518154,used: 6:05:28.064453,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.83714145, 'precision': 0.7501587, 'recall': 0.5537876, 'specificity': 0.9810195, 'f1': 0.59948397, 'auroc': 0.9697609}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   108     5   0    57   0    3   101    66     8    2    132
1     0  1084   0    19   0    0     3   208     6    0     12
2     2     0  69    36  13    8    41    41    17   44     41
3     0     2   0  7485   0   16    14   585   296    4     34
4     1     1  14    37  40    1    59    11    59    7    309
5     4     0   1   232   0  177     7     2    17   79      2
6     3    15   0    44   0    1  1408    61    38    6    331
7     0    43   0   598   3    4    17  6305   106    1    187
8     0     1   2   417   0    5    25   259  2082    2    503
9     8     1  18   132   4   70    49    22    17  161     11
10    1     2   2    59   5    0    78   112   162    3  12370
---- Validation: 
scalar performance:
{'acc': 0.83739465, 'precision': 0.75109017, 'recall': 0.5607221, 'specificity': 0.98105997, 'f1': 0.60730505, 'auroc': 0.97009075}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   125     4   1    56   0    0    85    88     2    2    120
1     0  1085   0     8   0    0     3   215     6    2     13
2     4     2  57    39  14    5    39    42    18   49     43
3     1     5   2  7439   1   24    18   599   303    6     42
4     0     2  13    35  50    3    58    23    43    7    305
5     3     1   4   224   0  190     7     3    16   70      3
6     4    17   0    38   3    3  1417    43    56    4    323
7     1    38   1   607   2    5    13  6316   113    1    168
8     3     1   2   404   0    2    27   261  2090    3    503
9     5     0  24   144   2   52    37    14    20  178     17
10    1     4   2    58   4    1    82   130   154    1  12359
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32057652, 'precision': 0.4123847, 'recall': 0.26435822, 'specificity': 0.9305397, 'f1': 0.20256913, 'auroc': 0.8109407}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   127   30   0   19   0   1  391   495    5   0   102
1     1  378   0   19   0   0   23  1025    0   0    53
2     0    5   0   34   0   0  141   317    9   0   509
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    29    2   0  1599
5     5    4   0  274   0  14  123   136   12   0    24
6     0    3   0   13   0   0  954   134   16   0  1947
7     0   17   0    9   0   0   12  1114    0   0    12
8     0    1   0  116   0   0  161   211  355   0   526
9     2   12   1  140   0   1  216   637    1   0   127
10    0    0   0    1   0   0    4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-21 06:24:14.407460,epoch time: 0:24:15.215975,used: 6:29:43.280428,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8414491, 'precision': 0.7447798, 'recall': 0.57363003, 'specificity': 0.9815677, 'f1': 0.6205895, 'auroc': 0.97129935}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   146     6   1    56   0    0    73    67    10    2    121
1     1  1099   0    11   0    0     2   194     9    1     15
2     5     1  79    36  21    5    34    33    17   38     43
3     3     4   0  7442   2   31    18   564   325    4     45
4     1     2  15    27  47    0    57    22    53    5    310
5     3     0   3   231   2  190    12     1    13   62      4
6     7    15   0    35   2    1  1426    51    49    2    319
7     1    37   1   548   4    3    24  6337   127    1    180
8     0     2   0   396   1   11    29   231  2147    2    477
9    11     3  30   123   5   63    31    19    20  176     12
10    2     3   2    46   3    1    81   122   171    1  12361
---- Validation: 
scalar performance:
{'acc': 0.84138024, 'precision': 0.73995745, 'recall': 0.57184064, 'specificity': 0.98156625, 'f1': 0.61733454, 'auroc': 0.97074336}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   147     7   1    55   0    2    60    67     5    3    136
1     0  1103   0    16   0    0     2   190     7    0     14
2     2     2  84    36  17    8    36    32    14   39     42
3     2     3   0  7448   2   18    12   586   335    2     32
4     1     1  18    31  43    2    55    20    64    6    298
5     3     0   4   225   0  192     8     4    18   66      1
6     7    13   0    37   0    1  1426    47    45    5    327
7     2    41   3   536   3    4    22  6368   115    1    170
8     0     3   2   384   1    4    26   255  2137    7    477
9    11     2  37   127   2   70    31    20    19  158     16
10    7     6   1    56   7    3    80   121   161    5  12349
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3454838, 'precision': 0.41432035, 'recall': 0.28443724, 'specificity': 0.9329567, 'f1': 0.23066394, 'auroc': 0.81396174}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   239   40   0   16   0   1   375   407    5   0    87
1     1  464   0   19   0   0    27   936    1   0    51
2     0    6   0   31   0   0   159   307   10   0   502
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     5    28    4   0  1596
5    15    4   0  270   0  17   127   123   12   0    24
6     0    3   0   13   0   0  1076   121   17   0  1837
7     0   22   0   10   0   0    15  1105    0   0    12
8     0    1   0  107   0   0   185   195  397   0   485
9     6   17   2  138   0   1   246   603    4   0   120
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-21 06:48:29.082660,epoch time: 0:24:14.675200,used: 6:53:57.955628,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.84305435, 'precision': 0.75400937, 'recall': 0.5722374, 'specificity': 0.98172814, 'f1': 0.6183321, 'auroc': 0.9727668}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   133     7   1    47   0    3    85    76     4    5    122
1     0  1087   0    17   0    0     3   201     6    1     17
2     0     4  71    29  20   10    36    42     9   49     42
3     1     3   1  7429   1   32    15   635   279    5     37
4     0     0  11    34  48    2    58    20    52    9    305
5     2     0   2   216   0  195     7     1    12   81      4
6     4    16   0    30   1    2  1434    53    41    3    324
7     1    42   1   530   3    3    16  6412    94    8    151
8     2     0   4   395   0    2    33   263  2100    7    490
9     6     1  20   108   3   69    36    24    20  192     14
10    0     0   2    47   6    1    64   136   125    4  12409
---- Validation: 
scalar performance:
{'acc': 0.8412465, 'precision': 0.7446987, 'recall': 0.5679318, 'specificity': 0.98149097, 'f1': 0.6141797, 'auroc': 0.97235924}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   134     6   2    47   0    2    89    73     3    6    121
1     0  1080   1    16   0    0     1   211     7    0     16
2     3     0  58    31  26    9    41    34    17   50     43
3     0     5   0  7435   2   27    19   620   282    8     42
4     0     1  13    30  55    1    53    17    51   11    307
5     2     0   4   216   0  197     9     1    12   77      3
6     3     8   0    36   1    2  1412    55    38    6    347
7     2    26   1   520   3    2    25  6408    93    6    179
8     2     1   2   391   3    7    38   260  2082    6    504
9     4     0  21   129   2   64    39    20    10  192     12
10    1     5   0    39  10    1    79   131   127    6  12397
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3347093, 'precision': 0.5124326, 'recall': 0.2735258, 'specificity': 0.9318185, 'f1': 0.21504074, 'auroc': 0.8144119}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   143   27   0   21   0   1   416   465    5   0    92
1     1  398   0   18   0   0    26  1005    1   0    50
2     0    4   0   30   0   0   158   310    8   0   505
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    28    2   0  1597
5     6    4   0  262   0  24   137   125    8   1    25
6     0    3   0   13   0   0  1095   125   14   0  1817
7     0   15   0    8   0   0    14  1115    0   0    12
8     0    0   0  108   0   0   192   204  368   0   498
9     3   10   1  130   0   1   250   616    2   0   124
10    0    0   0    1   0   0     4     1    0   0  1640
early stop counter: 1
val acc:0.841246485710144, best validation acc: 0.84138023853302, corresponding to test acc:                         0.34548380970954895 / 0.34548380970954895
after epoch: 18,now: 2024-07-21 07:12:52.376358,epoch time: 0:24:23.293698,used: 7:18:21.249326,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8451145, 'precision': 0.7483627, 'recall': 0.5755991, 'specificity': 0.981959, 'f1': 0.6202555, 'auroc': 0.9727281}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   163     8   0    44   0    2    75    71     5    3    112
1     0  1097   0    12   0    0     5   195     5    0     16
2     3     2  44    33  23    9    39    46    12   58     43
3     2     5   0  7426   3   20    13   640   284    7     39
4     0     2  10    35  56    3    61    24    42    9    297
5     6     0   3   200   0  213     8     3    15   72      1
6     8    16   0    34   3    2  1433    38    31    6    337
7     0    37   1   482   2    3    18  6450    94    4    172
8     1     1   3   380   1    6    32   275  2106    4    486
9    12     1  12   125   2   75    27    18    17  191     13
10    4     4   0    47   7    1    76   125   118    3  12408
---- Validation: 
scalar performance:
{'acc': 0.8441086, 'precision': 0.73792624, 'recall': 0.5723215, 'specificity': 0.9818439, 'f1': 0.6156825, 'auroc': 0.972645}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   157     8   0    43   0    1    71    79     3    2    119
1     0  1088   0    11   0    0     3   211     6    0     13
2     4     3  49    24  26   11    41    36    12   60     46
3     5     5   0  7468   1   21    14   610   278    7     31
4     1     1  14    36  43    1    59    23    47    6    308
5     3     0   2   205   0  206    13     4    16   68      4
6     5    10   0    31   0    3  1458    51    35    4    311
7     2    31   2   486   4    3    28  6432    87    4    186
8     1     3   1   414   0    7    34   271  2066    5    494
9    17     1  15   113   1   78    28    18    13  193     16
10    4     3   1    55   8    1    89   114   122    2  12397
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.35171062, 'precision': 0.51308763, 'recall': 0.28783906, 'specificity': 0.9335919, 'f1': 0.23524654, 'auroc': 0.81655914}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   259   38   0   18   0   1   371   400    4   0    79
1     1  466   0   19   0   0    27   941    1   0    44
2     0    5   0   31   0   0   162   313    7   0   497
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   1   0     6    31    1   0  1593
5    16    4   0  267   0  24   129   119    8   1    24
6     0    3   0   15   0   0  1168   128   13   0  1740
7     0   19   0    8   0   0    16  1110    0   0    11
8     0    1   0  117   0   0   201   210  359   0   482
9     8   15   1  135   0   1   245   611    1   0   120
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-21 07:37:01.222279,epoch time: 0:24:08.845921,used: 7:42:30.095247,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8467733, 'precision': 0.74872005, 'recall': 0.58021677, 'specificity': 0.9821716, 'f1': 0.62796813, 'auroc': 0.9725545}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   165     7   2    53   1    0    63    56     8    3    125
1     0  1103   0    16   0    0     2   188     7    0     16
2     9     2  76    39  22    6    30    35    17   40     36
3     1     7   0  7497   0   23    16   572   288    3     31
4     0     3  21    35  55    0    45    20    56    7    297
5     5     0   7   210   1  203    10     4    15   62      4
6    11    13   0    34   1    2  1403    48    57    4    335
7     3    42   2   554   0    3    15  6384    95    0    166
8     1     1   2   391   3    2    23   239  2196    2    434
9    15     0  30   138   1   64    29    22    14  167     13
10    6     6   2    42   4    3    61   104   163    1  12400
---- Validation: 
scalar performance:
{'acc': 0.84689045, 'precision': 0.7558042, 'recall': 0.58507675, 'specificity': 0.9821404, 'f1': 0.6344331, 'auroc': 0.97318566}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   176     5   3    43   0    3    50    69     7    3    124
1     0  1103   0    17   0    0     3   184     9    0     16
2     3     2  89    36  20    5    30    32    14   34     47
3     3     4   0  7552   0   20    13   531   283    3     31
4     2     1  17    32  53    0    41    24    60    7    302
5     5     0   4   209   1  205     8     4    15   66      4
6    14    16   0    39   1    2  1385    53    59    1    338
7     1    35   0   576   2    1    15  6366    96    3    170
8     5     1   4   389   2    5    18   232  2186    0    454
9    12     2  34   125   2   69    32    18    18  167     14
10    3     4   0    53   5    2    67   116   164    3  12379
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34947178, 'precision': 0.4181588, 'recall': 0.29045558, 'specificity': 0.9336036, 'f1': 0.23915315, 'auroc': 0.8169494}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   296   35   0   26   0   1   315   397    6   0    94
1     1  461   0   23   0   0    21   944    1   0    48
2     1    4   0   41   0   0   140   301   13   0   515
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     4    28    4   0  1597
5    16    4   0  302   0  16   114   103   13   0    24
6     0    3   0   20   0   0  1034   129   18   0  1863
7     0   16   0   11   0   0    10  1115    0   0    12
8     1    1   0  127   0   0   157   188  433   0   463
9    11   15   1  168   0   1   213   598    2   0   128
10    0    0   0    1   0   0     4     1    0   0  1640
better model found
persisted
after epoch: 20,now: 2024-07-21 08:01:05.320693,epoch time: 0:24:04.098414,used: 8:06:34.193661,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8471211, 'precision': 0.750331, 'recall': 0.5848447, 'specificity': 0.9822263, 'f1': 0.6296884, 'auroc': 0.97341627}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   170     5   0    44   0    2    74    71     3    4    110
1     0  1095   0    12   0    0     1   202     7    0     15
2     5     1  74    36  18   14    40    36    13   35     40
3     0     2   1  7389   0   28    25   671   279    3     40
4     2     1  18    33  47    2    57    25    42    9    303
5     5     1   1   190   0  230    11     2    10   67      4
6     8    12   1    33   1    4  1450    45    33    4    317
7     2    36   1   449   3    5    20  6483    87    3    172
8     2     3   1   348   1   10    36   269  2142    5    479
9    12     1  26   109   2   85    38    17    17  170     16
10    4     2   0    34   5    2    85   118   127    4  12412
---- Validation: 
scalar performance:
{'acc': 0.84670323, 'precision': 0.74404263, 'recall': 0.58803093, 'specificity': 0.98224634, 'f1': 0.6304614, 'auroc': 0.9742315}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   157     5   2    37   0    3    90    70     7    2    110
1     1  1107   0    13   1    0     4   186     6    1     13
2     2     2  94    23  15   11    36    43    13   32     41
3     3     9   1  7365   3   29    14   668   306    3     39
4     1     0  26    27  43    5    61    23    51    7    295
5     5     0   2   184   0  229    10     4    17   67      3
6    10    12   0    28   0    2  1467    53    31    1    304
7     4    37   1   437   2    2    23  6502    95    4    158
8     4     4   3   374   2   10    33   262  2120    5    479
9     9     0  32    99   2   95    36    23    15  169     13
10    5     1   2    39   3    2    86   122   133    2  12401
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36521375, 'precision': 0.5608392, 'recall': 0.2956513, 'specificity': 0.9347862, 'f1': 0.24402386, 'auroc': 0.8190252}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   274   31   0   14   0   1   389   383    4   0    74
1     1  464   0   18   0   0    30   941    1   0    44
2     1    3   1   26   0   0   176   305    9   0   494
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    28    2   0  1593
5    21    4   0  249   0  27   147   111    9   0    24
6     0    3   0   10   0   0  1318   116   13   0  1607
7     0   15   0    6   0   0    19  1113    0   0    11
8     0    1   0   97   0   0   231   195  383   0   463
9     9   13   1  116   0   1   277   594    3   0   123
10    0    0   0    1   0   0     5     1    0   0  1639
new oracle model saved
early stop counter: 1
val acc:0.8467032313346863, best validation acc: 0.8468904495239258, corresponding to test acc:                         0.349471777677536 / 0.3652137517929077
after epoch: 21,now: 2024-07-21 08:25:12.404577,epoch time: 0:24:07.083884,used: 8:30:41.277545,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.847683, 'precision': 0.75064933, 'recall': 0.5884941, 'specificity': 0.98226464, 'f1': 0.63432205, 'auroc': 0.9739401}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   175     4   0    50   0    1    71    66     1    3    111
1     1  1103   0    20   0    0     3   187     7    0     11
2     3     2  93    30  17   12    36    36    16   25     42
3     0     5   0  7566   1   32    20   539   244    0     30
4     1     2  33    22  54    2    49    22    50    4    300
5     4     1   6   194   0  236     7     1    18   50      4
6     7    11   0    42   1    4  1437    44    44    2    315
7     2    34   3   548   2    1    22  6382    95    3    172
8     1     1   2   449   3   14    31   245  2073    1    476
9    10     2  40   112   3  105    34    12    15  149     10
10    4     4   3    52   7    3    71   111   123    1  12415
---- Validation: 
scalar performance:
{'acc': 0.84945834, 'precision': 0.74908036, 'recall': 0.5877539, 'specificity': 0.98249304, 'f1': 0.6322608, 'auroc': 0.9739869}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   171     3   1    52   1    2    72    67     7    1    106
1     0  1118   0    19   0    1     2   178     3    0     11
2     6     4  89    31  12   10    29    45    15   30     41
3     1     5   1  7599   2   29    12   518   237    2     34
4     0     2  24    34  52    1    62    18    48    6    292
5     1     0   5   198   0  239     5     3    19   47      4
6     6    18   0    38   1    7  1467    37    41    1    292
7     3    32   3   564   4    4    17  6388    93    1    156
8     1     1   1   417   4   14    26   256  2096    5    475
9     8     3  40   118   4  115    27    14    14  137     13
10    4     3   2    50   7    2    75   117   134    1  12401
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3694116, 'precision': 0.5151231, 'recall': 0.298529, 'specificity': 0.9353746, 'f1': 0.24890156, 'auroc': 0.82052016}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   269   40   0   26   0   1   381   372    5   0    76
1     1  502   0   23   0   0    29   900    1   0    43
2     0    6   0   41   0   0   174   293    8   0   493
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    2   1   0     9    27    1   0  1593
5    16    3   0  297   0  26   131    87    9   0    23
6     0    3   0   19   0   0  1336   112   15   0  1582
7     0   16   0   11   0   0    18  1108    0   0    11
8     0    2   0  134   0   0   219   180  399   0   436
9     9   16   1  165   0   2   267   553    2   0   122
10    0    0   0    1   0   0     5     1    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-21 08:49:30.175086,epoch time: 0:24:17.770509,used: 8:54:59.048054,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.85153574, 'precision': 0.75927424, 'recall': 0.59494954, 'specificity': 0.9826687, 'f1': 0.6410794, 'auroc': 0.9751298}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   178     6   1    43   0    3    63    60     4    6    119
1     0  1106   0    19   0    0     0   182     8    0     16
2     4     1  70    29  23   10    23    36     8   66     42
3     1     4   0  7585   1   28    10   517   248    6     37
4     0     3  26    27  59    2    45    16    44   12    305
5     2     0   3   192   0  200     5     1    13  101      4
6     4    11   0    38   3    3  1420    55    36    5    332
7     1    28   3   565   3    2    20  6398    93    2    150
8     2     1   0   421   3    4    25   222  2135   12    470
9     6     2  18   106   1   57    20    16    17  238     12
10    4     3   1    39   7    2    66   100   128    5  12438
---- Validation: 
scalar performance:
{'acc': 0.851304, 'precision': 0.7607343, 'recall': 0.59620535, 'specificity': 0.9826702, 'f1': 0.64131105, 'auroc': 0.9737882}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   168     3   0    56   1    2    54    64     4    7    124
1     0  1104   0    14   0    0     4   187     6    1     16
2     5     2  71    29  17    7    19    33    11   72     46
3     2     4   0  7559   1   28    13   522   268    8     35
4     1     1  15    24  63    4    42    20    44   20    305
5     2     0   2   170   0  216     9     2    16  102      2
6    11    18   0    41   0    2  1425    44    43    7    317
7     2    39   1   575   3    1    16  6378    82    3    165
8     1     3   1   387   4    9    27   234  2166    9    455
9     6     1  27   103   2   57    24    15    10  233     15
10    3     3   0    43   8    1    63   101   125    6  12443
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36234522, 'precision': 0.4997939, 'recall': 0.29611832, 'specificity': 0.9347826, 'f1': 0.24712473, 'auroc': 0.8201698}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   283   35   0   28   0   1   350   382    6   0    85
1     1  485   0   23   0   0    25   913    1   0    51
2     1    4   0   43   1   0   153   281    8   0   524
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    2   1   0     5    24    1   0  1600
5    18    3   0  310   0  23   122    76   10   4    26
6     0    3   0   20   0   0  1221   105   16   0  1702
7     0   13   0   12   0   0    14  1113    0   0    12
8     0    0   0  137   0   0   189   176  411   0   457
9     9   11   1  182   0   2   253   542    2   2   133
10    0    0   0    1   0   0     4     1    0   0  1640
better model found
persisted
after epoch: 23,now: 2024-07-21 09:13:36.710501,epoch time: 0:24:06.535415,used: 9:19:05.583469,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8551744, 'precision': 0.7551148, 'recall': 0.6091794, 'specificity': 0.98336124, 'f1': 0.6541792, 'auroc': 0.97595996}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   172     8   0    55    0    3    75    58     5    5    102
1     0  1127   0    19    0    0     3   168     7    0      8
2     2     3  77    33   34   10    26    27    14   54     32
3     1     8   1  7624    2   27     9   473   257    5     31
4     0     1  16    31  102    3    50    26    49    9    252
5     1     0   5   188    2  227     6     3    11   77      1
6     5    18   0    30    3    1  1524    32    39    3    252
7     1    46   0   608    2    2    29  6338   110    1    125
8     1     3   4   425   10    6    33   214  2233    7    360
9     6     1  36    99    3   80    25    16    11  202     14
10    4     4   0    50   18    3    90   121   163    3  12337
---- Validation: 
scalar performance:
{'acc': 0.8542731, 'precision': 0.7644365, 'recall': 0.6092664, 'specificity': 0.9832199, 'f1': 0.65667695, 'auroc': 0.97502553}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   163     8   0    48    1    2    85    65     7    8     96
1     0  1141   0    16    1    0     1   153     9    0     11
2     1     4  81    31   31   11    29    29    15   48     32
3     0     5   0  7651    1   21    11   440   277   10     24
4     1     3  16    38  111    1    49    15    47    7    251
5     2     0   3   190    1  231     8     4    13   65      4
6     4    16   0    43    2    3  1497    40    36    5    262
7     3    42   0   594    6    5    17  6364    94    3    137
8     0     1   2   448    8    4    39   224  2172    6    392
9     5     0  30   114    6   75    23    12    16  202     10
10    3     5   1    44   18    2    95   124   178    2  12324
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4025747, 'precision': 0.558861, 'recall': 0.3170037, 'specificity': 0.938653, 'f1': 0.2687453, 'auroc': 0.8249962}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   234   55   0   32   0   1   435   360    6   0    47
1     1  624   0   28   0   0    28   777    1   0    40
2     0   11   1   50   1   0   215   293   13   0   431
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    2   1   0    13    34    3   0  1580
5    11    5   0  327   0  22   136    62   10   1    18
6     0    5   0   23   0   0  1648   100   22   0  1269
7     0   22   0   15   0   0    22  1094    0   0    11
8     0    2   0  148   2   0   260   151  492   0   315
9     7   27   1  207   0   1   294   500    3   2    95
10    0    0   0    1   0   0     8     1    0   0  1636
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-21 09:37:58.594308,epoch time: 0:24:21.883807,used: 9:43:27.467276,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.85290027, 'precision': 0.7518053, 'recall': 0.6101399, 'specificity': 0.98295444, 'f1': 0.6544409, 'auroc': 0.9758146}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   202     4   0    35   0    0    70    67     6    2     97
1     0  1110   0    11   0    0     1   188     6    0     16
2     3     0  96    27  24   11    21    37    11   46     36
3     2     3   2  7437   1   30    14   660   250    4     36
4     0     4  25    26  67    5    40    27    44   10    291
5     3     0   5   183   0  251     7     1    10   56      5
6    17    15   0    25   3    3  1472    52    41    4    275
7     4    47   2   427   2    2    18  6524    86    4    147
8     1     2   5   358   5   12    36   258  2154    2    462
9    10     2  31    90   1  101    26    18    11  184     19
10    5     1   4    38  13    3    70   152   122    3  12381
---- Validation: 
scalar performance:
{'acc': 0.85266817, 'precision': 0.7508664, 'recall': 0.6072212, 'specificity': 0.9829601, 'f1': 0.6511762, 'auroc': 0.97556084}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   195     2   2    38   0    3    66    70     8    2     97
1     0  1114   0    13   0    0     3   184     6    0     12
2     5     3  86    28  22   13    27    36     9   45     38
3     6     3   0  7390   2   38    11   679   274    6     31
4     0     1  21    30  69    2    44    34    43   12    283
5     4     0   6   176   2  243     4     1    12   71      2
6    13    16   0    29   2    2  1459    48    45    3    291
7     3    36   2   413   2    5    17  6528   103    2    154
8     4     4   0   330   2   12    32   282  2185    4    441
9    15     1  33    95   4   86    20    14    12  196     17
10    3     3   0    34   8    3    74   129   126    4  12412
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.39026096, 'precision': 0.5168168, 'recall': 0.3153311, 'specificity': 0.9375105, 'f1': 0.26755363, 'auroc': 0.82382953}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   360   39   0   17   0   1   328   358    5   0    62
1     1  543   0   18   0   0    25   871    1   0    40
2     1    6   1   31   1   0   178   319    9   0   469
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    36    2   0  1585
5    30    4   0  265   0  29   127   103    9   3    22
6     0    3   0   16   0   0  1450   125   15   0  1458
7     0   16   0    8   0   0    13  1117    0   0    10
8     0    2   0  103   0   0   220   210  438   0   397
9    19   20   3  130   0   2   251   590    4   1   117
10    0    0   0    1   0   0     6     1    0   0  1638
early stop counter: 1
val acc:0.8526681661605835, best validation acc: 0.8542730808258057, corresponding to test acc:                         0.40257468819618225 / 0.40257468819618225
after epoch: 25,now: 2024-07-21 10:02:04.391443,epoch time: 0:24:05.797135,used: 10:07:33.264411,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.85372967, 'precision': 0.7634667, 'recall': 0.6072364, 'specificity': 0.9831122, 'f1': 0.65395224, 'auroc': 0.9757309}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   186     3   0    36   1    3    66    54    11    4    119
1     0  1101   0    17   0    0     3   193     6    0     12
2     1     1  79    21  25    9    23    41    15   53     44
3     1     4   1  7527   0   33    18   524   292    7     31
4     0     1  13    27  87    2    51    14    55   10    278
5     3     0   3   174   0  223     5     1    16   90      6
6    13    14   0    29   1    2  1449    48    48    6    296
7     2    32   1   541   4    3    23  6385   124    3    145
8     1     1   0   349   3    5    27   220  2290   10    390
9     9     0  15    98   6   86    20    16    16  213     14
10    6     3   2    35  16    1    83   124   153    2  12369
---- Validation: 
scalar performance:
{'acc': 0.8542731, 'precision': 0.7608911, 'recall': 0.60643923, 'specificity': 0.9831294, 'f1': 0.6525392, 'auroc': 0.9758973}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   190     8   1    38   0    1    65    60     5    3    112
1     0  1103   0    15   0    0     5   188     7    1     13
2     6     2  62    22  33   11    18    32    20   63     43
3     1     1   0  7532   1   29    14   524   303    4     31
4     0     1  17    24  88    2    44    17    50   15    281
5     2     0   2   183   1  230     5     4    13   78      3
6     7    11   0    33   4    2  1466    41    42    3    299
7     5    29   4   494   4    1    18  6438   118    2    152
8     3     4   0   381   3    7    40   197  2226    8    427
9     9     1  13    97   7   76    21    11    17  225     16
10    2     1   1    42   9    3    66   129   165    1  12377
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.39942628, 'precision': 0.509035, 'recall': 0.3194477, 'specificity': 0.9383608, 'f1': 0.27275506, 'auroc': 0.82527006}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   339   33   0   25   0   1   371   333    7   0    61
1     1  531   0   23   0   0    30   869    1   0    44
2     1    5   0   35   1   0   192   286   17   0   478
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    10    29    4   0  1589
5    20    3   0  305   0  24   132    68   14   3    23
6     0    3   0   16   0   0  1555    95   25   0  1373
7     0   13   0   12   0   0    20  1108    0   0    11
8     0    2   0  114   0   0   232   160  511   0   351
9    14   15   1  168   0   2   290   521    6   2   118
10    0    0   0    1   0   0     6     1    0   0  1638
early stop counter: 2
val acc:0.8542730808258057, best validation acc: 0.8542730808258057, corresponding to test acc:                         0.40257468819618225 / 0.40257468819618225
after epoch: 26,now: 2024-07-21 10:26:03.341765,epoch time: 0:23:58.950322,used: 10:31:32.214733,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.85629815, 'precision': 0.762683, 'recall': 0.6176308, 'specificity': 0.9833772, 'f1': 0.6656248, 'auroc': 0.976957}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   186     4    0    40    0    0    70    56     8    5    114
1     1  1102    0    16    0    0     5   190     5    0     12
2     5     3  109    31   21    6    25    29     9   41     33
3     2     6    1  7616    2   27    12   511   221    6     35
4     2     1   21    33  109    0    51    22    41   12    247
5     3     0    5   186    2  205     9     3    13   93      1
6    10     9    1    39    5    2  1507    42    36    7    250
7     5    31    1   496    5    2    22  6480    80    4    138
8     1     2    4   440   10    2    37   245  2118    6    431
9     8     1   42   100    6   59    22    15    12  218     10
10    5     1    4    56   16    1    82   147   121    3  12355
---- Validation: 
scalar performance:
{'acc': 0.8591681, 'precision': 0.7680558, 'recall': 0.6228283, 'specificity': 0.98374075, 'f1': 0.6697962, 'auroc': 0.9768642}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   184     5    2    43    0    1    82    63     5    1     97
1     1  1106    0    18    1    0     2   187     7    0     10
2     4     2  107    21   24    3    29    34    10   47     31
3     3     2    0  7612    2   26    15   524   223    8     25
4     0     2   28    26  103    3    50    24    42   13    248
5     4     0    5   186    1  213     8     3     9   91      1
6     7     6    0    28    5    2  1539    39    28    6    248
7     4    24    5   498    5    2    17  6499    72    7    132
8     1     1    4   436    6    3    35   246  2150    6    408
9     7     1   34   100    4   48    23    13    17  234     12
10    8     2    2    41   14    3    85   129   133    6  12373
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4046736, 'precision': 0.51439756, 'recall': 0.31528127, 'specificity': 0.93879336, 'f1': 0.26550472, 'auroc': 0.8272846}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   305   28   0   27   0   1   412   354    3   0    40
1     1  505   0   23   0   0    31   898    1   0    40
2     1    4   2   37   1   0   240   312    7   0   411
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   1   0    16    39    2   0  1574
5    18    3   0  313   0  16   140    72    7   5    18
6     0    3   0   17   0   0  1782   109   15   0  1141
7     0   11   0   12   0   0    20  1111    0   0    10
8     0    2   0  140   3   0   294   181  426   0   324
9    12   10   3  170   0   1   309   535    1   2    94
10    0    0   0    1   0   0     9     2    0   0  1634
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-21 10:50:08.549979,epoch time: 0:24:05.208214,used: 10:55:37.422947,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8590272, 'precision': 0.7616066, 'recall': 0.6214203, 'specificity': 0.98387605, 'f1': 0.6653888, 'auroc': 0.9769857}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   184     3   1    44    0    4    85    64     4    3     91
1     1  1114   0    14    0    0     3   182     7    0     11
2     7     1  86    26   26   11    30    37    12   44     32
3     0     0   0  7480    4   35    18   591   280    3     24
4     1     2  22    26  102    4    50    24    48    6    254
5     4     0   2   152    0  273     7     2    12   65      4
6     6    14   0    37    5    2  1508    43    54    5    234
7     1    33   1   449    6    3    18  6520   110    1    123
8     1     1   2   346    4    9    38   240  2301    3    350
9    10     0  27    75    6  102    25    23    15  193     17
10    5     3   1    33   15    4    92   119   171    4  12346
---- Validation: 
scalar performance:
{'acc': 0.8597298, 'precision': 0.76912665, 'recall': 0.62372243, 'specificity': 0.98389065, 'f1': 0.6688896, 'auroc': 0.9773084}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   172     7   3    40   0    2    71    74     6    3    105
1     0  1121   0    13   0    0     0   181     7    0     10
2     5     0  94    25  25   13    25    34    17   44     30
3     3     3   1  7519   4   29    13   563   275    3     27
4     1     1  20    20  99    4    47    24    55   10    258
5     3     0   3   155   0  267     4     3    14   70      2
6     6    11   0    32   2    3  1506    41    53    4    250
7     2    25   1   443   4    1    27  6521   102    3    136
8     0     4   3   331   5    8    38   244  2285    6    372
9     5     0  31    94   4   91    20    12    15  212      9
10    2     3   1    38  15    3    80   127   179    3  12345
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.41481844, 'precision': 0.5437486, 'recall': 0.32517004, 'specificity': 0.9398018, 'f1': 0.2770621, 'auroc': 0.828349}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   295   32   0   26   0   1   410   360    7   0    39
1     1  528   0   23   0   0    31   877    1   0    38
2     0    6   1   34   1   0   235   319   15   0   404
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    16    39    4   0  1573
5    16    3   0  294   0  30   141    75   14   2    17
6     0    3   0   16   0   0  1801   113   25   0  1109
7     0   11   0   11   0   0    20  1112    0   0    10
8     0    2   0  113   2   0   277   175  525   0   276
9    11   16   1  149   0   3   309   548    5   2    93
10    0    0   0    1   0   0     9     2    0   0  1634
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-21 11:14:19.754743,epoch time: 0:24:11.204764,used: 11:19:48.627711,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.85587007, 'precision': 0.7551346, 'recall': 0.6196848, 'specificity': 0.9833718, 'f1': 0.6652355, 'auroc': 0.97674024}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   207     8   0    42    0    3    60    50     4    1    108
1     0  1113   0    16    0    0     4   180     7    0     12
2     3     2  93    29   33   10    28    32     5   45     32
3     3     5   1  7605    0   31    14   519   228    4     26
4     0     2  20    31  101    4    51    19    42    6    263
5     4     0   5   167    0  251     6     2    15   69      2
6    13    18   1    30    1    4  1504    37    36    5    258
7     3    31   5   548    2    4    22  6437    79    1    131
8     4     3   4   434    9   15    38   221  2153    2    412
9     3     1  30   100   13   91    23    17    13  193      9
10    6     4   0    52   22    2    90   132   151    4  12332
---- Validation: 
scalar performance:
{'acc': 0.85847265, 'precision': 0.75448525, 'recall': 0.62051266, 'specificity': 0.9836868, 'f1': 0.666028, 'auroc': 0.9771434}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   192     8   3    44    1    1    69    55     9    3     98
1     0  1134   0    16    0    0     7   165     1    0      9
2     6     1  91    20   34   11    24    35    11   48     31
3     2     3   0  7676    1   26    20   465   223    2     22
4     1     1  26    28  120    2    44    22    39    9    247
5     6     1   7   170    0  246     5     2    13   69      2
6     9    15   0    27    4    3  1518    47    34    5    246
7     2    46   7   539    5    3    18  6414    90    4    137
8     0     0   1   441   10    9    33   234  2152    3    413
9     9     1  35   103    5   89    19    16    14  189     13
10    2     4   2    47   23    4    82   136   133    1  12362
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42454347, 'precision': 0.5413523, 'recall': 0.3318052, 'specificity': 0.9408529, 'f1': 0.28611588, 'auroc': 0.82933605}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   347   48   0   35   0   1   389   307    6   0    37
1     1  649   0   24   0   0    27   758    1   0    39
2     0   11   1   46   1   0   241   299   11   0   405
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    2   1   0    17    36    3   0  1574
5    21    4   0  323   0  24   135    58    7   2    18
6     0    5   0   20   0   0  1850   102   17   0  1073
7     0   21   0   15   0   0    21  1097    0   0    10
8     0    2   0  151   3   0   290   161  464   0   299
9    16   25   1  191   0   2   309   501    2   2    88
10    0    0   0    1   0   0    10     2    0   0  1633
new oracle model saved
early stop counter: 1
val acc:0.8584726452827454, best validation acc: 0.8597298264503479, corresponding to test acc:                         0.4148184359073639 / 0.42454347014427185
after epoch: 29,now: 2024-07-21 11:38:09.738550,epoch time: 0:23:49.983807,used: 11:43:38.611518,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8587061, 'precision': 0.7696186, 'recall': 0.6241829, 'specificity': 0.9836838, 'f1': 0.67204124, 'auroc': 0.9760871}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   202     3   0    37    0    3    47    65     5    3    118
1     0  1095   0    18    0    0     3   199     4    1     12
2     7     0  89    26   22   10    17    40    16   49     35
3     4     4   0  7472    1   25     7   618   274    3     29
4     0     0  17    21  101    3    41    28    52   12    264
5     4     0   4   168    0  250     2     2    11   78      2
6    14    13   1    20    6    5  1469    52    45    8    274
7     4    24   2   434    4    2    13  6523   105    7    146
8     0     2   3   352    6    8    22   243  2293    7    360
9     7     0  25    96    5   74    17    15    16  224     13
10    6     1   0    37   20    3    61   132   155    2  12377
---- Validation: 
scalar performance:
{'acc': 0.8585529, 'precision': 0.76613617, 'recall': 0.6171441, 'specificity': 0.98367584, 'f1': 0.6648018, 'auroc': 0.9777373}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   203     4   0    42    0    2    50    60     3    2    117
1     0  1099   0    19    0    0     3   196     3    1     11
2     3     0  80    23   26   11    17    41    16   56     39
3     3     2   0  7487    2   35    12   583   277    7     32
4     0     0  17    23  104    4    42    18    53   11    267
5     3     0   3   178    1  232     3     3    17   76      5
6    12     9   0    34    2    5  1470    48    49    7    272
7     2    28   1   443    4    4     9  6528   109    0    137
8     0     1   0   349    6    7    21   239  2304    4    365
9     8     1  31    95    7   91    10    12    18  210     10
10    6     1   1    43    8    2    67   122   162    4  12380
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40474358, 'precision': 0.4999005, 'recall': 0.32268932, 'specificity': 0.9390522, 'f1': 0.2749317, 'auroc': 0.8279523}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   345   23   0   29   0   1   340   375    7   0    50
1     1  472   0   23   0   0    26   937    1   0    39
2     1    2   0   34   1   0   183   325   19   0   450
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    10    37    4   0  1581
5    23    3   0  301   0  28   122    78   15   2    20
6     0    3   0   16   0   0  1630   123   30   0  1265
7     0    8   0   10   0   0    13  1123    0   0    10
8     0    0   0  111   2   0   225   184  548   0   300
9    18    8   1  157   0   2   261   571    6   2   111
10    0    0   0    1   0   0     7     2    0   0  1636
early stop counter: 2
val acc:0.858552873134613, best validation acc: 0.8597298264503479, corresponding to test acc:                         0.4148184359073639 / 0.42454347014427185
after epoch: 30,now: 2024-07-21 12:02:06.648046,epoch time: 0:23:56.909496,used: 12:07:35.521014,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:07:35.521014 at 2024-07-21 12:02:06.648046
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.41481844, 'precision': 0.5437486, 'recall': 0.32517004, 'specificity': 0.9398018, 'f1': 0.2770621, 'auroc': 0.828349}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   295   32   0   26   0   1   410   360    7   0    39
1     1  528   0   23   0   0    31   877    1   0    38
2     0    6   1   34   1   0   235   319   15   0   404
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    16    39    4   0  1573
5    16    3   0  294   0  30   141    75   14   2    17
6     0    3   0   16   0   0  1801   113   25   0  1109
7     0   11   0   11   0   0    20  1112    0   0    10
8     0    2   0  113   2   0   277   175  525   0   276
9    11   16   1  149   0   3   309   548    5   2    93
10    0    0   0    1   0   0     9     2    0   0  1634
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42454347, 'precision': 0.5413523, 'recall': 0.3318052, 'specificity': 0.9408529, 'f1': 0.28611588, 'auroc': 0.82933605}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   347   48   0   35   0   1   389   307    6   0    37
1     1  649   0   24   0   0    27   758    1   0    39
2     0   11   1   46   1   0   241   299   11   0   405
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    2   1   0    17    36    3   0  1574
5    21    4   0  323   0  24   135    58    7   2    18
6     0    5   0   20   0   0  1850   102   17   0  1073
7     0   21   0   15   0   0    21  1097    0   0    10
8     0    2   0  151   3   0   290   161  464   0   299
9    16   25   1  191   0   2   309   501    2   2    88
10    0    0   0    1   0   0    10     2    0   0  1633
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562328_instance_wise_predictions.txt
accuracy from prediction file 0.4148184425942769
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/0.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193441 KiB | 464389 KiB | 598552 GiB | 598552 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 586257 GiB | 586257 GiB |
|       from small pool |  19041 KiB |  39751 KiB |  12294 GiB |  12294 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193441 KiB | 464389 KiB | 598552 GiB | 598552 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 586257 GiB | 586257 GiB |
|       from small pool |  19041 KiB |  39751 KiB |  12294 GiB |  12294 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 190583 KiB | 459649 KiB | 598529 GiB | 598528 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 586251 GiB | 586250 GiB |
|       from small pool |  17769 KiB |  37832 KiB |  12278 GiB |  12278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 514048 KiB | 514048 KiB | 514048 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  40960 KiB |  40960 KiB |  40960 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37982 KiB |  73500 KiB | 335559 GiB | 335559 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 323246 GiB | 323246 GiB |
|       from small pool |   7582 KiB |   9471 KiB |  12313 GiB |  12313 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4034    |    6277    |  116324 K  |  116320 K  |
|       from large pool |      76    |     158    |   57792 K  |   57791 K  |
|       from small pool |    3958    |    6126    |   58532 K  |   58528 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4034    |    6277    |  116324 K  |  116320 K  |
|       from large pool |      76    |     158    |   57792 K  |   57791 K  |
|       from small pool |    3958    |    6126    |   58532 K  |   58528 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      41    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      20    |      20    |      20    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      24    |    1268    |   64410 K  |   64410 K  |
|       from large pool |       9    |      19    |   38372 K  |   38372 K  |
|       from small pool |      15    |    1259    |   26037 K  |   26037 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB | 598552 GiB | 598552 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 586257 GiB | 586257 GiB |
|       from small pool |      0 KiB |  39751 KiB |  12294 GiB |  12294 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB | 598552 GiB | 598552 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 586257 GiB | 586257 GiB |
|       from small pool |      0 KiB |  39751 KiB |  12294 GiB |  12294 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB | 598529 GiB | 598529 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 586251 GiB | 586251 GiB |
|       from small pool |      0 KiB |  37832 KiB |  12278 GiB |  12278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 514048 KiB | 514048 KiB | 282624 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  40960 KiB |  40960 KiB |  14336 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82004 KiB | 335559 GiB | 335559 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 323246 GiB | 323246 GiB |
|       from small pool |      0 KiB |  21843 KiB |  12313 GiB |  12313 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  116324 K  |  116324 K  |
|       from large pool |       2    |     158    |   57792 K  |   57792 K  |
|       from small pool |       0    |    6126    |   58532 K  |   58532 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  116324 K  |  116324 K  |
|       from large pool |       2    |     158    |   57792 K  |   57792 K  |
|       from small pool |       0    |    6126    |   58532 K  |   58532 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      41    |      41    |      18    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      20    |      20    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1268    |   64411 K  |   64411 K  |
|       from large pool |       3    |      19    |   38372 K  |   38372 K  |
|       from small pool |       0    |    1259    |   26038 K  |   26038 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB | 598552 GiB | 598552 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 586257 GiB | 586257 GiB |
|       from small pool |      0 KiB |  39751 KiB |  12294 GiB |  12294 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB | 598552 GiB | 598552 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 586257 GiB | 586257 GiB |
|       from small pool |      0 KiB |  39751 KiB |  12294 GiB |  12294 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB | 598529 GiB | 598529 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 586251 GiB | 586251 GiB |
|       from small pool |      0 KiB |  37832 KiB |  12278 GiB |  12278 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 514048 KiB | 514048 KiB | 282624 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  40960 KiB |  40960 KiB |  14336 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82004 KiB | 335559 GiB | 335559 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 323246 GiB | 323246 GiB |
|       from small pool |      0 KiB |  21843 KiB |  12313 GiB |  12313 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  116324 K  |  116324 K  |
|       from large pool |       2    |     158    |   57792 K  |   57792 K  |
|       from small pool |       0    |    6126    |   58532 K  |   58532 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  116324 K  |  116324 K  |
|       from large pool |       2    |     158    |   57792 K  |   57792 K  |
|       from small pool |       0    |    6126    |   58532 K  |   58532 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      41    |      41    |      18    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      20    |      20    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1268    |   64411 K  |   64411 K  |
|       from large pool |       3    |      19    |   38372 K  |   38372 K  |
|       from small pool |       0    |    1259    |   26038 K  |   26038 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328

 Experiment start at: 2024-07-21 12:31:35.568901
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6131475, 'precision': 0.51903456, 'recall': 0.21406016, 'specificity': 0.9507043, 'f1': 0.1967369, 'auroc': 0.83365077}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    66   0   0   2    64   1   0    350
1    0  62   0   102   0   0   1   671   0   0    495
2    0   0   0   101   0   0   0    40   5   0    165
3    0   0   0  6001   0   0   1  1587  42   0    806
4    0   0   0    69   0   0   1    15   2   0    452
5    0   0   0   426   0   2   1    20   8   0     64
6    0   1   0   265   0   0  17    37  22   0   1565
7    0   3   0  1543   0   0   1  4226  24   0   1468
8    0   1   0   867   0   0   3   198  66   0   2160
9    0   0   0   273   0   0   0    44  14   1    161
10   0   0   0   170   0   0   1    73   8   0  12542
---- Validation: 
scalar performance:
{'acc': 0.61086, 'precision': 0.3718414, 'recall': 0.21208937, 'specificity': 0.9504149, 'f1': 0.19381607, 'auroc': 0.83389753}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    72   0   0   0    60   1   0    350
1    0  50   0    79   0   0   0   679   0   0    524
2    0   0   0    94   0   0   0    41   3   0    174
3    0   2   0  5983   1   0   2  1589  56   0    807
4    0   0   0    73   0   0   0    11   4   0    451
5    0   0   0   423   0   0   0    28  10   0     60
6    0   1   0   248   0   0  19    29  36   1   1574
7    0   3   0  1573   0   0   3  4188  18   0   1480
8    0   0   0   891   0   0   5   175  61   0   2164
9    0   0   0   279   0   0   1    44   2   1    166
10   0   1   0   163   0   0   2    76  19   0  12535
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.17945847, 'precision': 0.04799822, 'recall': 0.16417554, 'specificity': 0.9166092, 'f1': 0.059260055, 'auroc': 0.62986135}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   1   0   8   0   0   0  349   1   0   811
1    0   1   0   8   0   0   0  976   0   0   514
2    0   0   0   2   0   0   0  190   1   0   822
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   0   0   0   0   44   0   0  1589
5    0   0   0  60   0   0   0  212   0   0   320
6    0   0   0   5   0   0   0  350   0   0  2712
7    0   5   0   8   0   0   0  984   0   0   167
8    0   1   0  37   0   0   1  264   0   0  1067
9    0   0   0  20   0   0   0  542   0   0   575
10   0   0   0   0   0   0   0   66   0   0  1580
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 12:56:25.187952,epoch time: 0:24:49.619051,used: 0:24:49.619051,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6895602, 'precision': 0.5030646, 'recall': 0.29108766, 'specificity': 0.9614117, 'f1': 0.30107448, 'auroc': 0.90049684}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    2   0    81   0   0   18    96    4   0    282
1    0  492   0    58   0   0    2   662    3   0    115
2    0    2   0   102   0   0   13    35   13   0    147
3    0    6   0  6836   0   0    3  1220  112   0    260
4    0    0   0    77   0   0   12    14   13   0    423
5    0    0   0   451   0   4   11    15   14   1     24
6    0   11   0   203   0   0  356    55   50   0   1232
7    0   21   0  1477   0   0    6  5158   37   0    565
8    0    0   0   957   0   0   18   187  451   0   1683
9    0    0   0   301   0   4   26    36   27   3     96
10   0    3   0   156   0   0   23   108   30   0  12473
---- Validation: 
scalar performance:
{'acc': 0.68982214, 'precision': 0.508616, 'recall': 0.2925404, 'specificity': 0.96149015, 'f1': 0.30251056, 'auroc': 0.90105265}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    2   0    74   0   0   22   105    5   0    275
1    0  516   0    69   0   0    1   647    4   0     95
2    0    1   0   113   0   1    9    37   14   0    137
3    0    3   0  6845   0   0    4  1230  113   0    245
4    0    0   0    76   0   0    9    16   13   0    425
5    0    0   0   451   0   6   11     8   17   1     27
6    0   12   0   192   0   0  358    50   57   0   1239
7    0   27   0  1467   0   0    3  5167   46   0    555
8    0    1   0   970   0   0   18   210  415   0   1682
9    0    1   0   306   0   4   26    42   22   4     88
10   0    0   0   160   0   0   26    92   40   0  12478
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1966697, 'precision': 0.17710799, 'recall': 0.18029559, 'specificity': 0.9187164, 'f1': 0.070366934, 'auroc': 0.69308126}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0  14   0   7   0   0  26   699   1   0   423
1    0  61   0  12   0   0   0  1308   0   0   118
2    0   2   0  11   0   0   0   292   2   0   708
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   1   0   0   0    38   0   0  1594
5    0   3   0  85   0   0   2   356   3   0   143
6    0   0   0   7   0   0  18   317   2   0  2723
7    0  26   0   5   0   0   0  1090   0   0    43
8    0   3   0  49   0   0   5   314  22   0   977
9    0   4   0  41   0   0   1   802   3   0   286
10   0   0   0   0   0   0   0    26   0   0  1620
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 13:20:08.547378,epoch time: 0:23:43.359426,used: 0:48:32.978477,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7272314, 'precision': 0.5621523, 'recall': 0.33937865, 'specificity': 0.9664625, 'f1': 0.35759127, 'auroc': 0.9244606}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    1   11   0    83   0   0   36   112    2   0    238
1    0  695   0    34   0   0    0   543    3   0     57
2    0    2   0    95   0   0   23    56   15   1    120
3    0   11   0  6804   0   1    7  1264  181   0    172
4    0    0   0    69   0   0   12    17   27   0    414
5    0    1   0   424   0  17   19    14   20   5     21
6    0   15   0   124   0   0  619    67   57   1   1025
7    0   37   0   995   0   0   10  5759   42   0    417
8    0    1   0   736   0   0   19   260  830   0   1448
9    1    4   0   261   0  11   51    51   23  14     77
10   0    9   0   114   0   0   42   120   67   0  12442
---- Validation: 
scalar performance:
{'acc': 0.7261201, 'precision': 0.6170954, 'recall': 0.33851147, 'specificity': 0.9662988, 'f1': 0.35745367, 'auroc': 0.9265964}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    3    9   0    70   0   0   32   114    2   0    253
1    0  687   0    24   0   0    0   565    0   0     56
2    0    1   0    98   0   1   23    51   20   1    117
3    0    5   0  6767   0   0    7  1292  199   0    170
4    0    1   0    63   0   0   15    12   21   0    427
5    0    0   0   418   0  19   23     8   33   4     16
6    0   20   0   120   0   0  628    69   49   1   1021
7    0   25   0   987   0   0    6  5751   55   0    441
8    0    5   0   739   0   0   21   247  793   0   1491
9    0    4   1   268   0   8   69    49   21  13     60
10   0    3   0   105   0   0   31   119   53   0  12485
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20429581, 'precision': 0.28013062, 'recall': 0.18655983, 'specificity': 0.9194945, 'f1': 0.0803796, 'auroc': 0.72009844}
confusion matrix:
    0    1   2   3   4   5   6     7   8   9     10
0    1   25   0   4   0   0  52   773   1   0   314
1    0  115   0   8   0   0   0  1292   0   0    84
2    0    5   0   6   0   0   1   336   4   0   663
3    0    0   0   0   0   0   0     0   0   0     0
4    0    0   0   1   0   0   0    39   0   0  1593
5    0    5   0  78   0   0   3   386   5   0   115
6    0    0   0   6   0   0  37   312   3   0  2709
7    0   36   0   3   0   0   0  1096   0   0    29
8    0    3   0  44   0   0  11   343  47   0   922
9    0    6   0  28   0   0   1   864   3   0   235
10   0    0   0   0   0   0   1    21   0   0  1624
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 13:43:59.259173,epoch time: 0:23:50.711795,used: 1:12:23.690272,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.75187284, 'precision': 0.57037747, 'recall': 0.37616095, 'specificity': 0.96971405, 'f1': 0.39773917, 'auroc': 0.9389438}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    2    9   0    68   0   1   46   149     2   0    206
1    0  882   0    27   0   0    1   386     5   0     30
2    0    5   0    91   0   6   17    62    15   7    109
3    0   13   0  7005   0   1    5  1082   217   0    114
4    0    0   0    64   0   0   19    14    22   0    420
5    0    0   0   394   0  45   20    10    22  14     15
6    0   25   0   122   0   0  768    64    51   1    877
7    0   54   0   915   0   0    5  5864    70   0    356
8    0    2   0   683   0   0   22   296  1046   0   1247
9    1    4   0   249   0  37   49    47    26  26     54
10   0    9   0    97   0   0   34   122    67   0  12464
---- Validation: 
scalar performance:
{'acc': 0.7511836, 'precision': 0.603624, 'recall': 0.3753803, 'specificity': 0.96960044, 'f1': 0.39825612, 'auroc': 0.9399013}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    4   16   0    64   0   0   45   120     6   0    228
1    0  871   0    28   0   0    1   391     2   0     39
2    0    5   0    80   0   3   27    60    21   6    110
3    0    7   0  6995   0   4    5  1096   204   1    128
4    0    1   0    72   0   0   15    17    26   0    408
5    0    0   0   392   0  54   21     9    18  13     14
6    0   19   0   117   0   0  736    74    62   2    898
7    0   50   0   909   0   1    6  5913    47   0    339
8    0    3   0   702   0   1   18   271  1040   2   1259
9    0    5   0   272   0  29   50    45    26  23     43
10   0    4   0    95   0   0   31   133    86   0  12447
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21597984, 'precision': 0.29114288, 'recall': 0.19635057, 'specificity': 0.9206908, 'f1': 0.097057015, 'auroc': 0.7385292}
confusion matrix:
    0    1   2   3   4   5   6     7   8   9     10
0    2   62   0   3   0   0  65   758   1   0   279
1    0  238   0   9   0   0   0  1182   0   0    70
2    0    9   0  11   0   0   1   348   4   0   642
3    0    0   0   0   0   0   0     0   0   0     0
4    0    0   0   1   0   0   0    34   0   0  1598
5    0    9   0  99   0   0   4   377   6   1    96
6    0    5   0   9   0   0  48   302   3   0  2700
7    0   52   0   3   0   0   0  1085   0   0    24
8    0    8   0  59   0   0  13   328  84   0   878
9    0   16   0  35   0   0   1   875   2   0   208
10   0    0   0   0   0   0   1    15   0   0  1630
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 14:07:55.621655,epoch time: 0:23:56.362482,used: 1:36:20.052754,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.77250105, 'precision': 0.6782278, 'recall': 0.41201764, 'specificity': 0.9724633, 'f1': 0.43922675, 'auroc': 0.94826806}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   12    8   0    71   0   0    75   115     2   0    200
1    0  949   0    20   0   0     2   325     4   0     32
2    0    1   5    81   0   8    51    51    21   7     86
3    0    7   0  7251   1   4    11   834   226   1    105
4    0    0   0    70   0   0    32    18    30   0    389
5    1    0   0   360   0  78    24     2    22  23     10
6    0   18   0   101   0   0  1005    64    42   3    673
7    0   54   0   947   0   0    13  5911    61   0    279
8    0    1   0   703   0   0    27   258  1203   1   1102
9    0    4   2   247   0  38    70    36    18  46     32
10   0    9   0   117   1   0    61   121    70   0  12413
---- Validation: 
scalar performance:
{'acc': 0.77218133, 'precision': 0.64890593, 'recall': 0.40967852, 'specificity': 0.97240376, 'f1': 0.4369895, 'auroc': 0.94761634}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0   11   12   0    69   1   0   70   126     5   0    189
1    0  928   0    29   0   1    0   338     3   0     33
2    0    5   1    82   2   6   39    54    17   9     97
3    0   11   0  7294   0   6    6   826   205   1     91
4    0    0   1    68   0   1   31    11    28   2    397
5    0    1   0   361   0  84   19     7    21  17     11
6    0   25   0    95   0   1  959    66    44   3    715
7    0   54   0   974   0   0   12  5857    65   2    301
8    0    3   0   703   0   2   23   267  1246   1   1051
9    0    4   1   256   0  48   58    24    12  49     41
10   0    5   0    94   0   0   52   116    90   0  12439
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22584482, 'precision': 0.35316163, 'recall': 0.20387794, 'specificity': 0.9216438, 'f1': 0.11047438, 'auroc': 0.75330514}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   62   0    4   0   1  143   718    2   0   237
1    0  292   0   11   0   0    1  1126    0   0    69
2    0   10   0   21   0   0    7   344    7   0   626
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    0    32    0   0  1600
5    0    9   0  151   0   2   15   334    6   1    74
6    0    4   0   17   0   0   92   257    4   0  2693
7    0   56   0    4   0   0    0  1082    0   0    22
8    0    8   0   94   0   0   29   288  122   0   829
9    0   18   0   72   0   0   10   833    2   0   202
10   0    0   0    0   0   0    1    10    0   0  1635
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 14:31:40.420172,epoch time: 0:23:44.798517,used: 2:00:04.851271,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7867348, 'precision': 0.70481277, 'recall': 0.43806732, 'specificity': 0.9744201, 'f1': 0.46367222, 'auroc': 0.95328456}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   17    12   0    68   0    1   102   112     3   0    168
1    0  1047   0    28   0    1     1   229     3   0     23
2    0     5  12    71   1    8    54    52    19  11     79
3    0     9   0  7398   0    4    16   680   254   2     75
4    0     1   3    58   1    1    41    13    37   2    382
5    0     1   2   335   0  104    24     2    22  24      7
6    1    29   0    79   0    2  1110    66    40   0    581
7    0    67   0   955   0    1     8  5871    74   2    287
8    0     3   0   665   0    0    31   242  1414   0    939
9    1     5   2   225   0   77    67    28    16  46     25
10   0     9   0    98   0    0    70   120   109   1  12385
---- Validation: 
scalar performance:
{'acc': 0.78536844, 'precision': 0.6820185, 'recall': 0.43864745, 'specificity': 0.97424215, 'f1': 0.4657154, 'auroc': 0.9536735}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   18    14   0    79   0    0    97   101     2   1    171
1    0  1029   0    28   0    0     0   245     7   0     23
2    0     3  10    79   0    8    50    49    16  16     81
3    0    11   0  7344   0    8    15   741   253   0     68
4    0     0   1    54   0    1    41    17    40   1    384
5    0     1   1   320   0  121    21     4    21  25      7
6    0    27   0    72   0    2  1099    58    50   2    598
7    0    70   0   988   0    2     9  5853    74   0    269
8    0     4   0   645   0    1    28   234  1431   0    953
9    1     5   1   226   0   58    74    27    24  47     30
10   0     7   0   100   0    0    68   111   101   0  12409
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24963269, 'precision': 0.34231147, 'recall': 0.22212066, 'specificity': 0.92386997, 'f1': 0.13784079, 'auroc': 0.76496315}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3  120   0    3   0   1  215   634    2   0   192
1    0  509   0   11   0   0    1   913    0   0    65
2    0   17   0   26   0   0   13   321    9   0   629
3    0    0   0    0   0   0    0     0    0   0     0
4    0    2   0    1   0   0    0    27    0   0  1603
5    0   14   0  162   0   6   35   296   10   1    68
6    0   10   0   16   0   0  173   221    5   0  2642
7    1   84   0    8   0   0    0  1049    0   0    22
8    0   14   0   99   0   0   51   250  187   0   769
9    0   37   0   90   0   1   35   775    4   0   195
10   0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 14:55:37.158739,epoch time: 0:23:56.738567,used: 2:24:01.589838,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8012361, 'precision': 0.72709674, 'recall': 0.46857148, 'specificity': 0.9764077, 'f1': 0.5008626, 'auroc': 0.9578712}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   43     9   0    64   0    2   113    95     7   1    149
1    0  1021   0    22   0    0     0   260     4   0     25
2    0     4   9    72   2   16    54    53    23  24     55
3    0     6   0  7206   0   10    20   813   313   2     68
4    0     2   1    50   4    0    49    16    46   3    368
5    2     0   0   294   0  142    22     3    27  29      2
6    0    14   0    55   0    2  1235    67    50   2    483
7    0    42   0   730   0    1     8  6146    98   1    235
8    0     1   0   516   0    3    29   277  1672   1    796
9    1     3   3   199   3   63    68    31    19  82     20
10   0     3   0    76   0    1    73   134   121   0  12387
---- Validation: 
scalar performance:
{'acc': 0.7992778, 'precision': 0.7163543, 'recall': 0.4634639, 'specificity': 0.97619873, 'f1': 0.4937687, 'auroc': 0.95786446}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   47     9   0    57   0    0   107   119     2   1    141
1    0  1008   0    20   0    0     5   272     4   0     23
2    1     6   8    67   4   16    59    50    23  18     60
3    0     8   0  7203   1   11    16   820   319   0     62
4    0     1   0    53   2    1    59    11    48   1    363
5    1     0   0   293   1  139    21     3    19  38      6
6    1    16   0    66   0    1  1214    58    38   3    511
7    0    51   0   730   2    0     8  6133    89   0    252
8    0     4   0   505   0    2    38   285  1684   2    776
9    1     3   0   196   4   79    69    31    19  67     24
10   0     8   0    76   0    0    78   138   120   0  12376
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25753865, 'precision': 0.3715402, 'recall': 0.22675297, 'specificity': 0.92454517, 'f1': 0.14616999, 'auroc': 0.7752533}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   11   78   0    2   0   1  284   642    3   0   149
1    0  412   0    8   0   0    6  1015    0   0    58
2    0   13   0   20   0   0   22   361   12   0   587
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    36    1   0  1595
5    0    8   0  148   0  10   54   307   12   1    52
6    0    6   0   11   0   0  288   255    7   0  2500
7    1   59   0    5   0   0    3  1078    0   0    18
8    0    9   0   83   0   0   81   270  243   0   684
9    0   26   0   65   0   1   55   824    6   0   160
10   0    0   0    1   0   0    2     4    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-21 15:19:48.034419,epoch time: 0:24:10.875680,used: 2:48:12.465518,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8050086, 'precision': 0.7310866, 'recall': 0.46937615, 'specificity': 0.97694, 'f1': 0.50124717, 'auroc': 0.9601936}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   47     9   0    57   0    0   108   115     5   1    141
1    0  1025   0    21   0    0     3   255     5   0     23
2    0     4  12    65   1    7    60    51    26  21     65
3    0     9   0  7317   0   10    10   745   281   0     64
4    0     0   2    53   2    0    67    22    42   0    351
5    1     0   2   308   0  112    19     2    24  47      6
6    0    16   0    66   0    0  1237    64    48   4    473
7    1    50   1   743   0    3     9  6136   108   2    211
8    0     2   0   523   0    1    31   293  1745   1    698
9    3     5   4   192   0   59    66    40    20  90     14
10   0     3   0    81   0    0    88   144   112   1  12365
---- Validation: 
scalar performance:
{'acc': 0.80294234, 'precision': 0.68213445, 'recall': 0.47152948, 'specificity': 0.97668463, 'f1': 0.5041947, 'auroc': 0.96002215}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   52    10   0    57   0    1   112    99     5   0    147
1    0  1031   0    14   0    0     0   260     5   0     22
2    0     3  12    73   0    7    57    49    18  25     68
3    0     5   0  7264   0    8    10   797   301   1     54
4    0     0   4    52   0    1    47    22    44   6    363
5    1     0   0   314   0  123    22     5    16  33      7
6    1    18   0    63   0    0  1252    60    43   2    469
7    0    54   0   743   0    1     8  6140    99   4    216
8    0     2   0   554   0    0    30   279  1730   0    701
9    1     1   3   200   0   63    66    31    24  89     15
10   0     5   0    82   1    1    82   155   144   1  12325
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2684531, 'precision': 0.36683887, 'recall': 0.2337079, 'specificity': 0.9256513, 'f1': 0.15506393, 'auroc': 0.7815729}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   11   79   0    4   0   1  313   641    3   0   118
1    0  447   0    8   0   0    6   984    0   0    54
2    0   12   0   23   0   0   27   375   14   0   564
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    41    1   0  1590
5    0    6   0  175   0   5   66   288   10   1    41
6    0    5   0   16   0   0  367   277   11   0  2391
7    1   53   0    5   0   0    2  1088    0   0    15
8    0    9   0   94   0   0   93   271  282   0   621
9    0   27   0   79   0   1   68   820    7   0   135
10   0    0   0    1   0   0    2     6    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-21 15:44:12.083506,epoch time: 0:24:24.049087,used: 3:12:36.514605,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8152023, 'precision': 0.69594926, 'recall': 0.49171168, 'specificity': 0.9781871, 'f1': 0.5260713, 'auroc': 0.9639343}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   68     6   0    60   0    1   125    84     8    2    129
1    0  1065   0    17   0    0     2   219     8    0     21
2    0     4  16    54   9    5    49    40    20   42     73
3    0     5   0  7502   1   11    20   585   260    1     50
4    0     1   0    57   9    2    78    14    35    3    340
5    2     0   2   298   1  127    13     4    18   54      2
6    4    14   0    52   0    1  1314    45    37    6    435
7    4    60   0   807   1    1    15  6066    95    2    211
8    0     1   0   530   0    1    34   225  1825    3    677
9    5     0   8   187   5   58    63    20    22  110     15
10   1     7   1    73   4    0    92   125   125    0  12367
---- Validation: 
scalar performance:
{'acc': 0.81192994, 'precision': 0.71758544, 'recall': 0.49333242, 'specificity': 0.9778466, 'f1': 0.52959675, 'auroc': 0.96296495}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   79    15   0    58   0    1   113    74     2    0    141
1    0  1063   1    29   0    0     1   218     4    0     16
2    0     0  23    51   5    8    59    44    22   33     67
3    0     9   1  7425   0   18    17   608   309    4     49
4    0     2   3    56  12    0    64    23    42    6    331
5    2     0   1   296   0  121    25     3    19   52      2
6    1    23   0    49   0    0  1316    57    50    3    409
7    0    51   2   815   1    3    20  6028   108    2    235
8    0     4   0   527   2    1    35   222  1805    0    700
9    5     3   5   180   2   67    67    19    21  110     14
10   0     5   0    76   3    1    90   104   141    4  12372
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2923809, 'precision': 0.37478286, 'recall': 0.24919933, 'specificity': 0.9278027, 'f1': 0.17845386, 'auroc': 0.7890468}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   31   98   0    5   0   1  391   531    3   0   110
1    1  580   0   14   0   0   13   835    0   0    56
2    0   14   0   30   1   0   61   319   14   0   576
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    27    2   0  1602
5    2    6   0  199   0   8   93   228   13   2    41
6    0    6   0   14   0   0  545   183   13   0  2306
7    1   67   0    8   0   0   10  1059    0   0    19
8    0   11   0  111   0   0  121   218  314   0   595
9    1   36   0  100   0   1  116   727    5   0   151
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-21 16:08:01.903542,epoch time: 0:23:49.820036,used: 3:36:26.334641,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8181721, 'precision': 0.7316597, 'recall': 0.5039255, 'specificity': 0.9786283, 'f1': 0.5435052, 'auroc': 0.9634683}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   80     8   0    55   0    0    93   105     5    2    135
1    0  1072   1    15   0    0     1   220     5    0     17
2    2     3  27    55   5    7    40    53    29   36     55
3    1     8   0  7302   1   14     6   747   314    1     45
4    0     1  10    47  14    2    48    18    59    3    337
5    2     0   0   278   0  130    13     5    27   62      4
6    0    18   1    57   0    2  1263    73    60    1    432
7    0    53   1   609   0    2    10  6287   103    3    197
8    0     2   0   461   0    1    23   273  1942    1    593
9    2     4  13   169   1   62    35    40    23  130     14
10   0     4   0    67   2    1    65   168   150    0  12333
---- Validation: 
scalar performance:
{'acc': 0.8189381, 'precision': 0.75259763, 'recall': 0.5072651, 'specificity': 0.97876006, 'f1': 0.54775804, 'auroc': 0.9641506}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   77     9   0    60   0    1    90    93    13    1    139
1    0  1071   0    18   0    0     0   221     7    0     15
2    0     3  33    54   3    5    43    61    25   28     57
3    0     8   0  7288   0    9    13   763   315    1     43
4    0     2   6    46  14    2    59    25    47    2    336
5    1     1   2   269   1  148    15     3    26   52      3
6    1    21   0    42   0    3  1286    57    57    1    440
7    0    42   1   603   1    1    17  6322   101    1    176
8    0     1   0   456   0    1    23   310  1950    2    553
9    4     0  13   163   0   72    48    34    25  118     16
10   0     4   0    79   1    0    76   155   172    0  12309
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29657874, 'precision': 0.37168252, 'recall': 0.2556491, 'specificity': 0.9284988, 'f1': 0.18402839, 'auroc': 0.79295}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   37  107   0    4   0   1  312   605    3   0   101
1    1  580   0    8   0   0    6   856    1   0    47
2    0   18   0   23   1   0   45   393   19   0   516
3    0    0   0    0   0   0    0     0    0   0     0
4    0    2   0    0   0   0    1    43    2   0  1585
5    6   10   0  187   0  11   58   265   20   2    33
6    0    8   0   13   0   0  495   296   27   0  2228
7    1   61   0    5   0   0    2  1081    0   0    14
8    0   12   0   94   0   0   94   254  397   0   519
9    2   37   0   80   0   1   78   814    8   0   117
10   0    0   0    1   0   0    2     5    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-21 16:31:38.779053,epoch time: 0:23:36.875511,used: 4:00:03.210152,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.82116866, 'precision': 0.7544638, 'recall': 0.5169407, 'specificity': 0.97896093, 'f1': 0.55516386, 'auroc': 0.9663223}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   80    10   0    57   0    0   125    87     8    1    115
1    0  1086   0    17   0    0     2   209     2    0     16
2    1     2  36    50   3    9    53    53    14   34     57
3    1     5   0  7376   0   15    21   715   264    1     40
4    0     2   2    46  10    3    76    18    42    5    335
5    0     0   2   250   0  189    20     5    15   38      2
6    2    16   0    40   0    1  1385    51    32    4    377
7    1    43   0   655   0    1    21  6253    80    1    205
8    0     1   0   503   2    5    34   283  1780    5    683
9    3     1   9   140   0  100    54    30    17  118     20
10   0     5   0    57   1    1    95   138   117    2  12379
---- Validation: 
scalar performance:
{'acc': 0.8207035, 'precision': 0.72718775, 'recall': 0.510989, 'specificity': 0.97895646, 'f1': 0.54674965, 'auroc': 0.9658353}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   73    10   0    51   0    1   132    81     6    2    127
1    0  1068   0    18   0    0     4   222     5    1     14
2    1     4  28    49   8   12    57    45    20   42     46
3    0     5   0  7403   0   18    21   701   251    2     39
4    0     1   6    43  12    3    79    24    43    4    324
5    2     0   1   252   0  186    15     4    19   40      2
6    2    18   0    43   0    5  1373    45    37    3    382
7    2    42   0   668   0    3    16  6269    76    1    188
8    0     0   0   476   1    2    55   306  1775    1    680
9    3     1   8   146   1   95    58    32    16  115     18
10   0     5   1    69   2    2   100   124   113    0  12380
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3086126, 'precision': 0.3911994, 'recall': 0.2576307, 'specificity': 0.9293151, 'f1': 0.19010532, 'auroc': 0.7971828}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   35   80   0    5   0   1  428   532    3   0    86
1    1  548   0    9   0   0   15   873    0   0    53
2    0   10   0   28   0   0   94   335   11   0   537
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    4    32    2   0  1595
5    2    6   0  188   0  19  109   229    8   0    31
6    0    6   0   12   0   0  774   200   12   0  2063
7    1   50   0    5   0   0   14  1079    0   0    15
8    0    5   0  111   0   0  161   231  316   0   546
9    2   24   0   90   0   2  145   743    2   0   129
10   0    0   0    1   0   0    3     2    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-21 16:55:23.371480,epoch time: 0:23:44.592427,used: 4:23:47.802579,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.82742935, 'precision': 0.7306104, 'recall': 0.5301163, 'specificity': 0.97986877, 'f1': 0.5699676, 'auroc': 0.9671712}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   109     4   0    55   0    0   108    88     6    3    110
1     0  1080   0    17   0    0     1   214     5    1     13
2     0     1  28    51  15    4    55    53    13   44     48
3     0     3   0  7437   0   22    16   668   260    2     30
4     0     1   8    47  27    1    80    23    41    8    303
5     1     0   3   252   0  166    16     3    14   64      2
6     3    15   0    41   1    6  1414    56    35    3    333
7     0    48   0   641   2    1    21  6287    85    4    173
8     1     0   0   497   1    7    37   274  1904    3    572
9     4     0  11   139   2   78    42    32    18  151     16
10    0     5   2    63   2    1   111   146   139    2  12323
---- Validation: 
scalar performance:
{'acc': 0.82616025, 'precision': 0.74075055, 'recall': 0.52992386, 'specificity': 0.9796932, 'f1': 0.5695305, 'auroc': 0.9671811}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   95     8   0    61   0    1   126    73     5    2    112
1    0  1081   0    20   0    0     2   210     5    0     14
2    2     1  27    49  16    6    42    55    13   57     44
3    0     1   0  7430   1   19    19   675   258    2     35
4    0     2   5    46  25    2    77    21    46    3    312
5    3     0   1   247   0  175    16     5    20   50      4
6    1    13   0    46   0    1  1431    48    35    3    330
7    1    42   0   678   2    1    23  6243    89    2    184
8    0     4   1   487   1    2    44   296  1877    7    577
9    4     1   8   152   2   65    46    23    16  162     14
10   0     4   1    63   1    4   100   139   141    3  12340
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32736304, 'precision': 0.39022094, 'recall': 0.26895598, 'specificity': 0.931217, 'f1': 0.20509838, 'auroc': 0.8024842}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   64   81   0    5   0   1  433   517    3   0    66
1    1  576   0   13   0   0   17   846    1   0    45
2    0   10   0   32   2   0  115   348   12   0   496
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    5    39    2   0  1587
5   10    5   0  199   0  18  111   213    8   4    24
6    0    6   0   14   0   0  954   207   15   0  1871
7    1   48   0    8   0   0   13  1082    0   0    12
8    0    6   0  116   0   0  171   233  348   0   496
9    5   26   0  100   0   2  162   732    2   0   108
10   0    0   0    1   0   0    3     5    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-21 17:19:32.004884,epoch time: 0:24:08.633404,used: 4:47:56.435983,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8314961, 'precision': 0.7347306, 'recall': 0.54948914, 'specificity': 0.98045254, 'f1': 0.5920603, 'auroc': 0.9693818}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   137     1   0    55   0    0    88    82     5    2    113
1     1  1087   1    14   0    0     5   202     7    0     15
2     4     2  51    48   7    8    52    37    18   44     41
3     0     4   0  7358   2   18    22   667   316    5     46
4     0     0   6    34  30    1    86    28    52   12    290
5     4     1   2   234   0  180    11     5    17   63      3
6     4    22   0    45   0    4  1411    43    47    5    324
7     2    41   5   607   2    3    17  6313   106    2    166
8     0     1   1   414   2    5    37   266  2056    3    511
9    11     3  17   140   3   69    41    23    18  154     14
10    3     8   0    63   7    1   110   133   165    3  12301
---- Validation: 
scalar performance:
{'acc': 0.8310552, 'precision': 0.720002, 'recall': 0.5448994, 'specificity': 0.980403, 'f1': 0.5862221, 'auroc': 0.96786493}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   129     3   0    53   0    3    99    83     6    4    103
1     0  1094   0    17   0    0     3   198     7    1     12
2     4     1  45    39  14    5    52    46    22   41     43
3     1     3   1  7405   1   13    16   651   312    2     35
4     1     1  15    36  26    0    77    20    58   13    292
5     2     1   2   231   1  170    11     3    21   76      3
6     5    12   0    44   2    1  1404    49    51    7    333
7     0    37   0   630   2    2    19  6291   112    3    169
8     0     2   1   429   2    3    36   270  2025    6    522
9     6     2  23   143   0   64    48    21    13  163     10
10    3     4   2    56   8    1   108   134   161    2  12317
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34870216, 'precision': 0.40408474, 'recall': 0.28513375, 'specificity': 0.93338084, 'f1': 0.22679588, 'auroc': 0.8067745}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   141   79   0    6   0   1   410   477    4   0    52
1     1  601   0   14   0   0    17   822    1   0    43
2     2   10   0   31   2   0   124   354   16   0   476
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     6    40    3   0  1584
5    27    5   0  199   0  15   106   199   13   8    20
6     0    6   0   14   0   0  1079   207   23   0  1738
7     1   46   0    7   0   0    14  1084    0   0    12
8     1    7   0  108   0   0   175   227  428   0   424
9     9   27   0   98   0   1   180   722    6   1    93
10    0    0   0    1   0   0     6     4    0   0  1635
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-21 17:43:23.790885,epoch time: 0:23:51.786001,used: 5:11:48.221984,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8336366, 'precision': 0.7302203, 'recall': 0.5490504, 'specificity': 0.9804677, 'f1': 0.59405816, 'auroc': 0.97021365}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   150     6   0    49   0    1    79    68     7    3    120
1     1  1092   1    17   0    0     1   195     9    1     14
2     5     0  41    44  16    8    43    40    18   52     45
3     1     9   0  7483   1   14    12   638   240    3     39
4     0     0  15    43  35    0    52    21    54    9    310
5     3     0   0   241   2  175     7     1    14   74      4
6     8    14   0    51   0    4  1369    49    46    2    364
7     6    43   1   596   3    4     8  6317    91    0    194
8     2     1   0   470   2    3    31   262  1915    7    602
9     7     2  18   135   0   74    27    26    13  173     18
10    4     4   0    55   6    0    89   119   106    1  12408
---- Validation: 
scalar performance:
{'acc': 0.83359635, 'precision': 0.73429847, 'recall': 0.551739, 'specificity': 0.9805057, 'f1': 0.598534, 'auroc': 0.9687356}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   147     6   0    46   1    0    72    84     7    3    117
1     1  1083   0    18   0    0     4   206     5    1     14
2     4     2  44    36  20    9    36    53    13   46     49
3     1     4   0  7453   1   15    13   646   267    5     35
4     2     3  13    41  40    1    56    20    40    6    317
5     6     0   1   234   0  187     3     4    15   69      2
6     6    10   0    40   1    1  1383    63    51    3    350
7     4    39   1   624   4    3    17  6298    91    1    183
8     0     0   1   476   4    6    26   270  1952    4    557
9    11     3  17   135   3   67    31    32    15  168     11
10    1     6   2    50   3    1    79   132   112    1  12409
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33596864, 'precision': 0.39087513, 'recall': 0.28148785, 'specificity': 0.9322863, 'f1': 0.22444783, 'auroc': 0.80640256}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   198   80   0    8   0   1  337   469    4   0    73
1     1  641   0   16   0   0   13   781    1   0    46
2     3   10   0   34   1   0   92   336   11   0   528
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    4    34    2   0  1593
5    36    7   0  219   0  17   81   190    8   6    28
6     3    6   0   15   0   0  863   191   17   0  1972
7     1   49   0    7   0   0   11  1083    0   0    13
8     4    8   0  123   0   0  141   231  359   0   504
9    14   32   0  109   0   2  142   709    3   0   126
10    0    0   0    1   0   0    3     1    0   0  1641
better model found
persisted
after epoch: 14,now: 2024-07-21 18:07:19.747615,epoch time: 0:23:55.956730,used: 5:35:44.178714,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8341181, 'precision': 0.73260236, 'recall': 0.54820067, 'specificity': 0.9805743, 'f1': 0.59032834, 'auroc': 0.9698636}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   128     5   1    51   2    1    89    66     3    4    133
1     0  1090   0    13   0    0     1   203     7    3     15
2     3     4  31    44  14    9    39    53    14   58     43
3     0     8   0  7454   0   19    15   626   263    5     47
4     1     2   9    40  39    3    62    19    43    6    315
5     5     0   2   226   1  172     7     3    16   84      3
6     6    15   0    37   0    2  1381    55    38    5    369
7     2    42   1   646   1    1    21  6284    83    3    181
8     1     1   2   418   5    5    45   256  1998    6    558
9     8     0   8   134   7   61    31    24    14  195     11
10    2     5   0    54   6    3    74   114   131    0  12404
---- Validation: 
scalar performance:
{'acc': 0.83584327, 'precision': 0.7543223, 'recall': 0.5547594, 'specificity': 0.9807319, 'f1': 0.5997528, 'auroc': 0.9713745}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   131     4   0    52   0    3    83    69     8    5    128
1     0  1089   0    15   0    0     1   204     7    1     15
2     5     1  39    45  18    4    39    31    13   62     55
3     0     7   1  7439   0   20    18   628   281    3     43
4     0     1   8    37  42    0    58    22    46   10    315
5     3     0   1   227   0  177     9     0    22   78      4
6     3    12   0    34   1    4  1384    49    39    8    374
7     1    37   1   588   3    0    18  6329    96    5    187
8     1     0   1   455   2    3    32   229  1984    6    583
9     4     2   5   125   8   63    26    24    15  207     14
10    1     4   0    52   4    2    70   103   128    5  12427
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33582872, 'precision': 0.41592798, 'recall': 0.27960968, 'specificity': 0.9321501, 'f1': 0.22212155, 'auroc': 0.8078134}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   153   73   0    8   0   1  373   468    4   0    90
1     1  598   0   15   0   0   15   820    1   0    49
2     0    8   0   31   1   0  102   316   13   1   543
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    4    28    2   0  1599
5    25    4   0  218   0  18   96   176   12   9    34
6     0    5   0   13   0   0  909   163   17   0  1960
7     1   38   0    7   0   0   11  1091    0   0    16
8     0    3   0  111   0   0  146   219  388   0   503
9     9   24   0  109   0   1  164   691    3   2   134
10    0    0   0    1   0   0    3     1    0   0  1641
better model found
persisted
after epoch: 15,now: 2024-07-21 18:31:18.730874,epoch time: 0:23:58.983259,used: 5:59:43.161973,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8404056, 'precision': 0.7423004, 'recall': 0.5733824, 'specificity': 0.9814957, 'f1': 0.6193791, 'auroc': 0.9722618}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   144     7   1    50   1    1    87    68     6    3    115
1     0  1089   1    18   0    0     3   202     8    0     11
2     1     5  75    43  20    7    28    36    13   44     40
3     1     4   1  7450   1   19    18   637   273    0     35
4     0     3  24    40  50    1    67    15    51    8    280
5     2     0   2   219   0  181    12     2    17   85      1
6     8    16   0    29   2    2  1446    51    43    7    304
7     1    47   5   576   3    1    19  6348   101    1    159
8     1     2   3   396   6    1    18   268  2122    4    474
9     7     0  24   131   2   56    34    20    15  192     12
10    3     5   1    51  10    2    80   151   174    2  12314
---- Validation: 
scalar performance:
{'acc': 0.8397218, 'precision': 0.73742867, 'recall': 0.5686735, 'specificity': 0.9814153, 'f1': 0.6132258, 'auroc': 0.9717327}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   134     5   1    47   2    0    82    74    11    6    121
1     0  1104   0    15   0    0     0   193     8    0     12
2     5     3  58    34  26    5    37    41    17   48     38
3     1     5   0  7443   1   21    12   641   277    2     37
4     0     1  22    35  54    1    56    22    56   11    281
5     3     0   2   220   0  177     9     4    19   84      3
6     4    15   0    34   2    0  1430    51    59    5    308
7     1    51   3   560   1    3    19  6354    94    3    176
8     1     2   2   403   8    3    27   261  2111    9    469
9     4     1  29   126   4   48    28    24    13  204     12
10    0     6   0    51   9    1    88   139   176    2  12324
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36836213, 'precision': 0.4353183, 'recall': 0.3002361, 'specificity': 0.9354276, 'f1': 0.2440629, 'auroc': 0.8129012}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   169   89   0    9   0   1   388   457    4   0    53
1     1  690   0   14   0   0    15   738    1   0    40
2     0   12   0   32   2   0   124   351   20   0   474
3     0    0   0    0   0   0     0     0    0   0     0
4     0    1   0    0   1   0     6    39    3   0  1583
5    27    4   0  224   0  15   101   176   17   7    21
6     0    6   0   14   0   0  1171   201   31   0  1644
7     1   47   0    7   0   0    11  1087    0   0    11
8     0    9   0  104   1   0   161   221  496   0   378
9     9   37   0  103   0   1   181   703    9   1    93
10    0    0   0    1   0   0     6     4    0   0  1635
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-21 18:55:26.118481,epoch time: 0:24:07.387607,used: 6:23:50.549580,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.84134203, 'precision': 0.74785846, 'recall': 0.5717726, 'specificity': 0.9816068, 'f1': 0.6170001, 'auroc': 0.97232425}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   160     5   1    46   0    1    73    75    12    3    106
1     1  1103   0    14   0    0     1   190    10    0     13
2     4     4  39    35  27   10    26    42    20   64     41
3     2     5   0  7396   1   21    13   641   301    4     55
4     0     1   7    30  66    0    38    24    55   13    305
5     2     0   0   207   0  197    11     4    22   75      2
6     6    16   0    33   3    2  1378    54    68    6    341
7     3    53   0   548   4    1    12  6352   127    3    160
8     1     2   2   344   2    2    23   263  2210    7    439
9    10     3  15   123   4   61    24    22    28  194      9
10    1     2   0    42  10    1    68   124   192    3  12351
---- Validation: 
scalar performance:
{'acc': 0.84357363, 'precision': 0.75631267, 'recall': 0.5780965, 'specificity': 0.98186195, 'f1': 0.62406534, 'auroc': 0.972577}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   164     5   0    41   1    0    67    75    12    2    116
1     0  1112   0    13   0    0     2   186     6    0     13
2     5     1  42    37  25    6    29    41    16   66     44
3     0     7   0  7411   2   19    14   629   314    4     40
4     1     1   7    32  72    1    62    14    56    6    287
5     3     0   1   201   0  207    10     3    19   73      4
6    10    19   0    30   2    3  1390    59    53    8    334
7     3    51   0   536   1    3    17  6382   109    1    162
8     0     3   0   370   4    5    18   248  2205    9    434
9     2     2  17   116   3   66    28    21    25  197     16
10    2     4   1    54   8    1    74   128   167    2  12355
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36633316, 'precision': 0.41907746, 'recall': 0.30264795, 'specificity': 0.93529665, 'f1': 0.2481952, 'auroc': 0.81352186}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   207   90   0    9   0   2   344   448    5   0    65
1     1  713   0   13   0   0    13   716    1   0    42
2     1   17   0   30   2   0   108   328   21   1   507
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    33    3   0  1590
5    33    6   0  226   0  17    91   166   17  11    25
6     0    6   0   13   0   0  1063   186   35   0  1764
7     1   51   0    7   0   0    10  1082    0   0    13
8     2   10   0   95   1   0   135   207  513   0   407
9    11   39   0  105   2   1   164   692   10   1   112
10    0    0   0    1   0   0     4     2    0   0  1639
better model found
persisted
after epoch: 17,now: 2024-07-21 19:19:23.855848,epoch time: 0:23:57.737367,used: 6:47:48.286947,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.84187716, 'precision': 0.74973404, 'recall': 0.5729134, 'specificity': 0.98164374, 'f1': 0.6174189, 'auroc': 0.9729079}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   143     6   0    44   0    1    92    78     6    3    110
1     1  1098   2    15   0    0     2   196     4    0     14
2     3     1  78    33  13    6    36    37    18   36     51
3     0     5   0  7452   1   23    20   635   265    4     31
4     0     1  19    38  37    1    64    21    50    9    299
5     5     0   4   221   0  198    10     5    13   62      3
6     2    13   0    38   0    4  1475    45    39    4    288
7     0    44   5   548   0    4    16  6415    82    3    146
8     1     1   4   442   2    9    31   265  2062    5    474
9     7     1  31   124   1   70    34    25    15  174     10
10    3     3   1    59   6    2   105   140   139    2  12334
---- Validation: 
scalar performance:
{'acc': 0.84071153, 'precision': 0.7387107, 'recall': 0.5720802, 'specificity': 0.9814904, 'f1': 0.6166499, 'auroc': 0.97310406}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   144     7   0    51   0    1    85    75     8    2    110
1     0  1105   0     9   0    0     0   196     6    0     16
2     3     0  73    35  17    8    38    44    14   42     38
3     0     4   0  7466   0   22    18   651   239    6     34
4     0     1  18    44  40    2    66    21    36    9    302
5     5     0   1   217   2  198    13     2    21   58      4
6     6    16   0    37   1    3  1456    59    33    4    293
7     0    40   6   568   1    4    16  6399    86    3    142
8     2     2   3   439   2    5    37   279  2018    7    502
9     9     0  38   115   2   70    31    21    15  183      9
10    1     1   4    56  10    2   100   133   139    2  12348
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37423915, 'precision': 0.4339687, 'recall': 0.3004738, 'specificity': 0.93593764, 'f1': 0.2449098, 'auroc': 0.81564975}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   168   75   0    9   0   2   408   459    3   0    46
1     1  662   0   14   0   0    17   766    1   0    38
2     0    9   0   29   1   0   141   351   14   0   470
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     7    40    2   0  1583
5    24    4   0  230   0  19   115   161   12   7    20
6     0    6   0   14   0   0  1333   188   25   0  1501
7     1   37   0    7   0   0    12  1096    0   0    11
8     0    5   0  110   1   0   190   233  437   0   394
9     8   29   0  103   0   2   202   695    4   0    94
10    0    0   0    1   0   0     7     5    0   0  1633
new oracle model saved
early stop counter: 1
val acc:0.8407115340232849, best validation acc: 0.8435736298561096, corresponding to test acc:                         0.36633315682411194 / 0.37423914670944214
after epoch: 18,now: 2024-07-21 19:43:26.466783,epoch time: 0:24:02.610935,used: 7:11:50.897882,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.84508777, 'precision': 0.74985135, 'recall': 0.58760226, 'specificity': 0.98204374, 'f1': 0.6339383, 'auroc': 0.974045}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   145     4   0    44   3    0    81    75     6    5    120
1     0  1105   0    11   0    0     1   196     6    1     12
2     2     0  84    31  22    4    26    30    16   50     47
3     1     5   0  7410   0   13    16   657   293    4     39
4     1     0  22    29  71    2    47    20    44   17    286
5     7     0   3   206   1  185     5     0    20   92      2
6    10    11   1    30   3    2  1434    57    58    6    296
7     2    37   6   495   3    2    17  6416   113    2    169
8     0     1   1   368   5    7    34   251  2155    2    471
9     8     0  32   106   6   54    18    25    16  219      9
10    2     7   1    33   6    3    90   126   157    6  12362
---- Validation: 
scalar performance:
{'acc': 0.8459008, 'precision': 0.75806314, 'recall': 0.5880903, 'specificity': 0.98215574, 'f1': 0.6349193, 'auroc': 0.97357786}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   153     6   0    42   2    0    78    78     5    3    116
1     0  1106   1    15   0    0     0   190     7    2     11
2     1     2  88    31  17    3    23    35    16   54     42
3     0     4   0  7382   1   15    15   663   312    9     39
4     0     0  22    31  64    0    58    26    52   11    275
5     4     0   4   214   1  178     6     4    16   92      2
6     8    11   0    28   1    3  1438    50    53    7    309
7     3    46   3   492   2    2    22  6450    98    2    145
8     0     3   3   352   3    4    27   274  2176    6    448
9     5     0  30   110   6   54    25    16    18  215     14
10    0     5   0    53   9    1    76   131   144    3  12374
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38025606, 'precision': 0.44416016, 'recall': 0.3089464, 'specificity': 0.93655336, 'f1': 0.25603256, 'auroc': 0.81724256}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   221   72   0   10   0   2   376   431    6   0    52
1     1  655   0   14   0   0    16   770    1   0    42
2     0    8   0   24   2   0   137   332   20   1   491
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    34    3   0  1589
5    33    4   0  219   0  19   115   148   18  14    22
6     0    5   0   12   0   0  1277   172   30   0  1571
7     1   32   0    6   0   0    11  1101    0   0    13
8     0    4   0   86   2   0   161   211  520   0   386
9    10   26   0   91   0   1   200   684   11   4   110
10    0    0   0    1   0   0     6     2    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-21 20:07:34.689883,epoch time: 0:24:08.223100,used: 7:35:59.120982,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.84543556, 'precision': 0.75003564, 'recall': 0.5905369, 'specificity': 0.9819454, 'f1': 0.6353134, 'auroc': 0.973577}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   185     5   1    48   1    0    62    64     3    1    113
1     0  1100   0    16   0    0     4   197     4    0     11
2     6     1  96    34  13    7    26    43     9   32     45
3     2     5   3  7543   1   24    11   560   244    4     41
4     3     1  29    31  50    2    62    24    46    6    284
5     5     0   4   189   0  263     6     4    14   33      3
6    11    12   1    38   0    3  1447    38    31    1    323
7     2    40   5   583   4    3    16  6343    90    1    177
8     1     1   0   432   5    9    38   247  2027    4    532
9    13     0  35   106   2  124    32    18    14  133     16
10    3     5   0    50   7    2    93   112   109    1  12412
---- Validation: 
scalar performance:
{'acc': 0.84640896, 'precision': 0.75541073, 'recall': 0.5902584, 'specificity': 0.98205805, 'f1': 0.63675076, 'auroc': 0.9743318}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   179     5   1    48   1    2    70    60     3    1    113
1     0  1097   0    17   0    0     1   194     6    2     15
2     7     0  99    31  16   18    27    37    11   22     44
3     1     5   2  7584   1   31    15   544   229    1     27
4     1     0  27    31  56    5    51    17    38    6    307
5     5     1   2   196   1  251     7     5    12   38      3
6    14    15   0    29   1    5  1446    42    44    3    309
7     2    40   3   577   4    4    21  6355    80    0    179
8     0     3   1   444   3    8    39   262  2017    3    516
9     9     1  30   107   3  115    34    25    12  139     18
10    2     3   3    50   6    2    91   118   101    0  12420
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38564333, 'precision': 0.43280357, 'recall': 0.31432387, 'specificity': 0.9371425, 'f1': 0.26622865, 'auroc': 0.8181432}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   306   69   0   19   0   2   354   364    4   0    52
1     1  693   0   19   0   0    18   725    1   0    42
2     3    6   0   34   1   1   142   310   13   0   505
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    29    3   0  1594
5    47    5   0  245   0  33   105   120   12   2    23
6     1    5   0   15   0   0  1318   150   21   0  1557
7     1   37   0   11   0   0    13  1090    0   0    12
8     2    5   0  121   1   0   181   202  433   0   425
9    18   31   0  125   0   6   208   627    3   0   119
10    0    0   0    1   0   0     6     1    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-21 20:31:33.025126,epoch time: 0:23:58.335243,used: 7:59:57.456225,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8493686, 'precision': 0.76407903, 'recall': 0.5891476, 'specificity': 0.98253226, 'f1': 0.63469774, 'auroc': 0.9734697}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   156     5   0    51   1    1    77    60    11    8    113
1     0  1096   0    17   0    0     1   194     6    0     17
2     2     2  58    32  25    5    28    36    18   63     43
3     1     6   0  7514   0   20    11   550   307    4     26
4     1     1  13    32  75    0    44    21    52   18    282
5     2     1   1   209   0  173     5     0    14  112      4
6     5    12   0    23   3    0  1452    47    54    5    307
7     1    41   1   557   5    2    14  6385    96    6    155
8     0     1   2   376   5    4    24   215  2216    5    448
9     6     2  14   100   5   48    18    20    17  250     13
10    0     2   1    42  13    2    73   115   169    3  12371
---- Validation: 
scalar performance:
{'acc': 0.84991306, 'precision': 0.76103085, 'recall': 0.59357774, 'specificity': 0.9826516, 'f1': 0.6396714, 'auroc': 0.9742723}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   160     5   1    41   0    2    79    64     6    6    119
1     0  1110   0    18   0    0     1   186     5    1     11
2     4     1  73    25  27    5    25    36    19   59     38
3     1     7   0  7532   1   26    13   551   280    2     27
4     0     2  19    32  74    0    50    17    55   14    276
5     3     1   2   208   2  176     7     3    12  103      4
6     6    14   0    35   2    0  1444    52    49    9    297
7     3    38   1   569   1    3    17  6365   116    4    148
8     0     2   1   361   6    4    24   234  2257    9    398
9     7     1  10   112   4   52    20    12    25  237     13
10    1     3   2    58  14    2    62   125   179    4  12346
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38984117, 'precision': 0.44755855, 'recall': 0.3153862, 'specificity': 0.9375618, 'f1': 0.26279694, 'auroc': 0.8192073}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   205   80   0   18   0   1   395   407    7   1    56
1     1  748   0   18   0   0    17   674    1   0    40
2     0   14   0   33   2   0   130   306   23   2   505
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    30    3   0  1593
5    27    7   0  254   0  14   105   121   22  18    24
6     0    6   0   15   0   0  1314   151   36   0  1545
7     1   41   0   11   0   0    13  1086    0   0    12
8     0    8   0   99   4   0   151   184  557   0   367
9     7   40   0  126   0   1   204   624   11   8   116
10    0    0   0    1   0   0     5     1    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-21 20:55:32.731211,epoch time: 0:23:59.706085,used: 8:23:57.162310,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.85324806, 'precision': 0.76792, 'recall': 0.6024122, 'specificity': 0.9830454, 'f1': 0.6499302, 'auroc': 0.9742809}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   192     3   1    50   1    1    72    50     7    2    104
1     0  1117   0    18   0    0     3   174     5    0     15
2     3     3  60    32  28    5    28    41    17   58     37
3     1     1   2  7615   0   17     8   489   272    5     27
4     0     1  12    35  89    2    56    21    46   16    261
5     5     0   0   196   0  215     8     2    13   80      2
6    11    19   0    37   1    4  1464    44    47    4    276
7     4    30   1   586   2    1     8  6382   103    3    142
8     0     3   2   435   5    4    31   218  2201    4    393
9     6     1  12   103   5   78    21    16    25  216      9
10    3     2   1    53  12    0    90   117   172    5  12340
---- Validation: 
scalar performance:
{'acc': 0.85095626, 'precision': 0.75961363, 'recall': 0.59872186, 'specificity': 0.9827856, 'f1': 0.64543164, 'auroc': 0.9748863}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   184     5   0    49   0    0    64    53     8    3    117
1     0  1117   0    21   0    0     2   177     4    0     11
2     4     0  63    29  26    3    32    39    18   62     36
3     2     3   0  7605   1   19    14   501   260    8     27
4     0     1  19    37  82    0    53    25    53    8    261
5     6     0   4   197   0  204     4     5    14   84      3
6     5    10   0    29   2    0  1462    53    47    8    292
7     5    38   2   584   3    4    21  6339   115    7    147
8     1     2   1   416   5    3    26   219  2231    5    387
9     3     3  17   110   4   70    21    18    17  218     12
10    0     3   1    55  16    2    95   125   191    0  12308
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.41187993, 'precision': 0.43949258, 'recall': 0.33011883, 'specificity': 0.93980765, 'f1': 0.28185353, 'auroc': 0.8222866}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   322   71   0   19   0   2   359   347    6   0    44
1     1  734   0   20   0   0    20   687    1   0    36
2     3   11   0   40   2   0   158   310   22   1   468
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    32    4   0  1587
5    45    5   0  269   0  20   108    95   19  10    21
6     1    5   0   18   0   0  1533   150   36   0  1324
7     1   37   0   12   0   0    16  1086    0   0    12
8     1    7   0  122   4   0   192   175  552   0   317
9    21   34   0  149   0   1   220   596   10   2   104
10    0    0   0    1   0   0     7     1    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-21 21:19:35.345317,epoch time: 0:24:02.614106,used: 8:47:59.776416,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.85070634, 'precision': 0.74051964, 'recall': 0.6030894, 'specificity': 0.98273796, 'f1': 0.6470707, 'auroc': 0.9745884}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   207     5   0    36   2    1    52    63     4    2    111
1     1  1120   0    16   0    0     3   174     5    0     13
2     4     0  81    22  31   18    26    35    15   47     33
3     5     5   1  7452   2   31    11   623   271    3     32
4     3     2  22    30  80    2    47    27    41    9    275
5     3     1   2   178   1  247     8     5    16   57      3
6    15    13   0    31   2    4  1446    46    48    4    297
7     1    48   0   501   3    5    17  6433    97    2    158
8     7     3   0   350   3    9    26   264  2190    4    440
9    14     0  34    95   6  110    24    21    16  159     14
10    3     2   1    45  16    4    71   116   154    1  12381
---- Validation: 
scalar performance:
{'acc': 0.8528287, 'precision': 0.7592709, 'recall': 0.6140697, 'specificity': 0.98293674, 'f1': 0.6608006, 'auroc': 0.97518396}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   209     5    0    39   1    2    58    58     3    4    104
1     0  1104    0    19   0    0     1   188     6    0     14
2     5     1  100    33  24   12    23    36     9   27     42
3     3     1    0  7478   2   30    14   596   274    5     37
4     1     1   19    25  86    6    49    15    51   11    275
5     3     0    2   172   0  267     6     0    15   53      3
6    12    12    0    28   2    4  1449    50    49    3    299
7     3    37    2   497   3    5    13  6448    99    3    155
8     3     2    0   367  11   11    21   244  2175    7    455
9    11     1   30    96   5  116    20    16    18  167     13
10    8     4    1    36  12    3    73   114   141    4  12400
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40691248, 'precision': 0.42834407, 'recall': 0.33354378, 'specificity': 0.93934226, 'f1': 0.28754252, 'auroc': 0.8224211}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   407   63   0   14   0   2   299   328    6   0    51
1     1  706   0   17   0   0    18   717    1   0    39
2     9    8   0   29   2   1   137   307   20   1   501
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    30    3   0  1593
5    67    5   0  221   0  41    98   116   16   5    23
6     2    5   0   14   0   0  1396   145   28   0  1477
7     1   28   0   10   0   0    13  1100    0   0    12
8     5    4   0   94   4   1   169   198  527   0   368
9    38   29   0  111   0   8   201   627    7   1   115
10    0    0   0    1   0   0     7     1    0   0  1637
better model found
persisted
after epoch: 23,now: 2024-07-21 21:43:43.159421,epoch time: 0:24:07.814104,used: 9:12:07.590520,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.85348886, 'precision': 0.7646543, 'recall': 0.6062645, 'specificity': 0.9831718, 'f1': 0.6516971, 'auroc': 0.97530115}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   189     2   0    46   0    0    74    58    12    2    100
1     1  1102   0    11   0    0     3   199     6    0     10
2     2     0  89    25  16    6    36    34    18   48     38
3     4     6   0  7494   0   24    15   560   302    6     29
4     0     0  22    36  69    0    62    23    56   17    254
5     3     0   1   196   0  199     8     2    20   90      2
6     9    10   0    33   1    2  1501    46    43    7    254
7     1    36   2   511   3    1    16  6444   110    1    139
8     3     3   1   376   7    3    26   221  2271    8    377
9     7     2  29   110   2   61    22    16    21  216      5
10    5     3   0    36   8    2   100   126   183    3  12326
---- Validation: 
scalar performance:
{'acc': 0.8543266, 'precision': 0.77185667, 'recall': 0.6095457, 'specificity': 0.98326993, 'f1': 0.65614235, 'auroc': 0.9764061}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   178     4   1    40   0    3    73    66    11    5    102
1     0  1100   0    15   0    0     2   187     8    1     19
2     3     2  93    31  14    6    27    33    12   50     41
3     0     1   1  7508   1   20    17   572   292    2     26
4     0     0  25    33  82    0    49    17    65   12    256
5     4     0   3   197   2  197     6     3    16   91      2
6     6     7   1    31   2    2  1506    48    58    5    242
7     1    42   1   525   1    2    18  6434   107    3    131
8     1     1   2   340   4    5    28   242  2305    8    360
9    10     2  31    98   1   56    24    17    19  225     10
10    2     3   1    48   9    2    87   134   197    2  12311
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4217449, 'precision': 0.45682228, 'recall': 0.3331083, 'specificity': 0.9405794, 'f1': 0.28402913, 'auroc': 0.82516086}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   293   63   0   18   0   2   412   342    6   0    34
1     1  689   0   18   0   0    26   729    1   0    35
2     3    5   0   31   2   0   190   315   22   1   446
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    14    35    4   0  1579
5    43    5   0  251   0  22   124    98   20  12    17
6     0    5   0   14   0   0  1716   138   38   0  1156
7     1   26   0   11   0   0    20  1096    0   0    10
8     0    3   0   97   3   0   220   182  575   0   290
9    17   26   0  122   0   2   267   592   11   6    94
10    0    0   0    1   0   0    11     4    0   0  1630
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-21 22:07:52.472121,epoch time: 0:24:09.312700,used: 9:36:16.903220,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.8549336, 'precision': 0.75125545, 'recall': 0.6123419, 'specificity': 0.9833361, 'f1': 0.65471387, 'auroc': 0.9761652}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   194     5   2    40   0    2    56    62     8    3    111
1     0  1138   0    13   0    0     1   163     8    0      9
2     4     0  88    27  25   14    21    42    19   44     28
3     3     5   0  7454   2   33    19   598   291    3     31
4     1     0  20    27  75    4    64    21    53   15    258
5     5     1   5   169   0  257     3     3    17   57      4
6    11    12   0    30   1    4  1482    50    44    4    270
7     4    53   1   468   2    4    16  6457   115    0    140
8     0     2   1   341   5    5    32   247  2268    7    387
9    11     1  34    94   4  103    18    19    22  178      9
10    3     3   2    37  12    4    89   118   162    2  12363
---- Validation: 
scalar performance:
{'acc': 0.8556373, 'precision': 0.7590734, 'recall': 0.6146034, 'specificity': 0.9833947, 'f1': 0.6592272, 'auroc': 0.9764772}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   194     4    0    41   0    2    61    60     9    3    109
1     0  1117    1    12   0    0     0   186     8    0      8
2     9     1  102    24  19    8    26    33    15   40     35
3     3     4    0  7476   4   38    14   589   276    4     32
4     1     1   25    27  81    3    44    25    58    8    266
5     6     0    4   179   2  249     5     1    13   57      5
6    13    13    0    26   3    6  1477    47    48    3    272
7     1    46    2   444   4    2    18  6487   120    2    139
8     2     2    1   355   5    8    31   242  2274    3    373
9     7     4   36    95   3   96    23    21    19  176     13
10    0     4    4    37   5    3    82   132   171    3  12355
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42685232, 'precision': 0.42857692, 'recall': 0.34219128, 'specificity': 0.9412212, 'f1': 0.29432794, 'auroc': 0.8251083}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   335   77   0   18   0   2   356   336    6   0    40
1     1  812   0   15   0   0    19   617    1   0    34
2     2   16   0   31   4   0   166   311   22   1   462
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   2   0    10    33    4   0  1584
5    51    7   0  241   0  33   111   100   19   9    21
6     1    5   0   14   0   0  1614   146   34   0  1253
7     1   40   0   10   0   0    14  1088    0   0    11
8     0    9   0   93   4   1   202   182  580   0   299
9    26   44   0  115   0   8   230   601   12   1   100
10    0    0   0    1   0   0     7     2    0   0  1636
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-21 22:32:01.525067,epoch time: 0:24:09.052946,used: 10:00:25.956166,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.8549336, 'precision': 0.76360506, 'recall': 0.605762, 'specificity': 0.9832075, 'f1': 0.65119, 'auroc': 0.97653973}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   178     8    0    43   0    2    65    61     7    5    114
1     0  1119    1    20   0    0     2   175     4    0     11
2     2     0  104    27  12    4    31    40    15   40     37
3     3     2    2  7609   0   18    11   507   255    5     27
4     2     2   32    30  58    0    57    23    52   10    273
5     4     0    7   192   1  200     8     3    20   83      3
6     6    11    0    34   0    2  1499    41    46    3    265
7     4    37    2   563   1    2    19  6381    94    5    156
8     2     1    1   398   7    2    28   210  2226    6    412
9     9     1   32   104   4   66    27    15    15  207     12
10    2     4    0    40   9    0    93   116   153    4  12373
---- Validation: 
scalar performance:
{'acc': 0.85274845, 'precision': 0.76404536, 'recall': 0.60295993, 'specificity': 0.9829509, 'f1': 0.64981866, 'auroc': 0.977009}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   179     8   0    38   0    0    80    58     1    5    114
1     0  1117   0    18   0    0     0   179     8    0     10
2     4     1  99    30  18    8    28    33    14   40     37
3     4     2   1  7618   1   20    11   492   257    4     30
4     0     1  24    31  63    0    56    18    52   11    283
5     1     0   1   199   0  207     6     2    20   83      2
6    12    12   1    32   0    1  1493    38    47    5    267
7     4    41   2   581   2    1    15  6358   110    1    150
8     0     1   1   424   6    5    23   218  2189    6    423
9     6     1  36   108   1   62    31    16    22  198     12
10    4     1   1    39   8    0    87   125   169    3  12359
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42377388, 'precision': 0.46635506, 'recall': 0.33570683, 'specificity': 0.9408273, 'f1': 0.28806204, 'auroc': 0.8256068}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   295   72   0   25   0   2   409   321    5   0    41
1     1  804   0   21   0   0    22   615    1   0    35
2     2   11   0   39   1   0   178   285   22   1   476
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    10    31    3   0  1588
5    34    6   0  283   0  20   119    80   19  10    21
6     0    5   0   16   0   0  1667   116   30   0  1233
7     1   39   0   13   0   0    21  1078    0   0    12
8     0    7   0  120   2   0   220   156  551   0   314
9    12   36   1  158   0   1   269   538    7   4   111
10    0    0   0    1   0   0     7     1    0   0  1637
early stop counter: 1
val acc:0.852748453617096, best validation acc: 0.8556373119354248, corresponding to test acc:                         0.4268523156642914 / 0.4268523156642914
after epoch: 26,now: 2024-07-21 22:56:16.364412,epoch time: 0:24:14.839345,used: 10:24:40.795511,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.8544521, 'precision': 0.7655543, 'recall': 0.61409986, 'specificity': 0.98321754, 'f1': 0.65916955, 'auroc': 0.97571313}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   192     2   0    44   0    2    76    64     5    2     96
1     0  1115   0    17   0    0     2   180     5    1     12
2     3     0  90    23  17    6    27    38    19   49     40
3     2     3   0  7495   2   31    12   594   262    1     36
4     1     1  27    27  74    0    61    22    55   12    259
5     3     0   2   184   0  238     8     4    14   66      2
6    12    11   0    21   2    3  1520    48    44    4    243
7     2    34   3   503   2    3    24  6438   106    1    146
8     2     1   3   386   3    1    30   244  2203    9    414
9    12     0  31    93   1   80    20    18    15  213     10
10    6     2   2    48   8    1   100   121   143    3  12358
---- Validation: 
scalar performance:
{'acc': 0.8546208, 'precision': 0.7543621, 'recall': 0.6060536, 'specificity': 0.9832644, 'f1': 0.6485982, 'auroc': 0.9763646}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   185     6   2    39   0    3    78    62     6    5     97
1     0  1116   0    15   0    0     4   176     7    1     13
2     3     0  89    27  15    6    33    46    11   42     40
3     1     5   0  7511   2   31    14   570   276    2     28
4     2     2  27    21  56    1    67    23    48   15    277
5     7     1   4   183   1  229     9     2    15   69      1
6     6    12   0    33   1    3  1525    38    43    2    245
7     2    24   4   498   2    3    23  6463   112    1    133
8     1     1   3   390   4    7    35   237  2208    9    401
9    10     1  35    93   2   82    26    17    16  198     13
10    4     3   2    41   7    3    92   129   143    2  12370
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4323095, 'precision': 0.50743747, 'recall': 0.33840024, 'specificity': 0.94152915, 'f1': 0.29035252, 'auroc': 0.8274835}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   301   64   0   20   0   2   434   314    4   0    31
1     1  750   0   18   0   0    27   668    1   0    34
2     4    7   1   33   0   0   208   303   19   1   439
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    15    33    3   0  1581
5    46    5   0  259   0  26   133    79   17   9    18
6     0    5   0   14   0   0  1844   115   25   0  1064
7     1   29   0   12   0   0    23  1089    0   0    10
8     0    4   0  111   3   0   263   167  530   0   292
9    19   28   1  130   0   4   292   556    7   4    96
10    0    0   0    1   0   0    11     1    0   0  1633
new oracle model saved
early stop counter: 2
val acc:0.8546208143234253, best validation acc: 0.8556373119354248, corresponding to test acc:                         0.4268523156642914 / 0.43230950832366943
after epoch: 27,now: 2024-07-21 23:20:26.963817,epoch time: 0:24:10.599405,used: 10:48:51.394916,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.85455906, 'precision': 0.7585986, 'recall': 0.6184302, 'specificity': 0.98327607, 'f1': 0.66151685, 'auroc': 0.9773792}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   189     3    0    28   1    4    80    69     7    4     97
1     0  1115    1    13   0    0     6   180     7    1      9
2     3     0  110    20  22    9    20    44    13   35     36
3     1     3    0  7469   0   38    10   624   264    1     28
4     2     1   22    25  76    3    61    27    46   14    262
5     4     0    6   161   1  262     6     3    13   61      4
6     7    16    0    22   2    5  1513    43    43    5    252
7     2    45    5   474   3    4    18  6471   100    3    138
8     1     0    2   370   9    8    32   228  2224    4    416
9     7     0   34    92   3  107    23    21    14  182     10
10    3     3    2    44  11    3    94   134   169    2  12329
---- Validation: 
scalar performance:
{'acc': 0.85903436, 'precision': 0.76218534, 'recall': 0.62157845, 'specificity': 0.9838118, 'f1': 0.66453266, 'auroc': 0.97714555}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   182     3    1    38   3    2    86    65     5    2     96
1     0  1122    0    11   0    0     2   176     8    0     13
2     3     2  102    21  20   12    28    44    12   38     30
3     2     4    1  7501   0   31    19   582   274    3     23
4     2     2   32    22  81    4    60    20    48    7    261
5     3     0    3   171   1  270     5     1    15   50      2
6     7     9    0    23   1    7  1536    45    36    4    240
7     1    38    2   451   4    2    21  6493   103    2    148
8     3     1    4   348   8    4    37   236  2272    3    380
9     7     1   39    88   2  104    26    17    15  187      7
10    2     2    1    40  14    3    89   129   143    4  12369
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43188974, 'precision': 0.48906875, 'recall': 0.33928865, 'specificity': 0.9415312, 'f1': 0.2913043, 'auroc': 0.82789}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   272   68   0   20   0   2   428   344    5   0    31
1     1  765   0   16   0   0    23   659    1   0    34
2     1   12   1   31   3   0   197   317   20   1   432
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   2   0    15    37    4   0  1575
5    36    6   0  253   0  37   129    88   19   6    18
6     0    5   0   13   0   0  1825   135   31   0  1058
7     1   30   0   10   0   0    21  1092    0   0    10
8     0    4   0   99   5   1   247   187  546   0   281
9    13   29   2  114   0   6   283   590    6   3    91
10    0    0   0    1   0   0    11     4    0   0  1630
better model found
persisted
after epoch: 28,now: 2024-07-21 23:44:25.678181,epoch time: 0:23:58.714364,used: 11:12:50.109280,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.8598566, 'precision': 0.7549627, 'recall': 0.63049805, 'specificity': 0.9839351, 'f1': 0.6721828, 'auroc': 0.9779693}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   205     3    1    38   1    0    55    61    12    3    104
1     0  1134    1    11   0    0     1   167     8    1      9
2     6     1  126    22  17    9    13    30    19   41     28
3     0     6    2  7536   2   31    12   548   274    3     25
4     0     1   42    19  93    3    42    24    55   11    248
5     4     0    9   172   0  240     4     1    14   76      1
6    15    14    1    28   5    5  1470    45    53    5    267
7     4    36    5   482   5    3    15  6476   105    0    130
8     5     0    0   342   6    8    29   224  2323    8    350
9     7     1   54    93   4   79    14    16    18  196     11
10    6     5    1    41  19    4    65   117   194    3  12339
---- Validation: 
scalar performance:
{'acc': 0.8592751, 'precision': 0.7616065, 'recall': 0.6311401, 'specificity': 0.98381144, 'f1': 0.6743558, 'auroc': 0.9771617}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   199     3    0    46   3    1    49    57     9    3    113
1     0  1121    0    15   0    0     3   173     8    1     11
2     5     2  137    20  19    8    19    22    14   27     39
3     6     5    2  7540   1   28    14   527   283    3     31
4     0     2   36    29  88    0    44    25    55    7    253
5     4     0   15   171   1  236     4     1    16   70      3
6    13     9    1    25   3    2  1488    55    51    7    254
7     3    27    4   487   3    2    10  6458   124    1    146
8     3     2    4   350  11    3    28   215  2310    5    365
9     8     1   60    88   2   71    15    15    23  200     10
10    5     1    2    42  16    3    74   119   185    2  12347
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43461835, 'precision': 0.4589622, 'recall': 0.3454625, 'specificity': 0.94205284, 'f1': 0.29790202, 'auroc': 0.82846826}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   341   65   0   23   0   2   363   331    7   0    38
1     1  779   0   17   0   0    21   646    1   0    34
2     4   12   1   34   3   0   172   306   25   1   457
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   3   0    12    34    4   0  1580
5    47    6   0  277   0  25   107    80   21  10    19
6     1    5   0   17   0   0  1718   136   44   0  1146
7     1   28   0   12   0   0    15  1097    0   0    11
8     0    6   0  103   7   0   198   171  613   0   272
9    27   34   8  139   0   3   242   571   12   2    99
10    0    0   0    1   0   0     9     3    0   0  1633
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-22 00:08:22.945494,epoch time: 0:23:57.267313,used: 11:36:47.376593,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8615957, 'precision': 0.7718207, 'recall': 0.6352951, 'specificity': 0.9840074, 'f1': 0.68074775, 'auroc': 0.97821224}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   222     3    1    31   0    1    45    66     8    4    102
1     0  1117    0    13   0    0     2   182     7    1     10
2     6     3  103    21  20   10    15    29    14   46     45
3     5     2    1  7514   1   22    10   602   253    2     27
4     1     2   33    26  95    1    27    29    52   14    259
5     7     1    7   145   1  270     3     2    18   64      3
6    12    14    0    24   0    4  1494    46    46    4    264
7     3    35    4   447   4    6    11  6513    98    2    140
8     2     3    4   355   7    5    25   235  2269    5    386
9     9     0   28    80   4   87    12    23    21  216     13
10    5     1    3    42  12    1    74   132   125    5  12390
---- Validation: 
scalar performance:
{'acc': 0.85817844, 'precision': 0.7648809, 'recall': 0.62664104, 'specificity': 0.98359746, 'f1': 0.6721978, 'auroc': 0.9775239}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   229     5   1    33   0    0    49    57     7    2    100
1     1  1133   0    15   0    0     3   167     7    0      6
2    10     0  95    20  27    6     9    39    10   51     45
3     2     3   1  7466   0   29     8   617   279    0     35
4     1     2  23    30  91    1    41    24    49   12    265
5     5     1   4   163   1  245     3     2    15   77      5
6    16     9   0    21   2    4  1471    57    42    6    280
7     1    34   3   450   3    3    15  6523    96    2    135
8     2     3   2   353   3    7    26   259  2215    5    421
9     9     1  41    88   1   82    12    21    17  212      9
10    6     3   2    40  11    2    72   114   142    1  12403
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43300918, 'precision': 0.46872175, 'recall': 0.34802967, 'specificity': 0.9419661, 'f1': 0.3015005, 'auroc': 0.8281963}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   398   67   0   19   0   2   313   325    6   0    40
1     1  802   0   15   0   0    18   627    1   0    35
2     7   13   1   32   3   0   157   310   21   1   470
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   2   0     9    32    3   0  1587
5    63    7   0  259   0  32   100    82   18  10    21
6     2    5   0   16   0   0  1638   141   34   0  1231
7     1   31   0   10   0   0    12  1099    0   0    11
8     3    6   0   99   5   1   188   188  575   1   304
9    43   38   4  120   0   7   217   591    8   5   104
10    0    0   0    1   0   0     7     1    0   0  1637
early stop counter: 1
val acc:0.858178436756134, best validation acc: 0.8592751026153564, corresponding to test acc:                         0.43461835384368896 / 0.43461835384368896
after epoch: 30,now: 2024-07-22 00:32:14.345465,epoch time: 0:23:51.399971,used: 12:00:38.776564,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:00:38.776564 at 2024-07-22 00:32:14.345465
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43461835, 'precision': 0.4589622, 'recall': 0.3454625, 'specificity': 0.94205284, 'f1': 0.29790202, 'auroc': 0.82846826}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   341   65   0   23   0   2   363   331    7   0    38
1     1  779   0   17   0   0    21   646    1   0    34
2     4   12   1   34   3   0   172   306   25   1   457
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   3   0    12    34    4   0  1580
5    47    6   0  277   0  25   107    80   21  10    19
6     1    5   0   17   0   0  1718   136   44   0  1146
7     1   28   0   12   0   0    15  1097    0   0    11
8     0    6   0  103   7   0   198   171  613   0   272
9    27   34   8  139   0   3   242   571   12   2    99
10    0    0   0    1   0   0     9     3    0   0  1633
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43461835, 'precision': 0.4589622, 'recall': 0.3454625, 'specificity': 0.94205284, 'f1': 0.29790202, 'auroc': 0.82846826}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   341   65   0   23   0   2   363   331    7   0    38
1     1  779   0   17   0   0    21   646    1   0    34
2     4   12   1   34   3   0   172   306   25   1   457
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   3   0    12    34    4   0  1580
5    47    6   0  277   0  25   107    80   21  10    19
6     1    5   0   17   0   0  1718   136   44   0  1146
7     1   28   0   12   0   0    15  1097    0   0    11
8     0    6   0  103   7   0   198   171  613   0   272
9    27   34   8  139   0   3   242   571   12   2    99
10    0    0   0    1   0   0     9     3    0   0  1633
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_12_31_35_seed_1_22562328_instance_wise_predictions.txt
accuracy from prediction file 0.43461834464423144
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192535 KiB | 464389 KiB |   1169 TiB |   1169 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1145 TiB |   1145 TiB |
|       from small pool |  19041 KiB |  39751 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 192535 KiB | 464389 KiB |   1169 TiB |   1169 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1145 TiB |   1145 TiB |
|       from small pool |  19041 KiB |  39751 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 190583 KiB | 459649 KiB |   1169 TiB |   1169 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1145 TiB |   1145 TiB |
|       from small pool |  17769 KiB |  37832 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 528384 KiB | 528384 KiB |    792 MiB | 282624 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  40960 KiB |  40960 KiB |     54 MiB |  14336 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38888 KiB |  86670 KiB | 712707 GiB | 712707 GiB |
|       from large pool |  31306 KiB |  79555 KiB | 687894 GiB | 687894 GiB |
|       from small pool |   7582 KiB |  21843 KiB |  24812 GiB |  24812 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4034    |    6277    |  232649 K  |  232645 K  |
|       from large pool |      76    |     158    |  115584 K  |  115584 K  |
|       from small pool |    3958    |    6126    |  117065 K  |  117061 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4034    |    6277    |  232649 K  |  232645 K  |
|       from large pool |      76    |     158    |  115584 K  |  115584 K  |
|       from small pool |    3958    |    6126    |  117065 K  |  117061 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      60    |      18    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      20    |      20    |      27    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      26    |    1268    |  131929 K  |  131929 K  |
|       from large pool |      10    |      22    |   75999 K  |   75999 K  |
|       from small pool |      16    |    1259    |   55930 K  |   55930 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB |   1169 TiB |   1169 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1145 TiB |   1145 TiB |
|       from small pool |      0 KiB |  39751 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB |   1169 TiB |   1169 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1145 TiB |   1145 TiB |
|       from small pool |      0 KiB |  39751 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB |   1169 TiB |   1169 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1145 TiB |   1145 TiB |
|       from small pool |      0 KiB |  37832 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 528384 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  40960 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  86670 KiB | 712707 GiB | 712707 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 687895 GiB | 687895 GiB |
|       from small pool |      0 KiB |  21843 KiB |  24812 GiB |  24812 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  232649 K  |  232649 K  |
|       from large pool |       2    |     158    |  115584 K  |  115584 K  |
|       from small pool |       0    |    6126    |  117065 K  |  117065 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  232649 K  |  232649 K  |
|       from large pool |       2    |     158    |  115584 K  |  115584 K  |
|       from small pool |       0    |    6126    |  117065 K  |  117065 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      20    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1268    |  131930 K  |  131930 K  |
|       from large pool |       3    |      22    |   75999 K  |   75999 K  |
|       from small pool |       0    |    1259    |   55931 K  |   55931 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB |   1169 TiB |   1169 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1145 TiB |   1145 TiB |
|       from small pool |      0 KiB |  39751 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB |   1169 TiB |   1169 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1145 TiB |   1145 TiB |
|       from small pool |      0 KiB |  39751 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB |   1169 TiB |   1169 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1145 TiB |   1145 TiB |
|       from small pool |      0 KiB |  37832 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 528384 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  40960 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  86670 KiB | 712707 GiB | 712707 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 687895 GiB | 687895 GiB |
|       from small pool |      0 KiB |  21843 KiB |  24812 GiB |  24812 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  232649 K  |  232649 K  |
|       from large pool |       2    |     158    |  115584 K  |  115584 K  |
|       from small pool |       0    |    6126    |  117065 K  |  117065 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  232649 K  |  232649 K  |
|       from large pool |       2    |     158    |  115584 K  |  115584 K  |
|       from small pool |       0    |    6126    |  117065 K  |  117065 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      20    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1268    |  131930 K  |  131930 K  |
|       from large pool |       3    |      22    |   75999 K  |   75999 K  |
|       from small pool |       0    |    1259    |   55931 K  |   55931 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328

 Experiment start at: 2024-07-22 01:01:21.614312
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5972817, 'precision': 0.3186723, 'recall': 0.20991217, 'specificity': 0.9489695, 'f1': 0.19425398, 'auroc': 0.81806445}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   1   0    59   0   0   1    86   2   0    334
1    0  92   0    66   0   1   4   803   3   0    363
2    0   0   0    89   0   0   1    42   4   0    176
3    1   6   0  5600   0   1   4  1749  49   0   1030
4    0   0   0    73   0   0   0    14   2   0    450
5    0   0   0   368   0   0   0    30   2   0    121
6    0   7   0   281   0   0  25   111  22   0   1461
7    0   4   0  1380   0   0   2  4200   8   0   1669
8    0   1   0  1142   0   0   0   243  67   0   1842
9    0   0   0   260   2   0   1    44   0   0    186
10   0   1   0   204   0   0   3   185  58   0  12340
---- Validation: 
scalar performance:
{'acc': 0.59657615, 'precision': 0.31827414, 'recall': 0.20958638, 'specificity': 0.94882685, 'f1': 0.19405055, 'auroc': 0.81518334}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   1   0    78   0   0   2    85   0   1    316
1    0  87   0    59   1   0   2   775   4   0    404
2    0   0   0    99   0   1   0    42   1   0    169
3    0  10   0  5573   0   0   7  1783  19   0   1048
4    0   0   0    62   0   0   0    16   4   0    457
5    0   0   0   384   0   0   1    10   1   1    124
6    0   2   0   267   0   0  30   124  19   1   1465
7    0   7   0  1392   0   0   5  4195   5   0   1661
8    0   0   0  1103   0   0   3   241  72   0   1877
9    0   1   0   261   0   0   0    41   2   0    188
10   0   1   0   220   1   0   7   174  47   0  12346
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.16679494, 'precision': 0.09040052, 'recall': 0.14851752, 'specificity': 0.9151789, 'f1': 0.05358512, 'auroc': 0.6330064}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   2   0   0   0   0   0  636   0   0   532
1    0   1   0   0   0   0   0  969   0   0   529
2    0   0   0   2   0   0   0  183   1   0   829
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   0   0   0   0   13   0   0  1620
5    0   0   0  49   0   0   0  274   2   0   267
6    0   1   0   0   0   0   0   47   0   0  3019
7    0   1   0   1   0   0   0  735   0   0   427
8    0   0   0  16   0   0   0  128   3   0  1223
9    0   0   0  10   0   0   0  468   1   0   658
10   0   0   0   0   0   0   0    1   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 01:26:16.893382,epoch time: 0:24:55.279070,used: 0:24:55.279070,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6771458, 'precision': 0.45599696, 'recall': 0.27589855, 'specificity': 0.9600978, 'f1': 0.2799695, 'auroc': 0.90086573}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    6   0    91   0   0   19   117    0   0    250
1    0  399   0    53   0   0    7   786    3   0     84
2    0    0   0   123   0   1    7    54    4   0    123
3    0    5   0  6712   0   1    8  1411   64   0    236
4    0    0   0    87   0   0    4    17    6   0    425
5    0    0   0   459   0   3    9    13    4   2     30
6    0   10   0   242   0   0  306    92   21   0   1237
7    0   14   0  1470   1   0    6  5229   18   1    525
8    0    1   0  1220   0   0   12   244  276   0   1543
9    0    0   0   353   1   1   19    37    2   1     79
10   0    3   0   187   0   0   22   165   32   0  12383
---- Validation: 
scalar performance:
{'acc': 0.67708975, 'precision': 0.45788, 'recall': 0.27720955, 'specificity': 0.96006393, 'f1': 0.2812504, 'auroc': 0.8982566}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    3   0   102   0   0   15   134    1   0    228
1    0  426   0    57   1   0    3   743    2   1     99
2    0    0   0   106   1   1    6    63    4   0    131
3    0   10   0  6711   0   0    4  1405   56   0    254
4    0    1   0    79   0   0    3    21    5   0    430
5    0    1   0   461   0   2   10    12    3   2     30
6    0   13   0   246   0   0  305    94   20   0   1230
7    0   14   0  1474   0   0    2  5242   10   0    523
8    0    2   0  1201   0   0   10   254  268   0   1561
9    0    1   0   351   0   1   19    37    4   1     79
10   0    3   0   200   0   0   22   168   45   0  12358
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19359127, 'precision': 0.16920659, 'recall': 0.17786103, 'specificity': 0.91836953, 'f1': 0.06506799, 'auroc': 0.6906953}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   5   0   1   0   0   3   828   0   0   333
1    0  11   0   3   0   0   0  1348   0   0   137
2    0   0   0   3   0   0   0   332   1   0   679
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    26   0   0  1607
5    0   1   0  88   0   0   0   370   6   0   127
6    0   3   0   4   0   0   3   111   0   0  2946
7    0   9   0   3   0   0   1  1080   0   0    71
8    0   1   0  54   0   0   2   270  32   0  1011
9    0   0   0  27   0   0   1   775   1   0   333
10   0   0   0   0   0   0   0     5   0   0  1641
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 01:50:06.971086,epoch time: 0:23:50.077704,used: 0:48:45.356774,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7251712, 'precision': 0.46697575, 'recall': 0.34294665, 'specificity': 0.9664886, 'f1': 0.3577096, 'auroc': 0.9262141}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   20   0    95   0   0   42   115    5   0    206
1    0  785   0    33   0   1    1   460    5   0     47
2    0    2   0   103   0   1   34    47   11   0    114
3    1    8   0  6922   0   1    6  1128  218   0    152
4    0    1   0    68   0   0   10    15   26   0    419
5    0    1   0   416   0  17   25    13   19  10     20
6    0   27   0   140   0   0  611    87   47   0    996
7    0   56   0  1296   0   1    6  5450   64   0    392
8    0    3   0   893   0   0   22   255  943   0   1180
9    0    6   0   302   1  11   53    35   17   3     65
10   0    4   0   142   0   0   40   142   90   0  12373
---- Validation: 
scalar performance:
{'acc': 0.7249699, 'precision': 0.45288074, 'recall': 0.34024787, 'specificity': 0.96646, 'f1': 0.3544199, 'auroc': 0.9274022}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   17   0    93   0   0   53   117    6   0    197
1    0  755   0    32   0   0    2   487    4   0     52
2    0    0   0   110   0   3   29    52   13   0    105
3    0   11   0  6928   0   1   10  1123  214   1    152
4    0    0   0    69   0   0   14    13   22   0    421
5    0    1   0   435   0  12   23     8   16   7     19
6    0   28   0   154   0   0  615    83   51   0    977
7    0   53   0  1292   0   0    2  5473   61   0    384
8    0    3   0   894   0   0   13   225  939   0   1222
9    0    6   0   300   0  12   44    33   29   2     67
10   0    9   0   126   0   0   43   140   98   1  12379
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20996292, 'precision': 0.17703879, 'recall': 0.19236961, 'specificity': 0.9199991, 'f1': 0.09249179, 'auroc': 0.7192727}
confusion matrix:
    0    1   2    3   4   5   6     7    8   9     10
0    0   41   0    0   0   0  26   777    3   0   323
1    0  107   0    4   0   0   0  1274    1   0   113
2    0    3   0    5   0   0   1   315    4   0   687
3    0    0   0    0   0   0   0     0    0   0     0
4    0    0   0    0   0   0   0    21    0   0  1612
5    0    7   0  108   0   0   2   342   25   0   108
6    0    6   0    4   0   0  12    96    3   0  2946
7    0   35   0    4   0   0   1  1069    0   0    55
8    0    5   0   48   0   0   2   238  171   0   906
9    0    5   0   32   0   0   5   785   11   0   299
10   0    0   0    0   0   0   0     4    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-22 02:13:59.664214,epoch time: 0:23:52.693128,used: 1:12:38.049902,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.74732447, 'precision': 0.48250324, 'recall': 0.37061176, 'specificity': 0.9693276, 'f1': 0.3862086, 'auroc': 0.9394058}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   19   0    84   0   0   61   125     4   0    190
1    0  903   0    29   0   0    1   355     5   0     39
2    0    4   0    94   0   3   31    51    16   1    112
3    0   10   0  7220   0   4    6   889   208   0    102
4    0    2   0    68   0   0   14    15    31   0    409
5    0    2   0   409   0  36   25    11    19   7     12
6    0   29   0   142   0   0  791    68    41   1    836
7    0   64   0  1281   1   1    3  5530    62   0    320
8    0    4   0   915   0   0   19   220  1068   0   1069
9    0    8   2   302   0  22   64    31    19   3     42
10   0    8   0   131   0   0   44   155    73   0  12381
---- Validation: 
scalar performance:
{'acc': 0.7474388, 'precision': 0.53718436, 'recall': 0.36986262, 'specificity': 0.969273, 'f1': 0.38642672, 'auroc': 0.93994254}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   13   0    97   0   0   64   119     1   1    188
1    0  898   0    39   0   0    0   361     2   0     32
2    0    1   1   101   0   6   23    66    14   2     98
3    0   11   0  7230   0   2    8   897   186   0    106
4    0    0   0    69   0   0   20    10    17   0    423
5    0    0   0   419   0  25   38     4    18   9      8
6    0   26   0   149   0   0  779    61    35   0    858
7    0   53   0  1276   0   0    2  5556    49   0    329
8    0    3   0   879   0   0   14   217  1094   0   1089
9    0    1   1   308   1  21   58    29    12   8     54
10   0    9   0   147   0   1   48   139   100   0  12352
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21563002, 'precision': 0.2786966, 'recall': 0.19703773, 'specificity': 0.9206377, 'f1': 0.100249544, 'auroc': 0.7352741}
confusion matrix:
    0    1   2    3   4   5   6     7    8   9     10
0    1   66   0    2   0   0  52   748    2   0   299
1    0  170   0    6   0   0   0  1226    1   0    96
2    0    5   0   10   0   0   1   326    5   0   668
3    0    0   0    0   0   0   0     0    0   0     0
4    0    0   0    0   0   0   0    21    0   0  1612
5    0    7   0  161   0   0   3   309   18   0    94
6    0    7   0    6   0   0  24    98    3   0  2929
7    0   39   0    6   0   0   0  1076    0   0    43
8    0    6   0   94   0   0   5   222  169   0   874
9    0    7   0   58   0   0   9   790    3   0   270
10   0    0   0    0   0   0   0     4    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-22 02:37:58.694007,epoch time: 0:23:59.029793,used: 1:36:37.079695,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7612104, 'precision': 0.64991957, 'recall': 0.38685125, 'specificity': 0.9709877, 'f1': 0.40782815, 'auroc': 0.94707197}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    2   10   0    85   0   0   77   126     0   0    183
1    0  887   0    26   0   0    1   375     4   0     39
2    0    5   3    78   1   4   36    70     8   5    102
3    0   10   0  7108   0   4    6   993   213   0    102
4    0    0   0    64   0   1   18    20    19   0    417
5    0    1   0   382   0  34   33     9    19  33     10
6    0   17   0   100   0   0  928    67    27   0    769
7    0   41   0   889   0   0    3  5965    43   0    322
8    0    1   0   753   0   0   26   298  1077   0   1140
9    0    5   2   259   1  28   77    40    12  31     38
10   0    2   0    93   0   0   51   158    74   0  12416
---- Validation: 
scalar performance:
{'acc': 0.76273906, 'precision': 0.6118164, 'recall': 0.38751546, 'specificity': 0.9712156, 'f1': 0.4089337, 'auroc': 0.94777447}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    1   11   0    85   0   0   86   125     0   0    175
1    0  884   0    22   0   0    2   385     5   0     34
2    0    3   3    84   1   5   33    78     9   3     93
3    0    6   0  7148   0   4   14   968   197   0    103
4    0    0   0    64   0   0   20    13    28   1    413
5    0    2   0   387   0  41   33     8    17  26      7
6    1   21   0    93   0   1  902    80    32   0    778
7    0   47   0   881   0   1    3  5984    58   0    291
8    0    2   0   749   0   1   18   319  1091   0   1116
9    1    7   1   268   0  22   73    33    19  31     38
10   0    5   0    93   0   1   49   157    60   1  12430
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21590988, 'precision': 0.28596613, 'recall': 0.19698998, 'specificity': 0.9205947, 'f1': 0.099521905, 'auroc': 0.74434316}
confusion matrix:
    0    1   2    3   4   5   6     7    8   9     10
0    1   52   0    1   0   0  81   750    1   0   284
1    0  177   0    4   0   0   1  1228    0   0    89
2    0    3   0    6   0   0   4   330    5   0   667
3    0    0   0    0   0   0   0     0    0   0     0
4    0    0   0    0   0   0   0    21    0   0  1612
5    0    7   0  146   0   0  11   324    8   0    96
6    0    3   0    5   0   0  34   103    2   0  2920
7    0   36   0    3   0   0   1  1084    0   0    40
8    0    4   0   77   0   0   8   252  148   1   880
9    0    6   0   46   0   0  11   810    2   0   262
10   0    0   0    0   0   0   0     4    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-22 03:01:52.553910,epoch time: 0:23:53.859903,used: 2:00:30.939598,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7811965, 'precision': 0.63989043, 'recall': 0.4244489, 'specificity': 0.97387815, 'f1': 0.44763452, 'auroc': 0.95243543}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   22   14   0    65   0   0   124   118     2   0    136
1    1  980   1    22   0   0     1   296     4   0     27
2    0    3   7    68   0   5    56    68    16   6     83
3    0    5   0  7104   0   2    14   948   292   1     74
4    0    1   1    59   0   0    48    20    35   0    375
5    0    0   0   351   0  68    46     7    15  28      6
6    2   22   0    63   0   0  1118    72    49   0    581
7    0   55   0   816   0   0     9  6040    67   0    274
8    0    3   0   628   0   4    33   285  1452   0    890
9    2    5   4   243   0  34    97    20    21  33     34
10   1    4   0    88   0   0    76   155    97   0  12374
---- Validation: 
scalar performance:
{'acc': 0.7824529, 'precision': 0.73145175, 'recall': 0.42628926, 'specificity': 0.9740366, 'f1': 0.44904846, 'auroc': 0.95371586}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   15   14   0    64   0   0   117   120     2   0    151
1    0  981   0    18   0   0     4   302     4   0     23
2    1    1   9    68   0   6    57    63    15  12     80
3    0   11   0  7097   0   3    14   935   295   1     84
4    0    0   0    53   2   2    38    20    34   0    390
5    1    0   0   344   0  67    46     5    19  29     10
6    0   24   0    61   0   0  1138    62    39   0    584
7    0   47   0   778   0   3    11  6085    80   0    261
8    1    2   1   632   0   0    26   298  1467   0    869
9    1    2   4   226   0  42    98    31    19  37     33
10   1    9   0    77   0   0    86   166   103   0  12354
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22997272, 'precision': 0.34308696, 'recall': 0.20860952, 'specificity': 0.9218532, 'f1': 0.11852416, 'auroc': 0.75659823}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    4   81   0    2   0   0  182   677    1   0   223
1    1  257   0    4   0   0    2  1152    0   0    83
2    0    3   0    8   0   0   17   338    6   0   643
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    23    0   0  1610
5    1    9   0  156   0   1   30   299   19   0    77
6    0    6   0    7   0   0   71   109    6   0  2868
7    0   41   0    3   0   0    1  1081    0   0    38
8    0    6   0   77   0   0   27   236  232   1   791
9    0   12   0   51   0   0   36   805    4   0   229
10   0    0   0    0   0   0    1     4    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-22 03:25:36.067230,epoch time: 0:23:43.513320,used: 2:24:14.452918,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.79476136, 'precision': 0.6520571, 'recall': 0.45304823, 'specificity': 0.97579, 'f1': 0.4781779, 'auroc': 0.9572719}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   24    11   0    62   0    2   148   101     2   2    131
1    1  1017   0    18   0    1     1   266     8   0     20
2    0     2  14    55   0   15    66    60    22  13     65
3    0     6   0  7117   0   12    18   891   331   2     60
4    0     0   1    47   0    0    55    18    43   0    374
5    1     0   0   306   0  108    39     4    27  34      2
6    1    23   0    57   0    0  1212    65    51   1    498
7    0    52   0   727   0    1    15  6127   100   0    241
8    0     2   0   538   0    3    30   300  1694   2    726
9    1     1   7   191   0   71    85    30    24  58     25
10   1     5   0    68   0    0    82   158   146   0  12334
---- Validation: 
scalar performance:
{'acc': 0.7946235, 'precision': 0.6647069, 'recall': 0.45346698, 'specificity': 0.97576535, 'f1': 0.47878784, 'auroc': 0.95734835}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   24     7   0    63   0    0   130   107     5   1    146
1    0  1019   0    16   0    0     2   269     6   0     20
2    0     1  12    49   2   13    71    57    23  20     64
3    0     7   0  7102   0   14    24   923   311   2     57
4    0     0   0    39   0    0    57    30    47   0    366
5    1     0   0   305   0  118    35     6    22  29      5
6    1    28   0    54   0    2  1187    66    41   0    529
7    0    68   0   717   1    1    13  6155    94   0    216
8    0     1   0   549   0    3    36   288  1685   1    733
9    0     3   5   201   0   62    91    30    24  60     17
10   2     8   0    64   0    1    93   141   142   0  12345
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24697404, 'precision': 0.3389094, 'recall': 0.22298768, 'specificity': 0.9234342, 'f1': 0.14052905, 'auroc': 0.7670961}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   15   96   0    2   0   1  242   633    3   0   178
1    1  340   0    4   0   0    6  1071    0   0    77
2    0    4   0    8   0   0   26   332   12   0   633
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    24    0   0  1609
5    2    9   0  166   0   6   50   272   25   0    62
6    0    8   0    7   0   0  119   106   10   0  2817
7    0   52   0    3   0   0    3  1074    0   0    32
8    0   10   0   69   0   0   45   223  336   1   686
9    0   14   0   55   0   1   62   784   10   0   211
10   0    0   0    0   0   0    2     4    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-22 03:49:30.201496,epoch time: 0:23:54.134266,used: 2:48:08.587184,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.800594, 'precision': 0.66517615, 'recall': 0.46418592, 'specificity': 0.97656244, 'f1': 0.49555737, 'auroc': 0.9599217}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   29   10   0    59   1    0   140   120     2   1    120
1    0  968   0    19   0    0     2   321     4   1     16
2    0    1  26    51   1    9    68    64    19  16     57
3    1    3   0  7146   1    7    21   906   297   1     56
4    0    0   4    42   0    0    74    20    41   3    355
5    1    0   2   294   0  109    31     2    21  54      7
6    2   24   0    57   0    0  1264    70    44   1    446
7    0   35   0   674   0    1    16  6259    80   0    198
8    0    1   0   542   1    2    43   317  1710   0    678
9    1    1  11   188   1   54    80    34    20  85     18
10   0    3   0    56   0    0    92   174   142   0  12327
---- Validation: 
scalar performance:
{'acc': 0.80085593, 'precision': 0.71716446, 'recall': 0.4610598, 'specificity': 0.9765996, 'f1': 0.4892121, 'auroc': 0.9601997}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   27    8   0    64   0    0   145   115     5   3    116
1    0  982   1    12   0    0     4   312     3   1     17
2    0    0  16    49   0   14    69    66    19  15     64
3    0    3   0  7106   0    9    17   929   332   2     42
4    0    0   2    44   3    0    71    25    43   1    350
5    1    0   2   305   0  112    31     4    24  38      4
6    2   13   0    42   0    2  1291    62    44   0    452
7    0   35   1   613   1    0    11  6311    85   1    207
8    0    2   0   520   0    2    32   353  1703   1    683
9    3    1   7   199   0   59    84    34    17  69     20
10   3    4   0    60   0    0    97   178   134   0  12320
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2474638, 'precision': 0.3631987, 'recall': 0.2220557, 'specificity': 0.9234772, 'f1': 0.13893194, 'auroc': 0.774056}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   28   63   0    2   0   1  282   651    2   0   141
1    1  260   0    5   0   0    8  1165    0   0    60
2    0    1   0   10   0   0   35   381   10   0   578
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    32    1   0  1599
5    2    5   0  178   0   5   67   272   20   1    42
6    0    2   0    7   0   0  181   147    9   0  2721
7    0   34   0    3   0   0    2  1103    0   0    22
8    0    3   0   78   0   0   64   266  322   1   636
9    0    7   0   60   0   0   84   819    5   0   162
10   0    0   0    0   0   0    2     6    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-22 04:13:12.136722,epoch time: 0:23:41.935226,used: 3:11:50.522410,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8082994, 'precision': 0.7110511, 'recall': 0.48106438, 'specificity': 0.9774724, 'f1': 0.51284516, 'auroc': 0.9618701}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   38     9   0    50   0    0   157   109     5   0    115
1    0  1037   0    16   0    0     1   258     6   0     14
2    1     1  30    57   5   14    62    57    18  17     50
3    0     6   1  7240   0   14    17   841   265   2     52
4    0     0   2    54   6    2    69    22    32   0    352
5    2     0   0   287   0  152    26     4    18  28      4
6    2    22   0    50   2    0  1320    59    47   1    405
7    0    47   0   622   1    2    16  6302    82   0    191
8    0     2   0   542   1    4    45   309  1696   0    695
9    3     2   5   198   2   85    73    25    18  69     13
10   1     2   1    73   2    1    91   178   123   0  12321
---- Validation: 
scalar performance:
{'acc': 0.8082921, 'precision': 0.7219168, 'recall': 0.48086727, 'specificity': 0.97747844, 'f1': 0.5124698, 'auroc': 0.96163267}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   40    15   0    54   0    2   137   108     1   1    125
1    0  1026   0    15   0    0     4   262     8   0     17
2    0     0  28    61   5   12    59    60    19  16     52
3    0    10   0  7198   0   13    21   876   271   1     50
4    0     0   5    53  10    3    65    19    31   1    352
5    2     0   1   275   0  161    32     6    14  26      4
6    1    21   0    43   0    2  1297    72    37   0    435
7    0    41   0   628   0    2    16  6325    77   0    176
8    0     3   0   558   1    4    35   289  1751   1    654
9    3     1  12   176   1   87    84    29    21  60     19
10   2     3   0    65   0    2   100   176   126   0  12322
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25844818, 'precision': 0.35968998, 'recall': 0.23052952, 'specificity': 0.92456657, 'f1': 0.15294184, 'auroc': 0.77944183}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   40   87   0    5   0   1  296   609    2   0   130
1    1  363   0    5   0   0    7  1064    0   0    59
2    0    4   0   16   0   0   37   364    8   0   586
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    2    30    1   0  1600
5    7    8   0  208   0   9   72   236   15   0    37
6    0    7   0    9   0   0  227   139   10   0  2675
7    0   44   0    3   0   0    5  1091    0   0    21
8    0    8   0   97   0   0   73   246  325   1   620
9    0   13   0   79   0   1   95   780    4   0   165
10   0    0   0    1   0   0    2     4    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-22 04:36:59.530871,epoch time: 0:23:47.394149,used: 3:35:37.916559,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8134899, 'precision': 0.727571, 'recall': 0.49202257, 'specificity': 0.9782061, 'f1': 0.52542627, 'auroc': 0.9642118}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   48     8   0    53   0    0   137   110     5    3    119
1    0  1022   0    19   0    0     1   268     8    1     13
2    0     0  25    51   4    7    59    64    19   38     45
3    0     5   0  7245   0    6    15   813   310    5     40
4    0     2   6    43  10    1    69    29    47    7    325
5    2     0   0   267   0  110    24     5    17   91      4
6    0    14   0    54   0    1  1313    66    46    3    411
7    0    37   3   590   1    0    17  6345   101    4    166
8    0     1   2   518   0    4    33   293  1835    3    605
9    0     3  12   173   1   43    52    32    20  146     11
10   0     3   1    58   1    0    90   184   146    3  12306
---- Validation: 
scalar performance:
{'acc': 0.816076, 'precision': 0.72842926, 'recall': 0.49849758, 'specificity': 0.9785079, 'f1': 0.5333228, 'auroc': 0.96411794}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   44     8   0    47   0    0   147   112     7    2    116
1    0  1039   0    14   0    0     4   252     8    0     15
2    0     2  36    49   5    5    50    54    19   48     44
3    0     4   0  7240   0    7    20   814   310    2     43
4    0     0   5    40  11    0    71    34    51    7    320
5    2     0   0   272   0  112    27     6    17   83      2
6    1    15   0    54   0    0  1322    71    47    4    394
7    0    33   0   597   2    1    13  6342    99    2    176
8    2     3   1   458   0    1    38   308  1869    0    616
9    0     3  18   172   1   40    58    21    16  151     13
10   1     2   0    62   2    1    99   154   131    1  12343
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26446512, 'precision': 0.39462802, 'recall': 0.23464659, 'specificity': 0.9251784, 'f1': 0.15834582, 'auroc': 0.784201}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   49   73   0    5   0   1  313   605    2   0   122
1    1  349   0    7   0   0    8  1082    1   0    51
2    0    3   0   15   0   0   41   370   12   0   574
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    2    30    2   0  1599
5    5    7   0  219   0   6   71   227   19   2    36
6    0    5   0   10   0   0  272   147   15   0  2618
7    0   38   0    4   0   0    4  1101    0   0    17
8    0    6   0   97   0   0   75   246  364   1   581
9    0   11   0   86   0   0  103   775    5   1   156
10   0    0   0    1   0   0    2     5    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-22 05:00:49.545136,epoch time: 0:23:50.014265,used: 3:59:27.930824,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8188945, 'precision': 0.7299695, 'recall': 0.5116201, 'specificity': 0.97864336, 'f1': 0.55441827, 'auroc': 0.96566427}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   73     9   0    70   1    0    89    90     6    2    143
1    0  1058   0    15   0    0     1   234     7    1     16
2    0     0  46    48  10   16    48    50    20   20     54
3    0     5   0  7346   0   15    11   716   295    2     49
4    0     1   7    42  17    3    47    20    51    1    350
5    3     1   1   244   1  188    11     6    25   36      4
6    3    20   0    48   1    2  1266    59    54    2    452
7    1    48   0   664   3    3    14  6238    88    0    204
8    0     2   0   474   0    5    19   277  1900    0    619
9    7     3  13   172   4   83    45    34    20  101     11
10   3     3   0    67   1    3    64   130   144    3  12374
---- Validation: 
scalar performance:
{'acc': 0.82019526, 'precision': 0.72993445, 'recall': 0.51327556, 'specificity': 0.97881615, 'f1': 0.55651915, 'auroc': 0.96533257}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   90    11   0    62   0    0    93    76    11    2    138
1    0  1060   0    18   0    0     4   226     3    2     19
2    0     2  42    55   7   16    50    51    11   19     59
3    0    10   0  7343   1   16    10   708   297    2     53
4    0     0   8    50  20    4    48    19    47    2    341
5    2     0   4   259   1  178    13     5    17   37      5
6    5    15   0    46   0    2  1280    53    57    0    450
7    0    51   3   627   1    2    12  6272    98    0    199
8    1     0   0   514   4    6    29   252  1890    2    598
9    4     2  15   165   6   85    51    21    22  101     21
10   0     3   0    58   0    1    67   139   140    1  12387
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2760792, 'precision': 0.36847472, 'recall': 0.2475695, 'specificity': 0.92644835, 'f1': 0.18006574, 'auroc': 0.7874204}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   140  100   0    9   0   1  261   514    4   0   141
1     2  448   0   13   0   0    7   965    1   0    63
2     0    7   0   23   0   0   36   317   14   0   618
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    2    22    2   0  1607
5    12    7   0  255   0  10   59   183   20   1    45
6     0    7   0   13   0   0  233   100   17   0  2697
7     0   51   0   10   0   0    3  1077    0   0    23
8     0    8   0  114   0   0   52   200  396   1   599
9     7   16   0  116   0   1   88   718    5   0   186
10    0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-22 05:24:45.277776,epoch time: 0:23:55.732640,used: 4:23:23.663464,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.82298803, 'precision': 0.71559167, 'recall': 0.5192734, 'specificity': 0.97918004, 'f1': 0.5616789, 'auroc': 0.96684396}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   96     9   0    49   0    1    95    91     9    5    128
1    1  1052   0    15   0    0     3   237     5    1     18
2    0     0  39    50   5   12    43    45    18   46     54
3    1     3   2  7392   0   21    14   692   275    0     39
4    0     0   7    37   7    0    65    25    48    6    344
5    4     0   0   259   0  174    14     3    17   48      2
6    4    15   1    36   1    3  1308    68    53    3    415
7    1    44   0   674   4    0    12  6247    99    1    180
8    1     0   0   496   1    7    12   254  1930    1    591
9    3     2  11   170   5   69    41    21    19  136     16
10   1     6   0    62   2    0    58   155   132    0  12379
---- Validation: 
scalar performance:
{'acc': 0.8241541, 'precision': 0.7546659, 'recall': 0.522883, 'specificity': 0.97932994, 'f1': 0.5666412, 'auroc': 0.9667821}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   109    12   0    67   0    2    92    75     7    2    117
1     0  1062   0    15   0    0     2   230     6    0     17
2     0     1  49    50   2    8    49    41    21   36     55
3     1     7   0  7361   0   17    11   706   287    2     48
4     1     0   5    34  13    1    65    23    52    7    338
5     3     0   3   250   0  162    11     3    17   67      5
6     3    18   2    44   0    3  1296    70    42    3    427
7     1    42   0   621   1    1     9  6301    97    3    189
8     3     4   1   462   0    5    17   278  1929    2    595
9    12     1  15   150   0   69    51    25    25  130     15
10    1     4   1    55   0    2    60   139   133    2  12399
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28776324, 'precision': 0.3959922, 'recall': 0.25741625, 'specificity': 0.9276113, 'f1': 0.19498502, 'auroc': 0.79164654}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   231   75   0    9   0   1  246   476    3   0   129
1     2  422   0   13   0   0   10   990    1   0    61
2     0    3   0   27   0   0   43   316   13   0   613
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    2    23    2   0  1606
5    22    6   0  252   0  10   67   169   21   3    42
6     0    6   0   13   0   0  303   102   17   0  2626
7     0   38   0    9   0   0    5  1089    0   0    23
8     0    6   0  114   0   0   65   195  415   1   574
9    12   12   0  123   0   1  105   704    5   1   174
10    0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-22 05:48:45.914592,epoch time: 0:24:00.636816,used: 4:47:24.300280,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8282855, 'precision': 0.7422645, 'recall': 0.5365292, 'specificity': 0.9799192, 'f1': 0.5803703, 'auroc': 0.966843}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   102    11   0    64   0    0    93    93     3    4    113
1     0  1076   0    16   0    0     2   223     3    0     12
2     3     1  54    35   7    8    42    51    17   38     56
3     0     4   0  7330   0   17    15   736   285    8     42
4     0     0   5    30  20    3    66    22    48    9    336
5     4     0   1   239   0  172    12     6    14   66      6
6     3    13   0    36   1    4  1359    69    45    0    377
7     0    52   1   575   2    1    14  6345   105    4    164
8     0     1   0   481   0    2    29   284  1960    6    533
9     6     0  20   143   1   66    42    29    13  160     13
10    1     2   3    49   5    0    74   142   136    2  12380
---- Validation: 
scalar performance:
{'acc': 0.8275779, 'precision': 0.72837234, 'recall': 0.531586, 'specificity': 0.9798304, 'f1': 0.57428724, 'auroc': 0.967986}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   102    10   0    52   1    0    93   103     3    3    116
1     0  1070   0    14   0    0     3   224     5    0     16
2     0     0  46    37  11    9    45    58    12   44     50
3     0     3   0  7341   1   18    19   727   289    0     42
4     0     0  13    29  17    2    61    31    52    9    325
5     3     0   1   249   0  174    14     4    13   58      5
6     3    14   0    42   1    2  1356    54    52    4    380
7     0    53   2   565   2    3    16  6341    93    2    188
8     1     1   0   473   1    5    24   278  1978    3    532
9     2     3  22   153   3   61    42    23    19  148     17
10    1     5   0    52   1    0    76   155   136    4  12366
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.296089, 'precision': 0.3987068, 'recall': 0.26030526, 'specificity': 0.9283142, 'f1': 0.19783367, 'auroc': 0.79548216}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   181   97   0    8   0   1  306   473    3   0   101
1     1  503   0   11   0   0   12   917    1   0    54
2     0    8   0   21   0   0   62   334   12   0   578
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    28    2   0  1600
5    19    7   0  245   0  11   77   175   17   3    38
6     0    7   0   12   0   0  414   129   17   0  2488
7     0   47   0    6   0   0    7  1088    0   0    16
8     0    8   0  112   0   0   88   213  394   1   554
9     7   17   0  109   0   1  127   716    5   1   154
10    0    0   0    1   0   0    2     3    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-22 06:12:37.580606,epoch time: 0:23:51.666014,used: 5:11:15.966294,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.83179045, 'precision': 0.7444761, 'recall': 0.5409708, 'specificity': 0.98037696, 'f1': 0.5822325, 'auroc': 0.96902555}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   87     7   0    58   1    1   120    86     5    5    112
1    0  1076   0    17   0    0     3   212     8    0     16
2    1     1  55    41   4    8    46    45    16   46     49
3    1     4   0  7405   0   27    19   631   301    1     48
4    0     1   8    38  20    0    53    17    63   13    325
5    2     0   2   228   0  184    10     4    16   71      4
6    6    10   0    42   2    1  1369    57    46    3    372
7    1    38   1   609   1    3    12  6299   107    2    190
8    1     2   1   425   1    5    36   274  2047    4    500
9    0     2  15   136   2   74    43    23    17  170     11
10   3     3   0    48   4    1    72   121   161    4  12377
---- Validation: 
scalar performance:
{'acc': 0.83110875, 'precision': 0.74018323, 'recall': 0.539402, 'specificity': 0.98030174, 'f1': 0.57964694, 'auroc': 0.9684868}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   90     9   1    58   0    1   108    84     5    6    121
1    0  1070   0    11   0    0     3   223     8    0     17
2    1     0  50    32   9   11    41    48    13   47     60
3    0     6   0  7395   0   26    14   625   334    2     38
4    0     0  18    34  24    2    73    20    47    4    317
5    3     0   1   220   0  195    13     5    15   68      1
6    2    12   0    38   0    2  1390    49    50    4    361
7    1    45   2   600   1    3    22  6288   109    2    192
8    1     1   1   430   0    6    26   250  2040    7    534
9    5     0  11   140   1   78    50    17    23  152     16
10   1     5   1    50   3    1    76   138   139    5  12377
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.30651367, 'precision': 0.39881662, 'recall': 0.26654884, 'specificity': 0.9292052, 'f1': 0.20753479, 'auroc': 0.79859936}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   188   73   0   12   0   2  356   433    3   0   103
1     1  478   0   14   0   0   16   932    1   0    57
2     0    4   0   23   0   0   85   300   13   0   590
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    22    3   0  1605
5    16    6   0  254   0  12   93   147   20   4    40
6     0    6   0   13   0   0  522    96   22   0  2408
7     0   37   0    8   0   0   11  1090    0   0    18
8     0    5   0  109   0   0  110   179  449   1   517
9     7   12   0  120   0   1  169   668    5   1   154
10    0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-22 06:36:35.926043,epoch time: 0:23:58.345437,used: 5:35:14.311731,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.836098, 'precision': 0.74797744, 'recall': 0.5509554, 'specificity': 0.98098814, 'f1': 0.5940959, 'auroc': 0.97028816}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   121     4   0    52   0    0   117    77     3    3    106
1     1  1089   0    13   0    0     2   201     8    0     16
2     0     1  63    41   9    6    51    39    21   44     36
3     0     6   1  7401   2   16    14   665   295    3     35
4     0     0  16    40  35    1    69    19    59    8    292
5     3     1   0   240   0  191    10     3    16   54      3
6     5    20   0    42   1    3  1417    41    41    2    336
7     3    50   1   567   1    2    15  6336   114    0    174
8     0     2   2   423   0    4    22   249  2123    0    470
9     3     3  25   123   1   97    50    29    23  126     13
10    1     2   0    58   2    2    94   131   157    0  12348
---- Validation: 
scalar performance:
{'acc': 0.8352548, 'precision': 0.7507064, 'recall': 0.5484044, 'specificity': 0.980813, 'f1': 0.5919855, 'auroc': 0.96928614}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   113     7   0    52   0    0   112    75     4    1    119
1     0  1090   1    17   0    1     3   197     4    0     19
2     1     1  63    37  10   13    44    44    18   29     52
3     0     5   0  7427   0   15    20   633   299    4     37
4     0     1  13    35  31    1    69    18    53    6    312
5     5     2   2   236   0  196     7     2    23   46      2
6     4    20   1    32   0    3  1412    47    53    1    335
7     0    55   1   582   2    1    13  6317   114    0    180
8     0     2   0   403   0    5    35   251  2087    2    511
9     8     3  22   136   3   89    45    24    24  126     13
10    1     6   1    53   1    0    85   142   143    0  12364
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3288323, 'precision': 0.39078704, 'recall': 0.28279254, 'specificity': 0.93137616, 'f1': 0.22899541, 'auroc': 0.8021367}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   266   91   0   11   0   1  348   369    3   0    81
1     1  579   0   14   0   0   17   834    1   0    53
2     1    9   0   23   0   0  106   288   14   0   574
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    22    3   0  1605
5    26    6   0  259   0  12  107   128   20   1    33
6     0    8   0   13   0   0  659    92   23   0  2272
7     0   52   0    8   0   0   15  1073    0   0    16
8     1    8   0  107   0   0  130   171  471   1   481
9    10   19   0  124   0   1  196   640    7   0   140
10    0    0   0    1   0   0    3     2    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-22 07:00:28.694113,epoch time: 0:23:52.768070,used: 5:59:07.079801,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.837195, 'precision': 0.73960924, 'recall': 0.55821234, 'specificity': 0.98114574, 'f1': 0.5969998, 'auroc': 0.9705715}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   127     9   1    46   0    0   110    71     8    2    109
1     1  1084   0    15   0    0     3   210     4    0     13
2     1     2  47    41  10    8    39    42    16   68     38
3     0     6   2  7379   0   21    14   680   294    1     39
4     0     0  19    41  29    1    60    20    49   13    307
5     2     0   1   226   1  155     9     1    21  103      2
6    10    19   0    42   2    3  1410    55    48    3    316
7     1    41   0   530   1    1    19  6397   106    6    163
8     1     2   0   382   2    5    27   265  2136    5    470
9     4     0  21   123   0   45    26    17    18  225     14
10    2     5   2    40   1    2    96   155   186    3  12302
---- Validation: 
scalar performance:
{'acc': 0.83750165, 'precision': 0.74720645, 'recall': 0.5622305, 'specificity': 0.98123574, 'f1': 0.6033819, 'auroc': 0.9709419}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   126     8   1    40   0    0   105    71    11   11    110
1     0  1077   0    13   0    0     2   218     7    3     12
2     1     1  62    37  15    6    31    47    13   60     39
3     2     6   1  7360   0   17    16   685   306   11     36
4     0     0  16    32  33    1    73    28    58    9    289
5     2     0   1   223   0  159     9     1    17  108      1
6     4    20   1    34   0    0  1433    49    49    5    313
7     2    50   1   539   2    2    18  6390   116    1    144
8     0     1   2   379   3    6    32   288  2138    4    443
9     6     1  14   132   3   43    26    18    22  215     13
10    1     3   2    55   1    0    88   155   169    5  12317
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33652836, 'precision': 0.4094321, 'recall': 0.2878821, 'specificity': 0.9322476, 'f1': 0.23351419, 'auroc': 0.80547005}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   280   89   0   11   0   1  328   392    3   0    66
1     1  570   0   14   0   0   18   850    1   0    45
2     0    9   0   21   0   0  109   329   16   0   531
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    28    4   0  1598
5    27    6   0  251   0  10  102   144   21   7    24
6     0    8   0   14   0   0  726   121   31   0  2167
7     0   45   0    6   0   0   11  1088    0   0    14
8     1    8   0  110   0   0  125   191  495   1   439
9    11   21   0  113   0   1  179   680    6   2   124
10    0    0   0    1   0   0    3     3    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-22 07:24:22.250818,epoch time: 0:23:53.556705,used: 6:23:00.636506,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8419306, 'precision': 0.75669885, 'recall': 0.57468164, 'specificity': 0.98169196, 'f1': 0.62276375, 'auroc': 0.97138774}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   141     6   2    52   0    2    91    70     8    2    109
1     0  1089   0    17   0    0     3   202    11    1      9
2     3     0  74    37  17    4    44    43    18   36     36
3     0     2   0  7429   1   30    24   616   296    3     35
4     0     1  12    36  58    0    57    22    59   11    283
5     4     0   2   219   0  195     7     2    25   65      2
6     8    16   0    37   2    1  1411    47    54    4    328
7     2    38   2   543   4    3    12  6370   121    3    165
8     0     1   2   382   1    8    30   232  2191    2    446
9     5     1  17   121   7   74    29    19    24  181     15
10    3     5   0    49   7    1    90   145   164    1  12329
---- Validation: 
scalar performance:
{'acc': 0.84100574, 'precision': 0.74856937, 'recall': 0.5712977, 'specificity': 0.9816312, 'f1': 0.6167715, 'auroc': 0.9717203}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   141     4   1    51   1    0    97    70     8    2    108
1     0  1092   0    14   0    0     1   203     7    0     15
2     5     0  69    33  12    8    34    42    23   43     43
3     1     8   1  7374   1   22    15   645   337    0     36
4     1     0  16    32  53    2    62    21    57    9    286
5     5     1   2   207   0  200     8     2    20   74      2
6    12    16   1    30   0    2  1427    47    50    1    322
7     1    41   1   561   3    1    14  6365   118    3    157
8     1     2   1   383   1    5    31   249  2208    6    409
9     9     1  28   127   4   70    30    24    23  166     11
10    1     2   0    44   4    1    93   144   161    0  12346
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34331492, 'precision': 0.4572831, 'recall': 0.29535085, 'specificity': 0.93294543, 'f1': 0.24364692, 'auroc': 0.8072339}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   351   69   0   13   0   1  304   355    3   0    74
1     1  540   0   15   0   0   17   876    1   0    49
2     3    6   0   24   2   0  107   306   19   0   548
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   1   0    3    25    3   0  1601
5    37    6   0  258   0  15  105   114   26   1    30
6     2    7   0   15   0   0  737   103   36   0  2167
7     1   35   0    8   0   0   13  1093    0   0    14
8     1    4   0  107   0   0  122   174  529   1   432
9    22   15   1  128   0   1  191   637    7   1   134
10    0    0   0    1   0   0    3     2    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-22 07:48:24.392105,epoch time: 0:24:02.141287,used: 6:47:02.777793,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8401113, 'precision': 0.7612932, 'recall': 0.57340956, 'specificity': 0.981398, 'f1': 0.62194586, 'auroc': 0.971251}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   142     7   0    43   0    0   103    74     5    3    106
1     0  1072   1    11   0    0     2   226     8    0     12
2     5     0  81    39  12    6    27    45    20   40     37
3     0     4   0  7351   1   17    19   704   294    0     48
4     0     0  13    30  47    2    64    26    47    8    302
5     4     0   2   208   0  206     7     3    16   72      3
6     8    12   1    24   0    3  1421    50    51    2    336
7     0    40   0   503   1    1    19  6442    90    4    163
8     2     2   1   379   3    3    27   258  2122    3    496
9     5     0  26   124   2   77    27    25    20  175     12
10    1     2   3    44   6    0    78   160   154    2  12341
---- Validation: 
scalar performance:
{'acc': 0.8392671, 'precision': 0.75140077, 'recall': 0.57046306, 'specificity': 0.9813077, 'f1': 0.61753, 'auroc': 0.97184753}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   141     6   0    44   0    0    85    82     6    4    115
1     0  1083   1    13   0    0     3   213     6    0     13
2     5     1  82    28  12    7    31    39    15   41     51
3     0     2   0  7340   0   24    16   706   313    4     35
4     1     1  16    30  41    0    57    22    52    8    311
5     2     1   7   208   0  187    10     4    14   83      5
6     9    10   0    30   3    5  1427    52    53    4    315
7     4    36   1   487   4    2    17  6456   104    0    154
8     1     0   1   388   2    6    28   281  2072    5    512
9     6     1  20   130   4   64    30    23    18  183     14
10    0     2   1    38   3    0    78   155   152    3  12364
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33778772, 'precision': 0.5142388, 'recall': 0.2893794, 'specificity': 0.93238163, 'f1': 0.23645464, 'auroc': 0.80800086}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   322   55   0   12   0   1  313   390    3   0    74
1     1  506   0   13   0   0   17   913    1   0    48
2     2    4   0   20   0   0  102   318   16   0   553
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   1   0    3    25    3   0  1601
5    34    5   0  254   0  13  101   130   21   2    32
6     0    4   0   12   0   0  751   117   24   0  2159
7     0   31   0    6   0   0   12  1101    0   0    14
8     1    4   0  106   0   0  126   190  493   1   449
9    14   12   0  106   0   1  187   677    6   1   133
10    0    0   0    1   0   0    3     2    0   0  1640
early stop counter: 1
val acc:0.8392670750617981, best validation acc: 0.8410057425498962, corresponding to test acc:                         0.34331491589546204 / 0.34331491589546204
after epoch: 18,now: 2024-07-22 08:12:24.660629,epoch time: 0:24:00.268524,used: 7:11:03.046317,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.84420484, 'precision': 0.75292015, 'recall': 0.57985073, 'specificity': 0.98192394, 'f1': 0.6237778, 'auroc': 0.9728309}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   125     5   1    43   0    1   102    88     7    6    105
1     1  1079   1    15   0    0     0   210     7    1     17
2     2     0  97    27  12   11    26    38    15   46     38
3     0     4   1  7456   1   28    19   655   239    4     31
4     0     1  29    31  46    2    58    17    56    8    291
5     3     0   5   202   1  199     5     3    11   89      3
6     5    13   2    35   0    2  1435    58    44    6    305
7     3    33   3   533   3    3    19  6430    87    1    149
8     1     1   4   399   4    6    31   256  2107    9    478
9     3     1  34   115   2   70    20    20    19  198     11
10    1     2   2    51   1    0    77   122   154    3  12381
---- Validation: 
scalar performance:
{'acc': 0.8434399, 'precision': 0.74380887, 'recall': 0.5832426, 'specificity': 0.98182833, 'f1': 0.62662697, 'auroc': 0.9721576}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   132     8   1    47   0    2   106    61     6    4    116
1     0  1085   1    10   0    0     2   216     6    0     12
2     4     1  96    27  12    8    37    31    17   45     34
3     1     3   1  7442   1   27    12   646   258    5     44
4     1     1  30    27  46    2    54    22    53   11    292
5     4     0   4   192   0  214     9     4    13   78      3
6     5    12   1    38   2    4  1451    47    31    4    313
7     2    35   1   510   5    6    19  6411   106    4    166
8     2     1   7   434   1    6    37   266  2060    6    476
9     5     1  33   103   2   75    26    24    10  200     14
10    4     2   0    48  10    0    79   119   135    4  12395
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34366474, 'precision': 0.49647444, 'recall': 0.29098344, 'specificity': 0.93291986, 'f1': 0.24041277, 'auroc': 0.8104028}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   291   60   0   20   0   2  351   373    2   0    71
1     1  539   0   15   0   0   19   878    1   0    46
2     0    5   1   29   1   0  122   299   14   0   544
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   1   0    3    25    3   0  1601
5    25    5   0  285   0  17  112   105   12   6    25
6     0    6   0   15   0   0  853   102   23   0  2068
7     0   32   0    9   0   0   14  1095    0   0    14
8     0    4   0  123   0   0  144   178  473   1   447
9    11   14   2  137   0   2  209   623    6   2   131
10    0    0   0    1   0   0    3     2    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-22 08:36:19.634842,epoch time: 0:23:54.974213,used: 7:34:58.020530,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8451413, 'precision': 0.7550863, 'recall': 0.5870728, 'specificity': 0.9821801, 'f1': 0.62954104, 'auroc': 0.97307426}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   159     4   0    47   0    3    92    69     6    5     98
1     0  1096   0    12   0    0     2   204     4    0     14
2     3     2  80    31   8   14    36    44    25   38     31
3     1     2   0  7373   1   35    12   696   284    2     32
4     0     1  22    34  50    5    59    23    56   10    279
5     4     0   2   177   0  258     8     3    17   50      2
6     8    10   2    34   1    7  1444    53    61    4    283
7     1    31   0   489   4    6    12  6476   112    2    132
8     1     1   1   385   2    7    25   264  2194    5    408
9    12     1  26   107   1  114    29    22    15  153     12
10    6     4   0    36   4    4    85   160   188    2  12305
---- Validation: 
scalar performance:
{'acc': 0.84699744, 'precision': 0.7500627, 'recall': 0.59006065, 'specificity': 0.98239875, 'f1': 0.6330403, 'auroc': 0.9737606}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   164     6   0    50   1    0    74    70     9    3    106
1     1  1092   0    17   0    0     1   205     6    0     10
2     2     1  82    34  13   16    32    41    14   37     40
3     2     5   0  7360   0   36    12   692   299    5     29
4     0     0  20    31  47    1    59    28    57    9    287
5     4     0   2   186   0  252     9     1    16   50      1
6    10    10   0    35   0    5  1459    57    48    2    282
7     0    38   3   447   4    3    17  6523   103    2    125
8     0     2   3   379   3   14    36   273  2217    0    369
9     8     0  29   109   2  105    24    21    22  162     11
10    7     1   0    43   9    4    80   171   172    2  12307
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36514378, 'precision': 0.47330964, 'recall': 0.30782133, 'specificity': 0.93517303, 'f1': 0.25922292, 'auroc': 0.8138343}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   377   56   0   15   0   2  302   368    3   0    47
1     1  530   0   14   0   0   18   894    1   0    41
2     2    5   0   27   1   0  127   331   19   0   503
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   1   0    4    33    3   0  1592
5    35    5   0  263   0  25  104   118   21   2    19
6     0    5   0   17   0   0  999   124   33   0  1889
7     0   28   0    8   0   0   12  1104    0   0    12
8     1    4   0  108   0   0  144   192  545   1   375
9    19   12   1  123   0   3  205   653    7   1   113
10    0    0   0    1   0   0    4     4    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-22 09:00:22.086530,epoch time: 0:24:02.451688,used: 7:59:00.472218,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.84725493, 'precision': 0.74973416, 'recall': 0.58707714, 'specificity': 0.98232347, 'f1': 0.6322619, 'auroc': 0.9728631}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   164     6   0    45   0    0    87    57    10    8    106
1     0  1088   1    16   0    0     3   209     5    1      9
2     6     0  75    32  16    2    42    27    19   59     34
3     1     6   0  7530   1   21    29   561   249    4     35
4     1     0  19    27  55    0    69    25    50    8    285
5     4     0   3   205   1  188     4     2    16   95      3
6     6    13   1    32   3    3  1473    45    39    8    283
7     5    34   4   568   7    1    16  6392    91    2    145
8     2     4   1   441   0    7    44   215  2125    4    453
9     6     0  24   113   5   49    32    18    19  218      9
10    1     2   0    42  13    1    83   146   141    4  12359
---- Validation: 
scalar performance:
{'acc': 0.8472917, 'precision': 0.75155896, 'recall': 0.5897342, 'specificity': 0.9823117, 'f1': 0.6356137, 'auroc': 0.97465944}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   176     7   0    45   0    0    84    57    11    2    101
1     0  1083   1    14   0    0     2   215     5    0     12
2     5     0  79    27  18    3    40    38    15   53     34
3     4     0   1  7527   1   24    18   581   246    0     38
4     1     0  13    29  55    1    68    22    53   14    283
5     8     0   2   200   0  193     4     4    20   88      2
6    12    10   0    30   2    4  1484    42    46    2    276
7     4    33   0   569   1    1    26  6367    91    5    168
8     0     1   4   427   4    4    43   224  2125    7    457
9    11     0  25   118   3   54    33    18    12  210      9
10    6     3   2    41  11    1    99   120   134    2  12377
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37605822, 'precision': 0.45263386, 'recall': 0.31128985, 'specificity': 0.9360713, 'f1': 0.26368457, 'auroc': 0.81521493}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   442   44   0   20   0   1   327   283    2   0    51
1     1  523   0   18   0   0    28   882    1   0    46
2     7    3   0   33   1   0   156   282   16   0   517
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    24    3   0  1600
5    46    3   0  292   0  12   127    75   12   6    19
6     1    4   0   14   0   0  1172    81   21   0  1774
7     2   27   0   10   0   0    20  1091    0   0    14
8     2    2   0  124   1   0   197   164  494   1   385
9    30   11   1  147   0   1   270   550    5   1   121
10    0    0   0    1   0   0     4     2    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-22 09:24:31.822149,epoch time: 0:24:09.735619,used: 8:23:10.207837,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8491813, 'precision': 0.7542775, 'recall': 0.5938025, 'specificity': 0.98256713, 'f1': 0.64009726, 'auroc': 0.973856}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   183     6   1    50   1    1    60    62    11    5    102
1     0  1105   0    15   0    1     2   190     6    1     12
2     5     0  64    33  25    6    29    34    21   54     41
3     2     5   0  7577   0   32    10   473   303    2     34
4     1     0  15    33  78    0    54    20    52   10    276
5     5     1   2   195   1  212     5     0    12   84      4
6     9    16   0    37   5    2  1450    41    50    4    294
7     3    60   1   606   3    2    12  6308   120    2    147
8     4     1   1   406   2    3    29   221  2199    4    425
9    12     2  13   114   1   74    23    16    21  200     17
10    4     2   0    34  16    1    75   115   178    4  12363
---- Validation: 
scalar performance:
{'acc': 0.8487361, 'precision': 0.74856544, 'recall': 0.59372365, 'specificity': 0.98248816, 'f1': 0.64010406, 'auroc': 0.97413915}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   177     7   0    44   1    2    83    59     3    4    103
1     1  1107   0    21   0    0     3   180     8    0     12
2     3     0  70    35  27    8    31    31    16   59     32
3     1     3   0  7605   1   22    15   488   272    2     31
4     0     1  13    31  71    1    59    22    54   11    276
5     7     1   3   200   2  215    10     3    13   65      2
6    12    17   0    36   1    3  1441    38    48    2    310
7     2    43   3   630   8    6    24  6282   110    1    156
8     1     1   0   380   2   13    26   216  2211    3    443
9     9     1  18   116   7   70    23    13    19  201     16
10    9     1   2    50  17    1    73   117   174    2  12350
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38564333, 'precision': 0.43887675, 'recall': 0.3229442, 'specificity': 0.9372111, 'f1': 0.27716994, 'auroc': 0.816287}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   451   81   0   26   0   1   297   257    4   0    53
1     1  703   0   22   0   0    21   706    1   0    45
2     6   10   0   38   2   0   134   273   19   0   533
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     4    23    4   0  1601
5    47    6   0  307   0  14   105    67   19   5    22
6     3    7   0   17   0   0  1075    86   32   0  1847
7     2   47   0   16   0   0    15  1070    0   0    14
8     1    9   0  125   1   0   156   146  558   1   373
9    36   23   1  180   0   2   234   525    7   1   128
10    0    0   0    1   0   0     4     2    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-22 09:48:30.329631,epoch time: 0:23:58.507482,used: 8:47:08.715319,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.85217786, 'precision': 0.74691623, 'recall': 0.60826284, 'specificity': 0.98288995, 'f1': 0.6534064, 'auroc': 0.9758457}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   204     6   0    52   0    0    64    57     5    2     93
1     1  1108   0    16   0    0     5   186     4    0     11
2     6     1  97    29  24    6    28    36    11   32     42
3     6     4   0  7560   1   26    14   546   239    2     42
4     0     1  25    18  82    5    56    25    47    6    274
5     7     0   5   183   2  246     6     2    15   53      2
6    17    19   1    29   3    6  1477    38    38    4    276
7     4    51   1   537   5    4    13  6419    74    2    153
8     2     1   5   424   8    9    42   242  2120    2    441
9    13     2  38   105   3   97    22    24    17  166      6
10    9     4   2    49  16    3    80   124   130    1  12372
---- Validation: 
scalar performance:
{'acc': 0.85055506, 'precision': 0.7436186, 'recall': 0.60569584, 'specificity': 0.9826639, 'f1': 0.6505592, 'auroc': 0.97480804}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   198     4   0    53   1    2    58    56     4    2    105
1     0  1126   0    17   0    0     1   172     5    0     11
2     5     0  96    31  31   19    23    32    12   35     28
3     3     4   0  7578   4   33    10   553   224    4     27
4     2     0  21    28  75    4    61    22    49    7    270
5     5     0   6   178   1  254     4     2     9   60      2
6    20    17   1    31   3    5  1439    39    41    3    309
7     7    45   1   566   6    4    16  6362    97    1    160
8     2     2   0   439   5   10    28   246  2109    3    452
9    13     2  35   115   4   95    25    12    10  166     16
10    6     7   1    44  12    3    69   130   128    1  12395
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.39417896, 'precision': 0.44527492, 'recall': 0.32972908, 'specificity': 0.9381355, 'f1': 0.28339827, 'auroc': 0.8181331}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   534   85   0   21   0   1   250   230    2   0    47
1     2  741   0   21   0   0    19   674    1   0    41
2    12   11   0   41   2   0   136   285   13   0   515
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     4    26    3   0  1599
5    68    6   0  298   0  20    99    67   13   2    19
6     6    8   0   17   0   0  1145    94   21   0  1776
7     2   52   0   11   0   0    15  1071    0   0    13
8     5   10   0  145   3   0   177   156  482   1   391
9    64   27   1  168   0   2   215   535    6   1   118
10    0    0   0    1   0   0     4     2    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-22 10:12:33.013320,epoch time: 0:24:02.683689,used: 9:11:11.399008,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8530608, 'precision': 0.7634891, 'recall': 0.61197317, 'specificity': 0.9830319, 'f1': 0.65692055, 'auroc': 0.9754567}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   178     5    1    46   0    1    83    66     7    5     91
1     1  1098    0    17   0    0     0   199     7    0     10
2     3     2  122    25   9    8    20    37    14   34     38
3     3     5    2  7565   1   31    12   539   254    2     25
4     0     0   30    32  68    3    49    27    44   10    276
5     4     2    7   189   2  227     3     0    18   66      2
6    11    15    0    33   2    4  1496    34    39    4    270
7     2    37    6   548   5    6    17  6397    85    2    156
8     1     0    6   423   1    8    41   245  2183    3    385
9    11     1   41   112   1   71    25    14    11  195     11
10    0     1    2    46  13    1    96   125   150    4  12355
---- Validation: 
scalar performance:
{'acc': 0.85181224, 'precision': 0.75970495, 'recall': 0.612858, 'specificity': 0.9829077, 'f1': 0.65862036, 'auroc': 0.9751185}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   181     9    2    45   0    1    77    51     8    5    104
1     0  1111    0    16   0    0     2   184     6    2     11
2     2     1  118    25  15    7    21    32    15   37     39
3     2     3    1  7497   2   21    10   587   274    3     40
4     1     1   38    26  78    1    56    20    55    6    257
5     5     0    3   189   1  231     7     5    13   61      6
6    11     5    1    31   0    4  1486    54    42    4    270
7     2    29    2   550   6    4    15  6417   100    4    136
8     3     1    4   412   5   10    34   237  2187    5    398
9    13     1   38    92   4   79    28    19    13  191     15
10    3     3    0    39  12    0    99   122   167    3  12348
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3937592, 'precision': 0.4906419, 'recall': 0.32473546, 'specificity': 0.937957, 'f1': 0.2795154, 'auroc': 0.8192617}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   445   64   0   25   0   1   311   275    2   0    47
1     1  653   0   21   0   0    22   759    1   0    42
2     6    8   2   38   1   0   157   288   17   0   498
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    27    3   0  1597
5    45    5   0  301   0  19   118    69   13   3    19
6     2    7   0   15   0   0  1261    88   25   0  1669
7     1   34   0   11   0   0    16  1089    0   0    13
8     2    5   0  134   2   0   191   156  518   1   361
9    33   18   3  169   0   2   252   536    6   1   117
10    0    0   0    1   0   0     4     2    0   0  1639
better model found
persisted
after epoch: 24,now: 2024-07-22 10:37:00.682959,epoch time: 0:24:27.669639,used: 9:35:39.068647,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.85308754, 'precision': 0.7433557, 'recall': 0.60677695, 'specificity': 0.9831077, 'f1': 0.6496673, 'auroc': 0.97554207}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   187     3    1    47   1    1    66    57     8    3    109
1     0  1098    0    13   0    0     4   197     9    0     11
2     7     0  107    24  20    5    24    29    13   49     34
3     3     4    2  7550   1   27    16   509   283    4     36
4     0     1   27    23  69    1    62    23    54   11    267
5     6     0    3   205   0  196     7     1    15   82      6
6    14     9    0    27   1    3  1489    44    47    5    269
7     3    40    5   561   4    4    19  6355   123    7    144
8     2     1    3   378   8    8    32   191  2287    4    382
9    11     1   44   101   4   68    25    11    19  200      8
10    6     4    2    36  13    1    88   110   185    2  12347
---- Validation: 
scalar performance:
{'acc': 0.8552628, 'precision': 0.76515007, 'recall': 0.62182915, 'specificity': 0.98336196, 'f1': 0.66659355, 'auroc': 0.97589684}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   200     5    0    36   0    0    73    57    10    5     97
1     0  1116    1    12   0    0     2   184     8    0      9
2     3     0  115    18  19    9    21    29    17   39     42
3     2     2    3  7506   1   35    17   527   308    4     35
4     1     1   34    28  81    2    43    20    53   11    265
5     5     0    0   187   0  219     7     2    19   79      3
6     8    17    1    27   2    4  1490    45    57    2    255
7     5    36    2   521   1    1    17  6372   143    4    163
8     1     1    4   364   8    6    33   197  2308    3    371
9     6     0   43   108   2   55    30    12    11  215     11
10    5     5    3    37  10    0    79   111   193    1  12352
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.39984608, 'precision': 0.4546568, 'recall': 0.32912928, 'specificity': 0.9384781, 'f1': 0.2845792, 'auroc': 0.8201795}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   460   52   0   26   0   1   320   253    5   0    53
1     1  652   0   21   0   0    26   754    1   0    44
2     5    6   1   37   2   0   161   265   19   0   519
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    22    4   0  1601
5    44    3   0  298   0  15   126    61   18   7    20
6     2    7   0   14   0   0  1291    76   27   0  1650
7     2   31   0   14   0   0    20  1083    0   0    14
8     0    2   0  117   4   0   192   137  571   1   346
9    32   16   4  168   0   2   280   493    8   1   133
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-22 11:01:46.614077,epoch time: 0:24:45.931118,used: 10:00:24.999765,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.8545323, 'precision': 0.7729466, 'recall': 0.61633885, 'specificity': 0.9830829, 'f1': 0.6660802, 'auroc': 0.9761249}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   183     9   1    37    1    0    75    68     3    4    102
1     0  1110   0    16    0    0     2   188     6    1      9
2     0     1  89    28   30    1    22    37     7   53     44
3     3     4   0  7582    2   21    11   565   223    3     25
4     1     0  26    34  108    1    43    27    38    9    252
5     3     0   4   179    1  216     3     2    12   99      2
6    11    10   1    32    3    1  1468    52    29    6    295
7     4    42   0   486    3    3    12  6466    84    3    159
8     1     3   1   412   10    8    31   258  2090    6    474
9     4     0  25   103    1   49    14    24    10  250     13
10    5     4   2    43   14    0    79   134   130    5  12377
---- Validation: 
scalar performance:
{'acc': 0.85590476, 'precision': 0.7693268, 'recall': 0.61398923, 'specificity': 0.9832904, 'f1': 0.6623721, 'auroc': 0.9754305}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   169     6   0    46   2    1    82    61     3    7    106
1     0  1121   0    18   0    0     2   179     5    0      7
2     2     0  99    27  29    6    24    28     7   61     29
3     1     2   0  7572   2   34     8   591   196    2     32
4     1     0  18    30  99    2    43    22    44   17    263
5     3     0   1   189   1  211     5     1    11   98      1
6     9    14   0    34   4    4  1468    44    37   10    284
7     1    30   0   478   9    2    14  6509    80    6    136
8     1     0   2   431  10    9    31   271  2092    8    441
9     7     2  17    98   6   63    20    16    12  241     11
10    2     1   0    42  18    2    65   126   116    7  12417
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38739243, 'precision': 0.43677706, 'recall': 0.3190099, 'specificity': 0.9374026, 'f1': 0.27280366, 'auroc': 0.82005894}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   413   67   0   31   0   2   302   301    1   0    53
1     1  673   0   19   0   0    21   743    1   0    41
2     4    8   0   38   5   0   138   299   11   0   512
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     4    28    2   0  1598
5    38    4   0  310   0  14   109    73   11  11    22
6     0    7   0   16   0   0  1229    94   17   0  1704
7     0   35   0   10   0   0    12  1095    0   0    12
8     1    6   0  143   4   0   184   171  470   1   390
9    27   20   1  167   0   2   226   562    5   3   124
10    0    0   0    1   0   0     4     2    0   0  1639
better model found
persisted
after epoch: 26,now: 2024-07-22 11:27:41.209026,epoch time: 0:25:54.594949,used: 10:26:19.594714,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.8548534, 'precision': 0.7601746, 'recall': 0.6115371, 'specificity': 0.98326284, 'f1': 0.65803707, 'auroc': 0.97639036}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   195     3   0    53   0    2    69    50     4    5    101
1     0  1110   0    13   0    0     9   186     2    0     12
2     7     0  89    29  18    7    26    36    14   46     40
3     2     2   0  7552   2   33    23   539   249    2     33
4     0     1  18    28  84    0    55    21    46   13    272
5     8     0   4   191   1  214     9     0    14   79      1
6    11     8   0    28   3    4  1514    42    39    5    253
7     2    31   1   515   5    4    27  6429   113    4    133
8     0     1   1   397   6    6    43   214  2208    2    418
9    11     2  27   100   7   59    33    17    17  211      9
10    5     2   3    40  15    0    96   117   170    1  12345
---- Validation: 
scalar performance:
{'acc': 0.85836565, 'precision': 0.7750885, 'recall': 0.6207549, 'specificity': 0.9836453, 'f1': 0.66910005, 'auroc': 0.97736204}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   198     8   0    40   0    0    84    45     7    3     98
1     0  1119   0    15   0    0     2   176     6    0     14
2     4     0  97    27  19    7    27    35    15   45     36
3     2     2   1  7573   1   17    22   540   250    3     29
4     0     0  19    24  89    0    59    18    45   10    275
5     5     1   2   176   1  244     6     5    20   60      1
6    12     9   1    26   0    4  1524    47    40    2    243
7     6    35   3   519   4    2    22  6444    97    1    132
8     0     2   1   394   6   10    47   209  2212    4    411
9    11     0  31   107   5   61    31    14    14  203     16
10    2     0   1    37  12    2    89   109   153    4  12387
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.41250962, 'precision': 0.46516705, 'recall': 0.33312863, 'specificity': 0.93962383, 'f1': 0.28828958, 'auroc': 0.8227204}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   482   48   0   27   0   1   344   225    2   0    41
1     1  641   0   20   0   0    30   763    1   0    43
2     6    5   0   39   1   0   201   260   17   0   486
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     8    23    4   0  1597
5    47    3   0  299   0  14   138    57   13   1    20
6     2    5   0   14   0   0  1515    76   23   0  1432
7     2   28   0   15   0   0    22  1083    0   0    14
8     0    2   0  130   3   0   232   143  520   1   339
9    34   13   1  164   0   2   321   478    6   1   117
10    0    0   0    1   0   0     5     1    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-22 11:53:02.229654,epoch time: 0:25:21.020628,used: 10:51:40.615342,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8590807, 'precision': 0.7595271, 'recall': 0.6221362, 'specificity': 0.983925, 'f1': 0.66614044, 'auroc': 0.9770125}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   197     7   2    33   1    1    81    64     4    3     89
1     1  1105   0    12   0    0     3   198     3    0     10
2     3     1  88    22  25    9    37    38    14   41     34
3     4     3   2  7420   1   31    13   642   293    4     27
4     1     1  24    29  98    0    58    25    58    7    238
5     3     0   5   171   1  255     1     4    13   65      3
6    10     9   0    20   1    7  1546    48    51    1    213
7     1    28   2   402   9    5    27  6579   100    2    108
8     3     2   1   329   7    7    35   255  2295    4    358
9     8     0  32    90   4   88    32    12    25  195      7
10    3     3   0    41  16    2    99   139   152    6  12331
---- Validation: 
scalar performance:
{'acc': 0.8567875, 'precision': 0.76514435, 'recall': 0.62291044, 'specificity': 0.98361593, 'f1': 0.6681541, 'auroc': 0.9761041}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   193     2   0    45    0    1    67    73     6    2     94
1     1  1098   0    16    0    0     3   202     5    0      7
2     6     0  92    28   20    6    26    41    14   47     32
3     2     3   1  7402    2   32    21   674   273    4     26
4     1     0  19    27  106    2    51    26    54    9    244
5     4     0   3   164    0  255     5     4    16   67      3
6     8    13   0    25    4    4  1545    44    42    5    218
7     6    30   2   419    1    3    20  6554   107    2    121
8     3     1   6   324    9   14    28   254  2276    5    376
9     7     0  28    77    1   95    28    25    21  200     11
10    4     0   0    34   18    4    94   156   174    2  12310
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.41334918, 'precision': 0.47389245, 'recall': 0.3330045, 'specificity': 0.9397366, 'f1': 0.28754288, 'auroc': 0.8239335}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   421   45   0   20   0   2   354   287    3   0    38
1     1  611   0   18   0   0    27   803    1   0    38
2     3    6   0   29   1   0   196   301   17   0   462
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   2   0    11    31    3   0  1586
5    41    3   0  282   0  23   135    72   15   2    19
6     1    5   0   14   0   0  1553    92   26   0  1376
7     0   25   0   10   0   0    19  1099    0   0    11
8     0    2   0  114   3   0   221   159  562   1   308
9    22   12   1  139   0   2   302   547    6   1   105
10    0    0   0    1   0   0     5     4    0   0  1636
new oracle model saved
early stop counter: 1
val acc:0.8567875027656555, best validation acc: 0.8583656549453735, corresponding to test acc:                         0.41250962018966675 / 0.4133491814136505
after epoch: 28,now: 2024-07-22 12:17:43.192336,epoch time: 0:24:40.962682,used: 11:16:21.578024,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.85696703, 'precision': 0.77163345, 'recall': 0.6217191, 'specificity': 0.98342705, 'f1': 0.66885036, 'auroc': 0.9767238}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   185     5    0    46   1    2    69    52     5    3    115
1     2  1115    0    18   0    0     4   177     5    0     11
2     4     0  126    26  14    6    16    35    12   37     36
3     3     4    0  7601   1   26    13   520   239    2     28
4     1     0   37    31  87    2    47    19    43    9    263
5     4     1    6   186   1  227     7     2    11   72      4
6     9    13    0    28   3    2  1493    38    41    3    277
7     2    33    3   532   4    3    20  6410   116    4    137
8     1     0    3   409   5   11    30   234  2180    7    414
9     8     1   40   108   2   63    22    14    14  207     13
10    2     2    4    41  11    1    73   125   130    7  12399
---- Validation: 
scalar performance:
{'acc': 0.8576702, 'precision': 0.7739054, 'recall': 0.6225494, 'specificity': 0.9835003, 'f1': 0.66971207, 'auroc': 0.97665226}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   197     4    1    48   0    0    74    55     5    3     96
1     1  1106    0    16   0    0     1   188     8    1     11
2     1     1  121    23  12    9    19    37    14   40     35
3     2     3    2  7596   0   24    14   512   262    2     23
4     1     2   30    27  78    0    47    22    40   10    282
5     5     0    7   181   0  241     2     1    11   70      3
6    15     9    0    31   1    3  1483    45    47    5    269
7     2    33    2   523   4    4     9  6451    87    1    149
8     2     2    3   402   6    8    23   226  2201    2    421
9     6     1   46   107   2   67    20    14    12  204     14
10    1     4    3    36  12    1    76   126   147    4  12386
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40005597, 'precision': 0.44773084, 'recall': 0.32713145, 'specificity': 0.9386649, 'f1': 0.28315467, 'auroc': 0.82251984}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   440   48   0   38   0   2   314   273    3   0    52
1     1  647   0   21   0   0    24   763    1   0    42
2     5    6   0   44   1   0   145   273   18   0   523
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     4    24    3   0  1601
5    37    3   0  328   0  15   110    57   15   5    22
6     0    5   0   17   0   0  1348    84   23   0  1590
7     0   25   0   17   0   0    16  1093    0   0    13
8     0    2   0  140   3   0   185   149  533   1   357
9    24   12   1  193   0   2   253   504    6   1   141
10    0    0   0    1   0   0     4     1    0   0  1640
early stop counter: 2
val acc:0.8576701879501343, best validation acc: 0.8583656549453735, corresponding to test acc:                         0.41250962018966675 / 0.4133491814136505
after epoch: 29,now: 2024-07-22 12:42:38.576036,epoch time: 0:24:55.383700,used: 11:41:16.961724,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8595355, 'precision': 0.7713441, 'recall': 0.6300716, 'specificity': 0.98375005, 'f1': 0.67506456, 'auroc': 0.9769858}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   224     6   0    39   1    1    58    56     3    4     91
1     2  1117   0    14   0    0     2   182     5    0     10
2    10     1  86    21  18    5    21    39    14   60     37
3     3     1   0  7464   2   30    16   622   260    1     38
4     1     1  17    26  91    1    47    27    43   13    272
5    11     0   1   148   1  254     6     3    12   83      2
6    12    11   0    25   4    1  1499    46    29    8    272
7     4    29   1   428   3    1    20  6553    82    1    141
8     6     1   1   357   8    8    30   264  2191    7    422
9    13     1  21    84   5   71    17    14    14  241     12
10    9     2   2    29  11    5    73   132   125    0  12406
---- Validation: 
scalar performance:
{'acc': 0.85758996, 'precision': 0.7664023, 'recall': 0.62599087, 'specificity': 0.98347807, 'f1': 0.67287344, 'auroc': 0.9773864}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   219     6   1    36   1    0    44    59     8    5    104
1     0  1091   0    10   0    0     5   205     5    0     16
2     5     0  94    21  22    3    19    43     7   53     45
3     2     2   3  7493   1   31    17   629   225    3     34
4     3     4  21    24  95    2    40    17    48   12    273
5     4     1   3   165   1  239     6     3    11   84      4
6    21     7   0    30   3    4  1494    48    35    3    263
7     3    31   2   436   2    3    10  6519    96    4    159
8     1     1   1   345   7   15    38   260  2179    4    445
9    13     2  28    91   7   60    14    13    17  236     12
10    7     2   2    33  16    0    78   133   118    5  12402
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4125796, 'precision': 0.44080156, 'recall': 0.33943105, 'specificity': 0.9398825, 'f1': 0.29358494, 'auroc': 0.8240766}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   576   44   0   23   0   1   255   223    2   0    46
1     1  659   0   18   0   0    25   753    1   0    42
2    16    5   0   29   2   0   153   280   14   0   516
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    24    2   0  1601
5    74    3   0  274   0  24   110    63   12  10    22
6     5    5   0   14   0   0  1399    86   18   0  1540
7     2   27   0   10   0   0    16  1096    0   0    13
8     4    2   0  122   4   0   198   160  501   1   378
9    76   14   1  145   0   2   240   514    6   1   138
10    0    0   0    1   0   0     4     1    0   0  1640
early stop counter: 3
val acc:0.8575899600982666, best validation acc: 0.8583656549453735, corresponding to test acc:                         0.41250962018966675 / 0.4133491814136505
after epoch: 30,now: 2024-07-22 13:09:20.564907,epoch time: 0:26:41.988871,used: 12:07:58.950595,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:07:58.950595 at 2024-07-22 13:09:20.564907
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.41250962, 'precision': 0.46516705, 'recall': 0.33312863, 'specificity': 0.93962383, 'f1': 0.28828958, 'auroc': 0.8227204}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   482   48   0   27   0   1   344   225    2   0    41
1     1  641   0   20   0   0    30   763    1   0    43
2     6    5   0   39   1   0   201   260   17   0   486
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     8    23    4   0  1597
5    47    3   0  299   0  14   138    57   13   1    20
6     2    5   0   14   0   0  1515    76   23   0  1432
7     2   28   0   15   0   0    22  1083    0   0    14
8     0    2   0  130   3   0   232   143  520   1   339
9    34   13   1  164   0   2   321   478    6   1   117
10    0    0   0    1   0   0     5     1    0   0  1639
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.41334918, 'precision': 0.47389245, 'recall': 0.3330045, 'specificity': 0.9397366, 'f1': 0.28754288, 'auroc': 0.8239335}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   421   45   0   20   0   2   354   287    3   0    38
1     1  611   0   18   0   0    27   803    1   0    38
2     3    6   0   29   1   0   196   301   17   0   462
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   2   0    11    31    3   0  1586
5    41    3   0  282   0  23   135    72   15   2    19
6     1    5   0   14   0   0  1553    92   26   0  1376
7     0   25   0   10   0   0    19  1099    0   0    11
8     0    2   0  114   3   0   221   159  562   1   308
9    22   12   1  139   0   2   302   547    6   1   105
10    0    0   0    1   0   0     5     4    0   0  1636
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_01_01_21_seed_2_22562328_instance_wise_predictions.txt
accuracy from prediction file 0.4125096200937522
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192535 KiB | 464389 KiB |   1753 TiB |   1753 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1717 TiB |   1717 TiB |
|       from small pool |  19041 KiB |  39751 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 192535 KiB | 464389 KiB |   1753 TiB |   1753 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1717 TiB |   1717 TiB |
|       from small pool |  19041 KiB |  39751 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 190583 KiB | 459649 KiB |   1753 TiB |   1753 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1717 TiB |   1717 TiB |
|       from small pool |  17769 KiB |  37832 KiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 528384 KiB | 528384 KiB |   1082 MiB | 579584 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  40960 KiB |  40960 KiB |     68 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38888 KiB |  86670 KiB |   1064 TiB |   1064 TiB |
|       from large pool |  31306 KiB |  79555 KiB |   1027 TiB |   1027 TiB |
|       from small pool |   7582 KiB |  21843 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4034    |    6277    |  348975 K  |  348971 K  |
|       from large pool |      76    |     158    |  173376 K  |  173376 K  |
|       from small pool |    3958    |    6126    |  175599 K  |  175595 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4034    |    6277    |  348975 K  |  348971 K  |
|       from large pool |      76    |     158    |  173376 K  |  173376 K  |
|       from small pool |    3958    |    6126    |  175599 K  |  175595 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      79    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      20    |      20    |      34    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |    1268    |  199715 K  |  199715 K  |
|       from large pool |      10    |      22    |  113626 K  |  113626 K  |
|       from small pool |      15    |    1259    |   86089 K  |   86089 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB |   1753 TiB |   1753 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1717 TiB |   1717 TiB |
|       from small pool |      0 KiB |  39751 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB |   1753 TiB |   1753 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1717 TiB |   1717 TiB |
|       from small pool |      0 KiB |  39751 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB |   1753 TiB |   1753 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1717 TiB |   1717 TiB |
|       from small pool |      0 KiB |  37832 KiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 528384 KiB |   1082 MiB |    856 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  26624 KiB |  40960 KiB |     68 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  86670 KiB |   1064 TiB |   1064 TiB |
|       from large pool |  23872 KiB |  79555 KiB |   1027 TiB |   1027 TiB |
|       from small pool |      0 KiB |  21843 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  348975 K  |  348975 K  |
|       from large pool |       2    |     158    |  173376 K  |  173376 K  |
|       from small pool |       0    |    6126    |  175599 K  |  175599 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  348975 K  |  348975 K  |
|       from large pool |       2    |     158    |  173376 K  |  173376 K  |
|       from small pool |       0    |    6126    |  175599 K  |  175599 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      79    |      56    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      13    |      20    |      34    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1268    |  199716 K  |  199716 K  |
|       from large pool |       3    |      22    |  113626 K  |  113626 K  |
|       from small pool |       0    |    1259    |   86090 K  |   86090 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 22 13:31:51 2024]
Finished job 0.
1 of 1 steps (100%) done
