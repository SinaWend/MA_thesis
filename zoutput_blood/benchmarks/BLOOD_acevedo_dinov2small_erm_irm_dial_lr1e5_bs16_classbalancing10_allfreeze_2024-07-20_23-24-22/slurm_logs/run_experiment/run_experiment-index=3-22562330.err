Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 23:26:48 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330

 Experiment start at: 2024-07-20 23:54:31.129057
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.61435145, 'precision': 0.35962462, 'recall': 0.21406859, 'specificity': 0.95131326, 'f1': 0.19230364, 'auroc': 0.78143483}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    50   0   0   2   139   1   0    291
1    0   8   0   144   0   0   2   769   2   0    407
2    0   1   0    63   0   0   0    45   3   0    200
3    0   2   0  5870   0   0   4  1722  55   0    784
4    0   0   0    68   0   0   0    21   6   0    444
5    0   1   0   344   0   0   1    31   3   0    141
6    0   0   0   154   0   0  30   148  16   0   1560
7    0   4   0  1401   0   0   6  4852  20   0    982
8    0   0   0   870   0   0  10   283  60   0   2072
9    0   0   0   215   0   0   2    56   5   1    214
10   0   0   0   279   0   0  30   297  44   0  12141
---- Validation: 
scalar performance:
{'acc': 0.6154072, 'precision': 0.2831826, 'recall': 0.21466397, 'specificity': 0.9514263, 'f1': 0.19356665, 'auroc': 0.7798635}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    41   0   0   4   128   4   0    306
1    0  14   0   146   0   0   3   779   2   0    388
2    0   0   0    58   0   0   0    52   4   0    198
3    0   3   0  5898   0   0   2  1676  68   0    793
4    0   0   0    74   0   0   4    23   3   0    435
5    0   1   0   341   0   0   2    34   6   0    137
6    0   0   0   132   0   0  33   147  22   0   1574
7    0   2   0  1446   0   0   5  4818  23   0    971
8    0   0   0   812   0   0  11   302  65   0   2106
9    0   1   0   209   0   0   3    50   3   0    227
10   0   0   0   269   0   2  26   265  55   0  12179
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19086266, 'precision': 0.03797523, 'recall': 0.1756655, 'specificity': 0.91788304, 'f1': 0.061991032, 'auroc': 0.60867286}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   0   0   1   0   0   0   673   0   0   496
1    0   0   0  14   0   0   0  1264   0   0   221
2    0   0   0  30   0   0   0   236   0   0   749
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    27   0   0  1606
5    0   0   0  44   0   0   0   244   0   0   304
6    0   0   0   4   0   0   0    98   0   0  2965
7    0   0   0   3   0   0   0  1093   0   0    68
8    0   0   0  23   0   0   0   164   0   0  1183
9    0   0   0  60   0   0   0   565   1   0   511
10   0   0   0   0   0   0   0    11   0   0  1635
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 00:27:59.085671,epoch time: 0:33:27.956614,used: 0:33:27.956614,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.67321277, 'precision': 0.45621052, 'recall': 0.26325825, 'specificity': 0.9590173, 'f1': 0.25979573, 'auroc': 0.8864195}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    5   0    78   0   0    9   120    2   0    269
1    0  348   0    75   0   0    1   718    1   0    189
2    0    5   0    91   0   1    4    37    7   0    167
3    0   10   0  6800   0   0    3  1242   74   0    309
4    0    1   0    77   0   0    2     7    4   0    448
5    0    4   0   431   0   0   14    12    6   0     54
6    0    8   0   139   0   0  148    92   16   0   1505
7    0   35   0  1411   0   0    3  5223   16   0    574
8    0    1   0   931   0   0    2   250  185   0   1926
9    0   10   0   299   0   0    9    31    5   1    138
10   0    3   0   163   0   0   23   111   36   0  12457
---- Validation: 
scalar performance:
{'acc': 0.6728367, 'precision': 0.45221072, 'recall': 0.26363623, 'specificity': 0.95892966, 'f1': 0.26010668, 'auroc': 0.8863306}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    4   0    64   0   0   10   116    2   0    287
1    0  368   0    69   0   0    4   710    1   0    180
2    0    7   0    91   0   0    3    38    2   0    171
3    0    7   0  6833   0   0    1  1222   68   0    309
4    0    1   0    73   0   0    4    12    4   0    445
5    0    3   0   413   0   1   17    17    7   1     62
6    0    8   0   136   0   0  145    98   21   0   1500
7    0   27   0  1423   0   0    6  5190   19   0    600
8    0    1   0   968   0   0    4   215  159   0   1949
9    0    9   0   287   0   0   18    34    7   0    138
10   0    0   0   183   0   0   22   107   26   0  12458
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19415098, 'precision': 0.03737017, 'recall': 0.1791304, 'specificity': 0.91838586, 'f1': 0.061658226, 'auroc': 0.68918353}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   0   0   3   0   0   0   726   0   0   441
1    0   0   0  12   0   0   0  1344   0   0   143
2    0   0   0  22   0   0   0   284   0   0   709
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    19   0   0  1614
5    0   0   0  80   0   0   0   315   0   0   197
6    0   0   0   7   0   0   0   127   0   0  2933
7    0   0   0   3   0   0   0  1131   0   0    30
8    0   0   0  42   0   0   0   205   0   0  1123
9    0   0   0  63   0   0   0   719   1   0   354
10   0   0   0   0   0   0   0     2   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 01:00:40.308016,epoch time: 0:32:41.222345,used: 1:06:09.178959,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.71476346, 'precision': 0.5810586, 'recall': 0.31528103, 'specificity': 0.96470946, 'f1': 0.32630658, 'auroc': 0.9218584}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    7   0    60   0   0   42   131    1   0    242
1    0  602   0    32   0   0    6   595    0   1     96
2    0    6   1    82   0   0   16    61   13   1    131
3    0    7   0  6967   0   0   11  1123  163   0    168
4    0    1   0    64   0   0   13    11   13   0    437
5    0    3   0   424   1   3   33    13   12   3     29
6    0    9   0   108   0   0  496    85   24   0   1186
7    0   38   0  1115   0   0    9  5653   46   0    401
8    0    0   0   839   0   0   19   278  523   0   1635
9    0    7   0   291   0   2   51    42   15   5     80
10   0    0   0   129   0   0   55   112   33   0  12465
---- Validation: 
scalar performance:
{'acc': 0.7118096, 'precision': 0.48668417, 'recall': 0.31359315, 'specificity': 0.9643934, 'f1': 0.32436177, 'auroc': 0.92221725}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   11   0    63   0   0   31   146    3   0    229
1    0  596   0    37   0   0    3   602    1   0     93
2    0    6   0    82   0   0   20    63    8   1    132
3    0   14   0  6908   0   0   14  1182  154   0    168
4    0    1   0    62   0   0   14    13   15   1    433
5    0    1   0   418   0   2   41    12   14   3     30
6    0   12   0   109   0   0  482    92   27   0   1186
7    0   35   0  1154   0   0    5  5625   35   0    411
8    0    3   0   842   0   0   12   274  548   0   1617
9    0   10   0   293   0   2   62    30   10   7     79
10   0    1   0   132   0   0   51   125   44   0  12443
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19527042, 'precision': 0.11446115, 'recall': 0.18017595, 'specificity': 0.9185947, 'f1': 0.06175436, 'auroc': 0.72410405}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   3   0    3   0   0  10   781   1   0   372
1    0   4   0    6   0   0   1  1387   0   0   101
2    0   0   0   14   0   0   1   330   0   0   670
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    22   0   0  1611
5    0   1   0  101   0   0   1   352   0   0   137
6    0   0   0    5   0   0   3   165   0   0  2894
7    0   1   0    2   0   0   0  1140   0   0    21
8    0   0   0   51   0   0   2   266   1   0  1050
9    0   2   0   58   0   0   1   818   1   0   257
10   0   0   0    0   0   0   0     3   0   0  1643
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 01:32:58.654137,epoch time: 0:32:18.346121,used: 1:38:27.525080,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7448898, 'precision': 0.5277363, 'recall': 0.36043218, 'specificity': 0.9686577, 'f1': 0.37848848, 'auroc': 0.93771315}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    7   0    79   0   0   54   121    4   0    218
1    0  829   0    32   0   0    1   407    2   0     61
2    0   10   0    81   0   2   26    48   23   2    120
3    0    6   0  7203   0   4    9   899  202   0    116
4    0    1   0    58   0   0   20    16   22   0    422
5    0    3   0   405   0  24   39     6   21   6     17
6    0   15   0    95   0   0  717    70   34   0    976
7    0   47   0  1037   0   0   11  5725   59   1    383
8    0    3   0   759   0   1   14   260  872   0   1386
9    0    8   0   271   0   7   71    36   25  20     55
10   0    3   0   126   0   0   54   115   43   0  12451
---- Validation: 
scalar performance:
{'acc': 0.74241006, 'precision': 0.5122212, 'recall': 0.35738683, 'specificity': 0.96834946, 'f1': 0.3746357, 'auroc': 0.9377696}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    9   0    81   0   0   46   123    7   0    217
1    0  826   0    24   0   0    2   404    4   0     72
2    0    9   0    87   0   2   23    60   16   1    114
3    0    5   0  7158   0   3    6   938  202   1    127
4    0    2   0    59   0   0   13    15   22   0    428
5    0    0   0   420   0  20   40     4   15   9     13
6    0   12   0    99   0   1  711    84   27   0    974
7    0   46   0  1063   0   0    9  5720   63   0    364
8    0    2   0   795   0   0   10   250  846   1   1392
9    0   11   0   292   0   9   66    35   13  17     50
10   0    7   0   119   0   0   50   114   48   1  12457
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19883859, 'precision': 0.17947772, 'recall': 0.1828622, 'specificity': 0.91894925, 'f1': 0.06812905, 'auroc': 0.7430955}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   4   0    4   0   0  36   740   1   0   385
1    0  39   0    7   0   0   1  1352   0   0   100
2    0   1   0   20   0   0   2   313   0   0   679
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    17   0   0  1616
5    0   2   0  134   0   0   6   325   2   0   123
6    0   1   0    6   0   0  15   137   0   0  2908
7    0   4   0    2   0   0   0  1137   0   0    21
8    0   0   0   74   0   0   4   252   6   0  1034
9    0   6   0   81   0   0   7   797   0   0   246
10   0   0   0    1   0   0   0     0   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 02:05:16.199917,epoch time: 0:32:17.545780,used: 2:10:45.070860,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.772073, 'precision': 0.6272779, 'recall': 0.40429133, 'specificity': 0.97247505, 'f1': 0.42432714, 'auroc': 0.94629306}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    1   11   0    73   0   0   85   122     4   0    187
1    0  955   0    20   0   0    4   304     4   0     45
2    0    8   2    77   0   1   44    53    27   8     91
3    0    9   0  7126   0   4   15   858   332   0     94
4    0    1   0    51   0   0   31    14    33   0    409
5    0    1   0   363   1  59   44     5    25  14      9
6    0   13   0    78   0   1  964    61    33   2    756
7    0   49   0   861   0   0   12  5927   104   2    308
8    0    1   0   583   0   0   23   271  1365   0   1052
9    0   10   1   243   1  26   96    33    19  28     36
10   1   10   0    80   0   0   65   111    95   1  12430
---- Validation: 
scalar performance:
{'acc': 0.76988095, 'precision': 0.63763463, 'recall': 0.4028349, 'specificity': 0.97223216, 'f1': 0.4222383, 'auroc': 0.9457845}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    3   17   0    69   0   0   86   119     5   0    184
1    0  949   0    17   0   0    5   314     4   0     43
2    0    8   1    65   1   6   38    60    28   7     98
3    0    6   0  7077   0   8   15   922   304   0    108
4    0    1   0    47   0   0   28    11    39   0    413
5    0    1   0   362   0  59   53     7    20  13      6
6    0   14   0    65   0   3  959    63    44   0    760
7    0   66   0   824   0   1    8  5943   109   1    313
8    0    2   0   582   0   1   26   283  1352   0   1050
9    0   10   2   244   0  24   95    34    20  28     36
10   0    6   0   105   0   1   78   102    92   1  12411
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2096131, 'precision': 0.29857582, 'recall': 0.19135764, 'specificity': 0.9199368, 'f1': 0.08521946, 'auroc': 0.7589186}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   7   0    3   0   0  85   737   2   0   336
1    0  93   0    5   0   0   3  1306   0   0    92
2    0   2   0   15   0   0  11   324   2   0   661
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    20   0   0  1613
5    0   3   0  133   0   1  24   324   4   0   103
6    0   1   0    5   0   0  54   144   1   0  2862
7    0  10   0    2   0   0   0  1131   0   0    21
8    0   0   0   64   0   0  14   262  72   0   958
9    0   8   0   72   0   0  25   811   2   0   219
10   0   0   0    1   0   0   0     0   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 02:37:51.252959,epoch time: 0:32:35.053042,used: 2:43:20.123902,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.782668, 'precision': 0.6396608, 'recall': 0.42247897, 'specificity': 0.97392416, 'f1': 0.4439983, 'auroc': 0.953395}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    7   0    61   0   0   120   125     2   0    168
1    0  975   0    17   0   0     7   303     4   0     26
2    0    4   2    66   3   3    57    60    17  18     82
3    0    6   0  7144   0   9    11   896   295   0     78
4    0    1   0    63   1   0    40    21    29   3    381
5    0    0   0   340   0  58    48     5    24  37      8
6    0    9   0    73   0   3  1102    72    36   1    612
7    0   55   0   738   0   0    13  6098    66   1    293
8    0    2   0   567   0   2    21   321  1388   2    992
9    0    5   0   228   0  20    91    33    19  69     28
10   0    2   0    69   0   0    95   133    75   1  12416
---- Validation: 
scalar performance:
{'acc': 0.7810352, 'precision': 0.6792405, 'recall': 0.41985092, 'specificity': 0.9737323, 'f1': 0.4412547, 'auroc': 0.9520469}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    1    7   0    66   0   1   112   110     7   0    179
1    0  953   0    17   0   0     4   328     4   1     25
2    0    7   1    67   2   1    64    59    17  16     78
3    0    7   0  7069   0   5    14   947   311   1     86
4    0    1   0    49   1   0    36    17    35   0    400
5    0    0   0   345   0  62    45     7    18  36      8
6    0   10   0    64   0   1  1122    73    34   2    602
7    0   41   0   738   0   0    21  6127    72   1    265
8    0    1   0   555   0   0    23   322  1382   0   1013
9    0    8   1   222   4  20   101    35    13  58     31
10   0    2   0    86   0   1    97   113    74   0  12423
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21597984, 'precision': 0.3083045, 'recall': 0.19487002, 'specificity': 0.9203968, 'f1': 0.09201054, 'auroc': 0.7688188}
confusion matrix:
    0    1   2    3   4   5    6     7   8   9     10
0    0    7   0    4   0   0  173   706   2   0   278
1    0  111   0    6   0   0    5  1296   0   0    81
2    0    2   0   14   0   0   23   343   1   0   632
3    0    0   0    0   0   0    0     0   0   0     0
4    0    0   0    0   0   0    1    24   0   0  1608
5    0    2   0  139   0   2   64   309   1   0    75
6    0    1   0    5   0   0  123   154   1   0  2783
7    0   10   0    2   0   0    2  1132   0   0    18
8    0    0   0   65   0   0   36   273  75   0   921
9    0    7   0   65   0   0   67   812   1   0   185
10   0    0   0    1   0   0    1     0   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 03:10:17.924397,epoch time: 0:32:26.671438,used: 3:15:46.795340,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7946543, 'precision': 0.6644832, 'recall': 0.44283843, 'specificity': 0.9754323, 'f1': 0.46756673, 'auroc': 0.95762}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    8   12   1    68   0   0   140   105     2   0    147
1    1  990   0    20   0   0     6   277     1   1     36
2    0    3  10    72   1   1    69    46    11  26     72
3    0    5   0  7383   0   7    24   715   225   3     77
4    0    1   1    48   0   1    64    16    22   5    381
5    0    0   1   339   0  80    32     5    17  44      2
6    0   12   0    58   0   2  1246    57    20   1    512
7    0   42   0   805   0   1    20  6085    47   4    259
8    0    1   1   625   0   0    41   291  1399   4    932
9    1    4   2   218   0  29   101    30    14  81     13
10   0    5   0    88   0   0   109   117    55   1  12419
---- Validation: 
scalar performance:
{'acc': 0.7926976, 'precision': 0.7025951, 'recall': 0.4420858, 'specificity': 0.9751893, 'f1': 0.46747267, 'auroc': 0.9574476}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    9     6   0    63   0   0   153   110     3   0    139
1    0  1001   0    18   0   0     4   264     3   0     42
2    0     1  11    58   3   5    62    61    15  24     72
3    0     6   0  7403   0   6    19   726   215   0     65
4    0     2   1    51   1   1    62    23    24   2    372
5    0     0   0   325   0  90    37     4    16  44      5
6    0     9   0    55   0   1  1232    70    20   4    517
7    0    42   1   809   0   0    27  6074    49   1    262
8    0     1   0   659   0   4    44   288  1324   1    975
9    0     3   3   215   1  38    98    28     9  75     23
10   0     3   0    87   0   0   114   108    66   3  12415
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22745399, 'precision': 0.31538704, 'recall': 0.20086867, 'specificity': 0.92128503, 'f1': 0.10422441, 'auroc': 0.7788419}
confusion matrix:
    0    1   2    3   4   5    6     7   8   9     10
0    0   10   0    7   0   0  301   628   1   0   223
1    0  157   0    8   0   0   12  1240   0   0    82
2    0    2   0   18   0   0   55   313   1   0   626
3    0    0   0    0   0   0    0     0   0   0     0
4    0    0   0    1   0   0    1    16   0   0  1615
5    0    3   0  174   0   3  104   245   0   0    63
6    0    2   0    6   0   0  249   123   1   0  2686
7    0   13   0    4   0   0    3  1125   0   0    19
8    0    0   0   88   0   0   77   242  73   0   890
9    0    8   0   88   0   0  117   743   1   0   180
10   0    0   0    1   0   0    1     0   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-21 03:42:36.452592,epoch time: 0:32:18.528195,used: 3:48:05.323535,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8002194, 'precision': 0.70489424, 'recall': 0.45985666, 'specificity': 0.97607625, 'f1': 0.49023813, 'auroc': 0.9595826}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   26     9   0    74   0    1   102   121     4   2    144
1    0  1036   0    12   0    0     2   252     2   1     26
2    0     4  11    68   4    6    54    61     9  23     72
3    0     7   0  7315   0   12    15   778   245   0     64
4    0     2   3    54   4    1    47    21    27   0    380
5    0     0   1   288   0  148    35     9    13  22      5
6    0    12   0    58   0    3  1210    63    26   3    533
7    0    46   0   679   0    2    24  6203    66   1    243
8    0     2   0   552   0    4    25   331  1450   3    929
9    0     2  10   210   2   63    81    26    12  65     22
10   1     2   0    76   0    0    80   123    70   0  12441
---- Validation: 
scalar performance:
{'acc': 0.8020329, 'precision': 0.7401452, 'recall': 0.4592946, 'specificity': 0.9763385, 'f1': 0.49064147, 'auroc': 0.96004057}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   37     6   0    71   0    1   106   111     3   0    148
1    0  1031   0    20   0    1     5   238     2   0     35
2    0     6  20    69   0    9    58    59    12   8     71
3    0     7   1  7336   0   16    14   775   224   0     67
4    0     2   3    52   4    3    39    23    30   1    382
5    0     0   2   311   0  124    34     3    19  26      2
6    1    19   0    51   0    3  1208    68    26   3    529
7    0    42   0   705   0    5    16  6216    58   0    223
8    0     3   1   573   0    4    23   320  1518   2    852
9    1     2  12   203   1   68    83    40    12  50     21
10   0     5   0    71   0    1    96   111    71   1  12440
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23102218, 'precision': 0.40180448, 'recall': 0.2055746, 'specificity': 0.92173636, 'f1': 0.111619525, 'auroc': 0.78403395}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   10   0    6   0   0  276   650    2   0   223
1    0  173   0    6   0   0   10  1236    0   0    74
2    0    2   0   17   0   0   48   327    1   0   620
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    23    0   0  1609
5    0    3   0  168   0  11   90   256    1   0    63
6    0    2   0    6   0   0  233   146    1   0  2679
7    0   10   0    3   0   0    2  1133    0   0    16
8    0    0   0   83   0   0   59   264  105   0   859
9    0    8   0   80   0   1  103   766    1   0   178
10   0    0   0    1   0   0    1     0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-21 04:15:10.659534,epoch time: 0:32:34.206942,used: 4:20:39.530477,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8092091, 'precision': 0.7233138, 'recall': 0.4780673, 'specificity': 0.9773185, 'f1': 0.51006335, 'auroc': 0.96253425}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   25    11   1    62   0    1   128   100     6    1    148
1    0  1044   0    17   0    0     4   237     3    2     25
2    0     3  19    61   4    3    47    58    14   41     62
3    0     3   0  7306   0   14    13   766   269    3     66
4    0     1   2    43   5    3    40    27    36    6    376
5    1     0   0   297   0  119    21     4    12   65      2
6    1    13   0    58   0    2  1251    57    24    2    499
7    0    42   1   657   1    2    17  6228    91    3    222
8    0     1   0   488   0    1    26   322  1695    3    758
9    0     3   6   191   0   49    61    27    12  128     16
10   0     2   0    67   2    0    94   117    82    2  12425
---- Validation: 
scalar performance:
{'acc': 0.809683, 'precision': 0.76044273, 'recall': 0.48147675, 'specificity': 0.9773215, 'f1': 0.51492953, 'auroc': 0.9629268}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   26    13   0    61   0    0   113   120     5    2    143
1    0  1032   0    18   0    0     2   246     2    3     29
2    0     3  19    60   2    5    47    58     7   41     70
3    0     1   0  7316   0   11    17   754   268    2     71
4    0     2   0    41   5    1    50    20    35    8    377
5    0     0   0   288   0  133    20     3    13   61      3
6    0    15   0    59   0    2  1240    54    30    2    506
7    0    55   0   634   0    4    19  6234    75    1    243
8    0     4   0   507   0    4    28   283  1685    2    783
9    2     3   8   187   0   43    56    30     9  140     15
10   0     1   0    58   0    2    89   116    88    2  12440
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24375568, 'precision': 0.39752644, 'recall': 0.213768, 'specificity': 0.9228371, 'f1': 0.12617204, 'auroc': 0.7894586}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    4   15   0    7   0   0  344   594    2   0   204
1    0  217   0    6   0   0   11  1188    0   0    77
2    0    2   0   19   0   0   64   306    3   0   621
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    15    0   0  1617
5    0    4   0  175   0  11  112   224    4   0    62
6    0    2   0    5   0   0  330   115    1   0  2614
7    0   13   0    2   0   0    3  1126    0   0    20
8    0    0   0   80   0   0   83   233  152   0   822
9    0    8   0   78   0   2  131   741    1   0   176
10   0    0   0    1   0   0    1     0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-21 04:47:27.976210,epoch time: 0:32:17.316676,used: 4:52:56.847153,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.81544304, 'precision': 0.73750687, 'recall': 0.49712566, 'specificity': 0.9783097, 'f1': 0.53266925, 'auroc': 0.96460867}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   61     6   0    60   0    1   105    98     5    1    146
1    0  1062   0    18   0    0     1   224     8    0     19
2    0     4  21    52   4    4    50    48    32   33     64
3    0     7   0  7121   0   16    18   835   391    1     48
4    1     1   4    33   6    2    36    23    56    4    373
5    0     0   2   278   0  150    18     4    26   40      3
6    2    16   0    41   0    5  1256    65    57    1    464
7    0    39   0   538   0    3    15  6327   124    1    217
8    0     1   0   365   0    5    24   285  2011    3    602
9    2     2   6   182   1   56    65    26    28  113     12
10   1     6   0    59   0    2    85   123   165    1  12350
---- Validation: 
scalar performance:
{'acc': 0.8168517, 'precision': 0.7361536, 'recall': 0.5012872, 'specificity': 0.9785255, 'f1': 0.53802013, 'auroc': 0.9645893}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   56     8   0    51   0    1   108   102     4    0    153
1    0  1062   0     9   0    0     2   232     7    1     19
2    0     7  32    48   4    5    50    59    26   22     59
3    0     4   0  7128   0   16    18   817   401    1     55
4    0     2   3    36   4    1    50    28    67    4    344
5    0     0   2   266   0  156    19     5    26   43      4
6    0    11   0    35   0    2  1272    73    58    2    455
7    1    38   0   524   0    0    21  6349   140    1    191
8    0     1   0   375   0    5    19   291  2009    1    595
9    5     5   5   167   1   62    68    27    24  114     15
10   0     5   1    53   1    1    72   136   167    4  12356
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2601973, 'precision': 0.40008962, 'recall': 0.22741534, 'specificity': 0.9244602, 'f1': 0.14671922, 'auroc': 0.7948255}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   15   17   0    7   0   0  359   585    4   0   183
1    0  241   0    5   0   0   11  1175    0   0    67
2    0    2   0   15   0   0   68   312    7   0   611
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    20    1   0  1611
5    0    5   0  168   0  12  119   226   10   0    52
6    0    2   0    4   0   0  386   120    4   0  2551
7    0   12   0    2   0   0    4  1128    0   0    18
8    0    0   0   56   0   0   80   236  294   0   704
9    0    9   0   63   0   2  138   754    2   0   169
10   0    0   0    1   0   0    2     0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-21 05:19:54.479396,epoch time: 0:32:26.503186,used: 5:25:23.350339,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.81980413, 'precision': 0.7286289, 'recall': 0.49975437, 'specificity': 0.97875786, 'f1': 0.5358434, 'auroc': 0.96639717}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   55     9   0    72   0    1   116    93     3    2    132
1    0  1053   0    18   0    0     4   231     5    0     19
2    0     2  17    52  16    4    50    55    14   46     56
3    0     4   0  7421   0   17    17   639   289    2     50
4    0     1   1    42  18    0    49    22    51    4    351
5    0     0   0   283   0  137    22     1    18   57      3
6    0    13   0    42   0    2  1320    53    49    1    428
7    1    40   1   654   1    1    28  6240    96    4    198
8    0     1   3   477   0    3    25   278  1861    1    646
9    2     1   9   166   1   57    57    30    12  137     21
10   0     4   0    63   1    2    83   121   135    1  12382
---- Validation: 
scalar performance:
{'acc': 0.8199813, 'precision': 0.7426208, 'recall': 0.50151604, 'specificity': 0.978803, 'f1': 0.5375254, 'auroc': 0.9654239}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   53     5   0    61   1    0   122    97     7    3    134
1    0  1067   0    13   0    0     3   221     5    1     22
2    0     3  20    44   9    7    49    54    26   43     57
3    0     3   0  7385   1   15    18   663   307    3     45
4    0     0   4    43  18    3    46    19    44    6    356
5    1     0   1   275   0  132    18     6    12   73      3
6    1    11   0    51   0    1  1321    64    41    4    414
7    0    33   0   664   1    2    17  6252   103    2    191
8    0     1   0   481   1    4    26   271  1875    2    635
9    1     2   5   182   0   45    67    22    12  143     14
10   0     1   0    57   3    1    85   121   136    3  12389
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.27111173, 'precision': 0.40880156, 'recall': 0.23101181, 'specificity': 0.9253602, 'f1': 0.15302238, 'auroc': 0.7993938}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   17   15   0    8   0   0  446   528    2   0   154
1    0  258   0    8   0   0   20  1143    0   0    70
2    0    2   0   21   0   0   96   291    5   0   600
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    2    17    0   0  1614
5    0    4   0  197   0  12  152   179    7   0    41
6    0    2   0    5   0   0  567   105    1   0  2387
7    0   11   0    3   0   0    8  1125    0   0    17
8    0    0   0   83   0   0  115   214  253   0   705
9    0    8   0   91   0   2  192   685    1   0   158
10   0    0   0    1   0   0    2     0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-21 05:52:23.229149,epoch time: 0:32:28.749753,used: 5:57:52.100092,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8226402, 'precision': 0.74325883, 'recall': 0.5070045, 'specificity': 0.9789556, 'f1': 0.5464326, 'auroc': 0.96673197}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   68     2   0    50   0    2   109    98     3    6    145
1    0  1065   0    16   0    0     5   222     5    0     19
2    1     3  28    46   6    6    43    53    18   46     62
3    0     4   0  7381   1   18    17   702   250    5     61
4    1     1   3    33  16    4    50    21    36    3    371
5    1     0   0   267   0  145    15     7    13   71      2
6    1    14   0    38   0    2  1327    57    35    2    431
7    1    41   0   557   2    2    14  6358    66    1    222
8    0     2   1   481   0    4    26   318  1756    3    704
9    3     1  10   161   2   69    52    26    11  141     17
10   0     4   0    54   0    2    73   111    85    0  12462
---- Validation: 
scalar performance:
{'acc': 0.8228166, 'precision': 0.7315744, 'recall': 0.51006943, 'specificity': 0.9789741, 'f1': 0.5504546, 'auroc': 0.9674953}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   61    10   1    58   0    2   110    94     4    3    140
1    0  1062   0    18   0    0     3   222     4    1     22
2    0     5  33    41  14    8    45    48    17   42     59
3    0     4   0  7386   0   19    18   688   259    6     60
4    1     1   4    34  18    0    54    19    31    6    371
5    1     0   3   264   0  162     9     4    12   62      4
6    2    11   0    47   0    3  1325    52    27    6    435
7    0    34   3   569   1    3    18  6349    76    3    209
8    0     0   0   473   1    3    39   290  1758    2    730
9    1     2  16   161   2   55    57    26    13  141     19
10   0     1   0    56   1    1    83   110    77    1  12466
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2690128, 'precision': 0.41131637, 'recall': 0.23065385, 'specificity': 0.9251358, 'f1': 0.1539196, 'auroc': 0.80054444}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   23   19   0    8   0   0  434   513    2   0   171
1    0  316   0    7   0   0   19  1083    0   0    74
2    0    3   0   18   0   0   89   274    4   0   627
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    14    0   0  1618
5    0    4   0  190   0  17  146   176    4   0    55
6    0    2   0    5   0   0  525    88    1   0  2446
7    0   17   0    2   0   0    8  1118    0   0    19
8    0    0   0   85   0   0  107   216  203   0   759
9    0    9   0   80   0   2  184   681    1   0   180
10   0    0   0    1   0   0    2     0    0   0  1643
better model found
persisted
after epoch: 12,now: 2024-07-21 06:24:41.270316,epoch time: 0:32:18.041167,used: 6:30:10.141259,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.83136237, 'precision': 0.73862946, 'recall': 0.5291853, 'specificity': 0.98027813, 'f1': 0.56761706, 'auroc': 0.9687233}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   86     3   0    61   0    1   120    76     5    5    125
1    0  1090   0    18   0    0     3   198     4    0     19
2    1     3  28    43  15    6    49    46    16   51     54
3    0     3   0  7449   1   17    19   633   273    5     35
4    0     2   6    33  19    2    69    26    48    2    332
5    0     0   1   258   0  168    19     2    10   62      1
6    2    17   0    37   0    1  1384    57    40    3    367
7    2    35   1   602   0    0    24  6321   105    5    169
8    0     2   0   437   0    3    43   278  1992    2    539
9    3     5  10   163   1   62    48    18     8  161     14
10   1     6   1    53   2    1    95   126   133    1  12375
---- Validation: 
scalar performance:
{'acc': 0.83188444, 'precision': 0.75445783, 'recall': 0.52930987, 'specificity': 0.9803206, 'f1': 0.569388, 'auroc': 0.96914417}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   79     3   0    50   0    1   133    90     1    1    125
1    0  1097   0    15   0    0     4   198     6    0     12
2    1     4  34    45  10    5    56    40    15   48     54
3    0     3   0  7474   0    9    23   617   279    1     34
4    0     0   3    36  20    3    60    25    61    8    323
5    1     0   0   258   0  166    13     3    11   67      2
6    3     9   0    57   0    3  1355    55    41    2    383
7    2    34   1   587   1    4    16  6340   108    0    172
8    0     1   0   464   2    3    37   267  1982    4    536
9    5     1   7   154   0   62    45    26    14  164     15
10   1     4   0    59   4    1    92   122   121    3  12389
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.30105647, 'precision': 0.42041972, 'recall': 0.24996614, 'specificity': 0.92814624, 'f1': 0.180872, 'auroc': 0.80711454}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   37   22   0   10   0   0  527   460    3   0   111
1    0  364   0   12   0   0   26  1036    0   0    61
2    0    5   0   23   0   0  133   271    8   0   575
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    2    19    1   0  1610
5    0    4   0  205   0  16  174   148    9   0    36
6    0    4   0    5   0   0  819    94    2   0  2143
7    0   19   0    5   0   0   12  1111    0   0    17
8    0    0   0   83   0   0  170   193  313   0   611
9    0   10   0   97   0   1  245   642    1   0   141
10   0    0   0    1   0   0    2     0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-21 06:57:15.025170,epoch time: 0:32:33.754854,used: 7:02:43.896113,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8309878, 'precision': 0.75771713, 'recall': 0.5331454, 'specificity': 0.9800171, 'f1': 0.57823217, 'auroc': 0.9697032}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   98     6   0    59   0    0    92    82     2    8    136
1    0  1053   0    16   0    0     6   229     4    2     21
2    1     0  45    41   5    6    29    48    17   55     65
3    0     4   0  7481   0   19    10   639   241    7     39
4    0     0   8    42  19    3    48    20    44    7    348
5    1     0   2   257   0  152    11     1    10   84      3
6    1     7   0    37   0    3  1339    62    32    7    420
7    0    22   1   577   2    3    16  6383    64    5    188
8    0     0   1   488   0    4    21   281  1887    7    607
9    4     2  11   153   3   40    41    24    16  192      7
10   0     1   1    64   5    0    88   114   106    3  12410
---- Validation: 
scalar performance:
{'acc': 0.83044004, 'precision': 0.75706977, 'recall': 0.52869475, 'specificity': 0.9799589, 'f1': 0.5713708, 'auroc': 0.9700437}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   81     4   0    59   0    0   111    81     3    4    140
1    0  1064   0    17   0    0     1   231     5    0     14
2    0     1  33    44   9    9    45    54    11   51     55
3    1     3   0  7449   0   15    12   668   249    5     38
4    0     2  11    43  24    2    47    24    36    5    345
5    2     0   2   253   0  154     7     4    11   85      3
6    2     9   0    46   0    2  1340    68    33    6    402
7    0    21   0   546   0    1    17  6416    74    3    187
8    0     0   0   487   0    3    26   274  1869    6    631
9    2     1  14   146   0   45    37    21    14  196     17
10   0     5   0    60   4    2    76   135    92    2  12420
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28342545, 'precision': 0.42102894, 'recall': 0.2388332, 'specificity': 0.9265789, 'f1': 0.16520134, 'auroc': 0.8073864}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   59   11   0    9   0   0  462   494    2   0   133
1    0  252   0    9   0   0   22  1154    0   0    62
2    0    1   0   21   0   0  105   283    5   0   600
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    2    20    1   0  1610
5    1    3   0  212   0  14  155   161    7   0    39
6    0    2   0    5   0   0  692   109    1   0  2258
7    0    8   0    4   0   0    8  1129    0   0    15
8    0    0   0   90   0   0  134   222  262   0   662
9    0    5   0   89   0   1  203   682    1   0   156
10   0    0   0    1   0   0    2     0    0   0  1643
early stop counter: 1
val acc:0.8304400444030762, best validation acc: 0.8318844437599182, corresponding to test acc:                         0.30105647444725037 / 0.30105647444725037
after epoch: 14,now: 2024-07-21 07:29:48.089659,epoch time: 0:32:33.064489,used: 7:35:16.960602,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8369542, 'precision': 0.7448423, 'recall': 0.5537666, 'specificity': 0.980861, 'f1': 0.59760386, 'auroc': 0.9708713}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   119     5   0    59   0    0    95    77     4    5    119
1     0  1087   0    13   0    0     6   199     5    1     21
2     4     3  41    35  16    9    24    49    12   66     53
3     0     3   1  7488   0   13    18   605   262    4     42
4     0     2  11    36  36    3    44    23    53    9    322
5     2     0   1   223   0  187     6     3    16   80      3
6     5    13   0    38   0    2  1348    57    38    7    399
7     2    39   3   536   5    4    18  6340   115    4    197
8     2     1   1   424   4    4    19   262  2028    4    547
9     6     2  13   140   0   61    23    16    14  207     11
10    2     2   0    48   2    5    76   131   124    3  12401
---- Validation: 
scalar performance:
{'acc': 0.8371539, 'precision': 0.7491144, 'recall': 0.5517348, 'specificity': 0.980892, 'f1': 0.59624815, 'auroc': 0.9706436}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   120     2   0    52   0    2    86    88     5    6    122
1     0  1079   0    16   0    0     2   214     4    1     16
2     2     2  39    36  19    8    23    44    16   71     52
3     3     4   0  7412   0   26    17   647   276    9     46
4     4     1   6    33  47    1    38    15    49   11    334
5     2     0   2   229   1  175     5     3    12   87      5
6     4    12   0    37   0    5  1364    54    43    1    388
7     0    40   2   549   1    2    22  6396    83    3    167
8     2     1   1   410   1    5    21   268  2028   10    549
9     6     2  10   142   0   60    31    20    12  198     12
10    2     2   0    57   8    2    69   102   113    2  12439
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3115511, 'precision': 0.44829315, 'recall': 0.2629047, 'specificity': 0.9293176, 'f1': 0.20263694, 'auroc': 0.81118196}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   152   19   0    9   0   0  444   417    5   0   124
1     1  386   0    9   0   0   23  1017    0   0    63
2     0    4   0   20   0   0  117   267    8   0   599
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    2    16    1   0  1614
5     7    4   0  204   0  24  163   141    8   2    39
6     0    3   0    5   0   0  793    89    2   0  2175
7     0   13   0    3   0   0   10  1122    0   0    16
8     0    0   0   75   0   0  147   193  333   0   622
9     2    9   0   90   0   2  234   635    3   1   161
10    0    0   0    1   0   0    3     0    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-21 08:02:04.510244,epoch time: 0:32:16.420585,used: 8:07:33.381187,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.83537567, 'precision': 0.7533662, 'recall': 0.5484548, 'specificity': 0.9805448, 'f1': 0.59603703, 'auroc': 0.9714531}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   127     5   0    53   0    0    74    78     3    2    141
1     1  1071   0    11   0    0     5   220     3    1     19
2     4     1  57    38   9    6    31    47    14   44     61
3     1     1   0  7364   2   20    16   721   264    6     45
4     1     2  15    34  23    1    49    34    35    7    338
5     2     0   1   237   0  176    10     3     8   79      5
6     5     8   0    44   0    4  1362    58    27    2    397
7     4    23   1   476   0    2    18  6459    73    3    202
8     1     1   0   425   0    7    22   300  1931    5    604
9     4     1  20   135   2   59    35    26    14  180     17
10    1     1   2    40   1    4    63    97   110    1  12473
---- Validation: 
scalar performance:
{'acc': 0.8344791, 'precision': 0.7455623, 'recall': 0.54480207, 'specificity': 0.98041016, 'f1': 0.59155726, 'auroc': 0.9709878}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   132     3   0    50   0    0    70    76     4    3    145
1     0  1068   0    12   0    0     4   225     4    0     19
2     3     2  44    38   8    6    41    50    14   46     60
3     0     4   2  7360   0   20    16   713   275    4     46
4     1     1  12    30  28    3    42    24    37    8    353
5     4     0   1   224   0  173     9     3    18   86      3
6     5    16   0    37   3    1  1348    49    34    3    412
7     0    23   1   458   3    2    21  6475    73    5    204
8     1     0   0   400   0    9    22   302  1915    4    643
9     5     1  18   135   1   65    25    27    11  181     24
10    3     2   1    36   4    1    65   120    87    4  12473
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29888758, 'precision': 0.5118502, 'recall': 0.2533432, 'specificity': 0.92802197, 'f1': 0.18899348, 'auroc': 0.8097234}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   161   10   0    8   0   0  427   415    3   0   146
1     1  284   0    7   0   0   22  1118    0   0    67
2     0    0   1   14   0   0  107   261    7   0   625
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    2    14    1   0  1616
5    10    3   0  184   0  19  168   151    8   1    48
6     0    2   0    3   0   0  734    75    1   0  2252
7     0    8   0    3   0   0   10  1126    0   0    17
8     0    0   0   62   0   0  139   194  303   0   672
9     1    5   0   68   0   1  225   648    2   0   187
10    0    0   0    0   0   0    2     0    0   0  1644
early stop counter: 1
val acc:0.8344790935516357, best validation acc: 0.8371539115905762, corresponding to test acc:                         0.3115510940551758 / 0.3115510940551758
after epoch: 16,now: 2024-07-21 08:34:37.507973,epoch time: 0:32:32.997729,used: 8:40:06.378916,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.83722174, 'precision': 0.75189894, 'recall': 0.5472934, 'specificity': 0.9809002, 'f1': 0.59211576, 'auroc': 0.97155905}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   115     2   0    42   0    0   103    85     6    2    128
1     0  1067   0    15   0    0     4   226     6    1     13
2     1     1  48    37  12    5    41    45    16   50     56
3     0     2   0  7369   2   14    17   687   292    2     51
4     1     1   4    32  26    2    65    23    38    6    341
5     4     0   0   224   0  173    15     6    15   82      2
6     1     8   0    36   0    4  1392    51    38    5    373
7     0    31   0   472   1    2    19  6456    93    3    186
8     2     0   0   377   0    3    38   291  2021    6    558
9     9     1  18   133   3   60    39    23    10  182     15
10    2     3   2    42   3    2    75   105   113    3  12443
---- Validation: 
scalar performance:
{'acc': 0.83881235, 'precision': 0.7575902, 'recall': 0.5495976, 'specificity': 0.98108983, 'f1': 0.5951439, 'auroc': 0.9719713}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   121     4   0    44   1    2    88    93     1    3    126
1     0  1061   0    10   0    0     4   225     6    1     25
2     1     2  51    40   8    9    42    44    10   52     53
3     0     2   1  7384   1   21    19   680   287    6     39
4     0     1   9    32  31    1    52    25    44    7    337
5     3     0   1   227   1  175    10     4    17   79      4
6     3     8   0    33   0    2  1402    43    44    4    369
7     1    19   1   449   1    3    21  6465   112    6    187
8     0     1   0   364   0    4    36   281  2052    6    552
9     8     3  18   134   1   64    35    22    16  171     21
10    3     2   0    45   2    1    73   109   112    3  12446
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.31560904, 'precision': 0.42568144, 'recall': 0.2604307, 'specificity': 0.92945695, 'f1': 0.19684824, 'auroc': 0.812452}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   126   11   0    8   0   0  517   388    3   0   117
1     0  300   0    8   0   0   29  1097    0   0    65
2     0    0   0   16   0   0  142   252    8   0   597
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    4    12    1   0  1616
5     7    3   0  183   0  19  203   128    9   1    39
6     0    1   0    3   0   0  958    63    2   0  2040
7     0    8   0    3   0   0   15  1122    0   0    16
8     0    0   0   63   0   0  180   180  343   0   604
9     0    3   0   73   0   1  282   602    5   0   171
10    0    0   0    0   0   0    3     0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-21 09:06:54.614432,epoch time: 0:32:17.106459,used: 9:12:23.485375,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.84257275, 'precision': 0.7472388, 'recall': 0.5753097, 'specificity': 0.98168284, 'f1': 0.6198513, 'auroc': 0.9730622}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   149     1   1    44   0    1    89    80     2    6    110
1     0  1073   1    11   0    0     5   219     7    0     16
2     4     0  68    33  16    5    30    46    11   59     40
3     3     2   1  7363   0   30    23   685   287   11     35
4     1     0  25    29  48    3    47    23    51   15    297
5     4     0   2   206   0  196     4     2    17   88      2
6     4    14   0    31   0    3  1415    51    33    7    350
7     2    24   2   448   1    4    17  6506   104    3    153
8     2     0   2   400   2    8    24   275  2061    6    513
9     9     0  24   118   0   71    19    20    10  210     12
10    4     2   2    38   4    3    73   119   140    3  12403
---- Validation: 
scalar performance:
{'acc': 0.8425839, 'precision': 0.75292367, 'recall': 0.5752013, 'specificity': 0.9816479, 'f1': 0.6216388, 'auroc': 0.9732831}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   153     1   0    40   0    4    78    78     5    7    117
1     0  1079   0    15   0    0     5   221     3    0      9
2     3     1  73    30  12    9    23    43    14   61     43
3     1     4   0  7349   1   20    17   721   281    8     38
4     0     1  23    27  45    1    37    30    53   12    310
5     3     0   0   214   0  179     7     3    14   99      2
6     4    10   0    39   1    2  1401    57    29    4    361
7     1    26   2   434   2    4    20  6527    95    2    152
8     1     1   1   379   0    8    32   286  2079    4    505
9     7     0  26   117   5   58    23    21    13  215      8
10    0     0   0    39   9    3    76   128   133    8  12400
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33428952, 'precision': 0.49744618, 'recall': 0.27732927, 'specificity': 0.9314956, 'f1': 0.22105029, 'auroc': 0.8166431}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   234   12   0    6   0   1   447   367    4   0    99
1     1  349   0    8   0   0    25  1058    0   0    58
2     1    1   1   15   0   0   147   275    8   0   567
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     3    20    1   0  1609
5    22    3   0  187   0  27   175   134    8   4    32
6     0    3   0    3   0   0  1028    87    4   0  1942
7     0    9   0    3   0   0    12  1126    0   0    14
8     0    0   0   64   0   0   188   190  369   0   559
9     7    5   1   76   0   1   269   626    4   2   146
10    0    0   0    1   0   0     3     0    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-21 09:39:16.480343,epoch time: 0:32:21.865911,used: 9:44:45.351286,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8440711, 'precision': 0.7504264, 'recall': 0.57486546, 'specificity': 0.9817901, 'f1': 0.62081814, 'auroc': 0.9728451}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   144     7   1    47   0    1    88    60     7    4    124
1     0  1098   0    11   0    0     3   198     8    1     13
2     1     2  80    34  15    6    37    39    10   51     37
3     4     3   0  7459   0   28    22   634   248    5     36
4     0     1  19    28  47    0    53    22    44   10    315
5     2     0   4   217   0  198     7     3    12   73      5
6     3     8   1    35   0    1  1437    49    30    9    334
7     0    39   3   489   1    2    27  6443    92    8    161
8     0     1   4   390   2    8    33   276  2032    4    544
9     8     1  29   116   3   76    34    20    11  179     14
10    4     3   0    42   7    1    77   109   115    4  12431
---- Validation: 
scalar performance:
{'acc': 0.84386784, 'precision': 0.75220335, 'recall': 0.5737834, 'specificity': 0.9817609, 'f1': 0.6210446, 'auroc': 0.9739987}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   152     5   1    37   0    0    90    65     5    4    124
1     0  1091   0    13   0    0     4   200     6    2     16
2     2     2  75    34  18    6    32    41    15   42     45
3     0     5   2  7433   0   24    20   639   276    5     36
4     1     1  14    35  41    0    54    23    48   10    312
5     4     0   1   220   0  200     6     1    15   72      2
6     4    10   0    43   1    2  1409    50    28    4    357
7     1    33   2   466   2    1    25  6487    87    4    157
8     2     2   1   391   2    5    30   279  2055    6    523
9    12     0  32   121   0   65    32    23    13  183     12
10    3     2   0    38   5    2    93   107   122    2  12422
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34639335, 'precision': 0.47293934, 'recall': 0.28276205, 'specificity': 0.93251276, 'f1': 0.22790569, 'auroc': 0.8179746}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   212   19   0   10   0   0   502   336    3   0    88
1     1  440   0   10   0   0    27   962    0   0    59
2     0    4   1   15   0   0   168   247    8   0   572
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     6    13    1   0  1613
5    15    3   0  192   0  25   203   110   10   3    31
6     0    3   0    3   0   0  1164    64    2   0  1831
7     0   11   0    3   0   0    18  1118    0   0    14
8     0    0   0   71   0   0   225   173  350   0   551
9     5   10   1   84   0   1   307   580    3   0   146
10    0    0   0    1   0   0     4     0    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-21 10:11:46.786381,epoch time: 0:32:30.306038,used: 10:17:15.657324,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8439105, 'precision': 0.7612506, 'recall': 0.57230955, 'specificity': 0.981656, 'f1': 0.6191116, 'auroc': 0.97353244}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   148     5   1    40   0    5    84    72     3    3    122
1     0  1087   1    15   0    0     5   202     6    0     16
2     3     3  81    37  14   14    40    42    10   25     43
3     1     3   1  7596   1   35    16   527   219    2     36
4     0     0  19    34  42    8    50    22    40    2    322
5     3     0   4   200   0  248     9     7    11   33      6
6     3    13   0    36   0    4  1420    40    30    3    358
7     1    33   2   545   0    4    16  6415    73    1    174
8     0     1   2   462   1    7    37   271  1953    2    559
9     8     1  41   123   2   97    37    20    12  132     20
10    2     1   1    55   3    5    83   119   103    1  12420
---- Validation: 
scalar performance:
{'acc': 0.8445633, 'precision': 0.7596481, 'recall': 0.57552934, 'specificity': 0.9817723, 'f1': 0.62220514, 'auroc': 0.974427}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   156     3   0    43   0    1    89    69     3    3    116
1     1  1094   0    16   0    0     3   194     8    0     16
2     4     3  91    44   9   13    31    34     9   26     48
3     0     2   0  7552   1   28    20   582   217    2     36
4     1     1  24    29  37    3    58    23    50    1    312
5     5     0   3   207   0  240     9     3    13   38      3
6     5    12   0    38   0    1  1450    36    28    1    337
7     4    27   0   530   2    4    23  6423    83    0    169
8     1     1   1   462   1    8    34   278  1960    0    550
9     5     2  37   130   3  103    39    22     9  128     15
10    3     2   2    34   6    3    80   107   116    0  12443
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34485412, 'precision': 0.47178015, 'recall': 0.28119192, 'specificity': 0.93235576, 'f1': 0.2271917, 'auroc': 0.81867236}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   221   12   0   14   0   2   510   316    3   0    92
1     1  402   0   11   0   0    32   993    0   0    60
2     0    2   1   18   0   0   169   241    7   0   577
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     6    12    1   0  1614
5    14    3   0  210   0  32   199    89   10   0    35
6     0    2   0    4   0   0  1192    57    2   0  1810
7     0   10   0    3   0   0    19  1117    0   0    15
8     0    0   0   90   0   0   233   164  323   0   560
9     6    3   1  103   0   1   323   539    3   0   158
10    0    0   0    1   0   0     4     0    0   0  1641
better model found
persisted
after epoch: 20,now: 2024-07-21 10:44:17.608810,epoch time: 0:32:30.822429,used: 10:49:46.479753,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.84781677, 'precision': 0.753721, 'recall': 0.5823942, 'specificity': 0.98223686, 'f1': 0.6311498, 'auroc': 0.9747232}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   147     3   0    42   1    4    91    67     3    3    122
1     0  1107   0    13   0    0     4   191     5    1     11
2     3     1  76    30  34    8    33    41     7   37     42
3     3     3   0  7550   0   21    16   578   230    3     34
4     1     0  18    33  67    3    64    26    39    4    284
5     4     0   3   211   1  215     7     5    11   60      4
6     5     9   0    29   0    1  1479    44    31    3    307
7     3    30   1   520   2    3    26  6424    83    4    166
8     5     2   1   430   2    7    32   235  2047    7    527
9     9     0  17   131   8   80    38    21    11  170      8
10    1     3   2    49   9    0   101   109   110    3  12406
---- Validation: 
scalar performance:
{'acc': 0.8476662, 'precision': 0.75083697, 'recall': 0.582556, 'specificity': 0.9822841, 'f1': 0.6310437, 'auroc': 0.9750903}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   154     4   0    49   0    1    99    67     5    2    102
1     0  1103   0    17   1    0     6   187     6    1     11
2     3     0  75    35  23    8    27    45    11   43     42
3     2     2   0  7533   3   24    19   584   243    1     29
4     1     0  16    37  73    1    61    25    41    8    276
5     4     0   5   211   0  221     8     1    12   57      2
6     7     8   0    29   4    3  1470    48    31    1    307
7     1    33   2   524   7    4    27  6440    72    2    153
8     3     2   0   438   2    8    39   254  2064    3    483
9    11     3  30   135   2   75    36    18     9  156     18
10    2     8   0    46  12    2    94   114   116    1  12401
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36913174, 'precision': 0.56569755, 'recall': 0.295668, 'specificity': 0.9346827, 'f1': 0.24373674, 'auroc': 0.82178104}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   261   16   0   14   0   1   516   292    3   0    67
1     1  460   0   11   0   0    34   937    0   0    56
2     1    4   1   18   0   0   212   238    8   0   533
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     8    14    1   0  1609
5    19    3   0  203   0  27   215    85   10   1    29
6     0    2   0    4   0   0  1416    56    2   0  1587
7     0   10   0    3   0   0    23  1115    0   0    13
8     0    0   0   82   0   0   277   160  356   0   495
9    11    7   1  101   0   1   347   528    3   0   138
10    0    0   0    1   0   0     6     0    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-21 11:16:45.254763,epoch time: 0:32:27.645953,used: 11:22:14.125706,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8484321, 'precision': 0.75449276, 'recall': 0.5869561, 'specificity': 0.9823592, 'f1': 0.63246834, 'auroc': 0.97510517}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   152     4   3    42   0    1    88    74     6    3    110
1     0  1100   0    14   0    0     3   194     6    1     14
2     4     0  89    31  15    5    22    36    16   56     38
3     1     2   1  7456   1   31    20   643   245    6     33
4     0     0  20    29  53    1    54    23    46    7    306
5     3     0   5   214   0  179     4     2    16   97      1
6     4     8   0    38   2    2  1468    43    28    3    312
7     1    28   3   423   5    4    21  6522    89    3    163
8     2     2   4   413   4    5    36   271  2065    7    486
9     3     1  36   109   2   57    27    15    15  217     10
10    2     5   2    31   6    1    88   137   110    1  12410
---- Validation: 
scalar performance:
{'acc': 0.84919083, 'precision': 0.75872695, 'recall': 0.5915387, 'specificity': 0.98244154, 'f1': 0.63783205, 'auroc': 0.9755058}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   149     4   0    32   0    0    89    82     6    8    113
1     0  1097   0    13   0    0     5   197     7    0     13
2     2     1  92    25  19    7    24    44    14   47     37
3     1     2   0  7453   2   28    23   640   247    4     40
4     0     1  26    27  55    1    45    23    41    9    311
5     2     0   2   208   1  193     5     2    10   93      5
6    10    10   0    30   3    2  1466    44    32    6    305
7     3    28   3   459   1    3    22  6487    96    3    160
8     0     1   3   380   2    4    37   290  2101   10    468
9     7     1  30   114   2   51    25    19     8  224     12
10    3     0   2    42   7    0    85   118   104    5  12430
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36577347, 'precision': 0.5513683, 'recall': 0.29234755, 'specificity': 0.9343339, 'f1': 0.23852181, 'auroc': 0.8223026}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   213   15   0    9   0   1   541   316    4   0    71
1     1  425   0   11   0   0    35   970    0   0    57
2     1    2   1   15   0   0   200   251    9   0   536
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     7    16    1   0  1608
5    16    3   0  194   0  27   213    93   10   4    32
6     0    2   0    3   0   0  1412    61    3   0  1586
7     0    9   0    3   0   0    21  1118    0   0    13
8     0    0   0   69   0   0   262   166  390   0   483
9     5    3   1   88   1   1   347   546    4   2   139
10    0    0   0    1   0   0     6     0    0   0  1639
better model found
persisted
after epoch: 22,now: 2024-07-21 11:49:02.257898,epoch time: 0:32:17.003135,used: 11:54:31.128841,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8500107, 'precision': 0.7587979, 'recall': 0.5914933, 'specificity': 0.9825002, 'f1': 0.6390549, 'auroc': 0.9755775}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   165     2   1    43   0    3    71    67     9    4    118
1     1  1087   0    16   0    0     3   200     7    0     18
2     5     1  85    24  17    7    32    39    15   47     40
3     1     1   0  7519   1   23    16   576   267    4     31
4     1     1  20    30  49    4    42    21    53    7    310
5     3     0   1   191   0  231     5     4    15   68      3
6    11     7   0    37   2    3  1422    54    42    4    326
7     2    29   1   494   4    5    17  6431    93    5    183
8     3     0   1   381   1    7    24   246  2158    7    466
9     9     1  28   113   3   80    25    21    11  194      8
10    4     0   2    44   4    2    67    99   141    0  12429
---- Validation: 
scalar performance:
{'acc': 0.85258794, 'precision': 0.76860446, 'recall': 0.59845304, 'specificity': 0.982826, 'f1': 0.64612836, 'auroc': 0.97541606}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   168     2   0    50   0    1    67    66     4    4    121
1     0  1092   0    14   0    0     7   202     6    0     11
2     0     1  82    40  12    6    25    34    16   53     43
3     2     1   0  7545   2   31    15   542   278    4     20
4     1     1  19    27  60    1    42    27    51   10    300
5     5     0   2   182   0  242     6     2    14   65      3
6     8     8   0    41   1    3  1434    45    38    4    326
7     3    35   4   492   0    3    14  6453    97    3    161
8     0     0   2   367   5    4    34   236  2178    6    464
9     8     1  30   106   3   79    20    20    11  203     12
10    2     1   4    32   5    1    77   114   138    5  12417
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36325473, 'precision': 0.5830438, 'recall': 0.29696673, 'specificity': 0.93430215, 'f1': 0.24667893, 'auroc': 0.8227272}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   269   13   0   14   0   2   478   308    5   0    81
1     1  412   0   13   0   0    31   983    1   0    58
2     1    1   1   16   0   0   170   241   10   0   575
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    13    1   0  1612
5    23    3   0  215   0  32   188    79   14   5    33
6     0    2   0    4   0   0  1253    56    8   0  1744
7     0    9   0    3   0   0    17  1122    0   0    13
8     0    0   0   70   0   0   207   159  459   0   475
9    12    4   1  101   0   3   317   535    7   2   155
10    0    0   0    1   0   0     4     0    0   0  1641
better model found
persisted
after epoch: 23,now: 2024-07-21 12:21:12.797647,epoch time: 0:32:10.539749,used: 12:26:41.668590,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8535156, 'precision': 0.7700356, 'recall': 0.6054845, 'specificity': 0.9830583, 'f1': 0.65434986, 'auroc': 0.97666985}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   148     4   0    38    0    4    99    67     5    5    113
1     0  1118   1    12    0    0     4   178     6    1     11
2     2     2  93    23   27    8    38    40     6   41     32
3     0     4   4  7495    2   20    22   607   254    3     28
4     0     1  17    25  101    1    48    25    42    8    271
5     2     0   2   194    2  217     8     4    11   79      2
6     4    12   0    34    2    2  1495    44    30    3    282
7     2    32   5   484    5    4    26  6487    88    4    126
8     1     3   3   385    7    6    37   269  2152    3    430
9     4     0  25   111    1   69    28    23    12  210     10
10    2     4   2    51   15    1    96   116   116    3  12385
---- Validation: 
scalar performance:
{'acc': 0.8531764, 'precision': 0.76824677, 'recall': 0.601719, 'specificity': 0.98300433, 'f1': 0.6497953, 'auroc': 0.9762147}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   144     6   0    41   0    1   103    71     2    4    111
1     1  1119   0    16   0    0     5   172     6    0     13
2     0     1  88    34  29    4    25    35    10   51     35
3     3     1   1  7514   3   29    21   576   258    2     32
4     0     1  13    31  99    0    59    29    38    3    266
5     3     0   3   195   0  208     7     1    13   89      2
6     1    14   0    26   3    3  1515    44    28    4    270
7     1    32   3   496   3    2    19  6472    95    3    139
8     0     1   3   402   5    6    43   246  2128    6    456
9     5     0  27    99   6   79    31    14    11  210     11
10    1     2   1    47  11    1    90   120   121    3  12399
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3896313, 'precision': 0.5376489, 'recall': 0.30528364, 'specificity': 0.93651396, 'f1': 0.25231308, 'auroc': 0.8254913}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   183   17   0   11   0   1   602   298    3   0    55
1     0  514   0   12   0   0    37   887    1   0    48
2     0    4   1   15   1   0   256   238   10   0   490
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    15    17    1   0  1599
5    11    3   0  195   0  31   240    70   13   3    26
6     0    2   0    3   0   0  1662    56    3   0  1341
7     0   11   0    3   0   0    23  1115    0   0    12
8     0    1   0   71   0   0   302   154  423   0   419
9     3    9   1   88   2   2   397   508    6   2   119
10    0    0   0    1   0   0     8     0    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-21 12:53:32.745679,epoch time: 0:32:19.948032,used: 12:59:01.616622,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.8542915, 'precision': 0.76105803, 'recall': 0.60294074, 'specificity': 0.98310435, 'f1': 0.65227246, 'auroc': 0.9766078}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   165     6   0    40   1    1    75    62     3    2    127
1     0  1117   0    13   0    0     1   182     5    1     13
2     4     2  92    34  32    6    24    27    13   35     43
3     1     2   1  7528   0   23    16   570   269    0     30
4     2     1  20    29  79    3    55    25    50    3    272
5     5     0   6   196   1  220     5     2    12   71      3
6    10    16   0    44   3    2  1432    44    46    3    306
7     3    36   2   458   6    3    19  6489   105    2    140
8     2     0   2   388   7    5    35   230  2208    5    412
9     2     1  28   108   8   65    26    20    15  203     17
10    2     3   3    37  10    2    75   118   144    3  12397
---- Validation: 
scalar performance:
{'acc': 0.855771, 'precision': 0.76921487, 'recall': 0.6032202, 'specificity': 0.98323333, 'f1': 0.6534102, 'auroc': 0.97670096}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   160     4   0    39   0    1    69    75     5    4    126
1     0  1116   1    14   0    0     0   183     8    0     10
2     2     1  87    29  31    9    25    45     8   37     38
3     0     4   0  7559   0   23    12   546   266    6     24
4     2     0  21    32  86    0    40    24    41   11    282
5     5     0   4   198   0  231     5     0    11   65      2
6     7     5   0    28   3    3  1481    41    32    4    304
7     1    37   2   494   3    4    19  6463   102    4    136
8     0     2   1   387   5    3    23   245  2207    5    418
9     4     1  30   121   3   72    25    15    16  189     17
10    1     2   1    46  13    0    74   106   137    2  12414
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38249493, 'precision': 0.5263134, 'recall': 0.30720904, 'specificity': 0.93611693, 'f1': 0.25743726, 'auroc': 0.8250998}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   233   19   0   14   0   1   524   305    4   0    70
1     1  531   0   14   0   0    30   869    1   0    53
2     0    4   1   15   1   0   194   247   12   0   541
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     7    15    1   0  1609
5    17    3   0  213   0  31   201    78   15   3    31
6     0    3   0    4   0   0  1438    61    8   0  1553
7     0   11   0    3   0   0    19  1118    0   0    13
8     0    1   0   70   0   0   237   158  474   0   430
9     9   12   1   97   1   2   337   527    7   1   143
10    0    0   0    1   0   0     6     0    0   0  1639
better model found
persisted
after epoch: 25,now: 2024-07-21 13:25:50.172607,epoch time: 0:32:17.426928,used: 13:31:19.043550,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.85619116, 'precision': 0.770328, 'recall': 0.61276394, 'specificity': 0.98330045, 'f1': 0.6613887, 'auroc': 0.97621757}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   176     2    0    39   0    1    75    59     6    4    121
1     0  1102    1    11   0    0     2   201     6    1      8
2     4     0  112    28  16    6    19    40    10   37     39
3     0     3    0  7512   1   24    13   574   278    5     28
4     1     1   27    29  77    1    39    26    56    7    275
5     2     1    5   181   1  229     7     5    10   76      4
6     8     7    0    35   3    2  1470    39    39    7    298
7     1    23    4   459   3    0    23  6503    97    4    147
8     0     1    1   366   7   10    24   245  2201    4    437
9     6     0   45    99   3   72    23    15    14  203     13
10    3     3    0    41  12    2    75   111   128    0  12416
---- Validation: 
scalar performance:
{'acc': 0.85617226, 'precision': 0.7629791, 'recall': 0.6120034, 'specificity': 0.9833442, 'f1': 0.6581484, 'auroc': 0.9767982}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   166     2    1    41   1    2    73    71    10    4    112
1     0  1111    0    15   0    0     0   187     6    0     13
2     3     1  114    32  19    4    20    31     9   34     45
3     3     1    0  7473   0   26    14   592   298    0     33
4     2     2   30    26  77    1    46    24    52    8    271
5     3     0    9   179   0  238     6     3    14   66      3
6    11    11    0    29   2    5  1479    49    39    2    281
7     1    27    0   429   2    5    24  6527    98    1    151
8     2     0    3   331   2    7    22   255  2234    8    432
9     9     1   53    98   6   75    25    14    11  189     12
10    8     2    2    34   9    2    62   119   157    1  12400
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38634297, 'precision': 0.49436063, 'recall': 0.31156266, 'specificity': 0.9364849, 'f1': 0.26397255, 'auroc': 0.8257366}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   305   14   0   12   0   2   494   272    4   0    67
1     1  500   0   13   0   0    33   898    1   0    53
2     1    4   1   15   1   0   195   235   11   0   552
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     7    13    1   0  1611
5    25    3   0  202   0  34   201    74   16   4    33
6     0    2   0    4   0   0  1453    53    8   0  1547
7     0    9   0    3   0   0    22  1117    0   0    13
8     0    0   0   63   0   0   245   150  472   0   440
9    14    7   3   87   1   4   345   518    7   1   150
10    0    0   0    1   0   0     7     0    0   0  1638
better model found
persisted
after epoch: 26,now: 2024-07-21 13:58:24.973183,epoch time: 0:32:34.800576,used: 14:03:53.844126,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.85688674, 'precision': 0.75811815, 'recall': 0.613194, 'specificity': 0.9833224, 'f1': 0.6598054, 'auroc': 0.9766649}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   197     4   0    35   0    4    51    59     4    4    124
1     0  1115   0    14   0    0     1   183     7    1     11
2     6     0  80    24  30    6    17    37    11   60     41
3     1     3   0  7569   1   20    11   532   263    7     32
4     1     1  26    29  80    2    25    16    52   14    293
5     3     0   3   179   0  228     2     1    12   90      3
6    18    13   0    24   3    3  1404    48    49    7    339
7     4    39   2   478   4    2    13  6456   109    6    150
8     4     1   4   368   4    7    15   223  2205    8    457
9     7     1  30    92   3   61    12    18    16  243     10
10    1     3   1    32  17    3    53   102   128    1  12450
---- Validation: 
scalar performance:
{'acc': 0.85507554, 'precision': 0.75506663, 'recall': 0.6122019, 'specificity': 0.98315686, 'f1': 0.6570282, 'auroc': 0.97708946}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   193     7   0    33   0    2    58    55     6    8    121
1     0  1127   0    16   0    0     3   167     9    0     10
2     3     3  85    21  26    9    11    33     8   66     47
3     1     2   1  7487   0   31     9   590   281    4     34
4     2     1  25    25  87    6    28    20    38   12    295
5     4     0   5   170   0  210     6     1    15  107      3
6    13    14   0    31   5    3  1411    35    48    5    343
7     4    40   4   446   7    2    16  6486   112    1    147
8     3     1   1   372   1   10    32   233  2182   10    451
9     5     1  30    95   2   62    14    11    13  245     15
10    7     2   0    30  14    1    64    95   122    7  12454
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38375428, 'precision': 0.5090608, 'recall': 0.31781524, 'specificity': 0.9364991, 'f1': 0.27379054, 'auroc': 0.825719}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   389   21   0   13   0   2   405   250    5   0    85
1     1  572   0   14   0   0    27   828    1   0    56
2     1    4   1   17   1   0   149   229   11   0   602
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    11    1   0  1615
5    48    3   0  211   0  39   165    66   14   9    37
6     0    3   0    5   0   0  1243    51    8   0  1757
7     0   13   0    3   0   0    14  1119    0   0    15
8     0    0   0   76   0   0   196   148  475   0   475
9    26   11   2  101   1   4   292   510    7   4   179
10    0    0   0    1   0   0     3     0    0   0  1642
early stop counter: 1
val acc:0.8550755381584167, best validation acc: 0.8561722636222839, corresponding to test acc:                         0.38634297251701355 / 0.3896313011646271
after epoch: 27,now: 2024-07-21 14:30:46.110430,epoch time: 0:32:21.137247,used: 14:36:14.981373,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8583048, 'precision': 0.7755674, 'recall': 0.61407965, 'specificity': 0.98356694, 'f1': 0.663955, 'auroc': 0.9771344}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   194     3    1    43   0    0    80    51     4    2    104
1     1  1101    0    16   0    0     6   186     8    1     13
2     6     1  101    29  19    3    26    29    12   46     40
3     2     1    0  7663   1   24    13   458   243    6     26
4     1     1   21    30  87    3    53    14    49    8    271
5     2     0    5   201   0  217    10     2    13   69      2
6     8    12    0    40   1    2  1512    38    24    1    270
7     3    37    1   539   5    2    34  6403    96    2    142
8     2     0    4   424   1    2    28   217  2196    5    417
9     7     0   39   113   2   60    22    17    20  200     13
10    2     0    1    43  12    1    90   104   133    1  12406
---- Validation: 
scalar performance:
{'acc': 0.8582319, 'precision': 0.7673696, 'recall': 0.6150873, 'specificity': 0.98358333, 'f1': 0.66380453, 'auroc': 0.97739846}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   187     1    1    38   1    0    79    57     8    2    109
1     0  1114    0    19   0    0     2   176     5    0     16
2     5     3  102    25  27    5    22    37    10   39     37
3     1     0    1  7622   1   25    17   483   257    2     31
4     1     0   21    29  87    0    52    23    49    8    269
5     6     0    3   196   1  211     7     3    13   79      2
6    13     8    0    30   4    4  1516    45    27    3    258
7     1    24    1   536   3    2    24  6433   100    1    140
8     3     0    4   417   7    4    38   202  2206    5    410
9     8     0   28   104   4   67    25    18    17  211     11
10    5     2    3    45  12    0    99   113   118    3  12396
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4027846, 'precision': 0.53229016, 'recall': 0.31826624, 'specificity': 0.9380019, 'f1': 0.27054927, 'auroc': 0.8285266}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   344   13   0   18   0   0   511   230    4   0    50
1     1  470   0   17   0   0    39   918    1   0    53
2     1    2   1   19   1   0   252   219   11   0   509
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    15    13    1   0  1603
5    33    3   0  220   0  29   222    43   13   3    26
6     0    2   0    5   0   0  1699    46    6   0  1309
7     1    9   0    4   0   0    25  1113    0   0    12
8     0    0   0   85   0   0   294   132  462   0   397
9    20    4   1  108   1   2   397   458    7   1   138
10    0    0   0    1   0   0     8     0    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-21 15:03:03.543674,epoch time: 0:32:17.433244,used: 15:08:32.414617,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.8581175, 'precision': 0.76873183, 'recall': 0.6197833, 'specificity': 0.9835229, 'f1': 0.66847456, 'auroc': 0.97702026}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   214     3    0    31   0    2    55    60     5    7    106
1     1  1114    0    19   0    0     3   180     7    0      7
2     4     1  106    27  22    8    19    41     7   39     38
3     3     1    1  7539   1   24    16   575   254    6     18
4     1     0   28    29  84    4    29    22    50   11    281
5     2     0    6   185   1  236     3     2    10   73      3
6    16    10    0    40   2    2  1450    48    43    1    296
7     2    27    1   495   6    2    16  6501    83    3    127
8     2     0    1   389   3    6    39   235  2180    5    434
9     8     0   43   104   1   69    21    20    17  200     10
10    5     1    3    38  11    2    57    99   128    1  12449
---- Validation: 
scalar performance:
{'acc': 0.8580179, 'precision': 0.7554729, 'recall': 0.6168574, 'specificity': 0.98355305, 'f1': 0.6629435, 'auroc': 0.97721326}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   207     5    1    39   0    2    54    55     6    7    107
1     0  1117    0    14   0    0     1   183     7    0     10
2     5     2  109    24  25    9    17    39    11   39     32
3     4     2    3  7558   3   26    13   543   261    3     24
4     0     2   33    25  84    1    35    25    39   12    283
5     6     0    5   187   0  221     4     1    15   79      3
6    11    11    1    31   0    1  1467    44    38    3    301
7     6    26    5   472   4    1    16  6480   102    7    146
8     2     0    0   391   9    5    22   243  2232    4    388
9     7     0   52   108   2   74    16    15    13  190     16
10    6     3    1    35  14    2    76   120   126    1  12412
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40005597, 'precision': 0.50288403, 'recall': 0.32501638, 'specificity': 0.938112, 'f1': 0.2790042, 'auroc': 0.8286708}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   433   14   0   11   0   2   402   243    5   0    60
1     1  511   0   13   0   0    31   894    1   0    48
2     1    3   1   16   1   0   187   251   13   0   542
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    15    1   0  1610
5    62    3   0  216   0  35   163    62   14   5    32
6     0    2   0    4   0   0  1483    62    9   0  1507
7     1    9   0    3   0   0    16  1123    0   0    12
8     0    0   0   76   0   0   231   155  490   0   418
9    34    5   3   99   1   3   316   521    7   2   146
10    0    0   0    1   0   0     6     0    0   0  1639
early stop counter: 1
val acc:0.8580179214477539, best validation acc: 0.8582319021224976, corresponding to test acc:                         0.4027845859527588 / 0.4027845859527588
after epoch: 29,now: 2024-07-21 15:35:52.366120,epoch time: 0:32:48.822446,used: 15:41:21.237063,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8594285, 'precision': 0.77652097, 'recall': 0.61484313, 'specificity': 0.9836525, 'f1': 0.6611985, 'auroc': 0.978054}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   162     7    0    45   0    4    76    56     6    6    121
1     0  1122    0    15   0    0     0   179     5    0     11
2     0     1  109    25  17   10    18    30    13   49     40
3     2     0    0  7577   2   26    11   528   258    7     27
4     0     1   21    28  77    4    35    21    46   11    295
5     4     0    4   169   0  235     5     3    13   84      3
6     4    14    1    27   0    4  1477    41    43    5    292
7     4    36    3   463   1    2    16  6452   118    6    163
8     0     0    2   364   3    6    35   206  2228    7    444
9     9     1   36    96   1   77    19    13    13  212     16
10    4     4    0    31   5    3    69    83   115    7  12471
---- Validation: 
scalar performance:
{'acc': 0.85922164, 'precision': 0.77836984, 'recall': 0.61642945, 'specificity': 0.98358685, 'f1': 0.66565025, 'auroc': 0.9772949}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   185     2   0    38   0    3    64    60     7    7    117
1     0  1119   0    17   0    0     4   172     5    0     15
2     3     0  98    25  21    8    17    36    12   49     43
3     1     1   2  7588   2   23    14   513   260    1     35
4     2     0  21    21  81    1    44    19    51    9    290
5     3     0   3   182   0  229     8     3    10   82      1
6     5    11   1    27   1    2  1462    44    39    4    312
7     2    38   2   504   2    0    22  6443    95    3    154
8     0     1   3   374   3    9    27   228  2215    4    432
9     7     0  35    98   3   65    16    20    10  224     15
10    4     2   3    33   6    2    62    89   115    2  12478
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40166515, 'precision': 0.51005465, 'recall': 0.3205282, 'specificity': 0.9379018, 'f1': 0.2748375, 'auroc': 0.8286178}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   287   19   0   16   0   2   534   246    4   0    62
1     1  569   0   15   0   0    34   825    1   0    54
2     0    4   1   15   1   0   219   208   12   0   555
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    11    1   0  1611
5    21    3   0  208   0  40   216    49   16   6    33
6     0    2   0    5   0   0  1602    44    7   0  1407
7     0   10   0    3   0   0    23  1115    0   0    13
8     0    0   0   68   0   0   257   135  485   0   425
9    14   10   2   96   1   5   379   461    8   2   159
10    0    0   0    0   0   0     7     0    0   0  1639
better model found
persisted
after epoch: 30,now: 2024-07-21 16:08:12.568710,epoch time: 0:32:20.202590,used: 16:13:41.439653,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:13:41.439653 at 2024-07-21 16:08:12.568710
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40166515, 'precision': 0.51005465, 'recall': 0.3205282, 'specificity': 0.9379018, 'f1': 0.2748375, 'auroc': 0.8286178}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   287   19   0   16   0   2   534   246    4   0    62
1     1  569   0   15   0   0    34   825    1   0    54
2     0    4   1   15   1   0   219   208   12   0   555
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    11    1   0  1611
5    21    3   0  208   0  40   216    49   16   6    33
6     0    2   0    5   0   0  1602    44    7   0  1407
7     0   10   0    3   0   0    23  1115    0   0    13
8     0    0   0   68   0   0   257   135  485   0   425
9    14   10   2   96   1   5   379   461    8   2   159
10    0    0   0    0   0   0     7     0    0   0  1639
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4027846, 'precision': 0.53229016, 'recall': 0.31826624, 'specificity': 0.9380019, 'f1': 0.27054927, 'auroc': 0.8285266}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   344   13   0   18   0   0   511   230    4   0    50
1     1  470   0   17   0   0    39   918    1   0    53
2     1    2   1   19   1   0   252   219   11   0   509
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    15    13    1   0  1603
5    33    3   0  220   0  29   222    43   13   3    26
6     0    2   0    5   0   0  1699    46    6   0  1309
7     1    9   0    4   0   0    25  1113    0   0    12
8     0    0   0   85   0   0   294   132  462   0   397
9    20    4   1  108   1   2   397   458    7   1   138
10    0    0   0    1   0   0     8     0    0   0  1637
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562330_instance_wise_predictions.txt
accuracy from prediction file 0.4016651507731057
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/3.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192993 KiB |   2149 MiB |   1684 TiB |   1684 TiB |
|       from large pool | 173952 KiB |   2130 MiB |   1658 TiB |   1658 TiB |
|       from small pool |  19041 KiB |     38 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 192993 KiB |   2149 MiB |   1684 TiB |   1684 TiB |
|       from large pool | 173952 KiB |   2130 MiB |   1658 TiB |   1658 TiB |
|       from small pool |  19041 KiB |     38 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 190583 KiB |   2147 MiB |   1684 TiB |   1684 TiB |
|       from large pool | 172814 KiB |   2128 MiB |   1658 TiB |   1658 TiB |
|       from small pool |  17769 KiB |     36 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2382 MiB |   2382 MiB |   2382 MiB |      0 B   |
|       from large pool |   2342 MiB |   2342 MiB |   2342 MiB |      0 B   |
|       from small pool |     40 MiB |     40 MiB |     40 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  65054 KiB | 244546 KiB |    932 TiB |    932 TiB |
|       from large pool |  57472 KiB | 244060 KiB |    907 TiB |    907 TiB |
|       from small pool |   7582 KiB |   9474 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4034    |    6277    |  250667 K  |  250663 K  |
|       from large pool |      76    |     251    |  160178 K  |  160178 K  |
|       from small pool |    3958    |    6126    |   90488 K  |   90484 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4034    |    6277    |  250667 K  |  250663 K  |
|       from large pool |      76    |     251    |  160178 K  |  160178 K  |
|       from small pool |    3958    |    6126    |   90488 K  |   90484 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     117    |     117    |     117    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |      20    |      20    |      20    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      24    |    1258    |  141181 K  |  141181 K  |
|       from large pool |      10    |      98    |  107156 K  |  107156 K  |
|       from small pool |      14    |    1248    |   34024 K  |   34024 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2149 MiB |   1684 TiB |   1684 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1658 TiB |   1658 TiB |
|       from small pool |      0 KiB |     38 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2149 MiB |   1684 TiB |   1684 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1658 TiB |   1658 TiB |
|       from small pool |      0 KiB |     38 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2147 MiB |   1684 TiB |   1684 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   1658 TiB |   1658 TiB |
|       from small pool |      0 KiB |     36 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   2382 MiB |   2382 MiB |   2130 MiB |
|       from large pool | 231424 KiB |   2342 MiB |   2342 MiB |   2116 MiB |
|       from small pool |  26624 KiB |     40 MiB |     40 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 244546 KiB |    932 TiB |    932 TiB |
|       from large pool |  30464 KiB | 244060 KiB |    907 TiB |    907 TiB |
|       from small pool |      0 KiB |  21843 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  250667 K  |  250667 K  |
|       from large pool |       2    |     251    |  160178 K  |  160178 K  |
|       from small pool |       0    |    6126    |   90488 K  |   90488 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  250667 K  |  250667 K  |
|       from large pool |       2    |     251    |  160178 K  |  160178 K  |
|       from small pool |       0    |    6126    |   90488 K  |   90488 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     117    |     117    |      93    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      13    |      20    |      20    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1258    |  141182 K  |  141182 K  |
|       from large pool |       3    |      98    |  107156 K  |  107156 K  |
|       from small pool |       0    |    1248    |   34025 K  |   34025 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2149 MiB |   1684 TiB |   1684 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1658 TiB |   1658 TiB |
|       from small pool |      0 KiB |     38 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2149 MiB |   1684 TiB |   1684 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1658 TiB |   1658 TiB |
|       from small pool |      0 KiB |     38 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2147 MiB |   1684 TiB |   1684 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   1658 TiB |   1658 TiB |
|       from small pool |      0 KiB |     36 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   2382 MiB |   2382 MiB |   2130 MiB |
|       from large pool | 231424 KiB |   2342 MiB |   2342 MiB |   2116 MiB |
|       from small pool |  26624 KiB |     40 MiB |     40 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 244546 KiB |    932 TiB |    932 TiB |
|       from large pool |  30464 KiB | 244060 KiB |    907 TiB |    907 TiB |
|       from small pool |      0 KiB |  21843 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  250667 K  |  250667 K  |
|       from large pool |       2    |     251    |  160178 K  |  160178 K  |
|       from small pool |       0    |    6126    |   90488 K  |   90488 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  250667 K  |  250667 K  |
|       from large pool |       2    |     251    |  160178 K  |  160178 K  |
|       from small pool |       0    |    6126    |   90488 K  |   90488 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     117    |     117    |      93    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      13    |      20    |      20    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1258    |  141182 K  |  141182 K  |
|       from large pool |       3    |      98    |  107156 K  |  107156 K  |
|       from small pool |       0    |    1248    |   34025 K  |   34025 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330

 Experiment start at: 2024-07-21 16:38:04.600617
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.61106056, 'precision': 0.31962657, 'recall': 0.21156345, 'specificity': 0.95039177, 'f1': 0.1925015, 'auroc': 0.83795565}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    60   0   0   2    64   0   0    357
1    0  41   0    69   0   0   0   727   0   0    495
2    0   0   0    86   0   0   0    38   4   0    184
3    0   1   0  5835   0   0   2  1717  43   0    839
4    0   0   0    68   0   0   0    15   3   0    453
5    0   0   0   411   0   0   0    23   6   0     81
6    0   1   0   214   0   0  20    42  22   0   1609
7    0   6   0  1465   0   0   1  4321  16   0   1454
8    0   0   0   793   0   0   7   219  57   0   2218
9    0   0   0   263   0   1   1    44  13   0    171
10   0   0   0   138   0   0   5    74  12   0  12565
---- Validation: 
scalar performance:
{'acc': 0.61251837, 'precision': 0.32576013, 'recall': 0.21272, 'specificity': 0.9505271, 'f1': 0.19420432, 'auroc': 0.8383417}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    56   0   0   1    64   0   0    362
1    0  52   0    63   0   0   1   712   1   0    503
2    0   0   0    93   0   0   0    42   6   0    171
3    0   3   0  5887   0   0   3  1642  41   0    864
4    0   0   0    60   0   0   0     6   1   0    472
5    0   0   0   418   0   0   1    28   8   0     66
6    0   2   0   213   0   0  23    40  24   0   1606
7    0   1   0  1464   0   0   2  4329  14   0   1455
8    0   0   0   777   0   0   5   225  45   0   2244
9    0   0   0   252   0   0   0    64  11   0    166
10   0   0   0   145   0   0   4    71  13   0  12563
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18099768, 'precision': 0.05944033, 'recall': 0.1656879, 'specificity': 0.9167625, 'f1': 0.059513494, 'auroc': 0.6362441}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   0   0   8   0   0   0   362   1   0   799
1    0   1   0   8   0   0   0  1012   0   0   478
2    0   0   0   1   0   0   0   188   0   0   826
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    39   0   0  1594
5    0   0   0  52   0   0   0   223   0   0   317
6    0   0   0   3   0   0   0   350   0   0  2714
7    0   2   0   6   0   0   0   997   0   0   159
8    0   1   0  35   0   0   1   262   0   0  1071
9    0   0   0  14   0   0   0   549   0   0   574
10   0   0   0   0   0   0   0    57   0   0  1589
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 17:11:43.663929,epoch time: 0:33:39.063312,used: 0:33:39.063312,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.67955375, 'precision': 0.49433666, 'recall': 0.27404466, 'specificity': 0.9600383, 'f1': 0.27937222, 'auroc': 0.9026014}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    3   0    64   0   0   17   111    3   0    285
1    0  331   0    28   0   0    0   849    0   0    124
2    0    1   0    89   0   0    4    51   12   0    155
3    0    4   0  6351   0   1    3  1648  117   0    313
4    0    0   0    60   0   0    5    18   10   0    446
5    0    0   0   424   0  11    7    27   19   2     31
6    0    9   0   145   0   0  245    71   43   0   1394
7    0   18   0  1069   0   0    3  5566   29   0    578
8    0    0   0   793   0   0   14   283  371   0   1833
9    0    0   0   272   0   6   18    52   19   3    123
10   0    1   0   113   0   0   15   121   24   0  12521
---- Validation: 
scalar performance:
{'acc': 0.67850745, 'precision': 0.5172391, 'recall': 0.27430388, 'specificity': 0.9599226, 'f1': 0.28024864, 'auroc': 0.90196455}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    0   0    74   0   0   12   102    2   0    293
1    0  344   0    40   0   0    1   838    0   0    109
2    0    0   0    91   0   0    7    50   11   0    153
3    0    1   0  6317   0   1    2  1694  113   0    312
4    0    0   0    67   0   0    5    11    8   0    448
5    0    0   0   430   0   7    8    23   20   1     32
6    0    7   0   172   0   0  249    72   43   0   1365
7    0   11   0  1106   0   0    4  5524   26   0    594
8    0    0   0   751   0   0   13   299  384   0   1849
9    0    1   0   285   0   4   25    61   16   5     96
10   0    1   0   114   0   0   13   108   24   0  12536
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19422095, 'precision': 0.1634653, 'recall': 0.1787193, 'specificity': 0.9184426, 'f1': 0.06376747, 'auroc': 0.69761115}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   8   0   4   0   0  14   722   2   0   420
1    0  18   0   6   0   0   0  1365   0   0   110
2    0   0   0   3   0   0   0   307   2   0   703
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    35   0   0  1598
5    0   1   0  55   0   0   1   381   2   0   152
6    0   0   0   3   0   0   8   348   0   0  2708
7    0  13   0   2   0   0   0  1108   0   0    41
8    0   1   0  29   0   0   5   333  15   0   987
9    0   0   0  14   0   0   0   841   1   0   281
10   0   0   0   0   0   0   0    19   0   0  1627
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 17:44:05.198596,epoch time: 0:32:21.534667,used: 1:06:00.597979,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7296929, 'precision': 0.5150312, 'recall': 0.34355223, 'specificity': 0.9666791, 'f1': 0.36428368, 'auroc': 0.92903155}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    7   0    71   0   1   33   126    3   0    242
1    0  740   0    34   0   0    3   496    2   0     56
2    0    2   0    96   0   2   24    53   12   3    120
3    0    5   0  6969   0   0    7  1136  163   1    158
4    0    0   0    79   0   0   12    16   16   0    416
5    0    0   0   425   0  28   15     9   17  12     15
6    0   21   0   125   0   1  594    71   42   1   1053
7    0   33   0  1120   0   0    5  5649   40   0    413
8    0    2   0   822   0   0   14   253  756   0   1448
9    0    2   0   282   0  16   44    51   21  23     54
10   0    3   0   107   0   0   27   103   41   0  12514
---- Validation: 
scalar performance:
{'acc': 0.7303464, 'precision': 0.512921, 'recall': 0.34598595, 'specificity': 0.9667592, 'f1': 0.36667544, 'auroc': 0.92836297}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   12   0    76   0   0   32   120    2   0    241
1    0  751   0    32   0   0    1   496    1   1     50
2    0    2   0    90   0   1   24    59   11   3    122
3    0    5   0  6985   0   2    1  1122  144   1    180
4    0    2   0    66   0   0   13    19   19   0    420
5    0    0   0   419   0  32   16     9   19  12     14
6    0   16   0   141   0   0  642    56   36   1   1016
7    0   38   0  1124   0   1    4  5669   49   0    380
8    0    1   0   831   0   0   18   248  718   0   1480
9    0    1   0   284   0  18   37    44   21  21     67
10   0    1   0   107   0   0   40   111   51   0  12486
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20667459, 'precision': 0.19615942, 'recall': 0.18844377, 'specificity': 0.91972095, 'f1': 0.08364904, 'auroc': 0.72803277}
confusion matrix:
    0    1   2   3   4   5   6     7   8   9     10
0    0   28   0   5   0   0  45   733   1   0   358
1    0  146   0  10   0   0   0  1254   0   0    89
2    0    4   0   9   0   0   1   314   3   0   684
3    0    0   0   0   0   0   0     0   0   0     0
4    0    0   0   1   0   0   0    26   0   0  1606
5    0    7   0  89   0   0   5   371   5   0   115
6    0    1   0   6   0   0  38   272   2   0  2748
7    0   37   0   3   0   0   0  1092   0   0    32
8    0    4   0  59   0   0  12   311  45   0   939
9    0   12   0  39   0   0   1   854   2   0   229
10   0    0   0   0   0   0   1    12   0   0  1633
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 18:16:19.413580,epoch time: 0:32:14.214984,used: 1:38:14.812963,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7533711, 'precision': 0.60754895, 'recall': 0.3796268, 'specificity': 0.96978015, 'f1': 0.40404105, 'auroc': 0.9414889}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    2    9   0    57   0   0   63   131    2   0    219
1    0  824   0    28   0   0    4   413    3   0     59
2    0    3   0    76   0   5   37    68   15   7    100
3    0    5   0  7019   0   7    9  1090  165   0    143
4    0    0   0    69   0   0   22    12   17   0    419
5    0    0   0   372   0  65   24     9   19  19     13
6    0   13   0    95   0   0  892    66   29   1    812
7    0   28   0   868   0   0    8  5970   36   0    355
8    0    1   0   725   0   1   26   273  896   0   1373
9    0    2   1   251   0  43   52    39   14  30     61
10   0    4   0    89   0   0   58   118   63   0  12460
---- Validation: 
scalar performance:
{'acc': 0.7526548, 'precision': 0.6196077, 'recall': 0.3824491, 'specificity': 0.9696256, 'f1': 0.40895882, 'auroc': 0.9425106}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    2   12   0    67   0   0   70   117    1   0    214
1    0  835   0    24   0   0    1   433    1   0     38
2    0    3   0    84   0   9   29    60    7   8    112
3    0    4   0  7053   0   5   10  1049  180   0    139
4    0    0   0    57   0   0   19    14   19   0    430
5    0    0   0   365   0  83   20    10   17  15     11
6    0   15   0    92   0   0  880    60   21   1    839
7    0   33   0   914   0   0   16  5862   40   0    400
8    0    0   0   693   0   0   32   283  877   0   1411
9    0    2   0   240   0  39   52    51   21  34     54
10   0    0   0    95   0   0   45   100   44   0  12512
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21346113, 'precision': 0.3385958, 'recall': 0.19356549, 'specificity': 0.9202666, 'f1': 0.091900475, 'auroc': 0.74477595}
confusion matrix:
    0    1   2   3   4   5    6     7   8   9     10
0    1   27   0   2   0   1  108   694   1   0   336
1    0  185   0   9   0   0    1  1216   0   0    88
2    0    3   0   7   0   0    3   300   3   0   699
3    0    0   0   0   0   0    0     0   0   0     0
4    0    0   0   1   0   0    0    18   0   0  1614
5    0    7   0  88   0   1   15   362   4   1   114
6    0    1   0   5   0   0   69   210   2   0  2780
7    0   37   0   3   0   0    0  1097   0   0    27
8    0    6   0  61   0   0   19   264  55   0   965
9    0   12   0  31   0   0    4   845   1   0   244
10   0    0   0   0   0   0    1     2   0   0  1643
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 18:48:48.513202,epoch time: 0:32:29.099622,used: 2:10:43.912585,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.77520335, 'precision': 0.6550868, 'recall': 0.40669358, 'specificity': 0.9728465, 'f1': 0.42857438, 'auroc': 0.9500548}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    6    7   0    73   0   0    98   121     1   0    177
1    0  933   0    24   0   0     0   335     1   1     38
2    0    2   2    76   0   4    59    57    20   3     89
3    0    7   0  7307   0   5    15   777   236   0     90
4    0    1   1    65   0   0    31    17    23   0    401
5    0    0   0   384   0  62    31    10    13  13      8
6    0   19   0    84   1   1  1038    57    46   0    662
7    0   37   0   947   0   0    10  5914    76   1    279
8    0    0   0   725   0   0    27   233  1263   0   1047
9    2    2   0   250   1  46    79    37    21  28     27
10   0    5   0    95   1   0    70   116    84   0  12421
---- Validation: 
scalar performance:
{'acc': 0.77424103, 'precision': 0.660089, 'recall': 0.4055841, 'specificity': 0.97268844, 'f1': 0.42801592, 'auroc': 0.9500907}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    6    7   0    70   0   0    92   107     7   0    194
1    0  916   0    21   0   0     3   354     2   0     36
2    0    2   1    84   0   5    42    60    18   4     96
3    0    4   0  7273   0   7    11   839   209   1     96
4    0    0   0    62   0   1    28    24    34   1    389
5    0    0   0   370   0  67    33     9    23  13      6
6    0   11   0    92   0   1  1048    56    47   0    653
7    0   31   0   982   0   0    15  5876    69   0    292
8    0    2   0   672   0   1    30   241  1286   0   1064
9    0    4   1   249   1  44    78    45    19  23     29
10   0    3   0    95   0   1    61   116    71   0  12449
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22864339, 'precision': 0.33893985, 'recall': 0.20554873, 'specificity': 0.92174506, 'f1': 0.1131268, 'auroc': 0.7598179}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    2   42   0    2   0   1  182   672    1   0   268
1    0  257   0   10   0   0    2  1154    0   0    76
2    0    8   0   13   0   0   10   302    9   0   673
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    0    16    0   0  1616
5    0    7   0  131   0   1   32   320   12   1    88
6    0    2   0    9   0   0  122   213    3   0  2718
7    0   45   0    5   0   0    0  1091    0   0    23
8    0    7   0   79   0   0   39   247  152   0   846
9    0   15   0   58   0   0   25   821    5   0   213
10   0    0   0    0   0   0    1     2    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 19:21:08.907265,epoch time: 0:32:20.394063,used: 2:43:04.306648,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7879923, 'precision': 0.71469635, 'recall': 0.44075632, 'specificity': 0.97453225, 'f1': 0.46943164, 'auroc': 0.95571566}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   22   10   0    56   0    1   103   110     2   0    179
1    0  972   0    23   0    0     1   305     3   0     28
2    0    1  10    60   1   10    54    53    21  19     83
3    0    4   0  7152   0   11    18   897   262   1     94
4    0    1   1    59   1    0    40    17    29   2    389
5    1    0   0   315   0  118    23     6    25  27      5
6    0   13   0    58   0    1  1190    56    35   1    554
7    0   28   0   765   0    0    20  6054    91   0    305
8    0    3   0   556   0    1    39   265  1441   0    990
9    1    5   4   206   0   68    83    28    15  48     35
10   0    7   0    82   0    0    82    93    84   0  12444
---- Validation: 
scalar performance:
{'acc': 0.78903306, 'precision': 0.65126324, 'recall': 0.442531, 'specificity': 0.9746997, 'f1': 0.470264, 'auroc': 0.9545389}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   25    7   0    52   0    1   120   104     1   1    172
1    0  980   0    17   0    0     2   301     3   0     29
2    1    2   5    59   0    9    70    58    18  12     78
3    0    7   0  7213   0    6    17   831   274   3     89
4    0    0   0    56   0    1    43    10    39   2    388
5    0    0   0   305   0  123    30     7    24  26      6
6    0   10   0    55   0    1  1194    58    40   2    548
7    0   37   1   776   0    1    24  6050    72   1    303
8    0    0   0   569   0    0    45   275  1416   1    990
9    1    4   6   198   0   73    78    33    19  56     25
10   0    3   0    72   0    0    91   118    76   0  12436
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24200657, 'precision': 0.34140557, 'recall': 0.21454756, 'specificity': 0.922737, 'f1': 0.12860563, 'auroc': 0.76953197}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   44   0    2   0   1  311   579    1   0   229
1    0  334   0    8   0   0    5  1075    0   0    77
2    0    9   0    5   0   0   19   273    9   0   700
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    15    1   0  1617
5    0    6   0  109   0   5   71   298   13   1    89
6    0    2   0    5   0   0  218   154    4   0  2684
7    1   49   0    2   0   0    5  1084    0   0    23
8    0    6   0   58   0   0   68   226  173   0   839
9    0   16   0   40   0   1   60   785    4   0   231
10   0    0   0    0   0   0    2     2    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 19:53:31.107277,epoch time: 0:32:22.200012,used: 3:15:26.506660,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7964737, 'precision': 0.7300857, 'recall': 0.45280015, 'specificity': 0.9755156, 'f1': 0.48783177, 'auroc': 0.958313}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   43     8   0    66   0    0    86    94     8   1    177
1    0  1005   0    19   0    0     1   274     2   0     31
2    0     1   7    60   3    5    36    62    25  30     83
3    0     2   0  7248   0    6    15   787   303   2     76
4    1     0   0    41   2    1    32    18    50   0    394
5    1     0   0   311   0  104    24     4    30  39      8
6    0    15   0    64   0    2  1099    48    55   3    621
7    0    35   0   751   0    0    14  6056    90   1    314
8    0     0   0   500   0    1    19   249  1643   1    883
9    2     6   2   191   0   46    55    39    33  83     36
10   0     1   0    68   0    0    52    83   109   1  12479
---- Validation: 
scalar performance:
{'acc': 0.7974321, 'precision': 0.7345705, 'recall': 0.45327485, 'specificity': 0.97563136, 'f1': 0.48691514, 'auroc': 0.9588922}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   37     9   0    62   0    0    86    92     4   0    193
1    0  1001   0    15   0    0     3   275     5   0     33
2    1     4   5    57   1    6    36    62    26  26     88
3    0     3   0  7235   0   10    16   774   320   0     82
4    0     0   0    45   3    0    36     7    44   1    403
5    0     0   0   304   0  106    23     2    35  45      6
6    1    13   0    61   0    1  1123    49    45   4    611
7    1    30   0   730   0    1    13  6092    93   3    302
8    0     1   0   510   0    3    18   249  1618   2    895
9    3     2   2   186   1   52    61    37    32  89     28
10   0     1   0    53   0    2    45    78   113   1  12503
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24802351, 'precision': 0.34929883, 'recall': 0.22178257, 'specificity': 0.9234352, 'f1': 0.13909253, 'auroc': 0.7751827}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    4   48   0    3   0   1  255   559    3   0   297
1    0  392   0    7   0   0    4  1015    0   0    81
2    0    9   0   10   0   0   15   247   10   0   724
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    11    1   0  1621
5    0    6   0  137   0   5   59   261   20   1   103
6    0    2   0    7   0   0  168   113    5   0  2772
7    1   48   0    4   0   0    1  1086    0   0    24
8    0    5   0   56   0   0   40   202  247   0   820
9    0   16   0   48   0   1   47   749    6   0   270
10   0    0   0    1   0   0    2     0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-21 20:25:55.605175,epoch time: 0:32:24.497898,used: 3:47:51.004558,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.80524933, 'precision': 0.6675306, 'recall': 0.47121733, 'specificity': 0.9767786, 'f1': 0.5057108, 'auroc': 0.96130216}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   45    10   0    57   0    0    81   119     6    3    162
1    0  1019   0    17   0    0     2   266     6    0     22
2    0     4  12    62   0    5    39    60    22   41     67
3    0     2   0  7256   0    7    16   813   280    2     60
4    0     1   7    53   0    1    41    20    40    4    372
5    2     0   1   297   0  109    15     7    20   65      5
6    2    14   0    54   0    1  1204    66    37    4    526
7    0    38   0   668   0    1     4  6273    64    2    215
8    0     2   0   524   0    0    18   296  1654    2    799
9    1     2   4   180   0   47    55    42    22  124     16
10   1     5   1    76   1    1    69   130   105    2  12401
---- Validation: 
scalar performance:
{'acc': 0.80444026, 'precision': 0.7509794, 'recall': 0.47277272, 'specificity': 0.97664684, 'f1': 0.50897753, 'auroc': 0.9611135}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   46     6   0    60   0    1    84   118     3    0    165
1    0  1026   0    16   0    0     3   267     3    0     17
2    1     3  13    52   0    6    44    62    25   38     68
3    0     4   0  7278   0    6    12   818   256    3     63
4    0     0   3    56   2    0    35    25    33    2    383
5    0     0   0   296   0  125    13     5    22   56      4
6    0    21   0    55   0    0  1213    58    54    3    504
7    1    42   0   696   1    1    13  6219    67    0    225
8    0     4   1   525   0    0    22   295  1622    5    822
9    1     3   3   188   0   47    47    43    20  115     26
10   1     3   0    69   0    1    74   134    99    0  12415
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2633457, 'precision': 0.36869055, 'recall': 0.23209894, 'specificity': 0.92500186, 'f1': 0.1524347, 'auroc': 0.7840778}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    8   63   0    3   0   1  305   607    3   0   180
1    0  478   0    7   0   0    4   946    0   0    64
2    0   11   0   11   0   0   21   301   10   0   661
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    16    0   0  1614
5    0    6   0  152   0   6   72   274   12   1    69
6    0    4   0    7   0   0  274   179    5   0  2598
7    1   52   0    4   0   0    1  1088    0   0    18
8    0   10   0   68   0   0   59   239  268   0   726
9    0   22   0   49   0   1   58   810    7   0   190
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-21 20:58:14.175249,epoch time: 0:32:18.570074,used: 4:20:09.574632,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8120987, 'precision': 0.7163036, 'recall': 0.48913333, 'specificity': 0.9777483, 'f1': 0.52766436, 'auroc': 0.96480787}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   61     3   0    60   0    2   124    94     5   0    134
1    0  1029   0    15   0    0     1   261     7   0     19
2    0     2  37    63   0    8    63    54    14  15     56
3    0     4   1  7402   0   12    24   680   265   2     49
4    0     2   7    53   1    0    63    23    43   3    344
5    0     0   3   290   0  145    24     4    18  35      2
6    1    15   0    62   0    1  1309    55    35   2    428
7    1    30   0   717   0    2    23  6191    80   1    219
8    0     0   1   535   1    2    40   273  1683   3    757
9    2     1  16   173   0   70    67    31    13  92     27
10   0     2   0    70   1    1   101   113   100   0  12403
---- Validation: 
scalar performance:
{'acc': 0.81136817, 'precision': 0.7428679, 'recall': 0.48391646, 'specificity': 0.97763693, 'f1': 0.51988447, 'auroc': 0.96331686}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   57     5   0    66   0    0   121    95     5   2    132
1    0  1032   0    23   1    0     4   245     4   1     22
2    0     0  25    54   2    7    64    56    16  19     69
3    0     3   0  7430   0   12    16   672   255   1     51
4    0     1   3    54   6    0    52    17    42   0    364
5    0     0   2   291   0  141    23     8    13  38      5
6    2    13   0    54   0    2  1324    49    34   1    429
7    0    28   0   730   0    2    17  6186    82   1    219
8    0     2   1   521   0    4    48   282  1671   1    766
9    1     1  11   177   0   82    71    32    16  83     19
10   0     4   0    73   0    3    94   114   128   2  12378
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2799972, 'precision': 0.38574693, 'recall': 0.23936449, 'specificity': 0.92632246, 'f1': 0.16509709, 'auroc': 0.7908761}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   12   49   0    4   0   1  456   511    3   0   134
1    0  469   0    9   0   0   12   943    0   0    66
2    0    8   0   14   0   0   58   280   10   0   645
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    15    0   0  1615
5    0    5   0  159   0   8  120   232   10   1    57
6    0    4   0    7   0   0  513   140    4   0  2399
7    1   47   0    4   0   0    8  1086    0   0    18
8    0    4   0   79   0   0  120   212  272   0   683
9    0   18   0   67   0   1  124   746    3   0   178
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-21 21:30:34.865687,epoch time: 0:32:20.690438,used: 4:52:30.265070,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8174497, 'precision': 0.7026671, 'recall': 0.5025729, 'specificity': 0.97839016, 'f1': 0.54227686, 'auroc': 0.965824}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   84     7   0    51   0    0    95    97     4    1    144
1    0  1033   0    11   1    0     7   255     4    0     21
2    0     1  20    39   6    3    50    57    26   42     68
3    0     3   0  7143   0   13    10   895   316    2     55
4    0     0   3    36   6    0    47    24    44    7    372
5    3     0   2   264   0  156    17     6    14   56      3
6    2    11   0    33   0    1  1286    65    46    5    459
7    0    28   2   467   2    2    12  6415    94    2    238
8    1     2   0   370   1    4    30   308  1866    1    713
9    4     0  13   153   2   67    45    39    21  130     19
10   0     3   0    44   4    2    80   128   118    0  12414
---- Validation: 
scalar performance:
{'acc': 0.814899, 'precision': 0.725189, 'recall': 0.49919856, 'specificity': 0.97805214, 'f1': 0.53967315, 'auroc': 0.96552646}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   87     2   0    42   0    1    87   100     5    3    156
1    0  1023   0    12   0    0     0   270     6    1     20
2    0     1  20    36   5   11    51    58    19   38     73
3    0     3   0  7131   1   14    18   863   344    3     63
4    0     1   4    46   8    0    49    23    41    6    361
5    3     1   0   258   0  147    15     7    20   65      5
6    2    15   0    42   0    3  1268    66    43    3    466
7    0    24   1   502   1    0    11  6396    91    4    235
8    1     0   0   420   0    1    30   291  1805    1    747
9    5     2   7   152   0   72    50    31    22  134     18
10   1     2   0    52   2    1    60   121   110    1  12446
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2755195, 'precision': 0.38323623, 'recall': 0.23941717, 'specificity': 0.92590344, 'f1': 0.16524726, 'auroc': 0.7924755}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   29   39   0    2   0   1  406   530    3   0   160
1    1  431   0    4   0   0   12   983    0   0    68
2    0    5   0    4   0   0   38   271   10   0   687
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    14    1   0  1617
5    2    5   0  127   0  11  111   247   13   2    74
6    0    2   0    6   0   0  419   137    5   0  2498
7    1   35   0    3   0   0    5  1102    0   0    18
8    0    3   0   49   0   0   93   214  303   0   708
9    1   14   0   35   0   1  107   763    7   0   209
10   0    0   0    1   0   0    2     0    0   0  1643
better model found
persisted
after epoch: 10,now: 2024-07-21 22:03:08.285122,epoch time: 0:32:33.419435,used: 5:25:03.684505,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.82140946, 'precision': 0.7069891, 'recall': 0.5131288, 'specificity': 0.97903955, 'f1': 0.5504533, 'auroc': 0.96623737}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   89     9   1    49   0    1    96   109     6   0    123
1    0  1064   0    14   0    0     5   226     5   0     17
2    2     0  35    43   5   11    44    63    19  26     64
3    0     3   0  7245   0   25    24   803   289   3     46
4    0     1  13    37   9    1    68    25    54   4    327
5    0     1   2   246   0  188    11     3    20  47      3
6    3    19   0    40   0    3  1327    57    46   3    410
7    1    39   1   539   1    2    11  6382    84   4    198
8    0     1   1   418   0    3    25   324  1884   2    638
9    7     3  28   146   0   98    45    33    19  98     16
10   1     5   1    54   3    1    94   130   123   1  12380
---- Validation: 
scalar performance:
{'acc': 0.82292366, 'precision': 0.74085796, 'recall': 0.51767635, 'specificity': 0.9791847, 'f1': 0.5564913, 'auroc': 0.96713495}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   77     5   0    57   0    3   104   100     4    1    132
1    0  1080   0    15   0    0     1   213     6    1     16
2    2     2  41    41   5   10    52    61    19   27     52
3    0     4   0  7266   0   20    19   797   288    0     46
4    0     2   8    43  12    5    64    27    42    1    335
5    3     0   1   240   0  201    20     4    18   31      3
6    2    18   0    45   0    3  1335    60    34    1    410
7    0    35   1   525   1    2    19  6392    93    1    196
8    0     2   1   433   0    4    33   313  1861    1    648
9    3     5  19   146   1  102    51    34    17  104     11
10   0     4   0    48   1    2    86   134   124    1  12396
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.30189604, 'precision': 0.39237627, 'recall': 0.2563243, 'specificity': 0.9285128, 'f1': 0.18763763, 'auroc': 0.7996001}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   44   59   0    3   0   1  444   507    3   0   109
1    1  571   0    4   0   0   10   859    0   0    54
2    0    8   0    8   0   0   72   307   10   0   610
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    16    1   0  1614
5    4    5   0  153   0  14  130   229   10   0    47
6    0    6   0    6   0   0  626   153    8   0  2268
7    1   49   0    3   0   0    5  1089    0   0    17
8    0    8   0   63   0   0  120   223  329   0   627
9    1   24   0   46   0   1  130   770    5   0   160
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-21 22:35:39.730670,epoch time: 0:32:31.445548,used: 5:57:35.130053,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8280715, 'precision': 0.7542209, 'recall': 0.5310255, 'specificity': 0.9797205, 'f1': 0.5707894, 'auroc': 0.9688672}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   99     6   0    50   0    2   107    69     6    2    142
1    0  1081   0    20   0    0     0   201     5    3     21
2    3     2  31    35   4    9    56    49    14   52     57
3    0     5   0  7423   0   20    16   627   299    3     45
4    0     1   4    40  13    0    64    13    48    8    348
5    2     0   0   245   0  174    12     1    17   68      2
6    1    12   0    31   0    5  1377    52    35    6    388
7    1    34   2   641   1    2    16  6229   105    3    230
8    0     1   0   423   0    4    33   255  1904    2    674
9    3     2   9   133   1   68    47    24    17  176     13
10   0     3   0    45   2    1    88    93   114    3  12443
---- Validation: 
scalar performance:
{'acc': 0.82875484, 'precision': 0.7580999, 'recall': 0.5275768, 'specificity': 0.97974163, 'f1': 0.5684782, 'auroc': 0.96774155}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   87     4   0    56   0    1    99    79     7    4    146
1    0  1092   0    17   0    0     1   203     6    0     13
2    3     0  29    50   7    9    38    48    18   45     65
3    0     4   0  7390   1   18    17   649   291    2     68
4    0     0   4    37  17    3    49    21    50    7    351
5    3     0   0   248   0  164    11     3    18   71      3
6    2    12   0    45   0    2  1354    57    35    7    394
7    1    29   0   597   2    3    22  6287    98    0    226
8    0     1   0   393   0    2    40   253  1936    4    667
9    1     2   7   147   1   57    45    16    20  174     23
10   0     3   0    48   2    1    93    93   103    0  12453
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.31406984, 'precision': 0.41103756, 'recall': 0.26399875, 'specificity': 0.9293678, 'f1': 0.20095892, 'auroc': 0.8017392}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   66   51   0    4   0   1  531   379    4   0   134
1    0  630   0    7   0   0   20   774    0   0    68
2    1    9   0   12   0   0   96   219   10   1   667
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1     9    1   0  1621
5    6    4   0  153   0  12  161   175   16   7    58
6    0    5   0    5   0   0  719    71    8   0  2259
7    1   52   0    4   0   0   17  1071    0   0    19
8    0    2   0   67   0   0  157   158  346   0   640
9    2   27   0   59   0   1  203   632    8   2   203
10   0    0   0    1   0   0    2     0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-21 23:08:11.111362,epoch time: 0:32:31.380692,used: 6:30:06.510745,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8305865, 'precision': 0.7392107, 'recall': 0.5372556, 'specificity': 0.98017955, 'f1': 0.57293624, 'auroc': 0.97099566}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   93     7   0    46   0    0   111    77     2    9    138
1    0  1092   0    17   0    0     2   201     5    2     13
2    1     2  36    32  14    3    42    51    16   73     42
3    1     5   1  7368   0   13    24   704   267    5     50
4    0     1   9    37  24    0    65    12    48   17    326
5    3     0   0   243   0  124     7     4    14  124      2
6    3    11   0    33   0    3  1398    52    32   13    363
7    1    31   5   559   1    1    27  6358    88    6    185
8    0     1   0   446   1    2    46   279  1927   10    584
9    2     2  11   130   1   34    33    24    16  229     11
10   0     3   1    54   3    2    86   130   115    3  12395
---- Validation: 
scalar performance:
{'acc': 0.8326869, 'precision': 0.76057863, 'recall': 0.54278237, 'specificity': 0.98037815, 'f1': 0.5806484, 'auroc': 0.9699494}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   98     2   0    60   1    1    89    81     2    5    144
1    0  1084   0    17   0    0     2   208     6    1     14
2    0     1  40    34   5    4    39    53    14   76     46
3    0     2   1  7388   2   18    25   681   271    7     45
4    0     1  11    40  20    0    60    22    52   15    318
5    1     0   1   249   1  133     7     4    15  107      3
6    2    11   0    33   0    2  1407    47    40    8    358
7    0    28   1   556   0    2    26  6381    82    5    184
8    0     0   0   417   1    1    36   294  1939    7    601
9    1     1  10   124   0   40    26    21    21  239     10
10   0     3   0    50   2    2   107   119   107    5  12401
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32778284, 'precision': 0.4128331, 'recall': 0.270774, 'specificity': 0.9307906, 'f1': 0.20792636, 'auroc': 0.80683744}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   73   46   0    4   0   1  538   408    4   0    96
1    0  600   0    5   0   0   19   817    0   0    58
2    1    7   0   12   0   0  109   255   12   1   618
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    4    15    2   0  1612
5    8    4   0  148   0  10  160   181   15  25    41
6    0    5   0    5   0   0  898   107    8   0  2044
7    1   41   0    3   0   0   14  1088    0   0    17
8    0    2   0   71   0   0  173   180  368   0   576
9    2   23   0   54   0   1  213   676    7   6   155
10   0    0   0    1   0   0    3     0    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-21 23:40:28.390695,epoch time: 0:32:17.279333,used: 7:02:23.790078,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8310948, 'precision': 0.75062096, 'recall': 0.53797257, 'specificity': 0.9799805, 'f1': 0.5821612, 'auroc': 0.97099376}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   110     4   0    49   1    1   101    75     4    2    136
1     0  1075   0    11   0    0     2   222     2    1     19
2     0     0  37    44  13    4    46    42    10   64     52
3     0     1   0  7537   1   16    16   587   219    3     56
4     0     1   6    41  27    0    67    19    31   10    337
5     3     1   3   241   0  152    12     2    12   92      3
6     2     9   0    40   0    2  1396    52    29    3    374
7     1    24   1   640   1    3    16  6285    72    4    214
8     0     1   0   465   0    2    51   253  1797    7    720
9     3     1  16   145   2   37    32    20    10  204     23
10    2     2   0    57   6    0   102    98    84    2  12443
---- Validation: 
scalar performance:
{'acc': 0.8296108, 'precision': 0.7369747, 'recall': 0.53314734, 'specificity': 0.9797834, 'f1': 0.5755087, 'auroc': 0.9705733}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   106     5   0    49   0    0   104    79     2    7    131
1     0  1076   0    14   0    0     3   216     5    1     17
2     2     3  36    38  11    3    43    46    10   63     57
3     1     0   0  7563   1   15    19   565   216    4     56
4     1     1  10    43  19    0    62    14    39    9    341
5     2     0   2   244   0  149    12     4    16   90      2
6     6    12   0    43   1    2  1403    45    22    6    368
7     3    24   2   657   0    3    21  6241    72    7    235
8     0     1   1   484   2    0    38   237  1780    6    747
9     4     0  13   141   0   39    40    25    13  196     22
10    1     0   0    55   5    0    77   111    99    2  12446
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.31714827, 'precision': 0.4188457, 'recall': 0.2631653, 'specificity': 0.9296167, 'f1': 0.2011445, 'auroc': 0.8053308}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   87   30   0    5   0   1  553   363    4   0   127
1    0  566   0    9   0   0   25   831    0   0    68
2    1    4   0   12   0   0  102   212    9   1   674
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    2     9    0   0  1622
5    9    4   0  170   0  10  174   142   12  11    60
6    0    2   0    5   0   0  840    65    4   0  2151
7    1   29   0    4   0   0   18  1092    0   0    20
8    0    1   0   79   0   0  173   155  292   0   670
9    3   12   0   73   0   1  234   590    3   3   218
10   0    0   0    1   0   0    2     0    0   0  1643
early stop counter: 1
val acc:0.8296108245849609, best validation acc: 0.8326869010925293, corresponding to test acc:                         0.32778283953666687 / 0.32778283953666687
after epoch: 14,now: 2024-07-22 00:12:57.349319,epoch time: 0:32:28.958624,used: 7:34:52.748702,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8329677, 'precision': 0.7468033, 'recall': 0.54448354, 'specificity': 0.98023933, 'f1': 0.5913569, 'auroc': 0.9714971}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   110     5   0    59   1    4    91    74     3    2    134
1     0  1092   1    14   0    0     4   203     5    1     12
2     2     1  50    44  14    6    38    49    13   48     47
3     0     2   0  7513   1   21    15   619   214    4     49
4     0     1  10    42  34    0    43    24    40    9    336
5     3     0   2   227   1  176    11     6    10   80      5
6     3    11   0    39   1    2  1361    55    41    4    390
7     1    25   0   634   2    4    17  6310    65    6    198
8     0     1   3   496   3    6    23   237  1866    5    656
9     6     2  14   145   2   65    27    23    11  182     16
10    1     2   0    53   5    0    78   109   100    6  12439
---- Validation: 
scalar performance:
{'acc': 0.83632475, 'precision': 0.7528281, 'recall': 0.55112946, 'specificity': 0.9806483, 'f1': 0.597787, 'auroc': 0.97056675}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   114     4   0    61   0    1    79    80    10    5    129
1     0  1099   0    17   0    0     2   194     4    1     15
2     2     1  51    45  21    7    29    46     9   55     46
3     0     5   0  7543   0   23    16   608   198    1     46
4     0     1   7    45  33    1    55    20    35   13    329
5     5     0   0   237   0  181     8     0     8   75      7
6     4    15   0    38   0    3  1402    47    29    4    366
7     1    35   2   590   2    1    15  6358    73    0    188
8     0     1   2   511   2    2    30   247  1852    6    643
9     4     1  16   136   1   62    25    26    14  193     15
10    0     1   0    57   5    2    65   111   109    6  12440
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32694325, 'precision': 0.4241093, 'recall': 0.27378395, 'specificity': 0.9308548, 'f1': 0.21493807, 'auroc': 0.8089449}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   112   41   0    5   0   1  498   393    4   0   116
1     1  645   0    9   0   0   17   767    0   0    60
2     0    7   0   14   1   0   89   241   10   1   652
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    1   0   0    2    12    0   0  1618
5    15    4   0  188   0  20  136   156   12  11    50
6     0    5   0    7   0   0  823    84    7   0  2141
7     1   36   0    4   0   0   13  1092    0   0    18
8     0    3   0   86   0   0  146   178  335   0   622
9     3   24   0   81   0   1  195   636    5   3   189
10    0    0   0    1   0   0    2     0    0   0  1643
better model found
persisted
after epoch: 15,now: 2024-07-22 00:45:30.656780,epoch time: 0:32:33.307461,used: 8:07:26.056163,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.837409, 'precision': 0.74773896, 'recall': 0.55967754, 'specificity': 0.9808673, 'f1': 0.60608685, 'auroc': 0.97143644}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   129     3   1    55   0    4    81    61     4    3    142
1     0  1105   0    14   0    0     3   183     9    0     17
2     3     0  49    35  23   18    24    48    12   48     52
3     2     7   0  7489   0   21    22   553   292    1     53
4     0     2   5    37  44    2    52    16    42    6    333
5     3     0   0   213   1  219     8     4    13   55      5
6     9    12   0    30   0    2  1374    54    45    7    375
7     1    45   1   628   2    3    16  6233   120    2    211
8     0     1   2   415   1    3    23   235  2029    5    582
9     6     2  18   134   3   79    33    20    14  170     14
10    2     2   3    41   5    1    72    83   123    1  12458
---- Validation: 
scalar performance:
{'acc': 0.8387321, 'precision': 0.7493202, 'recall': 0.5557736, 'specificity': 0.9809855, 'f1': 0.6023799, 'auroc': 0.97126496}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   132     5   0    48   0    1    86    60     6    2    143
1     0  1115   0    16   0    0     0   181     6    1     13
2     4     2  42    37  16    8    29    45    16   49     64
3     1     1   1  7480   0   22    23   577   282    2     51
4     1     1  10    34  44    2    44    22    47    4    330
5     3     0   4   227   0  200    11     3    17   52      4
6     5    16   0    35   1    2  1374    48    51    8    368
7     3    37   2   611   1    4    20  6282    91    0    214
8     0     1   0   418   1    5    26   210  2044    4    587
9     3     1  19   140   4   81    25    20    14  166     20
10    1     2   1    41   4    1    67    81   120    1  12477
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34226546, 'precision': 0.397503, 'recall': 0.28800854, 'specificity': 0.93223155, 'f1': 0.23530327, 'auroc': 0.8099241}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   165   47   0    5   0   1  505   317    4   0   126
1     1  739   0   10   0   0   18   668    1   0    62
2     2   10   0   13   1   0   92   200   12   1   684
3     0    0   0    0   0   0    0     0    0   0     0
4     0    1   0    0   0   0    2     7    2   0  1621
5    26    5   0  171   0  29  155   121   21   4    60
6     0    4   0    4   0   0  847    61   11   0  2140
7     1   51   0    5   0   0   15  1072    0   0    20
8     0    4   0   70   0   0  147   144  397   0   608
9     9   33   0   73   0   3  235   551    9   0   224
10    0    0   0    1   0   0    2     0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-22 01:17:58.034426,epoch time: 0:32:27.377646,used: 8:39:53.433809,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.83976346, 'precision': 0.752101, 'recall': 0.5641333, 'specificity': 0.9811904, 'f1': 0.6076107, 'auroc': 0.9723779}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   136     6   0    46   0    3   105    59     1    4    123
1     0  1119   0    14   0    0     3   178     4    0     14
2     0     1  44    31  14   13    34    44    15   58     58
3     0     4   1  7467   1   25    19   616   265    3     37
4     0     0   8    35  42    1    59    25    47   12    310
5     3     0   0   216   2  206     6     2    10   73      3
6     4     7   0    29   1    3  1400    48    29    5    381
7     3    52   2   540   2    3    26  6313    99    5    218
8     0     3   0   394   2   10    36   250  2011    4    586
9     6     3  16   114   3   72    30    18    15  196     20
10    1     4   1    43   3    2    80    86   118    1  12453
---- Validation: 
scalar performance:
{'acc': 0.84204894, 'precision': 0.762947, 'recall': 0.57010585, 'specificity': 0.9814169, 'f1': 0.618367, 'auroc': 0.97230464}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   129    11   1    42   0    0    98    60     9    2    131
1     0  1114   0    18   0    0     3   176     5    0     16
2     5     2  61    27  17   10    36    48    12   36     58
3     0     4   0  7470   2   21    17   588   290    2     46
4     0     0   8    35  56    0    60    17    42   10    311
5     2     0   3   213   0  214     8     3    15   61      2
6     3    12   0    25   1    6  1421    48    40    1    351
7     1    49   3   530   3    2    16  6339    93    4    225
8     0     3   0   384   5    6    22   231  2030    2    613
9     6     2  15   121   3   89    29    18    15  180     15
10    1     1   1    43   6    2    77    97   101    1  12466
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.35639822, 'precision': 0.42585635, 'recall': 0.29303437, 'specificity': 0.933455, 'f1': 0.23895413, 'auroc': 0.81283647}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   125   50   0    5   0   1   566   318    4   0   101
1     0  784   0    8   0   0    21   626    1   0    59
2     1   11   0   10   0   0   129   207   11   1   645
3     0    0   0    0   0   0     0     0    0   0     0
4     0    1   0    0   0   0     5     8    2   0  1617
5    13    5   0  165   0  29   180   126   19   6    49
6     0    6   0    5   0   0  1054    54    9   0  1939
7     1   56   0    4   0   0    22  1063    0   0    18
8     0    3   0   67   0   0   186   148  395   0   571
9     4   39   0   67   0   3   278   550    8   2   186
10    0    0   0    1   0   0     3     0    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-22 01:50:14.673600,epoch time: 0:32:16.639174,used: 9:12:10.072983,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.84532857, 'precision': 0.75535965, 'recall': 0.57313126, 'specificity': 0.9820994, 'f1': 0.615777, 'auroc': 0.97387266}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   128     7   0    44   0    0    98    75    11    7    113
1     0  1106   0    12   0    0     6   188     7    1     12
2     2     1  81    35   8    3    36    43    19   46     38
3     1     2   0  7432   1   18    19   644   287    6     27
4     1     1  18    34  34    0    64    19    46   11    310
5     5     0   5   218   0  168     9     2    19   94      1
6     2    10   0    35   0    2  1445    51    45    6    312
7     2    41   1   486   1    1    20  6444   116    4    147
8     0     4   0   361   0    4    33   247  2205    5    436
9     5     3  34   120   4   50    25    21    21  199     11
10    2     3   0    43   6    1   106   130   148    2  12353
---- Validation: 
scalar performance:
{'acc': 0.84517854, 'precision': 0.7556329, 'recall': 0.57536477, 'specificity': 0.98207223, 'f1': 0.6186248, 'auroc': 0.9736381}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   128     1   1    58   0    1    95    69     5    3    122
1     0  1107   1    14   0    0     1   189     9    0     11
2     2     1  81    27  15    4    36    45    19   43     39
3     0     4   1  7452   1   17    20   633   275    6     31
4     0     0  24    33  43    0    55    24    61   12    287
5     4     0   1   213   0  172    11     1    18   99      2
6     4    11   1    31   0    1  1438    46    46    5    325
7     1    39   4   473   0    3    21  6450   116    2    156
8     0     2   4   380   1    3    41   245  2168    7    445
9     4     2  34   116   2   53    31    26    12  205      8
10    2     5   2    37   3    1    90   134   165    4  12353
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3719303, 'precision': 0.4264428, 'recall': 0.2995087, 'specificity': 0.9350761, 'f1': 0.24240038, 'auroc': 0.817155}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   118   42   0    5   0   1   581   351    4   0    68
1     0  699   0    7   0   0    22   724    1   0    46
2     0    8   0   12   0   0   153   249   20   1   572
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     5    18    3   0  1607
5    13    5   0  171   0  16   188   132   25  12    30
6     0    5   0    4   0   0  1269    88   14   0  1687
7     1   37   0    3   0   0    17  1091    0   0    15
8     0    3   0   64   0   0   200   168  480   0   455
9     5   29   0   69   0   1   281   602   10   3   137
10    0    0   0    1   0   0     5     0    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-22 02:22:48.251247,epoch time: 0:32:33.577647,used: 9:44:43.650630,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.84428513, 'precision': 0.76430655, 'recall': 0.57225806, 'specificity': 0.9817893, 'f1': 0.61892915, 'auroc': 0.97420913}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   135     4   0    58   0    0    90    56     6    8    126
1     0  1105   0    23   0    0     2   180     5    1     16
2     4     2  47    39  23    6    32    42    14   61     42
3     0     4   0  7661   2   16    15   490   210    8     29
4     0     0  12    41  61    1    65    17    42   11    289
5     3     0   1   207   0  201    10     4    13   78      4
6     4    13   0    35   0    2  1435    47    40    3    329
7     1    32   2   696   4    1    18  6222   105    2    181
8     0     1   1   465   4    3    43   205  2075    6    493
9     4     0   8   127   3   70    24    23    14  207     13
10    3     1   1    64   3    2    84    98   126    4  12407
---- Validation: 
scalar performance:
{'acc': 0.84413534, 'precision': 0.7539024, 'recall': 0.56880575, 'specificity': 0.98176235, 'f1': 0.615602, 'auroc': 0.974459}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   140     3   0    61   0    2    93    60     7    2    115
1     0  1112   0    19   0    0     3   180     2    0     16
2     2     2  52    36  18    5    35    42    13   54     53
3     2     2   0  7659   1   23    11   472   225    5     40
4     1     2  13    30  58    0    60    17    57   14    287
5     4     0   0   212   1  188    11     2    15   87      1
6     4     8   0    43   1    2  1441    48    32    4    325
7     3    41   1   687   3    3    23  6241    81    2    180
8     0     0   0   465   8    5    25   222  2053    5    513
9     5     1  17   130   4   68    30    20    17  188     13
10    1     2   1    54   5    1    82   103   119    2  12426
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37165046, 'precision': 0.4750856, 'recall': 0.3009653, 'specificity': 0.93508613, 'f1': 0.25001994, 'auroc': 0.81786096}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   191   31   0   10   0   1   555   301    4   0    77
1     1  684   0   17   0   0    25   718    1   0    53
2     3    7   0   20   0   0   158   214   13   1   599
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    11    2   0  1614
5    29    5   0  210   0  22   175    92   17  10    32
6     0    4   0    8   0   0  1260    58    9   0  1728
7     1   31   0    6   0   0    20  1089    0   0    17
8     0    2   0   88   1   0   207   150  421   0   501
9    10   24   0   99   0   2   300   535    8   3   156
10    0    0   0    1   0   0     4     0    0   0  1641
early stop counter: 1
val acc:0.8441353440284729, best validation acc: 0.8451785445213318, corresponding to test acc:                         0.3719303011894226 / 0.3719303011894226
after epoch: 19,now: 2024-07-22 02:55:01.092802,epoch time: 0:32:12.841555,used: 10:16:56.492185,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.849101, 'precision': 0.7613607, 'recall': 0.58589154, 'specificity': 0.9823807, 'f1': 0.6342159, 'auroc': 0.9746101}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   166     1   0    36   0    1    92    62     6    2    117
1     0  1085   1    14   0    0     5   203     6    0     18
2     3     2  74    35  18    4    34    38    12   46     46
3     1     1   1  7574   1   16    17   495   290    6     36
4     1     1  22    24  52    3    51    20    55   10    300
5     3     0   4   194   0  208    11     1    20   77      3
6     6     7   0    37   1    0  1435    39    51    4    328
7     1    19   2   590   1    4    27  6326   116    5    172
8     4     3   0   373   1    5    22   205  2168    3    510
9     6     1  24   102   4   77    25    21    21  198     14
10    0     2   2    41   5    2    65   103   121    2  12450
---- Validation: 
scalar performance:
{'acc': 0.84975255, 'precision': 0.7578459, 'recall': 0.59037566, 'specificity': 0.9825051, 'f1': 0.63647753, 'auroc': 0.9746148}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   165     2   0    44   0    0    90    56     7    2    117
1     0  1094   0    16   0    0     4   202     7    0      9
2     8     0  86    33  21    4    25    34    12   43     46
3     0     3   2  7527   1   26    15   542   285    5     34
4     0     0  19    35  42    2    59    15    44   10    313
5     4     0   2   195   0  211     4     3    19   78      5
6     6    11   0    23   1    3  1444    46    56    6    312
7     4    24   5   568   2    2    18  6354   113    4    171
8     2     1   1   362   0    6    35   202  2199    6    482
9     4     1  25   106   2   74    33    14    19  202     13
10    2     1   0    36   3    3    73    79   150    5  12444
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37584832, 'precision': 0.4778, 'recall': 0.30702943, 'specificity': 0.9354682, 'f1': 0.25860897, 'auroc': 0.818423}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   253   22   0    7   0   1   531   269    5   0    82
1     1  589   0   12   0   0    29   806    1   0    61
2     3    4   0   13   0   0   153   208   17   1   616
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6     9    2   0  1615
5    49    4   0  175   0  29   170    92   25  11    37
6     0    2   0    5   0   0  1259    52   12   0  1737
7     1   16   0    4   0   0    22  1104    0   0    17
8     0    0   0   65   1   0   196   133  492   0   483
9    18    8   0   71   0   3   311   535   13   4   174
10    0    0   0    1   0   0     4     0    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-22 03:27:16.342623,epoch time: 0:32:15.249821,used: 10:49:11.742006,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8490208, 'precision': 0.7523333, 'recall': 0.59819686, 'specificity': 0.9824407, 'f1': 0.644907, 'auroc': 0.9748031}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   198     6   2    39   2    0    52    63     6    2    113
1     0  1115   0    12   0    0     3   185     6    0     11
2    10     0  83    25  18    9    17    44    14   46     46
3     1     3   2  7406   1   28    10   651   295    2     39
4     1     0  30    30  65    0    32    19    55    9    298
5     2     0   3   188   1  246     5     3    19   50      4
6    18    12   0    48   0    1  1395    43    49    4    338
7     3    37   2   484   2    2    12  6451   102    2    166
8     0     1   0   342   8   10    24   257  2205    3    446
9    11     1  31   112   4  104    17    18    18  167     10
10    2     6   0    39   4    2    71   109   154    2  12402
---- Validation: 
scalar performance:
{'acc': 0.850448, 'precision': 0.75372267, 'recall': 0.5977771, 'specificity': 0.9826215, 'f1': 0.6450205, 'auroc': 0.97548497}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   187     2   1    48   0    3    54    61     8    4    115
1     0  1091   1    12   0    0     0   210     7    0     11
2     6     1  82    29  18    8    13    48    16   39     52
3     3     4   1  7473   1   30    15   612   273    2     26
4     0     1  15    34  70    2    36    22    61    8    290
5     6     0   3   177   1  243     3     3    15   68      2
6    16     9   1    23   2    7  1383    54    48    8    357
7     2    33   3   455   1    5    14  6468   116    5    163
8     4     2   0   341   3    7    19   255  2221    7    437
9    18     1  28   104   3   91    17    19    22  181      9
10    5     2   1    36  11    3    73   114   152    4  12395
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37990624, 'precision': 0.44109228, 'recall': 0.3205551, 'specificity': 0.93628275, 'f1': 0.27424067, 'auroc': 0.819661}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   374   30   0    4   0   2   379   298    5   0    78
1     1  694   0    8   0   0    17   727    1   0    51
2     8    7   0   11   1   1   111   239   18   1   618
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     4    12    2   0  1614
5    80    5   0  158   0  43   123   110   30   6    37
6     1    4   0    4   0   0  1049    81   16   0  1912
7     1   25   0    3   0   0    14  1104    0   0    17
8     2    2   0   60   1   0   141   164  522   0   478
9    38   23   0   68   1   7   220   599   12   2   167
10    0    0   0    1   0   0     4     0    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-22 03:59:47.064300,epoch time: 0:32:30.721677,used: 11:21:42.463683,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.84813786, 'precision': 0.7562983, 'recall': 0.5838995, 'specificity': 0.982406, 'f1': 0.62786007, 'auroc': 0.97514457}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   161     3   0    41   0    2   101    62     4    5    104
1     0  1084   0    12   0    0     5   212     6    0     13
2     4     1  55    31  17    8    38    36    11   63     48
3     0     3   0  7516   1   35    19   610   228    3     24
4     0     1  15    38  58    3    66    19    43   11    285
5     2     0   1   192   1  235     4     4    13   67      2
6     8     8   0    28   1    5  1492    43    31    4    288
7     1    14   1   521   4    7    30  6464    87    5    128
8     0     2   0   422   4    7    49   274  2057    7    473
9     4     1  13   104   2  104    29    26    11  190      9
10    1     1   1    42  10    2    99   130   115    3  12388
---- Validation: 
scalar performance:
{'acc': 0.8494048, 'precision': 0.758214, 'recall': 0.58891344, 'specificity': 0.98252654, 'f1': 0.63467, 'auroc': 0.97465587}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   160     7   0    39   1    3    90    60     3    1    119
1     0  1081   0    13   0    0     5   215     5    1     12
2     3     0  56    30  26   12    37    51    11   49     37
3     4     1   0  7541   1   26    21   589   219    4     34
4     0     0  13    36  73    1    61    21    38   14    282
5     7     0   2   187   1  238     7     5    11   61      2
6     7     7   0    23   0    2  1494    46    40    7    282
7     2    20   2   525   3    2    22  6477    79    0    133
8     1     1   0   470   2   12    53   245  2041    8    463
9     4     1  18   100   2   97    27    17    12  201     14
10    3     3   0    40   9    7    98   121   118    4  12393
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3869027, 'precision': 0.48024848, 'recall': 0.3081684, 'specificity': 0.9364912, 'f1': 0.25766638, 'auroc': 0.8220928}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   211   22   0    6   0   1   578   299    4   0    49
1     0  575   0   12   0   0    31   833    1   0    47
2     3    4   0   15   0   1   195   235   12   1   549
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     7    16    2   0  1607
5    36    4   0  170   0  40   190   101   17   7    27
6     0    2   0    6   0   0  1531    72    8   0  1448
7     1   13   0    3   0   0    22  1109    0   0    16
8     0    1   0   79   1   0   247   160  422   0   460
9    14    7   0   72   0   7   324   570    7   3   133
10    0    0   0    1   0   0     7     0    0   0  1638
new oracle model saved
early stop counter: 1
val acc:0.8494048118591309, best validation acc: 0.8504480123519897, corresponding to test acc:                         0.37990623712539673 / 0.38690268993377686
after epoch: 22,now: 2024-07-22 04:32:13.395474,epoch time: 0:32:26.331174,used: 11:54:08.794857,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.84837866, 'precision': 0.7613729, 'recall': 0.58781785, 'specificity': 0.98203105, 'f1': 0.63812613, 'auroc': 0.9749893}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   178     3   0    40   0    3    69    45     5    3    137
1     1  1105   1    15   0    0     4   180     5    1     20
2     3     2  84    31  16    5    21    39    10   44     57
3     0     2   1  7600   2   23    16   507   230    9     47
4     0     0  20    31  47    1    40    19    41    4    336
5     5     0   3   197   1  203     9     1    12   87      3
6     8    11   0    32   1    4  1389    45    37    4    377
7     2    24   3   529   0    2    14  6375    96    5    214
8     1     2   3   406   4    4    27   230  2000    4    614
9     9     0  31   115   3   59    18    17    11  212     18
10    2     2   2    32   7    2    67    94    68    0  12516
---- Validation: 
scalar performance:
{'acc': 0.84782666, 'precision': 0.76997274, 'recall': 0.5904746, 'specificity': 0.98197204, 'f1': 0.64098823, 'auroc': 0.97551966}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   171     4   1    51   0    0    62    47     5    2    140
1     1  1107   0    14   0    0     3   182     5    1     19
2     6     1  88    30  16    9    15    36     7   45     59
3     5     5   1  7591   1   26    19   527   220    3     42
4     0     0  18    35  49    0    41    19    33   11    333
5     4     0   2   205   0  215     6     3     7   75      4
6     5    13   0    34   0    1  1390    41    36    8    380
7     6    36   1   549   1    1    20  6381    68    4    198
8     2     3   1   424   2    6    27   224  1997    7    603
9     9     2  31   114   1   51    21    16    17  215     16
10    2     3   2    45   5    1    72    80    92    2  12492
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36017632, 'precision': 0.46527854, 'recall': 0.30065566, 'specificity': 0.9340834, 'f1': 0.25236216, 'auroc': 0.8173321}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   298   30   0   10   0   1   452   262    5   0   112
1     1  703   0   14   0   0    22   698    1   0    60
2     1    7   0   15   0   0   110   185    9   1   687
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     3     8    0   0  1621
5    56    5   0  191   0  22   147    81   16  13    61
6     0    4   0    5   0   0  1005    50    6   0  1997
7     1   23   0    3   0   0    17  1101    0   0    19
8     0    0   0   76   0   0   162   139  373   0   620
9    27   22   0   78   1   2   248   509    8   2   240
10    0    0   0    1   0   0     2     0    0   0  1643
early stop counter: 2
val acc:0.8478266596794128, best validation acc: 0.8504480123519897, corresponding to test acc:                         0.37990623712539673 / 0.38690268993377686
after epoch: 23,now: 2024-07-22 05:04:30.846598,epoch time: 0:32:17.451124,used: 12:26:26.245981,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.85405076, 'precision': 0.77086914, 'recall': 0.60614824, 'specificity': 0.98306274, 'f1': 0.6535985, 'auroc': 0.9763942}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   156     2    0    35   0    0    87    75    10    7    111
1     0  1111    0    14   0    0     2   189     4    1     10
2     4     2  103    29  16    7    33    37    13   37     31
3     5     3    0  7387   1   29    12   693   273    7     25
4     0     0   24    29  70    1    55    22    36    9    293
5     6     1    1   168   3  253     4     3    11   69      2
6     3     8    0    26   0    3  1483    45    36    3    300
7     2    20    2   400   4    2    17  6586    78    4    150
8     0     2    1   349   6    5    41   281  2145    8    458
9     2     0   30   103   4   88    28    26    14  188     10
10    2     2    1    32   6    2    86   104   119    1  12439
---- Validation: 
scalar performance:
{'acc': 0.851197, 'precision': 0.7620973, 'recall': 0.5991093, 'specificity': 0.9826982, 'f1': 0.6439018, 'auroc': 0.9759649}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   144     1   2    37   1    2    90    76     8    7    115
1     0  1115   0    11   0    0     0   185     6    1     14
2     1     2  81    21  22   14    30    43    13   47     38
3     0     3   1  7408   2   35    16   676   258    4     37
4     0     2  27    27  62    2    55    25    41    8    290
5     4     0   2   175   1  250     7     0    12   67      3
6     4    12   1    30   0    3  1467    45    38    6    302
7     4    27   2   431   4    3    14  6539    93    2    146
8     0     0   2   353   1   12    35   283  2111    4    495
9     5     1  22   100   1   81    24    16    11  218     14
10    1     2   4    36   8    2    73   129   110    4  12427
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3913804, 'precision': 0.4654162, 'recall': 0.31414193, 'specificity': 0.93692786, 'f1': 0.26401016, 'auroc': 0.82260597}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   187   30   0    6   0   2   571   306    5   0    63
1     0  708   0    6   0   0    27   708    1   0    49
2     0    7   0    8   0   1   169   230   12   1   587
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    13    1   0  1613
5    26    5   0  156   0  40   192   104   22  16    31
6     0    3   0    4   0   0  1457    58   10   0  1535
7     0   17   0    3   0   0    18  1110    0   0    16
8     0    2   0   64   1   0   226   156  446   1   474
9     8   21   0   60   1   6   318   555    7   6   155
10    0    0   0    1   0   0     6     0    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-22 05:36:57.950421,epoch time: 0:32:27.103823,used: 12:58:53.349804,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.85637844, 'precision': 0.77862304, 'recall': 0.6091497, 'specificity': 0.9834162, 'f1': 0.6559937, 'auroc': 0.9759984}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   192     3   0    32    1    1    62    67     9    4    111
1     0  1108   0    13    0    0     3   192     5    1      8
2     6     3  41    24   36    6    24    48    20   70     34
3     6     3   0  7409    0   25    11   664   294    0     27
4     0     0   4    29  121    3    43    29    51    9    250
5     3     0   2   177    0  226     4     3    18   85      3
6     5     6   0    29    2    5  1452    54    40    7    308
7     2    23   1   417    4    3    14  6558   111    1    129
8     1     1   0   327    6    8    23   256  2276    5    393
9     7     0  11    98    3   68    18    19    18  236     15
10    4     2   0    30   11    1    85   122   146    3  12389
---- Validation: 
scalar performance:
{'acc': 0.8542464, 'precision': 0.7665387, 'recall': 0.6009966, 'specificity': 0.9831689, 'f1': 0.646045, 'auroc': 0.97657007}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   182     3   0    37   2    0    72    73     5    7    102
1     1  1103   0    15   0    0     5   191     6    0     11
2     5     1  39    23  42    7    24    50    16   63     42
3     1     1   0  7417   1   21    15   651   296    6     31
4     1     0   6    24  94    1    34    22    66   16    275
5     3     0   1   188   2  224     3     2    13   81      4
6     5     6   0    29   1    2  1440    54    54    8    309
7     2    20   1   410   8    4    20  6556   113    6    125
8     1     1   0   315   6    4    28   254  2272    6    409
9     6     0  12    93   8   68    13    23    20  239     11
10    1     2   0    44  11    2    98   122   145    1  12370
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.39669767, 'precision': 0.4403649, 'recall': 0.3214972, 'specificity': 0.9377094, 'f1': 0.2729466, 'auroc': 0.82426256}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   275   24   0    6   0   2   494   303    5   0    61
1     1  657   0   10   0   0    23   760    1   0    47
2     2    6   0   11   1   0   149   250   19   1   576
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    15    2   0  1610
5    51    5   0  165   0  30   160   100   31  21    29
6     0    3   0    4   0   0  1406    79   14   0  1561
7     1   13   0    3   0   0    17  1114    0   0    16
8     0    2   0   59   3   0   189   161  542   0   414
9    17   12   0   63   2   4   292   583   11   5   148
10    0    0   0    1   0   0     5     0    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-22 06:09:23.464552,epoch time: 0:32:25.514131,used: 13:31:18.863935,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.85720783, 'precision': 0.77127475, 'recall': 0.6117022, 'specificity': 0.9834025, 'f1': 0.65758896, 'auroc': 0.97704613}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   202     3   1    39   0    5    58    47     6    2    120
1     0  1129   0    17   0    0     7   160     6    0     13
2     4     0  84    20  16    8    27    46    20   41     46
3     4     0   1  7529   0   25    18   539   291    3     27
4     1     0  21    21  64    2    54    20    60   12    284
5     5     0   5   169   0  249     2     3    18   69      1
6    11    16   0    28   1    4  1446    40    52    3    307
7     5    36   2   483   2    4    15  6396   128    4    186
8     0     1   1   338   1    5    21   215  2264    8    441
9     8     1  25   102   1   91    17    18    19  199     12
10    3     3   1    31   6    4    60    82   127    1  12477
---- Validation: 
scalar performance:
{'acc': 0.856734, 'precision': 0.7678014, 'recall': 0.6119085, 'specificity': 0.98331577, 'f1': 0.65742284, 'auroc': 0.97684497}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   208     3   0    38   0    3    53    51     6    3    118
1     0  1127   0    15   0    0     1   174     6    1      8
2     9     1  95    21  14    6    13    39    23   50     41
3     2     3   1  7541   1   30    15   543   271    1     32
4     1     2  18    26  54    4    38    20    56   11    309
5     6     0   2   179   2  247     4     3    15   60      3
6    13    14   1    27   0    3  1436    38    51    1    324
7     8    33   3   482   3    4    12  6443   116    3    158
8     3     0   1   353   1    7    23   222  2235    6    445
9     9     0  31    98   2   89    20    22    18  193     11
10    5     2   0    36   4    1    68    97   128    5  12450
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40376407, 'precision': 0.45420724, 'recall': 0.33350912, 'specificity': 0.9384598, 'f1': 0.28917587, 'auroc': 0.823775}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   365   39   0    9   0   2   437   236    5   0    77
1     1  827   0   12   0   0    19   588    1   0    51
2     4    8   0   13   0   1   137   199   17   1   635
3     0    0   0    0   0   0     0     0    0   0     0
4     0    1   0    0   1   0     5     8    2   0  1616
5    71    5   0  176   0  35   148    67   32  17    41
6     0    4   0    5   0   0  1266    50   12   0  1730
7     1   37   0    3   0   0    18  1088    0   0    17
8     1    3   0   62   1   0   165   132  543   0   463
9    39   35   0   73   1   5   283   491   14   5   191
10    0    0   0    1   0   0     4     0    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-22 06:41:44.381451,epoch time: 0:32:20.916899,used: 14:03:39.780834,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.85779643, 'precision': 0.7823041, 'recall': 0.6124329, 'specificity': 0.98357487, 'f1': 0.6584046, 'auroc': 0.97747666}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   181     4    1    36   0    3    82    61     6    1    108
1     0  1115    0    12   0    0     3   185     7    1      9
2     3     0  111    25   9    7    27    31    16   41     42
3     2     1    0  7542   0   21    17   592   236    3     23
4     0     0   30    27  57    2    69    16    51    5    282
5     1     0    1   185   0  226    11     3    13   78      3
6     7    12    0    29   0    4  1506    36    43    6    265
7     3    21    2   488   1    2    22  6499   105    3    117
8     0     1    0   375   1    8    43   240  2232    1    395
9     4     1   39   103   1   76    18    21    18  200     12
10    1     3    1    36   7    1   109   110   130    2  12392
---- Validation: 
scalar performance:
{'acc': 0.85705495, 'precision': 0.75886375, 'recall': 0.60615814, 'specificity': 0.9834754, 'f1': 0.6496929, 'auroc': 0.97697634}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   168     3    0    38   0    2    96    69     4    4     99
1     0  1115    0    17   0    0     1   178     7    1     13
2     3     2  105    29  16   11    25    42    11   33     35
3     1     4    0  7554   2   25    19   568   234    2     31
4     0     1   33    30  51    2    54    29    41   11    287
5     3     0    2   188   0  219     8     2    16   80      3
6     8     9    0    30   1    1  1513    36    44    2    264
7     3    23    2   464   2    1    22  6525    91    4    128
8     1     0    1   368   3    8    40   248  2199    4    424
9    12     0   47   101   4   73    17    13    12  202     12
10    1     3    1    39   6    0   105   103   144    4  12390
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4150983, 'precision': 0.4740057, 'recall': 0.32653812, 'specificity': 0.9392124, 'f1': 0.27693516, 'auroc': 0.82642454}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   222   26   0    8   0   1   596   268    5   0    44
1     0  721   0   13   0   0    31   689    1   0    44
2     2    7   0   14   0   0   210   223   15   1   543
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    10    13    2   0  1607
5    34    5   0  185   0  29   208    73   21  11    26
6     0    3   0    5   0   0  1713    53   10   0  1283
7     1   16   0    3   0   0    22  1106    0   0    16
8     0    2   0   70   1   0   263   140  499   0   395
9    12   19   0   76   1   3   366   508   11   4   137
10    0    0   0    1   0   0     7     0    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-22 07:14:03.318838,epoch time: 0:32:18.937387,used: 14:35:58.718221,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8571811, 'precision': 0.7656094, 'recall': 0.6203104, 'specificity': 0.98344994, 'f1': 0.66646206, 'auroc': 0.9773494}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   201     3    1    38   0    4    68    55     8    3    102
1     1  1113    0    12   0    0     3   184     6    0     12
2     8     0  107    28  21    9    20    36    11   31     41
3     3     6    0  7511   3   24    12   590   266    1     23
4     1     0   28    26  79    6    44    29    46    7    273
5     6     0    5   171   0  265     4     3    13   53      1
6     8    10    2    27   4    3  1509    49    37    1    258
7     3    30    5   480   2    4    15  6482    93    5    146
8     2     2    3   384   6    7    29   239  2174    4    444
9     8     1   40   101   4   91    18    15    17  182     16
10    5     4    1    35   8    1    86   125   109    2  12415
---- Validation: 
scalar performance:
{'acc': 0.8585262, 'precision': 0.7686636, 'recall': 0.62103975, 'specificity': 0.9835672, 'f1': 0.6678386, 'auroc': 0.9778741}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   203     3    0    38   0    2    57    60     7    2    111
1     0  1132    1    18   0    0     3   168     2    0      8
2     7     0  105    24  21   10    22    38    13   29     43
3     1     3    0  7521   1   28    11   575   268    2     30
4     0     1   29    35  80    2    44    17    43   11    277
5     5     0    3   173   0  261     5     3    17   52      2
6    11     9    0    32   2    4  1472    40    44    6    288
7     6    36    2   465   2    3    22  6489    93    4    143
8     3     1    1   348   2    5    22   239  2218    3    454
9    12     0   38    97   1   90    19    19    18  185     14
10    7     3    0    30  15    2    79   106   120    4  12430
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42426363, 'precision': 0.46253997, 'recall': 0.34070724, 'specificity': 0.94039565, 'f1': 0.29520294, 'auroc': 0.82733244}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   329   40   0    7   0   2   491   246    5   0    50
1     1  830   0   10   0   0    20   593    1   0    44
2     4    9   0   13   0   0   178   224   15   1   571
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    13    2   0  1611
5    63    6   0  181   0  41   174    69   20   9    29
6     0    4   0    5   0   0  1605    60   11   0  1382
7     1   31   0    3   0   0    18  1095    0   0    16
8     0    4   0   68   2   1   222   147  519   0   407
9    30   35   0   73   1   7   314   520   10   5   142
10    0    0   0    1   0   0     6     0    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-22 07:46:30.374963,epoch time: 0:32:27.056125,used: 15:08:25.774346,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.8598566, 'precision': 0.77381, 'recall': 0.6224007, 'specificity': 0.9839051, 'f1': 0.669001, 'auroc': 0.9774641}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   198     2   1    30   0    3    76    60    10    6     97
1     0  1099   0    10   0    0     3   199    11    0     10
2     8     2  93    17  22   10    21    45    16   37     41
3     2     1   0  7387   2   33    16   660   317    1     18
4     2     0  15    24  80    2    48    27    56    8    277
5     4     0   2   179   1  243     7     5    14   62      4
6     5     7   0    23   1    2  1524    47    39    5    255
7     3    27   3   390   4    2    22  6567   105    0    139
8     2     1   0   276   3    4    27   240  2389    7    347
9    10     0  31    94   2   74    22    17    20  212     11
10    2     4   2    32  14    0    96   124   171    2  12346
---- Validation: 
scalar performance:
{'acc': 0.85914135, 'precision': 0.76893514, 'recall': 0.6196445, 'specificity': 0.98387825, 'f1': 0.6651454, 'auroc': 0.97826385}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   204     2   1    39   0    3    70    62     3    3     96
1     0  1106   1    12   0    0     3   192     9    1      8
2     6     2  82    20  24    7    28    46    20   42     35
3     1     0   1  7412   1   26    19   635   321    2     22
4     1     0  15    30  88    2    54    22    59    4    264
5     4     1   3   174   2  240     7     1    15   71      3
6     9     7   0    20   2    4  1529    44    49    5    239
7     2    19   0   386   2    1    20  6585   124    3    123
8     1     0   1   303   3    6    34   255  2338    5    350
9    16     0  25    90   4   95    15    14    15  206     13
10    5     2   1    32  10    1   105   135   174    2  12329
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42755195, 'precision': 0.45681804, 'recall': 0.33928514, 'specificity': 0.94063187, 'f1': 0.2910949, 'auroc': 0.82887965}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   308   25   0    5   0   1   522   263    5   0    41
1     1  679   0    9   0   0    28   739    1   0    42
2     5    6   0   10   0   0   204   243   22   1   524
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0    10    16    2   0  1604
5    56    5   0  159   0  34   187    80   31  15    25
6     0    3   0    4   0   0  1736    68   19   0  1237
7     1   11   0    3   0   0    19  1116    0   0    14
8     0    1   0   55   2   0   235   150  596   0   331
9    24   13   0   62   1   5   341   542   14   4   131
10    0    0   0    1   0   0     8     0    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-22 08:18:50.676325,epoch time: 0:32:20.301362,used: 15:40:46.075708,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.8627461, 'precision': 0.76744634, 'recall': 0.6335362, 'specificity': 0.9842119, 'f1': 0.67639875, 'auroc': 0.9782478}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   187     2    2    36   0    2    88    57     7    2    100
1     0  1133    0    10   0    0     7   162     6    1     12
2     1     2  121    27  25    7    21    30    18   35     25
3     4     3    3  7576   2   34    13   505   265    6     28
4     0     1   39    23  90    2    43    12    52   11    266
5     2     0    8   150   1  256     6     2    14   77      5
6     9    12    0    25   3    1  1518    38    38    6    258
7     3    34   10   508   3    3    28  6433   106    1    135
8     2     2    2   364   5    6    31   210  2293    9    370
9     4     1   37    92   5   77    14    21    17  216      9
10    1     3    0    30  13    5    83    99   133    2  12423
---- Validation: 
scalar performance:
{'acc': 0.8643841, 'precision': 0.77420086, 'recall': 0.63734746, 'specificity': 0.98437375, 'f1': 0.68204284, 'auroc': 0.9784702}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   189     3    0    33    0    2    75    67     4    2    108
1     0  1128    1    14    0    0     1   169    10    0      9
2     3     0  127    23   27    8    19    29     9   39     28
3     1     1    2  7588    1   30    14   500   264    4     35
4     0     1   29    27  101    2    46    19    58    7    249
5     3     0    4   170    0  248     6     1    12   74      3
6     5     9    0    28    1    5  1527    41    43    4    245
7     2    39   11   484    5    3    15  6459   103    6    138
8     0     0    4   350    3    8    35   195  2302    5    394
9     5     2   42    84    1   79    17    13    19  219     12
10    5     3    1    35   22    3    86    79   134    1  12427
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43007067, 'precision': 0.45753044, 'recall': 0.3424884, 'specificity': 0.9407785, 'f1': 0.29745987, 'auroc': 0.8288068}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   264   35   0   11   0   2   567   237    5   0    49
1     0  823   0   14   0   0    29   587    1   0    45
2     2    8   0   14   1   1   197   202   20   2   568
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   2   0     8    10    2   0  1611
5    38    5   0  175   0  42   197    53   31  24    27
6     0    3   0    5   0   0  1691    44   14   0  1310
7     0   29   0    3   0   0    21  1095    0   0    16
8     0    3   0   61   4   1   235   122  584   0   360
9    18   30   2   89   1   7   363   453   13   8   153
10    0    0   0    1   0   0     7     0    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-22 08:51:24.000920,epoch time: 0:32:33.324595,used: 16:13:19.400303,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:13:19.400303 at 2024-07-22 08:51:24.000920
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43007067, 'precision': 0.45753044, 'recall': 0.3424884, 'specificity': 0.9407785, 'f1': 0.29745987, 'auroc': 0.8288068}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   264   35   0   11   0   2   567   237    5   0    49
1     0  823   0   14   0   0    29   587    1   0    45
2     2    8   0   14   1   1   197   202   20   2   568
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   2   0     8    10    2   0  1611
5    38    5   0  175   0  42   197    53   31  24    27
6     0    3   0    5   0   0  1691    44   14   0  1310
7     0   29   0    3   0   0    21  1095    0   0    16
8     0    3   0   61   4   1   235   122  584   0   360
9    18   30   2   89   1   7   363   453   13   8   153
10    0    0   0    1   0   0     7     0    0   0  1638
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43007067, 'precision': 0.45753044, 'recall': 0.3424884, 'specificity': 0.9407785, 'f1': 0.29745987, 'auroc': 0.8288068}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   264   35   0   11   0   2   567   237    5   0    49
1     0  823   0   14   0   0    29   587    1   0    45
2     2    8   0   14   1   1   197   202   20   2   568
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   2   0     8    10    2   0  1611
5    38    5   0  175   0  42   197    53   31  24    27
6     0    3   0    5   0   0  1691    44   14   0  1310
7     0   29   0    3   0   0    21  1095    0   0    16
8     0    3   0   61   4   1   235   122  584   0   360
9    18   30   2   89   1   7   363   453   13   8   153
10    0    0   0    1   0   0     7     0    0   0  1638
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_38_04_seed_1_22562330_instance_wise_predictions.txt
accuracy from prediction file 0.4300706639613797
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193451 KiB |   2149 MiB |   3368 TiB |   3368 TiB |
|       from large pool | 173046 KiB |   2130 MiB |   3317 TiB |   3317 TiB |
|       from small pool |  20405 KiB |     38 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 193451 KiB |   2149 MiB |   3368 TiB |   3368 TiB |
|       from large pool | 173046 KiB |   2130 MiB |   3317 TiB |   3317 TiB |
|       from small pool |  20405 KiB |     38 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191311 KiB |   2147 MiB |   3368 TiB |   3368 TiB |
|       from large pool | 172814 KiB |   2128 MiB |   3317 TiB |   3317 TiB |
|       from small pool |  18497 KiB |     36 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2376 MiB |   2382 MiB |   4506 MiB |   2130 MiB |
|       from large pool |   2336 MiB |   2342 MiB |   4452 MiB |   2116 MiB |
|       from small pool |     40 MiB |     40 MiB |     54 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  33877 KiB | 244546 KiB |   1883 TiB |   1883 TiB |
|       from large pool |  17418 KiB | 244060 KiB |   1832 TiB |   1832 TiB |
|       from small pool |  16459 KiB |  21843 KiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    5868    |    7846    |  501336 K  |  501330 K  |
|       from large pool |      76    |     251    |  320357 K  |  320357 K  |
|       from small pool |    5792    |    7728    |  180978 K  |  180972 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5868    |    7846    |  501336 K  |  501330 K  |
|       from large pool |      76    |     251    |  320357 K  |  320357 K  |
|       from small pool |    5792    |    7728    |  180978 K  |  180972 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     117    |     117    |     210    |      93    |
|       from large pool |      97    |      97    |     183    |      86    |
|       from small pool |      20    |      20    |      27    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    1258    |  279017 K  |  279017 K  |
|       from large pool |       9    |     100    |  211329 K  |  211329 K  |
|       from small pool |      25    |    1248    |   67688 K  |   67688 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2149 MiB |   3368 TiB |   3368 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   3317 TiB |   3317 TiB |
|       from small pool |      0 KiB |     38 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2149 MiB |   3368 TiB |   3368 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   3317 TiB |   3317 TiB |
|       from small pool |      0 KiB |     38 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2147 MiB |   3368 TiB |   3368 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   3317 TiB |   3317 TiB |
|       from small pool |      0 KiB |     36 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB |   2382 MiB |   4506 MiB |   4284 MiB |
|       from large pool | 190464 KiB |   2342 MiB |   4452 MiB |   4266 MiB |
|       from small pool |  36864 KiB |     40 MiB |     54 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 244546 KiB |   1883 TiB |   1883 TiB |
|       from large pool |  30464 KiB | 244060 KiB |   1832 TiB |   1832 TiB |
|       from small pool |      0 KiB |  30720 KiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7846    |  501336 K  |  501336 K  |
|       from large pool |       2    |     251    |  320357 K  |  320357 K  |
|       from small pool |       0    |    7728    |  180978 K  |  180978 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7846    |  501336 K  |  501336 K  |
|       from large pool |       2    |     251    |  320357 K  |  320357 K  |
|       from small pool |       0    |    7728    |  180978 K  |  180978 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |     117    |     210    |     183    |
|       from large pool |       9    |      97    |     183    |     174    |
|       from small pool |      18    |      20    |      27    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1258    |  279019 K  |  279019 K  |
|       from large pool |       3    |     100    |  211329 K  |  211329 K  |
|       from small pool |       0    |    1248    |   67689 K  |   67689 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2149 MiB |   3368 TiB |   3368 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   3317 TiB |   3317 TiB |
|       from small pool |      0 KiB |     38 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2149 MiB |   3368 TiB |   3368 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   3317 TiB |   3317 TiB |
|       from small pool |      0 KiB |     38 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2147 MiB |   3368 TiB |   3368 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   3317 TiB |   3317 TiB |
|       from small pool |      0 KiB |     36 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB |   2382 MiB |   4506 MiB |   4284 MiB |
|       from large pool | 190464 KiB |   2342 MiB |   4452 MiB |   4266 MiB |
|       from small pool |  36864 KiB |     40 MiB |     54 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 244546 KiB |   1883 TiB |   1883 TiB |
|       from large pool |  30464 KiB | 244060 KiB |   1832 TiB |   1832 TiB |
|       from small pool |      0 KiB |  30720 KiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7846    |  501336 K  |  501336 K  |
|       from large pool |       2    |     251    |  320357 K  |  320357 K  |
|       from small pool |       0    |    7728    |  180978 K  |  180978 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7846    |  501336 K  |  501336 K  |
|       from large pool |       2    |     251    |  320357 K  |  320357 K  |
|       from small pool |       0    |    7728    |  180978 K  |  180978 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |     117    |     210    |     183    |
|       from large pool |       9    |      97    |     183    |     174    |
|       from small pool |      18    |      20    |      27    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1258    |  279019 K  |  279019 K  |
|       from large pool |       3    |     100    |  211329 K  |  211329 K  |
|       from small pool |       0    |    1248    |   67689 K  |   67689 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_21_18_seed_2_22562330

 Experiment start at: 2024-07-22 09:21:18.274631
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.59642553, 'precision': 0.38217205, 'recall': 0.20724201, 'specificity': 0.9485901, 'f1': 0.19008282, 'auroc': 0.82277316}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   1   0    66   0   0   2    71   0   0    343
1    0  61   0    46   2   0   1   807   0   0    415
2    0   0   0    92   0   0   0    41   0   0    179
3    0   3   0  5525   0   0   2  1759  28   0   1121
4    0   0   0    64   0   0   0    13   0   0    462
5    0   0   0   395   0   0   0    17   1   0    108
6    0   0   0   261   0   0  29    95   7   1   1515
7    0   3   0  1359   0   0   5  4150   4   0   1741
8    0   0   0  1065   0   0   5   222  50   0   1954
9    0   0   0   264   0   0   0    45   3   1    179
10   0   0   0   180   0   0   4   111  22   0  12476
---- Validation: 
scalar performance:
{'acc': 0.5966029, 'precision': 0.33721465, 'recall': 0.20728736, 'specificity': 0.9486096, 'f1': 0.1900465, 'auroc': 0.823529}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   3   0    64   0   0   3    81   0   0    332
1    0  59   0    56   0   0   2   797   2   0    416
2    0   0   0    89   1   1   0    39   0   0    182
3    0   2   0  5544   0   0   3  1749  28   0   1114
4    0   0   0    73   0   0   0    19   4   0    443
5    0   0   0   387   0   0   0    13   3   1    117
6    0   1   0   246   0   0  35    87  12   0   1527
7    0   3   0  1371   0   0   2  4162   4   0   1723
8    0   0   0  1040   0   0   1   221  47   0   1987
9    0   0   0   250   0   0   0    52   3   0    188
10   0   0   0   189   0   0   5   126  19   0  12457
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.16959351, 'precision': 0.064240605, 'recall': 0.15167074, 'specificity': 0.9154688, 'f1': 0.05454217, 'auroc': 0.6373418}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   0   0   0   0   0   0  610   0   0   560
1    0   0   0   0   0   0   0  996   0   0   503
2    0   0   0   1   0   0   0  188   1   0   825
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   0   0   0   0   10   0   0  1623
5    0   0   0  44   0   0   0  291   2   0   255
6    0   0   0   0   0   0   0   45   0   0  3022
7    0   0   0   0   0   0   0  777   0   0   387
8    0   0   0  12   0   0   0  132   2   0  1224
9    0   0   0   9   0   0   0  494   1   0   633
10   0   0   0   0   0   0   0    1   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 09:54:58.720719,epoch time: 0:33:40.446088,used: 0:33:40.446088,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_21_18_seed_2_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6805704, 'precision': 0.40323162, 'recall': 0.2793864, 'specificity': 0.9604025, 'f1': 0.28479648, 'auroc': 0.9045765}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   13   0    83   0   0   21   118    2   0    246
1    0  432   0    39   0   1    7   746    4   0    102
2    0    1   0   110   0   0    3    64    4   0    130
3    0   12   0  6684   0   0    4  1362  106   0    272
4    0    0   0    82   0   0    2    11    9   0    435
5    0    1   0   463   0   1    5     8   13   0     30
6    0   19   0   210   0   0  280    81   35   0   1283
7    0   20   0  1432   1   0    1  5189   27   0    594
8    0    1   0  1092   0   0   10   216  395   0   1580
9    0    4   0   350   0   3   14    37    8   0     77
10   0    0   0   175   0   0   22   100   38   0  12456
---- Validation: 
scalar performance:
{'acc': 0.68153, 'precision': 0.41821903, 'recall': 0.28003377, 'specificity': 0.9605248, 'f1': 0.28612363, 'auroc': 0.9037004}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    8   0    86   0   0   18   121    2   0    248
1    0  435   0    38   0   0    3   761    1   0     94
2    0    0   0   117   0   2    3    64    4   0    122
3    0    7   0  6713   0   0    4  1362  112   0    242
4    0    0   0    70   0   0    4     9   14   0    442
5    0    2   0   451   0   2    9     8   13   1     35
6    0   12   0   200   0   0  264    80   36   0   1316
7    0   21   0  1461   0   0    4  5166   30   0    583
8    0    1   0  1042   0   0    9   239  431   0   1574
9    0    2   0   338   0   2   16    46    7   0     82
10   0    0   0   155   0   0   16   111   46   0  12468
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19652978, 'precision': 0.14952353, 'recall': 0.18069892, 'specificity': 0.9186008, 'f1': 0.07052265, 'auroc': 0.69563645}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   6   0   0   0   0   6   787   1   0   370
1    0  13   0   3   0   0   0  1334   1   0   148
2    0   0   0   3   0   0   0   306   3   0   703
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    21   0   0  1612
5    0   1   0  77   0   0   0   363  15   0   136
6    0   3   0   0   0   0   1    89   1   0  2973
7    0   9   0   2   0   0   1  1080   0   0    72
8    0   1   0  35   0   0   2   246  73   0  1013
9    0   0   0  23   0   0   0   770   3   0   341
10   0   0   0   0   0   0   0     4   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 10:27:33.647095,epoch time: 0:32:34.926376,used: 1:06:15.372464,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_21_18_seed_2_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7153521, 'precision': 0.49334282, 'recall': 0.32084566, 'specificity': 0.9648004, 'f1': 0.334941, 'auroc': 0.9273315}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   10   0    91   0   0   45   108    3   0    226
1    0  671   0    43   0   0    1   544    2   0     71
2    0    1   0   121   0   2   13    51    9   0    115
3    0    3   0  7084   0   0    4  1032  123   0    192
4    0    0   0    76   0   0    3    10   16   0    434
5    0    1   0   449   0  11   19     6   12   6     16
6    0   14   0   165   0   0  501    83   19   0   1125
7    0   29   0  1362   0   0    2  5380   28   0    462
8    0    0   0  1030   0   0   14   232  579   0   1440
9    0    5   0   338   0   7   37    23   11   4     68
10   0    0   0   124   0   0   24   108   31   0  12507
---- Validation: 
scalar performance:
{'acc': 0.71592885, 'precision': 0.48057452, 'recall': 0.32214522, 'specificity': 0.9648846, 'f1': 0.3363558, 'auroc': 0.9292959}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   16   0    89   0   0   37   122    2   0    217
1    0  673   0    32   0   0    4   565    0   0     58
2    0    2   0   116   0   1   11    53    8   1    120
3    0   10   0  7067   0   1    3  1050  113   0    196
4    0    0   0    73   0   0    5    10   12   0    439
5    0    0   0   441   0  12   16     6   17  12     17
6    0   19   0   156   0   0  504    84   27   1   1117
7    0   25   0  1293   0   0    2  5425   27   0    493
8    0    2   0  1044   0   0   20   191  590   1   1448
9    0    4   0   329   0   7   43    33   10   6     61
10   0    2   0   134   0   1   30   103   38   0  12488
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20072763, 'precision': 0.18518843, 'recall': 0.18407312, 'specificity': 0.9190233, 'f1': 0.07701346, 'auroc': 0.7206204}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0  26   0    2   0   0  23   728   0   0   391
1    0  59   0    4   0   0   0  1308   1   0   127
2    0   0   0    2   0   0   2   280   2   0   729
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    17   0   0  1616
5    0   2   0  116   0   0   2   325   9   0   138
6    0   2   0    4   0   0  12    76   0   0  2973
7    0  19   0    2   0   0   1  1086   0   0    56
8    0   1   0   54   0   0   3   228  69   0  1015
9    0   2   0   33   0   0   2   768   2   0   330
10   0   0   0    0   0   0   0     3   0   0  1643
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-22 11:01:46.680728,epoch time: 0:34:13.033633,used: 1:40:28.406097,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_21_18_seed_2_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7507224, 'precision': 0.49539375, 'recall': 0.37425488, 'specificity': 0.9696357, 'f1': 0.3932034, 'auroc': 0.94180423}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   11   0    85   0   0   80   117     1   0    189
1    0  873   0    23   0   0    4   389     2   0     40
2    0    2   0   102   1   7   30    44    11   5    110
3    0    5   0  7077   0   4   15   981   233   0    122
4    0    0   0    60   0   0   17    15    32   0    415
5    0    1   0   405   0  36   31     6    18  18      6
6    0   13   0   109   0   0  848    66    46   1    824
7    0   36   0  1107   0   1    6  5678    57   0    379
8    0    2   0   772   1   1   17   244  1076   0   1182
9    0    7   0   299   0  18   68    30    17  13     41
10   0    2   0   106   0   0   52   111    65   0  12458
---- Validation: 
scalar performance:
{'acc': 0.75048816, 'precision': 0.4991356, 'recall': 0.37512407, 'specificity': 0.9696132, 'f1': 0.39568, 'auroc': 0.9407033}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   13   0    78   0   0   87   107     4   1    193
1    0  850   0    30   0   0    3   405     2   0     42
2    0    0   0    96   0   8   37    56    13   5     97
3    0    4   0  7072   0   0   14   994   236   2    118
4    0    0   0    67   0   0   15    11    17   0    429
5    0    2   0   391   0  42   33     9    16  17     11
6    0   16   0   110   0   1  855    61    37   0    828
7    0   30   0  1089   0   0    5  5702    56   1    382
8    0    2   0   783   0   1   31   217  1065   2   1195
9    0    7   0   292   2  28   69    25    15  20     35
10   0    6   0   104   0   0   48   107    80   0  12451
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21325125, 'precision': 0.18586898, 'recall': 0.19488531, 'specificity': 0.9202144, 'f1': 0.09590778, 'auroc': 0.7375577}
confusion matrix:
    0    1   2    3   4   5   6     7    8   9     10
0    0   42   0    0   0   0  76   694    3   0   355
1    0  130   0    4   0   0   0  1253    1   0   111
2    0    2   0    5   0   0   2   276    4   0   726
3    0    0   0    0   0   0   0     0    0   0     0
4    0    0   0    0   0   0   0    17    0   0  1616
5    0    6   0  114   0   0  12   313   21   0   126
6    0    0   0    3   0   0  30    72    2   0  2960
7    0   29   0    2   0   0   1  1087    0   0    45
8    0    4   0   46   0   0   7   224  157   0   932
9    0    7   0   35   0   0   9   776    4   0   306
10   0    0   0    0   0   0   0     2    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-22 11:34:40.792485,epoch time: 0:32:54.111757,used: 2:13:22.517854,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_21_18_seed_2_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7751766, 'precision': 0.6519448, 'recall': 0.40928322, 'specificity': 0.9730224, 'f1': 0.42882136, 'auroc': 0.9504876}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    2   12   0    80   0   0   119   106     3   1    159
1    0  944   0    23   0   0     5   329     5   0     26
2    0    1   5    79   0   8    51    65    15   7     81
3    0    6   0  7180   0   6    18   850   290   1     89
4    0    0   0    59   0   1    38    13    37   2    389
5    0    0   1   369   0  62    34     7    25  19      4
6    0   16   0    93   0   0  1040    50    48   2    657
7    0   45   0   965   0   2    10  5854    77   0    309
8    0    0   0   657   0   0    28   233  1453   0    924
9    0    7   2   257   0  35    91    26    30  20     25
10   0    4   0    90   0   0    69   114   104   0  12413
---- Validation: 
scalar performance:
{'acc': 0.77365255, 'precision': 0.6156589, 'recall': 0.40674543, 'specificity': 0.97283804, 'f1': 0.4258896, 'auroc': 0.94969165}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    2    7   0    68   0   0   125   109     4   0    168
1    0  926   0    14   0   0     3   349     2   0     38
2    0    2   3    88   1   8    53    56    21   6     74
3    0    7   0  7140   0   1    23   892   290   0     87
4    0    1   0    63   0   0    35    22    34   0    384
5    1    0   1   374   0  52    44     2    18  20      9
6    0   11   0    77   0   2  1059    53    41   0    665
7    0   37   0   948   0   0     6  5889    84   1    300
8    0    2   0   653   0   1    25   247  1432   1    935
9    0    6   2   242   0  36    87    33    31  25     31
10   0    6   0    94   0   0    73   109   119   0  12395
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22465542, 'precision': 0.27861118, 'recall': 0.20461418, 'specificity': 0.921289, 'f1': 0.111526765, 'auroc': 0.75194246}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    1   51   0    0   0   0  154   660    2   0   302
1    0  183   0    4   0   0    2  1216    1   0    93
2    0    3   0    6   0   0   10   285    7   0   704
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    19    0   0  1614
5    0    6   0  132   0   0   28   294   27   0   105
6    0    2   0    3   0   0   52    85    5   0  2920
7    0   34   0    3   0   0    1  1088    0   0    38
8    0    3   0   54   0   0   12   218  243   0   840
9    0    8   0   44   0   0   25   780   10   0   270
10   0    0   0    0   0   0    0     2    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-22 12:07:46.649213,epoch time: 0:33:05.856728,used: 2:46:28.374582,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_21_18_seed_2_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.78515625, 'precision': 0.66335297, 'recall': 0.4254498, 'specificity': 0.97439766, 'f1': 0.44924963, 'auroc': 0.95435894}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   11    7   0    73   0   0   140   109     1   0    142
1    0  909   0    19   0   0     5   367     5   1     25
2    0    1   5    75   0   8    62    61    21  10     69
3    0    1   0  7288   0   6    21   807   254   1     61
4    0    0   0    61   0   0    42    12    39   0    385
5    1    0   0   344   0  79    39     4    25  26      3
6    1    9   0    79   0   2  1181    59    32   0    545
7    0   24   1   919   0   2    14  5983    86   0    234
8    0    1   0   680   0   2    30   260  1484   0    837
9    0    4   1   239   0  53    91    22    14  41     28
10   0    4   0    99   0   0    94   126   105   0  12365
---- Validation: 
scalar performance:
{'acc': 0.7879631, 'precision': 0.69349486, 'recall': 0.42622703, 'specificity': 0.9746959, 'f1': 0.4502781, 'auroc': 0.954825}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   14    8   0    88   0   0   127    93     3   1    149
1    0  925   0    18   0   0     1   354     9   0     25
2    0    1   6    75   0   6    69    60    20  10     65
3    0    2   0  7326   0   6    18   771   253   0     64
4    0    0   0    52   0   1    43    22    36   2    383
5    0    0   0   362   0  67    36     4    20  26      6
6    0   11   0    76   0   0  1170    66    36   1    548
7    0   29   0   887   0   0    11  5989    69   1    279
8    0    0   0   679   0   1    36   262  1521   1    796
9    0    4   1   243   0  36    99    29    20  40     21
10   0    3   0    78   0   0    84   123   108   0  12400
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22640453, 'precision': 0.38401526, 'recall': 0.20556748, 'specificity': 0.9214043, 'f1': 0.112696186, 'auroc': 0.7613939}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    4   24   0    1   0   0  225   671    1   0   244
1    0  157   0    4   0   0    6  1247    0   0    85
2    0    0   0    8   0   0   17   307    6   0   677
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    19    0   0  1614
5    0    5   0  154   0   2   51   283   17   0    80
6    0    1   0    6   0   0   87    90    3   0  2880
7    0   25   0    4   0   0    1  1106    0   0    28
8    0    1   0   72   0   0   31   233  237   0   796
9    0    4   0   54   0   0   42   800    5   0   232
10   0    0   0    0   0   0    1     2    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-22 12:42:38.883746,epoch time: 0:34:52.234533,used: 3:21:20.609115,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_21_18_seed_2_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7979452, 'precision': 0.6659481, 'recall': 0.4539014, 'specificity': 0.97601354, 'f1': 0.48055124, 'auroc': 0.95916706}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0   18    8   0    60   0   0   126   120     5    2    144
1    1  983   0    18   0   0     6   298     6    1     18
2    0    2   4    57   1  11    50    58    22   41     66
3    0    6   0  7165   0  12    17   860   302    6     70
4    0    0   1    44   0   1    44    24    45    3    376
5    1    0   0   313   1  94    26     4    21   59      2
6    0   11   0    65   0   0  1191    63    42    2    534
7    0   38   0   704   0   1    11  6195    89    1    224
8    0    1   0   544   0   1    33   274  1665    1    776
9    1    3   0   197   1  51    62    35    16  110     17
10   0    2   1    79   0   0    69   135   107    2  12399
---- Validation: 
scalar performance:
{'acc': 0.79695064, 'precision': 0.68599164, 'recall': 0.45563844, 'specificity': 0.97591674, 'f1': 0.4842701, 'auroc': 0.9579627}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0   25    9   0    54   0   1   133   112     4    1    144
1    0  982   0    15   0   0     4   306     4    1     20
2    0    2   8    68   1   8    49    64    16   36     60
3    0    4   0  7146   0   8    16   877   317    3     69
4    0    0   0    47   0   1    52    21    35    3    380
5    1    1   0   311   0  92    18     8    19   67      4
6    1   11   0    52   0   3  1192    77    45    0    527
7    0   36   0   710   2   3    15  6181    85    5    228
8    1    0   0   542   0   3    33   280  1673    0    764
9    0    4   1   192   0  47    62    36    20  110     21
10   1    4   0    74   0   1    73   139   118    1  12385
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23759882, 'precision': 0.37514675, 'recall': 0.2151567, 'specificity': 0.9224355, 'f1': 0.12801912, 'auroc': 0.7691104}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   11   49   0    1   0   0  247   630    2   0   230
1    0  249   0    4   0   0    7  1158    0   0    81
2    0    3   0    5   0   0   20   303    9   0   675
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    19    0   0  1614
5    1    7   0  147   0   4   57   275   21   1    79
6    0    2   0    4   0   0  106    90    3   0  2862
7    0   33   0    2   0   0    1  1101    0   0    27
8    0    4   0   54   0   0   37   234  282   0   759
9    0    9   0   45   0   0   60   790    6   0   227
10   0    0   0    0   0   0    1     2    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-22 13:15:38.523620,epoch time: 0:32:59.639874,used: 3:54:20.248989,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_21_18_seed_2_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.80514234, 'precision': 0.72319996, 'recall': 0.4731332, 'specificity': 0.9768763, 'f1': 0.5057831, 'auroc': 0.9611496}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   23    13   0    59   0    0   118   103    10   2    155
1    0  1028   0    16   0    0     2   258     8   0     20
2    0     0  23    51   1   11    54    61    17  28     66
3    0     5   0  7199   0   17    18   779   349   2     68
4    0     0   1    41   3    0    47    18    49   3    377
5    1     0   0   281   0  135    19     8    29  44      4
6    1    18   0    51   0    2  1193    58    57   2    524
7    0    33   0   673   0    3    14  6161   112   2    267
8    0     1   0   494   0    6    20   245  1804   0    726
9    0     2   9   186   2   62    62    36    15  99     20
10   0     1   0    67   1    2    63   104   129   0  12425
---- Validation: 
scalar performance:
{'acc': 0.804467, 'precision': 0.7236051, 'recall': 0.47303, 'specificity': 0.97680527, 'f1': 0.5061147, 'auroc': 0.960879}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   28    14   0    52   0    0   120   101    10    3    155
1    0  1023   0    22   0    0     1   260     6    0     20
2    0     2  19    58   2   11    44    64    21   27     64
3    0     4   0  7190   0   13    18   811   345    0     59
4    0     1   0    46   5    1    35    11    53    4    383
5    1     0   0   291   0  131    22     2    26   44      4
6    1    11   0    48   0    2  1191    65    56    1    533
7    0    46   0   709   1    4    10  6143   101    2    249
8    1     1   0   483   1    3    23   248  1821    1    714
9    3     2   7   182   1   74    46    29    18  104     27
10   0     4   0    44   0    1    63   124   140    0  12420
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24711397, 'precision': 0.3593074, 'recall': 0.22393376, 'specificity': 0.92331326, 'f1': 0.14172196, 'auroc': 0.77381116}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   16   58   0    2   0   1  269   567    3   0   254
1    0  323   0    4   0   0    8  1081    0   0    83
2    0    3   0    7   0   0   19   265   10   0   711
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    17    0   0  1615
5    1    7   0  155   0   7   65   242   26   0    89
6    0    4   0    5   0   0  108    67    5   0  2878
7    0   34   0    3   0   0    3  1096    0   0    28
8    0    5   0   49   0   0   32   202  338   0   744
9    0   12   0   51   0   1   67   743    8   0   255
10   0    0   0    0   0   0    1     1    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-22 13:49:28.970556,epoch time: 0:33:50.446936,used: 4:28:10.695925,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_21_18_seed_2_22562330
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
slurmstepd: error: *** JOB 22562330 ON gpusrv72 CANCELLED AT 2024-07-22T14:09:51 ***
