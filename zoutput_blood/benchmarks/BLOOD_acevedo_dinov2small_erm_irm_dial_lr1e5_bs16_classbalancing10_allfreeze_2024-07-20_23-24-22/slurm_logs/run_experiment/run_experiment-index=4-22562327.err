Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 23:26:48 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327

 Experiment start at: 2024-07-20 23:54:31.224160
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.11451199, 'precision': 0.09198241, 'recall': 0.111976266, 'specificity': 0.9128299, 'f1': 0.051384814, 'auroc': 0.6305864}
confusion matrix:
    0   1   2    3   4   5      6     7   8   9   10
0    0   0   0   22   0   2    397    62   0   0   0
1    0   0   0   33   0   0   1238    60   1   0   0
2    0   0   0   13   0   1    263    34   0   0   1
3    0   0   0  937   0  63   4531  2900   7   0   0
4    0   0   0   12   0   1    496    28   1   0   0
5    0   0   0   75   0   7    310   129   0   0   0
6    0   0   0   88   0   4   1677   135   0   0   4
7    0   0   0  229   0  50   5325  1658   1   0   1
8    0   0   0  209   0  24   2716   341   0   0   4
9    0   0   0   58   0   2    354    79   0   0   0
10   1   0   0   79   0  10  12367   335   0   0   1
---- Validation: 
scalar performance:
{'acc': 0.110525616, 'precision': 0.10343899, 'recall': 0.109029904, 'specificity': 0.9123419, 'f1': 0.04823272, 'auroc': 0.6332572}
confusion matrix:
    0   1   2    3   4   5      6     7   8   9   10
0    0   0   0   22   0   0    380    81   0   0   0
1    0   0   0   27   0   1   1238    63   3   0   0
2    0   0   0   18   0   0    264    28   1   0   1
3    0   0   0  925   1  72   4447  2987   7   0   1
4    0   0   0   19   0   0    488    32   0   0   0
5    0   0   0   87   0   3    296   135   0   0   0
6    0   0   0   75   0   5   1664   160   2   0   2
7    0   0   0  273   0  53   5398  1538   2   0   1
8    0   0   0  220   0  19   2722   335   0   0   0
9    0   0   0   57   0   3    342    91   0   0   0
10   1   0   0   80   0   8  12341   364   0   0   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21514028, 'precision': 0.04379215, 'recall': 0.0915339, 'specificity': 0.90918326, 'f1': 0.033397585, 'auroc': 0.5218253}
confusion matrix:
    0   1   2   3   4   5     6   7   8   9   10
0    0   0   0   0   0   0  1162   8   0   0   0
1    0   0   0   0   0   0  1492   7   0   0   0
2    0   0   0   0   0   0  1015   0   0   0   0
3    0   0   0   0   0   0     0   0   0   0   0
4    0   0   0   0   0   0  1633   0   0   0   0
5    0   0   0   1   0   0   585   6   0   0   0
6    0   0   0   0   0   0  3067   0   0   0   0
7    0   0   0   0   0   0  1156   8   0   0   0
8    0   0   0   0   0   0  1369   1   0   0   0
9    0   0   0   0   0   0  1137   0   0   0   0
10   0   0   0   0   0   0  1646   0   0   0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 00:22:28.447901,epoch time: 0:27:57.223741,used: 0:27:57.223741,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.25997967, 'precision': 0.13815132, 'recall': 0.17677505, 'specificity': 0.92559654, 'f1': 0.105519615, 'auroc': 0.71653014}
confusion matrix:
    0   1   2     3   4   5      6     7   8   9   10
0    0   0   0    33   0   0    326   123   0   0   1
1    0   0   0    29   0   0   1055   235  11   0   1
2    0   0   0    40   0   0    207    63   0   0   2
3    0   0   0  2933   0   0   1222  4281   3   0   1
4    0   0   0    33   0   0    469    33   0   0   4
5    0   0   0   286   1   0    114   119   0   0   0
6    0   0   0    88   0   0   1714    95   0   0   9
7    0   0   0   345   0   0   1856  5061   0   0   1
8    0   0   0   367   0   0   2389   532   1   0   5
9    0   0   0   192   0   0    202    98   0   0   1
10   0   0   0    59   0   0  12534   194   0   0   8
---- Validation: 
scalar performance:
{'acc': 0.25812492, 'precision': 0.12287612, 'recall': 0.17554781, 'specificity': 0.92543036, 'f1': 0.1048758, 'auroc': 0.7155846}
confusion matrix:
    0   1   2     3   4   5      6     7   8   9   10
0    0   0   0    42   0   0    312   129   0   0   0
1    0   0   0    40   1   0   1068   218   3   0   2
2    0   0   0    51   0   0    200    58   0   0   3
3    0   0   0  2896   0   0   1272  4263   7   0   2
4    0   0   0    40   0   0    459    37   0   0   3
5    0   0   0   280   0   0    108   131   1   0   1
6    0   0   0    87   0   0   1704   111   0   0   6
7    0   0   0   360   0   0   1853  5045   3   0   4
8    0   0   0   328   0   0   2471   492   0   0   5
9    0   0   0   165   0   0    214   110   0   0   4
10   0   0   0    70   0   0  12526   195   0   0   5
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25830826, 'precision': 0.0611936, 'recall': 0.13991581, 'specificity': 0.91513896, 'f1': 0.07881628, 'auroc': 0.5602651}
confusion matrix:
    0   1   2   3   4   5     6    7   8   9   10
0    0   0   0   0   0   0   971  199   0   0   0
1    0   0   0   0   0   0  1150  349   0   0   0
2    0   0   0   0   0   0   996   19   0   0   0
3    0   0   0   0   0   0     0    0   0   0   0
4    0   0   0   0   0   0  1632    1   0   0   0
5    0   0   0  12   0   0   471  109   0   0   0
6    0   0   0   0   0   0  3063    4   0   0   0
7    0   0   0   0   0   0   535  629   0   0   0
8    0   0   0   1   0   0  1352   17   0   0   0
9    0   0   0   1   0   0  1014  121   1   0   0
10   0   0   0   0   0   0  1646    0   0   0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 00:47:17.469712,epoch time: 0:24:49.021811,used: 0:52:46.245552,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.4949433, 'precision': 0.20505872, 'recall': 0.23896141, 'specificity': 0.9474766, 'f1': 0.19352064, 'auroc': 0.7545762}
confusion matrix:
    0   1   2     3   4   5     6     7   8   9     10
0    0   0   0    72   0   0   255   130   0   0    26
1    0   0   0    49   0   0   937   329  12   0     5
2    0   0   0    94   0   0   157    42   0   0    19
3    0   0   0  5040   0   0   568  2817   0   0    12
4    0   0   0    52   0   0   339    22   0   0   126
5    0   0   0   424   0   0    51    41   0   0     5
6    0   0   0   118   0   0  1447    80   1   0   260
7    0   0   0   654   0   0   976  5597   1   0    35
8    0   0   0   643   0   0  2010   417   0   0   226
9    0   0   0   297   0   0   125    59   0   0    12
10   0   0   0    77   0   0  6111   190   1   0  6415
---- Validation: 
scalar performance:
{'acc': 0.4909723, 'precision': 0.21119809, 'recall': 0.23631328, 'specificity': 0.94712305, 'f1': 0.192186, 'auroc': 0.75564814}
confusion matrix:
    0   1   2     3   4   5     6     7   8   9     10
0    0   0   0    55   0   0   269   137   0   0    22
1    0   0   0    62   0   0   941   311  10   0     8
2    0   0   0   103   0   0   147    51   0   0    11
3    0   0   0  4975   0   0   587  2871   0   0     7
4    0   0   0    56   0   0   345    19   0   0   119
5    0   0   0   449   0   0    40    30   0   0     2
6    0   0   0   152   0   0  1412    91   0   0   253
7    0   0   0   594   0   0  1009  5621   3   0    38
8    0   0   0   630   0   0  2030   418   1   0   217
9    0   0   0   300   0   0   129    58   0   0     6
10   0   0   0    85   0   0  6184   181   0   0  6346
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29399008, 'precision': 0.099697426, 'recall': 0.17914386, 'specificity': 0.92086935, 'f1': 0.10631367, 'auroc': 0.5733245}
confusion matrix:
    0   1   2   3   4   5     6    7   8   9    10
0    0   0   0   1   0   0   770  399   0   0    0
1    0   0   0   3   0   0   703  791   0   0    2
2    0   0   0   0   0   0   921   84   0   0   10
3    0   0   0   0   0   0     0    0   0   0    0
4    0   0   0   0   0   0  1454    1   0   0  178
5    0   0   0  61   0   0   365  165   0   0    1
6    0   0   0   0   0   0  2940   20   0   0  107
7    0   0   0   1   0   0   187  975   0   0    1
8    0   0   0   7   0   0  1300   55   0   0    8
9    0   0   0   7   0   0   798  326   0   0    6
10   0   0   0   0   0   0  1357    2   0   0  287
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 01:12:22.023248,epoch time: 0:25:04.553536,used: 1:17:50.799088,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.62050515, 'precision': 0.21046342, 'recall': 0.26297867, 'specificity': 0.95850843, 'f1': 0.22447386, 'auroc': 0.79225767}
confusion matrix:
    0   1   2     3   4   5     6     7   8   9      10
0    0   0   0    79   0   0   238   104   0   0     62
1    0   0   0    69   0   0   739   504   7   0     13
2    0   0   0   117   0   0   117    44   0   0     34
3    0   0   0  6252   0   0   274  1891   0   0     20
4    0   0   0    62   0   0   211    14   0   0    252
5    0   0   0   469   0   0    34    14   0   0      4
6    0   0   0   148   0   0  1096    68   1   0    594
7    0   0   0   880   0   0   622  5688   0   0     73
8    0   0   0   879   0   0  1499   375   0   0    543
9    0   0   0   363   0   0    84    31   0   0     15
10   0   0   0   104   0   0  2341   192   0   0  10156
---- Validation: 
scalar performance:
{'acc': 0.6222817, 'precision': 0.21099317, 'recall': 0.26373485, 'specificity': 0.9587221, 'f1': 0.22507688, 'auroc': 0.7932025}
confusion matrix:
    0   1   2     3   4   5     6     7   8   9      10
0    0   0   0    78   0   0   238   101   0   0     66
1    0   0   0    84   0   0   734   494   6   0     14
2    0   0   0   124   0   0   117    35   0   0     36
3    0   0   0  6252   0   0   276  1895   0   0     17
4    0   0   0    65   0   0   247     9   0   0    218
5    0   0   0   474   0   0    27    16   0   0      4
6    0   0   0   151   0   0  1103    59   0   0    595
7    0   0   0   873   0   0   633  5697   0   0     62
8    0   0   0   870   0   0  1486   383   0   0    557
9    0   0   0   339   0   0    99    40   0   0     15
10   0   0   0   105   0   0  2294   185   0   0  10212
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2990275, 'precision': 0.087659106, 'recall': 0.19614106, 'specificity': 0.9228816, 'f1': 0.11918062, 'auroc': 0.6031379}
confusion matrix:
    0   1   2    3   4   5     6    7   8   9    10
0    0   0   0    2   0   0   870  289   0   0    9
1    0   0   0    5   0   0   520  964   0   0   10
2    0   0   0    4   0   0   834   97   0   0   80
3    0   0   0    0   0   0     0    0   0   0    0
4    0   0   0    0   0   0   858    3   0   0  772
5    0   0   0  114   0   0   305  170   0   0    3
6    0   0   0    1   0   0  2441   10   0   0  615
7    0   0   0    4   0   0   170  986   0   0    4
8    0   0   0   23   0   0  1190   74   0   0   83
9    0   0   0   23   0   0   778  320   0   0   16
10   0   0   0    0   0   0   799    0   0   0  847
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 01:37:05.093774,epoch time: 0:24:43.070526,used: 1:42:33.869614,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.6732395, 'precision': 0.21747072, 'recall': 0.25792414, 'specificity': 0.9618525, 'f1': 0.23023325, 'auroc': 0.815674}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0   109   0   0  143    79   0   0    152
1    0   0   0    88   0   0  563   639  10   0     31
2    0   0   0   129   0   0   70    29   0   0     84
3    0   0   0  7054   0   0  131  1201   0   0     53
4    0   0   0    83   0   0   82     7   0   0    367
5    0   0   0   483   0   0   19     7   0   0     11
6    0   0   0   190   0   0  568    56   0   0   1093
7    0   0   0  1176   0   0  331  5580   0   0    177
8    0   0   0  1105   0   0  818   346   1   0   1026
9    0   0   0   373   0   0   56    17   0   0     47
10   0   0   0   124   0   0  546   162   0   0  11960
---- Validation: 
scalar performance:
{'acc': 0.67174, 'precision': 0.20853342, 'recall': 0.25664788, 'specificity': 0.96155065, 'f1': 0.22935541, 'auroc': 0.81585747}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0    99   0   0  141    82   0   0    161
1    0   0   0    99   0   0  554   623  11   0     45
2    0   0   0   143   0   0   61    22   0   0     86
3    0   0   0  7045   0   0  115  1214   1   0     65
4    0   0   0    77   0   0   77     9   0   0    376
5    0   0   0   488   0   0   14     4   0   0     15
6    0   0   0   176   0   0  551    60   1   0   1120
7    0   0   0  1174   0   0  331  5558   0   0    202
8    0   0   0  1082   0   0  802   329   0   0   1083
9    0   0   0   366   0   0   60    19   0   0     48
10   0   0   0   141   0   0  544   152   0   0  11959
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24865319, 'precision': 0.07206845, 'recall': 0.19449908, 'specificity': 0.9202622, 'f1': 0.103103764, 'auroc': 0.62153035}
confusion matrix:
    0   1   2    3   4   5     6     7   8   9     10
0    0   0   0    6   0   0   751   347   0   0    66
1    0   0   0   16   0   0   405  1055   0   0    23
2    0   0   0   16   0   0   516   109   0   0   374
3    0   0   0    0   0   0     0     0   0   0     0
4    0   0   0    0   0   0   171     3   0   0  1459
5    0   0   0  194   0   0   213   155   0   0    30
6    0   0   0    5   0   0  1003    14   0   0  2045
7    0   0   0    6   0   0   106  1044   0   0     8
8    0   0   0   70   0   0   841    89   0   0   370
9    0   0   0   75   0   0   621   346   0   0    95
10   0   0   0    0   0   0   139     0   0   0  1507
better model found
persisted
after epoch: 5,now: 2024-07-21 02:01:57.409191,epoch time: 0:24:52.315417,used: 2:07:26.185031,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.68292487, 'precision': 0.21797073, 'recall': 0.25676337, 'specificity': 0.96221817, 'f1': 0.23130165, 'auroc': 0.8359267}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0   119   0   0  109    90   0   0    164
1    0   0   0   100   0   0  432   718  43   0     39
2    0   0   0   147   0   0   33    29   0   0    103
3    0   0   0  7384   0   0   57   938   1   0     60
4    0   0   0   103   0   0   36     8   0   0    392
5    0   0   0   505   0   0    7     0   0   0      9
6    0   0   0   196   0   0  449    52   2   0   1209
7    0   0   0  1362   0   0  189  5548   3   0    161
8    0   0   0  1357   0   0  519   268   4   0   1147
9    0   0   0   380   0   0   39    19   0   0     55
10   0   0   0   166   0   0  311   174   0   0  12140
---- Validation: 
scalar performance:
{'acc': 0.68136954, 'precision': 0.21578029, 'recall': 0.25460565, 'specificity': 0.96202534, 'f1': 0.22933006, 'auroc': 0.8351598}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0   119   0   0  106    91   0   0    167
1    0   0   0   116   0   0  435   712  37   0     32
2    0   0   0   151   0   0   35    29   0   0     97
3    0   0   0  7423   0   0   50   905   3   0     59
4    0   0   0    93   0   0   42    11   1   0    392
5    0   0   0   494   0   0   10     1   1   0     15
6    0   0   0   218   0   0  402    51   2   0   1235
7    0   0   0  1349   0   0  191  5553   9   0    163
8    0   0   0  1383   0   0  491   264   4   0   1154
9    0   0   0   388   0   0   30    24   0   0     51
10   0   0   0   178   0   0  353   174   0   0  12091
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23556986, 'precision': 0.067927636, 'recall': 0.19285136, 'specificity': 0.9202497, 'f1': 0.09600214, 'auroc': 0.6334747}
confusion matrix:
    0   1   2    3   4   5    6     7   8   9     10
0    0   0   0   24   0   0  600   453   0   0    93
1    0   0   0   38   0   0  272  1162   0   0    27
2    0   0   0   33   0   0  401   149   0   0   432
3    0   0   0    0   0   0    0     0   0   0     0
4    0   0   0    2   0   0   94    15   0   0  1522
5    0   0   0  260   0   0  125   169   0   0    38
6    0   0   0    8   0   0  704    39   0   0  2316
7    0   0   0   14   0   0   52  1089   0   0     9
8    0   0   0  163   0   0  640   118   0   0   449
9    0   0   0  156   0   0  447   423   0   0   111
10   0   0   0    0   0   0   70     2   0   0  1574
better model found
persisted
after epoch: 6,now: 2024-07-21 02:27:06.028311,epoch time: 0:25:08.619120,used: 2:32:34.804151,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.6896404, 'precision': 0.22279763, 'recall': 0.24943605, 'specificity': 0.9619611, 'f1': 0.22446434, 'auroc': 0.8529751}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0   102   0   0   53    98   0   0    230
1    0   0   0    87   0   0  301   868  28   0     48
2    0   0   0   140   0   0   10    30   1   0    131
3    0   0   0  7468   0   0   32   859   1   0     78
4    0   0   0    93   0   0    6     7   0   0    432
5    0   0   0   484   0   0    2     5   0   0     29
6    0   0   0   207   0   0  194    60   1   0   1446
7    0   0   0  1220   0   0   78  5706   5   0    255
8    0   0   0  1362   0   0  167   297   7   0   1463
9    0   0   0   381   0   0   17    11   1   0     83
10   0   0   0   155   0   0   67   167   2   0  12401
---- Validation: 
scalar performance:
{'acc': 0.6897954, 'precision': 0.21930885, 'recall': 0.2491056, 'specificity': 0.9619658, 'f1': 0.22426116, 'auroc': 0.85354877}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0   106   0   0   51    93   0   0    233
1    0   0   0    74   0   0  302   858  39   0     59
2    0   0   0   135   0   0   18    27   0   0    132
3    0   0   0  7474   0   0   23   852   3   0     88
4    0   0   0    89   0   0    4    10   0   0    436
5    0   0   0   488   0   0    2     6   0   0     25
6    0   0   0   198   0   0  191    66   2   0   1451
7    0   0   0  1265   0   0   78  5658   9   0    255
8    0   0   0  1337   0   0  181   305   7   0   1466
9    0   0   0   388   0   0    9    16   0   0     80
10   0   0   0   139   0   0   66   132   1   0  12458
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20646471, 'precision': 0.056643628, 'recall': 0.18254063, 'specificity': 0.91847837, 'f1': 0.0794681, 'auroc': 0.64903283}
confusion matrix:
    0   1   2    3   4   5    6     7   8   9     10
0    0   0   0   27   0   0  411   509   0   0   223
1    0   0   0   43   0   0  180  1214   0   0    62
2    0   0   0   38   0   0  159   155   0   0   663
3    0   0   0    0   0   0    0     0   0   0     0
4    0   0   0    2   0   0   18    13   0   0  1600
5    0   0   0  273   0   0   66   167   0   0    86
6    0   0   0   13   0   0  218    38   0   0  2798
7    0   0   0   10   0   0   29  1099   0   0    26
8    0   0   0  192   0   0  361   123   0   0   694
9    0   0   0  183   0   0  243   452   0   0   259
10   0   0   0    0   0   0   11     1   0   0  1634
better model found
persisted
after epoch: 7,now: 2024-07-21 02:52:09.004481,epoch time: 0:25:02.976170,used: 2:57:37.780321,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.69592786, 'precision': 0.2439669, 'recall': 0.25011426, 'specificity': 0.9623665, 'f1': 0.22329275, 'auroc': 0.8680328}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0   103   0   0   15   131   0   0    234
1    0   0   0    47   0   0  141  1037  22   0     85
2    0   0   0   116   0   0    4    48   0   0    144
3    0   0   0  7262   0   0    3  1082   5   0     85
4    0   0   0    75   0   0    2    17   1   0    443
5    0   0   0   483   0   0    1     9   0   0     28
6    0   0   0   157   0   0  122    99   4   0   1525
7    0   0   0   838   0   0   17  6170   6   0    232
8    0   0   0  1282   0   0   32   409  15   0   1558
9    1   0   0   357   0   0    4    31   0   0    100
10   0   0   0   121   0   0   28   202   1   0  12442
---- Validation: 
scalar performance:
{'acc': 0.69493115, 'precision': 0.2510119, 'recall': 0.24913856, 'specificity': 0.9621976, 'f1': 0.22244576, 'auroc': 0.8663138}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0    92   0   0   17   125   0   0    249
1    0   0   0    47   0   0  127  1054  32   0     72
2    0   0   0   127   0   0    4    39   0   0    142
3    0   0   0  7254   0   0    6  1078   4   0     98
4    0   0   0    73   0   0    0    14   0   0    452
5    0   0   0   479   0   0    0     9   1   0     32
6    0   0   0   167   0   0  103    98   1   0   1539
7    0   0   0   843   0   0   21  6126  10   0    265
8    0   0   0  1253   0   0   31   410  32   0   1570
9    0   0   0   362   0   0    3    32   2   0     94
10   0   0   0   113   0   0   13   201   4   0  12465
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19946827, 'precision': 0.05225698, 'recall': 0.18108964, 'specificity': 0.91869664, 'f1': 0.07014298, 'auroc': 0.66210455}
confusion matrix:
    0   1   2    3   4   5    6     7   8   9     10
0    0   0   0   19   0   0  181   654   1   0   315
1    0   0   0   27   0   0   76  1321   1   0    74
2    0   0   0   35   0   0   44   220   0   0   716
3    0   0   0    0   0   0    0     0   0   0     0
4    0   0   0    1   0   0    8    17   0   0  1607
5    0   0   0  252   0   0   16   215   0   0   109
6    0   0   0   13   0   0   83    73   1   0  2897
7    0   0   0    6   0   0    4  1126   0   0    28
8    0   0   0  212   0   0  175   195   0   0   788
9    0   0   0  151   0   0   66   598   0   0   322
10   0   0   0    1   0   0    1     2   0   0  1642
better model found
persisted
after epoch: 8,now: 2024-07-21 03:16:49.132709,epoch time: 0:24:40.128228,used: 3:22:17.908549,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.6948844, 'precision': 0.24756542, 'recall': 0.24679366, 'specificity': 0.96204317, 'f1': 0.22019848, 'auroc': 0.87931305}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0   127   0   0    6    92   0   0    258
1    0   0   0    73   0   0  129   977  45   0    108
2    0   0   0   133   0   0    3    34   0   0    142
3    0   0   0  7789   0   0    1   552   4   0     92
4    0   0   0    89   0   0    1     2   0   0    447
5    0   0   0   484   0   0    1     1   0   0     35
6    0   0   0   204   0   0   65    54  10   0   1574
7    0   0   0  1371   0   0   15  5568  12   0    299
8    0   0   0  1546   0   0   13   210  44   0   1483
9    0   0   0   369   0   0    2    21   1   0    100
10   0   0   0   159   0   0   10   110   5   0  12506
---- Validation: 
scalar performance:
{'acc': 0.69610804, 'precision': 0.24886125, 'recall': 0.24734262, 'specificity': 0.9621936, 'f1': 0.2207016, 'auroc': 0.8788605}
confusion matrix:
    0   1   2     3   4   5    6     7   8   9      10
0    0   0   0   118   0   0   10    77   1   0    277
1    0   0   0    77   0   0  145   981  39   0     90
2    0   0   0   135   0   0    2    22   0   0    153
3    0   0   0  7825   0   0    2   539   3   0     71
4    0   0   0    78   0   0    0     5   1   0    455
5    0   0   0   491   0   0    0     5   0   0     25
6    0   0   0   216   0   0   71    53   5   0   1563
7    0   0   0  1396   0   0   19  5570   9   0    271
8    0   0   0  1500   0   0   14   217  37   0   1528
9    0   0   0   382   0   0    2    12   0   0     97
10   0   0   0   147   0   0   13   113   2   0  12521
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19520044, 'precision': 0.09326312, 'recall': 0.17782171, 'specificity': 0.91851735, 'f1': 0.07320564, 'auroc': 0.66551554}
confusion matrix:
    0   1   2    3   4   5    6     7   8   9     10
0    0   0   0   53   0   0  178   530   4   0   405
1    0   0   0   83   0   0   85  1216   3   0   112
2    0   0   0   64   0   0   38   132   1   0   780
3    0   0   0    0   0   0    0     0   0   0     0
4    0   0   0    2   0   0    2     8   0   0  1621
5    0   0   0  343   0   0   12   118   0   0   119
6    0   0   0   20   0   0   49    34   1   0  2963
7    0   0   0   25   0   0    6  1088   2   0    43
8    0   0   0  307   0   0   99   100   9   0   855
9    0   0   0  278   0   0   65   397   0   0   397
10   0   0   0    1   0   0    0     1   0   0  1644
better model found
persisted
after epoch: 9,now: 2024-07-21 03:41:37.795988,epoch time: 0:24:48.663279,used: 3:47:06.571828,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.70061004, 'precision': 0.26925293, 'recall': 0.2485683, 'specificity': 0.9627705, 'f1': 0.21972845, 'auroc': 0.88605}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   106   0   0   2   116   1   0    258
1    0   0   0    46   0   0  37  1142  23   0     84
2    0   0   0   133   0   0   0    33   0   0    146
3    0   0   0  7662   0   0   1   701   4   0     72
4    0   0   0    76   0   0   1    14   0   0    447
5    0   0   0   479   0   0   0     8   0   0     33
6    0   0   0   214   0   0  33    84  19   0   1558
7    0   0   0  1096   0   0   2  5904  12   0    248
8    0   0   0  1522   0   0   2   277  54   0   1441
9    0   0   0   359   0   0   0    31   1   0    102
10   0   0   0   135   0   0   3   119   2   0  12533
---- Validation: 
scalar performance:
{'acc': 0.70073557, 'precision': 0.2682951, 'recall': 0.2491805, 'specificity': 0.9628147, 'f1': 0.22085151, 'auroc': 0.88509196}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   112   0   0   5   119   1   0    246
1    0   0   0    49   0   0  41  1144  26   0     72
2    0   0   0   132   0   0   0    37   1   0    142
3    0   0   0  7658   0   0   0   701   8   0     73
4    0   0   0    85   0   0   0    12   1   0    441
5    0   0   0   490   0   0   0     3   1   0     27
6    1   0   0   215   0   0  44    83  19   0   1546
7    0   0   0  1086   0   0   3  5930  11   0    235
8    0   0   0  1496   0   0   1   267  55   0   1477
9    0   0   0   355   0   0   1    34   2   0    101
10   0   0   0   142   0   0   4   133   7   0  12510
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19652978, 'precision': 0.11099611, 'recall': 0.18039238, 'specificity': 0.9191164, 'f1': 0.072309196, 'auroc': 0.67528725}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   51   0   0  66   650   8   0   395
1    0   0   0   75   0   0  21  1304   3   0    96
2    0   0   0   70   0   0   5   178   3   0   759
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   1    13   0   0  1617
5    0   0   0  344   0   0   5   143   0   0   100
6    0   0   0   28   0   0  21    64   2   0  2952
7    0   0   0   20   0   0   0  1112   1   0    31
8    0   0   0  340   0   0  25   152  32   0   821
9    0   0   0  270   0   0  11   490   2   0   364
10   0   0   0    1   0   0   0     1   0   0  1644
better model found
persisted
after epoch: 10,now: 2024-07-21 04:06:39.257798,epoch time: 0:25:01.461810,used: 4:12:08.033638,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.70301795, 'precision': 0.36649162, 'recall': 0.25034222, 'specificity': 0.9631113, 'f1': 0.22158378, 'auroc': 0.8965165}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    1   0   0   101   0   0   5   130   2   0    244
1    0   0   0    43   0   0  21  1163  20   0     85
2    0   0   0   110   0   0   1    52   5   0    144
3    0   0   0  7546   0   0   0   816   7   0     70
4    0   0   0    84   0   0   0    16   3   0    435
5    0   0   0   477   0   0   0    12   0   0     32
6    0   0   0   180   0   0  27   111  34   0   1556
7    0   0   0   911   0   0   1  6116  11   0    223
8    0   0   0  1437   0   0   0   333  77   0   1448
9    0   0   0   334   0   0   0    40   1   0    118
10   0   0   0   126   0   0   1   149   8   0  12509
---- Validation: 
scalar performance:
{'acc': 0.7028755, 'precision': 0.28025866, 'recall': 0.2500082, 'specificity': 0.9630821, 'f1': 0.22097045, 'auroc': 0.8958952}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    88   0   0   5   124   3   0    263
1    0   0   0    41   0   0  17  1181  19   0     74
2    0   0   0   106   0   0   1    49   3   0    153
3    0   0   0  7536   0   0   0   830   3   0     71
4    0   0   0    79   0   0   0    18   0   0    442
5    0   0   0   467   0   0   0    10   0   0     44
6    0   0   0   179   0   0  25   113  31   0   1560
7    0   0   0   922   0   0   0  6116   9   0    218
8    0   0   0  1437   0   0   0   343  78   0   1438
9    0   0   0   335   0   0   1    46   2   0    109
10   0   0   0   123   0   0   1   140  10   0  12522
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1978591, 'precision': 0.10755597, 'recall': 0.18211576, 'specificity': 0.91926074, 'f1': 0.07384836, 'auroc': 0.67874736}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   42   0   0  39   675  14   0   400
1    0   0   0   56   0   0  14  1332   4   0    93
2    0   0   0   63   0   0   1   190   6   0   755
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    14   1   0  1616
5    0   0   0  320   0   0   3   160   0   0   109
6    0   0   0   25   0   0  10    75   8   0  2949
7    0   0   0   18   0   0   0  1117   1   0    28
8    0   0   0  324   0   0   3   161  57   0   825
9    0   0   0  241   0   0   9   524   3   0   360
10   0   0   0    1   0   0   0     1   0   0  1644
better model found
persisted
after epoch: 11,now: 2024-07-21 04:31:24.192621,epoch time: 0:24:44.934823,used: 4:36:52.968461,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.70406145, 'precision': 0.29945588, 'recall': 0.2500379, 'specificity': 0.96306646, 'f1': 0.22032122, 'auroc': 0.9035114}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    75   0   0   1   125   0   0    282
1    0   0   0    23   0   0   3  1228   5   0     73
2    0   0   0    93   0   0   0    59   2   0    158
3    0   0   0  7425   0   0   0   917   9   0     88
4    0   0   0    63   0   0   0    16   3   0    457
5    0   0   0   459   0   0   0    10   1   0     51
6    0   0   0   139   0   0   8   128  36   0   1597
7    0   0   0   743   0   0   0  6245  11   0    265
8    0   0   0  1276   0   0   0   363  83   0   1573
9    0   0   0   313   0   0   0    57   1   0    121
10   0   0   0    90   0   0   0   142   5   0  12554
---- Validation: 
scalar performance:
{'acc': 0.7057108, 'precision': 0.31613874, 'recall': 0.2509036, 'specificity': 0.9632449, 'f1': 0.22124484, 'auroc': 0.90325946}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    66   0   0   1   132   2   0    282
1    0   0   0    25   0   0   2  1218   8   0     79
2    0   0   0    96   0   0   0    65   2   0    149
3    0   0   0  7452   0   0   0   889   4   0     95
4    0   0   0    64   0   0   1    22   1   0    451
5    0   0   0   466   0   0   0     7   0   0     48
6    0   0   0   138   0   0  15   111  26   0   1618
7    0   0   0   725   0   0   0  6278   6   0    256
8    0   0   0  1292   0   0   0   370  77   0   1557
9    0   0   0   306   0   0   0    54   0   0    133
10   0   0   0    88   0   0   0   142   5   0  12561
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19771916, 'precision': 0.112911634, 'recall': 0.18219161, 'specificity': 0.9190792, 'f1': 0.07313079, 'auroc': 0.6817395}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   25   0   0  12   666  12   0   455
1    0   0   0   36   0   0   6  1347   3   0   107
2    0   0   0   39   0   0   0   186   6   0   784
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    10   0   0  1621
5    0   0   0  275   0   0   1   176   0   0   140
6    0   0   0   19   0   0   4    63   8   0  2973
7    0   0   0   10   0   0   0  1116   1   0    37
8    0   0   0  256   0   0   0   169  62   0   883
9    0   0   0  167   0   0   3   542   4   0   421
10   0   0   0    1   0   0   0     1   0   0  1644
better model found
persisted
after epoch: 12,now: 2024-07-21 04:56:10.018063,epoch time: 0:24:45.825442,used: 5:01:38.793903,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7075931, 'precision': 0.30126512, 'recall': 0.25142896, 'specificity': 0.9634684, 'f1': 0.22178383, 'auroc': 0.9088688}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    84   0   0   0   127   2   0    270
1    0   0   0    27   0   0   4  1221  10   0     70
2    0   0   0    92   0   0   0    59   1   0    160
3    0   0   0  7569   0   0   0   784   5   0     81
4    0   0   0    72   0   0   0    12   1   0    454
5    0   0   0   461   0   0   0    10   0   0     50
6    0   0   0   140   0   0   7   109  34   0   1618
7    0   0   0   771   0   0   0  6209   8   0    275
8    0   0   0  1319   0   0   0   363  90   0   1524
9    0   0   0   302   0   0   0    47   2   0    142
10   0   0   0    88   0   0   0   125   5   0  12572
---- Validation: 
scalar performance:
{'acc': 0.70835894, 'precision': 0.31580693, 'recall': 0.25152132, 'specificity': 0.96350783, 'f1': 0.22172947, 'auroc': 0.9077284}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    81   0   0   0   124   2   0    276
1    0   0   0    30   0   0   1  1201   6   0     94
2    0   0   0    88   0   0   0    58   1   0    165
3    0   0   0  7561   0   0   0   781   7   0     91
4    0   0   0    61   0   0   0    19   0   0    459
5    0   0   0   459   0   0   0    19   0   0     43
6    0   0   0   155   0   0   3   112  33   0   1605
7    0   0   0   785   0   0   0  6229   5   0    246
8    0   0   0  1306   0   0   0   323  90   0   1577
9    0   0   0   292   0   0   0    49   0   0    152
10   0   0   0    78   0   0   0   116   3   0  12599
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1976492, 'precision': 0.1080439, 'recall': 0.18222426, 'specificity': 0.91913426, 'f1': 0.07412836, 'auroc': 0.68514615}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   30   0   0   7   643  12   0   478
1    0   0   0   44   0   0   2  1337   5   0   111
2    0   0   0   49   0   0   0   170   5   0   791
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0     9   0   0  1622
5    0   0   0  301   0   0   0   145   0   0   146
6    0   0   0   19   0   0   1    54   9   0  2984
7    0   0   0   12   0   0   0  1116   1   0    35
8    0   0   0  284   0   0   0   141  63   0   882
9    0   0   0  204   0   0   0   487   4   0   442
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 13,now: 2024-07-21 05:20:51.050026,epoch time: 0:24:41.031963,used: 5:26:19.825866,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.7098138, 'precision': 0.34708858, 'recall': 0.25229478, 'specificity': 0.96366674, 'f1': 0.2229546, 'auroc': 0.91122246}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    86   0   0   0   115    0   0    282
1    0   0   0    31   0   0   0  1209    4   0     88
2    0   0   0    91   0   0   0    54    0   0    166
3    0   0   0  7659   0   0   0   687    5   0     88
4    0   0   0    68   0   0   0    13    1   0    457
5    0   0   0   461   0   0   0    11    0   0     49
6    0   0   0   135   0   0   2   112   31   0   1627
7    0   0   0   817   0   0   0  6175    3   0    269
8    0   0   0  1360   0   0   0   302  108   0   1523
9    0   0   0   297   0   0   0    59    0   0    137
10   0   0   0   100   0   0   0   106    2   0  12586
---- Validation: 
scalar performance:
{'acc': 0.7085462, 'precision': 0.32662562, 'recall': 0.2520794, 'specificity': 0.96352196, 'f1': 0.223059, 'auroc': 0.9120531}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    78   0   0   1   104    0   0    300
1    0   0   0    32   0   0   0  1205    4   0     91
2    0   0   0    88   0   0   0    52    2   0    170
3    0   0   0  7636   0   0   0   719    7   0     78
4    0   0   0    58   0   0   0    15    0   0    466
5    0   0   0   462   0   0   0     9    1   0     49
6    0   0   0   143   0   0   4   116   28   0   1617
7    0   0   0   819   0   0   0  6170    9   0    267
8    0   0   0  1340   0   0   0   326  115   0   1515
9    0   0   0   299   0   0   0    45    0   0    149
10   0   0   0    98   0   0   0   131    3   0  12564
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19729938, 'precision': 0.1013667, 'recall': 0.18187046, 'specificity': 0.919114, 'f1': 0.07448458, 'auroc': 0.68693906}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   37   0   0   1   634   9   0   489
1    0   0   0   48   0   0   0  1328   5   0   118
2    0   0   0   50   0   0   0   156   5   0   804
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0     7   0   0  1624
5    0   0   0  312   0   0   0   129   0   0   151
6    0   0   0   20   0   0   0    48  10   0  2989
7    0   0   0   17   0   0   0  1111   0   0    36
8    0   0   0  283   0   0   0   139  64   0   884
9    0   0   0  211   0   0   0   469   4   0   453
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 14,now: 2024-07-21 05:45:54.040261,epoch time: 0:25:02.990235,used: 5:51:22.816101,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.7102954, 'precision': 0.30267763, 'recall': 0.2531314, 'specificity': 0.9638207, 'f1': 0.224195, 'auroc': 0.916123}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    79   0   0   0   120    0   0    284
1    0   0   0    20   0   0   1  1229    2   0     80
2    0   0   0    80   0   0   0    63    1   0    168
3    0   0   0  7574   0   0   0   780    5   0     80
4    0   0   0    65   0   0   0    19    2   0    452
5    0   0   0   458   0   0   0    13    1   0     49
6    0   0   0   137   0   0   1   124   27   0   1617
7    0   0   0   749   0   0   0  6267    9   0    240
8    0   0   0  1385   0   0   0   332  136   0   1440
9    0   0   0   289   0   0   0    55    0   0    149
10   0   0   0   100   0   0   0   117    7   0  12570
---- Validation: 
scalar performance:
{'acc': 0.71090007, 'precision': 0.25436616, 'recall': 0.25317883, 'specificity': 0.9638786, 'f1': 0.22390905, 'auroc': 0.9158163}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    68   0   0   0   118    1   0    296
1    0   0   0    20   0   0   0  1231    0   0     81
2    0   0   0    79   0   0   0    56    1   0    176
3    0   0   0  7608   0   0   0   754    4   0     74
4    0   0   0    65   0   0   0    17    1   0    456
5    0   0   0   457   0   0   0    10    0   0     54
6    0   0   0   146   0   0   0   141   32   0   1589
7    0   0   0   744   0   0   0  6265   12   0    244
8    0   0   0  1361   0   0   0   340  126   0   1469
9    0   0   0   296   0   0   0    50    0   0    147
10   0   0   0    91   0   0   0   119    8   0  12578
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19911845, 'precision': 0.1027715, 'recall': 0.18374842, 'specificity': 0.91935056, 'f1': 0.07612407, 'auroc': 0.6924062}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   40   0   0   1   649   9   0   471
1    0   0   0   42   0   0   0  1348   6   0   103
2    0   0   0   53   0   0   0   168   6   0   788
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0     9   0   0  1622
5    0   0   0  316   0   0   0   131   0   0   145
6    0   0   0   22   0   0   0    54  12   0  2979
7    0   0   0   14   0   0   0  1124   0   0    26
8    0   0   0  309   0   0   0   144  77   0   840
9    0   0   0  216   0   0   0   486   4   0   431
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 15,now: 2024-07-21 06:10:51.440051,epoch time: 0:24:57.399790,used: 6:16:20.215891,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.7118472, 'precision': 0.26250538, 'recall': 0.2533679, 'specificity': 0.96383464, 'f1': 0.22498141, 'auroc': 0.9170866}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    83   0   0   0   110    1   0    289
1    0   0   0    24   0   0   0  1204    3   0    101
2    0   0   0    86   0   0   0    47    1   0    178
3    0   0   0  7762   0   0   0   590    4   0     81
4    0   0   0    63   0   0   0    17    0   0    459
5    0   0   0   450   0   0   0    12    0   0     58
6    0   0   0   133   0   0   0   110   22   0   1643
7    0   0   0   872   0   0   0  6094    8   0    290
8    0   0   0  1359   0   0   0   281  140   0   1514
9    0   0   0   294   0   0   0    36    0   0    163
10   0   0   0    86   0   0   0    93    5   0  12610
---- Validation: 
scalar performance:
{'acc': 0.7112211, 'precision': 0.25542936, 'recall': 0.2529293, 'specificity': 0.9637905, 'f1': 0.22406313, 'auroc': 0.91727537}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    78   0   0   0   117    0   0    288
1    0   0   0    21   0   0   0  1201    3   0    107
2    0   0   0    89   0   0   0    54    0   0    169
3    0   0   0  7727   0   0   0   632    5   0     76
4    0   0   0    62   0   0   0    13    2   0    462
5    0   0   0   465   0   0   0     7    2   0     47
6    0   0   0   144   0   0   0   115   32   0   1617
7    0   0   0   837   0   0   0  6130    8   0    290
8    0   0   0  1359   0   0   0   274  124   0   1539
9    0   0   0   304   0   0   0    38    0   0    151
10   0   0   0    91   0   0   0    92    5   0  12608
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1968796, 'precision': 0.102209926, 'recall': 0.18144885, 'specificity': 0.9190252, 'f1': 0.07496998, 'auroc': 0.6906323}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   47   0   0   1   597   8   0   517
1    0   0   0   49   0   0   0  1318   4   0   128
2    0   0   0   50   0   0   0   131   5   0   829
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0     5   0   0  1626
5    0   0   0  309   0   0   0   110   1   0   172
6    0   0   0   19   0   0   0    36  10   0  3002
7    0   0   0   15   0   0   0  1109   0   0    40
8    0   0   0  282   0   0   0   112  60   0   916
9    0   0   0  213   0   0   0   410   3   0   511
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 16,now: 2024-07-21 06:35:46.129468,epoch time: 0:24:54.689417,used: 6:41:14.905308,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.7136398, 'precision': 0.3523286, 'recall': 0.25485492, 'specificity': 0.9641064, 'f1': 0.22723338, 'auroc': 0.92013353}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    78   0   0   0   107    1   0    297
1    0   0   0    28   0   0   0  1222    1   0     80
2    0   0   0    84   0   0   0    59    0   0    169
3    0   0   0  7745   0   0   0   616    6   0     71
4    0   0   0    53   0   0   0    14    2   0    470
5    0   0   0   463   0   0   0     8    1   0     49
6    0   0   0   146   0   0   1   135   28   0   1597
7    0   0   0   812   0   0   0  6147   15   0    288
8    0   0   0  1321   0   0   0   286  176   0   1513
9    0   0   0   284   0   0   0    44    0   0    165
10   0   0   0    88   0   0   0    96    6   0  12604
---- Validation: 
scalar performance:
{'acc': 0.712077, 'precision': 0.2593568, 'recall': 0.25385827, 'specificity': 0.9639155, 'f1': 0.22588831, 'auroc': 0.92019594}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    79   0   0   0   108    2   0    294
1    0   0   0    23   0   0   0  1239    1   0     69
2    0   0   0    81   0   0   0    63    0   0    168
3    0   0   0  7725   0   0   0   636    8   0     71
4    0   0   0    70   0   0   0    17    2   0    450
5    0   0   0   455   0   0   0    13    0   0     53
6    0   0   0   135   0   0   0   130   31   0   1612
7    0   0   0   835   0   0   0  6121   11   0    298
8    0   0   0  1287   0   0   0   295  161   0   1553
9    0   0   0   296   0   0   0    40    0   0    157
10   0   0   0    81   0   0   0    96    5   0  12614
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19813895, 'precision': 0.101977676, 'recall': 0.18263152, 'specificity': 0.9192306, 'f1': 0.077589735, 'auroc': 0.69442016}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   56   0   0   1   593  12   0   508
1    0   0   0   53   0   0   0  1321   4   0   121
2    0   0   0   56   0   0   0   129   7   0   823
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0     5   0   0  1626
5    0   0   0  334   0   0   0   100   1   0   157
6    0   0   0   25   0   0   0    33  13   0  2996
7    0   0   0   21   0   0   0  1108   0   0    35
8    0   0   0  306   0   0   0   103  79   0   882
9    0   0   0  232   0   0   0   406   5   0   494
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 17,now: 2024-07-21 07:00:51.469698,epoch time: 0:25:05.340230,used: 7:06:20.245538,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.71519154, 'precision': 0.26504958, 'recall': 0.2557605, 'specificity': 0.9643571, 'f1': 0.22776815, 'auroc': 0.92279166}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    71   0   0   0   121    1   0    289
1    0   0   0    16   0   0   0  1250    3   0     63
2    0   0   0    81   0   0   0    61    0   0    169
3    0   0   0  7649   0   0   0   708    5   0     75
4    0   0   0    64   0   0   0    21    0   0    454
5    0   0   0   451   0   0   0    10    1   0     59
6    0   0   0   126   0   0   0   147   27   0   1608
7    0   0   0   703   0   0   0  6302    8   0    252
8    0   0   0  1292   0   0   0   332  179   0   1492
9    0   0   0   276   0   0   0    60    0   0    157
10   0   0   0    79   0   0   0   109    4   0  12601
---- Validation: 
scalar performance:
{'acc': 0.7147519, 'precision': 0.35798174, 'recall': 0.25560057, 'specificity': 0.96432626, 'f1': 0.22764513, 'auroc': 0.9234399}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    69   0   0   0   136    0   0    278
1    0   0   0    13   0   0   0  1252    1   0     66
2    0   0   0    72   0   0   0    73    0   0    167
3    0   0   0  7637   0   0   0   721    5   0     77
4    0   0   0    57   0   0   0    23    2   0    457
5    0   0   0   449   0   0   0    14    0   0     58
6    0   0   0   136   0   0   1   148   19   0   1604
7    0   0   0   717   0   0   0  6292   10   0    246
8    0   0   0  1290   0   0   0   344  180   0   1482
9    0   0   0   274   0   0   0    64    0   0    155
10   0   0   0    73   0   0   0   107    5   0  12611
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19904849, 'precision': 0.10731031, 'recall': 0.18363509, 'specificity': 0.91931045, 'f1': 0.07693839, 'auroc': 0.69895715}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   48   0   0   0   626   7   0   489
1    0   0   0   42   0   0   0  1351   3   0   103
2    0   0   0   52   0   0   0   145   6   0   812
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0     7   0   0  1624
5    0   0   0  318   0   0   0   115   0   0   159
6    0   0   0   23   0   0   0    44  12   0  2988
7    0   0   0   16   0   0   0  1120   0   0    28
8    0   0   0  299   0   0   0   124  80   0   867
9    0   0   0  211   0   0   0   462   3   0   461
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 18,now: 2024-07-21 07:25:47.541884,epoch time: 0:24:56.072186,used: 7:31:16.317724,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.71864295, 'precision': 0.2668361, 'recall': 0.25852913, 'specificity': 0.9648218, 'f1': 0.2320787, 'auroc': 0.92839557}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    71   0   0   0   121    3   0    287
1    0   0   0    18   0   0   0  1235    1   0     78
2    0   0   0    61   0   0   0    77    0   0    174
3    0   0   0  7661   0   0   0   705    7   0     64
4    0   0   0    56   0   0   0    20    3   0    460
5    0   0   0   443   0   0   0    19    0   0     59
6    0   0   0   130   0   0   0   152   33   0   1593
7    0   0   0   668   0   0   0  6354   14   0    228
8    0   0   0  1257   0   0   0   356  253   0   1429
9    0   0   0   252   0   0   0    75    0   0    166
10   0   0   0    80   0   0   0   117    4   0  12592
---- Validation: 
scalar performance:
{'acc': 0.71753377, 'precision': 0.2668471, 'recall': 0.25788072, 'specificity': 0.96468496, 'f1': 0.23112124, 'auroc': 0.9270858}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    69   0   0   0   131    1   0    282
1    0   0   0    12   0   0   0  1254    1   0     65
2    0   0   0    73   0   0   0    74    0   0    165
3    0   0   0  7615   0   0   0   746   12   0     67
4    0   0   0    60   0   0   0    21    3   0    455
5    0   0   0   433   0   0   0    22    1   0     65
6    0   0   0   126   0   0   0   147   27   0   1608
7    0   0   0   653   0   0   0  6376    9   0    227
8    0   0   0  1230   0   0   0   365  239   0   1462
9    0   0   0   259   0   0   0    68    0   0    166
10   0   0   0    75   0   0   0   120    6   0  12595
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20142727, 'precision': 0.10788097, 'recall': 0.1859617, 'specificity': 0.9195223, 'f1': 0.079821035, 'auroc': 0.7025903}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   38   0   0   0   642   10   0   480
1    0   0   0   40   0   0   0  1356    2   0   101
2    0   0   0   49   0   0   0   155    7   0   804
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    2   0   0   0     8    0   0  1623
5    0   0   0  310   0   0   0   120    3   0   159
6    0   0   0   22   0   0   0    47   14   0  2984
7    0   0   0   13   0   0   0  1126    0   0    25
8    0   0   0  280   0   0   0   131  108   0   851
9    0   0   0  194   0   0   0   484    4   0   455
10   0   0   0    1   0   0   0     0    0   0  1645
better model found
persisted
after epoch: 19,now: 2024-07-21 07:50:36.317114,epoch time: 0:24:48.775230,used: 7:56:05.092954,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.71928513, 'precision': 0.26844454, 'recall': 0.25922385, 'specificity': 0.9648187, 'f1': 0.23432148, 'auroc': 0.9277048}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    81   0   0   0   106    2   0    294
1    0   0   0    20   0   0   0  1229    2   0     80
2    0   0   0    69   0   0   0    60    0   0    183
3    0   0   0  7758   0   0   0   602   12   0     67
4    0   0   0    62   0   0   0    19    1   0    457
5    0   0   0   440   0   0   0    12    0   0     69
6    0   0   0   130   0   0   0   136   36   0   1606
7    0   0   0   799   0   0   0  6196   13   0    256
8    0   0   0  1277   0   0   0   291  303   0   1425
9    0   0   0   262   0   0   0    46    0   0    185
10   0   0   0    79   0   0   0    78    6   0  12627
---- Validation: 
scalar performance:
{'acc': 0.718363, 'precision': 0.2679649, 'recall': 0.25892198, 'specificity': 0.9646847, 'f1': 0.23415202, 'auroc': 0.92908657}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    66   0   0   0   113    0   0    304
1    0   0   0    22   0   0   0  1232    1   0     77
2    0   0   0    76   0   0   0    49    1   0    186
3    0   0   0  7727   0   0   0   620   12   0     81
4    0   0   0    56   0   0   0    20    1   0    462
5    0   0   0   435   0   0   0     8    1   0     77
6    0   0   0   117   0   0   0   125   36   0   1630
7    0   0   0   795   0   0   0  6202   12   0    256
8    0   0   0  1317   0   0   0   270  305   0   1404
9    0   0   0   253   0   0   0    47    0   0    193
10   0   0   0    61   0   0   0   103   10   0  12622
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20086756, 'precision': 0.10778189, 'recall': 0.18530166, 'specificity': 0.9194319, 'f1': 0.08128663, 'auroc': 0.7047487}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   54   0   0   0   591   13   0   512
1    0   0   0   46   0   0   0  1321    3   0   129
2    0   0   0   50   0   0   0   127    6   0   832
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    2   0   0   0     6    0   0  1625
5    0   0   0  320   0   0   0    94    5   0   173
6    0   0   0   21   0   0   0    33   13   0  3000
7    0   0   0   16   0   0   0  1115    0   0    33
8    0   0   0  278   0   0   0   103  111   0   878
9    0   0   0  203   0   0   0   409    4   0   521
10   0   0   0    1   0   0   0     0    0   0  1645
better model found
persisted
after epoch: 20,now: 2024-07-21 08:15:37.550904,epoch time: 0:25:01.233790,used: 8:21:06.326744,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.7186697, 'precision': 0.26848966, 'recall': 0.25891805, 'specificity': 0.964998, 'f1': 0.23294675, 'auroc': 0.929219}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    86   0   0   0   131    2   0    264
1    0   0   0    22   0   0   0  1252    2   0     56
2    0   0   0    79   0   0   0    73    0   0    160
3    0   0   0  7742   0   0   0   636   10   0     50
4    0   0   0    69   0   0   0    23    1   0    446
5    0   0   0   452   0   0   0    14    0   0     55
6    0   0   0   142   0   0   0   183   27   0   1556
7    0   0   0   806   0   0   0  6249   11   0    198
8    0   0   0  1416   0   0   0   319  285   0   1275
9    0   0   0   285   0   0   0    59    0   0    148
10   0   0   0    89   0   0   0   109    9   0  12585
---- Validation: 
scalar performance:
{'acc': 0.7179617, 'precision': 0.26707038, 'recall': 0.25843802, 'specificity': 0.96488756, 'f1': 0.2320734, 'auroc': 0.93000406}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    84   0   0   0   148    2   0    249
1    0   0   0    21   0   0   0  1262    2   0     47
2    0   0   0    76   0   0   0    72    1   0    163
3    0   0   0  7705   0   0   0   658   13   0     64
4    0   0   0    62   0   0   0    22    2   0    453
5    0   0   0   454   0   0   0    16    0   0     51
6    0   0   0   145   0   0   0   177   27   0   1559
7    0   0   0   749   0   0   0  6291   11   0    214
8    0   0   0  1403   0   0   0   310  267   0   1316
9    0   0   0   275   0   0   0    64    0   0    154
10   0   0   0    92   0   0   0   120    6   0  12578
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20240678, 'precision': 0.10800115, 'recall': 0.18690243, 'specificity': 0.919831, 'f1': 0.08157696, 'auroc': 0.7110092}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   67   0   0   0   659    9   0   435
1    0   0   0   44   0   0   0  1367    1   0    87
2    0   0   0   63   0   0   0   177    8   0   767
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    2   0   0   0    11    1   0  1619
5    0   0   0  358   0   0   0   108    2   0   124
6    0   0   0   34   0   0   0    58   17   0  2958
7    0   0   0   16   0   0   0  1127    0   0    21
8    0   0   0  343   0   0   0   130  121   0   776
9    0   0   0  250   0   0   0   500    7   0   380
10   0   0   0    1   0   0   0     0    0   0  1645
early stop counter: 1
val acc:0.7179617285728455, best validation acc: 0.7183629870414734, corresponding to test acc:                         0.20086756348609924 / 0.2990275025367737
after epoch: 21,now: 2024-07-21 08:40:32.298330,epoch time: 0:24:54.747426,used: 8:46:01.074170,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.7188035, 'precision': 0.27074096, 'recall': 0.25843817, 'specificity': 0.96489054, 'f1': 0.23162696, 'auroc': 0.9307206}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    69   0   0   0   137    0   0    277
1    0   0   0    16   0   0   0  1260    3   0     53
2    0   0   0    74   0   0   0    74    0   0    164
3    0   0   0  7710   0   0   0   665    8   0     53
4    0   0   0    61   0   0   0    23    0   0    455
5    0   0   0   454   0   0   0     8    0   0     59
6    0   0   0   135   0   0   0   188   18   0   1566
7    0   0   0   705   0   0   0  6330    9   0    220
8    0   0   0  1316   0   0   0   332  244   0   1404
9    0   0   0   264   0   0   0    53    0   0    175
10   0   0   0    93   0   0   0   111    8   0  12582
---- Validation: 
scalar performance:
{'acc': 0.7198074, 'precision': 0.2708494, 'recall': 0.25915956, 'specificity': 0.96503395, 'f1': 0.23290479, 'auroc': 0.9294776}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    71   0   0   0   130    1   0    281
1    0   0   0    16   0   0   0  1264    2   0     50
2    0   0   0    72   0   0   0    71    0   0    169
3    0   0   0  7723   0   0   0   648   10   0     59
4    0   0   0    67   0   0   0    25    0   0    447
5    0   0   0   448   0   0   0     9    0   0     64
6    0   0   0   146   0   0   0   178   19   0   1565
7    0   0   0   726   0   0   0  6314   11   0    214
8    0   0   0  1327   0   0   0   351  269   0   1349
9    0   0   0   249   0   0   0    59    0   0    185
10   0   0   0    80   0   0   0   104    8   0  12604
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20030785, 'precision': 0.11718472, 'recall': 0.18493521, 'specificity': 0.9195232, 'f1': 0.07795125, 'auroc': 0.7095162}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   55   0   0   0   652   4   0   459
1    0   0   0   41   0   0   0  1363   0   0    95
2    0   0   0   58   0   0   0   166   3   0   788
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0     9   0   0  1622
5    0   0   0  333   0   0   0   116   0   0   143
6    0   0   0   32   0   0   0    52  10   0  2973
7    0   0   0   14   0   0   0  1129   0   0    21
8    0   0   0  322   0   0   0   137  89   0   822
9    0   0   0  221   0   0   0   492   1   0   423
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 22,now: 2024-07-21 09:05:20.858358,epoch time: 0:24:48.560028,used: 9:10:49.634198,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.722469, 'precision': 0.272766, 'recall': 0.26227936, 'specificity': 0.96534425, 'f1': 0.2385076, 'auroc': 0.933114}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    81   0   0   0   116    2   0    284
1    0   0   0    15   0   0   0  1263    4   0     50
2    0   0   0    61   0   0   0    72    1   0    178
3    0   0   0  7715   0   0   0   647   14   0     62
4    0   0   0    62   0   0   0    21    1   0    455
5    0   0   0   441   0   0   0    10    0   0     70
6    0   0   0   140   0   0   0   189   21   0   1557
7    0   0   0   713   0   0   0  6319   11   0    221
8    0   0   0  1247   0   0   0   333  386   0   1330
9    0   0   0   241   0   0   0    60    0   0    192
10   0   0   0    76   0   0   0   120   12   0  12583
---- Validation: 
scalar performance:
{'acc': 0.72087735, 'precision': 0.26820505, 'recall': 0.2613829, 'specificity': 0.9651824, 'f1': 0.23744771, 'auroc': 0.93335056}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    69   0   0   0   128    3   0    283
1    0   0   0    15   0   0   0  1253    3   0     61
2    0   0   0    70   0   0   0    68    0   0    174
3    0   0   0  7672   0   0   0   694   17   0     57
4    0   0   0    65   0   0   0    19    2   0    453
5    0   0   0   438   0   0   0    19    0   0     64
6    0   0   0   125   0   0   0   193   27   0   1563
7    0   0   0   726   0   0   0  6302   21   0    216
8    0   0   0  1268   0   0   0   320  376   0   1332
9    0   0   0   249   0   0   0    66    0   0    178
10   0   0   0    71   0   0   0   109   16   0  12600
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20457567, 'precision': 0.11207621, 'recall': 0.18897125, 'specificity': 0.9199142, 'f1': 0.08507396, 'auroc': 0.7135148}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   61   0   0   0   634   12   0   463
1    0   0   0   41   0   0   0  1362    1   0    95
2    0   0   0   54   0   0   0   157   10   0   794
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    2   0   0   0     8    0   0  1623
5    0   0   0  336   0   0   0    98    3   0   155
6    0   0   0   28   0   0   0    50   15   0  2974
7    0   0   0   15   0   0   0  1128    0   0    21
8    0   0   0  288   0   0   0   114  151   0   817
9    0   0   0  219   0   0   0   475    4   0   439
10   0   0   0    1   0   0   0     0    0   0  1645
better model found
persisted
after epoch: 23,now: 2024-07-21 09:30:19.506412,epoch time: 0:24:58.648054,used: 9:35:48.282252,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.7201145, 'precision': 0.27255866, 'recall': 0.2594751, 'specificity': 0.96508896, 'f1': 0.23305589, 'auroc': 0.93342453}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    71   0   0   0   142    1   0    269
1    0   0   0    17   0   0   0  1267    2   0     46
2    0   0   0    59   0   0   0    88    0   0    165
3    0   0   0  7645   0   0   0   722    9   0     63
4    0   0   0    61   0   0   0    24    0   0    454
5    0   0   0   446   0   0   0    13    0   0     62
6    0   0   0   132   0   0   0   198   13   0   1565
7    0   0   0   654   0   0   0  6405   10   0    194
8    0   0   0  1295   0   0   0   340  269   0   1392
9    0   0   0   246   0   0   0    78    1   0    168
10   0   0   0    70   0   0   0   116    8   0  12596
---- Validation: 
scalar performance:
{'acc': 0.7211983, 'precision': 0.27296007, 'recall': 0.25981098, 'specificity': 0.96520483, 'f1': 0.23322383, 'auroc': 0.9338615}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    63   0   0   0   133    1   0    286
1    0   0   0    14   0   0   0  1257    2   0     59
2    0   0   0    65   0   0   0    77    0   0    170
3    0   0   0  7680   0   0   0   694    7   0     59
4    0   0   0    58   0   0   0    26    2   0    453
5    0   0   0   451   0   0   0    15    0   0     55
6    0   0   0   117   0   0   0   225   17   0   1549
7    0   0   0   627   0   0   0  6418   10   0    210
8    0   0   0  1335   0   0   0   335  263   0   1363
9    0   0   0   247   0   0   0    64    0   0    182
10   0   0   0    72   0   0   0   119    4   0  12601
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20212692, 'precision': 0.11453605, 'recall': 0.18669572, 'specificity': 0.91975653, 'f1': 0.08022846, 'auroc': 0.715167}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   59   0   0   0   679    4   0   428
1    0   0   0   40   0   0   0  1377    1   0    81
2    0   0   0   60   0   0   0   183    5   0   767
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    2   0   0   0    10    0   0  1621
5    0   0   0  344   0   0   0   117    1   0   130
6    0   0   0   34   0   0   0    60   14   0  2959
7    0   0   0   14   0   0   0  1132    0   0    18
8    0   0   0  327   0   0   0   137  112   0   794
9    0   0   0  218   0   0   0   532    2   0   385
10   0   0   0    1   0   0   0     0    0   0  1645
better model found
persisted
after epoch: 24,now: 2024-07-21 09:55:31.549291,epoch time: 0:25:12.042879,used: 10:01:00.325131,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.7220944, 'precision': 0.27587405, 'recall': 0.2609505, 'specificity': 0.9651033, 'f1': 0.23644683, 'auroc': 0.93467385}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    66   0   0   0   117    1   0    299
1    0   0   0    15   0   0   0  1243    1   0     73
2    0   0   0    59   0   0   0    60    1   0    192
3    0   0   0  7687   0   0   0   664   11   0     74
4    0   0   0    55   0   0   0    22    1   0    461
5    0   0   0   428   0   0   0     9    0   0     84
6    0   0   0   106   0   0   0   164   15   0   1622
7    0   0   0   661   0   0   0  6333    8   0    262
8    0   0   0  1200   0   0   0   324  327   0   1445
9    0   0   0   244   0   0   0    48    1   0    200
10   0   0   0    61   0   0   0    85    5   0  12642
---- Validation: 
scalar performance:
{'acc': 0.7209309, 'precision': 0.27328703, 'recall': 0.2604125, 'specificity': 0.96491873, 'f1': 0.2361161, 'auroc': 0.9343376}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    66   0   0   0   115    0   0    302
1    0   0   0    14   0   0   0  1243    1   0     74
2    0   0   0    51   0   0   0    57    1   0    203
3    0   0   0  7655   0   0   0   677   19   0     89
4    0   0   0    46   0   0   0    21    0   0    472
5    0   0   0   424   0   0   0    16    0   0     81
6    0   0   0   102   0   0   0   166   20   0   1620
7    0   0   0   667   0   0   0  6317    9   0    272
8    0   0   0  1201   0   0   0   289  327   0   1479
9    0   0   0   236   0   0   0    46    0   0    211
10   0   0   0    57   0   0   0    80    6   0  12653
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20107745, 'precision': 0.11403039, 'recall': 0.18559529, 'specificity': 0.9193776, 'f1': 0.08036785, 'auroc': 0.71250516}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   48   0   0   0   597    4   0   521
1    0   0   0   39   0   0   0  1338    1   0   121
2    0   0   0   42   0   0   0   129    6   0   838
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0     4    0   0  1628
5    0   0   0  310   0   0   0    97    2   0   183
6    0   0   0   18   0   0   0    30   13   0  3006
7    0   0   0   10   0   0   0  1124    0   0    30
8    0   0   0  247   0   0   0   110  104   0   909
9    0   0   0  173   0   0   0   424    2   0   538
10   0   0   0    0   0   0   0     0    0   0  1646
early stop counter: 1
val acc:0.7209308743476868, best validation acc: 0.721198320388794, corresponding to test acc:                         0.20212692022323608 / 0.2990275025367737
after epoch: 25,now: 2024-07-21 10:20:25.630316,epoch time: 0:24:54.081025,used: 10:25:54.406156,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.7238335, 'precision': 0.2749133, 'recall': 0.26236087, 'specificity': 0.96539325, 'f1': 0.23871168, 'auroc': 0.93547285}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    84   0   0   0    96    1   0    302
1    0   0   0    18   0   0   0  1248    2   0     62
2    0   0   0    58   0   0   0    59    1   0    194
3    0   0   0  7810   0   0   0   558   12   0     58
4    0   0   0    54   0   0   0    13    0   0    472
5    0   0   0   447   0   0   0     6    0   0     68
6    0   0   0   132   0   0   0   160   14   0   1601
7    0   0   0   762   0   0   0  6249   13   0    241
8    0   0   0  1277   0   0   0   307  375   0   1335
9    0   0   0   254   0   0   0    40    1   0    198
10   0   0   0    72   0   0   0    89   13   0  12620
---- Validation: 
scalar performance:
{'acc': 0.72531766, 'precision': 0.27529246, 'recall': 0.26359314, 'specificity': 0.96559775, 'f1': 0.24051505, 'auroc': 0.9352504}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    69   0   0   0   109    1   0    304
1    0   0   0    16   0   0   0  1251    1   0     64
2    0   0   0    76   0   0   0    46    1   0    189
3    0   0   0  7809   0   0   0   558   18   0     55
4    0   0   0    56   0   0   0    26    3   0    454
5    0   0   0   442   0   0   0    11    0   0     68
6    0   0   0   145   0   0   0   169    7   0   1587
7    0   0   0   752   0   0   0  6271   19   0    223
8    0   0   0  1262   0   0   0   276  410   0   1348
9    0   0   0   266   0   0   0    36    0   0    191
10   0   0   0    69   0   0   0    89   12   0  12626
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2037361, 'precision': 0.116365395, 'recall': 0.18813974, 'specificity': 0.91985995, 'f1': 0.08487372, 'auroc': 0.72017}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   68   0   0   0   606    6   0   490
1    0   0   0   46   0   0   0  1354    0   0    99
2    0   0   0   60   0   0   0   142    8   0   805
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    2   0   0   0     7    0   0  1624
5    0   0   0  356   0   0   0    87    1   0   148
6    0   0   0   30   0   0   0    43   15   0  2979
7    0   0   0   16   0   0   0  1125    0   0    23
8    0   0   0  309   0   0   0   112  142   0   807
9    0   0   0  233   0   0   0   437    3   0   464
10   0   0   0    1   0   0   0     0    0   0  1645
better model found
persisted
after epoch: 26,now: 2024-07-21 10:45:10.878370,epoch time: 0:24:45.248054,used: 10:50:39.654210,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.72305757, 'precision': 0.2763399, 'recall': 0.26159507, 'specificity': 0.96529347, 'f1': 0.23675084, 'auroc': 0.93607074}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    70   0   0   0   110    0   0    303
1    0   0   0    15   0   0   0  1262    2   0     53
2    0   0   0    52   0   0   0    78    0   0    182
3    0   0   0  7674   0   0   0   690   10   0     63
4    0   0   0    49   0   0   0    21    2   0    467
5    0   0   0   416   0   0   0    15    1   0     88
6    0   0   0   105   0   0   0   170    9   0   1624
7    0   0   0   619   0   0   0  6415   10   0    220
8    0   0   0  1239   0   0   0   336  327   0   1393
9    0   0   0   236   0   0   0    53    0   0    204
10   0   0   0    58   0   0   0   118    8   0  12609
---- Validation: 
scalar performance:
{'acc': 0.72240204, 'precision': 0.27681392, 'recall': 0.26063284, 'specificity': 0.9651847, 'f1': 0.23503497, 'auroc': 0.9356161}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    68   0   0   0   104    1   0    310
1    0   0   0    10   0   0   0  1256    1   0     65
2    0   0   0    52   0   0   0    69    0   0    191
3    0   0   0  7657   0   0   0   708   12   0     63
4    0   0   0    49   0   0   0    22    2   0    466
5    0   0   0   424   0   0   0     9    1   0     87
6    0   0   0   120   0   0   0   176    8   0   1604
7    0   0   0   612   0   0   0  6428    7   0    218
8    0   0   0  1257   0   0   0   316  289   0   1434
9    0   0   0   249   0   0   0    45    0   0    199
10   0   0   0    67   0   0   0    93    3   0  12633
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20184706, 'precision': 0.11769846, 'recall': 0.18637156, 'specificity': 0.91967285, 'f1': 0.081313446, 'auroc': 0.7203986}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   62   0   0   0   624    4   0   480
1    0   0   0   41   0   0   0  1363    0   0    95
2    0   0   0   53   0   0   0   158    4   0   800
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    2   0   0   0     8    0   0  1623
5    0   0   0  354   0   0   0    90    1   0   147
6    0   0   0   32   0   0   0    49   11   0  2975
7    0   0   0   14   0   0   0  1127    0   0    23
8    0   0   0  316   0   0   0   121  113   0   820
9    0   0   0  231   0   0   0   454    3   0   449
10   0   0   0    1   0   0   0     0    0   0  1645
early stop counter: 1
val acc:0.722402036190033, best validation acc: 0.725317656993866, corresponding to test acc:                         0.2037360966205597 / 0.2990275025367737
after epoch: 27,now: 2024-07-21 11:10:01.712127,epoch time: 0:24:50.833757,used: 11:15:30.487967,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.72361946, 'precision': 0.27606997, 'recall': 0.26212656, 'specificity': 0.9655103, 'f1': 0.23745872, 'auroc': 0.93726337}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    80   0   0   0   120    2   0    281
1    0   0   0    16   0   0   0  1270    1   0     45
2    0   0   0    51   0   0   0    77    0   0    184
3    0   0   0  7757   0   0   0   615    8   0     57
4    0   0   0    64   0   0   0    19    2   0    454
5    0   0   0   435   0   0   0    14    0   0     72
6    0   0   0   146   0   0   0   179   14   0   1569
7    0   0   0   713   0   0   0  6347    8   0    197
8    0   0   0  1371   0   0   0   301  349   0   1272
9    0   0   0   246   0   0   0    69    0   0    178
10   0   0   0    85   0   0   0   106    9   0  12593
---- Validation: 
scalar performance:
{'acc': 0.7240337, 'precision': 0.27671328, 'recall': 0.2624093, 'specificity': 0.9655456, 'f1': 0.23775186, 'auroc': 0.9384702}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    65   0   0   0   124    1   0    293
1    0   0   0    15   0   0   0  1268    4   0     45
2    0   0   0    60   0   0   0    70    0   0    182
3    0   0   0  7739   0   0   0   642   11   0     48
4    0   0   0    53   0   0   0    20    0   0    466
5    0   0   0   442   0   0   0    10    1   0     68
6    0   0   0   136   0   0   0   176    8   0   1588
7    0   0   0   702   0   0   0  6386    8   0    169
8    0   0   0  1377   0   0   0   290  351   0   1278
9    0   0   0   241   0   0   0    55    1   0    196
10   0   0   0    79   0   0   0   117    8   0  12592
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19925837, 'precision': 0.11836736, 'recall': 0.18398683, 'specificity': 0.9195485, 'f1': 0.07600762, 'auroc': 0.7214189}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   74   0   0   0   650   2   0   444
1    0   0   0   34   0   0   0  1383   0   0    82
2    0   0   0   62   0   0   0   184   1   0   768
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    11   0   0  1620
5    0   0   0  376   0   0   0    97   0   0   119
6    0   0   0   38   0   0   0    57   9   0  2963
7    0   0   0   13   0   0   0  1133   0   0    18
8    0   0   0  373   0   0   0   135  70   0   792
9    0   0   0  254   0   0   0   513   1   0   369
10   0   0   0    1   0   0   0     0   0   0  1645
early stop counter: 2
val acc:0.7240337133407593, best validation acc: 0.725317656993866, corresponding to test acc:                         0.2037360966205597 / 0.2990275025367737
after epoch: 28,now: 2024-07-21 11:34:42.490191,epoch time: 0:24:40.778064,used: 11:40:11.266031,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.72487694, 'precision': 0.27558857, 'recall': 0.26351652, 'specificity': 0.96548593, 'f1': 0.2409768, 'auroc': 0.93921024}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    69   0   0   0    99    1   0    314
1    0   0   0    15   0   0   0  1246    3   0     68
2    0   0   0    46   0   0   0    60    0   0    206
3    0   0   0  7845   0   0   0   527   18   0     48
4    0   0   0    51   0   0   0    17    3   0    468
5    0   0   0   434   0   0   0     3    1   0     83
6    0   0   0   121   0   0   0   146   17   0   1624
7    0   0   0   811   0   0   0  6193   13   0    246
8    0   0   0  1317   0   0   0   258  425   0   1294
9    0   0   0   231   0   0   0    42    0   0    220
10   0   0   0    73   0   0   0    83    7   0  12630
---- Validation: 
scalar performance:
{'acc': 0.7264946, 'precision': 0.27707416, 'recall': 0.26452804, 'specificity': 0.9656862, 'f1': 0.24223527, 'auroc': 0.9388622}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    74   0   0   0   102    2   0    305
1    0   0   0    20   0   0   0  1257    2   0     53
2    0   0   0    53   0   0   0    57    0   0    202
3    0   0   0  7849   0   0   0   523   13   0     55
4    0   0   0    54   0   0   0    18    2   0    465
5    0   0   0   431   0   0   0     4    0   0     86
6    0   0   0   131   0   0   0   146   10   0   1621
7    0   0   0   797   0   0   0  6234   11   0    223
8    0   0   0  1295   0   0   0   234  443   0   1324
9    0   0   0   233   0   0   0    47    1   0    212
10   0   0   0    69   0   0   0    75   18   0  12634
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19883859, 'precision': 0.11894487, 'recall': 0.18341254, 'specificity': 0.9194242, 'f1': 0.078738526, 'auroc': 0.723347}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   82   0   0   0   565   4   0   519
1    0   0   0   38   0   0   0  1358   0   0   103
2    0   0   0   63   0   0   0   127   2   0   823
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0     4   0   0  1627
5    0   0   0  379   0   0   0    65   0   0   148
6    0   0   0   34   0   0   0    34  10   0  2989
7    0   0   0   21   0   0   0  1118   0   0    25
8    0   0   0  366   0   0   0    96  79   0   829
9    0   0   0  268   0   0   0   387   0   0   482
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 29,now: 2024-07-21 11:59:27.058385,epoch time: 0:24:44.568194,used: 12:04:55.834225,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.72575986, 'precision': 0.27668017, 'recall': 0.26483244, 'specificity': 0.965785, 'f1': 0.24213722, 'auroc': 0.93995565}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    71   0   0   0   129    1   0    282
1    0   0   0    16   0   0   0  1278    2   0     36
2    0   0   0    46   0   0   0    68    0   0    197
3    0   0   0  7679   0   0   0   688   13   0     58
4    0   0   0    47   0   0   0    25    2   0    465
5    0   0   0   426   0   0   0    14    0   0     81
6    0   0   0   127   0   0   0   195   17   0   1569
7    0   0   0   680   0   0   0  6397   10   0    177
8    0   0   0  1320   0   0   0   298  454   0   1223
9    0   0   0   219   0   0   0    63    0   0    211
10   0   0   0    79   0   0   0   106   11   0  12596
---- Validation: 
scalar performance:
{'acc': 0.72724354, 'precision': 0.27588814, 'recall': 0.26590383, 'specificity': 0.9659758, 'f1': 0.24367383, 'auroc': 0.94017315}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    72   0   0   0   127    0   0    284
1    0   0   0    12   0   0   0  1282    3   0     35
2    0   0   0    43   0   0   0    68    0   0    201
3    0   0   0  7674   0   0   0   690   31   0     45
4    0   0   0    51   0   0   0    25    2   0    461
5    0   0   0   423   0   0   0    20    1   0     77
6    0   0   0   123   0   0   0   186   12   0   1587
7    0   0   0   652   0   0   0  6415   11   0    187
8    0   0   0  1320   0   0   0   292  484   0   1200
9    0   0   0   219   0   0   0    71    0   0    203
10   0   0   0    68   0   0   0   105    8   0  12615
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19939831, 'precision': 0.11831334, 'recall': 0.18416652, 'specificity': 0.91952896, 'f1': 0.07501756, 'auroc': 0.7282514}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   59   0   0   0   685   2   0   424
1    0   0   0   30   0   0   0  1395   0   0    74
2    0   0   0   56   0   0   0   199   1   0   759
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    13   0   0  1618
5    0   0   0  348   0   0   0   116   0   0   128
6    0   0   0   40   0   0   0    67   8   0  2952
7    0   0   0   10   0   0   0  1137   0   0    17
8    0   0   0  383   0   0   0   139  68   0   780
9    0   0   0  211   0   0   0   561   1   0   364
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 30,now: 2024-07-21 12:24:16.659472,epoch time: 0:24:49.601087,used: 12:29:45.435312,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:29:45.435312 at 2024-07-21 12:24:16.659472
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19939831, 'precision': 0.11831334, 'recall': 0.18416652, 'specificity': 0.91952896, 'f1': 0.07501756, 'auroc': 0.7282514}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   59   0   0   0   685   2   0   424
1    0   0   0   30   0   0   0  1395   0   0    74
2    0   0   0   56   0   0   0   199   1   0   759
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    13   0   0  1618
5    0   0   0  348   0   0   0   116   0   0   128
6    0   0   0   40   0   0   0    67   8   0  2952
7    0   0   0   10   0   0   0  1137   0   0    17
8    0   0   0  383   0   0   0   139  68   0   780
9    0   0   0  211   0   0   0   561   1   0   364
10   0   0   0    1   0   0   0     0   0   0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2990275, 'precision': 0.087659106, 'recall': 0.19614106, 'specificity': 0.9228816, 'f1': 0.11918062, 'auroc': 0.6031379}
confusion matrix:
    0   1   2    3   4   5     6    7   8   9    10
0    0   0   0    2   0   0   870  289   0   0    9
1    0   0   0    5   0   0   520  964   0   0   10
2    0   0   0    4   0   0   834   97   0   0   80
3    0   0   0    0   0   0     0    0   0   0    0
4    0   0   0    0   0   0   858    3   0   0  772
5    0   0   0  114   0   0   305  170   0   0    3
6    0   0   0    1   0   0  2441   10   0   0  615
7    0   0   0    4   0   0   170  986   0   0    4
8    0   0   0   23   0   0  1190   74   0   0   83
9    0   0   0   23   0   0   778  320   0   0   16
10   0   0   0    0   0   0   799    0   0   0  847
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562327_instance_wise_predictions.txt
accuracy from prediction file 0.1993983068634996
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/4.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 194817 KiB | 464403 KiB | 765216 GiB | 765216 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 749191 GiB | 749190 GiB |
|       from small pool |  20417 KiB |  39765 KiB |  16025 GiB |  16025 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 194817 KiB | 464403 KiB | 765216 GiB | 765216 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 749191 GiB | 749190 GiB |
|       from small pool |  20417 KiB |  39765 KiB |  16025 GiB |  16025 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191316 KiB | 459653 KiB | 765189 GiB | 765189 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 749182 GiB | 749182 GiB |
|       from small pool |  18502 KiB |  37835 KiB |  16007 GiB |  16006 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 514048 KiB | 514048 KiB | 514048 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  40960 KiB |  40960 KiB |  40960 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44799 KiB |  73488 KiB | 429057 GiB | 429057 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 413013 GiB | 413013 GiB |
|       from small pool |  14399 KiB |  15818 KiB |  16044 GiB |  16044 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    5890    |    7872    |  142731 K  |  142725 K  |
|       from large pool |      76    |     158    |   73841 K  |   73841 K  |
|       from small pool |    5814    |    7754    |   68889 K  |   68883 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5890    |    7872    |  142731 K  |  142725 K  |
|       from large pool |      76    |     158    |   73841 K  |   73841 K  |
|       from small pool |    5814    |    7754    |   68889 K  |   68883 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      41    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      20    |      20    |      20    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    2324    |   74482 K  |   74482 K  |
|       from large pool |       9    |      19    |   49034 K  |   49034 K  |
|       from small pool |      28    |    2315    |   25448 K  |   25448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464403 KiB | 765216 GiB | 765216 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 749191 GiB | 749191 GiB |
|       from small pool |      0 KiB |  39765 KiB |  16025 GiB |  16025 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464403 KiB | 765216 GiB | 765216 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 749191 GiB | 749191 GiB |
|       from small pool |      0 KiB |  39765 KiB |  16025 GiB |  16025 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459653 KiB | 765189 GiB | 765189 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 749182 GiB | 749182 GiB |
|       from small pool |      0 KiB |  37835 KiB |  16007 GiB |  16007 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB | 514048 KiB | 514048 KiB | 274432 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  34816 KiB |  40960 KiB |  40960 KiB |   6144 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  88829 KiB | 429057 GiB | 429057 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 413013 GiB | 413013 GiB |
|       from small pool |      0 KiB |  28668 KiB |  16044 GiB |  16044 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7872    |  142731 K  |  142731 K  |
|       from large pool |       2    |     158    |   73841 K  |   73841 K  |
|       from small pool |       0    |    7754    |   68889 K  |   68889 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7872    |  142731 K  |  142731 K  |
|       from large pool |       2    |     158    |   73841 K  |   73841 K  |
|       from small pool |       0    |    7754    |   68889 K  |   68889 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |      41    |      41    |      14    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      17    |      20    |      20    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2324    |   74485 K  |   74485 K  |
|       from large pool |       3    |      19    |   49034 K  |   49034 K  |
|       from small pool |       0    |    2315    |   25450 K  |   25450 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464403 KiB | 765216 GiB | 765216 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 749191 GiB | 749191 GiB |
|       from small pool |      0 KiB |  39765 KiB |  16025 GiB |  16025 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464403 KiB | 765216 GiB | 765216 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 749191 GiB | 749191 GiB |
|       from small pool |      0 KiB |  39765 KiB |  16025 GiB |  16025 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459653 KiB | 765189 GiB | 765189 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 749182 GiB | 749182 GiB |
|       from small pool |      0 KiB |  37835 KiB |  16007 GiB |  16007 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 239616 KiB | 514048 KiB | 514048 KiB | 274432 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  34816 KiB |  40960 KiB |  40960 KiB |   6144 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  88829 KiB | 429057 GiB | 429057 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 413013 GiB | 413013 GiB |
|       from small pool |      0 KiB |  28668 KiB |  16044 GiB |  16044 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7872    |  142731 K  |  142731 K  |
|       from large pool |       2    |     158    |   73841 K  |   73841 K  |
|       from small pool |       0    |    7754    |   68889 K  |   68889 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7872    |  142731 K  |  142731 K  |
|       from large pool |       2    |     158    |   73841 K  |   73841 K  |
|       from small pool |       0    |    7754    |   68889 K  |   68889 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      27    |      41    |      41    |      14    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      17    |      20    |      20    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2324    |   74485 K  |   74485 K  |
|       from large pool |       3    |      19    |   49034 K  |   49034 K  |
|       from small pool |       0    |    2315    |   25450 K  |   25450 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327

 Experiment start at: 2024-07-21 12:53:03.058484
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.53186536, 'precision': 0.17708647, 'recall': 0.17692697, 'specificity': 0.9401616, 'f1': 0.1536951, 'auroc': 0.66280633}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    62   0   0   0   120    0   0    301
1    0   1   8   246   0   0   0   699    4   0    373
2    0   0   0    85   0   2   0    43    3   0    179
3    0   0  10  6444   1   1   0   406   14   0   1562
4    0   0   1    99   0   0   0    32    5   0    402
5    0   0   0   310   0   0   0    13    1   0    196
6    0   0   2   214   0   0   0   236    8   0   1448
7    0   6   1  2575   0   0   0  1938   10   0   2733
8    0   1  13  1071   0   0   0   112   73   0   2025
9    0   0   1   177   0   0   0    41    1   0    272
10   1   3  10   515   0   1   0   734  108   0  11423
---- Validation: 
scalar performance:
{'acc': 0.53312826, 'precision': 0.17861675, 'recall': 0.17745627, 'specificity': 0.94033825, 'f1': 0.15379499, 'auroc': 0.6636295}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    54   0   0   0   139    2   0    288
1    0   1   3   249   0   0   0   689    2   0    388
2    0   0   0    96   0   0   0    53    0   0    163
3    0   1   6  6521   1   0   0   360   14   0   1537
4    0   0   1    91   0   0   0    36    6   0    405
5    0   0   1   325   0   0   0    16    0   0    179
6    0   0   3   196   0   0   0   236    7   0   1466
7    1   7   2  2547   0   0   1  1955    8   0   2744
8    0   0  12  1119   1   0   1   105   64   0   1994
9    0   0   1   194   0   0   0    40    0   0    258
10   1   0   9   542   1   0   0   752  101   0  11390
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.10585602, 'precision': 0.019639457, 'recall': 0.103392, 'specificity': 0.91022384, 'f1': 0.032671895, 'auroc': 0.5359033}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   0   0   5   0   0   0   928   0   0   237
1    0   0   0  63   0   0   0  1282   0   0   154
2    0   0   0  13   0   0   0   565   0   0   437
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   2   0   0   0   778   0   0   853
5    0   0   0  90   0   0   0   209   0   0   293
6    0   0   0   8   0   0   0   993   0   0  2066
7    0   0   0  27   0   0   0   867   0   0   270
8    0   0   0  67   0   0   0   399   0   0   904
9    0   0   0  59   0   0   0   682   0   0   396
10   0   0   0  15   0   0   0   985   0   0   646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 13:17:33.985118,epoch time: 0:24:30.926634,used: 0:24:30.926634,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.59706765, 'precision': 0.29289857, 'recall': 0.20224485, 'specificity': 0.94845974, 'f1': 0.17895752, 'auroc': 0.7487539}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    68   0   0   0   130    1   0    284
1    0   6   3   233   0   0   1   884    0   0    205
2    0   0   1    91   0   0   0    45    2   0    173
3    1   0   1  7217   0   0   0   351    7   0    862
4    0   0   0    77   0   0   0    26    6   0    430
5    0   0   1   407   0   0   0    12    2   0     99
6    0   0   2   176   0   0   0   200    5   0   1525
7    0   2   1  2400   0   0   0  2633    3   0   2226
8    0   0   8  1000   0   0   0    69  112   0   2105
9    0   0   2   252   0   0   1    37    0   0    201
10   0   0   1   231   0   0   0   176   35   0  12347
---- Validation: 
scalar performance:
{'acc': 0.59467703, 'precision': 0.2521805, 'recall': 0.20116372, 'specificity': 0.9481637, 'f1': 0.1779229, 'auroc': 0.74660474}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    60   0   0   0   141    0   0    282
1    0   4   0   228   0   0   0   905    2   0    193
2    0   0   0    83   0   0   0    56    1   0    172
3    0   0   5  7174   0   0   0   375   12   0    874
4    0   0   1    77   0   0   0    12    3   0    446
5    0   0   0   407   0   0   0    12    0   0    102
6    0   0   3   186   0   0   0   194    8   0   1517
7    0   5   0  2372   0   0   0  2612    2   0   2274
8    0   0   7   999   0   0   0    61  124   0   2105
9    0   1   3   238   0   0   0    43    2   0    206
10   0   0   4   226   0   0   0   199   49   0  12318
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.15930875, 'precision': 0.029518101, 'recall': 0.14833239, 'specificity': 0.91522205, 'f1': 0.049221247, 'auroc': 0.58782744}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   0   0   2   0   0   0   937   0   0   231
1    0   0   0  42   0   0   0  1350   0   0   107
2    0   0   0   9   0   0   0   461   0   0   545
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   1   0   0   0   298   0   0  1334
5    0   0   0  99   0   0   0   256   1   0   236
6    0   0   0   1   0   0   0   480   0   0  2586
7    0   0   0  18   0   0   0   987   0   0   159
8    0   0   0  57   0   0   0   262   0   0  1051
9    0   0   0  52   0   0   0   757   0   0   328
10   0   0   0   3   0   0   0   353   0   0  1290
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 13:42:56.009271,epoch time: 0:25:22.024153,used: 0:49:52.950787,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6008401, 'precision': 0.31464615, 'recall': 0.20243874, 'specificity': 0.9481095, 'f1': 0.18028691, 'auroc': 0.80491954}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    74   0   0   0    39    0   0    370
1    0  14   0   234   0   0   0   586    1   0    496
2    0   0   0    79   0   0   0     7    1   0    225
3    0   1   9  7376   0   0   0   215   21   0    815
4    0   0   2    47   0   0   0     2    6   0    482
5    0   0   6   402   0   0   0     2    4   0    107
6    0   0   3   150   0   0   0    26    9   0   1720
7    0   0   1  2474   0   0   0  2265    4   0   2519
8    0   0  33   723   0   0   0    18  131   0   2391
9    0   1   3   233   0   0   0    11    6   0    239
10   0   0   9    91   0   0   0    12   10   0  12671
---- Validation: 
scalar performance:
{'acc': 0.59991974, 'precision': 0.3054583, 'recall': 0.2020538, 'specificity': 0.94796926, 'f1': 0.17989469, 'auroc': 0.8061456}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   1   0    69   0   0   0    35    1   0    377
1    0  13   0   220   0   0   0   625    1   0    473
2    0   1   0    78   0   0   0     6    1   0    226
3    0   0  11  7376   0   0   0   198   21   0    834
4    0   0   2    53   0   0   0     1    4   0    479
5    0   0   8   382   0   0   0     3    5   0    123
6    0   1   6   140   0   0   0    35    4   0   1722
7    0   0   0  2481   0   0   1  2235    2   0   2546
8    0   0  26   699   0   0   0    23  136   0   2412
9    0   0   4   237   0   0   0    12    5   0    235
10   0   1   5    91   0   0   0    16   15   0  12668
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.17561044, 'precision': 0.04030032, 'recall': 0.15852523, 'specificity': 0.916134, 'f1': 0.061967224, 'auroc': 0.6199354}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0    5   0   0   0   334   1   0   830
1    0   0   0   56   0   0   0  1009   0   0   434
2    0   0   0    7   0   0   0   105   0   0   903
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0     7   0   0  1625
5    0   0   2  108   0   0   0   109   0   0   373
6    0   0   0    2   0   0   0    31   0   0  3034
7    0   0   0   44   0   0   0   870   0   0   250
8    0   0   0   56   0   0   0    77   0   0  1237
9    0   0   0   59   0   0   0   411   0   0   667
10   0   0   0    1   0   0   0     5   0   0  1640
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 14:07:52.247764,epoch time: 0:24:56.238493,used: 1:14:49.189280,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.63714683, 'precision': 0.30897948, 'recall': 0.22135448, 'specificity': 0.953267, 'f1': 0.202908, 'auroc': 0.83388746}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    72   0   0   0    56    0   0    355
1    0  21   0   211   0   0   0   753    1   0    346
2    0   0   0    77   0   0   1    16    3   0    215
3    0   0   2  7602   0   0   0   286   26   0    522
4    0   0   0    45   0   0   0     0    3   0    491
5    0   0   2   388   0   0   0     5   10   0    116
6    0   4   0   126   0   0   0    43   15   0   1720
7    0   1   0  2401   0   0   0  3282    7   0   1574
8    0   0   5   744   0   0   0    53  254   0   2239
9    0   3   0   252   0   0   2    11    6   0    218
10   0   2   1    94   0   0   0    23   16   0  12655
---- Validation: 
scalar performance:
{'acc': 0.6348268, 'precision': 0.34150964, 'recall': 0.22064456, 'specificity': 0.9529921, 'f1': 0.20264974, 'auroc': 0.8370867}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    62   0   0   0    53    1   0    367
1    0  18   0   226   0   0   0   725    1   0    362
2    0   0   0    72   0   0   0    20    2   0    218
3    0   2   3  7548   0   0   0   296   34   0    557
4    0   0   0    47   0   0   0     2    8   0    482
5    0   0   1   405   0   0   0     6    6   0    103
6    0   4   1   139   0   0   1    47   10   0   1706
7    1   4   0  2440   0   0   0  3236    6   0   1578
8    0   0   6   750   0   0   0    47  279   0   2214
9    0   4   1   235   0   0   1    13    6   0    233
10   0   0   0    80   0   0   0    33   32   0  12651
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18225706, 'precision': 0.039273597, 'recall': 0.16585332, 'specificity': 0.9169474, 'f1': 0.06219292, 'auroc': 0.6274359}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0    6   0   0   0   457   1   0   706
1    0   0   0   53   0   0   0  1175   0   0   271
2    0   0   0    7   0   0   0   129   0   0   879
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0     4   0   0  1628
5    0   0   1  117   0   0   0   158   0   0   316
6    0   0   0    2   0   0   0    27   0   0  3038
7    0   0   0   48   0   0   0   961   0   0   155
8    0   0   0   57   0   0   0    99   0   0  1214
9    0   0   0   62   0   0   0   489   0   0   586
10   0   0   0    0   0   0   0     2   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 14:32:29.667661,epoch time: 0:24:37.419897,used: 1:39:26.609177,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.65614295, 'precision': 0.32327884, 'recall': 0.23473126, 'specificity': 0.95601165, 'f1': 0.22086588, 'auroc': 0.85424477}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    68   0   0   1    53    1   0    360
1    0  12   0   238   0   0   0   725    2   0    355
2    0   1   0    73   0   0   0    19   10   0    209
3    0   2   0  7669   0   0   0   285   81   0    398
4    0   0   0    47   0   0   1     4   13   0    473
5    0   0   0   401   0   0   4     5   19   0     92
6    0   8   0   120   0   0   6    39   66   0   1669
7    0   2   0  2300   0   0   0  3609   16   0   1338
8    0   0   0   727   0   0   0    79  577   0   1912
9    0   2   0   237   0   0   3    16   20   0    215
10   0   0   0    81   0   0   0    24   38   0  12651
---- Validation: 
scalar performance:
{'acc': 0.65478134, 'precision': 0.29937702, 'recall': 0.23364751, 'specificity': 0.9558959, 'f1': 0.21914637, 'auroc': 0.85489225}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   1   0    83   0   0   0    59    2   0    338
1    0  10   0   223   0   0   3   753    1   0    342
2    0   0   0    84   0   0   2    16   11   0    199
3    0   0   0  7686   0   0   0   277   77   0    400
4    0   0   0    51   0   0   0     3   11   0    474
5    0   0   0   402   0   0   5     2   17   0     95
6    0   9   0   128   0   0   2    43   49   0   1677
7    0   1   0  2389   0   0   0  3563   19   0   1293
8    0   0   0   753   0   0   0    69  566   0   1908
9    0   1   0   242   0   0   3    18   21   0    208
10   0   0   0    72   0   0   1    32   39   0  12652
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18414609, 'precision': 0.09375106, 'recall': 0.16779822, 'specificity': 0.91721946, 'f1': 0.063916996, 'auroc': 0.63129413}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   10   0   0   2   484   2   0   672
1    0   0   0   71   0   0   0  1193   0   0   235
2    0   0   0    8   0   0   0   141   0   0   866
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0     5   0   0  1627
5    0   0   0  136   0   0   0   170   4   0   282
6    0   0   0    2   0   0   0    23   0   0  3042
7    0   0   0   56   0   0   0   975   0   0   133
8    0   0   0   65   0   0   0    90  12   0  1203
9    0   0   0   72   0   0   0   519   2   0   544
10   0   0   0    0   0   0   0     1   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 14:57:13.940616,epoch time: 0:24:44.272955,used: 2:04:10.882132,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.67519265, 'precision': 0.35734633, 'recall': 0.24844855, 'specificity': 0.9587482, 'f1': 0.23779593, 'auroc': 0.8653083}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   3   0    78   0   0   0    54    4   0    344
1    0  24   0   213   0   0   3   799    1   0    291
2    0   2   0    78   0   0   3    16   16   0    197
3    0   0   0  7640   0   0   0   325  143   0    331
4    0   0   0    43   0   0   1     3   16   0    476
5    0   2   0   389   0   1  13     2   33   0     81
6    0   5   0    97   0   0  14    63   78   0   1651
7    0   1   0  2081   0   0   0  4092   28   0   1062
8    0   1   0   690   0   0   1   121  818   0   1665
9    0   3   0   213   0   2  17    16   30   0    212
10   0   0   0    63   0   0   0    37   43   0  12647
---- Validation: 
scalar performance:
{'acc': 0.6769025, 'precision': 0.34112465, 'recall': 0.24907789, 'specificity': 0.9589521, 'f1': 0.2383551, 'auroc': 0.86484045}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   3   0    67   0   0   0    58   10   0    345
1    0  24   0   192   0   0   1   788    4   0    323
2    0   4   0    73   0   0   3    23   16   0    193
3    0   1   0  7671   0   0   1   340  133   0    294
4    0   0   0    51   0   0   0     2   11   0    475
5    0   3   0   401   0   0   3     2   30   0     82
6    0   9   0    91   0   0  21    65   89   0   1633
7    0   0   0  2049   0   0   0  4138   29   0   1049
8    0   0   0   692   0   0   1   104  804   0   1695
9    0   2   0   229   0   1  12    13   30   0    206
10   0   1   0    56   0   0   0    46   45   0  12648
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18540545, 'precision': 0.10098636, 'recall': 0.16886409, 'specificity': 0.9172818, 'f1': 0.06788173, 'auroc': 0.6441706}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   11   0   0   2   475   4   0   678
1    0   0   0   58   0   0   1  1144   0   0   296
2    0   0   0    4   0   0   0   117   0   0   894
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0     4   0   0  1629
5    0   0   0  131   0   0   0   170   9   0   282
6    0   0   0    3   0   0   0    19   4   0  3041
7    0   0   0   53   0   0   0   965   0   0   146
8    0   0   0   65   0   0   0    98  39   0  1168
9    0   0   0   61   0   0   0   452   2   0   622
10   0   0   0    0   0   0   0     0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 15:21:57.660992,epoch time: 0:24:43.720376,used: 2:28:54.602508,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.69657, 'precision': 0.32425174, 'recall': 0.26412037, 'specificity': 0.96238583, 'f1': 0.25408903, 'auroc': 0.87495565}
confusion matrix:
    0   1   2     3   4   5   6     7     8   9      10
0    0   3   0    90   0   0   8   104     7   0    270
1    0  21   0   276   0   0   4   860     4   0    167
2    0   2   0    93   0   0  13    38    25   0    141
3    0   0   0  7900   0   0   0   258   141   0    140
4    0   1   0    50   0   0   5     8    29   0    446
5    0   1   0   386   0   0  24    11    52   0     47
6    0  16   0   125   0   0  60    89   136   0   1482
7    0   1   0  2358   0   0   1  4386    37   0    481
8    0   0   0   786   0   0   0   142  1108   0   1260
9    0   2   0   246   0   0  50    28    58   0    109
10   0   1   0    78   0   0   1    82    68   0  12560
---- Validation: 
scalar performance:
{'acc': 0.6942624, 'precision': 0.328757, 'recall': 0.26298776, 'specificity': 0.9621141, 'f1': 0.25330904, 'auroc': 0.8758966}
confusion matrix:
    0   1   2     3   4   5   6     7     8   9      10
0    0   4   0    95   0   0   9   100     9   0    266
1    0  24   0   259   0   0   1   898     4   0    146
2    0   1   0    94   0   0  17    38    21   0    141
3    0   0   0  7868   0   0   0   269   153   0    150
4    0   1   0    49   0   0   3     6    30   0    450
5    0   1   0   397   0   0  18     7    51   0     47
6    0  17   0   112   0   0  68    95   141   0   1475
7    0   2   0  2358   0   0   1  4353    37   0    514
8    0   0   0   828   0   0   0   147  1073   0   1248
9    0   1   0   237   0   0  51    30    55   0    119
10   0   0   0    81   0   0   3    81    62   0  12569
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19876863, 'precision': 0.107964404, 'recall': 0.18224104, 'specificity': 0.91913885, 'f1': 0.081261754, 'auroc': 0.6524434}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   2   0   25   0   0  25   711   11   0   396
1    0   0   0  102   0   0   1  1276    0   0   120
2    0   0   0   20   0   0   0   234    4   0   757
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0    12    0   0  1620
5    0   0   0  189   0   0   7   248   20   0   128
6    0   0   0   10   0   0   0   131   10   0  2916
7    0   0   0   97   0   0   0  1022    0   0    45
8    0   0   0  120   0   0   6   204  176   0   864
9    0   0   0  118   0   0   5   686    6   0   322
10   0   0   0    1   0   0   0     2    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-21 15:47:01.907357,epoch time: 0:25:04.246365,used: 2:53:58.848873,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.70775366, 'precision': 0.3228053, 'recall': 0.2683704, 'specificity': 0.96367437, 'f1': 0.25758815, 'auroc': 0.88311535}
confusion matrix:
    0   1   2     3   4   5   6     7     8   9      10
0    0   0   0    76   0   0   4   122    10   0    271
1    0   4   0   185   0   0   6   972     3   0    162
2    0   0   0    72   0   0  15    42    27   0    156
3    0   0   0  7661   0   0   0   429   183   0    165
4    0   0   0    38   0   0   5    14    17   0    465
5    0   0   0   384   0   0  31    11    61   0     34
6    0   6   0    84   0   0  84   110   137   0   1487
7    0   0   0  1675   0   0   3  5055    31   0    497
8    0   0   0   653   0   0   0   239  1039   0   1364
9    0   0   1   227   0   0  74    41    46   0    104
10   0   0   0    48   0   0   1    79    56   0  12610
---- Validation: 
scalar performance:
{'acc': 0.70910794, 'precision': 0.34456742, 'recall': 0.2697611, 'specificity': 0.96381164, 'f1': 0.25954878, 'auroc': 0.8849888}
confusion matrix:
    0   1   2     3   4   5   6     7     8   9      10
0    0   0   0    84   0   0   1   112    10   0    276
1    0  12   0   144   0   0   3  1003     3   0    167
2    0   1   0    69   0   0  16    49    25   0    152
3    0   0   1  7671   0   0   0   417   179   0    172
4    0   0   0    38   0   0   3    14    26   0    458
5    0   0   0   392   0   0  28    11    54   0     36
6    0   5   0    81   0   0  85    83   162   0   1492
7    0   1   0  1616   0   0   2  5090    35   0    521
8    0   0   0   661   0   0   2   215  1054   0   1364
9    0   0   0   213   0   0  61    38    70   0    111
10   0   1   0    64   0   0   2    90    41   0  12598
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20541523, 'precision': 0.11029872, 'recall': 0.1889624, 'specificity': 0.9196216, 'f1': 0.08568011, 'auroc': 0.6570096}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0    9   0   0  26   731   23   0   381
1    0   0   0   54   0   0   2  1312    0   0   131
2    0   0   0    7   0   0   4   245    5   0   754
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    0   0   0   0     9    0   0  1624
5    0   0   1  142   0   0  18   278   25   0   128
6    0   0   0    6   0   0   4   122   14   0  2921
7    0   0   0   47   0   0   0  1071    0   0    46
8    0   0   0   86   0   0   8   219  217   0   840
9    0   0   0   62   0   0   6   729    8   0   332
10   0   0   0    0   0   0   0     1    1   0  1644
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-21 16:11:48.748862,epoch time: 0:24:46.841505,used: 3:18:45.690378,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.7131582, 'precision': 0.3375533, 'recall': 0.27155504, 'specificity': 0.9643236, 'f1': 0.26115665, 'auroc': 0.89142627}
confusion matrix:
    0   1   2     3   4   5   6     7     8   9      10
0    0   1   0    75   0   0  11   106    13   0    277
1    0   7   0   129   0   0   3  1033     3   0    157
2    0   1   0    64   0   0  16    44    30   0    157
3    0   0   0  7664   0   0   1   453   174   0    145
4    0   0   0    33   0   0   4    14    22   0    466
5    0   0   0   371   0   0  30     9    71   0     40
6    2   5   0    75   0   0  95    99   155   0   1476
7    0   0   0  1491   0   0   2  5220    40   0    512
8    0   0   0   636   0   0   0   224  1050   0   1385
9    0   0   0   232   0   0  57    47    60   0     97
10   0   0   0    52   0   0   1    78    42   0  12619
---- Validation: 
scalar performance:
{'acc': 0.713147, 'precision': 0.34780753, 'recall': 0.2712425, 'specificity': 0.9642829, 'f1': 0.260288, 'auroc': 0.8920585}
confusion matrix:
    0   1   2     3   4   5   6     7     8   9      10
0    0   1   0    66   0   0   8   120     9   0    279
1    0   8   0   139   0   0   4  1020     4   0    157
2    0   0   0    67   0   0  24    38    28   0    155
3    1   0   0  7665   0   0   0   426   174   0    174
4    0   1   0    39   0   0   3    17    27   0    452
5    0   0   0   370   0   0  27    12    64   0     48
6    1   1   0    67   0   0  74   116   163   0   1486
7    0   1   0  1477   0   0   3  5214    46   0    524
8    0   0   0   610   0   0   0   221  1076   0   1389
9    0   0   0   212   0   0  54    42    66   0    119
10   0   0   0    54   0   0   1    78    39   0  12624
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20772406, 'precision': 0.1116221, 'recall': 0.19124614, 'specificity': 0.91979057, 'f1': 0.088429525, 'auroc': 0.66636497}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   10   0   0  24   699   26   0   411
1    0   0   0   43   0   0   2  1309    0   0   145
2    0   0   0    5   0   0   3   214    7   0   786
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    0   0   0   0     7    0   0  1626
5    0   0   1  136   0   0  14   277   28   0   136
6    0   0   0    6   0   0   4    99   16   0  2942
7    0   0   0   35   0   0   0  1079    0   0    50
8    0   0   0   71   0   0   4   201  242   0   852
9    0   0   0   53   0   0   5   703    8   0   368
10   0   0   0    0   0   0   0     1    1   0  1644
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-21 16:36:32.936616,epoch time: 0:24:44.187754,used: 3:43:29.878132,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.71599424, 'precision': 0.36842716, 'recall': 0.2795116, 'specificity': 0.9650037, 'f1': 0.27270547, 'auroc': 0.89802814}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   1   0    99   0   0   12    95    15   0    261
1    0  16   0   106   0   0    6  1050     2   0    152
2    0   0   0    58   0   0   36    42    38   0    138
3    0   0   0  7902   0   0    1   255   183   0     97
4    0   0   0    41   0   0    8     9    29   0    452
5    0   0   0   366   0   0   36     9    88   0     22
6    0   4   0    75   0   0  198    97   180   0   1353
7    0   0   0  1944   0   0    2  4835    48   0    434
8    0   0   0   705   0   0    2   157  1230   0   1202
9    0   0   0   225   0   0   87    38    65   0     78
10   0   0   0    61   0   0    7    73    71   0  12580
---- Validation: 
scalar performance:
{'acc': 0.71630335, 'precision': 0.37195683, 'recall': 0.2784902, 'specificity': 0.9649757, 'f1': 0.271042, 'auroc': 0.8969306}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    88   0   0   13   101    10   0    271
1    0  10   0   127   0   0    8  1021     5   0    161
2    0   1   0    74   0   0   31    49    21   0    136
3    0   0   0  7913   0   0    0   247   169   0    111
4    0   0   0    40   0   0    2    14    33   0    450
5    0   0   0   378   0   0   27    18    69   0     29
6    0   1   0    88   0   0  183    97   197   0   1342
7    0   1   0  1896   0   0    3  4865    50   0    450
8    0   0   0   709   0   0    1   168  1215   0   1203
9    0   0   0   213   0   0   75    41    72   0     92
10   0   0   0    63   0   0    4    70    66   0  12593
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21094242, 'precision': 0.112270065, 'recall': 0.19333397, 'specificity': 0.9202204, 'f1': 0.09657043, 'auroc': 0.67589796}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   21   0   0  67   698   20   0   364
1    0   0   0   89   0   0   2  1271    1   0   136
2    0   0   0   18   0   0   6   208   12   0   771
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0     7    1   0  1624
5    0   0   1  187   0   0  35   226   38   0   105
6    0   0   0    9   0   0  13   100   35   0  2910
7    0   0   0   97   0   0   0  1025    0   0    42
8    0   0   0   96   0   0  17   171  333   0   753
9    0   0   0  115   0   0  22   655   15   0   330
10   0   0   0    1   0   0   0     0    1   0  1644
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-21 17:01:14.747771,epoch time: 0:24:41.811155,used: 4:08:11.689287,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.72575986, 'precision': 0.3986613, 'recall': 0.28362125, 'specificity': 0.9662901, 'f1': 0.27519166, 'auroc': 0.90396327}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    89   0   0    5   113    17   0    259
1    0   5   0    82   0   0    4  1095     5   0    141
2    0   0   0    74   0   0   26    53    27   0    132
3    0   0   0  7811   0   0    0   356   174   0     99
4    0   0   0    41   0   0    3    14    35   0    444
5    0   0   0   388   0   0   29    12    72   0     20
6    1   0   0    71   0   0  189   127   238   0   1281
7    0   0   0  1543   0   0    1  5293    55   0    373
8    0   0   0   681   0   0    1   207  1251   0   1155
9    0   0   0   215   0   0   62    54    89   0     73
10   0   0   0    63   0   0    2    88    61   0  12577
---- Validation: 
scalar performance:
{'acc': 0.7264411, 'precision': 0.3946222, 'recall': 0.2837261, 'specificity': 0.9664072, 'f1': 0.27508512, 'auroc': 0.9050312}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    84   0   0   12   120    12   0    255
1    0   7   0    88   0   0    6  1084     8   0    139
2    0   0   0    61   0   0   26    62    38   0    125
3    0   0   0  7805   0   0    1   358   186   0     90
4    0   0   0    46   0   0    7    19    29   0    438
5    0   0   0   381   0   0   27    15    73   0     25
6    0   0   0    69   0   0  186   113   241   0   1299
7    0   0   0  1512   0   0    3  5329    50   0    371
8    0   0   0   682   0   0    1   231  1239   0   1143
9    0   0   0   210   0   0   70    51    93   0     69
10   0   0   0    60   0   0    1    76    67   0  12592
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21758904, 'precision': 0.115862, 'recall': 0.20036747, 'specificity': 0.92096156, 'f1': 0.09902681, 'auroc': 0.6812769}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   18   0   0  32   773   32   0   315
1    0   0   0   59   0   0   2  1330    1   0   107
2    0   0   0    9   0   0   4   259   14   0   729
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    0   0   0   0    10    1   0  1622
5    0   0   1  171   0   0  22   270   41   0    87
6    0   0   0    7   0   0  12   143   40   0  2865
7    0   0   0   50   0   0   0  1084    0   0    30
8    0   0   0   88   0   0   3   221  370   0   688
9    0   0   0   83   0   0  11   744   18   0   281
10   0   0   0    0   0   0   0     1    1   0  1644
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-21 17:26:08.651220,epoch time: 0:24:53.903449,used: 4:33:05.592736,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.73188674, 'precision': 0.40254822, 'recall': 0.2916519, 'specificity': 0.96721506, 'f1': 0.2848224, 'auroc': 0.91025865}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    85   0   0   14   123    17   0    243
1    0   8   0    72   0   0    4  1109     4   0    135
2    0   0   0    51   0   0   31    67    32   0    130
3    0   0   0  7819   0   0    1   329   210   0     79
4    0   0   0    42   0   0   10    14    38   0    435
5    0   0   0   360   0   0   24    21    88   0     28
6    0   0   0    65   0   0  261   109   244   0   1228
7    0   0   0  1567   0   0    2  5294    54   0    345
8    0   0   0   630   0   0    3   235  1410   0   1018
9    0   0   0   214   0   0   70    46    84   0     79
10   0   0   0    50   0   0    8    82    92   0  12563
---- Validation: 
scalar performance:
{'acc': 0.73235255, 'precision': 0.3881073, 'recall': 0.29159915, 'specificity': 0.96728194, 'f1': 0.28480455, 'auroc': 0.9095081}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    84   0   0   14   125    18   0    242
1    0   5   0    83   0   0    5  1096     8   0    135
2    0   0   0    63   0   0   34    56    37   0    122
3    0   0   0  7870   0   0    0   308   187   0     75
4    0   0   0    40   0   0   10    14    30   0    445
5    0   0   0   374   0   0   29    17    82   0     19
6    0   1   0    61   0   0  272   104   254   0   1216
7    0   0   0  1592   0   0    2  5302    57   0    312
8    0   0   0   642   0   0    0   231  1378   0   1045
9    0   0   0   214   0   0   71    59    85   0     64
10   0   0   0    64   0   0    6    98    76   0  12552
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2194081, 'precision': 0.11754265, 'recall': 0.20149219, 'specificity': 0.9211593, 'f1': 0.10216518, 'auroc': 0.6886005}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   20   0   0  45   768   29   0   308
1    0   0   0   66   0   0   2  1323    1   0   107
2    0   0   0   16   0   0   6   250   17   0   726
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0     8    1   0  1623
5    0   0   1  178   0   0  27   259   45   0    82
6    0   0   0    8   0   0  21   140   58   0  2840
7    0   0   0   72   0   0   0  1061    0   0    31
8    0   0   0   96   0   0   7   206  410   0   651
9    0   0   0   94   0   0  20   729   18   0   276
10   0   0   0    1   0   0   0     0    1   0  1644
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-21 17:50:52.521363,epoch time: 0:24:43.870143,used: 4:57:49.462879,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7367027, 'precision': 0.40599912, 'recall': 0.29738718, 'specificity': 0.96801615, 'f1': 0.29144526, 'auroc': 0.91314745}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    97   0   0   16   128    24   0    218
1    0   3   0    71   0   0    7  1129     8   0    114
2    0   0   0    60   0   0   38    56    45   0    113
3    0   0   0  7866   0   0    1   298   200   0     74
4    0   0   0    44   0   0   18    17    47   0    413
5    0   0   0   368   0   0   33    18    81   0     21
6    0   0   0    60   0   0  357   108   271   0   1112
7    0   0   0  1549   0   0    3  5356    54   0    301
8    0   0   0   715   0   0    2   207  1427   0    944
9    0   0   0   210   0   0   74    50    99   0     60
10   0   0   0    68   0   0    6   108    83   0  12526
---- Validation: 
scalar performance:
{'acc': 0.73548216, 'precision': 0.408251, 'recall': 0.29625374, 'specificity': 0.9678484, 'f1': 0.29043844, 'auroc': 0.9128296}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    93   0   0   12   119    32   0    227
1    0   2   0    71   0   0    6  1133     5   0    115
2    0   0   0    59   0   0   38    59    38   0    118
3    0   0   0  7881   0   0    0   312   180   0     67
4    0   0   0    44   0   0   11    20    39   0    425
5    0   0   0   377   0   0   20    18    89   0     17
6    0   0   0    57   0   0  356   100   287   0   1108
7    0   0   0  1576   0   0    1  5330    70   0    288
8    0   0   0   731   0   0    1   208  1398   0    958
9    0   0   0   224   0   0   72    52    85   0     60
10   0   0   0    71   0   0    8   102    86   0  12529
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2243056, 'precision': 0.12027538, 'recall': 0.20529509, 'specificity': 0.92174685, 'f1': 0.10665084, 'auroc': 0.6948395}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   27   0   0  59   795   33   0   256
1    0   0   0   71   0   0   2  1334    1   0    91
2    0   0   0   23   0   0  14   288   23   0   667
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0    14    1   0  1617
5    0   0   1  196   0   0  28   263   50   0    54
6    0   0   0   12   0   0  42   170   86   0  2757
7    0   0   0   85   0   0   0  1054    0   0    25
8    0   0   0  105   0   0  14   214  467   0   570
9    0   0   0  125   0   0  32   745   25   0   210
10   0   0   0    1   0   0   0     0    2   0  1643
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-21 18:15:31.895347,epoch time: 0:24:39.373984,used: 5:22:28.836863,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.7422678, 'precision': 0.41191727, 'recall': 0.29969352, 'specificity': 0.9685514, 'f1': 0.29421136, 'auroc': 0.9156755}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    88   0   0   13   109    21   0    252
1    0   2   0    53   0   0    5  1136     7   0    129
2    0   0   0    66   0   0   23    59    42   0    122
3    0   0   0  7747   0   0    1   430   185   0     77
4    0   0   0    43   0   0   12    17    34   0    433
5    0   0   0   373   0   0   25    22    79   0     22
6    0   0   0    46   0   0  369   116   279   0   1098
7    0   0   0  1220   0   0    1  5682    54   0    306
8    0   0   0   599   0   0    2   272  1382   0   1040
9    0   0   0   209   0   0   81    43    85   0     75
10   0   0   0    50   0   0    5    91    83   0  12561
---- Validation: 
scalar performance:
{'acc': 0.7442557, 'precision': 0.4129664, 'recall': 0.30261415, 'specificity': 0.9688477, 'f1': 0.2976159, 'auroc': 0.91585857}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    85   0   0   15   130    19   0    234
1    0   2   0    47   0   0    7  1138     5   0    133
2    0   0   0    58   0   0   29    66    36   0    123
3    0   0   0  7756   0   0    0   413   194   0     77
4    0   0   0    31   0   0   18    22    41   0    427
5    0   0   0   386   0   0   22    19    71   0     23
6    0   0   0    59   0   0  408    97   272   0   1072
7    0   0   0  1213   0   0    2  5683    60   0    307
8    0   0   0   602   0   0    3   261  1421   0   1009
9    0   0   0   210   0   0   79    57    93   0     54
10   0   0   0    57   0   0   10    96    79   0  12554
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22486532, 'precision': 0.122981876, 'recall': 0.20659299, 'specificity': 0.9216915, 'f1': 0.105384365, 'auroc': 0.6959839}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   17   0   0  44   788   37   0   284
1    0   0   0   45   0   0   3  1355    1   0    95
2    0   0   0   11   0   0   8   272   18   0   706
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0    11    1   0  1620
5    0   0   1  173   0   0  25   281   42   0    70
6    0   0   0    7   0   0  32   157   71   0  2800
7    0   0   0   48   0   0   0  1089    0   0    27
8    0   0   0   79   0   0   4   231  449   0   607
9    0   0   0   72   0   0  22   772   23   0   248
10   0   0   0    0   0   0   0     1    1   0  1644
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-21 18:40:15.915478,epoch time: 0:24:44.020131,used: 5:47:12.856994,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.7532909, 'precision': 0.41560513, 'recall': 0.315741, 'specificity': 0.97041583, 'f1': 0.3103885, 'auroc': 0.9192855}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    88   0   0   20   140    34   0    201
1    0   2   0    46   0   0    5  1157     9   0    111
2    0   0   0    58   0   0   45    65    56   0     88
3    0   0   0  7804   0   0    2   372   221   0     40
4    0   0   0    42   0   0   24    23    55   0    395
5    0   0   0   358   0   0   36    27    87   0     13
6    0   0   0    48   0   0  557   114   308   0    881
7    0   0   0  1295   0   0    1  5674    75   0    219
8    0   0   0   579   0   0    5   265  1643   0    802
9    0   0   0   189   0   0   79    64   118   0     42
10   0   0   0    60   0   0   13   116   130   0  12475
---- Validation: 
scalar performance:
{'acc': 0.7512104, 'precision': 0.41445255, 'recall': 0.31488523, 'specificity': 0.9701806, 'f1': 0.3094278, 'auroc': 0.91842604}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    72   0   0   31   138    31   0    211
1    0   2   0    43   0   0   10  1164    11   0    102
2    0   0   0    52   0   0   42    70    54   0     94
3    0   0   0  7788   0   0    1   366   236   0     49
4    0   0   0    38   0   0   19    24    55   0    403
5    0   0   0   343   0   0   31    23   109   0     15
6    0   0   0    47   0   0  556   116   307   0    882
7    0   0   0  1324   0   0    2  5616    96   0    227
8    0   0   0   602   0   0    3   258  1649   0    784
9    0   0   0   193   0   0   72    74   104   0     50
10   0   0   0    58   0   0   17   109   139   0  12473
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23808858, 'precision': 0.12231533, 'recall': 0.21696189, 'specificity': 0.92299926, 'f1': 0.11560957, 'auroc': 0.7028782}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   20   0   0  103   808   35   0   204
1    0   0   0   47   0   0    3  1373    2   0    74
2    0   0   0   18   0   0   31   322   31   0   613
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    1   0   0    2    17    2   0  1611
5    0   0   0  161   0   0   44   287   59   0    41
6    0   0   0   10   0   0   94   230  151   0  2582
7    0   0   0   54   0   0    0  1095    0   0    15
8    0   0   0   88   0   0   21   235  573   0   453
9    0   0   0   75   0   0   59   810   26   0   167
10   0   0   0    1   0   0    0     0    4   0  1641
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-21 19:05:05.209406,epoch time: 0:24:49.293928,used: 6:12:02.150922,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.7492508, 'precision': 0.4212554, 'recall': 0.30847093, 'specificity': 0.96943915, 'f1': 0.30531225, 'auroc': 0.9215986}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    83   0   0   13   120    27   0    239
1    0   4   0    44   0   0    1  1141     7   0    134
2    0   0   0    52   0   0   35    60    27   0    137
3    0   0   0  7874   0   0    0   332   177   0     55
4    0   0   0    39   0   0   14    18    35   0    433
5    0   0   0   392   0   0   32    22    55   0     20
6    0   0   0    66   0   0  488    93   230   0   1030
7    0   0   0  1357   0   0    0  5574    58   0    274
8    0   0   0   647   0   0    5   236  1485   0    923
9    0   0   0   199   0   0   68    66    78   0     82
10   0   0   0    50   0   0    6    78    82   0  12579
---- Validation: 
scalar performance:
{'acc': 0.7475993, 'precision': 0.41808823, 'recall': 0.30687082, 'specificity': 0.9692826, 'f1': 0.3029214, 'auroc': 0.92165756}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    78   0   0   18   122    23   0    242
1    0   3   0    42   0   0    1  1150     7   0    129
2    0   0   0    59   0   0   34    64    27   0    128
3    0   0   0  7878   0   0    1   322   177   0     62
4    0   0   0    46   0   0   18    18    36   0    421
5    0   0   0   394   0   0   29    17    60   0     21
6    0   0   0    45   0   0  458   104   262   0   1039
7    0   0   0  1354   0   0    1  5572    66   0    272
8    0   0   0   679   0   0    4   210  1491   0    912
9    0   0   0   217   0   0   71    66    66   0     73
10   0   0   0    64   0   0    8    96    81   0  12547
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22969286, 'precision': 0.1237444, 'recall': 0.2103154, 'specificity': 0.9222012, 'f1': 0.110090196, 'auroc': 0.7061984}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   24   0   0  70   787   27   0   262
1    0   0   0   57   0   0   3  1346    1   0    92
2    0   0   0   21   0   0  15   272   28   0   679
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0    12    1   0  1619
5    0   0   0  192   0   0  32   255   51   0    62
6    0   0   0    9   0   0  55   169   95   0  2739
7    0   0   0   55   0   0   0  1088    0   0    21
8    0   0   0   93   0   0  12   214  496   0   555
9    0   0   0  101   0   0  37   747   24   0   228
10   0   0   0    1   0   0   0     0    1   0  1644
early stop counter: 1
val acc:0.7475993037223816, best validation acc: 0.7512103915214539, corresponding to test acc:                         0.23808857798576355 / 0.23808857798576355
after epoch: 16,now: 2024-07-21 19:29:43.062459,epoch time: 0:24:37.853053,used: 6:36:40.003975,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.75240797, 'precision': 0.42375374, 'recall': 0.31186154, 'specificity': 0.96980464, 'f1': 0.30886215, 'auroc': 0.9230468}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    80   0   0   14   119    33   0    237
1    0   2   0    36   0   0    3  1144     7   0    139
2    0   0   0    52   0   0   30    62    34   0    134
3    0   0   0  7883   0   0    0   336   177   0     42
4    0   0   0    39   0   0   10    16    44   0    430
5    0   0   0   396   0   0   24    30    54   0     17
6    0   0   0    44   0   0  517    88   225   0   1033
7    0   0   0  1279   0   0    1  5600    76   0    307
8    0   0   0   594   0   0    5   214  1549   0    934
9    0   0   0   223   0   0   78    57    65   0     70
10   0   0   0    57   0   0   10    86    69   0  12571
---- Validation: 
scalar performance:
{'acc': 0.74888325, 'precision': 0.3300125, 'recall': 0.3086632, 'specificity': 0.9693701, 'f1': 0.30532062, 'auroc': 0.92245674}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    86   0   0   20   124    15   0    238
1    0   0   0    41   0   0    2  1144     6   0    139
2    0   0   0    54   0   0   30    66    26   0    136
3    0   0   0  7844   0   0    0   339   194   0     63
4    0   0   0    31   0   0   14    20    31   0    443
5    0   0   0   384   0   0   25    23    65   0     24
6    0   0   0    45   0   0  502   106   242   0   1013
7    0   0   0  1282   0   0    1  5594    75   0    313
8    0   0   0   617   0   0    8   223  1484   0    964
9    0   0   0   204   0   0   65    70    77   0     77
10   0   0   0    56   0   0   11    81    75   0  12573
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23123208, 'precision': 0.12180953, 'recall': 0.21193968, 'specificity': 0.9223078, 'f1': 0.11031836, 'auroc': 0.70948994}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   27   0   0  60   765   40   0   278
1    0   0   0   48   0   0   1  1351    4   0    95
2    0   0   0   16   0   0  19   259   29   0   692
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0    11    1   0  1620
5    0   0   0  180   0   0  28   255   65   0    64
6    0   0   0    9   0   0  55   153  101   0  2749
7    0   0   0   41   0   0   0  1102    0   0    21
8    0   0   0   83   0   0  17   206  504   0   560
9    0   0   0   95   0   0  37   725   28   0   252
10   0   0   0    1   0   0   0     0    1   0  1644
early stop counter: 2
val acc:0.7488832473754883, best validation acc: 0.7512103915214539, corresponding to test acc:                         0.23808857798576355 / 0.23808857798576355
after epoch: 17,now: 2024-07-21 19:54:22.778068,epoch time: 0:24:39.715609,used: 7:01:19.719584,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.75647473, 'precision': 0.3326619, 'recall': 0.31501216, 'specificity': 0.9705435, 'f1': 0.31124574, 'auroc': 0.92759544}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    68   0   0   13   163    22   0    217
1    0   0   0    33   0   0    2  1173     7   0    117
2    0   0   0    54   0   0   31    81    31   0    115
3    0   0   0  7799   0   0    0   430   162   0     47
4    0   0   0    36   0   0   22    27    35   0    419
5    0   0   0   380   0   0   32    38    52   0     19
6    0   0   0    44   0   0  549   127   254   0    931
7    0   0   0  1114   0   0    3  5871    53   0    223
8    0   0   0   638   0   0    6   294  1535   0    822
9    0   0   0   209   0   0   69    84    66   0     65
10   0   0   0    38   0   0   12   119   105   0  12520
---- Validation: 
scalar performance:
{'acc': 0.758807, 'precision': 0.33538464, 'recall': 0.31718355, 'specificity': 0.9708097, 'f1': 0.31387007, 'auroc': 0.92760754}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    62   0   0   16   155    28   0    222
1    0   0   0    37   0   0    0  1164     7   0    124
2    0   0   0    48   0   0   32    85    38   0    109
3    0   0   0  7812   0   0    1   416   158   0     53
4    0   0   0    38   0   0   18    29    41   0    413
5    0   0   0   379   0   0   26    34    64   0     18
6    0   0   0    43   0   0  581   125   256   0    903
7    0   0   0  1115   0   0    0  5873    55   0    222
8    0   0   0   638   0   0    5   284  1547   0    822
9    0   0   0   199   0   0   71    84    60   0     79
10   0   0   0    43   0   0   11   112    75   0  12555
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23633946, 'precision': 0.13176578, 'recall': 0.21613173, 'specificity': 0.92292565, 'f1': 0.113008074, 'auroc': 0.7109872}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   17   0   0  59   854   28   0   212
1    0   0   0   33   0   0   1  1392    3   0    70
2    0   0   0   17   0   0  16   342   25   0   615
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   1    18    2   0  1611
5    0   0   0  171   0   0  26   306   45   0    44
6    0   0   0    9   0   0  82   253  130   0  2593
7    0   0   0   22   0   0   0  1129    0   0    13
8    0   0   0   88   0   0  14   268  525   0   475
9    0   0   0   78   0   0  36   821   22   0   180
10   0   0   0    1   0   0   0     0    3   0  1642
better model found
persisted
after epoch: 18,now: 2024-07-21 20:18:55.362787,epoch time: 0:24:32.584719,used: 7:25:52.304303,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.7555383, 'precision': 0.33678597, 'recall': 0.31286344, 'specificity': 0.9701942, 'f1': 0.3102614, 'auroc': 0.9283458}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    77   0   0   11   133    17   0    245
1    0   0   0    35   0   0    1  1161     3   0    132
2    0   0   0    54   0   0   31    74    26   0    127
3    0   0   0  7887   0   0    0   368   133   0     50
4    0   0   0    37   0   0   16    27    25   0    434
5    0   0   0   395   0   0   23    42    32   0     29
6    0   0   0    41   0   0  540   126   224   0    977
7    0   0   0  1175   0   0    3  5771    63   0    249
8    0   0   0   647   0   0    3   264  1471   0    909
9    0   0   0   204   0   0   66    88    54   0     81
10   0   0   0    47   0   0   12    86    80   0  12570
---- Validation: 
scalar performance:
{'acc': 0.7551157, 'precision': 0.42653143, 'recall': 0.31196356, 'specificity': 0.9701296, 'f1': 0.3092122, 'auroc': 0.9287553}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    74   0   0   11   141    14   0    243
1    0   2   0    30   0   0    2  1168     4   0    126
2    0   0   0    41   0   0   32    81    24   0    134
3    0   0   0  7872   0   0    1   365   151   0     51
4    0   0   0    37   0   0   18    18    34   0    432
5    0   0   0   392   0   0   21    42    43   0     23
6    0   0   0    40   0   0  524   112   232   0   1000
7    0   0   0  1136   0   0    2  5809    62   0    256
8    0   0   0   643   0   0    1   265  1453   0    934
9    0   0   0   204   0   0   66    94    43   0     86
10   0   0   0    51   0   0   10    85    80   0  12570
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23074232, 'precision': 0.12982729, 'recall': 0.21142375, 'specificity': 0.9223496, 'f1': 0.110108614, 'auroc': 0.71423084}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   30   0   0  51   790   33   0   266
1    0   0   0   41   0   0   1  1366    4   0    87
2    0   0   0   21   0   0  13   284   25   0   672
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0    11    1   0  1620
5    0   0   0  198   0   0  24   260   45   0    65
6    0   0   0   10   0   0  58   179   94   0  2726
7    0   0   0   38   0   0   0  1107    0   0    19
8    0   0   0   99   0   0  14   229  489   0   539
9    0   0   0  100   0   0  26   749   20   0   242
10   0   0   0    1   0   0   0     0    1   0  1644
early stop counter: 1
val acc:0.7551156878471375, best validation acc: 0.7588070034980774, corresponding to test acc:                         0.23633946478366852 / 0.23808857798576355
after epoch: 19,now: 2024-07-21 20:43:36.608578,epoch time: 0:24:41.245791,used: 7:50:33.550094,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.7606218, 'precision': 0.42980987, 'recall': 0.31894672, 'specificity': 0.970942, 'f1': 0.3163906, 'auroc': 0.9314369}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    88   0   0   15   138    17   0    225
1    0   2   0    29   0   0    2  1167     8   0    124
2    0   0   0    50   0   0   28    80    24   0    130
3    0   0   0  7803   0   0    1   430   160   0     45
4    0   0   0    37   0   0   12    23    37   0    430
5    0   0   0   394   0   0   26    41    35   0     25
6    0   0   0    44   0   0  598   114   231   0    921
7    0   0   0  1027   0   0    1  5922    66   0    246
8    0   0   0   633   0   0    3   281  1557   0    821
9    0   0   0   193   0   0   70   105    48   0     77
10   0   0   0    52   0   0   10    84    99   0  12547
---- Validation: 
scalar performance:
{'acc': 0.7622041, 'precision': 0.3395589, 'recall': 0.3201177, 'specificity': 0.9711275, 'f1': 0.3174265, 'auroc': 0.9311607}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    64   0   0   18   143    31   0    227
1    0   0   0    34   0   0    1  1163     6   0    128
2    0   0   0    48   0   0   31    76    22   0    135
3    0   0   0  7813   0   0    0   429   157   0     41
4    0   0   0    31   0   0   20    24    35   0    429
5    0   0   0   396   0   0   25    36    40   0     24
6    0   0   0    48   0   0  602   103   237   0    918
7    0   0   0  1031   0   0    1  5924    70   0    239
8    0   0   0   605   0   0    6   273  1591   0    821
9    0   0   0   207   0   0   59   100    47   0     80
10   0   0   0    39   0   0   12   106    74   0  12565
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23759882, 'precision': 0.12499088, 'recall': 0.21756414, 'specificity': 0.9229736, 'f1': 0.11437833, 'auroc': 0.7170732}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   24   0   0  65   786   50   0   245
1    0   0   0   35   0   0   1  1374    4   0    85
2    0   0   0   17   0   0  19   284   34   0   661
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   1    12    2   0  1617
5    0   0   0  182   0   0  23   268   60   0    59
6    0   0   0    8   0   0  72   175  140   0  2672
7    0   0   0   28   0   0   0  1118    0   0    18
8    0   0   0   85   0   0  16   213  564   0   492
9    0   0   0   84   0   0  43   761   27   0   222
10   0   0   0    1   0   0   0     0    3   0  1642
better model found
persisted
after epoch: 20,now: 2024-07-21 21:08:29.068701,epoch time: 0:24:52.460123,used: 8:15:26.010217,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.75593966, 'precision': 0.43266898, 'recall': 0.31389576, 'specificity': 0.97022283, 'f1': 0.31246328, 'auroc': 0.93180084}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    82   0   0   19   130    16   0    236
1    0   1   0    35   0   0    1  1180     6   0    109
2    0   0   0    52   0   0   24    76    20   0    140
3    0   0   0  7935   0   0    1   335   116   0     52
4    0   0   0    47   0   0   17    24    32   0    418
5    0   0   0   402   0   0   21    38    31   0     29
6    0   0   0    41   0   0  597   120   184   0    965
7    0   0   0  1202   0   0    1  5776    61   0    225
8    0   0   0   709   0   0    3   289  1392   0    903
9    0   0   0   238   0   0   50    83    31   0     90
10   0   0   0    53   0   0    7   114    64   0  12553
---- Validation: 
scalar performance:
{'acc': 0.7565066, 'precision': 0.43297487, 'recall': 0.3153869, 'specificity': 0.97028327, 'f1': 0.3143204, 'auroc': 0.93062705}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    77   0   0   16   135    15   0    240
1    0   2   0    35   0   0    1  1156     4   0    134
2    0   0   0    59   0   0   31    78    10   0    134
3    0   0   0  7950   0   0    1   339   103   0     47
4    0   0   0    40   0   0   18    27    28   0    426
5    0   0   0   399   0   0   21    33    27   0     41
6    0   0   0    40   0   0  627   140   180   0    921
7    0   0   0  1243   0   0    1  5738    50   0    233
8    0   0   0   682   0   0    5   305  1403   0    901
9    0   0   0   224   0   0   52    98    30   0     89
10   0   0   0    48   0   0   18    98    70   0  12562
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23263136, 'precision': 0.13597836, 'recall': 0.21224396, 'specificity': 0.9225057, 'f1': 0.11223149, 'auroc': 0.7159779}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   34   0   0  70   791   24   0   251
1    0   0   0   46   0   0   1  1368    3   0    81
2    0   0   0   21   0   0  18   287   18   0   671
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    1   0   0   0    14    2   0  1616
5    0   0   0  193   0   0  28   272   29   0    70
6    0   0   0   10   0   0  87   193   84   0  2693
7    0   0   0   33   0   0   0  1114    0   0    17
8    0   0   0  102   0   0  24   241  481   0   522
9    0   0   0   97   0   0  34   755   14   0   237
10   0   0   0    1   0   0   2     0    0   0  1643
early stop counter: 1
val acc:0.756506621837616, best validation acc: 0.762204110622406, corresponding to test acc:                         0.23759882152080536 / 0.23808857798576355
after epoch: 21,now: 2024-07-21 21:33:07.932368,epoch time: 0:24:38.863667,used: 8:40:04.873884,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.7619328, 'precision': 0.34564, 'recall': 0.31933364, 'specificity': 0.9710853, 'f1': 0.31792176, 'auroc': 0.9348688}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    79   0   0    8   145    18   0    233
1    0   0   0    28   0   0    0  1193     5   0    106
2    0   0   0    46   0   0   22    94    21   0    129
3    0   0   0  7942   0   0    1   347   108   0     39
4    0   0   0    35   0   0   17    32    29   0    426
5    0   0   0   403   0   0   16    57    26   0     19
6    0   0   0    46   0   0  639   137   201   0    885
7    0   0   0  1143   0   0    3  5872    45   0    199
8    0   0   0   725   0   0    7   306  1472   0    786
9    0   0   0   221   0   0   52   115    29   0     76
10   0   0   0    58   0   0   12   101    69   0  12553
---- Validation: 
scalar performance:
{'acc': 0.76150864, 'precision': 0.43455416, 'recall': 0.31929147, 'specificity': 0.9710841, 'f1': 0.31763738, 'auroc': 0.93348426}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    77   0   0   13   160    16   0    217
1    0   2   0    27   0   0    2  1190     3   0    108
2    0   0   0    47   0   0   32    96    16   0    121
3    0   0   0  7925   0   0    0   371    95   0     49
4    0   0   0    37   0   0   19    28    35   0    420
5    0   0   0   402   0   0   21    45    33   0     20
6    0   0   0    48   0   0  631   140   207   0    882
7    0   0   0  1123   0   0    0  5887    54   0    201
8    0   0   0   747   0   0    6   309  1486   0    748
9    0   0   0   226   0   0   48   109    27   0     83
10   0   0   0    50   0   0   11   112    85   0  12538
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23969775, 'precision': 0.13896249, 'recall': 0.21812874, 'specificity': 0.92332315, 'f1': 0.11620236, 'auroc': 0.71946526}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   34   0   0   58   840   32   0   206
1    0   0   0   40   0   0    1  1386    4   0    68
2    0   0   0   25   0   0   20   336   25   0   609
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    1   0   0    1    19    3   0  1609
5    0   0   0  200   0   0   23   285   35   0    49
6    0   0   0   10   0   0  115   246  142   0  2554
7    0   0   0   20   0   0    0  1131    0   0    13
8    0   0   0  115   0   0   18   253  538   0   446
9    0   0   0   85   0   0   38   812   17   0   185
10   0   0   0    1   0   0    0     0    3   0  1642
new oracle model saved
early stop counter: 2
val acc:0.7615086436271667, best validation acc: 0.762204110622406, corresponding to test acc:                         0.23759882152080536 / 0.23969775438308716
after epoch: 22,now: 2024-07-21 21:58:04.081179,epoch time: 0:24:56.148811,used: 9:05:01.022695,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.7672838, 'precision': 0.43875417, 'recall': 0.3224942, 'specificity': 0.9716108, 'f1': 0.32140177, 'auroc': 0.9358589}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    58   0   0   10   159    14   0    241
1    0   3   0    18   0   0    2  1166     3   0    140
2    0   0   0    47   0   0   20    95    17   0    133
3    0   0   0  7804   0   0    0   476   118   0     42
4    0   0   0    29   0   0   22    27    36   0    425
5    0   0   0   390   0   0   26    54    20   0     31
6    0   0   0    43   0   0  640   118   175   0    932
7    0   0   0   863   0   0    1  6126    57   0    216
8    0   0   0   604   0   0    4   332  1504   0    850
9    0   0   0   206   0   0   62   123    21   0     81
10   0   0   0    44   0   0    6    87    54   0  12601
---- Validation: 
scalar performance:
{'acc': 0.7648522, 'precision': 0.43547407, 'recall': 0.32058594, 'specificity': 0.97135293, 'f1': 0.31894076, 'auroc': 0.9360038}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    79   0   0   10   150    16   0    228
1    0   1   0    21   0   0    0  1182     4   0    124
2    0   0   0    37   0   0   21    99    15   0    140
3    0   0   0  7812   0   0    1   459   125   0     43
4    0   0   0    36   0   0   16    28    25   0    434
5    0   0   0   388   0   0   30    44    30   0     29
6    0   0   0    43   0   0  635   122   194   0    914
7    0   0   0   879   0   0    2  6092    56   0    236
8    0   0   0   647   0   0    9   326  1467   0    847
9    0   0   0   192   0   0   65   118    28   0     90
10   0   0   0    43   0   0    9    92    65   0  12587
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23654936, 'precision': 0.13285992, 'recall': 0.21626675, 'specificity': 0.9228496, 'f1': 0.11326982, 'auroc': 0.72088194}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   0   0   17   0   0  61   814   32   0   246
1    0   0   0   25   0   0   1  1392    4   0    77
2    0   0   0   13   0   0  17   305   25   0   655
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    0   0   0   1    14    2   0  1616
5    0   0   0  171   0   0  27   292   38   0    64
6    0   0   0    9   0   0  86   210  119   0  2643
7    0   0   0   13   0   0   0  1137    0   0    14
8    0   0   0   80   0   0  21   258  515   0   496
9    0   0   0   61   0   0  35   797   15   0   229
10   0   0   0    1   0   0   1     0    1   0  1643
better model found
persisted
after epoch: 23,now: 2024-07-21 22:22:56.620371,epoch time: 0:24:52.539192,used: 9:29:53.561887,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.76822025, 'precision': 0.43560338, 'recall': 0.32690722, 'specificity': 0.9719415, 'f1': 0.32506835, 'auroc': 0.9381236}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    86   0   0   23   136    20   0    218
1    0   2   0    26   0   0    1  1176     4   0    123
2    0   0   0    46   0   0   28    94    22   0    122
3    0   0   0  7936   0   0    0   338   117   0     46
4    0   0   0    40   0   0   16    21    36   0    426
5    0   0   0   391   0   0   39    53    21   0     17
6    0   0   0    47   0   0  735   116   199   0    811
7    0   0   0  1028   0   0    2  5987    59   0    188
8    0   0   0   708   0   0    7   298  1535   0    747
9    0   0   0   206   0   0   71   126    23   0     67
10   0   0   0    64   0   0    5   114    91   0  12518
---- Validation: 
scalar performance:
{'acc': 0.7700147, 'precision': 0.43759823, 'recall': 0.3288237, 'specificity': 0.9721954, 'f1': 0.32710806, 'auroc': 0.937877}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    81   0   0   15   145    12   0    230
1    0   3   0    25   0   0    1  1186     4   0    113
2    0   0   0    40   0   0   26   103    18   0    125
3    0   0   0  7936   0   0    0   349   116   0     39
4    0   0   0    35   0   0   22    32    33   0    417
5    0   0   0   403   0   0   26    46    28   0     18
6    0   0   0    53   0   0  723   129   205   0    798
7    0   0   0  1060   0   0    3  5963    56   0    183
8    0   0   0   684   0   0    4   291  1634   0    683
9    0   0   0   212   0   0   71   119    16   0     75
10   0   0   0    49   0   0   11   103   105   0  12528
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24298608, 'precision': 0.13467366, 'recall': 0.221271, 'specificity': 0.9236319, 'f1': 0.11875619, 'auroc': 0.7249853}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   36   0   0   72   826   30   0   206
1    0   0   0   39   0   0    1  1388    4   0    67
2    0   0   0   26   0   0   22   320   30   0   617
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    1   0   0    1    17    4   0  1610
5    0   0   0  213   0   0   27   265   39   0    48
6    0   0   0   11   0   0  115   236  178   0  2527
7    0   0   0   18   0   0    0  1133    0   0    13
8    0   0   0  111   0   0   17   227  583   0   432
9    0   0   0   99   0   0   46   781   15   0   196
10   0   0   0    1   0   0    0     0    3   0  1642
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-21 22:47:43.937653,epoch time: 0:24:47.317282,used: 9:54:40.879169,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.76870185, 'precision': 0.43860716, 'recall': 0.32664725, 'specificity': 0.97193587, 'f1': 0.32557356, 'auroc': 0.9391477}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    79   0   0   17   156    13   0    218
1    0   5   0    22   0   0    0  1191     4   0    110
2    0   0   0    39   0   0   21    99    16   0    137
3    0   0   0  7828   0   0    1   444   131   0     34
4    0   0   0    32   0   0   22    28    38   0    419
5    0   0   0   409   0   0   24    49    18   0     20
6    0   0   0    57   0   0  729   124   162   0    835
7    0   0   0   886   0   0    2  6125    54   0    198
8    0   0   0   658   0   0    8   340  1502   0    787
9    0   0   0   217   0   0   61   112    19   0     84
10   0   0   0    41   0   0   14   120    75   0  12542
---- Validation: 
scalar performance:
{'acc': 0.770309, 'precision': 0.43888938, 'recall': 0.3261264, 'specificity': 0.9721056, 'f1': 0.32465112, 'auroc': 0.93892497}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    82   0   0   15   153    17   0    216
1    0   1   0    26   0   0    0  1188     2   0    115
2    0   0   0    40   0   0   31   100    21   0    120
3    0   0   0  7855   0   0    0   434   112   0     39
4    0   0   0    34   0   0   22    26    28   0    429
5    0   0   0   405   0   0   29    42    20   0     25
6    0   0   0    39   0   0  710   124   162   0    873
7    0   0   0   865   0   0    0  6170    53   0    177
8    0   0   0   672   0   0    8   344  1490   0    782
9    0   0   0   209   0   0   67   111    23   0     83
10   0   0   0    42   0   0    2   104    76   0  12572
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24116701, 'precision': 0.1386777, 'recall': 0.2197152, 'specificity': 0.9234561, 'f1': 0.116931565, 'auroc': 0.72436786}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   33   0   0   56   843   34   0   204
1    0   0   0   34   0   0    1  1394    4   0    66
2    0   0   0   18   0   0   19   340   28   0   610
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    1   0   0    1    20    3   0  1608
5    0   0   0  210   0   0   25   269   36   0    52
6    0   0   0    9   0   0  112   263  146   0  2537
7    0   0   0   13   0   0    0  1139    0   0    12
8    0   0   0   95   0   0   17   268  553   0   437
9    0   0   0   83   0   0   37   802   18   0   197
10   0   0   0    1   0   0    0     0    2   0  1643
better model found
persisted
after epoch: 25,now: 2024-07-21 23:12:38.872303,epoch time: 0:24:54.934650,used: 10:19:35.813819,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.77429366, 'precision': 0.43978652, 'recall': 0.33477482, 'specificity': 0.97280145, 'f1': 0.3328069, 'auroc': 0.9405882}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    80   0   0   19   163    14   0    207
1    0   2   0    19   0   0    1  1196     5   0    108
2    0   0   0    37   0   0   29   110    16   0    120
3    0   0   0  7863   0   0    0   428   112   0     34
4    0   0   0    35   0   0   36    34    33   0    401
5    0   0   0   379   0   0   26    68    26   0     22
6    0   0   0    38   0   0  847   134   175   0    713
7    0   0   0   912   0   0    3  6126    50   0    173
8    0   0   0   692   0   0    9   325  1595   0    675
9    0   0   0   198   0   0   65   136    18   0     76
10   0   0   0    50   0   0   17   121    98   0  12507
---- Validation: 
scalar performance:
{'acc': 0.7738398, 'precision': 0.4399436, 'recall': 0.33348036, 'specificity': 0.9727192, 'f1': 0.33173186, 'auroc': 0.9401124}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    73   0   0   21   160    17   0    212
1    0   3   0    24   0   0    1  1183     6   0    115
2    0   0   0    42   0   0   27   102    16   0    125
3    0   0   0  7867   0   0    0   427   114   0     32
4    0   0   0    34   0   0   34    39    29   0    403
5    0   0   0   408   0   0   23    54    13   0     23
6    0   0   0    41   0   0  810   144   177   0    736
7    0   0   0   902   0   0    2  6133    62   0    166
8    0   0   0   675   0   0   13   323  1607   0    678
9    0   0   0   189   0   0   60   145    20   0     79
10   0   0   0    49   0   0   13   130    94   0  12510
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2517316, 'precision': 0.14209259, 'recall': 0.22613275, 'specificity': 0.9244481, 'f1': 0.12474532, 'auroc': 0.7268154}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   24   0   0   93   862   25   0   166
1    0   0   0   28   0   0    1  1406    4   0    60
2    0   0   0   18   0   0   40   361   32   0   564
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    1   0   0    2    25    5   0  1600
5    0   0   0  181   0   0   31   303   39   0    38
6    0   0   0   10   0   0  212   301  181   0  2363
7    0   0   0   10   0   0    0  1143    0   0    11
8    0   0   0   92   0   0   33   267  602   0   376
9    0   0   0   69   0   0   52   832   16   0   168
10   0   0   0    1   0   0    1     1    2   0  1641
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-21 23:37:18.365997,epoch time: 0:24:39.493694,used: 10:44:15.307513,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.76961154, 'precision': 0.44588596, 'recall': 0.32519257, 'specificity': 0.9717724, 'f1': 0.3253615, 'auroc': 0.94045}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    65   0   0    7   146    15   0    249
1    0   2   0    25   0   0    1  1170     2   0    132
2    0   0   0    38   0   0   16    89    14   0    155
3    0   0   0  7838   0   0    0   451    97   0     53
4    0   0   0    35   0   0    6    33    24   0    441
5    0   0   0   386   0   0   20    55    18   0     42
6    0   0   0    40   0   0  710   126   125   0    907
7    0   0   0   818   0   0    1  6164    59   0    221
8    0   0   0   628   0   0   10   316  1454   0    887
9    0   0   0   195   0   0   47   143    13   0     95
10   0   0   0    36   0   0    8    80    71   0  12597
---- Validation: 
scalar performance:
{'acc': 0.7715394, 'precision': 0.44460207, 'recall': 0.32752603, 'specificity': 0.9720793, 'f1': 0.3273755, 'auroc': 0.9401897}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    63   0   0   10   148     9   0    253
1    0   3   0    23   0   0    0  1154     5   0    147
2    0   0   0    37   0   0   12   101    11   0    151
3    0   0   0  7830   0   0    0   462   108   0     40
4    0   0   0    34   0   0   14    27    27   0    437
5    0   0   0   386   0   0   25    61    21   0     28
6    0   0   0    33   0   0  732   119   149   0    875
7    0   0   0   793   0   0    2  6194    55   0    221
8    0   0   0   663   0   0   12   306  1491   0    824
9    0   0   0   198   0   0   50   131    17   0     97
10   0   0   0    43   0   0   13    93    53   0  12594
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24151683, 'precision': 0.13527538, 'recall': 0.22020559, 'specificity': 0.9233214, 'f1': 0.11773703, 'auroc': 0.7286261}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   25   0   0   73   790   35   0   247
1    0   0   0   24   0   0    2  1387    4   0    82
2    0   0   0   14   0   0   19   271   28   0   683
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    0   0   0    1    13    3   0  1616
5    0   0   0  191   0   0   27   274   34   0    66
6    0   0   0    9   0   0  108   177  139   0  2634
7    0   0   0   10   0   0    0  1140    0   0    14
8    0   0   0   81   0   0   21   224  561   0   483
9    0   0   0   74   0   0   43   738   18   0   264
10   0   0   0    1   0   0    0     0    2   0  1643
early stop counter: 1
val acc:0.7715393900871277, best validation acc: 0.7738397717475891, corresponding to test acc:                         0.25173160433769226 / 0.25173160433769226
after epoch: 27,now: 2024-07-22 00:01:58.154062,epoch time: 0:24:39.788065,used: 11:08:55.095578,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.7706282, 'precision': 0.4476206, 'recall': 0.32762906, 'specificity': 0.9719516, 'f1': 0.328618, 'auroc': 0.9411315}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    71   0   0   12   149     7   0    244
1    0  10   0    26   0   0    0  1171     5   0    120
2    0   0   0    37   0   0   14    95    10   0    156
3    0   0   0  7866   0   0    1   436    96   0     39
4    0   0   0    37   0   0   15    30    23   0    434
5    0   0   0   411   0   0   18    54     8   0     30
6    0   0   0    34   0   0  767   130   117   0    860
7    0   0   0   875   0   0    2  6147    32   0    208
8    0   0   0   671   0   0    8   356  1422   0    837
9    0   0   0   212   0   0   46   119    14   0    102
10   0   0   0    43   0   0   12    93    53   0  12591
---- Validation: 
scalar performance:
{'acc': 0.7717266, 'precision': 0.4479705, 'recall': 0.32792446, 'specificity': 0.97208655, 'f1': 0.32868835, 'auroc': 0.94152594}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    69   0   0   11   145    11   0    247
1    0   8   0    19   0   0    1  1168     4   0    132
2    0   0   0    42   0   0   17    94     5   0    154
3    0   0   0  7870   0   0    0   431   100   0     39
4    0   0   0    36   0   0   15    30    19   0    439
5    0   0   0   393   0   0   19    62    11   0     36
6    0   0   0    40   0   0  753   142   127   0    846
7    0   0   0   825   0   0    1  6184    49   0    206
8    0   0   0   688   0   0    5   334  1447   0    822
9    0   0   0   219   0   0   36   118    12   0    108
10   0   0   0    47   0   0   13    92    55   0  12589
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2423564, 'precision': 0.14284721, 'recall': 0.2197403, 'specificity': 0.92346025, 'f1': 0.11876994, 'auroc': 0.7281842}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   27   0   0   76   823   23   0   221
1    0   0   0   25   0   0    3  1393    2   0    76
2    0   0   0   18   0   0   21   307   23   0   646
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    0   0   0    1    14    3   0  1615
5    0   0   0  200   0   0   29   270   31   0    62
6    0   0   0   10   0   0  143   226  119   0  2569
7    0   0   0   10   0   0    0  1142    0   0    12
8    0   0   0   89   0   0   26   250  536   0   469
9    0   0   0   80   0   0   41   767   12   0   237
10   0   0   0    1   0   0    2     0    0   0  1643
early stop counter: 2
val acc:0.7717266082763672, best validation acc: 0.7738397717475891, corresponding to test acc:                         0.25173160433769226 / 0.25173160433769226
after epoch: 28,now: 2024-07-22 00:26:39.624934,epoch time: 0:24:41.470872,used: 11:33:36.566450,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.777317, 'precision': 0.4453622, 'recall': 0.3356006, 'specificity': 0.97301173, 'f1': 0.33491966, 'auroc': 0.9431028}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    75   0   0   21   167    12   0    208
1    0   5   0    21   0   0    1  1191     6   0    108
2    0   0   0    33   0   0   19   105    12   0    142
3    0   0   0  7869   0   0    2   416   106   0     44
4    0   0   0    28   0   0   21    38    26   0    426
5    0   0   0   404   0   0   23    59     9   0     26
6    0   0   0    35   0   0  841   132   136   0    764
7    0   0   0   841   0   0    0  6191    62   0    169
8    0   0   0   662   0   0   10   335  1581   0    707
9    0   0   0   205   0   0   63   137    10   0     78
10   0   0   0    41   0   0    9    92    86   0  12566
---- Validation: 
scalar performance:
{'acc': 0.7760064, 'precision': 0.44415107, 'recall': 0.33446658, 'specificity': 0.9728168, 'f1': 0.33409974, 'auroc': 0.941605}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    73   0   0   17   146    16   0    231
1    0  10   0    26   0   0    0  1173     5   0    118
2    0   0   0    38   0   0   22    97    13   0    142
3    0   0   0  7873   0   0    0   421   104   0     42
4    0   0   0    29   0   0   26    28    29   0    427
5    0   0   0   393   0   0   22    63    13   0     30
6    0   0   0    36   0   0  835   141   144   0    752
7    0   0   0   828   0   0    3  6192    63   0    179
8    0   0   0   664   0   0   10   338  1540   0    744
9    0   0   0   200   0   0   59   132    13   0     89
10   0   0   0    40   0   0   12   104    79   0  12561
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25117192, 'precision': 0.14301628, 'recall': 0.22608191, 'specificity': 0.924359, 'f1': 0.12484825, 'auroc': 0.7297203}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   27   0   0   88   839   28   0   188
1    0   0   0   25   0   0    3  1405    2   0    64
2    0   0   0   17   0   0   35   330   30   0   603
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    0   0   0    1    19    5   0  1608
5    0   0   0  195   0   0   33   279   33   0    52
6    0   0   0   10   0   0  198   257  171   0  2431
7    0   0   0   10   0   0    0  1142    0   0    12
8    0   0   0   90   0   0   35   238  607   0   400
9    0   0   0   72   0   0   45   799   17   0   204
10   0   0   0    1   0   0    1     0    1   0  1643
better model found
persisted
after epoch: 29,now: 2024-07-22 00:51:26.450456,epoch time: 0:24:46.825522,used: 11:58:23.391972,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.77967143, 'precision': 0.4396, 'recall': 0.3399804, 'specificity': 0.9733231, 'f1': 0.3395003, 'auroc': 0.94400764}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    84   0   0   19   148    12   0    220
1    0  15   0    22   0   0    1  1169     5   0    119
2    0   0   0    39   0   0   36   102    13   0    122
3    0   0   0  7909   0   0    2   400    98   0     31
4    0   0   0    38   0   0   30    27    27   0    417
5    0   0   0   403   0   0   23    58    12   0     25
6    0   0   0    48   0   0  919   110   128   0    703
7    0   1   0   833   0   0    2  6181    67   0    179
8    0   0   0   664   0   0    8   337  1576   0    709
9    0   0   0   204   0   0   62   127    10   0     89
10   0   0   0    43   0   0   20   111    78   0  12541
---- Validation: 
scalar performance:
{'acc': 0.7807409, 'precision': 0.44560674, 'recall': 0.34124342, 'specificity': 0.97344285, 'f1': 0.34079117, 'auroc': 0.94298947}
confusion matrix:
    0   1   2     3   4   5    6     7     8   9      10
0    0   0   0    81   0   0   22   130    16   0    234
1    0  17   0    18   0   0    1  1174     5   0    117
2    0   0   0    34   0   0   29    96    11   0    142
3    0   0   0  7900   0   0    2   402    93   0     43
4    0   0   0    35   0   0   33    27    32   0    412
5    0   0   0   418   0   0   19    42    14   0     28
6    0   0   0    34   0   0  932   116   133   0    693
7    0   0   0   817   0   0    0  6210    59   0    179
8    0   0   0   663   0   0   12   334  1587   0    700
9    0   0   0   206   0   0   66   132    11   0     78
10   0   0   0    49   0   0   20    99    86   0  12542
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25690898, 'precision': 0.14271542, 'recall': 0.22951555, 'specificity': 0.9248853, 'f1': 0.12897149, 'auroc': 0.7320156}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   29   0   0  109   813   34   0   185
1    0   0   0   25   0   0    4  1401    3   0    66
2    0   0   0   22   0   0   44   305   36   0   608
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    0   0   0    1    17    7   0  1608
5    0   0   0  206   0   0   35   269   34   0    48
6    0   0   0   10   0   0  253   227  189   0  2388
7    0   0   0    9   0   0    0  1143    0   0    12
8    0   0   0   92   0   0   43   217  633   0   385
9    0   0   0   82   0   0   62   764   22   0   207
10   0   0   0    1   0   0    1     0    1   0  1643
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-22 01:16:04.563306,epoch time: 0:24:38.112850,used: 12:23:01.504822,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:23:01.504822 at 2024-07-22 01:16:04.563306
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25690898, 'precision': 0.14271542, 'recall': 0.22951555, 'specificity': 0.9248853, 'f1': 0.12897149, 'auroc': 0.7320156}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   29   0   0  109   813   34   0   185
1    0   0   0   25   0   0    4  1401    3   0    66
2    0   0   0   22   0   0   44   305   36   0   608
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    0   0   0    1    17    7   0  1608
5    0   0   0  206   0   0   35   269   34   0    48
6    0   0   0   10   0   0  253   227  189   0  2388
7    0   0   0    9   0   0    0  1143    0   0    12
8    0   0   0   92   0   0   43   217  633   0   385
9    0   0   0   82   0   0   62   764   22   0   207
10   0   0   0    1   0   0    1     0    1   0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25690898, 'precision': 0.14271542, 'recall': 0.22951555, 'specificity': 0.9248853, 'f1': 0.12897149, 'auroc': 0.7320156}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0   29   0   0  109   813   34   0   185
1    0   0   0   25   0   0    4  1401    3   0    66
2    0   0   0   22   0   0   44   305   36   0   608
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0    0   0   0    1    17    7   0  1608
5    0   0   0  206   0   0   35   269   34   0    48
6    0   0   0   10   0   0  253   227  189   0  2388
7    0   0   0    9   0   0    0  1143    0   0    12
8    0   0   0   92   0   0   43   217  633   0   385
9    0   0   0   82   0   0   62   764   22   0   207
10   0   0   0    1   0   0    1     0    1   0  1643
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_12_53_02_seed_1_22562327_instance_wise_predictions.txt
accuracy from prediction file 0.25690897642202476
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 192545 KiB | 464403 KiB |   1494 TiB |   1494 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1463 TiB |   1463 TiB |
|       from small pool |  19051 KiB |  39766 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 192545 KiB | 464403 KiB |   1494 TiB |   1494 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1463 TiB |   1463 TiB |
|       from small pool |  19051 KiB |  39766 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 190586 KiB | 459653 KiB |   1494 TiB |   1494 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1463 TiB |   1463 TiB |
|       from small pool |  17772 KiB |  37837 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 528384 KiB | 528384 KiB |    784 MiB | 274432 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  40960 KiB |  40960 KiB |     46 MiB |   6144 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38878 KiB |  88829 KiB |    889 TiB |    889 TiB |
|       from large pool |  31306 KiB |  79555 KiB |    858 TiB |    858 TiB |
|       from small pool |   7572 KiB |  28668 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4054    |    7872    |  285466 K  |  285462 K  |
|       from large pool |      76    |     158    |  147683 K  |  147683 K  |
|       from small pool |    3978    |    7754    |  137783 K  |  137779 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4054    |    7872    |  285466 K  |  285462 K  |
|       from large pool |      76    |     158    |  147683 K  |  147683 K  |
|       from small pool |    3978    |    7754    |  137783 K  |  137779 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      56    |      14    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      20    |      20    |      23    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |    2324    |  151686 K  |  151686 K  |
|       from large pool |      10    |      22    |   97177 K  |   97177 K  |
|       from small pool |      18    |    2315    |   54508 K  |   54508 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464403 KiB |   1494 TiB |   1494 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1463 TiB |   1463 TiB |
|       from small pool |      0 KiB |  39766 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464403 KiB |   1494 TiB |   1494 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1463 TiB |   1463 TiB |
|       from small pool |      0 KiB |  39766 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459653 KiB |   1494 TiB |   1494 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1463 TiB |   1463 TiB |
|       from small pool |      0 KiB |  37837 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 528384 KiB |    784 MiB | 571392 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  40960 KiB |     46 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  88829 KiB |    889 TiB |    889 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |  28668 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7872    |  285466 K  |  285466 K  |
|       from large pool |       2    |     158    |  147683 K  |  147683 K  |
|       from small pool |       0    |    7754    |  137783 K  |  137783 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7872    |  285466 K  |  285466 K  |
|       from large pool |       2    |     158    |  147683 K  |  147683 K  |
|       from small pool |       0    |    7754    |  137783 K  |  137783 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      56    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      20    |      23    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2324    |  151687 K  |  151687 K  |
|       from large pool |       3    |      22    |   97177 K  |   97177 K  |
|       from small pool |       0    |    2315    |   54510 K  |   54510 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464403 KiB |   1494 TiB |   1494 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1463 TiB |   1463 TiB |
|       from small pool |      0 KiB |  39766 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464403 KiB |   1494 TiB |   1494 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1463 TiB |   1463 TiB |
|       from small pool |      0 KiB |  39766 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459653 KiB |   1494 TiB |   1494 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1463 TiB |   1463 TiB |
|       from small pool |      0 KiB |  37837 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 528384 KiB |    784 MiB | 571392 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  40960 KiB |     46 MiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  88829 KiB |    889 TiB |    889 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |  28668 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7872    |  285466 K  |  285466 K  |
|       from large pool |       2    |     158    |  147683 K  |  147683 K  |
|       from small pool |       0    |    7754    |  137783 K  |  137783 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7872    |  285466 K  |  285466 K  |
|       from large pool |       2    |     158    |  147683 K  |  147683 K  |
|       from small pool |       0    |    7754    |  137783 K  |  137783 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      56    |      33    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      20    |      23    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2324    |  151687 K  |  151687 K  |
|       from large pool |       3    |      22    |   97177 K  |   97177 K  |
|       from small pool |       0    |    2315    |   54510 K  |   54510 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327

 Experiment start at: 2024-07-22 01:44:40.301042
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.3791203, 'precision': 0.26468438, 'recall': 0.10618614, 'specificity': 0.914845, 'f1': 0.07268836, 'auroc': 0.6170859}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    17   0   0   0   0   0   0    466
1    0   0   2   227   0   0   0   1   0   0   1102
2    0   0   0     4   0   0   0   1   0   0    307
3    0   0   2  1398   0   1   0   0   0   0   7038
4    0   0   0     6   0   0   0   0   0   0    532
5    0   0   0    47   0   1   0   1   0   0    472
6    0   0   0    52   0   0   0   0   0   0   1855
7    0   0   0   611   0   0   0   4   0   0   6647
8    0   0   0   143   0   0   0   1   0   0   3152
9    0   0   1    36   0   0   0   0   0   1    455
10   0   0   1    26   0   0   0   0   0   0  12766
---- Validation: 
scalar performance:
{'acc': 0.37678212, 'precision': 0.099439055, 'recall': 0.1048972, 'specificity': 0.914539, 'f1': 0.07060987, 'auroc': 0.6166175}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    21   0   0   0   0   0   0    462
1    0   0   1   211   0   0   0   2   0   0   1118
2    0   0   0     6   0   0   0   0   0   0    306
3    0   0   6  1311   1   1   0   7   0   0   7114
4    0   0   0     2   0   0   0   0   0   0    537
5    0   0   0    53   0   0   0   1   0   0    467
6    0   0   0    53   0   0   0   0   0   0   1855
7    0   0   2   628   0   1   0   3   0   0   6631
8    0   0   2   145   0   0   0   0   0   0   3149
9    0   0   0    32   0   0   0   1   0   0    460
10   0   0   0    23   0   0   0   1   0   0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.010560828, 'recall': 0.09090909, 'specificity': 0.9091936, 'f1': 0.018923346, 'auroc': 0.52718955}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0  11   0   0   0   0   0   0  1159
1    0   0   0  46   0   0   0   0   0   0  1453
2    0   0   0   2   0   0   0   0   0   0  1013
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0  18   0   0   0   0   0   0   574
6    0   0   0   3   0   0   0   0   0   0  3064
7    0   0   0  24   0   0   0   0   0   0  1140
8    0   0   0  15   0   0   0   0   0   0  1355
9    0   0   0   5   0   0   0   0   0   0  1132
10   0   0   0   0   0   0   0   0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 02:09:11.388516,epoch time: 0:24:31.087474,used: 0:24:31.087474,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.3850332, 'precision': 0.10164661, 'recall': 0.10822309, 'specificity': 0.91593295, 'f1': 0.074733414, 'auroc': 0.675207}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    23   0   0   0   0   0   0    460
1    0   0   0   377   0   0   0   6   0   0    949
2    0   0   0     6   0   0   0   0   0   0    306
3    0   0   0  1617   0   0   0   2   0   0   6816
4    0   0   0     5   0   0   0   0   0   0    534
5    0   0   0    47   0   0   0   2   0   0    472
6    0   0   0    86   0   0   0   0   0   0   1822
7    0   0   0   934   0   0   0   4   0   0   6327
8    0   0   0   125   0   0   0   1   0   0   3169
9    0   0   0    34   0   0   0   1   0   0    458
10   0   0   0    23   0   0   0   0   0   0  12770
---- Validation: 
scalar performance:
{'acc': 0.3840578, 'precision': 0.077941045, 'recall': 0.10783274, 'specificity': 0.9158221, 'f1': 0.07415186, 'auroc': 0.67405295}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    28   0   0   0   0   0   0    455
1    0   0   0   381   0   0   0   8   0   0    943
2    0   0   0     6   0   0   0   0   0   0    306
3    0   1   0  1589   0   0   0   1   0   0   6849
4    0   0   0     5   0   0   0   0   0   0    534
5    0   0   0    63   0   0   0   1   0   0    457
6    0   0   0    83   0   0   0   0   0   0   1825
7    0   0   0   909   0   0   0   0   0   0   6356
8    0   0   0   154   0   0   0   0   0   0   3142
9    0   0   0    47   0   0   0   1   0   0    445
10   0   0   0    27   0   0   0   0   0   0  12769
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.010747422, 'recall': 0.09090909, 'specificity': 0.90939724, 'f1': 0.019222349, 'auroc': 0.54584426}
confusion matrix:
    0   1   2    3   4   5   6   7   8   9     10
0    0   0   0   33   0   0   0   0   0   0  1137
1    0   0   0  144   0   0   0   0   0   0  1355
2    0   0   0    0   0   0   0   0   0   0  1015
3    0   0   0    0   0   0   0   0   0   0     0
4    0   0   0    0   0   0   0   0   0   0  1633
5    0   0   0   31   0   0   0   0   0   0   561
6    0   0   0    4   0   0   0   0   0   0  3063
7    0   0   0  112   0   0   0   0   0   0  1052
8    0   0   0   31   0   0   0   0   0   0  1339
9    0   0   0   15   0   0   0   0   0   0  1122
10   0   0   0    0   0   0   0   0   0   0  1646
better model found
persisted
after epoch: 2,now: 2024-07-22 02:33:45.541558,epoch time: 0:24:34.153042,used: 0:49:05.240516,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.41350064, 'precision': 0.083579235, 'recall': 0.119725965, 'specificity': 0.9208636, 'f1': 0.08654649, 'auroc': 0.7095435}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    61   0   0   0   0   0   0    422
1    0   0   0   628   0   0   0  55   0   0    649
2    0   0   0    23   0   0   0   0   0   0    289
3    0   0   0  2692   0   0   0   2   0   0   5744
4    0   0   0    11   0   0   0   0   0   0    528
5    0   0   0    81   0   0   0   1   0   0    438
6    0   0   0   150   0   0   0   4   0   0   1754
7    0   0   0  2091   0   0   0   5   0   0   5166
8    0   0   0   217   0   0   0   5   0   0   3074
9    0   0   0    84   0   0   0   2   0   0    407
10   0   0   0    35   0   0   0   0   0   0  12758
---- Validation: 
scalar performance:
{'acc': 0.4132941, 'precision': 0.08243549, 'recall': 0.119623646, 'specificity': 0.9208499, 'f1': 0.086368576, 'auroc': 0.7055909}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    47   0   0   0   0   0   0    436
1    0   0   0   593   0   0   0  48   0   0    691
2    0   0   0    28   0   0   0   1   0   0    283
3    0   0   0  2681   0   0   0   5   0   0   5754
4    0   0   0     9   0   0   0   0   0   0    530
5    0   0   0    97   0   0   0   0   0   0    424
6    0   0   0   132   0   0   0   1   0   0   1775
7    0   0   0  2190   0   0   0   4   0   0   5071
8    0   0   0   219   0   0   0   8   0   0   3069
9    0   0   0    68   0   0   0   2   0   0    423
10   0   0   0    30   0   0   0   0   0   0  12766
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011331797, 'recall': 0.09090909, 'specificity': 0.909991, 'f1': 0.02015169, 'auroc': 0.5438699}
confusion matrix:
    0   1   2    3   4   5   6   7   8   9     10
0    0   0   0  161   0   0   0   0   0   0  1009
1    0   0   0  261   0   0   0   0   0   0  1238
2    0   0   0   15   0   0   0   0   0   0  1000
3    0   0   0    0   0   0   0   0   0   0     0
4    0   0   0    0   0   0   0   0   0   0  1633
5    0   0   0  132   0   0   0   1   0   0   459
6    0   0   0   13   0   0   0   0   0   0  3054
7    0   0   0  310   0   0   0   0   0   0   854
8    0   0   0  101   0   0   0   0   0   0  1269
9    0   0   0   94   0   0   0   0   0   0  1043
10   0   0   0    0   0   0   0   0   0   0  1646
better model found
persisted
after epoch: 3,now: 2024-07-22 02:58:17.230812,epoch time: 0:24:31.689254,used: 1:13:36.929770,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.5085617, 'precision': 0.17272174, 'recall': 0.15893175, 'specificity': 0.9357989, 'f1': 0.119385086, 'auroc': 0.7388101}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0   100   0   0   0    3   0   0    379
1    0  10   0   717   0   0   0  117   0   0    488
2    0   0   0    83   0   0   0    1   0   0    228
3    0   2   0  6183   0   0   0   14   0   0   2240
4    0   0   0    28   0   0   0    0   0   0    511
5    0   0   0   241   0   0   0    4   0   0    276
6    0   1   4   297   0   0   0   26   0   0   1579
7    0   5   1  4115   0   0   0  108   0   0   3033
8    0   1   0   573   0   0   0   18   0   0   2703
9    0   0   0   196   0   0   0    5   0   0    292
10   0   0   0    86   0   0   0    1   0   0  12707
---- Validation: 
scalar performance:
{'acc': 0.50817174, 'precision': 0.17750789, 'recall': 0.15879397, 'specificity': 0.935753, 'f1': 0.11927624, 'auroc': 0.73903364}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0   111   0   0   0    6   0   0    366
1    0  10   0   706   0   0   0  103   0   0    513
2    0   1   0    87   0   0   0    3   0   0    221
3    0   1   1  6168   0   0   0   16   0   0   2254
4    0   0   0    42   0   0   0    2   0   0    495
5    0   0   0   225   0   0   0    3   0   0    293
6    0   1   1   285   0   0   0   18   0   0   1603
7    0   4   1  4159   0   0   0  110   0   0   2991
8    0   1   3   535   0   0   0   16   0   0   2741
9    0   0   2   226   0   0   0    5   0   0    260
10   0   0   1    84   0   0   0    1   0   0  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.12796474, 'precision': 0.042270884, 'recall': 0.10522437, 'specificity': 0.91260636, 'f1': 0.042520046, 'auroc': 0.54721457}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9     10
0    0   1   0  250   0   0   0  122   0   0   797
1    0   0   0  642   0   0   0   66   0   0   791
2    0   0   0   75   0   0   0   15   0   0   925
3    0   0   0    0   0   0   0    0   0   0     0
4    0   0   0    1   0   0   0    0   0   0  1632
5    0   1   0  312   0   0   0   43   0   0   236
6    0   0   0   30   0   0   0    2   0   0  3035
7    0   2   0  643   0   0   0  184   0   0   335
8    0   3   0  238   0   0   0   79   0   0  1050
9    0   0   0  339   0   0   0   68   0   0   730
10   0   0   0    1   0   0   0    0   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-22 03:22:56.753852,epoch time: 0:24:39.523040,used: 1:38:16.452810,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5519585, 'precision': 0.21843076, 'recall': 0.18391208, 'specificity': 0.9429, 'f1': 0.15371986, 'auroc': 0.77642167}
confusion matrix:
    0    1   2     3   4   5   6    7   8   9      10
0    0    0   0   168   0   0   0   19   0   0    296
1    0  117   2   445   0   0   0  603   0   0    165
2    0    0   0   131   0   0   0   15   0   0    166
3    0    1   1  7149   0   0   0   79   0   0   1209
4    0    0   0    50   0   0   0    1   0   0    488
5    0    0   0   305   0   0   0    9   0   0    207
6    0    6   0   423   0   0   0   64   0   0   1414
7    0   10   1  4878   0   0   0  727   0   0   1647
8    0    1   4   704   0   0   0   59   0   0   2528
9    0    1   0   293   0   0   0   19   0   0    180
10   0    0   0   141   0   0   0   13   0   0  12637
---- Validation: 
scalar performance:
{'acc': 0.5524676, 'precision': 0.21328126, 'recall': 0.1838626, 'specificity': 0.94299525, 'f1': 0.15347807, 'auroc': 0.7760498}
confusion matrix:
    0    1   2     3   4   5   6    7   8   9      10
0    0    1   0   174   0   0   0   25   0   0    283
1    0  112   2   422   0   0   0  617   0   0    179
2    0    0   0   125   0   0   0   17   0   0    170
3    0    3   1  7163   0   0   0   67   0   0   1206
4    0    0   0    52   0   0   0    2   0   0    485
5    0    1   0   312   0   0   0    9   0   0    199
6    0    3   2   383   0   0   0   93   0   0   1427
7    0   13   2  4887   0   0   0  742   0   0   1621
8    0    6   2   737   0   0   0   50   0   0   2501
9    0    0   0   287   0   0   0   24   0   0    182
10   0    0   0   148   0   0   0   11   0   0  12637
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.16679494, 'precision': 0.11510434, 'recall': 0.14807549, 'specificity': 0.91674095, 'f1': 0.06330193, 'auroc': 0.57241404}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9     10
0    0  15   0  154   0   0   0  607   0   0   394
1    0  29   0  476   0   0   0  667   0   0   327
2    0   2   1  118   0   0   0   96   0   0   798
3    0   0   0    0   0   0   0    0   0   0     0
4    0   0   0    1   0   0   0    2   0   0  1630
5    0   4   0  310   0   0   0  166   0   0   112
6    0   1   1   79   0   0   0   41   0   0  2945
7    0  14   0  341   0   0   0  709   0   0   100
8    0  17   0  256   0   0   0  228   0   0   869
9    0   4   0  415   0   0   0  313   0   0   405
10   0   0   0    1   0   0   0    0   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-22 03:47:39.222297,epoch time: 0:24:42.468445,used: 2:02:58.921255,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.5827269, 'precision': 0.23807824, 'recall': 0.20023021, 'specificity': 0.9471787, 'f1': 0.17631754, 'auroc': 0.8001045}
confusion matrix:
    0    1   2     3   4   5   6     7   8   9      10
0    0    1   0   177   0   0   0    38   0   0    267
1    0  162   1   211   0   0   0   868   0   0     90
2    0    0   0   135   0   0   0    33   0   0    144
3    0    2   1  7465   0   0   0   119   0   0    849
4    0    0   0    66   0   0   0     8   0   0    465
5    0    0   0   361   0   0   0    11   0   0    149
6    0    2   0   403   0   0   0   175   0   0   1326
7    0    2   1  4398   0   0   0  1509   0   0   1354
8    0    1   2   775   0   0   0   104   0   0   2414
9    0    1   0   312   0   0   0    36   0   0    144
10   0    0   0   134   0   0   0    16   0   0  12644
---- Validation: 
scalar performance:
{'acc': 0.5823726, 'precision': 0.23530744, 'recall': 0.1990531, 'specificity': 0.9471368, 'f1': 0.17451012, 'auroc': 0.8006403}
confusion matrix:
    0    1   2     3   4   5   6     7   8   9      10
0    0    0   0   190   0   0   0    60   0   0    233
1    0  143   4   196   0   0   0   891   0   0     98
2    0    0   0   131   0   0   0    26   0   0    155
3    0    1   0  7447   0   0   0   130   0   0    862
4    0    0   1    61   0   0   0     4   0   0    473
5    0    0   0   350   0   0   0    13   0   0    158
6    0    4   0   423   0   0   0   157   0   0   1324
7    0    8   0  4358   0   0   0  1539   0   0   1360
8    0    0   2   780   0   0   0    96   0   0   2418
9    0    0   1   319   0   0   0    36   0   0    137
10   0    0   0   131   0   0   0    22   0   0  12643
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.17763941, 'precision': 0.067407906, 'recall': 0.16046634, 'specificity': 0.91751206, 'f1': 0.06206522, 'auroc': 0.5881751}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9     10
0    0   9   0   78   0   0   0  766   0   0   317
1    0  12   0  274   0   0   0  934   0   0   279
2    0   1   0   87   0   0   0  157   0   0   770
3    0   0   0    0   0   0   0    0   0   0     0
4    0   0   0    1   0   0   0    5   0   0  1627
5    0   3   0  270   0   0   0  217   0   0   102
6    0   1   0   63   0   0   0   65   0   0  2938
7    0   3   0  204   0   0   0  882   0   0    75
8    0   7   0  208   0   0   0  271   0   0   884
9    0   1   0  311   0   0   0  468   0   0   357
10   0   0   0    1   0   0   0    0   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-22 04:12:19.066125,epoch time: 0:24:39.843828,used: 2:27:38.765083,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.60153574, 'precision': 0.2453484, 'recall': 0.20982371, 'specificity': 0.9499482, 'f1': 0.18827987, 'auroc': 0.81784695}
confusion matrix:
    0    1   2     3   4   5   6     7   8   9      10
0    0    0   0   195   0   0   0    63   0   0    225
1    0  178   2   131   0   0   0   962   0   0     59
2    0    0   0   133   0   0   0    52   0   0    127
3    0    0   0  7601   0   0   0   171   0   0    667
4    0    0   0    75   0   0   0     6   0   0    458
5    0    1   0   401   0   0   0    18   0   0    100
6    0    2   0   412   0   0   0   271   0   0   1223
7    0    3   0  4169   0   0   0  2088   0   0   1001
8    0    1   0   855   0   0   0   136   0   0   2304
9    0    0   0   345   0   0   0    48   0   0    100
10   0    0   0   146   0   0   0    31   0   0  12616
---- Validation: 
scalar performance:
{'acc': 0.6015514, 'precision': 0.24506931, 'recall': 0.20977256, 'specificity': 0.9498811, 'f1': 0.18822378, 'auroc': 0.8171209}
confusion matrix:
    0    1   2     3   4   5   6     7   8   9      10
0    0    0   0   183   0   0   0    79   0   0    221
1    0  178   1   127   0   0   0   958   0   0     68
2    0    0   0   137   0   0   0    43   0   0    132
3    0    0   0  7601   0   0   0   175   0   0    664
4    0    0   0    73   0   0   0     8   0   0    458
5    0    0   0   399   0   0   0    17   0   0    105
6    0    1   0   408   0   0   0   241   0   0   1258
7    0    4   0  4153   0   0   0  2079   0   0   1029
8    0    1   0   823   0   0   0   126   0   0   2346
9    0    1   0   339   0   0   0    50   0   0    103
10   0    1   0   130   0   0   0    34   0   0  12631
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18225706, 'precision': 0.059954893, 'recall': 0.16573113, 'specificity': 0.91808367, 'f1': 0.06234178, 'auroc': 0.6004677}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   8   0   72   0   0   0   842   0   0   248
1    0   7   0  228   0   0   0  1066   0   0   198
2    0   1   0  106   0   0   0   189   0   0   719
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0     5   0   0  1627
5    0   3   0  272   0   0   0   243   0   0    74
6    0   3   0   85   0   0   0   103   0   0  2876
7    0   0   0  164   0   0   0   954   0   0    46
8    0   6   0  237   0   0   0   289   0   0   838
9    0   1   0  325   0   0   0   533   0   0   278
10   0   0   0    1   0   0   0     1   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-22 04:36:55.340178,epoch time: 0:24:36.274053,used: 2:52:15.039136,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.62208366, 'precision': 0.25409716, 'recall': 0.21870425, 'specificity': 0.9526568, 'f1': 0.19778411, 'auroc': 0.83120155}
confusion matrix:
    0    1   2     3   4   5   6     7   8   9      10
0    0    0   0   190   0   0   0    79   0   0    214
1    0  169   0    86   0   0   0  1030   0   0     47
2    0    0   0   137   0   0   0    57   0   0    118
3    0    0   0  7756   0   0   0   191   0   0    490
4    0    0   0    69   0   0   0    12   0   0    458
5    0    0   0   426   0   0   0    18   0   0     77
6    0    1   0   430   0   0   0   296   0   0   1180
7    0    1   0  3718   0   0   0  2715   0   0    829
8    0    1   0   886   0   0   0   148   0   0   2261
9    0    1   0   348   0   0   0    53   0   0     91
10   0    0   0   142   0   0   0    40   0   0  12611
---- Validation: 
scalar performance:
{'acc': 0.619794, 'precision': 0.25373948, 'recall': 0.21694872, 'specificity': 0.95239896, 'f1': 0.19535571, 'auroc': 0.8292958}
confusion matrix:
    0    1   2     3   4   5   6     7   8   9      10
0    0    0   0   190   0   0   0    87   0   0    206
1    0  154   1    87   0   0   0  1049   0   0     41
2    0    0   0   147   0   0   0    49   0   0    116
3    0    0   0  7743   0   0   0   219   0   0    478
4    0    0   0    73   0   0   0    11   0   0    455
5    0    0   0   430   0   0   0    21   0   0     70
6    0    1   0   433   0   0   0   304   0   0   1170
7    0    1   0  3704   0   0   0  2685   0   0    875
8    0    0   0   851   0   0   0   172   0   0   2273
9    0    0   0   350   0   0   0    64   0   0     79
10   0    0   0   174   0   0   0    33   0   0  12589
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18652487, 'precision': 0.15565665, 'recall': 0.17051843, 'specificity': 0.9184317, 'f1': 0.062705256, 'auroc': 0.6092338}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   4   0   54   0   0   0   885   0   0   227
1    0   5   0  157   0   0   0  1168   0   0   169
2    0   1   0   90   0   0   0   222   0   0   702
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0     7   0   0  1625
5    0   0   0  264   0   0   0   257   0   0    71
6    0   2   0   89   0   0   0   126   0   0  2850
7    0   0   0  113   0   0   0  1016   0   0    35
8    0   4   0  232   0   0   0   286   1   0   847
9    0   1   0  295   0   0   0   591   0   0   250
10   0   0   0    1   0   0   0     1   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-22 05:01:19.071580,epoch time: 0:24:23.731402,used: 3:16:38.770538,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.636906, 'precision': 0.2578517, 'recall': 0.22544317, 'specificity': 0.9551382, 'f1': 0.20390347, 'auroc': 0.844161}
confusion matrix:
    0    1   2     3   4   5   6     7   8   9      10
0    0    0   0   208   0   0   0   126   0   0    149
1    0  158   0    65   0   0   0  1085   0   0     24
2    0    0   0   144   0   0   0    83   0   0     85
3    0    1   0  7848   0   0   0   291   0   0    298
4    0    0   0   104   0   0   0    19   0   0    416
5    0    0   0   437   0   0   0    33   0   0     51
6    0    0   0   471   0   0   0   442   0   0    993
7    0    1   0  3517   0   0   0  3299   0   0    447
8    0    0   0   993   0   0   0   257   0   0   2044
9    0    0   0   369   0   0   0    78   0   0     46
10   0    0   0   218   0   0   0    76   0   0  12500
---- Validation: 
scalar performance:
{'acc': 0.636298, 'precision': 0.25767362, 'recall': 0.22511987, 'specificity': 0.955072, 'f1': 0.20351444, 'auroc': 0.8437391}
confusion matrix:
    0    1   2     3   4   5   6     7   8   9      10
0    0    0   0   199   0   0   0   134   0   0    150
1    0  158   0    56   0   0   0  1090   1   0     27
2    0    0   0   150   0   0   0    75   0   0     87
3    0    0   0  7867   0   0   0   282   0   0    291
4    0    0   0   100   0   0   0    22   0   0    417
5    0    0   0   453   0   0   0    29   0   0     39
6    0    1   0   508   0   0   0   403   0   0    996
7    0    1   0  3543   0   0   0  3256   0   0    465
8    0    0   0  1019   0   0   0   262   0   0   2015
9    0    0   0   355   0   0   0    82   0   0     56
10   0    0   0   200   0   0   0    88   1   0  12507
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19044288, 'precision': 0.12476673, 'recall': 0.17492065, 'specificity': 0.9191431, 'f1': 0.06340923, 'auroc': 0.6211482}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   3   0   58   0   0   0   991   1   0   117
1    0   4   0  106   0   0   0  1298   0   0    91
2    0   1   0  138   0   0   0   327   0   0   549
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    7   0   0   0    16   0   0  1610
5    0   0   0  261   0   0   0   293   0   0    38
6    0   3   0  198   0   0   0   238   0   0  2628
7    0   0   0   74   0   0   0  1073   0   0    17
8    0   3   0  297   0   0   0   379   2   0   689
9    0   0   0  297   0   0   0   725   0   0   115
10   0   0   0    2   0   0   0     1   0   0  1643
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-22 05:25:56.078431,epoch time: 0:24:37.006851,used: 3:41:15.777389,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.65841717, 'precision': 0.2634451, 'recall': 0.23082939, 'specificity': 0.95751226, 'f1': 0.20532489, 'auroc': 0.8534376}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   150   0   0   0   150   0   0    183
1    0  74   0    32   0   0   0  1190   0   0     36
2    0   0   0   123   0   0   0    94   0   0     95
3    0   1   0  7672   0   0   0   433   0   0    329
4    0   0   0    79   0   0   0    22   0   0    438
5    0   0   0   433   0   0   0    41   0   0     47
6    0   1   0   353   0   0   0   481   0   0   1072
7    0   0   0  2457   0   0   0  4302   0   0    505
8    0   0   0   855   0   0   0   300   0   0   2141
9    0   0   0   322   0   0   0   100   0   0     71
10   0   0   0   152   0   0   0    81   0   0  12561
---- Validation: 
scalar performance:
{'acc': 0.65868664, 'precision': 0.2637569, 'recall': 0.23146592, 'specificity': 0.9575436, 'f1': 0.20660548, 'auroc': 0.8535316}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   158   0   0   0   153   0   0    172
1    0  85   0    42   0   0   0  1173   1   0     31
2    0   0   0   106   0   0   0   109   0   0     97
3    0   0   0  7671   0   0   0   427   0   0    342
4    0   0   0    82   0   0   0    29   0   0    428
5    0   0   0   440   0   0   0    26   0   0     55
6    0   1   0   349   0   0   0   487   0   0   1071
7    0   0   0  2457   0   0   0  4288   0   0    520
8    0   0   0   852   0   0   0   305   0   0   2139
9    0   0   0   325   0   0   0   106   0   0     62
10   0   1   0   143   0   0   0    71   0   0  12581
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19268173, 'precision': 0.13948798, 'recall': 0.1774611, 'specificity': 0.91895485, 'f1': 0.06177307, 'auroc': 0.62628794}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   1   0   22   0   0   0  1004   0   0   143
1    0   1   0   52   0   0   0  1337   0   0   109
2    0   1   0   72   0   0   0   341   0   0   601
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    14   0   0  1618
5    0   0   0  207   0   0   0   336   0   0    49
6    0   3   0   89   0   0   0   216   0   0  2759
7    0   0   0   35   0   0   0  1108   0   0    21
8    0   2   0  225   0   0   0   371   1   0   771
9    0   0   0  182   0   0   0   796   0   0   159
10   0   0   0    1   0   0   0     1   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-22 05:50:32.095675,epoch time: 0:24:36.017244,used: 4:05:51.794633,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.6666845, 'precision': 0.29484358, 'recall': 0.2331725, 'specificity': 0.95855045, 'f1': 0.20580433, 'auroc': 0.8594114}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   156   0   0   0   162   1   0    164
1    0  47   0    26   0   0   0  1231   1   0     27
2    0   0   0   104   0   0   0   106   0   0    102
3    0   0   0  7624   0   0   0   508   0   0    308
4    0   0   0    76   0   0   0    30   0   0    433
5    0   0   0   440   0   0   0    36   0   0     45
6    0   1   0   289   0   0   0   505   2   0   1111
7    0   1   0  2126   0   0   0  4662   0   0    475
8    0   0   0   831   0   0   0   342   2   0   2120
9    0   0   0   307   0   0   0   121   0   0     65
10   0   0   0   132   0   0   0    74   0   0  12583
---- Validation: 
scalar performance:
{'acc': 0.6649993, 'precision': 0.26577687, 'recall': 0.23235023, 'specificity': 0.9583416, 'f1': 0.20492908, 'auroc': 0.86023307}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   143   0   0   0   165   0   0    175
1    0  46   0    27   0   0   0  1228   0   0     31
2    0   0   0   102   0   0   0    97   0   0    113
3    0   0   0  7617   0   0   0   515   1   0    307
4    0   0   0    74   0   0   0    29   0   0    436
5    0   0   0   432   0   0   0    50   0   0     39
6    0   0   0   312   0   0   0   498   2   0   1096
7    0   0   0  2155   0   0   0  4619   1   0    490
8    0   1   0   836   0   0   0   339   0   0   2120
9    0   0   0   322   0   0   0   110   0   0     61
10   0   0   0   127   0   0   0    90   0   0  12579
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19366123, 'precision': 0.13181552, 'recall': 0.17840788, 'specificity': 0.9190671, 'f1': 0.0639441, 'auroc': 0.63222563}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   34   0   0   0   974   1   0   161
1    0   2   0   53   0   0   0  1343   0   0   101
2    0   0   0   83   0   0   0   311   1   0   620
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    11   0   0  1620
5    0   0   0  214   0   0   0   319   1   0    58
6    0   1   0  105   0   0   0   197   0   0  2764
7    0   0   0   33   0   0   0  1110   0   0    21
8    0   4   0  238   0   0   0   307  12   0   809
9    0   0   0  198   0   0   0   761   0   0   178
10   0   0   0    1   0   0   0     0   1   0  1644
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-22 06:15:05.687907,epoch time: 0:24:33.592232,used: 4:30:25.386865,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.6780287, 'precision': 0.3051011, 'recall': 0.23656733, 'specificity': 0.9601467, 'f1': 0.2060901, 'auroc': 0.8710872}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   122   0   0   0   200   0   0    161
1    0  10   0    19   0   0   0  1272   1   0     29
2    0   0   0   116   0   0   0   114   0   0     82
3    0   0   0  7625   0   0   0   576   2   0    235
4    0   0   0    75   0   0   0    31   0   0    433
5    0   0   0   439   0   0   0    49   2   0     31
6    0   0   0   307   0   0   0   571   9   0   1021
7    0   0   0  1763   0   0   0  5121   1   0    378
8    0   0   0   874   0   0   0   384  10   0   2026
9    0   0   0   306   0   0   0   133   0   0     54
10   0   0   0   113   0   0   0   103   2   0  12576
---- Validation: 
scalar performance:
{'acc': 0.67682225, 'precision': 0.28620642, 'recall': 0.23596093, 'specificity': 0.96002173, 'f1': 0.20511529, 'auroc': 0.870787}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   138   0   0   0   188   0   0    157
1    0   8   0    25   0   0   0  1273   1   0     25
2    0   0   0   102   0   0   0   123   1   0     86
3    0   0   0  7607   0   0   0   607   0   0    226
4    0   0   0    86   0   0   0    43   0   0    410
5    0   0   0   449   0   0   0    40   3   0     29
6    0   0   0   292   0   0   0   573  10   0   1033
7    0   0   0  1753   0   0   0  5131   0   0    381
8    0   0   0   869   0   0   0   396   3   0   2028
9    0   0   0   311   0   0   0   125   0   0     57
10   0   0   0   124   0   0   0   118   0   0  12554
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19492058, 'precision': 0.08971129, 'recall': 0.17986034, 'specificity': 0.9191803, 'f1': 0.06286174, 'auroc': 0.6379892}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   1   0   16   0   0   0  1031   2   0   120
1    0   0   0   30   0   0   0  1399   0   0    70
2    0   0   0   61   0   0   0   403   2   0   549
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    19   0   0  1613
5    0   0   0  190   0   0   0   354   2   0    46
6    0   0   0  102   0   0   0   306   2   0  2657
7    0   0   0   16   0   0   0  1131   0   0    17
8    0   3   0  210   0   0   0   392  11   0   754
9    0   0   0  138   0   0   0   870   0   0   129
10   0   1   0    1   0   0   0     0   0   0  1644
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-22 06:39:39.831541,epoch time: 0:24:34.143634,used: 4:54:59.530499,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.68236303, 'precision': 0.19590622, 'recall': 0.23788458, 'specificity': 0.9606816, 'f1': 0.20627815, 'auroc': 0.8770593}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   130   0   0   0   197   1   0    155
1    0   0   0    30   0   0   0  1273   1   0     28
2    0   0   0   114   0   0   0   108   0   0     90
3    0   0   0  7708   0   0   0   527   2   0    200
4    0   0   0    72   0   0   0    32   0   0    435
5    0   0   0   449   0   0   0    48   3   0     20
6    0   1   0   321   0   0   0   547  19   0   1020
7    0   0   0  1697   0   0   0  5224   0   0    341
8    0   0   0   876   0   0   0   367   5   0   2048
9    0   0   0   311   0   0   0   126   2   0     54
10   0   0   0   129   0   0   0    98   0   0  12567
---- Validation: 
scalar performance:
{'acc': 0.6798984, 'precision': 0.28363967, 'recall': 0.23702784, 'specificity': 0.9604728, 'f1': 0.20573282, 'auroc': 0.8763227}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   135   0   0   0   185   0   0    163
1    0   4   0    20   0   0   0  1284   0   0     24
2    0   0   0   103   0   0   0   112   0   0     97
3    0   0   0  7682   0   0   0   559   1   0    198
4    0   0   0    82   0   0   0    33   0   0    424
5    0   0   0   444   0   0   0    49   3   0     25
6    0   0   0   314   0   0   0   581  28   0    985
7    0   0   0  1743   0   0   0  5164   0   0    358
8    0   0   0   920   0   0   0   412   5   0   1959
9    0   0   0   318   0   0   0   130   1   0     44
10   0   0   0   135   0   0   0    97   1   0  12563
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19457076, 'precision': 0.08549036, 'recall': 0.17949334, 'specificity': 0.91921955, 'f1': 0.06297926, 'auroc': 0.6428844}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   21   0   0   0  1028   3   0   118
1    0   0   0   37   0   0   0  1396   0   0    66
2    0   0   0   73   0   0   0   395   1   0   546
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    19   0   0  1613
5    0   0   0  216   0   0   0   331   2   0    43
6    0   0   0  114   0   0   0   295   2   0  2656
7    0   0   0   23   0   0   0  1128   0   0    13
8    0   1   0  231   0   0   0   374   9   0   755
9    0   0   0  166   0   0   0   849   0   0   122
10   0   0   0    2   0   0   0     0   0   0  1644
better model found
persisted
after epoch: 13,now: 2024-07-22 07:04:18.177128,epoch time: 0:24:38.345587,used: 5:19:37.876086,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.690229, 'precision': 0.2025925, 'recall': 0.241725, 'specificity': 0.9615737, 'f1': 0.210302, 'auroc': 0.87957186}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   114   0   0   0   190   0   0    179
1    0   0   0    19   0   0   0  1291   1   0     21
2    0   0   0    89   0   0   0   127   4   0     92
3    0   0   0  7605   0   0   0   616   3   0    214
4    0   0   0    64   0   0   0    40   0   0    435
5    0   0   0   438   0   0   0    55   2   0     26
6    0   0   0   203   0   0   0   593  47   0   1065
7    0   0   0  1267   0   0   0  5578   1   0    417
8    0   0   0   805   0   0   0   434  16   0   2039
9    0   0   0   285   0   0   0   150   6   0     52
10   0   0   0    89   0   0   0   102   3   0  12599
---- Validation: 
scalar performance:
{'acc': 0.6891267, 'precision': 0.2962476, 'recall': 0.24128428, 'specificity': 0.96140903, 'f1': 0.2100717, 'auroc': 0.88151777}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    95   0   0   0   205   1   0    182
1    0   1   0    22   0   0   0  1285   2   0     22
2    0   0   0    93   0   0   0   117   3   0     99
3    0   0   0  7588   0   0   0   629   3   0    220
4    0   0   0    66   0   0   0    33   1   0    439
5    0   0   0   420   0   0   0    75   1   0     25
6    0   0   0   209   0   0   0   603  39   0   1057
7    0   0   0  1277   0   0   0  5550   1   0    437
8    0   0   0   782   0   0   0   430  17   0   2067
9    0   0   0   277   0   0   0   155   6   0     55
10   0   0   0    93   0   0   0    95   1   0  12607
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1956902, 'precision': 0.090651855, 'recall': 0.1806255, 'specificity': 0.919039, 'f1': 0.06336009, 'auroc': 0.6469518}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0    9   0   0   0  1015   3   0   143
1    0   0   0   15   0   0   0  1406   0   0    78
2    0   0   0   31   0   0   0   375   0   0   609
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    15   0   0  1618
5    0   0   0  186   0   0   0   348   1   0    57
6    0   0   0   40   0   0   0   254   5   0  2768
7    0   0   0   11   0   0   0  1134   0   0    19
8    0   1   0  149   0   0   0   357  19   0   844
9    0   0   0  101   0   0   0   864   3   0   169
10   0   0   0    1   0   0   0     0   1   0  1644
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-22 07:28:50.966564,epoch time: 0:24:32.789436,used: 5:44:10.665522,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.6915935, 'precision': 0.28564104, 'recall': 0.24278419, 'specificity': 0.9620209, 'f1': 0.21079105, 'auroc': 0.886783}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   116   0   0   0   215   3   0    149
1    0   3   0    18   0   0   0  1289   1   0     21
2    0   0   0    98   0   0   0   130   5   0     78
3    0   0   0  7592   0   0   0   680   3   0    162
4    0   0   0    75   0   0   0    58   8   0    398
5    0   0   0   419   0   0   0    77   2   0     23
6    0   0   0   234   0   0   0   693  55   0    925
7    0   0   0  1240   0   0   0  5705   0   0    320
8    0   0   0   847   0   0   0   451  10   0   1988
9    0   0   0   280   0   0   0   168   2   0     43
10   0   0   0   104   0   0   0   144   5   0  12539
---- Validation: 
scalar performance:
{'acc': 0.6922563, 'precision': 0.29716963, 'recall': 0.24309918, 'specificity': 0.9620732, 'f1': 0.21141134, 'auroc': 0.88623464}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   115   0   0   0   203   2   0    163
1    0   2   0    16   0   0   0  1286   2   0     26
2    0   0   0    99   0   0   0   128   2   0     83
3    0   0   0  7555   0   0   0   714   0   0    171
4    0   0   0    73   0   0   0    50   4   0    412
5    0   0   0   433   0   0   0    69   4   0     15
6    0   0   0   222   0   0   0   676  49   0    961
7    0   0   0  1226   0   0   0  5724   1   0    314
8    0   0   0   838   0   0   0   483  22   0   1953
9    0   0   0   276   0   0   0   166   7   0     44
10   0   0   0    95   0   0   0   122   2   0  12577
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19610998, 'precision': 0.09248251, 'recall': 0.18111697, 'specificity': 0.91922903, 'f1': 0.06347077, 'auroc': 0.65246487}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   15   0   0   0  1038   3   0   114
1    0   0   0   14   0   0   0  1430   0   0    55
2    0   0   0   45   0   0   0   437   1   0   532
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    22   0   0  1610
5    0   0   0  177   0   0   0   373   1   0    41
6    0   0   0   73   0   0   0   360   5   0  2629
7    0   0   0   11   0   0   0  1141   0   0    12
8    0   0   0  170   0   0   0   416  19   0   765
9    0   0   0   97   0   0   0   921   1   0   118
10   0   0   0    2   0   0   0     0   1   0  1643
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-22 07:53:33.893118,epoch time: 0:24:42.926554,used: 6:08:53.592076,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.6946436, 'precision': 0.2926972, 'recall': 0.24370328, 'specificity': 0.9622406, 'f1': 0.21180278, 'auroc': 0.8913892}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   112   0   0   0   209   0   0    162
1    0   1   0    15   0   0   0  1293   1   0     22
2    0   0   0   105   0   0   0   120   3   0     84
3    0   0   0  7696   0   0   0   578   2   0    163
4    0   0   0    62   0   0   0    52   2   0    422
5    0   0   0   433   0   0   0    65   2   0     21
6    0   0   0   211   0   0   0   632  57   0   1008
7    0   0   0  1245   0   0   0  5657   1   0    360
8    0   0   0   861   0   0   0   417  15   0   2003
9    0   0   0   289   0   0   0   158   3   0     43
10   0   0   0    82   0   0   0   114   1   0  12594
---- Validation: 
scalar performance:
{'acc': 0.69247025, 'precision': 0.28868687, 'recall': 0.24271715, 'specificity': 0.9620168, 'f1': 0.2111191, 'auroc': 0.89156854}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   106   0   0   0   204   0   0    173
1    0   1   0    20   0   0   0  1289   0   0     22
2    0   0   0   101   0   0   0   124   6   0     81
3    0   0   0  7682   0   0   0   585   5   0    168
4    0   0   0    68   0   0   0    45   3   0    423
5    0   0   0   430   0   0   0    68   7   0     16
6    0   0   0   213   0   0   0   654  74   0    967
7    0   0   0  1309   0   0   0  5587   2   0    367
8    0   0   0   838   0   0   0   431  17   0   2010
9    0   0   0   281   0   0   0   160  10   0     42
10   0   0   0    83   0   0   0   110   2   0  12601
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1956902, 'precision': 0.09318741, 'recall': 0.18060201, 'specificity': 0.9192209, 'f1': 0.064093046, 'auroc': 0.65727}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   18   0   0   0  1029   3   0   120
1    0   0   0   24   0   0   0  1414   0   0    61
2    0   0   0   50   0   0   0   407   1   0   557
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    20   0   0  1613
5    0   0   0  215   0   0   0   330   1   0    46
6    0   0   0   76   0   0   0   299   5   0  2687
7    0   0   0   19   0   0   0  1132   0   0    13
8    0   0   0  194   0   0   0   367  21   0   788
9    0   0   0  131   0   0   0   877   2   0   127
10   0   0   0    1   0   0   0     0   1   0  1644
better model found
persisted
after epoch: 16,now: 2024-07-22 08:18:10.538245,epoch time: 0:24:36.645127,used: 6:33:30.237203,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.6985766, 'precision': 0.29523605, 'recall': 0.24623622, 'specificity': 0.9629049, 'f1': 0.2139323, 'auroc': 0.89526594}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    98   0   0   0   233   2   0    149
1    0   1   0    13   0   0   0  1302   0   0     16
2    0   0   0    83   0   0   0   146   4   0     79
3    0   0   0  7527   0   0   0   756   3   0    153
4    0   0   0    56   0   0   0    55   5   0    423
5    0   0   0   426   0   0   0    77   5   0     12
6    0   0   0   181   0   0   0   737  67   0    923
7    0   0   0   959   0   0   0  6029   0   0    277
8    0   0   0   809   0   0   0   482  21   0   1983
9    0   0   0   258   0   0   0   193   4   0     37
10   0   0   0    91   0   0   0   165   4   0  12532
---- Validation: 
scalar performance:
{'acc': 0.69715124, 'precision': 0.29114696, 'recall': 0.24543896, 'specificity': 0.96275437, 'f1': 0.21323526, 'auroc': 0.894363}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    99   0   0   0   232   5   0    147
1    0   1   0    12   0   0   0  1301   0   0     18
2    0   0   0    77   0   0   0   150   1   0     84
3    0   0   0  7466   0   0   0   803   1   0    170
4    0   0   0    62   0   0   0    53   6   0    418
5    0   0   0   419   0   0   0    86   5   0     11
6    0   0   0   180   0   0   0   742  82   0    904
7    0   0   0   972   0   0   0  6003   2   0    288
8    0   0   0   776   0   0   0   526  18   0   1976
9    0   0   0   254   0   0   0   199   4   0     36
10   0   0   0    92   0   0   0   126   3   0  12575
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19638984, 'precision': 0.0791121, 'recall': 0.18140587, 'specificity': 0.91925585, 'f1': 0.063579515, 'auroc': 0.66194916}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   14   0   0   0  1046   4   0   106
1    0   0   0   12   0   0   0  1435   0   0    52
2    0   0   0   39   0   0   0   468   2   0   506
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    28   0   0  1605
5    0   0   0  177   0   0   0   377   1   0    37
6    0   0   0   62   0   0   0   400  12   0  2593
7    0   0   0    9   0   0   0  1143   0   0    12
8    0   0   0  158   0   0   0   441  21   0   750
9    0   0   0   80   0   0   0   953   4   0   100
10   0   0   0    1   0   0   0     1   1   0  1643
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-22 08:42:53.637393,epoch time: 0:24:43.099148,used: 6:58:13.336351,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.696784, 'precision': 0.2039697, 'recall': 0.24495427, 'specificity': 0.96265775, 'f1': 0.2132391, 'auroc': 0.89781046}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0   114   0   0   0   225   4   0    140
1    0   0   0    18   0   0   0  1298   0   0     16
2    0   0   0    88   0   0   0   143   3   0     78
3    0   0   0  7684   0   0   0   596   4   0    154
4    0   0   0    61   0   0   0    53  10   0    415
5    0   0   0   414   0   0   0    87   6   0     14
6    0   0   0   183   0   0   0   695  88   0    942
7    0   0   0  1209   0   0   0  5744   0   0    310
8    0   0   0   879   0   0   0   420  30   0   1967
9    0   0   0   267   0   0   0   179   7   0     40
10   0   0   0    89   0   0   0   110   7   0  12585
---- Validation: 
scalar performance:
{'acc': 0.6987829, 'precision': 0.29016468, 'recall': 0.24573083, 'specificity': 0.9629097, 'f1': 0.21391289, 'auroc': 0.8974608}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0   114   0   0   0   209    5   0    155
1    0   1   0    20   0   0   0  1286    2   0     23
2    0   0   0    91   0   0   0   138    6   0     77
3    0   0   0  7714   0   0   0   578    4   0    144
4    0   0   0    72   0   0   0    45    9   0    413
5    0   0   0   419   0   0   0    79    9   0     14
6    0   0   0   212   0   0   0   654  107   0    935
7    0   0   0  1196   0   0   0  5786    4   0    279
8    0   0   0   844   0   0   0   445   24   0   1983
9    0   0   0   268   0   0   0   180   14   0     31
10   0   0   0    89   0   0   0   104    4   0  12599
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19638984, 'precision': 0.073814124, 'recall': 0.18128845, 'specificity': 0.9193094, 'f1': 0.06551175, 'auroc': 0.66515833}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   18   0   0   0  1025   7   0   120
1    0   0   0   20   0   0   0  1423   0   0    56
2    0   0   0   59   0   0   0   408   4   0   544
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    19   1   0  1613
5    0   0   0  226   0   0   0   320   6   0    40
6    0   0   0   90   0   0   0   288  21   0  2668
7    0   0   0   19   0   0   0  1133   0   0    12
8    0   0   0  182   0   0   0   360  31   0   797
9    0   0   0  133   0   0   0   878   6   0   120
10   0   0   0    2   0   0   0     0   1   0  1643
better model found
persisted
after epoch: 18,now: 2024-07-22 09:07:43.173211,epoch time: 0:24:49.535818,used: 7:23:02.872169,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.7010916, 'precision': 0.20748925, 'recall': 0.24720228, 'specificity': 0.96327245, 'f1': 0.21494257, 'auroc': 0.9012121}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    90   0   0   0   244   4   0    145
1    0   0   0    15   0   0   0  1303   0   0     14
2    0   0   0    90   0   0   0   139   2   0     81
3    0   0   0  7575   0   0   0   714   4   0    145
4    0   0   0    54   0   0   0    64   8   0    413
5    0   0   0   423   0   0   0    83   2   0     12
6    0   0   0   192   0   0   0   740  83   0    892
7    0   0   0   958   0   0   0  6027   1   0    279
8    0   0   0   869   0   0   0   484  30   0   1912
9    0   0   0   266   0   0   0   187   7   0     33
10   0   0   0    86   0   0   0   133   1   0  12572
---- Validation: 
scalar performance:
{'acc': 0.7010833, 'precision': 0.2047041, 'recall': 0.24718133, 'specificity': 0.96326697, 'f1': 0.21489257, 'auroc': 0.9014724}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    84   0   0   0   236   5   0    158
1    0   0   0    10   0   0   0  1303   0   0     19
2    0   0   0    81   0   0   0   161   5   0     65
3    0   0   0  7580   0   0   0   712   4   0    144
4    0   0   0    71   0   0   0    61   5   0    402
5    0   0   0   422   0   0   0    80   2   0     17
6    0   0   0   173   0   0   0   760  88   0    887
7    0   0   0   938   0   0   0  6032   1   0    294
8    0   0   0   864   0   0   0   475  27   0   1930
9    0   0   0   255   0   0   0   198   3   0     37
10   0   0   0    74   0   0   0   140  11   0  12571
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19659974, 'precision': 0.08011125, 'recall': 0.18152337, 'specificity': 0.9193183, 'f1': 0.064841725, 'auroc': 0.6686059}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   14   0   0   0  1043   4   0   109
1    0   0   0   12   0   0   0  1438   0   0    49
2    0   0   0   46   0   0   0   454   3   0   512
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    24   0   0  1609
5    0   0   0  205   0   0   0   348   4   0    35
6    0   0   0   72   0   0   0   371  16   0  2608
7    0   0   0   15   0   0   0  1137   0   0    12
8    0   0   0  178   0   0   0   411  29   0   752
9    0   0   0   98   0   0   0   931   4   0   104
10   0   0   0    1   0   0   0     0   1   0  1644
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-22 09:32:43.673034,epoch time: 0:25:00.499823,used: 7:48:03.371992,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.70020866, 'precision': 0.20233138, 'recall': 0.24638206, 'specificity': 0.9630311, 'f1': 0.21469106, 'auroc': 0.9020462}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0   111   0   0   0   211    2   0    159
1    0   0   0    16   0   0   0  1287    1   0     27
2    0   0   0    88   0   0   0   132    7   0     84
3    0   0   0  7703   0   0   0   582    5   0    149
4    0   0   0    62   0   0   0    55   13   0    409
5    0   0   0   416   0   0   0    82    6   0     17
6    0   0   0   175   0   0   0   678  115   0    940
7    0   0   0  1082   0   0   0  5830    0   0    351
8    0   0   0   883   0   0   0   409   30   0   1974
9    0   0   0   264   0   0   0   190   10   0     29
10   0   0   0    75   0   0   0   104    5   0  12608
---- Validation: 
scalar performance:
{'acc': 0.7012973, 'precision': 0.29022872, 'recall': 0.24684912, 'specificity': 0.9631684, 'f1': 0.21496269, 'auroc': 0.9027763}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0   112   0   0   0   207    7   0    157
1    0   1   0    17   0   0   0  1289    2   0     23
2    0   0   0    85   0   0   0   131    8   0     88
3    0   0   0  7720   0   0   0   555    3   0    162
4    0   0   0    66   0   0   0    50   13   0    410
5    0   0   0   421   0   0   0    82    5   0     13
6    0   0   0   184   0   0   0   684  117   0    923
7    0   0   0  1064   0   0   0  5869    2   0    330
8    0   0   0   883   0   0   0   410   23   0   1980
9    0   0   0   262   0   0   0   184   10   0     37
10   0   0   0    81   0   0   0   103    7   0  12605
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19638984, 'precision': 0.07804544, 'recall': 0.18121922, 'specificity': 0.91931057, 'f1': 0.066171855, 'auroc': 0.67121917}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   25   0   0   0   998   7   0   140
1    0   0   0   24   0   0   0  1416   0   0    59
2    0   0   0   57   0   0   0   377   4   0   577
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    17   2   0  1614
5    0   0   0  256   0   0   0   287   6   0    43
6    0   0   0   82   0   0   0   243  17   0  2725
7    0   0   0   22   0   0   0  1129   0   0    13
8    0   0   0  199   0   0   0   319  33   0   819
9    0   0   0  160   0   0   0   830   5   0   142
10   0   0   0    1   0   0   0     0   0   0  1645
better model found
persisted
after epoch: 20,now: 2024-07-22 09:57:44.567042,epoch time: 0:25:00.894008,used: 8:13:04.266000,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.70357984, 'precision': 0.20229988, 'recall': 0.24799618, 'specificity': 0.96344084, 'f1': 0.21628782, 'auroc': 0.90566}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    97   0   0   0   214    5   0    167
1    0   0   0    13   0   0   0  1295    2   0     22
2    0   0   0    78   0   0   0   143   10   0     81
3    0   0   0  7676   0   0   0   623    4   0    135
4    0   0   0    52   0   0   0    54   12   0    421
5    0   0   0   418   0   0   0    76   11   0     15
6    0   0   0   147   0   0   0   665  138   0    958
7    0   0   0   963   0   0   0  5973    1   0    326
8    0   0   0   855   0   0   0   422   32   0   1986
9    0   0   0   252   0   0   0   186   13   0     42
10   0   0   0    81   0   0   0    92    4   0  12616
---- Validation: 
scalar performance:
{'acc': 0.7029557, 'precision': 0.20244896, 'recall': 0.2478249, 'specificity': 0.96337557, 'f1': 0.21604571, 'auroc': 0.9064033}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    79   0   0   0   231    7   0    166
1    0   0   0    11   0   0   0  1296    0   0     25
2    0   0   0    82   0   0   0   138    7   0     85
3    0   0   0  7630   0   0   0   658    5   0    147
4    0   0   0    63   0   0   0    47   15   0    414
5    0   0   0   415   0   0   0    85    6   0     15
6    0   0   0   152   0   0   0   683  129   0    944
7    0   0   0   949   0   0   0  6010    0   0    306
8    0   0   0   840   0   0   0   417   31   0   2008
9    0   0   0   243   0   0   0   198   13   0     39
10   0   0   0    73   0   0   0   108    6   0  12609
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19708948, 'precision': 0.07702208, 'recall': 0.18190628, 'specificity': 0.9193517, 'f1': 0.06693127, 'auroc': 0.67425}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0   23   0   0   0  1006   8   0   133
1    0   0   0   21   0   0   0  1424   0   0    54
2    0   0   0   52   0   0   0   389   5   0   569
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    17   2   0  1614
5    0   0   0  239   0   0   0   302   9   0    42
6    0   0   0   75   0   0   0   249  24   0  2719
7    0   0   0   21   0   0   0  1131   0   0    12
8    0   0   0  188   0   0   0   326  41   0   815
9    0   0   0  142   0   0   0   851   5   0   139
10   0   0   0    1   0   0   0     0   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-22 10:22:28.759205,epoch time: 0:24:44.192163,used: 8:37:48.458163,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_01_44_40_seed_2_22562327
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 22562327 ON gpusrv66 CANCELLED AT 2024-07-22T10:26:41 ***
