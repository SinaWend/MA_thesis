Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 23:26:45 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326

 Experiment start at: 2024-07-20 23:54:31.140180
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.52405286, 'precision': 0.20212486, 'recall': 0.17565031, 'specificity': 0.9388751, 'f1': 0.15781863, 'auroc': 0.6676812}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    52   0   0   1    96    3   0    331
1    0   2   0   206   0   0   0   376    8   1    739
2    0   0   0    52   0   0   1    32    6   0    221
3    0   3   0  5062   0   0   5  1350  114   0   1906
4    0   0   0    73   0   0   3    33    9   0    421
5    0   0   0   229   0   0   0    36    7   0    249
6    0   0   0   151   0   0   6   168   29   0   1554
7    0   1   0  1659   0   0   3  2982   33   0   2583
8    0   0   0   756   0   0   8   319   68   0   2144
9    0   0   0   157   0   0   0    54    9   0    273
10   0   0   0   570   0   1  17   634  103   0  11467
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.52344525, 'precision': 0.16554427, 'recall': 0.17477806, 'specificity': 0.93876755, 'f1': 0.15638974, 'auroc': 0.6730733}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    45   0   0   2    96    2   0    338
1    0   0   0   188   0   0   2   401    7   0    734
2    0   0   0    50   0   0   0    41    3   0    218
3    1   3   0  5030   0   0   3  1325  124   0   1954
4    0   0   0    66   0   0   0    32    7   0    434
5    0   0   0   248   0   0   0    30   12   0    231
6    0   0   0   148   0   0   3   176   30   0   1551
7    0   2   0  1664   0   0   3  2969   48   0   2579
8    0   0   0   752   0   0   3   326   55   0   2160
9    0   0   0   147   0   1   0    53   10   0    282
10   0   0   0   580   0   1  14   602   87   0  11512
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.15007347, 'precision': 0.03841538, 'recall': 0.13011, 'specificity': 0.91325116, 'f1': 0.05305447, 'auroc': 0.5390638}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   0   0   4   0   0   0  324   0   0   842
1    0   0   0  60   0   0   0  606   0   0   833
2    0   0   0  62   0   0   0   45   0   0   908
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   3   0   0   0    6   0   0  1624
5    0   0   0  31   0   0   0   62   0   0   499
6    0   0   0   8   0   0   0   28   0   0  3031
7    0   0   0  11   0   0   0  509   0   0   644
8    0   0   0  24   0   0   0   36   0   0  1310
9    0   0   0  90   0   0   0  136   1   0   910
10   0   0   0   0   0   0   0   10   0   0  1636
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 00:27:52.736959,epoch time: 0:33:21.596779,used: 0:33:21.596779,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.62644476, 'precision': 0.31581676, 'recall': 0.2195245, 'specificity': 0.9528879, 'f1': 0.1992076, 'auroc': 0.8111009}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   1   0    69   0   0   3   110   1   0    299
1    0  34   0   172   0   0   3   757   3   0    363
2    0   1   0    85   0   0   1    33   1   0    191
3    0   1   0  6590   0   0   0  1196  51   0    601
4    0   0   0    82   0   0   1    13   7   0    436
5    0   1   0   394   0   0   0    17   3   0    106
6    0   1   0   192   0   0  33   125  18   0   1538
7    0   4   0  1905   0   0   2  4448  16   0    888
8    0   0   0  1016   0   0   3   222  73   0   1980
9    0   1   0   263   0   0   4    28   6   0    191
10   0   1   0   335   0   0  15   172  34   0  12236
---- Validation: 
scalar performance:
{'acc': 0.6264277, 'precision': 0.30825526, 'recall': 0.2194694, 'specificity': 0.95282376, 'f1': 0.19902965, 'auroc': 0.8121745}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    68   0   0   2   109   0   0    304
1    0  38   0   192   0   0   3   738   3   0    358
2    0   0   0    87   0   0   0    30   3   0    192
3    0   4   0  6613   0   0   0  1200  36   0    587
4    0   0   0    80   0   0   1    16   3   0    439
5    0   1   0   380   0   0   1    14   2   0    123
6    0   0   0   185   0   0  24   118  20   0   1561
7    0   6   0  1872   0   0   5  4454  19   0    909
8    0   0   0  1029   0   0   4   176  71   0   2016
9    0   1   0   251   0   0   1    32   3   0    205
10   0   0   0   328   0   0  17   186  46   0  12219
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18974324, 'precision': 0.03945566, 'recall': 0.17430156, 'specificity': 0.9178015, 'f1': 0.06357673, 'auroc': 0.628232}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0    2   0   0   0   648   0   0   520
1    0   0   0   32   0   0   0  1224   0   0   243
2    0   0   0   50   0   0   0   180   0   0   785
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    16   0   0  1615
5    0   0   0   72   0   0   0   201   0   0   319
6    0   0   0   10   0   0   0    71   0   0  2986
7    0   0   0    9   0   0   0  1072   0   0    83
8    0   0   0   39   0   0   0   118   0   0  1213
9    0   0   0  124   0   0   0   440   1   0   572
10   0   0   0    0   0   0   0     6   0   0  1640
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 01:00:12.256391,epoch time: 0:32:19.519432,used: 1:05:41.116211,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.66360766, 'precision': 0.35253024, 'recall': 0.25535795, 'specificity': 0.95787704, 'f1': 0.25212106, 'auroc': 0.87269515}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    3   0    79   0   0   13   100    2   0    286
1    0  267   0   122   0   0    3   737    3   0    200
2    0    5   0    92   0   0    6    27    9   0    173
3    0    6   0  6872   0   0    2  1122   98   0    337
4    0    0   0    75   0   0    5     8   10   0    441
5    0    3   0   415   0   0   11    13    9   0     70
6    0    5   0   170   0   0  153    86   34   0   1460
7    0   23   0  1675   0   0    3  4900   35   0    626
8    0    0   0   954   0   0    7   198  237   0   1898
9    0    4   0   276   0   0   24    26   11   0    152
10   0    1   0   220   0   0   40   114   46   0  12374
---- Validation: 
scalar performance:
{'acc': 0.66200346, 'precision': 0.35482973, 'recall': 0.25473386, 'specificity': 0.9576738, 'f1': 0.25114405, 'auroc': 0.87399}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    6   0    74   0   0    6   104    5   0    288
1    0  271   0   101   0   0    3   739    4   0    214
2    0    3   0   101   0   0    2    29    8   0    169
3    0    8   0  6845   0   0    3  1140   96   0    348
4    0    1   0    78   0   0    6    11   12   0    431
5    0    2   0   417   0   0   12    11    7   0     72
6    0    7   0   168   0   0  159    90   30   0   1454
7    0   23   0  1662   0   0    4  4905   22   0    649
8    0    0   0  1011   0   0    7   205  208   0   1865
9    0    5   0   280   0   0   11    28    6   0    163
10   0    2   0   217   0   0   37   131   48   0  12361
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19268173, 'precision': 0.12927514, 'recall': 0.17751858, 'specificity': 0.9182052, 'f1': 0.06282845, 'auroc': 0.67813134}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0    3   0   0   0   708   0   0   459
1    0   1   0   19   0   0   0  1306   0   0   173
2    0   0   0   39   0   0   0   226   0   0   750
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    2   0   0   0    13   0   0  1618
5    0   0   0   91   0   0   0   261   0   0   240
6    0   0   0    8   0   0   0    88   0   0  2971
7    0   0   0    6   0   0   0  1111   0   0    47
8    0   0   0   47   0   0   0   163   0   0  1160
9    0   0   0  108   0   0   0   574   1   0   454
10   0   0   0    0   0   0   0     4   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 01:32:06.595522,epoch time: 0:31:54.339131,used: 1:37:35.455342,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.69362694, 'precision': 0.52289104, 'recall': 0.29416743, 'specificity': 0.96204317, 'f1': 0.30008757, 'auroc': 0.90683174}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    9   0    73   0   0   22   123    0   0    256
1    0  524   0    38   0   0    3   668    3   0     96
2    0   10   0    78   0   0   15    41    8   0    159
3    0   12   0  6755   0   0    8  1307  133   0    222
4    0    0   0    68   0   0   14    16   12   0    429
5    0    2   0   421   0   2   31    12   14   0     39
6    0   14   0   130   0   0  364    96   32   0   1272
7    0   44   0  1194   0   0   11  5537   31   0    446
8    0    2   0   906   0   0   13   273  377   0   1725
9    0    7   0   266   0   1   46    43   13   2    114
10   0    4   0   163   0   0   59   165   39   0  12364
---- Validation: 
scalar performance:
{'acc': 0.69485086, 'precision': 0.404646, 'recall': 0.29439315, 'specificity': 0.96218693, 'f1': 0.30048484, 'auroc': 0.9055702}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    9   0    76   0   0   19   134    3   0    242
1    0  517   0    50   0   0    3   646    3   0    113
2    0   11   0    75   0   0   15    53   11   0    147
3    0   12   0  6733   0   0    7  1321  138   0    229
4    0    1   0    63   0   0   10    16   12   0    437
5    0    3   0   414   0   0   28    16   11   2     47
6    0   10   0   116   0   0  366   105   33   0   1278
7    0   42   0  1193   0   0    4  5574   31   0    421
8    0    0   0   839   0   0   19   290  409   0   1739
9    0   12   0   270   0   1   45    43   13   1    108
10   0    2   0   166   0   0   49   150   52   0  12377
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19443084, 'precision': 0.0641125, 'recall': 0.17952767, 'specificity': 0.91851676, 'f1': 0.06141015, 'auroc': 0.7043457}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   3   0    1   0   0   3   809   0   0   354
1    0   3   0   13   0   0   1  1377   0   0   105
2    0   0   0   25   0   0   0   314   0   0   676
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    0   0   0   0    28   0   0  1605
5    0   1   0  100   0   0   0   335   0   0   156
6    0   0   0    8   0   0   0   159   0   0  2900
7    0   1   0    3   0   0   0  1138   0   0    22
8    0   0   0   47   0   0   2   251   0   0  1070
9    0   2   0   70   0   0   1   760   0   0   304
10   0   0   0    0   0   0   0     8   0   0  1638
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 02:03:50.941793,epoch time: 0:31:44.346271,used: 2:09:19.801613,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.71484375, 'precision': 0.5872256, 'recall': 0.31958455, 'specificity': 0.9649752, 'f1': 0.3312938, 'auroc': 0.9233747}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    7   0    71   0   0   34   158    0   0    213
1    0  610   0    34   0   0    3   607    0   0     78
2    0    4   1    79   0   0   22    66   11   1    128
3    0    6   0  6799   0   0    7  1298  158   0    169
4    0    1   0    63   0   0   15    15   18   0    427
5    0    2   0   419   0   4   40    14   15   1     26
6    0   11   0   104   0   0  546   104   31   0   1112
7    0   28   0  1050   0   0    7  5817   38   1    322
8    0    4   0   839   0   0    7   352  596   0   1497
9    0    7   0   285   0   3   71    38   10   4     75
10   0    6   0   156   0   0   63   180   47   0  12341
---- Validation: 
scalar performance:
{'acc': 0.7157149, 'precision': 0.49553686, 'recall': 0.3196574, 'specificity': 0.96504545, 'f1': 0.33174896, 'auroc': 0.92180634}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    6   0    71   0   0   37   150    4   0    215
1    0  616   0    33   0   0    3   601    0   0     79
2    0    5   0    86   0   0   23    61    7   2    128
3    0    9   0  6840   0   1   13  1245  179   0    153
4    0    1   0    66   0   0   14    16   14   0    428
5    0    2   0   415   0   4   35    16   18   4     27
6    0    8   0   114   0   0  512   114   30   0   1130
7    0   35   0  1026   0   0   11  5805   37   0    351
8    0    3   0   821   0   0    6   342  614   0   1510
9    0    7   0   284   0   2   58    36   16   8     82
10   0    4   0   148   0   0   50   184   52   0  12358
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1947107, 'precision': 0.17575446, 'recall': 0.17980966, 'specificity': 0.9186359, 'f1': 0.06153549, 'auroc': 0.72154504}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   3   0    1   0   0  10   846   0   0   310
1    0   8   0   13   0   0   1  1392   0   0    85
2    0   0   0   22   0   0   1   373   0   0   619
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    40   0   0  1592
5    0   1   0  110   0   0   1   359   0   0   121
6    0   0   0    7   0   0   0   206   0   0  2854
7    0   1   0    3   0   0   0  1139   0   0    21
8    0   0   0   55   0   0   2   295   1   0  1017
9    0   2   0   71   0   0   1   840   0   0   223
10   0   0   0    1   0   0   0    10   0   0  1635
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 02:35:55.832211,epoch time: 0:32:04.890418,used: 2:41:24.692031,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.73969924, 'precision': 0.50549126, 'recall': 0.35740584, 'specificity': 0.96832514, 'f1': 0.36916202, 'auroc': 0.9330041}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   10   0    77   0   0   71   134    1   0    190
1    0  834   0    28   0   0    4   408    3   0     54
2    0    9   0    88   0   0   53    47   13   1    101
3    0   13   0  7108   0   1   12   968  223   0    114
4    0    1   0    68   0   0   26    13   22   0    409
5    0    2   0   406   0  13   51    11   15   3     20
6    0   14   0   100   0   0  793    72   32   0    897
7    0   67   0  1180   0   0   14  5645   56   0    302
8    0    2   0   812   0   0   22   282  883   0   1294
9    0    7   0   288   0   7   87    34   12   5     53
10   0    8   0   133   0   0   73   142   69   0  12366
---- Validation: 
scalar performance:
{'acc': 0.74224955, 'precision': 0.5134033, 'recall': 0.35995108, 'specificity': 0.9686352, 'f1': 0.37260383, 'auroc': 0.9334646}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   13   0    77   0   0   73   125    4   0    191
1    0  819   0    32   0   0    5   423    2   0     51
2    0    3   0   100   0   0   42    51   20   1     95
3    0   10   0  7130   0   0    9   950  229   0    112
4    0    2   0    63   0   0   29    20   21   0    404
5    0    2   0   419   0  10   46     6   20   3     15
6    0   11   0    94   0   1  830    78   29   0    865
7    0   52   0  1140   0   0   17  5663   55   0    338
8    0    1   0   763   0   0   24   276  947   0   1285
9    0   11   0   270   0   6   90    32   22   7     55
10   0    9   0   150   0   0   72   148   74   0  12343
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19988805, 'precision': 0.19077523, 'recall': 0.18361597, 'specificity': 0.91913974, 'f1': 0.0698488, 'auroc': 0.7372657}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   5   0    5   0   0  45   807   1   0   307
1    0  51   0   14   0   0   3  1343   0   0    88
2    0   2   0   36   0   0   2   337   1   0   637
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    29   0   0  1603
5    0   3   0  151   0   0   8   323   0   0   107
6    0   1   0    7   0   0  20   171   0   0  2868
7    0   4   0    4   0   0   0  1136   0   0    20
8    0   1   0   80   0   0   7   268   7   0  1007
9    0   6   0  109   0   0  10   783   0   0   229
10   0   0   0    1   0   0   0     2   0   0  1643
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 03:07:49.585754,epoch time: 0:31:53.753543,used: 3:13:18.445574,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7555383, 'precision': 0.5649567, 'recall': 0.3804561, 'specificity': 0.9705063, 'f1': 0.3963136, 'auroc': 0.94057053}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   15   0    60   0   1   85   140     4   0    177
1    0  879   0    19   0   0    2   384     3   0     45
2    0   10   1    70   0   1   46    53    27   5     99
3    0   13   0  6811   0   1   11  1204   304   0     95
4    0    1   1    59   0   0   23    21    34   0    400
5    0    0   0   384   0  32   47    11    26   7     14
6    0   20   0    71   0   0  867    89    31   0    830
7    0   58   0   770   0   1   12  6065    80   0    277
8    0    2   0   586   0   0   21   346  1193   0   1145
9    0    9   0   239   1  11  111    40    29  17     36
10   0    7   0    98   0   0   70   160    85   0  12374
---- Validation: 
scalar performance:
{'acc': 0.75656015, 'precision': 0.54364777, 'recall': 0.38193247, 'specificity': 0.97058576, 'f1': 0.3982207, 'auroc': 0.9392297}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   13   0    54   0   0   79   139     8   1    189
1    0  879   0    23   0   0    2   382     4   0     42
2    0    9   2    67   0   1   39    62    30   5     97
3    0   15   0  6876   0   6   16  1135   276   0    116
4    0    2   0    54   0   0   20    21    29   0    413
5    0    2   0   374   0  36   53    12    25  10      9
6    0   20   0    72   0   1  887    72    43   0    813
7    0   64   0   774   0   0   11  6052    82   0    282
8    0    2   0   599   0   0   19   347  1176   0   1153
9    0   15   3   246   0  13   97    39    21  15     44
10   0    4   0   112   0   0   65   168    86   0  12361
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20310642, 'precision': 0.19410333, 'recall': 0.1863212, 'specificity': 0.919433, 'f1': 0.07469148, 'auroc': 0.74637085}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   6   0    2   0   0  53   830   2   0   277
1    0  69   0    6   0   0   1  1345   0   0    78
2    0   3   0   21   0   0   5   390   1   0   595
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    36   0   0  1596
5    0   3   0  122   0   0   6   361   4   0    96
6    0   2   0    6   0   0  26   210   0   0  2823
7    0   9   0    3   0   0   0  1133   0   0    19
8    0   1   0   54   0   0   7   315  33   0   960
9    0   6   0   69   0   0  16   856   1   0   189
10   0   0   0    1   0   0   0     3   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-21 03:39:36.363344,epoch time: 0:31:46.777590,used: 3:45:05.223164,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.76731056, 'precision': 0.5725916, 'recall': 0.40069243, 'specificity': 0.97202206, 'f1': 0.4215383, 'auroc': 0.9458414}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0   12   0    48   0   1  102   146     2   0    172
1    0  892   0    23   0   1    2   379     2   0     33
2    0    5   1    65   1   6   62    62    17   5     88
3    0   14   0  6865   0   3   18  1141   301   0     95
4    0    1   0    46   0   1   33    25    24   0    409
5    0    1   0   359   0  70   51    10    13   9      8
6    0   17   0    54   0   1  987    93    40   1    715
7    0   48   0   663   1   2   16  6181    77   0    277
8    0    2   0   566   0   0   20   370  1263   0   1075
9    0    6   1   214   0  36  112    46    14  33     31
10   1    2   0    96   0   0   69   167    67   1  12387
---- Validation: 
scalar performance:
{'acc': 0.7662966, 'precision': 0.67220604, 'recall': 0.40029937, 'specificity': 0.9718404, 'f1': 0.42293146, 'auroc': 0.9470048}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    2    7   0    56   0   0   96   139     3   0    180
1    0  880   0    15   0   0    4   389     2   0     42
2    0    4   2    64   0   2   55    69    17  11     88
3    0    6   0  6868   0   9   11  1139   303   0    104
4    0    3   0    58   0   0   28    21    32   0    397
5    0    0   0   359   0  63   44    14    17  17      7
6    0   15   0    63   0   1  999    79    19   0    732
7    0   42   0   708   0   0   16  6146    68   1    284
8    0    2   0   558   0   1   24   364  1261   1   1085
9    0    9   0   237   1  30   93    38    14  38     33
10   1    5   0    81   0   0   75   170    75   0  12389
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20548521, 'precision': 0.2906445, 'recall': 0.18788263, 'specificity': 0.91961455, 'f1': 0.07771, 'auroc': 0.7544717}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   5   0    2   0   0  86   820   2   0   255
1    0  71   0    6   0   0   3  1348   0   0    71
2    0   2   0   22   0   0  10   397   1   0   583
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0    1   0   0   0    37   0   0  1595
5    0   2   0  126   0   2  19   355   3   0    85
6    0   2   0    6   0   0  50   214   1   0  2794
7    0   8   0    3   0   0   0  1135   0   0    18
8    0   1   0   59   0   0  17   321  37   0   935
9    0   6   0   65   0   0  28   854   1   0   183
10   0   0   0    1   0   0   0     3   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-21 04:11:43.074948,epoch time: 0:32:06.711604,used: 4:17:11.934768,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.775899, 'precision': 0.68413156, 'recall': 0.41104335, 'specificity': 0.9730871, 'f1': 0.4349813, 'auroc': 0.95088184}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    5    8   0    75   0   0    96   137     3   0    159
1    0  931   0    18   0   0     2   348     1   0     32
2    0    4   6    88   4   3    61    55    11  12     68
3    0    9   0  7311   0   2    11   826   210   1     67
4    0    0   0    68   2   0    38    20    25   0    386
5    0    0   0   385   0  59    36     5    12  17      7
6    0   19   0    81   0   2  1059    92    22   0    632
7    0   43   0   931   0   1    13  6001    59   0    217
8    0    1   0   735   0   2    19   321  1256   1    961
9    1    6   4   254   3  23    95    27    16  41     23
10   0    1   0   125   0   0    70   181    85   0  12329
---- Validation: 
scalar performance:
{'acc': 0.7761669, 'precision': 0.7031565, 'recall': 0.40759185, 'specificity': 0.97307825, 'f1': 0.42931068, 'auroc': 0.9482978}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    6    8   0    79   0   0   100   124     0   0    166
1    0  916   0    22   0   0     6   348     6   0     34
2    0    8   2    85   2   0    56    58    13   8     80
3    0    7   0  7316   0   7    14   800   217   0     79
4    0    2   0    70   2   0    31    23    27   1    383
5    0    1   0   370   0  55    46     6    18  19      6
6    0   15   0    98   0   1  1067    72    33   0    622
7    0   42   0   901   0   1    10  6031    51   0    229
8    0    2   0   722   0   0    20   310  1246   2    994
9    0    5   1   251   1  23   115    29    11  34     23
10   1    5   0   145   0   1    65   183    54   0  12342
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20975302, 'precision': 0.30895153, 'recall': 0.19044203, 'specificity': 0.9201393, 'f1': 0.08385582, 'auroc': 0.7623213}
confusion matrix:
    0   1   2    3   4   5    6     7   8   9     10
0    0   6   0    7   0   0  116   828   0   0   213
1    0  91   0   10   0   0    3  1329   0   0    66
2    0   1   0   35   0   0   17   417   1   0   544
3    0   0   0    0   0   0    0     0   0   0     0
4    0   0   0    1   0   0    1    40   0   0  1591
5    0   2   0  183   0   2   28   316   0   0    61
6    0   2   0   12   0   0   88   238   1   0  2726
7    0  10   0    6   0   0    0  1133   0   0    15
8    0   1   0  106   0   0   25   317  46   0   875
9    0   6   0  114   0   0   36   831   1   0   149
10   0   0   0    1   0   0    1     6   0   0  1638
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-21 04:43:41.114527,epoch time: 0:31:58.039579,used: 4:49:09.974347,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.78384525, 'precision': 0.6719073, 'recall': 0.42508948, 'specificity': 0.9741271, 'f1': 0.44853774, 'auroc': 0.95338374}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    9    9   0    68   0   0   115   117     4   0    160
1    0  967   0    24   0   0     2   307     3   1     28
2    0    8   6    77   1   4    59    60    12   7     78
3    0   10   0  7175   0   4    11   879   295   0     66
4    0    1   0    52   0   1    53    21    31   0    380
5    0    0   0   342   0  77    51     7    15  22      7
6    0   14   0    72   0   2  1122    82    24   3    587
7    0   47   0   772   0   1    14  6119    61   0    251
8    0    3   0   610   0   1    27   317  1389   1    947
9    1    2   3   225   0  39   100    38    14  46     25
10   0    6   0    89   0   1    81   157    70   0  12387
---- Validation: 
scalar performance:
{'acc': 0.7851277, 'precision': 0.68204844, 'recall': 0.4287821, 'specificity': 0.9743333, 'f1': 0.45266157, 'auroc': 0.95230454}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   12   12   0    64   0   1   104   137     3   0    150
1    0  965   0    19   0   0     2   308     2   0     36
2    0    7   7    63   1   7    58    59    17  12     81
3    0   11   0  7211   0   8    13   867   262   1     67
4    0    2   1    61   0   0    42    15    32   0    386
5    0    0   0   347   0  87    43     7    10  21      6
6    0   14   0    61   0   3  1144    81    27   1    577
7    0   59   0   782   0   0    17  6097    77   1    232
8    0    1   0   610   0   1    28   347  1421   0    888
9    0    4   2   224   0  38   112    33    10  43     27
10   0    8   0    94   0   0    87   160    82   0  12365
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21758904, 'precision': 0.39345306, 'recall': 0.19609866, 'specificity': 0.9207318, 'f1': 0.095238194, 'auroc': 0.76765704}
confusion matrix:
    0    1   2    3   4   5    6     7   8   9     10
0    1   13   0    6   0   0  150   774   2   0   224
1    0  142   0    9   0   0    4  1274   0   0    70
2    0    7   0   26   0   0   28   379   1   0   574
3    0    0   0    0   0   0    0     0   0   0     0
4    0    0   0    1   0   0    1    34   0   0  1597
5    0    3   0  167   0   2   44   308   1   0    67
6    0    2   0   10   0   0  124   190   3   0  2738
7    0   19   0    5   0   0    0  1122   0   0    18
8    0    1   0   89   0   0   37   292  77   0   874
9    0    9   0   95   0   0   62   804   1   0   166
10   0    0   0    1   0   0    1     2   0   0  1642
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-21 05:15:40.805668,epoch time: 0:31:59.691141,used: 5:21:09.665488,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.7958048, 'precision': 0.69087327, 'recall': 0.45469344, 'specificity': 0.97569007, 'f1': 0.4876169, 'auroc': 0.9560195}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   30    9   0    70   0    1   106   113     3   0    151
1    0  985   0    17   0    0     2   296     1   0     31
2    0    2  12    59   9    3    57    61    19  24     66
3    0    8   0  7189   0    7    11   838   322   2     62
4    0    2   0    49   2    0    44    20    45   2    375
5    1    0   1   310   1  104    30     8    22  39      4
6    0   11   0    73   0    1  1174    71    33   2    542
7    0   41   0   738   1    1    11  6165    77   2    227
8    0    2   0   527   0    1    17   307  1620   2    817
9    3    4   7   210   0   37    80    26    18  90     18
10   0    6   0    83   0    1    78   147   107   0  12373
---- Validation: 
scalar performance:
{'acc': 0.7931791, 'precision': 0.70925593, 'recall': 0.4504686, 'specificity': 0.97535485, 'f1': 0.482934, 'auroc': 0.9555987}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   33   15   0    67   0   0   103   116     3   0    146
1    0  983   0    16   0   0     1   291     5   0     36
2    0    5  11    51   4   6    61    64    21  23     66
3    0    7   0  7186   0   8    10   832   332   1     64
4    0    2   1    46   3   1    43    24    35   1    383
5    0    0   0   329   0  86    31     5    16  50      4
6    0   13   0    63   0   2  1137    70    42   1    580
7    0   44   0   763   0   0    14  6113    87   0    244
8    0    1   0   513   1   1    17   307  1629   3    824
9    0    2   5   205   3  35    78    30    20  95     20
10   0    4   0    92   0   0    73   134   115   1  12377
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22164696, 'precision': 0.39881176, 'recall': 0.19968481, 'specificity': 0.9211314, 'f1': 0.101188675, 'auroc': 0.7730012}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    1   12   0    6   0   0  163   760    2   0   226
1    0  132   0    9   0   0    7  1282    0   0    69
2    0    3   0   26   0   0   28   375    3   0   580
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    33    0   0  1598
5    0    2   0  178   0   3   46   298    3   0    62
6    0    1   0   10   0   0  137   186    3   0  2730
7    0   14   0    6   0   0    0  1128    0   0    16
8    0    1   0   83   0   0   32   289  125   0   840
9    0    8   0   98   0   0   65   795    1   0   170
10   0    0   0    1   0   0    1     2    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-21 05:47:32.986033,epoch time: 0:31:52.180365,used: 5:53:01.845853,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.80227953, 'precision': 0.7144147, 'recall': 0.46377137, 'specificity': 0.97664624, 'f1': 0.49173284, 'auroc': 0.9570932}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   23    13   0    71   0    1   108   118     5   0    144
1    0  1041   0    18   0    0     2   244     4   1     22
2    0     9  16    62   2    7    58    46    26  18     68
3    0     5   0  7236   1   10    10   776   355   1     44
4    0     0   0    54   3    1    42    20    53   0    365
5    0     1   0   304   0  126    34     2    26  26      2
6    0    15   0    49   0    2  1187    67    48   1    539
7    0    68   0   729   0    3    14  6133   111   2    202
8    0     3   0   474   0    1    15   297  1825   3    678
9    1     4   6   194   4   65    84    27    20  65     23
10   0     2   0    93   0    1    76   153   137   0  12331
---- Validation: 
scalar performance:
{'acc': 0.8025679, 'precision': 0.72594684, 'recall': 0.4679137, 'specificity': 0.97666204, 'f1': 0.49945876, 'auroc': 0.9578595}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   27    10   0    75   0    2   102   120     3   0    144
1    0  1034   0    15   0    0     1   250     5   0     27
2    0     6  25    57   4   11    50    55    28  18     58
3    0    10   0  7239   0    7    13   755   352   1     63
4    0     2   1    45   2    1    47    23    50   0    368
5    0     0   0   303   0  132    29     2    27  24      4
6    0    18   0    47   0    2  1178    69    62   1    531
7    0    67   0   740   0    0    10  6148   106   0    194
8    0     2   0   490   0    3    16   277  1814   0    694
9    1     7   8   195   0   59    81    31    20  70     21
10   0     5   0    71   0    1    77   161   146   0  12335
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2360596, 'precision': 0.3880427, 'recall': 0.21163306, 'specificity': 0.9225506, 'f1': 0.12213948, 'auroc': 0.7786039}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    1   32   0    7   0   0  193   739    2   0   196
1    0  224   0   11   0   0    7  1194    0   0    63
2    0   10   0   30   0   0   34   376    5   0   560
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    33    0   0  1597
5    0    7   0  194   0  10   54   272    5   0    50
6    0    4   0   10   0   0  183   191    6   0  2673
7    0   25   0    6   0   0    0  1118    0   0    15
8    0    2   0   90   0   0   43   277  196   0   762
9    0   14   0  112   0   1   78   776    1   0   155
10   0    0   0    1   0   0    1     2    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-21 06:19:41.819960,epoch time: 0:32:08.833927,used: 6:25:10.679780,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.80562395, 'precision': 0.7013665, 'recall': 0.4723573, 'specificity': 0.97700405, 'f1': 0.50316596, 'auroc': 0.9586118}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   36     7   0    57   0    1   123   107     4   1    147
1    0  1037   0    16   0    0     6   250     7   0     16
2    0     2  13    59   7    5    75    42    22  25     62
3    0     7   0  7297   0    8    15   716   315   0     78
4    0     2   1    52   3    0    64    17    39   2    359
5    0     1   0   294   0  124    29     4    19  46      4
6    0    15   0    51   0    4  1255    67    33   0    483
7    0    37   1   729   0    4    19  6158   101   0    215
8    0     3   1   490   0    2    33   310  1716   3    737
9    2     5   6   186   1   55    83    17    17  98     22
10   1     7   0    77   0    1    86   120   126   2  12374
---- Validation: 
scalar performance:
{'acc': 0.8024609, 'precision': 0.69757783, 'recall': 0.46835512, 'specificity': 0.9766051, 'f1': 0.5004232, 'auroc': 0.95882505}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   39     9   0    71   0    2   108   103     3   2    146
1    0  1021   0    20   0    0     3   254     7   0     27
2    0     1  17    56   3    6    64    46    21  26     72
3    1    10   0  7256   1   11    17   750   342   0     52
4    0     0   2    41   2    2    58    22    45   2    365
5    0     0   0   307   0  118    27     3    15  45      6
6    0    13   0    58   0    2  1226    58    44   1    506
7    0    42   1   701   0    2    14  6164   104   2    235
8    0     1   0   513   0    1    27   288  1711   3    752
9    1     6  12   180   0   55    85    21    18  91     24
10   0     3   1    72   0    0    89   144   131   1  12355
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24032743, 'precision': 0.3976274, 'recall': 0.21241981, 'specificity': 0.9228139, 'f1': 0.12385291, 'auroc': 0.782495}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    6   23   0    8   0   0  260   689    2   0   182
1    0  207   0   11   0   0   12  1201    0   0    68
2    0    6   0   28   0   0   50   361    3   0   567
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    31    0   0  1600
5    0    3   0  201   0  10   74   250    4   0    50
6    0    2   0    8   0   0  277   172    3   0  2605
7    0   19   0    7   0   0    0  1123    0   0    15
8    0    1   0   95   0   0   63   264  168   0   779
9    0   11   0  108   0   1  103   750    1   0   163
10   0    0   0    1   0   0    1     0    0   0  1644
new oracle model saved
early stop counter: 1
val acc:0.8024609088897705, best validation acc: 0.8025678992271423, corresponding to test acc:                         0.23605960607528687 / 0.24032743275165558
after epoch: 13,now: 2024-07-21 06:51:41.331067,epoch time: 0:31:59.511107,used: 6:57:10.190887,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.81049335, 'precision': 0.7147102, 'recall': 0.48433322, 'specificity': 0.97770864, 'f1': 0.5192498, 'auroc': 0.96104276}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   56     7   0    59   0    0   105   111     8    0    137
1    0  1039   0    20   0    0     3   239     8    0     23
2    0     3  18    57  12    6    60    54    24   26     52
3    0     7   0  7195   0   11    13   783   370    5     52
4    1     2   0    42   8    1    48    15    66    4    352
5    0     0   2   296   1  117    27     5    17   48      8
6    2    13   0    45   0    1  1269    59    51    1    467
7    0    46   0   632   1    0    11  6238   116    0    219
8    0     4   0   445   0    1    24   290  1905    0    627
9    3     7   8   181   2   45    82    29    14  106     16
10   0     2   0    77   1    0    80   133   158    0  12342
---- Validation: 
scalar performance:
{'acc': 0.8099773, 'precision': 0.7031815, 'recall': 0.48059458, 'specificity': 0.977606, 'f1': 0.5132763, 'auroc': 0.962128}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   41     8   0    63   0    0   111   111     5    2    142
1    0  1035   0    17   0    0     2   251     5    2     20
2    0     5  15    56  13    2    60    43    20   34     64
3    0     7   0  7218   0    9    18   777   362    1     48
4    0     0   2    37   8    0    53    25    55    5    354
5    1     0   1   295   0  118    28     4    16   53      5
6    2    13   0    55   0    1  1251    56    44    1    485
7    1    51   0   629   0    2     7  6251   112    1    211
8    0     2   0   472   0    2    23   265  1876    2    654
9    3     6   7   179   3   43    74    30    14  113     21
10   2     5   0    79   0    1    76   127   149    2  12355
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24802351, 'precision': 0.3959512, 'recall': 0.21870722, 'specificity': 0.92359436, 'f1': 0.13359058, 'auroc': 0.78633076}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   13   24   0    9   0   0  260   694    3   0   167
1    0  230   0   10   0   0    9  1188    0   0    62
2    0    6   0   26   0   0   53   371    5   0   554
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    33    1   0  1597
5    0    4   0  195   0   8   74   255    8   0    48
6    0    2   0    8   0   0  299   183    5   0  2570
7    0   21   0    6   0   0    0  1123    0   0    14
8    0    1   0   87   0   0   66   263  230   0   723
9    0   13   0  104   0   1  104   762    1   0   152
10   0    0   0    1   0   0    1     2    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-21 07:23:46.351020,epoch time: 0:32:05.019953,used: 7:29:15.210840,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8116706, 'precision': 0.7382424, 'recall': 0.4902531, 'specificity': 0.97784984, 'f1': 0.5244825, 'auroc': 0.9633765}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   45     4   0    56   0    2   126   115     4    1    129
1    0  1033   0    10   0    0     5   257     5    0     22
2    0     4  21    43   6    7    68    54    20   29     60
3    0     4   0  7182   0   20    17   835   318    1     61
4    0     1   0    38  13    1    68    23    44    4    347
5    0     0   0   269   0  154    29     6    15   45      3
6    0    12   0    42   1    2  1318    71    38    2    421
7    0    40   0   582   1    2    24  6324    85    1    203
8    0     4   0   422   0    4    36   340  1774    6    710
9    3     3   9   162   1   59    86    27    17  108     18
10   1     5   1    53   1    1   114   145   107    1  12365
---- Validation: 
scalar performance:
{'acc': 0.8103517, 'precision': 0.72122765, 'recall': 0.48781267, 'specificity': 0.9777484, 'f1': 0.51947886, 'auroc': 0.9626777}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   47    10   1    54   0    2   141   102     5   0    121
1    0  1020   0    13   0    0     9   260     5   0     25
2    0     6  20    43   5   11    69    49    18  33     58
3    0     4   0  7108   1   19    18   888   345   1     56
4    0     3   2    39   6    4    69    25    41   3    347
5    0     0   0   267   0  161    30     4    13  44      2
6    1    13   0    42   0    1  1310    73    35   1    432
7    1    41   0   528   1    2    28  6381    82   0    201
8    2     2   0   415   0    5    42   329  1800   4    697
9    3     3   4   161   0   76    85    30    12  99     20
10   0     3   1    66   0    1    96   158   127   1  12343
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25718883, 'precision': 0.4071916, 'recall': 0.22137667, 'specificity': 0.9242476, 'f1': 0.13714492, 'auroc': 0.79033774}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   11   19   0    7   0   0  336   661    3   0   133
1    0  206   0    6   0   0   17  1212    0   0    58
2    0    4   0   22   0   0   91   374    4   0   520
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    35    1   0  1595
5    0    3   0  169   0  14  101   255    5   0    45
6    0    2   0    7   0   0  482   174    2   0  2400
7    0   17   0    2   0   0    5  1127    0   0    13
8    0    1   0   76   0   0  115   276  195   0   707
9    0    8   0   81   0   1  146   762    1   0   138
10   0    0   0    1   0   0    2     2    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-21 07:55:33.820269,epoch time: 0:31:47.469249,used: 8:01:02.680089,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8184129, 'precision': 0.7200098, 'recall': 0.50685346, 'specificity': 0.978627, 'f1': 0.5459148, 'auroc': 0.96311605}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   80    15   1    63   0    1    94    90     5    1    133
1    0  1084   0    14   0    0     4   202     8    1     19
2    1     9  26    44  12    6    50    51    17   31     65
3    2     6   0  7330   0   17    12   696   318    4     54
4    0     1   4    39  16    1    53    20    57    5    343
5    1     0   2   274   0  150    20     5    16   49      4
6    0    19   0    46   0    2  1279    68    39    4    450
7    1    52   1   665   0    2    11  6224    97    0    211
8    0     6   0   458   0    5    21   275  1932    3    596
9    5     5  15   167   3   55    62    28    13  122     18
10   2     7   0    66   2    0    76   148   142    1  12346
---- Validation: 
scalar performance:
{'acc': 0.8169052, 'precision': 0.7376534, 'recall': 0.5087878, 'specificity': 0.97851926, 'f1': 0.5477428, 'auroc': 0.96494436}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   73    11   0    64   0    1   103    89     6    1    135
1    0  1080   0    18   0    0     3   206     7    0     18
2    3     4  35    43  10   11    54    55    21   32     44
3    0    15   0  7330   0   17    15   672   344    4     43
4    0     3   3    37  16    4    50    24    49    3    350
5    1     0   1   271   0  147    21     6    24   47      3
6    1    21   0    49   0    1  1291    59    46    4    436
7    1    77   0   700   0    2    19  6179    89    3    195
8    0     2   0   457   0    5    20   299  1923    2    588
9    3     4  10   163   2   68    44    28    19  132     20
10   0     9   1    84   1    1    66   147   151    2  12334
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2721612, 'precision': 0.40035695, 'recall': 0.23629904, 'specificity': 0.9258995, 'f1': 0.16216299, 'auroc': 0.7941324}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   53   50   0    9   0   0  297   611    3   0   147
1    1  368   0   15   0   0   12  1046    0   0    57
2    0   15   0   29   0   0   74   343    6   0   548
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    30    1   0  1599
5    1    7   0  218   0  13   93   211    7   0    42
6    0    5   0    9   0   0  442   162    6   0  2443
7    0   30   0    7   0   0    4  1110    0   0    13
8    0    2   0   97   0   0   92   245  262   0   672
9    0   21   0  112   0   1  128   724    1   0   150
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-21 08:27:19.766403,epoch time: 0:31:45.946134,used: 8:32:48.626223,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.81969714, 'precision': 0.75121343, 'recall': 0.5097724, 'specificity': 0.9787093, 'f1': 0.5493492, 'auroc': 0.96519995}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   69    13   0    61   0    2   105    85     3    4    141
1    0  1078   1    15   0    0     0   209     5    0     24
2    1     5  31    54  12    5    50    40    10   47     56
3    0     3   1  7475   0   16    14   627   251    3     45
4    0     1   3    49  20    0    55    20    43    4    344
5    1     0   0   267   0  131    12     3    16   85      6
6    2    25   0    56   0    1  1305    53    35    1    430
7    0    49   0   729   0    3    11  6189    78    2    204
8    0     3   0   540   0    4    28   282  1795    4    639
9    2     5   7   160   1   44    56    19    17  164     18
10   0     5   0    71   1    0    87   122   122    6  12380
---- Validation: 
scalar performance:
{'acc': 0.81896484, 'precision': 0.7430263, 'recall': 0.5107449, 'specificity': 0.9785781, 'f1': 0.5508691, 'auroc': 0.96397054}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   76    10   0    72   0    0    92    85     3    1    144
1    0  1073   0    19   0    0     3   213     6    1     17
2    1     6  25    54   6    4    52    45    11   47     61
3    0     7   0  7445   0   13    17   640   263    4     51
4    0     0   8    46  19    2    48    16    44    7    349
5    1     1   0   274   0  141    15     3    12   71      3
6    0    17   0    54   0    2  1313    56    34    2    430
7    0    60   1   737   1    1    18  6161    80    1    205
8    0     4   1   533   0    4    16   272  1788    6    672
9    1     5  10   162   4   48    52    19    10  167     15
10   1     4   1    76   2    0    80   118   102    3  12409
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26957253, 'precision': 0.40399015, 'recall': 0.2318927, 'specificity': 0.9256472, 'f1': 0.15627524, 'auroc': 0.7961586}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   45   38   0   10   0   0  322   611    3   0   141
1    1  329   0   18   0   0   13  1079    0   0    59
2    0    9   0   35   0   0   88   335    4   0   544
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    30    1   0  1599
5    1    4   0  247   0  12   96   192    4   0    36
6    0    4   0   13   0   0  497   161    4   0  2388
7    0   26   0   10   0   0    3  1112    0   0    13
8    0    2   0  131   0   0  101   232  216   0   688
9    0   16   0  135   0   1  141   695    1   0   148
10   0    0   0    1   0   0    2     1    0   0  1642
better model found
persisted
after epoch: 17,now: 2024-07-21 08:59:17.053887,epoch time: 0:31:57.287484,used: 9:04:45.913707,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8211419, 'precision': 0.71586764, 'recall': 0.51701444, 'specificity': 0.9789636, 'f1': 0.55820894, 'auroc': 0.96614903}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   94     9   0    46   1    2    92    94     3    2    140
1    0  1068   0    14   0    0     2   225     4    1     18
2    3     4  40    38  10    4    53    45    14   43     58
3    2     9   0  7343   1   18    19   694   303    2     44
4    0     1  10    42  19    3    66    17    40    3    338
5    3     0   1   258   1  171    22     1    16   46      2
6    2    14   0    51   1    3  1328    57    33    2    416
7    1    51   1   617   3    2    22  6265    99    1    203
8    1     2   1   468   0    4    28   284  1859    4    643
9    9     2  17   159   0   78    63    22    11  117     15
10   3     6   0    66   2    2    77   144   106    2  12387
---- Validation: 
scalar performance:
{'acc': 0.824903, 'precision': 0.74059343, 'recall': 0.5273746, 'specificity': 0.9793604, 'f1': 0.5716764, 'auroc': 0.96648455}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   106     7   1    51   1    1    96    86     6    2    126
1     0  1071   0    12   0    0     3   221     4    0     21
2     3     5  44    49  12    9    47    40    10   39     54
3     0     8   0  7370   0   19    11   696   291    3     42
4     0     1  11    36  18    2    61    24    39    7    340
5     3     0   2   257   0  167    19     2    16   52      3
6     4    15   0    43   0    3  1339    64    31    1    408
7     2    53   0   591   0    2    12  6304    88    0    213
8     1     1   0   455   0    5    23   276  1884    1    650
9    10     1   7   143   0   63    58    27    17  148     19
10    2     5   0    72   2    1    84   135   106    1  12388
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28153643, 'precision': 0.40621817, 'recall': 0.24067385, 'specificity': 0.92671543, 'f1': 0.17004132, 'auroc': 0.7990083}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   92   34   0    9   0   0  322   580    3   0   130
1    1  330   0   14   0   0   16  1079    0   0    59
2    0    7   0   28   0   0  102   334    5   0   539
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    2    29    1   0  1600
5    3    4   0  225   0  14  112   192    6   0    36
6    0    4   0    7   0   0  586   152    5   0  2313
7    0   25   0    7   0   0    7  1112    0   0    13
8    0    1   0  101   0   0  119   241  248   0   660
9    2   16   0  111   0   1  166   698    1   0   142
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-21 09:31:14.618888,epoch time: 0:31:57.565001,used: 9:36:43.478708,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8272153, 'precision': 0.74347776, 'recall': 0.52867866, 'specificity': 0.97976476, 'f1': 0.5708643, 'auroc': 0.96744055}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   85     9   1    52   0    3   118    82     4    3    126
1    0  1074   0    14   0    0     3   216     7    1     17
2    3     6  55    41   8    9    56    43    15   26     50
3    1     6   3  7374   1   25    16   661   315    0     34
4    1     0   6    32  22    0    70    20    54    5    329
5    2     0   2   253   0  168    20     4    16   51      4
6    0    11   0    36   0    2  1385    59    37    2    375
7    1    62   2   589   0    1    14  6305    95    2    194
8    0     1   0   444   0    5    19   270  1952    2    602
9    6     2  16   151   2   69    58    28    17  131     13
10   2     4   0    63   3    0    88   138   127    2  12367
---- Validation: 
scalar performance:
{'acc': 0.8269627, 'precision': 0.7331923, 'recall': 0.5271046, 'specificity': 0.97973233, 'f1': 0.56868863, 'auroc': 0.96755326}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   83    12   0    53   0    3   107    85     8    3    129
1    0  1080   0    12   0    0     7   217     6    0     10
2    1     4  59    46  12    6    42    38    14   36     54
3    0     8   0  7393   0   11    17   653   309    1     48
4    0     1   8    46  21    3    71    15    41    3    330
5    1     0   5   254   1  167    18     1    16   56      2
6    2    15   0    42   2    1  1380    56    39    2    369
7    0    51   3   612   2    4    20  6296    90    1    186
8    0     3   0   411   1    3    39   288  1948    3    600
9    4     3  26   161   1   72    55    23    17  120     11
10   1     2   0    64   0    1    92   156   110    1  12369
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28839293, 'precision': 0.4087429, 'recall': 0.2428678, 'specificity': 0.92731124, 'f1': 0.17147261, 'auroc': 0.80149853}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   55   35   0    9   0   0  372   577    3   0   119
1    1  340   0   15   0   0   21  1066    0   0    56
2    0    6   0   29   0   0  116   335    5   0   524
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    2    30    1   0  1599
5    1    4   0  232   0  13  121   180    7   0    34
6    0    4   0    8   0   0  688   153    7   0  2207
7    0   23   0    7   0   0    9  1112    0   0    13
8    0    1   0  100   0   0  136   244  272   0   617
9    1   15   0  109   0   1  186   692    1   0   132
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-21 10:03:17.504731,epoch time: 0:32:02.885843,used: 10:08:46.364551,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.82659996, 'precision': 0.74949276, 'recall': 0.53141934, 'specificity': 0.9795579, 'f1': 0.5765592, 'auroc': 0.9679448}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   107     5   0    62   0    1    78    72     6    7    145
1     1  1066   0    14   0    0     2   220     8    0     21
2     0     2  47    47  11    4    46    36    15   53     51
3     1     7   1  7393   0   15    22   647   295    6     50
4     0     1   5    35  27    1    43    16    48    8    355
5     2     0   0   259   0  136    13     2    13   93      3
6     4    19   0    43   0    1  1309    60    38    1    433
7     2    40   1   624   1    0    18  6270   103    5    199
8     1     2   0   438   1    3    19   275  1946    5    606
9     3     1  17   146   1   48    39    14    24  185     14
10    1     5   0    59   4    1    68   117   127    2  12409
---- Validation: 
scalar performance:
{'acc': 0.8264812, 'precision': 0.72972924, 'recall': 0.5264334, 'specificity': 0.97952664, 'f1': 0.5686159, 'auroc': 0.9665441}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   100     8   0    64   1    0    82    82     5    5    136
1     0  1082   0    13   0    0     2   206     4    0     25
2     5     3  39    43  14    3    46    43    20   50     46
3     1     7   1  7425   0   12    12   609   313    4     56
4     0     3   4    33  19    2    45    20    41   12    360
5     1     0   2   258   0  135    12     4    19   85      5
6     3    13   0    33   0    0  1315    53    44    6    441
7     0    48   1   620   0    3    10  6268    98    3    214
8     0     1   2   444   1    2    31   261  1931    7    616
9     5     4  21   154   2   40    43    17    13  180     14
10    1     5   0    54   3    1    63   131   131    3  12404
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28377527, 'precision': 0.40724057, 'recall': 0.24428058, 'specificity': 0.9270544, 'f1': 0.17579256, 'auroc': 0.8013449}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   95   38   0   11   0   0  302   566    4   0   154
1    1  376   0   20   0   0   12  1026    0   0    64
2    0    9   0   31   0   0   85   314    5   0   571
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    1    23    1   0  1607
5    4    4   0  259   0  12   98   164    8   0    43
6    0    4   0   10   0   0  534   137    6   0  2376
7    0   25   0    8   0   0    6  1111    0   0    14
8    0    1   0  110   0   0  101   223  285   0   650
9    1   17   0  129   0   1  142   682    1   0   164
10   0    0   0    1   0   0    2     0    0   0  1643
early stop counter: 1
val acc:0.8264812231063843, best validation acc: 0.8269627094268799, corresponding to test acc:                         0.28839293122291565 / 0.28839293122291565
after epoch: 20,now: 2024-07-21 10:35:17.793854,epoch time: 0:32:00.289123,used: 10:40:46.653674,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8330479, 'precision': 0.7426195, 'recall': 0.53995395, 'specificity': 0.9804357, 'f1': 0.5868664, 'auroc': 0.96815234}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   114     5   0    56   0    0    95    70     4    4    135
1     0  1074   0    16   0    0     4   219     5    1     13
2     1     2  54    43  15    9    48    36    15   33     56
3     0     3   0  7477   1   13    12   615   273    4     40
4     0     1   7    37  34    2    62    21    48    5    322
5     5     0   2   245   1  174    14     6    16   54      4
6     4    14   0    49   1    5  1379    49    40    3    363
7     1    46   0   607   2    1    17  6343    88    1    156
8     0     1   0   467   2    3    38   284  1940    3    558
9     8     1  27   151   3   63    58    16    15  141     10
10    2     1   1    66   2    1    78   114   122    0  12406
---- Validation: 
scalar performance:
{'acc': 0.83017254, 'precision': 0.73376846, 'recall': 0.5394658, 'specificity': 0.9801147, 'f1': 0.5841697, 'auroc': 0.96869236}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   106     9   0    47   1    3    93    82     3    1    138
1     1  1081   0    17   0    0     5   204     3    0     21
2     1     2  55    45  14    7    45    44    15   38     46
3     0     6   0  7452   2   12    16   629   279    3     41
4     0     2  10    36  27    3    74    25    51    6    305
5     1     0   2   256   0  175    13     1    16   54      3
6     3    18   0    39   0    3  1375    57    32    0    381
7     3    49   1   645   4    4    17  6262    95    3    182
8     1     3   1   463   0    7    32   262  1969    2    556
9     9     1  19   146   2   65    48    22    15  153     13
10    3     3   0    58   7    1   107   118   116    2  12381
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3041349, 'precision': 0.4130918, 'recall': 0.25436845, 'specificity': 0.92893666, 'f1': 0.19013584, 'auroc': 0.8057813}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   134   31   0   15   0   0  365   516    3   0   106
1     1  354   0   20   0   0   23  1047    0   0    54
2     0    5   0   34   0   0  130   326    7   0   513
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    1   0   0    3    29    1   0  1599
5     5    4   0  263   0  13  119   153    6   0    29
6     0    4   0   13   0   0  803   139   11   0  2097
7     0   22   0    8   0   0   12  1110    0   0    12
8     0    1   0  116   0   0  142   226  291   0   594
9     3   13   0  138   0   1  198   658    1   0   125
10    0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-21 11:07:14.361677,epoch time: 0:31:56.567823,used: 11:12:43.221497,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8340379, 'precision': 0.733271, 'recall': 0.5455269, 'specificity': 0.9807781, 'f1': 0.587509, 'auroc': 0.96945417}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   99    10   1    55   1    0   111    79     6    4    117
1    0  1090   0     9   0    0     5   208     3    0     17
2    1     0  64    35  22   10    66    34    13   38     29
3    0     5   0  7439   0   16    26   624   292    1     33
4    0     1  11    42  34    3    83    29    50    4    282
5    2     0   4   246   2  170    19     2    13   60      3
6    1    14   0    38   0    2  1449    56    38    3    307
7    1    38   0   583   2    4    20  6363    95    4    153
8    2     2   1   431   0    6    38   270  2025    5    516
9    5     2  27   152   1   60    60    16    17  143     10
10   2     3   2    51   5    2   117   155   158    1  12297
---- Validation: 
scalar performance:
{'acc': 0.83480006, 'precision': 0.7472998, 'recall': 0.55104214, 'specificity': 0.9808575, 'f1': 0.59417033, 'auroc': 0.9691524}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   109     7   1    58   0    0   107    86     7    3    105
1     0  1083   0    17   0    0     1   205     5    2     19
2     2     1  64    37   9   10    50    39    25   36     39
3     0     6   0  7447   0   15    18   612   293    4     45
4     0     1  14    40  35    2    79    22    48    3    295
5     2     0   1   243   0  173    16     1    18   64      3
6     3    15   0    43   0    2  1443    53    38    1    310
7     3    47   1   572   1    3    20  6357   103    3    155
8     1     3   1   441   2    5    40   283  2042    4    474
9     5     3  29   138   3   60    54    17     9  161     14
10    2     2   3    60   3    1   119   148   159    4  12295
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32575387, 'precision': 0.418312, 'recall': 0.26348832, 'specificity': 0.9309497, 'f1': 0.19900079, 'auroc': 0.8098352}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   100   34   0   15   0   0   430   519    3   0    69
1     1  370   0   19   0   0    26  1036    0   0    47
2     0    6   0   34   0   0   170   346    7   0   452
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   0   0     7    39    1   0  1585
5     3    4   0  255   0  14   138   149    8   0    21
6     0    3   0   14   0   0  1104   152   12   0  1782
7     0   21   0    8   0   0    13  1112    0   0    10
8     0    1   0  118   0   0   199   240  317   0   495
9     2   13   1  133   0   1   238   653    2   0    94
10    0    0   0    1   0   0     4     2    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-21 11:38:59.793618,epoch time: 0:31:45.431941,used: 11:44:28.653438,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8339041, 'precision': 0.7506196, 'recall': 0.5481406, 'specificity': 0.98066425, 'f1': 0.5930523, 'auroc': 0.9702873}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   118     6   0    54   0    0    86    84     7    6    122
1     0  1080   0    14   0    0     3   211     7    1     16
2     2     2  52    35   8    9    47    47    25   37     48
3     2     6   0  7336   1   22    15   669   333    3     49
4     0     2  13    38  36    1    53    21    50    4    321
5     3     0   2   227   0  187    16     2    21   61      2
6     4    20   0    43   1    2  1361    62    52    3    359
7     0    45   1   527   2    2    12  6406   105    4    160
8     1     2   0   395   0    4    20   263  2113    3    495
9     8     2  21   142   1   68    40    23    21  154     13
10    0     4   0    44   4    1    82   147   183    3  12325
---- Validation: 
scalar performance:
{'acc': 0.835335, 'precision': 0.75122523, 'recall': 0.55201125, 'specificity': 0.98084325, 'f1': 0.5961665, 'auroc': 0.96988666}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   117     6   0    54   0    1    85    84     5    4    127
1     0  1075   0    15   0    0     3   208    10    1     20
2     0     4  58    40  11    6    44    43    20   42     44
3     2     5   0  7347   0   20    17   680   320    4     45
4     0     2  13    31  23    2    58    19    72    5    314
5     3     0   2   221   0  196    11     4    15   64      5
6     6     8   0    32   2    3  1391    59    49    4    354
7     0    34   0   532   2    3    12  6381   126    2    173
8     0     2   1   387   1    5    25   275  2140    1    459
9     3     2  13   141   2   75    46    19    20  161     11
10    0     6   0    47   1    2    67   149   180    4  12340
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.31406984, 'precision': 0.41019547, 'recall': 0.2619492, 'specificity': 0.92997134, 'f1': 0.19937807, 'auroc': 0.8089681}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   132   32   0   14   0   1  356   526    5   0   104
1     1  377   0   17   0   0   22  1032    0   0    50
2     0    6   0   32   0   0  128   340   10   0   499
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    3    33    2   0  1595
5     5    4   0  257   0  16  117   158   11   0    24
6     0    3   0   10   0   0  858   157   16   0  2023
7     0   21   0    8   0   0    8  1115    0   0    12
8     0    1   0  102   0   0  131   240  350   0   546
9     3   14   0  119   0   1  192   685    2   0   121
10    0    0   0    1   0   0    3     1    0   0  1641
better model found
persisted
after epoch: 23,now: 2024-07-21 12:10:51.713990,epoch time: 0:31:51.920372,used: 12:16:20.573810,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8366064, 'precision': 0.73822767, 'recall': 0.5612622, 'specificity': 0.98113453, 'f1': 0.60431075, 'auroc': 0.9710899}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   129     7   1    55   0    1    99    76     7    1    107
1     0  1096   0    15   0    0     7   196     7    0     11
2     3     3  50    34  23   10    43    38    20   48     40
3     0     3   0  7311   1   23    16   680   354    4     45
4     1     0  10    31  47    2    67    24    60    6    291
5     4     0   2   210   0  193    14     2    22   72      2
6     3    17   0    32   1    3  1420    55    50    2    325
7     1    36   0   521   4    1    23  6381   121    2    173
8     1     1   1   363   1    5    33   280  2162    5    444
9     4     2  24   117   3   71    40    23    17  177     15
10    1     4   1    43   7    1    87   139   206    0  12303
---- Validation: 
scalar performance:
{'acc': 0.8387321, 'precision': 0.7387363, 'recall': 0.5620899, 'specificity': 0.98137003, 'f1': 0.60433656, 'auroc': 0.97013026}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   131     8   0    48   1    1    94    77     7    3    113
1     0  1092   0    14   0    0     2   200     8    0     16
2     1     2  50    39  21    6    44    40    17   43     49
3     0     1   0  7357   1   24    15   649   350    8     35
4     1     2  11    41  41    1    62    16    58    9    297
5     4     0   1   217   1  189    12     3    20   71      3
6     6    12   0    35   1    3  1431    51    46    1    322
7     3    46   1   516   2    2    18  6405   122    3    147
8     1     5   1   367   0    6    40   272  2162    2    440
9     9     2  19   117   3   75    35    15    20  183     15
10    2     3   0    44   4    2    87   147   189    3  12315
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3403764, 'precision': 0.41305453, 'recall': 0.27795827, 'specificity': 0.932441, 'f1': 0.21981409, 'auroc': 0.8127636}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   177   36   0   13   0   1   386   478    5   0    74
1     1  404   0   16   0   0    26  1005    1   0    46
2     0    6   0   28   0   0   164   337   10   0   470
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     7    36    4   0  1586
5    11    4   0  244   0  18   135   146   12   0    22
6     0    3   0    9   0   0  1115   148   19   0  1773
7     0   21   0    8   0   0    13  1111    0   0    11
8     0    1   0   91   0   0   184   233  400   0   461
9     5   14   0  118   0   1   235   660    3   0   101
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-21 12:42:51.296127,epoch time: 0:31:59.582137,used: 12:48:20.155947,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.83853275, 'precision': 0.7487099, 'recall': 0.56784976, 'specificity': 0.9812379, 'f1': 0.6137458, 'auroc': 0.97067213}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   120     6   2    48   0    1   108    69     3    3    123
1     0  1069   0    20   0    0     4   218     4    0     16
2     1     0  89    30  15   13    41    38    14   30     41
3     0     3   1  7431   3   29    14   650   262    4     42
4     0     1  27    32  54    2    57    25    51    5    285
5     1     0   4   213   1  220     7     4    15   53      3
6     2    17   0    32   2    6  1426    65    40    2    316
7     1    31   2   522   1    3    17  6440    85    4    158
8     0     2   2   446   4   11    33   291  2010    3    493
9     3     2  39   130   0   88    36    27     9  147     12
10    4     4   1    53   7    4    91   142   147    3  12335
---- Validation: 
scalar performance:
{'acc': 0.83672595, 'precision': 0.7339083, 'recall': 0.5624191, 'specificity': 0.98102844, 'f1': 0.6079546, 'auroc': 0.9715974}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   124     8   1    47   0    3   109    78     3    2    108
1     1  1069   0    13   0    0     5   227     4    0     13
2     3     0  82    34  19    9    44    43    11   28     39
3     0     4   1  7401   1   33    16   673   271    4     36
4     0     2  23    35  56    5    58    16    57    8    279
5     2     0   6   224   0  205    11     3    12   54      4
6     5    14   0    33   0    4  1423    58    34    1    336
7     0    35   4   529   6    1    23  6411    82    2    172
8     1     0   6   430   4    6    34   277  2020    1    517
9     7     2  43   122   4   86    45    21    10  140     13
10    0     2   1    50  10    1    90   164   124    4  12350
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33023158, 'precision': 0.5580139, 'recall': 0.26850173, 'specificity': 0.9314407, 'f1': 0.20750818, 'auroc': 0.81314313}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   126   28   0   17   0   1   411   506    3   0    78
1     1  363   0   18   0   0    25  1046    0   0    46
2     0    5   2   30   0   0   161   337    7   0   473
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   1   0     6    38    1   0  1586
5     5    4   0  255   0  25   130   144    6   0    23
6     0    3   0   12   0   0  1120   146   12   0  1774
7     0   17   0    8   0   0    13  1115    0   0    11
8     0    1   0  115   0   0   192   239  328   0   495
9     2   11   2  127   0   1   230   658    1   0   105
10    0    0   0    1   0   0     4     1    0   0  1640
early stop counter: 1
val acc:0.8367259502410889, best validation acc: 0.838732123374939, corresponding to test acc:                         0.3403764069080353 / 0.3403764069080353
after epoch: 25,now: 2024-07-21 13:14:40.943223,epoch time: 0:31:49.647096,used: 13:20:09.803043,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.84043235, 'precision': 0.7344634, 'recall': 0.56358814, 'specificity': 0.98145026, 'f1': 0.60815406, 'auroc': 0.97208136}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   142     4   1    46   0    1    78    84     6    1    120
1     0  1095   0    16   0    0     3   200     4    1     13
2     4     3  81    33  16    5    32    44    15   37     42
3     1     8   1  7438   0   13    17   628   297    4     31
4     0     0  18    32  31    0    66    21    50    6    315
5     3     0   5   233   1  177    12     3    13   71      3
6     7    15   0    47   2    0  1425    52    41    4    315
7     2    39   3   504   1    0    19  6419   105    3    167
8     0     0   2   402   0    2    43   260  2097    8    482
9    14     1  41   137   2   60    35    17    18  154     14
10    3     4   2    50   6    1    84   132   153    4  12353
---- Validation: 
scalar performance:
{'acc': 0.8396148, 'precision': 0.74834543, 'recall': 0.5713641, 'specificity': 0.98134065, 'f1': 0.61833036, 'auroc': 0.972034}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   155     5   1    45   0    1    74    77    10    1    114
1     0  1090   0    11   0    0     5   201     8    1     16
2     3     0  86    34  10   11    34    38    20   29     47
3     1     4   0  7378   0   17    21   667   314    3     35
4     1     1  20    27  44    0    63    18    49   10    306
5     7     0   5   226   0  173     5     4    13   84      4
6     5     9   0    42   2    1  1438    49    35    4    323
7     2    35   3   528   3    1    17  6408    91    4    173
8     0     1   2   409   3    2    34   271  2090    6    478
9    11     1  38   130   1   52    42    22    11  171     14
10    3     1   4    55   7    0    84   135   149    2  12356
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34142587, 'precision': 0.4202307, 'recall': 0.27975965, 'specificity': 0.9325894, 'f1': 0.22383168, 'auroc': 0.81392205}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   249   36   0   15   0   0   366   425    3   0    76
1     1  424   0   18   0   0    25   983    0   0    48
2     0    5   0   30   0   0   162   325    7   0   486
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   0   0     6    33    1   0  1592
5    17    4   0  268   0  14   127   130    8   0    24
6     0    3   0   12   0   0  1103   136   13   0  1800
7     0   20   0    8   0   0    12  1112    0   0    12
8     0    1   0  117   0   0   189   222  338   0   503
9     7   14   1  129   0   1   236   633    1   0   115
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-21 13:46:29.847415,epoch time: 0:31:48.904192,used: 13:51:58.707235,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.8405394, 'precision': 0.7520156, 'recall': 0.5660142, 'specificity': 0.98145396, 'f1': 0.6116067, 'auroc': 0.97199583}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   143     5   0    47   0    2    75    77     4    3    127
1     0  1083   0    11   0    0     4   214     6    0     14
2     3     4  61    26  13   10    41    49    12   45     48
3     0     3   0  7285   1   26    10   746   324    3     40
4     0     0  12    21  43    4    64    25    61    5    304
5     2     0   2   212   0  200     6     3    20   74      1
6     4    14   0    31   1    5  1412    53    40    4    343
7     4    28   1   408   2    3    18  6519   113    1    168
8     0     0   2   335   1   12    29   292  2120    4    500
9     8     2  25   118   0   77    45    21    17  170     10
10    0     2   1    41   5    2    76   155   128    2  12380
---- Validation: 
scalar performance:
{'acc': 0.83798313, 'precision': 0.751731, 'recall': 0.56696826, 'specificity': 0.9811321, 'f1': 0.61303306, 'auroc': 0.97216696}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   141     6   0    45   0    1    69    78     3    5    135
1     0  1086   0    13   0    0     3   206     5    1     18
2     3     2  65    27  12   11    38    45    20   44     45
3     1     8   0  7244   0   26    15   762   334    3     47
4     0     0  15    29  43    4    49    33    48    8    310
5     3     0   3   212   0  213     7     5    14   62      2
6     6    11   0    27   0    3  1386    66    48    2    359
7     1    41   0   422   1    2    17  6514    86    3    178
8     0     1   2   361   2    5    26   310  2095    9    485
9     6     1  26   117   3   80    39    21    15  172     13
10    3     3   1    33   5    2    79   142   156    3  12369
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33198068, 'precision': 0.41730696, 'recall': 0.27355963, 'specificity': 0.93166125, 'f1': 0.21479338, 'auroc': 0.8133748}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   180   30   0   10   0   1   352   499    5   0    93
1     1  397   0   12   0   0    24  1018    0   0    47
2     0    5   0   26   0   0   144   338    8   0   494
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     4    36    2   0  1591
5    10    4   0  239   0  22   128   155   10   0    24
6     0    3   0    8   0   0  1032   145   17   0  1862
7     0   17   0    6   0   0    10  1119    0   0    12
8     0    1   0   85   0   0   164   246  355   0   519
9     5   11   0   96   0   1   212   686    2   0   124
10    0    0   0    1   0   0     4     1    0   0  1640
early stop counter: 1
val acc:0.8379831314086914, best validation acc: 0.8396148085594177, corresponding to test acc:                         0.3414258658885956 / 0.3414258658885956
after epoch: 27,now: 2024-07-21 14:18:29.530665,epoch time: 0:31:59.683250,used: 14:23:58.390485,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.84000427, 'precision': 0.74087906, 'recall': 0.5677799, 'specificity': 0.9812132, 'f1': 0.6133737, 'auroc': 0.9724482}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   137     6   0    48   0    2    88    66     4    5    127
1     0  1096   0    12   0    0     5   193     6    0     18
2     2     2  79    36  14   16    35    34    18   34     42
3     3     5   0  7537   1   31    19   549   249    1     41
4     1     3  25    34  39    1    48    12    39    8    329
5     2     0   3   212   0  225     6     3    10   54      6
6     3    12   0    43   1    2  1407    42    38    3    357
7     5    34   2   620   4    5    10  6284    94    4    203
8     0     0   2   423   4    7    40   252  2004    3    560
9     5     1  39   127   2   92    35    17     8  150     17
10    1     1   2    52   5    2    76   111   105    1  12438
---- Validation: 
scalar performance:
{'acc': 0.840979, 'precision': 0.7259265, 'recall': 0.56422895, 'specificity': 0.9814057, 'f1': 0.6069153, 'auroc': 0.973158}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   137     3   0    51   0    3    92    57     5    1    134
1     0  1097   0    16   0    0     4   193     4    0     18
2     3     2  79    38  19    8    40    39    10   34     40
3     0     2   0  7566   1   30    20   499   280    4     38
4     2     0  26    35  32    4    55    18    40    9    318
5     5     0   5   209   0  214     8     4    12   61      3
6     5     8   0    33   1    5  1422    46    38    3    347
7     3    33   6   582   0    5    15  6327    97    3    194
8     1     2   1   445   3    5    37   236  2024    1    541
9     9     2  37   127   2  102    38    13    11  138     14
10    3     3   1    50   5    3    88   109   129    1  12404
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33848736, 'precision': 0.42330787, 'recall': 0.2783492, 'specificity': 0.932277, 'f1': 0.22445309, 'auroc': 0.81433326}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   240   29   0   22   0   1   368   409    3   0    98
1     1  417   0   21   0   0    27   974    0   0    59
2     1    3   0   38   0   0   155   288    6   0   524
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   0   0     4    24    1   0  1603
5    12    4   0  284   0  25   128   104    7   0    28
6     0    3   0   15   0   0  1089   100    9   0  1851
7     0   18   0   10   0   0    14  1110    0   0    12
8     0    1   0  131   0   0   189   188  316   0   545
9     7   13   2  154   0   1   253   576    1   0   130
10    0    0   0    1   0   0     4     0    0   0  1641
better model found
persisted
after epoch: 28,now: 2024-07-21 14:50:49.069856,epoch time: 0:32:19.539191,used: 14:56:17.929676,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.8444992, 'precision': 0.75136507, 'recall': 0.5804747, 'specificity': 0.9819464, 'f1': 0.62758064, 'auroc': 0.97313374}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   151     6   1    49   0    1    80    65     5    3    121
1     1  1089   0    14   0    0     4   200     8    0     16
2     3     3  77    35  20    9    29    33    16   49     38
3     1     2   1  7441   2   22    15   602   310    3     41
4     0     0  19    32  62    2    55    18    54    6    291
5     4     0   1   208   0  206     8     1    16   74      3
6     7     9   0    34   1    3  1440    47    43    3    320
7     1    44   1   511   2    3    21  6402   113    3    162
8     0     1   3   369   0    9    44   247  2143    4    474
9     9     1  29   122   3   70    29    21    16  178     15
10    4     3   2    43   7    2    67   129   155    6  12375
---- Validation: 
scalar performance:
{'acc': 0.84376085, 'precision': 0.7512233, 'recall': 0.57781386, 'specificity': 0.9818494, 'f1': 0.6247133, 'auroc': 0.9727174}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   153     6   1    52   0    2    74    68     2    2    123
1     0  1080   0    14   0    0     4   215     5    0     14
2     2     2  86    31  12    2    33    35    12   51     46
3     0     4   0  7441   1   21    14   591   326    3     39
4     0     2  27    31  56    2    48    24    48    4    297
5     2     0   8   212   2  197     7     1    18   72      2
6     3    12   0    35   1    3  1434    49    52    5    314
7     1    49   2   510   3    5    15  6382   109    2    187
8     1     0   1   380   1    8    21   257  2172    7    448
9    11     0  35   126   1   80    26    20    15  164     15
10    5     1   0    40   6    1    72   136   154    2  12379
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34954172, 'precision': 0.51175535, 'recall': 0.28591174, 'specificity': 0.9334096, 'f1': 0.232173, 'auroc': 0.81663704}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   248   30   0   18   0   1   368   420    5   0    80
1     1  420   0   18   0   0    28   983    1   0    48
2     1    3   0   30   0   0   160   311   10   0   500
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     4    29    2   0  1597
5    13    4   0  274   0  20   128   118   12   0    23
6     0    3   0   14   0   0  1160   122   16   0  1752
7     0   18   0    9   0   0    11  1114    0   0    12
8     0    1   0  109   0   0   184   207  393   0   476
9     6   13   1  137   0   1   242   614    2   0   121
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-21 15:22:37.077657,epoch time: 0:31:48.007801,used: 15:28:05.937477,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.84551585, 'precision': 0.75384796, 'recall': 0.5840268, 'specificity': 0.98209596, 'f1': 0.631223, 'auroc': 0.9731347}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   161     2   1    43   0    2    69    81     4    2    117
1     0  1078   0    14   0    0     5   209    10    0     16
2     4     0  79    30  17    7    29    45    20   42     39
3     0     3   1  7352   2   33    19   673   321    1     30
4     0     0  20    37  56    3    54    32    45    4    288
5     3     0   4   195   1  224     6     3    17   63      5
6     8     7   1    26   2    3  1456    59    42    1    303
7     3    25   3   461   2    2    23  6470   113    3    159
8     0     2   3   334   2    8    27   271  2183    4    461
9     5     1  29   120   2   82    44    19    10  167     14
10    1     1   1    42   8    3    83   120   158    2  12376
---- Validation: 
scalar performance:
{'acc': 0.84592754, 'precision': 0.7566799, 'recall': 0.58598405, 'specificity': 0.98210216, 'f1': 0.6340054, 'auroc': 0.9730449}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   157     2   2    36   1    3    85    71    11    5    110
1     1  1076   0    14   0    0     2   215     7    1     16
2     6     1  81    32  20    6    35    31    17   41     42
3     3     1   0  7370   1   33    18   659   315    6     34
4     0     0  14    30  60    3    57    24    51    7    293
5     5     0   5   206   0  214     5     3    15   65      3
6     6    12   0    26   1    2  1448    49    44    1    319
7     3    15   3   474   1    2    27  6480    97    2    161
8     1     2   2   352   1    7    30   254  2161    8    478
9     8     1  26   114   1   74    35    22     7  189     16
10    4     2   1    47   9    0    79   133   131    1  12389
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3586371, 'precision': 0.5605207, 'recall': 0.29022408, 'specificity': 0.9342252, 'f1': 0.23606691, 'auroc': 0.81786174}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   253   23   0   13   0   1   379   424    5   0    72
1     1  384   0   17   0   0    30  1021    1   0    45
2     1    2   1   27   0   0   172   319   11   0   482
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    29    3   0  1591
5    13    4   0  253   0  23   139   126   12   0    22
6     0    3   0    9   0   0  1294   125   19   0  1617
7     0   12   0    7   0   0    15  1119    0   0    11
8     0    1   0   96   0   0   207   210  411   0   445
9     7   10   1  117   0   1   261   620    3   0   117
10    0    0   0    1   0   0     4     1    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-21 15:54:50.159182,epoch time: 0:32:13.081525,used: 16:00:19.019002,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:00:19.019002 at 2024-07-21 15:54:50.159182
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3586371, 'precision': 0.5605207, 'recall': 0.29022408, 'specificity': 0.9342252, 'f1': 0.23606691, 'auroc': 0.81786174}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   253   23   0   13   0   1   379   424    5   0    72
1     1  384   0   17   0   0    30  1021    1   0    45
2     1    2   1   27   0   0   172   319   11   0   482
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    29    3   0  1591
5    13    4   0  253   0  23   139   126   12   0    22
6     0    3   0    9   0   0  1294   125   19   0  1617
7     0   12   0    7   0   0    15  1119    0   0    11
8     0    1   0   96   0   0   207   210  411   0   445
9     7   10   1  117   0   1   261   620    3   0   117
10    0    0   0    1   0   0     4     1    0   0  1640
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3586371, 'precision': 0.5605207, 'recall': 0.29022408, 'specificity': 0.9342252, 'f1': 0.23606691, 'auroc': 0.81786174}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   253   23   0   13   0   1   379   424    5   0    72
1     1  384   0   17   0   0    30  1021    1   0    45
2     1    2   1   27   0   0   172   319   11   0   482
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     9    29    3   0  1591
5    13    4   0  253   0  23   139   126   12   0    22
6     0    3   0    9   0   0  1294   125   19   0  1617
7     0   12   0    7   0   0    15  1119    0   0    11
8     0    1   0   96   0   0   207   210  411   0   445
9     7   10   1  117   0   1   261   620    3   0   117
10    0    0   0    1   0   0     4     1    0   0  1640
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562326_instance_wise_predictions.txt
accuracy from prediction file 0.35863709508150843
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/2.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193441 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 744791 GiB | 744791 GiB |
|       from small pool |  19041 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 193441 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 744791 GiB | 744791 GiB |
|       from small pool |  19041 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 190583 KiB | 459649 KiB | 760391 GiB | 760390 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 744782 GiB | 744782 GiB |
|       from small pool |  17769 KiB |  37832 KiB |  15608 GiB |  15608 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 514048 KiB | 514048 KiB | 514048 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  40960 KiB |  40960 KiB |  40960 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37982 KiB |  74166 KiB | 411657 GiB | 411657 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 396008 GiB | 396008 GiB |
|       from small pool |   7582 KiB |   9471 KiB |  15648 GiB |  15648 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4034    |    6277    |  142891 K  |  142886 K  |
|       from large pool |      76    |     158    |   73408 K  |   73408 K  |
|       from small pool |    3958    |    6126    |   69482 K  |   69478 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4034    |    6277    |  142891 K  |  142886 K  |
|       from large pool |      76    |     158    |   73408 K  |   73408 K  |
|       from small pool |    3958    |    6126    |   69482 K  |   69478 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      41    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      20    |      20    |      20    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      24    |    1293    |   73067 K  |   73067 K  |
|       from large pool |       9    |      19    |   45567 K  |   45567 K  |
|       from small pool |      15    |    1285    |   27500 K  |   27500 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 744791 GiB | 744791 GiB |
|       from small pool |      0 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 744791 GiB | 744791 GiB |
|       from small pool |      0 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB | 760391 GiB | 760391 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 744782 GiB | 744782 GiB |
|       from small pool |      0 KiB |  37832 KiB |  15608 GiB |  15608 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 514048 KiB | 514048 KiB | 282624 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  40960 KiB |  40960 KiB |  14336 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82004 KiB | 411657 GiB | 411657 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 396008 GiB | 396008 GiB |
|       from small pool |      0 KiB |  21843 KiB |  15648 GiB |  15648 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  142891 K  |  142891 K  |
|       from large pool |       2    |     158    |   73408 K  |   73408 K  |
|       from small pool |       0    |    6126    |   69482 K  |   69482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  142891 K  |  142891 K  |
|       from large pool |       2    |     158    |   73408 K  |   73408 K  |
|       from small pool |       0    |    6126    |   69482 K  |   69482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      41    |      41    |      18    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      20    |      20    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1293    |   73068 K  |   73068 K  |
|       from large pool |       3    |      19    |   45567 K  |   45567 K  |
|       from small pool |       0    |    1285    |   27501 K  |   27501 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 744791 GiB | 744791 GiB |
|       from small pool |      0 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB | 760418 GiB | 760418 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 744791 GiB | 744791 GiB |
|       from small pool |      0 KiB |  39751 KiB |  15626 GiB |  15626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB | 760391 GiB | 760391 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 744782 GiB | 744782 GiB |
|       from small pool |      0 KiB |  37832 KiB |  15608 GiB |  15608 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 514048 KiB | 514048 KiB | 282624 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  40960 KiB |  40960 KiB |  14336 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82004 KiB | 411657 GiB | 411657 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 396008 GiB | 396008 GiB |
|       from small pool |      0 KiB |  21843 KiB |  15648 GiB |  15648 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6277    |  142891 K  |  142891 K  |
|       from large pool |       2    |     158    |   73408 K  |   73408 K  |
|       from small pool |       0    |    6126    |   69482 K  |   69482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6277    |  142891 K  |  142891 K  |
|       from large pool |       2    |     158    |   73408 K  |   73408 K  |
|       from small pool |       0    |    6126    |   69482 K  |   69482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      41    |      41    |      18    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      20    |      20    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1293    |   73068 K  |   73068 K  |
|       from large pool |       3    |      19    |   45567 K  |   45567 K  |
|       from small pool |       0    |    1285    |   27501 K  |   27501 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326

 Experiment start at: 2024-07-21 16:32:45.633473
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5279056, 'precision': 0.23281112, 'recall': 0.17195293, 'specificity': 0.9385652, 'f1': 0.15107638, 'auroc': 0.7654972}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    49   0   0   0    32   1   0    401
1    0   3   0    64   0   0   0   303   4   0    958
2    0   1   0    95   0   0   0    35   8   0    173
3    0   2   0  5264   0   0   0  1224  36   0   1913
4    0   0   0    85   0   0   1    24   4   0    425
5    0   0   0   396   0   0   0    38   7   0     80
6    0   0   0   317   0   0   4    48  16   0   1522
7    0   1   0  1635   0   0   1  2163  19   0   3443
8    0   0   0   877   0   0   0   149  19   0   2250
9    0   0   0   240   0   0   0    54   4   0    195
10   0   0   0   288   0   0   4   207  16   0  12278
---- Validation: 
scalar performance:
{'acc': 0.52884847, 'precision': 0.2760169, 'recall': 0.17211695, 'specificity': 0.93863094, 'f1': 0.15105414, 'auroc': 0.76915085}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    67   0   0   0    39   0   0    377
1    0   2   0    72   0   0   1   292   1   0    964
2    0   0   0    97   0   0   0    36   6   0    173
3    0   0   0  5295   0   0   1  1178  34   0   1932
4    0   0   0    80   0   0   0    21   4   0    434
5    0   0   0   390   0   0   0    44   4   0     83
6    0   0   0   297   0   0   4    55  16   0   1536
7    0   0   0  1637   0   0   2  2142  15   0   3469
8    0   0   0   837   0   0   5   170  18   0   2266
9    0   0   0   260   0   0   0    44   5   0    184
10   0   0   0   291   0   0   1   180  14   0  12310
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.13726999, 'precision': 0.029856108, 'recall': 0.11963692, 'specificity': 0.9120122, 'f1': 0.044955432, 'auroc': 0.56628114}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   0   0   8   0   0   0   80   1   0  1081
1    0   0   0  10   0   0   0  320   0   0  1169
2    0   0   0   3   0   0   0  131   0   0   881
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   0   0   0   0  101   0   0  1532
5    0   0   0  50   0   0   0   85   0   0   457
6    0   0   0   9   0   0   0  513   0   0  2545
7    0   0   0  18   0   0   0  493   0   0   653
8    0   0   0  49   0   0   0  261   0   0  1060
9    0   0   0  20   0   0   0  270   0   0   847
10   0   0   0   0   0   0   0  177   0   0  1469
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 17:06:18.533455,epoch time: 0:33:32.899982,used: 0:33:32.899982,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.623582, 'precision': 0.3626707, 'recall': 0.22041774, 'specificity': 0.9519614, 'f1': 0.20566641, 'auroc': 0.8570978}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    73   0   0   1    54   2   0    353
1    0  96   0    87   0   0   0   688   2   0    458
2    0   0   0    98   0   0   0    25   5   0    184
3    0   4   0  6508   0   0   1  1194  27   0    705
4    0   0   0    73   0   0   2     6   6   0    452
5    0   0   0   447   0   0   0     8   5   0     60
6    0   0   0   259   0   0  43    27  25   0   1553
7    0   4   0  1779   0   0   2  4000  10   0   1467
8    0   0   0   942   0   0   6   149  82   0   2116
9    0   0   0   305   0   1   1    24   7   0    155
10   0   0   0   143   0   0   1    56  17   0  12578
---- Validation: 
scalar performance:
{'acc': 0.62230843, 'precision': 0.48989958, 'recall': 0.21986267, 'specificity': 0.9517992, 'f1': 0.20505211, 'auroc': 0.8590681}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    72   0   0   1    51   1   0    358
1    0  91   0    86   0   0   0   676   1   0    478
2    0   0   0   104   0   0   1    29   4   0    174
3    0   2   0  6491   0   0   1  1212  36   0    698
4    0   0   0    75   0   0   1     7   5   0    451
5    0   0   0   446   0   2   0     4   8   0     61
6    0   2   0   251   0   0  38    23  32   0   1562
7    0   4   0  1780   0   0   2  3994  11   0   1474
8    0   0   0   933   0   0   7   152  76   0   2128
9    0   0   0   296   0   2   1    29   4   1    160
10   0   1   0   154   0   0   2    56  11   0  12572
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1815574, 'precision': 0.0650705, 'recall': 0.1655285, 'specificity': 0.9167377, 'f1': 0.06236891, 'auroc': 0.64954567}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   2   0   8   0   0   0  336   1   0   823
1    0   4   0  12   0   0   0  994   0   0   489
2    0   0   0   3   0   0   0  134   1   0   877
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   0   0   0   0   18   0   0  1615
5    0   0   0  80   0   0   0  185   0   0   327
6    0   0   0   5   0   0   0  176   0   0  2886
7    0   7   0  10   0   0   0  970   0   0   177
8    0   1   0  39   0   0   1  200   0   0  1129
9    0   0   0  32   0   0   0  465   0   0   640
10   0   0   0   0   0   0   0   25   0   0  1621
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 17:38:16.594451,epoch time: 0:31:58.060996,used: 1:05:30.960978,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6733465, 'precision': 0.519675, 'recall': 0.26947007, 'specificity': 0.9593166, 'f1': 0.27343863, 'auroc': 0.89696}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    1   0    66   0   0    7   130    2   0    277
1    0  324   0    45   0   0    1   816    2   0    144
2    0    0   0   102   0   0    2    49   13   0    146
3    0    3   0  6361   0   0    2  1696   67   0    310
4    0    0   0    67   0   0    2     6    5   0    459
5    0    0   0   420   0  11    5    22   21   1     41
6    0    8   0   192   0   0  227    85   40   0   1355
7    0   12   0  1198   0   0    4  5451   28   0    570
8    0    0   0   895   0   0    8   296  313   0   1784
9    0    0   0   281   0   5   17    55   17   3    115
10   0    2   0   146   0   0   10   120   36   0  12477
---- Validation: 
scalar performance:
{'acc': 0.6757523, 'precision': 0.48901686, 'recall': 0.2682127, 'specificity': 0.95959586, 'f1': 0.26996225, 'auroc': 0.89698654}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    4   0    64   0   0   10   113    2   0    290
1    0  311   0    48   0   0    0   841    1   0    131
2    0    0   0    91   0   1    7    65    9   0    139
3    0    4   0  6424   0   1    4  1624   73   0    310
4    0    0   0    75   0   0    2    12    5   0    445
5    0    0   0   440   0   6    3    26    8   2     36
6    0    8   0   203   0   0  211    76   45   0   1365
7    0   15   0  1153   0   0    2  5533   28   0    534
8    0    2   0   860   0   0   12   294  300   0   1828
9    0    0   0   273   0   3   11    64   13   3    126
10   0    2   0   144   0   0   18   131   26   0  12475
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19163227, 'precision': 0.15160513, 'recall': 0.17670053, 'specificity': 0.9182743, 'f1': 0.061816454, 'auroc': 0.6860709}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   8   0   6   0   0   8   751   2   0   395
1    0  17   0   7   0   0   0  1360   0   0   115
2    0   1   0   3   0   0   0   344   2   0   665
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    59   0   0  1574
5    0   1   0  61   0   0   1   390   2   0   137
6    0   0   0   4   0   0   6   446   0   0  2611
7    0  13   0   2   0   0   0  1110   0   0    39
8    0   2   0  33   0   0   4   385   9   0   937
9    0   0   0  16   0   0   0   862   1   0   258
10   0   0   0   0   0   0   0    49   0   0  1597
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-21 18:10:08.264625,epoch time: 0:31:51.670174,used: 1:37:22.631152,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7072185, 'precision': 0.52156943, 'recall': 0.3131865, 'specificity': 0.9637823, 'f1': 0.32757047, 'auroc': 0.9181621}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    8   0    92   0   0   19    98    1   0    265
1    0  617   0    40   0   0    1   599    2   0     73
2    0    2   0   108   0   0   17    44   17   0    124
3    0    4   0  6999   0   2    2  1094  153   0    184
4    0    0   0    83   0   0    5    11   13   0    427
5    0    2   0   455   0   5    9     7   16   3     24
6    0   24   0   176   0   0  429    61   67   0   1151
7    0   32   0  1405   0   0    2  5287   45   0    492
8    0    1   0   891   0   0   11   219  634   0   1538
9    0    2   0   296   0   2   31    37   27  12     86
10   0    3   0   158   0   0   19   104   59   0  12450
---- Validation: 
scalar performance:
{'acc': 0.70881367, 'precision': 0.50004, 'recall': 0.3120703, 'specificity': 0.9639891, 'f1': 0.32549822, 'auroc': 0.91535854}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0   11   0    81   0   0   14   113    7   0    257
1    0  610   0    48   0   0    0   593    6   0     75
2    0    1   0   120   0   0    3    38   16   1    133
3    0    5   0  7006   0   0    1  1094  149   0    185
4    0    0   0    65   0   0    5    15   24   0    430
5    0    2   0   451   0   5    9    10   21   3     20
6    0   15   0   195   0   1  403    65   69   0   1160
7    0   39   0  1385   0   0    4  5326   42   0    469
8    0    1   0   888   0   0    8   212  664   0   1523
9    0    5   1   302   0   5   31    42   28   7     72
10   0    2   0   153   0   0   20    97   46   0  12478
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20030785, 'precision': 0.17863914, 'recall': 0.18357033, 'specificity': 0.919111, 'f1': 0.076019384, 'auroc': 0.7099743}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0  23   0   6   0   0  28   735   2   0   376
1    0  88   0  11   0   0   0  1300   0   0   100
2    0   3   0  12   0   0   0   303   4   0   693
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   1   0   0   0    34   0   0  1598
5    0   7   0  92   0   0   1   361   6   0   125
6    0   1   0   8   0   0  18   290   3   0  2747
7    0  32   0   4   0   0   0  1091   0   0    37
8    0   3   0  56   0   0   7   315  43   0   946
9    0   4   0  43   0   0   1   822   4   0   263
10   0   0   0   0   0   0   0    23   0   0  1623
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 18:42:05.061599,epoch time: 0:31:56.796974,used: 2:09:19.428126,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7313517, 'precision': 0.5122846, 'recall': 0.34792858, 'specificity': 0.96699774, 'f1': 0.37049264, 'auroc': 0.9291581}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    7   0    67   0   0   41   123    3   0    242
1    0  689   0    37   0   0    1   547    3   0     54
2    0    1   0    98   0   3   21    41   19   1    128
3    0    6   0  6976   0   3    4  1089  197   2    160
4    0    0   0    71   0   0   16    12   23   0    417
5    0    0   0   411   0  41   18     9   14   7     21
6    0   17   0   131   0   0  689    57   42   2    970
7    0   35   0  1113   0   0    6  5662   45   0    404
8    0    1   0   797   0   1   21   227  828   0   1420
9    0    2   0   274   0  29   56    38   22  20     51
10   0    4   0   129   0   0   45   117   68   0  12430
---- Validation: 
scalar performance:
{'acc': 0.7305871, 'precision': 0.59217566, 'recall': 0.34621555, 'specificity': 0.9669391, 'f1': 0.36725056, 'auroc': 0.9285946}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    1    5   0    71   0   0   46   116    2   0    242
1    0  692   0    41   0   0    1   551    1   0     46
2    0    2   0    94   0   0   24    48   20   3    121
3    0    6   0  6942   0   4    5  1115  188   1    179
4    0    0   0    69   0   0   17     7   17   0    429
5    0    1   0   401   0  34   20     8   26  10     21
6    0   16   0   132   0   0  697    67   53   0    943
7    0   38   0  1110   0   1    5  5657   49   0    405
8    0    1   0   778   0   0   22   259  831   0   1405
9    0    2   0   280   0  24   51    39   24  15     58
10   0    4   0   117   0   0   47   105   79   0  12444
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20443574, 'precision': 0.19004472, 'recall': 0.18658032, 'specificity': 0.91950107, 'f1': 0.080812976, 'auroc': 0.72452646}
confusion matrix:
    0    1   2   3   4   5   6     7   8   9     10
0    0   23   0   5   0   0  62   758   1   0   321
1    0  105   0  10   0   0   1  1297   0   0    86
2    0    5   0  10   0   0   1   326   4   0   669
3    0    0   0   0   0   0   0     0   0   0     0
4    0    0   0   1   0   0   0    35   0   0  1597
5    0    6   0  91   0   0   3   371   5   0   116
6    0    0   0   7   0   0  41   275   3   0  2741
7    0   34   0   3   0   0   0  1096   0   0    31
8    0    3   0  54   0   0  12   318  55   0   928
9    0    5   0  40   0   0   1   844   3   0   244
10   0    0   0   0   0   0   1    20   0   0  1625
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 19:14:08.860161,epoch time: 0:32:03.798562,used: 2:41:23.226688,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7518996, 'precision': 0.61373353, 'recall': 0.37515655, 'specificity': 0.9697938, 'f1': 0.39649105, 'auroc': 0.9372129}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    2   11   0    63   0   0   57   137     2   0    211
1    0  820   0    25   0   0    1   443     3   0     39
2    0    7   0    81   0   6   40    60    18   2     98
3    0   10   0  6959   0   2    9  1130   203   0    125
4    0    0   0    66   0   0   25    19    29   0    400
5    0    0   0   394   0  43   25    11    22  12     14
6    0   19   0   101   0   0  853    71    47   0    817
7    0   54   0   853   0   0    7  5962    54   0    334
8    0    2   0   677   0   0   26   313  1004   1   1271
9    0    0   0   253   0  22   71    47    19  27     54
10   0    9   0    93   0   0   61   126    71   0  12433
---- Validation: 
scalar performance:
{'acc': 0.74915075, 'precision': 0.51642, 'recall': 0.37362915, 'specificity': 0.9694475, 'f1': 0.39516664, 'auroc': 0.9386554}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0    9   0    68   0   0   62   127     4   0    213
1    0  828   0    28   0   0    0   430     2   1     43
2    0    5   0    79   0   3   33    66    15   5    106
3    0    7   0  6975   0   2    6  1121   201   0    128
4    0    0   0    62   0   0   23    18    29   0    407
5    0    0   0   387   0  45   30     8    18  11     22
6    0   24   0   109   0   0  830    70    41   1    833
7    0   54   0   925   0   0    4  5898    65   2    317
8    0    1   0   717   0   0   22   281  1005   0   1270
9    1    2   0   259   0  27   57    49    26  27     45
10   0    6   0   104   0   0   54   151    82   0  12399
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.21297139, 'precision': 0.28532818, 'recall': 0.1936315, 'specificity': 0.9203696, 'f1': 0.092770465, 'auroc': 0.7362886}
confusion matrix:
    0    1   2   3   4   5   6     7   8   9     10
0    1   50   0   2   0   0  85   771   1   0   260
1    0  192   0   9   0   0   0  1228   0   0    70
2    0    6   0   9   0   0   2   358   4   0   636
3    0    0   0   0   0   0   0     0   0   0     0
4    0    0   0   1   0   0   0    39   0   0  1593
5    0    8   0  89   0   0   7   392   6   0    90
6    0    5   0   7   0   0  54   319   3   0  2679
7    0   48   0   3   0   0   0  1090   0   0    23
8    0    7   0  53   0   0  15   349  81   0   865
9    0   15   0  29   0   0   4   891   2   0   196
10   0    0   0   0   0   0   1    19   0   0  1626
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 19:45:58.449282,epoch time: 0:31:49.589121,used: 3:13:12.815809,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.76725703, 'precision': 0.5967956, 'recall': 0.40307966, 'specificity': 0.971873, 'f1': 0.42463052, 'auroc': 0.94379234}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    7   11   0    73   0   0    84   112     2   0    194
1    0  929   0    20   0   0     2   344     1   0     36
2    0    4   0    81   0   4    64    46    20   9     84
3    0    9   0  7110   0   7    11   978   205   1    116
4    0    0   0    64   0   0    40    18    24   0    393
5    0    1   0   368   0  60    29     9    19  25     10
6    0   25   0    94   0   0  1039    54    26   1    667
7    0   55   0   900   0   1    11  5957    55   0    284
8    0    4   0   695   0   1    32   285  1153   0   1126
9    1    6   0   239   0  32    83    33    19  40     40
10   0    5   0   110   0   0    74   135    88   0  12382
---- Validation: 
scalar performance:
{'acc': 0.764879, 'precision': 0.60654426, 'recall': 0.4011267, 'specificity': 0.9715992, 'f1': 0.42214566, 'auroc': 0.9434797}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    6   10   0    71   0   1    89   119     4   0    183
1    0  929   0    29   0   0     0   338     5   0     31
2    0    5   0    81   0   5    44    51    16  11     99
3    0   12   0  7144   0   4    12   948   213   0    107
4    0    1   0    56   0   0    39    18    28   0    397
5    0    0   0   377   0  66    27     5    21  19      6
6    0   24   0    90   0   0  1028    63    32   0    671
7    0   70   0   926   0   2    10  5879    68   1    309
8    0    2   0   702   0   2    42   294  1131   0   1123
9    0    7   2   255   0  34    68    42    16  35     34
10   0    9   0   117   0   0    80   136    77   0  12377
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22269642, 'precision': 0.34763163, 'recall': 0.20072496, 'specificity': 0.9212775, 'f1': 0.105567016, 'auroc': 0.74746495}
confusion matrix:
    0    1   2    3   4   5    6     7   8   9     10
0    3   78   0    2   0   1  145   703   1   0   237
1    0  278   0    9   0   0    1  1146   0   0    65
2    0   14   0   16   0   0    8   349   5   0   623
3    0    0   0    0   0   0    0     0   0   0     0
4    0    0   0    1   0   0    0    37   0   0  1595
5    0   12   0  122   0   2   15   358   5   1    77
6    0    7   0   11   0   0   98   288   3   0  2660
7    0   65   0    4   0   0    0  1075   0   0    20
8    0   11   0   70   0   0   32   314  97   0   846
9    0   24   0   52   0   0   10   856   2   0   193
10   0    0   0    0   0   0    1    15   0   0  1630
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-21 20:17:54.372168,epoch time: 0:31:55.922886,used: 3:45:08.738695,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.7736783, 'precision': 0.64687204, 'recall': 0.41644955, 'specificity': 0.9726993, 'f1': 0.44221672, 'auroc': 0.9503951}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0   10    9   0    55   0   0   78   130     7   0    194
1    0  950   0    12   0   0    1   335     4   0     30
2    0    4   6    76   0   6   44    54    19   9     94
3    0    6   0  7023   0  11   18  1014   269   1     95
4    0    0   2    59   0   0   36    11    34   0    397
5    0    0   0   336   0  94   18     4    30  30      9
6    1   29   0    73   0   0  999    65    41   0    700
7    0   65   0   778   1   1    7  6003    85   0    323
8    0    2   0   560   0   1   24   284  1374   1   1050
9    0    5   3   217   1  56   74    34    24  38     41
10   0    6   0    93   0   1   52   129    91   0  12420
---- Validation: 
scalar performance:
{'acc': 0.77662164, 'precision': 0.68842745, 'recall': 0.41959572, 'specificity': 0.9730043, 'f1': 0.44872716, 'auroc': 0.94807047}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   14   10   0    65   0   2    73   121     6   0    192
1    0  923   0    14   0   0     2   359     4   0     30
2    0    5   6    74   1   7    44    49    20   8     98
3    0    8   0  7067   0   6     6   977   268   0    108
4    0    0   0    59   0   0    33    20    28   1    398
5    0    0   0   345   0  99    22     7    19  20      9
6    0   23   0    76   0   0  1025    63    37   1    683
7    0   56   0   794   0   1     4  6054    76   0    280
8    0    2   0   562   0   0    19   287  1353   1   1072
9    2    3   1   213   0  58    66    40    27  46     37
10   0    5   0    84   0   0    45   119    96   0  12447
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22878332, 'precision': 0.34727103, 'recall': 0.20664395, 'specificity': 0.9218382, 'f1': 0.11472395, 'auroc': 0.7547338}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   72   0    1   0   1  147   707    2   0   237
1    0  284   0    8   0   0    1  1137    0   0    69
2    0   13   0   11   0   0    8   343    9   0   631
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    31    1   0  1601
5    0   10   0  112   0   4   17   353   13   1    82
6    0    7   0    9   0   0   97   247    6   0  2701
7    0   59   0    3   0   0    0  1079    0   0    23
8    0    8   0   58   0   0   32   290  166   0   816
9    0   22   0   44   0   1   13   851    3   0   203
10   0    0   0    0   0   0    1     8    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-21 20:49:55.341473,epoch time: 0:32:00.969305,used: 4:17:09.708000,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.7805811, 'precision': 0.6732227, 'recall': 0.42541954, 'specificity': 0.9735824, 'f1': 0.4526299, 'auroc': 0.9533383}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   14    9   0    56   0    1   105   118     6   0    174
1    0  931   0    19   0    0     3   347     3   0     29
2    0    3   3    75   2    7    56    55    11   7     93
3    0    6   0  7144   0    8    18   941   236   1     84
4    0    0   0    61   0    1    39    19    24   0    395
5    0    0   0   343   0  103    24     7    15  21      8
6    1   18   0    81   0    1  1124    53    39   1    590
7    0   42   0   785   0    2    11  6085    59   1    279
8    0    1   0   636   0    0    29   284  1300   0   1045
9    0    3   2   215   0   59    79    43    14  52     26
10   0    5   0    86   0    0    77   127    76   1  12419
---- Validation: 
scalar performance:
{'acc': 0.7823191, 'precision': 0.6868985, 'recall': 0.43046635, 'specificity': 0.9737654, 'f1': 0.4606065, 'auroc': 0.9508686}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0   31   10   0    62   0   0    87   126     4   0    163
1    0  955   0    18   0   0     3   324     2   0     30
2    0    3   3    67   0   7    60    52    16  12     92
3    0   11   0  7174   0   8    14   918   224   2     89
4    0    0   0    55   0   1    40    18    26   2    397
5    2    0   0   347   0  96    32     5    18  15      6
6    0   19   0    73   0   1  1114    63    29   2    607
7    0   40   0   763   0   1    16  6093    58   2    292
8    0    1   0   622   0   0    25   300  1312   1   1035
9    1    3   1   223   1  51    72    38    18  59     26
10   0    7   0    85   0   0    77   135    81   1  12410
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23389071, 'precision': 0.36380848, 'recall': 0.20914033, 'specificity': 0.92230904, 'f1': 0.11871663, 'auroc': 0.76121}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    3   60   0    1   0   1  196   709    2   0   198
1    0  285   0    8   0   0    1  1139    0   0    66
2    0   12   0   14   0   0   13   354    7   0   615
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    1   0   0    0    33    0   0  1599
5    0    8   0  132   0   5   32   343    6   1    65
6    0    4   0    9   0   0  167   251    3   0  2633
7    0   50   0    3   0   0    1  1091    0   0    19
8    0    8   0   73   0   0   47   287  155   0   800
9    0   19   0   55   0   1   28   848    3   0   183
10   0    0   0    0   0   0    2     7    0   0  1637
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-21 21:21:53.204042,epoch time: 0:31:57.862569,used: 4:49:07.570569,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.7924336, 'precision': 0.7391758, 'recall': 0.45241988, 'specificity': 0.97517717, 'f1': 0.48494756, 'auroc': 0.9553159}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   37   10   0    68   0    0    97   103     6   1    161
1    0  996   0    22   0    0     5   282     2   0     24
2    0    4  15    74   0    7    52    48    21  22     69
3    0    6   0  7179   0   11    12   890   268   1     72
4    0    1   3    56   2    0    49    26    30   2    370
5    0    0   1   310   0  108    23     4    24  47      4
6    0   16   0    63   0    1  1214    56    35   1    522
7    1   46   0   718   1    1    10  6160    68   2    256
8    0    2   0   563   0    0    37   301  1430   2    961
9    1    6   2   195   0   60    70    40    17  76     26
10   0    5   0    87   0    0    74   126    97   1  12401
---- Validation: 
scalar performance:
{'acc': 0.7909857, 'precision': 0.6904898, 'recall': 0.44979984, 'specificity': 0.97502816, 'f1': 0.48136368, 'auroc': 0.95439243}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   37   10   0    54   0    0    92   133     2   1    154
1    0  986   0    22   0    0     2   296     5   0     21
2    2    0  11    73   1   10    51    45    13  29     77
3    0    8   0  7167   0   15    15   904   259   0     72
4    0    0   2    57   1    0    51    15    34   5    374
5    0    0   0   326   0  101    23     4    21  42      4
6    0   18   0    53   0    0  1184    71    29   4    549
7    0   48   0   746   0    1    10  6139    72   1    248
8    0    1   0   584   0    1    32   279  1481   2    916
9    2    3   5   193   0   70    64    31    17  83     25
10   0    4   0    95   1    1    81   134    99   0  12381
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24487512, 'precision': 0.3553506, 'recall': 0.21682188, 'specificity': 0.9233187, 'f1': 0.13115528, 'auroc': 0.7691954}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    6   75   0    2   0   1  247   675    3   0   161
1    0  345   0    8   0   0    5  1082    0   0    59
2    0   13   0   15   0   0   20   362    9   0   596
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0    35    1   0  1597
5    0    9   0  136   0   6   46   329    7   1    58
6    0    5   0    9   0   0  232   256    4   0  2561
7    1   59   0    4   0   0    1  1081    0   0    18
8    0    9   0   73   0   0   67   287  192   0   742
9    0   22   0   55   0   1   45   845    3   0   166
10   0    0   0    0   0   0    2     6    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-21 21:53:58.820807,epoch time: 0:32:05.616765,used: 5:21:13.187334,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.79797196, 'precision': 0.6797837, 'recall': 0.4616976, 'specificity': 0.97603303, 'f1': 0.4941402, 'auroc': 0.9574237}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   44    8   0    62   0    0    94   126     4   0    145
1    0  982   0    20   0    0     1   307     5   0     17
2    0    4   9    71   1   15    49    56    21  30     56
3    0    6   0  7164   0   10    15   906   268   0     69
4    0    1   1    43   0    1    65    26    44   2    356
5    1    1   0   310   0  124    19     6    21  34      4
6    0   15   0    50   0    0  1233    75    37   4    494
7    0   46   1   689   0    2    11  6239    67   0    209
8    0    3   0   558   0    1    27   319  1599   0    785
9    4    1   2   197   1   67    62    39    14  88     18
10   0    4   0    82   0    1    82   165   118   0  12343
---- Validation: 
scalar performance:
{'acc': 0.79986626, 'precision': 0.68654436, 'recall': 0.46319717, 'specificity': 0.97629356, 'f1': 0.49536625, 'auroc': 0.9577516}
confusion matrix:
    0    1   2     3   4    5     6     7     8   9      10
0   44   10   0    62   0    1    92   114     5   1    154
1    0  978   0    18   0    0     4   308     4   0     20
2    1    4   9    70   3    8    54    59    21  23     60
3    0    9   0  7198   1   10    13   884   273   3     49
4    0    0   2    53   0    1    54    24    46   4    355
5    0    0   0   305   0  126    26     7    21  28      8
6    1   15   0    63   0    4  1223    68    43   1    490
7    1   54   0   651   0    0    15  6274    85   2    183
8    0    1   0   553   0    3    30   298  1617   3    791
9    1    0   1   189   0   78    63    35    19  92     15
10   0    4   0    80   0    1    88   172   108   1  12342
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2525712, 'precision': 0.36872476, 'recall': 0.22233155, 'specificity': 0.92418116, 'f1': 0.13919064, 'auroc': 0.77533376}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    8   65   0    2   0   1  258   706    3   0   127
1    0  327   0    7   0   0    5  1107    0   0    53
2    0   13   0   19   0   0   21   412   11   0   539
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    46    1   0  1585
5    0    8   0  145   0   8   51   328    9   1    42
6    0    4   0   11   0   0  298   352    7   0  2395
7    1   43   0    4   0   0    2  1099    0   0    15
8    0   10   0   80   0   0   74   317  243   0   646
9    0   18   0   57   0   1   46   889    6   0   120
10   0    0   0    0   0   0    2    17    0   0  1627
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-21 22:26:08.885591,epoch time: 0:32:10.064784,used: 5:53:23.252118,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.80227953, 'precision': 0.66897327, 'recall': 0.47137326, 'specificity': 0.9764237, 'f1': 0.50434816, 'auroc': 0.95867723}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   41     9   0    88   0    1   115    77     5   0    147
1    0  1047   0    26   0    0     1   231     1   0     26
2    0     0  24    67   3    8    63    50    14  23     60
3    0     6   0  7437   0    7    17   653   249   1     68
4    0     0   2    53   0    1    56    14    38   7    368
5    0     0   0   288   0  137    28     2    16  43      7
6    2    21   0    60   0    1  1265    46    28   2    483
7    0    53   0   865   0    2    12  5980    81   1    268
8    0     2   1   606   0    1    38   238  1570   2    837
9    3     3  13   196   0   74    62    16    26  79     21
10   0     4   0    88   0    4    87   115    87   2  12406
---- Validation: 
scalar performance:
{'acc': 0.8020864, 'precision': 0.7624729, 'recall': 0.46999466, 'specificity': 0.97641987, 'f1': 0.50310487, 'auroc': 0.9595294}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   37    11   0    78   0    2   103    96     2   2    152
1    0  1042   1    24   0    0     1   238     3   0     23
2    1     3  19    72   0   11    59    42    19  21     65
3    0    10   0  7416   0   12    15   654   262   3     68
4    0     1   5    53   4    0    66    11    34   1    364
5    1     1   2   305   0  128    24     5    21  31      3
6    0    16   0    66   0    2  1269    46    29   2    478
7    0    49   1   857   0    1    21  5998    83   1    254
8    0     3   0   653   0    0    27   228  1573   1    811
9    3     3   6   200   0   64    72    22    17  89     17
10   0     6   0    88   0    1    91   111    87   1  12411
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26404533, 'precision': 0.37125742, 'recall': 0.23032586, 'specificity': 0.9250909, 'f1': 0.15247181, 'auroc': 0.77957267}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    8   96   0    5   0   1  342   571    3   0   144
1    0  466   0   13   0   0    9   948    0   0    63
2    0   14   0   29   0   0   31   318   10   0   613
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    1   0   0    1    24    0   0  1606
5    0    6   0  190   0   9   72   253    8   1    53
6    0    5   0   15   0   0  342   192    5   0  2508
7    1   66   0    8   0   0    5  1065    0   0    19
8    0   10   0  106   0   0   94   226  242   0   692
9    0   29   0   97   0   1   75   755    4   0   176
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-21 22:58:09.063809,epoch time: 0:32:00.178218,used: 6:25:23.430336,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8101991, 'precision': 0.71685535, 'recall': 0.4894646, 'specificity': 0.9776502, 'f1': 0.52511466, 'auroc': 0.9614005}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   61     7   1    57   0    1   104   104     6    1    141
1    0  1023   0    16   0    0     0   270     6    0     17
2    1     1  24    61   0   10    43    52    22   41     57
3    0    12   0  7241   1    9    16   803   314    2     40
4    0     0   5    47   1    0    68    17    53    3    345
5    0     0   0   274   0  148    15     5    25   50      4
6    2    26   0    54   0    4  1260    59    45    3    454
7    1    54   1   647   0    2    10  6250    94    2    202
8    0     1   0   479   0    0    25   283  1809    3    696
9    4     4  11   165   0   68    61    29    22  115     14
10   0     2   0    70   0    1    86   133   149    1  12350
---- Validation: 
scalar performance:
{'acc': 0.8103517, 'precision': 0.73888105, 'recall': 0.49182034, 'specificity': 0.9776933, 'f1': 0.527354, 'auroc': 0.9608634}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   69     8   0    51   0    0   111   100     5    3    136
1    0  1045   0    16   0    0     0   246     9    0     16
2    2     3  21    55   1    6    55    50    28   34     57
3    0     6   0  7213   0   15    17   817   313    2     57
4    0     0   5    50   3    0    53    19    47    4    358
5    2     0   3   272   0  142    22     4    27   46      3
6    2    21   0    46   0    1  1303    65    44    3    423
7    0    40   0   671   0    2    12  6245    93    2    200
8    0     0   0   469   0    1    36   310  1810    2    668
9    4     3   9   173   0   65    59    32    22  112     14
10   0     7   0    61   0    2    88   147   158    1  12332
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.27579933, 'precision': 0.3754855, 'recall': 0.24022955, 'specificity': 0.92633486, 'f1': 0.16466779, 'auroc': 0.78483695}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   19   99   0    2   0   1  316   617    3   0   113
1    1  473   0    6   0   0    6   959    0   0    54
2    0   15   0   20   0   0   32   370   15   0   563
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    38    2   0  1591
5    0    9   0  164   0  11   68   287   14   1    38
6    0    6   0   10   0   0  388   266   17   0  2380
7    1   61   0    5   0   0    4  1077    0   0    16
8    0    8   0   77   0   0   90   265  336   0   594
9    0   29   0   69   0   1   75   821    8   0   134
10   0    0   0    1   0   0    2     5    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-21 23:30:01.646716,epoch time: 0:31:52.582907,used: 6:57:16.013243,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8151488, 'precision': 0.7226252, 'recall': 0.49687576, 'specificity': 0.97822994, 'f1': 0.5306281, 'auroc': 0.963128}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   75     7   0    54   0    4   108    93     4   1    136
1    0  1048   0    19   0    0     0   238    10   0     17
2    0     2  17    55   2   13    53    53    21  30     66
3    0     8   0  7232   0   20    19   768   327   0     65
4    0     1   5    40   2    1    66    19    39   7    358
5    1     0   0   267   0  175    23     5    19  27      4
6    2    17   0    46   0    4  1303    59    41   0    435
7    0    42   0   657   0    5    11  6222   114   0    212
8    0     1   0   445   0    3    27   276  1916   2    625
9    6     3   7   165   0   91    62    25    20  90     24
10   0     5   0    65   0    1    75   129   131   1  12387
---- Validation: 
scalar performance:
{'acc': 0.81452453, 'precision': 0.6987651, 'recall': 0.49929935, 'specificity': 0.9781781, 'f1': 0.533722, 'auroc': 0.96221805}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   76     7   0    56   0    1   107   101     5    1    129
1    0  1059   0    17   0    0     0   226     9    0     21
2    1     2  15    53   4   16    54    49    26   29     63
3    1     8   0  7254   0   12    13   762   339    2     49
4    0     1   9    44   6    2    66    12    55    5    339
5    2     0   0   265   0  175    16     5    17   37      4
6    2    23   0    48   0    2  1292    53    42    3    443
7    1    50   1   625   1    2    18  6245   103    1    218
8    0     4   1   407   0    2    31   302  1865    1    683
9    5     3  11   164   2   83    52    28    20  107     18
10   0     7   0    59   1    1    89   143   139    0  12357
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2851046, 'precision': 0.37908182, 'recall': 0.24610078, 'specificity': 0.92715573, 'f1': 0.17402427, 'auroc': 0.7881975}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   29   87   0    3   0   1  350   580    3   0   117
1    1  484   0    7   0   0   10   940    0   0    57
2    0   13   0   22   0   0   46   344   15   0   575
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    31    2   0  1598
5    2    6   0  171   0  14   83   259   14   0    43
6    0    5   0   10   0   0  477   221   17   0  2337
7    1   56   0    5   0   0    5  1079    0   0    18
8    0    7   0   82   0   0   99   237  352   0   593
9    1   28   0   74   0   1   97   783    7   0   146
10   0    0   0    1   0   0    2     3    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-22 00:02:04.302664,epoch time: 0:32:02.655948,used: 7:29:18.669191,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8181721, 'precision': 0.73089695, 'recall': 0.51315206, 'specificity': 0.97867113, 'f1': 0.55172956, 'auroc': 0.9648916}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   89     7   0    58   0    2    97    87     3    2    138
1    0  1060   0    14   0    0     1   235     5    0     16
2    0     2  29    37   4   13    46    43    28   40     70
3    2     9   0  7194   0   14    12   790   370    3     44
4    1     1   4    46   9    0    61    16    57    6    338
5    0     0   1   248   1  175    13     3    22   53      5
6    5    20   0    40   1    1  1313    53    52    1    421
7    0    45   0   618   1    4    18  6261   112    3    201
8    0     1   0   394   1    3    24   272  1979    0    620
9    5     5   6   153   1   77    46    33    23  123     21
10   0     4   0    60   2    1    80   135   164    1  12348
---- Validation: 
scalar performance:
{'acc': 0.8169052, 'precision': 0.7424567, 'recall': 0.5074239, 'specificity': 0.9785061, 'f1': 0.54294646, 'auroc': 0.96438915}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   72     6   0    47   0    0    99    91     7    2    159
1    0  1063   0    11   0    0     0   232     7    0     19
2    0     2  19    41   4    9    44    55    22   48     68
3    1     3   0  7211   0   17    17   781   353    4     53
4    0     1   4    44  10    0    63    11    62    4    340
5    3     0   0   253   0  182    11     5    21   44      2
6    3    21   0    51   0    2  1278    66    61    3    423
7    0    52   1   616   0    3    14  6246   124    0    209
8    0     0   0   410   0    7    32   259  1972    1    615
9    5     3   5   149   0   81    50    29    25  127     19
10   0     6   0    68   1    1    85   128   145    2  12360
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29231092, 'precision': 0.3812754, 'recall': 0.25223932, 'specificity': 0.9278621, 'f1': 0.18166968, 'auroc': 0.790818}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   33  103   0    3   0   1  348   560    3   0   119
1    1  547   0    8   0   0   11   876    0   0    56
2    0   14   0   23   0   0   49   334   15   0   580
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    27    2   0  1602
5    2    6   0  171   0  17   79   253   18   3    43
6    0    6   0   11   0   0  492   208   25   0  2325
7    1   62   0    5   0   0    5  1073    0   0    18
8    0    9   0   76   0   0   98   232  374   0   581
9    1   35   0   74   0   1  100   766    9   0   151
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-22 00:33:57.190613,epoch time: 0:31:52.887949,used: 8:01:11.557140,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.81739616, 'precision': 0.72098714, 'recall': 0.5078461, 'specificity': 0.97840464, 'f1': 0.54868174, 'auroc': 0.9658584}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   96     6   0    59   1    1    90    89     7    0    133
1    0  1068   0    17   0    0     1   221     5    0     20
2    2     4  21    57  13    8    43    60    15   31     58
3    0     7   0  7351   0   17    14   717   265    2     65
4    0     2   9    46  17    3    62    12    36    7    345
5    0     1   0   273   0  162    20     5    13   43      4
6    2    20   0    54   0    0  1320    61    30    4    415
7    1    40   0   677   0    4    12  6248    81    1    201
8    0     2   1   530   0    4    33   270  1752    4    700
9    5     4  12   149   1   74    57    27    20  124     20
10   1     6   0    77   2    5    70   124   115    0  12392
---- Validation: 
scalar performance:
{'acc': 0.81744015, 'precision': 0.7185863, 'recall': 0.50704676, 'specificity': 0.9783863, 'f1': 0.5478539, 'auroc': 0.9655498}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   99     6   0    51   0    1    90    86     8    2    140
1    1  1086   0    16   0    0     3   209     3    0     14
2    0     1  24    51  12   11    55    53    17   30     58
3    0     4   0  7409   0   11     7   690   257    3     59
4    1     2   5    53  21    1    65    16    36    3    336
5    4     0   1   264   0  164    13     5    12   51      7
6    2    17   0    54   0    0  1312    59    35    2    427
7    0    52   1   693   2    3    20  6210    78    0    206
8    0     3   0   519   0    2    27   291  1710    3    741
9    9     6  12   160   4   91    49    24    17  107     14
10   2     5   1    72   1    1    71   118   106    1  12418
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29461974, 'precision': 0.37913972, 'recall': 0.252006, 'specificity': 0.928112, 'f1': 0.18255985, 'auroc': 0.7930946}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   50  103   0    5   0   1  350   542    3   0   116
1    1  591   0    9   0   0   10   832    0   0    56
2    0   14   0   29   1   0   56   330   10   0   575
3    0    0   0    0   0   0    0     0    0   0     0
4    0    1   0    0   0   0    1    27    2   0  1602
5   10    9   0  196   0  14   81   234    7   0    41
6    0    6   0   13   0   0  548   199   11   0  2290
7    1   63   0    6   0   0    7  1069    0   0    18
8    0   11   0  110   0   0  110   229  297   0   613
9    2   39   0   95   0   1  107   741    3   0   149
10   0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-22 01:05:50.333660,epoch time: 0:31:53.143047,used: 8:33:04.700187,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8222656, 'precision': 0.73058844, 'recall': 0.516462, 'specificity': 0.97915953, 'f1': 0.5579989, 'auroc': 0.966422}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   77     8   1    53   0    2    95   107     4    1    135
1    0  1049   0    17   0    0     1   244     5    0     16
2    1     0  47    52   7    3    41    50    21   38     52
3    0     5   0  7208   0   15    13   832   318    3     45
4    0     1  10    45  11    2    56    20    51    7    336
5    2     0   0   262   0  171    11     4    19   48      3
6    2    20   0    38   0    1  1296    59    51    3    438
7    0    42   3   509   1    1    17  6431    90    2    167
8    0     2   0   411   0    4    24   328  1956    3    568
9    6     6  13   137   1   85    44    35    21  126     19
10   0     1   0    62   3    0    77   148   138    1  12361
---- Validation: 
scalar performance:
{'acc': 0.8216932, 'precision': 0.7265657, 'recall': 0.5181958, 'specificity': 0.97907555, 'f1': 0.5598434, 'auroc': 0.9670635}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   85     7   0    61   0    0    83   106     8    0    133
1    0  1047   0    14   0    0     2   249     6    1     13
2    1     4  37    39   5    5    48    55    26   34     58
3    0     6   1  7211   0   11    18   835   313    2     43
4    0     0   8    36  10    1    59    29    48    6    342
5    2     0   0   248   0  179    18     5    16   52      1
6    2    20   0    37   1    1  1304    77    50    8    408
7    1    39   0   508   0    2    14  6410    91    1    199
8    0     1   0   395   1    2    26   311  1962    3    595
9    4     0  20   153   1   74    42    30    21  137     11
10   0     2   1    63   5    1    68   172   145    2  12337
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29790807, 'precision': 0.3941928, 'recall': 0.25507402, 'specificity': 0.928548, 'f1': 0.18401052, 'auroc': 0.7957821}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   28   80   0    3   0   1  333   622    3   0   100
1    1  493   0    5   0   0    8   944    1   0    47
2    0   13   0   18   1   0   55   395   16   0   517
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    1    42    2   0  1588
5    1    8   0  174   0  17   75   265   16   3    33
6    0    5   0   10   0   0  578   271   21   0  2182
7    1   38   0    4   0   0    1  1106    0   0    14
8    0    6   0   80   0   0   97   269  398   0   520
9    0   23   0   68   0   1   94   824    7   0   120
10   0    0   0    1   0   0    2     5    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-22 01:37:40.599875,epoch time: 0:31:50.266215,used: 9:04:54.966402,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.82561004, 'precision': 0.7319399, 'recall': 0.5290659, 'specificity': 0.97956413, 'f1': 0.5702716, 'auroc': 0.96675956}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   101     6   0    55   0    2   107    81     8    0    123
1     0  1058   0    13   0    0     2   239     3    0     17
2     2     1  42    41  12    9    49    56    16   39     45
3     1     4   1  7322   1   28    23   726   276    2     51
4     0     0  10    35  19    3    76    19    50    5    321
5     2     0   0   236   0  211     9     5    16   39      3
6     3    13   0    46   0    3  1375    61    33    3    371
7     1    29   0   582   1    2    14  6351    82    2    200
8     0     2   2   455   1    8    36   282  1901    2    606
9     3     2  11   147   4  101    52    25    19  116     13
10    0     5   0    64   3    2   102   135   122    0  12362
---- Validation: 
scalar performance:
{'acc': 0.8258125, 'precision': 0.7348895, 'recall': 0.52718174, 'specificity': 0.979618, 'f1': 0.5651473, 'auroc': 0.9673021}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   102     5   0    50   0    1   107    88     7    1    122
1     0  1055   0    14   0    0     2   235     3    0     23
2     2     2  28    46   6    8    52    47    28   44     49
3     1     8   0  7314   0   30    15   745   274    1     52
4     0     0   7    42  17    2    73    22    44    4    328
5     1     0   2   235   0  213    11     2    20   34      3
6     1    15   0    30   0    3  1410    58    36    2    353
7     1    45   2   560   0    1    13  6336   108    1    198
8     0     3   0   454   0    3    35   276  1938    2    585
9    10     2  14   149   1   98    43    31    17  116     12
10    1     6   0    58   3    2    96   146   140    0  12344
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.31651857, 'precision': 0.39236584, 'recall': 0.26365647, 'specificity': 0.93013847, 'f1': 0.19852659, 'auroc': 0.80036336}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   62   72   0    4   0   1  417   537    3   0    74
1    1  501   0    7   0   0   15   925    1   0    49
2    0   10   0   22   1   0  101   355   15   0   511
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    4    36    2   0  1591
5    9    5   0  185   0  23  101   228   11   0    30
6    0    5   0   11   0   0  845   210   16   0  1980
7    1   38   0    4   0   0   12  1096    0   0    13
8    0    5   0   92   0   0  157   247  358   0   511
9    2   21   0   81   0   2  150   758    4   0   119
10   0    0   0    1   0   0    3     3    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-22 02:09:29.005096,epoch time: 0:31:48.405221,used: 9:36:43.371623,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8255833, 'precision': 0.7334397, 'recall': 0.5267595, 'specificity': 0.9795974, 'f1': 0.56838816, 'auroc': 0.9673423}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   92     8   1    53   1    0   117    87     2    3    119
1    0  1064   0    16   0    0     2   227     3    1     19
2    2     1  41    37  11    8    47    59    18   39     48
3    0     3   0  7346   1   15    22   708   291    5     48
4    0     0  12    40  18    1    80    19    51    6    312
5    2     1   1   252   0  165    18     4    18   56      4
6    1    16   0    45   0    1  1368    62    38    3    373
7    1    35   2   587   0    1    16  6343    88    3    187
8    0     2   2   456   5    5    47   280  1920    3    576
9    3     0   6   143   0   72    50    28    19  155     17
10   1     5   1    67   3    1    91   156   120    2  12345
---- Validation: 
scalar performance:
{'acc': 0.82797915, 'precision': 0.7451211, 'recall': 0.5302514, 'specificity': 0.97987854, 'f1': 0.5720017, 'auroc': 0.9694585}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   106     5   0    54   0    2   105    78     5    2    126
1     1  1069   0    16   0    0     3   220     5    1     17
2     3     2  42    38   4    7    51    53    18   41     53
3     0     4   0  7365   0   18    15   713   282    3     40
4     0     0  10    40  18    1    77    19    44    4    326
5     1     0   1   257   0  167    16     2    19   55      3
6     6    15   0    48   0    2  1404    48    41    5    339
7     1    30   1   616   0    2    17  6336    83    1    178
8     0     1   0   426   1    2    40   285  1960    3    578
9     4     1  16   138   3   75    46    34    19  139     18
10    2     2   1    57   1    0   109   134   140    2  12348
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3223956, 'precision': 0.39348882, 'recall': 0.2671428, 'specificity': 0.93073034, 'f1': 0.20213026, 'auroc': 0.80187005}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0   65   83   0    5   0   1  411   523    3   0    79
1    1  554   0    8   0   0   15   873    1   0    47
2    0   10   0   24   1   0  103   349   14   0   514
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    4    36    2   0  1591
5    9    5   0  189   0  15  106   223   12   3    30
6    0    6   0   11   0   0  873   201   17   0  1959
7    1   45   0    4   0   0   12  1089    0   0    13
8    0    6   0   96   0   0  156   239  372   0   501
9    2   25   0   90   0   1  153   743    4   0   119
10   0    0   0    1   0   0    3     2    0   0  1640
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-22 02:41:20.073838,epoch time: 0:31:51.068742,used: 10:08:34.440365,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8309075, 'precision': 0.73597, 'recall': 0.54012024, 'specificity': 0.98020166, 'f1': 0.5866242, 'auroc': 0.96847683}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   122     1   1    47   0    2    74    98     4    4    130
1     0  1063   0    13   0    0     4   229     5    0     18
2     2     0  41    45  18    6    31    51    13   58     47
3     0     5   0  7430   0   17     9   672   261    7     39
4     0     0  10    39  43    2    64    27    48    8    298
5     4     0   0   250   0  168     6     3    12   75      3
6     4     7   0    36   1    1  1373    65    49    6    366
7     1    32   0   597   2    2    11  6360    95    3    159
8     1     3   0   492   2    4    26   261  1948    3    553
9     8     0  23   141   3   60    41    31    10  160     16
10    1     4   1    60   6    2    76   157   135    3  12348
---- Validation: 
scalar performance:
{'acc': 0.8290758, 'precision': 0.73420155, 'recall': 0.5368029, 'specificity': 0.9800254, 'f1': 0.58215624, 'auroc': 0.96814567}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   116     8   1    52   0    0    84    85    11    2    124
1     0  1052   0    14   0    0     0   242     5    1     18
2     1     1  40    46  23    6    32    46    15   56     46
3     0     5   0  7418   1   15    18   663   280    5     35
4     0     1   7    45  38    0    66    22    40   11    309
5     2     1   3   240   2  165     8     7    16   74      3
6     4    15   0    46   0    3  1360    61    38    5    376
7     1    36   0   602   0    3    10  6357    94    4    158
8     0     2   0   473   3    4    24   295  1944    5    546
9     4     1  11   142   7   70    40    26    14  167     11
10    1     4   0    63  11    1    81   150   144    3  12338
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3186175, 'precision': 0.3972897, 'recall': 0.26637876, 'specificity': 0.93055785, 'f1': 0.20356596, 'auroc': 0.8039421}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   100   62   0    6   0   1  364   553    3   0    81
1     1  474   0    9   0   0   13   955    1   0    46
2     0    7   0   32   2   0   83   373   12   0   506
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    4    40    2   0  1587
5    17    4   0  205   0  18   86   219   12   6    25
6     0    4   0   15   0   0  832   231   21   0  1964
7     1   32   0    6   0   0    8  1104    0   0    13
8     0    4   0  109   0   0  136   246  388   0   487
9     5   14   0  100   1   1  136   766    4   0   110
10    0    0   0    1   0   0    3     4    0   0  1638
better model found
persisted
after epoch: 20,now: 2024-07-22 03:13:18.617122,epoch time: 0:31:58.543284,used: 10:40:32.983649,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8319777, 'precision': 0.7333992, 'recall': 0.5503953, 'specificity': 0.980376, 'f1': 0.59408844, 'auroc': 0.9697234}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   119     7   0    52   1    1    83    72     5    3    140
1     0  1097   1    13   0    0     1   197     8    0     15
2     4     2  63    41  14   16    34    40    17   35     46
3     2     6   1  7358   3   17    20   680   312    4     35
4     1     0  13    27  35    3    51    22    63    1    323
5     5     1   1   215   0  225    11     4    20   37      2
6     4    20   0    38   0    2  1339    63    51    5    386
7     1    55   0   601   2    2    21  6266   121    2    188
8     1     3   2   387   2    7    27   245  2070    2    550
9     5     4  19   125   4  119    37    23    22  124     11
10    3     6   1    52   6    1    62   113   148    3  12400
---- Validation: 
scalar performance:
{'acc': 0.8303063, 'precision': 0.71913296, 'recall': 0.54718125, 'specificity': 0.98019457, 'f1': 0.58958936, 'auroc': 0.96923745}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   115    12   0    51   1    5    76    87     5    1    130
1     0  1109   1    14   0    0     4   184     9    0     11
2     4     4  63    37  23   12    26    41    18   35     49
3     0     4   0  7330   1   30    14   666   352    3     40
4     0     1  15    34  37    1    51    17    56    8    319
5     3     0   3   220   1  210    14     4    19   45      2
6     6    16   0    35   2    5  1357    56    53    1    377
7     1    46   2   569   4    4    15  6305   108    2    209
8     0     1   1   419   4    6    33   252  2002    4    574
9     5     3  25   122   3  121    27    26    27  124     10
10    2     3   0    44   5    3    80   123   144    3  12389
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3307913, 'precision': 0.38615996, 'recall': 0.28069395, 'specificity': 0.93167853, 'f1': 0.22195055, 'auroc': 0.8041809}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   126   99   0    6   0   2  350   479    4   0   104
1     1  686   0    9   0   0   11   735    1   0    56
2     0   20   0   25   1   0   78   306   17   0   568
3     0    0   0    0   0   0    0     0    0   0     0
4     0    1   0    0   0   0    2    26    3   0  1601
5    20    7   0  196   0  29   85   203   14   1    37
6     0    6   0   10   0   0  746   159   27   0  2119
7     1   59   0    5   0   0   11  1071    0   0    17
8     0   10   0   88   0   0  112   210  428   0   522
9     5   40   0   91   0   4  131   709    8   0   149
10    0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-22 03:45:11.988558,epoch time: 0:31:53.371436,used: 11:12:26.355085,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8326734, 'precision': 0.754212, 'recall': 0.54604, 'specificity': 0.98047376, 'f1': 0.5866842, 'auroc': 0.9699462}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   112     8   0    48   0    0   106    74     8    4    123
1     0  1063   1    18   0    0     1   223     7    1     18
2     1     4  44    42   5    6    45    38    17   61     49
3     0     8   1  7379   0   18    19   670   295    5     41
4     0     1  13    37  20    1    76    16    53   11    310
5     3     0   1   226   1  181    13     1    14   78      3
6     1    10   0    36   0    4  1406    50    41    5    354
7     1    33   0   566   0    3    28  6336   101    7    188
8     0     2   1   415   1    6    35   270  2009    7    550
9     2     0  12   128   0   69    34    20    20  192     16
10    0     4   1    58   3    0    85   116   147    1  12380
---- Validation: 
scalar performance:
{'acc': 0.83199143, 'precision': 0.745206, 'recall': 0.54760087, 'specificity': 0.9804085, 'f1': 0.58940715, 'auroc': 0.969059}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   114     9   0    58   1    0   101    69     7    5    119
1     0  1081   1    16   0    0     2   209     5    1     17
2     3     0  50    32   4    5    42    38    21   65     52
3     1     7   1  7372   2   18    22   659   306    6     46
4     0     1  10    38  23    1    71    17    54   15    309
5     1     0   3   215   0  190    10     1    19   80      2
6     3    13   0    38   0    0  1403    54    43    6    348
7     1    27   2   599   3    1    21  6324   109    5    173
8     2     0   0   428   3    6    41   266  1985    4    561
9     5     0  11   132   0   62    47    21    18  177     20
10    0     2   0    45   4    1    86   120   147    6  12385
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33554888, 'precision': 0.41441268, 'recall': 0.2780166, 'specificity': 0.9320104, 'f1': 0.21896549, 'auroc': 0.80693865}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   118   75   0    7   0   1  406   475    4   0    84
1     1  573   0   13   0   0   15   846    1   0    50
2     0    8   0   28   1   0  108   313   14   1   542
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    5    28    2   0  1598
5    15    4   0  205   0  21  113   183   12   9    30
6     0    5   0   11   0   0  946   152   19   0  1934
7     1   38   0    5   0   0   11  1093    0   0    16
8     0    3   0   98   0   0  152   214  402   0   501
9     5   23   0   95   0   2  182   694    5   2   129
10    0    0   0    1   0   0    3     1    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-22 04:16:55.681023,epoch time: 0:31:43.692465,used: 11:44:10.047550,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8365796, 'precision': 0.740401, 'recall': 0.56023484, 'specificity': 0.98085696, 'f1': 0.60656536, 'auroc': 0.97142303}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   150     7   0    41   1    1    67    80     5    2    129
1     0  1093   0    14   0    0     2   203     7    1     12
2     4     3  63    39  11    8    33    35    16   49     49
3     1     6   1  7449   1   19    13   630   273    4     40
4     0     2  19    36  35    1    55    19    46    7    319
5     3     0   2   224   0  191    10     3    12   73      3
6     7    16   0    46   1    1  1373    49    47    5    363
7     5    39   1   572   3    2    13  6326   100    2    202
8     2     4   0   430   0    4    32   254  2022    5    543
9     6     3  19   121   5   84    27    29    16  168     15
10    2     6   1    62   5    2    74   106   134    2  12398
---- Validation: 
scalar performance:
{'acc': 0.83485353, 'precision': 0.73685163, 'recall': 0.558744, 'specificity': 0.98063225, 'f1': 0.6047639, 'auroc': 0.9716445}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   139     6   0    51   1    1    73    70     9    1    132
1     0  1084   0    17   0    0     2   211     3    1     14
2     4     2  57    41  13    7    37    35    17   54     45
3     0     7   1  7450   0   18    12   621   280    4     47
4     1     0  15    37  37    2    61    22    40    6    318
5     4     0   2   220   0  200     8     2    20   63      2
6     9    18   0    38   1    4  1372    53    43    4    366
7     1    47   3   586   1    5    12  6309   101    1    199
8     3     1   1   430   3    6    29   245  1998    2    578
9     8     3  21   124   4   80    26    16    17  180     14
10    1     6   0    79   9    3    68   117   126    2  12385
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34051633, 'precision': 0.38990268, 'recall': 0.2876706, 'specificity': 0.9327513, 'f1': 0.23252559, 'auroc': 0.80796295}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   217   86   0    8   0   2  318   453    4   0    82
1     1  655   0   14   0   0   13   768    1   0    47
2     3   10   0   31   1   0   86   323   15   0   546
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    4    28    2   0  1599
5    36    5   0  213   0  23   80   182   13   5    35
6     1    6   0   15   0   0  831   171   23   0  2020
7     1   46   0    5   0   0   10  1087    0   0    15
8     2    8   0  104   0   0  122   220  412   0   502
9    14   33   0  103   0   3  134   706    7   0   137
10    0    0   0    1   0   0    2     1    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-22 04:48:54.118614,epoch time: 0:31:58.437591,used: 12:16:08.485141,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.8381314, 'precision': 0.72958195, 'recall': 0.55760074, 'specificity': 0.98118657, 'f1': 0.5991613, 'auroc': 0.9709098}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   124     7   0    57   0    1   114    66     4    1    109
1     0  1083   1    16   0    0     4   206     4    0     18
2     3     0  94    39  11    9    47    34    14   26     35
3     1     5   1  7494   1   22    23   607   241    1     41
4     0     1  20    39  25    1    82    20    47    5    298
5     4     0   7   230   0  191    17     3    15   50      4
6     3    12   1    34   1    0  1481    48    32    3    293
7     2    28   4   589   3    2    25  6353    95    1    162
8     1     2   2   436   1    3    42   254  2025    5    525
9     6     2  48   138   2   82    47    25    16  114     13
10    3     5   1    55   6    2    97   130   151    0  12342
---- Validation: 
scalar performance:
{'acc': 0.8409523, 'precision': 0.744074, 'recall': 0.5622324, 'specificity': 0.98150337, 'f1': 0.6056823, 'auroc': 0.9717336}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   123     7   0    50   1    4   106    70     5    2    115
1     1  1079   0    17   0    0     3   217     3    1     11
2     3     2  86    40  11    3    52    37    10   22     46
3     0     2   1  7519   1   25    22   575   253    2     40
4     0     1  24    35  36    2    77    24    41    6    293
5     1     0   7   222   1  207    16     3    13   47      4
6     5     9   0    36   0    1  1470    47    41    3    296
7     2    36   6   558   1    4    20  6378    82    1    177
8     1     1   0   421   1    2    51   248  2080    3    488
9    10     0  39   136   1   85    48    20    13  121     20
10    2     3   1    55   5    3    89   153   144    1  12340
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36409432, 'precision': 0.40353063, 'recall': 0.2925212, 'specificity': 0.9347286, 'f1': 0.23613742, 'auroc': 0.8121307}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   147   71   0    9   0   1   443   445    4   0    50
1     1  606   0   14   0   0    25   810    1   0    42
2     0    7   0   31   1   0   154   317   15   0   490
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     8    32    3   0  1590
5    21    5   0  219   0  20   134   158   13   0    22
6     0    6   0   13   0   0  1288   160   23   0  1577
7     1   38   0    9   0   0    19  1085    0   0    12
8     0    3   0  102   0   0   207   214  422   0   422
9     6   23   0  106   0   2   237   656    4   0   103
10    0    0   0    1   0   0     8     1    0   0  1636
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-22 05:20:52.112381,epoch time: 0:31:57.993767,used: 12:48:06.478908,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.83976346, 'precision': 0.74549794, 'recall': 0.56615716, 'specificity': 0.98126614, 'f1': 0.6117145, 'auroc': 0.97188395}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   145     4   1    48   0    1    80    77     3    3    121
1     0  1094   0    17   0    0     2   197     8    1     13
2     3     2  56    37  15   10    28    34    16   57     54
3     2     7   1  7510   0   22    19   546   291    4     35
4     0     1  18    35  39    1    48    23    53   12    309
5     4     1   1   215   2  192     7     5    18   74      2
6     5    16   0    38   0    3  1394    55    48    3    346
7     5    36   1   628   2    3    12  6267   109    1    200
8     1     3   1   422   2    4    20   244  2085    5    508
9     9     2  14   126   1   64    32    22    14  197     12
10    1     5   2    58   8    1    73   107   124    5  12408
---- Validation: 
scalar performance:
{'acc': 0.84023005, 'precision': 0.74942493, 'recall': 0.5692955, 'specificity': 0.98127174, 'f1': 0.61597633, 'auroc': 0.97093046}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   151     7   0    56   0    2    68    65     6    4    124
1     0  1093   0    15   0    0     1   202     5    0     16
2     7     2  65    38  17    5    29    40    22   48     39
3     1     3   0  7468   2   20    12   583   285   10     56
4     1     2  12    42  29    2    59    18    52    8    314
5     3     1   2   213   0  206     8     2    18   66      2
6     6    18   0    38   0    0  1379    56    49    6    356
7     4    36   3   583   1    1    11  6325    98    1    202
8     1     1   0   391   1    1    24   229  2097    6    545
9     5     1  21   119   5   70    23    23    23  191     12
10    0     5   2    56   1    2    77    97   147    1  12408
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.35380957, 'precision': 0.40780184, 'recall': 0.2958308, 'specificity': 0.9340243, 'f1': 0.24318802, 'auroc': 0.8111459}
confusion matrix:
     0    1   2    3   4   5    6     7    8   9     10
0   224   80   0   12   0   2  343   427    5   0    77
1     1  670   0   18   0   0   14   751    1   0    44
2     1    8   0   33   1   0  100   304   18   1   549
3     0    0   0    0   0   0    0     0    0   0     0
4     0    0   0    0   0   0    4    27    4   0  1598
5    35    4   0  237   0  23   93   146   15   7    32
6     1    6   0   15   0   0  952   147   27   0  1919
7     1   45   0    8   0   0   10  1085    0   0    15
8     1    7   0  105   0   0  133   198  461   0   465
9    12   32   0  122   0   2  167   661    6   1   134
10    0    0   0    1   0   0    3     1    0   0  1641
early stop counter: 1
val acc:0.8402300477027893, best validation acc: 0.8409522771835327, corresponding to test acc:                         0.3640943169593811 / 0.3640943169593811
after epoch: 25,now: 2024-07-22 05:52:41.929170,epoch time: 0:31:49.816789,used: 13:19:56.295697,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.84318817, 'precision': 0.74341184, 'recall': 0.5764372, 'specificity': 0.9817771, 'f1': 0.62141263, 'auroc': 0.97233427}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   158     6   0    52   0    0    82    69     8    3    105
1     0  1101   2    15   0    0     1   196     3    0     14
2     2     1  65    29  24    4    34    44    21   50     38
3     1     7   0  7532   1   20    18   550   269    3     37
4     1     1  19    35  43    0    66    17    48    6    303
5     3     0   3   213   0  188     7     0    14   89      4
6     3    13   0    34   1    2  1451    49    42    7    306
7     2    45   3   579   1    2    16  6362   100    2    150
8     4     3   2   443   3    4    35   240  2071    2    487
9     6     1  24   120   3   60    26    25    11  205     12
10    1     2   4    57   7    3    88   143   148    2  12339
---- Validation: 
scalar performance:
{'acc': 0.84116626, 'precision': 0.74764246, 'recall': 0.5744329, 'specificity': 0.9815465, 'f1': 0.6191107, 'auroc': 0.97245306}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   158     5   0    42   0    1    72    78    13    7    107
1     0  1119   0    12   0    0     3   176     8    0     14
2     6     2  59    33  16    7    36    38    16   61     38
3     3     4   0  7553   1   18    21   557   247    2     34
4     1     2  16    38  50    1    70    14    49   11    287
5     3     0   2   214   1  187     8     4    15   82      5
6    10    18   0    33   2    3  1428    45    46    6    317
7     5    48   0   629   0    5    11  6306    94    4    163
8     1     2   0   437   5    3    31   264  2058    3    492
9     8     3  18   116   3   57    32    20    20  203     13
10    0     2   2    58   6    0    91   138   170    3  12326
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37668788, 'precision': 0.43528914, 'recall': 0.3061644, 'specificity': 0.9362155, 'f1': 0.25401574, 'auroc': 0.81482905}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   245   83   0   12   0   2   375   399    4   0    50
1     1  683   0   18   0   0    18   736    1   0    42
2     3    9   0   33   2   0   141   318   17   0   492
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     7    31    3   0  1591
5    34    4   0  239   0  16   110   144   14   8    23
6     1    6   0   15   0   0  1250   163   24   0  1608
7     1   43   0    9   0   0    14  1085    0   0    12
8     1    7   0  115   1   0   173   208  465   0   400
9    14   33   0  124   0   1   206   645    5   1   108
10    0    0   0    1   0   0     6     1    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-22 06:24:31.480625,epoch time: 0:31:49.551455,used: 13:51:45.847152,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.84401757, 'precision': 0.7546844, 'recall': 0.5779212, 'specificity': 0.9819056, 'f1': 0.62262857, 'auroc': 0.9726129}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   167     4   2    41   0    2    76    60    13    4    114
1     1  1101   0    13   0    0     2   191     7    0     15
2     5     2  70    41  10    5    33    41    21   45     39
3     0     4   0  7414   1   18    15   624   326    0     37
4     0     0  18    35  30    3    72    24    55    4    298
5     3     0   4   209   0  212     8     2    21   60      2
6     6    14   0    31   0    4  1449    50    37    2    315
7     3    30   0   530   0    1    22  6395   122    6    153
8     2     1   1   366   1    4    36   239  2177    4    465
9     8     0  30   121   1   69    36    18    22  173     14
10    0     5   0    49   6    1    87   125   163    0  12358
---- Validation: 
scalar performance:
{'acc': 0.8426642, 'precision': 0.7608043, 'recall': 0.5772156, 'specificity': 0.98173714, 'f1': 0.6232611, 'auroc': 0.97302717}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   169     6   1    47   1    0    75    71     8    2    103
1     1  1087   0    18   0    0     2   200     8    0     16
2     4     2  68    39   6    9    36    46    22   28     52
3     1     7   1  7430   0   26    14   606   319    1     35
4     1     1  15    27  39    2    74    19    54   10    297
5     4     0   0   198   0  219    10     0    25   63      2
6     6    16   0    32   1    4  1424    53    53    3    316
7     3    37   2   558   1    4    19  6359   108    1    173
8     1     1   1   384   2    3    31   235  2166    1    471
9     8     2  25   106   2   83    34    25    23  171     14
10    3     4   0    48   5    1    79   114   169    2  12371
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37395927, 'precision': 0.405636, 'recall': 0.30706838, 'specificity': 0.93592185, 'f1': 0.25569934, 'auroc': 0.81463313}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   240   69   0   10   0   2   370   413    5   0    61
1     1  644   0   15   0   0    19   776    1   0    43
2     2    5   0   30   1   0   132   310   21   0   514
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   0   0     6    28    4   0  1595
5    34    4   0  223   0  26   110   145   18   4    28
6     0    5   0   12   0   0  1186   149   29   0  1686
7     1   34   0    7   0   0    12  1096    0   0    14
8     0    3   0   89   0   0   157   203  513   0   405
9    12   24   0  107   0   2   200   665   11   0   116
10    0    0   0    1   0   0     4     1    0   0  1640
better model found
persisted
after epoch: 27,now: 2024-07-22 06:56:23.792624,epoch time: 0:31:52.311999,used: 14:23:38.159151,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.8461312, 'precision': 0.7516737, 'recall': 0.58393145, 'specificity': 0.9822377, 'f1': 0.63055944, 'auroc': 0.97336614}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   169     5   0    43   1    0    83    70     4    3    105
1     0  1089   0    17   0    0     3   207     4    0     10
2     6     2  61    33  27    9    37    41    16   44     36
3     3     4   0  7400   1   20    12   669   297    2     32
4     0     1  15    27  67    0    69    24    63    7    264
5     4     0   3   195   1  236    10     3    14   53      2
6     7    15   0    29   0    3  1448    53    59    3    291
7     4    33   2   472   1    2    15  6479   102    3    151
8     3     1   0   375   4    7    24   273  2169    2    438
9    12     1  23   108   2   87    34    28    25  163     10
10    2     3   1    52   5    0    95   129   160    1  12344
---- Validation: 
scalar performance:
{'acc': 0.8453925, 'precision': 0.7494806, 'recall': 0.58274055, 'specificity': 0.98216975, 'f1': 0.628766, 'auroc': 0.9726705}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   161     5   0    38   0    1    87    72     6    3    110
1     0  1099   0    11   0    0     2   201     8    0     11
2     7     0  69    29  25    7    33    42    20   36     44
3     0     5   0  7366   2   26    13   676   317    0     35
4     1     1  14    38  57    2    76    23    51    7    269
5     4     0   1   210   1  210     5     6    20   60      4
6     4    12   0    24   2    3  1485    51    50    4    273
7     1    30   2   492   0    1    18  6464   109    1    147
8     2     1   3   361   4    6    35   274  2190    2    418
9    10     4  26   110   4   81    31    26    16  174     11
10    2     3   1    44   8    4    90   153   159    2  12330
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38123557, 'precision': 0.42611122, 'recall': 0.30921075, 'specificity': 0.9366602, 'f1': 0.25675356, 'auroc': 0.81646746}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   219   69   0   10   0   2   377   439    5   0    49
1     1  635   0   13   0   0    18   791    1   0    40
2     1    7   0   26   2   0   137   350   17   0   475
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     8    37    3   0  1584
5    34    4   0  213   0  27   111   164   14   4    21
6     0    5   0   12   0   0  1317   178   27   0  1528
7     1   29   0    6   0   0    11  1105    0   0    12
8     0    3   0   89   1   0   178   221  510   0   368
9    12   24   0   92   0   4   198   697   11   0    99
10    0    0   0    1   0   0     7     3    0   0  1635
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-22 07:28:23.574614,epoch time: 0:31:59.781990,used: 14:55:37.941141,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.8470944, 'precision': 0.7515422, 'recall': 0.5867435, 'specificity': 0.98222566, 'f1': 0.6353385, 'auroc': 0.97339916}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   163     7   0    44   2    1    61    69     8    5    123
1     0  1114   0    12   0    0     1   184     7    0     12
2     2     1  72    29  24    7    34    45    18   42     38
3     0     5   0  7409   3   20    16   641   305    1     40
4     0     1  24    32  74    0    44    23    53    9    279
5     3     0   6   203   0  219     8     3    17   59      3
6    10    11   0    35   0    1  1417    56    55    3    319
7     3    34   4   467   1    2    21  6437   120    3    171
8     0     1   1   366   1    1    21   244  2178    7    475
9     9     0  34   110   6   82    19    23    22  174     14
10    2     6   1    48  11    2    61   113   142    3  12404
---- Validation: 
scalar performance:
{'acc': 0.8476127, 'precision': 0.7558202, 'recall': 0.59091866, 'specificity': 0.9822252, 'f1': 0.6408099, 'auroc': 0.9724172}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   175     4   1    45   1    1    67    64    12    2    111
1     0  1096   0    13   0    0     1   201     6    0     15
2     7     4  86    28  21    5    27    34    12   41     47
3     1     5   0  7470   1   21    12   608   275    4     43
4     1     0  16    33  63    1    49    14    52    8    302
5     5     0   2   197   1  213     9     4    16   71      3
6     9    13   0    30   2    3  1415    50    51    3    332
7     3    41   3   484   4    3    20  6436   101    0    170
8     2     1   1   385   5    6    22   228  2144    5    497
9    10     2  27   115   6   67    33    19    14  188     12
10    2     0   2    43  11    0    63   125   146    2  12402
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37402925, 'precision': 0.42520535, 'recall': 0.30873442, 'specificity': 0.93600714, 'f1': 0.2585572, 'auroc': 0.81568694}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   268   75   0   12   0   2   335   404    6   0    68
1     1  673   0   14   0   0    16   751    1   0    43
2     2    6   0   29   2   0   118   307   18   1   532
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    28    3   0  1596
5    37    4   0  230   0  26    98   141   17   7    32
6     1    5   0   12   0   0  1145   143   27   0  1734
7     1   37   0    8   0   0    11  1092    0   0    15
8     1    4   0   91   2   0   143   198  501   0   430
9    12   28   0  104   0   2   189   668    9   0   125
10    0    0   0    1   0   0     4     1    0   0  1640
better model found
persisted
after epoch: 29,now: 2024-07-22 08:00:29.036365,epoch time: 0:32:05.461751,used: 15:27:43.402892,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.84535533, 'precision': 0.7463231, 'recall': 0.58461934, 'specificity': 0.9820624, 'f1': 0.631048, 'auroc': 0.97414386}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   161     5   2    49   1    3    62    74     8    6    112
1     0  1110   0    17   0    0     1   185     5    1     13
2     3     2  89    31  21    6    28    33    15   43     41
3     1     4   0  7474   0   24    11   598   291    2     34
4     0     1  26    32  54    2    53    21    66   12    272
5     5     0   5   208   0  190     6     2    20   82      3
6     8    14   0    39   0    2  1408    55    48    5    329
7     1    36   3   533   2    4    20  6404    95    2    163
8     2     1   2   375   7    6    27   275  2150    5    444
9     9     0  34   120   2   59    29    20    14  192     14
10    5     3   1    50   6    1    72   125   164    1  12364
---- Validation: 
scalar performance:
{'acc': 0.84632874, 'precision': 0.75265384, 'recall': 0.5848087, 'specificity': 0.98215103, 'f1': 0.6333443, 'auroc': 0.9735271}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   162     7   1    46   1    2    73    67     6    2    116
1     0  1099   0    11   0    0     3   196     7    0     16
2     4     1  83    32  18    6    33    34    14   46     41
3     2     3   0  7474   1   19     8   614   282    4     33
4     2     0  20    36  64    0    62    26    44    4    281
5     3     0   5   222   2  188     9     4    14   72      2
6     9    11   0    37   0    1  1438    54    37    7    314
7     3    35   0   547   4    2    18  6381   100    1    174
8     0     1   0   390   4    4    33   241  2192    5    426
9     8     0  37   114   6   68    28    20    14  186     12
10    0     7   2    57   8    1    63   126   157    2  12373
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37668788, 'precision': 0.44916102, 'recall': 0.30918837, 'specificity': 0.93631685, 'f1': 0.25789875, 'auroc': 0.8168643}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   266   70   0   14   0   2   337   411    6   0    64
1     1  653   0   17   0   0    17   767    1   0    43
2     1    6   0   30   1   0   121   319   20   0   517
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     6    29    3   0  1594
5    36    4   0  248   0  17   100   135   18   7    27
6     1    5   0   15   0   0  1186   155   29   0  1676
7     1   28   0    9   0   0    11  1102    0   0    13
8     1    3   0  100   1   0   149   201  518   0   397
9    12   25   0  119   0   1   190   661   10   1   118
10    0    0   0    1   0   0     4     1    0   0  1640
early stop counter: 1
val acc:0.8463287353515625, best validation acc: 0.8476126790046692, corresponding to test acc:                         0.3740292489528656 / 0.3812355697154999
after epoch: 30,now: 2024-07-22 08:32:33.754004,epoch time: 0:32:04.717639,used: 15:59:48.120531,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:59:48.120531 at 2024-07-22 08:32:33.754004
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37402925, 'precision': 0.42520535, 'recall': 0.30873442, 'specificity': 0.93600714, 'f1': 0.2585572, 'auroc': 0.81568694}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   268   75   0   12   0   2   335   404    6   0    68
1     1  673   0   14   0   0    16   751    1   0    43
2     2    6   0   29   2   0   118   307   18   1   532
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     5    28    3   0  1596
5    37    4   0  230   0  26    98   141   17   7    32
6     1    5   0   12   0   0  1145   143   27   0  1734
7     1   37   0    8   0   0    11  1092    0   0    15
8     1    4   0   91   2   0   143   198  501   0   430
9    12   28   0  104   0   2   189   668    9   0   125
10    0    0   0    1   0   0     4     1    0   0  1640
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38123557, 'precision': 0.42611122, 'recall': 0.30921075, 'specificity': 0.9366602, 'f1': 0.25675356, 'auroc': 0.81646746}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   219   69   0   10   0   2   377   439    5   0    49
1     1  635   0   13   0   0    18   791    1   0    40
2     1    7   0   26   2   0   137   350   17   0   475
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    0   1   0     8    37    3   0  1584
5    34    4   0  213   0  27   111   164   14   4    21
6     0    5   0   12   0   0  1317   178   27   0  1528
7     1   29   0    6   0   0    11  1105    0   0    12
8     0    3   0   89   1   0   178   221  510   0   368
9    12   24   0   92   0   4   198   697   11   0    99
10    0    0   0    1   0   0     7     3    0   0  1635
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_16_32_45_seed_1_22562326_instance_wise_predictions.txt
accuracy from prediction file 0.3740292450850066
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze_2024-07-20_23-24-22/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 193901 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |  20407 KiB |  39752 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 193901 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |  20407 KiB |  39752 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 191313 KiB | 459649 KiB |   1485 TiB |   1485 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1454 TiB |   1454 TiB |
|       from small pool |  18499 KiB |  37832 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 528384 KiB | 528384 KiB |    792 MiB | 282624 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  40960 KiB |  40960 KiB |     54 MiB |  14336 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47763 KiB |  87899 KiB |    829 TiB |    829 TiB |
|       from large pool |  31306 KiB |  79555 KiB |    798 TiB |    798 TiB |
|       from small pool |  16457 KiB |  21843 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    5870    |    7848    |  285783 K  |  285777 K  |
|       from large pool |      76    |     158    |  146817 K  |  146817 K  |
|       from small pool |    5794    |    7730    |  138965 K  |  138959 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    5870    |    7848    |  285783 K  |  285777 K  |
|       from large pool |      76    |     158    |  146817 K  |  146817 K  |
|       from small pool |    5794    |    7730    |  138965 K  |  138959 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      60    |      18    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      20    |      20    |      27    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    1293    |  148468 K  |  148468 K  |
|       from large pool |      10    |      22    |   88251 K  |   88251 K  |
|       from small pool |      24    |    1285    |   60216 K  |   60216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  39752 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  39752 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  37832 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 241664 KiB | 528384 KiB |    792 MiB | 569344 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  36864 KiB |  40960 KiB |     54 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87899 KiB |    829 TiB |    829 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    798 TiB |    798 TiB |
|       from small pool |      0 KiB |  30718 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7848    |  285783 K  |  285783 K  |
|       from large pool |       2    |     158    |  146817 K  |  146817 K  |
|       from small pool |       0    |    7730    |  138965 K  |  138965 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7848    |  285783 K  |  285783 K  |
|       from large pool |       2    |     158    |  146817 K  |  146817 K  |
|       from small pool |       0    |    7730    |  138965 K  |  138965 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      42    |      60    |      32    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      18    |      20    |      27    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1293    |  148470 K  |  148470 K  |
|       from large pool |       3    |      22    |   88251 K  |   88251 K  |
|       from small pool |       0    |    1285    |   60218 K  |   60218 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  39752 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 464389 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  39752 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 459649 KiB |   1485 TiB |   1485 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |  37832 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 241664 KiB | 528384 KiB |    792 MiB | 569344 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  36864 KiB |  40960 KiB |     54 MiB |  18432 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87899 KiB |    829 TiB |    829 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    798 TiB |    798 TiB |
|       from small pool |      0 KiB |  30718 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7848    |  285783 K  |  285783 K  |
|       from large pool |       2    |     158    |  146817 K  |  146817 K  |
|       from small pool |       0    |    7730    |  138965 K  |  138965 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7848    |  285783 K  |  285783 K  |
|       from large pool |       2    |     158    |  146817 K  |  146817 K  |
|       from small pool |       0    |    7730    |  138965 K  |  138965 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      28    |      42    |      60    |      32    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      18    |      20    |      27    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1293    |  148470 K  |  148470 K  |
|       from large pool |       3    |      22    |   88251 K  |   88251 K  |
|       from small pool |       0    |    1285    |   60218 K  |   60218 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_10_53_seed_2_22562326

 Experiment start at: 2024-07-22 09:10:53.977044
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5044414, 'precision': 0.22984406, 'recall': 0.16765484, 'specificity': 0.9361266, 'f1': 0.1517222, 'auroc': 0.73614573}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   2   0    54   0   0   2    58    1   0    366
1    0  32   0    70   1   0   3   537    3   0    686
2    0   0   0    75   0   0   0    40    1   0    196
3    0   6   0  4288   2   0  19  1605   35   0   2483
4    0   0   0    79   0   0   0    30    8   0    422
5    0   0   0   276   0   0   0    28    1   0    216
6    1   7   0   367   0   0  10   118   15   0   1389
7    0   4   0  1292   0   0   6  2682    7   0   3274
8    0   0   0  1169   0   0   5   214   52   0   1856
9    0   0   0   200   1   0   0    43    1   0    248
10   0   0   0   459   1   0   9   421  110   0  11790
---- Validation: 
scalar performance:
{'acc': 0.5062191, 'precision': 0.22358477, 'recall': 0.16773356, 'specificity': 0.93634504, 'f1': 0.15113446, 'auroc': 0.73704785}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   1   0    59   0   0   1    56   1   0    365
1    0  23   0    61   0   1   6   532   2   0    707
2    0   0   0    80   0   0   0    36   0   0    196
3    0   8   0  4329   0   0  20  1567  39   0   2477
4    0   1   0    96   0   0   0    28   2   0    412
5    0   0   0   270   1   0   0    24   0   0    226
6    0   4   0   344   0   0   8   117  12   0   1423
7    1   2   0  1309   2   0  12  2694   8   0   3237
8    1   0   0  1170   1   0   5   244  54   1   1820
9    0   1   0   212   0   0   1    38   3   0    238
10   0   0   0   444   2   0   9   434  90   0  11817
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.13181278, 'precision': 0.055257857, 'recall': 0.10947356, 'specificity': 0.9112275, 'f1': 0.036590714, 'auroc': 0.5844706}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   0   0   0   0   0   0  403   0   0   767
1    0   0   0   0   0   0   0  362   0   0  1137
2    0   0   0   4   0   0   0  104   1   0   906
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   0   0   0   0    9   0   0  1624
5    0   0   0  36   0   0   0  176   2   0   378
6    0   1   0   0   0   0   0   38   0   0  3028
7    0   0   0   0   0   0   0  236   0   0   928
8    0   0   0  16   0   0   0   70   2   0  1282
9    0   0   0   9   0   0   0  245   1   0   882
10   0   0   0   0   0   0   0    0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 09:44:38.073566,epoch time: 0:33:44.096522,used: 0:33:44.096522,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_10_53_seed_2_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.62093323, 'precision': 0.3452328, 'recall': 0.22882816, 'specificity': 0.9521823, 'f1': 0.21910813, 'auroc': 0.8444783}
confusion matrix:
    0    1   2     3   4   5   6     7    8   9      10
0    0    4   0    84   0   0   3    77    2   0    313
1    0  240   0    81   0   0   2   724    2   0    283
2    0    0   0   109   0   0   0    31    3   0    169
3    0   11   0  6376   0   0   5  1343   23   0    679
4    0    1   0    89   0   0   0    12    3   0    434
5    0    0   0   430   0   0   1     8    3   0     79
6    0    7   0   289   0   0  37    72   22   0   1481
7    0   20   0  1769   0   0   0  4115    7   0   1352
8    0    2   0  1282   0   0   1   152  102   0   1755
9    0    3   0   315   0   0   2    25    4   0    143
10   0    0   0   262   0   0   4   137   54   0  12338
---- Validation: 
scalar performance:
{'acc': 0.6198743, 'precision': 0.34407327, 'recall': 0.22797844, 'specificity': 0.95209146, 'f1': 0.21813495, 'auroc': 0.84667635}
confusion matrix:
    0    1   2     3   4   5   6     7    8   9      10
0    0    8   0    88   0   0   2    77    1   0    307
1    0  231   0    80   0   0   2   722    3   1    293
2    0    0   0   106   0   1   0    34    2   0    169
3    0   14   0  6330   1   0   2  1345   43   0    705
4    0    0   0    97   0   0   0    11    6   0    425
5    0    1   0   434   0   0   0     9    2   2     73
6    0    7   0   304   0   0  39    65   28   0   1465
7    0   17   0  1748   0   0   0  4133   11   0   1356
8    0    1   0  1318   0   0   2   155  101   0   1719
9    0    0   0   319   1   0   1    24    1   0    147
10   0    1   0   266   0   0   6   129   54   0  12340
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.17057301, 'precision': 0.09095346, 'recall': 0.1526883, 'specificity': 0.91562057, 'f1': 0.055919614, 'auroc': 0.6510948}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9     10
0    0   3   0   0   0   0   0   616   0   0   551
1    0   3   0   3   0   0   0  1033   0   0   460
2    0   0   0   3   0   0   0   173   1   0   838
3    0   0   0   0   0   0   0     0   0   0     0
4    0   0   0   0   0   0   0    11   0   0  1622
5    0   0   0  78   0   0   0   254   3   0   257
6    0   3   0   1   0   0   0    40   0   0  3023
7    0   7   0   1   0   0   0   786   0   0   370
8    0   1   0  38   0   0   0   117   4   0  1210
9    0   0   0  20   0   0   0   466   1   0   650
10   0   0   0   0   0   0   0     1   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 10:16:32.352188,epoch time: 0:31:54.278622,used: 1:05:38.375144,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_22_09_10_53_seed_2_22562326
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
slurmstepd: error: *** JOB 22562326 ON gpusrv12 CANCELLED AT 2024-07-22T10:29:20 ***
