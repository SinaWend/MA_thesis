Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 23:29:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784

 Experiment start at: 2024-07-20 23:54:31.337027
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.4354131, 'precision': 0.1667856, 'recall': 0.24444622, 'specificity': 0.9417177, 'f1': 0.16935305, 'auroc': 0.8680996}
confusion matrix:
    0   1   2     3   4   5      6     7   8   9    10
0    0   0   0    45   0   0    101   132   0   0  205
1    0   0   0    24   0   0   1201   102   0   0    5
2    0   0   0    19   0   0     39    15   0   0  239
3    0   0   0  8048   0   0     14   359   0   0   17
4    0   0   0     5   0   0    323    32   0   0  178
5    0   0   0   301   0   1      1     0   0   0  218
6    0   0   0    56   0   0   1583   146   0   0  123
7    0   0   0   612   0   7    142  6460   0   0   43
8    0   0   0   755   0   0    551  1781   0   0  207
9    0   0   0    89   0   0      2     0   0   0  402
10   0   0   0    16   0   0  12472   123   0   0  182
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.4347198, 'precision': 0.15544704, 'recall': 0.24340211, 'specificity': 0.941634, 'f1': 0.16879478, 'auroc': 0.8675827}
confusion matrix:
    0   1   2     3   4   5      6     7   8   9    10
0    0   0   0    43   0   0    103   126   0   0  211
1    0   0   0    25   0   0   1199   101   0   0    7
2    0   0   0    20   0   0     26    14   0   0  252
3    0   0   0  8077   0   1     14   325   0   0   23
4    0   0   0    10   0   0    329    34   0   0  166
5    0   0   0   309   0   0      0     1   0   0  211
6    0   0   0    47   0   0   1569   146   0   0  146
7    0   0   0   646   0   7    153  6418   0   0   41
8    0   0   0   733   0   0    583  1779   0   0  201
9    0   0   0    97   0   0      3     1   0   0  392
10   0   0   0    16   0   0  12450   142   0   0  188
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.28972223, 'precision': 0.07057387, 'recall': 0.17648521, 'specificity': 0.9231864, 'f1': 0.10074006, 'auroc': 0.70741177}
confusion matrix:
    0   1   2    3   4   5     6     7   8   9    10
0    0   0   0   76   0   0    21   486   0   0  587
1    0   0   0   32   0   0  1176   282   0   0    9
2    0   0   0   14   0   0   327    92   0   0  582
3    0   0   0    0   0   0     0     0   0   0    0
4    0   0   0    0   0   0  1605     3   0   0   25
5    0   0   0  155   0   0     0     4   0   0  433
6    0   0   0    1   0   0  3032    20   0   0   14
7    0   0   0    8   0   0    25  1109   0   0   22
8    0   0   0  144   0   1   300   655   0   0  270
9    0   0   0   90   0   2    64    78   0   0  903
10   0   0   0    0   0   0  1646     0   0   0    0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 00:39:12.750287,epoch time: 0:44:41.413260,used: 0:44:41.413260,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.87109375, 'precision': 0.50218874, 'recall': 0.4974901, 'specificity': 0.984924, 'f1': 0.49413157, 'auroc': 0.95662516}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   2    15   0   0    32   329    22   0     83
1    0  1156   7    11   0   0     6   137     3   0     11
2    0     1  23    15   0   0     1   108    15   0    149
3    0     0   0  7902   0   0     3   441    92   0      2
4    0     0  33    10   0   0    25    67    75   0    329
5    0     0   0   386   0   0     0     6     7   0    121
6    0     0   0    20   0   0  1778    57    12   0     39
7    0     4   0   283   0   0     9  6909    41   0     17
8    0     0   0   270   0   0    63   472  2457   0     32
9    0     0   6   139   0   0     1    67     6   0    274
10   0     0  27    14   0   0   208   126    87   0  12333
---- Validation: 
scalar performance:
{'acc': 0.87299716, 'precision': 0.5060774, 'recall': 0.4989978, 'specificity': 0.98511845, 'f1': 0.4956987, 'auroc': 0.95681274}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   3    10   0   0    31   339    23   0     77
1    0  1161   9    14   0   0     4   131     3   0     10
2    0     0  23    11   0   0     3    96    20   0    159
3    0     0   0  7922   0   0     9   435    72   0      2
4    0     1  22     9   0   0    23    68    71   0    345
5    0     0   1   379   0   0     0     8     6   0    127
6    0     0   2    16   0   0  1780    55    17   0     38
7    0     5   0   274   0   0     8  6926    33   0     19
8    0     0   0   241   0   0    67   474  2487   0     27
9    0     0   5   122   0   0     1    76     7   0    282
10   0     0  21    16   0   0   204   122    95   0  12338
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5258518, 'precision': 0.34284836, 'recall': 0.3877929, 'specificity': 0.9526131, 'f1': 0.31484282, 'auroc': 0.795083}
confusion matrix:
    0    1   2    3   4   5     6     7     8   9     10
0    0    0   0   12   0   0     3  1117    32   0     6
1    0  859  28   21   0   0    34   500     2   0    55
2    0    0  25   16   0   0    12   522   175   0   265
3    0    0   0    0   0   0     0     0     0   0     0
4    0    0   6    0   0   0    26    15    24   0  1562
5    0    0   0  325   0   0     0   129    23   0   115
6    0    0   0    0   0   0  2772    11     7   0   277
7    0    0   0   11   0   0     3  1147     0   0     3
8    0    0   0   86   0   0     4   212  1067   0     1
9    0    0   7   97   0   0     2   786    69   0   176
10   0    0   0    0   0   0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 01:23:12.120549,epoch time: 0:43:59.370262,used: 1:28:40.783522,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8717894, 'precision': 0.5666662, 'recall': 0.57959276, 'specificity': 0.9852089, 'f1': 0.56889486, 'auroc': 0.96789587}
confusion matrix:
     0     1    2     3   4   5     6     7     8   9      10
0   325     0    1     2   0   0    44     7     1   0    103
1     0  1165    1     4   0   0     5   144     6   0      7
2    43     1  115     6   0   0     2    43     2   0    100
3     2     1    2  7200   0   0    67   884   258   0     23
4    20     0   60     4   0   0    14    20    15   0    406
5    60     0    3   351   0   0    10     3     4   0     90
6    19     1    0     6   0   0  1781    11     2   0     86
7     0    12   11    90   0   0    41  6969    45   0     95
8     7     0    4   111   0   0   291   275  2386   0    222
9   152     2   36    98   0   0     7    33     2   0    163
10   35     9   10     7   0   0    57    26     7   0  12643
---- Validation: 
scalar performance:
{'acc': 0.8705631, 'precision': 0.566763, 'recall': 0.57723117, 'specificity': 0.9850693, 'f1': 0.567952, 'auroc': 0.96780574}
confusion matrix:
     0     1    2     3   4   5     6     7     8   9      10
0   320     0    2     3   0   0    44    13     0   0    101
1     0  1168    1     4   0   0     4   139     5   0     11
2    38     2  114     5   0   0     4    47     3   0     99
3     1     1    4  7177   0   0    78   891   270   0     18
4    19     0   43     4   0   0    20    19    13   0    421
5    65     0    0   349   0   0    11     6     4   0     86
6    18     0    1     4   0   0  1768    14     1   0    102
7     1    13   12    86   0   0    41  6963    57   0     92
8     3     1    2   105   0   0   322   264  2372   0    227
9   139     1   42   112   0   0     6    37     3   0    153
10   25     7   17     6   0   0    56    19     2   0  12664
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57895476, 'precision': 0.4007035, 'recall': 0.45488426, 'specificity': 0.9570637, 'f1': 0.38722026, 'auroc': 0.8273686}
confusion matrix:
     0    1   2    3   4   5     6     7     8   9     10
0   899    0   0    2   0   0   184    38    12   0    35
1     4  911  13   13   0   0    32   482    10   0    34
2   204    0  36    4   0   0    67   162    50   0   492
3     0    0   0    0   0   0     0     0     0   0     0
4     3    0   2    0   0   0     5     4     3   0  1616
5   266    0   0  162   0   0    81     5    11   0    67
6     0    0   0    0   0   0  2594     0     0   0   473
7     4    0   0    1   0   0     6  1150     0   0     3
8    13    0   0   25   0   0   134   143  1039   0    16
9   510    0  50   46   0   0    28   288    53   0   162
10    0    0   0    0   0   0     0     0     0   0  1646
new oracle model saved
early stop counter: 1
val acc:0.8705630898475647, best validation acc: 0.8729971647262573, corresponding to test acc:                         0.5258517861366272 / 0.5789547562599182
after epoch: 3,now: 2024-07-21 02:06:53.303818,epoch time: 0:43:41.183269,used: 2:12:21.966791,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.89495933, 'precision': 0.60194343, 'recall': 0.5955183, 'specificity': 0.98805404, 'f1': 0.58403116, 'auroc': 0.97807}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   398     0   0     8   0   0    42     6     4   0     25
1     0  1233   0    20   0   0     0    70     4   0      5
2    18    40  51    38   1   0     1   109     5   0     49
3     0     2   0  8234   0   0     1   136    64   0      0
4    30    20  14    38   0   0    23    34    55   0    325
5    16     2   0   475   0   0     3    12     3   0     10
6    13     0   0    21   0   0  1858     4     2   0      9
7     2     8   0   517   0   0     6  6689    35   0      6
8     3     2   0   448   0   0    34   155  2641   0     13
9    65    34  17   244   0   0     7    94     5   0     27
10   82     1   0    20   0   0   237    33    74   0  12346
---- Validation: 
scalar performance:
{'acc': 0.89482415, 'precision': 0.59448904, 'recall': 0.5908662, 'specificity': 0.9880215, 'f1': 0.57705784, 'auroc': 0.9775467}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   402     0   0    12   0   0    37     5     4   0     23
1     0  1229   0    20   0   0     1    74     3   0      5
2    19    46  34    32   0   0     3   120     7   0     51
3     1     1   0  8249   0   0     4   130    55   0      0
4    30    13   9    54   0   0    35    27    56   0    315
5    11     2   0   480   0   0     4     8     3   0     13
6    16     0   0    20   0   0  1853     3     4   0     12
7     1    14   0   490   0   0     4  6706    40   0     10
8     3     0   0   454   0   0    36   150  2634   0     19
9    58    30  19   239   0   0     6    96     3   0     42
10   96     0   1    23   0   0   209    36    85   0  12346
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63898414, 'precision': 0.42146426, 'recall': 0.49626964, 'specificity': 0.9638036, 'f1': 0.4230004, 'auroc': 0.8222764}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1136     0   0    5   0   0    14     7     7   0     1
1      4  1061   1   28   0   0    29   330    10   0    36
2    243    10  11   27   0   0    74   153   209   0   288
3      0     0   0    0   0   0     0     0     0   0     0
4      7     0   1    1   0   0    27     3    13   0  1581
5    130     0   0  349   0   0    35     2     7   0    69
6      0     0   0    1   0   0  3032     2     0   0    32
7     18     0   0   55   0   0     4  1085     0   0     2
8     13     0   0  113   0   0    43    32  1166   0     3
9    361    24  16  206   0   0    23   242   139   0   126
10     0     0   0    0   0   0     3     1     0   0  1642
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-21 02:50:44.999915,epoch time: 0:43:51.696097,used: 2:56:13.662888,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8953874, 'precision': 0.5922091, 'recall': 0.5712447, 'specificity': 0.98788464, 'f1': 0.56449294, 'auroc': 0.9796448}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   362     0   0     9   0   0    25     6     0   0     81
1     0  1273   0    18   0   0     1    31     1   0      7
2     8   141   5    23   0   0     2    87     2   0     44
3     1     7   0  8196   0   0     1   204    29   0      1
4     6    46   3    21   0   0    18    40     9   0    396
5     3     4   1   466   0   0     2    33     2   0      9
6     8     2   0    14   0   0  1830     8     1   0     44
7     0   103   0   295   0   0    11  6806    32   0     17
8     1    38   0   615   0   0    71   189  2317   0     65
9    10    87   5   198   0   0     2   170     1   0     20
10   10     3   1     9   0   0    40    35    17   0  12677
---- Validation: 
scalar performance:
{'acc': 0.8952521, 'precision': 0.5957309, 'recall': 0.5707129, 'specificity': 0.9878416, 'f1': 0.5648468, 'auroc': 0.98069495}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   355     1   0     8   0   0    30    12     1   0     76
1     0  1274   0    15   0   0     0    33     1   0      9
2     6   147   5    18   0   0     1    78     1   0     56
3     0     6   0  8183   0   0     1   218    31   0      1
4     5    47   1    24   0   0    14    32    13   0    403
5     3     8   1   469   0   0     1    32     0   0      7
6     9     0   0     9   0   0  1840     8     3   0     39
7     0    97   0   307   0   0     5  6811    27   0     18
8     2    27   0   619   0   0    62   177  2338   0     71
9     7    83   7   196   0   0     0   171     1   0     28
10   10    10   0    13   0   0    48    35    17   0  12663
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5604142, 'precision': 0.45466423, 'recall': 0.46584642, 'specificity': 0.9560789, 'f1': 0.4168569, 'auroc': 0.81295586}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1019     0   1   21   0   0    18    37    24   0    50
1      0  1355   1   26   0   0     4    94     2   0    17
2     20    80   8   96   0   0    58   112   132   0   509
3      0     0   0    0   0   0     0     0     0   0     0
4      1     3   0    1   0   0     7     2     6   0  1613
5      3     1   0  557   0   0     2    11     2   0    16
6      2     5   0    1   0   0  1762     1     0   0  1296
7      2     1   0   24   0   0     0  1134     0   0     3
8      0     3   0  208   0   0    27    36  1087   0     9
9     23   170   7  444   0   0     7   225    86   0   175
10     0     1   0    0   0   0     0     0     0   0  1645
better model found
persisted
after epoch: 5,now: 2024-07-21 03:34:41.637027,epoch time: 0:43:56.637112,used: 3:40:10.300000,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.91058433, 'precision': 0.6027137, 'recall': 0.59677035, 'specificity': 0.9897342, 'f1': 0.5806229, 'auroc': 0.9827264}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   400     2   0     3   0   0    24     6     1   0     46
1     0  1274   0    12   0   0     3    33     4   0      6
2    11   125   9     6   0   0     3    72     5   0     81
3     2     6   0  8011   0   0    10   234   177   0      0
4     8    45   3    13   0   0     7    26    33   0    404
5    10    14   0   425   0   0     1    35     6   0     30
6    11     1   0     2   0   0  1850     4     6   0     34
7     3    60   0   188   0   0     4  6899    76   0     33
8     0     6   0   111   0   0    35   168  2937   0     38
9    24   140   6   139   0   0     6   101     4   0     73
10   17     4   1     8   0   0    48    22    37   0  12654
---- Validation: 
scalar performance:
{'acc': 0.91098034, 'precision': 0.5961616, 'recall': 0.59664166, 'specificity': 0.98983216, 'f1': 0.5782187, 'auroc': 0.98278844}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   398     3   0     7   0   0    17     3     2   0     53
1     0  1270   0    10   0   0     1    38     3   0     10
2     9   128   9     7   0   0     3    72    11   0     73
3     3     4   0  8013   0   0     5   231   184   0      0
4    12    58   4    13   0   0    11    25    27   0    389
5    11    15   0   420   0   0     2    32     9   0     32
6    16     5   0     6   0   0  1849     0     5   0     27
7     6    53   0   203   0   0     9  6913    64   0     17
8     0     9   0   108   0   0    33   148  2962   0     36
9    37   143   7   134   0   0     2   100     4   0     66
10   20     5   0    10   0   0    56    19    43   0  12643
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65458614, 'precision': 0.42539626, 'recall': 0.5129108, 'specificity': 0.9652235, 'f1': 0.44090447, 'auroc': 0.81749016}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1104     0   0    9   0   0    20     8     7   0    22
1      3  1280   0   13   0   0     4   152     8   0    39
2     61    52  15   13   0   0    71   183   166   0   454
3      0     0   0    0   0   0     0     0     0   0     0
4      2     5   0    0   0   0     9     3     8   0  1606
5     38     5   1  390   0   0     3    11    30   0   114
6      2     0   0    1   0   0  2950     1     1   0   112
7      3     0   0   29   0   0     4  1117     0   0    11
8      2     0   0   36   0   0    22    60  1246   0     4
9    148   142  35  119   0   0    20   309   159   0   205
10     0     1   0    0   0   0     1     0     0   0  1644
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 04:19:18.848351,epoch time: 0:44:37.211324,used: 4:24:47.511324,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9068386, 'precision': 0.6262868, 'recall': 0.584737, 'specificity': 0.98897314, 'f1': 0.57651854, 'auroc': 0.98312026}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   384     0   0     9   0   0    19    17     1   0     53
1     0  1196   0    12   0   0     2   117     3   0      2
2    19    91  10    16   0   0     4    60    17   0     95
3     1     0   0  8039   0   0     2   295   101   0      0
4    12    12   1    21   0   0     5    16    28   0    443
5    13     6   0   393   0   0     0    15    10   0     83
6    10     1   0    15   0   0  1843    11     4   0     24
7     0     5   0   182   0   0     2  7009    49   0     17
8     0     1   0   173   0   0    33   179  2747   0    163
9    72    70   3   118   0   0     2    55    10   0    163
10   11     3   0    14   0   0    49    34    15   0  12666
---- Validation: 
scalar performance:
{'acc': 0.9066203, 'precision': 0.7075536, 'recall': 0.58328086, 'specificity': 0.9889359, 'f1': 0.57600236, 'auroc': 0.98203963}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   375     0   0     7   0   0    21    14     2   0     64
1     0  1209   0    13   0   0     0   106     3   0      1
2    18    88   7    17   0   0     7    72    14   0     89
3     1     0   0  8050   0   0     0   292    94   0      3
4    11    12   1    26   1   0     6    17    30   0    435
5    17     4   0   392   0   0     3    17     7   0     81
6    11     0   0    11   0   0  1850    11     3   0     22
7     0     5   0   208   0   0     1  6996    40   0     15
8     0     0   0   186   0   0    31   176  2741   0    162
9    51    75   4   116   0   0     1    66    14   0    166
10    8     2   0    10   0   0    59    34    18   0  12665
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60791993, 'precision': 0.43785825, 'recall': 0.47581092, 'specificity': 0.9605072, 'f1': 0.40989175, 'auroc': 0.817455}
confusion matrix:
     0    1   2    3   4   5     6     7     8   9     10
0   965    0   0   21   0   0    11    98    18   0    57
1     0  965   0   20   0   0     2   489    14   0     9
2    53   15   1   10   0   0    24   138   172   0   602
3     0    0   0    0   0   0     0     0     0   0     0
4     1    3   0    0   0   0     1     5     5   0  1618
5    48    0   0  280   0   0     7     2    14   0   241
6     0    0   0    3   0   0  2764     3     2   0   295
7     2    0   0    6   0   0     1  1153     0   0     2
8     4    0   0   87   0   0    19    37  1198   0    25
9   159   34   1  133   0   0    20   239   186   0   365
10    0    1   0    0   0   0     1     1     0   0  1643
early stop counter: 1
val acc:0.9066203236579895, best validation acc: 0.9109803438186646, corresponding to test acc:                         0.654586136341095 / 0.654586136341095
after epoch: 7,now: 2024-07-21 05:02:51.050578,epoch time: 0:43:32.202227,used: 5:08:19.713551,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8996682, 'precision': 0.7165437, 'recall': 0.5933145, 'specificity': 0.98859924, 'f1': 0.5803174, 'auroc': 0.9837669}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   403     0   0     0   0   0    10     1     4   0     65
1     0  1195   0    10   0   0    11    76    10   0     30
2    12   110   5     4   0   0     1    16    36   1    127
3    13     1   0  7935   0   1    40   131   293   0     23
4     5    15   1     5   0   0     6     4    48   1    453
5     5     0   0    19   0   1    10   345   124   6     11
6    13     0   0     1   0   0  1848     2     3   0     40
7    23    27   0   462   0   0    11  6444   261   0     35
8     4     1   0    85   0   0    16    44  3094   0     52
9    20    44   1     6   0   1    14    68   240  25     74
10   13     5   0     7   0   0    30    11    52   0  12676
---- Validation: 
scalar performance:
{'acc': 0.9008693, 'precision': 0.7220864, 'recall': 0.59408283, 'specificity': 0.9887367, 'f1': 0.5813785, 'auroc': 0.9836359}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   406     0   0     1   0   0    10     2     2   0     62
1     0  1211   0    11   0   0     6    74    12   0     18
2     6   104   4     1   0   0     1    13    42   4    137
3    12     3   0  7954   0   0    37   112   299   0     23
4     6    20   0     5   0   0     5     5    48   2    448
5     7     1   0    22   0   1     7   332   129  14      8
6    17     0   0     5   0   0  1833     3     5   0     45
7    14    30   0   451   0   0    10  6456   266   0     38
8     3     4   0    83   0   0    17    48  3090   0     51
9    18    48   1     5   0   1    17    75   235  24     69
10   10     2   0     9   0   0    20    21    33   1  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60442173, 'precision': 0.52432835, 'recall': 0.47312486, 'specificity': 0.95968676, 'f1': 0.4202403, 'auroc': 0.8150022}
confusion matrix:
      0    1   2    3   4   5     6    7     8    9     10
0   1006    0   0    3   0   3    55    6    14    6    77
1      6  990   3   21   0   1    30  326    35    0    87
2     14   21   3    4   0   2    89   74   222   16   570
3      0    0   0    0   0   0     0    0     0    0     0
4      0    1   0    0   0   0     5    1    12    0  1614
5      6    0   0   18   0  19    44  373    90   24    18
6      2    0   0    1   0   0  2767    1     2    0   294
7     63    3   0  126   0   0    18  918     9    1    26
8      9    0   0   74   0   1    49   13  1179    1    44
9     26   49   1   45   0  14    88  198   293  111   312
10     0    0   0    0   0   0     0    0     0    0  1646
early stop counter: 2
val acc:0.9008693099021912, best validation acc: 0.9109803438186646, corresponding to test acc:                         0.654586136341095 / 0.654586136341095
after epoch: 8,now: 2024-07-21 05:47:00.826871,epoch time: 0:44:09.776293,used: 5:52:29.489844,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9181828, 'precision': 0.64290464, 'recall': 0.6037177, 'specificity': 0.99076694, 'f1': 0.59558344, 'auroc': 0.9921502}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   378     2   0     3   0   0     4    12     4   0     80
1     0  1277   0     9   0   0     0    36     5   0      5
2     2   211   0     4   0   0     1    32    13   0     49
3     0     0   0  8053   0   0     5   184   196   0      0
4     3    47   0    14   0   0     0    13    37   0    425
5     2     7   0    82   0  45     0   339    44   0      2
6     5     1   0     3   0   0  1846     4    11   0     37
7     0    19   0   150   0   0     3  6881   197   0     15
8     0     5   0    68   0   1     5    47  3132   0     38
9     2   167   0    14   0  12     1   180   107   0     10
10    4     7   0    10   0   0    10    14    39   0  12706
---- Validation: 
scalar performance:
{'acc': 0.9168383, 'precision': 0.70158184, 'recall': 0.60278267, 'specificity': 0.99063194, 'f1': 0.5932487, 'auroc': 0.99166316}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   388     1   0     5   0   0     8     6     3   0     72
1     0  1275   0     8   0   0     0    44     2   0      3
2     2   202   0     9   0   0     0    37    13   1     48
3     0     2   0  8036   0   1     2   189   208   0      2
4     2    57   0    12   0   0     1    19    38   0    410
5     0     5   0    91   0  34     0   343    43   0      5
6    11     1   0     2   0   0  1837     6    15   0     36
7     0    29   0   140   0   0     2  6868   207   0     19
8     0     7   0    76   0   0     1    54  3112   0     46
9     1   179   0    14   0  15     0   168   100   3     13
10    1     5   0    10   0   0     8    14    35   0  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63044846, 'precision': 0.48318577, 'recall': 0.48685122, 'specificity': 0.962801, 'f1': 0.41467834, 'auroc': 0.8306241}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   763     5   0    7   0   0    11    73   132  14   165
1     0  1223   0   23   0   0     0   193    39   0    21
2     1    70   0   18   0   0     7    87   267   0   565
3     0     0   0    0   0   0     0     0     0   0     0
4     0     2   0    0   0   0     2     1     8   0  1620
5     1    12   0  217   0   1     0   249    97   0    15
6     0     0   0    2   0   0  2941     0     3   0   121
7     0     0   0    6   0   0     1  1145     9   0     3
8     0     1   0   53   0   0     0     7  1292   0    17
9     3   197   0  125   0   0     0   313   372   0   127
10    0     0   0    0   0   0     0     0     0   0  1646
better model found
persisted
after epoch: 9,now: 2024-07-21 06:29:14.789139,epoch time: 0:42:13.962268,used: 6:34:43.452112,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9180758, 'precision': 0.7248455, 'recall': 0.61155653, 'specificity': 0.9906729, 'f1': 0.60063297, 'auroc': 0.98776793}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   423     0   0     2   0   0     5    11     2   0     40
1     0  1247   0     7   0   0     1    57     8   0     12
2    14   115   1     0   0   0     2    48    16   1    115
3     2     0   0  7942   0   0     1   278   214   0      3
4    10    15   0     1   0   0     7    10    43   0    452
5     6     7   0   114   0  45     0   229   107   2     10
6    46     0   0     2   0   0  1808    13    12   0     27
7     0    11   0    99   0   0     1  7041    91   0     19
8     1     1   0    60   0   0     7    98  3075   0     54
9    38   124   3    20   0  21     2    71   153  20     41
10   24     0   0     7   0   0     9    17    23   0  12712
---- Validation: 
scalar performance:
{'acc': 0.91665107, 'precision': 0.75380635, 'recall': 0.6109525, 'specificity': 0.99051136, 'f1': 0.6020541, 'auroc': 0.9880743}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   418     0   0     5   0   0     2    11     6   0     41
1     0  1249   0    10   0   0     0    58     5   0     10
2    10   119   3     1   0   0     1    41    20   1    116
3     3     1   0  7915   0   0     4   286   228   0      3
4     8    14   1     2   0   0     8    16    32   0    458
5     9     9   0   107   0  50     0   223   110   3     10
6    41     0   0     7   0   0  1803    13    12   0     32
7     0    19   0   100   0   0     1  7036    93   0     16
8     2     2   0    59   0   0     3   112  3068   0     50
9    33   118   1    17   0  22     1    70   167  18     46
10   18     1   0     7   0   0    11    21    29   0  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63051844, 'precision': 0.4799632, 'recall': 0.49608216, 'specificity': 0.96284664, 'f1': 0.42317012, 'auroc': 0.8257888}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1030     0   0    9   0   0     3    64    47   0    17
1      0  1118   0   18   0   0     6   300     7   0    50
2     36    30   1   16   0   0    41   177   267   7   440
3      0     0   0    0   0   0     0     0     0   0     0
4      2     1   0    0   0   0     7     3     7   0  1613
5     16     0   0  254   0   0     0   137   160   4    21
6      2     0   0    4   0   0  2800     5     2   0   254
7      1     0   0    4   0   0     1  1156     0   0     2
8      0     0   0   61   0   0     2    59  1243   0     5
9     65    55   2  135   0   0     4   297   390  20   169
10     0     0   0    0   0   0     2     0     0   0  1644
early stop counter: 1
val acc:0.9166510701179504, best validation acc: 0.9168382883071899, corresponding to test acc:                         0.6304484605789185 / 0.654586136341095
after epoch: 10,now: 2024-07-21 07:08:52.943800,epoch time: 0:39:38.154661,used: 7:14:21.606773,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92315924, 'precision': 0.76516724, 'recall': 0.6348406, 'specificity': 0.99135166, 'f1': 0.63967186, 'auroc': 0.9906703}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   391     0   0    12   0    0    12     5     5   0     58
1     0  1217   0     9   0    0     1    97     4   0      4
2     2   159   2     4   0    2     3    46    16   2     76
3     0     0   0  8082   0    6     2   205   143   0      1
4     3    17   0    11   0    1     1    26    34   2    443
5     0    22   0    49   0  218     1     0   221   7      3
6     9     1   0     3   0    0  1856     8     8   0     23
7     0     5   0   170   0    0     2  7008    66   0     11
8     0     2   0   104   0    1     2   118  3022   0     46
9     1   221   1    22   0   17     5    10   194  15      7
10    4     1   0     8   0    0    18    20    48   1  12693
---- Validation: 
scalar performance:
{'acc': 0.9228033, 'precision': 0.7886147, 'recall': 0.63344264, 'specificity': 0.9913131, 'f1': 0.63589305, 'auroc': 0.99056256}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   391     0   0     8   0    0    15     6     4   0     59
1     0  1229   0     8   0    0     1    85     3   0      6
2     1   160   1     3   0    0     2    47    17   2     79
3     1     0   0  8087   0    6     4   200   139   0      3
4     3    12   0     6   0    0     3    22    38   3    452
5     0    21   0    62   0  207     3     2   218   6      2
6     9     1   0     4   0    0  1862     4     4   0     24
7     1     2   0   169   0    0     1  6996    82   0     14
8     0     2   0   106   0    0     2    92  3053   0     41
9     1   211   0    12   0   20     8    12   207  11     11
10   10     2   0     8   0    0    31    29    54   0  12662
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6200238, 'precision': 0.503578, 'recall': 0.48964414, 'specificity': 0.9615215, 'f1': 0.43522933, 'auroc': 0.83465594}
confusion matrix:
     0    1   2   3   4    5     6     7     8   9     10
0   797    1   0   5   0    0    76    27    13  10   241
1     0  874   0  12   0    0     0   576     8   0    29
2     3   77   0   5   0    0    18   223   127  30   532
3     0    0   0   0   0    0     0     0     0   0     0
4     0    1   0   0   0    0     3     6     6   0  1617
5     0   17   0  97   0  100     4    16   262  85    11
6     0    0   0   1   0    0  2934     2     1   0   129
7     0    0   0   2   0    0     0  1160     0   0     2
8     0    0   0  32   0    0     4    64  1262   0     8
9     2  291   1  40   0    5    12   362   223  90   111
10    0    0   0   0   0    0     0     1     0   0  1645
better model found
persisted
after epoch: 11,now: 2024-07-21 07:48:14.772074,epoch time: 0:39:21.828274,used: 7:53:43.435047,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9223031, 'precision': 0.7304248, 'recall': 0.6508419, 'specificity': 0.9910713, 'f1': 0.6571945, 'auroc': 0.9885002}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   363     0   0     2   0    0    47     3     0   0     68
1     1  1236   0     8   0    0     1    76     3   0      7
2     8   186   3     0   0    0     1     9     3   1    101
3     3     2   0  7967   0   21     7   277   157   0      5
4     6    21   0     2   0    0     2     6    11   0    491
5    11    27   0    30   0  288     7    60    30  52     16
6    16     1   0     3   0    0  1816     8     3   1     60
7     3    19   1   137   0    0     6  6982    85   0     31
8     1     7   0    95   0    3     5    68  3023   0     93
9    28   205   3    10   0   33     9    53    17  73     61
10   11     2   0     7   0    0     5    11    33   1  12721
---- Validation: 
scalar performance:
{'acc': 0.92036915, 'precision': 0.72999763, 'recall': 0.6452911, 'specificity': 0.9908364, 'f1': 0.65296036, 'auroc': 0.98872787}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   351     0   0     3   0    0    54     5     2   0     68
1     0  1233   0    11   0    0     2    71     3   0     12
2     8   174   8     1   0    0     0    16     1   2    102
3     4     1   0  7949   0   25    12   288   157   0      4
4     6    14   1     1   0    0     0     4    15   0    498
5    10    18   0    34   0  280     7    69    31  63      9
6    10     0   0     3   0    0  1809     4     6   0     76
7     4    18   0   135   0    1     4  6969    94   0     40
8     5     7   0    87   0    0     2    82  3015   0     98
9    31   219   6     8   0   32     8    47    20  61     61
10   12     2   0     8   0    0     6    11    23   1  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5672707, 'precision': 0.5363325, 'recall': 0.48524773, 'specificity': 0.95594037, 'f1': 0.44033915, 'auroc': 0.82884496}
confusion matrix:
      0    1   2   3   4    5     6     7     8    9     10
0   1109    0   0   1   0    0    18     7     1    0    34
1      6  875   0  11   0    0     3   498    35    0    71
2     45   69   8   0   0    1    11    65    71    3   742
3      0    0   0   0   0    0     0     0     0    0     0
4      1    0   0   0   0    0     2     2     3    0  1625
5     40    9   0  53   0  131    35     9    25  146   144
6      2    0   0   0   0    0  1859     0     0    0  1206
7      5    0   0   6   0    0     2  1145     1    0     5
8      3    0   0  52   0    2     4    24  1250    0    35
9    116  215  15  20   0    8    16   130    99   85   433
10     0    0   0   0   0    0     0     0     0    0  1646
early stop counter: 1
val acc:0.9203691482543945, best validation acc: 0.9228032827377319, corresponding to test acc:                         0.620023787021637 / 0.654586136341095
after epoch: 12,now: 2024-07-21 08:27:30.904127,epoch time: 0:39:16.132053,used: 8:32:59.567100,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.91748714, 'precision': 0.6924227, 'recall': 0.66590065, 'specificity': 0.99094856, 'f1': 0.6537966, 'auroc': 0.9912965}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   413     0   0     3   0    0    28     2    14   0     23
1     0  1265   0    11   0    0     0    48     6   0      2
2     3   127   0    12   0    6     5    41    56   7     55
3     2     2   0  8226   0    2     6    57   144   0      0
4     5    50   0    17   0    1    21     7   104   1    333
5     2     1   0   113   0  356     3     6    33   6      1
6     6     0   0     5   0    0  1874     4    10   0      9
7     3    11   0   435   0    0     4  6558   241   0     11
8     1     5   0   168   0    0     4    38  3068   0     12
9    10    72   0    23   0  174     7    17   143  34     13
10   16     8   0    10   0    1    88    11   158   0  12498
---- Validation: 
scalar performance:
{'acc': 0.9179618, 'precision': 0.7052182, 'recall': 0.6648292, 'specificity': 0.9909928, 'f1': 0.65188897, 'auroc': 0.9913247}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   402     0   0     5   0    0    39     2     9   0     26
1     0  1265   0    14   0    0     0    45     6   0      2
2     6   136   0     7   0    7     3    34    60   2     57
3     1     0   0  8228   0    4     5    67   135   0      0
4     4    40   0    12   0    1    19     9   101   2    351
5     2     3   0   105   0  365     3    10    31   1      1
6     5     0   0     5   0    0  1880     4     6   0      8
7     2    15   0   437   0    0     4  6562   237   0      8
8     0     5   0   155   0    0     8    29  3090   0      9
9     7    67   0    23   0  175     5    22   159  26      9
10   14     6   0    10   0    1   101    13   151   0  12500
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66773945, 'precision': 0.52812946, 'recall': 0.5384331, 'specificity': 0.96664965, 'f1': 0.48451138, 'auroc': 0.84330535}
confusion matrix:
      0     1   2    3   4    5     6     7     8   9     10
0   1105     0   0    6   0    0    19    15    23   1     1
1      1  1164   0   32   0    0     6   266    20   0    10
2     55    17   0   29   0    3    64   113   451  17   266
3      0     0   0    0   0    0     0     0     0   0     0
4      4     1   0    0   0    0    46     5    36   0  1541
5     24     0   0  236   0  178    17    32    78  19     8
6      0     0   0    2   0    0  3049     2     2   0    12
7      4     0   0   43   0    0     2  1114     1   0     0
8      0     0   0  118   0    0     1    14  1237   0     0
9    103    18   0  174   0   45    15   167   458  59    98
10     0     0   0    1   0    0     6     0     1   0  1638
new oracle model saved
early stop counter: 2
val acc:0.9179617762565613, best validation acc: 0.9228032827377319, corresponding to test acc:                         0.620023787021637 / 0.6677394509315491
after epoch: 13,now: 2024-07-21 09:06:58.050512,epoch time: 0:39:27.146385,used: 9:12:26.713485,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92941993, 'precision': 0.7770443, 'recall': 0.67417234, 'specificity': 0.9917466, 'f1': 0.6771065, 'auroc': 0.9929634}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   365     0   0     8   0    1     4     8     7   3     87
1     0  1215   0    12   0    0     0    92     7   0      6
2     1    69   3     4   0   18     1    26    19  34    136
3     1     0   0  8171   0    0     0   200    66   0      1
4     4     3   0     7   0    7     1     7    21   2    487
5     1     0   0    98   0  410     0     1     3   6      2
6     7     0   0     5   0    3  1845     9     6   0     32
7     1     4   0   194   0    1     1  6974    75   0     14
8     0     0   0   218   0    5     1    66  2937   1     65
9     1    22   1    19   0  297     0    13    26  83     31
10    2     0   0     6   0    1     7    17    26   0  12735
---- Validation: 
scalar performance:
{'acc': 0.92785877, 'precision': 0.76086974, 'recall': 0.67247134, 'specificity': 0.9916066, 'f1': 0.6740751, 'auroc': 0.992681}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   372     0   0     7   0    0     4    13     4   4     79
1     0  1205   0    12   0    0     0   104     6   0      5
2     0    76   4     8   0   23     0    24    12  43    122
3     1     1   0  8164   0    3     2   210    57   0      2
4     3     2   0     6   0    9     0    14    33   3    469
5     0     0   0    98   0  411     0     2     3   6      1
6     8     0   0     7   0    1  1835     9     9   0     39
7     0     5   0   213   0    0     1  6951    79   1     15
8     0     0   0   237   0    8     0    60  2930   1     60
9     2    20   2    22   0  303     0     6    33  74     31
10    1     1   0     8   0    1     7    19    17   0  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6525572, 'precision': 0.5876634, 'recall': 0.5421977, 'specificity': 0.96523374, 'f1': 0.49664646, 'auroc': 0.84885573}
confusion matrix:
     0    1   2    3   4    5     6     7     8    9     10
0   913    0   0   26   0    3    18   103    15   20    72
1     0  835   0   26   0    0     2   588    25    0    23
2     8   27   4   36   0   27    11   122   196   45   539
3     0    0   0    0   0    0     0     0     0    0     0
4     0    1   0    1   0    0     6     2    13    0  1610
5     5    0   0  180   0  359     3     7    14   20     4
6     0    0   0    3   0    0  3034     2     0    0    28
7     0    0   0    8   0    0     0  1155     0    0     1
8     0    0   0  113   0    1     5    39  1203    0     9
9    10   40   2  163   0  231    13   178   181  179   140
10    0    0   0    0   0    0     1     0     0    0  1645
better model found
persisted
after epoch: 14,now: 2024-07-21 09:46:23.243259,epoch time: 0:39:25.192747,used: 9:51:51.906232,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9199219, 'precision': 0.75573736, 'recall': 0.65139866, 'specificity': 0.9912152, 'f1': 0.6408727, 'auroc': 0.99258435}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   436     1   0     1   0    0     0     5     2   0     38
1     0  1266   0     6   0    0     0    44     8   0      8
2     1   272   1     1   0    0     0    12     4   2     19
3     6     3   0  8001   0   24     0   214   183   1      7
4     5   139   0     3   0    0     0    16     8   1    366
5     2    49   0    19   0  273     0    63    46  64      5
6   144     5   0     2   0    0  1630    11    10   0    104
7     3    22   0   137   0    0     2  6981   104   0     16
8     1    19   0    61   0    1     1    97  3011   0    102
9     5   333   0     2   0   31     0    30    29  55      8
10   13    16   0     6   0    0     1    24     5   0  12729
---- Validation: 
scalar performance:
{'acc': 0.9207169, 'precision': 0.7568713, 'recall': 0.65131795, 'specificity': 0.9912964, 'f1': 0.64110625, 'auroc': 0.993267}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   435     3   0     1   0    0     1     5     0   0     38
1     0  1265   0     6   0    0     0    52     4   0      5
2     4   270   1     1   0    0     1    15     2   2     16
3     3     6   0  8033   0   19     0   209   165   0      5
4     5   147   0     2   0    0     0    12     8   1    364
5     4    43   0    21   0  270     0    67    48  65      3
6   148     2   0     2   0    0  1622    15     7   1    111
7     0    17   0   144   0    0     2  6997    88   0     17
8     3    19   0    63   0    1     5    79  3019   0    107
9     5   329   0     4   0   30     0    30    32  58      5
10   21    16   0    11   0    0     2    15     9   1  12721
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6398237, 'precision': 0.54816824, 'recall': 0.51986194, 'specificity': 0.9634198, 'f1': 0.46545228, 'auroc': 0.8601955}
confusion matrix:
      0     1   2   3   4   5     6     7     8    9     10
0   1110     1   0   8   0   0     0    27     6    1    17
1      2  1288   0  15   0   1     3   155    10    0    25
2     18   219   2   5   0   1     4    67    42    8   649
3      0     0   0   0   0   0     0     0     0    0     0
4      1     3   0   1   0   0     2     3     0    0  1623
5     21    46   0  64   0  86     0   129    75  121    50
6      6     0   0   1   0   0  2622     2     0    0   436
7      7     5   0   5   0   0     0  1140     3    1     3
8      3    14   0  41   0   3    13    26  1145    4   121
9     30   612   4  16   0   7     3   137    68  106   154
10     0     0   0   0   0   0     0     0     0    0  1646
early stop counter: 1
val acc:0.9207168817520142, best validation acc: 0.9278587698936462, corresponding to test acc:                         0.6525571942329407 / 0.6677394509315491
after epoch: 15,now: 2024-07-21 10:25:54.902014,epoch time: 0:39:31.658755,used: 10:31:23.564987,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9256475, 'precision': 0.74834716, 'recall': 0.6651549, 'specificity': 0.9913654, 'f1': 0.6745922, 'auroc': 0.9924067}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   426     0   0     3   0    0     6     8     2   1     37
1     0  1296   0    10   0    0     0    22     4   0      0
2     0   106  24     4   0    2     0    18     4   6    148
3     2     4   0  8249   0    1     3    96    80   0      2
4     3     9   1     7   0    1     0    10    22   4    482
5     1     0   1    77   0  250     0   158     9  11     13
6    11     1   0     7   0    0  1847     4     8   2     28
7     2   124   0   245   0    0     2  6821    45   0     25
8     2     7   1   162   0    1     5   127  2940   0     49
9     1    68  27    19   0  136     0    53    46  67     76
10   14     4   0     8   0    1    23     7    59   1  12677
---- Validation: 
scalar performance:
{'acc': 0.9256654, 'precision': 0.73925716, 'recall': 0.66285527, 'specificity': 0.9913783, 'f1': 0.6695882, 'auroc': 0.9928152}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   420     0   0     1   0    0    15     3     3   1     40
1     0  1297   0    10   0    0     0    21     3   0      1
2     0   123  15     4   0    2     1    11     3   7    146
3     1     4   0  8247   0    1     0   109    77   0      1
4     6    10   0     5   0    2     1     6    24   2    483
5     0     1   1    85   0  261     0   143    11  11      8
6    16     1   0    10   0    1  1847     4     6   1     22
7     0   120   0   246   0    0     3  6826    44   0     26
8     0    10   1   167   0    1     5   124  2944   0     44
9     3    63  27    23   0  137     0    49    44  64     83
10   16     9   0    10   0    1    15     5    55   0  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66340166, 'precision': 0.5589053, 'recall': 0.5357586, 'specificity': 0.9663645, 'f1': 0.5038602, 'auroc': 0.84679866}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   940     0   0   10   0    2    24   51    25   45    73
1     3  1335   0   28   0    0     3   96    28    0     6
2     6    48   7   33   0   18     3   95   196   20   589
3     0     0   0    0   0    0     0    0     0    0     0
4     0     5   0    1   0    0     3    1    21    0  1602
5     1     0   0  203   0  220     0  106    20   24    18
6     1     0   0    2   0    0  3018    0     3    0    43
7    12     3   0  173   0    0     1  961     8    0     6
8     0     0   0  126   0    1     4   29  1207    0     3
9     2   102  19  216   0  114     1  145   111  148   279
10    0     0   0    0   0    0     0    0     0    0  1646
early stop counter: 2
val acc:0.9256653785705566, best validation acc: 0.9278587698936462, corresponding to test acc:                         0.6525571942329407 / 0.6677394509315491
after epoch: 16,now: 2024-07-21 11:05:20.983632,epoch time: 0:39:26.081618,used: 11:10:49.646605,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.927226, 'precision': 0.70209366, 'recall': 0.6697762, 'specificity': 0.99204683, 'f1': 0.6593893, 'auroc': 0.9909557}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   443     2   0     1   0    0     3     5     5   2     22
1     0  1280   0    12   0    0     0    20    13   0      6
2     0   199   0     1   0    0     0    21    39   4     48
3     0     1   0  8157   0    3     0    93   183   0      1
4     7    30   0    12   0    0     2    10    87   0    391
5     0     8   0    50   0  310     0    65    79   8      1
6    12     0   0     3   0    0  1856     0    19   0     17
7     2    27   0   200   0    0     1  6853   164   0     15
8     1     3   0    62   0    0     0    36  3179   0     15
9     1   162   0     7   0   85     0     9   196  32      1
10   37     7   1    10   0    0    18    10   164   1  12546
---- Validation: 
scalar performance:
{'acc': 0.92767155, 'precision': 0.7320273, 'recall': 0.6705127, 'specificity': 0.9921029, 'f1': 0.6606224, 'auroc': 0.9909202}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   444     2   0     3   0    0     5     2     6   3     18
1     1  1281   0     8   0    0     1    26    14   0      1
2     1   188   1     7   0    0     0    31    38   4     42
3     2     1   0  8149   0    5     0    94   188   0      1
4     7    30   0    15   0    0     0     8    85   2    392
5     0     4   0    57   0  310     0    61    84   4      1
6    10     0   0     7   0    1  1853     1    15   2     19
7     2    19   0   204   0    0     1  6860   170   0      9
8     0     2   0    53   0    0     1    32  3195   0     13
9     1   165   1     5   0   80     0     5   203  32      1
10   38     7   1    10   0    0    13    12   158   1  12556
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66983837, 'precision': 0.54442763, 'recall': 0.53220195, 'specificity': 0.9666956, 'f1': 0.47474352, 'auroc': 0.82878435}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1026     0   0   13   0   0     0    37    78   7     9
1      1  1242   0   20   0   0     0   157    60   0    19
2     18    38   0    8   0   0     5    48   468  23   407
3      0     0   0    0   0   0     0     0     0   0     0
4      1     1   0    0   0   0     4     1    28   0  1598
5      4     3   0  123   0  90     0     9   337  25     1
6      0     0   0    0   0   0  3036     1     3   0    27
7      6     2   0   21   0   0     1  1116    13   0     5
8      0     0   0   25   0   1     0     3  1340   0     1
9     11   131   2   84   0   8     4    93   650  83    71
10     0     0   0    0   0   0     4     0     1   0  1641
new oracle model saved
early stop counter: 3
val acc:0.9276715517044067, best validation acc: 0.9278587698936462, corresponding to test acc:                         0.6525571942329407 / 0.6698383688926697
after epoch: 17,now: 2024-07-21 11:44:35.965314,epoch time: 0:39:14.981682,used: 11:50:04.628287,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9361087, 'precision': 0.7858335, 'recall': 0.69395316, 'specificity': 0.99255, 'f1': 0.7188997, 'auroc': 0.99374044}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   388     0   0     2   0    0    17     5     1    1     68
1     0  1272   0     9   0    0     2    39     7    0      3
2     2   121  57     1   0    0     0     9     2   14    105
3     1     0   0  8222   0    5     4   120    81    1      3
4     3     6   3     5   0    0     1     3     9    1    508
5     0     9   0    51   0  291     0     2   111   52      5
6    10     0   0     5   0    0  1857     3     2    2     29
7     1    21   1   157   0    1     2  6978    73    0     31
8     0     6   0    92   0    1     8    71  3011    1    105
9     1   164  33     5   0   29     0     4    71  154     32
10    2     0   1     7   0    0     5     4    15    1  12758
---- Validation: 
scalar performance:
{'acc': 0.93566936, 'precision': 0.78671706, 'recall': 0.6934977, 'specificity': 0.9925086, 'f1': 0.7191364, 'auroc': 0.9937742}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   386     0   1     2   0    0    12     4     6    2     70
1     0  1263   0    11   0    0     0    48     8    0      2
2     2   124  62     0   0    0     0     5     3   14    102
3     1     0   1  8214   0    5     5   129    82    1      2
4     4     8   2     4   0    0     1     3     5    2    510
5     1    11   1    48   0  294     0     2    96   63      5
6     5     0   0     4   0    1  1859     1     4    1     33
7     1    22   0   178   0    0     2  6982    63    0     17
8     0     6   1   101   0    1     6    71  3013    0     97
9     1   168  27     8   0   21     1     4    84  147     32
10    5     0   3     7   0    0     5     7     8    1  12760
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68488073, 'precision': 0.58768183, 'recall': 0.5549619, 'specificity': 0.96804667, 'f1': 0.5255985, 'auroc': 0.8468049}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   977     0   0   4   0    0    48    25     6   12    98
1     1  1229   0  25   0    0     1   195    40    0     8
2     2    32  19   7   0    0     4    35   106   35   775
3     0     0   0   0   0    0     0     0     0    0     0
4     0     0   0   1   0    0     4     1     3    0  1624
5     4     0   0  91   0  144     2     1    59  242    49
6     0     0   0   1   0    0  3034     1     1    0    30
7     1    10   0  32   0    0     1  1105     7    2     6
8     0     1   0  56   0    1    10     7  1268    2    25
9     6   139  49  52   0   16     5    45   185  370   270
10    0     0   0   0   0    0     3     0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-21 12:24:04.181328,epoch time: 0:39:28.216014,used: 12:29:32.844301,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.91820955, 'precision': 0.72609067, 'recall': 0.6527796, 'specificity': 0.99098617, 'f1': 0.6430112, 'auroc': 0.9903118}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   452     0   0     6   0    0     4     5     4   0     11
1     0  1254   0    12   0    0     0    64     1   0      1
2     6   125   3    15   0    0     1    73    14   1     74
3     1     2   0  8223   0    2     0   100   109   0      0
4    16    22   1    59   0    1     1    32    71   0    336
5     4    21   0    99   0  198     0    53   110  33      3
6    23     0   1    15   0    0  1834     6    12   0     17
7     1     9   0   282   0    0     1  6886    80   0      5
8     2     3   0   130   0    0     0    80  3071   0      9
9    13   231   1    24   0   27     1    48    64  65     19
10  173     4   1    30   0    0    19    43   190   0  12333
---- Validation: 
scalar performance:
{'acc': 0.9194597, 'precision': 0.71982676, 'recall': 0.6556263, 'specificity': 0.99109936, 'f1': 0.6473136, 'auroc': 0.9902986}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   450     0   1     7   0    0     1     7     4   0     13
1     0  1261   0    10   0    0     0    56     4   0      1
2     6   125   2    13   0    0     1    77    15   2     71
3     0     0   0  8230   0    0     2   102   106   0      0
4    12    21   0    67   0    0     1    17    64   0    357
5     3    28   0    91   0  206     0    62    93  33      5
6    29     1   0    13   0    0  1830     7    10   0     18
7     0     8   0   276   0    0     1  6887    87   0      6
8     4     3   0   108   0    0     0    79  3095   0      7
9    11   212   3    33   0   20     0    56    66  72     20
10  176     0   1    22   0    0    12    36   208   0  12341
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64814943, 'precision': 0.5540532, 'recall': 0.50681186, 'specificity': 0.9649353, 'f1': 0.44438154, 'auroc': 0.8495123}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9     10
0   1033     0   0   16   0   0     1    89    31   0     0
1      3  1180   0   33   0   0     1   270     6   0     6
2    111    33   5   56   0   0    14    84   369   2   341
3      0     0   0    0   0   0     0     0     0   0     0
4     12    14   0    3   0   0    17     4    66   0  1517
5     67     1   0  315   0  32     0    41    60  39    37
6      4     0   0    7   0   0  3024     2     4   0    26
7      7     0   0   55   0   0     0  1098     1   0     3
8      4     0   0  127   0   0     5    18  1215   0     1
9    157    59   9  247   0   2     2   159   247  40   215
10     0     0   0    0   0   0     7     1     1   0  1637
early stop counter: 1
val acc:0.9194597005844116, best validation acc: 0.9356693625450134, corresponding to test acc:                         0.6848807334899902 / 0.6848807334899902
after epoch: 19,now: 2024-07-21 13:03:21.374177,epoch time: 0:39:17.192849,used: 13:08:50.037150,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9200824, 'precision': 0.7601784, 'recall': 0.69639814, 'specificity': 0.99057406, 'f1': 0.7157222, 'auroc': 0.9861805}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   442     0   0     1   0    0     0     2     0    0     38
1     0  1248   0    13   0    0     0    58     4    0      8
2     3    53  75     3   0    0     0    32     7   12    127
3     4     0   0  7872   0    1     2   371   154    0     35
4     7     2   5     5   0    1     1     4    20    0    494
5     5     6   1   105   0  237     0    16    28  110     13
6    34     0   0     2   0    0  1819     3     9    0     41
7     5    20   0   136   0    0     4  6877    93    0    129
8     8     0   0   165   0    2     2   100  2889    1    129
9    18    40  69    17   0   32     0    17    25  201     74
10   30     0   0     7   0    0     4     2    17    1  12729
---- Validation: 
scalar performance:
{'acc': 0.91970044, 'precision': 0.7526341, 'recall': 0.6979102, 'specificity': 0.990559, 'f1': 0.71426255, 'auroc': 0.9861289}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   446     0   0     4   0    0     0     6     1    0     26
1     0  1258   0     9   0    0     0    56     2    0      7
2     5    52  75     4   0    1     1    21     2    9    142
3     2     1   0  7849   0    5     3   354   189    0     37
4     7     2   7     4   0    0     1     5    23    2    488
5     4     3   2   102   0  234     0    17    23  124     12
6    33     1   0     5   0    0  1821     5     4    0     39
7     5    26   0   141   0    0     2  6877    79    0    135
8     5     1   2   152   0    0     3   113  2896    0    124
9    24    30  78    14   0   35     0    14    22  205     71
10   39     1   0     7   0    0     2     7    18    0  12722
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6401735, 'precision': 0.5419823, 'recall': 0.50415564, 'specificity': 0.9636186, 'f1': 0.46346885, 'auroc': 0.8192264}
confusion matrix:
      0    1   2    3   4   5     6     7     8    9     10
0   1062    0   0   10   0   0     6    14    22    0    56
1      1  983   0   26   0   0     2   410    15    0    62
2     22    7   5   14   0   1     8    85   141    4   728
3      0    0   0    0   0   0     0     0     0    0     0
4      2    0   0    1   0   0     5     0     7    0  1618
5     22    0   0  163   0  92     6    11    32  144   122
6      0    0   0    1   0   0  3057     1     0    0     8
7      5    0   0    7   0   0     3  1012     2    0   135
8      5    1   0   71   0   0     8    23  1213    1    48
9     46   14  35   72   0   6     9   151   163   80   561
10     0    0   0    0   0   0     0     0     0    0  1646
early stop counter: 2
val acc:0.9197004437446594, best validation acc: 0.9356693625450134, corresponding to test acc:                         0.6848807334899902 / 0.6848807334899902
after epoch: 20,now: 2024-07-21 13:42:58.232039,epoch time: 0:39:36.857862,used: 13:48:26.895012,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9334867, 'precision': 0.79535544, 'recall': 0.7116811, 'specificity': 0.9922706, 'f1': 0.72852695, 'auroc': 0.99256396}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   340     0   0     5   0    1    48     9     7    3     70
1     0  1273   0     7   0    0     0    42     8    0      2
2     0    89  31     4   0    1     1    41    14   42     89
3     0     2   0  8178   0   25     1   147    82    0      3
4     2    10   2    20   0    1     5    13    38    9    439
5     0     0   0    23   0  404     1     0    40   51      2
6     1     1   0     5   0    0  1852     4    10    0     35
7     0     6   0   177   0    0     1  6986    81    0     13
8     0     1   1   205   0    2     2    90  2855    0    139
9     0    53   6     9   0  103     1     7    40  262     11
10    1     1   3    11   0    0    12    24    30    1  12709
---- Validation: 
scalar performance:
{'acc': 0.93553567, 'precision': 0.795416, 'recall': 0.7144893, 'specificity': 0.9924859, 'f1': 0.7320154, 'auroc': 0.99238354}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   345     0   0     6   0    1    50     7     7    1     66
1     0  1259   0     4   0    0     0    55    11    0      3
2     0    71  35     6   0    0     1    32    15   57     95
3     0     0   0  8197   0   20     1   149    72    1      0
4     3     8   1    12   0    0     4     7    32    8    464
5     0     1   0    23   0  408     1     3    32   52      1
6     2     0   0     6   0    0  1865     4     2    0     29
7     0     8   0   172   0    0     2  6980    81    1     21
8     0     2   1   174   0    4     1    82  2914    1    117
9     0    46  12    10   0   93     3     9    52  255     13
10    2     0   0     8   0    0    10    34    24    1  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6009935, 'precision': 0.5859355, 'recall': 0.47003424, 'specificity': 0.9591044, 'f1': 0.41826582, 'auroc': 0.8265705}
confusion matrix:
     0    1   2   3   4   5     6     7     8    9     10
0   529    0   0   6   0   0   290   148   122    1    74
1     0  829   0  20   0   1     7   542    67    0    33
2     1    3   3  13   0   0    89    86   341   16   463
3     0    0   0   0   0   0     0     0     0    0     0
4     0    0   0   0   0   0     5     4    21    0  1603
5     1    0   0  49   0  95    43    12   287   95    10
6     0    0   0   2   0   0  2899     1     3    0   162
7     1    0   0   7   0   0     5  1143     5    0     3
8     0    0   0  24   0   0    11     8  1320    0     7
9     3   23   1  47   0   6   133   105   540  127   152
10    0    0   0   0   0   0     1     0     0    0  1645
early stop counter: 3
val acc:0.9355356693267822, best validation acc: 0.9356693625450134, corresponding to test acc:                         0.6848807334899902 / 0.6848807334899902
after epoch: 21,now: 2024-07-21 14:22:52.470631,epoch time: 0:39:54.238592,used: 14:28:21.133604,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9375, 'precision': 0.79486996, 'recall': 0.7269514, 'specificity': 0.99270827, 'f1': 0.7501216, 'auroc': 0.9948904}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   412     0    0     4   0    0     0    12     2    2     51
1     0  1256    0     6   0    0     0    65     3    0      2
2     0    74  115     4   0    0     1    15     6   24     73
3     0     0    0  8222   0    7     0   163    43    0      1
4     3     7   11     9   0    0     0     8    13    9    479
5     0     2    1    45   0  375     0     0    75   22      1
6    23     0    0     7   0    0  1803    14     6    1     53
7     0     8    0   214   0    1     1  6982    45    0     13
8     0     1    1   170   0    2     1    90  2964    1     66
9     0    68   50     7   0   70     0     8   114  165     10
10   10     1    2    10   0    0     1    12    12    0  12746
---- Validation: 
scalar performance:
{'acc': 0.9364451, 'precision': 0.79731476, 'recall': 0.72897077, 'specificity': 0.992563, 'f1': 0.7537822, 'auroc': 0.9951068}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   416     0    1     6   0    0     1     9     1    0     49
1     0  1251    0     8   0    0     1    68     4    0      0
2     0    62  127     2   0    0     0    17     3   25     76
3     0     1    0  8218   0    3     0   172    43    0      3
4     2     6   15     2   0    0     0     8     6    7    493
5     0     1    1    52   0  357     0     1    84   24      1
6    27     0    1     5   0    0  1810    13     5    1     46
7     0     9    0   208   0    0     1  6987    47    1     12
8     0     3    3   203   0    4     0    93  2915    2     73
9     2    58   50    15   0   58     0     4   115  178     13
10    7     0    2    11   0    0     2     9    14    1  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6324075, 'precision': 0.58704245, 'recall': 0.4977727, 'specificity': 0.96316385, 'f1': 0.4653553, 'auroc': 0.83605796}
confusion matrix:
     0    1    2    3   4   5     6     7     8    9     10
0   922    0    0   26   0   0     1   110    19    3    89
1     0  974    1   35   0   0     6   435    19    0    29
2     1   12   42   33   0   0     7   105    75    9   731
3     0    0    0    0   0   0     0     0     0    0     0
4     0    0    1    0   0   0     4     3     2    0  1623
5     3    0    0  263   0  41     0     0   134   84    67
6     1    0    0    3   0   0  2962     2     0    0    99
7     1    0    0   31   0   0     1  1123     0    0     8
8     0    0    0  139   0   0     4    42  1154    1    30
9     7   32  120  194   0   3     2   154    96  176   353
10    0    0    0    0   0   0     1     0     0    0  1645
better model found
persisted
after epoch: 22,now: 2024-07-21 15:02:13.088431,epoch time: 0:39:20.617800,used: 15:07:41.751404,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9330319, 'precision': 0.7780863, 'recall': 0.71494305, 'specificity': 0.99224055, 'f1': 0.7330774, 'auroc': 0.99453974}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   431     0   0     2   0    1     1     6     3    1     38
1     0  1220   0     5   0    0     0    94     7    0      6
2     3    88  66     2   0    0     0    52     4   18     79
3     0     0   0  7935   0    5     1   409    86    1      1
4     5     6   6     6   0    1     1    21    16    4    473
5     2     6   0    24   0  359     0    66    16   45      3
6    19     0   0     4   0    1  1823    11     9    2     38
7     0     6   0    64   0    0     1  7132    42    0     19
8     0     4   1    90   0    2     0   116  2988    0     95
9     2   104  39     4   0  103     1    20    22  185     13
10   16     0   1     7   0    1     3    16    12    1  12734
---- Validation: 
scalar performance:
{'acc': 0.9323258, 'precision': 0.7783855, 'recall': 0.71692854, 'specificity': 0.99214154, 'f1': 0.73594093, 'auroc': 0.99444324}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   431     0   0     0   0    0     0     7     2    3     40
1     0  1214   0     6   0    0     0    99     8    0      5
2     4    71  84     1   0    0     1    58     4   16     73
3     3     0   0  7921   0    8     0   423    84    0      1
4     5    10   5     8   0    0     0    13    11    6    481
5     1     5   1    32   0  353     0    60    21   46      2
6    26     0   0     4   0    0  1824     9     4    1     40
7     0     8   1    65   0    0     1  7123    46    0     21
8     0     1   1    81   0    1     1   118  2986    0    107
9     3    87  44     6   0  103     0    25    32  177     16
10   17     0   1     9   0    1     4    12     7    3  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6347163, 'precision': 0.5638846, 'recall': 0.5362452, 'specificity': 0.9630947, 'f1': 0.5054385, 'auroc': 0.83619565}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   986     0   0    6   0    0     8    69    18    8    75
1     1  1072   0   20   0    0     0   365    20    0    21
2     6     4  14    9   0    3     9   108   134   40   688
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0   0    0     1     2     4    0  1626
5    10     0   0  108   0  225     3    58    51  114    23
6     3     0   0    2   0    0  2447     3     1    0   611
7     1     0   0    8   0    0     0  1152     1    0     2
8     1     0   0   75   0    1     0    26  1245    1    21
9    23    14  67   82   0   50    14   222   182  285   198
10    0     0   0    0   0    0     0     0     0    0  1646
early stop counter: 1
val acc:0.9323257803916931, best validation acc: 0.9364451169967651, corresponding to test acc:                         0.6324074864387512 / 0.6848807334899902
after epoch: 23,now: 2024-07-21 15:42:13.613347,epoch time: 0:40:00.524916,used: 15:47:42.276320,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9366171, 'precision': 0.78703845, 'recall': 0.6895423, 'specificity': 0.99232084, 'f1': 0.7186596, 'auroc': 0.99505603}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   397     0    0     6   0    0    10     7     5   0     58
1     0  1276    0     6   0    0     0    47     2   0      1
2     1     9  134     5   0    0     1    32     1   0    129
3     0     0    0  8261   0    1     0   123    53   0      1
4     3     5    4     3   0    0     1    11    11   0    501
5     1     0    3   122   0  184    21    88     4  62     36
6     4     1    0     6   0    0  1866     4     5   0     22
7     0    12    0   136   0    0     2  7052    38   0     23
8     0     1    1   166   0    2     2    85  2997   0     42
9     2     2   99    29   0   38    20    12     2  93    196
10    1     0    1     8   0    0     5     9    19   0  12747
---- Validation: 
scalar performance:
{'acc': 0.93585664, 'precision': 0.79142135, 'recall': 0.6913531, 'specificity': 0.9922503, 'f1': 0.7194578, 'auroc': 0.9951389}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   401     1    0     5   0    0     8     5     1   0     62
1     0  1269    0    10   0    0     0    51     2   0      0
2     0    14  143     2   0    0     0    26     2   1    124
3     0     0    0  8241   0    0     2   143    53   0      1
4     3     1    5     3   0    0     0     5    15   0    507
5     0     0    2   133   0  177    26    91     7  53     32
6     8     1    0     8   0    0  1863     3     2   0     23
7     0    11    1   150   0    0     1  7045    43   0     14
8     0     1    1   151   0    0     4    88  3008   1     42
9     1     0  110    24   0   29    30    11     3  95    190
10    2     1    1     9   0    0     6    12    20   0  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6440915, 'precision': 0.5955776, 'recall': 0.49928182, 'specificity': 0.96448696, 'f1': 0.4500361, 'auroc': 0.8497971}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   940     0   1   30   0   0    37    72    19   0    71
1     0  1242   0   31   0   0     1   216     3   0     6
2     3    11   5   55   0   0    25   160   178   0   578
3     0     0   0    0   0   0     0     0     0   0     0
4     0     4   0    2   0   0     9     5    13   0  1600
5     4     0   0  458   0  10    28     7     6   2    77
6     0     0   0    1   0   0  3035     7     1   0    23
7     0     0   0   22   0   0     0  1139     0   0     3
8     0     0   0  150   0   1     5    36  1177   0     1
9     5     9  31  361   0   1    17   172   115  14   412
10    0     0   0    0   0   0     2     0     0   0  1644
early stop counter: 2
val acc:0.9358566403388977, best validation acc: 0.9364451169967651, corresponding to test acc:                         0.6324074864387512 / 0.6848807334899902
after epoch: 24,now: 2024-07-21 16:21:54.172772,epoch time: 0:39:40.559425,used: 16:27:22.835745,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.92537993, 'precision': 0.77840936, 'recall': 0.6639211, 'specificity': 0.9909669, 'f1': 0.6962006, 'auroc': 0.99171257}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   376     0   0     1   0    0     3     5     0    0     98
1     0  1282   0     1   0    0     0    39     9    0      1
2     1    18  61     1   0    0     0    42     3    3    183
3    11     2   0  7942   0    0    40   341    84    0     16
4     1     1   0     4   0    0     0     9     8    0    516
5     0     0   1    71   0  177     0   199    11   32     30
6     1     0   0     3   0    0  1822     4     2    0     75
7     2    12   0    76   0    0     7  7027    99    0     41
8     0     2   0    90   0    0     5    75  3019    0    105
9     6     7  65    13   0   70     2    42    17  123    148
10    0     0   0     7   0    0     5    10    13    0  12758
---- Validation: 
scalar performance:
{'acc': 0.9259329, 'precision': 0.7820207, 'recall': 0.6658451, 'specificity': 0.99101025, 'f1': 0.6994013, 'auroc': 0.99118966}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   367     0   0     1   0    0     4     4     1    1    105
1     0  1279   0     1   0    0     2    41     7    0      2
2     0    23  63     3   0    0     1    41     4    1    176
3     9     2   0  7956   1    1    48   320    79    0     24
4     2     1   1     5   0    0     1     6    10    0    513
5     2     1   2    79   0  186     0   190     8   25     28
6     4     0   0     0   0    0  1825     1     1    0     77
7     4    15   0    62   0    0     8  7033    99    0     44
8     0     0   1    88   0    1     2    72  3008    0    124
9     1     2  73    14   0   65     0    39    15  132    152
10    0     2   0     6   0    0     2     8    11    0  12767
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6061009, 'precision': 0.5128374, 'recall': 0.47973537, 'specificity': 0.9598901, 'f1': 0.42632854, 'auroc': 0.8199459}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   877     0   0    0   0   0    38    23    14   0   218
1     0  1128   0   14   0   0     2   325    18   0    12
2     4     2   0    5   0   0     6    61   123   0   814
3     0     0   0    0   0   0     0     0     0   0     0
4     0     0   0    0   0   0     3     0     5   0  1625
5     5     0   0  151   0   5     2     8    15   2   404
6     0     0   0    0   0   0  2566     2     1   0   498
7     3     0   0    2   0   0     4  1147     4   0     4
8     0     0   0   25   0   0     5    27  1294   0    19
9    22     2   1   36   0   0     5   150   201   0   720
10    0     0   0    0   0   0     0     0     0   0  1646
early stop counter: 3
val acc:0.9259328842163086, best validation acc: 0.9364451169967651, corresponding to test acc:                         0.6324074864387512 / 0.6848807334899902
after epoch: 25,now: 2024-07-21 17:01:22.146102,epoch time: 0:39:27.973330,used: 17:06:50.809075,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9332192, 'precision': 0.79228866, 'recall': 0.7233732, 'specificity': 0.9920647, 'f1': 0.7309646, 'auroc': 0.99276495}
confusion matrix:
     0    1   2     3   4    5     6     7     8    9      10
0   454    0   0     0   0    0     5     2     1    1     20
1     1  990   0     8   0    0    11    87    20    0    213
2     6    1  60     1   0    5     0     5     5   69    160
3     4    0   0  8196   0   20     1   106   110    1      0
4     8    0   1     3   0    0     0     2    10   10    505
5     3    0   0     5   0  449     0    38     7   17      2
6    24    0   0     2   0    1  1847     3     1    2     27
7     6    3   0   184   0    0     4  6907   115    0     46
8    13    1   0    63   0    7     1    40  3049    8    112
9    13    0   6     3   0  224     0     2    16  201     28
10   33    0   0     7   0    0     5     3    15    4  12727
---- Validation: 
scalar performance:
{'acc': 0.93318176, 'precision': 0.79150724, 'recall': 0.72538847, 'specificity': 0.9920825, 'f1': 0.7315088, 'auroc': 0.99291146}
confusion matrix:
     0    1   2     3   4    5     6     7     8    9      10
0   455    0   0     0   0    0     2     2     1    3     20
1     0  997   0    10   0    0     9    93    11    0    212
2     6    0  58     1   0    3     0     6     5   73    160
3     7    0   0  8180   0   13     0   111   127    0      2
4    12    0   0     3   0    1     0     3    10   15    495
5     5    0   0     6   0  465     0    29     6    9      1
6    31    0   0     3   0    0  1842     2     1    3     26
7     7    4   0   206   0    0     4  6887   111    0     46
8    14    1   0    69   0    2     1    56  3059    7     87
9     4    0   8     3   0  234     0     6    19  199     20
10   26    0   0     7   0    0     5     3     8    2  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6498985, 'precision': 0.54175097, 'recall': 0.53980196, 'specificity': 0.96438706, 'f1': 0.49798593, 'auroc': 0.8344018}
confusion matrix:
      0    1   2    3   4    5     6     7     8    9     10
0   1100    0   0    5   0    0    18    15     2   19    11
1     10  492   0   35   0    1   124   545    74    4   214
2     35    0   1    9   0   10    49    37   135   75   664
3      0    0   0    0   0    0     0     0     0    0     0
4      2    0   0    0   0    0    94     2    14    0  1521
5     12    0   0   25   0  304     0   111    13  121     6
6      0    0   0    3   0    0  3061     0     0    0     3
7     14    0   1  113   0    0     5  1016     4    0    11
8      4    0   0   43   0    5    12    13  1271    7    15
9     67    0   5   32   0  131    20    73   132  421   256
10     0    0   0    0   0    0    23     0     0    0  1623
early stop counter: 4
val acc:0.9331817626953125, best validation acc: 0.9364451169967651, corresponding to test acc:                         0.6324074864387512 / 0.6848807334899902
after epoch: 26,now: 2024-07-21 17:40:59.100879,epoch time: 0:39:36.954777,used: 17:46:27.763852,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9440015, 'precision': 0.79708254, 'recall': 0.75688607, 'specificity': 0.99334633, 'f1': 0.771515, 'auroc': 0.9928218}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   402     1    1     3   0    1    12     2     1    1     59
1     0  1281    0     4   0    0     1    39     4    0      3
2     0    29  145     1   0    1     0    36     2   10     88
3     0     1    0  8227   0    7     2   129    63    1      7
4     3     6   10     5   0    0     1     5     9    3    497
5     2     0    3    35   0  427     0     2     8   41      2
6     8     0    1     2   0    0  1860     3     6    0     28
7     0    29    1   120   0    0     7  6992    78    0     37
8     1     5    1    87   0    1     4    66  2979    0    151
9     0     5  116     7   0  113     0     7     9  213     23
10    5     1    0     7   0    1     9     6     6    1  12757
---- Validation: 
scalar performance:
{'acc': 0.94455, 'precision': 0.79107726, 'recall': 0.7519843, 'specificity': 0.99342626, 'f1': 0.765782, 'auroc': 0.99361265}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   409     0    3     3   0    0    12     4     2    2     48
1     0  1287    0     6   0    0     4    29     4    0      2
2     1    23  135     2   0    2     0    40     2   14     93
3     0     0    0  8238   0    5     4   124    66    0      3
4     3     4    6     3   0    0     0     9     9    2    503
5     0     0    1    34   0  425     0     4     6   45      6
6     8     1    1     1   0    0  1856     3     9    2     27
7     0    24    0   116   0    0     4  7020    66    0     35
8     0     5    3    96   0    2     6    57  2988    1    138
9     0    11  121     8   0  122     0    11     7  193     20
10    6     0    0     7   0    1    15     4     2    0  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66165257, 'precision': 0.57116246, 'recall': 0.53546596, 'specificity': 0.9659992, 'f1': 0.5087995, 'auroc': 0.8286378}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   855     1   0   27   0    2    32    78    25   40   110
1     0  1154   0   31   0    0     3   279     9    0    23
2     1    17  16   28   0    0    26   105   150   14   658
3     0     0   0    0   0    0     0     0     0    0     0
4     1     1   0    0   0    0    16     2     7    0  1606
5     0     1   1  229   0  202     0     4    14   84    57
6     0     0   0    4   0    0  3021     1     0    0    41
7     1     0   1   21   0    0     0  1135     3    0     3
8     0     3   0  105   0    1     3    16  1234    0     8
9     4    29  70  188   0   46     4   143   153  198   302
10    0     0   0    0   0    0     4     0     0    0  1642
better model found
persisted
after epoch: 27,now: 2024-07-21 18:20:29.905548,epoch time: 0:39:30.804669,used: 18:25:58.568521,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.94044304, 'precision': 0.8009778, 'recall': 0.750265, 'specificity': 0.99303377, 'f1': 0.7678901, 'auroc': 0.9942178}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   423     0    0     7   0    0     0     4     3    3     43
1     0  1267    0    15   0    0     0    44     3    0      3
2     0     8  110     4   0    1     0    24     4   75     86
3     0     1    0  8310   0    2     0    79    44    0      1
4     4     0    9    16   0    0     0     9    30   13    458
5     0     0    0    42   0  395     0    46    15   22      1
6    10     0    0     7   0    1  1832     3     6    3     46
7     1     8    0   272   0    0     2  6923    50    0      9
8     3     2    1   196   0    0     1    78  2971    1     40
9     0     3   26    12   0  155     0    10    19  259      9
10   17     0    1    14   0    0     3    12    85    1  12660
---- Validation: 
scalar performance:
{'acc': 0.9406179, 'precision': 0.7964921, 'recall': 0.7488301, 'specificity': 0.9930799, 'f1': 0.7651741, 'auroc': 0.9946235}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   432     0    0     5   0    0     1     6     2    2     35
1     0  1259    0    14   0    0     1    51     4    0      3
2     1     6  105     5   0    3     0    26     7   73     86
3     1     0    0  8319   0    3     0    69    47    1      0
4     5     1   11    15   0    0     0     5    26   14    462
5     1     0    0    44   0  386     0    52    12   25      1
6    12     0    0    13   0    0  1826     1    10    2     44
7     0     9    0   270   0    0     3  6911    58    0     14
8     4     0    0   193   0    1     3    74  2994    2     25
9     1     3   28     6   0  159     0    11    21  260      4
10   14     0    2    17   0    0     5    12    73    0  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6199538, 'precision': 0.5830383, 'recall': 0.52629215, 'specificity': 0.9620042, 'f1': 0.5153125, 'auroc': 0.8293113}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   994     0   0   32   0    1     7    51    22   18    45
1     0  1239   0   53   0    1     1   167     6    0    32
2     9     1  10   97   0    4     2    57    33   22   780
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    3   0    0     2     0     1    0  1627
5     3     0   0  166   0  260     0    61     9   76    17
6     3     0   0   41   0    0  2338     1     0    0   684
7     0     0   0  128   0    0     1  1033     0    0     2
8     0     0   0  229   0    4     2    17  1104    1    13
9     8     5  59  235   0   92     4   100    45  237   352
10    0     0   0    0   0    0     0     0     0    0  1646
early stop counter: 1
val acc:0.9406179189682007, best validation acc: 0.9445499777793884, corresponding to test acc:                         0.6616525650024414 / 0.6848807334899902
after epoch: 28,now: 2024-07-21 19:00:11.835284,epoch time: 0:39:41.929736,used: 19:05:40.498257,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.80349576, 'recall': 0.76957834, 'specificity': 0.9938095, 'f1': 0.7839328, 'auroc': 0.9962755}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   431     0    0     0   0    1     5     1     1    0     44
1     0  1274    0     8   0    0     0    47     2    0      1
2     1    22  155     2   0    0     1    69     0   11     51
3     1     0    0  8216   0    3     0   106   111    0      1
4     5     2    6     5   0    0     1    28     7    1    484
5     2     0    2    23   0  393     0    18    13   62      8
6     7     0    0     2   0    0  1875     2     2    0     20
7     0    12    0   127   0    0     4  7007    99    1     13
8     0     2    5    68   0    1     4    67  3053    1     93
9     5     4  108     5   0   74     0     6     8  257     26
10   10     2    3     7   0    0     2    11    13    1  12744
---- Validation: 
scalar performance:
{'acc': 0.94829476, 'precision': 0.80140483, 'recall': 0.7688894, 'specificity': 0.99393296, 'f1': 0.7829187, 'auroc': 0.9964706}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   438     0    1     5   0    0     4     4     1    0     30
1     0  1274    0     5   0    0     0    50     3    0      0
2     2    20  139     2   0    0     0    73     3   16     57
3     2     2    0  8225   0    5     0   105    98    0      3
4     3     4    7     5   0    0     0    27     4    1    488
5     1     0    1    30   0  393     1    15     9   66      5
6    10     0    0     3   0    0  1873     3     2    0     17
7     1     7    4   124   0    0     2  7025    90    0     12
8     1     1    7    62   0    0     0    65  3080    2     78
9     3     5   98     8   0   72     2     5     6  267     27
10   10     1    3     9   0    0     5    13    15    2  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6457007, 'precision': 0.56752384, 'recall': 0.52252084, 'specificity': 0.96418345, 'f1': 0.48437518, 'auroc': 0.84471965}
confusion matrix:
      0     1    2    3   4    5     6     7     8   9     10
0   1032     0    0   13   0    0    17    64    18   1    25
1      0  1184    1   27   0    0     0   276     4   0     7
2     38    12   21   25   0    0     8    71    68   1   771
3      0     0    0    0   0    0     0     0     0   0     0
4      0     0    0    0   0    0     4     2     2   0  1625
5     34     0    0  174   0  108     5    45    27  67   132
6      2     0    0   14   0    0  2749     0     2   0   300
7      1     0    1   29   0    1     2  1127     2   0     1
8      3     1    0   45   0    0     6    17  1272   1    25
9     64     8  107   73   0   19     8   127   100  92   539
10     0     1    0    0   0    0     1     0     0   0  1644
better model found
persisted
after epoch: 29,now: 2024-07-21 19:39:52.775041,epoch time: 0:39:40.939757,used: 19:45:21.438014,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9426905, 'precision': 0.8121618, 'recall': 0.76100147, 'specificity': 0.9931135, 'f1': 0.7820462, 'auroc': 0.99542207}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   412     0    0     3   0    0     5     5     0    1     57
1     0  1241    0    14   0    0     0    68     3    0      6
2     0     1  148     4   0    1     0    19     3   43     92
3     0     0    0  8331   0    6     0    63    37    1      0
4     3     0    8     4   0    0     0     9     9    3    503
5     0     0    0    31   0  421     0    27     4   32      6
6     5     0    0     3   0    0  1805     6     3    0     86
7     1     6    2   276   0    1     2  6895    56    1     24
8     1     0    2   172   1    5     1    67  2988    5     53
9     0     0   53     9   0  132     0     2     2  255     40
10    2     0    1     8   0    1     3     9    30    0  12738
---- Validation: 
scalar performance:
{'acc': 0.94361377, 'precision': 0.81029516, 'recall': 0.7627704, 'specificity': 0.99324614, 'f1': 0.782199, 'auroc': 0.99550545}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   411     0    0     2   0    0     2     3     3    0     62
1     0  1237    0    16   0    0     0    65     6    0      8
2     0     1  153     4   0    2     0    18     2   39     93
3     0     0    1  8328   0    5     0    70    34    1      1
4     1     0   10     2   0    3     0    13     8    6    496
5     0     0    0    22   0  428     1    25     5   36      4
6     6     0    0     3   0    0  1811     2     6    2     78
7     2     5    1   268   0    1     0  6911    58    1     18
8     0     0    2   177   0    3     0    70  3001    5     38
9     1     0   56     4   0  141     0     2     2  249     38
10    2     0    0     7   0    1     4    17    17    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5567061, 'precision': 0.57106763, 'recall': 0.4867052, 'specificity': 0.95515037, 'f1': 0.47030997, 'auroc': 0.841018}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   860     0   0   24   0    0     5   100    36   14   131
1     0  1104   0   32   0    0     0   309     2    0    52
2     3     0  12   36   1    2     1    93    49    6   812
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    2   0    0     1     1     2    0  1627
5     4     0   0  153   0  218     1    10    11  113    82
6     3     0   0    3   0    0  1659     1     2    0  1399
7     3     0   0   34   0    0     0  1122     0    1     4
8     2     0   0  113   0    0     5    32  1188    2    28
9     5     0  51  116   0   40     0   102    75  148   600
10    0     0   0    0   0    0     0     0     0    0  1646
early stop counter: 1
val acc:0.9436137676239014, best validation acc: 0.9482947587966919, corresponding to test acc:                         0.6457006931304932 / 0.6848807334899902
after epoch: 30,now: 2024-07-21 20:19:22.595784,epoch time: 0:39:29.820743,used: 20:24:51.258757,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:24:51.258757 at 2024-07-21 20:19:22.595784
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6457007, 'precision': 0.56752384, 'recall': 0.52252084, 'specificity': 0.96418345, 'f1': 0.48437518, 'auroc': 0.84471965}
confusion matrix:
      0     1    2    3   4    5     6     7     8   9     10
0   1032     0    0   13   0    0    17    64    18   1    25
1      0  1184    1   27   0    0     0   276     4   0     7
2     38    12   21   25   0    0     8    71    68   1   771
3      0     0    0    0   0    0     0     0     0   0     0
4      0     0    0    0   0    0     4     2     2   0  1625
5     34     0    0  174   0  108     5    45    27  67   132
6      2     0    0   14   0    0  2749     0     2   0   300
7      1     0    1   29   0    1     2  1127     2   0     1
8      3     1    0   45   0    0     6    17  1272   1    25
9     64     8  107   73   0   19     8   127   100  92   539
10     0     1    0    0   0    0     1     0     0   0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68488073, 'precision': 0.58768183, 'recall': 0.5549619, 'specificity': 0.96804667, 'f1': 0.5255985, 'auroc': 0.8468049}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   977     0   0   4   0    0    48    25     6   12    98
1     1  1229   0  25   0    0     1   195    40    0     8
2     2    32  19   7   0    0     4    35   106   35   775
3     0     0   0   0   0    0     0     0     0    0     0
4     0     0   0   1   0    0     4     1     3    0  1624
5     4     0   0  91   0  144     2     1    59  242    49
6     0     0   0   1   0    0  3034     1     1    0    30
7     1    10   0  32   0    0     1  1105     7    2     6
8     0     1   0  56   0    1    10     7  1268    2    25
9     6   139  49  52   0   16     5    45   185  370   270
10    0     0   0   0   0    0     3     0     0    0  1643
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562784_instance_wise_predictions.txt
accuracy from prediction file 0.6457006926467501
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/rule_results/1.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455609 KiB |   3599 MiB |   1438 TiB |   1438 TiB |
|       from large pool | 412348 KiB |   3565 MiB |   1420 TiB |   1420 TiB |
|       from small pool |  43261 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455609 KiB |   3599 MiB |   1438 TiB |   1438 TiB |
|       from large pool | 412348 KiB |   3565 MiB |   1420 TiB |   1420 TiB |
|       from small pool |  43261 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449057 KiB |   3597 MiB |   1437 TiB |   1437 TiB |
|       from large pool | 407075 KiB |   3563 MiB |   1420 TiB |   1420 TiB |
|       from small pool |  41982 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4010 MiB |   4010 MiB |   4010 MiB |      0 B   |
|       from large pool |   3946 MiB |   3946 MiB |   3946 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 408646 KiB | 501476 KiB |   1095 TiB |   1095 TiB |
|       from large pool | 404804 KiB | 497885 KiB |   1076 TiB |   1076 TiB |
|       from small pool |   3842 KiB |  13312 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4576    |    6827    |  248969 K  |  248964 K  |
|       from large pool |     187    |     468    |  134600 K  |  134600 K  |
|       from small pool |    4389    |    6565    |  114368 K  |  114364 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4576    |    6827    |  248969 K  |  248964 K  |
|       from large pool |     187    |     468    |  134600 K  |  134600 K  |
|       from small pool |    4389    |    6565    |  114368 K  |  114364 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     196    |     196    |     196    |       0    |
|       from large pool |     164    |     164    |     164    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    2326    |  145182 K  |  145182 K  |
|       from large pool |      43    |     167    |   88050 K  |   88050 K  |
|       from small pool |      22    |    2283    |   57132 K  |   57132 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3599 MiB |   1438 TiB |   1438 TiB |
|       from large pool |  16640 KiB |   3565 MiB |   1420 TiB |   1420 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3599 MiB |   1438 TiB |   1438 TiB |
|       from large pool |  16640 KiB |   3565 MiB |   1420 TiB |   1420 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3597 MiB |   1437 TiB |   1437 TiB |
|       from large pool |  16640 KiB |   3563 MiB |   1420 TiB |   1420 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    844 MiB |   4010 MiB |   4010 MiB |   3166 MiB |
|       from large pool |    798 MiB |   3946 MiB |   3946 MiB |   3148 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 501476 KiB |   1095 TiB |   1095 TiB |
|       from large pool |  24320 KiB | 497885 KiB |   1076 TiB |   1076 TiB |
|       from small pool |      0 KiB |  32081 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |  248969 K  |  248969 K  |
|       from large pool |       2    |     468    |  134600 K  |  134600 K  |
|       from small pool |       0    |    6565    |  114368 K  |  114368 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |  248969 K  |  248969 K  |
|       from large pool |       2    |     468    |  134600 K  |  134600 K  |
|       from small pool |       0    |    6565    |  114368 K  |  114368 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     196    |     196    |     137    |
|       from large pool |      36    |     164    |     164    |     128    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2326    |  145184 K  |  145184 K  |
|       from large pool |       4    |     167    |   88050 K  |   88050 K  |
|       from small pool |       0    |    2283    |   57134 K  |   57134 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3599 MiB |   1438 TiB |   1438 TiB |
|       from large pool |  16640 KiB |   3565 MiB |   1420 TiB |   1420 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3599 MiB |   1438 TiB |   1438 TiB |
|       from large pool |  16640 KiB |   3565 MiB |   1420 TiB |   1420 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3597 MiB |   1437 TiB |   1437 TiB |
|       from large pool |  16640 KiB |   3563 MiB |   1420 TiB |   1420 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    844 MiB |   4010 MiB |   4010 MiB |   3166 MiB |
|       from large pool |    798 MiB |   3946 MiB |   3946 MiB |   3148 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 501476 KiB |   1095 TiB |   1095 TiB |
|       from large pool |  24320 KiB | 497885 KiB |   1076 TiB |   1076 TiB |
|       from small pool |      0 KiB |  32081 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |  248969 K  |  248969 K  |
|       from large pool |       2    |     468    |  134600 K  |  134600 K  |
|       from small pool |       0    |    6565    |  114368 K  |  114368 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |  248969 K  |  248969 K  |
|       from large pool |       2    |     468    |  134600 K  |  134600 K  |
|       from small pool |       0    |    6565    |  114368 K  |  114368 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     196    |     196    |     137    |
|       from large pool |      36    |     164    |     164    |     128    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2326    |  145184 K  |  145184 K  |
|       from large pool |       4    |     167    |   88050 K  |   88050 K  |
|       from small pool |       0    |    2283    |   57134 K  |   57134 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784

 Experiment start at: 2024-07-21 20:59:41.731868
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.34233198, 'precision': 0.03112109, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046368692, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    520
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12795
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 21:39:19.047988,epoch time: 0:39:37.316120,used: 0:39:37.316120,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3294
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 1
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 2,now: 2024-07-21 22:18:58.014464,epoch time: 0:39:38.966476,used: 1:19:16.282596,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.34227848, 'precision': 0.031116227, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363294, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12793
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 2
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 3,now: 2024-07-21 22:58:41.650544,epoch time: 0:39:43.636080,used: 1:58:59.918676,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 3
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 4,now: 2024-07-21 23:38:03.595452,epoch time: 0:39:21.944908,used: 2:38:21.863584,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8435
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 4
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 5,now: 2024-07-22 00:17:19.645985,epoch time: 0:39:16.050533,used: 3:17:37.914117,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 5
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 6,now: 2024-07-22 00:56:41.291612,epoch time: 0:39:21.645627,used: 3:56:59.559744,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    482
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 6
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 7,now: 2024-07-22 01:36:02.592980,epoch time: 0:39:21.301368,used: 4:36:20.861112,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7261
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 7
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 8,now: 2024-07-22 02:15:12.528542,epoch time: 0:39:09.935562,used: 5:15:30.796674,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 8
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 9,now: 2024-07-22 02:54:34.528649,epoch time: 0:39:22.000107,used: 5:54:52.796781,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 9
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 10,now: 2024-07-22 03:34:03.225388,epoch time: 0:39:28.696739,used: 6:34:21.493520,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    537
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 10
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 11,now: 2024-07-22 04:13:28.489098,epoch time: 0:39:25.263710,used: 7:13:46.757230,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.34233198, 'precision': 0.03112109, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046368692, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    482
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    311
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7262
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12795
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 11
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 12,now: 2024-07-22 04:52:44.795165,epoch time: 0:39:16.306067,used: 7:53:03.063297,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 12
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 13,now: 2024-07-22 05:32:02.799419,epoch time: 0:39:18.004254,used: 8:32:21.067551,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 13
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 14,now: 2024-07-22 06:11:25.391564,epoch time: 0:39:22.592145,used: 9:11:43.659696,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1330
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3294
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 14
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 15,now: 2024-07-22 06:50:39.368401,epoch time: 0:39:13.976837,used: 9:50:57.636533,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.34233198, 'precision': 0.03112109, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046368692, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    482
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    311
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12795
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 15
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 16,now: 2024-07-22 07:29:52.467685,epoch time: 0:39:13.099284,used: 10:30:10.735817,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.34227848, 'precision': 0.031116227, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363294, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12793
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 16
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 17,now: 2024-07-22 08:09:11.095820,epoch time: 0:39:18.628135,used: 11:09:29.363952,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1905
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 17
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 18,now: 2024-07-22 08:48:38.574656,epoch time: 0:39:27.478836,used: 11:48:56.842788,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.34233198, 'precision': 0.03112109, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046368692, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7261
8    0   0   0   0   0   0   0   0   0   0   3294
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12795
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 18
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 19,now: 2024-07-22 09:28:08.210170,epoch time: 0:39:29.635514,used: 12:28:26.478302,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7262
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 19
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 20,now: 2024-07-22 10:07:50.056479,epoch time: 0:39:41.846309,used: 13:08:08.324611,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 20
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 21,now: 2024-07-22 10:47:52.172284,epoch time: 0:40:02.115805,used: 13:48:10.440416,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 13:48:10.440416 at 2024-07-22 10:47:52.172284
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_21_20_59_41_seed_1_22562784_instance_wise_predictions.txt
accuracy from prediction file 0.11516126775344575
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457839 KiB |   3601 MiB |   2455 TiB |   2455 TiB |
|       from large pool | 414577 KiB |   3566 MiB |   2425 TiB |   2425 TiB |
|       from small pool |  43261 KiB |     62 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457839 KiB |   3601 MiB |   2455 TiB |   2455 TiB |
|       from large pool | 414577 KiB |   3566 MiB |   2425 TiB |   2425 TiB |
|       from small pool |  43261 KiB |     62 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449057 KiB |   3597 MiB |   2451 TiB |   2451 TiB |
|       from large pool | 407075 KiB |   3563 MiB |   2421 TiB |   2421 TiB |
|       from small pool |  41982 KiB |     60 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4012 MiB |   4012 MiB |   7178 MiB |   3166 MiB |
|       from large pool |   3948 MiB |   3948 MiB |   7096 MiB |   3148 MiB |
|       from small pool |     64 MiB |     64 MiB |     82 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 347025 KiB | 501476 KiB |   1873 TiB |   1873 TiB |
|       from large pool | 343182 KiB | 497885 KiB |   1842 TiB |   1842 TiB |
|       from small pool |   3842 KiB |  32081 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4576    |    6827    |  424369 K  |  424365 K  |
|       from large pool |     187    |     468    |  229522 K  |  229522 K  |
|       from small pool |    4389    |    6565    |  194847 K  |  194842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4576    |    6827    |  424369 K  |  424365 K  |
|       from large pool |     187    |     468    |  229522 K  |  229522 K  |
|       from small pool |    4389    |    6565    |  194847 K  |  194842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     197    |     197    |     334    |     137    |
|       from large pool |     165    |     165    |     293    |     128    |
|       from small pool |      32    |      32    |      41    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      60    |    2326    |  249223 K  |  249223 K  |
|       from large pool |      36    |     167    |  151938 K  |  151938 K  |
|       from small pool |      24    |    2289    |   97284 K  |   97284 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3601 MiB |   2455 TiB |   2455 TiB |
|       from large pool |  16640 KiB |   3566 MiB |   2425 TiB |   2425 TiB |
|       from small pool |      0 KiB |     62 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3601 MiB |   2455 TiB |   2455 TiB |
|       from large pool |  16640 KiB |   3566 MiB |   2425 TiB |   2425 TiB |
|       from small pool |      0 KiB |     62 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3597 MiB |   2451 TiB |   2451 TiB |
|       from large pool |  16640 KiB |   3563 MiB |   2421 TiB |   2421 TiB |
|       from small pool |      0 KiB |     60 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4012 MiB |   7178 MiB |   6392 MiB |
|       from large pool |    740 MiB |   3948 MiB |   7096 MiB |   6356 MiB |
|       from small pool |     46 MiB |     64 MiB |     82 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 501476 KiB |   1873 TiB |   1873 TiB |
|       from large pool |  24320 KiB | 497885 KiB |   1842 TiB |   1842 TiB |
|       from small pool |      0 KiB |  32081 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |  424369 K  |  424369 K  |
|       from large pool |       2    |     468    |  229522 K  |  229522 K  |
|       from small pool |       0    |    6565    |  194847 K  |  194847 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |  424369 K  |  424369 K  |
|       from large pool |       2    |     468    |  229522 K  |  229522 K  |
|       from small pool |       0    |    6565    |  194847 K  |  194847 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     197    |     334    |     277    |
|       from large pool |      34    |     165    |     293    |     259    |
|       from small pool |      23    |      32    |      41    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2326    |  249225 K  |  249225 K  |
|       from large pool |       4    |     167    |  151938 K  |  151938 K  |
|       from small pool |       0    |    2289    |   97286 K  |   97286 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3601 MiB |   2455 TiB |   2455 TiB |
|       from large pool |  16640 KiB |   3566 MiB |   2425 TiB |   2425 TiB |
|       from small pool |      0 KiB |     62 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3601 MiB |   2455 TiB |   2455 TiB |
|       from large pool |  16640 KiB |   3566 MiB |   2425 TiB |   2425 TiB |
|       from small pool |      0 KiB |     62 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3597 MiB |   2451 TiB |   2451 TiB |
|       from large pool |  16640 KiB |   3563 MiB |   2421 TiB |   2421 TiB |
|       from small pool |      0 KiB |     60 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   4012 MiB |   7178 MiB |   6392 MiB |
|       from large pool |    740 MiB |   3948 MiB |   7096 MiB |   6356 MiB |
|       from small pool |     46 MiB |     64 MiB |     82 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 501476 KiB |   1873 TiB |   1873 TiB |
|       from large pool |  24320 KiB | 497885 KiB |   1842 TiB |   1842 TiB |
|       from small pool |      0 KiB |  32081 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |  424369 K  |  424369 K  |
|       from large pool |       2    |     468    |  229522 K  |  229522 K  |
|       from small pool |       0    |    6565    |  194847 K  |  194847 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |  424369 K  |  424369 K  |
|       from large pool |       2    |     468    |  229522 K  |  229522 K  |
|       from small pool |       0    |    6565    |  194847 K  |  194847 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     197    |     334    |     277    |
|       from large pool |      34    |     165    |     293    |     259    |
|       from small pool |      23    |      32    |      41    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2326    |  249225 K  |  249225 K  |
|       from large pool |       4    |     167    |  151938 K  |  151938 K  |
|       from small pool |       0    |    2289    |   97286 K  |   97286 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784

 Experiment start at: 2024-07-22 11:28:22.396532
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.72653574, 'precision': 0.33715874, 'recall': 0.35140622, 'specificity': 0.9687589, 'f1': 0.30300623, 'auroc': 0.9096025}
confusion matrix:
    0    1   2     3   4     5   6     7   8   9      10
0   20  113   0    17   0     6   0   128   0   0    199
1    0  994   0     5   0     2   0   301   0   0     30
2    0    2   0    10   0    19   0    98   0   0    183
3    0   30   7  6260   0   395   0   975   4   0    768
4    1    1   0     4   0    38   0    26   0   0    468
5    3    2   1    64   0   199   0     9   0   0    243
6    5  743  83   104   0   101   0   477   9   0    385
7    0    1   0   166   0    20   0  6965   1   0    109
8    2   10   2    69   0  1632   0  1067   4   0    510
9    5    8   1    86   0    92   0    64   1   0    236
10   5    2   0     3   0    18   0    52   0   0  12713
---- Validation: 
scalar performance:
{'acc': 0.7276715, 'precision': 0.34134552, 'recall': 0.35058945, 'specificity': 0.9688937, 'f1': 0.3012368, 'auroc': 0.9093723}
confusion matrix:
    0    1   2     3   4     5   6     7   8   9      10
0   14  106   4    23   0    12   0   137   0   0    187
1    0  976   0     5   0     0   0   307   1   0     43
2    3    1   0    11   0    15   0   108   0   0    174
3    0   23  10  6331   0   424   1   929   4   0    718
4    0    0   0     4   0    34   0    26   0   0    475
5    1    2   0    60   0   204   0    14   0   0    240
6    5  759  80    74   0   105   0   433   3   0    449
7    0    2   0   148   0    16   0  6967   0   0    132
8    1    7   3    78   0  1652   0  1022   3   0    530
9    6   11   0    93   0   100   0    57   0   0    226
10   0    2   0     5   0    29   0    51   0   0  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24424544, 'precision': 0.28492796, 'recall': 0.24427044, 'specificity': 0.9240906, 'f1': 0.13913326, 'auroc': 0.6770747}
confusion matrix:
     0    1   2   3   4    5   6     7   8   9     10
0   123   80   0  48   0    3   0   742   1   0   173
1     0  361   3  10   0    1   0   967   0   0   157
2    15    0   0   7   0   46   0   227   0   0   720
3     0    0   0   0   0    0   0     0   0   0     0
4     0    0   0   0   0    5   0     6   0   0  1622
5    24    9   0  69   0  209   0    27   1   0   253
6     0   60   5  15   0  390   2   165  10   0  2420
7     0    0   0   2   0    0   0  1145   0   0    17
8     2    8   1  18   0  700   0   539   5   0    97
9    68    5   0  93   0   33   0   443   1   0   494
10    0    0   0   0   0    0   0     0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 12:07:24.492821,epoch time: 0:39:02.096289,used: 0:39:02.096289,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7848619, 'precision': 0.45651639, 'recall': 0.46085685, 'specificity': 0.97738653, 'f1': 0.39267224, 'auroc': 0.96209466}
confusion matrix:
     0     1    2     3   4     5   6     7    8   9      10
0   115   112    1    45   0    33   0    92    1   0     84
1     0  1186    0    18   0     5   0   108    2   0     13
2     2     1   84    25   0   117   0    24    1   0     58
3     0     1    0  8032   0   122   0   266    4   0     10
4     3     0   23    11   0   129   0    16    3   0    354
5     0     0    0   129   0   387   0     1    1   0      3
6    28   862  239   107   0    39   0   540   12   0     81
7     0    10    3   457   0    24   0  6717    7   0     47
8     2     6    1   290   0  1909   0   808  224   0     55
9     0     1   33    63   0   367   0    14    2   0     13
10   21     3    4    17   0   120   0    38    0   0  12590
---- Validation: 
scalar performance:
{'acc': 0.7834961, 'precision': 0.46382502, 'recall': 0.46218503, 'specificity': 0.97723484, 'f1': 0.39389008, 'auroc': 0.96191937}
confusion matrix:
     0     1    2     3   4     5   6     7    8   9      10
0   124   116    1    36   0    39   0    90    0   0     77
1     0  1183    2    17   0     4   0   111    2   0     13
2     1     1   89    29   0   107   0    25    1   0     59
3     1     3    1  8024   0   114   0   284    3   0     10
4     2     0   19     8   0   124   0    15    2   0    369
5     0     1    1   130   0   385   0     0    1   0      3
6    15   858  250   107   0    51   0   537   13   0     77
7     2    13    3   444   0    35   0  6715    2   0     51
8     2     5    2   287   0  1937   0   808  186   0     69
9     1     0   30    62   0   370   0    15    1   0     14
10   17     2    4    17   0   120   0    49    2   0  12585
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3358987, 'precision': 0.35535502, 'recall': 0.35729948, 'specificity': 0.9345253, 'f1': 0.22529298, 'auroc': 0.7733537}
confusion matrix:
     0     1   2    3   4    5   6     7    8   9     10
0   215   159   0  109   0   92   0   566    8   0    21
1     0  1139   4   31   0   23   0   276    2   0    24
2     6     1  31    9   0  499   0   162    6   0   301
3     0     0   0    0   0    0   0     0    0   0     0
4     1     0   0    0   0   67   0     5    0   0  1560
5     1     1   0   44   0  542   0     2    0   0     2
6     2   587  70  138   0  770   2   392  211   0   895
7     0     0   0   35   0    1   0  1123    0   0     5
8     0     1   0   70   0  864   0   331  103   0     1
9    12     8  40   81   0  718   0   185    9   0    84
10    0     0   0    0   0    0   0     0    0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 12:46:18.552395,epoch time: 0:38:54.059574,used: 1:17:56.155863,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.79987156, 'precision': 0.61955535, 'recall': 0.51208013, 'specificity': 0.97768253, 'f1': 0.4664534, 'auroc': 0.97068745}
confusion matrix:
     0     1    2     3   4     5   6     7    8    9      10
0   246     6    2    25   0    21   0    35    1    5    142
1     0  1257    0     6   0     2   0    61    2    0      4
2     0     1    8    79   0    30   0    29    1   38    126
3     1    24    1  7602   0   189   0   554   29    1     37
4     0     1    1    19   0    29   0     9    1    8    471
5     0     0    0    48   0   457   0     0    0   12      3
6    79   226  129    76   0    24   2  1208    5    2    157
7     4    71    1   216   0    15   0  6849   27    0     79
8     6    47    3   257   0  1458   0   271  626    1    627
9     1     0    1    70   0   254   0     7    0  121     39
10    3     5    0     8   0    16   0    30    2    1  12728
---- Validation: 
scalar performance:
{'acc': 0.79874283, 'precision': 0.5972023, 'recall': 0.51045346, 'specificity': 0.97758734, 'f1': 0.4663071, 'auroc': 0.97106284}
confusion matrix:
     0     1    2     3   4     5   6     7    8    9      10
0   232     7    5    34   0    25   0    37    3    2    138
1     0  1267    0    11   0     2   0    47    2    0      3
2     2     2    8    67   0    25   0    29    1   44    134
3     0    24    0  7566   0   204   1   577   33    0     35
4     2     3    2    21   0    23   0    12    1   10    465
5     0     0    0    46   0   456   0     1    0   16      2
6    59   204  152    87   0    23   3  1224    8    2    146
7     5    61    0   217   0    21   0  6860   24    0     77
8     7    52    3   289   0  1463   0   265  613    1    603
9     0     0    2    73   0   252   0     4    0  128     34
10    2     5    1    14   0    10   0    33    3    0  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40761212, 'precision': 0.46712548, 'recall': 0.43343008, 'specificity': 0.94087064, 'f1': 0.31838384, 'auroc': 0.8138253}
confusion matrix:
     0     1   2    3   4    5   6     7    8    9     10
0   558     3   1   57   0  134   0   102    1    9   305
1     0  1366   0   10   0   10   0    88    3    0    22
2     2     8   7   17   0  190   0    56   20   59   656
3     0     0   0    0   0    0   0     0    0    0     0
4     0     3   0    0   0    5   0     1    0    0  1624
5     1     0   0    5   0  575   0     0    0   10     1
6     0  1271  61  179   0   69  11   714   65    0   697
7     0     0   0    4   0    2   0  1148    1    0     9
8     3    12   0   47   0  770   0    91  277    6   164
9     2    17   9   67   0  531   0    65    4  238   204
10    0     0   0    0   0    0   0     0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-22 13:25:39.061622,epoch time: 0:39:20.509227,used: 1:57:16.665090,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8589737, 'precision': 0.704967, 'recall': 0.5908805, 'specificity': 0.9839961, 'f1': 0.57366234, 'auroc': 0.9768651}
confusion matrix:
     0     1   2     3   4    5   6     7     8   9      10
0   354     3   1    10   0    3   0    37     4   2     68
1     0  1249   0    18   0    2   0    52     9   0      2
2     1     1  44    31   0   35   0     7    17  42    134
3     2     0   0  7969   0  137   0   164   138   1     28
4     4     1  23    10   0   30   0    11    23   6    431
5     1     0   0    55   0  445   0     0     9   5      6
6    11    12   7    23   0    8   2  1799    11   2     32
7     7    42   3   433   0    3   0  6590   125   1     58
8     3     2   1    90   0  171   0   187  2707   0    134
9     7     0   6    37   0  292   0     4     7  83     57
10   19     3   3     9   0   19   0    37    42   0  12662
---- Validation: 
scalar performance:
{'acc': 0.85892737, 'precision': 0.64840204, 'recall': 0.59169674, 'specificity': 0.9839443, 'f1': 0.57529354, 'auroc': 0.97713566}
confusion matrix:
     0     1   2     3   4    5   6     7     8   9      10
0   353     5   0     9   0    4   0    33    10   1     68
1     0  1250   0    13   0    1   0    57     8   0      3
2     7     0  40    38   0   26   1    14    10  30    146
3     2     3   0  7963   0  126   0   153   155   0     38
4     5     1  14     7   0   31   0     6    20   8    447
5     2     0   0    56   0  446   0     1     5   5      6
6    14    11  10    22   0    6   1  1798     6   2     38
7     6    49   5   441   0    2   0  6573   128   0     61
8     3     3   1    98   0  178   0   160  2721   0    132
9     3     3   1    34   0  285   2     3     7  94     61
10   19     2   0    10   0   22   0    30    42   1  12670
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48870078, 'precision': 0.5107949, 'recall': 0.50775266, 'specificity': 0.9483551, 'f1': 0.41390508, 'auroc': 0.7924094}
confusion matrix:
      0     1   2   3   4    5   6     7     8    9     10
0   1087     3   0   4   0    5   0    41     2    1    27
1      3  1296   0   4   0    3   0   154    20    0    19
2     14     2   8   0   0   83   0    29    82   49   748
3      0     0   0   0   0    0   0     0     0    0     0
4      2     0   1   0   0    3   0     0     5    0  1622
5     19     0   0   3   0  481   0     3     9   49    28
6      9    24  39  84   0   17   5  1293   208    0  1388
7      4     0   2  14   0    1   0  1125     2    0    16
8     12     1   0   3   0   54   0   104  1155    1    40
9     51     1  14   5   0  178   0    75   139  182   492
10     0     0   0   0   0    0   0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-22 14:05:02.503748,epoch time: 0:39:23.442126,used: 2:36:40.107216,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8571543, 'precision': 0.68558925, 'recall': 0.58178717, 'specificity': 0.98320943, 'f1': 0.5681293, 'auroc': 0.98268414}
confusion matrix:
     0     1   2     3   4    5   6     7     8   9      10
0   367     1   0    11   0    6   1    17     1   5     74
1     0  1224   2    10   0    0   0    85     4   1      6
2     1     1  16    42   0   20   0     2     0  21    209
3     2     0   0  7995   0   66   0   259    58   0     59
4     1     0  12     7   0   11   0     3     2   4    499
5     0     0   0    34   0  473   0     0     1   8      5
6    93    28  24    48   0    5  41  1615     3   1     49
7     0    10   0   206   0    2   0  6925    11   2    107
8     7     2  16   213   0  142   0   284  2165   2    465
9     1     0   5    86   0  241   0     2     0  92     66
10   11     0   3     6   0    4   2    14     9   3  12739
---- Validation: 
scalar performance:
{'acc': 0.85769695, 'precision': 0.6830635, 'recall': 0.580142, 'specificity': 0.9832613, 'f1': 0.5656393, 'auroc': 0.9819684}
confusion matrix:
     0     1   2     3   4    5   6     7     8   9      10
0   369     0   0     8   0    4   0    16     0   4     82
1     0  1231   0    11   0    1   0    80     2   0      7
2     0     0  10    47   0   23   0     4     1  18    209
3     4     0   0  7995   0   63   0   266    47   2     63
4     1     0   7     7   0   19   0     1     3   2    499
5     1     0   1    42   0  462   0     0     0  11      4
6    98    26  20    55   0    3  27  1616     3   1     59
7     0     8   1   191   0    2   0  6938    17   2    106
8     3     0  26   189   0  148   1   280  2194   0    455
9     2     0   1    90   0  237   0     1     1  97     64
10   10     1   3     7   0    6   1    18     6   2  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47302875, 'precision': 0.55158687, 'recall': 0.49517912, 'specificity': 0.94759053, 'f1': 0.4081665, 'auroc': 0.82885075}
confusion matrix:
     0     1   2    3   4    5   6     7     8    9     10
0   936     0   0   37   0   30   0    96     1    5    65
1     0  1146   0   23   0    1   0   306     2    0    21
2     1     2  39   31   0  125   0    77    52   71   617
3     0     0   0    0   0    0   0     0     0    0     0
4     0     0   2    0   0    2   1     3     2    1  1622
5     1     0   0   28   0  547   0     1     1   10     4
6     8    70  26  139   0    0  92  2582    74    0    76
7     0     0   0   43   0    1   0  1108     0    0    12
8     2     3   0   81   0   60   0   122  1062    3    37
9     5     8   4  135   1  448   1    87    30  186   232
10    0     0   0    1   0    0   0     0     0    0  1645
early stop counter: 1
val acc:0.8576969504356384, best validation acc: 0.8589273691177368, corresponding to test acc:                         0.4887007772922516 / 0.4887007772922516
after epoch: 5,now: 2024-07-22 15:10:22.858019,epoch time: 1:05:20.354271,used: 3:42:00.461487,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.86935467, 'precision': 0.8088528, 'recall': 0.5736551, 'specificity': 0.9849147, 'f1': 0.5826709, 'auroc': 0.98345315}
confusion matrix:
     0     1   2     3   4    5   6     7     8   9      10
0   306     5   0    40   0   11   6    68     9   3     35
1     0  1222   0    15   0    1   0    88     5   0      1
2     0     0  55    40   0    2   0    26    16   2    171
3     0     3   0  8066   0   21   0   263    81   0      2
4     2     0  42    10   1    4   0    31    35   0    414
5     0     0   1   113   0  387   0     4     7   5      4
6     2     7   1    48   0    0  14  1806     9   1     18
7     1     7   0   175   0    0   0  7047    26   0      8
8     0     2   4   196   0    3   1   242  2811   0     37
9     0     0   4   213   0  145   0    11    12  35     73
10    9     2  25    20   0    6   1    96    86   0  12549
---- Validation: 
scalar performance:
{'acc': 0.8686104, 'precision': 0.73341143, 'recall': 0.5733793, 'specificity': 0.9848358, 'f1': 0.5837549, 'auroc': 0.983799}
confusion matrix:
     0     1   2     3   4    5   6     7     8   9      10
0   291     7   0    39   0   11   3    75    16   1     40
1     0  1224   0    16   0    0   0    85     6   0      1
2     0     0  57    51   0    3   0    30     9   2    160
3     0     4   2  8071   0   17   0   258    86   0      2
4     2     0  53    16   0    4   0    34    33   0    397
5     0     0   1   104   0  401   0     0     7   4      4
6     1     6   1    50   0    2  19  1796    13   1     19
7     0    10   0   180   0    0   0  7027    41   0      7
8     0     1   2   193   0    5   2   267  2786   0     40
9     0     0   3   226   0  126   0    16    12  36     74
10    4     0  27    22   1    2   2    98    79   0  12561
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4355279, 'precision': 0.5421541, 'recall': 0.44099167, 'specificity': 0.94432557, 'f1': 0.35482934, 'auroc': 0.8216666}
confusion matrix:
     0     1   2    3   4    5    6     7     8   9     10
0   505     0   0  225   0  114    0   256    28  16    26
1     0  1197   0   32   2    0    0   245    16   0     7
2     0     2  26  139   0   57    0   207   306   2   276
3     0     0   0    0   0    0    0     0     0   0     0
4     0     1   0    1   0    0    0    13    40   1  1577
5     0     0   0  139   0  445    0     1     6   0     1
6     0    76   0  169   0    0  152  1990   544   0   136
7     0     0   0   34   0    0    0  1129     0   0     1
8     0     5   0  180   0    7    1    67  1110   0     0
9     1     1   5  419   0  249    0   233   152  17    60
10    0     0   0    0   0    0    0     0     2   0  1644
better model found
persisted
after epoch: 6,now: 2024-07-22 16:26:28.188295,epoch time: 1:16:05.330276,used: 4:58:05.791763,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8694617, 'precision': 0.682649, 'recall': 0.59840214, 'specificity': 0.98456556, 'f1': 0.6211049, 'auroc': 0.9796043}
confusion matrix:
     0     1   2     3   4    5    6     7     8    9      10
0   336     0   0    14   0    1   16    80     0    1     35
1     0  1241   0    17   0    0    0    62     1    0     11
2     3     0   0    45   0    8    7    15     3   33    198
3     1     0   0  8242   0   18    3   136    31    2      6
4     5     0   0    24   0    3   15    49     1    7    435
5     2     0   0    92   0  388    0     0     1   31      6
6     2     3   0    21   0    0  688  1187     0    0      7
7     1    12   0   498   0    0    1  6673    25    4     47
8    24     2   0   428   0   18   22   237  2155   12    398
9     3     0   0    32   0  184    9     9     1  154    101
10    9     0   0    43   0    2   37    80     2    0  12620
---- Validation: 
scalar performance:
{'acc': 0.8687174, 'precision': 0.6847644, 'recall': 0.60070866, 'specificity': 0.9844689, 'f1': 0.6231715, 'auroc': 0.9803453}
confusion matrix:
     0     1   2     3   4    5    6     7     8    9      10
0   342     0   0     9   0    0   22    73     0    1     36
1     0  1246   0    19   0    0    0    62     1    0      4
2     1     0   0    40   0    8    4    21     1   27    210
3     0     2   0  8246   0   15    0   137    35    0      5
4     6     0   0    20   0    5   10    55     3    9    431
5     2     0   0    82   0  391    3     0     1   35      7
6    10     1   0    21   0    0  656  1205     1    0     14
7     5    13   1   488   0    1    1  6669    24    0     63
8    21     2   1   434   0   12   20   255  2152   10    389
9     3     1   0    28   0  179    5     7     0  166    104
10    6     0   0    51   0    2   47    74     4    3  12609
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55677605, 'precision': 0.61574864, 'recall': 0.49316102, 'specificity': 0.9558681, 'f1': 0.46482098, 'auroc': 0.8110862}
confusion matrix:
     0     1   2    3   4    5     6     7    8    9     10
0   711     1   0   67   0    9    72   272    2    3    33
1     0  1196   0   41   0    0    14   227    1    0    20
2    13     3   1  132   0   23    39   130   82   49   543
3     0     0   0    0   0    0     0     0    0    0     0
4     0     0   0   51   0    0    21    13    2    0  1546
5     2     0   0  146   0  372     5     2    1   55     9
6     0     6   0   77   0    0  1798  1181    0    0     5
7     2     0   0   68   0    0     1  1088    0    0     5
8     0     2   0  223   0    2    41   116  953    0    33
9     9    15   0  294   0  146    32   116   57  206   262
10    0     0   0    5   0    0     8     0    0    0  1633
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-22 17:45:00.541145,epoch time: 1:18:32.352850,used: 6:16:38.144613,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9126712, 'precision': 0.8077229, 'recall': 0.6660576, 'specificity': 0.98947906, 'f1': 0.68781936, 'auroc': 0.9865893}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   393     1   0    11   0    1     2    24     2    1     48
1     0  1247   0    15   0    0     0    68     0    0      2
2     5     0   0     3   0    2     0    40     0   23    239
3     1     2   0  8193   0   14     1   196    16    3     11
4     4     2   0     4   4    2     0    42     7    5    469
5     4     0   0    59   0  305     0     0     1  138     14
6    24    16   0     9   0    0  1641   180     5    1     31
7     0    26   0   187   0    0     0  7022    10    0     18
8     2     4   1   366   0    4     3   358  2365    2    191
9     8     0   0    13   0   55     0    18     0  234    165
10   11     1   0     9   0    0     4    47     9    4  12708
---- Validation: 
scalar performance:
{'acc': 0.9109001, 'precision': 0.8843148, 'recall': 0.66618586, 'specificity': 0.9892581, 'f1': 0.6893283, 'auroc': 0.98657626}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   395     4   0     9   0    1     1    28     1    1     43
1     0  1251   0    11   0    0     0    67     1    0      2
2     7     0   3     4   0    1     1    37     0   21    238
3     1     2   0  8176   0   16     0   211    24    1      9
4     4     2   0     2   5    0     0    53     7    5    461
5     1     0   0    61   0  297     0     0     0  143     19
6    25     9   0    12   0    0  1641   181     2    0     38
7     1    21   0   206   0    0     1  7001    13    1     21
8     1     2   0   386   0    4     5   344  2340    4    210
9    13     0   0    14   0   43     0    16     0  240    167
10   13     0   0    10   1    0     2    46    14    5  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64283216, 'precision': 0.5520132, 'recall': 0.5353694, 'specificity': 0.9640767, 'f1': 0.50949395, 'auroc': 0.82354087}
confusion matrix:
     0     1   2    3   4    5     6     7    8    9     10
0   959     1   0   45   0    4     0   116    2    4    39
1     0  1204   0   18   0    0     0   273    0    0     4
2     3     3   0   10   0    6     1   162   37   55   738
3     0     0   0    0   0    0     0     0    0    0     0
4     0     0   0    0   0    0     4     8    1    0  1620
5     4     0   0   51   0  241     0     5    0  270    21
6     0     4   0   35   0    0  2691   319    1    0    17
7     0     0   0   26   0    0     0  1135    0    0     3
8     0     0   0  148   0    4     1   145  992    3    77
9     7     5   0   49   0   34     0   223   19  324   476
10    0     0   0    0   0    0     2     2    0    0  1642
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-22 19:00:58.145250,epoch time: 1:15:57.604105,used: 7:32:35.748718,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91887844, 'precision': 0.8842106, 'recall': 0.65345263, 'specificity': 0.9902267, 'f1': 0.68063074, 'auroc': 0.98703194}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   394     1   0    18   0    0     6    27     0    0     37
1     0  1256   0     9   0    0     0    64     3    0      0
2     5     1   6    27   0    0     1    16     3    7    246
3     0     0   0  8126   0    1     0   230    78    0      3
4     2     1   1    10   2    0     0    16    16    3    488
5     2     0   0   166   0  198     0     0     5  129     21
6    17     2   0    45   0    0  1778    30     6    0     28
7     0     8   0   257   0    0     1  6963    26    0      9
8     2     0   1   175   0    0     0   295  2765    0     56
9     5     0   0   132   0   29     0     4     2  168    153
10    9     0   0    15   0    0     3    41    37    1  12688
---- Validation: 
scalar performance:
{'acc': 0.9169453, 'precision': 0.86923057, 'recall': 0.64800173, 'specificity': 0.98999876, 'f1': 0.67461056, 'auroc': 0.98747873}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   395     0   0    11   0    0     5    25     4    0     43
1     0  1247   0    11   0    0     0    71     3    0      0
2     4     0   5    28   0    0     1    20     3    4    247
3     1     2   1  8125   0    1     2   226    79    1      2
4     3     0   1     6   2    0     0    23    12    1    491
5     2     0   0   178   0  178     0     0     3  142     18
6    14     0   0    36   0    0  1780    42     6    0     30
7     2     8   0   263   0    0     1  6951    27    0     13
8     2     0   0   161   0    0     0   327  2742    0     64
9     6     0   1   125   0   29     0     3     2  166    161
10    8     0   0    14   0    1     3    39    42    0  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65990347, 'precision': 0.6809503, 'recall': 0.5297884, 'specificity': 0.96590734, 'f1': 0.49421722, 'auroc': 0.83420366}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9     10
0   1087     0   0   27   0   2     1    32     2    3    16
1      0  1247   0    9   0   0     0   236     1    0     6
2     12     0   2   32   0   1     1    98    87   33   749
3      0     0   0    0   0   0     0     0     0    0     0
4      0     0   0    3   2   0     2     3     5    0  1618
5     15     0   0  123   0  73     0     6     0  343    32
6      2     9   0   50   0   0  2878    82     5    0    41
7      1     0   0   51   0   0     0  1111     0    0     1
8      1     1   0   69   0   0     2   123  1151    3    20
9     41     7   3  258   0   3     2   137    38  237   411
10     0     1   0    0   0   0     0     1     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-22 20:15:20.824425,epoch time: 1:14:22.679175,used: 8:46:58.427893,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9319617, 'precision': 0.9214899, 'recall': 0.7061027, 'specificity': 0.9918449, 'f1': 0.7221168, 'auroc': 0.9894168}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   363     0   0    10   0    3     3    38     5    4     57
1     0  1258   0    10   0    0     0    60     2    0      2
2     1     0   2    27   0    3     1    22     4   59    193
3     0     0   0  8111   0   10     0   256    54    1      3
4     2     1   0     2   2    0     0    14    13   15    490
5     0     0   0    66   0  365     0     1     4   79      6
6     4     0   0    12   0    1  1799    57     7    1     26
7     0    11   0   122   0    0     1  7083    26    0     21
8     0     0   0   187   0    2     3   220  2802    3     79
9     0     0   0    27   0   85     0    14     2  313     52
10    1     0   0     9   0    1     4    28    14    2  12735
---- Validation: 
scalar performance:
{'acc': 0.9318443, 'precision': 0.9193257, 'recall': 0.7087405, 'specificity': 0.9918392, 'f1': 0.7241816, 'auroc': 0.9894922}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   362     0   0     9   0    2     5    31     3    3     68
1     0  1261   0     6   0    0     0    56     5    0      4
2     1     0   5    34   0    2     1    11     3   72    183
3     0     0   0  8123   0   17     2   234    58    0      6
4     1     0   0     4   4    1     0    12    13   13    491
5     0     0   0    61   0  369     0     0     4   81      6
6     3     1   0    13   0    0  1805    61     4    2     19
7     0    13   0   140   0    0     1  7070    24    0     17
8     0     1   0   202   0    3     5   214  2774    3     94
9     0     0   0    33   0   87     0     9     1  320     43
10    3     0   0    11   0    1     3    19    13    2  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6576646, 'precision': 0.57601166, 'recall': 0.5498212, 'specificity': 0.96574956, 'f1': 0.5109973, 'auroc': 0.8266734}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   594     0   0   60   0   59     1   214     5  197    40
1     0  1048   0   23   0    0     2   406     6    0    14
2     2     1   1   18   0   11     3   123   210  127   519
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    4   0    0     7     4    14    0  1604
5     0     0   0   96   0  397     0     3     1   94     1
6     0     0   0   16   0    0  2989    52     1    0     9
7     0     0   0    9   0    0     0  1152     0    0     3
8     0     0   0   78   0    6     1    83  1198    0     4
9     3     0   1  129   0  102     1   279   113  379   130
10    0     0   0    1   0    0     2     1     0    0  1642
better model found
persisted
after epoch: 10,now: 2024-07-22 21:36:49.751415,epoch time: 1:21:28.926990,used: 10:08:27.354883,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8954142, 'precision': 0.84769136, 'recall': 0.6591809, 'specificity': 0.9877653, 'f1': 0.6906123, 'auroc': 0.98155415}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   317     1   0    16   0    0    35    79     1    2     32
1     0  1213   0     8   0    0     1    92     7    0     11
2     4     1  16    28  10    1     6    31     2   41    172
3     0     4   0  7448   0    1    30   699   238    1     19
4     5     0   0     9  76    2     5    29     6   14    393
5     2     3   0   145   0  194     5     8    10  149      5
6    22     0   0    13   0    0  1793    63     4    0     13
7     2    24   0   104   3    0    12  7000    30    0     89
8     5     2   0    61   2    0    18   363  2499    3    342
9     7     0   4    61   1   22    11    34     6  290     57
10   38     3   0    33   1    0    42    44     2    5  12621
---- Validation: 
scalar performance:
{'acc': 0.8956533, 'precision': 0.8322686, 'recall': 0.6577515, 'specificity': 0.9877967, 'f1': 0.68495476, 'auroc': 0.981179}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   333     2   0    10   0    0    40    62     0    3     33
1     0  1213   0    12   0    0     0    97     3    0      7
2     4     0   8    28  14    0     5    29     5   50    169
3     1     2   0  7440   0    3    33   727   220    0     14
4     5     1   1     7  65    1     7    22     4   14    412
5     2     1   1   160   0  187     8    10    10  137      5
6    20     1   0    10   0    0  1759    97     2    3     16
7     0    19   0    86   1    0    10  7024    32    0     93
8     2     2   0    70   1    0    20   351  2534    3    313
9    11     5   2    51   0   25     5    29     5  298     62
10   43     1   0    31   2    1    43    44     5    3  12623
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.623522, 'precision': 0.64028025, 'recall': 0.487658, 'specificity': 0.9625133, 'f1': 0.46633875, 'auroc': 0.84185535}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   539     1   0  100   0    0    90   426     3    0    11
1     0  1144   0   33   1    0     4   296     5    0    16
2     4     2   6  113   1    5    41   200    81  127   435
3     0     0   0    0   0    0     0     0     0    0     0
4     1     2   0   42   1    0    62    14     5    1  1505
5     1     2   0  391   0  108     5    14     2   68     1
6     0     0   0   18   0    0  3043     6     0    0     0
7     0     0   0   24   0    0     4  1128     0    0     8
8     0     0   0  147   0    0    45    93  1061    0    24
9     5     3   3  389   0   17    60   223    82  266    89
10    0     1   0   15   0    0    13     1     0    0  1616
early stop counter: 1
val acc:0.8956533074378967, best validation acc: 0.9318442940711975, corresponding to test acc:                         0.6576645970344543 / 0.6599034667015076
after epoch: 11,now: 2024-07-22 22:44:50.265373,epoch time: 1:08:00.513958,used: 11:16:27.868841,model: blood_mon_eos_bas_te_acevedo_dann_b888c1ef2_not_commited_2024md_07md_22_11_28_22_seed_2_22562784
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
slurmstepd: error: *** JOB 22562784 ON supergpu02 CANCELLED AT 2024-07-22T23:29:53 DUE TO TIME LIMIT ***
