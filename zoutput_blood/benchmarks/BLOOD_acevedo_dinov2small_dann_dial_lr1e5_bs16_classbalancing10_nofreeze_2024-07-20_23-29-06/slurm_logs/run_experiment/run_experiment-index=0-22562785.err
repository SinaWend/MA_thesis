Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 23:29:32 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785

 Experiment start at: 2024-07-20 23:54:31.131888
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9235873, 'precision': 0.84085935, 'recall': 0.7961847, 'specificity': 0.9916843, 'f1': 0.80592084, 'auroc': 0.9942813}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    1     5    0    0    17     0     7    8     36
1     0  1244    2    19    0    0     0    38    17    0     12
2     1     0  155     1   35    5     3     0    11   94      7
3     0     1    1  8184    0   27     1    71   147    5      0
4     4     0   36     0  199    2     1     1    61   16    219
5     1     0    1    27    0  314     1     0     7  169      1
6    18     0    0    18    0    1  1841     1     9    5     15
7     2    19   26   668    1    1     1  6119   397    7     24
8     1     0    7   180    3    7     0    19  3064    1     13
9     3     0   28     5    0   41     2     1     8  403      2
10   27     0    5     8    4    0    22     6   125    6  12588
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9238197, 'precision': 0.8428595, 'recall': 0.7925564, 'specificity': 0.9916935, 'f1': 0.8043567, 'auroc': 0.9940507}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    1     5    0    0    23     1     4    5     38
1     0  1251    0    23    0    0     0    33    16    0      9
2     1     0  145     0   38    2     2     1    10  106      7
3     0     1    1  8188    0   17     0    73   154    5      1
4     4     0   41     0  186    2     0     2    61   14    229
5     0     0    0    26    0  318     1     0     8  167      1
6    15     1    0     6    0    0  1846     0    16    9     15
7     2    17   19   670    1    1     1  6122   401    6     25
8     1     0    5   174    1    7     0    19  3071    2     16
9     2     0   31     9    0   34     2     0     8  405      2
10   17     0    4     7   12    1    21     6   128    1  12599
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6573148, 'precision': 0.61347353, 'recall': 0.57326597, 'specificity': 0.9657558, 'f1': 0.5526381, 'auroc': 0.87886065}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1022     0    0   45   0    0     7    29     9   56     2
1      1  1059    1   43   0    0     0   323    26    1    45
2     19     0  183   27  13    9     0    38   415   78   233
3      0     0    0    0   0    0     0     0     0    0     0
4      1     0    4    0   3    0     1     1    57    1  1565
5      2     0    0   91   0  308     0     0    15  173     3
6     13     1    0    7   0    0  2393     2   406    0   245
7      1     0    0   62   0    0     0  1092     6    0     3
8      1     0    0  148   0    2     0     3  1211    4     1
9      8     0  124  162   0   81     2    68   183  481    28
10     0     0    0    0   1    0     0     0     2    0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-21 00:41:53.121239,epoch time: 0:47:21.989351,used: 0:47:21.989351,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93902504, 'precision': 0.85787266, 'recall': 0.8180045, 'specificity': 0.993346, 'f1': 0.8094018, 'auroc': 0.99606866}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    5     2    0    3     7     3     3    2     57
1     0  1235    0    17    0    2     0    75     2    0      1
2     0     0  262     1    0    3     0     6     5   32      3
3     0     0    0  8172    0   89    13    95    68    1      0
4     3     0  186     0  104    1     0     4    41    9    191
5     0     0    3     6    0  439     0     0     4   68      1
6    10     1    5     1    0    1  1867     0     3    1     19
7     3     4    7   425    0    1     4  6731    80    1      6
8     0     0   12   223    1    9     3    61  2967    3     16
9     1     0   93     4    0   94     0     1     2  298      0
10    8     1   18     9    9    2    14    23    85    3  12621
---- Validation: 
scalar performance:
{'acc': 0.9410191, 'precision': 0.86339927, 'recall': 0.82088447, 'specificity': 0.9935257, 'f1': 0.81080943, 'auroc': 0.9962747}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   401     0    3     2   0    2     8     2     2    4     59
1     0  1244    0    15   0    1     0    68     4    0      0
2     1     0  269     1   0    2     0     2     4   30      3
3     0     0    0  8194   0   79     6    88    71    2      0
4     1     0  184     1  94    2     0     4    32   14    207
5     0     0    3     5   0  437     0     0     5   70      1
6    14     0    3     1   0    2  1855     1     1    3     28
7     2     5   14   379   0    1     3  6785    68    1      7
8     1     0   14   224   2   10     0    65  2948    2     30
9     1     0   88     4   0   86     0     1     1  311      1
10   13     0   20     9   3    0     9    23    73    4  12642
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68243194, 'precision': 0.6449027, 'recall': 0.5964092, 'specificity': 0.9681259, 'f1': 0.58425426, 'auroc': 0.8755268}
confusion matrix:
      0     1    2    3   4    5     6    7     8    9     10
0   1076     0    4    9   0    5    24   11     2   16    23
1      1  1078    0   26   0    0     0  362     9    1    22
2      3     0  374    5  23   10     0   51   130   41   378
3      0     0    0    0   0    0     0    0     0    0     0
4      0     0    5    0  15    0     1    1    11    0  1600
5      3     0    8   16   0  388     3    0     7  165     2
6      0     1    1    2   0    0  2635    2     2    0   424
7      0     0    1  260   0    1     2  898     0    0     2
8      1     0    4   59   0   12     8   16  1258    5     7
9      9     0  416   34   1   75     5   81    89  387    40
10     0     0    0    0   0    0     0    1     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-21 01:28:02.912889,epoch time: 0:46:09.791650,used: 1:33:31.781001,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94624895, 'precision': 0.87089443, 'recall': 0.8232065, 'specificity': 0.9941044, 'f1': 0.83415794, 'auroc': 0.9964141}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     2    0    0     3     5     5    1     29
1     0  1210    1    12    0    0     0    96    10    0      3
2    10     0  186     1   10    2     0    18     8   69      7
3     2     1    0  8096    0   22     2   132   181    3      0
4    11     0   55     0  187    2     0    12    43   15    214
5     4     0    0    20    0  399     0     0    11   86      1
6    30     0    2     5    0    1  1835     3     8    2     22
7     1     4    3   219    1    0     2  6932    87    2     11
8     1     0    6    93    0    0     0    76  3080    0     38
9    14     0   28     8    0   69     0     5     8  360      1
10   36     0   16     8    3    1     7    32    45    2  12644
---- Validation: 
scalar performance:
{'acc': 0.9469038, 'precision': 0.86844337, 'recall': 0.8233527, 'specificity': 0.9941826, 'f1': 0.83231556, 'auroc': 0.9964161}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     2    0    1     4     6     2    1     29
1     0  1212    1    13    0    0     0    98     5    0      3
2     8     0  178     0    8    2     0    22     9   79      6
3     2     0    0  8104    0   23     1   118   187    5      0
4    13     1   72     1  175    0     0    15    35   16    211
5     2     0    0    21    0  407     0     0     7   83      1
6    26     0    0     5    1    1  1845     3     5    1     21
7     2     5    3   235    0    0     1  6938    72    4      5
8     2     0    5    85    2    2     1    77  3080    4     38
9    12     0   32     3    0   55     0     3    13  374      1
10   40     0    9     7    6    1     9    37    37    1  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6152662, 'precision': 0.60756963, 'recall': 0.54242194, 'specificity': 0.9611665, 'f1': 0.5089959, 'auroc': 0.87376803}
confusion matrix:
      0    1    2   3   4    5     6     7     8    9     10
0   1072    0    0   8   0    0    19    59     4    5     3
1      0  821    0  19   0    0     0   642     6    0    11
2    105    0  146   1  19    4     0   166   181   59   334
3      0    0    0   0   0    0     0     0     0    0     0
4      4    0    3   0   9    0     1     7    16    0  1593
5     47    0    0  26   0  231     0     1    36  250     1
6     59    0    1   8   0    0  1989    20    55    0   935
7      2    0    0  27   0    0     2  1126     6    0     1
8      3    0    0  22   0    0     1    28  1308    2     6
9    106    0  141  25   0   15     0   201   170  447    32
10     0    0    0   0   0    0     0     1     0    0  1645
better model found
persisted
after epoch: 3,now: 2024-07-21 02:14:02.471855,epoch time: 0:45:59.558966,used: 2:19:31.339967,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9412992, 'precision': 0.8715613, 'recall': 0.85655165, 'specificity': 0.99345905, 'f1': 0.8600228, 'auroc': 0.99716866}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     7    0    0     2     1     0    5     36
1     1  1195    2    25    0    0     0   103     1    0      5
2     0     0  216     0   33    0     1     4     1   55      2
3     0     4    2  8302    0   36     0    54    32    9      0
4     4     0   22     1  360    0     0     2     4   14    132
5     0     0    1     5    1  369     0     0     2  142      1
6    10     0    0    13    2    0  1861     0     1    5     15
7     1     4    4   538    2    0     1  6689    10    9      5
8     1     1   11   276   66    7     3   132  2677   30     91
9     0     0   37     2    2   18     0     0     0  434      0
10   11     0    3    11   88    0     6    14     7    5  12647
---- Validation: 
scalar performance:
{'acc': 0.94099236, 'precision': 0.86803716, 'recall': 0.85177916, 'specificity': 0.99342614, 'f1': 0.85594684, 'auroc': 0.99719536}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     4    0    0     2     0     0    7     36
1     0  1185    1    22    0    0     0   117     1    1      5
2     1     0  206     0   34    0     0     1     1   66      3
3     1     2    1  8312    0   26     0    54    33   10      1
4     4     0   25     0  368    1     0     1     6   12    122
5     0     0    1     9    0  367     0     0     3  140      1
6    12     0    1     9    0    0  1856     1     0    5     24
7     1     7    3   547    4    0     1  6676     8    8     10
8     2     1   10   265   64    7     1   120  2697   32     97
9     0     0   41     4    2   27     0     0     0  419      0
10   14     0    2     8   87    0     5    12     4    5  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6931365, 'precision': 0.68171203, 'recall': 0.57076144, 'specificity': 0.96935105, 'f1': 0.5750196, 'auroc': 0.88082904}
confusion matrix:
     0    1    2    3    4    5     6    7     8    9     10
0   976    0    0   42    2    0    37    5     1   93    14
1     1  962    0   18    1    0     1  485     2    3    26
2     3    0  185    9  379    1     2   77    60  125   174
3     0    0    0    0    0    0     0    0     0    0     0
4     0    0    0    0  420    0     1    1     5    1  1205
5     0    0    2   80    1  106     0    0     1  402     0
6     0    0    0    2    6    0  2830    3     0    1   225
7     0    0    0  254    0    0     3  902     1    1     3
8     0    0    2  116    9    0     5   42  1176    8    12
9     1    0  127   57    9    4     0  149    28  736    26
10    0    0    0    0   32    0     0    0     0    0  1614
new oracle model saved
early stop counter: 1
val acc:0.9409923553466797, best validation acc: 0.9469038248062134, corresponding to test acc:                         0.6152662038803101 / 0.6931365132331848
after epoch: 4,now: 2024-07-21 03:00:09.105916,epoch time: 0:46:06.634061,used: 3:05:37.974028,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9500749, 'precision': 0.8828752, 'recall': 0.832707, 'specificity': 0.99452513, 'f1': 0.8513466, 'auroc': 0.9973415}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     8    0    12    0    0    10     7     3    4     57
1     0  1310    0    10    0    0     0    11     1    0      0
2     1     8  188     2   39    3     0    10    15   35     10
3     0    12    0  8228    0   12     0    95    91    0      0
4     3     6   18     2  240    1     1     8    46    9    205
5     1     0    0    21    1  445     0     1     6   45      1
6     6     4    0    18    1    1  1847     5     7    1     18
7     0   141    0   231    2    0     1  6734   140    0     14
8     0    13    3    99    1    0     1    26  3126    0     26
9     1     2   52    13    5   79     0     2     8  331      0
10    2    16    2     9   15    1    10    12    45    2  12679
---- Validation: 
scalar performance:
{'acc': 0.9502207, 'precision': 0.88559735, 'recall': 0.8358356, 'specificity': 0.99453545, 'f1': 0.85447085, 'auroc': 0.99721044}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     3    0    10    0    0     9    10     2    3     54
1     0  1312    0     6    0    0     0    10     4    0      0
2     0     2  199     3   44    1     0     9    11   33     10
3     0    15    0  8230    0    9     0    90    95    0      1
4     2     5   17     1  233    1     0     5    53   10    212
5     0     3    0    30    0  429     0     0     7   51      1
6     9     3    1    14    0    1  1855     5     4    1     15
7     0   158    1   218    0    0     1  6737   135    0     15
8     0    15    0   109    2    1     2    32  3105    1     29
9     0     0   40    13    8   80     0     5     4  343      0
10    1    12    4     7   14    2     7    10    49    1  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7065697, 'precision': 0.63772476, 'recall': 0.5941099, 'specificity': 0.9706799, 'f1': 0.5691389, 'auroc': 0.87690824}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   965     4   0   98   0    1    51   33     9    2     7
1     0  1419   0   22   0    0     0   48     7    0     3
2    15    23  61   25  95   14     9   80   332   97   264
3     0     0   0    0   0    0     0    0     0    0     0
4     1    10   0    0  32    0     2    1    32    1  1554
5     6     0   1  141   0  369     2    1    18   53     1
6     2     2   0    8   0    0  3002    1     0    0    52
7     0    20   0  150   0    0     1  975    16    0     2
8     0     0   0   85   0    1     3   11  1267    0     3
9    17    22  41  139   7  127     2  131   256  364    31
10    0     0   0    0   0    0     0    0     1    0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-21 03:46:10.321171,epoch time: 0:46:01.215255,used: 3:51:39.189283,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9591449, 'precision': 0.89222205, 'recall': 0.86289084, 'specificity': 0.99546164, 'f1': 0.8729534, 'auroc': 0.99803346}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     1    0     3    1    0     1     3     0    3     12
1     0  1284    0    10    0    0     0    34     1    0      3
2     1     0  152     0   84    3     0     0     3   64      5
3     1     2    1  8257    1   27     0   104    40    6      0
4     5     0    4     1  337    2     0     2     8    2    178
5     0     0    0    17    0  457     0     0     4   41      1
6    21     0    0     4    2    0  1857     3     5    0     16
7     2     8    5   145    3    0     1  7041    45    3     11
8     1     2    1   171   12    4     2   107  2926    5     64
9     1     0   21     4    7   70     0     0     2  387      1
10   36     0    1     6   28    0     8    10     9    1  12692
---- Validation: 
scalar performance:
{'acc': 0.9609737, 'precision': 0.8993862, 'recall': 0.87118804, 'specificity': 0.9956659, 'f1': 0.88150334, 'auroc': 0.99811375}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     6    2    1     0     2     1    2     12
1     0  1281    0    11    0    0     0    36     3    0      1
2     2     0  169     0   70    1     0     2     4   61      3
3     0     2    1  8275    0   22     0   104    35    1      0
4     5     0    4     1  337    2     0     2    11    6    171
5     0     0    0    15    0  459     0     0     2   44      1
6    17     0    0     3    3    0  1869     3     2    2      9
7     0    11    4   162    5    0     2  7030    40    3      8
8     1     2    2   169   13    9     1    97  2945    2     55
9     1     0   18     4    2   66     0     0     1  401      0
10   34     0    2     7   32    0     3     5     9    1  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72615963, 'precision': 0.6468024, 'recall': 0.6086793, 'specificity': 0.9725199, 'f1': 0.5874405, 'auroc': 0.88166237}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1121     0   0   19    0    0     3    21     1    5     0
1      3  1256   0   19    1    0     0   207     4    1     8
2     46     1  66   12  322    8     0    78   219  104   159
3      0     0   0    0    0    0     0     0     0    0     0
4      4     0   0    0  145    0     2     1    19    0  1462
5     11     0   0   74    3  259     1     0     7  237     0
6      7     0   0    3    0    0  3011     1     0    0    45
7      4     0   0   42    0    0     1  1114     1    0     2
8      3     1   0  105    0    2     9    38  1207    2     3
9     28     1  43   85   20   70     4   120   179  558    29
10     0     0   0    0    4    0     0     0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-21 04:32:26.021110,epoch time: 0:46:15.699939,used: 4:37:54.889222,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9440015, 'precision': 0.8554307, 'recall': 0.81155986, 'specificity': 0.99387693, 'f1': 0.82481533, 'auroc': 0.9968919}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     6    0    0     7     2     1    0      8
1     0  1268    0    15    0    0     0    37     6    0      6
2    11     1  141     4   93    2     6    17     7   25      4
3     3     0    0  8117    1    1     0   209   108    0      0
4    28     0    2     2  242    0     6     1    36    0    222
5    16     0    2    81    1  356     3     1     8   51      1
6    14     0    0     3    0    0  1872     4     4    0     11
7     6    40    0   161    1    0     1  6877   138    0     39
8     7     0    1   114    3    1     9    35  3065    2     57
9    29     1   54    16    3   60     6     5     5  313      1
10  113     0    1     7    6    1    49     5    39    0  12573
---- Validation: 
scalar performance:
{'acc': 0.9438812, 'precision': 0.8551368, 'recall': 0.80696, 'specificity': 0.99387723, 'f1': 0.82171124, 'auroc': 0.99681234}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     8    1    0     7     5     2    0      9
1     0  1268    0    13    0    0     0    42     4    0      5
2    13     0  143     2   95    2     5    17    10   23      2
3     2     0    0  8113    0    3     2   208   111    0      1
4    25     0    1     2  247    0    16     2    37    0    209
5    12     0    2    88    1  337     4     0     6   70      1
6    13     0    0     4    0    1  1873     3     4    0     10
7     6    38    0   155    3    0     3  6906   121    0     33
8    13     0    1   119    2    0     3    40  3058    2     58
9    34     1   43    22    2   63     8     7     5  307      1
10  114     1    0     9    4    0    42     6    36    0  12584
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66389143, 'precision': 0.55958724, 'recall': 0.5265012, 'specificity': 0.9653857, 'f1': 0.47654468, 'auroc': 0.87092644}
confusion matrix:
     0     1   2    3    4    5     6     7     8   9     10
0   991     0   0   31    0    0    80    58     9   0     1
1     5  1255   0   18    0    0    10   168     8   0    35
2    94     3   8   11  125    0   242    65   190   3   274
3     0     0   0    0    0    0     0     0     0   0     0
4     5     0   0    0   11    0    26     1     7   0  1583
5    69     0   0  222    0  100   120     3    25  53     0
6     4     0   0    2    0    0  3052     0     1   0     8
7     2     4   0    1    0    0    14  1130     8   0     5
8     1     0   0   49    0    0    50    23  1224   0    23
9   153     1  26  106   16   14   305   206   200  76    34
10    0     0   0    0    0    0     4     0     0   0  1642
early stop counter: 1
val acc:0.9438812136650085, best validation acc: 0.9609736800193787, corresponding to test acc:                         0.7261596322059631 / 0.7261596322059631
after epoch: 7,now: 2024-07-21 05:18:39.380105,epoch time: 0:46:13.358995,used: 5:24:08.248217,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9586366, 'precision': 0.9177563, 'recall': 0.8466646, 'specificity': 0.995312, 'f1': 0.8781738, 'auroc': 0.9982823}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     5    0    0     3     1     1    1     52
1     0  1220    0     5    0    0     0   102     1    0      3
2     1     1  201     2   64    0     2    11     4   23      3
3     0     1    0  8095    0    0     0   271    69    0      0
4     4     0    3     1  313    0     0     2    17    1    198
5     1     0    1    72    0  374     0     0     9   63      1
6     6     0    0     3    0    0  1873     4     6    0     16
7     0     0    0    62    1    0     1  7156    38    0      6
8     1     0    0    92    3    0     0    97  3078    0     25
9     0     0   40    18    3   48     3    11     9  359      2
10    1     0    0     7    5    1     3    10    25    0  12741
---- Validation: 
scalar performance:
{'acc': 0.9587, 'precision': 0.91720545, 'recall': 0.84800136, 'specificity': 0.99531686, 'f1': 0.87880176, 'auroc': 0.9982671}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     3    1    0     4     4     0    0     50
1     0  1211    0     4    0    0     0   106     3    0      8
2     1     0  200     2   62    0     1    10     5   25      6
3     0     0    0  8097    0    1     0   267    73    1      1
4     7     0    3     1  310    1     1     2    16    0    198
5     0     0    1    62    0  389     0     0    11   57      1
6     6     0    0     4    1    0  1866     4     2    0     25
7     0     1    0    55    1    0     1  7166    32    0      9
8     0     0    1    86    3    1     0    91  3090    0     24
9     0     0   42    15    3   44     3    10    17  359      0
10    2     0    0     6    8    0     2    12    34    0  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63989365, 'precision': 0.618879, 'recall': 0.51045686, 'specificity': 0.96392024, 'f1': 0.470271, 'auroc': 0.87326103}
confusion matrix:
     0    1   2    3   4    5     6     7     8    9     10
0   881    0   0   58   0    1    12   147    23   11    37
1     0  757   0    8   0    0     1   677     5    0    51
2     4    0  16   13  52    3     2   127   315   30   453
3     0    0   0    0   0    0     0     0     0    0     0
4     0    0   0    0  29    0     3     3    12    0  1586
5     1    0   0  256   0  122     1     9    80  117     6
6     0    0   0    0   0    0  3026     1     0    0    40
7     0    0   0    1   0    0     0  1158     3    0     2
8     0    0   0   35   0    0     1    41  1292    0     1
9     3    0  12  107   1   24     2   338   361  220    69
10    0    0   0    0   0    0     1     0     0    0  1645
early stop counter: 2
val acc:0.9587000012397766, best validation acc: 0.9609736800193787, corresponding to test acc:                         0.7261596322059631 / 0.7261596322059631
after epoch: 8,now: 2024-07-21 06:05:08.971056,epoch time: 0:46:29.590951,used: 6:10:37.839168,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96305114, 'precision': 0.90220964, 'recall': 0.90724236, 'specificity': 0.99603593, 'f1': 0.90251243, 'auroc': 0.9987485}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     1    1     3    2    0     4     3     1    3     28
1     0  1281    0     8    1    0     0    36     3    0      3
2     0     0  239     0   30    2     0     3     2   36      0
3     0     2    1  8289    3   11     1    98    31    3      1
4     4     0   15     1  458    0     1     3     5    2     50
5     0     0    0    12    2  438     0     0     1   67      1
6     3     0    0     2    3    1  1880     3     2    2     11
7     0    17    2   129    4    0     2  7063    38    0      9
8     0     2    2   196   28    7     1    51  2960    5     42
9     0     0   28     4    2   41     0     2     3  413      0
10    6     0    1     7  213    1     9     5    12    0  12537
---- Validation: 
scalar performance:
{'acc': 0.96300656, 'precision': 0.89845324, 'recall': 0.9057481, 'specificity': 0.9960385, 'f1': 0.90012735, 'auroc': 0.9986724}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     5    4    0     8     3     1    5     20
1     1  1291    0     9    0    0     0    28     1    0      2
2     0     0  241     0   27    2     0     2     1   39      0
3     0     2    2  8279    0   12     1   107    36    1      0
4     3     0   17     1  448    1     0     5     4    5     55
5     0     0    0    17    0  434     0     0     0   69      1
6     2     0    0     3    2    2  1880     1     3    1     14
7     2     9    0   134    3    0     1  7063    42    2      9
8     0     0    4   179   32    7     0    51  2982    2     39
9     0     0   36     7    1   37     0     2     1  409      0
10    5     0    4     7  220    2     6     7     7    0  12538
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72385085, 'precision': 0.6662378, 'recall': 0.60390663, 'specificity': 0.97252476, 'f1': 0.591475, 'auroc': 0.8831579}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   855     0   0   51    3    3    55   150    30   18     5
1     1  1251   0   18    3    0     0   200    10    0    16
2    15     1  73   42  182   41    24   131   339   60   107
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   2    0  543    0     3     3    37    1  1044
5     0     0   1  142    1  354     1     3     7   83     0
6     1     0   0    1    0    0  3054     1     1    0     9
7     0     0   0    3    0    0     0  1158     2    0     1
8     0     0   0  143    0    1    11    37  1173    1     4
9     6     2  45  212    4  189     7   223   128  306    15
10    0     0   0    0   66    0     0     0     1    0  1579
better model found
persisted
after epoch: 9,now: 2024-07-21 06:51:37.690262,epoch time: 0:46:28.719206,used: 6:57:06.558374,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9677601, 'precision': 0.9246187, 'recall': 0.9066164, 'specificity': 0.9963945, 'f1': 0.9148785, 'auroc': 0.9988645}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     1    1    0     5     2     0    0     27
1     0  1304    0     6    0    0     0    21     1    0      0
2     0     0  245     0   33    0     0     2     0   28      4
3     1     0    0  8089    2   17     0   230    92    3      3
4     3     0   19     0  380    1     0     1     2    1    132
5     0     0    1     4    1  445     1     0     2   66      1
6     4     0    0     2    1    0  1887     1     3    0      9
7     0    13    3    58    2    0     2  7158    11    0     17
8     0     0    8    61   19    1     0   105  3037    4     61
9     0     0   28     2    6   26     0     0     1  430      0
10    7     0    0     6   18    0     6     4     1    1  12749
---- Validation: 
scalar performance:
{'acc': 0.96608263, 'precision': 0.92103964, 'recall': 0.90156543, 'specificity': 0.99620354, 'f1': 0.91000044, 'auroc': 0.9988891}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    1     1    2    0     8     2     0    0     18
1     0  1303    0     6    0    0     0    22     1    0      0
2     0     0  254     0   21    1     0     6     0   27      3
3     0     2    1  8075    1   20     0   234    98    4      5
4     3     0   20     0  359    0     0     2     2    3    150
5     0     0    1     7    1  425     0     0     4   82      1
6     7     0    0     0    1    0  1888     0     1    1     10
7     0    14    2    48    1    0     1  7160    18    0     21
8     0     0    6    66   19    2     0   101  3030    3     69
9     0     0   28     2    6   27     0     3     0  425      2
10    5     1    2     7   21    0     4     4     5    0  12747
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7344854, 'precision': 0.6576763, 'recall': 0.62441266, 'specificity': 0.9732529, 'f1': 0.6058427, 'auroc': 0.88386554}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   941     0    0  24    4    1    38   101    28   13    20
1     0  1286    0  11    0    0     0   187     1    0    14
2     4     1  269   4  158   18     9   104   169   55   224
3     0     0    0   0    0    0     0     0     0    0     0
4     1     1    7   0   99    0     3     3    16    0  1503
5     1     0    3  71    4  342     2     3    26  137     3
6     1     0    0   1    0    0  3047     1     0    0    17
7     0     0    0   8    0    0     0  1148     1    0     7
8     0     0    0  32    0    2     6    51  1274    0     5
9     2     0  121  41    9  153     2   182   144  450    33
10    0     0    0   0    4    0     0     0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-21 07:37:48.577486,epoch time: 0:46:10.887224,used: 7:43:17.445598,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9627569, 'precision': 0.91735226, 'recall': 0.8623303, 'specificity': 0.9959606, 'f1': 0.87395203, 'auroc': 0.9987847}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     1    1    0    16     1     0    2     25
1     0  1277    0     6    0    0     0    33     7    0      7
2     1     0  101     0   61    2     4     1     2  131      9
3     0     0    0  8000    0    8     0   217   212    1      1
4     6     0    1     0  368    1     1     0     7    3    152
5     0     0    0    15    0  473     0     1     9   22      1
6     2     0    0     0    0    0  1893     1     1    0     11
7     0     5    0    64    2    0     3  7121    63    1      5
8     2     0    1    19    7    0     2    38  3199    0     27
9     1     0    1     2    1   79     0     2     2  405      0
10   14     0    0     6   13    1    19     9    20    0  12710
---- Validation: 
scalar performance:
{'acc': 0.9623913, 'precision': 0.9229423, 'recall': 0.863204, 'specificity': 0.9959089, 'f1': 0.87471086, 'auroc': 0.9988259}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   438     1   0     2    1    0    18     1     0    1     21
1     0  1272   0     5    0    0     0    43     3    0      9
2     1     0  93     0   63    1     1     6     2  136      9
3     0     0   0  7996    0    6     1   214   221    2      0
4     5     0   1     0  366    1     4     0     9    3    150
5     0     0   0    19    0  475     0     0     4   22      1
6     3     0   0     1    0    1  1895     1     3    0      4
7     0     4   0    71    2    0     4  7086    88    0     10
8     1     0   0    22    1    0     2    28  3203    4     35
9     1     0   0     2    2   55     0     2     3  425      3
10   13     0   0     7   11    2    17     4    12    0  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6918771, 'precision': 0.6381419, 'recall': 0.5755105, 'specificity': 0.96863794, 'f1': 0.54692245, 'auroc': 0.8703574}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   768     0   0   22    0    3   267    66    14   25     5
1     4  1211   0   16    1    0     2   150    26    0    89
2    10     0   7    9  169   16    47    58   284   77   338
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    1   68    0     6     1    11    0  1545
5     0     0   0  102    3  334    15     0    16  118     4
6     0     0   0    1    0    0  3036     0     1    0    29
7     1     0   0    9    0    0     0  1142     8    0     4
8     0     0   0   47    0    0    11    14  1293    0     5
9     6     1   3  144   28  113    29   164   206  388    55
10    0     0   0    0    2    0     2     0     0    0  1642
early stop counter: 1
val acc:0.9623913168907166, best validation acc: 0.9660826325416565, corresponding to test acc:                         0.734485387802124 / 0.734485387802124
after epoch: 11,now: 2024-07-21 08:24:02.404895,epoch time: 0:46:13.827409,used: 8:29:31.273007,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97174656, 'precision': 0.93834364, 'recall': 0.9025924, 'specificity': 0.99692464, 'f1': 0.9169494, 'auroc': 0.9991676}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     4    0    0     7     4     0    0     17
1     0  1307    0     0    0    0     0    20     5    0      0
2     1     0  240     0    7    1     1     1     7   51      3
3     0    11    0  8217    0    0     0   103   107    1      0
4     8     0   26     0  341    1     6     6    27    1    123
5     0     0    0    38    0  424     1     0     6   51      1
6     3     0    0     1    0    0  1895     1     3    0      4
7     0    10    0    89    0    0     1  7131    30    0      3
8     1     0    0    39    0    0     0    45  3209    0      1
9     3     0    7     5    1   35     5     1     0  436      0
10    6     0    3     7   14    0    19    11    62    0  12669
---- Validation: 
scalar performance:
{'acc': 0.9735188, 'precision': 0.9406637, 'recall': 0.9064949, 'specificity': 0.99711084, 'f1': 0.92028654, 'auroc': 0.9991086}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     1    0     4    0    0     4     1     3    1     14
1     0  1304    0     0    0    0     0    24     4    0      0
2     1     0  242     1    8    1     2     3     5   47      2
3     0     8    0  8249    0    4     1    92    86    0      0
4     8     0   27     1  341    1     6     4    33    2    116
5     0     0    0    26    0  442     1     0     5   46      1
6     2     0    0     1    0    0  1892     4     3    1      5
7     0     8    0    92    1    0     1  7133    26    0      4
8     0     0    0    34    0    0     0    40  3213    1      8
9     1     0   10     7    1   33     2     2     5  432      0
10    7     0    2     7   10    0    13     7    57    1  12692
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6959351, 'precision': 0.67557585, 'recall': 0.561189, 'specificity': 0.96953833, 'f1': 0.54672325, 'auroc': 0.880867}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   797     0    0  132    0    0   125    82    25    2     7
1     0  1282    0    9    0    0     0   185     6    0    17
2    22     3  109   32   79    7    31    81   391   36   224
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    1    0  202    0    31     2    46    0  1350
5     6     0    1  270    0  140    13     2    57  100     3
6     0     0    0    1    0    0  3057     1     4    0     4
7     0     0    0   28    0    0     1  1132     1    0     2
8     0     1    0   51    0    0     3    18  1297    0     0
9    14     3   51  229    5   50    20   140   295  294    36
10    0     0    0    0    5    0     3     1     0    0  1637
better model found
persisted
after epoch: 12,now: 2024-07-21 09:10:05.451307,epoch time: 0:46:03.046412,used: 9:15:34.319419,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97206765, 'precision': 0.9271896, 'recall': 0.9073269, 'specificity': 0.99708617, 'f1': 0.91200924, 'auroc': 0.9991998}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     1    0     0    0    0    11     0     0    0     15
1     0  1311    0     3    0    0     0    13     4    0      1
2     3     0  173     0   83    0     2     1     4   44      2
3     3     7    0  8113    0    6     9   140   156    1      0
4     8     0    1     0  455    0     1     0    14    1     59
5     3     0    0     1    4  443     1     0     4   65      0
6     0     0    0     0    0    0  1898     1     3    0      6
7     2    21    0    59    1    0     5  7115    53    0      8
8     2     0    0    11    4    0     3    18  3249    1      8
9     1     0   11     3    7   22     3     1     4  439      2
10    3     0    0     6   54    0    25     4    21    0  12681
---- Validation: 
scalar performance:
{'acc': 0.9714859, 'precision': 0.92842525, 'recall': 0.90929174, 'specificity': 0.99700814, 'f1': 0.9141018, 'auroc': 0.99924105}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     0    0    0    12     0     0    0     13
1     0  1307    0     1    0    0     2    17     4    0      1
2     2     0  179     0   88    1     0     2     2   35      3
3     0     8    0  8096    0    9    12   148   165    2      0
4     5     0    0     0  449    0     2     1    14    0     68
5     3     0    0     4    3  437     2     0     6   65      1
6     3     0    0     0    0    0  1898     0     3    0      4
7     0    16    0    68    1    0     7  7111    52    0     10
8     0     0    1     7    3    0     1    22  3252    0     10
9     4     0   11     1    3   19     1     0     2  452      0
10    6     0    1     6   56    0    17     5    25    0  12680
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7288183, 'precision': 0.64171535, 'recall': 0.59945065, 'specificity': 0.9724985, 'f1': 0.5817729, 'auroc': 0.88192976}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1089     0   0    4    0    0    61     2     1    1    12
1      0  1328   0    4    1    0     2   106     6    1    51
2     35     1  35    1  371    2    11    37   268   41   213
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  331    0     8     1    25    0  1268
5     47     0   2   25   21  214    14     0    37  205    27
6      1     0   0    1    0    0  3051     1     2    0    11
7      2     0   0  121    0    0     3  1029     1    1     7
8      3     0   0   19    1    4    14    16  1309    1     3
9     47     3  47   27   95   44    19    80   310  406    59
10     0     0   0    0   15    0     5     1     0    0  1625
early stop counter: 1
val acc:0.9714859127998352, best validation acc: 0.9735187888145447, corresponding to test acc:                         0.695935070514679 / 0.734485387802124
after epoch: 13,now: 2024-07-21 09:56:24.885504,epoch time: 0:46:19.434197,used: 10:01:53.753616,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96888375, 'precision': 0.93723714, 'recall': 0.9048643, 'specificity': 0.99661124, 'f1': 0.9167718, 'auroc': 0.99931335}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     2    0    0     0     1     4    0      8
1     0  1312    0     7    0    0     0     9     2    0      1
2     1     0  188     1   21    0     0     1     9   90      1
3     0     0    0  8361    0    3     0    12    64    0      0
4     5     0   15     2  385    0     0     0    23    4    105
5     0     0    1    13    1  476     0     0     8   22      0
6     5     0    0     1    0    0  1891     0     6    0      5
7     1    12    0   318    1    0     1  6754   168    0      6
8     0     1    1    45    0    0     0     4  3240    0      5
9     1     0    2     3    3   40     0     1     8  434      1
10    5     0    1     9   14    0     5     3    51    0  12704
---- Validation: 
scalar performance:
{'acc': 0.968918, 'precision': 0.94208556, 'recall': 0.907689, 'specificity': 0.9966078, 'f1': 0.91975296, 'auroc': 0.999265}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    0    0     2     0     0    0     15
1     0  1306    0    10    0    0     0    15     1    0      0
2     2     0  185     0   22    0     0     2     4   95      2
3     0     0    0  8356    0    2     0    19    61    2      0
4     5     0    8     0  398    0     0     1    34    3     90
5     2     0    0    12    0  483     0     0     6   18      0
6     1     0    0     2    0    1  1894     1     3    0      6
7     1    19    0   334    1    0     2  6748   155    1      4
8     0     1    0    49    2    0     0     5  3235    0      4
9     0     0    1     4    1   37     0     1     6  442      1
10    4     0    0     8   17    0     6     8    42    0  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7048905, 'precision': 0.66889817, 'recall': 0.5817739, 'specificity': 0.97061014, 'f1': 0.57300675, 'auroc': 0.8808756}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1025     0   0   27    1    0    16   27    64    1     9
1      2  1168   0   42    1    0     3  248    17    2    16
2     42     0  67   27  164    6     8   48   357   50   246
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   0    0  248    0    12    1    41    1  1330
5     25     0   2  133    5  270     0    0    29  118    10
6      1     0   0    2    0    0  3058    1     2    0     3
7      2     0   0  231    0    0     1  925     4    0     1
8      0     0   0   67    0    1     3    8  1289    0     2
9     50     0  37  208   12   71     3   81   239  395    41
10     0     0   0    0   14    0     1    0     1    0  1630
early stop counter: 2
val acc:0.9689180254936218, best validation acc: 0.9735187888145447, corresponding to test acc:                         0.695935070514679 / 0.734485387802124
after epoch: 14,now: 2024-07-21 10:42:38.239899,epoch time: 0:46:13.354395,used: 10:48:07.108011,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9702483, 'precision': 0.9274634, 'recall': 0.90166885, 'specificity': 0.99683917, 'f1': 0.9055626, 'auroc': 0.99941844}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     1    5    0     7     1     0    3     17
1     0  1303    0     7    0    0     0    14     6    0      2
2     0     0  249     0    5    0     0     0     0   55      3
3     0     0    2  8238    0    8     0    24   147   17      0
4     3     0   34     0  380    0     1     0     5    5    111
5     0     0    0     6    0  322     1     0     2  189      1
6     4     0    0     1    0    0  1890     2     2    0      8
7     2     6    7   158    0    0     1  6945   122   13      9
8     0     0    1     6    4    1     0     8  3254    8     14
9     0     0    7     0    0    2     0     0     0  484      0
10    3     0    1     7    6    0     6     2    17    2  12750
---- Validation: 
scalar performance:
{'acc': 0.9706567, 'precision': 0.93072367, 'recall': 0.9029808, 'specificity': 0.99687684, 'f1': 0.908012, 'auroc': 0.9994285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     1    0     2    2    0     4     0     0    2     26
1     0  1301    1     3    0    0     2    13     9    0      3
2     0     0  253     0    2    1     0     0     1   54      1
3     0     0    1  8247    0   10     1    19   154    8      0
4     1     0   33     0  384    0     1     0     6    7    107
5     0     0    0     4    0  322     1     0     6  187      1
6     3     0    0     2    0    0  1891     0     2    2      8
7     0     5    5   155    0    0     2  6972   108   10      8
8     0     0    2    14    6    0     3    12  3242    7     10
9     0     0    7     0    0    0     0     0     0  485      1
10    2     0    1     7    6    0    12     3    18    2  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72504026, 'precision': 0.672939, 'recall': 0.5973599, 'specificity': 0.97225547, 'f1': 0.58233666, 'auroc': 0.87649035}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   994     0    0   35    0    0    45   29    28   24    15
1     3  1251    0   14    1    0     7  137    22   19    45
2    11     0  178    4  158    2    15   15   156  162   314
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    0  106    0     6    0    15    1  1502
5     3     0    0   38    4  117     3    0    10  416     1
6     0     0    0    2    0    0  3030    0     2    0    33
7     2     0    2  156    0    0     4  954     6   36     4
8     0     0    1   17    3    1     5    7  1307   13    16
9     7     1   66   20   13   27     5   18   162  785    33
10    0     0    0    0    3    0     2    0     0    0  1641
early stop counter: 3
val acc:0.97065669298172, best validation acc: 0.9735187888145447, corresponding to test acc:                         0.695935070514679 / 0.734485387802124
after epoch: 15,now: 2024-07-21 11:28:57.990516,epoch time: 0:46:19.750617,used: 11:34:26.858628,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9734054, 'precision': 0.95145625, 'recall': 0.91311544, 'specificity': 0.99693257, 'f1': 0.9304787, 'auroc': 0.9994426}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     1    0    0     0     3     0    0      6
1     0  1292    0     4    0    0     0    32     1    0      2
2     2     0  240     0   34    0     0     9     0   18      9
3     0     0    0  8264    0    2     0   134    40    0      0
4     6     0    4     1  386    0     0     1     6    1    134
5     0     0    0    18    0  482     0     0     2   18      1
6    18     0    0     0    2    0  1848     4     3    0     32
7     0     1    0    67    1    0     0  7179     3    0     10
8     0     0    0    85    2    0     0   113  3043    0     53
9     1     0   22     5    2   37     1    15     3  407      0
10    8     0    0     6    4    0     2     3     2    0  12768
---- Validation: 
scalar performance:
{'acc': 0.97156614, 'precision': 0.947296, 'recall': 0.9044377, 'specificity': 0.9967092, 'f1': 0.923975, 'auroc': 0.9994124}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     2    0    0     0     0     2    0     16
1     0  1289    0     4    0    0     0    35     1    0      3
2     2     0  234     0   37    0     0     9     2   16     12
3     0     0    0  8257    0    0     0   152    30    0      1
4     5     0    2     1  382    0     0     0     7    0    142
5     1     0    0    21    1  468     0     0     4   25      1
6    13     0    0     2    0    0  1868     2     0    0     23
7     0     3    0    66    0    0     0  7180     6    0     10
8     0     0    1    92    2    0     0   123  3015    0     63
9     4     0   28     3    1   41     0    11     1  398      6
10    9     1    0     6    6    0     1     2     3    0  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68949836, 'precision': 0.61354053, 'recall': 0.5755825, 'specificity': 0.9687687, 'f1': 0.5519838, 'auroc': 0.87073493}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1077     0   0   27    1    0     2    55     1    1     6
1      0  1269   0    7    0    0     0   184     1    0    38
2     48     0  53   18  273    3     1   132    78   28   381
3      0     0   0    0    0    0     0     0     0    0     0
4      3     0   0    0   90    0     2     2     6    0  1530
5     37     0   3  125   10  219     1     5     9  165    18
6      5     0   0    2    2    0  2797     3     0    0   258
7      1     0   0   10    0    0     0  1151     0    0     2
8      1     0   0   64    5    2     2    75  1208    0    13
9     63     2  82   87   48   73     0   317    45  349    71
10     0     0   0    0    3    0     0     1     0    0  1642
early stop counter: 4
val acc:0.9715661406517029, best validation acc: 0.9735187888145447, corresponding to test acc:                         0.695935070514679 / 0.734485387802124
after epoch: 16,now: 2024-07-21 12:15:06.486211,epoch time: 0:46:08.495695,used: 12:20:35.354323,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9812714, 'precision': 0.95014906, 'recall': 0.9475487, 'specificity': 0.9980155, 'f1': 0.9475951, 'auroc': 0.99962986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    5    1     2     1     0    2      7
1     0  1280    0     4    0    0     0    46     2    0      0
2     0     0  281     0    7    3     0     1     2   18      0
3     1     0    1  8303    0   21     0    65    44    1      0
4     1     0    6     0  477    1     0     3     7    2     42
5     0     0    0     1    0  512     0     0     1    6      1
6     1     0    0     0    0    1  1900     1     3    0      2
7     0     0    0    70    0    0     1  7157    30    2      3
8     0     0    1    29    0    2     0    25  3236    0      3
9     0     0   13     0    0   86     0     1     1  392      0
10    3     0    2     5   53    2     6    14    34    0  12674
---- Validation: 
scalar performance:
{'acc': 0.98162365, 'precision': 0.9518123, 'recall': 0.9456317, 'specificity': 0.9980598, 'f1': 0.94694084, 'auroc': 0.9996269}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    2     1    4    4     7     0     1    2      4
1     0  1271    0     3    0    0     0    55     2    0      1
2     0     0  275     0    7    2     0     8     2   18      0
3     0     0    0  8317    0   17     0    64    42    0      0
4     1     0    5     0  487    0     0     5     7    0     34
5     0     0    0     2    0  517     0     0     1    1      0
6     1     1    0     0    0    0  1900     2     3    0      1
7     0     0    0    70    0    0     0  7177    15    0      3
8     0     0    1    27    0    2     0    21  3244    0      1
9     0     0   10     1    0   96     1     0     1  384      0
10    8     0    1     8   56    2     3    14    36    0  12668
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71447563, 'precision': 0.64685476, 'recall': 0.6017668, 'specificity': 0.9713663, 'f1': 0.5857532, 'auroc': 0.8804529}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   916    0   14  18   10    4    50    78    17   59     4
1     1  874    0  25    1    0     1   566    17    0    14
2     4    0  163   2  217   23     3   136   261   80   126
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    2   0  413    0     4     4    24    1  1185
5     2    0   11  32    6  340     0     0     8  193     0
6     0    0    1   4    0    0  3045     3     2    0    12
7     0    0    0  12    0    0     1  1149     1    1     0
8     0    0    0  45    0    3     0    37  1284    1     0
9     4    0   80  44   12  202     2   208   130  428    27
10    0    0    0   0   42    0     1     2     1    0  1600
better model found
persisted
after epoch: 17,now: 2024-07-21 13:01:17.972843,epoch time: 0:46:11.486632,used: 13:06:46.840955,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97725815, 'precision': 0.943252, 'recall': 0.95152956, 'specificity': 0.9976145, 'f1': 0.9458529, 'auroc': 0.9996378}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    2    0     3     1     0    2     13
1     0  1318    0     0    0    0     0    13     0    0      1
2     0     0  246     0   19    1     0     0     0   45      1
3     0     0    0  8058    0   60     1   128   184    8      1
4     5     0    5     0  492    0     0     0     3    1     33
5     0     0    0     1    0  497     0     0     2   21      0
6     0     0    0     0    0    0  1897     0     0    0     11
7     0    10    0    42    0    0     1  7138    58    7      8
8     0     0    2     5    5    1     0    11  3237    8     24
9     0     0    3     0    0   18     0     0     0  472      0
10    2     0    1     6   57    0     3     4     9    0  12709
---- Validation: 
scalar performance:
{'acc': 0.97696936, 'precision': 0.94164205, 'recall': 0.94810987, 'specificity': 0.99759865, 'f1': 0.94293416, 'auroc': 0.9996332}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    0    0     3     1     0    0      8
1     0  1320    0     1    0    0     0     8     2    0      1
2     0     0  236     0   20    1     0     1     0   52      2
3     1     3    0  8054    0   57     1   126   186   12      0
4     6     0    4     0  485    1     0     2     2    5     34
5     0     0    0     2    0  491     0     0     1   27      0
6     1     0    0     0    0    0  1897     1     0    0      9
7     1    13    3    42    0    0     1  7130    64    2      9
8     0     0    0     9    3    1     0    14  3246    7     16
9     1     0    1     0    0   20     0     0     0  471      0
10    2     0    1     5   50    0     3     5     6    1  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7605821, 'precision': 0.68122435, 'recall': 0.6320764, 'specificity': 0.97581506, 'f1': 0.6170827, 'auroc': 0.88331306}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   955     0    0  38    1    2    35    80    11   36    12
1     0  1352    0   5    1    0     0   115    17    0     9
2     7     2  128   1  310    8     9    35   263  141   111
3     0     0    0   0    0    0     0     0     0    0     0
4     0     2    3   0  392    0     5     2    18    2  1209
5     5     0    3  21    9  174     4     1    13  362     0
6     0     0    0   2    0    0  3043     2    10    0    10
7     1     0    0  14    0    0     1  1141     2    4     1
8     0     1    0   6    0    4     1    13  1331    8     6
9     6     7   51  14   21   59     0    51   175  735    18
10    0     0    0   0   25    0     0     0     1    0  1620
new oracle model saved
early stop counter: 1
val acc:0.9769693613052368, best validation acc: 0.981623649597168, corresponding to test acc:                         0.7144756317138672 / 0.7605820894241333
after epoch: 18,now: 2024-07-21 13:47:25.264007,epoch time: 0:46:07.291164,used: 13:52:54.132119,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97880995, 'precision': 0.9401665, 'recall': 0.9545306, 'specificity': 0.9977666, 'f1': 0.9464556, 'auroc': 0.9995818}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    1     1    2    0     0     0     0    0      4
1     0  1323    0     4    0    0     0     4     1    0      0
2     1     0  295     0    4    1     0     2     1    7      1
3     0     0    1  8345    0    1     0    28    64    0      0
4     5     0   10     0  478    0     0     0     8    1     37
5     0     0    1    11    1  456     0     0     1   51      0
6     8     0    0     4    0    0  1891     2     0    0      2
7     2    17    4   184    1    0     0  7002    49    1      5
8     0     0    5    17    7    0     0     8  3256    1      0
9     0     0   39     2    0    7     1     0     2  440      0
10   14     0    4     8   85    0     4     7    48    0  12623
---- Validation: 
scalar performance:
{'acc': 0.97755784, 'precision': 0.9405839, 'recall': 0.955922, 'specificity': 0.9976264, 'f1': 0.9473832, 'auroc': 0.99957645}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    1     0    2    0     1     0     0    0      3
1     0  1322    0     0    0    0     0     5     3    0      2
2     0     0  299     1    5    0     0     0     2    5      0
3     2     0    1  8325    0    2     0    20    86    4      0
4     4     0    9     0  472    0     1     0     7    2     44
5     0     0    1    12    0  457     0     0     2   48      1
6     6     1    0     7    0    0  1887     0     3    0      4
7     2    20    2   202    1    0     0  6985    51    0      2
8     0     0    8    22    7    1     0     9  3241    3      5
9     1     0   29     0    0    5     0     2     3  453      0
10   11     0    4     5   96    0     4     0    46    1  12629
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7022319, 'precision': 0.6311359, 'recall': 0.57531106, 'specificity': 0.9703015, 'f1': 0.5653271, 'auroc': 0.8743372}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   908     0    9  105    6    0    15    83    32    8     4
1     1  1274    0   25    1    0     3   164    18    0    13
2    16     0  171   35  279    5    10    41   302   19   137
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    3    0  180    0    27     1    41    0  1380
5     7     0   18  197   10  195     2     0    37  125     1
6     0     0    0   23    0    0  3021     2    10    0    11
7     0     0    1   61    0    0     1  1096     4    0     1
8     0     0    0   36    0    0     4    23  1305    0     2
9    13     0  220  198   31   67     2   100   232  253    21
10    0     0    0    0    7    0     4     0     1    0  1634
early stop counter: 2
val acc:0.9775578379631042, best validation acc: 0.981623649597168, corresponding to test acc:                         0.7144756317138672 / 0.7605820894241333
after epoch: 19,now: 2024-07-21 14:33:41.719281,epoch time: 0:46:16.455274,used: 14:39:10.587393,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9734321, 'precision': 0.95738536, 'recall': 0.93579626, 'specificity': 0.9970217, 'f1': 0.9452279, 'auroc': 0.99958694}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     5    3    0     8     3     1    1      9
1     0  1305    0     8    0    0     0    18     1    0      0
2     1     0  246     0   14    0     1     0     2   47      1
3     0     0    0  8420    0    1     0    15     1    0      0
4     2     0    7     2  460    0     0     2    17    2     47
5     0     0    0     8    1  479     0     0     1   32      0
6     3     0    0     1    0    0  1898     1     1    0      3
7     0    12    0   293    1    0     3  6930    18    3      4
8     0     0    0   233    1    1     0    29  3024    2      5
9     1     0    5     3    2   10     0     0     0  472      0
10    3     0    3     7   20    0     6    19    38    1  12696
---- Validation: 
scalar performance:
{'acc': 0.97383976, 'precision': 0.95652765, 'recall': 0.93772316, 'specificity': 0.99707294, 'f1': 0.9459143, 'auroc': 0.9996039}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     5    4    0     4     1     0    0      5
1     0  1305    0     8    0    0     0    18     0    0      1
2     0     0  251     1   10    0     2     0     1   47      0
3     0     0    0  8415    0    3     0    19     3    0      0
4     3     0    8     1  459    0     0     3    14    3     48
5     0     0    0    13    1  474     0     0     1   32      0
6     3     0    0     6    0    0  1891     1     2    0      5
7     0    19    1   273    0    0     1  6940    23    5      3
8     0     0    0   218    3    2     0    35  3028    2      8
9     0     0    7     5    2    8     0     0     1  470      0
10    5     0    0     7   21    0     5    12    34    2  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6976142, 'precision': 0.6437747, 'recall': 0.5796408, 'specificity': 0.96993303, 'f1': 0.57395387, 'auroc': 0.87357664}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   963     0   0   90    0    0    33    75     3    2     4
1     0  1217   0   40    0    0     3   195     9    2    33
2    31     0  80   49  230   23     5    39   202   45   311
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   1    1  221    0     6     1    11    0  1390
5    20     0   4  138   10  292     2     0     6  114     6
6     5     0   0   45    0    0  2984     1     1    0    31
7     1     1   0  138    0    0     9  1009     1    2     3
8     0     0   0  126    0    2     5    21  1203    2    11
9    27     2  75  222   57  154     4    80   107  366    43
10    0     0   0    1    8    0     1     0     0    0  1636
early stop counter: 3
val acc:0.9738397598266602, best validation acc: 0.981623649597168, corresponding to test acc:                         0.7144756317138672 / 0.7605820894241333
after epoch: 20,now: 2024-07-21 15:20:03.273614,epoch time: 0:46:21.554333,used: 15:25:32.141726,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98113763, 'precision': 0.9597761, 'recall': 0.94862026, 'specificity': 0.9979178, 'f1': 0.9531878, 'auroc': 0.9997339}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     5    3    0     1     1     0    0     11
1     0  1314    0     4    0    0     0    14     0    0      0
2     1     0  251     0   10    1     0     0     0   46      3
3     0     0    0  8390    0    3     0    33    10    2      0
4     2     0    4     0  504    0     0     0     1    0     28
5     0     0    0    13    1  500     0     0     0    7      0
6     5     1    0     2    2    0  1882     2     2    0     12
7     0    15    1   123    1    0     0  7112     4    2      4
8     0     0    0   152   11    2     1    44  3080    2      3
9     0     0    1     2    1   43     0     0     1  445      0
10    0     0    0     6   39    0     0     3    14    0  12731
---- Validation: 
scalar performance:
{'acc': 0.98202485, 'precision': 0.96288437, 'recall': 0.95234615, 'specificity': 0.99801576, 'f1': 0.9562994, 'auroc': 0.99976915}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     2    2    0     2     0     1    0      6
1     0  1317    0     1    0    0     0    11     3    0      0
2     0     0  244     0   11    0     0     0     1   55      1
3     0     0    0  8399    0    2     2    27    10    0      0
4     3     0    3     0  505    0     0     0     3    1     24
5     0     0    0     8    0  508     0     0     0    5      0
6     3     0    0     3    1    0  1881     1     4    0     15
7     0    14    0   121    1    0     0  7119     4    1      5
8     0     0    0   153   14    3     0    44  3074    1      7
9     0     0    1     0    1   31     0     1     0  459      0
10    2     0    0     6   33    0     1     4    12    1  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71531516, 'precision': 0.66415524, 'recall': 0.61056066, 'specificity': 0.9713368, 'f1': 0.6051894, 'auroc': 0.87656987}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   921     0    1  60   12    1    19    83     9   14    50
1     0  1347    0   8    1    0     0   124     9    1     9
2     3     2  171   7  372    9     0    57   124   77   193
3     0     0    0   0    0    0     0     0     0    0     0
4     0     2    2   0  301    0     0     2     6    1  1319
5     1     0    9  75   11  271     0     0    19  201     5
6     1     0    0  18    1    0  2648     4     1    0   394
7     0     0    0  27    0    1     0  1132     1    0     3
8     0     0    0  49    5    0     1    35  1277    2     1
9     2     3   92  59   38  107     0   127   157  522    30
10    0     0    0   0   12    0     0     0     0    0  1634
better model found
persisted
after epoch: 21,now: 2024-07-21 16:06:37.421591,epoch time: 0:46:34.147977,used: 16:12:06.289703,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9831443, 'precision': 0.9578309, 'recall': 0.9510233, 'specificity': 0.99816406, 'f1': 0.9517337, 'auroc': 0.99977225}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     1    3    0     1     0     0    1      4
1     0  1324    0     0    0    0     0     8     0    0      0
2     0     0  305     0    2    1     0     1     1    1      1
3     0     0    0  8371    0    9     2    37    20    0      0
4     2     0    9     0  468    0     0     1     5    0     54
5     0     0    0    10    0  507     0     0     3    1      0
6     2     0    0     1    0    1  1901     1     0    0      2
7     0    12    1   111    1    0     1  7118    13    0      5
8     0     7    1    56    2    0     3    49  3172    0      5
9     0     0   47     1    0   75     0     0     4  365      0
10    5     0    2     4   15    1     2     6    16    0  12742
---- Validation: 
scalar performance:
{'acc': 0.98322856, 'precision': 0.95490205, 'recall': 0.94810593, 'specificity': 0.9981804, 'f1': 0.9491252, 'auroc': 0.9997427}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    1     1    3    0     4     0     0    0      8
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     0  299     0    5    1     0     1     1    4      1
3     1     0    0  8378    0    7     0    34    18    1      1
4     5     1   13     0  462    0     0     1     6    1     50
5     0     0    0     5    0  511     0     0     0    4      1
6     2     0    0     0    0    1  1897     2     2    0      4
7     0     9    1   115    0    0     1  7124    11    1      3
8     0     3    1    49    2    0     2    49  3187    0      3
9     0     1   40     0    0   79     1     2     4  366      0
10   11     0    0     4   13    1     5     7    13    0  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7347653, 'precision': 0.63764304, 'recall': 0.6258116, 'specificity': 0.9731356, 'f1': 0.59918636, 'auroc': 0.87359023}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1031     0    0  13    0    2    32    73     9    6     4
1      0  1339    0   8    0    0     0   135     4    1    12
2     69     9  145   3  180   19    70    60   200   45   215
3      0     0    0   0    0    0     0     0     0    0     0
4      5     5    0   1  176    0    28     0    12    0  1406
5      7     0   11  27    0  404     9     0     7  127     0
6      3     0    0   2    0    0  3055     1     1    0     5
7      1     2    0   6    0    1     1  1151     0    0     2
8      4     1    0  64    2    7    39    55  1194    1     3
9     40    19  181  39    9  187    29   116   123  370    24
10     0     0    0   0    5    0     4     0     0    0  1637
better model found
persisted
after epoch: 22,now: 2024-07-21 16:52:47.071547,epoch time: 0:46:09.649956,used: 16:58:15.939659,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9857395, 'precision': 0.96073174, 'recall': 0.9673853, 'specificity': 0.998495, 'f1': 0.9636515, 'auroc': 0.99983287}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    3    0     1     0     0    0      6
1     0  1298    0     1    0    0     1    32     0    0      0
2     2     0  283     0    8    0     0     0     1   18      0
3     4     0    0  8367    0    1     4    37    26    0      0
4     3     0    6     0  509    0     0     2     4    0     14
5     0     0    0     2    0  493     0     0     1   24      1
6     1     0    0     0    0    0  1901     0     0    0      6
7     2     0    1    88    1    0     5  7142    20    0      5
8     1     0    2    28    0    0     2    13  3247    0      1
9     3     0    7     2    1   14     1     0     0  464      1
10    3     0    0     3   87    0     0     1    31    1  12666
---- Validation: 
scalar performance:
{'acc': 0.98568946, 'precision': 0.9582378, 'recall': 0.9648918, 'specificity': 0.9984894, 'f1': 0.96119106, 'auroc': 0.99981797}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    0     1     0     0    0      5
1     0  1303    0     1    0    0     2    25     1    0      0
2     1     0  281     0    7    0     0     3     1   18      1
3     6     1    0  8365    0    4     8    32    23    0      1
4     3     0   10     0  498    0     1     1     5    1     20
5     2     0    1     2    0  482     0     0     1   33      0
6     3     0    0     2    1    0  1895     1     0    0      6
7     5     0    2    89    0    0     2  7151    14    0      2
8     0     0    0    35    0    0     1     9  3248    0      3
9     2     0    5     1    1    9     3     0     1  471      0
10    1     0    2     1   83    0     2     3    22    2  12680
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72811866, 'precision': 0.65611315, 'recall': 0.5961634, 'specificity': 0.9728001, 'f1': 0.5976991, 'auroc': 0.881828}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1113     0    0   15    3    0    22    6     3    4     4
1      3  1175    0   14    1    0     5  254    12    2    33
2     28     0  124   14  302    6    20   62   269   59   131
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    1    1  636    0     5    3    24    0   962
5     48     0   12   59   23  183    25    0    12  225     5
6      0     0    0    2    0    0  3045    2     1    0    17
7      3     0    2  267    0    0     6  883     0    0     3
8      5     0    0   61    2    1    24   22  1245    5     5
9     56     0  109  126   32   61    26  100   143  459    25
10     0     0    0    1   99    0     2    0     0    0  1544
better model found
persisted
after epoch: 23,now: 2024-07-21 17:38:56.133634,epoch time: 0:46:09.062087,used: 17:44:25.001746,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9840807, 'precision': 0.9589795, 'recall': 0.9594783, 'specificity': 0.99827826, 'f1': 0.9586572, 'auroc': 0.99977183}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    5    0     4     0     0    2      8
1     0  1291    0     3    0    0     0    35     1    1      0
2     0     0  264     0    1    0     0     1     0   46      0
3     0     0    0  8412    0    1     2    14     9    0      1
4     3     0   21     0  487    0     0     0     3    5     20
5     0     0    0     0    0  496     0     0     1   24      0
6     0     0    0     0    0    0  1905     0     0    1      2
7     0     1    1   182    0    0     0  7048    28    0      3
8     0     0    1    48    3    0     0    11  3229    1      3
9     0     0    2     1    0    5     0     0     0  485      0
10    0     0    8     4   53    0     3     4    16    3  12700
---- Validation: 
scalar performance:
{'acc': 0.9835763, 'precision': 0.9600993, 'recall': 0.95744, 'specificity': 0.9982063, 'f1': 0.9582795, 'auroc': 0.99981326}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     0    2    1     5     1     0    4     15
1     0  1293    0     5    0    0     0    33     1    0      0
2     0     0  267     0    1    0     0     0     0   44      0
3     0     0    0  8408    0    4     1    15    12    0      0
4     2     0   18     1  489    0     0     1     2    5     21
5     0     0    1     9    0  491     0     0     0   20      0
6     0     0    0     0    0    0  1902     1     1    0      4
7     0     0    2   192    0    0     0  7034    36    0      1
8     0     0    0    48    4    0     0     3  3233    0      8
9     0     0    4     0    1    6     0     0     0  482      0
10    0     0    7     4   51    0     1     3    12    1  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68530047, 'precision': 0.65041304, 'recall': 0.55384016, 'specificity': 0.9682309, 'f1': 0.54577, 'auroc': 0.8759961}
confusion matrix:
     0    1    2   3    4   5     6     7     8    9     10
0   641    0    6  34    3   3   230    74    15  124    40
1     0  987    0  19    1   0     2   439     8    1    42
2     3    0  242   9  169   1     7    69   213  101   201
3     0    0    0   0    0   0     0     0     0    0     0
4     0    0    2   0  276   0     2     2    12    1  1338
5     0    0   19  70    2  94     9     3    15  379     1
6     0    0    0   5    0   0  3018     2     1    0    41
7     0    0    1  86    0   0     0  1071     1    2     3
8     0    0    1  52    0   0     4    40  1263    7     3
9     2    0  125  68   12  27     2   137   175  571    18
10    0    0    0   0   13   0     1     0     0    0  1632
early stop counter: 1
val acc:0.9835762977600098, best validation acc: 0.9856894612312317, corresponding to test acc:                         0.7281186580657959 / 0.7605820894241333
after epoch: 24,now: 2024-07-21 18:24:56.601123,epoch time: 0:46:00.467489,used: 18:30:25.469235,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98236835, 'precision': 0.96875155, 'recall': 0.9505521, 'specificity': 0.997939, 'f1': 0.95912564, 'auroc': 0.99978244}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     2    6    0     3     1     0    1     29
1     0  1316    0     1    0    0     0     9     0    0      6
2     0     0  291     0   12    0     1     1     0    5      2
3     0     0    0  8312    0    1     0    72    54    0      1
4     1     0    6     0  458    0     2     1     1    0     70
5     0     0    3     5    1  486     0     0     4   22      0
6     0     0    0     1    0    0  1894     3     1    0      7
7     1     9    2    34    0    0     0  7150    28    0     39
8     0     0    3    15    7    0     0    48  3133    0     88
9     0     0   25     1    1    6     1     0     2  457      0
10    0     0    1     4    3    0     2     2     2    0  12780
---- Validation: 
scalar performance:
{'acc': 0.98277384, 'precision': 0.9704478, 'recall': 0.9483852, 'specificity': 0.9979785, 'f1': 0.9588362, 'auroc': 0.99978554}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     3    2    0     7     3     0    2     37
1     0  1317    0     2    0    0     0    11     0    0      2
2     0     0  285     0   13    0     0     1     0    9      4
3     0     0    0  8311    1    0     0    76    48    1      3
4     2     0    9     0  456    0     0     0     1    1     70
5     0     0    1     2    0  489     0     0     2   27      0
6     1     0    0     2    0    0  1897     0     1    0      7
7     0     4    1    41    0    0     0  7172    21    0     26
8     0     0    3    16   10    0     0    46  3133    0     88
9     0     0   13     1    2    5     0     2     5  464      1
10    0     0    1     3    2    0     1     0     1    0  12788
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69502556, 'precision': 0.62670815, 'recall': 0.56480813, 'specificity': 0.9691906, 'f1': 0.54871786, 'auroc': 0.8730606}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   800     0    0  43    7    0    68    54    81   39    78
1     0  1223    0   9    1    0     0   206     7    0    53
2     4     0  174   4  168    4     6   100   114   52   389
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  141    0     4     1     5    0  1482
5     1     0    7  55    1  143     5     8    51  311    10
6     0     0    0   2    0    0  3039     2     0    0    24
7     0     0    0  30    0    0     0  1127     2    0     5
8     0     0    0  24    4    0     5    45  1267    2    23
9     6     1  160  35   15   50     3   186   241  378    62
10    0     0    0   0    4    0     0     0     0    0  1642
early stop counter: 2
val acc:0.9827738404273987, best validation acc: 0.9856894612312317, corresponding to test acc:                         0.7281186580657959 / 0.7605820894241333
after epoch: 25,now: 2024-07-21 19:11:09.707098,epoch time: 0:46:13.105975,used: 19:16:38.575210,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9894585, 'precision': 0.97235465, 'recall': 0.97816414, 'specificity': 0.99890673, 'f1': 0.975067, 'auroc': 0.9999134}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    5    0     4     0     0    0      8
1     0  1324    0     2    0    0     0     5     1    0      0
2     0     0  303     0    3    1     0     0     0    3      1
3     0     1    1  8340    0    2     1    30    63    0      0
4     1     0    4     0  523    0     1     0     3    0      7
5     0     0    0     3    0  502     0     0     3   13      0
6     1     0    0     0    0    0  1902     1     1    0      3
7     0     8    1    39    0    0     2  7157    53    0      4
8     0     0    0     9    2    0     0     4  3277    0      4
9     2     0   13     1    1   15     0     0     1  460      0
10    3     0    1     1   42    0     3     0    13    0  12728
---- Validation: 
scalar performance:
{'acc': 0.98943424, 'precision': 0.97017753, 'recall': 0.9743235, 'specificity': 0.9988921, 'f1': 0.9721309, 'auroc': 0.99991053}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    6    0     2     0     0    0     11
1     0  1330    0     1    0    0     0     1     0    0      0
2     0     0  296     0    7    0     0     0     0    9      0
3     1     1    1  8343    0    0     2    35    54    3      0
4     1     0    4     0  519    0     0     0     1    0     14
5     1     0    0     1    0  501     0     0     2   16      0
6     0     0    0     1    0    0  1905     0     0    0      2
7     0    11    0    47    1    0     0  7163    38    0      5
8     0     0    0     7    1    0     0     1  3276    2      9
9     2     0   10     0    1   24     0     0     0  456      0
10    2     0    1     2   38    0     5     0    10    0  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7249003, 'precision': 0.64650077, 'recall': 0.5992801, 'specificity': 0.97205603, 'f1': 0.59307796, 'auroc': 0.87539035}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   982     0    0  19    3    0   115    23     5    4    19
1     0  1280    0  16    2    0     9   137    12    0    43
2    14     1  151   9  317    7    54    27   185   52   198
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    1   0  331    0    10     0    15    0  1275
5    27     0    6  47    9  216    25     0    11  250     1
6     2     0    0   3    0    0  3025     0     0    0    37
7     0     1    2  91    0    0     3  1057     5    1     4
8     1     0    1  38    4    0    28    21  1267    1     9
9    28     3  119  46   55   96    37    80   215  429    29
10    0     0    0   0   22    0     1     0     0    0  1623
better model found
persisted
after epoch: 26,now: 2024-07-21 19:57:14.917483,epoch time: 0:46:05.210385,used: 20:02:43.785595,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9874251, 'precision': 0.96420735, 'recall': 0.9661784, 'specificity': 0.998611, 'f1': 0.9645904, 'auroc': 0.9998535}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    2    0     0     0     0    0      0
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  299     0   10    0     0     0     0    1      2
3     0     7    0  8350    0    0     0    69    12    1      0
4     3     0    8     0  503    0     0     0     1    0     24
5     0     0    0    13    0  459     0     0     3   45      1
6     6     0    0     1    0    0  1898     1     0    0      2
7     1    23    2    40    2    0     1  7164    10    1     19
8     1     2    3    14    9    0     0    16  3196    0     55
9     2     0   35     0    0    2     0     0     0  454      0
10    3     0    0     4   10    0     1     0     2    0  12771
---- Validation: 
scalar performance:
{'acc': 0.98627794, 'precision': 0.95700216, 'recall': 0.96294034, 'specificity': 0.9985098, 'f1': 0.9589774, 'auroc': 0.9998386}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    3    0     0     1     0    0      1
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  301     0   10    0     0     0     0    1      0
3     0     5    0  8342    1    0     0    74    14    2      2
4     4     0    2     0  507    0     1     0     0    1     24
5     0     0    1     8    1  446     0     0     0   65      0
6     2     0    0     1    0    0  1900     1     0    0      4
7     1    20    6    48    2    0     0  7162    11    2     13
8     2     0    5    14   19    0     1    15  3186    3     51
9     0     0   43     0    0    1     0     0     0  449      0
10    2     0    0     2   13    0     5     0     1    0  12773
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72007275, 'precision': 0.64927214, 'recall': 0.5923163, 'specificity': 0.9718251, 'f1': 0.5881558, 'auroc': 0.87396926}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   952     0    0   45    0    0    54    85     8    9    17
1     1  1396    0   12    3    0     4    47     1    0    35
2    40     0  201   10  288    4    20    32    83   44   293
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    1    1  247    0     6     0     4    0  1373
5    17     0    9  143    2  154     6     1    11  247     2
6     2     0    0    5    0    0  2980     0     2    0    78
7     1     8    2   21    1    0     1  1123     0    0     7
8     1     0    4   74    8    0    14    29  1210    1    29
9    41     9  250  111   33   44     9    89   103  400    48
10    0     0    0    0   17    0     0     0     0    0  1629
early stop counter: 1
val acc:0.9862779378890991, best validation acc: 0.9894342422485352, corresponding to test acc:                         0.7249003052711487 / 0.7605820894241333
after epoch: 27,now: 2024-07-21 20:43:20.017929,epoch time: 0:46:05.100446,used: 20:48:48.886041,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9882545, 'precision': 0.96709013, 'recall': 0.966798, 'specificity': 0.99878323, 'f1': 0.9656872, 'auroc': 0.9999031}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    4    0     1     0     0    0      1
1     0  1322    0     1    0    0     0     9     0    0      0
2     0     0  256     0    2    1     0     2     1   50      0
3     0     0    0  8285    0    0     0   126    26    0      0
4     2     0    9     0  517    0     0     1     3    1      5
5     0     0    0     7    0  477     0     0     1   36      0
6     1     0    0     0    0    0  1906     0     1    0      0
7     0     2    1    17    0    0     2  7232    10    0      0
8     0     0    0    10    2    0     0    13  3270    0      1
9     0     0    1     0    0    1     0     0     0  491      0
10    3     0    1     3   48    0     4     5    23    1  12705
---- Validation: 
scalar performance:
{'acc': 0.9882306, 'precision': 0.96744984, 'recall': 0.9679043, 'specificity': 0.9987771, 'f1': 0.966465, 'auroc': 0.99990845}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    4    0     0     0     0    0      1
1     0  1323    0     0    0    0     0     9     0    0      0
2     0     0  267     0    1    0     0     1     0   43      0
3     3     1    0  8279    0    2     3   119    31    2      0
4     3     0    9     0  523    0     0     0     1    0      3
5     0     0    0    13    0  460     0     0     1   47      0
6     1     0    0     0    0    0  1905     0     1    0      1
7     0     2    0    22    0    0     0  7231     9    0      1
8     0     0    0     7    0    0     0    25  3263    0      1
9     0     0    0     0    0    1     0     1     0  491      0
10    3     0    3     4   40    0     4     0    17    0  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7425313, 'precision': 0.67734325, 'recall': 0.6142761, 'specificity': 0.9741288, 'f1': 0.6057861, 'auroc': 0.8810701}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1052     0    0   13    0    1    34    37    19   11     3
1      0  1250    0   16    5    0     2   193     8    0    25
2     27     2  179   13  157   11    30    95   300   62   139
3      0     0    0    0    0    0     0     0     0    0     0
4      3     1    1    0  459    0    29     2    35    0  1103
5     10     0    4   89    1  185     6     1    23  273     0
6      1     0    0    6    0    0  3049     1     4    0     6
7      1     0    0   10    0    1     1  1150     0    0     1
8      1     0    0   73    0    1     2    36  1257    0     0
9     30     4   80  108   11   53     7   165   212  441    26
10     0     0    0    0   46    0     6     1     2    0  1591
early stop counter: 2
val acc:0.9882305860519409, best validation acc: 0.9894342422485352, corresponding to test acc:                         0.7249003052711487 / 0.7605820894241333
after epoch: 28,now: 2024-07-21 21:29:36.496387,epoch time: 0:46:16.478458,used: 21:35:05.364499,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9891374, 'precision': 0.961562, 'recall': 0.97442216, 'specificity': 0.9988799, 'f1': 0.9674764, 'auroc': 0.99988717}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    4    0     1     0     0    0      4
1     0  1321    0     0    0    0     0    10     0    0      0
2     0     0  303     0    4    1     1     0     0    2      1
3     1     0    0  8340    0    4     1    58    33    1      0
4     3     0    9     0  517    0     0     1     1    0      8
5     0     0    0     0    0  502     0     0     1   18      0
6     4     0    0     0    1    0  1899     0     0    0      4
7     1     2    6    22    0    0     0  7209    18    0      5
8     1     0    1     8   11    1     1    15  3249    0      7
9     0     0   21     0    2   27     0     2     0  441      0
10    1     1    2     2   60    0     1     2    10    0  12715
---- Validation: 
scalar performance:
{'acc': 0.9890865, 'precision': 0.96241206, 'recall': 0.97646856, 'specificity': 0.9988773, 'f1': 0.9688612, 'auroc': 0.9998932}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    1     0    2    0     1     0     0    0      4
1     0  1324    0     1    0    0     0     7     0    0      0
2     0     0  295     1    9    0     1     0     0    6      0
3     2     0    0  8342    0    5     1    56    34    0      0
4     3     0    5     0  525    0     0     0     1    0      5
5     0     0    0     2    0  501     0     0     1   16      1
6    10     0    0     0    0    0  1893     1     1    0      3
7     1     1    1    23    1    0     0  7213    18    0      7
8     1     0    1     5    5    2     3    11  3257    0     11
9     0     0   16     1    1   15     0     1     1  458      0
10    2     0    0     1   91    0     0     1     7    0  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74099207, 'precision': 0.66080093, 'recall': 0.6221368, 'specificity': 0.9739728, 'f1': 0.6165578, 'auroc': 0.88055533}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1038     0    0   24    2    1    65   27     1    3     9
1      1  1332    0   13    7    0     3  126     5    0    12
2     13     1  133   12  484   25    41   63   103   36   104
3      0     0    0    0    0    0     0    0     0    0     0
4      1     1    2    1  587    0    13    0     7    0  1021
5      9     0    0   56   14  370     8    1     8  126     0
6      0     0    0    1    1    0  3054    0     1    0    10
7      2     7    0  173    0    1     0  976     0    0     5
8      4     0    2   51   25    6    17   33  1221    0    11
9     20     2  104   90   84  203     8  154   140  311    21
10     0     0    0    0   73    0     4    0     0    0  1569
early stop counter: 3
val acc:0.9890865087509155, best validation acc: 0.9894342422485352, corresponding to test acc:                         0.7249003052711487 / 0.7605820894241333
after epoch: 29,now: 2024-07-21 22:15:58.389158,epoch time: 0:46:21.892771,used: 22:21:27.257270,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98943174, 'precision': 0.9710232, 'recall': 0.9720572, 'specificity': 0.9988611, 'f1': 0.9712693, 'auroc': 0.99990016}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    6    0     1     0     0    0      3
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  303     0    1    0     0     1     1    5      1
3     0     2    0  8375    1    3     0    44    13    0      0
4     0     0    3     0  504    0     0     0     3    0     29
5     1     0    0     3    0  477     0     0     2   37      0
6     4     1    0     2    0    0  1897     0     1    0      3
7     0    52    1    35    1    0     0  7167     4    1      3
8     0     1    1    33    2    0     0    21  3219    1     17
9     0     0   23     0    2    2     0     1     1  464      0
10    4     0    0     0   11    0     1     1     5    0  12770
---- Validation: 
scalar performance:
{'acc': 0.9887923, 'precision': 0.971232, 'recall': 0.9700003, 'specificity': 0.9987674, 'f1': 0.97043574, 'auroc': 0.99988925}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     1    6    0     1     0     0    0      5
1     0  1331    0     0    0    0     0     0     1    0      0
2     0     0  301     0    5    0     0     0     0    3      3
3     0     0    0  8371    0    3     0    50    16    0      0
4     0     0    2     0  495    0     0     1     3    0     38
5     0     0    1     4    0  485     0     0     0   31      0
6     9     0    0     0    1    0  1892     1     0    0      5
7     0    41    1    37    0    0     0  7180     2    0      4
8     0     2    2    36    1    0     0    29  3206    0     20
9     1     0   22     2    0    4     0     0     0  464      0
10    2     0    0     1   17    0     1     1     3    0  12771
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74267125, 'precision': 0.6575103, 'recall': 0.6281177, 'specificity': 0.97423255, 'f1': 0.6183441, 'auroc': 0.8808718}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1068     1    1  32    1    0     7    39     6    4    11
1      1  1418    0   5    1    0     0    68     1    0     5
2     11    13  198  18  338   18     1    54   191   38   135
3      0     0    0   0    0    0     0     0     0    0     0
4      3     2    4   1  288    0     7     0    21    0  1307
5     14     0   15  69    2  323     0     0    11  153     5
6      3     0    0  14    0    0  2983     1     2    0    64
7      1     1    1  96    0    0     0  1059     2    1     3
8      0     0    0  62    1    6     2    29  1263    2     5
9     21    21  165  87   30  152     2   110   132  386    31
10     0     0    0   0   14    0     2     1     0    0  1629
early stop counter: 4
val acc:0.9887923002243042, best validation acc: 0.9894342422485352, corresponding to test acc:                         0.7249003052711487 / 0.7605820894241333
after epoch: 30,now: 2024-07-21 23:01:45.346089,epoch time: 0:45:46.956931,used: 23:07:14.214201,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 23:07:14.214201 at 2024-07-21 23:01:45.346089
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7249003, 'precision': 0.64650077, 'recall': 0.5992801, 'specificity': 0.97205603, 'f1': 0.59307796, 'auroc': 0.87539035}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   982     0    0  19    3    0   115    23     5    4    19
1     0  1280    0  16    2    0     9   137    12    0    43
2    14     1  151   9  317    7    54    27   185   52   198
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    1   0  331    0    10     0    15    0  1275
5    27     0    6  47    9  216    25     0    11  250     1
6     2     0    0   3    0    0  3025     0     0    0    37
7     0     1    2  91    0    0     3  1057     5    1     4
8     1     0    1  38    4    0    28    21  1267    1     9
9    28     3  119  46   55   96    37    80   215  429    29
10    0     0    0   0   22    0     1     0     0    0  1623
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7605821, 'precision': 0.68122435, 'recall': 0.6320764, 'specificity': 0.97581506, 'f1': 0.6170827, 'auroc': 0.88331306}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   955     0    0  38    1    2    35    80    11   36    12
1     0  1352    0   5    1    0     0   115    17    0     9
2     7     2  128   1  310    8     9    35   263  141   111
3     0     0    0   0    0    0     0     0     0    0     0
4     0     2    3   0  392    0     5     2    18    2  1209
5     5     0    3  21    9  174     4     1    13  362     0
6     0     0    0   2    0    0  3043     2    10    0    10
7     1     0    0  14    0    0     1  1141     2    4     1
8     0     1    0   6    0    4     1    13  1331    8     6
9     6     7   51  14   21   59     0    51   175  735    18
10    0     0    0   0   25    0     0     0     1    0  1620
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_20_23_54_31_seed_0_22562785_instance_wise_predictions.txt
accuracy from prediction file 0.7249003008465682
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/rule_results/0.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_dann_dial_lr1e5_bs16_classbalancing10_nofreeze_2024-07-20_23-29-06/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459016 KiB |   6793 MiB |   2444 TiB |   2444 TiB |
|       from large pool | 415765 KiB |   6757 MiB |   2416 TiB |   2416 TiB |
|       from small pool |  43251 KiB |     62 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 459016 KiB |   6793 MiB |   2444 TiB |   2444 TiB |
|       from large pool | 415765 KiB |   6757 MiB |   2416 TiB |   2416 TiB |
|       from small pool |  43251 KiB |     62 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   6788 MiB |   2442 TiB |   2442 TiB |
|       from large pool | 407075 KiB |   6753 MiB |   2415 TiB |   2415 TiB |
|       from small pool |  41979 KiB |     60 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8318 MiB |   8318 MiB |   8318 MiB |      0 B   |
|       from large pool |   8254 MiB |   8254 MiB |   8254 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 333559 KiB |   1141 MiB |   3124 TiB |   3124 TiB |
|       from large pool | 329707 KiB |   1131 MiB |   3096 TiB |   3096 TiB |
|       from small pool |   3852 KiB |     14 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    6799    |  356899 K  |  356895 K  |
|       from large pool |     187    |     783    |  220937 K  |  220937 K  |
|       from small pool |    4369    |    6537    |  135962 K  |  135958 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    6799    |  356899 K  |  356895 K  |
|       from large pool |     187    |     783    |  220937 K  |  220937 K  |
|       from small pool |    4369    |    6537    |  135962 K  |  135958 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     336    |     336    |     336    |       0    |
|       from large pool |     304    |     304    |     304    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      55    |    1677    |  230575 K  |  230575 K  |
|       from large pool |      34    |     303    |  167015 K  |  167015 K  |
|       from small pool |      21    |    1643    |   63560 K  |   63560 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |   2444 TiB |   2444 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   2416 TiB |   2416 TiB |
|       from small pool |      0 KiB |     62 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |   2444 TiB |   2444 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   2416 TiB |   2416 TiB |
|       from small pool |      0 KiB |     62 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6788 MiB |   2442 TiB |   2442 TiB |
|       from large pool |  16640 KiB |   6753 MiB |   2415 TiB |   2415 TiB |
|       from small pool |      0 KiB |     60 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    774 MiB |   8318 MiB |   8318 MiB |   7544 MiB |
|       from large pool |    728 MiB |   8254 MiB |   8254 MiB |   7526 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1141 MiB |   3124 TiB |   3124 TiB |
|       from large pool |  24320 KiB |   1131 MiB |   3096 TiB |   3096 TiB |
|       from small pool |      0 KiB |     35 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  356899 K  |  356899 K  |
|       from large pool |       2    |     783    |  220937 K  |  220937 K  |
|       from small pool |       0    |    6537    |  135962 K  |  135962 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  356899 K  |  356899 K  |
|       from large pool |       2    |     783    |  220937 K  |  220937 K  |
|       from small pool |       0    |    6537    |  135962 K  |  135962 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     336    |     336    |     279    |
|       from large pool |      34    |     304    |     304    |     270    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1677    |  230576 K  |  230576 K  |
|       from large pool |       3    |     303    |  167015 K  |  167015 K  |
|       from small pool |       0    |    1643    |   63561 K  |   63561 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6793 MiB |   2444 TiB |   2444 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   2416 TiB |   2416 TiB |
|       from small pool |      0 KiB |     62 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6793 MiB |   2444 TiB |   2444 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   2416 TiB |   2416 TiB |
|       from small pool |      0 KiB |     62 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6788 MiB |   2442 TiB |   2442 TiB |
|       from large pool |  16640 KiB |   6753 MiB |   2415 TiB |   2415 TiB |
|       from small pool |      0 KiB |     60 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    774 MiB |   8318 MiB |   8318 MiB |   7544 MiB |
|       from large pool |    728 MiB |   8254 MiB |   8254 MiB |   7526 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1141 MiB |   3124 TiB |   3124 TiB |
|       from large pool |  24320 KiB |   1131 MiB |   3096 TiB |   3096 TiB |
|       from small pool |      0 KiB |     35 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  356899 K  |  356899 K  |
|       from large pool |       2    |     783    |  220937 K  |  220937 K  |
|       from small pool |       0    |    6537    |  135962 K  |  135962 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  356899 K  |  356899 K  |
|       from large pool |       2    |     783    |  220937 K  |  220937 K  |
|       from small pool |       0    |    6537    |  135962 K  |  135962 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     336    |     336    |     279    |
|       from large pool |      34    |     304    |     304    |     270    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1677    |  230576 K  |  230576 K  |
|       from large pool |       3    |     303    |  167015 K  |  167015 K  |
|       from small pool |       0    |    1643    |   63561 K  |   63561 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785

 Experiment start at: 2024-07-21 23:40:06.962840
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90742725, 'precision': 0.8383361, 'recall': 0.7659863, 'specificity': 0.98963606, 'f1': 0.7862872, 'auroc': 0.9942664}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     0    0    0     8    17     0    0     45
1     0  1265    0     7    0    0     0    53     2    0      5
2     4     1  164     1   28    5     1    49    11   25     23
3     7     1    0  6863    0   13     3  1350   199    0      1
4     9     0   18     1  124    3     2    23    49    5    305
5     3     0    4    41    0  375     0     1    13   82      2
6    38     1    0     1    0    0  1820    22     5    2     19
7     0    23    0    36    1    0     0  7167    23    0     13
8     3     5    3    86    4    0     0   285  2864    0     44
9     8     2   90     6    0   79     1    20    14  265      8
10   18     0    0     4    6    0    26    92    50    2  12596
---- Validation: 
scalar performance:
{'acc': 0.90726227, 'precision': 0.83937806, 'recall': 0.7716582, 'specificity': 0.98964953, 'f1': 0.7895135, 'auroc': 0.9941581}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     1    0     2    0    0     7    12     0    1     42
1     0  1264    0     5    0    0     0    56     4    0      3
2     5     0  174     0   28    3     1    38    13   22     28
3    12     1    0  6866    0   14     2  1352   192    1      0
4     5     0   21     0  138    1     2    39    32    8    293
5     3     0    4    32    0  371     0     3    18   89      1
6    56     4    2     1    0    1  1806    21     3    2     12
7     0    24    0    29    1    0     1  7173    30    0      7
8     8     5    3    93    2    2     0   307  2827    1     48
9    11     0   87     8    0   74     0    23     9  275      6
10   22     2    1     4    1    0    25    82    51    2  12606
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7017421, 'precision': 0.61959076, 'recall': 0.58787614, 'specificity': 0.96995944, 'f1': 0.537025, 'auroc': 0.8814722}
confusion matrix:
      0     1   2   3   4    5     6     7     8    9     10
0   1026     2   0   4   0    0    14   118     1    3     2
1      0  1247   0   8   0    0     0   236     3    0     5
2     49     3  11   2  30   13    13   288   254   42   310
3      0     0   0   0   0    0     0     0     0    0     0
4      2     0   0   0  41    0     3     9    26    1  1551
5     34     0   0  71   0  361     5    13    47   59     2
6      0     0   0   0   0    0  3048     7     3    0     9
7      0     0   0   2   0    0     0  1161     0    0     1
8      1     1   0  36   0    1     8    51  1269    1     2
9     55    10  24  19   0  109    10   432   222  224    32
10     0     0   0   0   1    0     1     1     1    0  1642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-22 00:27:02.612228,epoch time: 0:46:55.649388,used: 0:46:55.649388,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9363763, 'precision': 0.8507884, 'recall': 0.83705044, 'specificity': 0.9933032, 'f1': 0.8381455, 'auroc': 0.9962926}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     4    0    2     1     0     2    2     28
1     0  1270    0    16    0    0     1    29    12    0      4
2     7     0  166     1   56    6     1     4    13   54      4
3     7     1    1  7961    0   17     3   127   316    3      1
4    12     0    8     2  339    5     0     1    44    7    121
5     1     0    0    23    0  450     0     0    21   24      2
6    27     0    0     4    0    0  1855     1     5    0     15
7     4    26    2   309    1    0     2  6570   338    1     10
8     1     0    1    78    6    4     1    13  3179    1     10
9     2     0   33     3    1  155     1     1    24  270      3
10   50     0    1     7   97    1    19    12   114    0  12494
---- Validation: 
scalar performance:
{'acc': 0.9372476, 'precision': 0.8468163, 'recall': 0.835946, 'specificity': 0.99341595, 'f1': 0.83550465, 'auroc': 0.99630827}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     2    0    0     8     1     4    1     25
1     0  1276    0    11    0    0     0    26    15    0      4
2     6     1  175     0   56   11     1     4    14   43      1
3     6     1    1  7983    0   14     5   109   316    2      3
4    10     0   14     3  332    2     0     2    49    5    122
5     2     0    2    18    0  456     0     0    23   18      2
6    29     0    0     5    2    0  1851     0     6    2     13
7     3    16    4   291    4    1     1  6602   329    1     13
8     2     0    1    71    7    2     0    23  3177    2     11
9     3     2   42     8    3  159     2     0    23  249      2
10   59     2    1     8   94    1    16     4   115    0  12496
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7300077, 'precision': 0.6564134, 'recall': 0.6143905, 'specificity': 0.9730391, 'f1': 0.5980489, 'auroc': 0.8843359}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1119     3   0   18    0    1     4   16     2    3     4
1      1  1262   0   27    0    0     1  174    19    0    15
2     97     1  38   10  241   13     4   38   350   58   165
3      0     0   0    0    0    0     0    0     0    0     0
4      5     0   1    0  493    0     3    2    33    0  1096
5     25     0   0   64    1  370     3    0    42   86     1
6     15     0   0    1    0    0  2989    3     1    0    58
7      0     0   0  231    0    0     1  918    12    0     2
8      3     0   0   63    0    2     1    0  1299    2     0
9     63     4  42   61   13  147     1   59   344  375    28
10     0     0   0    0   72    0     3    0     0    0  1571
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-22 01:13:05.841091,epoch time: 0:46:03.228863,used: 1:32:58.878251,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93263054, 'precision': 0.8675538, 'recall': 0.8305165, 'specificity': 0.9924873, 'f1': 0.8432761, 'auroc': 0.99622524}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   400     0    2     3    1    0     5     6     3    1     62
1     0  1098    2    27    0    0     0   188    10    0      6
2     0     0  243     0   26    4     0    12     3   20      4
3     1     0    0  8283    0    4     4    78    69    0      0
4     2     0   43     4  337    4     0     5    32    3    109
5     0     0   12    51    0  431     0     0     1   25      1
6    12     0    2     7    3    3  1826     3     7    0     45
7     1     2    5   763    1    0    10  6439    34    0      5
8     0     0    5   180    7    5     1   105  2974    1     17
9     0     0   85    13    1  118     0     3     5  267      1
10    3     0    8    15  126    0     6    19    58    0  12560
---- Validation: 
scalar performance:
{'acc': 0.93245953, 'precision': 0.86798203, 'recall': 0.83218503, 'specificity': 0.99247015, 'f1': 0.8443817, 'auroc': 0.99625015}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   399     0    1     5    1    0     5     3     7    3     59
1     0  1104    1    24    0    0     0   189     9    0      5
2     0     0  242     1   30    3     1    12     3   19      1
3     0     0    1  8293    0    7     3    73    62    0      1
4     3     0   52     5  338    2     0    11    26    1    101
5     1     0    7    38    0  440     0     0     5   29      1
6    11     0    1     8    1    1  1829     0     8    0     49
7     1     2    2   788    1    0     5  6435    25    0      6
8     0     0    6   190    9    4     0    93  2979    0     15
9     0     0   85    10    3  118     0     4     5  267      1
10    5     0    9    17  113    1     5    32    80    0  12534
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60868955, 'precision': 0.6268712, 'recall': 0.50402063, 'specificity': 0.96110004, 'f1': 0.4981295, 'auroc': 0.8745114}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   883    0    4   78    1    0    48    88     8   11    49
1     0  857    0   35    0    0     0   536     8    0    63
2     3    0   89   51  232    8     0   183   196    7   246
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    1    0  252    0     1     6    18    0  1355
5     5    0   10  361    0  164     0     0    11   38     3
6     1    0    0   14    6    0  2410     5    12    0   619
7     2    0    0   94    0    0     3  1063     1    0     1
8     0    0    0  111    1    0     1    44  1208    1     4
9     7    0  184  307   18   43     1   329    68  148    32
10    0    0    0    0   19    0     0     0     1    0  1626
early stop counter: 1
val acc:0.9324595332145691, best validation acc: 0.9372475743293762, corresponding to test acc:                         0.7300077080726624 / 0.7300077080726624
after epoch: 3,now: 2024-07-22 01:59:17.970942,epoch time: 0:46:12.129851,used: 2:19:11.008102,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9456603, 'precision': 0.8552906, 'recall': 0.87411416, 'specificity': 0.9941693, 'f1': 0.8625778, 'auroc': 0.9974527}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    1     0    0    0     6     3     0    4     16
1     0  1268    0     1    0    0     0    55     4    0      3
2     3     0  201     0   30    1     1     3     2   68      2
3    26     0    2  7699    0   65    10   484   136   15      1
4     8     0   29     0  361    1     0     4    12    9    115
5     1     0    0     6    0  469     1     0     4   38      2
6    12     0    1     0    1    3  1875     1     1    0     14
7     5    12   16    57    4    0     1  7110    32    7     21
8    10     1    4    52   21   15     4   155  2945   20     68
9     0     0   18     1    0   95     1     3     1  373      1
10   56     0    5     6  104    0     9     8    11    2  12591
---- Validation: 
scalar performance:
{'acc': 0.94535244, 'precision': 0.8566325, 'recall': 0.87326413, 'specificity': 0.99411523, 'f1': 0.86300886, 'auroc': 0.9973016}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     0    0    2     4     1     0    5     15
1     0  1270    0     3    0    0     0    56     1    0      2
2     1     0  207     0   26    3     1     6     1   63      4
3    24     0    2  7687    2   71     8   492   132   22      0
4     4     0   37     0  356    1     2     3    13    7    116
5     0     0    1     8    0  462     0     0     3   46      1
6    10     0    1     1    1    2  1872     4     0    0     17
7     8     8   12    61    3    0     1  7105    38    9     20
8    11     0    5    53   15   10     0   163  2954   14     71
9     4     0   23     2    2   88     0     2     1  368      3
10   52     0    6     7   85    1    13     8    18    1  12605
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74532986, 'precision': 0.6682488, 'recall': 0.63358176, 'specificity': 0.97425354, 'f1': 0.61022854, 'auroc': 0.8830794}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1107     0    0   2    0    0    26    20     0   13     2
1      2  1269    0   4    0    0     1   204     2    0    17
2     38     5  116   2  133   10     6   123   185   65   332
3      0     0    0   0    0    0     0     0     0    0     0
4      3     0    1   0  219    0     2     2    16    0  1390
5     11     0    0  39    1  343     5     4     6  175     8
6      6     0    0   1    1    0  3034     2     0    0    23
7      2     1    0   2    0    0     1  1157     0    0     1
8      0     0    0  20    1    8    20    52  1263    1     5
9     28    19   90  20   15  106     8   220    83  517    31
10     0     0    0   0   15    0     1     1     1    0  1628
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-22 02:45:27.518415,epoch time: 0:46:09.547473,used: 3:05:20.555575,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9495933, 'precision': 0.88134646, 'recall': 0.8419192, 'specificity': 0.9945024, 'f1': 0.85493606, 'auroc': 0.9976079}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     0    0     5    2    0     5     3     5    1     47
1     0  1294    0     4    0    0     0    25     5    0      4
2     0     0  201     3   66    3     1     0    15   18      5
3     0     3    1  8124    1    9     0   113   179    1      6
4     0     0    9     1  359    1     0     1    24    0    144
5     1     0    1    35    0  451     0     0    16   14      3
6    11     1    2    10    9    1  1811     4    13    0     46
7     5    40    9   203    7    0     0  6744   219    1     36
8     0     0    1    57   11    1     1    26  3157    1     40
9     3     1   59    12    8  140     0     0    34  228      8
10    5     0    1     7   41    1     4     2    23    0  12708
---- Validation: 
scalar performance:
{'acc': 0.9494985, 'precision': 0.87956536, 'recall': 0.84017193, 'specificity': 0.9945032, 'f1': 0.8525267, 'auroc': 0.9976072}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0    14    2    0     3     1     2    0     47
1     0  1283    0     7    0    0     0    30     6    0      6
2     0     0  200     2   66    4     1     0    13   16     10
3     0     5    2  8118    1   13     0   112   186    0      3
4     2     0    8     1  358    1     0     3    18    0    148
5     1     0    0    37    0  448     0     0    20   13      2
6    12     0    1     8    9    1  1829     4     6    0     38
7     3    40    8   205    5    0     1  6762   207    2     32
8     0     0    1    52   23    0     0    27  3158    0     35
9     1     0   63    10    8  150     1     1    29  224      6
10    4     0    1     9   47    1     1     4    26    0  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67200726, 'precision': 0.6345997, 'recall': 0.56902814, 'specificity': 0.9669497, 'f1': 0.5408371, 'auroc': 0.8775928}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1037     0   0   23    0    0     6    36    32    0    36
1      6  1220   0   16    0    0     3   174    11    0    69
2      8     1  31    7  273   10     0    45   253    4   383
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  240    0     1     1     4    0  1387
5      9     0   1  168    0  306     0     0    84   15     9
6      6     0   0    2    4    0  2574     5     7    0   469
7      3     1   0    4    0    0     1  1116    10    0    29
8      0     1   0   29    2    0     0     3  1330    0     5
9     38     7  96  135   17   90     2   103   443  118    88
10     0     0   0    0   11    0     0     1     1    0  1633
better model found
persisted
after epoch: 5,now: 2024-07-22 03:31:19.845145,epoch time: 0:45:52.326730,used: 3:51:12.882305,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9508508, 'precision': 0.89341426, 'recall': 0.8583598, 'specificity': 0.99450994, 'f1': 0.8742546, 'auroc': 0.99771184}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   381     0    0     5    2    0    21     2     3    1     68
1     0  1231    0     5    0    0     0    85     5    0      6
2     1     0  202     1   51    0     1     1     4   46      5
3     0     1    2  7939    1   11     2   250   228    2      3
4     1     0   13     0  366    1     1     1     8    2    146
5     0     0    5    21    2  420     0     0     6   65      1
6     2     0    0     2    2    0  1884     3     3    0     12
7     1     3   13    88    7    0     3  6981   125    2     40
8     0     0    6    32   22    2     3    38  3025    2    165
9     0     0   44     4    6   44     0     1     2  391      1
10    0     0    4     7   28    1    16     9     6    2  12719
---- Validation: 
scalar performance:
{'acc': 0.9516651, 'precision': 0.89839983, 'recall': 0.86152995, 'specificity': 0.99458826, 'f1': 0.8782538, 'auroc': 0.9978095}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     0    0     0    1    0    24     6     2    1     72
1     0  1226    1     4    0    0     0    87     7    0      7
2     1     0  217     0   49    0     0     1     3   40      1
3     0     2    3  7966    0   12     1   248   202    2      4
4     1     0   10     1  369    0     4     1     8    1    144
5     0     0    1    22    1  415     0     0     8   73      1
6     6     1    0     2    1    1  1877     4     2    1     13
7     1     4    9    77    2    0     1  6994   130    3     44
8     0     0    7    32   22    2     4    32  3025    2    170
9     1     0   29     6   11   50     2     0     0  393      1
10    0     0    2     7   33    0    18     4    12    1  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7029315, 'precision': 0.6409833, 'recall': 0.5886746, 'specificity': 0.9699328, 'f1': 0.5765631, 'auroc': 0.87927026}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   923    0    3  15    2    0   111    43    13   18    42
1     0  878    0  17    0    0     5   513     7    0    79
2     2    0  186   4  248    4    16    29   172   69   285
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    1   0  129    0     3     2     5    0  1493
5     6    0    3  87    1  271     5     1    19  196     3
6     0    0    0   1    0    0  3060     1     0    0     5
7     0    0    0   4    0    0     1  1156     2    0     1
8     0    0    0  20    5    0     7    22  1296    1    19
9    13    1  218  53   16   42     6    85   152  511    40
10    0    0    0   0    7    0     2     0     0    0  1637
better model found
persisted
after epoch: 6,now: 2024-07-22 04:17:05.082110,epoch time: 0:45:45.236965,used: 4:36:58.119270,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9535531, 'precision': 0.89221287, 'recall': 0.85359025, 'specificity': 0.99496794, 'f1': 0.8565087, 'auroc': 0.99792093}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     1    0     0    3    0     6     3     0   20     26
1     0  1272    0     6    1    0     0    44     3    0      6
2     0     0  238     0   38    0     0     2     2   31      1
3     0     1    3  7970    0    1     1   335   119    8      1
4     2     0   16     0  386    0     0     3     5    6    121
5     0     0    4    32    1  194     0     1     7  281      1
6     4     0    0     0    3    0  1878     1     3    4     14
7     0     7    2    83    2    0     2  7124    24    0     17
8     1     0    6    64   15    1     1   119  3028    7     54
9     0     0   48     2    1    2     0     3     1  436      0
10   11     0    4     5   54    0     6    12     8    3  12690
---- Validation: 
scalar performance:
{'acc': 0.9526548, 'precision': 0.88745624, 'recall': 0.84582806, 'specificity': 0.9948553, 'f1': 0.8510889, 'auroc': 0.9979682}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0     0    4    0     2     2     0   19     32
1     0  1274    0     7    0    0     2    43     3    0      3
2     0     0  226     0   39    0     0     6     2   38      1
3     0     1    1  8007    1    2     1   311   108    6      2
4     2     0   18     0  380    0     0     3     9    3    124
5     0     0    3    33    1  200     0     0     4  279      1
6     6     0    0     0    2    0  1871     4     4    7     14
7     0     7    4    85    1    0     1  7122    25    4     16
8     1     1    2    70   16    1     2   124  2995   10     74
9     0     0   64     2    3    1     0     3     3  417      0
10    9     0    1     6   52    0     3    12    11    3  12699
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6746659, 'precision': 0.5986426, 'recall': 0.53952837, 'specificity': 0.9670593, 'f1': 0.5103661, 'auroc': 0.86902803}
confusion matrix:
     0     1    2   3    4   5     6     7     8    9     10
0   897     0    6   8    8   0    79    44     0  116    12
1     1  1109    0   8    1   0     9   323     1    0    47
2     3     0  103   4  388   0    12    72    81   69   283
3     0     0    0   0    0   0     0     0     0    0     0
4     1     0    1   0   58   0     4     2     4    1  1562
5     4     0   13  69   11  25     4     4    18  443     1
6     0     0    0   1    0   0  2996     0     0    0    70
7     0     0    0   1    0   0     2  1158     0    1     2
8     0     0    0  34   11   0    30    82  1175    7    31
9     7     9  251  20   31   2     7   194   101  480    35
10    0     0    0   0    1   0     3     0     0    0  1642
better model found
persisted
after epoch: 7,now: 2024-07-22 05:02:50.775540,epoch time: 0:45:45.693430,used: 5:22:43.812700,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9618204, 'precision': 0.9234542, 'recall': 0.8605406, 'specificity': 0.9957055, 'f1': 0.8834294, 'auroc': 0.99862576}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   361     0    0     7    2    0    16     2     2    4     89
1     0  1293    0     4    0    0     0    28     6    0      1
2     0     0  198     1   20    0     0     1     5   84      3
3     0     0    0  8285    0   10     0    80    56    4      1
4     1     0   21     0  329    1     0     2    26    7    152
5     0     0    0    16    0  376     0     0     5  123      1
6     1     0    1     0    0    0  1884     2     4    2     14
7     0    20    4   230    1    0     1  6959    42    0      8
8     0     0    0   138    6    0     0    52  3067    5     27
9     0     0    7     7    0   18     0     1     3  457      0
10    0     0    2     8   11    0     1     6    24    0  12740
---- Validation: 
scalar performance:
{'acc': 0.9612411, 'precision': 0.92377347, 'recall': 0.8597461, 'specificity': 0.99561155, 'f1': 0.8833656, 'auroc': 0.9985742}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    0     6    0    0    12     1     3    4     86
1     0  1296    0     6    0    0     0    23     5    1      1
2     0     0  200     2   15    0     0     3     6   79      7
3     0     3    0  8293    0   12     0    74    57    1      0
4     1     0   23     1  305    1     0     2    29   12    165
5     0     0    0    18    0  392     0     0     3  107      1
6     3     0    0     2    2    1  1871     1     5    0     23
7     0    19    3   239    1    0     2  6944    43    1     13
8     0     1    1   132    2    0     0    52  3077    1     30
9     1     0    5     5    0   26     0     4     3  448      1
10    0     0    2     8   11    0     4     7    23    2  12739
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69866365, 'precision': 0.63910806, 'recall': 0.57121927, 'specificity': 0.96954393, 'f1': 0.54430985, 'auroc': 0.8772174}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   786     6   2  44   0    0    94    56    21   59   102
1     0  1301   1  19   1    0     2   139     5    0    31
2     1     0  64   6  98    3     2    47   333  116   345
3     0     0   0   0   0    0     0     0     0    0     0
4     0     0   0   0  29    0     1     2    17    0  1584
5     1     0   0  53   0  139     1     0    16  367    15
6     0     0   0   1   0    0  2993     1     1    0    71
7     0     0   0  26   0    0     1  1130     1    1     5
8     0     0   0  70   0    0     6    27  1256    4     7
9     3     3  38  57   1   21     2    94   227  642    49
10    0     0   0   0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 8,now: 2024-07-22 05:48:54.341955,epoch time: 0:46:03.566415,used: 6:08:47.379115,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9672517, 'precision': 0.91820294, 'recall': 0.8912852, 'specificity': 0.99640226, 'f1': 0.9022713, 'auroc': 0.9988305}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     1    0     0    1    1     6     0     1    5     13
1     0  1311    0     1    0    0     0    18     2    0      0
2     0     0  204     0   38    1     0     4     3   59      3
3     4     5    0  8251    0   14     7    78    79    0      1
4     5     0    9     0  350    2     1     3    14    1    154
5     0     0    0     8    2  467     0     0     4   40      0
6     6     0    0     0    2    0  1880     1     2    0     17
7     0    25    1   169    1    1     4  7000    52    0     11
8     0     0    1    72    7    4     0    56  3136    2     17
9     0     0   14     1    3   71     1     2     1  397      2
10    8     0    4     8   24    0     3     7    35    1  12701
---- Validation: 
scalar performance:
{'acc': 0.96586865, 'precision': 0.9164801, 'recall': 0.8894001, 'specificity': 0.9962608, 'f1': 0.90053076, 'auroc': 0.99876416}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     1    1    0    10     0     0    2     19
1     0  1305    0     3    0    0     0    20     3    0      1
2     1     0  210     0   40    1     0     4     3   52      1
3     2     5    0  8233    0   13     3    82    98    2      2
4     6     0    9     0  348    1     0     3    18    6    148
5     0     0    0     9    1  464     0     0     2   44      1
6     3     1    0     0    0    0  1888     2     2    0     12
7     1    35    3   185    1    0     2  6980    48    0     10
8     0     2    1    65   11    2     0    56  3134    3     22
9     1     0   12     1    2   82     0     3     1  391      0
10    8     1    1     7   23    0     7     7    34    2  12706
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7085986, 'precision': 0.6113667, 'recall': 0.5799813, 'specificity': 0.97052324, 'f1': 0.5509654, 'auroc': 0.8772767}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   954     5   0  13    1    1    63    65    17   23    28
1     1  1333   0   7    0    0     0   145     6    0     7
2    18     7  64   4  217    5     8    55   296   61   280
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0   61    0     3     1    25    0  1543
5    12     0   0  85    2  158    12     0    31  272    20
6     3     0   0   1    0    0  3022     1     1    0    39
7     0     3   0  27    0    0     3  1125     4    0     2
8     0     0   0  23    0    0     5    20  1316    1     5
9    29    16  80  49   22   37     8   168   216  451    61
10    0     0   0   0    1    0     1     0     0    0  1644
better model found
persisted
after epoch: 9,now: 2024-07-22 06:34:56.533700,epoch time: 0:46:02.191745,used: 6:54:49.570860,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96468323, 'precision': 0.9374374, 'recall': 0.8711157, 'specificity': 0.996054, 'f1': 0.89317095, 'auroc': 0.9988742}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     3    0    0     0     2     1    0      8
1     0  1254    0     8    0    0     0    67     1    0      2
2     2     0  226     0    4    0     2    30    11   33      4
3     0     1    0  8199    0    3     0   114   119    0      1
4     5     0   23     0  225    0     0     8    67    3    208
5     0     0    0    17    0  434     0     0    17   52      1
6     9     1    0     0    0    2  1879     2     7    0      8
7     1     4    0   131    0    0     1  7093    28    0      4
8     0     0    0    32    0    0     0    81  3175    0      8
9     2     0   13     9    0   42     1    14    13  397      2
10   13     0    0     6    1    0     1    17    50    0  12705
---- Validation: 
scalar performance:
{'acc': 0.9644777, 'precision': 0.9319694, 'recall': 0.8699881, 'specificity': 0.99604106, 'f1': 0.88975596, 'auroc': 0.99883664}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     3    0    0     3     2     2    0     10
1     0  1262    0    10    0    0     0    56     3    0      1
2     1     0  223     2    5    0     1    26    13   35      6
3     0     1    0  8198    0    5     0   117   119    0      0
4     4     0   33     1  215    1     0     9    60    5    211
5     3     0    1    16    0  432     0     0    16   52      1
6     8     0    1     2    0    0  1884     2     6    0      5
7     0     2    0   135    1    0     2  7097    24    0      4
8     0     0    0    31    0    1     0    72  3184    0      8
9     1     0   11     6    0   40     1    12    13  408      1
10   19     0    0     7    3    0     1    18    57    0  12691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.690128, 'precision': 0.6072141, 'recall': 0.5631019, 'specificity': 0.968756, 'f1': 0.527303, 'auroc': 0.86961114}
confusion matrix:
      0     1   2   3   4    5     6     7     8    9     10
0   1036     0   0  11   0    0    10    78    27    2     6
1      2  1170   0  25   0    0     4   259    16    0    23
2     65     0  75   9  38    1     7    97   250   39   434
3      0     0   0   0   0    0     0     0     0    0     0
4      3     0   0   0  10    0     3     2    13    0  1602
5     57     0   7  67   3  147    17     0    40  249     5
6      1     0   0   1   0    0  3022     1     1    0    41
7      2     0   0  39   0    0     2  1119     0    0     2
8      2     0   0  44   0    0    12    39  1263    2     8
9    127     2  64  72   6   16    20   184   198  378    70
10     0     0   0   0   0    0     2     0     0    0  1644
early stop counter: 1
val acc:0.9644777178764343, best validation acc: 0.9658686518669128, corresponding to test acc:                         0.7085986137390137 / 0.7453298568725586
after epoch: 10,now: 2024-07-22 07:20:56.385786,epoch time: 0:45:59.852086,used: 7:40:49.422946,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96262306, 'precision': 0.9115856, 'recall': 0.88449574, 'specificity': 0.99598944, 'f1': 0.89167786, 'auroc': 0.9987361}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     3    1    0     7     4     1    1     14
1     0  1282    0     6    0    0     0    41     2    0      0
2     0     0  238     0    0    1     0     4     8   59      2
3     0     3    0  8058    0   11     1   196   166    3      0
4     3     1   73     1  269    0     0     0    54   10    128
5     0     0    1     9    0  454     0     0     8   48      1
6     9     0    0     5    0    0  1871     0     6    0     17
7     0    11    0    85    1    0     2  7062    96    1      4
8     0     0    1    40    0    0     0    25  3222    0      8
9     2     0   12     2    0   57     0     2    13  405      0
10   16     0    2     7   17    2     4    17    62    0  12666
---- Validation: 
scalar performance:
{'acc': 0.9621239, 'precision': 0.90697503, 'recall': 0.88122016, 'specificity': 0.9959457, 'f1': 0.887206, 'auroc': 0.99868137}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     1    0     0    1    0     6     4     1    1     18
1     0  1284    0     5    0    0     0    38     4    0      1
2     1     0  228     0    1    1     0     3    14   63      1
3     1     2    0  8091    0    8     0   176   161    1      0
4     3     0   83     0  259    2     0     9    48    9    126
5     0     0    0    10    0  460     0     0     5   45      1
6    12     1    1     4    0    0  1862     3     4    1     20
7     1    12    0    88    1    0     1  7052   107    0      3
8     0     2    2    33    0    0     1    26  3224    0      8
9     2     0   13     5    0   55     0     0     9  409      0
10   15     0    7     6   17    1     5    22    74    0  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7051004, 'precision': 0.6450941, 'recall': 0.5927135, 'specificity': 0.97035885, 'f1': 0.56046957, 'auroc': 0.87634885}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   993     0    0   27   0    0    29    77    39    2     3
1     1  1223    0   19   0    0     0   234     2    0    20
2    41     2  115    6  19   14     1    58   491   63   205
3     0     0    0    0   0    0     0     0     0    0     0
4     4     0    1    0  14    0     1     2    49    0  1562
5    17     0    2  100   0  310     0     2    38  122     1
6     5     0    0    8   0    0  2992     5     4    0    53
7     0     0    0   42   0    0     9  1107     3    0     3
8     0     0    0   43   0    3     5    30  1288    0     1
9    40     4   50   61   1  100     6   114   343  390    28
10    0     0    0    0   0    0     0     0     0    0  1646
early stop counter: 2
val acc:0.9621238708496094, best validation acc: 0.9658686518669128, corresponding to test acc:                         0.7085986137390137 / 0.7453298568725586
after epoch: 11,now: 2024-07-22 08:06:40.127001,epoch time: 0:45:43.741215,used: 8:26:33.164161,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9736997, 'precision': 0.941244, 'recall': 0.9093333, 'specificity': 0.9970454, 'f1': 0.9212034, 'auroc': 0.99932116}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    0    0     0     2     0    0     14
1     0  1315    0     2    0    0     0    11     2    0      1
2     1     0  244     0    8    1     0     0     2   50      6
3     0     9    0  8330    0    3     3    51    40    2      0
4     1     0   24     0  343    0     0     0     8    4    159
5     0     0    0    19    0  420     0     0     3   78      1
6     3     0    0     1    0    0  1895     0     3    0      5
7     1    36    0   133    1    0     4  7021    56    0     12
8     1     0    0    73    4    0     0    27  3151    5     35
9     0     0   17     2    0   15     0     1     1  455      2
10    5     0    1     5    9    0     2     6    11    1  12752
---- Validation: 
scalar performance:
{'acc': 0.97421426, 'precision': 0.93682057, 'recall': 0.90477246, 'specificity': 0.99712527, 'f1': 0.9166771, 'auroc': 0.9992962}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    0    0     1     0     0    1     12
1     0  1318    0     1    0    0     0    10     2    0      1
2     1     0  237     0   10    0     1     3     4   48      8
3     0     3    0  8342    0    3     2    49    40    1      0
4     4     0   27     0  336    0     2     2    16    1    151
5     0     0    0    14    1  413     0     0     4   88      1
6     3     0    0     0    3    0  1892     0     1    0      9
7     0    36    0   134    1    0     5  7042    40    0      7
8     1     0    0    63    4    0     0    27  3169    3     29
9     0     0   19     3    0   17     1     1     4  448      0
10    8     0    1     7    9    0     5     4     6    1  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7288183, 'precision': 0.6625346, 'recall': 0.6012212, 'specificity': 0.97265965, 'f1': 0.5790351, 'auroc': 0.8792118}
confusion matrix:
      0     1    2   3   4    5     6     7     8    9     10
0   1040     0    0  26   0    0    46    24    12   15     7
1      2  1324    0   8   0    0     1   147     5    0    12
2     20     0  148   7  86    5     4    74   278   87   306
3      0     0    0   0   0    0     0     0     0    0     0
4      2     0    1   0  94    0     9     2    26    0  1499
5      5     0    7  67   0  149     2     1    10  349     2
6      1     0    0   2   0    0  3059     1     0    0     4
7      0     0    1  49   0    0     4  1107     0    1     2
8      0     0    0  48   1    0     5    30  1280    3     3
9     11     5   97  53   3   31     8   119   196  578    36
10     0     0    0   0   5    0     3     0     0    0  1638
better model found
persisted
after epoch: 12,now: 2024-07-22 08:52:29.299267,epoch time: 0:45:49.172266,used: 9:12:22.336427,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97439533, 'precision': 0.92975354, 'recall': 0.9161385, 'specificity': 0.99728453, 'f1': 0.9161944, 'auroc': 0.9994354}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     1    2    0     2     0     1    0      8
1     0  1310    0     3    0    0     0    17     2    0      0
2     2     2  238     1   30    0     0     4     0   34      1
3     0     1    1  8273    0    1     0   116    45    1      0
4     5     0    5     0  480    0     0     1     3    3     42
5     1     0    1    22    0  324     0     0     2  170      1
6     2     3    0     4    0    0  1889     0     1    0      9
7     1    18    0    54    2    0     1  7166    12    0      8
8     1     2    2    52   18    0     3    59  3117    6     36
9     5     0   12     1    1    2     1     1     0  470      0
10    8     1    0     7   77    1     6     4     4    1  12683
---- Validation: 
scalar performance:
{'acc': 0.9730373, 'precision': 0.93017244, 'recall': 0.9095925, 'specificity': 0.99713475, 'f1': 0.91165924, 'auroc': 0.99939054}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     4    1    0     0     0     1    0     11
1     0  1309    0     3    0    0     0    19     1    0      0
2     1     1  224     0   38    1     0     4     0   41      2
3     1     0    0  8261    0    1     1   123    52    1      0
4     4     0    3     1  477    0     1     2     3    1     47
5     2     0    0    24    1  313     0     0     5  175      1
6     2     2    0     1    1    0  1892     1     3    0      6
7     0    13    0    70    1    0     1  7159    14    1      6
8     1     1    0    74   21    0     3    47  3117    3     29
9     4     0    9     2    0    2     1     1     0  474      0
10   10     1    0     5   77    1     8     4     5    0  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75050724, 'precision': 0.6825825, 'recall': 0.61745775, 'specificity': 0.9747751, 'f1': 0.61097234, 'auroc': 0.88677824}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1040     6   0  26    0    0    38    46     8    1     5
1      2  1394   0  11    0    0     3    85     0    0     4
2     78     9  99  19  330    6    82    71    48   78   195
3      0     0   0   0    0    0     0     0     0    0     0
4      5     0   0   0  478    0    10     2     4    0  1134
5     32     0   4  81    0  151    14     0     2  307     1
6      0     0   0   2    0    0  3055     1     0    0     9
7      1     6   1  92    0    0     4  1059     0    0     1
8      1     1   0  66   10    0    39    45  1192    6    10
9     74    21  64  60   13   32    36   107    43  660    27
10     0     0   0   0   43    0     3     1     0    0  1599
new oracle model saved
early stop counter: 1
val acc:0.9730373024940491, best validation acc: 0.9742142558097839, corresponding to test acc:                         0.7288182973861694 / 0.7505072355270386
after epoch: 13,now: 2024-07-22 09:38:55.175609,epoch time: 0:46:25.876342,used: 9:58:48.212769,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96543235, 'precision': 0.92540026, 'recall': 0.91065025, 'specificity': 0.9961078, 'f1': 0.9141316, 'auroc': 0.9992072}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    1    0     0     1     0    2     19
1     1  1294    0     1    0    0     0    21     5    0     10
2     0     0  243     0    9    0     0     0     0   56      4
3     4     0    0  8116    2   16     2   108   168   14      6
4     6     0   17     0  401    0     0     0     0    2    113
5     0     0    1     5    0  396     0     0     1  117      1
6    10     0    0     0    2    0  1863     0     3    2     27
7     4     2    5    72    5    0     3  6971    99    6     94
8     1     0    2    10   21    1     0    10  3100   12    139
9     1     0    6     1    0    5     0     0     0  480      0
10    4     0    1     5   21    0     2     0     2    1  12760
---- Validation: 
scalar performance:
{'acc': 0.9650127, 'precision': 0.920786, 'recall': 0.9100904, 'specificity': 0.9960822, 'f1': 0.91248804, 'auroc': 0.99920845}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    1    0     1     0     0    2     15
1     0  1286    0     2    0    0     1    29     6    0      8
2     0     0  243     0   10    0     0     0     0   53      6
3     2     0    1  8134    2   21     2   105   157   12      4
4     5     0   12     0  404    0     0     0     0    0    118
5     0     0    0     4    1  399     0     0     2  115      0
6     7     0    0     0    3    0  1869     0     0    0     29
7     4     1    8    72   10    0     0  6951   123    8     88
8     2     0    5    13   29    3     0     4  3099   11    130
9     0     0    8     1    0   12     0     0     1  471      0
10    3     0    2     6   22    0     1     2     2    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74092215, 'precision': 0.687928, 'recall': 0.6148082, 'specificity': 0.973816, 'f1': 0.6018865, 'auroc': 0.87955064}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   980     0    0   8    0    0    12    44     4   69    53
1     5  1232    1  18    0    0     1   169     1    3    69
2    17     0  140   4  176    8     5    25    96  142   402
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  263    0     2     1     3    0  1364
5     2     0    2  51    1  136     3     1     4  388     4
6     3     0    1   1    0    0  3017     1     0    0    44
7     2     0    0   3    1    0     0  1147     2    3     6
8     2     0    0  40    7    8    16    16  1238   10    33
9     9     1   77  29    6   26     3    54    75  814    43
10    0     0    0   0   23    0     0     0     0    0  1623
early stop counter: 2
val acc:0.9650127291679382, best validation acc: 0.9742142558097839, corresponding to test acc:                         0.7288182973861694 / 0.7505072355270386
after epoch: 14,now: 2024-07-22 10:24:59.742506,epoch time: 0:46:04.566897,used: 10:44:52.779666,model: blood_mon_eos_bas_te_acevedo_erm_b888c1ef2_not_commited_2024md_07md_21_23_40_06_seed_1_22562785
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 22562785 ON supergpu03 CANCELLED AT 2024-07-22T10:25:22 ***
