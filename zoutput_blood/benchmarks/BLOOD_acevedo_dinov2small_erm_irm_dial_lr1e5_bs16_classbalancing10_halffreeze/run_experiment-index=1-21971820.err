Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 14 11:33:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820

 Experiment start at: 2024-07-14 12:01:04.957514
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9364298, 'precision': 0.8637973, 'recall': 0.7730492, 'specificity': 0.9926293, 'f1': 0.8053945, 'auroc': 0.9949931}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     1    0    10    0    0     1     5     2    2     84
1     0  1261    0    16    0    0     0    43     2    0     10
2     6     0  110     1   89    1     1    14     4   61     25
3     0     1    0  8193    0    4     0   178    60    1      3
4     4     0    2     2  221    1     2     4    15    6    282
5     4     0    0    84    0  293     0     0     6  133      1
6    34     1    0    16    1    1  1797     7     4    2     45
7     2    14    0   262    1    0     2  6874    51    3     52
8     2     3    1   271   10    0     0    91  2768    1    148
9     6     0   34    16    9   35     0     2     5  372     14
10   11     0    0     6   10    0     3    13    13    3  12733
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9384245, 'precision': 0.86144674, 'recall': 0.7778672, 'specificity': 0.9928974, 'f1': 0.80752057, 'auroc': 0.9950695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   388     0    0    12    1    0     4     1     2    1     74
1     0  1269    0    12    0    0     0    38     4    0      9
2     7     0  110     2   91    1     1     7     5   64     24
3     0     0    0  8187    0    2     0   183    64    1      3
4     9     0    5     2  218    2     0     3    18    8    274
5     5     0    1    77    0  303     0     0     7  124      4
6    36     0    0    18    0    1  1794     5     7    2     45
7     2    15    1   240    2    0     2  6904    49    2     48
8     3     1    0   252    8    0     1    86  2808    3    134
9     7     0   31    14    6   42     0     2     7  372     12
10   13     0    0     9   12    0     3    14    13    2  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.605821, 'precision': 0.5801506, 'recall': 0.50176436, 'specificity': 0.9604018, 'f1': 0.47865194, 'auroc': 0.86750674}
confusion matrix:
     0     1   2    3   4   5     6     7     8    9     10
0   972     0   0  128   0   0     6    15     7    1    41
1     0  1052   0   28   0   0     0   306     9    0   104
2    19     0   9   15  86   0     2    65   105   41   673
3     0     0   0    0   0   0     0     0     0    0     0
4     0     0   0    0  10   0     0     1     5    0  1617
5    23     0   0  173   0  74     0     0    30  269    23
6     0     1   0    6   0   0  2278     6    36    0   740
7     0     0   0   98   0   0     0  1061     0    0     5
8     0     0   0  128   2   0     1    22  1182    1    34
9    61     2  32  122  30   9     1   139   163  375   203
10    0     0   0    0   0   0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-14 12:35:43.219841,epoch time: 0:34:38.262327,used: 0:34:38.262327,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9501552, 'precision': 0.8668271, 'recall': 0.8334987, 'specificity': 0.99443436, 'f1': 0.84734684, 'auroc': 0.99650264}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     1    1    0     2     1     0    3     41
1     0  1279    0     8    0    0     1    38     4    1      1
2     3     0  199     0   76    0     1     8     2   17      6
3    18     0    2  8003    2    8     1   208   191    4      2
4     3     0   12     1  303    0     4     2     5    2    207
5     7     0    9    35    5  349     2     0    11  102      1
6    19     0    2     1    0    0  1863     1     2    0     19
7     6    14    3   115    3    0     4  7042    52    1     23
8     3     0    1    47   13    0     2    76  2994    0    158
9     6     0  113     5    6   29     0     7     5  316      6
10   13     1    2     6   15    0     6    11     7    1  12731
---- Validation: 
scalar performance:
{'acc': 0.94933796, 'precision': 0.8619977, 'recall': 0.8311431, 'specificity': 0.99437165, 'f1': 0.84404695, 'auroc': 0.9965722}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     1    0    0     5     1     0    3     43
1     0  1279    0     7    0    0     1    38     4    1      2
2     5     0  196     0   76    0     1     5     4   18      7
3     7     1    1  7993    1   11     3   197   220    3      3
4     4     0    6     0  305    0     1     4     4    3    212
5     6     0    7    25    7  345     0     0     9  121      1
6    16     0    0     0    2    0  1868     1     1    0     20
7    11    12    3   111    3    0     1  7044    61    2     17
8     9     0    6    48   16    0     1    76  2988    1    151
9     7     0  115     6   12   25     2     3     2  315      6
10   13     0    0     6   18    0    10    16     4    1  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6776744, 'precision': 0.5944697, 'recall': 0.56220937, 'specificity': 0.96742916, 'f1': 0.5384804, 'auroc': 0.87589025}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1133     0    0  11    1    0     3    12     1    1     8
1      0  1192    0  15    0    0     0   259     7    0    26
2     52     0  112   1  318    2     4    53    60   10   403
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    0   0  107    0     2     1     0    0  1521
5     53     0   40  27   10  164     4     4    40  246     4
6      5     0    0   0    0    0  2728     2     3    0   329
7      0     0    0  35    0    0     0  1125     2    0     2
8      0     0    0  18   19    1     4    36  1263    1    28
9     97     2  412  12   52   15     2   135   133  216    61
10     0     0    0   0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-14 13:09:01.107566,epoch time: 0:33:17.887725,used: 1:07:56.150052,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95620185, 'precision': 0.89965063, 'recall': 0.83802855, 'specificity': 0.99523735, 'f1': 0.8509428, 'auroc': 0.9978716}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     6    0    0     4     2     0    3     48
1     0  1269    0    19    0    0     0    36     4    0      4
2     1     0  187     1   38    0     2     4     7   68      4
3     0     1    0  8242    1    2     0    60   125    4      2
4     2     0   14     0  361    0     1     5    17    6    133
5     0     0    0    55    1  193     1     0     9  261      1
6    13     0    1     9    1    0  1867     0     3    0     14
7     0     5    0   249    2    0     1  6913    75    3     14
8     1     0    1    57   11    0     1    48  3151    3     21
9     2     0   26     8    1    5     0     2     3  444      2
10    3     0    1     7   39    0     6     9    35    3  12692
---- Validation: 
scalar performance:
{'acc': 0.9547412, 'precision': 0.8987707, 'recall': 0.8388923, 'specificity': 0.99509096, 'f1': 0.85075444, 'auroc': 0.99775904}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    0     3    0    0     6     0     1    6     44
1     0  1274    0    17    0    0     0    32     6    1      2
2     0     0  190     0   40    0     1     5     6   62      8
3     0     0    0  8228    1    2     0    66   138    5      0
4     2     0   17     0  347    0     1     2    24   12    134
5     0     0    0    47    1  201     1     0     8  262      1
6     9     0    1     8    1    0  1863     2     6    2     16
7     1     8    0   258    2    0     1  6897    80    2     16
8     0     0    0    63   15    0     1    45  3140    6     26
9     1     1   21    10    2    1     2     3     2  450      0
10    4     0    2     8   47    0    12    10    29    4  12680
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6680193, 'precision': 0.6529571, 'recall': 0.54438096, 'specificity': 0.96672964, 'f1': 0.53533185, 'auroc': 0.8823005}
confusion matrix:
     0     1    2    3    4   5     6    7     8    9     10
0   892     0    0   91    1   0    58   44    27   16    41
1     1  1092    0   33    0   0     0  308    16    0    49
2     0     0   92    8  286   0     3   47   257   64   258
3     0     0    0    0    0   0     0    0     0    0     0
4     0     0    0    0  311   0     1    0    21    0  1300
5     2     0    4  118    5  63     3    1    36  348    12
6     0     0    0    2    1   0  2666    3    45    0   350
7     0     0    0  216    0   0     0  944     1    0     3
8     0     0    0   50    1   0     2   14  1299    2     2
9     3     1  109   97   12   4     4   83   227  557    40
10    0     0    0    0   14   0     0    0     0    0  1632
better model found
persisted
after epoch: 3,now: 2024-07-14 13:42:29.331530,epoch time: 0:33:28.223964,used: 1:41:24.374016,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96174014, 'precision': 0.8900279, 'recall': 0.8642688, 'specificity': 0.99591446, 'f1': 0.8652606, 'auroc': 0.9982333}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0    1    0     1     4     0    6     14
1     0  1289    0     6    0    0     0    32     3    1      1
2     1     0  121     0   39    0     1     4     2  140      3
3     5     1    1  8172    1   29     1   124    98    5      0
4     8     0   12     0  391    0     1     3     5   12    107
5     0     0    1    10    0  364     0     0     2  143      1
6    14     0    0     0    2    0  1866     0     0    6     20
7     1    12    2   103    1    0     1  7093    33    5     12
8     1     0    1    61   24    2     1    87  3064   10     45
9     0     0    8     1    0   17     0     2     2  461      1
10   23     0    1     6   66    1     3    14    10    2  12668
---- Validation: 
scalar performance:
{'acc': 0.96121436, 'precision': 0.8832447, 'recall': 0.86104184, 'specificity': 0.995871, 'f1': 0.8616486, 'auroc': 0.9981391}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     1    0    0     3     2     0    6     17
1     0  1291    0     8    0    0     0    29     3    1      0
2     0     0  125     0   41    0     1     5     2  136      2
3     5     1    0  8188    1   27     0   119    91    8      0
4     5     0   17     0  380    0     0     3     3   11    120
5     0     0    0    12    0  358     0     0     2  148      1
6    13     0    0     2    0    0  1869     1     2    6     15
7     2    10    2   116    3    0     1  7084    36    5      6
8     3     0    1    59   29    3     2    84  3074    5     36
9     1     0   10     1    2   21     0     2     1  455      0
10   28     0    3     8   75    0     5    10     7    3  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72399074, 'precision': 0.66111284, 'recall': 0.6093612, 'specificity': 0.9722027, 'f1': 0.60435224, 'auroc': 0.8814694}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   977     0    0   25    1    3    27    16     9   95    17
1     0  1205    0   16    0    0     0   255    12    1    10
2     7     0  128    4  430    8     2    45    79   89   223
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  293    0     2     2     4    1  1331
5     0     0    4   35    2  230     0     1    15  304     1
6     0     0    0    1    1    0  2854     2     5    3   201
7     0     0    0  140    0    1     0  1021     0    0     2
8     1     0    0   26    9    3     4    25  1287    4    11
9     2     1  128   24   21   43     0    74   106  711    27
10    0     0    0    0    4    0     0     0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-14 14:15:54.453939,epoch time: 0:33:25.122409,used: 2:14:49.496425,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95135915, 'precision': 0.891329, 'recall': 0.82613873, 'specificity': 0.9947591, 'f1': 0.8333535, 'auroc': 0.9981473}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    0     6    0    1     5     4     8    1     87
1     0  1294    0     4    0    0     0    26     8    0      0
2     0     0  241     2    2   16     1     5    15   29      1
3     0     2    0  8025    0   25     0   104   281    0      0
4     1     0   77     0  237    7     0     7    32    2    176
5     0     0    0     7    0  507     0     0     6    0      1
6     3     1    1     3    0    5  1835     2    15    0     43
7     0    14    1    96    1    0     1  6944   196    0     10
8     0     0    2    25    1    3     0    23  3208    0     33
9     0     0   37     4    0  274     0     1    17  160      0
10    1     0    8     7    3    2     1     7    28    0  12736
---- Validation: 
scalar performance:
{'acc': 0.9519594, 'precision': 0.8928866, 'recall': 0.82725346, 'specificity': 0.9947996, 'f1': 0.8362656, 'auroc': 0.99810004}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   376     0    0     4    1    5     3     2    11    3     78
1     0  1293    0     2    0    0     0    24     8    0      5
2     0     0  240     0    3   16     1    11    11   27      3
3     0     3    0  8042    0   21     0   120   254    0      0
4     1     0   76     0  229    6     0     4    34    4    185
5     0     0    0    10    0  503     0     0     7    0      1
6     4     3    2     1    0    6  1825     6    15    0     46
7     0    15    0   107    1    0     1  6958   174    0      9
8     0     0    0    27    1    2     0    19  3217    0     30
9     0     0   33     3    0  264     0     2    17  174      0
10    0     0    5     7    4    2     2    11    33    0  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5866508, 'precision': 0.6137595, 'recall': 0.5371256, 'specificity': 0.95844764, 'f1': 0.47412384, 'auroc': 0.87769824}
confusion matrix:
     0     1   2    3   4    5     6     7     8   9     10
0   792     0   0   50   0   57    50    10   111  18    82
1     0  1164   0    5   0    0     0   252    61   0    17
2     0     0  85    8  28   78     0    26   582  12   196
3     0     0   0    0   0    0     0     0     0   0     0
4     0     0   3    0  35    0     0     1    49   1  1544
5     0     0   0   35   0  527     0     0    28   2     0
6     0     2   0    1   0    0  1726     1   510   0   827
7     0     0   0  116   0    0     0  1021    26   0     1
8     0     0   0   14   0    1     0     0  1354   0     1
9     0     1  38   57   0  461     0    27   500  37    16
10    0     0   0    0   1    0     0     0     1   0  1644
early stop counter: 1
val acc:0.9519593715667725, best validation acc: 0.9612143635749817, corresponding to test acc:                         0.7239907383918762 / 0.7239907383918762
after epoch: 5,now: 2024-07-14 14:49:33.289260,epoch time: 0:33:38.835321,used: 2:48:28.331746,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96468323, 'precision': 0.9229553, 'recall': 0.87664455, 'specificity': 0.995961, 'f1': 0.8932655, 'auroc': 0.99885875}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     2    0    1     1     3     0    0     40
1     0  1307    0     2    0    0     0    17     4    0      1
2     2     0  260     1   16    2     0     6     2   15      8
3     1     6    0  8129    0    3     0   173   125    0      2
4     4     0   26     1  267    0     0     3    13    2    223
5     2     0    0    31    1  410     0     0     2   73      2
6    20     0    2     1    0    0  1837     3     6    1     38
7     0    22    0    51    1    0     1  7136    38    0     15
8     0     2    3    27    2    1     0    58  3122    0     80
9     1     0   56     3    0   32     0     2     7  389      3
10    4     0    0     7    3    0     1     5     8    0  12763
---- Validation: 
scalar performance:
{'acc': 0.96519995, 'precision': 0.9269216, 'recall': 0.88220906, 'specificity': 0.9960219, 'f1': 0.89779353, 'auroc': 0.99877673}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     2    0    0     0     2     1    1     37
1     0  1310    0     3    0    0     0    16     1    0      2
2     3     0  266     0   13    1     1     4     3   15      6
3     0     5    0  8115    0    1     0   175   141    2      1
4     3     0   23     1  274    0     0     3    10    0    225
5     2     0    2    21    0  424     0     0     3   68      1
6    15     1    2     1    0    0  1850     3     2    0     34
7     0    23    0    53    1    0     1  7124    46    2     15
8     0     1    5    28    0    1     0    55  3126    1     79
9     0     0   58     7    0   35     0     3     4  383      3
10    3     0    1     5    1    0     1     7     6    0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6311481, 'precision': 0.6119914, 'recall': 0.5455681, 'specificity': 0.9629378, 'f1': 0.5233062, 'auroc': 0.8744132}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   945     0    0   78   0    0    10    32    54    3    48
1     0  1201    0   13   0    0     0   245    11    0    29
2     2     0   79   24  16    8     1    34   231   22   598
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    0    0   5    0     0     1     8    0  1619
5     4     0    4  181   0  291     0     0    36   62    14
6     1     0    0    6   0    0  2226     1    46    0   787
7     0     0    0   67   0    0     0  1087     7    0     3
8     0     0    0   37   0    0     1    10  1304    1    17
9    13     0  139  185   0  112     0    80   286  237    85
10    0     0    0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 6,now: 2024-07-14 15:23:35.720876,epoch time: 0:34:02.431616,used: 3:22:30.763362,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9614191, 'precision': 0.90317035, 'recall': 0.8895689, 'specificity': 0.9958906, 'f1': 0.8916618, 'auroc': 0.9988609}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     2    2    0    22     2     2    4      5
1     0  1316    0     6    0    0     0     9     1    0      0
2     0     0  174     0    9    4     2     1     0  122      0
3     0     1    0  8386    0   23     0    17    11    1      0
4     5     0   31     1  380    1    11     3    13   15     79
5     0     0    0     2    0  499     1     0     0   18      1
6     1     0    0     1    0    0  1905     0     1    0      0
7     0    43    1   292    1    0     4  6887    29    2      4
8     2     4    0   197    5   15     5    27  3021    5     12
9     0     0    4     3    0   78     2     1     0  405      0
10    7    11    3    12   30    1   172    11    28    1  12518
---- Validation: 
scalar performance:
{'acc': 0.9597967, 'precision': 0.8977495, 'recall': 0.88556194, 'specificity': 0.9957218, 'f1': 0.8868036, 'auroc': 0.99879926}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     2    0    0    34     1     2    3     10
1     0  1322    0     5    0    0     0     4     1    0      0
2     1     0  167     0    8    6     2     1     2  125      0
3     1     1    0  8385    0   20     0    21    11    1      0
4     5     1   35     0  385    2     8     1    11   13     78
5     0     0    0     4    0  507     0     0     0    9      1
6     1     0    0     3    0    0  1900     0     0    1      3
7     0    48    1   293    1    0     3  6871    36    7      5
8     0     4    1   209    5   16     1    27  3022    1     10
9     0     0    3     5    0   86     1     0     1  397      0
10   15     6    4    12   31    2   181    10    35    5  12495
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7283985, 'precision': 0.703155, 'recall': 0.6212001, 'specificity': 0.97287595, 'f1': 0.6167034, 'auroc': 0.89005923}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   839     1    0  165    0    2   126   13     6   12     6
1     0  1378    0   29    0    0     2   85     2    0     3
2     1     2  189   28  168   81    94   42   204  104   102
3     0     0    0    0    0    0     0    0     0    0     0
4     0     2    4    0  334    0    81    1    20    2  1189
5     3     0    0   80    0  479     3    0     0   27     0
6     0     0    0    4    0    0  3061    1     1    0     0
7     0     1    0  242    0    0     1  918     1    0     1
8     0     0    0  146    0    8    23   12  1179    1     1
9     2     2   42  122    3  409    11   49    67  419    11
10    0     1    0    0    7    0    23    0     0    0  1615
new oracle model saved
early stop counter: 1
val acc:0.9597967267036438, best validation acc: 0.9651999473571777, corresponding to test acc:                         0.631148099899292 / 0.7283985018730164
after epoch: 7,now: 2024-07-14 15:57:20.584603,epoch time: 0:33:44.863727,used: 3:56:15.627089,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9762147, 'precision': 0.94342345, 'recall': 0.9207448, 'specificity': 0.9973987, 'f1': 0.93053216, 'auroc': 0.9994277}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     2    2    0    17     0     1    2     24
1     0  1312    0     1    0    0     0    16     3    0      0
2     0     0  260     0   15    1     1     0     3   31      1
3     0     1    0  8187    0   12     1   125   108    3      0
4     0     0   11     0  400    0     1     2    10    0    115
5     0     0    0     3    0  439     1     0     4   73      1
6     1     0    0     0    1    1  1892     1     2    0     10
7     0     8    1    41    1    0     1  7175    34    0      4
8     0     1    2    26    8    2     1    39  3197    4     16
9     0     0   21     1    0   20     1     0     1  448      1
10    2     0    1     6   13    0     8     5    13    0  12742
---- Validation: 
scalar performance:
{'acc': 0.9767019, 'precision': 0.9479381, 'recall': 0.9241773, 'specificity': 0.99743235, 'f1': 0.93429196, 'auroc': 0.9994342}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     0    0    0    12     0     0    2     29
1     0  1316    0     2    0    0     0    12     2    0      0
2     0     0  260     0   14    2     1     2     1   30      2
3     0     0    0  8202    0   10     2   121   100    5      0
4     1     0   10     0  400    1     1     3    10    1    112
5     1     0    0     6    0  439     1     0     5   68      1
6     2     0    0     1    0    0  1891     0     0    0     14
7     1    11    0    42    2    0     3  7164    39    0      3
8     0     0    1    29    4    0     1    38  3201    2     20
9     0     0   13     0    0   17     0     1     2  460      0
10    4     0    4     7   14    0     5     5    16    0  12741
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7271392, 'precision': 0.6570197, 'recall': 0.61579555, 'specificity': 0.9723487, 'f1': 0.59809387, 'auroc': 0.8822042}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   864     4    0  52    2    1   111    39    28   40    29
1     0  1271    0  16    0    0     1   193    10    0     8
2     2     0  123   2  201   13    18    39   256   65   296
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  162    0     2     2    16    0  1450
5     1     0    2  52    0  326     6     0    35  157    13
6     0     0    0   1    0    0  2964     1     8    0    93
7     0     0    0   9    0    1     0  1148     5    0     1
8     0     0    0  12    0    3     8    13  1331    2     1
9     1     2  101  39    4  124     6    82   170  563    45
10    0     0    0   0    3    0     0     1     1    0  1641
better model found
persisted
after epoch: 8,now: 2024-07-14 16:31:04.152186,epoch time: 0:33:43.567583,used: 4:29:59.194672,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96960616, 'precision': 0.9202231, 'recall': 0.9213674, 'specificity': 0.99671066, 'f1': 0.91861665, 'auroc': 0.9992154}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     0     0     0    1      5
1     0  1303    0    11    0    0     0    14     2    0      2
2     0     0  211     0   10    1     0     0     0   89      1
3     2     0    0  8376    0    5     1    10    42    1      0
4     6     0   14     0  454    0     0     1     1    9     54
5     0     0    0    14    0  499     0     0     1    6      1
6    10     0    0     1    1    1  1857     0     1    0     36
7     6    15    4   303    2    0     1  6793   117    5     19
8     1     0    1    50   17    5     0     4  3187    9     22
9     1     0    1     3    0   76     1     0     0  411      0
10   23     0    3     7   72    0     1     1    11    1  12672
---- Validation: 
scalar performance:
{'acc': 0.97124517, 'precision': 0.9220354, 'recall': 0.92193043, 'specificity': 0.9968957, 'f1': 0.919291, 'auroc': 0.9992225}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    0    0     1     0     0    2      4
1     1  1304    0    11    0    0     0    13     3    0      0
2     0     0  201     0    7    2     0     0     1  100      1
3     0     0    1  8390    0    2     0    10    32    5      0
4     5     0   16     1  465    0     0     0     3    7     42
5     0     0    0     8    0  503     0     0     0    9      1
6    13     0    0     1    0    2  1853     0     2    1     36
7     6    10    1   279    3    0     1  6821   115    2     27
8     1     0    0    51   17    4     0     3  3193    6     21
9     2     0    2     2    0   73     0     0     0  414      0
10   25     0    3     7   59    0     1     0    10    1  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6399636, 'precision': 0.6646867, 'recall': 0.57424533, 'specificity': 0.9641729, 'f1': 0.57766706, 'auroc': 0.88410467}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1031     0    0   43    2   35    16    3     5   18    17
1     12  1105    0   79    0    2     2  214    21    5    59
2      4     0  179   14  315   28     0    7   104   71   293
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0  448    0     0    1     8    1  1173
5      0     0    2   41    1  475     0    0     8   59     6
6     17     0    0    4    0    1  2009    0    54    1   981
7      2     0    1  600    0    2     0  539    16    1     3
8      0     0    0   51   10   17     1    0  1273    1    17
9      1     0  101   84    7  313     0    9    99  476    47
10     0     0    0    0   33    0     0    0     1    0  1612
early stop counter: 1
val acc:0.9712451696395874, best validation acc: 0.9767019152641296, corresponding to test acc:                         0.7271391749382019 / 0.7283985018730164
after epoch: 9,now: 2024-07-14 17:04:52.436426,epoch time: 0:33:48.284240,used: 5:03:47.478912,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97776645, 'precision': 0.94253933, 'recall': 0.9201547, 'specificity': 0.99754107, 'f1': 0.92566705, 'auroc': 0.9995197}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    2    0     0     2     0    0     24
1     0  1323    0     0    0    0     0     8     1    0      0
2     0     0  300     0    0    0     0     5     2    5      0
3     0     3    0  8257    0    2     0   111    65    1      1
4     2     0   62     0  341    0     0     9     7    0    118
5     0     0    2    11    0  441     0     0     3   63      1
6     7     1    0     0    0    0  1877     6     1    0     14
7     0    14    0    32    1    0     1  7192    21    0      4
8     0     0    1    24    2    1     0    51  3196    0     20
9     0     0   64     5    0   11     1     2     3  407      0
10    2     2    2     3    4    0     2    10     8    1  12757
---- Validation: 
scalar performance:
{'acc': 0.97729033, 'precision': 0.94250965, 'recall': 0.9216893, 'specificity': 0.9974766, 'f1': 0.92631495, 'auroc': 0.99951035}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    2     0    0    0     2     1     1    1     21
1     0  1326    0     0    0    0     0     5     1    0      0
2     0     0  299     0    0    1     1     7     0    4      0
3     0     5    0  8236    0    4     0   141    54    0      0
4     1     0   60     0  340    0     0     5    10    2    121
5     1     0    3    11    0  450     0     0     1   54      1
6     8     3    2     2    0    0  1875     2     4    0     12
7     0    12    1    33    0    0     0  7204    10    1      4
8     0     1    1    28    1    0     0    51  3182    0     32
9     1     0   65     1    2    8     1     3     0  412      0
10    2     1    4     6    6    0     4     6     9    1  12757
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70125234, 'precision': 0.64583194, 'recall': 0.5935637, 'specificity': 0.97003305, 'f1': 0.5655844, 'auroc': 0.880655}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   923     4    1   56    0    3    37    94    19    9    24
1     0  1355    0   12    0    0     0   127     0    0     5
2     3     0  105   19   74   23     3   111   284   35   358
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  111    0     0     2    14    0  1504
5     1     0   12  108    0  347     2     5    19   89     9
6     1     4    0    9    0    0  2851    20    35    0   147
7     0     0    0   14    0    0     0  1148     1    0     1
8     0     0    0   56    0    1     2    40  1266    1     4
9     0     5  111  121    2  168     2   212   207  273    36
10    0     0    0    0    1    0     0     1     0    0  1644
better model found
persisted
after epoch: 10,now: 2024-07-14 17:38:45.407284,epoch time: 0:33:52.970858,used: 5:37:40.449770,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9833583, 'precision': 0.95743716, 'recall': 0.94851, 'specificity': 0.9981792, 'f1': 0.95276594, 'auroc': 0.9996881}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    3    0     2     0     0    0     14
1     0  1314    0     1    0    0     0    14     3    0      0
2     0     0  282     0   12    0     2     1     0   15      0
3     0     3    0  8315    0    0     0    98    22    0      1
4     3     0    9     0  492    0     0     1     2    0     32
5     0     0    1    32    0  464     0     0     3   19      1
6     2     0    0     1    0    0  1894     0     1    0      9
7     1     8    0    47    1    0     1  7190    11    0      4
8     0     0    1    37    7    0     0    51  3179    0     18
9     0     0   21     3    1   46     1     2     0  419      0
10    0     0    1     3   40    0     1     5     3    0  12742
---- Validation: 
scalar performance:
{'acc': 0.9830146, 'precision': 0.9564543, 'recall': 0.9475459, 'specificity': 0.99814165, 'f1': 0.95183, 'auroc': 0.9996732}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    3    0     1     2     0    1      8
1     0  1320    0     0    0    0     0    11     1    0      0
2     0     0  283     0   13    0     0     1     1   13      1
3     0     0    0  8313    0    0     1   102    24    0      0
4     1     0    6     0  485    0     0     1     6    0     40
5     0     0    0    30    0  462     1     0     0   27      1
6     3     0    0     0    1    0  1894     0     0    0     10
7     0     3    0    52    1    0     1  7196     6    0      6
8     0     0    1    44    5    0     1    45  3187    0     13
9     0     0   20     5    2   44     1     4     2  415      0
10    2     0    3     3   44    0     3     4     8    1  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67207724, 'precision': 0.6550945, 'recall': 0.56490254, 'specificity': 0.9671235, 'f1': 0.55319345, 'auroc': 0.8781726}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   863     1   0   91    1    4    71    65    30    8    36
1     0  1233   0   13    0    0     0   237     5    0    11
2    18     0  96   15  178    8     7    85   327   23   258
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  358    0     0     2    17    0  1255
5     3     0   7  178    2  257     7     5    37   91     5
6     1     0   0    2    0    0  2559     4    38    0   463
7     0     0   0   65    0    0     0  1097     1    0     1
8     0     0   0   42    0    0     5    36  1285    2     0
9     8     1  58  185    9   98     6   212   293  229    38
10    0     0   0    0   17    0     0     0     0    0  1629
better model found
persisted
after epoch: 11,now: 2024-07-14 18:13:09.040541,epoch time: 0:34:23.633257,used: 6:12:04.083027,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.981646, 'precision': 0.9443638, 'recall': 0.95430744, 'specificity': 0.99804837, 'f1': 0.94802713, 'auroc': 0.9996839}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    3     0    1    0     0     1     0    0      1
1     0  1302    0     2    0    0     0    23     4    0      1
2     0     0  296     0    1    0     0     0     0   15      0
3     4     0    1  8249    0   18     0    88    76    2      0
4     4     0   41     0  438    1     0     1     5    1     47
5     0     0    0     5    0  492     0     0     0   23      1
6     1     0    2     0    1    0  1894     0     0    2      8
7     1     2    6    53    1    0     1  7164    29    0      5
8     1     0    2    27    5    2     0    25  3224    1      9
9     1     0   24     4    0   22     0     0     0  442      0
10    8     0   15     6   29    0     4    10     8    1  12712
---- Validation: 
scalar performance:
{'acc': 0.98135614, 'precision': 0.94126266, 'recall': 0.95270723, 'specificity': 0.9980242, 'f1': 0.94571954, 'auroc': 0.99963397}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    2     0    0    0     0     2     0    1      2
1     0  1307    0     1    0    0     0    20     3    1      0
2     0     0  294     0    1    0     0     1     0   16      0
3     1     0    1  8263    0   16     0   101    55    3      0
4     3     0   47     0  435    1     0     2     5    2     44
5     0     0    1     1    0  485     0     0     2   31      1
6     4     0    2     3    1    0  1888     1     2    2      5
7     1     1    6    55    0    0     1  7172    23    3      3
8     0     0    5    28    5    1     0    32  3215    0     10
9     2     0   21     0    1   20     0     1     0  448      0
10    5     0   13     6   40    1     3    10    13    0  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7154551, 'precision': 0.66318005, 'recall': 0.61998326, 'specificity': 0.97143257, 'f1': 0.6072121, 'auroc': 0.88401794}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   951     0    4  46    0   18    41    21    23   43    23
1     0  1128    0  19    0    3     0   312    20    2    15
2     1     0  273   3  161   29     0    28   260   92   168
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    5   0  244    0     0     2    20    1  1361
5     0     0    8  32    0  364     0     0    11  176     1
6     0     0    0   2    0    2  2717     3    73    2   268
7     0     0    0  97    0    1     0  1054    11    0     1
8     0     0    0  28    0    4     0     3  1329    3     3
9     3     0  131  32    3  214     0    35   178  529    12
10    0     0    0   0    8    0     0     1     0    0  1637
early stop counter: 1
val acc:0.981356143951416, best validation acc: 0.9830145835876465, corresponding to test acc:                         0.6720772385597229 / 0.7283985018730164
after epoch: 12,now: 2024-07-14 18:47:23.149710,epoch time: 0:34:14.109169,used: 6:46:18.192196,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98274297, 'precision': 0.9540013, 'recall': 0.9467126, 'specificity': 0.9982158, 'f1': 0.94764245, 'auroc': 0.99978364}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     1    1    0     8     0     1    0     15
1     0  1319    0     0    0    0     0    11     2    0      0
2     1     0  241     0   34    0     0     0     5   31      0
3     0     4    0  8355    0    0     0    27    50    0      0
4     5     0    0     0  522    0     0     0     8    0      4
5     0     0    0    36    0  439     0     0     6   40      0
6     0     1    0     1    0    0  1897     1     2    0      6
7     0     5    0    67    2    0     1  7116    68    0      5
8     0     1    0    18    3    0     0     8  3259    0      6
9     0     0    2     3    0   16     1     0     2  468      0
10    4     0    1     6  106    0     3     0    16    0  12658
---- Validation: 
scalar performance:
{'acc': 0.98314834, 'precision': 0.9545827, 'recall': 0.9472747, 'specificity': 0.99825585, 'f1': 0.9485716, 'auroc': 0.9997689}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    0    0     8     1     0    0     12
1     0  1324    0     1    0    0     0     7     0    0      0
2     0     0  240     0   42    1     0     1     2   26      0
3     0     2    0  8362    0    0     0    30    46    0      0
4     4     0    1     0  517    0     0     0    12    0      5
5     0     0    0    30    1  442     0     0     7   40      1
6     2     0    0     0    0    0  1899     1     1    0      5
7     0    11    0    61    1    0     0  7104    81    2      5
8     0     0    0    17    2    0     0     7  3259    0     11
9     1     0    5     5    0   10     0     0     4  468      0
10    2     0    2     6   89    0     4     1    13    1  12678
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7172742, 'precision': 0.6533247, 'recall': 0.58654666, 'specificity': 0.9712901, 'f1': 0.5778559, 'auroc': 0.88169163}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   710     3   0  38    2   13   291    24    36   20    33
1     0  1137   0  12    0    0     0   322    10    1    17
2     3     0  32   3  363    3     9    24   412   53   113
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   1   0  659    0     3     1    20    0   949
5     0     0   1  90    3  231    10     0    63  194     0
6     0     0   0   1    0    0  3014     1    28    0    23
7     0     0   0  49    0    0     0  1108     6    0     1
8     0     0   0  28    2    0     1    10  1323    1     5
9     1     0  38  62   28   56    11    50   419  452    20
10    0     0   0   0   57    0     1     1     1    0  1586
better model found
persisted
after epoch: 13,now: 2024-07-14 19:21:02.930567,epoch time: 0:33:39.780857,used: 7:19:57.973053,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98547196, 'precision': 0.95653987, 'recall': 0.95513, 'specificity': 0.9984498, 'f1': 0.9556315, 'auroc': 0.9997937}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    3    0     2     1     0    0      2
1     0  1261    0     4    0    0     1    61     3    0      2
2     0     0  280     0    3    2     0     3     0   24      0
3     0     0    0  8326    0    1     1    88    19    1      0
4     5     0   39     0  475    0     0     3     5    1     11
5     0     0    0    15    0  490     0     0     0   16      0
6     4     0    0     0    0    0  1898     1     0    0      5
7     0     1    0    37    0    0     0  7215     6    0      4
8     0     0    2    12    4    0     0    39  3229    0     10
9     0     0   11     1    0   32     0     1     1  447      0
10    3     0    2     5   33    0     0     4     8    1  12737
---- Validation: 
scalar performance:
{'acc': 0.98523474, 'precision': 0.95856076, 'recall': 0.95601153, 'specificity': 0.9984098, 'f1': 0.9571359, 'auroc': 0.9997918}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    3    0     2     0     0    1      1
1     0  1262    0     3    0    0     1    61     2    0      3
2     0     0  274     0    3    0     0     2     0   33      0
3     0     0    0  8330    0    0     0    87    22    1      0
4     5     0   37     0  477    0     1     5     0    1     13
5     0     0    0    18    0  492     0     0     0   11      0
6     5     0    0     1    0    0  1892     1     0    0      9
7     0     0    0    35    0    0     0  7220     7    0      3
8     0     0    0    19    5    1     0    45  3213    0     13
9     0     0    6     0    0   26     0     1     0  460      0
10    2     0    4     4   31    0     2     8     6    2  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71279645, 'precision': 0.67563075, 'recall': 0.6033896, 'specificity': 0.97118425, 'f1': 0.5983988, 'auroc': 0.88311744}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   980    0    1   38    0    3    49    38    14   21    26
1     2  911    0   13    0    0     7   511    10    0    45
2     7    0  157   22  212   14     5    83   186   95   234
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    5    0  460    0     2     3    14    1  1148
5     2    0    3  111    1  280     3     4    12  170     6
6     0    0    0    3    0    0  2842     5    18    0   199
7     0    0    0   23    0    0     0  1139     1    0     1
8     0    0    1   39    2    1     4    46  1269    2     6
9     4    0   83  111    2   95     1   135   142  533    31
10    0    0    0    0   27    0     1     1     0    0  1617
better model found
persisted
after epoch: 14,now: 2024-07-14 19:54:40.512133,epoch time: 0:33:37.581566,used: 7:53:35.554619,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98729134, 'precision': 0.9673543, 'recall': 0.9640888, 'specificity': 0.9986258, 'f1': 0.96553886, 'auroc': 0.9998325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    0     0     0     0    0      2
1     0  1305    0     0    0    0     0    27     0    0      0
2     1     0  287     0    2    0     0    11     2    8      1
3     1     5    0  8362    0    2     0    51    17    0      0
4     5     0   27     0  475    0     0     5     6    1     20
5     0     0    0     3    0  487     0     0     1   29      1
6     1     0    0     0    0    0  1901     1     1    0      3
7     0     1    0    51    0    0     0  7192    15    0      3
8     0     0    0    48    0    1     1    16  3222    0      8
9     1     0    5     2    0   16     1     2     0  466      0
10    9     0    0     8   22    1     3    11    15    0  12725
---- Validation: 
scalar performance:
{'acc': 0.9868664, 'precision': 0.9664606, 'recall': 0.960455, 'specificity': 0.9985768, 'f1': 0.9632205, 'auroc': 0.9998145}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    1    0     0     0     1    0      3
1     0  1303    0     0    0    0     0    28     1    0      0
2     1     0  285     2    0    0     0    10     2   12      0
3     0     4    0  8363    0    3     0    50    20    0      0
4     5     0   25     0  472    0     2     7     9    1     18
5     1     0    1     4    0  493     1     0     1   19      1
6     3     0    0     0    0    0  1898     1     2    0      4
7     0     1    0    56    0    0     0  7192    12    0      4
8     0     0    1    47    3    1     0    17  3215    0     12
9     3     0   10     1    0   21     1     3     2  452      0
10    7     0    0     8   15    0     3     6    13    0  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70496047, 'precision': 0.6664555, 'recall': 0.5938071, 'specificity': 0.97041786, 'f1': 0.5736899, 'auroc': 0.88284296}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   873     1   0  114    1    1   104    41    23    2    10
1     0  1066   0    3    0    0     1   411     5    0    13
2     8     0  57   27  168   30     9    97   321   67   231
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   2    0  376    0     3     3    18    0  1231
5     6     0   0  100    0  372     2     0    17   95     0
6     0     0   0    3    0    0  2947     4    13    0   100
7     0     0   0   35    0    0     0  1125     3    0     1
8     0     0   0   43    0    3     8    23  1289    1     3
9    10     0  25  124    4  204     8   128   261  346    27
10    0     0   0    0   20    0     1     0     0    0  1625
better model found
persisted
after epoch: 15,now: 2024-07-14 20:28:10.656163,epoch time: 0:33:30.144030,used: 8:27:05.698649,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.985686, 'precision': 0.9575215, 'recall': 0.957462, 'specificity': 0.9984486, 'f1': 0.9562777, 'auroc': 0.99981326}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    3     3    7    0     1     0     0    3     26
1     0  1319    0     2    0    0     0    11     0    0      0
2     0     0  302     0    7    0     0     1     0    2      0
3     0     1    0  8399    0    2     0    14    22    1      0
4     0     0   13     0  514    0     0     0     2    0     10
5     0     0    0     4    0  453     0     0     3   60      1
6     0     0    0     2    0    0  1896     0     0    0      9
7     0     7    0   128    0    0     1  7107    18    0      3
8     0     0    1    28    3    0     1    10  3236    0     17
9     0     0   48     1    2    1     0     0     0  441      0
10    0     0    2     5   34    0     1     6     8    0  12734
---- Validation: 
scalar performance:
{'acc': 0.98579645, 'precision': 0.95857376, 'recall': 0.95880675, 'specificity': 0.9984634, 'f1': 0.9576479, 'auroc': 0.99983186}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     1    1     2   12    0     0     0     1    0     24
1     0  1322    0     0    0    0     0    10     0    0      0
2     0     0  303     0    8    0     0     1     0    0      0
3     0     0    0  8412    0    0     0     9    18    1      0
4     0     0    6     0  515    0     0     0     4    0     14
5     0     0    0     5    0  454     0     0     2   59      1
6     2     0    0     1    0    0  1895     0     2    0      8
7     0    12    0   122    0    0     1  7101    24    2      3
8     0     0    0    28    4    0     0    16  3230    0     18
9     0     0   46     2    0    2     0     0     0  443      0
10    0     0    0     3   44    0     1     3     8    0  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69901353, 'precision': 0.6554586, 'recall': 0.58553064, 'specificity': 0.9699434, 'f1': 0.5890785, 'auroc': 0.87791497}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   791     4    4  126   15    2    72   35    23   50    48
1     0  1200    0   26    0    0     0  259     4    0    10
2     0     1  109   17  282   11     2   48   280   67   198
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    5    0  552    0     0    1    24    0  1051
5     0     0    4   85    4  288     0    0    29  178     4
6     1     0    0    6    2    0  2746    1    41    0   270
7     0     0    0  215    0    0     0  945     2    0     2
8     0     0    0   57    0    1     1    9  1299    2     1
9     1     1  102  104   16  116     0   64   254  459    20
10    0     0    0    0   42    0     0    1     1    0  1602
early stop counter: 1
val acc:0.9857964515686035, best validation acc: 0.9868664145469666, corresponding to test acc:                         0.7049604654312134 / 0.7283985018730164
after epoch: 16,now: 2024-07-14 21:01:39.444745,epoch time: 0:33:28.788582,used: 9:00:34.487231,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9854452, 'precision': 0.95268875, 'recall': 0.96556854, 'specificity': 0.99847823, 'f1': 0.95782375, 'auroc': 0.999819}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    1     0    3    1     3     1     1    1      2
1     0  1316    0     0    0    0     0    14     1    0      1
2     0     0  305     0    2    0     0     0     0    4      0
3     0     0    0  8382    0    0     0    40    13    0      0
4     4     0   14     0  515    0     0     2     0    0      4
5     0     0    1     7    0  452     0     0     0   60      1
6     1     0    1     0    0    0  1901     0     2    0      3
7     1     2    0    49    0    0     0  7206     6    0      1
8     0     0    1    56    6    1     0    58  3170    0      3
9     0     0   33     2    0    1     0     1     1  455      0
10    4     0   11     7   79    0     4    15    14    0  12660
---- Validation: 
scalar performance:
{'acc': 0.98494047, 'precision': 0.95185375, 'recall': 0.962361, 'specificity': 0.9984145, 'f1': 0.955547, 'auroc': 0.9998022}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     1    3    0     3     0     0    0      3
1     0  1319    0     1    0    0     0    11     1    0      0
2     0     0  306     0    1    0     0     0     0    5      0
3     0     0    0  8390    0    1     0    41     8    0      0
4     4     0   15     0  510    0     0     2     0    0      8
5     0     0    1    17    0  441     0     0     2   59      1
6     1     0    1     0    1    0  1900     0     1    1      3
7     0     0    0    54    0    0     0  7210     0    0      1
8     0     0    2    63    3    0     0    58  3167    0      3
9     0     0   41     1    0    0     0     1     0  450      0
10    2     0    5     6   90    0     4    18    14    0  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7326663, 'precision': 0.67728555, 'recall': 0.614959, 'specificity': 0.9733434, 'f1': 0.6166578, 'auroc': 0.8800273}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1000     0    2   47    0    4    38    51    11   14     3
1      0  1016    0   24    0    0     0   435     4    0    20
2     16     0  233   36  255   13     3    95   195   58   111
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    6    0  572    0     1     5    17    1  1031
5      4     0    7   97    1  251     2     1    14  214     1
6      2     1    1    3    5    0  2947     8    36    0    64
7      0     0    0   60    0    0     0  1102     1    0     1
8      0     0    0   64    1    0     0    24  1278    2     1
9     10     0  142  142    5   78     0   111   161  472    16
10     0     0    0    0   44    0     0     1     0    0  1601
new oracle model saved
early stop counter: 2
val acc:0.9849404692649841, best validation acc: 0.9868664145469666, corresponding to test acc:                         0.7049604654312134 / 0.7326663136482239
after epoch: 17,now: 2024-07-14 21:35:15.469156,epoch time: 0:33:36.024411,used: 9:34:10.511642,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9889769, 'precision': 0.97532487, 'recall': 0.9704086, 'specificity': 0.9987824, 'f1': 0.97241205, 'auroc': 0.99988854}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    2    0     5     0     0    1      6
1     0  1328    0     0    0    0     0     4     0    0      0
2     0     0  302     0    1    0     0     0     1    7      1
3     0     5    0  8320    0    2     0    85    13    1      9
4     5     0   12     1  465    1     0     0    11    1     43
5     0     0    0     1    0  511     0     0     0    9      0
6     4     1    0     0    0    0  1894     1     2    0      5
7     0    19    2    32    0    0     0  7171    30    0     11
8     0     1    0    11    1    0     0    10  3263    1      7
9     0     0    8     0    0   22     0     0     0  463      0
10    3     1    3     0    3    0     0     1     6    0  12778
---- Validation: 
scalar performance:
{'acc': 0.9881503, 'precision': 0.9700917, 'recall': 0.96746814, 'specificity': 0.99871016, 'f1': 0.9684365, 'auroc': 0.9998832}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     1    1     0    3    0     3     0     1    0      5
1     0  1329    0     0    0    0     0     2     1    0      0
2     0     0  295     0    1    0     0     1     2   12      1
3     1     2    0  8315    0    4     1    89    16    2     10
4     4     0   21     0  468    0     0     0     1    2     43
5     0     0    0     1    0  510     0     0     1    8      1
6     5     1    0     2    0    0  1889     1     2    1      7
7     0    25    0    26    0    0     0  7170    37    1      6
8     0     2    0    15    1    0     0     4  3268    0      6
9     0     0    7     0    1   26     0     0     1  458      0
10    4     0    0     0    8    0     1     1    11    0  12771
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71692437, 'precision': 0.67322904, 'recall': 0.625409, 'specificity': 0.9714302, 'f1': 0.60723007, 'auroc': 0.87674975}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   963     1    0  38    1   10    24    41    43   37    12
1     0  1255    0   9    0    0     0   206     9    0    20
2     8     0  124   9  129   25     0    39   206   78   397
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    2   0  245    0     0     2    14    0  1370
5     0     0    2  44    1  375     0     4    14  149     3
6     4     5    0   4    0    1  2583     3    76    1   390
7     0     0    0  11    0    0     0  1149     2    1     1
8     0     0    0  19    0    2     0    24  1321    2     2
9     4     3   93  37    5  144     0    65   143  603    40
10    0     0    0   0   15    0     0     1     1    0  1629
better model found
persisted
after epoch: 18,now: 2024-07-14 22:08:34.177943,epoch time: 0:33:18.708787,used: 10:07:29.220429,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9894585, 'precision': 0.9723474, 'recall': 0.9569227, 'specificity': 0.9988242, 'f1': 0.96268296, 'auroc': 0.9999021}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    2    0     2     0     0    0      6
1     0  1315    0     1    0    0     0    15     1    0      0
2     0     0  304     0    1    0     0     0     0    7      0
3     0     0    0  8403    0    3     1    18    11    0      0
4     3     0   14     0  439    1     0     0     5    0     77
5     0     0    0     3    0  515     0     0     0    2      0
6     2     0    0     1    0    0  1899     1     0    0      4
7     0     0    0    40    0    0     1  7209     9    0      6
8     1     0    0    26    0    1     0    14  3250    1      2
9     0     0   12     3    0   77     0     0     1  400      0
10    1     0    1     2    1    0     1     3    10    0  12775
---- Validation: 
scalar performance:
{'acc': 0.98970175, 'precision': 0.97508943, 'recall': 0.9634047, 'specificity': 0.9988445, 'f1': 0.9677802, 'auroc': 0.9999126}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    1     0    3    0     0     0     0    0      2
1     0  1311    0     1    0    0     0    20     0    0      0
2     0     0  307     0    1    0     1     0     0    3      0
3     2     1    1  8394    0    4     0    20    18    0      0
4     3     0   18     0  440    0     0     1     4    0     73
5     0     0    0     1    0  520     0     0     0    0      0
6     1     0    0     0    0    0  1902     0     0    0      5
7     1     0    0    48    0    0     0  7206     5    0      5
8     0     0    0    23    0    0     0    15  3250    1      7
9     1     0    5     0    1   60     0     0     1  424      1
10    2     0    0     4    4    0     1     0    16    0  12769
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.696075, 'precision': 0.6475836, 'recall': 0.6003338, 'specificity': 0.96947426, 'f1': 0.5866624, 'auroc': 0.8772227}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   929     0    2   63    2   11    47    38    45   13    20
1     3  1066    0   22    0    0     0   364    10    1    33
2     2     0  182   15  195   25     0    30   201   55   310
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  174    0     0     2    16    0  1440
5     1     0   10   83    5  366     2     2    12  105     6
6     1     0    0    3    0    0  2717     3    48    1   294
7     0     0    0   40    0    0     0  1119     3    0     2
8     0     0    0   39    2    1     2    21  1296    5     4
9     5     0  160  104   13  180     1    59   122  461    32
10    0     0    0    0    4    0     0     1     2    0  1639
better model found
persisted
after epoch: 19,now: 2024-07-14 22:41:47.009202,epoch time: 0:33:12.831259,used: 10:40:42.051688,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9872646, 'precision': 0.96517146, 'recall': 0.96172243, 'specificity': 0.9986281, 'f1': 0.9620593, 'auroc': 0.99987334}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    2    0     0     0     0    0      1
1     0  1321    0     0    0    0     0    10     1    0      0
2     0     0  302     0    1    0     0     0     1    7      1
3     1     0    0  8302    0    0     1    73    54    1      5
4     3     0   31     0  439    0     2     0     4    0     60
5     0     0    0     8    0  461     0     0    11   41      0
6     5     0    0     1    0    0  1901     0     0    1      0
7     0     3    0    17    0    0     0  7214    28    0      1
8     1     0    0     1    0    0     3     7  3268    0     16
9     1     0   10     1    0    2     0     1     2  475      0
10   29     0    0     1    7    0     9     4     6    0  12737
---- Validation: 
scalar performance:
{'acc': 0.9854755, 'precision': 0.95829415, 'recall': 0.9572172, 'specificity': 0.99844325, 'f1': 0.95601594, 'auroc': 0.9998678}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    2    0     1     0     0    0      1
1     1  1323    0     0    0    0     0     7     0    1      0
2     0     0  300     0    1    0     0     1     1    9      0
3     0     0    0  8281    0    0     0    98    55    0      6
4     6     0   43     0  424    0     1     2     4    0     59
5     1     0    0     6    0  459     2     0     8   45      0
6     5     0    0     1    0    0  1902     0     0    0      0
7     0     2    0    25    1    0     1  7199    35    0      2
8     1     0    0     5    0    0     1     5  3269    0     15
9     0     0   11     0    0    4     0     0     4  473      1
10   32     0    1     3   11    0     9     4     3    0  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72168195, 'precision': 0.6788265, 'recall': 0.60595554, 'specificity': 0.97199225, 'f1': 0.60152423, 'auroc': 0.8805463}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   995     1    1  28    0    3    25    59    32   15    11
1     0  1109    2  12    0    0     3   321    26   12    14
2     3     0  195   2  170    4     5    22   252   80   282
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    3   0  356    0     1     2     8    0  1262
5     3     0    2  75    1  235     2     2    64  206     2
6     1     0    0   1    1    0  2892     0    17    2   153
7     0     0    0  94    0    0     0  1062     6    1     1
8     0     0    0  16    1    0     2    12  1327    3     9
9     6     0  129  42    1   46     2    34   319  521    37
10    0     0    0   0   21    0     1     1     0    0  1623
early stop counter: 1
val acc:0.985475480556488, best validation acc: 0.9897017478942871, corresponding to test acc:                         0.6960750222206116 / 0.7326663136482239
after epoch: 20,now: 2024-07-14 23:15:13.359622,epoch time: 0:33:26.350420,used: 11:14:08.402108,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99173266, 'precision': 0.9813473, 'recall': 0.9823563, 'specificity': 0.9991296, 'f1': 0.9817637, 'auroc': 0.9999339}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    5    0     1     0     1    0      1
1     0  1328    0     1    0    0     0     3     0    0      0
2     0     0  291     1    3    0     0     2     0   15      0
3     1     0    0  8389    0    1     0    22    25    0      0
4     1     0    2     0  523    0     0     2     6    0      5
5     0     0    2     0    0  510     0     0     3    6      0
6     1     0    0     1    0    0  1904     0     1    0      0
7     0     5    0    66    0    0     1  7181     7    0      2
8     0     1    0    11    0    0     0    12  3272    0      0
9     0     0    2     0    3    4     0     1     2  481      0
10    6     0    1     4   23    0     8     2    36    0  12713
---- Validation: 
scalar performance:
{'acc': 0.99178815, 'precision': 0.9798109, 'recall': 0.98198503, 'specificity': 0.9991408, 'f1': 0.9806847, 'auroc': 0.9999502}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    5    0     1     0     0    0      3
1     0  1328    0     1    0    0     0     3     0    0      0
2     0     0  286     0    7    0     0     2     3   14      0
3     0     0    0  8393    0    0     0    18    29    0      0
4     2     0    1     0  528    0     0     0     4    0      4
5     0     0    0     1    0  511     0     0     2    7      0
6     3     0    0     1    0    0  1900     2     2    0      0
7     0     6    0    65    0    0     0  7184     9    0      1
8     2     0    0    12    0    0     0     5  3276    0      1
9     0     0    2     0    3    4     0     1     0  483      0
10    7     0    2     2   30    0     4     3    32    1  12715
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7151053, 'precision': 0.65659255, 'recall': 0.59608483, 'specificity': 0.97155917, 'f1': 0.59186184, 'auroc': 0.87421274}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1004     1    0   76    1    2     8   26    17   28     7
1      0  1209    0   37    0    0     1  214    22    0    16
2     15     0  111   19  211    5     2   46   403   46   157
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    3    0  376    0     3    2    47    0  1202
5      3     0   13   62    8  246     1    2    37  213     7
6      5     0    0    2    0    0  2903    1    83    0    73
7      0     0    0  199    0    0     0  960     4    0     1
8      0     0    0   32    1    1     0   13  1318    4     1
9      6     1  106  100   27   85     0   36   269  484    23
10     0     0    0    0   29    0     3    1     3    0  1610
better model found
persisted
after epoch: 21,now: 2024-07-14 23:48:35.432945,epoch time: 0:33:22.073323,used: 11:47:30.475431,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9902879, 'precision': 0.96654606, 'recall': 0.9715966, 'specificity': 0.99900734, 'f1': 0.96765053, 'auroc': 0.99993414}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    1     0    3    0     2     0     0    0      2
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  252     0   10    0     1     1     2   46      0
3     1     0    0  8388    1    5     0    28     9    4      0
4     4     0    0     0  529    0     0     1     1    0      4
5     0     0    0     1    0  510     0     0     0   10      0
6     0     0    0     0    0    0  1899     1     1    0      7
7     0     6    0    25    0    0     0  7224     5    2      1
8     0     0    0    19    1    1     0    18  3251    1      5
9     0     0    2     0    1    9     0     0     0  481      0
10    3     0    2     5   80    0     1     7    22    0  12673
---- Validation: 
scalar performance:
{'acc': 0.99047744, 'precision': 0.9680512, 'recall': 0.9724725, 'specificity': 0.9990251, 'f1': 0.96895474, 'auroc': 0.99994045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    3    1     0     0     0    2      4
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  252     0   12    0     0     1     0   47      0
3     0     0    0  8397    0    2     0    26    12    3      0
4     5     0    2     0  528    0     0     1     1    0      2
5     0     0    0     0    0  516     0     0     0    5      0
6     3     0    0     2    1    0  1895     0     3    0      4
7     0    11    0    33    0    0     0  7218     2    0      1
8     0     0    0    18    1    2     1    16  3254    0      4
9     0     0    0     0    0    9     0     0     0  484      0
10    3     0    3     3   69    0     0    11    25    0  12682
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7531659, 'precision': 0.67898124, 'recall': 0.63606334, 'specificity': 0.97519135, 'f1': 0.6291607, 'auroc': 0.8827884}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   855     1    0  54    3   12    39    53    55   88    10
1     0  1307    0  10    0    0     1   159     7    2    13
2    10     1  110   5  277   18     1    88   248   82   175
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  744    0     0     3    17    0   869
5     1     0    4  42    6  296     0     2    28  210     3
6     0     1    0   1    2    0  2874     2    32    0   155
7     0     0    0  32    0    0     0  1127     3    1     1
8     0     1    0  27    2    1     4    33  1294    6     2
9     4     1   67  35   16  118     0    98   154  622    22
10    0     0    0   0  108    0     0     1     1    0  1536
new oracle model saved
early stop counter: 1
val acc:0.990477442741394, best validation acc: 0.9917881488800049, corresponding to test acc:                         0.7151052951812744 / 0.7531659007072449
after epoch: 22,now: 2024-07-15 00:22:35.601869,epoch time: 0:34:00.168924,used: 12:21:30.644355,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.98189384, 'recall': 0.9850584, 'specificity': 0.999387, 'f1': 0.98345435, 'auroc': 0.99995035}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     2    2    0     0     0     0    0      2
1     0  1324    0     1    0    0     0     7     0    0      0
2     0     0  303     0    2    0     0     1     0    6      0
3     0     0    0  8399    0    3     0    19    15    0      0
4     4     0    3     0  518    0     0     0     6    0      8
5     0     0    0     2    0  509     0     0     1    9      0
6     2     0    0     0    1    0  1899     0     3    0      2
7     0     3    0    16    0    0     0  7235     8    0      2
8     0     0    0    16    1    0     0    11  3268    0      0
9     0     0    9     0    0    6     0     0     0  478      0
10    2     0    2     1   29    0     4     1     7    0  12747
---- Validation: 
scalar performance:
{'acc': 0.9941153, 'precision': 0.98207766, 'recall': 0.985376, 'specificity': 0.9993751, 'f1': 0.9837005, 'auroc': 0.9999542}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    2    0     0     0     0    0      3
1     0  1325    0     0    0    0     0     7     0    0      0
2     1     0  301     0    3    0     0     1     0    6      0
3     0     0    0  8397    0    2     0    32     9    0      0
4     4     0    4     0  521    0     0     0     2    0      8
5     0     0    0     1    0  512     0     0     1    7      0
6     1     0    2     1    0    0  1900     0     1    0      3
7     0     2    0    25    0    0     0  7227     8    0      3
8     0     0    0    10    1    0     0     1  3281    0      3
9     0     0   11     1    0    6     0     0     0  475      0
10    3     0    1     3   24    0     4     1    12    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7335759, 'precision': 0.6697253, 'recall': 0.6192518, 'specificity': 0.9732245, 'f1': 0.6083932, 'auroc': 0.8807895}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   876     2    1  57    4    4    74    56    41   31    24
1     0  1184    0   8    0    0     0   286    10    0    11
2     3     0  147  13  201   17     5    69   310   54   196
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  454    0     3     2    26    0  1147
5     2     0    4  66    1  345     1     4    30  138     1
6     0     0    1   2    1    0  2987     1    11    0    64
7     0     0    0  26    0    0     0  1134     3    0     1
8     0     0    0  27    1    2     6    23  1309    1     1
9     2     0   94  77   11  170     2   117   197  438    29
10    0     0    0   0   33    0     0     1     1    0  1611
better model found
persisted
after epoch: 23,now: 2024-07-15 00:57:08.353783,epoch time: 0:34:32.751914,used: 12:56:03.396269,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99245507, 'precision': 0.98481214, 'recall': 0.97813064, 'specificity': 0.9991434, 'f1': 0.98130286, 'auroc': 0.9999519}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    1    0     1     1     0    1     13
1     0  1322    0     0    0    1     0     7     1    0      1
2     0     0  293     0    7    0     0     1     1    9      1
3     0     1    0  8372    1    0     0    36    21    5      1
4     4     0    2     0  513    0     0     0     0    0     20
5     0     0    0     6    0  499     0     0     1   15      0
6     3     0    0     0    0    0  1897     0     0    1      7
7     0     3    0    37    0    0     0  7212     2    1      8
8     0     0    1    11    8    0     1     8  3245    1     21
9     1     0    0     0    0    3     1     0     0  488      0
10    1     0    0     1    1    0     1     0     1    0  12787
---- Validation: 
scalar performance:
{'acc': 0.9933663, 'precision': 0.9850395, 'recall': 0.9765668, 'specificity': 0.9992471, 'f1': 0.98067456, 'auroc': 0.999948}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    3    0     1     2     0    0     15
1     0  1325    0     0    0    0     0     5     2    0      0
2     1     0  290     0   10    0     0     0     0   10      1
3     1     0    0  8394    0    1     0    23    18    0      3
4     3     0    2     0  507    0     0     0     1    1     25
5     0     0    0     7    0  501     0     0     1   12      0
6     1     0    0     0    0    0  1903     0     0    1      3
7     0     0    0    29    0    0     0  7225     8    0      3
8     0     0    1     8    7    0     0     5  3255    0     20
9     1     0    2     0    0    4     0     0     0  486      0
10    0     0    1     0    5    0     0     0     1    0  12789
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72399074, 'precision': 0.6566759, 'recall': 0.60187185, 'specificity': 0.9721746, 'f1': 0.59531176, 'auroc': 0.874908}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   857     3   1  28    3    3    29    77    31   33   105
1     0  1183   0   7    0    0     5   245    11    1    47
2     2     0  73  13  437   16     2    45   140   57   230
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   1   0  514    0     1     2     7    0  1108
5     1     0   1  78    7  249     1     4    21  212    18
6     0     0   1   2    3    0  2939     0    20    0   102
7     0     0   0  32    0    0     2  1120     8    0     2
8     0     0   1  21    8    2    12    22  1292    3     9
9     2     0  65  74   57   94     2   107   148  513    75
10    0     0   0   0   38    0     0     0     0    0  1608
early stop counter: 1
val acc:0.9933663010597229, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.7335758805274963 / 0.7531659007072449
after epoch: 24,now: 2024-07-15 01:31:06.157303,epoch time: 0:33:57.803520,used: 13:30:01.199789,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9918397, 'precision': 0.9756814, 'recall': 0.96353763, 'specificity': 0.99912405, 'f1': 0.9668973, 'auroc': 0.999954}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    4    0     1     0     0    0      2
1     0  1325    0     1    0    0     0     5     0    0      0
2     1     0  223     0   43    0     0     1     0   43      1
3     0     0    0  8416    0    1     0    16     5    1      0
4     0     0    0     0  532    1     0     0     0    0      6
5     0     0    0    10    0  498     0     0     0   13      0
6     1     0    0     0    0    0  1903     0     0    0      4
7     0     1    0    46    1    0     0  7209     0    0      7
8     0     0    0    20    2    0     0    10  3242    0     21
9     0     0    0     1    0    3     0     0     0  489      0
10    2     0    0     1   25    0     0     0     5    0  12758
---- Validation: 
scalar performance:
{'acc': 0.99149394, 'precision': 0.9743212, 'recall': 0.96014255, 'specificity': 0.9990912, 'f1': 0.9641878, 'auroc': 0.9999452}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    3    0     0     0     0    0      3
1     0  1327    0     1    0    0     0     4     0    0      0
2     2     0  217     1   35    0     1     2     0   53      1
3     0     0    0  8413    0    1     0    10    15    1      0
4     1     0    0     0  526    0     0     0     0    2     10
5     0     0    0     9    0  495     0     0     0   17      0
6     2     0    0     0    0    0  1903     0     0    1      2
7     0     0    0    51    2    0     0  7207     2    0      3
8     0     0    0    19    1    0     0     8  3244    2     22
9     1     0    0     0    0    4     0     0     0  488      0
10    1     0    0     1   17    0     1     1     4    0  12771
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6837613, 'precision': 0.6574148, 'recall': 0.571235, 'specificity': 0.968502, 'f1': 0.5700302, 'auroc': 0.87117404}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   967     6   0   55    2    2    36   28     8   38    28
1     0  1071   0   26    0    0     4  361     6    2    29
2     7     0  27   72  250   18     2   67   168   97   307
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  440    0     0    2    13    0  1178
5     2     0   1  143    0  215     0    1     9  218     3
6     3     0   0   15    0    1  2675    2    14    0   357
7     0     0   0  175    0    0     0  983     2    2     2
8     0     0   0  100    3    4    12   21  1216    5     9
9     2     0  21  216   15   98     2   85    87  571    40
10    0     0   0    0   37    0     0    1     0    0  1608
early stop counter: 2
val acc:0.9914939403533936, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.7335758805274963 / 0.7531659007072449
after epoch: 25,now: 2024-07-15 02:04:39.886142,epoch time: 0:33:33.728839,used: 14:03:34.928628,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99381953, 'precision': 0.98307526, 'recall': 0.9844763, 'specificity': 0.9993378, 'f1': 0.98369217, 'auroc': 0.99995565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    6    0     2     0     0    0      8
1     0  1322    0     0    0    0     0    10     0    0      0
2     0     0  303     0    5    0     0     0     0    4      0
3     2     2    0  8382    0    2     0    25    23    2      0
4     0     0    3     0  529    0     0     0     0    0      7
5     0     0    0     0    0  500     0     0     0   21      0
6     1     1    0     0    0    0  1904     1     0    1      0
7     0     5    0    17    1    0     0  7226     9    0      4
8     1     6    1     6    1    1     0    11  3253    1     15
9     0     0    4     0    0    2     0     0     1  486      0
10    2     0    1     1   10    1     1     1     2    0  12773
---- Validation: 
scalar performance:
{'acc': 0.99406177, 'precision': 0.9816053, 'recall': 0.9806691, 'specificity': 0.9993639, 'f1': 0.98104924, 'auroc': 0.9999676}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    6    0     0     0     0    0      9
1     0  1328    0     0    0    0     0     4     0    0      0
2     0     0  297     0    6    0     0     1     0    7      1
3     1     3    0  8391    0    0     1    19    25    0      0
4     0     0    3     0  523    0     0     0     3    0     10
5     0     0    0     0    0  496     0     0     2   22      1
6     2     1    0     1    0    0  1901     1     0    1      1
7     1     5    0    17    1    0     0  7232     4    0      5
8     0     3    1     5    3    0     0     9  3265    0     10
9     1     0   12     0    0    1     0     0     0  479      0
10    1     0    1     2    7    0     0     0     1    1  12783
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74833834, 'precision': 0.68261814, 'recall': 0.6301261, 'specificity': 0.97470105, 'f1': 0.6283264, 'auroc': 0.87916327}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   984     9    0  38    4    3    27    45     3   11    46
1     0  1259    0  16    0    0     0   203     3    0    18
2     9     1  113  14  380   11     3    43   119   76   246
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  571    0     1     1     8    0  1051
5     8     0    0  82    7  285     0     2    15  177    16
6     0     3    1   2    4    0  2943     2     5    0   107
7     0     0    0  32    0    0     1  1127     1    2     1
8     0     0    1  48   12    4    10    22  1257    6    10
9     8     1   87  96   44   88     1    86   117  560    49
10    0     0    0   0   49    0     0     0     0    0  1597
early stop counter: 3
val acc:0.9940617680549622, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.7335758805274963 / 0.7531659007072449
after epoch: 26,now: 2024-07-15 02:37:11.155377,epoch time: 0:32:31.269235,used: 14:36:06.197863,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9894852, 'precision': 0.9779761, 'recall': 0.9697618, 'specificity': 0.9988384, 'f1': 0.97327, 'auroc': 0.9999183}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    5    0     7     0     0    0      4
1     0  1328    0     0    0    0     0     4     0    0      0
2     0     0  302     0    0    0     0     1     2    7      0
3     0     0    0  8424    0    0     0    12     2    0      0
4     2     0   35     0  464    1     0     2    13    0     22
5     0     0    0    14    0  502     0     0     1    3      0
6     0     0    0     2    0    0  1903     0     1    0      1
7     0     0    1    92    0    0     0  7163     6    0      3
8     0     0    0    68    0    0     0    11  3214    1      1
9     0     0    2     3    0   17     0     0     0  471      0
10    1     0    1     4    1    0     2     3    35    0  12745
---- Validation: 
scalar performance:
{'acc': 0.9899425, 'precision': 0.9807291, 'recall': 0.97149277, 'specificity': 0.9988781, 'f1': 0.9753989, 'auroc': 0.9999312}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    5    0     3     0     1    0      2
1     0  1325    0     3    0    0     0     4     0    0      0
2     0     0  304     2    0    0     0     0     2    4      0
3     0     0    0  8421    0    0     0    17     2    0      0
4     2     0   28     0  450    1     1     1    21    0     35
5     0     0    0     5    0  515     0     0     0    1      0
6     0     0    0     0    0    0  1902     1     1    0      4
7     0     0    0    83    0    0     1  7175     3    0      3
8     0     0    0    59    0    0     0     6  3227    1      3
9     0     0    1     2    0   17     0     0     0  473      0
10    0     0    2     3    2    0     5     2    36    1  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68362135, 'precision': 0.6682396, 'recall': 0.572496, 'specificity': 0.96821237, 'f1': 0.5560492, 'auroc': 0.87204605}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   719     0    3   55    0    1   234    81    27   25    25
1     0  1141    1   29    0    0     1   289     6    0    32
2     4     0  124   33   37   29     9    71   446   73   189
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  180    0     0     2    67    0  1380
5     1     0    4  127    0  320     5     4    21  109     1
6     0     4    0   11    0    0  2894     2    83    0    73
7     0     0    0   57    0    0     0  1105     1    0     1
8     0     0    0   63    0    0     1    30  1273    2     1
9     1     0   54  187    1  175     7   129   189  377    17
10    0     0    0    0    6    0     0     0     2    0  1638
early stop counter: 4
val acc:0.9899424910545349, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.7335758805274963 / 0.7531659007072449
after epoch: 27,now: 2024-07-15 03:09:53.797158,epoch time: 0:32:42.641781,used: 15:08:48.839644,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9930169, 'precision': 0.98616004, 'recall': 0.9789156, 'specificity': 0.9992101, 'f1': 0.982401, 'auroc': 0.99995697}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    3    0     0     0     0    0     14
1     0  1329    0     0    0    0     0     0     1    0      0
2     1     0  295     0    3    0     0     0     4    4      5
3     0     0    0  8417    0   11     0     2     5    1      0
4     2     0    1     0  511    0     0     0     3    0     22
5     0     0    0     1    0  497     0     0     0   22      1
6     0     0    0     0    0    0  1903     0     2    0      3
7     0    10    0    88    0    0     0  7160     6    0      1
8     0     0    0    18    1    2     0     4  3264    0      6
9     0     0    3     0    0    2     0     0     2  486      0
10    0     0    0     1    2    0     0     0     4    0  12787
---- Validation: 
scalar performance:
{'acc': 0.99253714, 'precision': 0.9875056, 'recall': 0.9794278, 'specificity': 0.9991416, 'f1': 0.9833495, 'auroc': 0.99996716}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     1    3    0     0     0     0    0      6
1     0  1330    0     0    0    0     0     1     1    0      0
2     0     0  298     0    4    0     0     0     2    1      7
3     0     0    0  8430    0    4     0     3     3    0      0
4     2     0    3     0  505    0     0     0     4    0     25
5     0     0    0     1    0  498     0     0     0   21      1
6     1     0    0     2    0    0  1898     0     0    0      7
7     0     8    0   103    0    0     0  7144     9    0      1
8     0     0    0    21    2    0     0     6  3256    0     11
9     0     0    4     0    0    1     1     0     1  485      1
10    0     0    0     0    1    0     1     1     4    0  12789
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69810396, 'precision': 0.6693454, 'recall': 0.5982811, 'specificity': 0.96967345, 'f1': 0.5822691, 'auroc': 0.86791265}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   904     3   0  79    1   13    43    45     5   29    48
1     0  1241   0   8    0    0     0   224     4    0    22
2     0     0  62  21  136   25     1    47   285   74   364
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  263    0     0     3    20    0  1347
5     0     0   2  64    0  342     1     0    26  153     4
6     1     3   0  13    0    2  2640     2    67    0   339
7     0     0   0  82    0    0     1  1077     2    0     2
8     0     0   0  45    0    0     2    17  1301    1     4
9     1     0  35  92    2  168     1    76   176  515    71
10    0     0   0   0   12    0     0     1     0    0  1633
early stop counter: 5
val acc:0.9925371408462524, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.7335758805274963 / 0.7531659007072449
after epoch: 28,now: 2024-07-15 03:42:32.685554,epoch time: 0:32:38.888396,used: 15:41:27.728040,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99074274, 'precision': 0.9811801, 'recall': 0.97791654, 'specificity': 0.99899507, 'f1': 0.97930026, 'auroc': 0.9999513}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    4    0     0     0     0    0      2
1     0  1330    0     0    0    0     0     2     0    0      0
2     1     0  301     0    3    2     0     2     0    3      0
3     0     0    0  8421    0    1     0    12     6    0      0
4     4     0    3     0  507    0     1     2     7    0     15
5     0     0    0     3    0  518     0     0     0    0      0
6     3     0    0     1    0    0  1902     1     0    0      0
7     0    15    0    77    0    0     0  7152    19    0      0
8     0     0    0    49    0    0     0     9  3231    0      5
9     1     0    6     2    1   27     1     2     1  452      0
10    5    13    1     3    4    0     9    10     7    0  12741
---- Validation: 
scalar performance:
{'acc': 0.99055773, 'precision': 0.9805618, 'recall': 0.9773087, 'specificity': 0.9989673, 'f1': 0.9787473, 'auroc': 0.9999442}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    2    0     1     1     0    1      1
1     0  1331    0     1    0    0     0     0     0    0      0
2     1     0  301     0    2    0     0     1     1    6      0
3     0     1    0  8427    0    1     0     7     4    0      0
4     5     0    2     0  501    0     1     1    10    0     19
5     0     0    0     1    0  516     0     0     0    3      1
6     2     0    0     2    0    0  1902     1     0    0      1
7     0    11    0    75    0    0     0  7161    18    0      0
8     0     0    0    57    1    0     0     9  3222    0      7
9     0     0    9     1    0   26     0     0     0  457      0
10    6    11    1     2    4    0     7    20     7    0  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71440566, 'precision': 0.66813534, 'recall': 0.60393226, 'specificity': 0.9715649, 'f1': 0.59677565, 'auroc': 0.8760032}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   973     6    0   49    0   17    72   24     6    7    16
1     0  1376    0   15    0    0     0  100     5    0     3
2    10     2  142   17  213   27     7   28   301   39   229
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1    3    0  373    0     8    3    28    0  1217
5     4     1    4  109    0  405     5    0    13   47     4
6     1     7    0   13    0    0  2926    0    10    0   110
7     0     0    0  285    0    0     1  867    10    0     1
8     0     0    0   87    0    1     2   11  1262    2     5
9     7     6  121  161   11  261     5   45   215  275    30
10    0     0    0    0   25    0     7    1     1    0  1612
early stop counter: 6
val acc:0.9905577301979065, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.7335758805274963 / 0.7531659007072449
after epoch: 29,now: 2024-07-15 04:15:32.964704,epoch time: 0:33:00.279150,used: 16:14:28.007190,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99042165, 'precision': 0.9818046, 'recall': 0.9806237, 'specificity': 0.9989474, 'f1': 0.98088396, 'auroc': 0.99996555}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     1     0     0    0      0
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  306     0    0    0     0     3     1    1      1
3     0     1    0  8274    0    3     0   142     9    0      6
4     4     0    5     0  522    0     0     0     1    0      7
5     0     0    0     2    0  517     0     0     1    1      0
6     0     0    0     1    0    0  1901     3     0    0      3
7     0     1    0     1    0    0     0  7257     3    0      2
8     2     1    0    18    5    0     0    55  3207    0      7
9     0     0   12     0    0   29     0     4     1  445      2
10    2     0    0     0    8    0     0     1     5    0  12779
---- Validation: 
scalar performance:
{'acc': 0.9908787, 'precision': 0.9825895, 'recall': 0.98186815, 'specificity': 0.999002, 'f1': 0.9819259, 'auroc': 0.99996567}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    3    0     3     2     0    0      1
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  307     0    1    0     0     3     0    0      1
3     2     0    0  8292    0    2     0   136     1    0      7
4     4     0    1     0  530    0     0     0     0    0      4
5     0     0    0     0    0  519     0     0     0    2      0
6     3     0    0     0    1    0  1900     0     1    0      3
7     0     1    0     1    1    0     0  7259     2    0      1
8     0     0    0    15    6    0     0    59  3211    0      5
9     0     0    8     0    0   33     1     2     0  449      0
10    1     0    0     1    8    0     2     2     4    0  12778
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71307635, 'precision': 0.65370816, 'recall': 0.61268044, 'specificity': 0.97133505, 'f1': 0.59012866, 'auroc': 0.87787277}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1032     3    0  38    3    7    11    41     2    4    29
1      0  1194    0   6    1    0     0   279     3    0    16
2     14     0  151  14  271   43     5    82   167   25   243
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0  523    1     1     4    15    0  1088
5      5     0    4  80    1  425     2     4     9   53     9
6      7     5    0   9    1    3  2752     3    20    0   267
7      0     0    0  66    0    0     0  1096     0    0     2
8      0     0    0  69    2    2     3    44  1244    1     5
9     10     1  120  90   10  359     1   179   133  179    55
10     0     0    0   0   46    0     3     1     0    0  1596
early stop counter: 7
val acc:0.990878701210022, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.7335758805274963 / 0.7531659007072449
after epoch: 30,now: 2024-07-15 04:48:16.769763,epoch time: 0:32:43.805059,used: 16:47:11.812249,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:47:11.812249 at 2024-07-15 04:48:16.769763
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7335759, 'precision': 0.6697253, 'recall': 0.6192518, 'specificity': 0.9732245, 'f1': 0.6083932, 'auroc': 0.8807895}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   876     2    1  57    4    4    74    56    41   31    24
1     0  1184    0   8    0    0     0   286    10    0    11
2     3     0  147  13  201   17     5    69   310   54   196
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  454    0     3     2    26    0  1147
5     2     0    4  66    1  345     1     4    30  138     1
6     0     0    1   2    1    0  2987     1    11    0    64
7     0     0    0  26    0    0     0  1134     3    0     1
8     0     0    0  27    1    2     6    23  1309    1     1
9     2     0   94  77   11  170     2   117   197  438    29
10    0     0    0   0   33    0     0     1     1    0  1611
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7531659, 'precision': 0.67898124, 'recall': 0.63606334, 'specificity': 0.97519135, 'f1': 0.6291607, 'auroc': 0.8827884}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   855     1    0  54    3   12    39    53    55   88    10
1     0  1307    0  10    0    0     1   159     7    2    13
2    10     1  110   5  277   18     1    88   248   82   175
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  744    0     0     3    17    0   869
5     1     0    4  42    6  296     0     2    28  210     3
6     0     1    0   1    2    0  2874     2    32    0   155
7     0     0    0  32    0    0     0  1127     3    1     1
8     0     1    0  27    2    1     4    33  1294    6     2
9     4     1   67  35   16  118     0    98   154  622    22
10    0     0    0   0  108    0     0     1     1    0  1536
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971820_instance_wise_predictions.txt
accuracy from prediction file 0.7335758763030854
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 324315 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool | 293117 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |  31198 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 324315 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool | 293117 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |  31198 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 316152 KiB |   3546 MiB |   1083 TiB |   1083 TiB |
|       from large pool | 286862 KiB |   3521 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  29290 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3958 MiB |   3958 MiB |   3958 MiB |      0 B   |
|       from large pool |   3908 MiB |   3908 MiB |   3908 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 261413 KiB | 407295 KiB |    796 TiB |    796 TiB |
|       from large pool | 247555 KiB | 401804 KiB |    780 TiB |    780 TiB |
|       from small pool |  13858 KiB |  14680 KiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6134    |    8112    |  190764 K  |  190758 K  |
|       from large pool |     130    |     436    |  102399 K  |  102399 K  |
|       from small pool |    6004    |    7940    |   88365 K  |   88359 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6134    |    8112    |  190764 K  |  190758 K  |
|       from large pool |     130    |     436    |  102399 K  |  102399 K  |
|       from small pool |    6004    |    7940    |   88365 K  |   88359 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     188    |     188    |     188    |       0    |
|       from large pool |     163    |     163    |     163    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |    1617    |  117648 K  |  117648 K  |
|       from large pool |      25    |     163    |   74866 K  |   74866 K  |
|       from small pool |      24    |    1593    |   42782 K  |   42782 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3546 MiB |   1083 TiB |   1083 TiB |
|       from large pool |  16640 KiB |   3521 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 585728 KiB |   3958 MiB |   3958 MiB |   3386 MiB |
|       from large pool | 540672 KiB |   3908 MiB |   3908 MiB |   3380 MiB |
|       from small pool |  45056 KiB |     50 MiB |     50 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 407295 KiB |    796 TiB |    796 TiB |
|       from large pool |  24320 KiB | 401804 KiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |  36862 KiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8112    |  190764 K  |  190764 K  |
|       from large pool |       2    |     436    |  102399 K  |  102399 K  |
|       from small pool |       0    |    7940    |   88365 K  |   88365 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8112    |  190764 K  |  190764 K  |
|       from large pool |       2    |     436    |  102399 K  |  102399 K  |
|       from small pool |       0    |    7940    |   88365 K  |   88365 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      46    |     188    |     188    |     142    |
|       from large pool |      24    |     163    |     163    |     139    |
|       from small pool |      22    |      25    |      25    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1617    |  117650 K  |  117650 K  |
|       from large pool |       4    |     163    |   74866 K  |   74866 K  |
|       from small pool |       0    |    1593    |   42783 K  |   42783 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3546 MiB |   1083 TiB |   1083 TiB |
|       from large pool |  16640 KiB |   3521 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 585728 KiB |   3958 MiB |   3958 MiB |   3386 MiB |
|       from large pool | 540672 KiB |   3908 MiB |   3908 MiB |   3380 MiB |
|       from small pool |  45056 KiB |     50 MiB |     50 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 407295 KiB |    796 TiB |    796 TiB |
|       from large pool |  24320 KiB | 401804 KiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |  36862 KiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8112    |  190764 K  |  190764 K  |
|       from large pool |       2    |     436    |  102399 K  |  102399 K  |
|       from small pool |       0    |    7940    |   88365 K  |   88365 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8112    |  190764 K  |  190764 K  |
|       from large pool |       2    |     436    |  102399 K  |  102399 K  |
|       from small pool |       0    |    7940    |   88365 K  |   88365 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      46    |     188    |     188    |     142    |
|       from large pool |      24    |     163    |     163    |     139    |
|       from small pool |      22    |      25    |      25    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1617    |  117650 K  |  117650 K  |
|       from large pool |       4    |     163    |   74866 K  |   74866 K  |
|       from small pool |       0    |    1593    |   42783 K  |   42783 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820

 Experiment start at: 2024-07-15 05:24:20.089262
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9328981, 'precision': 0.8323307, 'recall': 0.7572372, 'specificity': 0.9929061, 'f1': 0.7322514, 'auroc': 0.99510473}
confusion matrix:
     0     1    2     3   4   5     6     7     8    9      10
0   426     0    0     3   0   0     4     4     3   11     32
1     0  1285    0     9   0   0     0    32     5    0      1
2     1     1  166     1   1   0     1    13     7  120      1
3     4     3    1  7984   0   1     4   291   142    9      0
4     7     1  192     1  80   0     4     5    56   23    170
5     3     0    0   113   0  48     0     0    11  345      1
6    38     1    0     2   0   0  1841     1     4    5     15
7     4    78    7   127   0   0     4  6933    97    4      8
8     3     2    6   119   2   0     2    76  3054    5     26
9     3     0   10     9   0   0     0     2     8  460      1
10   30     4   30     6  15   0    19    20    71    7  12591
---- Validation: 
scalar performance:
{'acc': 0.9329678, 'precision': 0.8346614, 'recall': 0.7560514, 'specificity': 0.99293816, 'f1': 0.73045206, 'auroc': 0.99524915}
confusion matrix:
     0     1    2     3   4   5     6     7     8    9      10
0   426     0    0     5   0   0     5     7     3    9     28
1     0  1293    0     7   0   0     0    28     4    0      0
2     1     0  159     1   1   0     1    11    10  127      1
3     5     6    1  7999   0   0     5   277   140    7      0
4     9     1  185     0  84   0     2     8    57   28    165
5     1     0    0   109   0  47     0     0     9  354      1
6    38     5    0     1   0   0  1846     0     4    3     11
7     3    87    6   139   0   0     3  6928    87    3      9
8     2     3    1   122   2   0     1    79  3055    8     23
9     3     0   14     8   0   0     0     1     9  458      0
10   40     7   38     6  11   0    11    19    70   10  12584
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73966277, 'precision': 0.7217773, 'recall': 0.6058818, 'specificity': 0.97386414, 'f1': 0.5714213, 'auroc': 0.8907412}
confusion matrix:
      0     1    2    3    4   5     6     7     8    9     10
0   1129     9    0    9    0   0     2    12     2    4     3
1      0  1316    0   16    0   0     1   155     4    0     7
2     60     1  207    4   57   0     2    83   235  154   212
3      0     0    0    0    0   0     0     0     0    0     0
4      3     0    4    0  167   0     4     1    14    0  1440
5     38     0    0  127    0   9     0     0    24  391     3
6      5     0    0    1    1   0  2980     2    19    1    58
7      3     1    0   42    0   0     2  1110     3    0     3
8      3     0    0   52    1   0     3    19  1287    2     3
9     61    12   41   45    0   0     0    85   149  727    17
10     0     0    1    0    4   0     1     0     0    0  1640
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-15 05:58:13.603401,epoch time: 0:33:53.514139,used: 0:33:53.514139,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94980735, 'precision': 0.8616103, 'recall': 0.85796034, 'specificity': 0.9946593, 'f1': 0.8532938, 'auroc': 0.99717236}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     5    2    0     0     4     0    9     29
1     0  1290    0     7    2    0     0    25     4    0      3
2     0     1  196     0   36    0     2     1     3   73      0
3     2     1    1  8094    1   25     0   223    87    4      1
4     7     0   32     0  379    0     0     1    11   10     99
5     0     0    0    23    0  289     1     0     3  203      1
6    17     2    1     6    1    0  1836     3     5    3     33
7     2    24   10   187   13    0     1  6897   115    4      9
8     6     1    4   120   28    5     0    34  3062    6     29
9     0     0   19     4    4   18     0     2     3  443      0
10   20     0    8     6  139    0     3    12    24    3  12580
---- Validation: 
scalar performance:
{'acc': 0.9512104, 'precision': 0.87043405, 'recall': 0.86062706, 'specificity': 0.9947918, 'f1': 0.8589202, 'auroc': 0.9970393}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    0     7    2    0     3     4     0   12     28
1     0  1292    0     8    0    0     0    26     5    0      1
2     0     0  196     0   33    1     1     1     2   77      1
3     0     1    1  8117    0   21     0   219    77    4      0
4     7     0   25     0  389    0     1     4     8    9     96
5     0     0    0    16    1  301     0     0     5  197      1
6    16     1    0     7    2    0  1842     4     4    3     29
7     4    16    8   202   12    0     1  6906   107    3      6
8     3     0    4   128   25    4     0    31  3063    8     30
9     0     1   21     5    3   15     0     2     5  441      0
10   18     0    2     6  134    1     4    16    25    3  12587
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74532986, 'precision': 0.6728152, 'recall': 0.6315251, 'specificity': 0.9743715, 'f1': 0.62132627, 'auroc': 0.8869356}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1074     3   0  41    2    2     3    12     9   20     4
1      1  1244   0  27    0    0     0   199     9    0    19
2      6     0  66   8  532    4     0    48   117  114   120
3      0     0   0   0    0    0     0     0     0    0     0
4      2     0   0   0  444    0     1     1     7    1  1177
5      4     0   0  43    3  254     0     0    10  277     1
6     18     0   0   1    9    0  2833     6    42    0   158
7      0     0   0  26    0    0     0  1137     0    0     1
8      0     0   0  57    4    2     0     7  1290    5     5
9      7     1  72  60   46   41     1    59   151  687    12
10     0     0   0   0   21    0     0     1     0    0  1624
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-15 06:30:49.824323,epoch time: 0:32:36.220922,used: 1:06:29.735061,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95446277, 'precision': 0.85697025, 'recall': 0.88357794, 'specificity': 0.9952478, 'f1': 0.86677146, 'auroc': 0.99762154}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     2    0    1     2     2     2    3      8
1     0  1304    0     8    0    1     0    17     2    0      0
2     2     0  244     0   10    3     1     3     2   45      2
3     3     4    1  8110    0   52     0   154   114    1      0
4     8     1   75     0  319    3     0     5    29   10     89
5     0     0    2    11    0  478     0     0     7   22      1
6    34     0    0     3    0    1  1851     2     5    1     10
7     1    54    5   168    0    2     1  6954    72    2      4
8     2     2    5    94    8    4     0    49  3121    2      9
9     1     0   45     3    2  104     0     0     4  334      0
10   70     1   21     7  109    1     8    28    47    3  12496
---- Validation: 
scalar performance:
{'acc': 0.95439345, 'precision': 0.8605617, 'recall': 0.884088, 'specificity': 0.99521846, 'f1': 0.8686883, 'auroc': 0.9976175}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     3    0    0     1     2     2    3     12
1     0  1306    0     6    0    0     0    15     5    0      0
2     1     0  249     2    8    2     1     3     3   43      0
3     1     5    1  8126    0   46     1   151   107    2      0
4     9     1   78     0  324    3     0     5    21    7     91
5     0     0    0    12    0  475     0     0     5   28      1
6    24     3    2     3    1    1  1853     4     6    1     10
7     1    49    7   181    0    1     1  6942    76    4      3
8     1     3    4    94    8    8     0    54  3108    2     14
9     0     0   41     2    0  112     1     1     5  331      0
10   74     2   21     8   92    0     5    31    54    3  12506
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7696075, 'precision': 0.69683605, 'recall': 0.66650355, 'specificity': 0.97690487, 'f1': 0.64893484, 'auroc': 0.8902774}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1097    10    0  17    2    2     6    18     2   14     2
1      1  1337    0  16    0    0     0   131     4    0    10
2     27     2  215   7  167   31     2    79   318   68    99
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    5   0  495    0     2     2    25    1  1101
5      1     0    0  40    1  438     1     1    23   87     0
6      8     2    0   1    2    0  2923     9    76    0    46
7      0     0    0  11    0    1     0  1151     0    0     1
8      0     0    0  39    0    2     1    15  1312    0     1
9     10    18   99  68    5  202     0    60   252  416     7
10     0     0    1   0   26    0     1     1     1    0  1616
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-15 07:03:30.688415,epoch time: 0:32:40.864092,used: 1:39:10.599153,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9576734, 'precision': 0.91118443, 'recall': 0.8507806, 'specificity': 0.9952191, 'f1': 0.87689096, 'auroc': 0.998195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     4    2    0    22     5     1    2     31
1     0  1163    1    12    0    0     0   143     5    0      8
2     0     0  212     1   14    1     1    26     8   48      1
3     0     0    0  8325    1    2     2    79    29    0      0
4     4     0   41     2  302    1     0    10    14    9    156
5     0     0    0    58    0  402     0     0     8   52      1
6     5     0    1     4    1    0  1874     3     4    0     16
7     1     3    0   163    1    0     1  7073    17    0      4
8     1     0    3   221    3    0     1    93  2931    0     41
9     0     0   24     9    1   58     1     5     5  388      2
10    7     0    2     7   26    0    12    17    12    2  12708
---- Validation: 
scalar performance:
{'acc': 0.95789754, 'precision': 0.9090481, 'recall': 0.8540053, 'specificity': 0.9952345, 'f1': 0.8779199, 'auroc': 0.9982528}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     3    1    0    12     5     0    4     30
1     0  1184    0    14    0    0     0   126     1    0      7
2     1     0  212     1   11    3     2    27     5   45      5
3     0     0    0  8317    0    1     0    91    31    0      0
4     3     0   46     1  305    3     0     9    16    7    149
5     0     0    0    57    0  401     0     0     7   54      2
6     7     0    1     3    0    0  1880     1     4    0     12
7     0     0    0   158    1    0     1  7081    15    0      9
8     1     0    2   219    9    0     0   107  2900    2     56
9     1     0   29     8    0   55     2     4     6  387      1
10    8     0    3     8   31    0     5    14    10    1  12716
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62443155, 'precision': 0.69513714, 'recall': 0.5034418, 'specificity': 0.96259904, 'f1': 0.47654444, 'auroc': 0.87655765}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   931    0   0   54    0    0   129    29     5   10    12
1     0  471   0   25    0    0     0   936    11    0    56
2     3    0   8   46   39    9     2   173   391   53   291
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0  231    0     1     4    36    0  1361
5     3    0   0  289    0  173     3     0    46   72     6
6     0    0   0    1    0    0  2921    10    69    0    66
7     0    0   0   58    0    0     0  1105     0    0     1
8     0    0   0  108    0    0     0    32  1228    0     2
9     3    0   0  317    1   46     1   171   337  221    40
10    0    0   0    0   10    0     0     0     0    0  1636
better model found
persisted
after epoch: 4,now: 2024-07-15 07:36:40.161099,epoch time: 0:33:09.472684,used: 2:12:20.071837,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9648973, 'precision': 0.8953678, 'recall': 0.90271455, 'specificity': 0.9962295, 'f1': 0.8970123, 'auroc': 0.9986452}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    1     2    0    0     2     1     0    5     30
1     0  1301    0     2    0    0     0    23     5    0      0
2     0     0  255     0    2    1     0     2     0   52      0
3     1     0    0  8051    1   45     2   257    76    4      0
4     3     0   65     0  359    2     0     1     7    6     96
5     0     0    0     6    0  474     0     0     2   38      1
6    16     0    2     3    0    1  1876     0     1    2      7
7     5    11    2    50    3    2     1  7157    26    2      6
8     3     0   12    38   11   12     1    94  3076    8     40
9     0     0   21     1    0   76     0     1     0  392      1
10   11     1   13     6   52    1     7     5    14    2  12681
---- Validation: 
scalar performance:
{'acc': 0.96453124, 'precision': 0.89553, 'recall': 0.9011532, 'specificity': 0.99619365, 'f1': 0.89614964, 'auroc': 0.9986018}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    2     2    1    0     3     0     0   12     22
1     0  1296    0     3    0    0     0    28     4    0      1
2     0     0  253     0    2    0     0     0     1   56      0
3     4     1    0  8044    0   49     3   246    87    5      1
4     4     0   68     0  355    2     1     1     8    5     95
5     0     0    1     5    0  473     0     0     1   40      1
6    14     0    0     2    0    1  1876     2     2    2      9
7     2    13    1    44    1    1     1  7158    31    4      9
8     1     0    6    53   11   13     1    71  3082   11     47
9     0     0   19     1    0   76     0     1     0  395      1
10    4     0   11     7   48    1    13    10    11    5  12686
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7689778, 'precision': 0.70724386, 'recall': 0.6685165, 'specificity': 0.97681946, 'f1': 0.65607965, 'auroc': 0.89144075}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1095     5    1  24    0    5     2     8     5   20     5
1      0  1176    0  10    0    0     0   297     6    0    10
2      3     0  254   6  152   21     4    65   150   85   275
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   0  392    0     2     1     9    1  1225
5      2     0    0  43    0  459     0     0     7   79     2
6      1     0    0   1    0    0  3025     2     6    0    32
7      0     0    0  14    0    1     0  1146     2    0     1
8      0     0    0  43    2   16     5    17  1283    0     4
9      4     2  125  70    4  179     1   107    73  542    30
10     0     0    0   0   25    0     1     1     0    0  1619
better model found
persisted
after epoch: 5,now: 2024-07-15 08:09:46.980235,epoch time: 0:33:06.819136,used: 2:45:26.890973,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9663688, 'precision': 0.91291547, 'recall': 0.89771134, 'specificity': 0.9963726, 'f1': 0.903177, 'auroc': 0.998594}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    0    0     3     0     1    0     19
1     0  1311    0     3    0    0     0    10     6    0      1
2     0     0  244     0   42    1     1     0     7   16      1
3     1     3    1  8160    1   25     0   117   128    0      2
4     4     0    5     0  350    1     0     0    25    0    154
5     3     0    0     7    0  474     0     0     4   32      1
6     9     0    1     0    0    0  1887     1     1    0      9
7     2    53    3    88    3    1     3  6955   141    1     14
8     2     0    1    43    2    7     3    22  3194    1     19
9     4     0   58     1    3   64     1     0     8  354      0
10   11     0    1     6   17    1     4     2    21    0  12730
---- Validation: 
scalar performance:
{'acc': 0.9659222, 'precision': 0.9133367, 'recall': 0.8946425, 'specificity': 0.9963157, 'f1': 0.9017509, 'auroc': 0.99861944}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    1    0     4     0     0    1     23
1     0  1316    0     3    0    0     0     7     5    0      1
2     1     0  237     0   42    2     1     1    10   16      2
3     2     1    0  8158    1   23     3   114   137    0      1
4     3     0    3     0  355    1     1     0    26    0    150
5     0     0    0     4    1  478     0     0     4   33      1
6    12     0    1     1    0    0  1881     1     1    0     11
7     0    41    1    90    2    0     1  6963   147    2     18
8     0     1    1    36    1    8     2    20  3198    0     29
9     1     0   59     1    5   75     2     0     4  346      0
10    9     1    0     7   16    0     6     1    31    0  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71223676, 'precision': 0.60440826, 'recall': 0.61162454, 'specificity': 0.9709334, 'f1': 0.5623398, 'auroc': 0.86702704}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1116     7   0   8    2    1     5     3    17    3     8
1      0  1340   0   7    0    0     1   110    14    0    27
2      4     1  39   0  239   20     1     9   438   12   252
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0   34    0     2     0    34    0  1563
5      9     0   2  26   10  468     1     0    31   42     3
6      0     0   0   0    0    0  2921     0    55    0    91
7      0     0   0  40    0    1     1  1106    13    0     3
8      0     0   0  18    1    4     2     2  1341    0     2
9     16     4  85  31   73  245     3    10   462  170    38
10     0     0   0   0    0    0     0     1     0    0  1645
better model found
persisted
after epoch: 6,now: 2024-07-15 08:42:42.187943,epoch time: 0:32:55.207708,used: 3:18:22.098681,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97297734, 'precision': 0.91205394, 'recall': 0.9055058, 'specificity': 0.9971277, 'f1': 0.9067528, 'auroc': 0.99897796}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     1    4    0     0     1     2    4     14
1     0  1291    0     2    0    0     0    35     4    0      0
2     0     0  187     0    4    0     0     1     1  119      0
3     2     0    0  8318    0   11     0    62    42    1      1
4     2     0   55     0  393    1     0     1    11   12     64
5     0     0    0     9    0  489     0     0     2   20      1
6     7     0    0     2    0    0  1883     1     2    2      9
7     0     3    3   118    0    0     1  7103    28    3      4
8     1     0    0    64    3    5     0    54  3153    8      8
9     0     0    3     1    0   54     0     0     1  434      0
10    6     1    9     8   53    0     7    16    27    9  12658
---- Validation: 
scalar performance:
{'acc': 0.9718069, 'precision': 0.90753853, 'recall': 0.90082943, 'specificity': 0.99701345, 'f1': 0.9020076, 'auroc': 0.9989168}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     0    3    1     2     0     1    5     15
1     0  1302    0     4    0    0     0    26     0    0      0
2     0     0  186     0    6    2     0     0     2  116      0
3     1     0    0  8311    0   13     0    78    33    4      0
4     4     1   57     0  382    1     0     3    20   11     60
5     0     0    0     8    0  487     0     0     1   25      0
6     5     0    0     0    0    2  1887     3     2    2      7
7     0     5    0   119    1    0     1  7107    25    2      5
8     0     1    2    74    4    4     1    64  3134    5      7
9     0     0    1     3    0   67     0     0     0  422      0
10   10     0    6     9   55    0     9    11    29   10  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7394529, 'precision': 0.69949615, 'recall': 0.6259284, 'specificity': 0.97386587, 'f1': 0.6154988, 'auroc': 0.8863033}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1030     7    1  27    3    0    14    20    19   29    20
1      0  1113    0  13    0    0     0   339    11    1    22
2      2     0  190  19  115    9     0    68   239  148   225
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   0  265    0     1     2    25    1  1336
5      3     0    1  90    0  241     0     2    15  239     1
6      2     0    0   9    0    0  2946     4    32    1    73
7      0     0    0  24    0    0     0  1139     1    0     0
8      0     0    0  37    0    3     0    21  1305    3     1
9      5     3   62  92    4   58     0    54   127  708    24
10     0     0    0   0   12    0     0     1     1    0  1632
better model found
persisted
after epoch: 7,now: 2024-07-15 09:16:40.545720,epoch time: 0:33:58.357777,used: 3:52:20.456458,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.976402, 'precision': 0.9362247, 'recall': 0.91896784, 'specificity': 0.99744785, 'f1': 0.9269978, 'auroc': 0.99934757}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     1    1    1     5     0     1    0      1
1     0  1293    0     6    0    0     0    32     1    0      0
2     0     0  238     0   36    1     1     5     1   29      1
3     0     0    0  8303    0    7     1    84    42    0      0
4     4     0    4     1  433    0     1     3     8    0     85
5     0     0    1    12    0  456     0     0     2   49      1
6     6     0    0     0    0    0  1894     2     2    0      4
7     1     3    0    75    1    0     1  7163    15    0      4
8     0     2    1    56    1    2     0    70  3154    0     10
9     0     0   26     5    3   55     2     3     2  397      0
10   17     0    2     7   16    1    29     5    25    0  12690
---- Validation: 
scalar performance:
{'acc': 0.97507024, 'precision': 0.9348853, 'recall': 0.9193093, 'specificity': 0.99729323, 'f1': 0.9267013, 'auroc': 0.99934477}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    1    1     3     0     1    0      5
1     0  1294    0     8    0    0     0    30     0    0      0
2     1     0  244     0   32    1     1     6     1   26      0
3     2     0    0  8308    0    5     0    83    42    0      0
4     5     0    6     0  426    1     2     2     8    1     88
5     0     0    1    14    0  456     0     0     2   47      1
6     4     0    0     5    0    0  1893     1     2    1      2
7     0     3    0    82    1    0     1  7156    17    0      5
8     0     1    2    64    8    0     1    94  3118    1      7
9     0     0   30     5    0   46     2     4     1  404      1
10   18     0    3     6   22    0    22     6    36    0  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6932764, 'precision': 0.62790644, 'recall': 0.5768766, 'specificity': 0.9692731, 'f1': 0.5644194, 'auroc': 0.87877136}
confusion matrix:
      0    1    2    3    4    5     6     7     8    9     10
0   1071    5    0   25    1    2    34     7    19    4     2
1      0  957    0   20    0    0     2   498     2    0    20
2     18    0   93   20  318    5    25    72   247   31   186
3      0    0    0    0    0    0     0     0     0    0     0
4      0    0    0    0  141    0     7     2    23    0  1460
5      7    0    6  127    4  281     8     0    15  143     1
6      1    0    0    1    0    0  3045     1    13    0     6
7      0    0    0  114    0    0     0  1047     2    0     1
8      0    0    0   91    1    0     6    18  1251    1     2
9     19    0  143  174   33   48    23   117   168  385    27
10     0    0    0    0    4    0     2     0     2    0  1638
better model found
persisted
after epoch: 8,now: 2024-07-15 09:53:30.459522,epoch time: 0:36:49.913802,used: 4:29:10.370260,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9775524, 'precision': 0.9421661, 'recall': 0.91160595, 'specificity': 0.99751985, 'f1': 0.92352855, 'auroc': 0.99948627}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    0    0     2     1     0    0     16
1     0  1323    0     0    0    0     0     6     3    0      0
2     1     0  248     0   46    0     0     2     2    7      6
3     1     2    0  8319    0    4     0    67    45    0      0
4     4     0    3     0  382    0     0     1    22    1    126
5     0     0    0    16    0  498     0     0     1    6      0
6    11     1    0     1    1    0  1880     1     1    0     12
7     1    22    0    91    1    0     1  7120    23    0      5
8     0     0    0    35    0    0     0    28  3219    0     13
9     1     0   36     2    1  104     1     1     6  340      1
10    3     0    0     7    7    0     2     3    24    1  12744
---- Validation: 
scalar performance:
{'acc': 0.9777986, 'precision': 0.9431663, 'recall': 0.91196406, 'specificity': 0.9975442, 'f1': 0.92394197, 'auroc': 0.9994838}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    0    0     0     0     0    1     17
1     0  1322    0     1    0    0     0     5     4    0      0
2     0     0  247     0   41    2     0     2     4    9      7
3     2     1    0  8322    0    2     0    71    42    0      0
4     6     1    3     0  378    1     0     0    23    1    126
5     0     0    0     9    0  504     0     0     4    3      1
6    10     1    0     0    0    0  1881     2     4    0     10
7     0    22    0    97    1    0     1  7116    21    0      7
8     0     0    0    32    1    1     0    27  3224    0     11
9     1     0   44     3    0   96     0     0     9  340      0
10    2     1    0     6    2    0     3     3    23    0  12756
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6886588, 'precision': 0.64420164, 'recall': 0.5906781, 'specificity': 0.9688449, 'f1': 0.5541869, 'auroc': 0.88132185}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1113     2   0   22    2    2     1    11     8    4     5
1      0  1230   0   20    0    0     0   228     9    0    12
2     11     1  34   21   86   16     1    39   575   25   206
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  125    0     0     1    49    0  1458
5      7     0   1  104    1  396     2     0    39   37     5
6      4     0   0    3    0    0  2707     5   276    0    72
7      0     0   0  104    0    0     0  1057     2    0     1
8      0     0   0   49    0    1     0     7  1312    0     1
9     16     2  46  143   10  187     7    41   404  231    50
10     0     0   0    0    5    0     0     0     3    0  1638
better model found
persisted
after epoch: 9,now: 2024-07-15 10:31:13.698693,epoch time: 0:37:43.239171,used: 5:06:53.609431,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9832513, 'precision': 0.95484275, 'recall': 0.94491655, 'specificity': 0.998142, 'f1': 0.94858104, 'auroc': 0.99968195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    0    0     3     0     1    2      4
1     0  1295    0     4    0    0     0    30     1    0      1
2     0     0  293     0    5    1     1     0     1   11      0
3     0     1    0  8335    1    4     0    50    48    0      0
4     6     0   18     0  421    2     1     0     3    0     88
5     1     0    0     7    0  485     0     0     2   25      1
6     4     0    1     0    0    0  1896     1     0    0      6
7     1     0    4    78    1    0     0  7147    23    2      7
8     1     0    3    13    1    0     1    26  3222    1     28
9     0     0   38     1    0   33     2     0     0  419      0
10    3     0    2     3   12    0     4     1     2    0  12764
---- Validation: 
scalar performance:
{'acc': 0.98202485, 'precision': 0.954592, 'recall': 0.9450792, 'specificity': 0.9979925, 'f1': 0.9487518, 'auroc': 0.9996629}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    0    0     0     0     0    1      4
1     0  1301    0     3    0    0     0    25     1    0      2
2     1     0  294     0    3    0     2     0     1   11      0
3     0     0    1  8321    0    4     0    51    63    0      0
4     3     0   15     0  423    2     1     0     4    0     91
5     1     0    0    10    0  482     0     0     2   25      1
6     7     0    0     1    0    0  1892     2     1    0      5
7     0     3    3    85    1    0     0  7145    21    1      6
8     2     0    2    13    3    0     1    23  3202    2     48
9     1     0   33     3    2   33     1     0     1  419      0
10    7     0    2     3   15    0     5     2     4    1  12757
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68047297, 'precision': 0.6388259, 'recall': 0.55835843, 'specificity': 0.9679272, 'f1': 0.54316014, 'auroc': 0.87566966}
confusion matrix:
      0    1    2    3    4    5     6     7     8    9     10
0   1008    2    1   36    4    0    58    11    25   14    11
1      3  780    0   12    0    0     1   648    19    0    36
2      4    0  132   20  164    2     8    46   336   39   264
3      0    0    0    0    0    0     0     0     0    0     0
4      0    0    1    0  151    0     2     1    20    0  1458
5      3    0    6  148    3  176    10     0    36  207     3
6      0    0    0    0    0    0  3028     1     9    0    29
7      0    0    0   91    0    0     0  1069     3    0     1
8      0    0    0   45    0    0    13     7  1298    2     5
9      5    0  126  126   20   35    17    56   277  445    30
10     0    0    0    0    7    0     0     0     0    0  1639
better model found
persisted
after epoch: 10,now: 2024-07-15 11:07:28.971941,epoch time: 0:36:15.273248,used: 5:43:08.882679,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9825824, 'precision': 0.95436144, 'recall': 0.9382732, 'specificity': 0.99811447, 'f1': 0.94516754, 'auroc': 0.99963546}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    3    0     1     0     0    0      5
1     0  1319    0     1    0    0     0    12     0    0      0
2     2     0  229     0   43    0     0     9     1   26      2
3     0     0    0  8256    0    1     2   145    33    1      0
4     5     0    2     1  468    0     0     3     6    0     54
5     3     0    0     5    1  488     0     0     3   18      2
6     4     0    0     0    0    0  1899     0     2    0      3
7     1     4    0    38    0    0     0  7196    22    0      3
8     3     0    0    30    6    0     0    22  3219    0     12
9     6     0   15     2    1   34     0     1     5  429      0
10    8     0    0     3   19    0     2     6     9    0  12748
---- Validation: 
scalar performance:
{'acc': 0.9833088, 'precision': 0.9552706, 'recall': 0.93967694, 'specificity': 0.9981945, 'f1': 0.9462487, 'auroc': 0.99967986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    2    0     2     0     0    0      3
1     0  1315    0     1    0    0     0    15     0    0      1
2     1     0  230     0   43    0     0     6     1   29      2
3     2     0    0  8279    0    5     1   115    38    0      0
4     7     0    1     1  463    0     0     2     8    0     57
5     1     0    0    10    0  493     0     0     2   14      1
6     7     0    0     0    0    0  1895     0     0    0      6
7     1     3    0    32    0    0     1  7204    21    0      3
8     0     0    1    35    3    3     0    27  3219    1      7
9     4     0   13     1    2   35     0     0     2  435      1
10   12     0    0     5   14    0     2     4     7    0  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6982439, 'precision': 0.6004458, 'recall': 0.5778669, 'specificity': 0.96965456, 'f1': 0.5483444, 'auroc': 0.87333536}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1088     1   0    8    2    0    13    29    10    2    17
1      1  1081   0   11    0    0     0   364    14    0    28
2     59     1   2   19  354    4     2    63   215   19   277
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  238    0     1     1    23    0  1370
5     56     0   0  123   14  262     0     2    15   98    22
6      6     0   0    1    0    0  2992     3    14    0    51
7      0     0   0   14    0    0     0  1147     1    0     2
8      4     0   0   66    3    1    11    23  1257    1     4
9    117     0   8  114   86   91     3    91   239  274   114
10     0     0   0    0    6    0     0     0     1    0  1639
better model found
persisted
after epoch: 11,now: 2024-07-15 11:43:50.313125,epoch time: 0:36:21.341184,used: 6:19:30.223863,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9785959, 'precision': 0.9528676, 'recall': 0.92928755, 'specificity': 0.99753416, 'f1': 0.9372054, 'auroc': 0.9996743}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     1    0    0     2     1     0    3     21
1     0  1316    0     2    0    0     0    13     0    0      1
2     0     0  286     0    3    3     0     2     0   18      0
3     0     0    0  8372    0   14     0    40    11    1      0
4     3     0   22     1  366    5     0     5     3    3    131
5     0     0    0     0    0  519     0     0     0    1      1
6     2     0    1     0    0    1  1895     0     1    0      8
7     0     6    2   102    0    0     0  7144     3    1      4
8     0     1    4    52    3   15     2    90  3057    1     70
9     0     0   24     0    0   72     0     0     0  397      0
10    2     0    2     7    3    0     0     6     2    2  12769
---- Validation: 
scalar performance:
{'acc': 0.9784138, 'precision': 0.9501266, 'recall': 0.92949533, 'specificity': 0.9975393, 'f1': 0.93535405, 'auroc': 0.9996467}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    1     2    0    1     4     0     0    4     14
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  297     0    2    1     0     0     0   12      0
3     0     1    0  8355    0   20     0    43    20    1      0
4     3     0   24     1  364    2     1     5     3    4    132
5     0     0    0     2    0  514     0     0     0    4      1
6     1     0    0     2    0    1  1896     0     0    3      5
7     0     9    1    92    1    0     1  7155     3    0      3
8     0     0    4    60    3   15     1    84  3059    4     66
9     0     0   28     0    0   80     0     3     0  382      0
10    1     0    4     4    1    0     0     7     4    1  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6876793, 'precision': 0.64328015, 'recall': 0.59290993, 'specificity': 0.96856445, 'f1': 0.57177943, 'auroc': 0.87756765}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   769     0    0   44   0   24   191    27     3   59    53
1     0  1283    0   18   0    0     1   177     4    0    16
2     0     0  174   22  68   44     5   113   125   79   385
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    1    0  40    1     1     2    11    0  1577
5     0     0    4   52   0  450     1     1     1   75     8
6     0     0    0    1   0    6  2801     3     9    0   247
7     0     0    0  148   0    0     2  1012     1    0     1
8     0     0    0   78   0   15     9    17  1236    2    13
9     1     0  103  108   0  270     1   129    68  419    38
10    0     0    0    0   0    0     0     1     0    0  1645
early stop counter: 1
val acc:0.9784138202667236, best validation acc: 0.9833087921142578, corresponding to test acc:                         0.6982439160346985 / 0.7696074843406677
after epoch: 12,now: 2024-07-15 12:18:43.292571,epoch time: 0:34:52.979446,used: 6:54:23.203309,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9805223, 'precision': 0.95910156, 'recall': 0.9362663, 'specificity': 0.99789137, 'f1': 0.9452684, 'auroc': 0.99971914}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    2    0     2     0     0    0      9
1     0  1315    0     1    0    0     0    15     1    0      0
2     0     0  301     0    2    0     1     2     3    2      1
3     0     0    1  8291    0    0     1    74    71    0      0
4     4     0    8     1  423    0     0     2    30    0     71
5     0     0    0    44    0  415     7     0    11   43      1
6     6     0    0     0    0    0  1895     0     2    0      4
7     0     2    0    75    0    0     1  7141    43    0      1
8     0     0    0    18    0    0     0    10  3268    0      0
9     3     0   46     3    1    9     3     2     8  418      0
10    7     0    2     4    2    0     3     5    58    0  12711
---- Validation: 
scalar performance:
{'acc': 0.97983146, 'precision': 0.9556786, 'recall': 0.93079364, 'specificity': 0.9977945, 'f1': 0.9402671, 'auroc': 0.99967384}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     1    1    0     1     0     1    0      6
1     0  1315    0     1    0    0     0    14     2    0      0
2     1     0  302     0    1    0     0     1     5    2      0
3     1     1    0  8316    0    0     1    63    57    0      1
4     4     0   12     0  401    0     1     1    23    0     97
5     0     0    1    36    0  416     5     0    15   48      0
6     7     0    0     0    0    0  1890     1     3    0      7
7     0     2    0    87    0    0     1  7143    30    0      2
8     0     0    0    24    0    0     0    15  3255    0      2
9     2     0   52     5    2    9     5     3    10  405      0
10    4     0    1     3    6    1     3     5    58    0  12715
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67585534, 'precision': 0.6140551, 'recall': 0.5473583, 'specificity': 0.96745, 'f1': 0.50969064, 'auroc': 0.8718767}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1017     4   0   34   0    0    28    18    60    2     7
1      2  1115   0   18   0    0     0   336    20    0     8
2     45     1  55   14  45    2     5    64   495   16   273
3      0     0   0    0   0    0     0     0     0    0     0
4      0     0   1    0  59    0     3     1    62    0  1507
5     35     0   8  166   2  131    12     1    80  146    11
6      1     0   0    2   0    0  2970     1    52    0    41
7      0     0   0   29   0    0     0  1132     2    0     1
8      0     0   0   29   0    0     2    24  1314    1     0
9     66     1  86  125  12   29    13   112   420  228    45
10     0     0   0    0   1    0     1     1     4    0  1639
early stop counter: 2
val acc:0.9798314571380615, best validation acc: 0.9833087921142578, corresponding to test acc:                         0.6982439160346985 / 0.7696074843406677
after epoch: 13,now: 2024-07-15 12:54:10.333500,epoch time: 0:35:27.040929,used: 7:29:50.244238,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.95164967, 'recall': 0.9597176, 'specificity': 0.998386, 'f1': 0.9550067, 'auroc': 0.99976325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    0    0     4     1     0    0      2
1     0  1321    0     1    0    0     0    10     0    0      0
2     0     0  270     1    3    5     1     3     0   28      1
3     0     0    0  8363    0    6     0    46    23    0      1
4     6     0    9     0  503    4     2     1     2    3      8
5     0     0    0     3    0  512     0     0     0    6      0
6     1     0    0     0    0    0  1904     1     1    0      0
7     1     8    0    73    0    0     2  7169     9    0      1
8     0     1    1    27    1    1     1    39  3218    1      5
9     1     0    6     1    0   58     0     4     0  423      0
10   26     0    1     3   60    1    47     6    15    0  12635
---- Validation: 
scalar performance:
{'acc': 0.98579645, 'precision': 0.95654327, 'recall': 0.9644648, 'specificity': 0.9985198, 'f1': 0.95985043, 'auroc': 0.99980783}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    0    0     0     1     1    0      1
1     0  1326    0     0    0    0     0     6     0    0      0
2     1     0  279     0    2    3     0     1     1   24      1
3     0     0    0  8362    0    5     1    53    19    0      0
4     6     0    6     0  511    0     0     0     3    3     10
5     0     0    0     4    0  512     0     0     0    5      0
6     2     0    0     0    0    0  1904     0     1    0      1
7     2    11    0    77    0    0     1  7166     6    0      2
8     0     0    2    27    3    2     0    33  3222    0      7
9     0     0    7     1    0   65     0     0     0  420      0
10   25     0    1     5   44    0    33     5    11    0  12672
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72601974, 'precision': 0.6410314, 'recall': 0.610476, 'specificity': 0.97231525, 'f1': 0.586406, 'auroc': 0.8833539}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   960     5   0  45    0    0   118    13    25    1     3
1     0  1234   0   2    0    0     1   238    11    0    13
2     8     1  42  11  180   58    39    81   265   43   287
3     0     0   0   0    0    0     0     0     0    0     0
4     1     0   0   0  300    0     9     2    24    0  1297
5     5     0   0  87    0  359     9     1    22  106     3
6     1     0   0   1    0    0  3040     1    16    0     8
7     0     0   0  18    0    0     1  1142     1    0     2
8     0     0   0  35    0    4     9    27  1292    1     2
9    13     0  75  99   21  193    37   130   135  385    49
10    0     0   0   0   17    0     5     1     0    0  1623
better model found
persisted
after epoch: 14,now: 2024-07-15 13:29:25.863276,epoch time: 0:35:15.529776,used: 8:05:05.774014,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98935145, 'precision': 0.9758751, 'recall': 0.9656358, 'specificity': 0.99880683, 'f1': 0.9704288, 'auroc': 0.99987936}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     0    6    0     0     0     0    0     16
1     0  1320    0     3    0    0     0     8     0    0      0
2     0     0  287     0    6    0     0     5     0   14      0
3     0     0    0  8333    0   19     0    59    26    0      1
4     1     0    4     0  489    0     0     1     2    0     42
5     0     0    0     0    0  515     0     0     2    4      0
6     0     0    0     0    1    0  1890     0     3    0     13
7     0     0    0    20    0    0     0  7237     3    0      3
8     0     1    0    19    0    0     0    39  3221    1     13
9     1     0   13     0    2   28     0     0     1  448      0
10    0     0    1     3    3    0     0     4     7    0  12777
---- Validation: 
scalar performance:
{'acc': 0.989461, 'precision': 0.97730464, 'recall': 0.9661906, 'specificity': 0.9988071, 'f1': 0.9714155, 'auroc': 0.99989676}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     0    4    1     0     1     0    0     21
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  295     0    8    0     0     3     0    6      0
3     0     0    0  8341    0   12     0    60    27    0      0
4     1     0    2     0  481    0     0     4     2    0     49
5     0     0    0     0    0  514     0     0     1    6      0
6     2     0    0     0    1    0  1890     1     2    0     12
7     0     0    0    26    2    0     0  7234     2    0      1
8     0     0    0    22    4    1     0    31  3226    0     12
9     0     0   12     1    0   29     0     0     0  450      1
10    0     0    1     2    6    0     1     5     1    1  12779
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69908345, 'precision': 0.6526997, 'recall': 0.5961268, 'specificity': 0.96992785, 'f1': 0.5840596, 'auroc': 0.87612534}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   969     3    1   42   13    8    29    35    17   28    25
1     0  1102    0   22    0    0     0   356     8    0    11
2     0     0  141   21  203   23     2    89   161   60   315
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    1  242    0     0     2    15    0  1372
5     0     0    6   84    4  364     0     2     7  113    12
6     1     0    0    4    1    3  2831     2    41    0   184
7     0     0    0   87    0    0     0  1074     1    0     2
8     0     0    0  103    0    4     1    27  1229    3     3
9     1     0   91  137   11  215     0   131   111  404    36
10    0     0    0    0    9    0     0     1     0    0  1636
better model found
persisted
after epoch: 15,now: 2024-07-15 14:03:08.697724,epoch time: 0:33:42.834448,used: 8:38:48.608462,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98836154, 'precision': 0.9725132, 'recall': 0.96101433, 'specificity': 0.9987234, 'f1': 0.96638995, 'auroc': 0.99985284}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    0    0     1     2     0    1      2
1     0  1315    0     1    0    0     0    16     0    0      0
2     0     0  270     1   12    0     2     3     0   22      2
3     1     0    0  8396    0    0     0    39     1    1      0
4     5     0    3     0  500    0     0     0     6    2     23
5     0     0    0    15    0  476     0     0     2   28      0
6     0     0    0     1    0    0  1900     2     0    0      3
7     1     2    1    41    0    0     1  7212     5    0      2
8     0     1    0    51    2    0     0    61  3173    1      7
9     0     0   12     1    0   11     0     1     1  467      0
10    5     0    1     5    7    0     2     6     7    2  12757
---- Validation: 
scalar performance:
{'acc': 0.98844457, 'precision': 0.9750114, 'recall': 0.96205914, 'specificity': 0.9987291, 'f1': 0.96805215, 'auroc': 0.9998552}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    1    0     6     0     0    0      3
1     0  1314    0     1    0    0     0    16     1    0      0
2     0     0  276     0    9    0     1     3     1   21      1
3     0     0    0  8399    0    0     0    35     5    1      0
4     6     0    5     0  489    0     0     2     7    0     30
5     0     0    0    13    0  475     0     0     2   31      0
6     2     0    0     1    0    0  1899     1     0    0      5
7     0     1    0    39    1    0     0  7221     2    0      1
8     0     0    0    60    0    1     0    48  3181    1      5
9     0     0    4     1    0    7     0     1     2  478      0
10    4     0    0     3   15    0     3     6    16    0  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6722871, 'precision': 0.6539738, 'recall': 0.5387969, 'specificity': 0.96733785, 'f1': 0.5250764, 'auroc': 0.8715017}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   826     4   0   78    2   0   125    65    15   41    14
1     0  1054   0   21    0   0     0   384    10    0    30
2     1     0  58   62  154   2     4    84   373   62   215
3     0     0   0    0    0   0     0     0     0    0     0
4     0     0   0    1  220   0     2     3    32    0  1375
5     0     0   1  251    0  97     3     1    21  216     2
6     0     0   0    8    0   0  2991     3    31    0    34
7     0     0   0   40    0   0     0  1121     2    0     1
8     0     0   0  124    0   0     1    22  1220    1     2
9     2     0  37  290   10  23     4   125   235  385    26
10    0     0   0    0    6   0     1     1     1    0  1637
early stop counter: 1
val acc:0.9884445667266846, best validation acc: 0.9894610047340393, corresponding to test acc:                         0.6990834474563599 / 0.7696074843406677
after epoch: 16,now: 2024-07-15 14:40:42.708814,epoch time: 0:37:34.011090,used: 9:16:22.619552,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98507065, 'precision': 0.9601239, 'recall': 0.94953597, 'specificity': 0.9984348, 'f1': 0.95320344, 'auroc': 0.9997983}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    2    0     7     1     3    0      6
1     0  1318    0     0    0    0     0    12     2    0      0
2     0     0  283     0    0    1     0     0     3   25      0
3     0     0    0  8278    0    3     0    34   123    1      0
4     4     0   46     0  410    0     2     2    19    7     49
5     0     0    0     0    0  508     0     0     4    8      0
6     0     0    0     0    0    0  1899     3     2    0      4
7     1     0    0    34    0    0     0  7192    34    0      2
8     0     0    0     7    0    0     0     8  3278    0      3
9     0     0    2     0    0   46     0     0     5  440      0
10    0     0    2     3    4    0     2     4    28    0  12748
---- Validation: 
scalar performance:
{'acc': 0.9853952, 'precision': 0.96055037, 'recall': 0.95150495, 'specificity': 0.99846804, 'f1': 0.95458907, 'auroc': 0.99978876}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    1    0     3     0     1    0      7
1     0  1312    0     0    0    0     0    15     5    0      0
2     0     0  278     0    0    1     0     0     3   29      1
3     0     0    0  8281    0    1     0    38   120    0      0
4     4     0   49     0  416    0     3     3    15    7     42
5     0     0    0     1    0  511     0     0     4    5      0
6     1     0    0     0    0    0  1900     2     2    0      3
7     0     0    2    34    0    0     0  7191    34    1      3
8     0     0    0     7    1    0     1     4  3278    0      5
9     0     0    1     0    0   40     1     0     5  446      0
10    2     0    0     3    3    1     3     5    24    0  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6872595, 'precision': 0.67244726, 'recall': 0.5949986, 'specificity': 0.9685297, 'f1': 0.5713017, 'auroc': 0.8783975}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   942     6    0  33    1   12    51    49    49   24     3
1     0  1029    0   8    0    1     0   402    49    0    10
2     1     0  121   3   78   20     1    28   570   68   125
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  288    0     2     3    66    0  1270
5     2     0    0  53    2  392     0     2    57   84     0
6     2     0    0   1    0    0  2597     2   382    0    83
7     0     0    0  27    0    0     0  1127     9    0     1
8     0     0    0   7    0    1     0     8  1353    1     0
9     4     0   51  44    3  143     0    27   497  345    23
10    0     0    0   0   13    0     1     1     2    0  1629
early stop counter: 2
val acc:0.9853951930999756, best validation acc: 0.9894610047340393, corresponding to test acc:                         0.6990834474563599 / 0.7696074843406677
after epoch: 17,now: 2024-07-15 15:14:25.440592,epoch time: 0:33:42.731778,used: 9:50:05.351330,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99018085, 'precision': 0.9773797, 'recall': 0.971522, 'specificity': 0.99890804, 'f1': 0.97426295, 'auroc': 0.9999074}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    0    0     1     0     0    0     12
1     0  1283    0     0    0    0     0    49     0    0      0
2     0     0  299     0    2    0     0     3     0    7      1
3     1     0    0  8375    0    6     0    34    19    0      0
4     4     0    7     0  502    1     0     0     1    0     23
5     0     0    0     3    0  513     0     0     0    5      0
6     2     0    0     2    0    0  1898     2     0    1      3
7     0     0    0    36    0    0     1  7217     5    0      5
8     1     0    0    22    5    1     1    17  3230    1     17
9     0     0   11     3    0   27     0     0     0  451      1
10    2     0    0     1   12    0     1     2     5    1  12771
---- Validation: 
scalar performance:
{'acc': 0.99074495, 'precision': 0.97889006, 'recall': 0.9745487, 'specificity': 0.9989773, 'f1': 0.97649354, 'auroc': 0.9999185}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     1    0    0     0     0     0    0      3
1     0  1276    0     0    0    1     0    54     0    0      1
2     0     0  300     0    3    0     0     2     0    6      1
3     0     0    0  8386    0    5     0    30    19    0      0
4     4     0    3     0  506    1     0     0     0    0     25
5     0     0    0     1    0  516     0     0     0    4      0
6     4     0    0     3    0    0  1898     1     0    0      2
7     0     0    0    44    0    0     0  7212     5    1      3
8     1     0    0    25    4    2     0    11  3242    0     11
9     0     0    8     1    0   30     0     1     0  452      1
10    3     0    0     0   15    0     0     2     3    1  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65262717, 'precision': 0.59579813, 'recall': 0.542467, 'specificity': 0.9651115, 'f1': 0.51805335, 'auroc': 0.86454284}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   780    5   2  67    1   24    35    67    67   36    86
1     0  709   0   6    0    0     0   717    16    0    51
2     1    1  62   7  216   16     0    46   218   37   411
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   0   0  192    0     2     1    16    0  1422
5     0    0   6  70    5  316     0     3    20  162    10
6     0    0   0   9    0    1  2923     3    31    0   100
7     0    0   0  54    0    0     0  1107     1    0     2
8     0    0   0  35    6    3     2    25  1289    2     8
9     5    0  96  70   39  175     0    89   259  314    90
10    0    0   0   0    9    0     1     0     0    0  1636
better model found
persisted
after epoch: 18,now: 2024-07-15 15:49:29.417089,epoch time: 0:35:03.976497,used: 10:25:09.327827,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99167913, 'precision': 0.97616816, 'recall': 0.97844964, 'specificity': 0.99911827, 'f1': 0.9770226, 'auroc': 0.99991566}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     0    1    0     1     2     0    0      6
1     0  1313    0     0    0    0     0    19     0    0      0
2     0     0  308     0    1    0     0     0     0    2      0
3     0     1    0  8395    0    3     0    28    12    0      0
4     3     0    7     0  518    0     0     0     5    0      6
5     0     0    1     6    0  503     0     0     0   11      0
6     0     0    1     0    0    0  1900     1     2    0      3
7     0     0    0    35    1    0     0  7212    14    0      1
8     0     0    0    13    1    0     1    19  3259    0      3
9     0     0   22     1    0   18     0     0     1  451      0
10    0     0    3     3   19    0     2     4    25    2  12734
---- Validation: 
scalar performance:
{'acc': 0.9909589, 'precision': 0.971523, 'recall': 0.9779129, 'specificity': 0.99904954, 'f1': 0.97425866, 'auroc': 0.99991643}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    1    0     0     1     1    2      6
1     0  1307    0     1    0    0     0    23     0    0      1
2     0     0  312     0    0    0     0     0     0    0      0
3     0     0    0  8400    0   10     0    19    11    0      0
4     5     0    9     0  519    0     0     0     3    0      3
5     0     0    0     9    0  502     0     0     0   10      0
6     2     0    1     0    0    0  1898     2     0    0      5
7     0     0    1    34    0    0     0  7220     9    0      1
8     0     0    2    20    0    0     0    14  3257    2      1
9     0     0   28     1    1   15     0     0     0  448      0
10    0     0    2     4   30    0     2     9    34    2  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7283285, 'precision': 0.64770544, 'recall': 0.6131117, 'specificity': 0.9728141, 'f1': 0.60428023, 'auroc': 0.87695855}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   901    8    6  55   14    1    15    54    34   55    27
1     0  973    0  15    1    0     0   493     7    0    10
2     0    2  153   9  363   20     1    77   252   46    92
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    1   0  664    1     4     3    36    1   923
5     0    0    8  63    5  323     1     3    16  172     1
6     0    0    0   2    1    1  2959     6    55    0    43
7     0    0    0  10    0    0     0  1152     1    0     1
8     0    0    0  37    2    3     2    45  1279    1     1
9     0    0  169  50   28  164     0   125   159  424    18
10    0    0    0   0   59    0     1     1     3    0  1582
better model found
persisted
after epoch: 19,now: 2024-07-15 16:28:18.835706,epoch time: 0:38:49.418617,used: 11:03:58.746444,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9882277, 'precision': 0.9566604, 'recall': 0.975964, 'specificity': 0.99881643, 'f1': 0.9645642, 'auroc': 0.9999137}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    1     0    8    0     0     0     0    0      0
1     0  1322    0     1    0    0     0     9     0    0      0
2     0     0  296     0   14    0     0     0     0    1      1
3     0     1    1  8369    0    9     0     7    52    1      0
4     0     0    1     0  535    0     0     1     0    0      2
5     0     0    0     0    1  515     0     0     0    5      0
6     2     0    0     0    1    0  1903     0     0    0      2
7     0     0    3    61    3    0     2  7162    28    0      3
8     1     0    2    13   25    0     0     3  3244    0      5
9     0     0   46     0    6    7     0     0     0  434      0
10    2     1    0     5   96    0     3     1     3    0  12682
---- Validation: 
scalar performance:
{'acc': 0.98884577, 'precision': 0.9593536, 'recall': 0.9724773, 'specificity': 0.9988633, 'f1': 0.96451914, 'auroc': 0.9999095}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    7    0     2     2     2    0      5
1     0  1324    0     2    0    0     0     6     0    0      0
2     0     0  295     0   15    0     0     0     0    1      1
3     0     0    0  8387    0    4     0     5    44    0      0
4     0     0    1     0  533    0     0     0     2    0      3
5     0     0    2     0    0  513     0     0     0    6      0
6     0     0    0     0    0    0  1907     1     0    0      0
7     0     2    5    61    0    0     1  7161    32    1      2
8     1     0    2    13   25    0     0     5  3239    1     10
9     0     0   51     0    4    9     0     0     1  428      0
10    2     0    1     3   64    0     3     2     4    0  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6969845, 'precision': 0.6273997, 'recall': 0.5721569, 'specificity': 0.96975344, 'f1': 0.57431424, 'auroc': 0.86519516}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   955    14    1   92   31    0    17   14    24   15     7
1     1  1045    0   18    2    1     0  402    19    0    11
2     0     1   79   22  601    2     0   29   140   14   127
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    1  641    0     1    2    13    0   975
5     2     0   16   97   43  257     0    0    12  161     4
6     1     3    0    6    4    1  2946    0    47    0    59
7     0     0    0  223    0    0     0  937     3    0     1
8     0     0    1   62   18    4     0    2  1278    1     4
9     3     1  161  110  236   96     1   30   211  255    33
10    0     0    0    0   75    0     1    1     0    0  1569
early stop counter: 1
val acc:0.9888457655906677, best validation acc: 0.9909589290618896, corresponding to test acc:                         0.72832852602005 / 0.7696074843406677
after epoch: 20,now: 2024-07-15 17:02:35.090960,epoch time: 0:34:16.255254,used: 11:38:15.001698,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9902076, 'precision': 0.981162, 'recall': 0.9697448, 'specificity': 0.99885774, 'f1': 0.97501427, 'auroc': 0.99989736}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    0    0     3     0     0    0      2
1     0  1310    0     0    0    0     0    18     2    0      2
2     0     0  281     0    7    0     1     5     0   17      1
3     0     1    0  8378    0    9     3    33    13    0      1
4     7     0    4     0  466    0     2     0     1    0     59
5     0     0    0     0    0  518     0     0     1    2      0
6     0     0    0     0    0    0  1906     0     0    0      2
7     0     0    1    29    1    1     1  7208     8    0     10
8     1     0    1     3    6    4     5    10  3201    3     62
9     0     0    1     1    1    7     0     0     0  483      0
10    1     0    0     3    3    1     4     1     1    0  12781
---- Validation: 
scalar performance:
{'acc': 0.98943424, 'precision': 0.97524726, 'recall': 0.96675664, 'specificity': 0.9987925, 'f1': 0.9705265, 'auroc': 0.9998762}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    0    0     3     0     0    0      4
1     1  1310    0     0    0    0     0    18     1    0      2
2     1     0  278     0    6    0     0     3     0   23      1
3     1     0    2  8363    0   11     6    39    18    0      0
4     6     0    6     0  469    1     2     0     2    0     53
5     0     0    0     2    0  516     0     0     0    3      0
6     2     0    0     0    0    0  1903     0     0    0      3
7     4     0    1    28    1    0     2  7209     5    0     15
8     2     0    1     3    5    3     2     7  3214    6     53
9     1     0    1     0    0   17     0     0     0  473      1
10    2     0    0     6    2    0     6     1     0    0  12779
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7052403, 'precision': 0.62611985, 'recall': 0.5978815, 'specificity': 0.97019225, 'f1': 0.5698546, 'auroc': 0.8634252}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1018     3   1  16    2    5    68    11     4   10    32
1      0  1010   0   6    0    4     8   400    17    1    53
2      8     0  77   8  239   37    11    42   150   63   380
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0  108    0     2     1     8    0  1513
5      3     0   3  35    4  378     7     1     9  137    15
6      0     0   0   1    0    1  3032     0     4    0    29
7      0     0   0  38    0    1     2  1119     2    0     2
8      1     0   0  28    4   12    26    29  1249    3    18
9     13     1  58  41   24  248    11    88   114  447    92
10     0     0   0   0    1    0     3     0     0    0  1642
early stop counter: 2
val acc:0.9894342422485352, best validation acc: 0.9909589290618896, corresponding to test acc:                         0.72832852602005 / 0.7696074843406677
after epoch: 21,now: 2024-07-15 17:35:34.526281,epoch time: 0:32:59.435321,used: 12:11:14.437019,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9877194, 'precision': 0.9683792, 'recall': 0.9680562, 'specificity': 0.99865776, 'f1': 0.9680464, 'auroc': 0.9999011}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    4    0     0     2     0    0      6
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  272     0    6    0     0     3     0   31      0
3     0     0    1  8273    0    5     0   125    29    1      2
4     1     0    9     0  498    0     0     3     0    0     27
5     0     0    1     1    1  510     0     0     0    8      0
6    11     0    0     1    2    1  1881     2     0    0      9
7     0     1    1     7    0    0     0  7253     0    0      1
8     0     0    2    10   13    2     0    58  3191    0     20
9     0     0    6     0    0    9     0     0     0  478      0
10    3     0    2     0   22    0     1     4     0    0  12763
---- Validation: 
scalar performance:
{'acc': 0.98849803, 'precision': 0.9754374, 'recall': 0.9718225, 'specificity': 0.9987234, 'f1': 0.97338736, 'auroc': 0.9999206}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    1    0     0     1     0    0      8
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  275     0    5    0     0     4     0   28      0
3     0     0    1  8278    0    5     1   137    16    0      2
4     2     0    3     0  501    0     0     3     0    0     30
5     0     0    1     0    1  512     0     0     0    7      0
6    11     0    0     2    1    0  1884     3     0    0      7
7     0     1    0     6    0    0     0  7255     2    0      1
8     0     1    2     5    8    1     0    58  3202    1     18
9     0     0    2     2    0    4     0     0     0  485      0
10    1     0    4     0   18    0     0    10     2    0  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67809415, 'precision': 0.6390052, 'recall': 0.57388437, 'specificity': 0.96771574, 'f1': 0.56542325, 'auroc': 0.8631525}
confusion matrix:
     0    1    2    3    4    5     6    7     8    9     10
0   936    8    6   13   13    6     3   45    40   31    69
1     0  985    0   12    0    3     0  474    11    0    14
2     1    0  144    9  254    1     0  126   225   54   201
3     0    0    0    0    0    0     0    0     0    0     0
4     0    0    1    0  299    0     1    3    24    0  1305
5     3    0   11   53    8  279     1    1    17  199    20
6     3    0    0    1    6    2  2675   12   120    0   248
7     0    0    0  177    0    0     0  985     1    0     1
8     0    0    0   36    3    1     0   14  1311    3     2
9     5    0   85   54   26  102     0  123   238  447    57
10    0    0    0    0   14    0     0    0     1    0  1631
early stop counter: 3
val acc:0.9884980320930481, best validation acc: 0.9909589290618896, corresponding to test acc:                         0.72832852602005 / 0.7696074843406677
after epoch: 22,now: 2024-07-15 18:08:26.508006,epoch time: 0:32:51.981725,used: 12:44:06.418744,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9893782, 'precision': 0.9641044, 'recall': 0.9782918, 'specificity': 0.99891233, 'f1': 0.96993935, 'auroc': 0.99993885}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    4    0     1     1     0    0      1
1     0  1330    0     1    0    0     0     1     0    0      0
2     0     0  295     0   13    0     0     1     0    0      1
3     0     1    0  8332    0    4     0    74    26    0      0
4     1     0    0     0  534    0     0     0     1    0      3
5     0     0    0     0    0  516     0     0     1    4      0
6     6     0    1     2    0    0  1890     2     0    0      7
7     0     6    1    11    1    0     0  7239     3    0      4
8     0     2    0    11   17    0     0    17  3243    0      6
9     3     0   19     1    0   26     0     3     0  441      0
10    0     0    1     3  102    0     2     0     1    0  12683
---- Validation: 
scalar performance:
{'acc': 0.9891668, 'precision': 0.96481043, 'recall': 0.9798167, 'specificity': 0.99888945, 'f1': 0.971072, 'auroc': 0.9999252}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    5    0     0     0     1    0      3
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     1  296     0    9    0     0     3     1    2      0
3     1     0    0  8320    0    5     0    73    40    1      0
4     0     0    1     0  535    0     0     0     0    0      3
5     1     0    0     0    0  517     0     0     3    0      0
6     7     0    0     0    3    0  1891     1     0    0      6
7     0     4    0     6    3    0     0  7242     3    0      7
8     0     1    0     5   15    0     0    20  3242    2     11
9     1     0   17     1    0   21     0     1     0  452      0
10    0     0    0     0  109    0     1     1     3    0  12682
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71559507, 'precision': 0.64880824, 'recall': 0.6102142, 'specificity': 0.9714234, 'f1': 0.5879588, 'auroc': 0.87615204}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1059    10   0    9   10    2     1    25    18    5    31
1      0  1273   0    5    1    0     0   202     5    0    13
2     10     1  32   18  460    6     0    70   166   18   234
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  704    0     0     1     7    0   921
5     11     0   3  106    9  349     1     1    29   57    26
6      6     1   0    1   29    0  2608     6    75    0   341
7      1     0   0   15    0    0     0  1144     3    0     1
8      0     0   0   33    3    0     0    33  1297    1     3
9     27     4  43  148   67  168     1   184   183  204   108
10     0     0   0    0   87    0     0     1     0    0  1558
early stop counter: 4
val acc:0.989166796207428, best validation acc: 0.9909589290618896, corresponding to test acc:                         0.72832852602005 / 0.7696074843406677
after epoch: 23,now: 2024-07-15 18:42:09.483676,epoch time: 0:33:42.975670,used: 13:17:49.394414,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98895013, 'precision': 0.9589228, 'recall': 0.9647134, 'specificity': 0.9988834, 'f1': 0.96012646, 'auroc': 0.9998817}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     3    1    0     0     1     0    2      3
1     0  1325    0     1    0    0     0     6     0    0      0
2     0     0  255     0    2    0     1     0     0   54      0
3     0     0    0  8405    0    0     0    27     4    1      0
4     5     0   11     0  517    0     1     0     1    0      3
5     0     0    0    19    0  470     0     0     1   31      0
6     2     0    0     0    1    0  1901     2     2    0      0
7     0     1    0    32    0    0     1  7218    11    1      0
8     0     0    0    21    1    1     0     3  3266    0      4
9     0     0    2     1    0    1     0     0     0  489      0
10    3     0    2     2  109    0     9     5    16    2  12644
---- Validation: 
scalar performance:
{'acc': 0.989568, 'precision': 0.96116483, 'recall': 0.9667362, 'specificity': 0.9989533, 'f1': 0.962363, 'auroc': 0.9998926}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    2    0     1     2     1    0      3
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  257     0    3    0     1     0     2   49      0
3     0     1    0  8414    0    0     0    19     6    0      0
4     5     0    9     0  520    0     2     0     2    1      0
5     0     0    0    18    0  476     0     0     1   26      0
6     2     0    0     1    0    0  1901     2     1    0      1
7     0     2    0    27    0    0     0  7220    14    1      1
8     0     0    0    15    2    0     0     6  3271    0      2
9     0     0    1     0    0    4     0     0     1  487      0
10    2     0    1     4  112    0    10     7     9    1  12650
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69222695, 'precision': 0.65659535, 'recall': 0.56742275, 'specificity': 0.9692547, 'f1': 0.5554057, 'auroc': 0.8731244}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   947    9   1   16    3    0    22    99    41   19    13
1     0  734   0   20    0    0     0   715     7    0    23
2    15    1  46   38  287    4    17    93   269   76   169
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0  573    0     9     2    26    0  1023
5     8    0   3  140    1  190     8     3    26  204     9
6     1    0   0    3    2    0  2976     4    49    0    32
7     0    0   0   16    0    0     0  1146     1    0     1
8     0    0   0   76    0    1     7    56  1227    2     1
9    17    0  24  193   10   67    11   131   174  465    45
10    0    0   0    0   50    0     3     2     1    0  1590
early stop counter: 5
val acc:0.9895679950714111, best validation acc: 0.9909589290618896, corresponding to test acc:                         0.72832852602005 / 0.7696074843406677
after epoch: 24,now: 2024-07-15 19:15:34.185691,epoch time: 0:33:24.702015,used: 13:51:14.096429,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9876391, 'precision': 0.98120534, 'recall': 0.9624994, 'specificity': 0.99860764, 'f1': 0.97110105, 'auroc': 0.9999265}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     0    3    2     9     0     1    0     21
1     0  1325    0     0    0    0     0     3     2    0      2
2     0     0  299     0    6    0     1     0     3    3      0
3     0     1    0  8265    0    0     1    98    71    1      0
4     4     0    2     0  457    0     0     0     4    0     72
5     0     0    0     4    0  514     0     0     3    0      0
6     0     0    0     0    0    0  1898     0     0    0     10
7     0     3    0    14    1    0     0  7189    49    0      8
8     0     0    0     2    0    0     0     4  3282    0      7
9     0     0    9     2    0   29     0     0     0  451      2
10    0     0    0     2    0    0     0     0     3    0  12787
---- Validation: 
scalar performance:
{'acc': 0.9872944, 'precision': 0.98068047, 'recall': 0.96139616, 'specificity': 0.9985749, 'f1': 0.9703075, 'auroc': 0.9999196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     1    2    1     3     0     0    1     31
1     0  1327    0     0    0    0     0     3     2    0      0
2     0     0  298     0    5    0     1     0     2    5      1
3     0     3    0  8261    0    2     1   101    72    0      0
4     3     0    1     0  457    0     0     0    10    0     68
5     0     0    1     4    0  509     0     0     3    3      1
6     0     0    0     0    0    0  1903     1     1    0      3
7     0     5    1     8    0    0     0  7186    53    1     11
8     0     0    0     2    1    0     0     3  3284    0      6
9     0     0    5     4    1   28     0     0     1  453      1
10    1     0    0     0    0    0     0     0     7    0  12788
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64332193, 'precision': 0.5890907, 'recall': 0.5319006, 'specificity': 0.9640809, 'f1': 0.50436556, 'auroc': 0.85573685}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   705     6    3   25    1   29    55    25   105   23   193
1     0  1042    0    9    0    0     0   353    22    0    73
2     0     0   71   15  104    8     3    55   342   18   399
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0   52    0     2     1    25    0  1553
5     1     0   11  136    2  263     0     1    52   99    27
6     0     0    0    1    0    0  2780     2    62    0   222
7     0     0    0   24    0    0     0  1134     4    0     2
8     0     0    0   36    0    0     0    29  1304    1     0
9     1     0  117  135   12  111     1   106   349  200   105
10    0     0    0    0    1    0     0     1     0    0  1644
early stop counter: 6
val acc:0.9872943758964539, best validation acc: 0.9909589290618896, corresponding to test acc:                         0.72832852602005 / 0.7696074843406677
after epoch: 25,now: 2024-07-15 19:48:25.019548,epoch time: 0:32:50.833857,used: 14:24:04.930286,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9891642, 'precision': 0.9624567, 'recall': 0.96752876, 'specificity': 0.99888825, 'f1': 0.9629634, 'auroc': 0.9999153}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    2    0     0     0     1    0      5
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  307     0    3    0     0     0     1    1      0
3     0     6    0  8405    0    0     0    21     5    1      0
4     3     0   18     0  493    0     1     1    10    0     13
5     0     0    1     2    0  507     0     0     1   10      0
6     1     2    0     0    0    0  1905     0     0    0      0
7     0    87    1    42    0    0     1  7115    10    0      6
8     0     7    0    18    0    0     0     7  3256    0      6
9     0     0   76     0    0    5     1     0     1  408      2
10    2     0    0     1    7    0     2     3    10    0  12769
---- Validation: 
scalar performance:
{'acc': 0.98943424, 'precision': 0.9631237, 'recall': 0.9698578, 'specificity': 0.9989118, 'f1': 0.9645362, 'auroc': 0.9999196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    2    0     0     0     1    0      7
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  310     0    0    0     0     1     0    0      1
3     0     4    0  8412    0    3     0    17     4    0      0
4     4     0   10     1  507    1     0     0     5    0     11
5     0     0    2     1    0  508     0     0     1    9      0
6     2     1    0     2    0    0  1901     0     0    0      2
7     0    83    0    36    1    0     0  7133     8    0      4
8     0     3    0    28    1    1     0    15  3243    0      5
9     0     0   78     0    0    6     0     0     2  406      1
10    1     0    0     0   12    1     2     2    13    0  12765
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69614494, 'precision': 0.6428441, 'recall': 0.56834143, 'specificity': 0.969611, 'f1': 0.5591341, 'auroc': 0.87270963}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   988    18    3   44    2    1    22   21    31   16    24
1     0  1299    0    7    0    0     0  161    10    0    22
2     4     2  141   11  105    1     1   28   406   10   306
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    1    0  259    0     2    1    45    0  1325
5     2     0   24  123    2  185     1    0    39  188    28
6     1     0    0    4    0    0  2961    1    75    0    25
7     0     0    0  170    0    0     0  986     4    0     4
8     0     0    0   70    1    0     1    1  1296    1     0
9     8     3  243  122    8   51     0   32   343  211   116
10    0     0    0    0   19    0     2    0     1    0  1624
early stop counter: 7
val acc:0.9894342422485352, best validation acc: 0.9909589290618896, corresponding to test acc:                         0.72832852602005 / 0.7696074843406677
after epoch: 26,now: 2024-07-15 20:22:13.768121,epoch time: 0:33:48.748573,used: 14:57:53.678859,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9934985, 'precision': 0.9854909, 'recall': 0.97670233, 'specificity': 0.9992916, 'f1': 0.98096013, 'auroc': 0.99995315}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    3    0     5     0     0    1      5
1     0  1321    0     0    0    0     0     8     1    0      0
2     0     0  300     0    4    0     1     4     0    0      3
3     0     1    0  8385    0    0     0    13    37    0      3
4     2     0    3     0  496    0     0     2     9    0     27
5     0     0    0     2    0  508     0     0     3    7      1
6     2     0    0     0    0    0  1904     1     1    0      0
7     0     1    0    28    0    0     0  7219    13    0      1
8     0     0    0     6    1    0     0     2  3286    0      1
9     1     0   14     0    0    6     1     2     5  463      0
10    1     0    0     0    5    0     1     3     2    0  12782
---- Validation: 
scalar performance:
{'acc': 0.9939013, 'precision': 0.9859289, 'recall': 0.97986203, 'specificity': 0.9993389, 'f1': 0.98277897, 'auroc': 0.9999604}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    4    0     3     0     0    0      4
1     0  1319    0     1    0    0     0    11     0    0      1
2     0     0  307     0    1    0     0     1     1    1      1
3     0     0    0  8393    0    0     0    10    34    0      3
4     3     0    2     0  502    0     1     0     9    0     22
5     0     0    0     2    0  505     0     0     5    8      1
6     0     0    0     0    0    0  1906     0     1    0      1
7     0     0    0    29    1    0     0  7226     9    0      0
8     0     1    0     3    1    0     0     4  3285    0      2
9     0     0   14     0    1    5     0     4     4  465      0
10    2     0    0     0    8    0     1     3     5    0  12777
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67711467, 'precision': 0.6345038, 'recall': 0.5445513, 'specificity': 0.9675991, 'f1': 0.5285453, 'auroc': 0.8655332}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   854     7    3   46    1    1   143    33    49   14    19
1     1  1029    0   16    0    0     1   417     8    0    27
2    12     1  116   33   81    0     1    76   430   24   241
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  276    0     2     2    35    0  1318
5     9     0   26  129    2  116     3     1    47  251     8
6     0     0    0    1    0    0  2993     2    35    0    36
7     0     0    0   60    0    0     0  1099     1    0     4
8     0     0    0   39    1    0     4    31  1291    1     3
9    21     1  129  196    3   36     4   129   291  277    50
10    0     0    0    0   17    0     2     0     0    0  1627
better model found
persisted
after epoch: 27,now: 2024-07-15 20:54:57.747032,epoch time: 0:32:43.978911,used: 15:30:37.657770,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9879067, 'precision': 0.97159624, 'recall': 0.9751312, 'specificity': 0.998763, 'f1': 0.9730588, 'auroc': 0.9999239}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     0    0    0     1     0     1    0      0
1     0  1326    0     0    0    0     0     1     3    0      0
2     0     0  293     0    4    0     0     0     1   13      1
3     1     0    0  8311    0    4     0     5   119    0      0
4     6     0   20     0  498    0     0     0     6    1      6
5     0     0    0     2    0  515     0     0     3    1      0
6     0     0    0     0    0    0  1899     0     2    1      6
7     0     4    1    73    0    0     0  7105    80    1      0
8     0     0    1     1    0    0     0     1  3293    0      0
9     0     0    3     0    0   32     0     0     2  456      0
10    2     0    2     1    8    0     0     1    31    0  12747
---- Validation: 
scalar performance:
{'acc': 0.9887121, 'precision': 0.97355235, 'recall': 0.9761921, 'specificity': 0.99883527, 'f1': 0.9745889, 'auroc': 0.99992806}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    2    0     0     0     1    0      2
1     0  1328    0     0    0    0     0     1     3    0      0
2     0     0  297     0    5    0     0     0     0    9      1
3     0     0    0  8342    0    4     0     5    89    0      0
4     4     0   20     0  503    0     0     0     6    1      5
5     0     0    0     1    0  514     0     0     3    2      1
6     2     0    0     0    0    0  1894     1     1    0     10
7     0     5    1    70    0    0     0  7103    85    0      1
8     0     0    0     2    0    0     0     0  3294    0      0
9     0     0    3     0    0   32     0     0     1  457      0
10    2     0    2     1    6    0     1     3    27    0  12754
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6922969, 'precision': 0.6584445, 'recall': 0.5803425, 'specificity': 0.96902424, 'f1': 0.57261884, 'auroc': 0.8739248}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   719     6    3   66    2    4   151     9   125   37    48
1     2  1157    0    8    0    0     1   259    59    0    13
2     1     0  168   10  166   10     2    18   399   50   191
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  334    0     1     0    39    0  1256
5     0     0    5   82    1  334     2     0    42  115    11
6     0     0    0    0    1    0  2873     0   130    0    63
7     0     1    0  131    0    0     0  1005    25    0     2
8     0     0    1   16    0    0     0     1  1351    1     0
9     3     0   92   76    5  165     6    27   393  330    40
10    0     0    0    0   17    0     0     0     5    0  1624
early stop counter: 1
val acc:0.9887120723724365, best validation acc: 0.9939013123512268, corresponding to test acc:                         0.6771146655082703 / 0.7696074843406677
after epoch: 28,now: 2024-07-15 21:29:17.888727,epoch time: 0:34:20.141695,used: 16:04:57.799465,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9955854, 'precision': 0.98674875, 'recall': 0.984561, 'specificity': 0.99952173, 'f1': 0.98546576, 'auroc': 0.99997956}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     1    2    0     0     0     0    0      0
1     0  1327    0     1    0    0     0     2     0    0      0
2     0     0  301     0    3    0     1     0     0    7      0
3     1     0    0  8427    0    0     0    10     1    1      0
4     4     0    3     0  515    0     1     0     0    0     16
5     0     0    0     2    0  491     0     0     0   28      0
6     2     0    0     0    0    0  1904     0     1    0      0
7     0     0    0    24    0    0     0  7234     3    0      2
8     0     0    0    14    1    1     0    12  3263    0      4
9     0     0    2     1    0    0     0     0     0  490      0
10    3     0    1     0    5    0     1     0     4    0  12779
---- Validation: 
scalar performance:
{'acc': 0.994463, 'precision': 0.982824, 'recall': 0.9834678, 'specificity': 0.99940324, 'f1': 0.98297524, 'auroc': 0.9999679}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    2    0     0     0     0    0      1
1     0  1328    1     0    0    0     1     2     0    0      0
2     0     0  302     0    3    0     0     0     0    7      0
3     0     1    0  8420    0    2     0    14     1    2      0
4     3     0    3     0  513    0     0     0     0    1     19
5     0     0    0     5    0  491     0     0     0   25      0
6     2     0    0     1    0    0  1905     0     0    0      0
7     0     4    2    22    0    0     1  7232     2    0      2
8     0     0    1    23    9    0     0    16  3241    2      4
9     1     0    2     0    0    1     0     0     0  489      0
10    4     0    0     0    8    0     2     1     3    1  12777
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72343105, 'precision': 0.6391882, 'recall': 0.60408723, 'specificity': 0.9721656, 'f1': 0.5902622, 'auroc': 0.8702745}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1034     6    0  20    4    1    29    24    13   30     9
1      1  1124    0  13    1    0     5   327     7    0    21
2      9     1  122  11  275   13     4    45   158   88   289
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0  207    0     2     1    18    0  1404
5      3     0    6  40    4  224     0     1     6  302     6
6      1     0    0   1    0    0  3014     2    18    0    31
7      0     0    0  65    0    0     0  1096     1    1     1
8      0     0    0  56    5    5     8    22  1268    3     3
9     11     1  114  51   30  122     3    55    64  620    66
10     0     0    0   0   10    0     3     1     1    0  1631
better model found
persisted
after epoch: 29,now: 2024-07-15 22:04:25.807642,epoch time: 0:35:07.918915,used: 16:40:05.718380,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9940069, 'precision': 0.98596716, 'recall': 0.97999847, 'specificity': 0.99931645, 'f1': 0.98278487, 'auroc': 0.9999671}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    5    1     2     0     0    0     16
1     0  1330    0     0    0    0     0     0     2    0      0
2     0     0  310     0    1    0     0     0     0    0      1
3     0     0    0  8396    0    0     2    38     3    0      0
4     0     0    2     0  530    0     0     0     3    0      4
5     1     0    0    11    1  496     0     0     2    8      2
6     0     0    0     0    1    0  1881     0     0    0     26
7     0     3    0     5    0    0     0  7250     3    0      2
8     0     0    0    10    3    0     0    10  3258    0     13
9     0     0   17     3    0    9     0     1     2  461      0
10    1     0    1     2    4    0     0     1     2    0  12781
---- Validation: 
scalar performance:
{'acc': 0.9943293, 'precision': 0.98454046, 'recall': 0.98019826, 'specificity': 0.999358, 'f1': 0.98219025, 'auroc': 0.9999688}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    1     2    4    0     2     0     0    0     14
1     0  1330    0     0    0    0     0     1     0    0      1
2     0     0  306     0    1    0     0     1     0    3      1
3     0     0    0  8402    0    0     0    35     3    0      0
4     2     0    0     0  529    0     0     0     1    0      7
5     0     0    1     8    0  500     1     0     1   10      0
6     1     0    2     0    1    0  1879     1     1    0     23
7     0     0    0     2    0    0     0  7254     6    0      3
8     0     0    0    10    2    0     0     9  3264    0     11
9     0     0   22     1    0    4     2     0     0  464      0
10    0     0    0     1    8    0     0     1     1    0  12785
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6619324, 'precision': 0.6291635, 'recall': 0.5582683, 'specificity': 0.9661667, 'f1': 0.5412042, 'auroc': 0.85974187}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   905     3   2   76    5   11    49    46    27    2    44
1     0  1105   0   13    0    0     0   317     6    0    58
2     0     0  79   55  199    9     0    58   304   18   293
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  254    0     1     1    19    0  1358
5     0     0   9  165    6  291     3     2    24   85     7
6     0     0   0    3    0    0  2608     2    62    0   392
7     0     0   0   35    0    0     0  1127     1    0     1
8     0     0   0   72    0    0     4    28  1262    1     3
9     4     1  82  218   20  176     5   107   261  198    65
10    0     0   0    0   13    0     0     0     1    0  1632
early stop counter: 1
val acc:0.9943292737007141, best validation acc: 0.9944630265235901, corresponding to test acc:                         0.7234310507774353 / 0.7696074843406677
after epoch: 30,now: 2024-07-15 22:39:11.162623,epoch time: 0:34:45.354981,used: 17:14:51.073361,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:14:51.073361 at 2024-07-15 22:39:11.162623
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72343105, 'precision': 0.6391882, 'recall': 0.60408723, 'specificity': 0.9721656, 'f1': 0.5902622, 'auroc': 0.8702745}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1034     6    0  20    4    1    29    24    13   30     9
1      1  1124    0  13    1    0     5   327     7    0    21
2      9     1  122  11  275   13     4    45   158   88   289
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0  207    0     2     1    18    0  1404
5      3     0    6  40    4  224     0     1     6  302     6
6      1     0    0   1    0    0  3014     2    18    0    31
7      0     0    0  65    0    0     0  1096     1    1     1
8      0     0    0  56    5    5     8    22  1268    3     3
9     11     1  114  51   30  122     3    55    64  620    66
10     0     0    0   0   10    0     3     1     1    0  1631
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7696075, 'precision': 0.69683605, 'recall': 0.66650355, 'specificity': 0.97690487, 'f1': 0.64893484, 'auroc': 0.8902774}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1097    10    0  17    2    2     6    18     2   14     2
1      1  1337    0  16    0    0     0   131     4    0    10
2     27     2  215   7  167   31     2    79   318   68    99
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    5   0  495    0     2     2    25    1  1101
5      1     0    0  40    1  438     1     1    23   87     0
6      8     2    0   1    2    0  2923     9    76    0    46
7      0     0    0  11    0    1     0  1151     0    0     1
8      0     0    0  39    0    2     1    15  1312    0     1
9     10    18   99  68    5  202     0    60   252  416     7
10     0     0    1   0   26    0     1     1     1    0  1616
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_05_24_20_seed_1_21971820_instance_wise_predictions.txt
accuracy from prediction file 0.7234310501644161
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 322395 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool | 292563 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |  29832 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 322395 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool | 292563 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |  29832 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 315422 KiB |   3546 MiB |   2167 TiB |   2167 TiB |
|       from large pool | 286862 KiB |   3521 MiB |   2135 TiB |   2135 TiB |
|       from small pool |  28560 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3966 MiB |   3966 MiB |   7352 MiB |   3386 MiB |
|       from large pool |   3916 MiB |   3916 MiB |   7296 MiB |   3380 MiB |
|       from small pool |     50 MiB |     50 MiB |     56 MiB |      6 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 203940 KiB | 416257 KiB |   1600 TiB |   1600 TiB |
|       from large pool | 201005 KiB | 410766 KiB |   1568 TiB |   1568 TiB |
|       from small pool |   2935 KiB |  36862 KiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4298    |    8112    |  381529 K  |  381525 K  |
|       from large pool |     130    |     436    |  204798 K  |  204798 K  |
|       from small pool |    4168    |    7940    |  176730 K  |  176726 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4298    |    8112    |  381529 K  |  381525 K  |
|       from large pool |     130    |     436    |  204798 K  |  204798 K  |
|       from small pool |    4168    |    7940    |  176730 K  |  176726 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     189    |     189    |     331    |     142    |
|       from large pool |     164    |     164    |     303    |     139    |
|       from small pool |      25    |      25    |      28    |       3    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    1617    |  240073 K  |  240072 K  |
|       from large pool |      22    |     169    |  149236 K  |  149236 K  |
|       from small pool |      18    |    1593    |   90836 K  |   90836 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3546 MiB |   2167 TiB |   2167 TiB |
|       from large pool |  16640 KiB |   3521 MiB |   2135 TiB |   2135 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB |   3966 MiB |   7352 MiB |   6838 MiB |
|       from large pool | 493568 KiB |   3916 MiB |   7296 MiB |   6814 MiB |
|       from small pool |  32768 KiB |     50 MiB |     56 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 416257 KiB |   1600 TiB |   1600 TiB |
|       from large pool |  24320 KiB | 410766 KiB |   1568 TiB |   1568 TiB |
|       from small pool |      0 KiB |  36862 KiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8112    |  381529 K  |  381529 K  |
|       from large pool |       2    |     436    |  204798 K  |  204798 K  |
|       from small pool |       0    |    7940    |  176730 K  |  176730 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8112    |  381529 K  |  381529 K  |
|       from large pool |       2    |     436    |  204798 K  |  204798 K  |
|       from small pool |       0    |    7940    |  176730 K  |  176730 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |     189    |     331    |     293    |
|       from large pool |      22    |     164    |     303    |     281    |
|       from small pool |      16    |      25    |      28    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1617    |  240074 K  |  240074 K  |
|       from large pool |       4    |     169    |  149236 K  |  149236 K  |
|       from small pool |       0    |    1593    |   90838 K  |   90838 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3546 MiB |   2167 TiB |   2167 TiB |
|       from large pool |  16640 KiB |   3521 MiB |   2135 TiB |   2135 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB |   3966 MiB |   7352 MiB |   6838 MiB |
|       from large pool | 493568 KiB |   3916 MiB |   7296 MiB |   6814 MiB |
|       from small pool |  32768 KiB |     50 MiB |     56 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 416257 KiB |   1600 TiB |   1600 TiB |
|       from large pool |  24320 KiB | 410766 KiB |   1568 TiB |   1568 TiB |
|       from small pool |      0 KiB |  36862 KiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8112    |  381529 K  |  381529 K  |
|       from large pool |       2    |     436    |  204798 K  |  204798 K  |
|       from small pool |       0    |    7940    |  176730 K  |  176730 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8112    |  381529 K  |  381529 K  |
|       from large pool |       2    |     436    |  204798 K  |  204798 K  |
|       from small pool |       0    |    7940    |  176730 K  |  176730 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      38    |     189    |     331    |     293    |
|       from large pool |      22    |     164    |     303    |     281    |
|       from small pool |      16    |      25    |      28    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1617    |  240074 K  |  240074 K  |
|       from large pool |       4    |     169    |  149236 K  |  149236 K  |
|       from small pool |       0    |    1593    |   90838 K  |   90838 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820

 Experiment start at: 2024-07-15 23:16:43.104719
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9317209, 'precision': 0.84795046, 'recall': 0.7702519, 'specificity': 0.99241626, 'f1': 0.79055923, 'auroc': 0.99471796}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   342     0   0     7    0    1    10     8     4    4    107
1     0  1278   0    10    0    0     0    37     4    0      3
2     0     0  52     1  183    0     1    12     9   51      3
3     0     1   0  7592    1   15     2   640   186    1      0
4     1     0   2     0  310    1     0     3    23    7    192
5     1     0   1    41    6  334     0     0    11  125      2
6    10     3   1     2    3    1  1771     2    14    3     97
7     0    15   0    78    5    0     1  7088    62    1     15
8     0     1   0    74   27    3     0   115  3012    1     63
9     0     0  18     5   36   56     0     9    13  351      5
10    0     2   0     6   43    0     1    16    26    2  12694
---- Validation: 
scalar performance:
{'acc': 0.9306941, 'precision': 0.85546124, 'recall': 0.76722044, 'specificity': 0.9922793, 'f1': 0.78690267, 'auroc': 0.994584}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   336     0   0     7    0    0     9     9     3    9    110
1     0  1275   0    10    0    0     0    41     4    0      2
2     0     0  44     0  184    0     1    15     5   60      3
3     0     2   0  7564    0   12     1   672   184    4      1
4     1     0   1     1  307    1     0     6    26    9    187
5     1     0   0    38    5  333     0     1    11  130      2
6     7     2   0     6    5    0  1764     4    14    1    105
7     0    19   0    79    8    0     1  7082    57    1     18
8     0     0   0    71   20    3     1   102  3027    1     71
9     3     0  11    11   36   51     0     7     9  360      5
10    2     0   0     5   32    0     3    24    25    3  12702
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6198139, 'precision': 0.592823, 'recall': 0.537578, 'specificity': 0.96159375, 'f1': 0.5066586, 'auroc': 0.8694722}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1030     5   0   34    0    1    31    19    18    3    29
1      0  1230   0   25    0    0     0   220     9    0    15
2     12     0   2   12  113    0     3   116   235   55   467
3      0     0   0    0    0    0     0     0     0    0     0
4      1     0   0    0   30    0     0     2     8    0  1592
5     19     0   0  114    0  171     0     0    45  234     9
6      2     1   0    1    2    0  1908     8   107    0  1038
7      0     0   0   81    0    0     0  1078     1    0     4
8      0     0   0   36    1    0     0    13  1313    1     6
9     46     0   5   80   30   18     1   186   256  451    64
10     0     0   0    0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-15 23:52:16.936886,epoch time: 0:35:33.832167,used: 0:35:33.832167,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9419146, 'precision': 0.857821, 'recall': 0.8034878, 'specificity': 0.9938377, 'f1': 0.8141526, 'auroc': 0.9967865}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   353     0    0    12    1    5    59     1     8    5     39
1     0  1272    0    17    0    0     0    30    12    0      1
2     0     0  115     0   32   20     1     3    20  121      0
3     0     0    0  8205    0   31     0    51   149    1      0
4     1     0   14     0  333    4     3     3    50   13    118
5     0     0    0    12    0  498     0     0     7    3      1
6     2     0    0     7    1    3  1875     2     7    0     11
7     1     8    0   431    1    0     2  6603   203    6      8
8     0     0    0    77    5    8     1    27  3160    2     14
9     0     0    4     2    0  275     2     0    11  198      0
10    2     0    3     7   64    1    38    13    69    5  12593
---- Validation: 
scalar performance:
{'acc': 0.9407249, 'precision': 0.85091966, 'recall': 0.7993084, 'specificity': 0.99371785, 'f1': 0.8087449, 'auroc': 0.99692535}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   356     0    0     8    0    2    58     1    16    5     37
1     0  1267    0    15    0    0     1    35    12    1      1
2     0     0  106     1   36   19     2     2    19  127      0
3     0     0    0  8191    0   23     0    54   170    2      0
4     1     0   19     0  330    3     3     4    51   11    117
5     0     0    0    14    0  501     0     0     4    1      1
6     4     0    0     4    2    1  1880     1     7    0      9
7     0    11    1   430    2    0     5  6599   206    4      7
8     0     0    0    88    6    8     1    24  3153    1     15
9     0     0    5     5    0  281     3     0     9  190      0
10    3     0    1    11   66    1    36    18    60    4  12596
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.656825, 'precision': 0.678396, 'recall': 0.54609543, 'specificity': 0.9659283, 'f1': 0.5191362, 'auroc': 0.8861436}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   791     0   0  212   0    6    93   10    48    2     8
1     1  1177   0   58   0    0     2  205    45    0    11
2     3     0  20   12  23   25     4   50   634   58   186
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    0  57    0     2    4    33    0  1537
5     2     0   0  111   0  418     0    0    44   15     2
6     0     0   0    1   0    0  2976    3    61    0    26
7     0     0   0  405   0    0     1  750     5    0     3
8     0     0   0   53   0    1     0    3  1312    0     1
9     5     1   6  135   1  264     5   36   417  244    23
10    0     0   0    0   0    0     3    0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-16 00:27:06.524602,epoch time: 0:34:49.587716,used: 1:10:23.419883,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93926585, 'precision': 0.8590181, 'recall': 0.8335651, 'specificity': 0.99358916, 'f1': 0.8354838, 'auroc': 0.9975985}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     2    0    1    32     4     4    0      5
1     0  1264    0     6    0    0     0    57     4    0      1
2     3     0  148     0   71    8     7    27    11   33      4
3     0     0    0  7540    0   25    17   658   198    0      0
4     6     0    6     0  365    4    11     4    30    6    107
5     0     0    0    13    0  482     2     0    13    9      1
6     7     0    0     0    0    1  1895     0     4    0      1
7     1     8    0    31    1    0     1  7177    39    0      4
8     0     0    1    26   10    4     6    91  3141    0     15
9     9     0   40     1    5  192     2    14    13  217      0
10   51     0    1     5   65    2   142    32    54    1  12442
---- Validation: 
scalar performance:
{'acc': 0.94088537, 'precision': 0.86623096, 'recall': 0.8407466, 'specificity': 0.9937376, 'f1': 0.8433405, 'auroc': 0.99758005}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     0    0    0    31     4     2    1      7
1     0  1258    0     3    0    0     0    64     6    0      1
2     6     0  161     0   71    3     6    30     7   27      1
3     1     0    0  7565    0   26    19   643   186    0      0
4     7     0    5     0  367    4     8     5    26    2    115
5     3     0    0    12    0  484     1     0    11    9      1
6     4     0    0     0    0    0  1898     1     3    0      2
7     1     3    0    30    1    0     3  7180    43    0      4
8     1     0    0    30    7    4     3    87  3145    0     19
9    11     0   42     1    4  181     4    10    11  229      0
10   53     0    0     6   62    3   141    31    49    1  12450
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6749458, 'precision': 0.6356726, 'recall': 0.5651122, 'specificity': 0.9666145, 'f1': 0.5119303, 'auroc': 0.8861934}
confusion matrix:
     0    1   2   3    4    5     6     7     8   9     10
0   866    0   0  18    0    1   246    26    12   0     1
1     0  933   0  13    0    0     1   517    23   0    12
2    12    0   3   3  110   22   225    86   373  14   167
3     0    0   0   0    0    0     0     0     0   0     0
4     0    0   0   0  165    0    56     4    16   0  1392
5    12    0   0  65    0  434    25     1    52   2     1
6     0    0   0   0    0    0  3061     3     3   0     0
7     0    0   0  12    0    0     1  1148     2   0     1
8     0    0   0  13    1    1    13    13  1327   0     2
9    28    0   3  46    8  229   119   162   430  91    21
10    0    0   0   0    4    0    22     1     0   0  1619
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-16 01:01:25.529050,epoch time: 0:34:19.004448,used: 1:44:42.424331,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9616064, 'precision': 0.8852309, 'recall': 0.8953352, 'specificity': 0.99597055, 'f1': 0.88899636, 'auroc': 0.99811}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     3    0    1     3     0     1    1     14
1     0  1283    0     6    0    0     0    41     1    0      1
2     0     0  207     0   22    1     1     3     3   75      0
3     2     1    1  8136    0   13     0   200    78    5      0
4     6     0   26     0  403    2     0     1    17   18     66
5     0     0    0    18    0  464     0     0     1   37      1
6    26     0    1     0    1    2  1860     4     4    1      9
7     0     7    2    93    3    0     1  7102    51    0      5
8     4     0    1    75   13    6     1    62  3121    5      8
9     0     0   14     3    0   82     0     3     1  389      1
10   30     0    5     8  156    1     5     6    63    2  12516
---- Validation: 
scalar performance:
{'acc': 0.96252507, 'precision': 0.88985276, 'recall': 0.89785475, 'specificity': 0.9960418, 'f1': 0.8929006, 'auroc': 0.9980887}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    0    0     1     1     0    2     15
1     0  1283    0     9    0    0     0    38     1    0      1
2     2     0  217     0   15    1     0     2     2   71      2
3     1     0    0  8158    0   10     1   200    68    1      1
4     4     0   28     0  406    1     0     1    15   16     68
5     0     0    0    18    0  449     0     0     3   50      1
6    23     0    0     0    0    2  1867     1     4    1     10
7     0     6    1    83    6    0     1  7103    53    2     10
8     3     1    5    83    9    6     1    55  3114    4     15
9     1     0   11     3    0   81     0     2     1  393      1
10   25     0    3     6  150    2     9    11    58    1  12531
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75778353, 'precision': 0.69308, 'recall': 0.64566684, 'specificity': 0.97583383, 'f1': 0.6296882, 'auroc': 0.8907899}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1096     0    0   18    0    3    12    26    11    2     2
1      0  1166    0   20    0    0     0   291    10    0    12
2     40     0  106   16  113   18    10    62   412   93   145
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    1    0  730    0     2     1    31    0   865
5     10     0    0  104    1  413     2     0    17   44     1
6      2     0    0    0    0    1  3008     6    40    0    10
7      0     0    0   25    0    0     0  1136     2    0     1
8      0     0    0   42    0    2     1    25  1300    0     0
9     32     0   54  138    2  180     4   108   250  343    26
10     0     0    0    0  107    0     4     1     1    0  1533
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-16 01:35:24.037003,epoch time: 0:33:58.507953,used: 2:18:40.932284,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96468323, 'precision': 0.92033577, 'recall': 0.87994456, 'specificity': 0.9960651, 'f1': 0.8935194, 'auroc': 0.9987136}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     1    0     0    0    0     0     1     0    3     31
1     0  1303    0     4    0    0     0    19     2    0      3
2     0     0  191     0   36    0     1     1     1   76      6
3     0     1    0  8111    0    3     0   229    83    9      0
4     3     0    9     0  344    0     0     1     8    4    170
5     0     0    0    20    0  390     0     0     4  106      1
6    19     1    0     1    0    1  1851     6     4    4     20
7     0    19    2    59    1    0     1  7123    40    5     15
8     1     3    2    59   14    4     0    44  3092   20     57
9     0     0    9     1    1   23     0     0     0  458      1
10    4     0    0     9   12    0     2     6    11    3  12746
---- Validation: 
scalar performance:
{'acc': 0.964665, 'precision': 0.91706324, 'recall': 0.87773067, 'specificity': 0.99609154, 'f1': 0.8901815, 'auroc': 0.9986699}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     1    0     3    0    0     0     1     1    2     28
1     0  1301    0     5    0    0     0    18     4    0      4
2     0     0  176     1   42    1     1     1     2   85      3
3     0     0    0  8099    0    5     0   240    87    9      0
4     4     0   10     0  352    0     0     1     4    9    159
5     1     0    0    26    1  386     0     0     2  104      1
6    20     0    1     1    1    1  1855     2     3    1     23
7     0    17    0    48    1    0     1  7141    44    4      9
8     2     2    1    42   12    2     0    55  3111   14     55
9     0     0    8     2    0   19     0     0     0  464      0
10    5     0    3     4   21    0     4    10    15    2  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6957252, 'precision': 0.7008414, 'recall': 0.5804246, 'specificity': 0.9697316, 'f1': 0.5735349, 'auroc': 0.8754691}
confusion matrix:
      0     1   2    3   4    5     6    7     8    9     10
0   1044     1   0   71   1    0     1   23     6    7    16
1      0  1299   0   19   0    0     0  152    11    0    18
2      2     0  39   34  86    5     0   56   166  105   522
3      0     0   0    0   0    0     0    0     0    0     0
4      0     0   1    0  97    0     0    1     5    0  1529
5      2     0   0  255   2  209     1    0     8  110     5
6      5     0   0   13   0    0  2806    7    36    0   200
7      0     0   0  211   0    0     0  949     2    0     2
8      0     0   0   95   2    0     0    6  1254    2    11
9      3     1  11  215   4   52     0   76   106  604    65
10     0     0   0    0   2    0     0    1     0    0  1643
better model found
persisted
after epoch: 5,now: 2024-07-16 02:09:13.944390,epoch time: 0:33:49.907387,used: 2:52:30.839671,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96436214, 'precision': 0.9227152, 'recall': 0.8656339, 'specificity': 0.9960055, 'f1': 0.8862356, 'auroc': 0.998656}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     2    2    0    13     0     1    0     19
1     0  1296    0     8    0    0     0    25     2    0      1
2     0     0  165     3   80    1     1     9     5   44      4
3     0     0    0  8312    0    1     5    49    72    0      0
4     4     0    0     1  362    0     0     1    13    0    157
5     2     0    0    41    1  354     1     0    10  110      2
6     6     0    0     1    2    0  1833     0     6    0     60
7     5     7    0   228    1    0     2  6935    66    0     19
8     1     0    0    55    9    0     1    35  3171    0     24
9     2     0   14    11    6   13     0     1     5  437      4
10   14     0    0     7   14    0     1     6    15    1  12733
---- Validation: 
scalar performance:
{'acc': 0.96431726, 'precision': 0.9157948, 'recall': 0.8633539, 'specificity': 0.9960318, 'f1': 0.88121545, 'auroc': 0.99863064}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0    2    0     9     1     0    0     14
1     0  1295    0     4    0    0     0    26     6    0      1
2     1     0  152     2   86    1     1     8     7   50      4
3     0     0    0  8310    0    2     7    41    78    2      0
4     4     0    2     0  365    0     0     0    10    1    157
5     1     0    0    37    2  355     0     0     9  116      1
6     9     0    0     0    5    0  1829     1     4    0     60
7     1     8    0   211    2    0     4  6958    61    1     19
8     1     0    0    56    9    0     0    38  3166    1     25
9     0     0   15    11    8   17     1     1     6  432      2
10   12     0    0     7   21    2     2     6    14    0  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6189743, 'precision': 0.62443125, 'recall': 0.5292072, 'specificity': 0.96156347, 'f1': 0.5175393, 'auroc': 0.86843044}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   888     1   0   48    1    0   193    6     7    2    24
1     5  1152   0   16    0    0     0  286    10    0    30
2     6     0  19   22  311    6     9   68   247   32   295
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  119    0     0    2     8    0  1504
5     3     0   0  188   18  261     5    0    28   80     9
6     0     0   0    1    1    0  2198    1    27    0   839
7     0     0   0  179    0    0     2  978     2    0     3
8     0     0   0   68    2    0     2   16  1275    1     6
9     9     4  15  200   53   79    17  148   242  312    58
10    0     0   0    0    1    0     0    0     0    0  1645
early stop counter: 1
val acc:0.964317262172699, best validation acc: 0.9646649956703186, corresponding to test acc:                         0.6957252025604248 / 0.7577835321426392
after epoch: 6,now: 2024-07-16 02:43:23.149728,epoch time: 0:34:09.205338,used: 3:26:40.045009,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9731111, 'precision': 0.929582, 'recall': 0.90816426, 'specificity': 0.9970904, 'f1': 0.91816294, 'auroc': 0.99916685}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    1     3    0    0     0     2     1    5     45
1     0  1291    0     2    0    0     0    34     3    0      1
2     0     0  237     0   49    1     1     2     7   15      0
3     0     1    0  8285    0    3     0    91    57    1      0
4     3     0    3     0  449    0     0     3    14    1     65
5     0     0    0    28    1  453     1     0     7   30      1
6     4     0    0     0    1    0  1880     0     7    0     16
7     0     3    0    84    1    0     1  7138    34    0      3
8     0     0    0    40    4    0     0    50  3196    0      6
9     0     0   53     1    0   52     2     2     5  378      0
10    1     0    2     6   55    0     5    15    69    1  12638
---- Validation: 
scalar performance:
{'acc': 0.9746422, 'precision': 0.9333768, 'recall': 0.916849, 'specificity': 0.99726224, 'f1': 0.924518, 'auroc': 0.9992109}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     0    1    0     1     2     2    2     34
1     0  1297    0     2    0    0     0    30     3    0      0
2     0     0  243     0   48    0     1     5     3   12      0
3     0     0    0  8285    0    2     0    91    61    1      0
4     3     0    6     0  452    0     0     2    14    2     60
5     0     0    0    18    1  466     0     0     7   28      1
6     2     0    0     6    0    0  1882     1     7    0     10
7     0     2    0    96    1    0     1  7139    23    0      3
8     0     0    0    41    2    0     0    47  3199    0      7
9     0     0   52     1    0   48     0     1     8  383      0
10    0     0    3     9   61    0     4    10    58    1  12650
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7009725, 'precision': 0.67491645, 'recall': 0.5881654, 'specificity': 0.97018564, 'f1': 0.57962406, 'auroc': 0.88280725}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   964    1    0   55    3    2    30    54    27   12    22
1     0  971    0   23    0    0     0   486     9    0    10
2     0    0  124   15  204   13     2    66   378   49   164
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    2    0  406    0     1     5    30    0  1189
5     3    0    1  149    4  324     1     0    37   72     1
6     0    0    0    6    2    0  2929     7    63    0    60
7     0    0    0  127    0    0     0  1035     1    0     1
8     0    0    0   44    0    1     0    20  1305    0     0
9     4    0   49  146   10  126     0   112   340  338    12
10    0    0    0    0   21    0     0     1     1    0  1623
better model found
persisted
after epoch: 7,now: 2024-07-16 03:17:15.245971,epoch time: 0:33:52.096243,used: 4:00:32.141252,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97308433, 'precision': 0.93931097, 'recall': 0.9116551, 'specificity': 0.9970723, 'f1': 0.92079264, 'auroc': 0.9994216}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     1    0     0    0    1     2     0     1    2     22
1     0  1324    0     2    0    0     0     4     2    0      0
2     0     0  242     0    7    1     1     3     2   53      3
3     1     3    1  8222    0   16     0    49   146    1      0
4     2     0   17     0  327    1     1     1    32    7    151
5     0     0    0     3    0  466     0     0     4   47      1
6     7     1    0     2    0    0  1878     1     5    0     12
7     1    68    2    98    0    0     2  7005    72    0     14
8     0     0    1    13    2    2     0    10  3257    2      9
9     0     0   11     0    0   33     0     0     1  448      0
10    4     0    0     6    1    0     1     2    28    4  12747
---- Validation: 
scalar performance:
{'acc': 0.9722081, 'precision': 0.9388189, 'recall': 0.91022897, 'specificity': 0.99698037, 'f1': 0.9198431, 'auroc': 0.99939644}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     1    0     1    1    0     1     0     1    1     15
1     0  1324    0     2    0    0     0     5     1    0      0
2     0     0  234     0   14    1     1     3     1   56      2
3     0     2    1  8218    0   14     0    52   151    2      0
4     4     0   13     0  328    1     0     1    32    3    157
5     0     0    0     3    0  465     0     0     3   49      1
6     6     0    0     1    0    0  1885     0     2    0     14
7     2    79    0    97    1    0     1  6976    91    4     14
8     0     0    1    13    1    0     0    12  3256    2     11
9     0     0    8     1    0   36     0     0     1  446      1
10    2     0    1     7    0    0     1     2    29    2  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7113972, 'precision': 0.6958344, 'recall': 0.6070029, 'specificity': 0.9713433, 'f1': 0.588477, 'auroc': 0.88437206}
confusion matrix:
      0     1    2    3   4    5     6    7     8    9     10
0   1051     0    0   50   0   11     9    3    23   18     5
1      0  1341    0   25   0    2     0  102    18    1    10
2      3     0  119   25  28   25     5   33   383  104   290
3      0     0    0    0   0    0     0    0     0    0     0
4      0     0    1    0  57    1     1    1    40    0  1532
5      2     0    1   77   0  428     1    0    11   70     2
6      1     0    0    2   0    0  2965    0    42    0    57
7      1     1    0  386   0    0     0  766     7    0     3
8      0     0    0   58   0    3     0    3  1304    1     1
9      8     0   33  152   3  229     3   32   155  493    29
10     0     0    0    0   1    0     0    0     1    0  1644
early stop counter: 1
val acc:0.9722080826759338, best validation acc: 0.9746422171592712, corresponding to test acc:                         0.7009724974632263 / 0.7577835321426392
after epoch: 8,now: 2024-07-16 03:50:50.456492,epoch time: 0:33:35.210521,used: 4:34:07.351773,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97915775, 'precision': 0.95323044, 'recall': 0.92362165, 'specificity': 0.997679, 'f1': 0.93676805, 'auroc': 0.9994518}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     1    3    0     5     0     1    1     10
1     0  1318    0     2    0    0     0     7     2    0      2
2     0     0  240     1   25    0     0     6     3   33      4
3     0     4    0  8289    0    1     6    85    51    2      1
4     3     0    3     0  403    0     0     2    10    1    117
5     0     0    0    18    1  450     1     0     3   47      1
6     5     0    0     1    2    0  1887     0     0    1     12
7     0    11    0    52    1    0     6  7154    30    0     10
8     1     0    1    39    4    1     1    32  3200    0     16
9     0     0   13     1    4   23     1     2     0  448      1
10    3     0    0     6    6    0     4     5    20    1  12746
---- Validation: 
scalar performance:
{'acc': 0.9801257, 'precision': 0.95464283, 'recall': 0.9263974, 'specificity': 0.9977884, 'f1': 0.93921554, 'auroc': 0.99946374}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     2    4    0     5     0     1    0     11
1     0  1313    0     1    0    0     1    14     2    0      1
2     1     0  237     0   29    0     0     5     3   32      5
3     1     1    0  8307    0    2     5    77    45    1      1
4     4     0    4     0  415    0     0     2     9    0    105
5     0     0    1    21    1  461     0     0     5   31      1
6     4     0    0     0    3    0  1888     0     2    0     11
7     0    10    0    65    1    0     6  7151    26    0      6
8     0     0    0    44    5    0     0    31  3204    0     12
9     1     0   12     0    2   28     0     1     0  449      0
10    7     0    0     7    7    0     2     2    14    0  12757
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7129364, 'precision': 0.64829886, 'recall': 0.59695643, 'specificity': 0.9711344, 'f1': 0.5704621, 'auroc': 0.87914824}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1046     0   0   28    0    1    68    10    10    4     3
1      0  1256   0   13    0    0     0   196    19    0    15
2      3     0  41   11  122   10     9    32   376   49   362
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   1    0   51    0     2     1    31    0  1547
5      5     0   0  155    4  314     2     0    37   74     1
6      0     0   0    1    0    0  3040     1    13    0    12
7      0     0   0   95    0    0     1  1063     4    0     1
8      0     0   0   35    0    2     5    10  1316    1     1
9      8     1  27  118    7  128     3    45   333  420    47
10     0     0   0    0    1    0     1     1     0    0  1643
better model found
persisted
after epoch: 9,now: 2024-07-16 04:24:17.877901,epoch time: 0:33:27.421409,used: 5:07:34.773182,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97741866, 'precision': 0.9360083, 'recall': 0.9204963, 'specificity': 0.99756896, 'f1': 0.9221934, 'auroc': 0.99956894}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     0    1     1    5    0    18     1     0    0     59
1     0  1317    0     2    0    0     0    10     3    0      0
2     0     0  283     0   19    2     1     0     2    4      1
3     0     1    0  8274    0   16     0    95    51    0      0
4     0     0    6     0  489    0     1     0     7    0     36
5     0     0    0     2    0  507     0     0     6    5      1
6     0     0    0     1    0    0  1897     1     0    0      9
7     0     9    2    49    2    0     2  7155    30    0     14
8     0     0    0    40    4    1     0    40  3189    0     20
9     1     0   84     0    4   99     3     1     4  297      0
10    0     0    1     7   39    1     9     2     9    0  12726
---- Validation: 
scalar performance:
{'acc': 0.9767286, 'precision': 0.9315269, 'recall': 0.9150537, 'specificity': 0.9975115, 'f1': 0.9166592, 'auroc': 0.9995367}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    0     1    5    0    24     3     0    0     49
1     0  1312    0     4    0    0     1    12     3    0      0
2     0     0  278     0   21    0     3     1     2    5      2
3     1     0    0  8269    0   17     1    97    54    0      1
4     0     0    7     0  487    0     1     0     2    0     42
5     0     0    1     1    1  503     1     0     6    7      1
6     2     0    0     1    0    0  1896     2     1    0      6
7     0    12    0    47    1    0     1  7167    26    0     11
8     0     1    0    36    2    1     0    37  3197    0     22
9     1     0   86     1    2  111     5     0     8  279      0
10    0     0    2     8   42    0     8     3     7    0  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68816906, 'precision': 0.6439447, 'recall': 0.57183397, 'specificity': 0.96865624, 'f1': 0.5653811, 'auroc': 0.88018644}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   757     1    2  129    3    5   206    28     6    0    33
1     0  1182    0   17    2    0     0   269     5    0    24
2     0     0  162   17  300   11    24    28   186    5   282
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  336    0     4     1     5    0  1286
5     3     0    5  124   16  368     8     0    24   38     6
6     0     0    0    2    0    0  3010     1     4    0    50
7     0     0    0  156    0    0     0  1004     2    0     2
8     0     0    0   82    4    2    12    14  1252    0     4
9     0     0  311  154   37  176    40    45   191  138    45
10    0     0    0    0   18    0     1     0     0    0  1627
early stop counter: 1
val acc:0.976728618144989, best validation acc: 0.9801257252693176, corresponding to test acc:                         0.7129364013671875 / 0.7577835321426392
after epoch: 10,now: 2024-07-16 04:57:42.683662,epoch time: 0:33:24.805761,used: 5:40:59.578943,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9773117, 'precision': 0.93362665, 'recall': 0.9117639, 'specificity': 0.99753684, 'f1': 0.9189424, 'auroc': 0.9995267}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    2    5     3     0     0    2      5
1     0  1286    1     5    0    0     1    36     2    0      0
2     0     0  246     0    0    3     0     2     2   59      0
3     0     0    0  8360    0    9     1    56    12    1      0
4     5     0   43     0  379    1     0     5    15    8     83
5     0     0    0     2    0  515     0     0     1    2      1
6     1     0    0     1    0    1  1888     1     3    0     13
7     3     1    1    91    0    0     2  7140    18    2      5
8     0     0    1    90    2    2     0    43  3145    1     10
9     0     0    2     1    0  142     0     0     0  347      0
10    5     0    2     8    9    1     2     5     3    2  12757
---- Validation: 
scalar performance:
{'acc': 0.9785476, 'precision': 0.93681705, 'recall': 0.91371876, 'specificity': 0.9976601, 'f1': 0.92205334, 'auroc': 0.99949104}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     0    1    5     3     0     0    7      6
1     1  1289    0     4    0    0     0    35     1    0      2
2     0     0  247     0    1    4     0     1     1   56      2
3     0     0    0  8387    0    6     0    40     7    0      0
4     5     1   36     0  394    2     0     1     9    6     85
5     0     0    0     9    0  506     0     0     0    5      1
6     3     0    0     1    0    2  1894     2     0    1      5
7     1     3    0    83    0    0     1  7154    14    1      8
8     0     0    2    95    0    3     0    44  3140    1     11
9     0     0    3     2    0  136     0     0     0  352      0
10    5     0    3     5    8    0     2     9     4    1  12759
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67284685, 'precision': 0.65941274, 'recall': 0.57307816, 'specificity': 0.96739244, 'f1': 0.5587696, 'auroc': 0.8762445}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   746    0    0  140    1   49   117    29    23   33    32
1     0  939    0   35    0    0     0   496     5    0    24
2     0    0  133   40  109   22     3    63   208  129   308
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    5    0   94    0     0     3    18    0  1513
5     0    0    0  135    0  397     1     0    10   48     1
6     0    0    0   16    0    0  2878    10    16    0   147
7     0    0    0  109    0    0     0  1053     1    0     1
8     0    0    1  102    0    1     1    19  1241    1     4
9     0    0   37  196    2  228     2    54   104  493    21
10    0    0    0    0    2    0     0     1     0    0  1643
early stop counter: 2
val acc:0.9785475730895996, best validation acc: 0.9801257252693176, corresponding to test acc:                         0.7129364013671875 / 0.7577835321426392
after epoch: 11,now: 2024-07-16 05:31:03.078792,epoch time: 0:33:20.395130,used: 6:14:19.974073,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9823951, 'precision': 0.9448604, 'recall': 0.9516818, 'specificity': 0.9981788, 'f1': 0.9468157, 'auroc': 0.9997184}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     1     0     0    0      1
1     0  1319    0     1    0    0     0     9     3    0      0
2     4     0  258     0   38    0     1     1     3    6      1
3     4     2    0  8354    0    1     2    55    21    0      0
4     7     0    0     0  517    0     0     0     3    0     12
5     6     0    1     9    2  480     0     0     2   20      1
6     4     0    0     1    0    0  1900     0     0    0      3
7     1    19    0    50    3    0     2  7126    56    0      7
8     3     0    0    49   14    0     5     9  3198    0     18
9     9     0   21     0    4   29     2     2     7  418      0
10   26     1    0     7   71    1    11     3     2    0  12668
---- Validation: 
scalar performance:
{'acc': 0.98210514, 'precision': 0.94661754, 'recall': 0.9501569, 'specificity': 0.99812466, 'f1': 0.946936, 'auroc': 0.9997244}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     0    0    0     0     0     0    0      2
1     0  1319    0     3    0    0     0     9     1    0      0
2     3     0  253     0   49    0     0     1     3    3      0
3     4     1    0  8337    0    1     2    72    22    0      1
4     7     0    0     0  514    0     0     0     0    0     18
5     7     0    0     9    1  483     1     0     2   17      1
6     5     0    0     1    0    0  1898     0     1    0      3
7     1    14    0    67    2    0     3  7110    61    0      7
8     1     0    0    42   14    0     4     5  3206    0     24
9    12     0   24     0    4   28     2     0     5  418      0
10   18     0    1     5   61    0    12     2     0    0  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.713706, 'precision': 0.64593375, 'recall': 0.58806276, 'specificity': 0.97131044, 'f1': 0.5642222, 'auroc': 0.8805936}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1076     1   0   46    0    0    33    10     2    1     1
1      4  1240   0   15    1    0     0   218     8    0    13
2     53     0  23   19  305   13    23    42   243   12   282
3      0     0   0    0    0    0     0     0     0    0     0
4      3     0   0    1  372    0     3     1    10    0  1243
5     26     0   0  202    8  277     9     1    27   36     6
6      1     0   0    1    0    0  3047     3     4    0    11
7      0     0   0   44    0    0     2  1113     4    0     1
8      1     0   0   71    2    0    10    10  1268    0     8
9     72     1  34  199   34  112    35    78   367  161    44
10     0     0   0    0   19    0     3     0     0    0  1624
better model found
persisted
after epoch: 12,now: 2024-07-16 06:04:27.088651,epoch time: 0:33:24.009859,used: 6:47:43.983932,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.975412, 'precision': 0.94928163, 'recall': 0.9373831, 'specificity': 0.9974003, 'f1': 0.9395137, 'auroc': 0.99964666}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    1     0    4    0     2     1     2    1     14
1     0  1290    0     1    0    0     0    40     1    0      0
2     0     0  285     0    1    0     0     7     5   14      0
3     0     0    0  8101    0    0     0   230   105    2      1
4     0     0   12     0  485    1     0     2    18    2     19
5     0     0    0    16    0  362     0     0     9  133      1
6     2     0    0     1    0    0  1895     2     2    0      6
7     0     0    0    27    0    0     0  7198    32    1      6
8     0     0    0     7    1    0     0    28  3254    0      5
9     0     0   10     1    1    0     0     1     4  476      0
10    3     0    3     7   41    0     1    14    67    1  12653
---- Validation: 
scalar performance:
{'acc': 0.9752842, 'precision': 0.9525572, 'recall': 0.93988967, 'specificity': 0.99738175, 'f1': 0.94286776, 'auroc': 0.99968505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    5    0     2     0     2    2     12
1     0  1295    0     0    0    0     0    36     1    0      0
2     0     0  288     0    2    0     0     6     4   12      0
3     0     2    1  8077    0    1     1   250   106    2      0
4     0     0    9     0  482    0     0     3    21    2     22
5     0     0    1    14    0  373     0     0     5  127      1
6     0     0    0     1    0    0  1895     1     3    0      8
7     0     0    0    21    1    0     0  7213    26    0      4
8     0     0    0     4    0    0     1    36  3248    0      7
9     0     0   12     0    1    1     0     1     3  475      0
10    2     0    0     6   26    0     1     8    97    1  12655
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60896945, 'precision': 0.64736265, 'recall': 0.49809498, 'specificity': 0.960856, 'f1': 0.47271115, 'auroc': 0.867548}
confusion matrix:
     0    1   2    3    4   5     6     7     8    9     10
0   677    0   3   84    6   1   131    82    64   62    60
1     0  957   0   14    0   0     0   478    14    0    36
2     0    0  41   23   81   0     0    92   617   66    95
3     0    0   0    0    0   0     0     0     0    0     0
4     0    0   3    0  272   0     0     4   114    0  1240
5     0    0   0  217    4  55     0     2    84  228     2
6     0    0   0    7    0   0  2304    12   586    0   158
7     0    0   0   26    0   0     0  1133     2    0     3
8     0    0   0   51    0   0     0    21  1297    1     0
9     0    0  18  217    4   8     1   162   356  350    21
10    0    0   0    0   18   0     0     0    10    0  1618
early stop counter: 1
val acc:0.975284218788147, best validation acc: 0.9821051359176636, corresponding to test acc:                         0.7137060165405273 / 0.7577835321426392
after epoch: 13,now: 2024-07-16 06:38:27.665623,epoch time: 0:34:00.576972,used: 7:21:44.560904,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97463614, 'precision': 0.9458112, 'recall': 0.9251555, 'specificity': 0.9972226, 'f1': 0.9313125, 'auroc': 0.99967664}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     0    0    0     0     0     1    0     29
1     0  1320    0     2    0    0     0     5     4    0      1
2     1     0  277     0    1    1     1     0     1   30      0
3     0     0    0  8252    0   20     0    29   135    0      3
4     3     0   20     0  414    1     0     0     9    3     89
5     0     0    0     2    0  515     0     0     3    0      0
6     1     0    0     1    0    1  1871     0     0    0     33
7     6    10    3   119    0    0     1  6954   136    0     34
8     0     0    0    17    0    3     2     1  3252    0     21
9     0     0    5     0    0  140     0     0     1  345      2
10    1     0    1     6    4    1     0     0     4    0  12775
---- Validation: 
scalar performance:
{'acc': 0.975418, 'precision': 0.94558704, 'recall': 0.9290389, 'specificity': 0.997331, 'f1': 0.93357015, 'auroc': 0.9996907}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     0    0    0     2     0     2    0     28
1     1  1324    0     2    0    0     0     3     2    0      0
2     1     0  279     0    0    4     0     0     1   27      0
3     2     0    0  8248    0   14     1    25   147    1      2
4     4     0   19     0  430    1     0     0     6    2     77
5     0     0    0     4    0  516     0     0     1    0      0
6     3     0    0     1    0    2  1876     0     1    0     25
7     2     4    2   112    5    1     0  6959   143    0     37
8     0     0    0    16    0    5     0     0  3258    0     17
9     0     0    9     0    0  135     0     0     1  347      1
10    2     0    1     6    4    1     0     0     4    0  12778
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60106343, 'precision': 0.6602845, 'recall': 0.5393392, 'specificity': 0.96012807, 'f1': 0.52918494, 'auroc': 0.8732}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   873     0    1   94    1   34    27    6    31    4    99
1     3  1206    0   31    0    1     2  185    16    0    55
2     0     0  103   21   92   40     2   20   217   38   482
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  192    1     0    1    15    0  1422
5     2     0    0  106    2  436     0    1    12   25     8
6     0     0    0    4    1    2  1821    0    51    0  1188
7     0     0    0  346    0    0     0  793    22    0     3
8     0     0    0   86    2    5     1    5  1256    1    14
9     6     0   78  148    4  394     0   20   127  271    89
10    0     0    0    0    6    0     0    0     0    0  1640
early stop counter: 2
val acc:0.975417971611023, best validation acc: 0.9821051359176636, corresponding to test acc:                         0.7137060165405273 / 0.7577835321426392
after epoch: 14,now: 2024-07-16 07:14:11.740180,epoch time: 0:35:44.074557,used: 7:57:28.635461,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.988308, 'precision': 0.9637378, 'recall': 0.9702387, 'specificity': 0.99873817, 'f1': 0.9665536, 'auroc': 0.99984217}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    0    0     0     1     0    0      2
1     0  1324    0     0    0    0     0     7     0    0      1
2     0     0  304     0    4    0     0     1     1    1      1
3     0     3    0  8325    0   18     0    62    22    4      1
4     5     0    5     0  505    0     0     1     2    0     21
5     2     0    1     3    0  488     0     0     0   27      0
6     0     0    0     2    0    0  1903     0     2    0      1
7     0     2    2    27    0    0     0  7226     2    1      3
8     0     3    2    13    9    2     1    42  3192    0     32
9     1     0   42     1    0    7     0     1     0  440      1
10    3     0    1     4   18    0     7     3     6    0  12752
---- Validation: 
scalar performance:
{'acc': 0.9885248, 'precision': 0.9598917, 'recall': 0.97102654, 'specificity': 0.9987793, 'f1': 0.964905, 'auroc': 0.9998406}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    0    0     2     0     0    0      2
1     0  1324    0     0    0    0     0     8     0    0      0
2     1     0  306     0    0    0     0     1     1    3      0
3     0     3    0  8322    0   28     0    67    18    1      1
4     5     0    9     0  505    0     1     0     0    0     19
5     0     0    3     1    0  485     0     0     0   32      0
6     0     0    0     4    0    0  1900     2     0    0      2
7     0     1    2    24    0    0     0  7228     5    1      4
8     0     0    7    15   12    3     0    27  3206    2     24
9     2     0   37     0    0    8     0     1     1  444      0
10    5     0    2     5   18    0     3     3     3    0  12757
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7172042, 'precision': 0.66993964, 'recall': 0.59784734, 'specificity': 0.97182906, 'f1': 0.6021876, 'auroc': 0.8778236}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   941     4    0  114    1    1    23    62    11    7     6
1     0  1117    0   19    1    0     0   352     2    0     8
2    19     0  160   21  323   10     3    66   132   36   245
3     0     0    0    0    0    0     0     0     0    0     0
4     2     0    4    0  430    0     2     2    14    0  1179
5    10     0    3  133   11  251     1     4    16  162     1
6     2     0    0   14    0    0  2959    10    21    0    61
7     0     0    0   97    0    0     0  1066     0    0     1
8     0     0    0   63    5    2     1    49  1244    2     4
9    19     1  143  179   35   64     1   107    86  470    32
10    0     0    0    0   30    0     2     0     1    0  1613
better model found
persisted
after epoch: 15,now: 2024-07-16 07:50:44.158332,epoch time: 0:36:32.418152,used: 8:34:01.053613,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9847763, 'precision': 0.9500043, 'recall': 0.9551705, 'specificity': 0.9983973, 'f1': 0.9508426, 'auroc': 0.9997694}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0   13    0     0     0     0    0     13
1     0  1330    0     0    0    0     0     1     1    0      0
2     0     0  239     0   11    0     0     0     0   61      0
3     2     5    1  8290    0   26     4    52    54    4      1
4     0     0    4     0  527    0     0     0     1    1      6
5     1     0    0     0    0  515     0     0     0    5      0
6     1     0    0     0    3    2  1883     0     0    4     15
7     2    10    3    37    2    0     7  7173    14    2     12
8     1     0    0     5   20    2     1    12  3201    7     46
9     0     0    1     0    0   47     0     0     0  445      0
10    1     0    2     6   36    0     0     1     0    0  12747
---- Validation: 
scalar performance:
{'acc': 0.98411125, 'precision': 0.9474927, 'recall': 0.95390314, 'specificity': 0.9983366, 'f1': 0.9485171, 'auroc': 0.9997644}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0   16    0     0     0     0    1      9
1     0  1325    0     0    1    0     0     3     1    1      1
2     0     0  240     0    5    1     0     0     0   65      1
3     2     2    0  8288    0   33     4    46    60    4      1
4     0     0    2     0  528    0     0     0     0    1      8
5     0     0    0     0    0  517     0     0     0    4      0
6     2     0    1     0    9    0  1879     0     0    2     15
7     2    13    3    35    4    0     5  7183    10    5      5
8     0     0    1     1   29    1     1    20  3186    3     54
9     0     0    0     0    0   53     0     0     0  440      0
10    1     0    0     6   38    1     0     1     0    1  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73854333, 'precision': 0.6860665, 'recall': 0.62855667, 'specificity': 0.97379345, 'f1': 0.6300391, 'auroc': 0.8807569}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   911     0    2   38   59   34    15    11     7   70    23
1     2  1280    0   11    1    3     0   169     6    4    23
2     0     0  123   20  419   11     1    35    84  117   205
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  471    0     2     1     4    1  1152
5     0     0    1   69    9  326     0     0     3  183     1
6     2     0    0    0    5    0  2860     2     4    1   193
7     0     0    0   99    0    1     0  1060     2    0     2
8     0     0    0   55   19    4     2    20  1239   11    20
9     0     0   65  133   45  110     1    27    57  680    19
10    0     0    0    0   39    0     0     0     0    1  1606
early stop counter: 1
val acc:0.9841112494468689, best validation acc: 0.9885247945785522, corresponding to test acc:                         0.717204213142395 / 0.7577835321426392
after epoch: 16,now: 2024-07-16 08:26:34.579513,epoch time: 0:35:50.421181,used: 9:09:51.474794,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9912243, 'precision': 0.97326696, 'recall': 0.96950823, 'specificity': 0.99904156, 'f1': 0.97038317, 'auroc': 0.99989957}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    0    1     1     0     0    1     12
1     0  1320    0     1    0    0     0    10     1    0      0
2     0     0  306     0    1    0     0     0     1    2      0
3     1     0    0  8380    1    6     0    27    22    0      1
4     5     0    9     0  476    1     0     0     4    0     44
5     0     0    0     1    0  513     0     0     0    6      0
6     1     0    0     0    0    0  1903     1     0    0      3
7     1     4    0    31    0    0     0  7202    22    1      3
8     0     0    0     7    1    0     0    10  3273    1      4
9     0     0   45     0    0   15     0     1     1  431      0
10    1     1    1     2    5    0     0     1     6    0  12776
---- Validation: 
scalar performance:
{'acc': 0.9909857, 'precision': 0.9738164, 'recall': 0.96963483, 'specificity': 0.9990069, 'f1': 0.9707774, 'auroc': 0.99991226}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    0    0     2     0     0    2     15
1     0  1324    0     0    0    0     0     7     1    0      0
2     0     0  309     0    0    0     0     1     1    1      0
3     1     0    0  8378    0    5     0    38    18    0      0
4     7     0    7     0  478    0     0     0     1    1     45
5     1     0    1     2    0  513     0     0     0    4      0
6     0     1    0     0    0    0  1898     1     1    0      7
7     0     5    0    39    0    0     0  7207    12    0      2
8     0     0    0     2    3    2     0     9  3276    1      3
9     0     0   44     0    0   16     0     0     0  433      0
10    3     0    0     3    5    0     0     4    13    0  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7066396, 'precision': 0.6638471, 'recall': 0.5893031, 'specificity': 0.97074735, 'f1': 0.587288, 'auroc': 0.8758447}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   844     5    5   94    4   35    70   25     8   58    22
1     0  1292    0   15    0    1     0  180     5    1     5
2     1     0  114   25  122    8     4   70   257   70   344
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    0  274    0     2    5    17    0  1332
5     0     0    4  116    3  299     0    0    14  150     6
6     0     0    0    4    0    0  2954    3    16    1    89
7     0     0    0  198    0    0     0  963     2    0     1
8     0     0    0   63    1    2     3   19  1276    3     3
9     2     1   95  189    6  115     2   77   155  463    32
10    0     0    0    0   20    0     2    1     1    1  1621
better model found
persisted
after epoch: 17,now: 2024-07-16 09:01:08.243768,epoch time: 0:34:33.664255,used: 9:44:25.139049,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98870933, 'precision': 0.9734937, 'recall': 0.96950305, 'specificity': 0.9987563, 'f1': 0.97112024, 'auroc': 0.99991584}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    5    0     0     0     0    0      0
1     1  1309    1     4    0    0     0    16     0    0      1
2     1     0  295     0    3    0     0     0     1   11      1
3     0     0    0  8410    0    3     0    24     0    0      0
4     3     0    5     0  505    0     0     0     5    0     21
5     2     0    0     4    1  514     0     0     0    0      0
6     5     0    0     5    0    0  1896     0     0    0      2
7     0     0    0    62    0    0     1  7199     1    0      1
8     0     0    0    81    1    0     0    38  3166    0      9
9     0     0   13     1    0   40     1     0     1  437      0
10   13     0    0     6   10    0     3     4    10    0  12746
---- Validation: 
scalar performance:
{'acc': 0.98876554, 'precision': 0.97293156, 'recall': 0.96915853, 'specificity': 0.99876887, 'f1': 0.970615, 'auroc': 0.9999027}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     2    5    0     0     0     0    0      1
1     0  1311    0     3    0    0     1    17     0    0      0
2     0     0  295     0    4    1     1     0     1   10      0
3     0     0    0  8414    0    2     0    24     0    0      0
4     2     0    5     0  513    0     0     2     2    1     14
5     0     0    1     3    0  513     0     0     1    2      1
6     2     0    0     1    0    0  1902     1     0    0      2
7     0     0    0    64    0    0     0  7199     1    0      1
8     3     0    0   105    1    1     2    25  3155    0      4
9     1     0   14     1    0   46     0     1     0  430      0
10    6     0    1     4   13    1     1     4     8    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.697964, 'precision': 0.66026163, 'recall': 0.5843833, 'specificity': 0.9700478, 'f1': 0.5850867, 'auroc': 0.8799581}
confusion matrix:
      0    1    2    3    4    5     6    7     8    9     10
0   1118    0    0   31    1    0    11    3     1    3     2
1      4  987    0   38    0    0     1  440    11    0    18
2     20    0  102   34  234   11    26   32   226   63   267
3      0    0    0    0    0    0     0    0     0    0     0
4      2    0    0    0  361    0     4    2    13    0  1251
5     16    0    0  122    4  347     3    0    11   82     7
6      5    0    0   10    0    0  3016    2     4    0    30
7      1    0    0  326    0    0     1  833     0    0     3
8      0    0    0  173    1    2     8    7  1177    0     2
9     28    0   93  178   16  153    15   39   161  412    42
10     0    0    0    0   19    0     4    0     0    0  1623
early stop counter: 1
val acc:0.9887655377388, best validation acc: 0.9909856915473938, corresponding to test acc:                         0.7066395878791809 / 0.7577835321426392
after epoch: 18,now: 2024-07-16 09:35:56.702866,epoch time: 0:34:48.459098,used: 10:19:13.598147,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98860234, 'precision': 0.96749175, 'recall': 0.97561693, 'specificity': 0.99880546, 'f1': 0.97134906, 'auroc': 0.99991333}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    6    0     1     1     0    0      0
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     1  283     0    5    1     0     0     0   22      0
3     0     0    0  8326    0   11     0    96     7    0      0
4     1     1    4     0  520    1     0     3     4    0      5
5     1     0    0     0    0  513     0     0     0    7      0
6     5     0    0     0    0    0  1898     3     0    2      0
7     0    18    0    16    0    0     1  7221     4    0      1
8     0     0    0    52    0    2     0    20  3215    1      3
9     0     0   12     0    0   13     0     0     0  468      0
10    6     5    0     5   48    1     6    13     8    0  12702
---- Validation: 
scalar performance:
{'acc': 0.9887388, 'precision': 0.97060645, 'recall': 0.9773493, 'specificity': 0.9988148, 'f1': 0.9737379, 'auroc': 0.9999026}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    6    0     0     1     1    0      0
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  281     0    4    1     0     4     2   19      1
3     0     1    0  8340    0    7     0    84     6    2      0
4     1     0    1     0  521    0     1     1     6    1      7
5     0     0    0     0    0  516     0     0     2    3      0
6     3     0    0     1    0    0  1901     1     0    0      2
7     0    20    0    15    0    0     1  7224     4    0      1
8     1     1    1    44    0    0     0    13  3230    0      6
9     3     0    6     0    0    9     0     0     1  474      0
10   14    13    2     5   42    1     7    26    14    1  12671
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74309105, 'precision': 0.6765084, 'recall': 0.627779, 'specificity': 0.97440636, 'f1': 0.6081264, 'auroc': 0.8817641}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   985     8   2   67    1    0    17    60    25    2     3
1     0  1330   0   12    0    2     0   148     4    0     3
2    19     6  82   32  159   28    12    88   368   73   148
3     0     0   0    0    0    0     0     0     0    0     0
4     0     3   1    0  462    0    11     8    41    0  1107
5     8     0   1  115    1  385     0     1    18   61     2
6     2     0   0    5    0    0  3031     2    25    0     2
7     0     0   0   12    0    0     0  1151     0    0     1
8     0     0   0   57    0    2     2    37  1271    0     1
9     9     5  51  182    3  243     1    83   221  326    13
10    0     3   0    0   34    0     3     3     4    1  1598
early stop counter: 2
val acc:0.9887387752532959, best validation acc: 0.9909856915473938, corresponding to test acc:                         0.7066395878791809 / 0.7577835321426392
after epoch: 19,now: 2024-07-16 10:11:12.503149,epoch time: 0:35:15.800283,used: 10:54:29.398430,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9859268, 'precision': 0.96236426, 'recall': 0.94462025, 'specificity': 0.9985254, 'f1': 0.95002306, 'auroc': 0.999874}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    5    0     1     0     0    0     10
1     0  1330    0     1    0    0     0     0     0    0      0
2     0     0  261     0   18    4     0     1     3   20      5
3     0     1    0  8341    1    6     0    28    49    0     12
4     0     0    0     0  497    1     0     0     7    0     34
5     0     0    0     0    0  520     0     0     1    0      0
6     3     0    0     0    0    0  1896     0     4    0      4
7     1    17    0    32    0    1     1  7132    70    0      9
8     0     0    0     9    0    1     0     3  3277    0      5
9     1     0    1     0    1  135     1     1     2  350      1
10    0     0    0     0    1    0     0     2    12    0  12779
---- Validation: 
scalar performance:
{'acc': 0.9862512, 'precision': 0.9624543, 'recall': 0.94606614, 'specificity': 0.99857414, 'f1': 0.950891, 'auroc': 0.99988526}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    6    0     2     0     2    0      5
1     0  1330    0     1    0    0     0     0     1    0      0
2     0     0  260     0   25    2     0     1     2   17      5
3     0     0    0  8351    1    5     0    32    43    0      8
4     0     0    0     0  505    0     0     0     9    0     25
5     0     0    1     1    0  519     0     0     0    0      0
6     0     0    0     1    0    1  1895     0     4    0      7
7     1    21    0    34    1    0     0  7129    71    0      8
8     0     0    0     5    0    0     0     4  3284    0      3
9     2     0    1     0    2  132     0     0     3  352      1
10    0     0    0     1    0    0     0     2    15    0  12778
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6906878, 'precision': 0.653763, 'recall': 0.58274615, 'specificity': 0.96897995, 'f1': 0.568936, 'auroc': 0.8745303}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   913     0   0   56    0    5    36    7    65    8    80
1     2  1261   0   20    0    1     0  171    19    1    24
2     0     0  30    9  138   19     1   12   317   54   435
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  195    0     2    0    30    0  1406
5     5     0   0   77    2  356     0    1    21  109    21
6     0     0   0    0    0    1  2818    0    64    0   184
7     0     0   0  232    0    0     0  913    18    0     1
8     0     0   0   34    0    3     1    5  1325    1     1
9     4     0  37  127   17  154     5   17   242  426   108
10    0     0   0    0   10    0     1    0     0    0  1635
early stop counter: 3
val acc:0.986251175403595, best validation acc: 0.9909856915473938, corresponding to test acc:                         0.7066395878791809 / 0.7577835321426392
after epoch: 20,now: 2024-07-16 10:44:44.011505,epoch time: 0:33:31.508356,used: 11:28:00.906786,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9924283, 'precision': 0.97681856, 'recall': 0.975435, 'specificity': 0.9991856, 'f1': 0.97581166, 'auroc': 0.9999217}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    4    0     0     0     1    0      1
1     0  1323    0     0    0    0     0     9     0    0      0
2     0     0  304     1    3    0     0     2     0    2      0
3     1     0    0  8412    0    0     0    17     8    0      0
4     3     0    1     0  519    0     0     0     1    1     13
5     0     0    0    15    0  483     1     0     3   19      0
6     0     0    0     0    0    0  1906     0     2    0      0
7     0     1    0    24    0    0     1  7236     0    0      0
8     0     0    0    23    6    0     0    44  3216    0      6
9     1     0   34     0    0    4     0     1     0  452      1
10    9     0    2     1    6    0     0     6     5    0  12766
---- Validation: 
scalar performance:
{'acc': 0.9917346, 'precision': 0.9723589, 'recall': 0.9710196, 'specificity': 0.99911296, 'f1': 0.9714012, 'auroc': 0.99991983}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    4    0     0     0     0    0      3
1     0  1324    0     0    0    0     0     7     0    0      1
2     0     0  297     0   10    0     0     2     0    2      1
3     1     0    0  8401    0    0     0    29     8    0      1
4     3     0    4     0  514    0     0     0     1    0     17
5     0     0    2    14    0  478     0     0     2   25      0
6     2     0    0     1    0    0  1902     0     1    0      2
7     0     2    0    25    0    0     1  7233     3    0      1
8     0     0    0    13    4    0     0    32  3239    0      8
9     0     0   35     0    0    7     0     0     1  449      1
10    7     0    1     0   11    0     1     6     7    0  12763
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6838313, 'precision': 0.62752235, 'recall': 0.5684496, 'specificity': 0.96843594, 'f1': 0.5530595, 'auroc': 0.8716684}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1023     5    2   24    3    2    15    58    24    8     6
1      0  1011    0   18    0    0     0   445     9    0    16
2      7     0  114   23  153   14     5    61   334   32   272
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    0  196    0     1     6    18    0  1411
5      7     0    6  149    2  233     0     2    26  166     1
6      2     0    0   29    0    0  2881     5    45    0   105
7      0     0    0   75    0    0     0  1087     1    0     1
8      0     0    0   71    0    0     1    26  1270    1     1
9     16     1  164  172   10   91     2   103   226  323    29
10     0     0    0    0    6    0     1     1     2    0  1636
better model found
persisted
after epoch: 21,now: 2024-07-16 11:19:27.615000,epoch time: 0:34:43.603495,used: 12:02:44.510281,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_23_16_43_seed_2_21971820
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
slurmstepd: error: *** JOB 21971820 ON supergpu02 CANCELLED AT 2024-07-16T11:34:04 DUE TO TIME LIMIT ***
