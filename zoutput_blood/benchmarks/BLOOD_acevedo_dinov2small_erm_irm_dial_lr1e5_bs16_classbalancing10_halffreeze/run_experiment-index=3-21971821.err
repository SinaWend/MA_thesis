Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 14 11:33:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821

 Experiment start at: 2024-07-14 12:01:04.749830
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9333262, 'precision': 0.8289251, 'recall': 0.827497, 'specificity': 0.9927754, 'f1': 0.81786376, 'auroc': 0.9951597}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     3    0    2     6     0     1    6     36
1     0  1288    0    15    0    1     0    13     8    1      6
2     1     0  202     0   19    1     1     1     2   74     11
3    20     2    3  8129    0  120     4    53    92   14      0
4     8     0   57     0  219    1     2     1    26   20    205
5     0     0    0    12    0  346     0     0     4  158      1
6    18     0    0     5    0    2  1849     1     5    8     20
7    28    66   42   504    2    0     1  6320   228   23     51
8     8     0    8   164    7   14     3    21  3019   14     37
9     2     0   44     3    0   31     0     1     3  404      5
10   23     0    8     7   11    0     9     3    47    4  12679
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.933904, 'precision': 0.83406675, 'recall': 0.8276081, 'specificity': 0.9928062, 'f1': 0.8204807, 'auroc': 0.9947881}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0     2    0    2     5     0     1    9     40
1     0  1289    1    16    0    0     0    15     6    1      4
2     3     0  205     0   17    0     1     1     2   74      9
3    17     5    2  8148    1  104     1    56    92   12      2
4     5     0   60     0  224    1     0     1    15   16    217
5     0     0    0    12    0  345     0     0     3  160      1
6    17     0    1     1    1    2  1851     0     7    6     22
7    31    68   36   520    1    1     2  6319   220   20     47
8     9     0   12   164    4   13     0    23  3023   10     38
9     0     0   48     3    0   36     1     0     3  399      3
10   17     0    4     7    9    0    10     6    51    5  12687
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70300144, 'precision': 0.6646055, 'recall': 0.5962958, 'specificity': 0.9701693, 'f1': 0.58958983, 'auroc': 0.88232934}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1085     0    2    6    0    1    29    1     7   30     9
1      2  1266    0   44    0    0     0  144     9    2    32
2     26     0  232   10  106    2    11   15   190   71   352
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0   47    0     3    0    13    0  1568
5     10     0    0   44    0  189     0    0     6  335     8
6      4     0    2    1    1    0  2698    0    19    1   341
7      3     0    1  202    0    0     0  949     6    0     3
8      2     0    1  103    0    2     2    1  1250    5     4
9     34     1  213   76    3   10     3   16    66  686    29
10     0     0    0    0    0    0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-14 12:46:26.160706,epoch time: 0:45:21.410876,used: 0:45:21.410876,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9503425, 'precision': 0.88493484, 'recall': 0.81936586, 'specificity': 0.9944438, 'f1': 0.8176295, 'auroc': 0.99704224}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   412     0    1     2   0    0     5     3     0    2     58
1     0  1287    0    11   0    1     1    27     2    0      3
2     1     0  271     0   0    2     1     2     6   16     13
3     1     0    3  8228   0   29     3    91    80    1      2
4     2     0  134     0  81    3     0     2    32    7    278
5     0     0    3    14   0  398     0     0     7   97      2
6     9     0    4     2   0    1  1870     1     3    0     18
7     1    11    8   232   0    0     2  6866   107    0     35
8     1     0    5   125   0    2     0    40  3078    0     44
9     0     0  131     5   0   58     0     1     7  286      5
10    4     0    5     6   0    2     7     5    21    0  12743
---- Validation: 
scalar performance:
{'acc': 0.9496857, 'precision': 0.88442194, 'recall': 0.8190533, 'specificity': 0.99438363, 'f1': 0.8167424, 'auroc': 0.99696416}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   412     0    1     1   0    0     9     1     2    1     56
1     0  1279    0    13   0    0     0    29     6    0      5
2     0     0  274     0   1    0     1     1     6   16     13
3     0     0    2  8218   0   29     1    95    92    3      0
4     1     0  138     0  79    2     2     3    28    5    281
5     0     0    9    13   0  399     0     0     4   94      2
6     8     0    1     1   0    2  1875     1     1    0     19
7     1     9    7   227   0    0     3  6870   116    1     31
8     0     1    6   124   0    2     0    40  3080    0     43
9     0     0  140     6   0   52     0     0     7  283      5
10    7     0    5     7   0    0     5     4    32    1  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68963826, 'precision': 0.67707443, 'recall': 0.5870131, 'specificity': 0.96864796, 'f1': 0.57118106, 'auroc': 0.87157875}
confusion matrix:
      0     1    2   3   4    5     6     7     8    9     10
0   1043     0    7  14   0    2    29     9     6   12    48
1      0  1190    0  20   0    0     1   240     8    1    39
2      1     0  267   2   1    4     2    18    95   12   613
3      0     0    0   0   0    0     0     0     0    0     0
4      0     0    3   0   3    0     2     0     7    0  1618
5      3     0   22  29   0  292     1     0    26  178    41
6      1     0    2   0   0    0  2768     0     6    0   290
7      0     0    0  75   0    0     1  1082     3    0     3
8      0     0    0  29   0    1     1    13  1310    1    15
9      1     1  567  22   0   33     1    32   128  257    95
10     0     0    0   0   0    0     0     1     0    0  1645
better model found
persisted
after epoch: 2,now: 2024-07-14 13:30:55.237527,epoch time: 0:44:29.076821,used: 1:29:50.487697,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9479613, 'precision': 0.87822056, 'recall': 0.82675767, 'specificity': 0.99445564, 'f1': 0.8286324, 'auroc': 0.9972906}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     2    0    0     1     4     2    0      4
1     0  1241    0    11    0    0     0    74     5    0      1
2    14     0  166     1   10    5     1     9    34   67      4
3     1     1    0  8177    0   13     0    94   152    1      0
4    35     0   23     0  150    1     0     5   104   10    211
5     3     0    0    23    0  459     0     0     9   26      1
6    31     0    1     2    0    1  1858     3     7    0      5
7     2     7    0   195    0    0     1  6958    93    0      6
8     5     0    0    58    0    0     0    36  3189    1      5
9    14     0    8     6    0  127     1     2    12  323      0
10  172     0    0     7    0    1     9    19   144    2  12440
---- Validation: 
scalar performance:
{'acc': 0.9481343, 'precision': 0.8762511, 'recall': 0.82985187, 'specificity': 0.99447465, 'f1': 0.83055294, 'auroc': 0.99733156}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     4    0    0     1     6     1    0      5
1     0  1242    0    16    0    0     0    66     7    0      1
2    14     0  172     0   17    4     1     8    22   70      4
3     0     0    0  8185    0   14     0    95   146    0      0
4    47     0   21     1  148    0     1     5    93    7    216
5     6     0    0    20    0  471     0     0     9   14      1
6    28     0    0     4    0    1  1865     1     5    1      3
7     2     6    0   205    1    0     1  6950    97    0      3
8     6     1    0    54    0    0     0    40  3193    1      1
9    15     0    8     5    0  121     0     2    18  324      0
10  181     0    2     9    1    1     8    15   147    2  12430
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69348633, 'precision': 0.63169223, 'recall': 0.5855005, 'specificity': 0.96917284, 'f1': 0.5418416, 'auroc': 0.8845207}
confusion matrix:
      0    1   2   3   4    5     6     7     8    9     10
0   1059    1   0  23   0    1     5    56    22    2     1
1      0  979   0  15   0    0     0   479    13    0    13
2     85    0  60   5  24    7     5    78   489   49   213
3      0    0   0   0   0    0     0     0     0    0     0
4      5    0   1   0  13    0     3     2    53    0  1556
5     19    0   0  70   0  338     1     2    58  104     0
6      3    0   0   2   0    0  2981     4    38    0    39
7      0    0   0  10   0    0     0  1149     4    0     1
8      0    0   0  15   0    0     2    21  1331    1     0
9     41    0  31  51   0   97     3   149   384  358    23
10     0    0   0   0   0    0     1     0     1    0  1644
early stop counter: 1
val acc:0.9481343030929565, best validation acc: 0.9496856927871704, corresponding to test acc:                         0.6896382570266724 / 0.7030014395713806
after epoch: 3,now: 2024-07-14 14:15:07.726068,epoch time: 0:44:12.488541,used: 2:14:02.976238,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9585563, 'precision': 0.8891637, 'recall': 0.8795789, 'specificity': 0.995437, 'f1': 0.8800894, 'auroc': 0.9983179}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     1    1    0     2     2     0    6     32
1     0  1284    0    11    0    0     0    28     1    3      5
2     0     0  195     0   31    0     0     1     0   83      2
3     3     1    1  8315    1   40     0    45    26    7      0
4     2     0   23     0  387    0     0     1     4   10    112
5     0     0    0     5    0  397     0     0     1  117      1
6    20     0    0     0    0    0  1863     1     0    6     17
7     1    10    4   245    6    0     1  6933    23   18     22
8     1     0    5   192   49   15     0    53  2873   21     86
9     0     0    9     1    1   28     0     1     1  452      0
10    9     0    1     6   64    0     3     8     6    6  12689
---- Validation: 
scalar performance:
{'acc': 0.95768356, 'precision': 0.8875798, 'recall': 0.8738859, 'specificity': 0.99534196, 'f1': 0.87550366, 'auroc': 0.9982988}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     1    2    0     0     1     0    8     28
1     0  1278    0     9    0    0     0    38     3    0      4
2     0     0  186     0   33    0     0     0     0   91      2
3     4     2    0  8322    1   35     0    51    21    4      0
4     3     0   21     0  387    0     0     0     4   12    112
5     0     0    0     8    0  386     0     0     1  125      1
6    20     0    0     3    2    1  1855     1     0    3     23
7     2     8    4   237    3    1     1  6946    23   15     25
8     3     0    1   204   54   11     0    52  2853   32     86
9     0     0    9     3    2   31     0     0     0  448      0
10    8     0    3     7   62    0     3     4     4    6  12699
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72853845, 'precision': 0.69697344, 'recall': 0.61623716, 'specificity': 0.97270906, 'f1': 0.6114891, 'auroc': 0.8852552}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   933     0   0   11    5    1     7    18     1  157    37
1     0  1082   0   13    1    0     0   355     4    2    42
2     1     0  86   11  508    4     1    50    62  144   148
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  579    0     0     1     3    1  1048
5     0     0   0   39    3  214     0     0     0  336     0
6     1     0   0    3   14    0  2750     3     8    2   286
7     0     0   0   17    0    0     0  1142     0    1     4
8     0     0   0  135   20    3     3    31  1154    7    17
9     0     0  34   43   27   44     0    82    18  868    21
10    0     0   0    0   40    0     0     1     0    0  1605
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-14 14:59:42.197014,epoch time: 0:44:34.470946,used: 2:58:37.447184,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9653521, 'precision': 0.91673386, 'recall': 0.8703965, 'specificity': 0.9961496, 'f1': 0.89009315, 'auroc': 0.99837637}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     2    0    0     5     4     2    1     34
1     0  1311    0     7    0    0     0    12     2    0      0
2     2     0  199     0   67    1     1     2     5   27      7
3     0     4    0  8225    0    7     0   101   100    1      0
4     3     1    4     0  287    0     1     4    17    1    221
5     1     0    0    15    2  429     1     0     2   70      1
6     2     1    1     1    0    0  1881     5     4    0     13
7     0    32    1   103    1    0     1  6987   131    0      7
8     0     2    1    39    3    1     0    16  3207    1     25
9     1     0   34     8    8   36     0     2     5  396      3
10    0     1    1     7    5    0     4     8    43    0  12724
---- Validation: 
scalar performance:
{'acc': 0.96635014, 'precision': 0.91708076, 'recall': 0.87219125, 'specificity': 0.99627656, 'f1': 0.8908845, 'auroc': 0.99839777}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     2    0    0     6     5     1    1     30
1     0  1313    0     4    0    0     0    13     2    0      0
2     0     0  199     1   59    1     1     4     3   36      8
3     0     5    0  8244    0   11     0    79   100    1      0
4     3     3    3     0  289    0     1     4    18    2    216
5     3     0    1    12    0  433     1     0     4   66      1
6     3     3    1     1    0    0  1885     3     1    0     11
7     0    27    0    98    1    0     1  7001   129    2      6
8     0     2    0    35    0    2     0    30  3205    1     21
9     1     0   35     6   13   35     1     0     4  395      3
10    2     1    0     9    3    0     6     5    43    2  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72867835, 'precision': 0.6466708, 'recall': 0.61093163, 'specificity': 0.9726452, 'f1': 0.59162766, 'auroc': 0.87809515}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   991     3   0  50    0    0    46    27    34    8    11
1     0  1403   0  12    0    0     0    76     5    0     3
2     2     1  47   9  251    7     5    60   288   61   284
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  109    0     1     1    18    0  1504
5     4     0   0  77    2  280     4     1    34  186     4
6     1     2   0   3    0    0  2981     0    35    0    45
7     0     2   0  94    0    0     0  1055    11    0     2
8     0     0   0  19    0    0     2     4  1344    1     0
9     4     7  65  76   43   51     4    80   215  560    32
10    0     0   0   0    0    0     0     1     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-14 15:44:04.807247,epoch time: 0:44:22.610233,used: 3:43:00.057417,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97150576, 'precision': 0.9206952, 'recall': 0.8900676, 'specificity': 0.99687374, 'f1': 0.9031341, 'auroc': 0.9989923}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     1    0     1    2    0     1     1     2    0     20
1     0  1313    0     6    0    0     0    11     1    0      1
2     1     0  187     0   80    1     1     7     4   30      1
3     0     2    0  8283    0   17     0    87    49    1      0
4     1     0    3     0  389    2     0     1     9    1    133
5     0     0    0    16    1  469     0     0     6   27      1
6     5     0    0     2    1    0  1888     0     3    0      9
7     0    20    0    95    3    0     2  7109    30    0      5
8     0     6    0    59   13    0     1    68  3119    0     29
9     1     0   34     1   11   68     1     1     7  369      0
10    4     1    0     6   20    0     5     7    16    2  12730
---- Validation: 
scalar performance:
{'acc': 0.97183365, 'precision': 0.9211109, 'recall': 0.88932586, 'specificity': 0.9969055, 'f1': 0.9025008, 'auroc': 0.9989564}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     2    2    0     2     0     3    1     18
1     0  1313    0     4    0    0     0    14     1    0      0
2     0     0  177     0   87    1     1     7     7   30      2
3     1     3    0  8299    0   15     0    83    37    2      0
4     3     0    5     1  383    0     0     0    11    1    135
5     0     0    0    16    0  469     0     0     3   32      1
6     5     0    0     0    1    0  1886     0     2    2     12
7     0    18    1    96    3    0     1  7099    41    0      6
8     1     3    0    62   10    0     0    65  3130    0     25
9     1     0   27     2    3   68     0     1     5  386      0
10    5     0    0     7   22    1     6     8    12    0  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73637444, 'precision': 0.6506757, 'recall': 0.6269392, 'specificity': 0.9734272, 'f1': 0.6052599, 'auroc': 0.88357806}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   946     1   0  39    3    2    69    63     8   32     7
1     0  1338   0   9    0    0     0   147     0    0     5
2     0     0  42   8  571   27     1    78   101   69   118
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  287    0     1     1     5    0  1339
5     2     0   0  52    2  412     0     3     9  112     0
6     0     3   0   5    2    0  3001     2     3    0    51
7     0     0   0  15    0    0     0  1147     0    0     2
8     0     0   0  63    4    5     4    55  1229    0    10
9     1     2  40  51   52  201     1   156   126  483    24
10    0     0   0   0    5    0     0     1     0    0  1640
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-14 16:28:48.968733,epoch time: 0:44:44.161486,used: 4:27:44.218903,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97174656, 'precision': 0.93468606, 'recall': 0.89651155, 'specificity': 0.99679303, 'f1': 0.9115281, 'auroc': 0.99906456}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     3    0    0     3     1     0    0      8
1     0  1286    0    12    0    0     1    32     1    0      0
2     3     0  263     0   24    1     3     3     1   11      2
3     0     0    0  8225    0    5     0   157    52    0      0
4     8     0   12     0  313    0     1     2     4    0    199
5     0     0    3    33    0  418     0     0     4   61      1
6    10     0    0     0    0    0  1893     0     0    0      5
7     0     3    0    47    1    0     1  7187    18    0      6
8     0     0    0    42    1    1     1    73  3135    0     41
9     2     0   49    11    0   31     1     5     1  391      2
10   19     0    1     7    1    1    12     5     7    0  12741
---- Validation: 
scalar performance:
{'acc': 0.9716196, 'precision': 0.93353724, 'recall': 0.8948635, 'specificity': 0.99677944, 'f1': 0.9101112, 'auroc': 0.9991104}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     3    0    0     1     3     1    0      9
1     0  1289    0     8    0    0     1    31     3    0      0
2     4     0  258     0   24    0     1     4     1   14      6
3     0     0    0  8229    0    4     0   159    48    0      0
4     9     0   10     1  308    0     4     1     7    0    199
5     0     0    2    31    0  428     0     0     4   55      1
6     7     0    0     1    0    0  1891     1     1    0      7
7     0     3    0    48    1    0     1  7191    17    0      4
8     1     0    4    40    1    0     2    65  3141    0     42
9     4     0   52     6    0   34     2     6     0  388      1
10   15     0    2    10    3    0    16     8     7    0  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6794235, 'precision': 0.6150625, 'recall': 0.5656188, 'specificity': 0.9678366, 'f1': 0.5456606, 'auroc': 0.8736328}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   982     0    0   63    0    0    17    91     4   10     3
1     0  1005    0   12    0    0     0   463     1    0    18
2     8     0   93   12  192    9     4   128   108   21   440
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0   52    0     2     1     7    0  1571
5     5     0    5  131    0  271     2     8    24  146     0
6     3     0    0    3    0    0  2963     6     6    0    86
7     0     0    0   13    0    0     0  1148     2    0     1
8     0     0    0   36    2    0     5    60  1243    1    23
9     5     0  150  153   17   55     7   273   105  309    63
10    0     0    0    0    0    0     0     1     0    0  1645
early stop counter: 1
val acc:0.9716196060180664, best validation acc: 0.9718336462974548, corresponding to test acc:                         0.7363744378089905 / 0.7363744378089905
after epoch: 7,now: 2024-07-14 17:17:13.464782,epoch time: 0:48:24.496049,used: 5:16:08.714952,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97225493, 'precision': 0.94075036, 'recall': 0.9081036, 'specificity': 0.9968804, 'f1': 0.9227763, 'auroc': 0.99929285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    0    0     1     1     0    1     11
1     0  1291    0     1    0    0     0    38     1    0      0
2     2     0  221     0   47    1     1     6     2   29      3
3     0     4    0  8242    0    1     0   162    26    0      1
4     7     0    1     0  404    0     0     2     4    2    119
5     0     0    0    13    0  459     0     0     2   46      1
6     9     0    0     0    1    0  1882     2     1    2     11
7     0    14    0    71    0    0     1  7162    11    0      5
8     0     0    0   132    3    1     0    86  3044    0     30
9     1     1   21     2    1   45     0     3     1  415      3
10    7     0    0     6   11    0     3     9     6    0  12751
---- Validation: 
scalar performance:
{'acc': 0.9728501, 'precision': 0.9387598, 'recall': 0.9044602, 'specificity': 0.99695325, 'f1': 0.91975355, 'auroc': 0.9992393}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    0    0     1     2     0    1     14
1     0  1293    0     0    0    0     0    38     1    0      0
2     1     0  213     0   54    1     1     4     1   33      4
3     0     4    0  8254    0    2     0   154    26    0      0
4     6     0    2     0  400    1     0     2     6    1    121
5     0     0    0    20    0  448     0     0     3   49      1
6    12     0    0     2    0    0  1881     0     2    0     11
7     0    16    0    57    1    0     1  7178     7    0      5
8     0     1    0   121    3    1     0    84  3059    0     27
9     0     0   24     3    1   36     0     5     1  421      2
10   11     0    0     4    6    0     2     9     6    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6539565, 'precision': 0.62722987, 'recall': 0.5561588, 'specificity': 0.9651388, 'f1': 0.53761184, 'auroc': 0.874688}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   886    0   0  40    1    0    29   180     5   18    11
1     0  817   0   9    1    0     0   631     4    0    37
2     3    0  37   7  314   10     3   118    95   44   384
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   1   0  244    0     0     2     5    0  1381
5     2    0   0  95    2  318     2    11    21  138     3
6     0    0   0   3    1    0  2612     6    13    0   432
7     0    0   0   1    0    0     0  1157     2    0     4
8     0    0   0  28    2    1     2    55  1258    1    23
9     4    0  50  59   41   92     0   303   142  377    69
10    0    0   0   0    5    0     0     0     0    0  1641
better model found
persisted
after epoch: 8,now: 2024-07-14 18:04:15.658965,epoch time: 0:47:02.194183,used: 6:03:10.909135,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97332513, 'precision': 0.92281854, 'recall': 0.9327621, 'specificity': 0.997142, 'f1': 0.9262625, 'auroc': 0.99941415}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     1    5     1    1    0    13     0     0    2     29
1     0  1313    0     0    0    0     0    16     3    0      0
2     0     0  293     0   13    0     0     2     0    4      0
3     0     3    1  8088    0   33     0   254    57    3      1
4     4     0   15     0  478    0     0     0     1    0     41
5     0     0    2     4    0  445     0     0     1   68      1
6     1     0    1     2    0    0  1892     1     2    1      7
7     0    11    5    20    3    0     1  7177    32    0     15
8     0     0    8    21   10    5     2    40  3169    1     38
9     0     0   66     2    1   19     0     5     1  399      0
10    2     0    2     4   75    0     4     4     6    0  12694
---- Validation: 
scalar performance:
{'acc': 0.9731176, 'precision': 0.9231868, 'recall': 0.9294424, 'specificity': 0.9971181, 'f1': 0.92468274, 'auroc': 0.9993985}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    3     0    7    1    12     2     0    2     32
1     0  1311    0     0    0    0     0    19     2    0      0
2     0     0  290     0   15    0     0     0     0    7      0
3     0     1    2  8090    0   18     2   261    64    2      0
4     3     0   14     0  474    0     0     0     4    0     44
5     0     0    2     3    0  451     0     0     0   64      1
6     1     0    1     1    0    1  1893     2     1    0      8
7     0     7    4    17    3    0     1  7176    43    2     12
8     0     2    8    22    9    4     1    42  3173    1     34
9     0     0   72     0    0   26     0     4     0  391      0
10    3     0    4     6   66    0     2     5     3    0  12707
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7303575, 'precision': 0.65665126, 'recall': 0.6097654, 'specificity': 0.9728277, 'f1': 0.60779274, 'auroc': 0.8830312}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   636     0   13   27    6   18   202   135     4  113    16
1     0  1265    0    8    1    0     0   213     3    0     9
2     0     0  217   17  319   15     6    73   193   27   148
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  647    0     2     2    16    1   964
5     0     0   11  121    0  323     2     4    11  120     0
6     0     0    0    5    2    0  2997     2    11    0    50
7     0     0    0    4    0    0     0  1160     0    0     0
8     0     0    0   31    1    1     5    50  1277    1     4
9     0     1  266   90    7  103     2   171   129  345    23
10    0     0    0    0   72    0     0     1     1    0  1572
better model found
persisted
after epoch: 9,now: 2024-07-14 18:56:41.489528,epoch time: 0:52:25.830563,used: 6:55:36.739698,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9772849, 'precision': 0.93541825, 'recall': 0.93393576, 'specificity': 0.99756455, 'f1': 0.93160003, 'auroc': 0.9996076}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    3    0     2     6     0    4      5
1     0  1317    0     0    0    0     0    12     1    0      2
2     0     0  292     0    4    0     0     1     0   15      0
3     1     5    0  8188    0   20     0   183    33    6      1
4     1     0   43     0  431    0     0     5     4    1     54
5     0     0    0     5    0  387     0     0     0  128      1
6     5     0    0     3    0    0  1885     6     5    1      2
7     0     6    2    35    0    0     1  7210     6    0      4
8     2     1    1    43    5    1     0    61  3156    3     23
9     0     0   25     0    0    3     0     0     0  465      0
10   10     0    2     5   21    0     9     7     5    0  12733
---- Validation: 
scalar performance:
{'acc': 0.97667515, 'precision': 0.93471235, 'recall': 0.9325372, 'specificity': 0.99749935, 'f1': 0.92980456, 'auroc': 0.9995992}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    4    0     4     3     0    2      7
1     0  1315    0     0    0    0     0    16     1    0      0
2     0     0  292     0    1    0     0     2     0   17      0
3     1     3    0  8181    0   12     0   206    28    9      0
4     3     0   52     0  419    1     1     1     6    2     54
5     0     0    0     2    0  388     0     0     1  129      1
6     7     0    1     2    0    1  1885     7     1    1      3
7     0     8    1    38    0    0     1  7208     4    1      4
8     2     1    2    34    4    0     0    68  3158    3     24
9     0     0   22     0    0    2     0     0     0  469      0
10   11     1    3     4   17    1     7     8     7    2  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72476035, 'precision': 0.6824459, 'recall': 0.6000457, 'specificity': 0.9722451, 'f1': 0.59238714, 'auroc': 0.88164973}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   697     1    1  37    1    3    62   183     9  166    10
1     0  1256    0   5    0    0     0   224     1    1    12
2     1     0  243   4  266    2     5    95    76   87   236
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    5   0  315    0     3     2     5    1  1302
5     0     0    2  42    2  140     0     4     6  396     0
6     0     0    0   9    0    0  2942    15    11    1    89
7     0     0    0   3    0    0     0  1160     0    0     1
8     0     0    1  21    2    0     3    79  1241    5    18
9     0     1  153  27    8   12     0   140    36  734    26
10    0     0    0   0   13    0     1     1     0    0  1631
better model found
persisted
after epoch: 10,now: 2024-07-14 19:40:18.526689,epoch time: 0:43:37.037161,used: 7:39:13.776859,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9842947, 'precision': 0.96355176, 'recall': 0.94613796, 'specificity': 0.9982615, 'f1': 0.9541818, 'auroc': 0.99972713}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     2     0     0    0      4
1     0  1300    0     3    0    0     0    26     1    0      0
2     0     0  265     0   13    0     1     2     2   26      3
3     0     1    0  8296    0    4     1    99    37    0      1
4     5     0    5     1  446    0     2     2     3    1     74
5     0     0    0     4    0  497     1     0     5   13      1
6     0     0    0     0    0    0  1898     2     3    0      5
7     0     2    0    33    1    0     1  7210    13    0      4
8     0     0    0    16    3    0     0    43  3216    0     17
9     0     0   13     2    6   43     0     0     1  428      0
10   14     1    0     5    4    0     1     3     8    0  12756
---- Validation: 
scalar performance:
{'acc': 0.9849137, 'precision': 0.96605384, 'recall': 0.949102, 'specificity': 0.998325, 'f1': 0.957043, 'auroc': 0.999723}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    1    0     2     2     1    0      4
1     0  1306    0     1    0    0     0    25     0    0      0
2     0     0  274     0    9    0     1     2     2   22      2
3     0     0    1  8305    0    2     1    97    34    0      0
4     3     0    4     0  446    0     1     0     2    1     82
5     0     0    0     5    0  500     0     0     3   12      1
6     2     0    0     0    0    0  1904     0     0    0      2
7     0     3    0    34    2    0     1  7203    18    0      4
8     0     0    1    19    4    0     0    35  3225    0     12
9     0     0   15     3    4   38     0     2     4  427      0
10    7     0    0     4    7    0    10     5     5    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7085986, 'precision': 0.61662525, 'recall': 0.58939904, 'specificity': 0.97042954, 'f1': 0.5717616, 'auroc': 0.869347}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   913     0    0  22    2    1    92    81    27   18    14
1     0  1247    0   9    0    0     2   227     7    0     7
2     2     0   68   2  386    7     8    52   148   25   317
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  170    0     5     2    11    0  1444
5     0     0    4  48   38  265     3     5    28  193     8
6     0     0    0   1    0    0  2978     2     7    0    79
7     0     0    0   4    0    0     0  1156     2    0     2
8     0     0    0  18    2    0     4    22  1311    1    12
9     1     2  152  27  111   72     6   124   202  383    57
10    0     0    0   0    7    0     2     0     0    0  1637
better model found
persisted
after epoch: 11,now: 2024-07-14 20:24:30.256872,epoch time: 0:44:11.730183,used: 8:23:25.507042,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.96294487, 'recall': 0.93782353, 'specificity': 0.99831116, 'f1': 0.9478493, 'auroc': 0.999714}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    0    0     1     3     0    0      6
1     0  1314    0     2    0    0     0    16     0    0      0
2     4     0  219     0    5    0     1    13     1   68      1
3     0     1    0  8378    0    0     0    27    33    0      0
4     7     0    3     1  467    0     1     4    13    2     41
5     1     0    0    16    0  496     0     0     1    6      1
6     1     0    0     4    0    0  1895     3     1    1      2
7     0     0    0    98    0    0     1  7156     6    0      3
8     0     0    0    31    2    0     0    20  3241    0      1
9     0     0    0     1    0   54     0     3     1  434      0
10    7     0    0     7    9    0    16    11    22    0  12719
---- Validation: 
scalar performance:
{'acc': 0.98360306, 'precision': 0.9590268, 'recall': 0.9393121, 'specificity': 0.9982417, 'f1': 0.94676113, 'auroc': 0.99968946}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    0    0     1     1     0    0      5
1     0  1317    0     1    0    0     0    14     0    0      0
2     4     0  219     0    6    0     1     6     2   73      1
3     0     0    0  8379    0    1     0    27    33    0      0
4     6     0    3     1  466    0     2     2    16    3     40
5     0     0    0    13    0  501     1     0     2    3      1
6     1     1    0     5    0    0  1894     2     1    0      4
7     0     1    0    92    0    0     1  7154    14    0      3
8     0     0    0    35    0    1     0    19  3235    1      5
9     2     0    1     2    1   49     0     1     0  437      0
10    9     0    0     6   23    0    23    15    25    1  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71013784, 'precision': 0.6716336, 'recall': 0.58871007, 'specificity': 0.970978, 'f1': 0.57311165, 'auroc': 0.8851251}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   961     0   0   31    0    0    52    97    10   16     3
1     0  1056   0   25    0    0     0   404     8    0     6
2     9     0  47   26  105   11    19   143   342   84   229
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  389    0     6     7    34    1  1195
5     5     0   0  132    0  249     1     4    36  165     0
6     0     0   0    7    0    0  2987     4    39    0    30
7     0     0   0    8    0    0     0  1153     2    0     1
8     0     0   0   46    0    0     1    33  1287    1     2
9     8     1  31  165    7   60     4   206   207  416    32
10    0     0   0    0   37    0     3     1     0    0  1605
early stop counter: 1
val acc:0.9836030602455139, best validation acc: 0.98491370677948, corresponding to test acc:                         0.7085986137390137 / 0.7363744378089905
after epoch: 12,now: 2024-07-14 21:08:27.990647,epoch time: 0:43:57.733775,used: 9:07:23.240817,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98426795, 'precision': 0.9500086, 'recall': 0.9372952, 'specificity': 0.9983337, 'f1': 0.93853974, 'auroc': 0.9997527}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     1    1    1     1     0     0    1     28
1     0  1318    0     1    0    0     0    12     0    1      0
2     0     0  189     0   21    0     0     0     0  102      0
3     0     0    0  8331    0   24     0    51    29    0      0
4     5     0    1     0  499    0     0     1     2    1     30
5     0     0    0     0    0  510     0     0     1   10      0
6     0     0    0     0    0    0  1898     0     1    2      7
7     0     3    0    57    0    0     1  7182    10    5      6
8     0     0    1    16    9    3     0    15  3231    4     17
9     0     0    0     0    0   33     0     0     0  460      0
10    0     0    1     3   60    0     2     3     3    1  12721
---- Validation: 
scalar performance:
{'acc': 0.98408455, 'precision': 0.9537641, 'recall': 0.9395119, 'specificity': 0.99828345, 'f1': 0.94241357, 'auroc': 0.9997609}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     2    2    0     2     0     0    0     27
1     0  1308    0     2    0    0     0    22     0    0      0
2     0     0  196     0   15    0     0     1     0   98      2
3     0     0    0  8336    0   16     0    62    26    0      0
4     2     0    3     0  496    1     0     0     2    2     33
5     0     0    0     0    0  513     0     0     1    7      0
6     2     0    0     0    0    0  1893     0     2    0     11
7     0     5    0    58    0    0     2  7186     5    2      7
8     0     0    1    18    3    1     0    18  3230    4     21
9     0     0    1     0    0   25     0     1     0  466      0
10    1     0    0     6   67    0     1     2     3    0  12716
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7155251, 'precision': 0.6772336, 'recall': 0.59800607, 'specificity': 0.9713373, 'f1': 0.5890223, 'auroc': 0.8862867}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   840    1   0  54    2    4    57    93    12   28    79
1     0  937   0  11    1    0     0   511     3    0    36
2     0    0  58   5  448    8     4    72   133   48   239
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   0   0  605    0     2     2     7    1  1016
5     1    0   0  78    5  286     1     5    19  193     4
6     0    0   0   2    1    0  2938     1     7    0   118
7     0    0   0   5    0    0     0  1154     3    0     2
8     0    0   0  21    4    0     2    28  1305    2     8
9     1    0  23  50   57   98     1   202   126  530    49
10    0    0   0   0   71    0     0     1     0    0  1574
early stop counter: 2
val acc:0.9840845465660095, best validation acc: 0.98491370677948, corresponding to test acc:                         0.7085986137390137 / 0.7363744378089905
after epoch: 13,now: 2024-07-14 21:52:41.299764,epoch time: 0:44:13.309117,used: 9:51:36.549934,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9834653, 'precision': 0.96140957, 'recall': 0.9497069, 'specificity': 0.99823123, 'f1': 0.9533802, 'auroc': 0.9998159}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     1    0    0     1     0     0    1      0
1     0  1326    0     0    0    0     0     5     0    0      0
2     2     0  230     0   16    0     1     0     0   62      1
3     0     0    0  8381    0    1     0    12    46    0      0
4     6     0    3     0  491    0     0     0     5    1     33
5     1     0    0    17    0  473     0     0     3   27      0
6     5     0    0     0    0    0  1900     0     1    0      2
7     0    23    0   184    0    0     0  7007    43    0      4
8     0     1    0    14    0    1     0     4  3272    0      4
9     1     0    2     2    0   12     1     0     2  473      0
10   16     1    0     6   15    0     2     2    23    2  12725
---- Validation: 
scalar performance:
{'acc': 0.98400426, 'precision': 0.9664665, 'recall': 0.95335674, 'specificity': 0.998278, 'f1': 0.9580293, 'auroc': 0.99981916}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     2    1    0     0     0     0    0      1
1     0  1323    0     1    0    0     0     8     0    0      0
2     1     0  243     0    9    0     0     0     2   57      0
3     1     4    0  8384    0    0     0    11    40    0      0
4     7     0    0     1  491    0     1     0     9    1     29
5     1     0    0    18    0  473     0     0     2   27      0
6     5     0    0     1    1    0  1897     0     2    0      2
7     2    19    0   180    2    0     2  7007    49    2      2
8     1     1    0    15    1    0     0     6  3264    0      8
9     0     0    0     4    0    8     0     2     3  476      0
10   10     0    0     6   13    0     5     3     9    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7253201, 'precision': 0.67724895, 'recall': 0.6016704, 'specificity': 0.9723618, 'f1': 0.5857829, 'auroc': 0.8812179}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1013     3   0   28    1    0    38    41    25   18     3
1      2  1234   0   10    2    0     0   238     3    0    10
2      8     0  74    7  220    6     9    52   352   63   224
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   1    1  310    0     6     0    18    0  1297
5      4     0   1  164    1  202     2     3    55  158     2
6      0     0   0    2    0    0  2959     0    16    0    90
7      0     0   0   14    0    0     0  1147     2    0     1
8      0     0   0   24    2    0     3    20  1315    1     5
9      6     1  34   83   12   55     4   108   315  484    35
10     0     0   0    0   14    0     0     1     2    0  1629
early stop counter: 3
val acc:0.9840042591094971, best validation acc: 0.98491370677948, corresponding to test acc:                         0.7085986137390137 / 0.7363744378089905
after epoch: 14,now: 2024-07-14 22:36:29.489259,epoch time: 0:43:48.189495,used: 10:35:24.739429,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9880672, 'precision': 0.96055937, 'recall': 0.95734894, 'specificity': 0.99877, 'f1': 0.956879, 'auroc': 0.99987304}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     0   10    0     0     1     2    5      9
1     0  1325    0     1    1    0     0     2     3    0      0
2     0     0  273     0    5    0     0     0     0   34      0
3     0     0    0  8356    0   20     0    27    25    8      0
4     0     0    1     0  511    0     0     0     2    0     25
5     0     0    0     0    1  426     0     0     0   94      0
6     2     0    0     0    1    0  1896     0     1    1      6
7     0    14    3    46    1    0     0  7168    24    5      2
8     0     0    0     9    3    1     0     6  3271    3      3
9     0     0    2     0    0    3     0     0     0  488      0
10    0     0    1     2   15    0     1     2    12    1  12760
---- Validation: 
scalar performance:
{'acc': 0.9882038, 'precision': 0.95929, 'recall': 0.95761764, 'specificity': 0.9987814, 'f1': 0.95649093, 'auroc': 0.99987406}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     2    7    0     1     0     0    6      8
1     0  1326    0     1    0    0     0     3     1    1      0
2     0     0  274     0    6    0     0     0     0   31      1
3     0     0    0  8346    0   25     0    28    35    6      0
4     0     0    2     0  511    0     0     0     1    0     25
5     0     0    0     0    0  425     0     0     1   94      1
6     0     0    0     1    4    2  1892     0     3    1      5
7     0     8    4    44    1    0     1  7182    12    9      4
8     0     0    0     6    5    2     0     8  3265    5      5
9     0     0    3     0    0    2     0     0     1  487      0
10    1     0    1     1   10    0     1     1     2    2  12777
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7209823, 'precision': 0.66704834, 'recall': 0.59713095, 'specificity': 0.971925, 'f1': 0.5842209, 'auroc': 0.8822488}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   535     0    0  46   21    3    22    76   143  295    29
1     0  1307    0  18    1    0     0   141    10   12    10
2     0     0  143   2  277    3     0    35   290  128   137
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  309    0     3     0    26    1  1290
5     0     0    1  27    3  222     0     2    22  315     0
6     0     0    0   3    1    0  2985     2    24    0    52
7     0     0    0  48    0    0     0  1108     3    2     3
8     0     0    0  14    2    2     0    11  1326   10     5
9     0     1   66  22   16   67     0    25   181  740    19
10    0     0    0   0   14    0     0     1     1    0  1630
better model found
persisted
after epoch: 15,now: 2024-07-14 23:21:54.805507,epoch time: 0:45:25.316248,used: 11:20:50.055677,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9880137, 'precision': 0.96949625, 'recall': 0.95263416, 'specificity': 0.9986787, 'f1': 0.9593804, 'auroc': 0.99986935}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     2    1    0     0     0     0    0      3
1     0  1326    0     1    0    0     0     4     0    0      0
2     0     0  283     1    5    0     0     4     0   17      2
3     0     0    0  8421    0    0     0    12     7    0      0
4     5     0    2     0  468    0     0     0     5    2     57
5     0     0    0     6    0  511     0     0     1    3      0
6     6     0    0     2    0    1  1885     3     4    0      6
7     0     3    0    74    0    0     0  7170     9    0      5
8     0     0    0    44    1    0     0    14  3231    0      6
9     0     0    2     0    0  101     0     1     1  388      0
10    8     0    1     4    2    0     2     1     7    0  12768
---- Validation: 
scalar performance:
{'acc': 0.9871874, 'precision': 0.97012657, 'recall': 0.95059264, 'specificity': 0.9985719, 'f1': 0.958856, 'auroc': 0.9998681}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     4    1    0     0     1     0    0      2
1     0  1324    0     3    0    0     0     5     0    0      0
2     0     0  275     0    5    6     0     1     1   23      1
3     0     0    0  8421    0    0     0    11     8    0      0
4     5     0    1     1  459    0     0     0     8    1     64
5     0     0    0     7    0  509     0     0     1    3      1
6     1     0    0     1    0    1  1897     0     1    0      7
7     1     5    0    96    0    0     0  7149     9    1      4
8     0     0    0    50    1    0     0    13  3222    0     10
9     0     0    2     0    0   88     0     0     0  403      0
10    6     0    1     3    2    0     0     2    10    0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6325474, 'precision': 0.6212521, 'recall': 0.5429455, 'specificity': 0.9634045, 'f1': 0.51856977, 'auroc': 0.8652435}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   795     1   0  120    2    4    21   121    44   39    23
1     0  1249   0   27    0    0     0   208     3    0    12
2     1     0  54   45  154   25     1    81   429   32   193
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  148    0     0     3    32    0  1450
5     0     0   0  196    0  313     0     4    21   57     1
6     0     0   0   26    0    0  2280     7   279    0   475
7     0     0   0   56    0    0     0  1104     1    0     3
8     0     0   0  107    0    0     1    35  1226    1     0
9     1     2  38  225   14  240     0   132   226  232    27
10    0     0   0    0    4    0     1     1     0    0  1640
early stop counter: 1
val acc:0.987187385559082, best validation acc: 0.9882038235664368, corresponding to test acc:                         0.7209823131561279 / 0.7363744378089905
after epoch: 16,now: 2024-07-15 00:11:59.252445,epoch time: 0:50:04.446938,used: 12:10:54.502615,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9889769, 'precision': 0.9731938, 'recall': 0.96940297, 'specificity': 0.9988177, 'f1': 0.9707966, 'auroc': 0.99990475}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     1    0     0    2    0    13     0     0    0      8
1     0  1327    0     0    0    0     0     4     1    0      0
2     0     0  307     0    3    0     0     0     0    1      1
3     0     0    0  8306    0    5     1    46    76    1      1
4     3     0    0     1  484    0     0     0     6    0     45
5     0     0    0     0    1  511     0     0     1    7      1
6     0     0    0     0    2    0  1901     0     1    0      4
7     0    14    4    30    3    0     0  7175    32    1      4
8     0     0    0     4    0    0     0     2  3285    0      5
9     0     0   25     0    1   28     0     0     0  439      0
10    3     0    0     2    8    0     2     1     7    0  12770
---- Validation: 
scalar performance:
{'acc': 0.98922026, 'precision': 0.97134584, 'recall': 0.9694804, 'specificity': 0.99885833, 'f1': 0.96992576, 'auroc': 0.99989676}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    3    0    10     0     0    0      5
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  304     0    7    0     0     0     0    1      0
3     0     1    0  8296    0    7     0    51    85    0      0
4     1     0    1     0  495    0     0     0     2    0     40
5     0     0    2     3    1  505     0     0     0   10      0
6     1     1    0     0    0    1  1903     1     1    0      0
7     1    12    2    25    2    0     0  7187    31    1      4
8     0     0    0     1    0    0     0     4  3284    0      7
9     0     0   28     0    1   31     0     0     1  432      0
10    1     1    0     2    7    0     2     0     2    0  12781
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68488073, 'precision': 0.6189047, 'recall': 0.5751358, 'specificity': 0.96806854, 'f1': 0.5628588, 'auroc': 0.86749256}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   768     1    4  48   11    8   128    77    37   49    39
1     0  1355    0  10    1    0     1   106    12    1    13
2     0     0  119   6  355    5     1    30   238    7   254
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  254    0     1     0    15    0  1362
5     1     0   15  70   17  237     1     4    47  191     9
6     0     0    0   1    2    0  2613     0    51    0   400
7     0     0    0   6    0    0     0  1153     4    0     1
8     0     0    0  16    2    0     1    16  1330    1     4
9     1     1  201  55   54   88     1    76   274  327    59
10    0     0    0   0   12    0     0     1     0    0  1633
better model found
persisted
after epoch: 17,now: 2024-07-15 01:00:29.102950,epoch time: 0:48:29.850505,used: 12:59:24.353120,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98517764, 'precision': 0.96505284, 'recall': 0.9618821, 'specificity': 0.99848926, 'f1': 0.962332, 'auroc': 0.9998363}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     0    0     0    3    0    57     0     0    0      8
1     0  1321    0     0    0    0     1     4     6    0      0
2     0     0  272     0   26    0     2     0     0   11      1
3     0     2    0  8276    0    1    11    67    83    0      0
4     2     0    0     0  528    0     1     0     1    0      7
5     0     0    0     6    0  503     0     0     2   10      0
6     0     0    0     0    0    0  1906     0     2    0      0
7     0     3    6    28    2    0     2  7147    70    0      6
8     0     0    0     8    3    1     0     2  3276    1      2
9     1     0    5     0    2    9     1     0     1  474      0
10    2     0    0     3   58    0    16     1     7    0  12704
---- Validation: 
scalar performance:
{'acc': 0.98411125, 'precision': 0.96221757, 'recall': 0.9580626, 'specificity': 0.99837756, 'f1': 0.9589288, 'auroc': 0.9997899}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    1     0    4    0    57     0     0    1     14
1     0  1325    0     0    0    0     0     3     4    0      0
2     0     0  268     0   23    1     3     0     1   16      0
3     0     2    0  8275    0    0     4    70    88    1      0
4     3     0    1     0  526    0     0     0     2    0      7
5     0     0    0     5    0  505     1     0     2    8      0
6     0     0    0     0    0    0  1906     0     1    0      1
7     0     2    5    30    3    0     3  7123    94    0      5
8     0     0    0    11    3    0     0     2  3279    0      1
9     2     0    4     1    1   16     0     0     0  469      0
10    3     1    1     3   56    0    18     0     5    0  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7207724, 'precision': 0.6586436, 'recall': 0.5895487, 'specificity': 0.9714433, 'f1': 0.58172476, 'auroc': 0.8809558}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   566     0   0  21    7    1   392    69    33   52    29
1     0  1233   0  17    1    0     3   224     9    0    12
2     0     0  94   5  425    7    10    54   191   46   183
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  584    0    11     2    15    0  1021
5     1     0   0  83    6  215    12     8    53  211     3
6     0     0   0   1    0    0  3013     2    20    0    31
7     0     0   0   1    0    0     1  1156     5    0     1
8     0     0   0  10    0    1     2    13  1343    0     1
9     0     1  74  43   38   76     4   132   224  496    49
10    0     0   0   0   40    0     3     1     0    0  1602
early stop counter: 1
val acc:0.9841112494468689, best validation acc: 0.9892202615737915, corresponding to test acc:                         0.6848807334899902 / 0.7363744378089905
after epoch: 18,now: 2024-07-15 01:48:01.634826,epoch time: 0:47:32.531876,used: 13:46:56.884996,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99347174, 'precision': 0.97884023, 'recall': 0.9851713, 'specificity': 0.99931735, 'f1': 0.9818849, 'auroc': 0.9999416}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    0     2     1     0    0      0
1     0  1328    1     1    0    0     0     2     0    0      0
2     0     0  308     0    2    0     0     1     0    1      0
3     0     0    0  8385    0    2     0    30    22    0      0
4     4     0    5     0  514    0     0     0     2    0     14
5     1     0    0     0    0  498     1     0     2   19      0
6     2     0    0     0    0    0  1903     1     0    0      1
7     0     4    2    14    0    0     0  7238     6    0      1
8     1     0    0     5    2    1     0    15  3263    2      5
9     0     0   11     0    0    0     0     0     0  480      0
10    5     0    2     1   29    0     3     8     9    0  12736
---- Validation: 
scalar performance:
{'acc': 0.99312556, 'precision': 0.9767058, 'recall': 0.9826517, 'specificity': 0.9992813, 'f1': 0.9795625, 'auroc': 0.9999444}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    0    0     0     1     0    0      3
1     0  1328    0     0    1    0     0     3     0    0      0
2     0     0  303     0    6    0     0     0     0    3      0
3     0     0    0  8382    0    5     0    30    22    0      1
4     3     0    7     0  516    0     2     0     1    0     10
5     0     0    0     0    0  492     0     0     1   28      0
6     0     0    0     0    0    0  1906     0     0    0      2
7     0     2    2    29    0    0     1  7222     8    0      1
8     1     0    1     4    6    0     0    11  3267    0      6
9     1     0    9     1    0    2     0     0     0  480      0
10    6     0    0     0   27    0     3     2     5    0  12753
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72224164, 'precision': 0.6438261, 'recall': 0.60011744, 'specificity': 0.97192144, 'f1': 0.58595026, 'auroc': 0.8780509}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   871     2   0  29    3    4   127    75    12   24    23
1     0  1319   0  14    1    0     0   145     5    0    15
2     1     0  84   8  388    9    13    49   230   36   197
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  313    0     5     1    16    0  1298
5     1     0   3  93    2  283     2     3    37  163     5
6     0     0   0   4    0    0  3019     3     6    0    35
7     0     0   0   9    0    0     0  1152     2    0     1
8     0     0   0  42    0    2     0    31  1289    1     5
9     2     2  83  80   47  107     2    84   327  363    40
10    0     0   0   0   12    0     2     1     1    0  1630
better model found
persisted
after epoch: 19,now: 2024-07-15 02:35:05.416886,epoch time: 0:47:03.782060,used: 14:34:00.667056,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9881475, 'precision': 0.9635491, 'recall': 0.9650705, 'specificity': 0.9988011, 'f1': 0.9626349, 'auroc': 0.9998504}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     1    4    0     2     0     0    1      2
1     0  1317    0     0    0    0     0    15     0    0      0
2     0     0  306     0    1    0     0     1     1    3      0
3     0     0    0  8417    0    4     1     8     7    0      0
4     3     0    6     0  507    0     0     1    15    0      7
5     0     0    0     0    0  411     0     0     3  107      0
6     0     0    0     0    0    0  1904     0     2    0      1
7     0    13    0    47    0    0     1  7194     7    0      2
8     0     0    0    16    1    0     0     8  3269    1      0
9     0     0   10     0    0    4     0     1     0  478      0
10    7     0    1     0   20    0     5     3    98    2  12657
---- Validation: 
scalar performance:
{'acc': 0.9886318, 'precision': 0.96500826, 'recall': 0.96886706, 'specificity': 0.99884015, 'f1': 0.9657292, 'auroc': 0.99986476}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    3    0     2     1     0    0      2
1     0  1321    0     1    0    0     0    10     0    0      0
2     0     0  307     0    1    0     0     0     2    2      0
3     0     1    0  8413    0    4     1    11     9    1      0
4     4     1    6     0  504    0     0     1    14    0      9
5     0     0    0     4    1  429     0     0     1   86      0
6     2     0    0     0    0    0  1903     0     1    0      2
7     0    23    0    49    0    0     0  7180     8    1      4
8     0     0    1    15    0    0     0     6  3274    0      0
9     0     0   11     1    0    0     0     0     1  480      0
10    7     0    2     0   28    0     0     6    79    0  12674
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72734904, 'precision': 0.66440135, 'recall': 0.6041626, 'specificity': 0.9727297, 'f1': 0.6030915, 'auroc': 0.8803512}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   737     1    2   61    3    5   102   144    15   94     6
1     0  1236    0   26    0    0     0   223     2    0    12
2     1     0  141   25  257   15     1   110   296   45   124
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  615    0     2     2    60    1   951
5     1     0    1  110    2  275     2     7    23  167     4
6     0     0    0    6    3    0  2990     2    50    0    16
7     0     0    0   29    0    0     0  1133     1    0     1
8     0     0    0   75    0    0     1    41  1252    1     0
9     1     1  115  130   22   96     2   126   167  455    22
10    0     0    0    0   76    0     3     1     4    0  1562
early stop counter: 1
val acc:0.9886317849159241, best validation acc: 0.9931255578994751, corresponding to test acc:                         0.7222416400909424 / 0.7363744378089905
after epoch: 20,now: 2024-07-15 03:22:01.217353,epoch time: 0:46:55.800467,used: 15:20:56.467523,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99240154, 'precision': 0.97612286, 'recall': 0.981232, 'specificity': 0.999179, 'f1': 0.978432, 'auroc': 0.9999379}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    1     0    3    0     1     1     0    0      2
1     0  1323    0     2    0    0     0     5     2    0      0
2     0     0  307     0    2    0     0     0     0    2      1
3     0     0    1  8413    1    1     0    16     5    0      1
4     3     0    4     0  523    0     0     0     0    0      9
5     0     0    2     4    0  490     0     0     0   24      1
6     1     0    0     0    1    0  1906     0     0    0      0
7     0     3    5    74    3    0     1  7166     6    0      4
8     0     0    3    21    9    0     0     6  3248    0      8
9     0     0   17     1    1    3     0     0     0  471      0
10    7     0    0     1   11    0     1     1     2    0  12770
---- Validation: 
scalar performance:
{'acc': 0.99245685, 'precision': 0.979329, 'recall': 0.9805902, 'specificity': 0.9991704, 'f1': 0.97987366, 'auroc': 0.99994385}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    3    0     0     0     0    0      4
1     0  1324    0     3    0    0     0     2     3    0      0
2     0     0  304     0    6    0     0     0     0    1      1
3     0     0    0  8414    1    1     0    19     4    0      1
4     1     0    2     0  520    0     0     0     1    0     15
5     0     0    0     4    0  493     0     0     0   24      0
6     0     0    0     0    0    0  1907     1     0    0      0
7     1     4    3    71    3    0     3  7168     6    1      5
8     0     0    1    15    8    0     0     5  3253    0     14
9     0     0   14     1    1    5     0     2     0  470      0
10    7     0    0     2    7    0     4     1     1    0  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7249003, 'precision': 0.6791276, 'recall': 0.5901469, 'specificity': 0.9724464, 'f1': 0.59850526, 'auroc': 0.8790117}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   674     1    6  146    3    1   141   112    15   61    10
1     0  1355    3   15    1    0     1   110     4    0    10
2     2     0  180   24  414    4     7    50    84   47   203
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  640    0     5     1     3    0   981
5     0     0    2  181    6  151     7     6    17  216     6
6     0     0    0    3    4    0  2972     2     5    0    81
7     0     0    0   51    0    0     0  1108     2    0     3
8     0     0    2   57   14    0     2    39  1251    1     4
9     0     1  150  165   25   32     3   146   119  441    55
10    0     0    0    0   52    0     4     1     0    0  1589
early stop counter: 2
val acc:0.99245685338974, best validation acc: 0.9931255578994751, corresponding to test acc:                         0.7222416400909424 / 0.7363744378089905
after epoch: 21,now: 2024-07-15 04:08:03.762286,epoch time: 0:46:02.544933,used: 16:06:59.012456,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9919467, 'precision': 0.9800361, 'recall': 0.97398853, 'specificity': 0.9991318, 'f1': 0.9765711, 'auroc': 0.9999462}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    3    0     0     0     0    0      1
1     0  1330    0     0    0    0     0     1     0    0      1
2     0     0  307     0    1    0     0     1     0    2      1
3     0     0    0  8348    0    0     1    42    46    0      2
4     5     0    9     0  487    0     0     0     6    0     32
5     0     0    0    25    1  484     0     0     2    8      1
6     2     0    0     0    0    0  1904     1     1    0      0
7     0     2    0     8    0    0     0  7230    20    0      2
8     0     0    0     1    0    0     0     1  3289    0      4
9     1     0   17     5    0    6     0     1     5  457      0
10   14     0    1     1    3    0     3     1    10    0  12760
---- Validation: 
scalar performance:
{'acc': 0.99149394, 'precision': 0.97662234, 'recall': 0.97259253, 'specificity': 0.99909127, 'f1': 0.9740749, 'auroc': 0.9999353}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    3    0     0     0     0    0      1
1     0  1328    0     0    0    0     0     3     1    0      0
2     0     0  307     0    1    1     0     0     0    1      2
3     0     0    0  8361    0    0     2    29    48    0      0
4     6     0   11     0  488    0     0     0     4    0     30
5     0     0    0    22    0  490     0     0     1    7      1
6     3     0    0     0    0    0  1903     0     0    0      2
7     0     2    0    11    0    0     0  7221    28    0      3
8     0     0    0     5    1    0     0     1  3283    0      6
9     0     0   25     2    0   10     0     2     8  446      0
10   12     0    0     2    7    0     2     3     9    0  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7162947, 'precision': 0.66877675, 'recall': 0.5888829, 'specificity': 0.97163, 'f1': 0.58301437, 'auroc': 0.87627953}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   889     0    3   44    1    0    29   111    76   12     5
1     0  1139    0   12    0    0     0   331     7    1     9
2     4     1  147   21  205    2     3   127   212   34   259
3     0     0    0    0    0    0     0     0     0    0     0
4     2     0    5    0  454    0     5     3    16    0  1148
5     4     0    4  191    0  194     2     7    36  152     2
6     1     0    0    8    0    0  3004     8    18    0    28
7     0     0    0    4    0    0     0  1158     1    0     1
8     0     0    0   34    1    0     0    41  1290    0     4
9     2     1  111  139    9   56     3   209   207  364    36
10    0     0    0    0   43    0     3     1     0    0  1599
early stop counter: 3
val acc:0.9914939403533936, best validation acc: 0.9931255578994751, corresponding to test acc:                         0.7222416400909424 / 0.7363744378089905
after epoch: 22,now: 2024-07-15 04:54:10.978271,epoch time: 0:46:07.215985,used: 16:53:06.228441,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99216074, 'precision': 0.9749997, 'recall': 0.97480583, 'specificity': 0.9991793, 'f1': 0.97457045, 'auroc': 0.9999317}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    2    0     1     0     1    0      1
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     0  290     1   17    0     0     1     1    2      0
3     0     3    0  8407    0    1     1    14    13    0      0
4     4     0    2     0  520    0     1     1     2    0      8
5     0     0    0     3    0  471     0     0     2   43      2
6     0     0    0     0    0    0  1906     0     1    0      1
7     0     5    0    42    0    0     0  7209     6    0      2
8     0     0    1    20    0    0     1    14  3255    0      3
9     0     0   12     0    0    2     1     2     1  475      0
10    2     0    0     1   30    0     1     9     6    0  12743
---- Validation: 
scalar performance:
{'acc': 0.9931523, 'precision': 0.9765522, 'recall': 0.9774373, 'specificity': 0.9992836, 'f1': 0.97684515, 'auroc': 0.99994105}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    1    0     2     0     0    0      3
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  293     0   11    0     0     0     2    4      2
3     0     6    0  8415    0    0     0     7    12    0      0
4     5     0    1     0  526    0     0     0     2    0      5
5     0     0    0     0    0  484     1     0     1   34      1
6     1     0    0     0    0    0  1906     0     0    0      1
7     0     5    0    35    1    0     0  7217     4    0      3
8     0     0    0    20    0    0     2     8  3260    0      6
9     2     0   17     0    0    4     1     2     0  467      0
10    1     0    0     1   24    0     1     7     7    0  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7091583, 'precision': 0.65092903, 'recall': 0.5743735, 'specificity': 0.97097695, 'f1': 0.5680472, 'auroc': 0.8782789}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   782     4   2  121    4    1    72   115    25   22    22
1     0  1202   0   14    0    0     0   268     8    0     7
2     2     0  59   26  290    2     4   177   257   27   171
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  658    0     3     9    29    0   934
5     0     0   8  161    3  179     5    11    24  197     4
6     0     0   0    4    1    0  3008     2    16    0    36
7     0     0   0   13    0    0     0  1149     1    0     1
8     0     0   0   54    0    0     2    74  1237    1     2
9     1     3  73  182   12   42     6   346   146  303    23
10    0     0   0    0   82    0     3     1     1    0  1559
better model found
persisted
after epoch: 23,now: 2024-07-15 05:39:40.307450,epoch time: 0:45:29.329179,used: 17:38:35.557620,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9927761, 'precision': 0.98304427, 'recall': 0.97715473, 'specificity': 0.99919385, 'f1': 0.9797199, 'auroc': 0.9999627}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    2    0     4     0     0    0     10
1     0  1294    0     2    0    0     0    35     0    0      0
2     0     0  306     0    0    0     0     0     0    5      1
3     0     0    0  8392    0    2     0    30    14    0      1
4     4     0   26     0  484    0     0     0     2    1     22
5     0     0    0     1    0  515     0     0     0    5      0
6     0     0    0     0    0    0  1904     2     0    0      2
7     0     0    0    19    0    0     0  7218    13    0     13
8     0     0    0    14    1    0     0    10  3268    0      3
9     0     0    4     1    0   10     1     0     0  477      0
10    0     0    1     1    1    0     1     1     4    0  12782
---- Validation: 
scalar performance:
{'acc': 0.9928849, 'precision': 0.9848071, 'recall': 0.97812057, 'specificity': 0.9992008, 'f1': 0.98120165, 'auroc': 0.99995875}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    2    0     2     0     0    0     13
1     0  1289    0     0    0    0     0    42     1    0      0
2     0     0  306     0    0    0     1     0     0    4      1
3     0     0    0  8405    0    3     0    22    10    0      0
4     4     0   18     0  491    0     0     0     3    0     23
5     0     0    0     3    0  516     1     0     0    1      0
6     0     0    0     1    0    0  1902     2     0    0      3
7     0     0    1    18    0    0     0  7222    16    0      8
8     0     0    0    19    2    1     0     8  3261    0      5
9     0     0    7     1    0    6     0     0     0  479      0
10    1     0    0     1    4    0     0     0     7    0  12783
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6708179, 'precision': 0.6575248, 'recall': 0.551773, 'specificity': 0.96699023, 'f1': 0.5380716, 'auroc': 0.8777778}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   659    0    1   20    2    2    62   201    36  111    76
1     0  980    0   10    0    0     0   493     3    0    13
2     0    0  187   16   44    9     3   181   267   63   245
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    9    0  218    0     4     5    35    1  1361
5     0    0    4  100    0  199     2    22    14  247     4
6     0    0    0    7    0    0  2909    13    78    0    60
7     0    0    0    5    0    0     0  1156     1    0     2
8     0    0    0   53    0    1     1    67  1246    1     1
9     1    0   68   88    3   84     0   317   136  411    29
10    0    0    0    0   18    0     2     2     1    0  1623
early stop counter: 1
val acc:0.9928848743438721, best validation acc: 0.9931523203849792, corresponding to test acc:                         0.7091583013534546 / 0.7363744378089905
after epoch: 24,now: 2024-07-15 06:25:15.441819,epoch time: 0:45:35.134369,used: 18:24:10.691989,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9893247, 'precision': 0.9773078, 'recall': 0.96266884, 'specificity': 0.9987496, 'f1': 0.9691465, 'auroc': 0.9999189}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0    5    0     1     0     0    0     19
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  280     0   11    2     0     1     1   17      0
3     0     1    0  8409    0    8     1    13     7    0      1
4     0     0    0     0  497    0     0     0     1    0     41
5     0     0    0     2    0  519     0     0     0    0      0
6     2     0    0     0    0    0  1900     0     0    0      4
7     0     6    1    57    0    1     0  7163    19    0     16
8     0     0    0     1    4    1     0     1  3198    0     89
9     1     0    0     0    0   60     0     0     0  432      0
10    0     0    1     2    0    0     0     0     0    0  12791
---- Validation: 
scalar performance:
{'acc': 0.98844457, 'precision': 0.974182, 'recall': 0.9587651, 'specificity': 0.99867, 'f1': 0.9652113, 'auroc': 0.99990284}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    5    0     0     0     0    0     24
1     0  1328    0     0    0    0     0     0     1    0      3
2     0     0  280     0   15    1     0     0     2   14      0
3     0     1    0  8402    0    8     0    15    11    0      3
4     0     0    0     0  498    1     0     0     1    0     39
5     0     0    0     0    0  521     0     0     0    0      0
6     1     0    0     0    0    0  1900     0     0    0      7
7     1     7    1    61    1    0     0  7150    27    0     17
8     0     0    0     1    5    1     0     3  3214    0     72
9     0     0    0     0    1   78     0     0     1  413      0
10    0     0    1     1    0    0     1     0     0    0  12793
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70146227, 'precision': 0.65114117, 'recall': 0.59202623, 'specificity': 0.96994334, 'f1': 0.57392687, 'auroc': 0.8678371}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   981     0    0   13    1    9     8    49    22   22    65
1     0  1310    0   14    0    0     0   151     3    3    18
2     1     0  104   14  131   11     3    33   203   40   475
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  141    0     2     2     7    0  1479
5     2     0    4  118    1  271     4     1    26  156     9
6     0     0    0    4    0    0  2768     2    21    0   272
7     0     0    0   29    0    0     0  1131     3    0     1
8     0     0    0   36    1    2     1    17  1302    1    10
9     2     0   71  106   18  146     2    96   247  378    71
10    0     0    0    0    4    0     1     1     0    0  1640
early stop counter: 2
val acc:0.9884445667266846, best validation acc: 0.9931523203849792, corresponding to test acc:                         0.7091583013534546 / 0.7363744378089905
after epoch: 25,now: 2024-07-15 07:11:13.538592,epoch time: 0:45:58.096773,used: 19:10:08.788762,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99074274, 'precision': 0.9705609, 'recall': 0.98028535, 'specificity': 0.99905276, 'f1': 0.9746331, 'auroc': 0.9999423}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    6    0     0     1     0    0      1
1     0  1301    0     1    0    0     0    30     0    0      0
2     0     0  294     0   12    0     0     5     0    0      0
3     0     0    0  8349    0    2     0    63    24    0      0
4     2     0    0     0  530    0     0     0     2    1      4
5     0     0    0     0    0  494     0     0     2   25      0
6     6     0    0     0    0    0  1897     3     0    0      2
7     0     0    0     5    0    0     0  7258     0    0      1
8     0     0    0     7    2    0     0    15  3271    0      1
9     0     0    9     0    0    1     0     0     0  483      0
10    5     0    0     0   97    0     2     5     4    0  12678
---- Validation: 
scalar performance:
{'acc': 0.9910659, 'precision': 0.9721332, 'recall': 0.982862, 'specificity': 0.9990877, 'f1': 0.9766304, 'auroc': 0.9999522}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    6    0     1     1     0    0      0
1     0  1303    0     3    0    0     0    25     1    0      0
2     0     0  296     0   13    0     0     0     1    2      0
3     1     0    0  8350    0    3     0    54    31    0      1
4     2     0    0     0  531    0     0     1     1    0      4
5     0     0    0     0    0  500     0     0     0   21      0
6     5     0    0     0    1    0  1900     1     0    0      1
7     0     0    0     6    0    0     0  7256     2    0      1
8     0     0    0     4    4    0     0    15  3267    0      6
9     0     0    3     0    0    1     0     0     0  489      0
10    3     0    1     1   99    0     1     1     5    0  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7202127, 'precision': 0.6778873, 'recall': 0.588925, 'specificity': 0.9719016, 'f1': 0.5747906, 'auroc': 0.8780563}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   906    0   0  17   19    1    12   138    13   53    11
1     1  977   0  23    0    0     3   475     4    0    16
2     0    0  48  11  406    2     3   122   197   89   137
3     0    0   0   0    0    0     0     0     0    0     0
4     1    0   3   0  839    0     8     7    18    2   755
5     1    0   0  50    5  117     2     8    20  389     0
6     0    0   0  12    5    0  2907    12    26    1   104
7     0    0   0  12    0    0     0  1149     2    0     1
8     0    0   0  14    1    2     1    56  1291    2     3
9     2    0  18  56   41   18     1   216   160  605    20
10    0    0   0   0  183    0     4     3     0    1  1455
early stop counter: 3
val acc:0.9910659193992615, best validation acc: 0.9931523203849792, corresponding to test acc:                         0.7091583013534546 / 0.7363744378089905
after epoch: 26,now: 2024-07-15 07:58:06.761979,epoch time: 0:46:53.223387,used: 19:57:02.012149,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9932042, 'precision': 0.978986, 'recall': 0.9855527, 'specificity': 0.9992619, 'f1': 0.98198795, 'auroc': 0.9999582}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    6    0     0     0     0    0      3
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  305     0    5    0     0     0     0    0      2
3     1     3    0  8407    0    1     0    14    13    0      0
4     1     0    3     0  529    0     0     0     1    0      5
5     0     0    0     2    0  515     0     0     1    2      1
6     0     0    0     2    0    0  1904     0     0    0      2
7     0    11    1    35    1    0     0  7206     6    0      3
8     0     2    4     5   19    0     2     8  3220    0     36
9     1     0   16     1    0    6     0     0     0  469      0
10    1     0    0     0   28    0     0     0     0    0  12762
---- Validation: 
scalar performance:
{'acc': 0.9932593, 'precision': 0.9804574, 'recall': 0.9865964, 'specificity': 0.99926025, 'f1': 0.98322254, 'auroc': 0.9999633}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    4    0     0     0     0    0      0
1     0  1331    0     0    0    0     0     0     0    0      1
2     0     0  309     0    3    0     0     0     0    0      0
3     1     2    0  8408    1    0     0    13    15    0      0
4     0     0    2     0  529    0     0     0     1    0      7
5     0     0    1     4    1  510     0     0     4    1      0
6     1     0    0     0    0    0  1903     0     0    0      4
7     0    10    2    43    2    0     0  7196     3    0      9
8     0     4    0     2   21    0     0     8  3228    0     33
9     0     0   20     0    1    4     0     0     0  468      0
10    0     0    1     3   20    0     0     0     0    0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7151053, 'precision': 0.6570178, 'recall': 0.6019226, 'specificity': 0.9714317, 'f1': 0.6014215, 'auroc': 0.8753359}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   946     6    0   45    3    3     5    86     5   33    38
1     0  1354    1   27    0    0     0    99     1    0    17
2     1     0  104   17  361    7     2    56    56   13   398
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    0    0  547    0     0     2     1    0  1082
5     1     0    9  127    5  283     0     4    25  122    16
6     1     1    0    8   10    0  2726     2     8    0   311
7     0     0    0   31    0    0     0  1128     3    0     2
8     0     0    0   34   21    0     2    21  1258    1    33
9     3     3  203  182   41  107     0   111    95  289   103
10    0     0    0    0   58    0     1     1     0    0  1586
better model found
persisted
after epoch: 27,now: 2024-07-15 08:44:31.313953,epoch time: 0:46:24.551974,used: 20:43:26.564123,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98994005, 'precision': 0.98324466, 'recall': 0.9835642, 'specificity': 0.99891806, 'f1': 0.9832682, 'auroc': 0.9999644}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    6    0     0     1     0    0      1
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  297     0    2    0     0     0     0   13      0
3     0     4    0  8220    0    0     2   193    17    1      0
4     1     0    5     0  521    0     0     0     5    0      6
5     0     0    0    12    0  499     0     0     0   10      0
6     1     0    0     0    0    0  1907     0     0    0      0
7     0     0    0     5    0    0     0  7254     4    0      1
8     0     1    0     1    0    0     0    12  3281    1      0
9     0     0    0     0    0    2     0     0     0  491      0
10    4     0    1     3   15    0     6     6    33    0  12725
---- Validation: 
scalar performance:
{'acc': 0.99045074, 'precision': 0.9850967, 'recall': 0.9862553, 'specificity': 0.99897003, 'f1': 0.9855479, 'auroc': 0.99996823}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     1    0     0    6    0     0     0     0    0      2
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  305     0    1    0     0     0     0    6      0
3     0     1    0  8225    0    0     1   193    20    0      0
4     1     0    6     0  528    0     0     1     3    0      0
5     0     0    0    11    0  496     0     0     0   14      0
6     0     0    0     0    0    0  1907     1     0    0      0
7     0     2    0     0    0    0     0  7260     2    0      1
8     0     1    0     6    1    0     0    17  3270    0      1
9     0     0    0     0    1    0     0     0     0  492      0
10    3     0    2     0   11    0     5     8    27    0  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7251102, 'precision': 0.6565321, 'recall': 0.5965216, 'specificity': 0.9724251, 'f1': 0.58075833, 'auroc': 0.8759565}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   911     7    1   15    1    2    37   115    30   43     8
1     0  1228    0    7    0    0     1   248     3    0    12
2     0     0  106   13  175   18    12   138   334   53   166
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  402    0    11     4    80    0  1132
5     2     0    2  117    0  199     0     9    25  235     3
6     0     0    0    4    0    0  3039     2    17    0     5
7     0     0    0    6    0    0     0  1156     1    0     1
8     0     0    0   19    0    0     2    49  1299    1     0
9     2     1   55   96    8   98     1   237   192  424    23
10    0     0    0    0   33    0     4     2     7    0  1600
early stop counter: 1
val acc:0.9904507398605347, best validation acc: 0.9932593107223511, corresponding to test acc:                         0.7151052951812744 / 0.7363744378089905
after epoch: 28,now: 2024-07-15 09:36:16.534597,epoch time: 0:51:45.220644,used: 21:35:11.784767,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9895655, 'precision': 0.9549477, 'recall': 0.97781533, 'specificity': 0.9989661, 'f1': 0.96527636, 'auroc': 0.9998846}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     1    0    0     0     0     0    0      1
1     0  1317    0     0    0    0     0    14     0    0      0
2     0     0  307     0    0    0     0     0     0    5      0
3     0     0    0  8419    0    4     0     9     5    1      0
4     6     0   28     0  504    0     0     0     0    0      1
5     0     0    0     0    0  521     0     0     0    0      0
6     0     0    0     0    1    1  1905     0     1    0      0
7     0     0    1    37    0    0     0  7221     3    1      0
8     0     0    1    13    1    3     0    11  3265    0      0
9     0     0    5     0    0   52     0     0     0  436      0
10   28     1    4     1  101    0     5    14    30    0  12610
---- Validation: 
scalar performance:
{'acc': 0.9888725, 'precision': 0.95434564, 'recall': 0.97834665, 'specificity': 0.998891, 'f1': 0.9653005, 'auroc': 0.9998627}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     0    1    0     1     0     0    0      0
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  308     0    0    0     0     0     0    4      0
3     0     0    0  8406    0    5     0    15    13    1      0
4     6     0   31     0  499    1     0     0     1    0      1
5     0     0    0     0    0  521     0     0     0    0      0
6     1     0    0     3    0    1  1900     0     2    0      1
7     0     0    1    34    0    0     0  7225     5    0      0
8     0     0    1    15    1    1     0    18  3258    1      1
9     0     0    0     1    0   49     0     0     0  443      0
10   26     0    6     2  107    1     7    20    24    0  12603
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74477017, 'precision': 0.6793089, 'recall': 0.6378211, 'specificity': 0.97455597, 'f1': 0.6275801, 'auroc': 0.8863381}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   942     2    0  35    2    8    36    86    23   31     5
1     0  1144    0  28    0    0     0   313     8    1     5
2     1     0  244  14  217   34     9    74   313   47    62
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   10   0  764    1     3     4    49    0   802
5     0     0    2  84    0  410     3     2    23   68     0
6     0     0    0   6    3    2  2883     7   122    0    44
7     0     0    0  54    0    0     0  1108     1    0     1
8     0     0    0  31    0    2     1    27  1307    1     1
9     0     1  112  95    6  263     0   121   233  299     7
10    0     0    0   0   88    0     7     2     5    0  1544
new oracle model saved
early stop counter: 2
val acc:0.9888725280761719, best validation acc: 0.9932593107223511, corresponding to test acc:                         0.7151052951812744 / 0.7447701692581177
after epoch: 29,now: 2024-07-15 10:34:26.927124,epoch time: 0:58:10.392527,used: 22:33:22.177294,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9938463, 'precision': 0.9853068, 'recall': 0.9749781, 'specificity': 0.99930006, 'f1': 0.97980297, 'auroc': 0.99995744}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    3    0     1     0     0    0      1
1     0  1329    0     0    0    0     0     1     0    0      2
2     0     0  305     0    5    0     0     1     0    0      1
3     0     0    0  8409    0    0     0    13    16    0      0
4     5     0    1     0  473    0     1     0     3    0     56
5     0     0    0     8    1  494     0     0     1   16      0
6     2     0    0     0    0    0  1905     0     0    0      1
7     0     3    0    26    0    0     1  7228     6    0      0
8     0     0    0     5    0    0     0    10  3274    0      6
9     2     0   17     0    1    2     0     2     0  468      1
10    1     0    0     1    0    0     1     1     5    0  12783
---- Validation: 
scalar performance:
{'acc': 0.9943025, 'precision': 0.9851279, 'recall': 0.9762498, 'specificity': 0.99934715, 'f1': 0.98041135, 'auroc': 0.99995285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    2    0     1     0     0    0      2
1     0  1327    0     0    0    0     0     2     2    0      1
2     0     0  303     0    8    0     0     0     0    0      1
3     0     0    0  8419    0    0     0     9    11    0      1
4     4     0    0     0  474    0     2     0     1    0     58
5     0     0    0     2    0  508     0     0     0   11      0
6     2     0    0     0    0    0  1903     0     1    0      2
7     0     3    0    20    0    0     0  7236     3    0      3
8     1     1    0     5    1    0     0     5  3277    0      6
9     0     0   20     0    1    2     0     3     1  465      1
10    2     0    1     1    2    0     1     1     6    0  12782
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69089764, 'precision': 0.6221715, 'recall': 0.56555986, 'specificity': 0.96893656, 'f1': 0.5426862, 'auroc': 0.87365615}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   926     0    0   40    0    0    34   115    25    2    28
1     0  1243    0   20    0    0     0   207     7    0    22
2     7     0   80   21  170    5    10   120   204   19   379
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  140    0     5     2    15    0  1471
5     7     0    7  124    4  204     7    12    43  169    15
6     0     0    0    4    0    0  2990     2     8    0    63
7     0     0    0   12    0    0     0  1149     2    0     1
8     0     0    0   38    0    0     2    62  1263    1     4
9    10     0  100  141   23   67     2   260   191  240   103
10    0     0    0    0    3    0     2     1     0    0  1640
better model found
persisted
after epoch: 30,now: 2024-07-15 11:27:14.567425,epoch time: 0:52:47.640301,used: 23:26:09.817595,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 23:26:09.817595 at 2024-07-15 11:27:14.567425
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69089764, 'precision': 0.6221715, 'recall': 0.56555986, 'specificity': 0.96893656, 'f1': 0.5426862, 'auroc': 0.87365615}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   926     0    0   40    0    0    34   115    25    2    28
1     0  1243    0   20    0    0     0   207     7    0    22
2     7     0   80   21  170    5    10   120   204   19   379
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  140    0     5     2    15    0  1471
5     7     0    7  124    4  204     7    12    43  169    15
6     0     0    0    4    0    0  2990     2     8    0    63
7     0     0    0   12    0    0     0  1149     2    0     1
8     0     0    0   38    0    0     2    62  1263    1     4
9    10     0  100  141   23   67     2   260   191  240   103
10    0     0    0    0    3    0     2     1     0    0  1640
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74477017, 'precision': 0.6793089, 'recall': 0.6378211, 'specificity': 0.97455597, 'f1': 0.6275801, 'auroc': 0.8863381}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   942     2    0  35    2    8    36    86    23   31     5
1     0  1144    0  28    0    0     0   313     8    1     5
2     1     0  244  14  217   34     9    74   313   47    62
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   10   0  764    1     3     4    49    0   802
5     0     0    2  84    0  410     3     2    23   68     0
6     0     0    0   6    3    2  2883     7   122    0    44
7     0     0    0  54    0    0     0  1108     1    0     1
8     0     0    0  31    0    2     1    27  1307    1     1
9     0     1  112  95    6  263     0   121   233  299     7
10    0     0    0   0   88    0     7     2     5    0  1544
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971821_instance_wise_predictions.txt
accuracy from prediction file 0.6908976422024767
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/3.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 320408 KiB |   4485 MiB |   2103 TiB |   2103 TiB |
|       from large pool | 290575 KiB |   4459 MiB |   2076 TiB |   2076 TiB |
|       from small pool |  29832 KiB |     49 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 320408 KiB |   4485 MiB |   2103 TiB |   2103 TiB |
|       from large pool | 290575 KiB |   4459 MiB |   2076 TiB |   2076 TiB |
|       from small pool |  29832 KiB |     49 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 315422 KiB |   4483 MiB |   2102 TiB |   2102 TiB |
|       from large pool | 286862 KiB |   4457 MiB |   2076 TiB |   2076 TiB |
|       from small pool |  28560 KiB |     47 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5908 MiB |   5908 MiB |   5908 MiB |      0 B   |
|       from large pool |   5858 MiB |   5858 MiB |   5858 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 216168 KiB |    955 MiB |   2087 TiB |   2087 TiB |
|       from large pool | 205040 KiB |    949 MiB |   2060 TiB |   2060 TiB |
|       from small pool |  11127 KiB |     10 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4298    |    6541    |  304760 K  |  304755 K  |
|       from large pool |     130    |     521    |  191013 K  |  191012 K  |
|       from small pool |    4168    |    6336    |  113747 K  |  113742 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4298    |    6541    |  304760 K  |  304755 K  |
|       from large pool |     130    |     521    |  191013 K  |  191012 K  |
|       from small pool |    4168    |    6336    |  113747 K  |  113742 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     229    |     229    |     229    |       0    |
|       from large pool |     204    |     204    |     204    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    1632    |  180508 K  |  180508 K  |
|       from large pool |      28    |     208    |  134399 K  |  134399 K  |
|       from small pool |      25    |    1604    |   46108 K  |   46108 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4485 MiB |   2103 TiB |   2103 TiB |
|       from large pool |  16640 KiB |   4459 MiB |   2076 TiB |   2076 TiB |
|       from small pool |      0 KiB |     49 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4485 MiB |   2103 TiB |   2103 TiB |
|       from large pool |  16640 KiB |   4459 MiB |   2076 TiB |   2076 TiB |
|       from small pool |      0 KiB |     49 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4483 MiB |   2102 TiB |   2102 TiB |
|       from large pool |  16640 KiB |   4457 MiB |   2076 TiB |   2076 TiB |
|       from small pool |      0 KiB |     47 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 536576 KiB |   5908 MiB |   5908 MiB |   5384 MiB |
|       from large pool | 495616 KiB |   5858 MiB |   5858 MiB |   5374 MiB |
|       from small pool |  40960 KiB |     50 MiB |     50 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    955 MiB |   2087 TiB |   2087 TiB |
|       from large pool |  24320 KiB |    949 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     28 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  304760 K  |  304760 K  |
|       from large pool |       2    |     521    |  191013 K  |  191013 K  |
|       from small pool |       0    |    6336    |  113747 K  |  113747 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  304760 K  |  304760 K  |
|       from large pool |       2    |     521    |  191013 K  |  191013 K  |
|       from small pool |       0    |    6336    |  113747 K  |  113747 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     229    |     229    |     186    |
|       from large pool |      23    |     204    |     204    |     181    |
|       from small pool |      20    |      25    |      25    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1632    |  180509 K  |  180509 K  |
|       from large pool |       3    |     208    |  134399 K  |  134399 K  |
|       from small pool |       0    |    1604    |   46110 K  |   46110 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4485 MiB |   2103 TiB |   2103 TiB |
|       from large pool |  16640 KiB |   4459 MiB |   2076 TiB |   2076 TiB |
|       from small pool |      0 KiB |     49 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4485 MiB |   2103 TiB |   2103 TiB |
|       from large pool |  16640 KiB |   4459 MiB |   2076 TiB |   2076 TiB |
|       from small pool |      0 KiB |     49 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4483 MiB |   2102 TiB |   2102 TiB |
|       from large pool |  16640 KiB |   4457 MiB |   2076 TiB |   2076 TiB |
|       from small pool |      0 KiB |     47 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 536576 KiB |   5908 MiB |   5908 MiB |   5384 MiB |
|       from large pool | 495616 KiB |   5858 MiB |   5858 MiB |   5374 MiB |
|       from small pool |  40960 KiB |     50 MiB |     50 MiB |     10 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    955 MiB |   2087 TiB |   2087 TiB |
|       from large pool |  24320 KiB |    949 MiB |   2060 TiB |   2060 TiB |
|       from small pool |      0 KiB |     28 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  304760 K  |  304760 K  |
|       from large pool |       2    |     521    |  191013 K  |  191013 K  |
|       from small pool |       0    |    6336    |  113747 K  |  113747 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  304760 K  |  304760 K  |
|       from large pool |       2    |     521    |  191013 K  |  191013 K  |
|       from small pool |       0    |    6336    |  113747 K  |  113747 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     229    |     229    |     186    |
|       from large pool |      23    |     204    |     204    |     181    |
|       from small pool |      20    |      25    |      25    |       5    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1632    |  180509 K  |  180509 K  |
|       from large pool |       3    |     208    |  134399 K  |  134399 K  |
|       from small pool |       0    |    1604    |   46110 K  |   46110 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821

 Experiment start at: 2024-07-15 12:18:47.407120
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92380136, 'precision': 0.8699346, 'recall': 0.7886607, 'specificity': 0.9914522, 'f1': 0.8153606, 'auroc': 0.9956748}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   388     0    0     0    0    1    13    16     0    4     61
1     0  1268    0     6    0    0     0    51     4    0      3
2     3     0  132     0   23    5     1    72     4   55     17
3     4     1    0  7367    0   28     2   970    64    0      1
4     4     0   26     0  187    1     3    36    43   13    226
5     2     0    0    22    0  428     2     1     4   61      1
6    10     0    0     1    0    0  1866     7     7    2     15
7     0    13    0    44    1    1     1  7187    13    0      3
8     1     3    0   164    3    9     2   337  2753    3     19
9     3     1   29     4    0   88     1    28     4  328      7
10    8     1    2     4   10    0    13    75    53    4  12624
---- Validation: 
scalar performance:
{'acc': 0.92389995, 'precision': 0.8742446, 'recall': 0.79293936, 'specificity': 0.9914577, 'f1': 0.81943536, 'auroc': 0.995602}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   389     0    0     1    0    0    13    17     0    1     62
1     0  1264    0     5    0    0     0    59     2    1      1
2     1     0  137     0   20    3     2    66     3   60     20
3     2     2    0  7335    0   28     1  1003    67    2      0
4     3     1   29     0  189    1     2    36    34   16    228
5     1     1    0    18    0  426     0     3     6   65      1
6    11     1    0     1    0    1  1861     9     5    3     16
7     0    12    0    46    1    0     1  7192    10    0      3
8     3     2    2   155    2   10     1   318  2782    3     18
9     2     0   27     5    0   79     2    27     5  343      3
10    8     0    0     6    8    0    14    76    60    2  12622
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6915973, 'precision': 0.59637827, 'recall': 0.58081543, 'specificity': 0.96889704, 'f1': 0.5401654, 'auroc': 0.8801543}
confusion matrix:
      0     1   2   3   4    5     6     7     8    9     10
0   1079     4   0   1   0    0    35    40     1    4     6
1      0  1042   0   6   0    0     0   431     2    0    18
2     24     0   0   4  60    6     5   319   174   57   366
3      0     0   0   0   0    0     0     0     0    0     0
4      0     0   0   0  77    0     2    10    19    0  1525
5     34     0   0  42   0  322     5     9    20  148    12
6      3     0   0   0   0    0  2964     7     8    0    85
7      0     0   0   1   0    0     0  1162     0    0     1
8      2     0   0  32   0    3     1    88  1240    2     2
9     70     7   2  14   2   59     1   460   109  354    59
10     0     0   0   0   0    0     0     1     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-15 13:16:59.798905,epoch time: 0:58:12.391785,used: 0:58:12.391785,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94780076, 'precision': 0.85950315, 'recall': 0.83908784, 'specificity': 0.9945357, 'f1': 0.83710843, 'auroc': 0.99718064}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     3    0    2     3     4     5    2     33
1     0  1287    0     8    0    0     0    29     8    0      0
2     0     0  215     0   36    6     1     4    20   28      2
3     1     3    0  8023    0   19     0   157   234    0      0
4     6     0   20     1  322    2     0     3    66    9    110
5     0     0    0    18    0  488     0     0    10    4      1
6    15     0    1     3    1    1  1858     1     7    1     19
7     1    17    1   129    1    0     1  6911   194    0      8
8     0     0    2    39    3    0     1    28  3209    0     12
9     1     0   77     5    1  227     0     1    24  157      0
10   28     0    4    10   73    1     4    24   125    2  12524
---- Validation: 
scalar performance:
{'acc': 0.9486425, 'precision': 0.86632526, 'recall': 0.84235835, 'specificity': 0.9946262, 'f1': 0.8410143, 'auroc': 0.9973022}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     2    0    0     6     4     6    3     31
1     0  1289    0     9    0    0     0    27     6    0      1
2     3     0  221     1   35    9     1     6    14   19      3
3     0     1    1  8034    0   16     0   156   231    1      0
4     6     0   24     0  321    3     1     3    69    7    105
5     0     0    1    12    0  489     0     0    14    3      2
6    13     0    1     4    2    2  1857     0    10    1     18
7     1    18    5   129    1    0     2  6917   186    0      6
8     1     0    4    33    3    2     0    31  3211    0     11
9     1     0   61     6    0  234     0     1    21  164      5
10   32     2    3     7   55    1     3    21   138    3  12531
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72217166, 'precision': 0.64843136, 'recall': 0.6133537, 'specificity': 0.97206354, 'f1': 0.58563614, 'auroc': 0.88473386}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1056    11    0  17    2    5     6    60     5    2     6
1      0  1255    0  13    0    0     0   217    10    0     4
2     20     0   69   3  230   10     2    48   410   19   204
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    2   0  494    0     1     1    29    0  1105
5     13     0    2  76    2  376     0     1    67   40    15
6      1     0    0   1    2    0  2807     2    15    0   239
7      0     0    0  31    0    0     0  1128     4    0     1
8      0     0    0  15    0    1     0     4  1349    1     0
9     31     5  130  63   31  146     0    92   430  170    39
10     0     0    0   0   26    0     0     1     1    0  1618
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-15 14:09:51.284081,epoch time: 0:52:51.485176,used: 1:51:03.876961,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9572453, 'precision': 0.8821538, 'recall': 0.88663363, 'specificity': 0.9954371, 'f1': 0.88082266, 'auroc': 0.9979823}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    1     4    2    0     5     3     3    0     23
1     0  1187    2    16    0    0     0   118     5    0      3
2     1     0  262     0   18    1     1     5     2   22      0
3     0     0    1  8292    1   13     5    82    45    0      0
4     4     0   37     1  415    2     0     1    13    2     64
5     1     0    4    22    0  461     0     0     2   30      1
6     4     0    1     2    0    0  1880     2     6    1     12
7     1     1    8   195    2    0     1  7017    27    1      7
8     0     0    4   153   18   15     0    80  3017    1      7
9     3     0   69     4    0  103     1     2     3  308      0
10   17     0   10     8  174    1     6    12    70    0  12497
---- Validation: 
scalar performance:
{'acc': 0.9572823, 'precision': 0.87987727, 'recall': 0.8858123, 'specificity': 0.99546003, 'f1': 0.87852275, 'auroc': 0.99799335}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    1     4    2    0     4     4     3    1     24
1     0  1192    1    18    0    0     0   114     5    0      2
2     0     0  264     0   21    3     1     1     1   21      0
3     2     0    3  8290    0   15     0    80    50    0      0
4     4     0   46     1  407    2     1     3    13    2     60
5     1     0    2    20    1  466     1     0     3   25      2
6    10     0    1     0    1    0  1881     2     5    0      8
7     1     2   10   192    3    0     3  7017    30    1      6
8     0     0    8   155   13   13     0    73  3029    0      5
9     4     0   67     2    0  114     0     2     1  302      1
10   12     0   13     8  167    1     8    15    72    0  12500
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6936262, 'precision': 0.63397753, 'recall': 0.57928276, 'specificity': 0.96935296, 'f1': 0.5640331, 'auroc': 0.8814989}
confusion matrix:
      0    1    2    3    4    5     6     7     8   9     10
0   1053    0    4   21    2    2    51    26     1   1     9
1      0  854    0   25    0    0     0   573     5   0    42
2      5    0  156   12  457    8     5    55   116   4   197
3      0    0    0    0    0    0     0     0     0   0     0
4      0    0    0    0  381    0     2     2     9   0  1239
5     10    0   43  132    5  351     3     0    10  31     7
6      0    0    0    1    0    0  3038     2     3   0    23
7      0    0    0   85    0    0     1  1076     1   0     1
8      1    0    0   47    4    1     9    19  1284   1     4
9     16    0  569  118   23  114     8    82    79  91    37
10     0    0    0    0   15    0     0     1     0   0  1630
better model found
persisted
after epoch: 3,now: 2024-07-15 15:06:37.845877,epoch time: 0:56:46.561796,used: 2:47:50.438757,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9619007, 'precision': 0.897701, 'recall': 0.896822, 'specificity': 0.9958476, 'f1': 0.8959379, 'auroc': 0.99861217}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     0    1    0     0     0     0    1     25
1     0  1286    0     1    0    0     0    41     2    0      1
2     1     0  260     0   21    0     1     6     1   19      2
3     3     3    1  7942    1   36     0   358    82   12      0
4     4     0   33     0  374    1     1     3     5    4    114
5     0     0    0     8    0  429     0     0     2   81      1
6     9     0    1     0    0    1  1881     0     1    0     15
7     2    10    4    38    2    1     1  7184    16    1      6
8     4     1    4    51   15    7     3   110  3056    4     40
9     0     0   72     1    2   37     1     2     0  377      1
10   13     0    3     7   40    1     3    10     7    1  12707
---- Validation: 
scalar performance:
{'acc': 0.96207035, 'precision': 0.89628106, 'recall': 0.89560294, 'specificity': 0.9958725, 'f1': 0.89462465, 'auroc': 0.99850464}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     0    2    0     0     0     0    3     17
1     0  1288    0     3    0    0     0    38     2    0      1
2     1     0  265     0   16    1     1     5     1   18      4
3     2     2    0  7970    1   34     3   334    79   14      1
4     3     0   32     0  375    1     1     5     7    3    112
5     0     0    0     7    1  418     0     0     4   90      1
6     9     0    1     0    1    0  1882     0     1    0     14
7     1     8    5    37    3    0     1  7184    17    2      7
8     5     1    2    49   13    4     0   119  3052    4     47
9     0     0   76     1    3   39     2     2     0  367      3
10   12     0    1     6   49    0     4     8    10    1  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73889315, 'precision': 0.661114, 'recall': 0.6286553, 'specificity': 0.9735859, 'f1': 0.6123513, 'auroc': 0.87984097}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1075     5    0  10    2    0    43    22     0    9     4
1      0  1167    0   5    0    0     0   298     1    0    28
2      9     0  100   1  310    9     2    93   128   50   313
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0  259    0     1     1    11    0  1360
5      3     0    1  53   11  343     2     3    16  159     1
6      0     0    0   0    0    0  2992     3     2    0    70
7      0     0    0   2    0    0     0  1158     1    0     3
8      0     1    0  22    2    1     9    33  1287    3    12
9      7     8  116  25   37   87     2   181    80  541    53
10     0     0    0   0    7    0     0     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-15 15:54:43.600209,epoch time: 0:48:05.754332,used: 3:35:56.193089,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96567315, 'precision': 0.90235966, 'recall': 0.887409, 'specificity': 0.99637914, 'f1': 0.8860582, 'auroc': 0.99880403}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     2    3    1     8     0     0    0     11
1     0  1295    0     5    0    0     0    28     2    0      2
2     2     1  225     1   59    2     2     5     4   11      0
3     0     0    0  8313    0    7     0    54    63    0      0
4     5     0    4     1  452    2     0     1    14    1     59
5     0     0    1    24    0  483     1     0     6    5      1
6     4     0    1     0    0    0  1894     0     2    0      7
7     1     7    0   219    2    0     4  6966    60    0      5
8     0     0    2    62    6    1     1    31  3184    0      8
9     3     1   58    14    4  170     0     4     8  230      1
10   13     0    1     8  117    1    13     6    40    0  12593
---- Validation: 
scalar performance:
{'acc': 0.9654139, 'precision': 0.8992278, 'recall': 0.88582456, 'specificity': 0.9963524, 'f1': 0.8833862, 'auroc': 0.9987489}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     5    3    0     7     0     1    0     10
1     0  1292    0     6    0    0     0    30     3    0      1
2     3     0  216     3   64    3     1     3     5   12      2
3     0     1    0  8304    0   11     0    54    70    0      0
4     5     0    6     0  455    2     1     3     9    0     58
5     0     0    0    20    0  491     0     0     5    4      1
6     3     0    0     1    0    0  1895     0     2    0      7
7     3     3    1   205    1    0     3  6984    61    0      4
8     2     0    1    67    6    0     0    39  3169    0     12
9     5     0   65    15    5  162     1     3     7  229      1
10   18     0    2     8  116    2    11     9    30    0  12600
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7017421, 'precision': 0.63140744, 'recall': 0.58392847, 'specificity': 0.9701013, 'f1': 0.5384817, 'auroc': 0.88106334}
confusion matrix:
     0     1   2    3    4    5     6     7     8   9     10
0   998     3   0   38    1    7    96    16     7   0     4
1     0  1194   0   20    0    0     1   240     3   0    41
2     9     0  10   19  236   27    26    44   378   1   265
3     0     0   0    0    0    0     0     0     0   0     0
4     0     0   0    0  306    0     4     2    14   0  1307
5     4     0   0  157    0  384     3     0    43   0     1
6     0     0   0    1    0    0  3046     0     3   0    17
7     0     0   0   24    0    0     0  1134     3   0     3
8     0     0   0   38    1    0     4     4  1319   0     4
9     9     2  37  252   21  281    14    69   398   7    47
10    0     0   0    0   13    0     0     0     1   0  1632
better model found
persisted
after epoch: 5,now: 2024-07-15 16:42:26.139002,epoch time: 0:47:42.538793,used: 4:23:38.731882,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9683487, 'precision': 0.9223999, 'recall': 0.9028277, 'specificity': 0.99655837, 'f1': 0.91122395, 'auroc': 0.9989536}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     0    1    0     6     0     1    0     41
1     0  1264    0     5    0    0     0    55     4    0      4
2     2     0  258     0   32    0     2     0     1   15      2
3     0     0    0  8111    0    1     3   137   184    1      2
4     6     0   17     0  400    0     6     0    10    0    100
5     2     0    2     9    1  426     3     0     6   70      1
6     3     0    0     0    0    0  1898     1     0    0      6
7     1     1    6    53    3    0     1  7068   103    1     26
8     0     0    3    22    2    0     6    23  3200    0     39
9     4     0   62     1    2   27     2     1     0  394      0
10    2     0    5     6   17    0    13     1     8    0  12740
---- Validation: 
scalar performance:
{'acc': 0.96766084, 'precision': 0.9211002, 'recall': 0.90143466, 'specificity': 0.99647367, 'f1': 0.9096029, 'auroc': 0.9989566}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     0    1    0     6     0     0    0     40
1     0  1268    0     4    0    0     0    53     5    0      2
2     2     0  262     0   27    0     2     1     0   13      5
3     0     0    1  8102    0    5     2   149   179    2      0
4     5     0   13     0  390    0     7     1     8    0    115
5     1     0    1    13    0  421     0     0     4   80      1
6     4     0    0     0    0    0  1898     0     0    0      6
7     1     3    8    49    2    0     2  7076   101    1     22
8     1     0    2    20    3    1     9    21  3192    1     46
9     7     0   62     1    2   24     3     1     0  393      0
10    4     0    5     6   14    0    20     2     6    1  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6859302, 'precision': 0.641343, 'recall': 0.56551254, 'specificity': 0.9678136, 'f1': 0.55592674, 'auroc': 0.8808317}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   732    1    5   9    0    1   295    48    11    6    62
1     0  893    0  10    0    0     4   527     9    0    56
2     7    0  133   2  164    3    73    37   217   17   362
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    0   0  312    0     8     1    11    0  1301
5    10    0   15  76    1  278    55     3    26  122     6
6     0    0    0   0    0    0  3058     1     0    0     8
7     0    0    0   1    0    0     1  1156     3    0     3
8     0    0    0  12    0    1    65    14  1271    0     7
9    12    0  235  65    7   84    59   101   165  339    70
10    0    0    0   0   12    0     1     1     0    0  1632
better model found
persisted
after epoch: 6,now: 2024-07-15 17:29:46.548697,epoch time: 0:47:20.409695,used: 5:10:59.141577,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9684289, 'precision': 0.9136988, 'recall': 0.9089646, 'specificity': 0.99663925, 'f1': 0.9070346, 'auroc': 0.9991411}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    2     1    2    0     5     5     0   11     18
1     0  1230    0     3    0    0     0    95     1    0      3
2     0     0  276     0   12    0     0     1     0   23      0
3     0     0    0  8278    0    5     0   112    42    2      0
4     2     0   29     0  446    0     1     2     9    5     45
5     0     0    0     6    1  357     0     0     5  152      0
6     4     0    2     0    1    0  1887     1     4    1      7
7     0     1    1    83    1    0     1  7161     5    0      8
8     0     0    3    76    8    1     1   129  3064    4     10
9     0     0   43     2    0    4     0     2     0  442      0
10    7     0    9     9  100    1     7    10    31    3  12616
---- Validation: 
scalar performance:
{'acc': 0.969132, 'precision': 0.916011, 'recall': 0.9134542, 'specificity': 0.9967023, 'f1': 0.91107166, 'auroc': 0.999184}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    3     0    2    0     5     3     1    7     18
1     0  1221    0     2    0    0     1   104     1    0      3
2     0     0  282     0    9    0     0     2     0   19      0
3     0     0    0  8292    0    7     0   109    26    6      0
4     3     0   28     0  450    0     0     3     8    2     45
5     1     0    0     5    0  368     0     0     6  140      1
6     5     0    1     0    1    0  1887     3     3    1      7
7     0     1    3    85    1    0     1  7160     7    1      6
8     1     0    4    74    7    2     0   142  3053    2     11
9     0     0   42     1    0    6     0     2     0  442      0
10    5     0    8     7  102    0     4     5    32    1  12632
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6841811, 'precision': 0.66365004, 'recall': 0.55974674, 'specificity': 0.96843874, 'f1': 0.5570773, 'auroc': 0.87900007}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   820    0   16   43    4    1    78    82     2  118     6
1     0  706    0   14    0    0     0   741     1    0    37
2     0    0  211   19  243    2     9   191   184   61    95
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    3    0  407    0     3     6    25    0  1189
5     0    0   13  131    1  160     3     4     9  271     0
6     0    0    0    1    0    0  3013     3    10    0    40
7     0    0    0   18    0    0     0  1144     1    0     1
8     0    0    0   55    0    1     1    80  1232    1     0
9     1    0  138  169    5   19     1   251    72  464    17
10    0    0    0    0   19    0     4     1     0    0  1622
better model found
persisted
after epoch: 7,now: 2024-07-15 18:16:21.250056,epoch time: 0:46:34.701359,used: 5:57:33.842936,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9749037, 'precision': 0.94225705, 'recall': 0.90127903, 'specificity': 0.99721897, 'f1': 0.91517335, 'auroc': 0.999497}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     0    0    2     6     1     0   10     20
1     0  1309    0     3    0    0     0    17     3    0      0
2     0     0  229     0    4    0     0     0     0   77      2
3     0     0    0  8348    0    7     0    65    14    2      0
4     3     0   27     1  366    0     1     6    12    6    117
5     0     0    0     7    0  385     0     0     5  123      1
6     1     0    0     0    0    0  1896     0     1    1      9
7     1     7    1    71    1    0     3  7173     2    2      4
8     0     0    0    72    2    1     2   135  3053    6     24
9     0     0    4     1    0   10     0     1     1  476      0
10    1     0    1     8    5    0     1    10     6    1  12759
---- Validation: 
scalar performance:
{'acc': 0.9754447, 'precision': 0.9453739, 'recall': 0.90592945, 'specificity': 0.99724853, 'f1': 0.9195527, 'auroc': 0.9994909}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     2    0    0     6     1     0    4     20
1     0  1307    0     5    0    0     0    17     3    0      0
2     0     0  235     0    3    0     0     0     0   72      2
3     0     0    0  8343    0    5     0    72    19    1      0
4     3     0   34     0  353    1     0     3     7    5    133
5     0     0    0    10    0  402     0     0     1  107      1
6     2     0    0     0    0    0  1891     0     1    1     13
7     0     5    1    80    1    0     1  7171     2    1      3
8     0     0    1    67    0    1     4   123  3076    4     20
9     0     0    2     0    0    9     0     1     0  481      0
10    0     0    2     9    6    0     4    11     6    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6910376, 'precision': 0.6808022, 'recall': 0.56821585, 'specificity': 0.9689013, 'f1': 0.5602904, 'auroc': 0.88000125}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   556     0    4   67    1   26   251    41     1  188    35
1     0  1237    0   23    0    0     0   232     0    0     7
2     0     0  113   23   70    3     2   160   223  112   309
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  216    0     3     4    14    1  1394
5     0     0    3   94    0  224     2     0    14  254     1
6     0     0    0    1    0    0  2980     5     3    0    78
7     0     0    0   65    0    0     0  1097     1    0     1
8     0     0    0  105    0    1     2    54  1202    2     4
9     0     2   42  164    2   41     3   147    89  619    28
10    0     0    0    0   12    0     0     1     0    0  1633
better model found
persisted
after epoch: 8,now: 2024-07-15 19:04:29.167062,epoch time: 0:48:07.917006,used: 6:45:41.759942,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98188674, 'precision': 0.95312285, 'recall': 0.93819714, 'specificity': 0.9979917, 'f1': 0.94502735, 'auroc': 0.9996376}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    1    0     2     1     0    1     10
1     0  1317    0     1    0    0     0    13     0    0      1
2     0     0  268     0   12    0     1     0     2   29      0
3     2     0    0  8383    0    3     0    24    25    2      0
4     2     0   10     0  428    0     2     0     5    2     90
5     0     0    0     6    0  486     0     0     3   25      1
6     2     0    0     0    0    0  1901     0     1    0      4
7     1     5    6   130    1    0     1  7087    29    1      3
8     0     0    1    50    5    1     0    31  3192    1     14
9     0     0   18     0    0   57     1     0     0  416      0
10    3     0    0     8   10    0     4     3     9    1  12753
---- Validation: 
scalar performance:
{'acc': 0.98151666, 'precision': 0.9522025, 'recall': 0.9394212, 'specificity': 0.99795383, 'f1': 0.94527346, 'auroc': 0.9996089}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    2    0     2     1     0    0      8
1     0  1321    0     0    0    0     1     7     2    0      1
2     0     0  274     0   14    1     1     0     1   20      1
3     0     0    0  8385    0    2     1    25    23    4      0
4     5     0    9     0  426    0     2     2     3    1     91
5     0     0    0     6    0  482     0     0     1   31      1
6     1     0    0     1    0    0  1902     0     0    0      4
7     0    10    4   141    1    0     1  7075    30    0      3
8     0     0    0    48    8    3     0    26  3193    2     16
9     0     0   18     0    1   57     0     0     0  417      0
10    4     0    2     5   11    0     6     5    14    0  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69033796, 'precision': 0.63085186, 'recall': 0.5687843, 'specificity': 0.9687992, 'f1': 0.55875975, 'auroc': 0.87793815}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   768     0   0   45    4    8   205    52     8   56    24
1     0  1265   0   14    0    0     0   174     7    0    39
2     5     1  96   15  297   11     7    39   273   47   224
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  134    0     2     2    16    0  1478
5     0     0   0  165    2  250     7     3    22  140     3
6     0     0   0    1    0    0  2978     2     4    0    82
7     0     0   0  102    0    0     0  1058     1    0     3
8     0     0   0   56    0    0     2    12  1298    1     1
9     3     1  81  183   19   97    13    67   259  378    36
10    0     0   0    0    4    0     0     0     0    0  1642
better model found
persisted
after epoch: 9,now: 2024-07-15 19:50:32.277493,epoch time: 0:46:03.110431,used: 7:31:44.870373,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97683007, 'precision': 0.95691293, 'recall': 0.91666627, 'specificity': 0.99733686, 'f1': 0.93051547, 'auroc': 0.99963886}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     2    0    0     1     0     0    0      4
1     0  1311    0     3    0    0     0    18     0    0      0
2     1     0  270     0    0    0     1     5     2   29      4
3     0     0    0  8301    0    1     0   122    13    0      0
4     5     1   37     0  295    0     3     2    18    0    178
5     1     0    0    23    0  458     0     0     4   34      1
6     3     0    0     0    0    0  1897     1     2    0      5
7     0     2    1    47    0    0     0  7203     3    0      6
8     1     0    0    78    0    0     0   103  3100    0     14
9     3     0    9     4    0   18     3     4     0  451      1
10   18     0    0     5    1    0     3     7    10    1  12748
---- Validation: 
scalar performance:
{'acc': 0.97611344, 'precision': 0.9578006, 'recall': 0.91172206, 'specificity': 0.99724245, 'f1': 0.9278728, 'auroc': 0.9996097}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     1    0    0     1     1     0    0      2
1     0  1307    0     2    0    0     0    23     0    0      0
2     2     0  262     0    3    0     2     6     0   31      6
3     1     0    0  8305    0    0     0   119    15    0      0
4     5     1   26     0  279    1     2     1    26    2    196
5     1     0    0    30    0  461     0     0     0   29      0
6     2     1    0     0    0    0  1901     1     0    0      3
7     0     2    0    41    0    0     1  7214     3    0      4
8     2     0    0    86    0    0     4   106  3082    0     16
9     4     0    8     4    0   22     0     5     0  449      1
10   15     0    0     5    2    0     2     8    10    0  12754
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6655006, 'precision': 0.65827, 'recall': 0.54125094, 'specificity': 0.9664415, 'f1': 0.51037633, 'auroc': 0.87293196}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   987     3   1   19   0    0    38   116     3    0     3
1     0  1198   0    2   0    0     0   290     0    0     9
2    26     1  80   10  22    0     8   226   189   38   415
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    0  44    0     1     3    11    0  1573
5    17     0  14  198   0  103     4    16    21  205    14
6     2     0   0    1   0    0  2834     5     5    0   220
7     0     0   0    4   0    0     0  1159     0    0     1
8     0     0   0   70   0    0     4   123  1167    1     5
9    27     3  32  160   0   21    11   428   103  298    54
10    0     0   0    0   2    0     1     1     0    0  1642
early stop counter: 1
val acc:0.9761134386062622, best validation acc: 0.9815166592597961, corresponding to test acc:                         0.6903379559516907 / 0.7388931512832642
after epoch: 10,now: 2024-07-15 20:36:31.193216,epoch time: 0:45:58.915723,used: 8:17:43.786096,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98220783, 'precision': 0.9531138, 'recall': 0.93863434, 'specificity': 0.9980905, 'f1': 0.944936, 'auroc': 0.9996412}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    1    0     0     0     0    0      5
1     0  1298    0     4    0    0     0    29     0    0      0
2     0     0  247     1    1    2     0     1     7   53      0
3     1     0    0  8332    0    5     0    62    37    1      0
4     4     0   26     1  434    0     0     4    23    1     46
5     0     0    0     6    0  478     0     0     7   30      0
6     3     0    1     1    0    0  1877     0     4    1     21
7     0     1    0    76    1    0     0  7138    42    1      3
8     0     0    0    21    0    0     0    15  3258    0      2
9     0     0    8     0    0   33     0     0     3  449      0
10    1     0    0     8   19    1     0     3    38    0  12723
---- Validation: 
scalar performance:
{'acc': 0.98087466, 'precision': 0.9497923, 'recall': 0.9363481, 'specificity': 0.99794304, 'f1': 0.94201607, 'auroc': 0.9996541}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    0    0     0     1     0    0      7
1     0  1295    0     2    0    0     0    34     1    0      0
2     0     0  245     0    0    2     0     1     7   57      0
3     1     0    0  8331    0    4     0    59    44    1      0
4     5     0   34     1  423    0     0     3    22    1     50
5     0     0    0     5    0  493     0     0     3   19      1
6     8     0    1     2    0    0  1874     2     3    1     17
7     0     0    0    93    1    0     0  7128    40    0      3
8     0     0    0    34    0    0     0    14  3247    0      1
9     0     0    6     0    0   38     0     0     5  443      1
10    6     0    1     6   18    0     1     5    43    0  12716
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6850906, 'precision': 0.67047924, 'recall': 0.57514787, 'specificity': 0.9684669, 'f1': 0.55729496, 'auroc': 0.8804962}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   850    3    3   85    0   20    80    57    50    8    14
1     0  963    0   25    0    0     0   496     3    0    12
2     3    0  107   12   69   15     0    82   512   48   167
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    2    0  258    0     1     2    48    0  1322
5     0    0    2  101    0  328     0     2    40  116     3
6     0    0    0    2    1    0  2900    13    57    0    94
7     0    0    0   60    0    0     0  1101     1    0     2
8     0    0    0   40    0    0     0    28  1301    1     0
9     2    1   45  118    1  125     0    87   388  345    25
10    0    0    0    0    6    0     0     1     0    0  1639
early stop counter: 2
val acc:0.9808746576309204, best validation acc: 0.9815166592597961, corresponding to test acc:                         0.6903379559516907 / 0.7388931512832642
after epoch: 11,now: 2024-07-15 21:22:40.990727,epoch time: 0:46:09.797511,used: 9:03:53.583607,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98482984, 'precision': 0.9650003, 'recall': 0.9477399, 'specificity': 0.99829865, 'f1': 0.95432675, 'auroc': 0.9998363}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    1    0     3     1     0    0      1
1     0  1325    0     0    0    0     0     5     1    0      0
2     0     0  280     0    0    1     1     1     1   25      3
3     0     8    0  8371    0    4     0    38    16    1      0
4     6     0   13     0  409    0     0     0     5    0    106
5     0     0    0     8    0  457     1     0     0   55      0
6     6     0    0     1    0    0  1895     0     0    0      5
7     0    17    2    76    0    0     0  7151    12    2      4
8     1     0    1    57    0    0     1    20  3209    0      7
9     0     0    6     0    0    8     0     1     0  478      0
10   12     0    2     5    2    0     4     2     7    0  12758
---- Validation: 
scalar performance:
{'acc': 0.9855557, 'precision': 0.9648907, 'recall': 0.9461001, 'specificity': 0.9983694, 'f1': 0.9529687, 'auroc': 0.99981934}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     1    2    0     0     0     0    0      1
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  276     0    4    0     1     0     0   29      2
3     1     5    0  8393    0    1     0    25    15    0      0
4     6     0   11     0  391    0     0     0     7    1    123
5     0     0    0     4    0  460     1     0     1   55      0
6     4     0    0     2    0    0  1898     1     0    0      3
7     2    19    5    65    0    0     1  7154     9    3      7
8     0     0    1    55    0    0     0     9  3220    2      9
9     0     0    8     0    0    4     0     0     0  481      0
10   12     0    0     6    2    0     1     1    11    0  12763
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6915973, 'precision': 0.6695776, 'recall': 0.5649533, 'specificity': 0.96903944, 'f1': 0.54262817, 'auroc': 0.8762722}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   941     6    0   78   1    6    42    46    15   21    14
1     0  1159    0    6   0    0     1   289     9    0    35
2    13     0  121   12  32    2     0    72   243   61   459
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    0    0  60    0     2     1    27    0  1543
5     2     0    6  145   0  100     0     3    20  298    18
6     4     0    0    1   0    0  2940     5     9    0   108
7     0     0    0   50   0    0     0  1111     1    0     2
8     0     0    0   48   0    0     2    35  1275    2     8
9     5     0   78  117   3   14     4   193   123  534    66
10    0     0    0    0   0    0     0     1     1    0  1644
better model found
persisted
after epoch: 12,now: 2024-07-15 22:08:12.657750,epoch time: 0:45:31.667023,used: 9:49:25.250630,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9852579, 'precision': 0.9576265, 'recall': 0.9414366, 'specificity': 0.9984486, 'f1': 0.94527256, 'auroc': 0.99984413}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    3    0     2     0     0    1     20
1     0  1323    0     0    0    0     0     8     1    0      0
2     1     0  212     0   54    0     1     2     0   41      1
3     0     1    0  8287    0    2     0    95    46    6      1
4     3     0    1     0  515    0     0     0     1    0     19
5     0     0    0     1    0  442     3     0     5   69      1
6     0     0    0     2    0    0  1900     0     0    0      6
7     0     9    0    14    0    0     1  7222    11    1      4
8     0     0    0     7    8    0     0    21  3239    2     19
9     2     0    2     0    1    2     0     1     0  485      0
10    0     0    1     4   37    1     1     1     3    0  12744
---- Validation: 
scalar performance:
{'acc': 0.98400426, 'precision': 0.95412606, 'recall': 0.93716043, 'specificity': 0.9983173, 'f1': 0.9405339, 'auroc': 0.9998386}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    2    0     2     1     0    0     24
1     0  1328    0     0    0    0     0     3     1    0      0
2     0     0  207     0   51    0     0     2     0   48      4
3     0     3    0  8271    0    4     0   108    49    5      0
4     4     0    0     0  515    0     1     1     1    0     17
5     0     0    0     4    0  429     1     0     2   85      0
6     0     0    0     1    1    0  1892     0     2    0     12
7     0    14    0    16    0    0     1  7221     9    1      3
8     0     0    0     7    9    0     0    12  3245    1     22
9     1     0    2     0    0    3     0     1     1  485      0
10    1     0    1     2   43    0     4     2     2    1  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7484083, 'precision': 0.67467844, 'recall': 0.61617863, 'specificity': 0.97446144, 'f1': 0.6087058, 'auroc': 0.88438255}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   915     7   0  33    2    0   139    45    13   10     6
1     0  1310   0   4    0    0     0   170     3    1    11
2     2     0  88   4  481    3    13    66   151   62   145
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  622    0     1     1     8    0  1001
5     2     0   4  66    2  169     9     3    27  309     1
6     0     0   0   0    0    0  2994     3     8    0    62
7     0     0   0  22    0    0     1  1136     3    0     2
8     0     0   0  17    9    0    16    19  1301    3     5
9     6     1  67  41   50   41    20    99   215  565    32
10    0     0   0   0   48    0     0     1     0    0  1597
new oracle model saved
early stop counter: 1
val acc:0.9840042591094971, best validation acc: 0.9855557084083557, corresponding to test acc:                         0.6915972828865051 / 0.748408317565918
after epoch: 13,now: 2024-07-15 22:52:31.341128,epoch time: 0:44:18.683378,used: 10:33:43.934008,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9816727, 'precision': 0.9614122, 'recall': 0.9404415, 'specificity': 0.9978731, 'f1': 0.94776046, 'auroc': 0.99976474}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    0    1     0     0     0    0      3
1     1  1315    0     1    0    0     0    10     1    0      4
2     0     0  227     0    7    1     0     0     0   74      3
3     0     3    0  8290    1   11     1    80    26    7     17
4     5     0    3     0  452    0     0     0     1    0     78
5     0     0    0     4    0  469     0     0     0   48      0
6    11     0    0     1    0    0  1881     1     2    0     11
7     1     3    2    29    1    0     1  7154    24    0     46
8     0     0    0    15    8    1     0     9  3152    1    110
9     0     0    1     0    0    4     0     0     0  488      0
10    3     0    0     3    4    0     0     0     1    1  12784
---- Validation: 
scalar performance:
{'acc': 0.9797512, 'precision': 0.9586885, 'recall': 0.9315182, 'specificity': 0.9976539, 'f1': 0.94057536, 'auroc': 0.99974585}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    0    1     1     0     0    0      6
1     0  1313    0     0    0    0     0    10     2    0      7
2     0     0  211     1   12    0     0     1     0   81      6
3     0     4    0  8289    0    8     0    84    35    7     13
4     4     0    0     0  443    1     0     0     0    1     90
5     0     0    0     5    0  464     0     0     0   52      0
6    12     0    0     0    1    0  1874     1     1    0     19
7     1     4    1    34    0    0     0  7143    31    3     48
8     0     0    1    12   13    1     1     9  3146    3    110
9     0     0    0     0    1    3     0     0     0  488      1
10    8     0    0     3    2    0     0     0     0    0  12783
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7180438, 'precision': 0.6685318, 'recall': 0.59746593, 'specificity': 0.9716128, 'f1': 0.58707917, 'auroc': 0.8732639}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   954     8   0  33    3    5    15    33    25   57    37
1     0  1176   0   6    0    0     0   242     3    1    71
2     7     0  60  13  271    9     4    42   110   92   407
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  265    0     1     1     2    0  1364
5     2     0   0  85    4  213     2     1    16  263     6
6     3     0   0   2    2    0  2958     3     4    0    95
7     0     0   0  52    0    0     1  1101     2    1     7
8     0     0   0  56   11    1    10    10  1243    6    33
9     5     0  33  92   19   81     4    58   114  663    68
10    0     0   0   0   15    0     0     1     0    0  1630
early stop counter: 2
val acc:0.9797512292861938, best validation acc: 0.9855557084083557, corresponding to test acc:                         0.6915972828865051 / 0.748408317565918
after epoch: 14,now: 2024-07-15 23:38:49.604636,epoch time: 0:46:18.263508,used: 11:20:02.197516,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98095036, 'precision': 0.9579856, 'recall': 0.9469885, 'specificity': 0.9979273, 'f1': 0.9492604, 'auroc': 0.9998314}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    2    0     2     2     0    0      2
1     0  1329    0     0    0    0     0     2     1    0      0
2     1     0  297     0    5    0     0     0     2    6      1
3     0     0    0  8116    0    3     0   241    76    2      0
4     4     0    6     0  449    0     0     1     1    1     77
5     0     0    0     1    0  387     0     0     0  133      0
6     3     0    0     0    0    0  1898     0     0    0      6
7     1     5    4    14    0    0     1  7228     5    1      3
8     0     0    0    10    6    0     0    29  3236    3     12
9     0     0   10     1    0    0     0     1     0  481      0
10    7     0    1     2    7    0     0     6     2    0  12768
---- Validation: 
scalar performance:
{'acc': 0.9811689, 'precision': 0.9624709, 'recall': 0.9498271, 'specificity': 0.99793553, 'f1': 0.9530701, 'auroc': 0.99981743}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     1    0    0     0     0     0    1      2
1     0  1325    0     1    0    0     0     6     0    0      0
2     0     0  300     0    4    0     0     0     0    6      2
3     0     2    0  8111    0    5     0   247    75    0      0
4     3     0    2     0  446    0     0     0     5    2     81
5     0     0    1     2    0  393     0     0     1  124      0
6     3     0    0     1    3    0  1894     0     1    0      6
7     1    11    2    11    0    0     1  7233     1    2      3
8     0     0    0    11    3    2     0    26  3240    1     13
9     0     0    6     0    0    0     0     0     0  487      0
10    7     0    1     3    1    0     0     9     2    0  12773
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.703981, 'precision': 0.6205244, 'recall': 0.57130754, 'specificity': 0.9701522, 'f1': 0.54007345, 'auroc': 0.8726068}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   910    10   0   48    2   1    74    64    13   39     9
1     0  1295   0    5    0   0     0   190     0    0     9
2    12     3  78    8  103   1     8   110   280   62   350
3     0     0   0    0    0   0     0     0     0    0     0
4     0     0   0    0   47   0     4     4    16    0  1562
5     3     0   6  113    0  96     1     7    34  324     8
6     1     0   0    1    0   0  3038     3     2    0    22
7     0     0   0    7    0   0     0  1154     1    0     2
8     0     1   0   38    0   1    13    46  1265    1     5
9     5     4  74   85    2  34     4   160   182  536    51
10    0     0   0    0    0   0     2     1     0    0  1643
early stop counter: 3
val acc:0.9811689257621765, best validation acc: 0.9855557084083557, corresponding to test acc:                         0.6915972828865051 / 0.748408317565918
after epoch: 15,now: 2024-07-16 00:26:56.309911,epoch time: 0:48:06.705275,used: 12:08:08.902791,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9871843, 'precision': 0.9567782, 'recall': 0.953913, 'specificity': 0.9986897, 'f1': 0.9528263, 'auroc': 0.99986947}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    2    0     4     0     0    0     13
1     0  1331    0     0    0    0     0     0     0    0      0
2     0     0  277     0   26    0     0     0     1    3      5
3     0     1    0  8325    0    0     0    54    60    0      0
4     3     0    0     0  529    0     0     0     2    0      5
5     0     0    0     4    0  509     0     0     6    2      0
6     0     0    0     0    0    0  1899     1     2    0      6
7     0     2    0    28    1    0     0  7213    16    0      2
8     1     1    0     0    2    0     0    10  3280    0      2
9     0     0   41     0    3   89     0     1     3  356      0
10    1     2    0     2   34    0     3     9    26    0  12714
---- Validation: 
scalar performance:
{'acc': 0.9869199, 'precision': 0.955245, 'recall': 0.9531115, 'specificity': 0.99867225, 'f1': 0.9506767, 'auroc': 0.999892}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    3    0     0     0     0    0     10
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  283     0   25    0     1     1     0    1      1
3     1     2    0  8318    0    0     1    56    62    0      0
4     2     0    1     0  527    0     0     0     2    0      7
5     0     0    2     2    1  512     1     0     3    0      0
6     0     0    0     0    0    0  1897     0     4    0      7
7     0     5    0    18    0    0     0  7223    17    0      2
8     0     0    0     1    1    0     0    10  3282    0      2
9     1     0   42     0    5  100     0     1     7  337      0
10    1     1    0     0   36    0     1    14    23    0  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6886588, 'precision': 0.6316621, 'recall': 0.56585574, 'specificity': 0.9686586, 'f1': 0.54144526, 'auroc': 0.8751418}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   609     5   2   62   29   12   174   160    52    4    61
1     0  1216   0    7    0    0     0   260     8    0     8
2     1     1  54   12  297   10     2   100   365    5   168
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  627    0     1     2    43    0   960
5     0     0   9  139   13  307     3     5    87   24     5
6     0     0   0    1   21    0  2889     4    29    0   123
7     0     0   0    9    0    0     0  1152     2    0     1
8     0     0   0   24    1    0     0    30  1314    1     0
9     3     3  86  127   40  167     2   156   414  105    34
10    0     0   0    0   70    0     0     2     4    0  1570
better model found
persisted
after epoch: 16,now: 2024-07-16 01:14:10.287709,epoch time: 0:47:13.977798,used: 12:55:22.880589,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9895655, 'precision': 0.9725377, 'recall': 0.96259475, 'specificity': 0.9988527, 'f1': 0.96647936, 'auroc': 0.99990326}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    3    0     2     0     0    0     14
1     0  1317    0     1    0    0     0    13     0    0      1
2     0     0  294     0    5    0     1     0     0   10      2
3     0     0    0  8406    0    4     0    18    10    0      0
4     4     0    3     0  500    0     0     0     2    0     30
5     0     0    0     4    0  516     0     0     0    1      0
6     3     0    0     0    0    0  1895     1     0    1      7
7     0     3    1    68    0    0     0  7176     9    0      6
8     0     0    0    32    2    2     2    10  3239    0      9
9     1     0    6     0    0   81     0     0     1  404      0
10    1     0    0     1   11    0     1     0     3    0  12775
---- Validation: 
scalar performance:
{'acc': 0.989247, 'precision': 0.97002494, 'recall': 0.9609158, 'specificity': 0.99883044, 'f1': 0.96414155, 'auroc': 0.9999097}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    4    0     0     0     0    0     10
1     0  1316    0     2    0    0     0    14     0    0      0
2     0     0  290     0    6    0     1     1     0   14      0
3     0     0    0  8397    0    4     0    24    15    0      0
4     4     0    2     0  496    1     0     1     2    0     33
5     0     0    0     0    0  520     0     0     1    0      0
6     7     0    0     0    0    0  1897     0     0    0      4
7     0     2    1    72    0    0     0  7175    11    0      4
8     0     0    0    26    1    0     0     3  3253    0     13
9     1     0    6     0    0   89     0     0     2  395      0
10    2     0    0     2   14    0     0     0     3    0  12775
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6772546, 'precision': 0.6395867, 'recall': 0.5729225, 'specificity': 0.96771127, 'f1': 0.54485774, 'auroc': 0.8729507}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   964     1   3   37    2   20    16    34     5    7    81
1     0  1030   0   31    0    0     5   374     3    0    56
2     4     1  82   17  115   19     0    78   272   20   407
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  102    0     2     1    20    0  1508
5     3     0   6   96    2  379     0     2    23   62    19
6     1     0   0    2    0    0  2896     1    16    0   151
7     0     0   0   45    0    0     0  1116     0    0     3
8     0     0   0   96    1    2     1    23  1240    1     6
9    10     0  50  207    8  250     1   110   170  231   100
10    0     0   0    0    5    0     1     0     0    0  1640
better model found
persisted
after epoch: 17,now: 2024-07-16 02:00:11.989104,epoch time: 0:46:01.701395,used: 13:41:24.581984,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9913046, 'precision': 0.9785524, 'recall': 0.9780237, 'specificity': 0.99907285, 'f1': 0.9780172, 'auroc': 0.9999366}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    1     2    0    0     1     0     0    1      3
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  305     0    2    1     0     0     1    2      1
3     0     1    0  8392    0    1     0    17    25    1      0
4     4     0    4     0  500    0     0     1     2    0     27
5     0     0    0     4    0  514     0     0     0    3      0
6     1     0    1     0    0    0  1904     0     0    1      1
7     1    14    0    49    0    0     1  7137    56    0      5
8     0     1    0    10    2    0     0     0  3279    0      3
9     0     0   12     0    0   29     0     0     1  451      0
10    7     0    1     1    6    0     2     0    13    0  12764
---- Validation: 
scalar performance:
{'acc': 0.9913869, 'precision': 0.97801995, 'recall': 0.9768875, 'specificity': 0.9990858, 'f1': 0.9771769, 'auroc': 0.9999429}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    0    2     1     0     0    2      0
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  307     0    0    0     0     1     1    3      0
3     0     1    0  8405    0    1     1    14    17    1      0
4     4     0    3     0  497    1     0     0     4    1     29
5     0     0    0     4    0  509     0     0     1    7      0
6     0     0    0     0    0    0  1904     1     0    1      2
7     0    13    1    51    1    0     3  7129    61    0      6
8     0     0    0     7    0    0     0     1  3288    0      0
9     1     0   13     1    0   29     0     1     2  446      0
10    2     0    2     1    9    0     3     1     9    0  12769
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.676555, 'precision': 0.64411086, 'recall': 0.54577255, 'specificity': 0.96755165, 'f1': 0.53019285, 'auroc': 0.87513614}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   668     2    7   55    1    9   184    71     8  158     7
1     0  1264    0   15    0    0     1   183     4    0    32
2     2     2  100   21  116    0     3    87   396   67   221
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  136    0     4     4    33    0  1455
5     0     0    6  171    0  138     2     5    45  220     5
6     0     1    0    1    0    0  2972     5    19    0    69
7     0     0    0   50    0    0     0  1111     1    0     2
8     0     0    0   67    0    0     0    34  1267    1     1
9     1     2   44  272    4   33     1   142   226  377    35
10    0     0    0    0    6    0     2     1     0    0  1637
better model found
persisted
after epoch: 18,now: 2024-07-16 02:46:24.701525,epoch time: 0:46:12.712421,used: 14:27:37.294405,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9880137, 'precision': 0.97517073, 'recall': 0.9726074, 'specificity': 0.9986633, 'f1': 0.9736978, 'auroc': 0.9999273}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    3    0     0     0     0    0      3
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  290     1    9    0     0     0     0   12      0
3     0     0    0  8428    0    0     0     4     3    0      0
4     1     0    3     0  522    0     0     0     1    0     12
5     0     0    3    12    0  482     0     0     0   24      0
6     5     0    0     1    0    0  1886     0     0    0     16
7     0     5    0   140    0    0     0  7085    30    1      3
8     0     0    2    93    3    0     0     2  3188    1      7
9     0     0    9     1    1    7     0     0     0  475      0
10    1     0    0     1   20    1     0     0     2    0  12768
---- Validation: 
scalar performance:
{'acc': 0.9883108, 'precision': 0.97531563, 'recall': 0.97462875, 'specificity': 0.99869555, 'f1': 0.9747973, 'auroc': 0.99991024}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    3    0     0     0     0    0      2
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     0  301     0    7    0     0     0     0    3      1
3     0     0    0  8432    0    0     0     4     4    0      0
4     2     0    1     0  517    0     0     0     1    0     18
5     0     0    3     8    0  484     0     0     0   26      0
6    10     0    0     1    1    0  1883     1     0    0     12
7     1     3    0   125    0    0     0  7107    28    0      1
8     1     0    2   106   11    0     0     3  3165    1      7
9     2     0   11     1    1    6     0     0     0  472      0
10    1     0    2     1   10    0     0     0     2    0  12780
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7214021, 'precision': 0.6595093, 'recall': 0.6050113, 'specificity': 0.9721352, 'f1': 0.6020364, 'auroc': 0.8755086}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1073     0    0   45    3    2     6    25     2   10     4
1      1  1211    0   30    0    0     1   214     4    0    38
2      6     0  127   27  367    4     1    32   199   61   191
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    0  370    0     2     3    23    0  1234
5      1     0   11  117   11  217     0     2    10  221     2
6      4     0    0    6    5    0  2833     2    11    0   206
7      0     0    0   52    0    0     0  1109     2    0     1
8      0     0    1   72   12    0     2    12  1262    2     7
9      8     0  110  175   31   96     2    50   132  489    44
10     0     0    0    0   25    0     0     1     0    0  1620
early stop counter: 1
val acc:0.9883108139038086, best validation acc: 0.991386890411377, corresponding to test acc:                         0.6765549778938293 / 0.748408317565918
after epoch: 19,now: 2024-07-16 03:32:16.946231,epoch time: 0:45:52.244706,used: 15:13:29.539111,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9924818, 'precision': 0.96994907, 'recall': 0.9732736, 'specificity': 0.9991983, 'f1': 0.97073996, 'auroc': 0.9999239}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    1     1     0     0    0      1
1     0  1324    0     1    0    0     0     6     0    0      1
2     0     0  309     1    1    0     0     0     0    1      0
3     0     0    0  8412    0    0     0    16     8    0      2
4     3     0   25     0  478    0     0     0     0    3     30
5     0     0    1     0    0  509     0     0     1   10      0
6     1     0    0     2    0    0  1902     0     0    0      3
7     1     2    1    25    0    0     0  7224     9    0      1
8     0     0    0    17    2    1     0     6  3261    1      6
9     1     0   27     1    0   24     0     0     0  439      1
10    8     0    5     0   15    0     1     5     1    0  12758
---- Validation: 
scalar performance:
{'acc': 0.9918149, 'precision': 0.9662399, 'recall': 0.973673, 'specificity': 0.9991404, 'f1': 0.96862125, 'auroc': 0.9999086}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    2    0     2     0     0    0      3
1     0  1326    0     0    0    0     0     5     1    0      0
2     0     0  310     0    1    0     1     0     0    0      0
3     0     0    0  8402    0    3     1    22     8    2      2
4     3     0   33     0  473    1     0     0     2    1     26
5     0     0    0     1    0  518     0     0     0    2      0
6     3     0    2     0    0    0  1899     0     2    0      2
7     1     3    4    21    0    0     1  7224     9    0      2
8     2     0    2    18    5    1     0     5  3255    0      8
9     0     0   32     0    0   20     0     0     0  441      0
10   13     0    3     1   15    0     1     3     5    0  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68579024, 'precision': 0.6305462, 'recall': 0.5743715, 'specificity': 0.96843266, 'f1': 0.56529284, 'auroc': 0.8715761}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   831     4    6   48    1    5    35   111    26   64    39
1     0  1198    1   14    0    0     2   250     7    0    27
2     3     0  155   16  216   13     2    56   167   28   359
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  238    0     2     3    13    0  1374
5     0     0   12  120    5  239     1     2    37  159    17
6     1     0    0    2    2    0  2736     3     6    0   317
7     0     0    0   17    0    0     0  1142     1    0     4
8     0     0    1   34    5    0     5    18  1290    1    16
9     3     1  187  144   11  128     0    97   155  342    69
10    0     0    0    0   13    0     2     0     0    0  1631
better model found
persisted
after epoch: 20,now: 2024-07-16 04:18:24.581076,epoch time: 0:46:07.634845,used: 15:59:37.173956,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99269587, 'precision': 0.98116255, 'recall': 0.9831146, 'specificity': 0.9992405, 'f1': 0.98199046, 'auroc': 0.99995804}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     0     0     0    1      1
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  290     0    2    0     0     0     2   18      0
3     0     0    0  8375    0    7     0    43    13    0      0
4     5     0    2     0  521    1     0     0     2    0      8
5     0     0    0     0    0  518     0     0     0    3      0
6     3     0    0     0    0    0  1900     0     1    0      4
7     0     4    0    30    0    0     0  7207    21    0      1
8     0     0    1     5    2    3     0     5  3280    0      0
9     0     0    0     0    0   19     0     0     0  474      0
10    1     0    1     0   13    0     1     0    45    1  12729
---- Validation: 
scalar performance:
{'acc': 0.9928046, 'precision': 0.98185635, 'recall': 0.98251796, 'specificity': 0.9992496, 'f1': 0.9820249, 'auroc': 0.99995416}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    1     1     0     0    0      1
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  288     0    1    1     0     0     1   21      0
3     0     0    0  8366    0    6     0    54    13    1      0
4     5     0    2     0  515    1     0     1     5    0     10
5     0     0    0     0    0  519     0     0     0    2      0
6     0     0    0     0    0    0  1905     0     0    0      3
7     0     3    1    24    0    0     0  7214    22    0      1
8     0     0    0     4    0    1     0     1  3290    0      0
9     0     0    0     0    0   16     0     0     0  477      0
10    3     0    1     1   16    0     1     0    40    0  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7370041, 'precision': 0.65412426, 'recall': 0.6174627, 'specificity': 0.97350883, 'f1': 0.60632044, 'auroc': 0.8818519}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   936     9    5  25    8    3    36    29    16   84    19
1     0  1328    0  11    0    0     0   135     5    1    19
2     3     3  118   6  308   10     2    28   309   53   175
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  393    0     3     1    51    0  1184
5     1     0   13  58    6  263     2     2    29  217     1
6     0     0    0   2    0    0  2938     2    47    0    78
7     0     0    0  20    0    0     0  1137     3    0     4
8     0     1    0  27    0    0     4     9  1327    1     1
9     3     4  109  67   23  107     1    49   276  476    22
10    0     0    0   0   23    0     2     1     2    0  1618
better model found
persisted
after epoch: 21,now: 2024-07-16 05:03:56.759114,epoch time: 0:45:32.178038,used: 16:45:09.351994,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.992241, 'precision': 0.97558594, 'recall': 0.96595955, 'specificity': 0.99918836, 'f1': 0.9692009, 'auroc': 0.9999525}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    1     1     1     0    0      0
1     0  1322    0     0    0    0     0     9     1    0      0
2     0     0  293     0    1    4     0     3     0   10      1
3     0     0    0  8389    0    7     0    41     2    0      0
4     5     0    2     0  496    2     0     0     8    1     25
5     0     0    0     2    0  519     0     0     0    0      0
6     0     0    0     0    0    0  1905     1     2    0      0
7     0     4    0     8    0    0     0  7248     1    0      1
8     0     0    0    16    0    3     1    16  3259    0      0
9     0     0    2     1    0   90     0     2     0  398      0
10    5     0    1     0    2    0     1     1     4    0  12778
---- Validation: 
scalar performance:
{'acc': 0.99216264, 'precision': 0.97560704, 'recall': 0.9677825, 'specificity': 0.99917865, 'f1': 0.97052854, 'auroc': 0.9999437}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    1     2     0     0    1      2
1     0  1326    0     0    0    0     0     5     1    0      0
2     0     0  291     0    1    4     0     3     1   12      0
3     0     0    0  8371    0    6     0    59     4    0      0
4     4     1    3     0  500    3     0     0     6    1     21
5     0     0    0     2    0  519     0     0     0    0      0
6     0     0    0     2    0    0  1905     0     0    0      1
7     0     4    0     7    0    0     0  7251     1    0      2
8     1     0    0    10    0    1     1    14  3269    0      0
9     0     0    3     1    0   78     0     2     0  409      0
10    6     0    1     1    2    0     4     2     5    0  12775
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6911075, 'precision': 0.6355859, 'recall': 0.57824504, 'specificity': 0.9690562, 'f1': 0.53871673, 'auroc': 0.86922836}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   954     1   1   34   1   19    81    56     5    8    10
1     1  1134   0   13   0    0     0   326     3    0    22
2    11     0  36   23  53   28    13   107   368   38   338
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  65    0     6     2    50    0  1510
5     1     0   1  136   1  367     2     6    24   52     2
6     0     0   0    2   0    0  3047     3     6    0     9
7     0     0   0   13   0    0     0  1149     0    0     2
8     0     0   0   65   0    1     2    25  1274    1     2
9     7     0  31  224   4  205     8   203   185  213    57
10    0     0   0    0   1    0     4     1     1    0  1639
early stop counter: 1
val acc:0.9921626448631287, best validation acc: 0.9928045868873596, corresponding to test acc:                         0.7370041012763977 / 0.748408317565918
after epoch: 22,now: 2024-07-16 05:51:06.979104,epoch time: 0:47:10.219990,used: 17:32:19.571984,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9933112, 'precision': 0.9815634, 'recall': 0.9738323, 'specificity': 0.999264, 'f1': 0.9772824, 'auroc': 0.99993646}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    5    0     0     0     0    0      3
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  306     0    0    0     1     0     0    4      1
3     1     1    0  8408    0    1     1    19     5    0      1
4     2     0    7     0  505    0     0     0     4    0     21
5     0     0    0    21    0  499     0     0     0    0      1
6     1     0    0     1    0    0  1903     0     1    0      2
7     0     6    0    20    0    0     1  7229     7    0      1
8     3     0    0    16    1    0     0     1  3253    1     20
9     0     1    3     2    0   53     0     0     0  434      0
10    1     0    0     0    3    0     1     1     2    0  12784
---- Validation: 
scalar performance:
{'acc': 0.99293834, 'precision': 0.9787259, 'recall': 0.970761, 'specificity': 0.9992347, 'f1': 0.97414917, 'auroc': 0.9999254}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    4    0     0     0     0    0      4
1     0  1330    0     1    0    0     0     1     0    0      0
2     0     0  302     0    0    3     0     1     0    5      1
3     1     0    0  8411    0    0     0    21     7    0      0
4     4     0   16     0  494    0     0     0     3    0     22
5     0     0    0    20    0  501     0     0     0    0      0
6     0     0    0     0    0    0  1907     0     0    0      1
7     0     8    0    31    0    0     1  7213    11    0      1
8     0     0    0    14    2    0     0     0  3269    0     11
9     0     0    1     2    0   59     1     0     0  430      0
10    1     0    1     1    1    1     0     1     0    0  12790
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7125866, 'precision': 0.656565, 'recall': 0.60062397, 'specificity': 0.97127175, 'f1': 0.58381987, 'auroc': 0.87418336}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1021     7    1   20    1    0    50    41     8   16     5
1      0  1291    0   19    0    0     0   158     3    0    28
2     10     7  122   49  186   13     5    61   293   36   233
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    0  281    0     2     2    27    0  1320
5      3     0    7  112    3  337     3     2    22  100     3
6      1     1    0    9    1    0  2901     2    26    0   126
7      0     0    0   75    0    0     0  1085     1    0     3
8      0     0    0   76    0    0     3    16  1270    1     4
9      8     6   73  203    7  208     5    93   249  243    42
10     0     0    0    0   10    0     1     1     0    0  1634
better model found
persisted
after epoch: 23,now: 2024-07-16 06:38:24.493202,epoch time: 0:47:17.514098,used: 18:19:37.086082,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9905287, 'precision': 0.9662345, 'recall': 0.9829674, 'specificity': 0.99907416, 'f1': 0.973403, 'auroc': 0.9999463}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    4    0     0     0     0    0      1
1     0  1329    0     1    0    0     0     1     0    0      0
2     0     0  287     0    8    0     0     0     0   17      0
3     0     0    0  8342    0    4     0    17    72    0      0
4     2     0    0     0  533    1     0     0     1    0      2
5     0     0    0     0    0  509     0     0     0   12      0
6     0     0    0     0    0    0  1907     0     0    0      0
7     0     6    0    18    0    0     1  7232     7    1      0
8     0     0    0     2    4    0     0     4  3285    1      0
9     0     0    3     0    0   12     0     0     0  478      0
10    3     0    1     1  129    0     6     7     5    0  12642
---- Validation: 
scalar performance:
{'acc': 0.9909857, 'precision': 0.9663913, 'recall': 0.9813909, 'specificity': 0.9991154, 'f1': 0.97268724, 'auroc': 0.9999338}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    4    0     2     0     0    0      0
1     0  1330    0     1    0    0     0     0     0    0      1
2     0     0  279     0    7    1     0     0     0   25      0
3     0     0    0  8369    0    6     0    18    47    0      0
4     2     0    1     0  534    0     0     0     1    0      1
5     0     0    0     0    1  509     0     0     0   11      0
6     1     0    0     0    0    0  1907     0     0    0      0
7     0     6    0    21    0    0     0  7227    10    1      0
8     1     0    0     2    4    1     1     6  3279    0      2
9     0     0    1     0    0    9     0     0     0  483      0
10    4     0    2     2  118    0     6     7     2    0  12655
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73847336, 'precision': 0.6722604, 'recall': 0.606503, 'specificity': 0.9735142, 'f1': 0.6020849, 'auroc': 0.88138324}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   817     4   1  16    4    1   214    33     7   69     4
1     0  1244   0  12    0    0     2   220     6    2    13
2     7     2  99   8  289    5    10    76   286   80   153
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   1   0  676    0     4     3    19    0   930
5     1     0   3  65    2  203     9     5    38  260     6
6     1     0   0   1    2    0  3026     3     4    0    30
7     0     0   0  49    0    0     0  1110     2    0     3
8     0     0   0  26    5    0    10    23  1299    3     4
9     4     1  63  90   17   57    10    97   273  501    24
10    0     0   0   0   64    0     1     1     0    0  1580
early stop counter: 1
val acc:0.9909856915473938, best validation acc: 0.9929383397102356, corresponding to test acc:                         0.7125865817070007 / 0.748408317565918
after epoch: 24,now: 2024-07-16 07:27:02.452721,epoch time: 0:48:37.959519,used: 19:08:15.045601,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9908765, 'precision': 0.97949064, 'recall': 0.977049, 'specificity': 0.9990417, 'f1': 0.9780807, 'auroc': 0.9999528}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    2    0     1     0     0    0      9
1     0  1328    0     0    0    0     0     1     0    0      1
2     0     0  287     0   13    1     1     0     1    7      2
3     1     3    0  8353    0   12     4    16    50    0      0
4     6     0    2     0  505    0     0     0     2    0     24
5     0     0    0     0    0  517     1     0     0    3      0
6     0     0    0     0    0    0  1903     0     2    0      3
7     1     7    0    14    1    0     0  7128   103    1      8
8     0     0    0     1    1    0     1     0  3288    0      5
9     0     0    5     0    0   14     0     0     1  473      0
10    1     0    0     0    6    0     1     0     2    0  12783
---- Validation: 
scalar performance:
{'acc': 0.98996925, 'precision': 0.9812184, 'recall': 0.9775622, 'specificity': 0.9989247, 'f1': 0.9791853, 'auroc': 0.9999408}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     1    2    0     1     0     0    0     10
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  294     0   10    0     1     1     0    5      1
3     0     4    0  8340    1   13     0    16    66    0      0
4     2     0    1     0  500    1     0     0     1    0     34
5     0     0    0     0    0  518     0     0     0    2      1
6     1     0    0     0    0    0  1900     0     3    0      4
7     1     6    0    27    0    0     0  7123   102    0      6
8     0     0    0     1    2    0     0     1  3281    0     11
9     0     0    3     0    0   16     0     0     0  474      0
10    0     0    0     1    8    0     0     0     5    0  12782
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69222695, 'precision': 0.6294013, 'recall': 0.57480025, 'specificity': 0.96879417, 'f1': 0.55552655, 'auroc': 0.8745947}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   836     3  12  10    0    5   147    77     7   54    19
1     0  1060   0   5    1    0     2   384     6    1    40
2     2     0  93   7  239    6     6   101   185   76   300
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  210    0     1     2    17    0  1403
5     4     0   9  43    4  218     3    18    22  266     5
6     0     0   0   2    2    0  2886     3    19    0   155
7     0     0   0   5    0    0     0  1153     3    0     3
8     0     0   0   8    5    0     0    31  1316    1     9
9     6     0  64  27    9   81     9   201   194  483    63
10    0     0   0   0    5    0     2     0     0    0  1639
early stop counter: 2
val acc:0.9899692535400391, best validation acc: 0.9929383397102356, corresponding to test acc:                         0.7125865817070007 / 0.748408317565918
after epoch: 25,now: 2024-07-16 08:15:18.204683,epoch time: 0:48:15.751962,used: 19:56:30.797563,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9926691, 'precision': 0.9874187, 'recall': 0.9797726, 'specificity': 0.9991982, 'f1': 0.9833141, 'auroc': 0.99996084}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     1    3    0     5     2     0    0      3
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  302     0    4    0     0     0     2    4      0
3     0     0    0  8426    0    0     0     4     7    0      0
4     4     0    0     0  523    0     0     0     2    0     10
5     1     0    0    20    0  473     0     0     5   22      0
6     1     0    0     1    0    0  1905     0     0    0      1
7     0     2    0    75    0    0     1  7159    23    0      1
8     0     0    0    31    1    0     0     1  3262    0      0
9     0     0    0     1    1    0     0     0     2  489      0
10    1     0    0     0    9    0     1     6    13    0  12765
---- Validation: 
scalar performance:
{'acc': 0.99304533, 'precision': 0.9877548, 'recall': 0.97863233, 'specificity': 0.99923253, 'f1': 0.9828655, 'auroc': 0.9999532}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    3    0     1     4     1    0     11
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  301     0    3    0     0     0     1    6      1
3     0     0    0  8430    0    0     0     4     6    0      0
4     3     0    1     0  525    0     0     0     2    0      8
5     0     0    0    22    0  472     0     0     2   25      0
6     1     0    0     0    0    0  1903     1     1    0      2
7     0     4    0    58    0    0     0  7184    19    0      0
8     0     0    0    38    1    0     0     0  3257    0      0
9     0     0    0     1    0    0     0     1     2  489      0
10    0     0    0     1    8    0     0     4    12    0  12771
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6782341, 'precision': 0.65622663, 'recall': 0.53542507, 'specificity': 0.9680402, 'f1': 0.52048826, 'auroc': 0.87214124}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   748    10   6   79    7   1    87   160    12   33    27
1     0  1209   0   16    0   0     0   265     2    0     7
2     3     3  37   49  194   0     6   146   359   41   177
3     0     0   0    0    0   0     0     0     0    0     0
4     0     0   0    0  520   0     3     5    37    0  1068
5     1     0   4  299    1  51     1     8    31  195     1
6     2     0   0    6    2   0  2945     8    19    0    85
7     0     0   0   44    0   0     0  1119     0    0     1
8     0     0   0  116    0   0     1    24  1226    0     3
9     2     1  22  310    8   7     2   235   263  254    33
10    0     0   0    0   54   0     3     1     3    0  1585
better model found
persisted
after epoch: 26,now: 2024-07-16 09:03:25.994493,epoch time: 0:48:07.789810,used: 20:44:38.587373,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99486303, 'precision': 0.9867799, 'recall': 0.99067533, 'specificity': 0.99947083, 'f1': 0.98865736, 'auroc': 0.9999721}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    1     0    4    0     0     0     0    0      2
1     0  1326    0     0    0    0     0     5     0    0      1
2     0     0  309     0    2    0     0     0     0    1      0
3     0     3    0  8374    0    1     0    12    46    1      0
4     0     0    2     0  533    0     0     1     2    0      1
5     0     0    0     4    2  510     0     0     2    3      0
6     3     0    0     0    1    0  1900     0     0    0      4
7     0     1    0    20    0    0     0  7224    18    0      0
8     0     0    0     1    2    0     0     2  3290    0      1
9     0     0    1     1    0    8     0     0     0  483      0
10    2     0    1     0   23    0     0     2     5    0  12759
---- Validation: 
scalar performance:
{'acc': 0.9949712, 'precision': 0.98695916, 'recall': 0.99002993, 'specificity': 0.9994813, 'f1': 0.9884166, 'auroc': 0.9999789}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    4    0     0     0     0    0      2
1     0  1327    0     0    0    0     0     4     1    0      0
2     0     0  306     0    4    0     0     0     0    2      0
3     0     1    0  8366    0    1     0    15    57    0      0
4     1     0    0     0  534    0     0     0     1    0      3
5     0     0    0     5    0  513     0     0     2    1      0
6     2     1    1     0    0    0  1897     1     0    0      6
7     0     0    0    14    1    0     0  7245     5    0      0
8     0     0    1     1    1    0     0     0  3292    0      1
9     0     0    3     0    0   11     0     0     0  479      0
10    1     0    1     0   22    0     0     1    10    0  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71622473, 'precision': 0.6555149, 'recall': 0.59253526, 'specificity': 0.9714692, 'f1': 0.5758117, 'auroc': 0.8771165}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1023     4    1  27    2    1    10    64     5   27     6
1      0  1068    0   4    0    0     1   375     4    1    46
2      4     2  101   2  191    2     2   110   351   60   190
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    4   0  404    0     3     3    37    0  1182
5      2     0    7  78    2  172     2    10    43  273     3
6      2     0    0   1    1    0  2927     5    58    0    73
7      0     0    0   6    0    0     0  1156     1    0     1
8      0     0    0  16    0    0     0    35  1317    2     0
9      2     0   85  56   14   39     3   194   247  470    27
10     0     0    0   0   44    0     1     1     1    0  1599
better model found
persisted
after epoch: 27,now: 2024-07-16 09:51:16.178528,epoch time: 0:47:50.184035,used: 21:32:28.771408,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99274933, 'precision': 0.9745445, 'recall': 0.97850776, 'specificity': 0.999255, 'f1': 0.9758141, 'auroc': 0.9999503}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    8    0     1     2     0    3      2
1     0  1320    0     1    0    0     0    10     0    0      0
2     0     0  285     0    5    0     0     1     0   21      0
3     0     0    0  8364    0    3     0    62     6    4      0
4     0     0    1     0  529    0     0     0     1    1      7
5     0     0    0     0    0  492     0     0     0   29      0
6     0     0    0     4    1    0  1901     0     0    2      0
7     0     2    0     8    0    0     0  7252     2    0      1
8     0     1    1     3    5    0     0     8  3269    3      4
9     1     0    2     0    1    0     0     0     0  489      0
10    1     0    1     1   51    0     0     0     0    0  12737
---- Validation: 
scalar performance:
{'acc': 0.99301857, 'precision': 0.97580796, 'recall': 0.9812386, 'specificity': 0.99928033, 'f1': 0.97803897, 'auroc': 0.9999485}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    4    0     1     3     0    0      2
1     0  1321    0     0    0    0     0    11     0    0      0
2     0     0  289     0    7    1     0     0     0   15      0
3     0     0    0  8369    0    7     0    51    11    2      0
4     0     0    4     0  523    0     0     0     2    1      9
5     0     0    0     0    0  496     0     0     0   25      0
6     0     0    0     0    1    0  1904     0     0    1      2
7     0     0    0     3    0    0     0  7258     1    1      2
8     0     1    0     4    3    0     3    14  3264    3      4
9     0     0    0     0    0    0     0     0     0  493      0
10    3     0    1     1   53    0     1     0     2    1  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7011824, 'precision': 0.65492487, 'recall': 0.5744661, 'specificity': 0.9699729, 'f1': 0.5637067, 'auroc': 0.8779831}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   788     5   4   55   12    2    72   138     8   73    13
1     0  1007   0   14    0    0     2   443     1    2    30
2     7     1  79   16  273    5    12    69   201  109   243
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  326    0     4     3    12    0  1288
5     1     0   1   92    1  173     1     6    16  298     3
6     2     0   0    7    1    0  3020     1    10    0    26
7     0     0   0   20    0    0     1  1142     0    0     1
8     0     0   0   56    5    0     7    35  1256    3     8
9     2     0  58  120   12   37     9   125   121  611    42
10    0     0   0    0   22    0     3     1     0    0  1620
early stop counter: 1
val acc:0.9930185675621033, best validation acc: 0.9949712157249451, corresponding to test acc:                         0.716224730014801 / 0.748408317565918
after epoch: 28,now: 2024-07-16 10:36:19.139093,epoch time: 0:45:02.960565,used: 22:17:31.731973,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9931507, 'precision': 0.9801543, 'recall': 0.9775287, 'specificity': 0.99928594, 'f1': 0.9784078, 'auroc': 0.999933}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   482     0    0     0    0    0     0     0     0    0      1
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  291     0    3    1     0     0     0   15      2
3     2     0    0  8386    0    0     0    37    11    0      1
4     6     0    0     0  525    0     0     0     4    0      4
5     0     0    0     4    0  516     0     0     0    1      0
6     1     0    0     0    0    0  1905     1     0    0      1
7     1     2    0    19    0    0     1  7213    23    0      3
8     1     0    0    13    2    0     2    18  3258    0      2
9     0     0    2     0    0   54     0     0     0  437      0
10    0     0    0     0    9    1     1     0     5    0  12777
---- Validation: 
scalar performance:
{'acc': 0.9934733, 'precision': 0.9810914, 'recall': 0.9791126, 'specificity': 0.99931, 'f1': 0.9795689, 'auroc': 0.99992484}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   483     0    0     0    0    0     0     0     0    0      0
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  303     0    1    1     0     0     0    6      1
3     0     0    0  8401    0    2     1    32     3    0      1
4     6     0    1     0  517    0     0     0     3    0     12
5     0     0    0     3    0  516     0     0     0    1      1
6     2     0    0     0    0    0  1906     0     0    0      0
7     1     0    0    23    0    0     0  7216    23    0      2
8     1     0    0    14    0    0     1    14  3261    0      5
9     1     0    3     0    0   55     0     1     1  432      0
10    5     0    0     0    9    1     3     0     1    0  12777
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6910376, 'precision': 0.6268246, 'recall': 0.5700487, 'specificity': 0.9688912, 'f1': 0.5451038, 'auroc': 0.87425166}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   977     0   2   13    1    1    54    72    26   18     6
1     0  1063   0    7    0    0     1   389     5    0    34
2    24     1  33   10  189    4     3    98   302   53   298
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  251    0     1     3    30    0  1348
5    13     0   3  114    2  188     5     7    48  194    18
6    19     0   0    2    2    0  2878     5    72    0    89
7     0     0   0    4    0    0     0  1156     3    0     1
8     0     0   0   22    1    0     6    28  1309    1     3
9    17     0  46  104   15   51     2   265   165  394    78
10    0     0   0    0   16    0     1     1     0    0  1628
early stop counter: 2
val acc:0.9934732913970947, best validation acc: 0.9949712157249451, corresponding to test acc:                         0.716224730014801 / 0.748408317565918
after epoch: 29,now: 2024-07-16 11:22:44.078731,epoch time: 0:46:24.939638,used: 23:03:56.671611,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_12_18_47_seed_1_21971821
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21971821 ON supergpu03 CANCELLED AT 2024-07-16T11:34:04 DUE TO TIME LIMIT ***
