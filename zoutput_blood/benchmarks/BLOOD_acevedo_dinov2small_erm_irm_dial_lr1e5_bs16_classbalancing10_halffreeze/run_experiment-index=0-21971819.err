Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 14 11:33:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819

 Experiment start at: 2024-07-14 12:01:04.957512
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92404217, 'precision': 0.8330653, 'recall': 0.7932903, 'specificity': 0.99173725, 'f1': 0.7942293, 'auroc': 0.99490047}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   388     0    0     5    0    1    21     0     7   18     43
1     0  1268    0    23    0    0     0    25     8    1      6
2     1     0  101     1   25    1     2     0    11  163      7
3     6     1    0  8164    0  114     7    48    92    6      0
4     4     0   45     1  184    2     2     1    55   29    216
5     0     0    0    11    0  381     0     0     4  124      1
6    15     0    0     4    1    0  1865     0     7    1     15
7    10    23    5   735    1    3     6  6067   350   29     33
8     1     0    0   184    2   17     2    12  3034   20     24
9     2     0    4     1    0   43     2     0     4  435      1
10   15     0    7     8    9    0    20     1    77    7  12650
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9241942, 'precision': 0.8449444, 'recall': 0.79924375, 'specificity': 0.9917054, 'f1': 0.8039588, 'auroc': 0.9950284}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   388     0    0     5    0    1    20     0     5   17     47
1     0  1271    0    19    0    1     1    21    10    1      8
2     0     0  120     0   20    3     2     1     7  149     10
3     5     2    0  8174    0  109     5    43    93    9      0
4     4     0   40     1  193    4     3     1    51   23    219
5     0     0    0    13    0  383     3     0     5  116      1
6    11     0    0     0    0    0  1873     0     5    2     17
7    12    23    4   779    1    1     4  6031   364   22     24
8     2     0    3   197    2   11     2    12  3018   18     31
9     0     0    5     4    0   49     1     0     4  429      1
10   14     0    2     8    8    0    17     3    67    6  12671
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6676695, 'precision': 0.6433445, 'recall': 0.5527281, 'specificity': 0.9665156, 'f1': 0.541536, 'auroc': 0.8827467}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   917     0   0   21   0    4   153    1    10   51    13
1     0  1201   0   47   0    0     2  167    30    3    49
2     6     0  49    3  83    5   106    6   208  155   394
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    0  24    0     4    0    14    0  1591
5     1     0   0   17   0  216    29    0     4  323     2
6     0     0   0    1   0    0  2822    0    23    0   221
7     0     0   0  620   0    1     3  508    26    4     2
8     0     0   0   71   0   12    10    0  1264    9     4
9     5     0  29   22   5   27    28    5    81  896    39
10    0     0   0    0   0    0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-14 12:35:02.800998,epoch time: 0:33:57.843486,used: 0:33:57.843486,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9443493, 'precision': 0.85982835, 'recall': 0.83209807, 'specificity': 0.99396855, 'f1': 0.84283304, 'auroc': 0.9966118}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     2    1    1     8    11     1    1     32
1     0  1213    0    10    0    0     0   100     5    0      4
2     1     0  195     0   56    0     1    32     6   19      2
3     0     0    1  7969    0    6     3   311   146    1      0
4     3     0   10     0  384    1     0    16    14    2    109
5     1     0    5    38    1  321     0     1    17  136      1
6    17     0    1     4    5    2  1841     4     2    2     29
7     0     3    0   117    2    0     2  7112    23    0      4
8     2     0    3    73   15    0     0   172  2990    0     41
9     1     0  106     6    8   26     0    24     8  311      3
10   16     0    2     6  152    0     4    58    19    2  12534
---- Validation: 
scalar performance:
{'acc': 0.94430923, 'precision': 0.8622277, 'recall': 0.83323836, 'specificity': 0.9939665, 'f1': 0.8448733, 'auroc': 0.99671966}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     4    1    0     2    11     0    2     32
1     0  1214    0    12    0    0     0   100     1    1      4
2     1     0  195     0   61    0     1    36     4   12      2
3     0     0    0  7975    0    6     0   309   150    0      0
4     3     0   17     0  372    1     0    19    19    2    106
5     0     0    5    40    0  333     1     2    23  116      1
6    20     0    2     2    3    0  1856     7     2    0     16
7     0     2    0   116    2    0     1  7110    31    0      3
8     3     0    1    61   20    0     0   195  2977    0     39
9     0     0  100     8    6   27     0    28    12  310      2
10   23     0    3     6  143    0     3    67    19    2  12530
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.662772, 'precision': 0.62824225, 'recall': 0.5445158, 'specificity': 0.9662467, 'f1': 0.5355579, 'auroc': 0.8779233}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   988    0    0  62    1    1     9    76     7   17     9
1     0  761    0  22    0    0     0   683     9    0    24
2     5    0  100   3  408    0     0   211   122   20   146
3     0    0    0   0    0    0     0     0     0    0     0
4     1    0    0   0  738    0     0     7     9    0   878
5     3    0   16  88    5  130     3     4    65  274     4
6     4    0    1   2   22    0  2612    14    28    0   384
7     0    0    0  81    0    0     0  1080     1    0     2
8     0    0    0  38   10    0     1    63  1251    1     6
9     5    0  237  53   19    8     3   318   208  270    16
10    0    0    0   0  103    0     0     0     0    0  1543
better model found
persisted
after epoch: 2,now: 2024-07-14 13:07:33.729344,epoch time: 0:32:30.928346,used: 1:06:28.771832,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9548641, 'precision': 0.89082927, 'recall': 0.83100057, 'specificity': 0.9949884, 'f1': 0.84958774, 'auroc': 0.9974927}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    0     3    0    4     9     7     1    6     36
1     0  1259    0    14    0    0     0    54     3    0      2
2     0     0  141     1   34    7     1    10     5  104      9
3     0     0    0  8273    0   29     0    91    43    1      1
4     5     0   16     1  261    3     0     7    33   14    199
5     0     0    0    17    0  485     0     0     2   16      1
6     9     0    1     4    1    1  1870     1     5    1     15
7     1     5    0   182    1    1     1  7043    21    3      6
8     0     0    0   190    7   10     0   118  2943    8     19
9     1     0    5     5    1  152     2     5     1  321      0
10   13     0    1     7   17    2     9    30    33    3  12676
---- Validation: 
scalar performance:
{'acc': 0.9565334, 'precision': 0.90087914, 'recall': 0.838462, 'specificity': 0.9951429, 'f1': 0.85815424, 'auroc': 0.9975889}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     2    0    2     4     6     2    0     37
1     0  1268    0    11    0    0     1    45     4    0      3
2     0     0  138     1   36    7     2    16     2   97     13
3     3     0    0  8284    0   20     1    96    35    1      0
4     3     0    9     1  285    3     0     6    28    9    195
5     0     0    0    14    0  485     0     0     2   18      2
6     7     0    0     4    1    0  1871     5     3    2     15
7     0     8    0   178    1    0     1  7055    15    2      5
8     2     0    0   182    6   12     0   131  2930   10     23
9     1     0    8     4    0  148     0     2     0  328      2
10   10     0    0     8   13    1     3    28    45    2  12686
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6731967, 'precision': 0.6457763, 'recall': 0.57817566, 'specificity': 0.967359, 'f1': 0.5587965, 'auroc': 0.87968284}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   900     0   0   77    1   15    83   33     5   38    18
1     0  1020   0   43    0    0     0  397    17    0    22
2     0     0  51   16  226   25     3   73   234  127   260
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   1    0  107    0     0    1    22    0  1502
5     0     0   0   55    1  433     1    1     5   94     2
6     0     0   0    6    3    0  2783    7    61    0   207
7     0     0   0  262    0    1     0  897     1    0     3
8     0     0   0  101    0    7     1   23  1236    1     1
9     0     0  15  115    9  219     2   67   125  549    36
10    0     0   0    0    0    0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-14 13:40:12.039297,epoch time: 0:32:38.309953,used: 1:39:07.081785,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96163315, 'precision': 0.9134732, 'recall': 0.8486148, 'specificity': 0.99570936, 'f1': 0.8733013, 'auroc': 0.9982854}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   360     0    0     4    2    0    24     6     3    1     83
1     0  1297    0     6    0    0     0    23     2    0      3
2     0     1  166     0   34    3     2     5     8   89      4
3     0     0    0  8140    0    7     1   202    86    1      0
4     1     0   14     0  303    1     2     4    24    6    184
5     0     0    0    24    0  453     1     0     3   39      1
6     1     1    0     1    0    1  1875     2     3    1     21
7     0    26    0    64    1    0     1  7103    58    2     10
8     0     1    1    52    0    3     1    66  3136    1     35
9     0     0   12     2    2   83     1     3     6  384      0
10    0     0    2     6   16    0     7    11    24    2  12725
---- Validation: 
scalar performance:
{'acc': 0.9626856, 'precision': 0.9189972, 'recall': 0.8559619, 'specificity': 0.99583274, 'f1': 0.8797427, 'auroc': 0.99829054}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   360     1    0     5    0    1    25     3     1    2     85
1     0  1296    0     6    0    0     0    29     1    0      0
2     0     0  170     0   31    2     1     6    10   90      2
3     0     1    0  8129    0    8     0   207    92    3      0
4     1     0   14     0  313    1     1     4    20    8    177
5     0     0    0    18    0  462     0     0     3   37      1
6     1     0    0     2    0    0  1886     1     3    1     14
7     0    27    0    53    2    0     1  7096    66    0     20
8     0     2    3    46    2    2     1    56  3153    1     30
9     0     0    8     2    2   70     2     3     8  397      1
10    0     1    1     8   12    0    11     8    26    1  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6752256, 'precision': 0.640962, 'recall': 0.55402476, 'specificity': 0.9668012, 'f1': 0.53610426, 'auroc': 0.883286}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   303     7    2   63    0    6   590    31    56   68    44
1     0  1271    0   22    0    0     0   192     7    0     7
2     0     0  106    9  207    7    14    39   313   63   257
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  183    0     1     1    15    1  1432
5     0     0    0  130    0  288     7     0    37  129     1
6     0     1    0    1    1    0  2977     3    32    0    52
7     0     0    0   60    0    0     0  1100     3    0     1
8     0     0    0   37    1    0     2    17  1307    1     5
9     0     3   67  104   10  144    11    78   211  475    34
10    0     0    0    0    4    0     0     1     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-14 14:12:43.297513,epoch time: 0:32:31.258216,used: 2:11:38.340001,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95965326, 'precision': 0.894701, 'recall': 0.86762595, 'specificity': 0.9956096, 'f1': 0.8787126, 'auroc': 0.9981348}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     1    0     6    2    4     5     7     1    8     30
1     0  1245    0     6    0    0     0    79     1    0      0
2     0     0  193     1    4    3     1    22     6   81      0
3     0     0    0  8273    0    9     2   129    25    1      0
4     1     0   57     0  349    3     0    13    30   11     74
5     0     0    0    12    0  494     0     0     3   11      1
6     9     0    1     4    0    2  1868     7     2    2     13
7     0     0    0   129    0    0     1  7115    12    0      6
8     1     1    0   201    1    1     0   120  2956    5      9
9     0     0    8     4    0  125     0     6     3  346      1
10    1     0    9     7   81    2     4    34    44    2  12610
---- Validation: 
scalar performance:
{'acc': 0.9598502, 'precision': 0.895965, 'recall': 0.8714538, 'specificity': 0.99563146, 'f1': 0.8812603, 'auroc': 0.9981056}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     8    1    3     0     5     0    4     31
1     0  1244    0     9    0    0     0    77     1    0      1
2     0     0  202     0    6    3     1    19     2   79      0
3     1     0    0  8251    0   12     1   149    25    1      0
4     3     0   63     0  333    2     0    13    35    9     81
5     0     0    0    13    0  495     0     0     3    9      1
6     9     0    1     3    1    4  1865    11     5    1      8
7     0     2    0   130    1    0     1  7112    14    0      5
8     0     0    0   182    1    2     2   118  2981    2      8
9     0     0    7     5    0  118     0     5     3  355      0
10    5     0    5     7   74    2     2    23    54    9  12615
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6820821, 'precision': 0.6974058, 'recall': 0.5703285, 'specificity': 0.9687675, 'f1': 0.57104623, 'auroc': 0.88374346}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   726    6    1  199    2   33    23   114    22   33    11
1     0  891    0   29    0    0     0   566     3    0    10
2     0    0  119   52  106   39     2   123   346  102   126
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    2    0  524    0     2     7    31    1  1066
5     0    0    0  182    0  384     1     0     7   18     0
6     0    0    0    2    0    0  2974     4    20    0    67
7     0    0    0  103    0    0     0  1060     0    0     1
8     0    0    0  203    0    0     1    23  1141    1     1
9     1    0   12  337    3  192     0   156   107  317    12
10    0    0    0    0   32    0     0     1     0    0  1613
new oracle model saved
early stop counter: 1
val acc:0.9598501920700073, best validation acc: 0.9626855850219727, corresponding to test acc:                         0.6752256155014038 / 0.6820821166038513
after epoch: 5,now: 2024-07-14 14:45:19.465576,epoch time: 0:32:36.168063,used: 2:44:14.508064,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96864295, 'precision': 0.92995423, 'recall': 0.89735603, 'specificity': 0.99650013, 'f1': 0.9088245, 'auroc': 0.99897736}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     2    0    0    15     0     1    9     19
1     0  1292    0     5    0    0     0    32     2    0      1
2     0     0  257     0    5    0     0     2     0   47      1
3     0     0    0  8177    0    3     1   229    29    0      0
4     4     0   41     0  334    2     0     4     6    9    139
5     0     0    0    24    0  399     0     0     1   96      1
6     1     0    1     1    0    0  1894     1     0    2      7
7     0     8    3    53    1    0     1  7162    26    1      7
8     1     0    2    88    6    0     1    85  3065    4     43
9     0     0   20     4    0   16     0     2     0  450      1
10    5     0    3     6   16    0     7     5    12    2  12737
---- Validation: 
scalar performance:
{'acc': 0.968276, 'precision': 0.92457235, 'recall': 0.89042205, 'specificity': 0.9964657, 'f1': 0.90334857, 'auroc': 0.99897754}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     0    1    0    10     0     0    4     32
1     0  1285    0     3    0    0     2    37     3    0      2
2     0     0  236     0   12    0     1     2     2   59      0
3     0     1    0  8201    0    1     1   208    27    1      0
4     5     0   39     0  335    1     1     3     4   13    138
5     0     0    0    24    0  404     0     0     2   90      1
6     0     0    1     0    0    0  1901     0     1    0      5
7     0     8    3    55    2    0     1  7162    27    2      5
8     1     0    7    99    6    1     0    88  3050    4     40
9     1     0   17     6    0   24     0     1     1  443      0
10    4     0    3     4   17    0    11     5     5    1  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7048905, 'precision': 0.6894209, 'recall': 0.57133746, 'specificity': 0.9701929, 'f1': 0.5712408, 'auroc': 0.8837675}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   480     0    1  102    1    0   318    49    17  193     9
1     0  1227    0   14    0    0     1   218     5    4    30
2     0     0  262   15  207    0    33    62   148  121   167
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    5    0  316    0     6     2     6    1  1297
5     0     0    1  163    0  111     4     0    17  296     0
6     0     0    0    1    0    0  3049     2     7    0     8
7     0     0    0   53    0    0     0  1109     0    0     2
8     0     0    0   93    2    0     6    28  1227    3    11
9     0     0  125  128    3   13    11    80    99  664    14
10    0     0    0    0   13    0     2     1     0    0  1630
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-14 15:17:48.904874,epoch time: 0:32:29.439298,used: 3:16:43.947362,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96425515, 'precision': 0.9290751, 'recall': 0.8637979, 'specificity': 0.99617517, 'f1': 0.8818406, 'auroc': 0.99897}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     1    1    0    19     1     4    2     34
1     0  1306    0     3    0    0     0    21     2    0      0
2     1     0  149     2   35    0     2     5     6  103      8
3     0     0    0  8035    0    1     0   157   241    2      1
4     3     0    3     1  376    0     1     4    25    8    118
5     0     0    0    26    0  334     0     0     6  154      1
6     1     1    0     1    0    1  1876     8     5    1     14
7     0    11    0    52    1    0     1  7125    68    0      6
8     0     0    0    10    6    0     0    28  3235    1     14
9     1     0    2     5    0   12     1     1     8  463      0
10    2     2    0     8   10    0     3    12    37    0  12720
---- Validation: 
scalar performance:
{'acc': 0.9656279, 'precision': 0.9325315, 'recall': 0.86711276, 'specificity': 0.99631083, 'f1': 0.8858958, 'auroc': 0.9990063}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     2    0    0    14     5     2    5     39
1     0  1304    0     3    0    0     0    23     2    0      0
2     1     0  149     0   39    0     1     8     6  101      7
3     0     1    0  8078    0    1     0   141   218    1      0
4     0     2    2     1  376    0     1     3    26    6    122
5     0     0    0    26    0  354     0     0     7  133      1
6     1     1    0     0    0    0  1884     2     5    1     14
7     0     9    0    51    1    0     1  7113    85    0      5
8     0     0    0    10    6    0     0    24  3246    0     10
9     1     0    1     6    0   10     0     1     8  464      2
10    1     2    0     6   17    1     4    13    36    0  12716
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.649129, 'precision': 0.67704976, 'recall': 0.50568175, 'specificity': 0.9640702, 'f1': 0.48505443, 'auroc': 0.8807508}
confusion matrix:
     0     1   2    3    4   5     6    7     8    9     10
0   223     1   0   60    1   2   773   14    21   59    16
1     0  1275   0   15    0   0     0  190    10    0     9
2     0     0  16   12  139   0    17   28   402   93   308
3     0     0   0    0    0   0     0    0     0    0     0
4     0     0   0    0  280   0     3    1    21    1  1327
5     0     0   0  228    0  77    41    0    56  189     1
6     0     0   0    3    0   0  2981    1    54    0    28
7     0     0   0  195    0   0     0  960     8    0     1
8     0     0   0   45    0   0     1    1  1320    1     2
9     0     1   6  170    7  12    40   26   319  515    41
10    0     0   0    0   14   0     0    1     0    0  1631
early stop counter: 1
val acc:0.965627908706665, best validation acc: 0.9682760238647461, corresponding to test acc:                         0.7048904895782471 / 0.7048904895782471
after epoch: 7,now: 2024-07-14 15:49:50.602351,epoch time: 0:32:01.697477,used: 3:48:45.644839,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9729506, 'precision': 0.92819285, 'recall': 0.9031929, 'specificity': 0.9971341, 'f1': 0.91060454, 'auroc': 0.999209}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     3    1    1    30     0     1    1     12
1     0  1306    0     3    0    0     0    22     1    0      0
2     1     0  196     0   54    4     1     1     2   53      0
3     0     0    0  8259    0   39     3    56    80    2      0
4     4     0    0     0  432    1     1     0     7    3     90
5     0     0    0     5    0  508     0     0     1    6      1
6     1     0    0     1    0    0  1903     0     0    0      3
7     0     7    3   114    4    0     1  7046    76    1      9
8     0     0    0    34    9    2     2    14  3218    1     16
9     1     0    3     1    3  119     1     0     3  362      0
10    4     0    1     7   27    1    34     3    14    1  12701
---- Validation: 
scalar performance:
{'acc': 0.97279656, 'precision': 0.92312145, 'recall': 0.8992684, 'specificity': 0.99713206, 'f1': 0.9062925, 'auroc': 0.99917257}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     4    1    0    28     0     1    1     12
1     0  1304    0     3    0    0     0    23     2    0      0
2     1     0  185     0   64    3     1     1     2   55      0
3     0     0    0  8273    0   35     3    52    74    3      0
4     4     0    2     0  439    2     4     1     5    0     82
5     0     0    0     4    0  498     1     0     2   15      1
6     1     0    0     0    0    0  1900     1     2    0      4
7     0     6    1   126    3    0     5  7035    82    0      7
8     0     0    0    30    6    2     5    12  3227    1     13
9     2     0    9     1    5  112     3     0     1  360      0
10    7     0    1     7   30    1    20     2    17    0  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6911775, 'precision': 0.6370667, 'recall': 0.577118, 'specificity': 0.9681556, 'f1': 0.54615813, 'auroc': 0.88321257}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   437     1   0  48    0   17   611    26    15   12     3
1     0  1272   0  12    0    1     6   173    16    0    19
2     0     0  25   2  406   37    69    21   205   33   217
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  359    0     8     1    12    0  1253
5     0     0   0  40    1  473    29     0    22   27     0
6     0     0   0   1    0    0  3052     1     6    0     7
7     0     0   0  75    0    1     0  1083     4    0     1
8     0     0   0  38    1    2    11     8  1304    0     6
9     0     0  29  31   66  336    67    34   294  246    34
10    0     0   0   0   16    0     1     1     0    0  1628
better model found
persisted
after epoch: 8,now: 2024-07-14 16:22:04.609961,epoch time: 0:32:14.007610,used: 4:20:59.652449,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.974101, 'precision': 0.9352709, 'recall': 0.9050894, 'specificity': 0.99718153, 'f1': 0.91463506, 'auroc': 0.9993}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     2    1    0     3     0     1    0     23
1     0  1322    0     5    0    0     0     4     0    0      0
2     2     0  178     0   25    4     1     3     1   96      2
3     0     1    0  8383    0   10     0    28    15    1      0
4     4     0    9     0  407    2     0     1     8    3    105
5     0     0    0     4    0  501     0     0     1   14      1
6     3     0    0     3    0    1  1888     1     4    0      7
7     0   121    0   135    1    0     1  6965    22    2     16
8     0     3    0    92    4    4     0    29  3154    1      7
9     0     0    1     4    0   72     0     0     1  415      0
10    1     4    1     9    7    0     4     3    23    1  12742
---- Validation: 
scalar performance:
{'acc': 0.9753912, 'precision': 0.94197434, 'recall': 0.9064313, 'specificity': 0.9972959, 'f1': 0.9179801, 'auroc': 0.99932915}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     1    1    0     4     2     0    0     21
1     0  1322    0     3    0    0     0     5     1    0      1
2     3     1  179     1   19    3     1     1     1  101      2
3     0     1    0  8385    0    5     0    29    20    0      0
4     3     1    3     0  399    2     0     1     6    7    117
5     0     0    0     7    0  499     0     0     0   14      1
6     3     1    0     0    0    1  1895     1     2    0      5
7     2    76    0   149    1    1     2  6997    27    2      8
8     0     3    0    93    7    5     0    20  3158    1      9
9     0     0    2     2    0   64     0     0     0  425      0
10    1     2    0     9    4    1     6     2    19    0  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6885888, 'precision': 0.6692789, 'recall': 0.57816815, 'specificity': 0.9690804, 'f1': 0.57411903, 'auroc': 0.8779132}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   873     3   1  109    1   11    75    5    27   41    24
1     0  1414   0   16    0    0     0   56     9    0     4
2     0     2  55   17  249   25     1   16   247  126   277
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   1    1  169    0     0    1    17    1  1443
5     0     0   0  115    0  354     1    0    13  109     0
6     0     1   0    3    0    0  2849    2    97    1   114
7     0     0   0  444    0    0     0  716     3    0     1
8     0     0   0  130    1    1     1    2  1231    2     2
9     2     2  17  144   16  208     2   23   150  541    32
10    0     0   0    0    5    0     0    1     0    0  1640
better model found
persisted
after epoch: 9,now: 2024-07-14 16:55:44.123216,epoch time: 0:33:39.513255,used: 4:54:39.165704,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.94651604, 'recall': 0.9303987, 'specificity': 0.9974309, 'f1': 0.9371971, 'auroc': 0.9995381}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    0     1     0     0    0      5
1     0  1277    0     2    0    0     0    49     4    0      0
2     3     0  266     0   16    0     0    17     0    9      1
3     1     0    0  8153    0    2     0   207    75    1      0
4     7     0   11     1  429    0     3     1     8    1     78
5     0     0    0     7    0  491     1     1     3   17      1
6     5     0    0     0    1    1  1891     1     1    0      8
7     4     1    0    37    1    0     1  7198    16    0      5
8     4     0    3    20    5    1     1    49  3189    1     22
9     4     0   29     4    0   59     0     7     2  388      0
10   15     0    0     7   11    1     6     1     8    0  12742
---- Validation: 
scalar performance:
{'acc': 0.9752307, 'precision': 0.94157624, 'recall': 0.92399776, 'specificity': 0.9972665, 'f1': 0.9315073, 'auroc': 0.9995098}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    0    0     0     2     0    0      4
1     0  1271    0     3    0    0     1    53     1    0      3
2     2     0  256     0   24    0     0    15     0   15      0
3     2     0    1  8147    0    4     0   214    71    0      1
4    11     0   10     0  415    0     1     0     6    1     95
5     1     0    0    11    0  487     1     1     4   15      1
6    10     0    0     0    0    0  1890     2     0    0      6
7     3     0    0    39    0    0     1  7193    16    0     13
8     2     0    2    20    5    0     2    47  3191    2     25
9     6     0   33     5    3   52     0     5     0  389      0
10   18     0    1     9   13    0     7     1     3    0  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70621985, 'precision': 0.6569159, 'recall': 0.5922338, 'specificity': 0.9703429, 'f1': 0.5766751, 'auroc': 0.8831295}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   928    2    0   29    0    1   122    68    12    4     4
1     2  991    0    9    0    0     6   431    17    0    43
2     9    0  122   14  197   10    30    69   239   56   269
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    1    0  194    0     3     1    19    0  1415
5     6    0    1  104    0  312    11     2    29  127     0
6     0    0    0    1    0    0  3040     2     5    0    19
7     0    0    0   32    0    0     0  1127     4    0     1
8     0    0    0   44    0    0     0    25  1297    1     3
9     9    0   76   93    4  106    16   155   194  451    33
10    0    0    0    0    8    0     4     1     1    0  1632
new oracle model saved
early stop counter: 1
val acc:0.9752306938171387, best validation acc: 0.9753912091255188, corresponding to test acc:                         0.6885887980461121 / 0.7062198519706726
after epoch: 10,now: 2024-07-14 17:28:25.830688,epoch time: 0:32:41.707472,used: 5:27:20.873176,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9813249, 'precision': 0.9484241, 'recall': 0.9448017, 'specificity': 0.99803925, 'f1': 0.94597244, 'auroc': 0.9996118}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    1    0     4     1     0    0      5
1     0  1309    0     1    0    0     0    19     1    0      2
2     1     0  269     0   17    0     0     3     4   18      0
3     0     1    0  8338    0    0     1    43    54    0      1
4     4     0   10     1  469    0     0     0    20    0     34
5     2     0    1    19    0  438     1     0     5   54      1
6     2     0    0     0    1    0  1900     1     0    0      4
7     0     5    0    64    0    0     2  7110    79    0      5
8     0     0    0    15    2    0     1     8  3260    0     10
9     1     0   16     3    0   13     0     2     5  452      0
10   12     0    1     7   71    1     1    10    26    0  12662
---- Validation: 
scalar performance:
{'acc': 0.9810887, 'precision': 0.94723713, 'recall': 0.948643, 'specificity': 0.9980234, 'f1': 0.9475691, 'auroc': 0.9995948}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    1    0     4     1     0    0      2
1     0  1307    0     2    0    0     0    20     2    0      1
2     1     0  274     0   16    1     0     2     1   16      1
3     1     1    0  8332    0    0     0    42    64    0      0
4     4     0    7     1  475    1     1     0    19    2     29
5     1     0    0    10    0  455     1     0     6   47      1
6     1     0    0     1    0    0  1897     0     1    0      8
7     0     5    0    74    1    0     1  7103    76    0      5
8     0     0    0    16    2    0     0    10  3259    0      9
9     0     0   20     5    0   19     0     0     4  445      0
10    9     0    1     7   84    1     7     6    23    1  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7288183, 'precision': 0.675443, 'recall': 0.6044073, 'specificity': 0.97263056, 'f1': 0.601471, 'auroc': 0.885071}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   872     4    0   40    0    0   190    26    19   12     7
1     0  1133    0    5    0    2     0   329    12    0    18
2     2     0  133    7  228    7     5    59   387   68   119
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    9    0  714    0     1     4    36    0   869
5     4     0    1  115    1  228    12     2    64  164     1
6     0     0    0    1    4    0  2914     2    52    1    93
7     0     0    0   40    0    0     1  1118     4    0     1
8     0     0    0   26    0    0     0     8  1335    1     0
9     4     0   76   85    7   69    11    85   372  412    16
10    0     0    0    0   85    0     0     1     1    1  1558
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-14 18:01:12.757289,epoch time: 0:32:46.926601,used: 6:00:07.799777,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9841877, 'precision': 0.9547846, 'recall': 0.93895215, 'specificity': 0.9983189, 'f1': 0.9446116, 'auroc': 0.9996822}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    6    0     0     1     0    0     22
1     0  1312    0     1    0    0     0    19     0    0      0
2     0     0  218     0   71    1     1     3     2   14      1
3     1     0    0  8331    0    0     0    68    38    1      0
4     0     1    0     0  514    0     0     1     3    0     20
5     0     0    0    12    0  492     0     0     2   14      1
6     5     0    0     1    1    0  1887     2     1    0     11
7     0     3    0    40    0    0     1  7196    20    0      3
8     0     1    0    20    9    1     0    25  3233    0      7
9     1     0   15     2    7   39     1     0     3  425      0
10    2     1    2     8   36    0     1     8    10    0  12723
---- Validation: 
scalar performance:
{'acc': 0.9837635, 'precision': 0.9498288, 'recall': 0.9364433, 'specificity': 0.99828184, 'f1': 0.94122964, 'auroc': 0.999698}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     2   10    0     1     2     1    0     15
1     0  1314    0     2    0    0     0    16     0    0      0
2     0     0  218     0   72    0     1     3     0   18      0
3     0     1    0  8323    0    2     0    66    48    0      0
4     2     0    1     0  506    0     0     1     4    0     25
5     0     0    0     7    0  498     0     0     4   11      1
6     0     0    0     2    0    0  1895     0     0    0     11
7     0     4    0    34    1    0     1  7211    10    0      4
8     0     2    0    24    7    0     0    25  3229    1      8
9     0     0   28     4    6   34     0     3     4  414      0
10    4     0    1     8   47    0     0    12     6    0  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7130064, 'precision': 0.658431, 'recall': 0.5998822, 'specificity': 0.97141135, 'f1': 0.5905998, 'auroc': 0.87890625}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   767     3   0  179   10    5    30    41    18   56    61
1     0  1234   0   16    0    0     0   244     3    0     2
2     0     0  50   29  450   17     1    77   201   61   129
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  514    0     3     4    19    0  1092
5     0     0   2  132    2  354     1     0    17   84     0
6     0     8   0   16    3    0  2861     6    41    0   132
7     0     0   0   31    0    0     0  1131     1    0     1
8     0     0   0   65    0    0     0    16  1286    1     2
9     0     2  40  179   35  177     2   112   201  380     9
10    0     0   0    0   29    0     0     1     2    0  1614
better model found
persisted
after epoch: 12,now: 2024-07-14 18:34:45.884557,epoch time: 0:33:33.127268,used: 6:33:40.927045,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98507065, 'precision': 0.9617517, 'recall': 0.95946634, 'specificity': 0.99837273, 'f1': 0.96027935, 'auroc': 0.99977773}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     5    4    0     3     3     1    0      8
1     0  1307    0     0    0    0     0    25     0    0      0
2     0     0  295     0    2    0     1     1     1   11      1
3     0     2    0  8338    0    2     0    85    11    0      0
4     3     0   14     0  489    0     0     0    10    1     21
5     0     0    0     9    0  465     1     0     2   43      1
6     1     0    0     0    0    0  1894     2     2    0      8
7     0     1    1    34    1    0     1  7216     5    0      5
8     0     0    2    45    0    0     0    50  3176    0     22
9     0     0   13     3    0   12     0     0     0  465      0
10    2     0    2     5   56    0     2     2     9    1  12714
---- Validation: 
scalar performance:
{'acc': 0.98486024, 'precision': 0.9591906, 'recall': 0.95669, 'specificity': 0.9983613, 'f1': 0.9575066, 'auroc': 0.99974394}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     4    7    0     5     3     0    3      6
1     0  1310    0     0    0    0     0    22     0    0      0
2     0     0  287     0    5    1     1     1     1   16      0
3     0     4    0  8345    0    1     0    78    12    0      0
4     0     0   11     0  492    0     0     0     7    1     28
5     0     0    0    10    0  464     1     0     2   43      1
6     2     0    0     1    0    0  1898     0     3    0      4
7     0     0    0    29    0    0     1  7221     9    0      5
8     0     1    3    52    1    0     0    43  3174    1     21
9     1     0   15     3    0    8     0     0     2  464      0
10    1     0    4     7   63    0     3     1     8    0  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6761352, 'precision': 0.65029263, 'recall': 0.55846804, 'specificity': 0.96755636, 'f1': 0.5594653, 'auroc': 0.878923}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   593     5    0  159    5    4   155   139    18   42    50
1     0  1017    0    8    0    0     0   463     3    0     8
2     0     1  137   14  304    7     4    61   263   64   160
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  445    0     2     3    18    0  1161
5     0     0    7  124    1  218     2     3    18  218     1
6     0     0    0   15    1    0  2809     5    59    0   178
7     0     0    0   68    0    0     0  1093     2    0     1
8     0     0    0  108    0    0     0    42  1216    1     3
9     1     0  101  109   12   66     1   106   198  522    21
10    0     0    0    0   29    0     2     1     0    0  1614
better model found
persisted
after epoch: 13,now: 2024-07-14 19:07:10.110187,epoch time: 0:32:24.225630,used: 7:06:05.152675,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97819453, 'precision': 0.9292859, 'recall': 0.9221674, 'specificity': 0.99775106, 'f1': 0.9182987, 'auroc': 0.9996104}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    3    0     6     1     2    1      3
1     0  1328    0     2    0    0     0     1     1    0      0
2     0     0  175     0   81    2     1     0     0   53      0
3     0     1    0  8396    0   13     0    24     5    0      0
4     4     0    0     1  512    1     1     0     2    1     17
5     0     0    0     1    0  516     1     0     0    3      0
6     1     0    0     1    0    0  1901     0     2    0      3
7     0    28    4   101   18    1     3  7064    27    2     17
8     0     0    2   104   16    8     3     3  3148    1     10
9     0     0    1     2    0  108     1     0     1  380      0
10    2     0    2     6   92    0     3     0     9    0  12675
---- Validation: 
scalar performance:
{'acc': 0.97707635, 'precision': 0.9279807, 'recall': 0.9202249, 'specificity': 0.99764824, 'f1': 0.91491395, 'auroc': 0.99959826}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     2    4    0     4     0     2    0      0
1     0  1325    0     3    0    0     0     2     1    0      1
2     0     0  170     0   93    1     1     0     1   46      0
3     0     1    0  8402    0   12     0    20     4    0      1
4     3     0    0     0  516    1     0     0     3    0     16
5     0     0    0     1    0  518     0     0     0    2      0
6     1     0    0     0    0    0  1901     0     3    0      3
7     0    33    2    90   20    0     1  7061    37    1     20
8     0     0    0   102   19    4     1     5  3150    2     13
9     0     0    3     3    3  115     0     0     0  369      0
10    3     1    1     7  116    1     7     0    15    0  12645
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72518015, 'precision': 0.65223217, 'recall': 0.6076584, 'specificity': 0.9725898, 'f1': 0.5898729, 'auroc': 0.8818893}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   748     3   1  121    3   24   151   28    37   22    32
1     0  1376   0   13    0    0     0   96     5    0     9
2     0     0  74   13  538   58     6   24   177   26    99
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  685    0     3    1    15    0   929
5     0     0   6   74   10  456     4    0     8   31     3
6     1     0   0    1    0    0  3026    0    10    0    29
7     0     1   0  201    0    0     0  956     5    0     1
8     0     0   0   63    1    3     1    7  1294    1     0
9     0     2  91   93   48  494     2   35   174  179    19
10    0     0   0    0   73    0     1    1     0    0  1571
early stop counter: 1
val acc:0.9770763516426086, best validation acc: 0.9848602414131165, corresponding to test acc:                         0.6761351823806763 / 0.7288182973861694
after epoch: 14,now: 2024-07-14 19:39:24.138770,epoch time: 0:32:14.028583,used: 7:38:19.181258,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.95864326, 'recall': 0.95399666, 'specificity': 0.9983894, 'f1': 0.95608556, 'auroc': 0.9997199}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    3    0     0     0     0    0      7
1     0  1323    0     0    0    0     0     8     0    0      1
2     0     0  288     0   18    0     1     1     0    4      0
3     0     3    0  8354    0    9     3    42    25    0      1
4     4     0    3     0  460    0     3     1     2    0     66
5     0     0    1     2    0  473     0     0     2   42      1
6     4     0    0     0    0    0  1894     0     1    0      9
7     0     4    3    43    2    0     1  7184    18    0      9
8     0     0    2    17   14    0     1    27  3178    3     52
9     0     0   37     1    1    8     0     1     0  445      0
10    3     0    0     5   15    0     3     1     1    0  12765
---- Validation: 
scalar performance:
{'acc': 0.98694664, 'precision': 0.96355474, 'recall': 0.9597708, 'specificity': 0.99852836, 'f1': 0.96140367, 'auroc': 0.9997264}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    3    0     1     0     0    0      4
1     0  1319    0     1    0    0     0    11     1    0      0
2     0     0  294     0   12    0     2     0     0    3      1
3     0     2    0  8376    0    9     4    36    12    0      1
4     3     0    3     0  469    0     0     0     0    0     64
5     0     0    0     2    0  486     0     0     2   31      0
6     0     0    0     0    1    0  1894     2     1    0     10
7     0     8    3    40    2    0     1  7193    12    0      6
8     0     0    3    16   14    0     1    24  3181    1     56
9     0     0   36     1    2    9     1     0     0  444      0
10    6     0    1     5   10    0     2     4     2    0  12766
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7306374, 'precision': 0.6514849, 'recall': 0.6034688, 'specificity': 0.9728922, 'f1': 0.6010895, 'auroc': 0.877337}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   913     5    1   50    2    3    78    51    13   38    16
1     0  1358    0    5    0    0     0   127     2    0     7
2     2     0  146   14  440    0    15    49   154   68   127
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    3    0  377    0     4     2    13    0  1233
5     0     0    4   67    6  192    10     2    26  285     0
6     3     0    0    1    0    0  2979     2    26    0    56
7     0     0    0  104    0    0     0  1056     2    1     1
8     0     0    0   41    5    0     2    33  1282    3     4
9     2     1  201   83   27   58     8    83   138  509    27
10    0     1    0    0   12    0     0     1     1    0  1631
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-14 20:11:36.939073,epoch time: 0:32:12.800303,used: 8:10:31.981561,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98565924, 'precision': 0.9648597, 'recall': 0.94738865, 'specificity': 0.9984263, 'f1': 0.955629, 'auroc': 0.9997689}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    2    0     3     1     0    0     12
1     0  1322    0     1    0    0     0     9     0    0      0
2     0     0  275     1   25    0     1     3     2    3      2
3     0     1    0  8326    0    0     2    77    30    0      0
4     5     1    4     1  466    0     0     1    13    1     47
5     0     0    0    32    0  480     0     0     3    4      2
6     0     0    0     0    0    0  1902     1     0    0      4
7     0     5    1    17    0    0     1  7225     9    0      6
8     0     1    0    23    0    0     0    33  3225    0     14
9     3     1   19     1    3   40     1     3     2  418      2
10    2     0    0     5   35    0     0     1    13    0  12738
---- Validation: 
scalar performance:
{'acc': 0.98617095, 'precision': 0.96849316, 'recall': 0.9513985, 'specificity': 0.99847054, 'f1': 0.95962226, 'auroc': 0.99976647}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     3    1    0     2     2     0    0      9
1     0  1323    0     0    0    0     0     9     0    0      0
2     0     0  276     0   22    0     0     2     4    6      2
3     0     0    0  8338    0    0     2    74    26    0      0
4     3     0    1     0  471    0     1     1    10    1     51
5     0     0    0    29    0  481     0     1     6    3      1
6     0     0    0     0    0    0  1904     0     0    0      4
7     0     4    0    27    0    0     0  7221     9    0      4
8     0     0    0    20    0    0     1    45  3217    0     13
9     2     0   22     5    1   29     0     2     1  431      0
10    2     0    1     6   34    0     1     3     9    0  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71524525, 'precision': 0.62980294, 'recall': 0.58697456, 'specificity': 0.9711841, 'f1': 0.57123125, 'auroc': 0.88005304}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   784     9    2   45    0    6   230    57    17    8    12
1     0  1354    0    4    0    0     0   136     2    0     3
2     2     4   67   11  340    7     8    84   294   21   177
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  517    0     3     3    38    0  1072
5     2     0   20  119   11  269    15     6    54   92     4
6     0     1    0    1    1    0  3012     2    26    0    24
7     0     0    0   41    0    0     0  1121     1    0     1
8     0     0    0   31    0    0     3    31  1303    1     1
9     3     6  103   86   29  136    21   196   302  217    38
10    0     0    0    0   64    0     0     1     2    0  1579
early stop counter: 1
val acc:0.9861709475517273, best validation acc: 0.9869466423988342, corresponding to test acc:                         0.7306373715400696 / 0.7306373715400696
after epoch: 16,now: 2024-07-14 20:43:39.986362,epoch time: 0:32:03.047289,used: 8:42:35.028850,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9832513, 'precision': 0.943966, 'recall': 0.9425304, 'specificity': 0.99827564, 'f1': 0.94018114, 'auroc': 0.9997533}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    6    0     0     0     0    0      1
1     0  1327    0     2    0    0     0     3     0    0      0
2     0     0  219     0   33    1     0     1     1   57      0
3     1     0    0  8393    0    8     0    24    12    0      0
4     3     1    1     0  515    1     0     1     6    0     11
5     0     0    0     4    0  515     0     0     1    1      0
6     7     0    0     0    0    1  1891     0     1    1      6
7     1    13    1   101    1    0     1  7127    17    0      1
8     2     0    2    56    2    1     1     9  3220    0      3
9     1     0    3     1    0   88     0     0     3  397      0
10    8     7    1     3   69    1     1    10    22    0  12671
---- Validation: 
scalar performance:
{'acc': 0.9845393, 'precision': 0.94969267, 'recall': 0.9501192, 'specificity': 0.99839425, 'f1': 0.9477126, 'auroc': 0.9997597}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    6    0     0     0     0    0      0
1     0  1328    0     0    0    0     0     3     1    0      0
2     0     0  231     0   25    2     0     0     0   53      1
3     1     0    0  8402    0    4     2    23     8    0      0
4     4     0    4     0  518    0     0     0     1    2     10
5     0     0    0     3    0  516     0     0     0    2      0
6     4     0    0     1    0    1  1899     0     0    0      3
7     0     5    0   102    1    0     1  7136    14    3      3
8     1     0    0    65    3    0     1    15  3208    0      3
9     1     0    3     0    0   75     0     0     1  413      0
10   10     6    1     5   62    1     0     6    26    0  12679
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7495977, 'precision': 0.67149645, 'recall': 0.64414346, 'specificity': 0.9747874, 'f1': 0.6313948, 'auroc': 0.88158566}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1010     9   0  20    1    7    60    27    32    3     1
1      0  1367   0   8    0    0     0   108    11    0     5
2     11     1  95   6  479   20     6    26   216   77    78
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0  851    0     1     1    13    0   766
5      9     0   5  60    3  389    20     1    45   58     2
6     11     3   0   1    8    1  2683     1   148    0   211
7      0     1   0  80    0    0     0  1075     6    0     2
8      0     0   0  41    5    1     1     9  1310    1     2
9     13     1  86  50   39  245    29    42   212  401    19
10     0     0   0   0  110    0     1     1     1    0  1533
new oracle model saved
early stop counter: 2
val acc:0.984539270401001, best validation acc: 0.9869466423988342, corresponding to test acc:                         0.7306373715400696 / 0.7495977282524109
after epoch: 17,now: 2024-07-14 21:15:50.211687,epoch time: 0:32:10.225325,used: 9:14:45.254175,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9873448, 'precision': 0.96126884, 'recall': 0.9698301, 'specificity': 0.99866146, 'f1': 0.9652789, 'auroc': 0.99984187}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     2    4    0     1     0     0    0      0
1     0  1314    0     4    0    0     0    14     0    0      0
2     0     0  278     0    0    0     0     7     0   27      0
3     0     1    1  8413    0    1     0    15     7    0      0
4     2     0   23     0  503    0     0     1     3    1      6
5     0     0    0     7    0  504     0     0     0    9      0
6     0     0    0     1    0    0  1899     4     1    1      2
7     0     0    0    71    0    0     0  7179     7    0      4
8     0     0    0    59    2    0     0    34  3198    1      2
9     0     0    2     2    0   14     0     1     0  474      0
10   10     0    4     7   88    0     1     6    13    0  12665
---- Validation: 
scalar performance:
{'acc': 0.98673266, 'precision': 0.9592771, 'recall': 0.96859145, 'specificity': 0.99860996, 'f1': 0.963452, 'auroc': 0.99982995}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    5    0     1     0     0    0      0
1     0  1309    0     3    0    0     0    17     3    0      0
2     0     0  273     0    3    0     0     4     3   29      0
3     0     0    0  8413    0    1     0    19     7    0      0
4     2     0   15     0  511    0     0     0     5    3      3
5     0     0    0     5    1  507     0     0     0    8      0
6     5     0    0     0    0    0  1900     2     0    0      1
7     0     1    0    74    1    0     0  7182     5    0      2
8     0     0    0    63    4    0     0    36  3192    0      1
9     0     0    2     3    0   17     0     2     0  469      0
10   10     1    7     4   93    0     0     5    18    1  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75050724, 'precision': 0.69341755, 'recall': 0.62991077, 'specificity': 0.9750842, 'f1': 0.63522744, 'auroc': 0.8848209}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   840     1    7  80    5    6    50    76    13   86     6
1     0  1143    0  21    0    1     1   299    10    0    24
2     0     0  240   9  287    7     2    90   192  117    71
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    9   1  847    0     3     4    17    0   752
5     0     0   15  93    2  231     1     4    25  221     0
6     6     0    0   1    5    0  2877     4    51    0   123
7     0     0    0  61    0    0     0  1099     2    0     2
8     0     0    0  36    1    0     0    21  1309    1     2
9     0     0   67  84    4   85     0   154   125  606    12
10    0     0    0   0  108    0     1     1     0    1  1535
new oracle model saved
early stop counter: 3
val acc:0.9867326617240906, best validation acc: 0.9869466423988342, corresponding to test acc:                         0.7306373715400696 / 0.7505072355270386
after epoch: 18,now: 2024-07-14 21:47:53.371681,epoch time: 0:32:03.159994,used: 9:46:48.414169,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9891374, 'precision': 0.97182935, 'recall': 0.9729834, 'specificity': 0.9988607, 'f1': 0.9720288, 'auroc': 0.9999012}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    0    0     0     0     0    0      4
1     0  1328    0     0    0    0     0     2     0    0      0
2     1     0  282     0   14    1     1     1     0   12      0
3     2     3    0  8319    0   11     0    44    60    0      0
4     5     0    0     0  516    0     0     0     3    0     15
5     0     0    0     0    0  516     0     1     1    2      1
6     8     1    0     0    0    0  1878     1     1    0     19
7     1    23    1    27    1    0     0  7178    27    0      5
8     0     0    0     3    1    0     0     6  3281    0      4
9     0     0    6     0    1   33     0     0     4  449      0
10    2     0    1     2   16    0     0     2    25    1  12744
---- Validation: 
scalar performance:
{'acc': 0.99058443, 'precision': 0.9766065, 'recall': 0.97486407, 'specificity': 0.9990121, 'f1': 0.9753345, 'auroc': 0.99993736}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     0     0     0    0      2
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  277     0   17    0     1     3     0   13      1
3     1     3    0  8328    0    8     0    38    61    1      0
4     5     0    1     0  518    0     0     1     1    0     13
5     0     0    0     0    0  516     0     0     1    3      1
6     5     0    0     0    0    0  1886     0     2    0     15
7     1    16    0    22    1    0     0  7204    18    0      3
8     0     1    0     4    0    0     0     6  3281    0      4
9     0     0    1     0    0   31     0     1     0  460      0
10    1     0    1     3   10    0     0     2    26    0  12753
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6722172, 'precision': 0.64306235, 'recall': 0.6017567, 'specificity': 0.96690613, 'f1': 0.58785874, 'auroc': 0.87313116}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   977     4    2  36    3    8    16    50    22   37    15
1     0  1321    0   4    0    0     0   145    15    0    14
2     4     2  160   6  341    8     1    90   165   32   206
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  536    0     0     2    16    0  1078
5     1     0   13  52    5  327     1     4    27  152    10
6     5     2    0   1    9    0  1825     5   367    0   853
7     0     0    0  17    0    0     0  1144     0    1     2
8     1     0    0  17    3    1     0    42  1302    2     2
9     4     1  171  32   21  128     0   147   171  411    51
10    0     0    0   0   40    0     0     1     0    0  1605
better model found
persisted
after epoch: 19,now: 2024-07-14 22:19:39.404018,epoch time: 0:31:46.032337,used: 10:18:34.446506,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98967254, 'precision': 0.9654717, 'recall': 0.9684114, 'specificity': 0.9989175, 'f1': 0.9661648, 'auroc': 0.99990016}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     5    4    1     2     0     0    1      8
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     0  283     0   13    0     0     1     0   13      2
3     0     0    0  8365    0    6     0    57     9    1      0
4     4     0    2     0  518    1     0     1     5    1      7
5     0     0    0     3    0  517     0     0     0    0      1
6     0     0    0     1    0    0  1896     0     1    0     10
7     0     2    1    20    0    0     0  7235     3    1      2
8     0     0    2     8    4    2     0    19  3245    3     11
9     0     0    5     2    0   53     0     0     0  433      0
10    3     0    0     1   65    2     1     5     7    1  12707
---- Validation: 
scalar performance:
{'acc': 0.9891935, 'precision': 0.96787614, 'recall': 0.971094, 'specificity': 0.9988627, 'f1': 0.96856743, 'auroc': 0.999897}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     2    2    0     2     2     0    1      7
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  284     0   13    1     0     2     0   11      1
3     0     0    0  8367    0    4     0    59    10    0      0
4     1     0    1     0  525    1     0     0     3    1      7
5     0     0    0     2    0  518     0     0     0    0      1
6     0     0    0     4    0    1  1889     1     5    0      8
7     1     1    2    25    2    0     0  7223     8    0      3
8     0     0    1    20    7    3     1    22  3234    0      8
9     0     0    2     2    0   50     0     0     0  439      0
10    2     1    0     3   69    2     1     3     6    1  12708
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72776884, 'precision': 0.65941155, 'recall': 0.6189178, 'specificity': 0.97274137, 'f1': 0.60527486, 'auroc': 0.8804935}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   622     3    6  94    1   91   150   105    16   53    29
1     2  1196    0  10    0    0     0   275     7    0     9
2     0     0  179   8  343   55     3    71   152   73   131
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    3   0  719    0     3     3    22    0   883
5     1     0    6  71    0  435     0     4    10   65     0
6     0     3    0   4    2    1  2925     5    59    0    68
7     0     0    0  15    0    1     0  1144     2    0     2
8     0     0    3  56    7    5     1    35  1257    3     3
9     0     0  109  47    9  352     0   120   103  381    16
10    0     0    0   0   99    0     1     1     0    1  1544
early stop counter: 1
val acc:0.9891934990882874, best validation acc: 0.9905844330787659, corresponding to test acc:                         0.6722171902656555 / 0.7505072355270386
after epoch: 20,now: 2024-07-14 22:51:49.576420,epoch time: 0:32:10.172402,used: 10:50:44.618908,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.986997, 'precision': 0.9770391, 'recall': 0.9587433, 'specificity': 0.9985794, 'f1': 0.96706617, 'auroc': 0.99984455}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    2    0     4     0     0    0     11
1     0  1326    0     2    0    0     0     1     2    0      1
2     0     0  272     0    1    0     1     1     4   32      1
3     0     0    0  8351    0    1     0    17    69    0      0
4     2     0    2     0  463    0     1     0    11    1     59
5     0     0    0    12    0  505     0     0     0    4      0
6     1     0    0     0    0    0  1902     0     3    0      2
7     0     0    1    71    0    0     1  7087    88    2     11
8     0     0    0     4    0    0     0     0  3289    0      3
9     0     0    1     2    0   28     0     0     5  457      0
10    1     0    1     3    2    0     1     0    12    1  12772
---- Validation: 
scalar performance:
{'acc': 0.98657215, 'precision': 0.9714763, 'recall': 0.95586514, 'specificity': 0.99855447, 'f1': 0.96285397, 'auroc': 0.9998495}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    4    0     0     1     2    0     10
1     0  1329    0     2    0    0     0     0     1    0      0
2     1     0  258     0    9    0     0     1     4   36      3
3     0     1    0  8350    0    2     0    10    77    0      0
4     4     0    5     0  471    0     3     0    12    0     44
5     0     0    0     9    0  506     1     0     2    3      0
6     1     0    0     0    0    0  1905     0     0    0      2
7     0     1    1    78    1    0     1  7087    86    1      9
8     0     0    0     6    0    0     0     0  3281    1      8
9     1     0    1     1    0   32     0     0     2  455      1
10    3     0    2     2    2    0     1     0    11    0  12775
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6975443, 'precision': 0.65468144, 'recall': 0.58405364, 'specificity': 0.96968, 'f1': 0.57103515, 'auroc': 0.87260735}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   860     2   0   63    0    8    99    18    91   13    16
1     0  1252   0   16    0    0     0   207    14    0    10
2     0     0  74    8  151   18    11    22   473   43   215
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   2    0  369    0     6     1    50    0  1205
5     1     0   6  103    1  316     5     1    50  102     7
6     0     4   0    2    0    0  2821     2   205    0    33
7     0     0   0  135    0    0     0  1019     9    0     1
8     0     0   0   49    0    0     0     5  1314    0     2
9     2     0  62  125   10  190     9    46   340  315    38
10    0     0   0    0   14    0     1     1     0    0  1630
early stop counter: 2
val acc:0.9865721464157104, best validation acc: 0.9905844330787659, corresponding to test acc:                         0.6722171902656555 / 0.7505072355270386
after epoch: 21,now: 2024-07-14 23:23:45.796009,epoch time: 0:31:56.219589,used: 11:22:40.838497,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9903414, 'precision': 0.9661138, 'recall': 0.9658075, 'specificity': 0.99897075, 'f1': 0.9635879, 'auroc': 0.99993247}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    0     0     0     0    0      7
1     0  1321    0     1    0    0     0    10     0    0      0
2     0     0  309     0    3    0     0     0     0    0      0
3     0     0    0  8351    0    3     0    51    30    1      1
4     5     0    5     0  500    0     0     0     1    0     28
5     0     0    1     0    0  518     0     0     1    0      1
6     3     0    0     0    0    0  1900     1     0    0      3
7     0     1    0    24    1    0     0  7228     7    0      3
8     0     0    1     4    6    0     0    17  3257    0     11
9     1     0   64     0    1   47     0     1     0  378      0
10    0     0    2     2    9    0     0     0     2    0  12779
---- Validation: 
scalar performance:
{'acc': 0.990317, 'precision': 0.9690347, 'recall': 0.9649533, 'specificity': 0.99894726, 'f1': 0.9647559, 'auroc': 0.99993324}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     5    2    0     0     2     0    0      9
1     0  1319    0     0    0    0     0    13     0    0      0
2     0     0  310     0    2    0     0     0     0    0      0
3     0     1    1  8351    0    6     1    48    32    0      0
4     5     0    4     0  497    0     0     1     1    0     31
5     0     0    0     2    0  517     0     0     0    1      1
6     1     0    0     0    0    0  1907     0     0    0      0
7     0     2    2    18    0    0     0  7232     5    0      6
8     0     0    2     4    2    0     0    12  3253    0     23
9     0     0   62     1    1   40     0     2     0  386      1
10    0     0    1     2    3    0     0     1     3    0  12786
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71657455, 'precision': 0.6556365, 'recall': 0.61681306, 'specificity': 0.97158146, 'f1': 0.6028126, 'auroc': 0.8722024}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   909     1    1  67    1    4    86    47    37    7    10
1     0  1224    0  11    0    0     0   244     8    0    12
2     4     0  257  15  323   16    11    55   119   22   193
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    5   0  376    0     2     1     8    0  1241
5     3     0   16  70    2  425     3     3    15   53     2
6     1     4    0  25    4    1  2812     4    63    0   153
7     0     0    0  53    0    1     0  1107     2    0     1
8     0     0    0  59    3    0     1    38  1264    1     4
9     6     1  284  82   10  271     4    99   111  238    31
10    0     0    0   0   15    0     0     1     0    0  1630
early stop counter: 3
val acc:0.9903169870376587, best validation acc: 0.9905844330787659, corresponding to test acc:                         0.6722171902656555 / 0.7505072355270386
after epoch: 22,now: 2024-07-14 23:55:25.608973,epoch time: 0:31:39.812964,used: 11:54:20.651461,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99165237, 'precision': 0.9817487, 'recall': 0.97922033, 'specificity': 0.9991005, 'f1': 0.9804374, 'auroc': 0.99993724}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    3    0     1     0     0    0      6
1     0  1330    0     0    0    0     0     1     0    0      0
2     0     0  295     0    7    0     0     2     0    6      2
3     0     6    0  8299    0    4     0    58    67    0      3
4     3     0    1     0  511    0     0     1     2    0     21
5     0     1    1     1    1  507     0     0     1    9      0
6     7     0    0     0    1    1  1895     1     1    0      1
7     2     1    0    17    0    0     1  7232     9    0      3
8     0     0    0     3    1    1     0     9  3273    0      8
9     0     0    5     0    1   10     0     1     1  474      1
10    3     0    1     1    3    0     1     2     7    0  12775
---- Validation: 
scalar performance:
{'acc': 0.9913602, 'precision': 0.98196614, 'recall': 0.9763727, 'specificity': 0.9990616, 'f1': 0.97904915, 'auroc': 0.99993503}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    3    0     1     0     0    0      1
1     0  1330    0     0    0    0     0     2     0    0      0
2     1     0  288     0    9    0     0     2     0    9      3
3     0     7    0  8309    0    0     1    54    69    0      0
4     3     0    0     1  502    0     0     0     1    0     32
5     0     0    1     4    1  501     0     0     1   13      0
6     3     0    0     0    0    1  1900     1     0    0      3
7     1     5    0    21    0    0     0  7224    11    0      3
8     0     0    1     3    2    1     0     7  3273    0      9
9     0     0    4     0    0    8     0     1     0  478      2
10    1     0    0     0    7    0     3     4     2    0  12779
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7132862, 'precision': 0.6510651, 'recall': 0.62025195, 'specificity': 0.9712449, 'f1': 0.6050674, 'auroc': 0.87948036}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1012     3    2  43    0   26     6    22    41   12     3
1      0  1199    0   9    0    0     0   262    14    0    15
2      0     0  140  12  338   15     0    55   218   49   188
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    0   0  509    0     0     3    13    0  1108
5      4     0   10  62    2  373     1     0    31  108     1
6      9     2    0   2   11    2  2502     4   245    1   289
7      0     0    0  61    0    1     0  1098     3    0     1
8      0     0    0  19    3    1     0    16  1327    1     3
9      3     1  139  62   16  230     1    69   171  420    25
10     0     0    0   0   30    0     0     1     0    0  1615
better model found
persisted
after epoch: 23,now: 2024-07-15 00:27:19.859559,epoch time: 0:31:54.250586,used: 12:26:14.902047,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9925353, 'precision': 0.9773312, 'recall': 0.9830886, 'specificity': 0.9992066, 'f1': 0.9800936, 'auroc': 0.9999403}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    1    0     2     0     0    0      2
1     0  1320    0     1    0    0     0    10     0    1      0
2     0     0  307     0    1    0     0     0     0    3      1
3     0     0    1  8361    0    5     0    58    12    0      1
4     5     0    7     0  514    1     0     1     1    2      8
5     0     0    0     3    0  511     0     0     0    7      0
6     0     0    0     0    0    0  1903     0     0    0      4
7     0     1    4    11    0    1     0  7225    16    2      2
8     2     0    5    15    4    1     1     8  3252    1      7
9     0     0    8     1    0   17     0     0     0  467      0
10    3     0    0     4   17    0     2     2     6    0  12759
---- Validation: 
scalar performance:
{'acc': 0.9923766, 'precision': 0.9734178, 'recall': 0.9813705, 'specificity': 0.99920225, 'f1': 0.9772187, 'auroc': 0.99993503}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    2    0     2     0     0    0      0
1     0  1323    0     3    0    0     0     5     0    1      0
2     0     0  307     0    2    0     0     0     0    2      1
3     0     0    0  8359    0    8     0    66     6    1      0
4     4     0   11     0  515    1     0     0     1    2      5
5     1     0    0     1    0  508     0     0     0   11      0
6     0     0    0     0    0    0  1903     0     1    0      4
7     1     1    3    19    0    0     0  7229     8    3      1
8     1     0    3    15    7    1     0     6  3258    0      5
9     1     0   10     2    0   23     0     0     0  457      0
10    5     0    1     0   18    0     1     2     7    0  12762
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7237109, 'precision': 0.65944195, 'recall': 0.6232847, 'specificity': 0.97210324, 'f1': 0.6196917, 'auroc': 0.87813556}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   869     1    2  41    0   13   178    26    18   15     7
1     0  1156    0  32    0    1     0   261    18   10    21
2     5     0  233   8  362   23    16    25    99   64   180
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  416    0     1     2    12    0  1202
5     2     0   19  38    1  387     4     2     5  133     1
6     3     0    0   3    2    1  2798     4    39    0   217
7     1     0    0  74    0    1     0  1085     1    0     2
8     0     0    0  52   10    8     3    19  1259   10     9
9     1     1  234  34    9  230     5    24    50  515    34
10    0     0    0   0   19    0     0     1     0    0  1626
better model found
persisted
after epoch: 24,now: 2024-07-15 00:59:13.218902,epoch time: 0:31:53.359343,used: 12:58:08.261390,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.988094, 'precision': 0.94768465, 'recall': 0.96965206, 'specificity': 0.99879384, 'f1': 0.9572104, 'auroc': 0.99985534}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     3    3    1     0     1     1    1      0
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  301     0    1    0     0     0     0    9      1
3     0     1    0  8406    0    6     0    17     8    1      0
4     2     0   33     0  495    0     0     0     1    2      6
5     0     0    0     0    0  512     0     0     1    8      0
6     5     1   47    12   24    1  1804     0     8    2      3
7     0     9    3    44    0    0     0  7181    23    0      3
8     0     2    1    18    2    6     0     5  3248    2     11
9     0     0   14     0    0   29     0     0     0  450      0
10   27     0    2     5   12    0     2     1     7    4  12732
---- Validation: 
scalar performance:
{'acc': 0.9893808, 'precision': 0.95589316, 'recall': 0.97463346, 'specificity': 0.99891293, 'f1': 0.9642024, 'auroc': 0.9998721}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    5    0     0     0     1    0      0
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  305     0    1    0     0     0     0    5      1
3     0     3    0  8402    0    5     0    22     7    1      0
4     1     0   18     0  509    1     0     0     1    2      7
5     0     0    1     2    0  513     0     0     0    5      0
6     6     0   40     8   18    1  1810     3     9    4      9
7     1     9    0    43    0    1     0  7189    19    2      1
8     0     1    2    18    1    3     0     4  3258    2      7
9     0     0   16     0    0   28     0     0     0  449      0
10   16     2    1     6   17    0     0     0     8    1  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71496534, 'precision': 0.6638429, 'recall': 0.6224786, 'specificity': 0.97150326, 'f1': 0.61462986, 'auroc': 0.87288225}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   687     3   17  129    1   66    14    61    44  120    28
1     0  1349    0   14    0    0     0   122     5    1     8
2     1     1  277    9  248   13     1    35   156   96   178
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    6    0  426    0     1     2    10    1  1187
5     0     0   11   37    1  387     0     2     9  143     2
6     0     2    1   16    6    2  2548     7   190    0   295
7     0     0    0   52    0    1     0  1108     2    0     1
8     0     0    0   58    1    6     0    19  1280    2     4
9     0     1  149   31    3  264     0    40    93  534    22
10    0     0    0    0   21    0     0     1     0    1  1623
early stop counter: 1
val acc:0.9893807768821716, best validation acc: 0.9923766255378723, corresponding to test acc:                         0.7237108945846558 / 0.7505072355270386
after epoch: 25,now: 2024-07-15 01:31:06.152256,epoch time: 0:31:52.933354,used: 13:30:01.194744,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99406034, 'precision': 0.98440826, 'recall': 0.97911775, 'specificity': 0.9993441, 'f1': 0.98159343, 'auroc': 0.9999593}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    4    0     2     0     0    0      5
1     0  1324    0     0    0    0     0     8     0    0      0
2     0     0  284     0   10    0     0     0     0   15      3
3     1     0    0  8400    0    8     0    20     9    0      0
4     3     0    1     0  515    0     0     0     1    0     18
5     0     0    0     1    0  515     0     0     0    5      0
6     0     0    0     0    0    0  1900     0     0    0      6
7     0     1    1    22    0    0     0  7226     9    0      4
8     0     0    1     2    3    1     0    13  3261    0     15
9     0     0    1     0    0   15     0     0     0  477      0
10    1     1    0     0    4    0     0     1     7    0  12780
---- Validation: 
scalar performance:
{'acc': 0.9941153, 'precision': 0.98473674, 'recall': 0.98033535, 'specificity': 0.99935055, 'f1': 0.98235506, 'auroc': 0.9999598}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    4    0     0     0     0    0      9
1     0  1328    0     0    0    0     0     4     0    0      0
2     0     0  289     0    6    1     0     0     0   15      1
3     0     1    0  8397    0    8     0    23    11    0      0
4     3     0    0     0  515    0     0     1     1    1     18
5     0     0    0     0    0  514     0     0     0    6      1
6     1     0    0     0    0    0  1900     0     0    1      6
7     0     1    1    19    0    0     0  7233     8    0      3
8     0     0    0     4    0    5     0    12  3258    4     13
9     0     0    0     0    0   14     0     0     0  479      0
10    2     0    0     0    3    0     0     2     7    0  12782
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6846708, 'precision': 0.65051234, 'recall': 0.6074527, 'specificity': 0.9683378, 'f1': 0.5899632, 'auroc': 0.87314045}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   797     4    2  47    1   94    20    46    10  105    44
1     0  1343    0   9    0    3     0   130     2    0    12
2     0     0  137   8  328   55     1    50   129   83   224
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  425    1     1     3     9    0  1194
5     0     0    2  21    2  440     0     2     6  117     2
6     0     2    0   4    3    1  2216     3    30    0   808
7     0     0    0  63    0    1     0  1098     1    0     1
8     0     0    0  45    8   19     0    40  1247    7     4
9     0     2   92  40    7  387     0    55    62  459    33
10    0     0    0   0   20    0     0     1     0    1  1624
better model found
persisted
after epoch: 26,now: 2024-07-15 02:04:01.661862,epoch time: 0:32:55.509606,used: 14:02:56.704350,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99173266, 'precision': 0.9723433, 'recall': 0.9774013, 'specificity': 0.9991265, 'f1': 0.9743296, 'auroc': 0.99989843}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    1     0    4    0     2     0     0    1      2
1     0  1319    0     0    0    0     0    12     0    0      0
2     0     0  308     0    0    0     0     0     0    4      0
3     0     5    0  8396    0    1     0    29     6    2      0
4     4     0   42     0  483    0     0     2     2    0      6
5     0     0    0     8    0  504     0     0     2    6      0
6     1     0    0     0    0    0  1905     0     0    0      2
7     0     0    0    26    0    0     0  7233     5    0      0
8     0     0    1    30    2    0     0    28  3230    1      4
9     0     0    9     0    0    9     0     0     0  475      0
10    2     0    2     4   23    0     3     8     8    0  12741
---- Validation: 
scalar performance:
{'acc': 0.99208236, 'precision': 0.9705614, 'recall': 0.97567296, 'specificity': 0.99917006, 'f1': 0.97203565, 'auroc': 0.9998867}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    2    0     0     1     0    0      4
1     0  1318    0     0    0    0     0    14     0    0      0
2     0     0  307     0    0    1     0     0     1    3      0
3     0     2    0  8410    0    0     0    21     7    0      0
4     2     0   66     0  462    0     0     1     2    0      6
5     0     0    0    11    0  508     0     0     1    1      0
6     0     0    0     0    0    0  1906     0     0    0      2
7     0     1    1    21    0    0     0  7239     3    0      0
8     0     0    4    26    1    0     1    26  3235    3      0
9     1     0    5     0    0    8     0     0     0  479      0
10    1     0    1     5   23    0     1     8     7    1  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73371583, 'precision': 0.6992453, 'recall': 0.61272025, 'specificity': 0.9735122, 'f1': 0.625168, 'auroc': 0.88046926}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   822     2    5  116    2    2    82    38    15   65    21
1     0  1173    0    9    0    0     0   306     2    0     9
2     0     0  301   43  208    5     4    96   152   88   118
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0   10    0  668    0     2     5    14    1   933
5     0     0    6  156    1  180     0     3    10  236     0
6     0     1    0   18    1    0  2854     4    46    0   143
7     0     0    0   35    0    0     1  1126     1    0     1
8     0     0    1   82    5    0     1    42  1236    2     1
9     0     1   94  211    3   62     0   108    83  562    13
10    0     0    1    0   77    0     1     1     1    0  1565
early stop counter: 1
val acc:0.9920823574066162, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.6846708059310913 / 0.7505072355270386
after epoch: 27,now: 2024-07-15 02:35:29.742341,epoch time: 0:31:28.080479,used: 14:34:24.784829,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9915989, 'precision': 0.97745526, 'recall': 0.9870635, 'specificity': 0.9991346, 'f1': 0.9821273, 'auroc': 0.9999611}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    2    0     1     0     0    0      2
1     0  1324    0     0    0    0     0     6     1    0      1
2     0     0  305     0    5    0     0     0     1    0      1
3     1     1    0  8307    0    1     1    84    39    0      1
4     5     0    4     0  523    0     0     1     1    0      5
5     0     0    0     1    0  514     0     0     1    5      0
6     0     1    0     0    1    0  1905     1     0    0      0
7     0     2    0     4    0    0     0  7245    14    0      0
8     0     0    0     2    4    0     0     3  3285    0      1
9     0     0    4     0    0    9     0     0     2  478      0
10   26     0    3     0   26    1    21     7    11    0  12698
---- Validation: 
scalar performance:
{'acc': 0.9928849, 'precision': 0.9840142, 'recall': 0.9908679, 'specificity': 0.9992583, 'f1': 0.9873762, 'auroc': 0.9999656}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    0     0     1     0    0      2
1     0  1328    0     0    0    0     0     4     0    0      0
2     1     0  308     0    1    0     0     0     0    1      1
3     0     0    0  8321    1    0     0    88    29    0      1
4     4     0    3     0  527    0     0     0     2    0      3
5     0     0    0     0    0  520     0     0     0    1      0
6     1     0    0     0    0    0  1906     0     1    0      0
7     0     5    0     3    0    0     0  7243    14    0      0
8     0     0    0     3    3    0     1     6  3283    0      0
9     0     0    5     0    0    7     0     0     0  481      0
10   14     0    1     0   17    0    20     8    13    0  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7535857, 'precision': 0.67432976, 'recall': 0.6417947, 'specificity': 0.975165, 'f1': 0.6308554, 'auroc': 0.88171536}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   918     4    1  36    0    9    92    27    15   66     2
1     0  1253    0   5    1    1     1   220    10    2     6
2     0     0  216   3  195   21    18    41   309  106   106
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    7   0  540    0    20     5    22    2  1037
5     0     0    8  40    1  365     2     3    36  137     0
6     0     0    1   3    1    0  2966     3    78    0    15
7     0     0    0  31    0    0     0  1127     5    0     1
8     0     0    0  12    3    1     0    20  1330    1     3
9     0     1  116  25    1  225     2    54   240  456    17
10    0     0    0   0   35    0    10     1     0    0  1600
new oracle model saved
early stop counter: 2
val acc:0.9928848743438721, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.6846708059310913 / 0.753585696220398
after epoch: 28,now: 2024-07-15 03:07:13.693235,epoch time: 0:31:43.950894,used: 15:06:08.735723,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9940871, 'precision': 0.9853704, 'recall': 0.9842082, 'specificity': 0.99935794, 'f1': 0.9846532, 'auroc': 0.9999614}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   482     0    0     0    1    0     0     0     0    0      0
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  301     0    5    0     0     0     0    5      1
3     3    11    0  8386    0    2     0    21    11    2      0
4     4     0    2     0  499    0     0     0     2    1     31
5     0     0    0     1    0  515     0     0     0    5      0
6     7     0    0     0    0    0  1895     0     2    0      3
7     4    10    1    25    0    0     0  7215     5    0      3
8     2     0    0     9    0    0     0     8  3276    0      0
9     0     0    2     0    0    7     0     0     3  481      0
10    3     0    0     0    3    0     1     5    10    0  12773
---- Validation: 
scalar performance:
{'acc': 0.9941153, 'precision': 0.98507077, 'recall': 0.9824286, 'specificity': 0.9993496, 'f1': 0.98361003, 'auroc': 0.9999584}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   482     0    0     0    1    0     0     0     0    0      0
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  301     0    4    0     1     0     1    4      1
3     2     6    0  8407    0    2     0    13     8    1      1
4     5     0    0     0  497    0     0     1     0    0     36
5     0     0    1     1    0  509     0     0     1    8      1
6     3     0    0     0    0    1  1894     0     2    0      8
7     1    13    2    32    0    0     0  7211     4    1      1
8     2     0    0     7    1    0     0     1  3283    0      2
9     0     0    5     0    0    8     0     0     1  478      1
10    7     0    0     3    1    0     1     2    11    0  12771
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71734416, 'precision': 0.6508943, 'recall': 0.6062366, 'specificity': 0.9716269, 'f1': 0.60375273, 'auroc': 0.87318814}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   917     3    1   73    2    7    47    36    10   63    11
1     2  1348    0    1    0    0     1   133     3    0    11
2     2     0  204   10  288    4     4    35   175   73   220
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  286    0     2     2    22    0  1320
5     1     0   12   47    3  278     2     2    28  216     3
6     3     0    0    6    4    0  2809     3    22    0   220
7     0     1    0  151    0    1     0  1009     1    0     1
8     0     0    2   49    6    1     1    32  1272    3     4
9     1     0  203   52    6  132     3    64   141  495    40
10    0     0    0    0    8    0     2     0     1    0  1635
early stop counter: 3
val acc:0.9941152930259705, best validation acc: 0.9941152930259705, corresponding to test acc:                         0.6846708059310913 / 0.753585696220398
after epoch: 29,now: 2024-07-15 03:38:57.056931,epoch time: 0:31:43.363696,used: 15:37:52.099419,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99352527, 'precision': 0.9820559, 'recall': 0.9830619, 'specificity': 0.9993221, 'f1': 0.98248804, 'auroc': 0.99995565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    4    1     0     2     1    0      2
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  296     0    9    0     0     1     0    5      0
3     0     0    0  8385    0    2     0    20    29    0      1
4     3     0    3     0  517    0     0     2     5    0      9
5     0     0    0     2    0  515     0     0     0    4      0
6     0     0    0     0    0    0  1905     1     0    0      1
7     0     1    1    18    0    0     0  7235     6    0      3
8     0     0    0    10    1    0     0    19  3265    0      1
9     0     0    3     0    0   14     0     0     0  475      0
10    1     1    1     0   31    0     4     0    14    0  12742
---- Validation: 
scalar performance:
{'acc': 0.9943828, 'precision': 0.9859407, 'recall': 0.98697287, 'specificity': 0.9994106, 'f1': 0.9864177, 'auroc': 0.99996793}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     0    2    0     0     0     2    0      6
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  299     0    6    0     0     1     0    6      0
3     0     4    0  8390    0    4     0    21    20    0      1
4     2     0    2     0  525    0     0     1     2    2      5
5     0     0    0     1    0  518     0     0     1    1      0
6     2     1    0     0    1    0  1903     0     0    0      1
7     0     2    0    16    0    0     0  7234    11    0      2
8     0     0    1     5    0    0     0    22  3268    0      0
9     0     0    1     0    0    8     0     1     0  483      0
10    0     1    1     0   19    0     6     0    15    0  12754
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73637444, 'precision': 0.6762187, 'recall': 0.6120041, 'specificity': 0.9735703, 'f1': 0.6156836, 'auroc': 0.8800884}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   854     2    3   52    1    6   117    23     8   88    16
1     0  1224    0    6    1    0     0   252     5    1    10
2     0     1  211   17  262    7     9    71   237   71   129
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    1  597    0     4     2    24    1  1001
5     0     0    7  111    0  230     2     9    33  199     1
6     0     0    1    2    1    0  2988     3    41    0    31
7     0     0    0   45    0    0     0  1117     1    0     1
8     0     0    0   56    2    0     1    78  1230    2     1
9     0     0  132  147    8   72     7   123   146  485    17
10    0     0    0    0   51    0     4     1     1    0  1589
better model found
persisted
after epoch: 30,now: 2024-07-15 04:10:20.000974,epoch time: 0:31:22.944043,used: 16:09:15.043462,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:09:15.043462 at 2024-07-15 04:10:20.000974
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73637444, 'precision': 0.6762187, 'recall': 0.6120041, 'specificity': 0.9735703, 'f1': 0.6156836, 'auroc': 0.8800884}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   854     2    3   52    1    6   117    23     8   88    16
1     0  1224    0    6    1    0     0   252     5    1    10
2     0     1  211   17  262    7     9    71   237   71   129
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    1  597    0     4     2    24    1  1001
5     0     0    7  111    0  230     2     9    33  199     1
6     0     0    1    2    1    0  2988     3    41    0    31
7     0     0    0   45    0    0     0  1117     1    0     1
8     0     0    0   56    2    0     1    78  1230    2     1
9     0     0  132  147    8   72     7   123   146  485    17
10    0     0    0    0   51    0     4     1     1    0  1589
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7535857, 'precision': 0.67432976, 'recall': 0.6417947, 'specificity': 0.975165, 'f1': 0.6308554, 'auroc': 0.88171536}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   918     4    1  36    0    9    92    27    15   66     2
1     0  1253    0   5    1    1     1   220    10    2     6
2     0     0  216   3  195   21    18    41   309  106   106
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    7   0  540    0    20     5    22    2  1037
5     0     0    8  40    1  365     2     3    36  137     0
6     0     0    1   3    1    0  2966     3    78    0    15
7     0     0    0  31    0    0     0  1127     5    0     1
8     0     0    0  12    3    1     0    20  1330    1     3
9     0     1  116  25    1  225     2    54   240  456    17
10    0     0    0   0   35    0    10     1     0    0  1600
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971819_instance_wise_predictions.txt
accuracy from prediction file 0.7363744490309941
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/0.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 321647 KiB |   1125 MiB | 778331 GiB | 778331 GiB |
|       from large pool | 291814 KiB |   1100 MiB | 765552 GiB | 765552 GiB |
|       from small pool |  29832 KiB |     49 MiB |  12779 GiB |  12779 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 321647 KiB |   1125 MiB | 778331 GiB | 778331 GiB |
|       from large pool | 291814 KiB |   1100 MiB | 765552 GiB | 765552 GiB |
|       from small pool |  29832 KiB |     49 MiB |  12779 GiB |  12779 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 315422 KiB |   1122 MiB | 777997 GiB | 777997 GiB |
|       from large pool | 286862 KiB |   1098 MiB | 765235 GiB | 765235 GiB |
|       from small pool |  28560 KiB |     47 MiB |  12761 GiB |  12761 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1320 MiB |   1320 MiB |   1320 MiB |      0 B   |
|       from large pool |   1270 MiB |   1270 MiB |   1270 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 202641 KiB | 243020 KiB | 665279 GiB | 665279 GiB |
|       from large pool | 195609 KiB | 239401 KiB | 652118 GiB | 652118 GiB |
|       from small pool |   7031 KiB |   9901 KiB |  13161 GiB |  13161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4298    |    6541    |  144279 K  |  144275 K  |
|       from large pool |     130    |     212    |   73208 K  |   73208 K  |
|       from small pool |    4168    |    6336    |   71070 K  |   71066 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4298    |    6541    |  144279 K  |  144275 K  |
|       from large pool |     130    |     212    |   73208 K  |   73208 K  |
|       from small pool |    4168    |    6336    |   71070 K  |   71066 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |      78    |      78    |       0    |
|       from large pool |      53    |      53    |      53    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    1418    |   84649 K  |   84649 K  |
|       from large pool |      21    |      52    |   48075 K  |   48075 K  |
|       from small pool |      17    |    1397    |   36574 K  |   36574 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1125 MiB | 778331 GiB | 778331 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 765552 GiB | 765552 GiB |
|       from small pool |      0 KiB |     49 MiB |  12779 GiB |  12779 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1125 MiB | 778331 GiB | 778331 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 765552 GiB | 765552 GiB |
|       from small pool |      0 KiB |     49 MiB |  12779 GiB |  12779 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1122 MiB | 777997 GiB | 777997 GiB |
|       from large pool |  16640 KiB |   1098 MiB | 765235 GiB | 765235 GiB |
|       from small pool |      0 KiB |     47 MiB |  12761 GiB |  12761 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1320 MiB |   1320 MiB |    808 MiB |
|       from large pool | 487424 KiB |   1270 MiB |   1270 MiB |    794 MiB |
|       from small pool |  36864 KiB |     50 MiB |     50 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 265447 KiB | 665279 GiB | 665279 GiB |
|       from large pool |  24320 KiB | 243866 KiB | 652118 GiB | 652118 GiB |
|       from small pool |      0 KiB |  27987 KiB |  13161 GiB |  13161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  144279 K  |  144279 K  |
|       from large pool |       2    |     212    |   73208 K  |   73208 K  |
|       from small pool |       0    |    6336    |   71070 K  |   71070 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  144279 K  |  144279 K  |
|       from large pool |       2    |     212    |   73208 K  |   73208 K  |
|       from small pool |       0    |    6336    |   71070 K  |   71070 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      78    |      78    |      38    |
|       from large pool |      22    |      53    |      53    |      31    |
|       from small pool |      18    |      25    |      25    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1418    |   84651 K  |   84651 K  |
|       from large pool |       4    |      52    |   48075 K  |   48075 K  |
|       from small pool |       0    |    1397    |   36575 K  |   36575 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1125 MiB | 778331 GiB | 778331 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 765552 GiB | 765552 GiB |
|       from small pool |      0 KiB |     49 MiB |  12779 GiB |  12779 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1125 MiB | 778331 GiB | 778331 GiB |
|       from large pool |  16640 KiB |   1100 MiB | 765552 GiB | 765552 GiB |
|       from small pool |      0 KiB |     49 MiB |  12779 GiB |  12779 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1122 MiB | 777997 GiB | 777997 GiB |
|       from large pool |  16640 KiB |   1098 MiB | 765235 GiB | 765235 GiB |
|       from small pool |      0 KiB |     47 MiB |  12761 GiB |  12761 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1320 MiB |   1320 MiB |    808 MiB |
|       from large pool | 487424 KiB |   1270 MiB |   1270 MiB |    794 MiB |
|       from small pool |  36864 KiB |     50 MiB |     50 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 265447 KiB | 665279 GiB | 665279 GiB |
|       from large pool |  24320 KiB | 243866 KiB | 652118 GiB | 652118 GiB |
|       from small pool |      0 KiB |  27987 KiB |  13161 GiB |  13161 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  144279 K  |  144279 K  |
|       from large pool |       2    |     212    |   73208 K  |   73208 K  |
|       from small pool |       0    |    6336    |   71070 K  |   71070 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  144279 K  |  144279 K  |
|       from large pool |       2    |     212    |   73208 K  |   73208 K  |
|       from small pool |       0    |    6336    |   71070 K  |   71070 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      78    |      78    |      38    |
|       from large pool |      22    |      53    |      53    |      31    |
|       from small pool |      18    |      25    |      25    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1418    |   84651 K  |   84651 K  |
|       from large pool |       4    |      52    |   48075 K  |   48075 K  |
|       from small pool |       0    |    1397    |   36575 K  |   36575 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819

 Experiment start at: 2024-07-15 04:47:25.927134
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9083102, 'precision': 0.8666122, 'recall': 0.78137165, 'specificity': 0.9896977, 'f1': 0.80614936, 'auroc': 0.9947679}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     0    0     5    0    0     4    24     2    3     38
1     0  1262    0     6    0    0     0    60     2    0      1
2     4     1  149     0   17    3     1    57     2   53     24
3     1     4    0  6954    0   35     0  1400    43    0      0
4     5     1   24     1  158    3     4    48    38   15    242
5     0     0    0    22    0  413     0     1     5   79      1
6    24     6    0     5    0    1  1819    27     6    3     16
7     0    11    1    33    1    1     1  7199    14    0      4
8     2     1    1   230    1   10     1   351  2674    3     21
9     1     0   28     6    0   90     0    25     5  333      5
10    9     1    0     4    4    1    13   120    58    3  12581
---- Validation: 
scalar performance:
{'acc': 0.90841246, 'precision': 0.8729018, 'recall': 0.78510123, 'specificity': 0.98968077, 'f1': 0.8114822, 'auroc': 0.9949044}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    0     2    0    0     3    31     3    1     42
1     0  1255    0     6    0    0     0    68     1    0      2
2     1     0  163     0   17    2     1    48     6   55     19
3     0     2    0  6961    0   33     0  1400    43    1      0
4     4     1   21     3  162    2     1    39    37   17    252
5     1     0    0    20    0  419     0     3     6   71      1
6    26     6    0     5    0    1  1811    26     6    2     25
7     0    14    0    33    1    0     1  7201    12    0      3
8     1     0    1   237    0    8     0   356  2663    5     25
9     1     1   26     5    0   89     1    27     5  335      3
10   12     0    0     5    4    1    12   116    55    1  12590
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6696985, 'precision': 0.5884957, 'recall': 0.56497407, 'specificity': 0.9667537, 'f1': 0.5265221, 'auroc': 0.87125957}
confusion matrix:
      0    1   2   3   4    5     6     7     8    9     10
0   1079    3   0   5   0    0     2    65     2    4    10
1      0  994   0   4   0    0     0   485     1    0    15
2     15    0   1   4  57    6     1   337   111   89   394
3      0    0   0   0   0    0     0     0     0    0     0
4      0    0   0   0  29    0     1     9    12    0  1582
5     17    0   0  52   0  267     0    15    11  227     3
6      2    2   0   1   0    0  2754    54    47    0   207
7      0    0   0   4   0    0     0  1160     0    0     0
8      0    0   0  41   0    1     2   114  1206    2     4
9     39    7   5  21   3   58     0   424    75  441    64
10     0    0   0   0   0    0     0     4     1    0  1641
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-15 05:20:17.134608,epoch time: 0:32:51.207474,used: 0:32:51.207474,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9505565, 'precision': 0.8791312, 'recall': 0.81868917, 'specificity': 0.9945408, 'f1': 0.8224803, 'auroc': 0.99732924}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     3    0    0     8     3     2    2     44
1     0  1289    0     5    0    1     0    30     5    0      2
2     1     0  229     0   26   13     3     5     7   15     13
3     1     1    1  8137    0   44     1   133   118    0      1
4     7     0   35     0  199    2     5     2    27    3    259
5     0     0    0    12    0  497     2     0     4    3      2
6    13     0    0     3    0    0  1858     0     4    0     29
7     1    15    4   193    1    1     1  6928   102    0     18
8     3     0    4    84    2    8     0    42  3122    0     31
9     2     0   72     4    0  261     5     3     5  135      6
10   10     0    2     8    4    2     4    12    38    0  12713
---- Validation: 
scalar performance:
{'acc': 0.95059514, 'precision': 0.8808248, 'recall': 0.82352275, 'specificity': 0.99454296, 'f1': 0.82807875, 'auroc': 0.9974466}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     2    0    0     8     4     2    2     43
1     0  1287    0     8    0    0     0    28     4    0      5
2     3     0  235     0   22    8     3     5     4   21     11
3     1     4    1  8137    0   40     1   136   118    0      2
4     5     0   34     0  202    2     8     1    31    1    255
5     0     0    0    12    0  499     1     0     5    3      1
6    10     0    1     0    0    0  1861     0     5    0     31
7     0    21    4   201    1    0     1  6907   108    1     21
8     1     0    4    80    2    6     0    43  3129    1     30
9     1     0   62     3    0  265     1     0     7  148      6
10   14     0    1     8    7    2     8     9    36    0  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6811726, 'precision': 0.6085098, 'recall': 0.5788095, 'specificity': 0.9679023, 'f1': 0.53983355, 'auroc': 0.87582606}
confusion matrix:
      0     1    2    3   4    5     6    7     8    9     10
0   1072     1    0   15   0    2    57    4     6    0    13
1      0  1181    0   26   0    0     1  218    13    0    60
2      5     0   65    3  59   17     9   26   196   12   623
3      0     0    0    0   0    0     0    0     0    0     0
4      0     0    0    0  10    0     1    1    14    0  1607
5      9     0    2   48   0  453    16    0    23   17    24
6      0     0    0    1   0    0  2937    0    11    0   118
7      0     0    0  253   0    0     0  904     4    0     3
8      0     0    0   30   0    2     5    2  1325    0     6
9     16     1  126   69   3  278    18   44   282  144   156
10     0     0    0    0   0    0     0    0     1    0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-15 05:51:28.114273,epoch time: 0:31:10.979665,used: 1:04:02.187139,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95735234, 'precision': 0.90113294, 'recall': 0.86225355, 'specificity': 0.9951383, 'f1': 0.8782121, 'auroc': 0.9978728}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0     2    0    1     3     2     0    4     57
1     0  1267    0    14    0    0     0    42     2    0      7
2     0     0  248     1   23    2     0     4     1   27      6
3     0     0    2  8221    0    6     2   155    50    1      3
4     3     0   37     2  309    0     0     1    17    6    164
5     0     0    2    25    0  385     0     0     6  101      2
6    13     1    3     1    2    0  1841     0     4    3     40
7     2     5    5   149    3    1     5  7029    14    0     47
8     1     0    1   152    7    0     0   108  2951    4     70
9     1     0   56     4    0   43     0     2     3  380      4
10    3     0    3     8   28    0     1     1    13    0  12737
---- Validation: 
scalar performance:
{'acc': 0.9568276, 'precision': 0.90256184, 'recall': 0.85930043, 'specificity': 0.99505025, 'f1': 0.8768752, 'auroc': 0.99782306}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    0     3    0    0     4     2     0    1     56
1     0  1262    0    15    0    0     0    46     2    0      7
2     0     0  244     0   22    1     0     6     1   29      9
3     2     0    2  8233    0    6     1   148    45    1      2
4     1     0   36     0  297    2     0     2    16    4    181
5     0     0    3    29    0  385     0     0     7   96      1
6    13     0    2     1    1    2  1838     0     4    5     42
7     2     6    7   156    1    0     3  7028    15    0     47
8     2     0    4   142    7    1     3   112  2942    2     81
9     0     0   55     7    0   41     0     3     2  382      3
10    3     0    1     7   24    1     2     3    12    0  12743
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64591056, 'precision': 0.6576749, 'recall': 0.54717815, 'specificity': 0.96453047, 'f1': 0.55204654, 'auroc': 0.87161744}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   963     0    0   47    0    1    12   16     7   10   114
1     1  1123    0   20    0    0     1  266    19    0    69
2     0     0   94   19  131    3     0   30   187   25   526
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    0  251    0     0    0    10    0  1372
5     3     0   12  147    0  233     0    0    27  157    13
6     0     0    0    1    0    0  2381    1   105    0   579
7     0     0    0  235    0    0     0  923     2    0     4
8     0     0    0   72    4    0     0   16  1262    1    15
9     4     0  180  177    4   32     0   73   157  368   142
10    0     0    0    0   12    0     0    0     0    0  1634
better model found
persisted
after epoch: 3,now: 2024-07-15 06:24:07.546445,epoch time: 0:32:39.432172,used: 1:36:41.619311,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9645494, 'precision': 0.90550566, 'recall': 0.8809483, 'specificity': 0.9961466, 'f1': 0.8877212, 'auroc': 0.99843156}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     0    0    0    23     1     1    2     16
1     0  1302    0     4    0    0     0    21     3    0      1
2     0     0  246     0    3    0     1     6     3   53      0
3     3     1    0  8166    0   15    11   170    70    1      0
4     3     0   63     0  278    0     3     3    30    9    150
5     1     0    1    14    0  459     0     0     8   36      1
6     2     0    0     1    0    0  1885     0     3    2     15
7     4    21    5    81    1    0    10  7101    35    1      5
8     0     1    2    90    4    2     4    61  3112    0     20
9     0     0   33     3    0   78     1     3     8  367      0
10   21     0    3     7   17    0    12     7    28    3  12695
---- Validation: 
scalar performance:
{'acc': 0.9636218, 'precision': 0.90110505, 'recall': 0.8802091, 'specificity': 0.99604785, 'f1': 0.8856509, 'auroc': 0.9984093}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     0    0    0    18     1     0    2     18
1     1  1294    1     2    0    0     2    26     3    0      3
2     1     0  246     0    2    0     3     4     1   55      0
3     4     0    0  8160    0   16    18   178    61    2      1
4     3     0   71     0  286    1     2     3    23   11    139
5     0     0    0    13    0  465     1     0     5   36      1
6     2     0    0     1    0    0  1881     1     2    0     21
7     3    18    3    84    1    0    10  7095    44    0      7
8     0     1    1    82    4    0     5    73  3107    1     22
9     1     0   40     5    0   79     2     5     8  353      0
10   18     0    4     7   24    0    11     9    26    3  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7129364, 'precision': 0.6613039, 'recall': 0.5945111, 'specificity': 0.97096884, 'f1': 0.594781, 'auroc': 0.88484263}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   848     0    2   14    1    1   253     4     3   40     4
1     1  1204    0   13    0    0     1   235     7    0    38
2     3     0  201    7  268    4    19    47   277   59   130
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  320    0     3     1    20    0  1288
5     2     0    8   77    0  288     5     0    19  190     3
6     0     0    0    1    1    0  2989     0    10    0    66
7     0     0    0  152    0    0     4  1006     1    0     1
8     0     0    0   46    0    0     4    18  1300    1     1
9     1     4  149  130    9   68    16    89   257  396    18
10    0     0    0    0    7    0     0     0     1    0  1638
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-15 06:55:28.379834,epoch time: 0:31:20.833389,used: 2:08:02.452700,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.90568984, 'recall': 0.8944966, 'specificity': 0.9965129, 'f1': 0.89938474, 'auroc': 0.99870366}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     2    6    0     1     1     0    0     25
1     0  1313    0     1    0    0     0    11     5    0      2
2     2     0  204     0   70    1     1     1     5   26      1
3     2     4    0  8187    0   14     0   104   128    0      1
4     3     0    3     0  416    0     0     0    17    0    100
5     1     0    0    10    0  442     0     0     5   61      1
6     6     0    0     3    2    0  1870     0     2    0     23
7     0    39    3    85    2    0     1  7034    78    1     22
8     1     1    2    35   11    3     0    36  3178    3     25
9     4     0   46     2    8   46     0     0     5  381      1
10    9     0    2     8   60    0     3     3    20    0  12687
---- Validation: 
scalar performance:
{'acc': 0.9683028, 'precision': 0.9068676, 'recall': 0.8943983, 'specificity': 0.9966134, 'f1': 0.8996038, 'auroc': 0.9987397}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     1    5    0     2     0     0    0     31
1     0  1318    0     3    0    0     0     7     2    0      2
2     0     0  202     0   77    2     1     1     4   25      0
3     1     2    0  8197    1   17     1    92   128    1      0
4     4     0    5     0  430    0     0     0    13    0     87
5     3     0    1    13    1  438     0     0     3   60      2
6     8     0    0     2    3    0  1870     0     2    0     23
7     0    33    2    81    2    0     1  7047    79    1     19
8     1     1    1    37    8    4     0    34  3183    0     27
9     1     0   39     2    8   59     1     2     4  377      0
10    6     0    2     7   54    0     4     1    28    0  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6782341, 'precision': 0.625458, 'recall': 0.5664298, 'specificity': 0.96776956, 'f1': 0.5471399, 'auroc': 0.86906296}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1052     2   1   31    3    0    20   10    26    1    24
1      0  1213   0   21    0    0     0  184     9    0    72
2     11     0  22    9  208    2     1   23   399   19   321
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   0    0  162    0     0    0    18    0  1453
5     14     0   4  135    5  295     2    0    54   81     2
6      0     0   0    1    0    0  2794    0    63    0   209
7      0     0   0  190    0    0     0  967     5    0     2
8      0     0   0   41    1    1     1    4  1317    0     5
9     23     2  50  204   41   77     3   55   405  231    46
10     0     0   0    0    3    0     0    1     1    0  1641
better model found
persisted
after epoch: 5,now: 2024-07-15 07:27:03.782105,epoch time: 0:31:35.402271,used: 2:39:37.854971,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9657267, 'precision': 0.9291761, 'recall': 0.87492776, 'specificity': 0.9961806, 'f1': 0.8960211, 'auroc': 0.9987813}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     0    0     5    0    0    15     0     2    0     79
1     0  1294    0     5    0    0     0    22    10    0      1
2     0     0  186     1   50    1     1     3     5   58      7
3     0     0    0  8127    0   11     1   118   178    3      0
4     1     0    6     1  346    0     2     1     9    0    173
5     0     0    0     6    1  428     0     0     5   79      2
6     5     0    1     1    0    0  1884     0     0    0     17
7     0    10    0    68    2    0     1  7046   131    2      5
8     0     0    2    18    7    1     1    15  3195    0     55
9     0     0    9     5    1   22     0     0     5  450      0
10    0     0    1     7   11    0     5     4     7    0  12757
---- Validation: 
scalar performance:
{'acc': 0.9656012, 'precision': 0.93193513, 'recall': 0.87532985, 'specificity': 0.99617475, 'f1': 0.8972159, 'auroc': 0.99888325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     0    0     4    0    0    14     3     1    1     82
1     0  1298    0     3    0    0     0    20     9    0      2
2     0     0  188     0   46    0     1     4     7   62      4
3     0     1    0  8131    1    4     0   112   191    0      0
4     1     0    8     1  342    1     0     2    14    1    169
5     0     0    0     6    0  432     0     0     6   74      3
6     2     0    0     1    1    0  1889     0     2    0     13
7     0     9    1    62    1    0     1  7035   148    1      7
8     0     0    0    18    8    0     1    20  3196    0     53
9     0     0    7     2    1   24     1     1     4  452      1
10    1     0    0     7   12    1     6     5     6    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67851394, 'precision': 0.60934246, 'recall': 0.56511366, 'specificity': 0.96746445, 'f1': 0.5438974, 'auroc': 0.87429464}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   900     1   0   44    0    1   118    12    22    1    71
1     0  1080   0    8    0    0     4   363    18    0    26
2     0     0  18    1  356    6     8    19   237   24   346
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  140    0     3     0    15    0  1475
5     7     0   4  106    9  316     2     2    49   88     9
6     0     0   0    0    0    0  2911     0     9    0   147
7     0     0   0   80    0    0     0  1066    17    0     1
8     0     0   0   13    1    0     0     1  1346    0     9
9    11     1  45  103  103   83    12    40   366  275    98
10    0     0   0    0    0    0     0     0     0    0  1646
early stop counter: 1
val acc:0.9656012058258057, best validation acc: 0.9683027863502502, corresponding to test acc:                         0.6782341003417969 / 0.7129364013671875
after epoch: 6,now: 2024-07-15 07:58:36.437501,epoch time: 0:31:32.655396,used: 3:11:10.510367,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97225493, 'precision': 0.9185177, 'recall': 0.9114697, 'specificity': 0.9970481, 'f1': 0.91321373, 'auroc': 0.9992082}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     0    2    0     6     0     1    2     38
1     0  1307    0     2    0    0     0    18     5    0      0
2     0     0  258     0   33    0     2     1     2   16      0
3     0     0    0  8238    0   31     3    53   113    0      0
4     4     0   18     0  425    0     1     1     6    0     84
5     0     0    0     2    0  486     0     0     5   27      1
6     3     0    1     0    0    0  1887     1     3    0     13
7     1     8    1    89    5    0     1  7045   104    1      6
8     0     0    4    39   15    6     0    16  3202    0     13
9     1     0   54     1    4   83     1     1     3  343      1
10    1     0    1     6   39    1     5     7    21    0  12714
---- Validation: 
scalar performance:
{'acc': 0.97301054, 'precision': 0.9256786, 'recall': 0.91589403, 'specificity': 0.9971045, 'f1': 0.9189351, 'auroc': 0.9991477}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     0    0    1     5     0     1    1     37
1     0  1312    0     0    0    0     0    16     3    0      1
2     0     0  262     0   27    2     1     1     4   14      1
3     0     1    0  8250    0   24     2    55   105    1      2
4     5     0   20     0  422    0     1     0     9    0     82
5     0     0    1     2    1  490     0     0     4   22      1
6     3     0    0     0    0    0  1891     1     2    0     11
7     0     8    2    99    4    2     1  7030   106    0     13
8     0     0    2    41   14    5     0    14  3209    0     11
9     0     0   49     2    0   80     2     1     3  353      3
10    1     1    2     7   29    0     4     6    27    0  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.723571, 'precision': 0.6448529, 'recall': 0.6111374, 'specificity': 0.9721986, 'f1': 0.5867562, 'auroc': 0.8818757}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   971     1    1   22    3    4    82    21    23    1    41
1     0  1168    0   13    0    1     0   290    13    0    14
2     0     0   76    8  311   24     5    24   237   19   311
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  556    0     2     0    21    0  1053
5     4     0   10   59    0  440    12     1    18   38    10
6     0     0    0    1    1    0  3002     0    26    0    37
7     0     0    0  105    0    0     1  1032    22    0     4
8     0     0    0   23    0    3     5     3  1334    0     2
9     8     2  134   84   48  292    17    53   265  164    70
10    0     0    0    0   45    0     0     0     2    0  1599
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-15 08:30:04.145320,epoch time: 0:31:27.707819,used: 3:42:38.218186,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9728703, 'precision': 0.9239502, 'recall': 0.9161103, 'specificity': 0.9970735, 'f1': 0.9184735, 'auroc': 0.999196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     6    0    1    10     1     0    2     11
1     0  1310    0     2    0    0     1    15     4    0      0
2     0     0  258     0    4    3     1     0     0   45      1
3     0     0    0  8375    1    4     0    42    13    1      0
4     3     0   44     0  402    1     5     0     9    2     73
5     0     0    1    10    0  495     0     0     2   13      0
6     1     0    1     1    0    0  1897     1     2    0      5
7     0    15    4   174    1    0     2  7007    49    1     11
8     0     0    5    99    8    3     0    21  3141    1     16
9     0     0   11     3    0  112     0     0     2  365      0
10    7     0    3     9   41    1    29     7    37    0  12660
---- Validation: 
scalar performance:
{'acc': 0.9721814, 'precision': 0.91815066, 'recall': 0.9094265, 'specificity': 0.99702644, 'f1': 0.91230077, 'auroc': 0.9992093}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     5    2    3    12     1     0    2      8
1     0  1311    0     6    0    0     0    11     4    0      0
2     0     0  245     0    2    0     1     0     4   59      1
3     0     0    0  8372    1    4     0    39    23    1      0
4     5     0   43     0  403    2     5     0    10    3     68
5     0     0    0    14    0  488     0     0     1   17      1
6     2     0    1     0    0    0  1899     0     1    0      5
7     0    14    3   170    1    0     3  7020    47    2      5
8     0     0    4   110    5    5     1    13  3142    2     14
9     0     0    9     4    0  124     0     0     0  356      0
10   10     0    3     8   40    1    29     6    40    0  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68488073, 'precision': 0.68226767, 'recall': 0.5586592, 'specificity': 0.968658, 'f1': 0.57372004, 'auroc': 0.8818301}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   489     5    1  181    0   51   317   17    37   65     7
1     0  1239    0   34    0    0     9  194     9    0    14
2     0     0  143   52  195   53    39   14   313   91   115
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    0  505    1    32    1    38    0  1053
5     0     0    1  199    0  310     5    0     5   72     0
6     0     0    0    1    0    0  3050    1    13    0     2
7     0     0    0  321    0    0     1  840     1    0     1
8     0     0    0  146    1    0     5    0  1215    1     2
9     0     0   44  325    4  148     7   11   174  405    19
10    0     0    0    1   40    0     9    0     3    0  1593
early stop counter: 1
val acc:0.9721813797950745, best validation acc: 0.9730105400085449, corresponding to test acc:                         0.7235710024833679 / 0.7235710024833679
after epoch: 8,now: 2024-07-15 09:01:55.162375,epoch time: 0:31:51.017055,used: 4:14:29.235241,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98105735, 'precision': 0.9479098, 'recall': 0.93590456, 'specificity': 0.9979388, 'f1': 0.9417434, 'auroc': 0.99953514}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     1    1    0    11     2     0    1      6
1     0  1297    0     3    0    0     0    31     0    0      1
2     0     0  264     0   29    0     0     1     1   16      1
3     0     0    0  8375    0    6     0    27    27    0      0
4     2     0    4     0  448    0     1     0    11    0     73
5     0     0    0     5    0  478     0     0     5   33      0
6     0     0    0     0    0    0  1901     2     1    0      4
7     0     2    2   105    1    0     1  7121    24    1      5
8     1     0    0    46    4    1     0    30  3201    0     13
9     0     0   38     1    2   35     0     1     3  413      0
10   10     0    1     7   25    0    20     3    20    0  12709
---- Validation: 
scalar performance:
{'acc': 0.9813027, 'precision': 0.9435521, 'recall': 0.9341886, 'specificity': 0.99799156, 'f1': 0.93878615, 'auroc': 0.99953145}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     1    3    0     9     1     0    2      5
1     0  1303    0     3    0    0     0    26     0    0      0
2     0     0  249     0   39    0     1     1     1   19      2
3     0     0    1  8358    0    5     0    39    35    1      1
4     4     0    4     0  459    0     0     0     8    0     64
5     0     0    1     8    0  470     0     0     3   39      0
6     1     0    0     2    0    0  1899     1     2    0      3
7     0     2    0    83    1    0     2  7152    21    0      4
8     1     0    0    34    3    3     0    27  3214    1     13
9     1     0   43     0    2   26     0     0     1  420      0
10   11     1    1     6   24    0    16     8    29    0  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6678094, 'precision': 0.59910333, 'recall': 0.54388785, 'specificity': 0.9664134, 'f1': 0.5334432, 'auroc': 0.8726613}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   770    4   0   26    6    3   298    20    21   17     5
1     0  929   0   26    0    0     1   518     2    0    23
2     5    0  32   21  416   15    23    54   169   17   263
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0  282    0     3     1    13    0  1334
5     3    0  16  139    7  265    14     2    12  128     6
6     0    0   0    1    0    0  3044     2     2    0    18
7     0    0   0   97    0    0     0  1065     1    0     1
8     0    0   0   92    1    0     4    12  1257    1     3
9     2    0  90  198   93  112    53    98   173  269    49
10    0    0   0    0   12    0     1     1     0    0  1632
better model found
persisted
after epoch: 9,now: 2024-07-15 09:34:46.311672,epoch time: 0:32:51.149297,used: 4:47:20.384538,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9794521, 'precision': 0.94196975, 'recall': 0.94463575, 'specificity': 0.99784994, 'f1': 0.94235444, 'auroc': 0.99960697}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    0    0     4     3     0    1      5
1     0  1322    0     3    0    0     0     5     1    0      0
2     1     0  246     0   15    3     3     0     3   41      0
3     1     1    0  8259    0   16     0   126    34    2      0
4     4     1    5     0  483    0     6     2     6    1     31
5     0     0    1     2    0  497     0     0     1   19      1
6     4     0    0     0    0    0  1901     1     0    0      1
7     1    59    1    45    2    0     2  7133    16    2      4
8     0     0    0    31    3    4     3    51  3188    2     14
9     0     0    6     0    0   56     2     0     0  429      0
10   14     2    1     6   52    1    21     6     7    0  12680
---- Validation: 
scalar performance:
{'acc': 0.9784673, 'precision': 0.93852353, 'recall': 0.9441533, 'specificity': 0.9977472, 'f1': 0.9407182, 'auroc': 0.9995576}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    1    0     5     1     0    1      4
1     0  1320    0     4    0    0     0     7     1    0      0
2     0     0  257     0   13    3     1     0     3   35      0
3     1     3    0  8252    0   18     1   118    39    8      0
4     6     1    6     0  470    1     7     1    11    0     36
5     0     0    0     4    0  495     0     0     0   22      0
6     2     0    0     0    0    0  1904     0     1    0      1
7     1    63    1    36    1    1     2  7143    11    1      5
8     0     0    1    43    4    3     2    50  3173    1     19
9     1     0    9     0    0   55     3     0     0  425      0
10   18     4    1     5   53    1    26     8    10    0  12670
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74826837, 'precision': 0.6839491, 'recall': 0.6329306, 'specificity': 0.97451925, 'f1': 0.62266815, 'auroc': 0.8870536}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   960     1   0   29    1   20   132    13     4    8     2
1     0  1318   0   35    0    0     0   131     4    2     9
2    17     0  69    8  185   49   131    37   228   62   229
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    0  654    1    19     2    23    0   932
5     3     0   2   62    0  421    14     1     3   86     0
6     1     0   0    1    0    0  3059     1     1    0     4
7     0     0   0  110    0    0     1  1051     1    0     1
8     0     0   0   91    0    9    42    12  1214    1     1
9     7     1  43   87    5  272    53    40   175  413    41
10    0     0   0    0  101    0     6     1     2    0  1536
new oracle model saved
early stop counter: 1
val acc:0.9784672856330872, best validation acc: 0.9813026785850525, corresponding to test acc:                         0.6678094267845154 / 0.7482683658599854
after epoch: 10,now: 2024-07-15 10:10:32.639958,epoch time: 0:35:46.328286,used: 5:23:06.712824,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9758401, 'precision': 0.93737566, 'recall': 0.94722867, 'specificity': 0.99738294, 'f1': 0.9409492, 'auroc': 0.9995677}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     7    0    0     1     1     0    3      1
1     0  1303    0     7    0    0     0    21     1    0      0
2     0     0  298     0    1    0     0     1     1   11      0
3     0     0    0  8403    0    8     0     9    17    1      0
4     6     0   30     1  474    0     2     0     1    3     22
5     0     0    1    11    0  429     0     0     1   79      0
6     3     0    2     3    0    0  1897     0     1    0      2
7     1     0    0   317    0    0     1  6929     8    1      3
8     1     0    2    77   10    3     2    34  3147   10     10
9     2     0   24     4    0    8     1     0     0  453      0
10   24     0    1     9   56    0    16     4    14    1  12670
---- Validation: 
scalar performance:
{'acc': 0.97520393, 'precision': 0.93779314, 'recall': 0.9460869, 'specificity': 0.9973074, 'f1': 0.9403812, 'auroc': 0.99957234}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     5    1    0     2     0     0    0      2
1     0  1302    0     5    0    0     0    24     1    0      0
2     0     0  292     0    4    0     0     2     1   13      0
3     0     0    0  8405    0    2     0     9    22    2      0
4     6     0   32     0  476    0     1     0     2    0     22
5     0     0    0    17    0  425     0     0     1   78      0
6     4     0    1     3    0    0  1897     0     1    0      2
7     0     1    0   342    0    0     1  6909     7    2      3
8     1     0    4    78   10    0     0    29  3156   10      8
9     0     0   27     1    0    8     0     0     0  457      0
10   22     0    3    10   56    0    19     7    13    0  12666
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6674596, 'precision': 0.66218436, 'recall': 0.54168475, 'specificity': 0.9674114, 'f1': 0.5619192, 'auroc': 0.87640834}
confusion matrix:
     0    1   2    3    4    5     6    7     8    9     10
0   891    1   1  181    2    7    57   17     6    5     2
1     0  911   0   87    0    0     1  477     6    3    14
2     5    0  65   74  274   22     8   40   273   83   171
3     0    0   0    0    0    0     0    0     0    0     0
4     0    0   1    1  505    0     5    1    23    0  1097
5     2    0   6  220    0  246     4    0    12  101     1
6     0    0   0    5    0    0  3005    2    29    0    26
7     0    0   0  472    0    0     0  691     0    0     1
8     0    0   0  191    1    0     4    3  1169    0     2
9     6    0  48  322   13   81     4   47   139  456    21
10    0    0   0    0   40    0     3    1     1    0  1601
early stop counter: 2
val acc:0.9752039313316345, best validation acc: 0.9813026785850525, corresponding to test acc:                         0.6678094267845154 / 0.7482683658599854
after epoch: 11,now: 2024-07-15 10:43:38.784193,epoch time: 0:33:06.144235,used: 5:56:12.857059,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9856057, 'precision': 0.9647488, 'recall': 0.9583674, 'specificity': 0.9984007, 'f1': 0.96140254, 'auroc': 0.99976325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    0    0     0     0     0    0     12
1     0  1306    0     4    0    0     0    18     0    0      3
2     0     0  272     1   10    0     0     2     0   27      0
3     1     0    0  8404    0    5     1    20     7    0      0
4     6     0    3     0  500    0     0     0     1    2     27
5     0     0    0     8    0  490     0     0     1   20      2
6     5     0    1     1    1    0  1890     0     0    2      7
7     1     0    1   142    3    0     1  7095     7    0     12
8     1     0    1    56    8    0     0    17  3203    3      7
9     0     0   12     1    1   28     0     0     0  450      1
10    1     0    0     3   18    0     2     5     8    0  12757
---- Validation: 
scalar performance:
{'acc': 0.9856092, 'precision': 0.96060455, 'recall': 0.9577968, 'specificity': 0.9984169, 'f1': 0.95913464, 'auroc': 0.9997749}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    1    0     0     0     0    1      8
1     0  1311    0     3    0    0     0    16     2    0      0
2     0     0  273     0    7    0     0     1     0   29      2
3     2     1    0  8408    0    1     1    18     8    1      0
4     7     0    4     0  499    0     0     0     2    1     26
5     0     0    0     4    0  494     0     0     0   23      0
6     2     0    2     1    0    0  1892     1     0    0     10
7     3     0    3   128    0    0     2  7104    14    0     11
8     0     0    2    60   11    0     0    12  3198    0     13
9     1     0   16     0    0   36     0     1     0  439      0
10    0     0    1     5   24    0     2     2     6    0  12756
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6855104, 'precision': 0.6367519, 'recall': 0.5695976, 'specificity': 0.9685953, 'f1': 0.5656544, 'auroc': 0.8734138}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   969    0    1   48    3    5    15    43    20   16    50
1     0  906    0   28    0    1     3   504     7    0    50
2     2    0   67   19  289   15     2    69   125   60   367
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    0    0  403    0     2     2     9    0  1217
5     2    0   10  160    2  247     3     2     9  146    11
6     2    0    1    2    1    0  2878     2    28    0   153
7     0    0    0   77    0    0     1  1085     0    0     1
8     0    0    0  122    4    0     1    23  1209    1    10
9     3    0  100  158   28  126     5    73   131  420    93
10    0    0    0    0   29    0     0     1     2    0  1614
better model found
persisted
after epoch: 12,now: 2024-07-15 11:18:39.815150,epoch time: 0:35:01.030957,used: 6:31:13.888016,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9797196, 'precision': 0.94313353, 'recall': 0.9434359, 'specificity': 0.997781, 'f1': 0.9404535, 'auroc': 0.9996381}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    3    0     0     0     0    0      4
1     0  1304    0     7    0    0     0    18     2    0      1
2     0     0  305     1    0    0     0     3     0    1      2
3     0     0    0  8381    0    0     0    54     3    0      0
4     6     0   36     0  472    0     1     3     2    0     19
5     0     0    4    26    0  453     0     0     0   36      1
6     5     0    0     0    0    0  1893     2     0    0      5
7     0     1    0    64    0    0     2  7183     7    0      7
8     4     0    3   118    5    0     0    85  3038    0     43
9     2     0   83     3    0    9     1     2     0  393      0
10    8     0    1     4   51    0     3     7     0    0  12720
---- Validation: 
scalar performance:
{'acc': 0.9806339, 'precision': 0.94629127, 'recall': 0.94580805, 'specificity': 0.997884, 'f1': 0.94313097, 'auroc': 0.99970454}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    2    0     1     0     0    0      1
1     0  1301    0     3    0    0     0    22     4    0      2
2     0     0  308     0    0    0     0     3     0    0      1
3     1     0    0  8379    0    0     1    57     2    0      0
4     5     0   27     0  477    0     0     3     2    0     25
5     0     0    4    21    0  462     0     0     1   31      2
6     7     0    0     1    0    0  1899     1     0    0      0
7     0     2    0    58    1    0     2  7186    11    0      5
8     2     0    5   108    5    0     1    87  3049    0     39
9     0     0   86     4    1   13     0     3     1  384      1
10    9     0    1     4   38    0     2     4     1    0  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6935563, 'precision': 0.66159236, 'recall': 0.5698911, 'specificity': 0.969554, 'f1': 0.576087, 'auroc': 0.8752483}
confusion matrix:
      0    1    2    3    4    5     6     7     8    9     10
0   1073    0    2   46    2    5    18    19     1    0     4
1      0  935    0   23    0    0     0   515     2    0    24
2      8    0  167   35  268    2     4   101    98   27   305
3      0    0    0    0    0    0     0     0     0    0     0
4      0    0    3    1  560    0     1     3    10    0  1055
5      5    0   18  161    4  174     2     1    12  209     6
6     14    0    0    6    2    0  2890     6    21    0   128
7      0    0    0  152    0    0     1  1009     1    0     1
8      0    0    1  127    4    0     2    31  1199    1     5
9     14    0  176  234   20   34     9   141    96  310   103
10     0    0    0    0   48    0     1     1     0    0  1596
early stop counter: 1
val acc:0.9806339144706726, best validation acc: 0.9856091737747192, corresponding to test acc:                         0.6855103969573975 / 0.7482683658599854
after epoch: 13,now: 2024-07-15 11:51:52.950537,epoch time: 0:33:13.135387,used: 7:04:27.023403,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.985686, 'precision': 0.96322155, 'recall': 0.9623891, 'specificity': 0.9984568, 'f1': 0.961787, 'auroc': 0.9998314}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     1    9    0     7     0     0    1     36
1     0  1311    0     7    0    0     1    12     0    0      0
2     0     0  287     0   11    0     0     0     1   13      0
3     0     0    0  8329    0    0     0    75    35    1      0
4     1     0    1     0  525    0     1     0     3    0      8
5     0     0    0    11    0  495     0     0     1   14      0
6     0     0    1     0    0    1  1898     0     1    0      6
7     0     1    1    35    2    0     1  7194    13    3     13
8     0     0    1    23   19    0     1    17  3219    1     14
9     0     0    7     0    2   24     0     0     1  457      2
10    0     0    1     5   80    0     3     0     6    0  12697
---- Validation: 
scalar performance:
{'acc': 0.98542196, 'precision': 0.9640645, 'recall': 0.9605532, 'specificity': 0.9984244, 'f1': 0.9612643, 'auroc': 0.9998308}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     1    6    0     3     0     2    0     32
1     0  1312    0     9    0    0     0    10     0    0      1
2     0     0  272     0   22    0     0     2     1   15      0
3     0     0    0  8322    0    2     0    77    39    0      0
4     1     0    2     0  524    0     0     0     1    1     10
5     0     0    0     8    1  498     0     0     2   11      1
6     0     0    0     1    1    0  1900     0     0    0      6
7     0     4    0    36    2    0     1  7189    19    0     14
8     1     0    1    25   20    0     0    23  3212    1     13
9     0     0    8     2    0   22     0     0     0  460      1
10    0     0    0     4   70    0     3     2     5    0  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67536557, 'precision': 0.6333122, 'recall': 0.55648077, 'specificity': 0.9670193, 'f1': 0.55955875, 'auroc': 0.8694108}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   706     4   1   44   11    7   271   31    26   18    51
1     0  1044   0   34    0    0     1  332    14    2    72
2     1     0  58    8  534    2    14   39    79   61   219
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  523    0     0    1     5    0  1104
5     4     0   7   72   10  204    13    2     9  258    13
6     0     0   0    1    7    0  2740    2    20    0   297
7     0     0   0  153    2    0     4  996     5    0     4
8     0     0   0   30   20    0    28   19  1258    1    14
9     4     0  85   82   82   62    29   66   140  521    66
10    0     0   0    0   43    0     0    0     0    0  1603
early stop counter: 2
val acc:0.9854219555854797, best validation acc: 0.9856091737747192, corresponding to test acc:                         0.6855103969573975 / 0.7482683658599854
after epoch: 14,now: 2024-07-15 12:24:37.324984,epoch time: 0:32:44.374447,used: 7:37:11.397850,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98416096, 'precision': 0.95631564, 'recall': 0.95680445, 'specificity': 0.9983251, 'f1': 0.95603955, 'auroc': 0.99974555}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    1    1     3     0     0    0      1
1     0  1312    0     4    0    0     1    13     2    0      0
2     1     0  279     2    8    2     1     5     2   12      0
3     2     0    0  8370    0    8     6    28    23    0      0
4     7     0    4     0  500    1     2     1     6    0     18
5     0     0    0    36    0  474     0     0     4    5      0
6     2     0    0     0    0    0  1905     0     0    0      1
7     2     0    0    81    0    0     3  7166     9    0      4
8     0     0    0    48    2    0     3    20  3220    0      2
9     0     0   10     9    0   38     1     2     1  432      0
10   40     0    1     6   58    1    12     3    22    0  12650
---- Validation: 
scalar performance:
{'acc': 0.98478, 'precision': 0.957029, 'recall': 0.9558147, 'specificity': 0.9983941, 'f1': 0.955812, 'auroc': 0.9997255}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     1    0    0     2     0     0    0      0
1     0  1307    0     3    0    0     1    19     2    0      0
2     2     0  281     1    7    1     0     7     2   11      0
3     1     0    0  8378    0   10     4    28    19    0      0
4     9     0    1     0  501    1     5     2     5    0     15
5     0     0    0    41    0  468     0     0     4    8      0
6     2     0    0     0    0    0  1904     0     0    0      2
7     2     2    0    74    0    0     4  7169    10    0      4
8     1     0    0    34    0    1     1    14  3242    0      3
9     3     0   10     6    0   44     0     3     2  424      1
10   33     0    0     7   60    0     9     8    17    0  12662
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67760444, 'precision': 0.6372931, 'recall': 0.54043674, 'specificity': 0.96766686, 'f1': 0.52467823, 'auroc': 0.86986226}
confusion matrix:
      0     1   2    3    4   5     6     7     8    9     10
0   1006     0   0    8    0   2   121    16     9    6     2
1      1  1125   0   25    0   0     6   307    13    0    22
2     35     0  34   50  152   3    63    80   265   61   272
3      0     0   0    0    0   0     0     0     0    0     0
4      1     0   1    1  261   0     7     2    18    0  1342
5     19     0   0  232    0  83    17     6    18  214     3
6      1     0   0    3    0   0  3009     1    10    0    43
7      1     0   0  147    0   0     4  1010     1    0     1
8      0     0   0  104    1   0    21    19  1220    1     4
9     29     0  36  289   15  20    69   140   176  312    51
10     0     0   0    1   18   0     0     1     1    0  1625
early stop counter: 3
val acc:0.9847800135612488, best validation acc: 0.9856091737747192, corresponding to test acc:                         0.6855103969573975 / 0.7482683658599854
after epoch: 15,now: 2024-07-15 12:56:51.143751,epoch time: 0:32:13.818767,used: 8:09:25.216617,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98555225, 'precision': 0.9596129, 'recall': 0.95736074, 'specificity': 0.9984481, 'f1': 0.9572443, 'auroc': 0.9998283}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    1     0   10    0     2     0     0    0     18
1     0  1316    0     2    0    0     0    13     1    0      0
2     0     0  264     0   45    0     0     0     0    3      0
3     1     0    0  8384    2    2     0    29    19    1      1
4     0     0    0     0  529    0     0     0     3    0      7
5     0     0    0     4    1  469     0     0     0   46      1
6     2     0    0     0    1    0  1888     0     1    1     15
7     0     2    2    85    3    0     1  7112    46    3      7
8     0     0    0    23   19    0     1     7  3215    0     30
9     0     0   17     0    4    5     0     0     1  466      0
10    0     0    1     3   40    0     1     2     5    0  12741
---- Validation: 
scalar performance:
{'acc': 0.98563594, 'precision': 0.9581411, 'recall': 0.9569824, 'specificity': 0.9984479, 'f1': 0.95653987, 'auroc': 0.99982786}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     0   12    0     2     0     0    0     20
1     0  1317    0     2    1    0     0     9     1    0      2
2     0     0  264     0   35    0     1     0     0   12      0
3     0     0    0  8380    0    4     0    30    23    2      1
4     0     0    1     0  527    0     0     0     0    0     11
5     0     0    0     7    1  472     1     0     1   38      1
6     0     0    0     0    1    0  1894     0     1    0     12
7     0     2    6    89    7    0     3  7118    30    0     10
8     0     0    1    26   18    0     1     5  3217    0     28
9     0     0   23     0    1    4     0     0     1  464      0
10    0     0    1     2   42    0     1     3     1    0  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63737494, 'precision': 0.6072316, 'recall': 0.5166415, 'specificity': 0.96356505, 'f1': 0.51054776, 'auroc': 0.86086833}
confusion matrix:
     0    1    2    3    4   5     6     7     8    9     10
0   910    3    3   16   23   0   117    14    15   31    38
1     1  968    0   32    0   0     3   390    16    0    89
2     2    0   57   21  556   1     7    13   138   19   201
3     0    0    0    0    0   0     0     0     0    0     0
4     0    0    0    0  453   0     0     0     8    0  1172
5     5    0    9  219   21  79     6     3    41  191    18
6     0    0    0    4    8   0  2540     1    75    0   439
7     0    0    0  127    1   0     0  1029     6    0     1
8     1    0    0   93    9   0     8     5  1245    0     9
9     5    0  135  249  127  17    28    25   283  222    46
10    0    0    0    0   39   0     0     0     0    0  1607
better model found
persisted
after epoch: 16,now: 2024-07-15 13:29:25.862992,epoch time: 0:32:34.719241,used: 8:41:59.935858,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9896458, 'precision': 0.97422224, 'recall': 0.9705226, 'specificity': 0.99887955, 'f1': 0.9722068, 'auroc': 0.9999094}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     0    1    1    16     0     1    0     11
1     0  1328    0     1    0    0     0     3     0    0      0
2     0     0  301     0    4    0     1     3     1    2      0
3     0     0    0  8343    0    9     1    67    17    1      1
4     4     0    6     0  502    0     1     0     1    0     25
5     0     0    0     4    0  504     0     0     0   11      1
6     0     0    0     0    0    0  1907     0     0    0      0
7     0     1    0    25    0    0     1  7227     4    0      5
8     0     1    0    14    2    1     1    44  3225    2      5
9     2     0   14     0    2   20     1     2     0  452      0
10    4     0    1     1   16    1    16     3     4    0  12748
---- Validation: 
scalar performance:
{'acc': 0.98954123, 'precision': 0.9722982, 'recall': 0.971606, 'specificity': 0.9988849, 'f1': 0.97166884, 'auroc': 0.99989355}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    3    1    14     2     1    0      8
1     1  1324    0     0    0    0     0     6     1    0      0
2     0     0  304     0    3    0     1     1     1    2      0
3     2     4    0  8343    0    5     0    66    20    0      0
4     5     0    8     0  505    0     2     1     3    0     15
5     0     0    0     2    1  508     0     0     1    9      0
6     0     0    0     0    0    0  1908     0     0    0      0
7     0     3    0    35    0    0     0  7222     1    0      4
8     0     0    0    14    0    0     0    37  3238    1      6
9     1     0   23     0    0   19     2     0     1  447      0
10    5     0    1     1   16    1    20     3     8    0  12741
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68537045, 'precision': 0.6336458, 'recall': 0.5644506, 'specificity': 0.9682152, 'f1': 0.5587291, 'auroc': 0.87449276}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   720    1   1   26    8    8   333    28     8   26    11
1     0  967   0   19    1    0     0   481     8    1    22
2     0    0  94   21  350   11    21   109   203   62   144
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   4    0  433    0     7     4    24    0  1161
5     0    0   7  126    1  303    16     4    13  122     0
6     0    0   0    2    1    0  3028     1    14    0    21
7     0    0   0   61    0    0     0  1102     0    0     1
8     0    0   0   82    2    1    11    22  1249    1     2
9     2    0  91  231   37  124    32   152   152  290    26
10    0    0   0    0   31    0     2     1     2    0  1610
better model found
persisted
after epoch: 17,now: 2024-07-15 14:02:57.779660,epoch time: 0:33:31.916668,used: 9:15:31.852526,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99066246, 'precision': 0.97497636, 'recall': 0.9775015, 'specificity': 0.99901956, 'f1': 0.9759327, 'auroc': 0.9999206}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     2    5    0    17     0     0    1      7
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  296     0    3    1     0     1     0   11      0
3     0     0    0  8357    0    2     0    47    27    3      0
4     1     0    3     0  525    0     2     1     1    1      5
5     0     0    1     3    0  508     0     0     1    8      0
6     0     0    0     0    0    0  1907     0     0    0      1
7     0     8    0    16    0    0     0  7203    27    0      9
8     0     0    0    14    5    0     0     5  3258    0     14
9     0     0    4     1    0   13     0     0     1  473      0
10    0     0    0     2   54    0     9     1     4    0  12724
---- Validation: 
scalar performance:
{'acc': 0.99130666, 'precision': 0.97602844, 'recall': 0.97695994, 'specificity': 0.99907655, 'f1': 0.9762479, 'auroc': 0.999922}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     0    5    0    12     0     0    1     12
1     0  1328    0     1    0    0     0     1     1    0      1
2     0     0  294     0    3    0     0     0     0   14      1
3     0     1    0  8375    0    0     0    47    17    0      0
4     1     0    2     0  522    0     1     0     1    0     12
5     0     0    0     3    0  506     0     0     1   10      1
6     0     0    0     0    0    0  1908     0     0    0      0
7     0     6    1    23    0    0     1  7198    31    1      4
8     0     1    1     4    1    0     0     5  3270    0     14
9     0     0    5     0    0   14     0     0     0  473      1
10    0     0    0     3   53    0     5     1     1    0  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68949836, 'precision': 0.6399741, 'recall': 0.56772196, 'specificity': 0.9689089, 'f1': 0.5602505, 'auroc': 0.87502456}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   879     1   1   64    2    6   131    20    29    9    28
1     0  1003   0   27    2    0     2   396    16    0    53
2     5     0  64   27  225    9     5    45   270   44   321
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  414    0     4     0    23    0  1192
5     2     0   9  184    1  260     2     1    23  109     1
6     0     0   0    8    0    0  2966     1    52    0    40
7     0     0   0   74    0    0     0  1079     9    0     2
8     0     0   0   64    1    0     1     4  1294    1     5
9     8     0  80  212   24  120     7    56   280  288    62
10    0     0   0    0   36    0     1     1     0    0  1608
better model found
persisted
after epoch: 18,now: 2024-07-15 14:40:47.136267,epoch time: 0:37:49.356607,used: 9:53:21.209133,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9902879, 'precision': 0.96494514, 'recall': 0.9709706, 'specificity': 0.9990007, 'f1': 0.9677888, 'auroc': 0.99989045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    4    1     2     0     0    0      2
1     0  1329    0     0    1    0     0     2     0    0      0
2     0     0  284     0    2    0     0     0     0   25      1
3     0     1    0  8347    0   12     0    41    31    4      2
4     2     0   17     0  500    0     2     1     3    0     14
5     0     0    1     1    0  488     0     0     0   30      1
6     0     0    0     0    0    0  1908     0     0    0      0
7     1    20    2    12    0    0     1  7216     6    1      3
8     1     1    3     8    0    1     3    13  3251    0     14
9     0     0    6     0    0   11     1     1     0  474      0
10    5     1    2     0   18    0    24     0     1    0  12742
---- Validation: 
scalar performance:
{'acc': 0.9902902, 'precision': 0.9671847, 'recall': 0.9725294, 'specificity': 0.9989952, 'f1': 0.96964896, 'auroc': 0.9998828}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    3    0     2     0     0    1      2
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  286     0    4    1     0     0     0   20      1
3     0     0    1  8334    0   16     0    45    36    5      3
4     2     0   18     0  496    0     0     1     4    2     16
5     0     0    1     0    0  493     0     0     0   27      0
6     1     0    0     0    0    0  1907     0     0    0      0
7     0    20    3    11    0    0     2  7216     8    0      5
8     0     1    3    10    2    0     6    12  3250    0     12
9     0     0    6     0    0    9     0     0     0  478      0
10    3     0    0     0    7    0    26     0     3    0  12757
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7535157, 'precision': 0.6772946, 'recall': 0.6319649, 'specificity': 0.9752106, 'f1': 0.63074964, 'auroc': 0.88273174}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   944     5    8  34    3   18    78    18     9   47     6
1     1  1276    0  15    1    0     6   180     9    1    10
2     1     1  270  10  208   15    12    34   220  104   140
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   12   1  423    0    16     2    25    0  1154
5     0     0    4  47    1  240     2     2    12  284     0
6     0     0    1   6    0    0  3039     1    13    0     7
7     0     0    0  85    0    0     0  1076     2    0     1
8     0     0    0  42    1    5     3    13  1301    2     3
9     0     1  145  42   10  113     2    50   154  592    28
10    0     0    0   0   31    0     5     1     0    0  1609
new oracle model saved
early stop counter: 1
val acc:0.9902902245521545, best validation acc: 0.9913066625595093, corresponding to test acc:                         0.6894983649253845 / 0.7535157203674316
after epoch: 19,now: 2024-07-15 15:14:14.052214,epoch time: 0:33:26.915947,used: 10:26:48.125080,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9774015, 'recall': 0.97886986, 'specificity': 0.9991588, 'f1': 0.97804016, 'auroc': 0.99993694}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    3    0     1     0     0    2      1
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  299     0    1    0     0     0     0   12      0
3     1     0    0  8382    0    5     0    39     9    1      1
4     1     0   11     0  503    0     0     2     2    3     16
5     0     0    0     1    0  516     0     0     0    3      1
6     1     0    0     0    0    0  1902     0     0    1      1
7     0     6    1    26    0    0     1  7223     4    1      2
8     0     0    1    27    1    0     1    26  3233    0      7
9     0     0    2     0    0   27     0     0     0  464      0
10    4     0    4     0   12    0     2     6     2    2  12762
---- Validation: 
scalar performance:
{'acc': 0.9928581, 'precision': 0.9791126, 'recall': 0.9797781, 'specificity': 0.9992306, 'f1': 0.97934484, 'auroc': 0.9999517}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    3    0     0     2     0    0      2
1     0  1328    0     0    0    0     0     3     1    0      0
2     0     0  297     0    1    0     0     0     0   14      0
3     1     0    0  8390    0    6     0    35     6    1      1
4     2     0    9     0  508    2     1     1     2    1     13
5     0     0    0     0    0  516     1     0     0    3      1
6     1     0    4     0    1    0  1901     0     0    1      0
7     0     1    0    31    0    0     0  7228     3    0      2
8     0     1    3    25    0    0     1    25  3235    0      6
9     0     0    2     0    0   25     0     0     0  466      0
10    2     0    2     0    8    0     5     5     1    0  12773
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6723571, 'precision': 0.6241174, 'recall': 0.5728547, 'specificity': 0.9670543, 'f1': 0.5532817, 'auroc': 0.8713205}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   709     8    4  65    1   31   127    84    31   75    35
1     0  1011    0  23    0    0     1   434     9    0    21
2     0     0  135  12  196   37     4    78   198   59   296
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  180    0     0     1    16    1  1434
5     1     0    5  69    1  383     2     3     7  117     4
6     0     0    2   2    0    1  2775     1    41    0   245
7     0     0    0  55    0    0     0  1106     2    0     1
8     0     0    0  56    1    1     0    29  1277    1     5
9     0     0  111  72   12  226     4   138   142  397    35
10    0     0    0   0    7    0     1     1     0    0  1637
better model found
persisted
after epoch: 20,now: 2024-07-15 15:49:29.384446,epoch time: 0:35:15.332232,used: 11:02:03.457312,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9926691, 'precision': 0.98072445, 'recall': 0.97593373, 'specificity': 0.9992075, 'f1': 0.97804725, 'auroc': 0.99994373}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    7    0     0     0     0    0      1
1     0  1326    0     1    0    0     0     3     1    0      0
2     0     0  289     0   13    0     0     0     0   10      0
3     0     1    0  8414    0    0     0    18     6    0      0
4     1     0    0     0  513    0     0     0     1    0     24
5     0     0    0     4    0  484     0     0     2   30      1
6     5     0    0     0    2    0  1893     1     0    0      7
7     0    26    0    40    0    0     0  7184    11    0      2
8     1     0    0    13    1    0     0     4  3270    0      7
9     0     0    3     1    0    3     0     1     1  483      1
10    6     1    0     0    3    0     2     4     4    0  12771
---- Validation: 
scalar performance:
{'acc': 0.99253714, 'precision': 0.98055553, 'recall': 0.97696656, 'specificity': 0.99919, 'f1': 0.9785738, 'auroc': 0.9999466}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     2    5    0     0     0     0    0      1
1     0  1330    0     0    0    0     0     1     1    0      0
2     0     0  291     1   12    0     0     0     0    7      1
3     0     2    0  8420    0    1     0     8     9    0      0
4     2     0    1     0  508    0     0     0     6    0     22
5     0     0    0     4    0  491     0     0     1   25      0
6     5     0    0     1    0    0  1890     0     1    1     10
7     0    28    1    46    0    0     0  7171    14    1      4
8     0     0    0    17    1    0     0     3  3268    0      7
9     0     0    5     0    0    1     0     2     0  484      1
10    8     0    1     0    3    0     0     2     4    0  12778
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6405933, 'precision': 0.61841834, 'recall': 0.52421737, 'specificity': 0.9641704, 'f1': 0.5182147, 'auroc': 0.8584914}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   777     8   0  172    1    3    19   35    62   28    65
1     0  1195   0   40    0    0     0  245    10    0     9
2     0     0  54   30  200    3     0   44   234   46   404
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  125    0     1    1    10    0  1496
5     1     0   2  147    1  154     1    1    24  248    13
6     0     0   0    3    0    0  2634    1    84    0   345
7     0     0   0  234    0    0     0  927     1    0     2
8     0     0   0   94    1    0     0   17  1252    1     5
9     2     1  57  184   27   57     0   88   256  397    68
10    0     0   0    0    4    0     0    1     0    0  1641
early stop counter: 1
val acc:0.9925371408462524, best validation acc: 0.9928581118583679, corresponding to test acc:                         0.6723570823669434 / 0.7535157203674316
after epoch: 21,now: 2024-07-15 16:28:18.701688,epoch time: 0:38:49.317242,used: 11:40:52.774554,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99173266, 'precision': 0.97437835, 'recall': 0.9767363, 'specificity': 0.99912083, 'f1': 0.9751557, 'auroc': 0.99991643}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    0     0     0     0    0      6
1     0  1328    0     0    0    0     0     3     0    0      1
2     0     0  299     0    0    0     0     0     0   13      0
3     0     0    0  8338    0    5     0    55    36    3      0
4     5     0   42     0  478    0     0     0     2    0     12
5     1     0    0     1    0  509     0     0     0   10      0
6     1     0    0     0    0    0  1903     0     0    0      3
7     1     3    0    27    0    0     1  7224     5    0      1
8     0     1    0     8    0    0     1    21  3258    0      7
9     1     0    0     0    1   11     0     0     1  478      0
10    0     0    0     0    7    0     1     4     6    1  12776
---- Validation: 
scalar performance:
{'acc': 0.9901297, 'precision': 0.9677965, 'recall': 0.9705789, 'specificity': 0.9989613, 'f1': 0.9685185, 'auroc': 0.9998894}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    1    0     2     0     0    0      3
1     0  1325    0     0    0    0     0     6     1    0      0
2     0     0  294     0    0    0     0     0     0   18      0
3     1     0    0  8328    0    7     2    65    36    1      0
4     4     0   51     1  462    0     0     0     5    1     15
5     0     0    0     1    0  508     0     0     0   12      0
6     0     0    0     0    1    0  1904     0     0    0      3
7     0     2    0    31    0    0     2  7217    12    0      1
8     0     1    2     8    2    1     3    15  3256    0      8
9     2     0    2     1    0   15     0     1     1  471      0
10    3     0    1     1    5    0     1     4     6    1  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6794235, 'precision': 0.63302237, 'recall': 0.55777705, 'specificity': 0.96785575, 'f1': 0.54708564, 'auroc': 0.8634408}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   866     8   3   60    0    3   155    13    17   10    35
1     1  1200   0   13    0    1     2   251    13    0    18
2    11     0  70   48  169    6     3    64   307   53   284
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    1  175    0     2     3    40    0  1411
5     4     0   7  184    1  175     2     4    19  193     3
6     0     0   0    3    0    0  2841     1    51    0   171
7     0     0   0  113    0    0     0  1047     2    0     2
8     0     0   0   51    0    0     4    24  1288    1     2
9    18     1  66  234   19   77     6    57   193  413    53
10    0     0   0    0    7    0     1     1     1    0  1636
early stop counter: 2
val acc:0.9901297092437744, best validation acc: 0.9928581118583679, corresponding to test acc:                         0.6723570823669434 / 0.7535157203674316
after epoch: 22,now: 2024-07-15 17:02:35.087017,epoch time: 0:34:16.385329,used: 12:15:09.159883,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99208045, 'precision': 0.97534555, 'recall': 0.9782592, 'specificity': 0.99916124, 'f1': 0.9765496, 'auroc': 0.9999267}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     2    0    0     0     0     0    0      1
1     0  1324    0     0    0    0     0     6     1    0      1
2     0     0  296     0    0    0     0     0     0   16      0
3     2     0    0  8348    0    2     0    67    16    0      1
4     6     0   13     0  512    0     0     0     1    1      5
5     0     0    0     5    0  484     0     0     1   31      0
6     2     0    0     0    0    0  1902     0     0    0      2
7     1     0    0    13    0    0     1  7244     2    0      4
8     4     0    0    20    2    0     1    21  3242    1      5
9     0     0    3     2    0    5     0     1     0  482      0
10   10     0    2     0   14    0     0     0     2    0  12766
---- Validation: 
scalar performance:
{'acc': 0.9917614, 'precision': 0.9739066, 'recall': 0.9789571, 'specificity': 0.9991367, 'f1': 0.9760626, 'auroc': 0.99992883}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   482     0    0     0    1    0     0     0     0    0      0
1     0  1320    0     0    0    0     0    10     1    0      1
2     0     0  297     0    0    1     0     0     0   14      0
3     0     0    1  8343    0    2     1    70    20    1      2
4     6     0   10     0  514    0     1     1     1    1      5
5     0     0    1     5    0  478     0     0     1   36      0
6     3     0    1     0    0    1  1900     0     0    0      3
7     0     0    0    12    0    0     0  7245     6    1      1
8     2     0    1    18    3    0     1    16  3250    2      3
9     1     0    1     0    0    2     0     0     0  489      0
10    9     0    2     2   22    0     0     2     0    0  12759
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68970823, 'precision': 0.6428342, 'recall': 0.564776, 'specificity': 0.96880424, 'f1': 0.5581882, 'auroc': 0.8732144}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   866    5    1   27    1    4   163    45    23   12    23
1     3  901    0   25    0    1    13   501     5    1    49
2    30    0  104   32  312    3     6    70   199   59   200
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    1    0  410    0     2     2    18    0  1200
5     7    0    4  179    0  152     3     5    21  212     9
6     2    0    0    4    0    0  2918     2    32    0   109
7     0    0    0   27    0    0     2  1132     2    0     1
8     0    0    0   57    0    1     7    30  1271    1     3
9    28    0   94  176   25   56    13   118   115  482    30
10    0    0    0    0   22    0     1     1     0    0  1622
early stop counter: 3
val acc:0.9917613863945007, best validation acc: 0.9928581118583679, corresponding to test acc:                         0.6723570823669434 / 0.7535157203674316
after epoch: 23,now: 2024-07-15 17:35:00.596319,epoch time: 0:32:25.509302,used: 12:47:34.669185,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9899668, 'precision': 0.98124874, 'recall': 0.97736704, 'specificity': 0.99891746, 'f1': 0.97917575, 'auroc': 0.9999338}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    3    0     0     1     1    0      5
1     0  1325    0     0    0    0     0     6     1    0      0
2     1     0  303     0    3    0     0     3     0    2      0
3     0     0    0  8258    0    1     0   107    74    0      0
4     4     0    2     0  515    0     0     0     5    0     13
5     1     0    0    11    0  495     0     0     7    7      0
6     1     0    0     0    0    0  1884     1     4    0     16
7     0     1    0     3    0    0     0  7240    16    0      4
8     0     0    0     0    5    0     0     6  3283    0      2
9     2     0   16     0    0    5     0     0     5  463      0
10    1     0    1     6    8    0     0     3    11    0  12762
---- Validation: 
scalar performance:
{'acc': 0.99047744, 'precision': 0.9812652, 'recall': 0.9769736, 'specificity': 0.9989754, 'f1': 0.978987, 'auroc': 0.9999385}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    3    0     2     1     1    0      5
1     0  1323    0     3    0    0     0     5     1    0      0
2     1     0  301     0    2    0     0     2     1    3      2
3     0     0    0  8262    0    2     1   105    70    0      0
4     1     1    3     0  513    0     0     1     6    0     14
5     0     0    1     7    0  501     0     0     4    8      0
6     1     0    1     0    2    0  1889     1     3    0     11
7     0     1    0     3    0    0     0  7247    12    0      2
8     0     0    0     0    0    0     0     3  3292    0      1
9     1     0   18     0    0    5     0     0     7  462      0
10    0     0    0     6   10    0     0     6     6    0  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59875464, 'precision': 0.5902958, 'recall': 0.49042058, 'specificity': 0.9598055, 'f1': 0.46871933, 'auroc': 0.8602575}
confusion matrix:
     0    1   2    3    4   5     6     7     8    9     10
0   599    3   1  120    3  10    68    82   195   20    69
1     0  962   0   38    0   0     1   467    16    0    15
2     2    0  36   19  331   2     0    59   357   26   183
3     0    0   0    0    0   0     0     0     0    0     0
4     0    0   0    0  292   0     1     2    27    0  1311
5     1    0   3  238    5  83     0     1    92  166     3
6     2    0   0    4    5   0  2240     3   444    0   369
7     0    0   0   32    0   0     0  1122     8    0     2
8     0    0   0   32    0   0     0    12  1323    1     2
9     0    0  55  194   54  31     0    69   434  263    37
10    0    0   0    0    6   0     0     1     1    0  1638
early stop counter: 4
val acc:0.990477442741394, best validation acc: 0.9928581118583679, corresponding to test acc:                         0.6723570823669434 / 0.7535157203674316
after epoch: 24,now: 2024-07-15 18:07:25.323847,epoch time: 0:32:24.727528,used: 13:19:59.396713,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99274933, 'precision': 0.9806216, 'recall': 0.97196615, 'specificity': 0.9992179, 'f1': 0.97611314, 'auroc': 0.99992806}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    3    0     2     0     0    0      2
1     0  1332    0     0    0    0     0     0     0    0      0
2     1     0  289     0   12    0     1     2     2    3      2
3     0     0    0  8419    0    0     1    13     6    0      0
4     3     0    0     0  523    0     1     0     2    0      9
5     0     0    0    15    3  488     0     0     3   11      1
6     1     0    0     1    1    0  1898     1     2    0      4
7     0     8    0    41    0    0     0  7192    18    0      1
8     1     0    0    14    2    0     0     8  3264    0      6
9     2     0   13     9    3   14     0     2     2  444      4
10    1     0    1     0    5    0     3     0     4    0  12781
---- Validation: 
scalar performance:
{'acc': 0.9929116, 'precision': 0.9815916, 'recall': 0.9727688, 'specificity': 0.9992276, 'f1': 0.9769265, 'auroc': 0.99994385}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    3    0     0     0     0    0      1
1     0  1327    0     0    0    0     0     4     1    0      0
2     0     0  294     0    8    0     0     5     1    2      2
3     0     0    0  8419    0    0     0    14     7    0      0
4     4     0    0     0  517    0     0     0     5    0     13
5     1     0    0    20    4  488     1     0     1    5      1
6     2     0    0     0    1    0  1904     0     0    0      1
7     0     3    0    39    0    0     1  7209    10    0      3
8     0     0    0    17    3    0     1     6  3261    0      8
9     5     0   17     8    2    7     0     2     8  443      1
10    2     0    0     0   11    0     1     2     1    0  12779
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6453509, 'precision': 0.61351, 'recall': 0.52550054, 'specificity': 0.9644798, 'f1': 0.4992677, 'auroc': 0.86219966}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   922    10   1   58    3   1    72    39    41    2    21
1     0  1167   0   10    0   0     1   301    11    0     9
2     7     0  35   31  161   1     1    84   380   13   302
3     0     0   0    0    0   0     0     0     0    0     0
4     0     0   0    0  210   0     1     2    34    0  1386
5     9     2   6  254    8  87     2     3    46  159    16
6     0     0   0    1    0   0  2559     0   197    0   310
7     0     0   0   54    0   0     0  1106     3    0     1
8     0     0   0   39    0   0     2    21  1302    0     6
9    11     7  41  265   31  31     7   116   348  197    83
10    0     0   0    0    6   0     0     1     0    0  1639
better model found
persisted
after epoch: 25,now: 2024-07-15 18:40:54.289773,epoch time: 0:33:28.965926,used: 13:53:28.362639,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9899668, 'precision': 0.9742669, 'recall': 0.9533701, 'specificity': 0.9989194, 'f1': 0.96176016, 'auroc': 0.9999542}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     1    5    0    35     0     1    1      7
1     0  1321    0     0    0    0     0     9     0    0      2
2     0     0  298     0    1    0     0     3     0    9      1
3     0     0    0  8359    0    0     0    46    34    0      0
4     1     0    8     0  469    0     0     2     4    0     55
5     0     0    0     9    0  421     1     0     5   85      0
6     0     0    0     0    0    0  1904     0     2    0      1
7     0     0    0     9    0    0     0  7248     5    0      2
8     0     0    0     3    0    0     0     8  3279    0      3
9     0     0    6     1    0    0     1     0     0  484      0
10    0     0    1     0    1    0     1     1     5    0  12785
---- Validation: 
scalar performance:
{'acc': 0.9901565, 'precision': 0.97524315, 'recall': 0.95321035, 'specificity': 0.9989411, 'f1': 0.9620841, 'auroc': 0.9999511}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     2    5    0    36     1     0    1      9
1     0  1317    0     0    0    0     0    11     0    0      4
2     0     0  292     0    0    0     0     4     1   13      2
3     0     0    0  8372    0    0     0    35    33    0      0
4     0     0    9     0  473    0     0     1     9    0     47
5     0     0    1     2    0  427     0     0     4   87      0
6     0     0    0     0    0    0  1904     0     1    0      3
7     0     0    0    11    0    0     0  7242    10    1      1
8     0     0    0     3    0    0     0     7  3280    0      6
9     0     0    1     0    0    0     0     1     0  490      1
10    0     0    0     1    0    0     0     0     4    0  12791
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.61365706, 'precision': 0.6238433, 'recall': 0.4837327, 'specificity': 0.960754, 'f1': 0.4494713, 'auroc': 0.8654007}
confusion matrix:
     0    1    2    3    4   5     6     7     8    9     10
0   269    0    4   78    7   2   475   110   103   77    45
1     0  777    0    7    0   0     1   639    21    0    54
2     0    0  100    9  129   1     1    82   338   59   296
3     0    0    0    0    0   0     0     0     0    0     0
4     0    0    1    0  223   0     2     1    33    0  1373
5     0    0    0  141    1  37     3     2    59  345     4
6     0    0    0    3    0   0  2779     2   102    0   181
7     0    0    0   14    0   0     0  1147     2    0     1
8     0    0    0   25    0   0     0    29  1310    1     5
9     1    0   76  102    3   7     2   119   287  493    47
10    0    0    0    0    8   0     0     1     1    0  1636
early stop counter: 1
val acc:0.9901564717292786, best validation acc: 0.9929115772247314, corresponding to test acc:                         0.6453508734703064 / 0.7535157203674316
after epoch: 26,now: 2024-07-15 19:13:25.348538,epoch time: 0:32:31.058765,used: 14:25:59.421404,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99157214, 'precision': 0.9777177, 'recall': 0.97820985, 'specificity': 0.99908483, 'f1': 0.97770715, 'auroc': 0.9999368}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    2    0     3     0     0    3      2
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  306     0    0    0     0     1     0    4      1
3     0     1    0  8401    0    1     1    27     7    0      0
4     2     0    7     0  519    0     0     1     0    0     10
5     0     0    3     2    0  488     0     0     1   27      0
6     0     0    1     0    0    0  1904     2     0    0      1
7     0     5    0    18    0    0     1  7236     0    0      2
8     1     0    3    16    3    0     7    86  3164    0     16
9     0     0   17     0    0    2     0     3     0  470      1
10    1     1    0     1   12    0     2     5     1    0  12769
---- Validation: 
scalar performance:
{'acc': 0.9913334, 'precision': 0.9783274, 'recall': 0.9794654, 'specificity': 0.99904764, 'f1': 0.97874486, 'auroc': 0.99994105}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    2    0     1     0     0    0      2
1     0  1329    0     1    0    0     0     1     0    1      0
2     0     0  304     0    1    0     0     1     0    4      2
3     1     1    0  8391    0    1     2    34    10    0      0
4     2     0    4     0  522    0     0     0     0    1     10
5     0     0    0     3    0  490     0     0     1   26      1
6     0     0    0     0    0    0  1907     0     0    0      1
7     0     2    0    24    0    0     0  7237     1    0      1
8     0     0    3    18    6    0     3    74  3166    0     26
9     0     0   16     0    0    4     0     1     0  471      1
10    3     0    0     1   15    0     3     5     2    1  12766
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7111873, 'precision': 0.6589508, 'recall': 0.581395, 'specificity': 0.97086906, 'f1': 0.57946104, 'auroc': 0.8741452}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   813    12    5   54    4    2   136    68     7   49    20
1     0  1268    0   22    0    0     0   191     5    0    13
2     2     1  145   21  332    2     6    68    96   48   294
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  486    0     3     1     6    0  1134
5     0     0    8  100    0  114     6     4    24  334     2
6     0     3    0    6    5    0  2866     1    22    0   164
7     0     0    0   57    0    0     0  1105     1    0     1
8     0     0    1   49    7    0     8    33  1258    1    13
9     4     1  117   93   23   35    12    98   167  506    81
10    0     0    0    0   39    0     2     1     0    0  1604
early stop counter: 2
val acc:0.9913334250450134, best validation acc: 0.9929115772247314, corresponding to test acc:                         0.6453508734703064 / 0.7535157203674316
after epoch: 27,now: 2024-07-15 19:45:33.181384,epoch time: 0:32:07.832846,used: 14:58:07.254250,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99381953, 'precision': 0.9828677, 'recall': 0.9815763, 'specificity': 0.99934006, 'f1': 0.9820996, 'auroc': 0.9999591}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    3    0     3     0     0    0      5
1     0  1323    0     4    0    0     0     4     0    0      1
2     0     0  290     0   19    0     0     0     0    2      1
3     0     0    0  8387    0    4     0    29    18    0      0
4     3     0    1     0  527    0     0     0     0    0      8
5     0     0    0     1    0  514     0     0     0    6      0
6     2     0    0     0    1    0  1904     0     0    0      1
7     0     3    0    24    0    0     0  7229     6    0      1
8     0     0    0    13    2    0     1     9  3264    0      5
9     0     0    9     1    3    5     0     2     1  472      0
10    3     0    0     3   16    0     1     2     5    0  12764
---- Validation: 
scalar performance:
{'acc': 0.9942223, 'precision': 0.98402977, 'recall': 0.98329675, 'specificity': 0.9993827, 'f1': 0.98356164, 'auroc': 0.99996316}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    3    0     0     0     0    0      4
1     0  1324    0     1    0    0     0     5     2    0      0
2     0     0  294     0   13    0     1     0     2    1      1
3     1     0    0  8388    0    7     0    25    18    1      0
4     3     0    0     0  528    0     0     0     1    0      7
5     0     0    0     1    0  513     0     0     0    6      1
6     1     0    0     0    0    0  1905     0     0    0      2
7     0     0    0    28    1    0     0  7229     4    0      3
8     0     0    0    11    2    2     0    10  3267    0      4
9     0     0    7     0    3   12     0     0     1  470      0
10    1     0    0     0   12    0     1     2     5    0  12775
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6558455, 'precision': 0.62647223, 'recall': 0.5522331, 'specificity': 0.9651855, 'f1': 0.53710693, 'auroc': 0.8692245}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   689     0   0   66    0   21   205    57    76    6    50
1     0  1082   0   31    1    0     3   308    49    0    25
2     0     0  62    8  248    9     3    35   294   35   321
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  319    0     1     0    23    0  1290
5     0     0   6   72    0  298     2     2    37  157    18
6     0     0   0    5    1    0  2566     0   145    0   350
7     1     0   0   64    0    0     0  1082    16    0     1
8     0     0   0   19    0    0     0     4  1345    1     1
9     8     0  53  101   34  136     8    50   343  305    99
10    0     0   0    0   19    0     0     0     1    0  1626
better model found
persisted
after epoch: 28,now: 2024-07-15 20:21:59.196792,epoch time: 0:36:26.015408,used: 15:34:33.269658,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99181294, 'precision': 0.98418456, 'recall': 0.97399956, 'specificity': 0.99909943, 'f1': 0.9788611, 'auroc': 0.99994296}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     1    5    0     1     1     1    1     13
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  301     1    2    1     0     1     1    5      0
3     0     0    0  8410    0    0     1    25     3    0      0
4     2     0    2     0  498    0     1     1    12    1     21
5     0     0    1    14    0  485     0     0     1   20      0
6     0     0    0     0    0    0  1906     1     0    1      0
7     0     3    0    27    0    0     0  7221    10    0      0
8     0     0    0    41    0    0     0    11  3242    0      1
9     0     0    9     3    0    1     0     1     0  479      0
10    1     0    1     5    3    0    13    10    24    0  12737
---- Validation: 
scalar performance:
{'acc': 0.99162763, 'precision': 0.9829935, 'recall': 0.9759822, 'specificity': 0.9990821, 'f1': 0.97926277, 'auroc': 0.99994385}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    5    0     2     2     0    0     10
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     0  306     0    0    1     0     1     0    4      0
3     0     0    0  8408    0    1     1    26     4    0      0
4     2     0    7     1  495    0     0     0    12    0     22
5     0     0    2     9    0  493     0     0     1   16      0
6     0     0    0     0    0    0  1907     0     1    0      0
7     0     3    0    34    0    1     0  7216    11    0      0
8     0     0    0    37    0    0     0    12  3245    0      2
9     0     0   11     2    0    1     0     2     0  477      0
10    0     1    1     5    5    0    11     8    28    1  12736
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67025816, 'precision': 0.6388672, 'recall': 0.543661, 'specificity': 0.96670115, 'f1': 0.5321405, 'auroc': 0.8705157}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   626     4    6   74    4    6   305    67    28   28    22
1     0  1005    0   10    0    0     0   459    13    0    12
2     0     0  120   18  108    7    11    88   421   37   205
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  322    0    12    11    85    0  1203
5     0     0   12  146    0  179    10     2    30  206     7
6     0     0    0    3    0    0  2949     1   102    0    12
7     0     0    0   14    0    0     0  1149     0    0     1
8     0     0    0   57    0    0     3    21  1288    1     0
9     0     1  100  166    7   59    24   102   323  325    30
10    0     0    0    0   22    0     3     1     3    0  1617
early stop counter: 1
val acc:0.9916276335716248, best validation acc: 0.9942222833633423, corresponding to test acc:                         0.6558455228805542 / 0.7535157203674316
after epoch: 29,now: 2024-07-15 20:54:04.556344,epoch time: 0:32:05.359552,used: 16:06:38.629210,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99162567, 'precision': 0.9704843, 'recall': 0.97497594, 'specificity': 0.9991193, 'f1': 0.97226095, 'auroc': 0.9999319}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     0    6    2     4     0     1    3     12
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  290     0    8    0     0     0     0   10      4
3     0     1    0  8392    1    5     2    17    14    5      2
4     0     0    5     0  523    0     0     0     1    2      8
5     0     0    0     0    0  488     0     0     0   33      0
6     3     0    0     1    0    0  1897     0     0    0      7
7     0    28    2    14    1    0     1  7199     9    3      6
8     0     1    5    17    9    7     0     3  3222   15     17
9     0     0    1     0    0    4     0     0     0  488      0
10    0     0    1     0   10    1     1     0     0    0  12777
---- Validation: 
scalar performance:
{'acc': 0.9914672, 'precision': 0.9728002, 'recall': 0.9772723, 'specificity': 0.9990949, 'f1': 0.9746634, 'auroc': 0.9999334}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     0    7    1     3     0     0    2     15
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  295     0    3    0     0     0     0   12      2
3     0     3    1  8388    1    2     0    19    19    6      1
4     0     0    3     0  525    0     0     0     1    0     10
5     0     0    0     0    0  493     0     0     0   28      0
6     2     0    0     1    0    1  1899     0     0    1      4
7     0    32    1    15    1    0     0  7200    10    1      5
8     1     1    4    22   10    6     0     4  3216   12     20
9     0     0    2     0    0    4     0     0     0  487      0
10    1     0    1     1   11    0     3     1     2    0  12776
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71055764, 'precision': 0.6388008, 'recall': 0.5863966, 'specificity': 0.97057104, 'f1': 0.58323777, 'auroc': 0.8738874}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   537     7    0  29   22   57   293    31    12  120    62
1     0  1124    0  15    0    1     1   301    13    7    37
2     0     0  161   2  372   14     4    30   107   70   255
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    3   0  640    0     3     1     8    0   978
5     2     0   13  33    7  195     4     1     8  322     7
6     0     0    0   8    4    1  2877     3    63    0   111
7     0     1    0  16    0    0     2  1141     2    1     1
8     0     0    7  27   13    6     5    23  1273   13     3
9     1     1  144  24   32  116     9    42    62  635    71
10    0     0    0   0   70    0     2     1     0    0  1573
early stop counter: 2
val acc:0.9914671778678894, best validation acc: 0.9942222833633423, corresponding to test acc:                         0.6558455228805542 / 0.7535157203674316
after epoch: 30,now: 2024-07-15 21:27:05.574792,epoch time: 0:33:01.018448,used: 16:39:39.647658,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:39:39.647658 at 2024-07-15 21:27:05.574792
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6558455, 'precision': 0.62647223, 'recall': 0.5522331, 'specificity': 0.9651855, 'f1': 0.53710693, 'auroc': 0.8692245}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   689     0   0   66    0   21   205    57    76    6    50
1     0  1082   0   31    1    0     3   308    49    0    25
2     0     0  62    8  248    9     3    35   294   35   321
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  319    0     1     0    23    0  1290
5     0     0   6   72    0  298     2     2    37  157    18
6     0     0   0    5    1    0  2566     0   145    0   350
7     1     0   0   64    0    0     0  1082    16    0     1
8     0     0   0   19    0    0     0     4  1345    1     1
9     8     0  53  101   34  136     8    50   343  305    99
10    0     0   0    0   19    0     0     0     1    0  1626
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7535157, 'precision': 0.6772946, 'recall': 0.6319649, 'specificity': 0.9752106, 'f1': 0.63074964, 'auroc': 0.88273174}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   944     5    8  34    3   18    78    18     9   47     6
1     1  1276    0  15    1    0     6   180     9    1    10
2     1     1  270  10  208   15    12    34   220  104   140
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   12   1  423    0    16     2    25    0  1154
5     0     0    4  47    1  240     2     2    12  284     0
6     0     0    1   6    0    0  3039     1    13    0     7
7     0     0    0  85    0    0     0  1076     2    0     1
8     0     0    0  42    1    5     3    13  1301    2     3
9     0     1  145  42   10  113     2    50   154  592    28
10    0     0    0   0   31    0     5     1     0    0  1609
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_04_47_25_seed_1_21971819_instance_wise_predictions.txt
accuracy from prediction file 0.6558455187854194
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 321317 KiB |   1125 MiB |   1520 TiB |   1520 TiB |
|       from large pool | 291484 KiB |   1100 MiB |   1495 TiB |   1495 TiB |
|       from small pool |  29832 KiB |     49 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 321317 KiB |   1125 MiB |   1520 TiB |   1520 TiB |
|       from large pool | 291484 KiB |   1100 MiB |   1495 TiB |   1495 TiB |
|       from small pool |  29832 KiB |     49 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 315422 KiB |   1122 MiB |   1519 TiB |   1519 TiB |
|       from large pool | 286862 KiB |   1098 MiB |   1494 TiB |   1494 TiB |
|       from small pool |  28560 KiB |     47 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1314 MiB |   1320 MiB |   2122 MiB |    808 MiB |
|       from large pool |   1264 MiB |   1270 MiB |   2058 MiB |    794 MiB |
|       from small pool |     50 MiB |     50 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 241883 KiB | 269974 KiB |   1283 TiB |   1283 TiB |
|       from large pool | 236899 KiB | 266355 KiB |   1258 TiB |   1258 TiB |
|       from small pool |   4983 KiB |  27987 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4298    |    6541    |  288556 K  |  288552 K  |
|       from large pool |     130    |     212    |  146417 K  |  146417 K  |
|       from small pool |    4168    |    6336    |  142139 K  |  142134 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4298    |    6541    |  288556 K  |  288552 K  |
|       from large pool |     130    |     212    |  146417 K  |  146417 K  |
|       from small pool |    4168    |    6336    |  142139 K  |  142134 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |      78    |     116    |      38    |
|       from large pool |      53    |      53    |      84    |      31    |
|       from small pool |      25    |      25    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |    1481    |  167910 K  |  167910 K  |
|       from large pool |      26    |      54    |   94776 K  |   94776 K  |
|       from small pool |      17    |    1455    |   73134 K  |   73134 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1125 MiB |   1520 TiB |   1520 TiB |
|       from large pool |  16640 KiB |   1100 MiB |   1495 TiB |   1495 TiB |
|       from small pool |      0 KiB |     49 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1125 MiB |   1520 TiB |   1520 TiB |
|       from large pool |  16640 KiB |   1100 MiB |   1495 TiB |   1495 TiB |
|       from small pool |      0 KiB |     49 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1122 MiB |   1519 TiB |   1519 TiB |
|       from large pool |  16640 KiB |   1098 MiB |   1494 TiB |   1494 TiB |
|       from small pool |      0 KiB |     47 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 563200 KiB |   1320 MiB |   2122 MiB |   1572 MiB |
|       from large pool | 528384 KiB |   1270 MiB |   2058 MiB |   1542 MiB |
|       from small pool |  34816 KiB |     50 MiB |     64 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 301373 KiB |   1283 TiB |   1283 TiB |
|       from large pool |  24320 KiB | 281114 KiB |   1258 TiB |   1258 TiB |
|       from small pool |      0 KiB |  30035 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  288556 K  |  288556 K  |
|       from large pool |       2    |     212    |  146417 K  |  146417 K  |
|       from small pool |       0    |    6336    |  142139 K  |  142139 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  288556 K  |  288556 K  |
|       from large pool |       2    |     212    |  146417 K  |  146417 K  |
|       from small pool |       0    |    6336    |  142139 K  |  142139 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      78    |     116    |      75    |
|       from large pool |      24    |      53    |      84    |      60    |
|       from small pool |      17    |      25    |      32    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1481    |  167912 K  |  167912 K  |
|       from large pool |       4    |      54    |   94776 K  |   94776 K  |
|       from small pool |       0    |    1455    |   73135 K  |   73135 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1125 MiB |   1520 TiB |   1520 TiB |
|       from large pool |  16640 KiB |   1100 MiB |   1495 TiB |   1495 TiB |
|       from small pool |      0 KiB |     49 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1125 MiB |   1520 TiB |   1520 TiB |
|       from large pool |  16640 KiB |   1100 MiB |   1495 TiB |   1495 TiB |
|       from small pool |      0 KiB |     49 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1122 MiB |   1519 TiB |   1519 TiB |
|       from large pool |  16640 KiB |   1098 MiB |   1494 TiB |   1494 TiB |
|       from small pool |      0 KiB |     47 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 563200 KiB |   1320 MiB |   2122 MiB |   1572 MiB |
|       from large pool | 528384 KiB |   1270 MiB |   2058 MiB |   1542 MiB |
|       from small pool |  34816 KiB |     50 MiB |     64 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 301373 KiB |   1283 TiB |   1283 TiB |
|       from large pool |  24320 KiB | 281114 KiB |   1258 TiB |   1258 TiB |
|       from small pool |      0 KiB |  30035 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  288556 K  |  288556 K  |
|       from large pool |       2    |     212    |  146417 K  |  146417 K  |
|       from small pool |       0    |    6336    |  142139 K  |  142139 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  288556 K  |  288556 K  |
|       from large pool |       2    |     212    |  146417 K  |  146417 K  |
|       from small pool |       0    |    6336    |  142139 K  |  142139 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      78    |     116    |      75    |
|       from large pool |      24    |      53    |      84    |      60    |
|       from small pool |      17    |      25    |      32    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1481    |  167912 K  |  167912 K  |
|       from large pool |       4    |      54    |   94776 K  |   94776 K  |
|       from small pool |       0    |    1455    |   73135 K  |   73135 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819

 Experiment start at: 2024-07-15 22:06:06.721955
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92899185, 'precision': 0.8444874, 'recall': 0.80487514, 'specificity': 0.9922855, 'f1': 0.8032509, 'auroc': 0.9957744}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     4    0    0    10    14     0    4     14
1     0  1230    0     9    0    0     0    89     1    0      3
2     3     0  231     0   18    0     1    12     2   43      2
3     1     0    2  7643    0    5     0   693    93    3      0
4    12     1   72     2  267    0     1    14    15   13    142
5     9     0    8    72    0  164     0     0     3  264      1
6    20     0    0     2    0    0  1857    12     4    1     11
7     0     5    5    58    1    0     1  7170    19    0      4
8     9     1   14   139    9    0     1   288  2780    3     51
9     7     0   73     9    0    5     1     7     3  386      2
10   69     0   10     5   56    0    24    47    20    3  12557
---- Validation: 
scalar performance:
{'acc': 0.92900896, 'precision': 0.84777635, 'recall': 0.80811, 'specificity': 0.9922738, 'f1': 0.8064152, 'auroc': 0.9957503}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    2     3    0    0     4    13     1    2     17
1     0  1240    0     8    0    0     0    81     1    0      2
2     3     0  233     0   15    0     1    17     0   40      3
3     0     1    1  7638    0    2     0   703    92    3      0
4    12     0   79     1  257    0     3    18    15   14    140
5     6     0    5    70    0  170     0     0     4  265      1
6    19     0    1     3    1    0  1851    16     4    1     12
7     0     6    5    67    1    0     1  7162    18    1      4
8     7     1   15   115    6    0     2   303  2789    3     55
9     8     0   62     6    0    8     0     7     2  398      2
10   68     0   10     6   55    0    22    55    25    3  12552
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65962356, 'precision': 0.66398746, 'recall': 0.5273581, 'specificity': 0.9660762, 'f1': 0.49219626, 'auroc': 0.8844768}
confusion matrix:
      0    1    2    3    4   5     6     7     8    9     10
0   1086    2    0   26    0   0    12    36     6    0     2
1      2  635    0   30    0   0     0   812     3    0    17
2    143    0  188   14   38   0     5   299    93   27   208
3      0    0    0    0    0   0     0     0     0    0     0
4      5    0    4    0  189   0     3    14     9    0  1409
5     93    0    2  169    1  19     3     0    15  289     1
6      9    0    0    2    0   0  3018    16    10    0    12
7      0    0    0    8    0   0     0  1155     0    0     1
8      3    0    0   82    1   0     7    88  1182    1     6
9    175    0  172  141    0   0     2   245    59  326    17
10     0    0    0    0    8   0     6     2     0    0  1630
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-15 22:39:11.417349,epoch time: 0:33:04.695394,used: 0:33:04.695394,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9503425, 'precision': 0.8832282, 'recall': 0.83954626, 'specificity': 0.9945457, 'f1': 0.85520416, 'auroc': 0.9970665}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   364     1    0     2    1    5    39     3     2    6     60
1     0  1296    0     5    0    0     0    27     2    1      1
2     0     0  204     1   48    4     2     2     4   38      9
3     0     3    1  7844    0   57    17   386   124    4      1
4     2     0    8     0  276    4     3     2    39    6    199
5     0     0    0    13    0  462     0     0     5   39      1
6     4     0    1     1    0    1  1878     2     4    0     17
7     1    20    5    61    1    0     6  7090    58    6     16
8     0     1    1    60    3    5     2    85  3101    3     35
9     0     0   55     1    0  115     0     2     6  311      3
10    5     0    2     5    9    2    12    11    51    1  12694
---- Validation: 
scalar performance:
{'acc': 0.94907045, 'precision': 0.8801112, 'recall': 0.8379811, 'specificity': 0.994397, 'f1': 0.85247064, 'auroc': 0.9971284}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     1    0     3    0    5    35     4     2    5     54
1     0  1296    0     4    0    1     0    26     3    0      2
2     0     0  208     0   41    3     3     5     5   36     11
3     1     1    0  7813    0   54    21   416   123   10      1
4     3     0   12     0  261    2     2     1    34    7    217
5     0     0    0    10    0  464     2     0     6   38      1
6     5     0    1     0    0    1  1878     1     5    0     17
7     2    23    4    64    1    1     5  7091    57    3     14
8     1     2    2    62    5    3     2    85  3099    1     34
9     0     1   62     2    1  117     1     2     4  301      2
10    7     0    2     5    8    0     9    13    53    3  12696
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69383615, 'precision': 0.6448029, 'recall': 0.58027625, 'specificity': 0.9686718, 'f1': 0.5628636, 'auroc': 0.8807558}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   735     0   0   10   0    2   390     3     1   13    16
1     0  1239   0   12   0    0     0   216     5    0    27
2     6     0  45    9  65    4    28    55   188   90   525
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  39    0     3     1    11    0  1579
5     2     0   0   68   1  314    13     0    25  167     2
6     0     0   0    0   0    0  2981     6     6    0    74
7     0     0   0  104   0    0     3  1055     0    0     2
8     0     0   0   66   1    2    12    28  1255    1     5
9     7     7  52   69   2   62    38    62   140  610    88
10    0     0   0    0   0    0     2     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-15 23:11:15.891019,epoch time: 0:32:04.473670,used: 1:05:09.169064,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94929904, 'precision': 0.8938568, 'recall': 0.85019034, 'specificity': 0.99433124, 'f1': 0.8607202, 'auroc': 0.9977079}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     1    0    0     2     4     1    2     26
1     0  1289    0     3    0    0     0    33     4    0      3
2     1     0  236     0   21    1     1     6     3   37      6
3     0     1    2  7747    0   11     1   400   273    1      0
4     7     0   38     0  184    1     0     3    19    4    283
5     1     0    1    18    1  426     0     0     9   64      1
6    43     0    0     1    0    0  1828     3     7    0     26
7     0    20    3    53    1    0     1  7149    26    1     11
8     2     0    5    25    0    1     0   124  3077    1     61
9     1     0   40     4    1   57     1    11     5  372      1
10   17     2    5     8    1    0     2    15    13    2  12726
---- Validation: 
scalar performance:
{'acc': 0.94896346, 'precision': 0.8938377, 'recall': 0.8503543, 'specificity': 0.9942883, 'f1': 0.8626783, 'auroc': 0.9977506}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     5    0    0     1     8     1    2     25
1     0  1293    0     4    0    0     0    28     3    0      4
2     2     0  232     0   22    0     1     9     1   39      6
3     1     0    2  7734    0   13     0   412   277    1      0
4     4     0   30     1  199    1     0     4    12    4    284
5     1     0    0    16    1  427     0     0     9   66      1
6    30     0    0     2    0    1  1832     5     6    1     31
7     0    32    1    50    1    0     1  7136    34    0     10
8     0     0    4    18    2    0     0   124  3084    0     64
9     1     0   43     4    2   61     0     9     4  369      0
10   19     1    7     5    3    0     2    16    12    1  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69047785, 'precision': 0.60609746, 'recall': 0.56563205, 'specificity': 0.96897334, 'f1': 0.5385095, 'auroc': 0.8731441}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1018     7    0   48   0    1     1    55     8   12    20
1      1  1322    0   18   0    0     0   138     7    0    13
2      8     2  143    9   7    0     0   133   176   22   515
3      0     0    0    0   0    0     0     0     0    0     0
4      0     0    1    0   0    0     1     3     6    1  1621
5      1     0    5  175   0  144     0     7    69  185     6
6      0     0    0    1   0    0  2934     3     7    0   122
7      0     0    0   36   0    0     0  1126     0    0     2
8      0     0    0   36   0    0     2    42  1266    0    24
9      9     8  162  153   0   12     0   315   166  271    41
10     0     0    0    0   0    0     0     1     0    0  1645
early stop counter: 1
val acc:0.948963463306427, best validation acc: 0.9490704536437988, corresponding to test acc:                         0.6938361525535583 / 0.6938361525535583
after epoch: 3,now: 2024-07-15 23:43:41.288832,epoch time: 0:32:25.397813,used: 1:37:34.566877,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94956654, 'precision': 0.89336777, 'recall': 0.8692273, 'specificity': 0.994372, 'f1': 0.87650305, 'auroc': 0.9981004}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    0    0     0     4     0    0     12
1     0  1291    0     2    0    0     1    34     3    1      0
2     3     1  233     0   31    0     0     6     1   32      5
3     8     0    0  7893    0   14     0   487    36    1      0
4    10     0    9     0  320    1     0     6     6    6    181
5     1     0    2    29    0  382     0     0     1  105      1
6    58     1    0     1    0    0  1821    11     3    1     12
7     3    14    3    38    1    0     1  7180    16    2      4
8    18     3    6   229   15    1     2   145  2798    4     74
9     5     0   40     2    0   29     0     3     2  410      2
10   33    12    3     7    9    0     2    22     6    2  12696
---- Validation: 
scalar performance:
{'acc': 0.95102316, 'precision': 0.89819825, 'recall': 0.87389547, 'specificity': 0.9945202, 'f1': 0.88111746, 'auroc': 0.9980344}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    0    0     0     1     0    0     11
1     0  1289    0     4    0    0     0    36     2    1      0
2     3     0  240     0   28    2     1     2     1   30      5
3     8     0    0  7909    0    9     0   474    37    3      0
4     7     0   17     0  322    1     0     5     6    4    177
5     0     0    0    28    0  381     0     0     3  108      1
6    55     2    2     0    0    0  1810    15     1    2     21
7     4    15    2    35    1    0     1  7184    17    1      5
8    15     1    5   210   11    2     0   141  2832    3     76
9     1     0   37     4    0   24     0     7     1  417      2
10   37    10    1     5   12    0     2    24     6    0  12699
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72266144, 'precision': 0.66363335, 'recall': 0.60359687, 'specificity': 0.972177, 'f1': 0.58731997, 'auroc': 0.8807082}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1148     0    0   11    0    0     0     8     1    1     1
1      0  1085    0   16    0    0     0   392     1    0     5
2     78     1  182   10  205    1     0   110    47   73   308
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    2    0  137    0     2     6     4    0  1479
5     32     0    0   89    1  172     0     0     2  290     6
6     15     0    0    1    0    0  3005     9     2    0    35
7      1     0    0   10    0    0     0  1152     0    0     1
8      7     0    0  115    2    1     6    55  1162    7    15
9     88     7  150   56    5   21     0   105    33  641    31
10     0     0    0    0    0    0     0     1     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-16 00:16:52.220368,epoch time: 0:33:10.931536,used: 2:10:45.498413,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9617134, 'precision': 0.91946155, 'recall': 0.8746748, 'specificity': 0.99568754, 'f1': 0.89226645, 'auroc': 0.99876547}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   372     0    0     5    2    0    26     3     0    2     73
1     0  1280    0     4    0    0     0    46     2    0      0
2     0     1  264     1    2    2     1    12     3   26      0
3     0     0    0  8303    0    7     0   103    23    0      0
4     1     0   46     1  350    1     1    11    13    0    115
5     0     0    0    20    1  474     0     0     3   22      1
6     1     0    0     1    0    0  1877     2     1    0     26
7     0     7    1   107    0    0     2  7133    10    0      3
8     0     0    2   201    7    0     0   176  2881    0     28
9     1     0   41     8    2  103     0     4     3  330      1
10    0     0    2     8   39    1     6    44    13    0  12681
---- Validation: 
scalar performance:
{'acc': 0.9613214, 'precision': 0.91845, 'recall': 0.8693925, 'specificity': 0.9956307, 'f1': 0.888419, 'auroc': 0.99864894}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   368     0    1     6    0    1    22     3     0    4     78
1     0  1281    0     7    0    0     0    42     2    0      0
2     0     0  252     1    7    4     1    13     7   27      0
3     0     0    0  8284    0   11     0   122    23    0      0
4     1     0   51     0  340    1     1    15    16    1    113
5     0     0    1    23    0  478     0     0     2   16      1
6     1     0    0     1    1    0  1884     0     1    0     20
7     0     9    0    97    1    0     1  7143    11    0      3
8     0     0    2   198    3    0     0   173  2871    0     49
9     1     0   45     9    0   97     0     5     4  329      3
10    0     0    4     8   32    0     2    27    14    0  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6405933, 'precision': 0.65052795, 'recall': 0.53295636, 'specificity': 0.96406245, 'f1': 0.5366729, 'auroc': 0.87829566}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   540     1    2  113    3    6   334   26     3   36   106
1     0  1017    0   32    0    0     0  434     5    0    11
2     0     0  230   43  136   14     4   85   165   41   297
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    4    0  158    0     0    6    11    0  1454
5     0     0    3  162    1  371     5    0     9   36     5
6     0     0    0    1    0    0  2892    5     5    0   164
7     0     0    0  319    0    0     0  842     0    0     3
8     0     0    0  135    0    1     9   27  1193    1     4
9     0     1  131  285    1  201    20   76   108  269    45
10    0     0    0    0    2    0     0    0     0    0  1644
better model found
persisted
after epoch: 5,now: 2024-07-16 00:49:47.712879,epoch time: 0:32:55.492511,used: 2:43:40.990924,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96149933, 'precision': 0.92666906, 'recall': 0.8480307, 'specificity': 0.99561405, 'f1': 0.8750031, 'auroc': 0.99853086}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0    11    0    0    10     8     1    1     20
1     0  1284    0     9    0    0     0    38     1    0      0
2     0     0  229     4    2   10     1    11     5   49      1
3     0     0    0  8344    0    1     0    79    16    0      0
4     4     0   35     4  224    2     0     9    43    6    212
5     0     0    0    80    0  430     0     0     1    9      1
6     3     0    0     4    0    0  1880     4     2    0     14
7     0     5    1   152    0    0     1  7084    13    0      5
8     0     0    0   228    0    0     0    63  2992    0     12
9     0     0   11    25    0  131     1     4     4  317      0
10   10     0    1    14    1    0     5    16    25    0  12723
---- Validation: 
scalar performance:
{'acc': 0.959556, 'precision': 0.9191918, 'recall': 0.8372741, 'specificity': 0.9954082, 'f1': 0.86555314, 'auroc': 0.9985076}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0    13    0    0    13    12     1    1     19
1     0  1278    0    11    0    0     0    42     1    0      0
2     0     0  211     5    6   10     2    18    10   49      1
3     0     0    0  8347    0    1     0    76    16    0      0
4     4     0   40     3  215    3     1     6    43    7    217
5     0     0    0    85    0  424     0     0     2    9      1
6     4     0    0     3    0    1  1879     5     3    0     13
7     0     5    0   155    1    0     1  7085    15    0      3
8     1     1    0   236    0    1     1    69  2971    1     15
9     0     0   13    24    0  134     1     2     4  315      0
10    7     0    2    12    1    0     7    18    25    0  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6250612, 'precision': 0.6225755, 'recall': 0.49677032, 'specificity': 0.9629835, 'f1': 0.46891105, 'auroc': 0.8692279}
confusion matrix:
     0    1   2    3   4    5     6     7     8   9     10
0   778    2   0  208   0    0    82    71    18   2     9
1     0  963   0   24   0    0     0   490     8   0    14
2     0    0  17   93   3   13     6   104   401  18   360
3     0    0   0    0   0    0     0     0     0   0     0
4     1    0   1    0   2    0     2     2    18   0  1607
5     3    0   0  372   0  173     1     0    30  10     3
6     0    0   0    8   0    0  2993    11    11   0    44
7     0    0   0  128   0    0     0  1032     1   0     3
8     0    0   0  120   0    0     0    11  1239   0     0
9     2    1  15  481   0  102     6    99   288  91    52
10    0    0   0    0   0    0     0     0     0   0  1646
early stop counter: 1
val acc:0.959555983543396, best validation acc: 0.9613214135169983, corresponding to test acc:                         0.6405932903289795 / 0.7226614356040955
after epoch: 6,now: 2024-07-16 01:22:04.419935,epoch time: 0:32:16.707056,used: 3:15:57.697980,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9702483, 'precision': 0.9221127, 'recall': 0.90323555, 'specificity': 0.99687994, 'f1': 0.90872806, 'auroc': 0.99903095}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     2    0    0     2     0     0    5      5
1     0  1304    0     1    0    0     0    25     2    0      0
2     0     0  191     0    2    2     1     6    11   98      1
3     0     0    0  8149    0    7     0   156   125    0      0
4     6     1   28     0  381    1     4     1    42   12     62
5     0     0    0    14    0  457     0     0     5   44      1
6     8     0    0     2    0    0  1885     0     8    0      5
7     1     8    0    66    1    0     1  7145    37    1      3
8     3     0    0    29    0    1     0    38  3220    2      2
9     0     0    2     1    0   47     0     3     3  437      0
10   22     0    1     7   36    0     9    15    73    5  12626
---- Validation: 
scalar performance:
{'acc': 0.9707637, 'precision': 0.922983, 'recall': 0.9030192, 'specificity': 0.9969231, 'f1': 0.90906507, 'auroc': 0.9990594}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     3    0    0     4     0     0    4      5
1     0  1304    0     3    0    0     0    24     1    0      0
2     1     1  183     1    6    1     0    13     9   96      1
3     1     1    0  8155    0    4     1   157   121    0      0
4     6     1   26     1  385    3     3     3    31   12     68
5     0     0    0    15    0  463     0     0     4   38      1
6     8     0    0     1    0    0  1889     0     5    1      4
7     0     6    1    63    0    0     1  7153    38    0      3
8     0     0    0    31    1    2     2    28  3230    0      2
9     0     0    4     4    0   41     0     3     2  439      0
10   21     0    1     8   38    1    21    11    66    5  12624
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.698034, 'precision': 0.67799574, 'recall': 0.57717025, 'specificity': 0.9698192, 'f1': 0.54370785, 'auroc': 0.8821357}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1017     2   0   38    0    2    17    55    30    6     3
1      1  1194   0   14    0    0     0   269    12    0     9
2     12     0   5   34   26    6    19   126   543  104   140
3      0     0   0    0    0    0     0     0     0    0     0
4      1     0   1    0  103    0    18     4    86    0  1420
5      4     0   0  164    0  252     0     2    47  122     1
6      0     0   0    8    0    0  3012     8    30    0     9
7      0     0   0   18    0    0     0  1143     1    0     2
8      0     0   0   58    0    0     1    27  1283    1     0
9      4     3   1  204    0   83     2   149   330  343    18
10     0     0   0    0    4    0     9     1     7    0  1625
better model found
persisted
after epoch: 7,now: 2024-07-16 01:54:57.698921,epoch time: 0:32:53.278986,used: 3:48:50.976966,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9756796, 'precision': 0.939278, 'recall': 0.93805504, 'specificity': 0.9974529, 'f1': 0.9383873, 'auroc': 0.9994268}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     0    2    0    27     5     0    1      2
1     0  1312    0     4    0    0     0    13     2    0      0
2     1     0  269     0    9    0     1     2     2   27      1
3     0     0    0  8251    0    4     0    72   111    1      0
4     4     0   21     0  453    1     5     0    12    2     41
5     0     0    1     7    0  468     0     0     5   39      1
6     1     0    0     5    0    0  1899     1     0    0      2
7     1     9    1   117    0    0     1  7082    47    0      5
8     1     0    0    18    3    2     1    29  3236    1      3
9     0     0   25     2    1   21     1     0     3  440      0
10    6     3    2     5   46    1    54    15    49    1  12612
---- Validation: 
scalar performance:
{'acc': 0.9766484, 'precision': 0.9435124, 'recall': 0.94393694, 'specificity': 0.9975473, 'f1': 0.94353855, 'auroc': 0.99949884}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     1    2    0    19     3     1    1     11
1     0  1312    0     4    0    0     0    14     2    0      0
2     0     0  277     1   11    0     0     1     1   21      0
3     0     0    0  8266    0    4     1    56   113    0      0
4     3     0   17     0  460    1     3     2    10    1     42
5     0     0    0     4    0  475     1     0     4   36      1
6     1     0    0     0    0    0  1906     1     0    0      0
7     0    14    0   114    1    0     2  7095    35    1      3
8     1     0    0    27    4    0     2    31  3229    0      2
9     0     0   16     2    0   27     2     0     0  446      0
10    6     4    4     8   54    2    52    12    53    0  12601
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6713776, 'precision': 0.66396016, 'recall': 0.5425339, 'specificity': 0.9671682, 'f1': 0.5621233, 'auroc': 0.8809482}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   697     2    1  168    0    0   279    7     6    9     1
1     0  1205    0   29    0    0     1  247    11    0     6
2     0     0  161   32  233    5    83   25   231   42   203
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    1    0  314    0    18    2    11    0  1287
5     2     0    6  123    0  255    10    0    39  157     0
6     0     0    0    1    0    0  3059    1     4    0     2
7     0     0    0  626    0    0     0  534     2    0     2
8     0     0    0   61    2    0     9    5  1288    1     4
9     2     1  117  194    9   67    29   33   203  459    23
10    0     0    0    0   14    0     7    0     1    0  1624
better model found
persisted
after epoch: 8,now: 2024-07-16 02:27:20.974399,epoch time: 0:32:23.275478,used: 4:21:14.252444,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9721479, 'precision': 0.93145, 'recall': 0.9288572, 'specificity': 0.99703664, 'f1': 0.9281596, 'auroc': 0.99940825}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    0    0     4     2     0    0      2
1     0  1287    0     1    0    0     0    40     3    0      1
2     0     0  268     0   20    2     1     5     3   12      1
3     3     0    0  8060    1    2     3   300    67    1      1
4     8     0    5     0  454    1     0     3    14    0     54
5     0     0    1     8    0  494     0     0     4   13      1
6     5     0    0     0    0    0  1901     0     0    0      2
7     1     6    0    36    2    0     0  7181    30    0      7
8     0     0    1    18    4    0     2    45  3221    1      2
9     0     0   36     1    0   98     1     2     4  351      0
10   39     0    1     6   42    0     7    12    43    0  12643
---- Validation: 
scalar performance:
{'acc': 0.9722616, 'precision': 0.9345436, 'recall': 0.93118054, 'specificity': 0.99703723, 'f1': 0.9306545, 'auroc': 0.9994149}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    0    0     2     1     0    0      1
1     0  1298    0     0    0    0     0    29     2    0      3
2     0     0  276     0   16    0     1     2     1   14      2
3     1     0    0  8048    0    9     1   304    77    0      0
4     6     0    6     0  447    1     2     5    14    2     56
5     0     0    1     7    0  498     0     0     4   10      1
6     4     0    0     0    0    0  1897     3     0    0      4
7     2     4    0    37    1    0     0  7189    28    0      4
8     2     0    0    22    4    0     2    48  3213    1      4
9     3     0   36     1    0   93     3     3     5  348      1
10   36     0    0     6   31    1     4    14    48    1  12655
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7231512, 'precision': 0.65960324, 'recall': 0.6090174, 'specificity': 0.9722059, 'f1': 0.58628654, 'auroc': 0.8868707}
confusion matrix:
      0    1   2   3    4    5     6     7     8    9     10
0   1044    0   0  26    1    0    40    53     4    1     1
1      1  983   0  14    0    0     0   472    10    0    19
2     55    0  67   8  175   11    25   128   312   44   190
3      0    0   0   0    0    0     0     0     0    0     0
4      5    0   1   0  532    0     4     9    27    0  1055
5     22    0  11  84    0  375     5     2    34   58     1
6      1    0   0   1    0    0  3034     4     4    0    23
7      0    0   0  23    0    0     1  1138     0    0     2
8      0    0   0  44    1    1     9    38  1277    0     0
9     66    0  50  92    5  161    29   149   267  298    20
10     1    0   0   0   53    0     3     0     1    0  1588
new oracle model saved
early stop counter: 1
val acc:0.9722616076469421, best validation acc: 0.9766483902931213, corresponding to test acc:                         0.6713775992393494 / 0.7231512069702148
after epoch: 9,now: 2024-07-16 02:59:45.861511,epoch time: 0:32:24.887112,used: 4:53:39.139556,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9738335, 'precision': 0.9451759, 'recall': 0.9104053, 'specificity': 0.9970716, 'f1': 0.9251002, 'auroc': 0.9994327}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    0    0     2     2     0    1      2
1     0  1215    0    12    0    0     0    94     8    0      3
2     0     0  271     4    3    0     2    10     4   18      0
3     0     0    0  8389    0    2     0    22    26    0      0
4     5     0   14     2  385    1     0     8    15    2    107
5     1     0    2    54    0  414     0     0     2   46      1
6     3     0    0     1    0    0  1892     0     5    0      7
7     0     0    0   168    0    0     1  7081    11    0      3
8     0     0    2    57    4    0     0    57  3164    0     10
9     3     0   28    20    0   26     0     5     4  406      1
10   45     0    1     8    6    0     2     5    20    0  12705
---- Validation: 
scalar performance:
{'acc': 0.97458875, 'precision': 0.94986117, 'recall': 0.91547084, 'specificity': 0.99715066, 'f1': 0.93036276, 'auroc': 0.99941075}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     3    1    0     4     1     0    0      2
1     0  1217    0    13    0    0     0    95     5    0      2
2     1     0  275     1    6    0     0     7     2   19      1
3     0     0    0  8378    0    4     0    27    31    0      0
4     8     0   10     1  402    1     0     8    13    0     96
5     0     0    1    59    0  413     0     0     6   41      1
6     4     0    0     1    0    0  1887     0     4    0     12
7     0     0    0   174    0    0     0  7072    16    0      3
8     0     0    1    51    2    0     0    48  3186    0      8
9     3     0   27    19    0   18     0     4     5  416      1
10   39     0    1     8    5    0     1     8    17    0  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5813335, 'precision': 0.6203152, 'recall': 0.46472278, 'specificity': 0.95861685, 'f1': 0.444965, 'auroc': 0.8656939}
confusion matrix:
     0    1   2    3   4    5     6    7     8    9     10
0   888    0   0  183   0    0    43   26    21    0     9
1     2  369   0   47   0    0     0  976    22    0    83
2    11    0  59   87  85    5     0   89   291   13   375
3     0    0   0    0   0    0     0    0     0    0     0
4     2    0   1    0  93    0     1    3    14    0  1519
5     5    0   2  314   0  161     1    1    61   44     3
6     2    0   0    5   1    0  2806    7    33    0   213
7     0    0   0  292   0    0     0  868     1    0     3
8     0    0   0   77   2    0     1   20  1268    0     2
9    11    0  63  392   2   61     3   85   315  154    51
10    0    0   0    0   3    0     0    0     0    0  1643
early stop counter: 2
val acc:0.9745887517929077, best validation acc: 0.9766483902931213, corresponding to test acc:                         0.6713775992393494 / 0.7231512069702148
after epoch: 10,now: 2024-07-16 03:31:53.216920,epoch time: 0:32:07.355409,used: 5:25:46.494965,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9820741, 'precision': 0.9625728, 'recall': 0.934403, 'specificity': 0.9979673, 'f1': 0.94715095, 'auroc': 0.9996538}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    2    0     4     0     0    0     20
1     0  1295    0     7    0    0     1    27     1    0      1
2     1     0  278     0   15    0     1     1     1   14      1
3     1     1    0  8319    0    1     0    77    38    1      1
4     4     0    2     0  434    0     1     0     9    0     89
5     1     0    0    36    0  419     0     0     4   59      1
6     2     0    0     1    0    0  1887     0     3    0     14
7     2     2    0    40    1    0     4  7184    16    0     14
8     0     0    1    21    1    0     0    34  3213    0     26
9     1     0   19     2    1   10     0     1     3  455      1
10    2     0    0     8   10    0     1     2     3    0  12766
---- Validation: 
scalar performance:
{'acc': 0.9817574, 'precision': 0.9640736, 'recall': 0.9372206, 'specificity': 0.9979182, 'f1': 0.9492728, 'auroc': 0.99968624}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    1    0     1     1     0    0     21
1     0  1298    0     3    0    0     0    31     0    0      0
2     0     0  278     0   12    0     0     2     1   16      3
3     0     0    0  8299    0    1     2    88    49    1      0
4     3     0    5     0  434    0     0     1     6    1     89
5     0     0    0    38    0  425     0     0     6   51      1
6     2     0    0     0    0    0  1889     0     3    1     13
7     1     1    1    38    1    0     4  7183    16    0     20
8     0     0    0    20    1    0     0    30  3210    0     35
9     1     0   20     0    2    6     0     0     0  463      1
10    1     0    2     7   10    0     3     1     7    0  12765
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67795426, 'precision': 0.6439756, 'recall': 0.5570489, 'specificity': 0.96773154, 'f1': 0.5554489, 'auroc': 0.876539}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   900    0    0   94    1    0    91    30    24    2    28
1     1  887    0   38    0    0     3   510    11    0    49
2     0    0  128   10  309    1     3    36   188   36   304
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    0    0  261    0     2     3    10    0  1357
5     6    0    7  149    3  196     0     2    41  186     2
6     0    0    0    4    1    0  2943     3     6    0   110
7     0    0    0  124    0    0     1  1033     3    0     3
8     0    0    0   63    2    0     4    22  1277    1     1
9     6    0  142  152   23   49     9    53   215  426    62
10    0    0    0    0    5    0     1     1     0    0  1639
better model found
persisted
after epoch: 11,now: 2024-07-16 04:04:05.438075,epoch time: 0:32:12.221155,used: 5:57:58.716120,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9763752, 'precision': 0.9389436, 'recall': 0.9207859, 'specificity': 0.9975142, 'f1': 0.9243718, 'auroc': 0.9996071}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    5    0     0     0     0    0      2
1     0  1324    0     1    0    0     0     5     1    0      1
2     2     0  284     1   11    0     0     3     4    6      1
3     2     0    0  8216    0    0     0    51   170    0      0
4     2     0    2     0  411    0     0     0    14    0    110
5     4     0    0     6    1  339     0     0    11  159      1
6    33     1    0     0    0    0  1866     0     4    0      3
7     3    32    0    46    0    0     1  7100    71    1      8
8     1     0    0     5    0    0     0     9  3274    0      4
9     2     0   32     2    3    1     1     0     4  446      2
10    6     0    0     6    1    0     1     1    23    0  12757
---- Validation: 
scalar performance:
{'acc': 0.97614014, 'precision': 0.9377392, 'recall': 0.92245615, 'specificity': 0.9974906, 'f1': 0.9242101, 'auroc': 0.9996002}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    3    0     0     0     1    1      5
1     0  1328    0     0    0    0     0     4     0    0      0
2     1     0  287     0   12    0     0     1     2    7      2
3     5     0    0  8213    0    1     0    55   166    0      0
4     1     0    4     0  417    0     0     0    12    0    105
5     5     0    1     5    1  334     0     0    14  160      1
6    39     1    0     1    0    0  1857     0     0    0     10
7     5    35    0    50    0    0     1  7094    73    0      7
8     1     0    0     7    1    0     0    11  3273    0      3
9     2     0   30     1    1    0     0     0     4  455      0
10    8     0    0     6    0    0     2     0    18    0  12762
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6831316, 'precision': 0.61844957, 'recall': 0.555213, 'specificity': 0.96828365, 'f1': 0.53130263, 'auroc': 0.8738284}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1068     0   0   65    0    0     2    9    20    1     5
1      3  1306   0   21    0    0     0  134    11    0    24
2     21     0  45   12  125    0     2   32   371   47   360
3      0     0   0    0    0    0     0    0     0    0     0
4      3     0   0    0   36    0     1    1    23    0  1569
5     21     0   5  125    3  129     2    0    60  235    12
6      4     1   0    2    0    0  2912    1    38    0   109
7      0     0   0  233    0    0     0  920     7    0     4
8      0     0   0   38    0    0     2    4  1324    1     1
9     41     1  48  133   23   26     9   33   390  379    54
10     0     0   0    0    1    0     0    0     0    0  1645
early stop counter: 1
val acc:0.9761401414871216, best validation acc: 0.981757402420044, corresponding to test acc:                         0.6779542565345764 / 0.7231512069702148
after epoch: 12,now: 2024-07-16 04:36:30.438680,epoch time: 0:32:25.000605,used: 6:30:23.716725,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9825824, 'precision': 0.95465064, 'recall': 0.9230583, 'specificity': 0.9981125, 'f1': 0.93575037, 'auroc': 0.999709}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     1    2    1    24     0     0    1     15
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     0  242     0    3    2     4     2     1   57      1
3     0     1    0  8351    0    2     2    34    46    1      0
4     3     0    4     0  417    0     4     0     9    0    102
5     0     0    0     3    0  511     0     0     2    3      1
6     0     0    0     1    0    0  1905     0     1    0      0
7     0    13    0    56    1    0    11  7148    27    0      7
8     0     1    0    15    3    0     3    21  3242    2      9
9     0     0    3     2    1  111     0     0     1  375      0
10    1     0    0     5    5    0     5     2    10    0  12766
---- Validation: 
scalar performance:
{'acc': 0.9819446, 'precision': 0.95247155, 'recall': 0.91991985, 'specificity': 0.99804264, 'f1': 0.9327991, 'auroc': 0.99967986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     1    3    0    28     0     1    1     14
1     0  1329    0     0    0    0     0     3     0    0      0
2     1     0  241     0    4    1     2     1     2   60      0
3     0     2    0  8344    0    4     2    46    40    2      0
4     4     0    5     0  411    0     3     0     6    0    110
5     0     0    1     6    0  510     0     0     3    1      0
6     0     0    0     0    0    0  1905     0     0    0      3
7     0    12    1    66    1    0    10  7142    28    1      4
8     0     1    0     4    1    0     0    20  3259    1     10
9     0     0    0     0    0  121     1     0     1  370      0
10    0     0    1     5    4    0    10     2     9    1  12764
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66144264, 'precision': 0.64459896, 'recall': 0.5444758, 'specificity': 0.9656095, 'f1': 0.527606, 'auroc': 0.87346554}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   476     1   0  146    0    4   487    6    35    4    11
1     0  1277   0   19    0    0    16  166    14    0     7
2     2     0  92   21  115   26    56   50   333   35   285
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0   82    0    10    1    28    0  1512
5     2     0   1  138    0  389    20    1    22   16     3
6     0     0   0    1    0    0  3053    2     4    0     7
7     0     0   0  265    0    0    11  885     1    0     2
8     0     0   0   51    0    0    27   11  1279    0     2
9     0     1  63  161    6  247    76   76   185  280    42
10    0     0   0    0    2    0     2    0     1    0  1641
better model found
persisted
after epoch: 13,now: 2024-07-16 05:08:30.461190,epoch time: 0:32:00.022510,used: 7:02:23.739235,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9835456, 'precision': 0.9539431, 'recall': 0.95412594, 'specificity': 0.99827623, 'f1': 0.95203984, 'auroc': 0.9998018}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     0   10    1    16     0     1    2      7
1     0  1291    0     5    0    0     0    35     0    0      1
2     0     0  296     0    7    1     0     1     0    7      0
3     0     0    0  8302    0    1     0   113    20    1      0
4     0     0    4     0  525    0     0     0     3    1      5
5     0     0    0    16    0  502     0     0     2    1      0
6     0     0    0     0    0    0  1907     0     1    0      0
7     0     0    1    44    1    0     3  7187    21    1      5
8     0     0    1    27    4    0     4    18  3233    0      9
9     0     0   25     0    0   86     1     0     2  379      0
10    0     0    1     5   73    0    10     2     9    0  12694
---- Validation: 
scalar performance:
{'acc': 0.9830146, 'precision': 0.94960505, 'recall': 0.9504119, 'specificity': 0.99822927, 'f1': 0.9479105, 'auroc': 0.9997791}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     0    7    1    21     0     1    2      7
1     0  1295    0     4    0    0     1    29     1    0      2
2     0     0  298     0    6    0     0     2     0    6      0
3     0     0    1  8311    0    1     1   102    21    3      0
4     1     0    6     0  517    1     0     0     4    1      9
5     0     0    0    22    0  494     0     0     3    2      0
6     1     0    0     0    0    1  1905     0     1    0      0
7     1     0    0    33    0    0     5  7206    15    0      5
8     0     0    0    32    2    0     1    23  3231    0      7
9     1     0   28     1    0   88     0     0     3  372      0
10    1     0    1     5   90    0    10     2    10    0  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6756454, 'precision': 0.65052533, 'recall': 0.5625193, 'specificity': 0.96764684, 'f1': 0.5566313, 'auroc': 0.87491393}
confusion matrix:
     0    1    2    3    4    5     6    7     8    9     10
0   869    0    0   72    3    6   154   13    32   12     9
1     4  700    0   64    3    0    10  673    11    0    34
2     3    0  103   40  169   26     9   59   312   63   231
3     0    0    0    0    0    0     0    0     0    0     0
4     0    0    1    0  503    0     4    3    24    1  1097
5     1    0    4  142    0  354     4    0    28   57     2
6     0    0    0    2    2    0  2994    4    32    0    33
7     0    0    0  185    0    0     4  970     4    0     1
8     0    0    0   84    0    1     4    8  1273    0     0
9     5    0   82  187   11  197    17   60   236  305    37
10    0    0    0    0   55    0     4    1     0    0  1586
better model found
persisted
after epoch: 14,now: 2024-07-16 05:40:34.695241,epoch time: 0:32:04.234051,used: 7:34:27.973286,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98598033, 'precision': 0.9546196, 'recall': 0.96457237, 'specificity': 0.99855924, 'f1': 0.9585405, 'auroc': 0.9998332}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     1    5    0     0     0     0    3      1
1     0  1329    0     0    0    0     0     1     0    0      0
2     0     0  271     0    6    0     0     0     1   33      0
3     0     4    0  8364    0    2     0    43    23    2      0
4     1     1    8     0  509    0     0     1     4    2     13
5     0     0    0     4    0  465     0     0     2   50      0
6     6     1    2     0    0    1  1889     1     1    2      5
7     0    49    5    51    0    0     0  7149     5    2      2
8     0     1    2    17    5    1     0    13  3240    3     13
9     0     0    2     1    0    5     0     0     0  485      0
10    2    12    2     4   62    0     2    11    21    1  12678
---- Validation: 
scalar performance:
{'acc': 0.98579645, 'precision': 0.95510507, 'recall': 0.96521205, 'specificity': 0.99854517, 'f1': 0.9588075, 'auroc': 0.9998268}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     1    5    0     0     0     0    1      3
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  275     0    4    0     0     0     0   33      0
3     0     4    0  8359    0    8     0    46    19    4      0
4     1     2    6     0  512    0     0     0     5    4      9
5     0     0    0     7    0  454     0     0     2   57      1
6     6     1    1     1    1    1  1882     2     3    4      6
7     0    47    6    49    0    0     0  7143    15    2      3
8     0     0    2    17    3    1     0    12  3254    2      5
9     0     0    1     0    0    0     0     0     0  492      0
10    4    13    1     6   58    0     1    14    19    1  12679
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70342124, 'precision': 0.67731214, 'recall': 0.5817724, 'specificity': 0.9708929, 'f1': 0.6005374, 'auroc': 0.8786992}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1038     0    0   66    2    1    12    4    30   12     5
1      1  1312    0   68    0    0     0  108     7    0     3
2      7     1   96   53  378    9     0   27   181   98   165
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    1    1  521    0     1    2    18    0  1088
5      4     0    5  123    3  265     0    0    14  178     0
6      7     1    1   59    1    0  2883    3    39    0    73
7      0     3    0  684    0    0     0  472     4    0     1
8      0     0    0   99    1    2     2    6  1256    2     2
9      7     1  104  178   29   65     0   20    91  626    16
10     0     2    0    0   56    0     1    0     2    0  1585
better model found
persisted
after epoch: 15,now: 2024-07-16 06:13:03.938548,epoch time: 0:32:29.243307,used: 8:06:57.216593,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9837864, 'precision': 0.9668789, 'recall': 0.9413642, 'specificity': 0.99818385, 'f1': 0.9511505, 'auroc': 0.99981415}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     1     0     0    0      5
1     0  1312    0     2    0    0     0    12     3    0      1
2     2     0  273     0    5    0     0     0     4   22      6
3     0     0    0  8305    0    3     0    38    88    2      0
4     6     0    1     0  417    1     0     0     4    0    110
5     0     0    0     5    0  420     0     0     5   90      1
6     3     0    0     1    0    0  1897     0     1    0      6
7     0     3    0    67    0    0     0  7153    34    0      8
8     0     0    0     4    0    0     0     2  3257    0     32
9     0     0    8     0    0    0     3     0     1  481      0
10    8     0    0     4    2    0     1     0     1    0  12778
---- Validation: 
scalar performance:
{'acc': 0.9834158, 'precision': 0.9613816, 'recall': 0.939589, 'specificity': 0.9981552, 'f1': 0.94817114, 'auroc': 0.99981403}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    0     1     0     0    0      2
1     0  1318    0     2    0    0     0     8     4    0      0
2     1     0  277     0   10    0     1     0     0   21      2
3     0     0    0  8326    0    3     0    19    91    0      1
4     6     0    3     0  409    1     0     0     8    1    111
5     0     0    0     4    1  426     0     0     5   83      2
6     5     0    0     0    0    0  1894     0     2    1      6
7     2     2    0    75    0    0     0  7143    34    3      6
8     0     0    0     4    1    0     1     2  3249    1     38
9     0     0   14     1    6    2     2     0     2  465      1
10    5     0    0     4    1    0     1     1     5    0  12779
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6310082, 'precision': 0.63901484, 'recall': 0.5153246, 'specificity': 0.9630697, 'f1': 0.50182766, 'auroc': 0.8628783}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   944     0   0   68   1   0    17   19    54    6    61
1     2  1162   0   29   0   0     0  262    23    0    21
2     2     0  35   32  90   1     0   33   178   63   581
3     0     0   0    0   0   0     0    0     0    0     0
4     0     0   0    0  54   0     1    3     6    0  1569
5     2     0   6  134   2  75     4    3    24  327    15
6     1     0   0    6   0   0  2508    6    20    0   526
7     0     0   0  316   0   0     0  841     5    0     2
8     0     0   0   67   1   0     0    9  1276    1    16
9     5     0  34  185  10   4     2   49   198  479   171
10    0     0   0    0   0   0     1    0     0    0  1645
early stop counter: 1
val acc:0.9834157824516296, best validation acc: 0.9857964515686035, corresponding to test acc:                         0.7034212350845337 / 0.7231512069702148
after epoch: 16,now: 2024-07-16 06:45:54.122566,epoch time: 0:32:50.184018,used: 8:39:47.400611,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.989726, 'precision': 0.9801057, 'recall': 0.968478, 'specificity': 0.9988132, 'f1': 0.9736642, 'auroc': 0.99991035}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    1    0     0     0     0    0      4
1     0  1324    1     1    0    0     0     6     0    0      0
2     0     0  296     0    7    0     0     1     0    7      1
3     0     0    0  8343    0    2     0    44    40    3      4
4     4     0    3     0  442    0     0     1     3    0     86
5     1     0    0     0    0  514     0     0     1    5      0
6     8     0    0     0    0    0  1894     0     1    0      5
7     0     4    1    28    0    0     0  7217     6    0      7
8     1     0    0     4    1    0     0    27  3240    0     22
9     0     0   12     0    0    9     0     0     0  472      0
10    6     0    0     0    3    0     0     6     7    0  12772
---- Validation: 
scalar performance:
{'acc': 0.9895145, 'precision': 0.9787016, 'recall': 0.96970594, 'specificity': 0.9988048, 'f1': 0.9735277, 'auroc': 0.9999114}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    2    0     0     0     0    0      4
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     0  302     0    1    1     0     0     0    7      1
3     1     0    0  8335    0    4     0    42    49    3      6
4     3     0    4     0  445    0     0     1     6    0     80
5     0     0    0     1    0  513     0     0     1    6      0
6     7     0    1     1    0    1  1892     0     2    0      4
7     0     8    0    25    0    0     0  7218     7    3      4
8     0     0    0     6    0    1     0    26  3240    1     22
9     1     0   12     1    1    8     0     1     0  469      0
10   10     0    0     0    3    0     2     2     5    0  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6791436, 'precision': 0.65245056, 'recall': 0.58010036, 'specificity': 0.96793073, 'f1': 0.57243943, 'auroc': 0.8730941}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1047     1    0   47    1    0     3   29    30    5     7
1      0  1260    0   31    0    0     0  193     6    0     9
2     22     0  160   36   99    7     0   77   160   69   385
3      0     0    0    0    0    0     0    0     0    0     0
4      4     0    1    0  107    0     1    2    12    0  1506
5     10     0    9   91    2  242     0    0    15  219     4
6     30     0    0    5    2    0  2509    6    51    0   464
7      0     0    0  212    0    0     0  946     3    0     3
8      0     0    2   64    0    1     1   16  1283    2     1
9     20     1  124  154    1   92     1   72   114  509    49
10     0     0    0    0    2    0     0    0     0    0  1644
better model found
persisted
after epoch: 17,now: 2024-07-16 07:20:28.055454,epoch time: 0:34:33.932888,used: 9:14:21.333499,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98448205, 'precision': 0.97662365, 'recall': 0.9760382, 'specificity': 0.99825513, 'f1': 0.9762003, 'auroc': 0.9999132}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     2    6    0     1     1     0    1      1
1     0  1321    0     3    0    0     0     8     0    0      0
2     0     0  299     1    5    0     0     0     0    7      0
3     0     0    0  8430    0    1     0     2     5    0      0
4     1     0    7     0  511    0     1     0     4    1     14
5     0     0    0     4    0  500     0     0     0   16      1
6     2     0    0     3    0    1  1901     0     0    0      1
7     0     0    3   324    1    0     1  6887    36    0     11
8     1     0    0    41    1    0     0     2  3249    0      2
9     0     0    4     0    0    7     0     0     0  482      0
10    8     0    0     3   14    0     7     1    13    0  12745
---- Validation: 
scalar performance:
{'acc': 0.9842985, 'precision': 0.974602, 'recall': 0.9744086, 'specificity': 0.9982433, 'f1': 0.9744074, 'auroc': 0.9998891}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     2    5    0     1     1     1    1      1
1     0  1321    0     4    0    0     0     7     0    0      0
2     0     0  294     1    4    0     0     0     1   11      1
3     0     0    0  8427    0    1     0     2    10    0      0
4     3     0    2     0  512    0     0     0     7    0     15
5     0     0    1     4    0  506     0     0     0   10      0
6     2     0    0     6    0    0  1899     0     1    0      0
7     0     0    5   286    3    0     1  6917    42    0     11
8     1     0    1    57    2    0     2     3  3225    0      5
9     0     0    6     0    0   10     0     0     0  477      0
10    7     0    1     5   21    0     4     1     8    0  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6798433, 'precision': 0.66489923, 'recall': 0.55992174, 'specificity': 0.9684416, 'f1': 0.57338804, 'auroc': 0.8743167}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   898     0   0  168    1    5    27    9    39   15     8
1     0  1115   0   68    0    0     4  273    18    1    20
2     5     0  99   27  238   11     9   22   257   71   276
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  363    0     3    1    25    1  1240
5     2     0   0  126    3  319     0    0     9  130     3
6     0     0   0    1    2    0  2998    1     8    0    57
7     0     0   0  569    0    0     0  585     6    0     4
8     0     0   0   96    0    5     5    3  1260    0     1
9     3     0  69  196   13  117     0   48   186  462    43
10    0     0   0    0   26    0     1    0     1    0  1618
early stop counter: 1
val acc:0.9842985272407532, best validation acc: 0.9895145297050476, corresponding to test acc:                         0.6791436076164246 / 0.7231512069702148
after epoch: 18,now: 2024-07-16 07:53:21.589972,epoch time: 0:32:53.534518,used: 9:47:14.868017,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99002033, 'precision': 0.9762018, 'recall': 0.96332264, 'specificity': 0.9988777, 'f1': 0.9696311, 'auroc': 0.99987155}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     2    6    0     0     0     1    0      6
1     0  1314    0     0    0    0     0    17     0    0      0
2     0     0  281     2   20    0     0     2     2    3      2
3     0     0    0  8418    0    1     0     6    13    0      0
4     0     0    1     0  497    0     0     0     3    0     38
5     0     0    2     7    0  491     0     0     4   16      1
6     7     0    0     2    1    0  1885     0     1    0      9
7     0     1    0    71    1    0     0  7178     4    0      9
8     0     0    0    25    0    0     0    27  3237    0      7
9     1     1   21     2   10    1     0     1     2  453      1
10    2     0    0     2    5    0     1     1     2    0  12781
---- Validation: 
scalar performance:
{'acc': 0.98996925, 'precision': 0.97501004, 'recall': 0.9619367, 'specificity': 0.998876, 'f1': 0.9683386, 'auroc': 0.99987364}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    5    0     0     0     1    0      5
1     0  1320    0     0    0    0     0    12     0    0      0
2     0     0  279     0   19    0     0     5     5    2      2
3     0     0    0  8416    0    2     0    13     9    0      0
4     0     0    3     0  488    0     0     0     4    0     44
5     0     0    0     7    1  495     0     0     2   15      1
6    10     0    0     2    1    1  1887     0     0    1      6
7     0     0    0    66    1    0     1  7189     3    0      5
8     0     0    0    38    2    0     0    20  3229    0      7
9     3     1   21     1    4    6     1     2     5  448      1
10    2     0    0     0    4    0     1     0     2    0  12787
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6562653, 'precision': 0.61026126, 'recall': 0.5384521, 'specificity': 0.9655645, 'f1': 0.5212767, 'auroc': 0.8605123}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1009     1   0   67    2    1    24    9    16    2    39
1      0  1104   0   14    0    0     0  338     4    0    39
2      1     0  34   19  170    3     1   81   233   17   456
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   0    0  113    0     1    1    14    0  1504
5     14     0   2  102    7  219     1    1    53  173    20
6      0     0   0    1    1    1  2812    4    22    0   226
7      0     0   0  263    0    0     0  891     7    0     3
8      0     0   0   38    1    2     1   13  1313    0     2
9     18     0  47  151   43   54     5  127   322  241   129
10     0     0   0    0    1    0     1    0     0    0  1644
better model found
persisted
after epoch: 19,now: 2024-07-16 08:26:34.706905,epoch time: 0:33:13.116933,used: 10:20:27.984950,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9880672, 'precision': 0.96778375, 'recall': 0.9608067, 'specificity': 0.99870706, 'f1': 0.9622309, 'auroc': 0.99989027}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    0    0     1     1     1    1      5
1     0  1318    0     0    0    0     0    14     0    0      0
2     0     0  303     0    1    0     0     0     1    7      0
3     0     0    0  8406    0    2     0    19    10    1      0
4     5     0   19     0  469    0     0     1     4    2     39
5     0     0    0     4    0  421     0     0     1   95      0
6     0     0    1     0    0    0  1902     0     2    0      2
7     0     2    3    93    0    0     3  7156     6    0      2
8     0     0    5    25    0    0     0    28  3229    1      5
9     0     0    2     0    0    1     1     0     0  488      0
10    2     3    2     0    4    0     3     5    11    0  12764
---- Validation: 
scalar performance:
{'acc': 0.9874281, 'precision': 0.96658427, 'recall': 0.95596236, 'specificity': 0.9986378, 'f1': 0.95899916, 'auroc': 0.9998924}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     2    0    0     3     1     1    0      7
1     0  1315    0     0    0    0     1    16     0    0      0
2     0     0  297     0    1    0     0     1     0   12      1
3     0     1    0  8410    0    0     0    22     7    0      0
4     6     0   18     0  473    0     0     0     5    0     37
5     0     0    0     5    0  410     0     0     0  106      0
6     1     0    0     0    0    0  1901     1     2    0      3
7     0     1    4    94    0    0     2  7156     6    0      2
8     0     0    1    32    4    1     0    25  3228    1      4
9     0     0    5     1    0    1     0     0     0  486      0
10    0     3    0     1    3    0     4     4    11    0  12770
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6560554, 'precision': 0.6198969, 'recall': 0.5437517, 'specificity': 0.9655565, 'f1': 0.529593, 'auroc': 0.8709833}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   798     2    0  142    1    1    66    30    63    7    60
1     0  1012    0   10    0    0     0   464     5    0     8
2     0     0  119   14  117    5     0    74   312   19   355
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  120    0     1     5    21    0  1486
5     2     0   15  109    3  242     0     2    41  173     5
6     0     0    0    7    0    0  2790     5   116    0   149
7     0     0    0  104    0    0     0  1055     4    0     1
8     0     0    0   41    0    0     1    20  1306    1     1
9     4     0  181  149    9   71     2   110   266  293    52
10    0     0    0    0    2    0     2     0     0    0  1642
early stop counter: 1
val acc:0.9874281287193298, best validation acc: 0.9899692535400391, corresponding to test acc:                         0.6562653183937073 / 0.7231512069702148
after epoch: 20,now: 2024-07-16 09:01:08.092973,epoch time: 0:34:33.386068,used: 10:55:01.371018,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9888966, 'precision': 0.9632453, 'recall': 0.9677161, 'specificity': 0.99882776, 'f1': 0.9647035, 'auroc': 0.99987954}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    4    0     1     0     0    0      7
1     0  1330    0     1    0    0     0     1     0    0      0
2     0     0  307     0    3    0     0     0     1    1      0
3     0     1    0  8339    0    7     0    82     8    0      0
4     1     0    5     0  517    0     0     0     4    1     11
5     0     0    2     2    0  463     0     0     2   52      0
6     0     0    0     3    0    0  1895     6     1    0      1
7     0    14    2    23    0    0     2  7200    19    0      5
8     1     0    0    32    3    0     3    12  3234    1     10
9     0     0   51     1    1    2     0     0     1  437      0
10    3     0    1     0   14    0     1     1     4    0  12768
---- Validation: 
scalar performance:
{'acc': 0.98836434, 'precision': 0.9632437, 'recall': 0.9690739, 'specificity': 0.99875915, 'f1': 0.9656222, 'auroc': 0.999847}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    4    0     1     0     0    1      3
1     0  1330    0     0    0    0     0     1     1    0      0
2     0     0  308     0    3    0     0     0     1    0      0
3     0     4    0  8332    0   15     1    75    13    0      0
4     3     0    4     0  516    0     0     0     3    0     13
5     0     0    2     1    0  461     0     0     1   56      0
6     0     1    0     2    0    0  1891     6     1    1      6
7     2    13    0    16    0    0     0  7208    20    0      6
8     0     1    0    40    0    0     1    15  3216    0     23
9     0     1   41     0    0    2     0     1     0  447      1
10    1     0    1     0   20    1     0     1     5    0  12767
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6984538, 'precision': 0.63938665, 'recall': 0.59203523, 'specificity': 0.9695976, 'f1': 0.5789467, 'auroc': 0.8746957}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   960     0    0  63    1    2    46    28    13   25    32
1     0  1342    0   2    0    0     1   137     3    0    14
2     2     0  104   6  248    4     3    47   348   33   220
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  338    0     2     1    14    0  1278
5     5     0   14  72    4  271     0     1    32  189     4
6     1     0    0   1    1    1  2601     3    57    0   402
7     0     0    0  33    0    0     0  1125     4    0     2
8     0     0    0  33    0    1     3    21  1308    1     3
9    10     2  147  79   24   76     1   105   338  313    42
10    0     0    0   0   23    0     2     0     0    0  1621
early stop counter: 2
val acc:0.9883643388748169, best validation acc: 0.9899692535400391, corresponding to test acc:                         0.6562653183937073 / 0.7231512069702148
after epoch: 21,now: 2024-07-16 09:35:53.898167,epoch time: 0:34:45.805194,used: 11:29:47.176212,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99026114, 'precision': 0.96821105, 'recall': 0.9768424, 'specificity': 0.9989885, 'f1': 0.97212535, 'auroc': 0.999911}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    6    0     0     0     0    1      2
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  285     0   10    0     1     0     1   14      1
3     0     3    0  8391    0    5     0    31     7    1      0
4     0     0    1     0  526    0     0     2     0    0     10
5     0     0    0     0    0  500     0     0     0   21      0
6    11     0    0     0    0    0  1896     0     0    0      1
7     0    25    1    36    2    0     1  7190     7    0      2
8     1     3    0    23    7    4     2     8  3233    1     13
9     0     0    2     1    0   12     0     0     2  476      0
10    9     0    2     3   48    0     2     7     8    0  12713
---- Validation: 
scalar performance:
{'acc': 0.99026346, 'precision': 0.970715, 'recall': 0.98037446, 'specificity': 0.99898076, 'f1': 0.9751804, 'auroc': 0.99990845}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    6    0     0     0     0    0      1
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  292     0   10    0     1     0     0    9      0
3     0     1    0  8385    0    8     0    37     9    0      0
4     0     0    2     0  524    1     0     0     2    1      9
5     0     0    0     0    0  500     0     0     0   20      1
6     2     0    0     0    1    0  1901     2     1    0      1
7     1    27    3    32    0    0     1  7187    11    1      2
8     2     1    1    44    9    4     2    13  3210    0     10
9     2     0    1     1    1    3     0     0     0  485      0
10    4     1    1     2   52    0     0     5     1    0  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73238647, 'precision': 0.65878075, 'recall': 0.616079, 'specificity': 0.97317183, 'f1': 0.60428864, 'auroc': 0.8739521}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1063     3   0   53    3    0    26    14     2    2     4
1      0  1360   0    8    0    0     0   124     2    0     5
2     17     3  63   26  288   11     6    73    92   45   391
3      0     0   0    0    0    0     0     0     0    0     0
4      1     0   0    0  318    0     3     3     5    0  1303
5     21     0   5   77    9  331     2     2     6  138     1
6      3     0   0    5    2    1  2997     4     4    0    51
7      0     0   0   77    0    0     0  1086     0    0     1
8      0     3   0   96    6    6     6    15  1226    1    11
9     49    10  66  133   57  152     5   106    88  406    65
10     0     0   0    0   25    0     2     1     0    0  1618
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-16 10:10:27.170354,epoch time: 0:34:33.272187,used: 12:04:20.448399,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9905287, 'precision': 0.9806829, 'recall': 0.97742254, 'specificity': 0.9989776, 'f1': 0.9789305, 'auroc': 0.99991924}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     6    3    0     2     0     0    0      7
1     0  1331    0     0    0    0     0     0     0    0      0
2     0     0  299     1    4    0     0     3     0    4      1
3     1     1    0  8327    0   10     0    84    17    0      0
4     2     0    0     0  521    0     0     2     6    0      8
5     0     1    0     8    1  486     0     0     0   25      0
6     0     0    0     2    0    0  1902     1     0    1      2
7     0    13    0    23    1    0     0  7219     3    2      2
8     0     1    0    30    1    1     0    11  3249    0      3
9     0     1    4     3    1    1     1     1     2  479      0
10    1     0    0     0   16    0     1     8    20    0  12744
---- Validation: 
scalar performance:
{'acc': 0.99053097, 'precision': 0.9799033, 'recall': 0.97815067, 'specificity': 0.9989802, 'f1': 0.97893775, 'auroc': 0.99991816}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     4    3    0     0     1     0    0      4
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  295     0    6    0     0     1     2    7      1
3     1     0    0  8329    0    8     0    80    21    1      0
4     2     0    1     0  520    0     0     0     7    0      9
5     0     1    0     8    0  490     0     0     0   22      0
6     2     0    0     3    0    1  1899     0     1    0      2
7     0     9    1    26    1    0     0  7224     2    0      2
8     0     1    1    30    3    0     0    12  3244    1      4
9     0     1    6     2    0    2     0     0     0  482      0
10    0     0    1     1   10    0     2     8    28    0  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6747359, 'precision': 0.6361747, 'recall': 0.5689617, 'specificity': 0.96742225, 'f1': 0.55543053, 'auroc': 0.87211865}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   903    16   0  128    1    0    16    64    19    8    15
1     0  1310   0   11    1    0     0   166     2    0     9
2     7     3  54   29  255    5     1   105   305   41   210
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  285    0     1     7    32    0  1308
5     6     0   5  101    7  214     1     4    15  236     3
6     0     1   0   34    3    0  2473     7   105    0   444
7     0     0   0   83    0    0     0  1079     1    0     1
8     0     2   0   40    0    0     3    36  1288    1     0
9    17    19  51  127   29   64     0   174   203  412    41
10    0     0   0    0   15    0     2     1     2    0  1626
better model found
persisted
after epoch: 23,now: 2024-07-16 10:43:26.071536,epoch time: 0:32:58.901182,used: 12:37:19.349581,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99098355, 'precision': 0.9765911, 'recall': 0.9753598, 'specificity': 0.9990289, 'f1': 0.9756123, 'auroc': 0.9999403}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    0    0     2     0     0    1      0
1     0  1322    0     7    0    0     0     1     2    0      0
2     0     0  286     0    7    1     0     1     0   16      1
3     1     0    0  8423    0    8     0     3     4    0      0
4     5     0    1     0  528    0     0     0     0    1      4
5     0     0    0     0    0  514     0     0     0    6      0
6     0     0    0     0    0    1  1907     0     0    0      0
7     0     7    0   113    0    0     2  7126    10    0      3
8     1     0    0    33    0    3     0     5  3245    0      9
9     0     0    3     3    0   43     0     0     1  442      1
10    2     0    2     2    9    0     9     0     3    0  12766
---- Validation: 
scalar performance:
{'acc': 0.9908252, 'precision': 0.9798312, 'recall': 0.97712004, 'specificity': 0.9989912, 'f1': 0.978226, 'auroc': 0.9999469}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    1    0     3     0     0    0      1
1     0  1316    0    12    0    0     0     1     3    0      0
2     0     0  294     2    5    1     0     0     0   10      0
3     0     0    0  8430    0    2     0     5     3    0      0
4     5     0    2     0  521    2     1     0     1    1      6
5     0     0    0     0    0  517     0     0     0    4      0
6     2     0    0     0    0    0  1906     0     0    0      0
7     0     7    0   121    0    0     0  7121    10    0      6
8     0     0    0    40    1    0     0     5  3239    0     11
9     0     0    3     1    0   38     0     0     2  449      0
10    4     0    1     3    9    0     5     3     0    0  12771
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7085986, 'precision': 0.6722865, 'recall': 0.59640175, 'specificity': 0.9710748, 'f1': 0.593347, 'auroc': 0.8794958}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1009     0    0   58    0    1    51   22    21    3     5
1      1  1109    0   44    1    0     5  278    11    0    50
2     10     0  130   70  240   23    15   55   230   48   194
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    0    0  432    0    11    2    17    0  1170
5     12     0    4  109    3  385     2    1    14   60     2
6      0     0    0    4    1    1  2995    3    16    0    47
7      0     0    0  201    0    0     0  960     1    0     2
8      0     0    0  115    1    4     8   11  1229    0     2
9     19     0   76  262    5  203     6   60   192  277    37
10     0     0    0    0   40    0     3    0     1    0  1602
better model found
persisted
after epoch: 24,now: 2024-07-16 11:19:18.803239,epoch time: 0:35:52.731703,used: 13:13:12.081284,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_22_06_06_seed_2_21971819
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
slurmstepd: error: *** JOB 21971819 ON supergpu02 CANCELLED AT 2024-07-16T11:34:04 DUE TO TIME LIMIT ***
