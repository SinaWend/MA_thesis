Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 14 11:33:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817

 Experiment start at: 2024-07-14 12:01:04.801718
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93704516, 'precision': 0.86583215, 'recall': 0.7777075, 'specificity': 0.9927162, 'f1': 0.809379, 'auroc': 0.9949783}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     1    0    10    0    0     2     5     2    2     83
1     0  1263    0    16    0    0     0    41     2    0     10
2     6     0  113     1   90    1     1    14     4   58     24
3     0     1    0  8187    0    4     0   182    61    1      4
4     4     0    2     2  243    1     2     3    13    6    263
5     5     0    0    85    0  288     0     0     5  136      2
6    33     1    0    16    1    1  1806     6     3    2     39
7     2    15    0   263    2    0     2  6872    49    3     53
8     2     4    1   268   11    0     0    93  2765    2    149
9     6     0   35    16    9   32     0     2     5  375     13
10   10     0    0     6   12    0     3    13    12    3  12733
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.938371, 'precision': 0.85978997, 'recall': 0.7793516, 'specificity': 0.9929142, 'f1': 0.80806607, 'auroc': 0.9950582}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0    11    1    0     4     1     2    2     76
1     0  1270    0    12    0    0     0    37     4    0      9
2     7     0  110     2   98    1     1     7     4   62     20
3     0     1    0  8179    0    2     0   190    64    1      3
4     7     0    4     2  233    2     0     3    17    9    262
5     5     0    1    76    0  299     0     0     7  130      3
6    35     0    0    18    0    1  1800     5     5    2     42
7     2    17    1   240    3    0     2  6907    43    2     48
8     3     1    0   247   14    0     1    92  2799    5    134
9     7     0   33    14    7   39     0     2     7  372     12
10   13     0    0     9   14    0     4    14    14    2  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6119079, 'precision': 0.57923925, 'recall': 0.50493383, 'specificity': 0.961012, 'f1': 0.48227793, 'auroc': 0.86803734}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   976     0   0  126    0   0     8    14     7    1    38
1     0  1064   0   26    0   0     0   300     8    0   101
2    23     0   8   15  134   0     2    65    91   41   636
3     0     0   0    0    0   0     0     0     0    0     0
4     0     0   0    0   14   0     0     1     4    0  1614
5    24     0   0  172    0  70     0     0    27  280    19
6     0     1   0    6    0   0  2342     6    25    0   687
7     0     0   0  102    0   0     0  1057     0    0     5
8     0     0   0  125    4   0     2    23  1177    1    38
9    66     2  32  114   54   9     1   137   150  392   180
10    0     0   0    0    0   0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-14 12:38:37.028057,epoch time: 0:37:32.226339,used: 0:37:32.226339,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9497271, 'precision': 0.8605945, 'recall': 0.83035314, 'specificity': 0.99441576, 'f1': 0.8425786, 'auroc': 0.9964533}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     1    2    0     2     1     0    3     40
1     0  1278    0     9    0    0     1    38     4    1      1
2     4     0  196     0   80    0     1     8     1   17      5
3    20     0    2  8009    2    8     5   198   189    4      2
4     3     0   14     1  303    0     4     2     5    2    205
5     9     0   10    34    5  348     2     0    10  102      1
6    18     0    2     1    0    0  1866     1     2    0     17
7     7    14    3   120    4    0     4  7033    55    1     22
8     4     0    1    46   16    0     1    77  2998    0    151
9     6     0  125     5    7   29     0     6     5  304      6
10   15     1    3     5   16    0     7    11     6    1  12728
---- Validation: 
scalar performance:
{'acc': 0.94944495, 'precision': 0.86013913, 'recall': 0.83119076, 'specificity': 0.99439585, 'f1': 0.8430828, 'auroc': 0.9965081}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     1    0    0     5     1     0    3     42
1     0  1281    0     7    0    0     2    36     4    0      2
2     5     0  197     0   78    0     1     5     4   15      7
3     8     1    1  8002    1   11     3   188   219    4      2
4     4     0    6     0  308    0     1     4     3    3    210
5     8     0    9    23    7  346     0     0     9  118      1
6    15     0    0     0    2    0  1869     1     1    0     20
7    10    12    3   116    3    0     2  7038    62    2     17
8    10     0    6    50   19    0     2    74  2987    0    148
9     7     0  123     6   13   24     2     3     2  308      5
10   16     0    0     6   17    0     9    15     4    1  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6768348, 'precision': 0.59296983, 'recall': 0.55994445, 'specificity': 0.96735525, 'f1': 0.53635836, 'auroc': 0.87570447}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1136     0    0  10    1    0     3    11     1    1     7
1      0  1196    0  14    0    0     0   256     8    0    25
2     58     0  118   1  330    2     4    43    59    5   395
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    0   0  115    0     2     1     0    0  1513
5     54     0   51  27    9  156     4     3    37  247     4
6      5     0    0   0    0    0  2739     2     2    0   319
7      1     0    0  43    0    0     0  1116     2    0     2
8      0     0    0  20   21    1     4    34  1260    1    29
9    101     2  449  11   53   14     4   116   136  192    59
10     0     0    0   0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-14 13:14:44.520399,epoch time: 0:36:07.492342,used: 1:13:39.718681,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9560146, 'precision': 0.9013594, 'recall': 0.8355802, 'specificity': 0.9952004, 'f1': 0.8498757, 'auroc': 0.9978547}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    0     6    0    0     5     2     0    3     49
1     0  1268    0    18    0    0     0    38     4    0      4
2     1     0  185     1   37    0     2     5     7   69      5
3     0     1    0  8248    1    1     0    61   119    4      2
4     2     0   13     0  351    0     1     5    19    8    140
5     0     0    0    57    1  193     1     0     9  259      1
6    12     0    1     8    1    0  1870     0     2    0     14
7     0     5    0   249    2    0     1  6915    73    2     15
8     1     0    1    61   10    0     1    49  3145    3     23
9     2     0   26     8    1    4     0     2     3  445      2
10    4     0    1     7   34    0     6    10    36    3  12694
---- Validation: 
scalar performance:
{'acc': 0.9545005, 'precision': 0.8989344, 'recall': 0.836416, 'specificity': 0.99505216, 'f1': 0.8492026, 'auroc': 0.9977497}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     3    0    0     5     1     1    6     47
1     0  1273    0    17    0    0     0    32     6    1      3
2     0     0  190     0   40    0     1     5     6   62      8
3     0     0    0  8233    1    2     0    65   134    5      0
4     2     0   17     0  340    0     1     2    26   12    139
5     0     0    0    49    1  198     1     0     8  263      1
6     9     0    1     7    2    0  1865     2     5    1     16
7     1     8    0   258    2    0     1  6898    80    2     15
8     0     0    0    67   14    0     1    46  3135    5     28
9     1     0   21    12    2    1     2     3     2  449      0
10    4     0    1     8   46    0    12    10    28    4  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6655006, 'precision': 0.653667, 'recall': 0.5418198, 'specificity': 0.9664535, 'f1': 0.5314194, 'auroc': 0.882052}
confusion matrix:
     0     1    2    3    4   5     6    7     8    9     10
0   879     0    0   89    1   0    66   48    28   14    45
1     1  1079    0   32    0   0     0  323    12    0    52
2     0     0   89    9  254   0     2   52   252   63   294
3     0     0    0    0    0   0     0    0     0    0     0
4     0     0    0    0  283   0     1    0    21    0  1328
5     2     0    4  120    3  62     2    1    36  345    17
6     0     0    0    2    0   0  2675    3    42    0   345
7     0     0    0  200    0   0     0  960     1    0     3
8     0     0    0   52    1   0     2   15  1296    2     2
9     3     0  100   99   10   4     7   90   221  553    50
10    0     0    0    0   10   0     0    0     0    0  1636
better model found
persisted
after epoch: 3,now: 2024-07-14 13:50:45.077690,epoch time: 0:36:00.557291,used: 1:49:40.275972,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9615261, 'precision': 0.8874335, 'recall': 0.8651214, 'specificity': 0.9958925, 'f1': 0.86527807, 'auroc': 0.9982248}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    1    0     0     4     0    6     13
1     0  1292    0     6    0    0     0    30     3    0      1
2     1     0  126     0   38    1     1     3     1  137      3
3     5     1    1  8172    1   32     0   121    99    5      0
4     8     0   13     0  386    0     1     3     5   12    111
5     0     0    1    10    0  365     0     0     2  142      1
6    17     0    0     0    3    0  1862     0     1    6     19
7     1    12    2   103    2    0     1  7093    32    6     11
8     2     0    1    62   24    3     0    86  3060   10     48
9     0     0    9     1    0   17     0     2     2  460      1
10   26     0    1     6   68    1     2    16     9    2  12663
---- Validation: 
scalar performance:
{'acc': 0.9613481, 'precision': 0.8820151, 'recall': 0.86283034, 'specificity': 0.99589103, 'f1': 0.8627427, 'auroc': 0.9981259}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    0    0     2     2     0    8     14
1     0  1291    0     7    0    0     0    29     4    1      0
2     0     0  131     0   40    0     1     4     1  133      2
3     4     1    1  8195    1   27     0   116    87    8      0
4     5     0   19     0  379    0     0     3     3   10    120
5     0     0    0    12    0  357     0     0     2  149      1
6    13     0    0     2    0    0  1871     1     2    6     13
7     2    10    2   118    3    0     1  7082    35    5      7
8     3     0    1    59   31    5     1    84  3070    6     36
9     1     0   10     1    2   21     0     2     1  455      0
10   29     0    3     8   78    0     5    10     7    3  12653
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7257399, 'precision': 0.66416335, 'recall': 0.6112087, 'specificity': 0.972385, 'f1': 0.6071769, 'auroc': 0.88169473}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   973     0    0   26    2    2    25    18     7  103    14
1     0  1220    0   18    0    0     0   244     8    1     8
2     6     0  136    4  436    7     2    45    78   90   211
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  305    0     2     2     4    1  1319
5     0     0    4   35    2  227     0     1    13  309     1
6     0     0    0    1    1    0  2843     2     5    3   212
7     0     0    0  140    0    1     0  1021     0    0     2
8     0     0    0   26    9    3     3    24  1288    5    12
9     2     1  135   23   21   41     0    72    98  719    25
10    0     0    0    0    5    0     0     0     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-14 14:26:33.762994,epoch time: 0:35:48.685304,used: 2:25:28.961276,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9514662, 'precision': 0.88975036, 'recall': 0.8269205, 'specificity': 0.9947635, 'f1': 0.8345012, 'auroc': 0.9981305}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   373     0    0     7    0    4     4     4     8    1     82
1     0  1294    0     4    0    0     0    26     8    0      0
2     0     0  241     3    2   15     1     5    14   30      1
3     0     1    0  8045    0   24     0   102   265    0      0
4     1     0   79     0  238    7     0     5    33    2    174
5     0     0    0     8    0  505     0     0     6    1      1
6     6     3    2     3    2    5  1813     2    19    0     53
7     0    13    1   103    1    0     1  6945   190    0      9
8     0     0    2    24    1    3     0    24  3206    1     34
9     0     0   34     4    0  267     0     1    19  168      0
10    2     0    8     8    3    2     1     7    28    0  12734
---- Validation: 
scalar performance:
{'acc': 0.9514779, 'precision': 0.8905015, 'recall': 0.82595444, 'specificity': 0.99473345, 'f1': 0.8348938, 'auroc': 0.9980733}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     0    0     4    1    5     2     2    12    3     77
1     0  1293    0     2    0    0     0    24     8    0      5
2     0     0  239     0    3   17     0    12    10   29      2
3     0     3    0  8062    0   21     0   110   244    0      0
4     1     0   77     0  228    6     0     4    34    4    185
5     0     0    0     9    0  504     0     0     7    0      1
6     5     4    3     1    2    6  1793     7    19    0     68
7     0    15    0   112    1    0     1  6953   174    0      9
8     0     0    1    28    1    2     0    18  3217    0     29
9     0     0   33     5    0  261     0     2    17  175      0
10    1     0    6     7    4    2     2    11    33    0  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5595746, 'precision': 0.6089371, 'recall': 0.522606, 'specificity': 0.9557275, 'f1': 0.45975083, 'auroc': 0.8758507}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   782     0   2   56   0   63    38    8   116  21    84
1     0  1148   0    5   0    0     0  265    63   0    18
2     0     0  85    9  26   73     0   25   590  11   196
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   3    0  35    0     0    1    48   1  1545
5     0     0   0   39   0  523     0    0    28   2     0
6     0     1   0    1   0    0  1401    0   643   0  1021
7     0     0   0  140   0    0     0  988    35   0     1
8     0     0   0   12   0    1     0    0  1356   0     1
9     0     1  38   63   0  440     0   25   517  36    17
10    0     0   0    0   1    0     0    0     1   0  1644
early stop counter: 1
val acc:0.9514778852462769, best validation acc: 0.9613481163978577, corresponding to test acc:                         0.7257398962974548 / 0.7257398962974548
after epoch: 5,now: 2024-07-14 15:02:33.392958,epoch time: 0:35:59.629964,used: 3:01:28.591240,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96492404, 'precision': 0.92277366, 'recall': 0.8759688, 'specificity': 0.99598765, 'f1': 0.8929916, 'auroc': 0.9988565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     2    0    1     1     3     0    0     42
1     0  1307    0     2    0    0     0    16     4    0      2
2     2     0  259     1   17    2     0     6     2   15      8
3     1     6    0  8140    0    2     0   167   121    0      2
4     4     0   27     1  269    0     0     3    14    2    219
5     1     0    0    30    1  409     0     0     3   74      3
6    20     0    2     1    0    0  1838     3     5    1     38
7     0    21    0    54    1    0     1  7133    38    0     16
8     0     2    3    29    2    0     0    58  3124    0     77
9     1     0   56     3    0   34     0     2     7  387      3
10    3     0    0     7    3    0     1     5     7    0  12765
---- Validation: 
scalar performance:
{'acc': 0.9655477, 'precision': 0.9277873, 'recall': 0.8828248, 'specificity': 0.9960607, 'f1': 0.8984902, 'auroc': 0.9987785}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     2    0    0     0     2     1    1     38
1     0  1311    0     2    0    0     0    16     1    0      2
2     3     0  268     0   12    1     1     3     4   14      6
3     0     4    0  8129    0    1     0   168   136    1      1
4     3     0   24     1  276    0     0     3    10    0    222
5     3     0    1    23    0  421     0     0     4   68      1
6    15     1    2     3    0    0  1845     3     2    0     37
7     0    21    1    56    1    0     1  7122    48    1     14
8     0     1    5    29    0    1     0    55  3129    1     75
9     0     0   58     7    0   35     0     2     4  385      2
10    3     0    1     5    1    0     1     7     6    0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6319177, 'precision': 0.6126318, 'recall': 0.54524994, 'specificity': 0.963023, 'f1': 0.5233965, 'auroc': 0.87447137}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   945     0    0   80   0    0    12    27    51    3    52
1     0  1199    0   13   0    0     0   246    11    0    30
2     2     0   77   25  23   10     1    34   222   21   600
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    0    0   8    0     0     1     8    0  1616
5     4     0    4  181   0  291     0     0    37   62    13
6     1     0    0    6   0    0  2249     1    45    0   765
7     0     0    0   73   0    0     0  1080     8    0     3
8     0     0    0   37   0    0     1    10  1304    0    18
9    11     0  144  186   0  116     0    77   281  233    89
10    0     0    0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 6,now: 2024-07-14 15:38:51.235145,epoch time: 0:36:17.842187,used: 3:37:46.433427,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96246254, 'precision': 0.905187, 'recall': 0.89146805, 'specificity': 0.9959966, 'f1': 0.8941108, 'auroc': 0.9988981}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     0    2    0    23     2     2    3      4
1     0  1317    0     5    0    0     0     9     1    0      0
2     0     0  179     0   10    4     2     1     1  115      0
3     0     1    0  8390    0   19     0    18    10    1      0
4     5     0   31     0  379    1    11     3    14   13     82
5     0     0    0     2    0  500     1     0     0   17      1
6     1     0    0     1    0    0  1904     0     1    0      1
7     0    46    2   275    1    0     3  6899    29    4      4
8     1     5    0   194    3   14     5    28  3025    4     14
9     0     0    4     3    0   79     2     1     2  402      0
10    6    10    3    11   33    1   158    12    27    1  12532
---- Validation: 
scalar performance:
{'acc': 0.9613214, 'precision': 0.9030312, 'recall': 0.8894996, 'specificity': 0.9958743, 'f1': 0.8919208, 'auroc': 0.9988381}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     2    0    0    32     1     2    3     10
1     0  1322    0     5    0    0     0     4     1    0      0
2     1     0  176     0    7    6     2     1     2  117      0
3     1     1    0  8384    0   19     0    22    12    1      0
4     4     1   34     0  389    1     7     1    12   12     78
5     0     0    0     4    0  507     0     0     0    9      1
6     1     0    0     3    0    0  1900     0     0    1      3
7     0    51    1   277    1    0     3  6883    39    5      5
8     0     4    1   212    4   12     0    26  3026    1     10
9     0     0    3     5    0   87     1     0     1  396      0
10   13     6    4    11   28    2   163     8    33    5  12523
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7252501, 'precision': 0.69752336, 'recall': 0.61820614, 'specificity': 0.9724985, 'f1': 0.61043245, 'auroc': 0.8897376}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   832     1    0  157    0    2   144   11     6   12     5
1     0  1386    0   26    0    0     2   79     3    0     3
2     2     2  172   26  167   84    92   38   210  104   118
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1    3    0  283    0    78    1    20    2  1245
5     2     0    0   78    0  477     4    0     1   30     0
6     0     0    0    2    0    0  3063    1     1    0     0
7     0     1    0  217    0    0     1  943     1    0     1
8     0     0    0  144    0    6    25   12  1180    1     2
9     2     2   42  126    3  403    13   51    68  414    13
10    0     1    0    0    5    0    24    0     0    0  1616
early stop counter: 1
val acc:0.9613214135169983, best validation acc: 0.9655476808547974, corresponding to test acc:                         0.6319177150726318 / 0.7257398962974548
after epoch: 7,now: 2024-07-14 16:15:34.148182,epoch time: 0:36:42.913037,used: 4:14:29.346464,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9756796, 'precision': 0.9427812, 'recall': 0.91635406, 'specificity': 0.99733067, 'f1': 0.92761546, 'auroc': 0.9994119}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     2    2    0    12     0     1    2     32
1     0  1311    0     1    0    0     0    17     3    0      0
2     1     0  246     1   20    1     1     0     2   38      2
3     1     1    0  8182    0   13     1   120   115    4      0
4     0     0   10     0  397    0     1     2     9    1    119
5     0     0    0     3    0  439     1     0     3   74      1
6     1     0    0     0    1    1  1890     1     2    0     12
7     0     9    0    42    1    0     1  7166    41    0      5
8     0     1    1    24    8    2     1    36  3201    4     18
9     0     0   17     1    0   19     1     0     1  453      1
10    2     0    1     5   11    0     6     5    10    0  12750
---- Validation: 
scalar performance:
{'acc': 0.97640765, 'precision': 0.947238, 'recall': 0.9215196, 'specificity': 0.99739486, 'f1': 0.9325886, 'auroc': 0.9994169}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     2    0    0     7     1     0    2     32
1     0  1315    0     2    0    0     0    12     3    0      0
2     0     0  250     0   18    2     1     2     0   36      3
3     0     0    0  8192    0   14     1   112   117    4      0
4     0     0    8     0  401    1     1     3     9    1    115
5     1     0    0     5    0  445     0     0     4   65      1
6     2     0    0     1    0    0  1889     0     1    0     15
7     0    11    0    41    2    0     3  7162    43    0      3
8     0     0    1    26    5    0     1    35  3201    2     25
9     0     0   12     0    0   20     0     2     2  457      0
10    4     0    2     7   14    0     2     5    10    0  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71755403, 'precision': 0.6510869, 'recall': 0.6087887, 'specificity': 0.9714125, 'f1': 0.59237593, 'auroc': 0.8799286}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   823     5    0  71    2    2    92    51    43   43    38
1     0  1259    0  16    0    0     1   201    10    0    12
2     1     0  122   2  225   14    15    38   200   71   327
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  152    0     1     1    12    0  1466
5     1     0    2  58    0  316     4     0    31  167    13
6     0     0    0   1    1    0  2882     1    10    0   172
7     0     0    0   9    0    1     0  1148     5    0     1
8     0     0    0  10    1    3     7    12  1331    2     4
9     1     1  103  39    6  128     3    84   145  582    45
10    0     0    0   0    3    0     0     1     1    0  1641
better model found
persisted
after epoch: 8,now: 2024-07-14 16:58:18.946414,epoch time: 0:42:44.798232,used: 4:57:14.144696,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96979344, 'precision': 0.9225277, 'recall': 0.9199034, 'specificity': 0.99671346, 'f1': 0.91909075, 'auroc': 0.99921227}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    0    0     0     0     0    1      4
1     0  1299    0    13    0    0     0    16     1    0      3
2     0     0  208     0    9    1     0     0     2   91      1
3     2     0    0  8384    0    2     1    12    36    0      0
4     6     0   18     0  445    0     0     1     2   10     57
5     1     0    0    16    0  495     0     0     1    7      1
6    13     0    0     2    1    1  1857     0     1    1     31
7     5    11    4   318    2    0     1  6805    99    2     18
8     0     0    1    65   16    3     0     8  3179    7     17
9     1     0    1     4    0   66     1     0     0  420      0
10   25     0    1     7   66    0     2     1    12    0  12677
---- Validation: 
scalar performance:
{'acc': 0.97108465, 'precision': 0.92319864, 'recall': 0.92098475, 'specificity': 0.99686956, 'f1': 0.919344, 'auroc': 0.99920404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     1     0     0    2      3
1     1  1303    0    11    0    0     0    13     4    0      0
2     0     0  201     0    5    1     0     0     1  103      1
3     0     0    0  8396    0    2     0    13    24    5      0
4     5     0   18     1  457    0     0     0     6    7     45
5     0     0    0     9    0  499     0     0     0   12      1
6    18     0    0     1    0    2  1849     0     3    1     34
7     5     9    0   289    3    0     1  6834   100    2     22
8     1     0    1    74   14    4     0     5  3173    7     17
9     2     0    1     2    0   65     0     0     1  422      0
10   27     0    3     7   54    0     1     0    11    0  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6536766, 'precision': 0.6669779, 'recall': 0.5758794, 'specificity': 0.9656027, 'f1': 0.58073515, 'auroc': 0.8841108}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1018     0    0   49    2   33    29    3     7   15    14
1     12  1096    0   72    0    2     2  239    20    4    52
2      2     0  168   18  278   28     0   12   135   69   305
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0  436    0     0    1     9    1  1184
5      2     0    3   56    0  456     0    0     6   62     7
6     16     0    0    5    0    1  2267    0    52    1   725
7      1     0    0  585    0    0     0  558    17    1     2
8      0     0    0   62    5   15     2    0  1272    1    13
9      1     0   89  122    6  282     0   14   113  459    51
10     0     0    0    0   32    0     0    0     1    0  1613
early stop counter: 1
val acc:0.9710846543312073, best validation acc: 0.9764076471328735, corresponding to test acc:                         0.7175540328025818 / 0.7257398962974548
after epoch: 9,now: 2024-07-14 17:37:52.920507,epoch time: 0:39:33.974093,used: 5:36:48.118789,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97808754, 'precision': 0.9426594, 'recall': 0.9231276, 'specificity': 0.99758863, 'f1': 0.927804, 'auroc': 0.99952656}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    2    0     1     2     0    0     23
1     0  1321    0     1    0    0     0     9     1    0      0
2     0     0  301     0    0    0     0     5     2    4      0
3     0     3    0  8251    0    2     0   116    67    1      0
4     2     0   63     0  352    0     1     5     8    0    108
5     0     0    1     9    0  453     0     0     4   53      1
6     8     0    0     0    0    0  1879     6     0    0     13
7     0    14    0    36    1    0     1  7188    22    0      3
8     0     0    2    21    3    0     0    46  3203    0     20
9     0     0   64     4    1   14     1     2     6  400      1
10    2     2    2     3    6    0     6     7     8    0  12755
---- Validation: 
scalar performance:
{'acc': 0.9776648, 'precision': 0.94370323, 'recall': 0.92455924, 'specificity': 0.99752194, 'f1': 0.92903596, 'auroc': 0.99951565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    2     0    0    0     2     2     1    1     22
1     0  1326    0     0    0    0     0     5     1    0      0
2     0     0  297     0    0    1     1     6     1    3      3
3     0     2    0  8223    0    5     0   149    61    0      0
4     1     0   63     0  349    0     0     2     9    2    113
5     0     0    2    10    0  460     1     0     3   44      1
6     9     1    2     2    0    0  1877     3     4    0     10
7     0    10    1    33    0    0     1  7208     7    1      4
8     0     1    1    19    1    1     0    54  3190    0     29
9     1     0   61     2    2    9     1     2     1  414      0
10    2     1    3     6    9    0     6     7     8    1  12753
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7092283, 'precision': 0.65336686, 'recall': 0.5965024, 'specificity': 0.9708357, 'f1': 0.57187307, 'auroc': 0.8821517}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   904     5    0   63    0    2    41   104    25    7    19
1     0  1347    0   11    0    0     0   133     2    0     6
2     2     0  113   18   98   20     5    79   314   32   334
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  176    0     2     2    13    0  1438
5     1     0   12  119    0  340     3     5    27   82     3
6     3     5    0    9    0    0  2934    11    28    0    77
7     0     0    0   20    0    0     0  1140     2    0     2
8     0     0    0   42    0    1     2    35  1284    1     5
9     1     4  107  113    3  164     2   188   261  257    37
10    0     0    0    0    3    0     0     1     0    0  1642
better model found
persisted
after epoch: 10,now: 2024-07-14 18:19:20.204004,epoch time: 0:41:27.283497,used: 6:18:15.402286,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98250216, 'precision': 0.9559624, 'recall': 0.948347, 'specificity': 0.998086, 'f1': 0.95169926, 'auroc': 0.99966717}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    3    0     2     0     0    0     12
1     0  1312    0     2    0    0     0    17     1    0      0
2     1     0  291     0    6    0     0     1     0   13      0
3     1     3    0  8318    0    0     0    99    18    0      0
4     2     0   11     0  496    0     0     1     2    0     27
5     0     0    1    35    0  463     0     0     3   17      1
6     2     1    0     1    0    0  1892     0     1    0     10
7     1     4    0    46    1    0     2  7193    12    0      4
8     0     0    1    50    5    0     1    73  3146    0     17
9     0     0   27     5    2   51     1     2     0  405      0
10    0     0    1     2   42    0     1     4     4    0  12741
---- Validation: 
scalar performance:
{'acc': 0.98183763, 'precision': 0.95443165, 'recall': 0.9451427, 'specificity': 0.9980114, 'f1': 0.94930613, 'auroc': 0.9996513}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    3    0     1     2     0    1      3
1     0  1316    0     0    0    0     0    15     1    0      0
2     0     0  285     0   12    0     0     2     1   10      2
3     0     0    0  8311    0    0     1   111    17    0      0
4     3     0    9     0  479    0     0     1     7    0     40
5     0     0    1    31    0  471     0     0     1   16      1
6     6     0    0     0    1    0  1888     0     0    0     13
7     0     3    0    49    1    0     1  7200     7    0      4
8     1     0    2    62    3    0     1    60  3157    1      9
9     0     0   24     9    3   52     1     4     1  398      1
10    3     0    3     3   41    0     2     5    10    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68795913, 'precision': 0.65959454, 'recall': 0.5754993, 'specificity': 0.9687248, 'f1': 0.5636015, 'auroc': 0.87915665}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   893     1    0   78    1    4    78    51    25    7    32
1     0  1200    0   13    0    0     0   269     4    0    13
2    19     0  108   16  180    8    11    79   302   22   270
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  341    0     0     2    15    0  1274
5     3     0    9  175    2  275     7     4    34   77     6
6     0     0    0    2    0    0  2759     5    26    0   275
7     0     0    0   52    0    0     0  1110     1    0     1
8     0     0    0   52    0    0     4    38  1275    1     0
9     8     0   69  177    9  112     5   207   270  242    38
10    0     0    0    0   14    0     0     1     1    0  1630
better model found
persisted
after epoch: 11,now: 2024-07-14 19:04:24.906336,epoch time: 0:45:04.702332,used: 7:03:20.104618,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9819938, 'precision': 0.944798, 'recall': 0.95246756, 'specificity': 0.99808127, 'f1': 0.94661754, 'auroc': 0.9997176}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    1     0    1    0     0     0     0    0      3
1     0  1306    0     4    0    0     0    19     2    0      1
2     0     0  303     0    1    0     0     0     0    8      0
3     4     0    0  8277    0    6     0    89    61    0      1
4     9     0   47     0  437    0     0     1     3    0     41
5     0     0    0     8    0  485     0     0     2   25      1
6     0     0    1     0    1    0  1901     0     0    1      4
7     3     5    5    62    0    0     1  7148    32    1      5
8     1     0    3    32    7    0     1    19  3218    0     15
9     1     0   38     4    0   25     0     0     1  424      0
10   17     0   12     7   20    0     2     2     6    1  12726
---- Validation: 
scalar performance:
{'acc': 0.98178416, 'precision': 0.9454751, 'recall': 0.9511405, 'specificity': 0.99804693, 'f1': 0.94654715, 'auroc': 0.99967355}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    1     0    0    0     2     2     0    0      2
1     0  1308    0     0    0    0     0    21     2    1      0
2     0     0  299     0    0    0     0     1     1   11      0
3     1     0    0  8298    0    3     0    84    52    2      0
4     4     0   46     0  435    1     0     1     3    2     47
5     0     0    1     3    0  490     0     0     1   25      1
6     3     0    3     0    0    0  1894     1     1    0      6
7     2     2    5    70    0    0     2  7148    30    2      4
8     1     0    3    31    6    1     0    27  3207    0     20
9     1     0   37     2    1   24     0     1     2  425      0
10   13     0    8     6   24    1     4     7     9    0  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71615475, 'precision': 0.6657622, 'recall': 0.60925955, 'specificity': 0.97143894, 'f1': 0.6026381, 'auroc': 0.88392043}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   855     0    3  45    0   24   138    13    19   47    26
1     0  1084    0  22    0    0     1   351    16    3    22
2     1     0  283   8  148   20     8    30   201   81   235
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    6   0  250    0     1     2    16    1  1357
5     1     0   13  58    0  337     1     0    15  167     0
6     0     0    0   1    0    1  2932     0    19    0   114
7     0     0    0  99    0    0     0  1055     9    0     1
8     0     0    0  41    1    1     2     5  1313    4     3
9     1     0  141  69    2  177     3    43   192  492    17
10    0     0    0   0    9    0     0     1     1    0  1635
early stop counter: 1
val acc:0.9817841649055481, best validation acc: 0.9818376302719116, corresponding to test acc:                         0.6879591345787048 / 0.7257398962974548
after epoch: 12,now: 2024-07-14 19:40:09.253612,epoch time: 0:35:44.347276,used: 7:39:04.451894,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9832513, 'precision': 0.9511783, 'recall': 0.95548993, 'specificity': 0.998283, 'f1': 0.95044774, 'auroc': 0.9998216}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    2    0     7     0     0    0      9
1     0  1319    0     0    0    0     0    11     0    0      2
2     1     0  260     0   20    0     0     0     0   30      1
3     0     2    0  8353    0    1     0    33    46    1      0
4     4     0    2     0  525    0     0     0     5    0      3
5     1     0    0     7    0  428     0     0     3   82      0
6     0     0    0     1    1    0  1898     2     1    0      5
7     1     4    2    67    3    0     1  7102    72    5      7
8     0     0    1    19    5    0     1     6  3250    2     11
9     0     0    1     0    1    3     0     0     0  487      0
10    5     0    2     6   98    0     4     0    15    1  12663
---- Validation: 
scalar performance:
{'acc': 0.98354954, 'precision': 0.95037925, 'recall': 0.95543706, 'specificity': 0.99831784, 'f1': 0.9503707, 'auroc': 0.9997923}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    1    0     4     0     0    2      5
1     0  1321    0     1    0    0     0     8     0    0      2
2     0     0  263     0   26    1     0     0     1   21      0
3     0     2    0  8367    1    2     0    30    37    1      0
4     4     0    2     0  519    0     0     0     7    0      7
5     0     0    0     7    1  424     0     0     3   85      1
6     3     0    0     0    1    0  1898     1     0    0      5
7     0    11    3    63    4    0     1  7084    86    7      6
8     0     1    1    16    6    0     0     5  3253    2     12
9     1     0    4     0    0    3     0     0     0  485      0
10    3     0    2     6   82    0     3     2    12    1  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7355349, 'precision': 0.6645271, 'recall': 0.606291, 'specificity': 0.9731435, 'f1': 0.59833884, 'auroc': 0.8833249}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   803     1   0  36    1    5   235    12    22   45    10
1     2  1105   0  11    0    0     1   320    12   11    37
2     3     0  59   5  329    6    26    17   363   87   120
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   1   0  601    1     3     1    20    0  1006
5     1     0   2  54    1  209    12     0    30  282     1
6     0     0   0   1    0    0  3040     0    11    0    15
7     0     0   0  50    0    0     0  1105     8    0     1
8     0     0   0  28    2    0     5     5  1318    7     5
9     1     0  58  50   26   63    16    23   214  673    13
10    0     0   0   0   46    0     0     0     0    0  1600
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-14 20:16:25.144155,epoch time: 0:36:15.890543,used: 8:15:20.342437,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.985793, 'precision': 0.95251304, 'recall': 0.9557332, 'specificity': 0.99849045, 'f1': 0.9539819, 'auroc': 0.99977195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    1     0    4    0     2     0     0    1     17
1     0  1314    0     4    0    0     1    13     0    0      0
2     0     0  268     0    3    1     0     1     0   39      0
3     0     2    0  8327    0    4     1    78    20    4      0
4     3     0   27     0  489    0     0     1     2    6     11
5     0     0    0     5    0  503     0     0     0   13      0
6     0     0    0     1    1    0  1894     1     0    0     11
7     0     4    1    34    0    0     1  7215     5    0      3
8     0     0    4    17   10    0     0    46  3204    1     14
9     0     0    9     0    0   36     0     1     0  447      0
10    2     0    2     5   47    1     0     3     6    1  12726
---- Validation: 
scalar performance:
{'acc': 0.9857697, 'precision': 0.9537108, 'recall': 0.95496345, 'specificity': 0.9984829, 'f1': 0.954173, 'auroc': 0.99977446}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    4    0     2     1     0    2      9
1     0  1316    0     3    0    0     0    13     0    0      0
2     0     0  263     0    2    1     0     0     0   45      1
3     0     0    0  8341    0    2     0    74    22    1      0
4     4     0   29     0  486    1     0     1     0    5     13
5     0     0    0     8    0  499     0     0     0   14      0
6     5     0    0     2    0    0  1890     1     0    0     10
7     0     3    1    32    1    0     0  7220     4    0      4
8     0     1    1    31   10    1     0    55  3178    4     15
9     0     0    6     1    0   33     0     0     0  453      0
10    1     0    0     3   43    0     1     3     2    1  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.739173, 'precision': 0.6840173, 'recall': 0.6409767, 'specificity': 0.9738456, 'f1': 0.6371215, 'auroc': 0.88480747}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   892     0    1  46    2   21    43    28    12   79    46
1     0  1214    0  13    0    0     0   252     4    1    15
2     1     0  205  14  260   27     0    45   127  163   173
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    7   0  543    0     1     1    11    1  1069
5     0     0    2  56    0  389     0     0     5  138     2
6     0     1    1   4    3    0  2715     2    25    0   316
7     0     0    0  55    0    0     0  1107     1    0     1
8     0     0    4  55    5    4     4    27  1265    3     3
9     1     0  114  62    6  186     0    62    67  623    16
10    0     0    0   0   34    0     0     0     0    0  1612
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-14 20:52:18.863816,epoch time: 0:35:53.719661,used: 8:51:14.062098,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98688996, 'precision': 0.9673822, 'recall': 0.96318513, 'specificity': 0.9985876, 'f1': 0.9649248, 'auroc': 0.9998365}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    3    0     1     0     1    0      2
1     0  1310    0     0    0    0     0    20     2    0      0
2     1     0  290     1    5    0     1     6     2    6      0
3     0     4    0  8340    0   10     0    59    25    0      0
4     4     0    9     0  484    0     1     2     8    0     31
5     0     0    0     0    0  508     0     0     1   11      1
6     1     0    0     1    0    0  1898     0     1    0      6
7     0     3    0    44    1    0     1  7186    24    0      3
8     0     0    0    42    0    3     2    11  3234    0      4
9     0     0   21     0    1   34     1     1     3  432      0
10    4     0    1     7   16    1     3    16    16    0  12730
---- Validation: 
scalar performance:
{'acc': 0.9869734, 'precision': 0.9654721, 'recall': 0.96058714, 'specificity': 0.99860096, 'f1': 0.9625981, 'auroc': 0.99981743}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     1    5    0     2     1     1    0      3
1     0  1310    0     1    0    0     0    20     1    0      0
2     0     0  289     1    6    0     0     3     2   11      0
3     0     3    0  8345    0    7     1    58    26    0      0
4     4     0   13     0  479    0     1     6     6    0     30
5     0     0    0     2    0  510     0     0     1    8      0
6     2     0    0     0    2    0  1900     0     2    0      2
7     0     2    0    46    0    0     0  7191    22    0      4
8     0     0    0    31    5    2     1    14  3236    0      7
9     0     0   21     0    2   39     0     3     1  426      1
10    4     0    2     6    9    0     3    11    19    0  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68572026, 'precision': 0.65985715, 'recall': 0.5854528, 'specificity': 0.96855277, 'f1': 0.54074115, 'auroc': 0.8811426}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   877    0   0  125    0    6    86    34    21   13     8
1     0  994   0    5    0    0     0   485     7    0     8
2     1    0  34   18  115   76     9   102   393   46   221
3     0    0   0    0    0    0     0     0     0    0     0
4     2    0   2    0  234    1     1     6    26    0  1361
5     2    0   0   66    0  477     2     2    16   27     0
6     1    0   0    1    0    0  2913     6    26    0   120
7     0    0   0   25    0    0     0  1136     2    0     1
8     0    0   0   42    0    9     4    16  1298    0     1
9     4    0   9   96    4  392     1   121   291  202    17
10    0    0   0    0    9    0     0     1     0    0  1636
better model found
persisted
after epoch: 15,now: 2024-07-14 21:28:27.893930,epoch time: 0:36:09.030114,used: 9:27:23.092212,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9877461, 'precision': 0.96113884, 'recall': 0.9635248, 'specificity': 0.99868906, 'f1': 0.96169865, 'auroc': 0.9998262}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    1     2   10    0     0     0     0    1     10
1     0  1324    0     0    0    0     0     8     0    0      0
2     0     0  302     0    9    0     0     0     0    1      0
3     0     1    1  8402    0    2     0    16    16    1      0
4     0     0    9     0  515    0     0     0     6    0      9
5     0     0    0     4    0  467     0     0     4   45      1
6     2     0    0     1    2    0  1898     0     0    0      4
7     0     5    0    85    1    0     0  7162     8    1      2
8     2     1    1    36    9    0     1    21  3207    0     18
9     0     0   39     2    3    7     0     0     4  438      0
10    1     1    1     4   25    0     2     5     7    0  12744
---- Validation: 
scalar performance:
{'acc': 0.98777586, 'precision': 0.9612826, 'recall': 0.9655478, 'specificity': 0.9986851, 'f1': 0.9627447, 'auroc': 0.99985653}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    1     1   10    0     0     0     0    1     10
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  303     0    7    0     0     1     0    1      0
3     0     2    0  8416    0    2     0    12     7    1      0
4     0     0    5     0  518    0     0     0     3    0     13
5     0     0    0     2    0  472     0     0     2   44      1
6     3     0    0     1    0    0  1901     0     1    0      2
7     0     8    1   100    1    0     1  7145     5    0      4
8     0     1    2    40   10    0     1    23  3199    3     17
9     0     0   44     1    1    6     0     0     2  439      0
10    0     0    0     4   32    0     3     2     7    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7290282, 'precision': 0.6536866, 'recall': 0.6116477, 'specificity': 0.97285247, 'f1': 0.6095476, 'auroc': 0.87894887}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   950     2    2   69   17    7    31    17    22   46     7
1     0  1158    0   22    0    0     1   302     6    2     8
2     1     0  147   17  417    8     3    31   195   52   144
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    5    0  482    0     2     1    15    0  1128
5     1     0   10   65    5  292     1     0    29  187     2
6     4     0    1    3    4    0  2954     0    19    0    82
7     0     0    0  105    0    0     1  1053     4    0     1
8     0     0    1   35   11    2     7     9  1296    4     5
9     3     1  155   78   24  122     1    44   220  471    18
10    0     0    0    0   27    0     0     1     1    0  1617
better model found
persisted
after epoch: 16,now: 2024-07-14 22:04:26.222226,epoch time: 0:35:58.328296,used: 10:03:21.420508,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9861676, 'precision': 0.9486212, 'recall': 0.9563919, 'specificity': 0.9985816, 'f1': 0.95020723, 'auroc': 0.9997939}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    3    0     3     1     0    0      1
1     0  1317    0     2    0    0     0    11     2    0      0
2     0     0  310     0    1    0     0     0     0    0      0
3     1     1    0  8383    0    1     0    35    14    0      0
4     4     0    6     0  516    0     2     0     2    0      9
5     5     0    3     6    0  401     0     0     2  103      1
6     1     0    0     0    0    0  1906     0     1    0      0
7     1     2    1    54    1    0     1  7192    10    1      2
8     1     0    1    30    5    0     2    19  3232    0      5
9     5     0   53     4    0    0     0     0     3  428      0
10    7     0    4     6   37    0    15     7    19    0  12699
---- Validation: 
scalar performance:
{'acc': 0.9862244, 'precision': 0.9504661, 'recall': 0.9535385, 'specificity': 0.9985795, 'f1': 0.9492923, 'auroc': 0.9997873}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    2    0     7     0     0    0      3
1     0  1313    0     1    0    0     0    16     2    0      0
2     0     0  310     0    2    0     0     0     0    0      0
3     1     0    0  8388    0    1     1    34    15    0      0
4     4     0    7     0  513    0     2     0     0    0     13
5     1     0    1    15    0  385     3     0     4  112      0
6     0     0    1     0    0    0  1906     0     0    0      1
7     0     0    2    54    0    0     1  7193    11    1      3
8     0     0    2    29    3    0     2    17  3239    1      3
9     4     0   51     0    0    0     2     0     0  436      0
10    3     0    1     6   38    0    15     7    10    0  12716
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72217166, 'precision': 0.64591527, 'recall': 0.59886503, 'specificity': 0.9721265, 'f1': 0.58803165, 'auroc': 0.8812253}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1054     0    1   38    0    0    38    31     3    2     3
1      1  1034    0   25    0    0     0   420     6    0    13
2     32     0  153   20  323    6    14    58   227   37   145
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    3    0  388    0     6     2    12    0  1220
5     40     0   12   81    1  234     6     0    35  182     1
6      0     0    0    1    0    0  3047     2     9    0     8
7      0     0    0   37    0    0     0  1124     2    0     1
8      0     0    0   34    6    0     7    15  1303    2     3
9     46     0  166  128   17   71    10    79   238  357    25
10     0     0    0    0   17    0     0     1     0    0  1628
early stop counter: 1
val acc:0.9862244129180908, best validation acc: 0.9877758622169495, corresponding to test acc:                         0.7290282249450684 / 0.7391729950904846
after epoch: 17,now: 2024-07-14 22:39:59.763894,epoch time: 0:35:33.541668,used: 10:38:54.962176,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98820096, 'precision': 0.97648966, 'recall': 0.9603784, 'specificity': 0.99871755, 'f1': 0.9677615, 'auroc': 0.99987197}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    3    0     1     0     0    0      2
1     0  1299    0     2    0    0     0    26     4    0      1
2     0     0  270     0    2    0     0    10     4   26      0
3     0     0    0  8339    0    0     0    70    24    0      2
4     6     0    6     0  463    0     0     2    34    1     27
5     0     0    0     2    0  512     0     0     0    6      1
6     4     0    0     0    0    0  1888     2     6    0      7
7     0     0    1    42    0    0     0  7206    14    0      2
8     0     0    0    18    0    0     0    12  3259    0      5
9     0     0    0     0    1   25     0     4     0  463      0
10    6     0    0     0    7    0     0     5    17    0  12760
---- Validation: 
scalar performance:
{'acc': 0.98903304, 'precision': 0.97670674, 'recall': 0.96601653, 'specificity': 0.9987956, 'f1': 0.9710191, 'auroc': 0.9998789}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    2    0     1     0     0    0      1
1     0  1302    0     0    0    0     0    27     3    0      0
2     0     0  284     0    0    0     0     6     3   18      1
3     1     0    0  8355    0    0     0    71    11    0      2
4     3     0   14     0  470    0     0     1    17    2     32
5     0     0    0     4    0  505     0     0     3    7      2
6     9     0    0     1    0    0  1886     4     2    0      6
7     0     1    0    38    0    0     0  7211    11    0      4
8     0     0    0    23    0    0     0    11  3257    0      5
9     0     0    2     0    0   18     0     3     2  468      0
10    6     1    0     2    9    0     1     0    19    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6958651, 'precision': 0.66496134, 'recall': 0.59344, 'specificity': 0.96938956, 'f1': 0.5728866, 'auroc': 0.87601805}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   933    0   1  39    1    4    19    55    63   34    21
1     0  914   0  21    0    0     0   538     8    0    18
2     4    0  75   8  139   11     0    67   349   72   290
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   0   0  300    0     0     3    29    0  1301
5     0    0   3  42    1  308     0     4    33  194     7
6     3    1   0   2    1    0  2741     6   101    0   212
7     0    0   0  10    0    0     0  1151     2    0     1
8     0    0   0  18    0    1     0    28  1320    2     1
9     4    0  38  41   10   97     0   119   212  580    36
10    0    0   0   0   21    0     0     1     0    0  1624
better model found
persisted
after epoch: 18,now: 2024-07-14 23:15:41.951579,epoch time: 0:35:42.187685,used: 11:14:37.149861,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98924446, 'precision': 0.97638667, 'recall': 0.96193945, 'specificity': 0.9987767, 'f1': 0.96804255, 'auroc': 0.9999029}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    2    0     1     1     0    0      4
1     0  1324    0     0    0    0     0     8     0    0      0
2     0     0  299     1    3    0     0     1     0    5      3
3     0     1    0  8350    0    7     0    61    16    1      0
4     4     0    5     0  439    0     0     0     5    0     86
5     0     0    0     2    0  517     0     0     0    1      0
6     3     0    0     1    0    0  1896     1     0    0      6
7     0     2    0    24    0    0     1  7231     2    0      5
8     2     0    1    14    2    1     0    34  3239    0      2
9     1     0   17     2    1   39     0     0     0  433      0
10    2     0    0     4    2    0     0     6     8    0  12772
---- Validation: 
scalar performance:
{'acc': 0.9890063, 'precision': 0.9796125, 'recall': 0.9658535, 'specificity': 0.99874705, 'f1': 0.9716769, 'auroc': 0.9999162}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    1     0    2    0     0     0     0    0      3
1     0  1324    0     0    0    0     0     8     0    0      0
2     0     0  304     0    3    0     1     1     0    2      1
3     0     1    0  8347    0    8     0    58    26    0      0
4     4     0    7     0  446    0     0     2     3    0     77
5     0     0    0     1    0  519     0     0     1    0      0
6     1     0    0     0    0    1  1898     0     2    0      6
7     0     1    1    23    0    0     2  7229     5    0      4
8     0     0    0    16    0    2     0    51  3214    0     13
9     1     0   11     1    1   35     0     1     2  440      1
10    0     0    0     6    1    0     0     3    10    0  12776
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69908345, 'precision': 0.648908, 'recall': 0.60127574, 'specificity': 0.9697903, 'f1': 0.5790882, 'auroc': 0.87815493}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   870     0    0  79    2   16    30    35    70   29    39
1     0  1145    0   8    0    0     0   331     5    0    10
2     1     0  120  17  179   21     1    45   295   69   267
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  184    0     0     3    28    0  1417
5     0     0    4  76    1  384     0     1    20  106     0
6     0     4    0   5    0    0  2743     6   132    0   177
7     0     0    0  14    0    0     0  1145     3    0     2
8     0     0    0  24    0    2     1    25  1315    2     1
9     0     0   79  96    9  202     0    68   192  448    43
10    0     0    0   0    6    0     0     1     1    0  1638
early stop counter: 1
val acc:0.9890062808990479, best validation acc: 0.989033043384552, corresponding to test acc:                         0.6958650946617126 / 0.7391729950904846
after epoch: 19,now: 2024-07-14 23:51:10.726047,epoch time: 0:35:28.774468,used: 11:50:05.924329,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9910638, 'precision': 0.9761271, 'recall': 0.9768117, 'specificity': 0.99906856, 'f1': 0.97617465, 'auroc': 0.9999089}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    4    0     0     1     0    1      1
1     0  1324    0     0    0    0     0     6     2    0      0
2     0     0  301     0    3    0     0     1     1    6      0
3     1     0    0  8372    0    0     0    19    45    0      0
4     3     0   12     0  509    0     0     0     4    0     11
5     0     0    0    12    0  473     0     0     4   32      0
6     0     0    0     0    0    0  1906     0     0    0      2
7     0     3    0    34    0    0     1  7182    42    0      1
8     0     0    0     5    5    0     1     5  3271    0      9
9     0     0    3     1    0    1     2     0     2  483      0
10    3     0    2     2   23    0     8     1     8    0  12746
---- Validation: 
scalar performance:
{'acc': 0.99085194, 'precision': 0.9743213, 'recall': 0.97376394, 'specificity': 0.9990354, 'f1': 0.97360045, 'auroc': 0.999922}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    2    0     4     2     0    1      1
1     0  1328    0     0    0    0     0     3     1    0      0
2     0     0  303     0    1    0     0     3     0    5      0
3     0     0    0  8377    0    0     1    27    35    0      0
4     3     0   16     0  502    0     1     0     2    0     15
5     0     0    0     8    0  464     3     0     5   41      0
6     0     0    0     0    0    0  1906     0     1    0      1
7     0     2    0    37    2    0     2  7187    33    0      2
8     0     0    0    12    1    0     0     4  3265    1     13
9     0     0    8     0    0    3     0     0     1  480      1
10    2     0    2     3   17    0    10     1     3    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.727419, 'precision': 0.6719174, 'recall': 0.5993285, 'specificity': 0.9725634, 'f1': 0.59919107, 'auroc': 0.8818903}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   823     4    2   80    1    6   136    32    18   50    18
1     0  1161    0   12    0    0     3   298    18    2     5
2     4     0  120   11  227    4    21    30   302   78   218
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  514    0    11     2    17    0  1086
5     1     0    2  106    3  216     5     1    38  218     2
6     0     0    0    1    0    0  3035     0     9    0    22
7     0     0    0  106    0    0     0  1055     3    0     0
8     0     0    0   23    2    0     5    13  1325    2     0
9     0     0  108   91   12   54     4    36   262  547    23
10    0     0    0    0   36    0     7     1     1    0  1601
better model found
persisted
after epoch: 20,now: 2024-07-15 00:27:33.335330,epoch time: 0:36:22.609283,used: 12:26:28.533612,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9898598, 'precision': 0.9700343, 'recall': 0.97650075, 'specificity': 0.9989686, 'f1': 0.9726281, 'auroc': 0.9999263}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    5    0     0     0     0    0      5
1     0  1325    0     3    0    0     0     3     1    0      0
2     0     0  283     0   10    0     0     3     0   16      0
3     1     0    0  8351    0    8     0    24    54    0      0
4     2     0    0     0  533    0     0     0     3    0      1
5     0     0    2     0    0  512     0     0     3    4      0
6     1     0    0     1    0    0  1903     0     0    0      2
7     0     4    0    30    1    0     1  7219     4    0      3
8     0     0    0    11    0    0     1    16  3268    0      0
9     0     0    3     1    3   27     0     2     1  456      0
10    1     0    1     4   69    0     4     2    38    0  12674
---- Validation: 
scalar performance:
{'acc': 0.9907985, 'precision': 0.97376263, 'recall': 0.9790375, 'specificity': 0.9990525, 'f1': 0.97599995, 'auroc': 0.99993944}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    5    0     0     0     0    0      5
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  290     0    9    1     0     3     0    9      0
3     0     0    0  8367    0    0     0    22    51    0      0
4     2     0    1     0  529    0     0     0     3    0      4
5     0     0    0     0    0  517     0     0     2    1      1
6     3     0    0     1    0    1  1899     0     2    0      2
7     0     7    0    37    1    0     0  7212     5    0      3
8     0     0    0     9    1    0     0    12  3271    0      3
9     0     0    7     0    1   27     0     1     2  455      0
10    1     0    2     4   53    0     3     2    34    1  12696
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6904079, 'precision': 0.635975, 'recall': 0.589913, 'specificity': 0.96896815, 'f1': 0.5792271, 'auroc': 0.87553287}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   870     8   0  102    3    9    27    43    47   38    23
1     1  1219   0   29    0    0     0   221    16    3    10
2     2     0  60   18  310    9     1    30   334   42   209
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  506    1     1     2    42    0  1080
5     0     0   7   65    7  324     0     1    33  147     8
6     0     1   0    1    0    0  2509     0    96    0   460
7     0     0   0   83    0    0     0  1079     1    0     1
8     0     0   0   36    1    2     0    19  1309    2     1
9     2     1  87  112   40  179     1    40   258  387    30
10    0     0   0    0   39    0     0     1     1    0  1605
early stop counter: 1
val acc:0.9907984733581543, best validation acc: 0.9908519387245178, corresponding to test acc:                         0.7274190187454224 / 0.7391729950904846
after epoch: 21,now: 2024-07-15 01:03:12.963531,epoch time: 0:35:39.628201,used: 13:02:08.161813,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9900471, 'precision': 0.9663102, 'recall': 0.97846866, 'specificity': 0.99897146, 'f1': 0.97176886, 'auroc': 0.99991196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    1     1    2    0     1     1     0    1      2
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  293     0   16    0     0     1     0    2      0
3     1     0    0  8379    1    1     0    45     3    6      0
4     4     0    3     0  524    0     0     0     3    0      5
5     0     0    1     4    0  493     0     0     0   23      0
6     0     0    1     0    1    0  1901     1     0    0      4
7     0     6    0    12    0    0     1  7242     2    0      0
8     0     1    0    27    1    1     0    40  3221    1      4
9     0     0   12     0    0    2     0     0     0  479      0
10    6     0    4     3   88    0     2    13     9    0  12668
---- Validation: 
scalar performance:
{'acc': 0.990103, 'precision': 0.9665271, 'recall': 0.9778737, 'specificity': 0.9989751, 'f1': 0.9717046, 'auroc': 0.99991447}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     0    0    0     1     1     1    2      5
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  294     0   12    0     0     2     2    2      0
3     0     0    0  8389    0    0     0    38     6    7      0
4     4     0    4     0  525    0     0     1     3    0      2
5     0     0    1     4    0  500     0     0     0   16      0
6     2     0    1     0    1    0  1897     1     0    0      6
7     0    16    0    14    0    0     0  7234     0    0      1
8     0     0    0    28    1    0     1    39  3223    1      3
9     0     0   17     0    0    6     0     0     1  469      0
10    1     0    4     3   85    0     0    14     8    0  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7502274, 'precision': 0.6725247, 'recall': 0.62149596, 'specificity': 0.97496736, 'f1': 0.6191242, 'auroc': 0.88003826}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   705     2    3  71    1   41    57    35    25  211    19
1     0  1334    0  18    3    0     0   136     2    0     6
2     2     1  141   6  215    7     1    85   292   72   193
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    3   0  786    0     1     3    22    1   817
5     0     0    6  59    1  230     0     1    19  273     3
6     0     1    0   1    2    0  2981     4    17    0    61
7     0     0    0  25    0    0     0  1136     1    1     1
8     0     0    0  41    2    2     5    33  1281    4     2
9     1     1  103  53   11   70     2   136   157  584    19
10    0     0    0   0   99    0     0     1     1    0  1545
new oracle model saved
early stop counter: 2
val acc:0.990103006362915, best validation acc: 0.9908519387245178, corresponding to test acc:                         0.7274190187454224 / 0.7502273917198181
after epoch: 22,now: 2024-07-15 01:38:50.746755,epoch time: 0:35:37.783224,used: 13:37:45.945037,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99256206, 'precision': 0.97585076, 'recall': 0.97100073, 'specificity': 0.9992176, 'f1': 0.9731106, 'auroc': 0.99991196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    4    0     1     0     0    1      1
1     0  1324    0     2    0    0     0     6     0    0      0
2     0     0  275     0    2    0     0     0     0   35      0
3     0     0    0  8406    0    4     0    11    14    1      0
4     3     1   19     0  481    0     1     3     7    5     19
5     1     0    0     1    0  514     0     0     0    5      0
6     2     0    0     0    1    1  1898     0     1    0      4
7     0     2    0    30    0    0     0  7209    22    0      1
8     0     0    0    13    1    0     0    14  3267    0      1
9     0     0    0     1    0   13     0     0     1  478      0
10    1     0    0     0    7    0     1     5     8    0  12771
---- Validation: 
scalar performance:
{'acc': 0.99205565, 'precision': 0.97588795, 'recall': 0.97141373, 'specificity': 0.99915636, 'f1': 0.9733939, 'auroc': 0.9999219}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    4    0     2     0     0    0      3
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     0  274     0    0    0     0     2     0   35      1
3     0     0    0  8405    0    2     1    22    10    0      0
4     3     0   20     0  489    0     1     0     4    3     19
5     0     0    0     2    0  514     0     0     0    5      0
6     0     0    0     1    0    1  1898     0     3    2      3
7     0     2    1    37    0    0     0  7197    26    0      2
8     0     0    1    16    0    0     0     5  3271    0      3
9     0     0    1     0    0   15     0     1     0  476      0
10    2     0    0     2    6    0     1     3    18    0  12764
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6987336, 'precision': 0.67572737, 'recall': 0.57972324, 'specificity': 0.9697744, 'f1': 0.5641017, 'auroc': 0.8777183}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   779     2   1   90    1    3   120    59    47   31    37
1     1  1147   0   21    0    0     2   285    28    0    15
2     0     0  59   25   98   13     6    69   414   83   248
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   2    0  269    0     2     3    43    0  1314
5     2     0   0  103    1  285     1     1    19  178     2
6     0     0   1    1    0    0  2970     5    17    0    73
7     0     0   0   90    0    0     0  1071     2    0     1
8     0     0   0   29    0    1     1    13  1324    2     0
9     1     0  14  128    4  149     2    65   286  446    42
10    0     0   0    0    7    0     0     1     1    0  1637
better model found
persisted
after epoch: 23,now: 2024-07-15 02:14:58.284456,epoch time: 0:36:07.537701,used: 14:13:53.482738,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99269587, 'precision': 0.9812619, 'recall': 0.980901, 'specificity': 0.99919087, 'f1': 0.98087984, 'auroc': 0.99995565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    2    0     1     0     0    0      5
1     0  1310    0     1    0    0     0    16     2    0      3
2     0     0  310     0    0    0     0     0     0    0      2
3     1     0    0  8378    0    1     0    35    19    2      1
4     4     0    4     0  511    0     0     0     0    0     20
5     0     0    0     5    0  487     0     0     1   28      0
6     2     0    0     0    0    0  1905     0     0    0      1
7     1     0    4    26    0    0     3  7203     8    2     16
8     0     0    1     5    8    0     0     6  3266    0     10
9     2     0   10     0    0    1     0     0     0  480      0
10    1     0    0     1    5    0     2     0     5    0  12778
---- Validation: 
scalar performance:
{'acc': 0.9928849, 'precision': 0.9793767, 'recall': 0.9806175, 'specificity': 0.99922705, 'f1': 0.97978365, 'auroc': 0.9999461}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    4    0     1     0     0    0      7
1     0  1311    0     1    0    0     0    18     1    0      1
2     0     0  307     1    1    0     0     0     0    2      1
3     1     0    0  8386    0    1     1    26    22    1      2
4     3     0    9     0  513    0     1     0     0    0     13
5     0     0    0     2    0  493     0     0     0   26      0
6     1     0    0     0    0    0  1905     0     0    0      2
7     1     0    4    28    0    0     1  7200    18    0     13
8     0     0    6     3    6    0     1     5  3268    0      7
9     0     0   10     0    0    4     0     0     0  479      0
10    0     0    1     1    3    0     2     0     3    0  12786
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71384597, 'precision': 0.6504376, 'recall': 0.5889126, 'specificity': 0.9711182, 'f1': 0.5824548, 'auroc': 0.8758426}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   885    0    0  43    8    2    42    31    23   39    97
1     1  938    0  12    0    0    20   414    20    5    89
2     0    0  128   5  374    3     3    22   202   57   221
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    2   0  410    0     2     1    25    0  1193
5     3    0    4  56    4  187     2     3    33  291     9
6     0    0    1   1    2    0  3016     0    16    0    31
7     0    0    0  35    0    0     0  1117     9    1     2
8     0    0    2  11    5    0     5    19  1322    4     2
9     0    0  157  46   36   44     5    43   179  582    45
10    0    0    0   0   24    0     1     1     2    0  1618
better model found
persisted
after epoch: 24,now: 2024-07-15 02:50:37.753323,epoch time: 0:35:39.468867,used: 14:49:32.951605,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9934182, 'precision': 0.97867596, 'recall': 0.9840651, 'specificity': 0.99931055, 'f1': 0.98077154, 'auroc': 0.9999627}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    6    0     0     0     0    0      2
1     0  1325    0     0    0    0     0     5     0    0      1
2     0     0  286     0    9    0     0     0     0   16      1
3     0     0    0  8418    0    0     0    15     5    1      0
4     0     0    1     0  534    0     0     0     1    0      3
5     0     0    0     2    0  509     0     0     0   10      0
6     0     0    0     0    1    0  1902     0     0    0      5
7     0     0    0    26    1    0     0  7221    13    1      2
8     0     0    0    24    3    1     0     5  3251    1     10
9     0     0    1     0    0    3     0     0     0  489      0
10    3     0    0     0   64    1     0     0     2    1  12720
---- Validation: 
scalar performance:
{'acc': 0.99304533, 'precision': 0.9772614, 'recall': 0.98258096, 'specificity': 0.9992759, 'f1': 0.97930515, 'auroc': 0.9999589}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    6    0     0     0     0    0      1
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  283     0   10    0     0     0     0   18      1
3     1     0    0  8418    0    0     0    12     9    0      0
4     0     0    1     0  533    0     0     0     2    0      3
5     0     0    0     1    0  511     0     0     0    9      0
6     1     0    0     0    1    0  1904     0     0    0      2
7     0     0    1    32    0    0     1  7212    15    1      3
8     0     0    0    16    3    0     1     9  3254    1     12
9     1     0    1     1    0    5     0     0     0  485      0
10    3     0    0     0   67    0     0     1     0    0  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7304974, 'precision': 0.6660894, 'recall': 0.6138458, 'specificity': 0.9729895, 'f1': 0.60980976, 'auroc': 0.8816976}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   941    1   0  56   12    7    35    14    21   43    40
1     0  940   1  29    2    0     2   463    14    7    41
2     1    0  95  15  340   16     7    38   240   80   183
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   1   0  756    0     1     1    27    0   847
5     1    0   3  59    8  276     1     1    14  226     3
6     0    0   0   4    3    1  2901     2    56    0   100
7     0    0   0  59    0    0     0  1093     8    2     2
8     0    0   0  43    2    0    14    13  1285    8     5
9     1    0  76  84   29  113     1    61   131  613    28
10    0    0   0   0  104    0     0     1     0    0  1541
better model found
persisted
after epoch: 25,now: 2024-07-15 03:26:28.830595,epoch time: 0:35:51.077272,used: 15:25:24.028877,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99060893, 'precision': 0.9812021, 'recall': 0.97875893, 'specificity': 0.9989412, 'f1': 0.97979444, 'auroc': 0.99995106}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     1    6    0     5     0     0    0     10
1     0  1318    0     1    0    0     0    13     0    0      0
2     0     0  301     0    6    0     0     0     0    4      1
3     2     2    0  8343    0    0     0    84     6    0      1
4     0     0    1     0  521    0     0     0     0    0     17
5     0     0    0     1    1  500     0     0     0   19      0
6     0     0    0     0    0    0  1902     0     0    0      6
7     0     2    0     6    0    0     0  7251     1    0      2
8     0     0    3    22   16    1     0    46  3167    5     36
9     0     0    4     0    0    2     0     0     0  487      0
10    2     0    0     1   13    0     1     1     0    0  12774
---- Validation: 
scalar performance:
{'acc': 0.9911997, 'precision': 0.98109984, 'recall': 0.98009956, 'specificity': 0.9990127, 'f1': 0.9804205, 'auroc': 0.99996233}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    6    0     5     0     0    0     10
1     0  1325    0     0    0    0     0     7     0    0      0
2     0     0  301     0    5    0     0     1     0    4      1
3     2     2    0  8354    1    1     0    71     8    1      0
4     0     0    3     0  522    0     0     0     1    0     13
5     0     0    0     0    1  501     0     0     0   18      1
6     0     1    1     2    0    0  1898     2     0    0      4
7     0     1    0     4    2    0     0  7254     1    0      3
8     0     1    3    20   19    1     1    46  3168    1     36
9     0     0    4     0    0    0     0     0     0  489      0
10    1     0    1     2    8    0     0     1     0    1  12782
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7229413, 'precision': 0.66827035, 'recall': 0.6070746, 'specificity': 0.9719858, 'f1': 0.6036867, 'auroc': 0.8781728}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   762     5   0  52    7   23   149    48    10   32    82
1     1  1120   0  19    0    0     0   327     3    4    25
2     1     0  79  12  494   10     3    63    68   86   199
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   2   0  564    0     1     2     4    0  1060
5     0     0   0  71    9  286     2     4     8  203     9
6     1     0   0   1    6    0  2884     2     5    0   168
7     0     0   0  21    0    0     0  1139     1    2     1
8     0     0   0  27   25    3    10    37  1248    9    11
9     2     0  58  75   52  103     4    89    72  646    36
10    0     0   0   0   40    0     0     1     0    0  1605
early stop counter: 1
val acc:0.9911996722221375, best validation acc: 0.9930453300476074, corresponding to test acc:                         0.730497419834137 / 0.7502273917198181
after epoch: 26,now: 2024-07-15 04:02:13.772266,epoch time: 0:35:44.941671,used: 16:01:08.970548,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9852579, 'precision': 0.97375923, 'recall': 0.94200647, 'specificity': 0.9983337, 'f1': 0.9563289, 'auroc': 0.9998428}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     5    4    0     9     4     0    0      5
1     0  1329    0     1    0    0     0     1     0    0      1
2     0     0  269     2    0    1     0     7     8   25      0
3     0     0    0  8433    0    0     0     5     0    0      0
4     1     0   22     1  410    0     4     3    21    3     74
5     0     0    0    26    0  488     0     0     2    4      0
6     0     0    0     1    0    0  1902     0     3    0      1
7     0     0    0    90    0    0     0  7157    16    0      2
8     0     0    0   109    0    0     0    12  3173    0      1
9     0     0    0     8    0   29     0     0     4  452      0
10    1     0    1     6    0    0     3     3    22    0  12756
---- Validation: 
scalar performance:
{'acc': 0.9861442, 'precision': 0.97588587, 'recall': 0.9433545, 'specificity': 0.9984304, 'f1': 0.9577776, 'auroc': 0.9998757}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     1    3    0    16     0     1    1      3
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     0  269     3    0    2     0     2     7   29      0
3     0     0    0  8428    0    0     0    11     1    0      0
4     4     0   11     3  403    0     5     3    27    5     78
5     0     0    0    24    0  495     0     0     1    0      1
6     0     0    0     0    0    0  1905     1     0    0      2
7     0     1    0    74    0    0     0  7182     6    0      2
8     0     0    0   103    0    0     0     9  3181    0      3
9     0     0    1     3    0   30     0     1     2  455      1
10    1     0    1     5    0    0     1     8    18    0  12762
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64584064, 'precision': 0.67051435, 'recall': 0.51915944, 'specificity': 0.96491253, 'f1': 0.5048399, 'auroc': 0.8598687}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   582     5   0  220    0    5   167    50    59   32    50
1     0  1125   0   34    0    0     2   311     5    0    22
2     1     0  39   84   21   18     8    74   511   49   210
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    1  138    0     3     2    78    0  1410
5     0     0   0  270    0  234     3     1    26   57     1
6     0     0   0    9    0    0  2995     7    46    0    10
7     0     0   0  140    0    0     0  1021     2    0     1
8     0     0   0   99    0    0     1    18  1251    1     0
9     1     0  15  400    0  128     3    95   266  207    22
10    0     0   0    0    6    0     0     1     0    0  1639
early stop counter: 2
val acc:0.9861441850662231, best validation acc: 0.9930453300476074, corresponding to test acc:                         0.730497419834137 / 0.7502273917198181
after epoch: 27,now: 2024-07-15 04:37:56.173953,epoch time: 0:35:42.401687,used: 16:36:51.372235,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928296, 'precision': 0.9858119, 'recall': 0.9789931, 'specificity': 0.99917537, 'f1': 0.98232216, 'auroc': 0.9999627}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     1    0     0    5    0     0     0     0    0     19
1     0  1325    0     1    0    0     0     3     0    0      1
2     0     0  299     0    3    0     0     0     0    4      6
3     0     0    0  8421    0    2     0    13     0    0      0
4     0     0    2     0  519    1     0     0     1    1     15
5     0     0    1     2    0  511     0     0     0    6      1
6     0     0    0     0    0    0  1901     0     0    1      6
7     0     0    1    58    1    0     0  7189    10    0      6
8     0     0    0    53    3    0     2     6  3228    0      3
9     0     0   10     0    0    9     0     0     0  473      1
10    0     0    0     1    8    0     0     0     1    0  12784
---- Validation: 
scalar performance:
{'acc': 0.9918684, 'precision': 0.98489785, 'recall': 0.9799067, 'specificity': 0.99906594, 'f1': 0.9823181, 'auroc': 0.99995756}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    1     0    6    0     1     0     1    1     15
1     0  1329    0     0    0    0     0     1     1    0      1
2     0     0  303     0    5    0     0     0     0    2      2
3     0     0    0  8425    0    4     0    10     0    1      0
4     1     0    2     0  518    0     0     0     2    2     14
5     0     0    1     0    0  515     0     0     0    4      1
6     1     0    1     1    1    0  1897     0     0    0      7
7     0     2    0    79    1    0     1  7165    12    0      5
8     0     0    0    61    1    0     0     3  3214    2     15
9     0     0    8     0    0   10     0     0     0  473      2
10    0     0    0     0    6    0     0     2     4    0  12784
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65479606, 'precision': 0.658764, 'recall': 0.5548394, 'specificity': 0.9653718, 'f1': 0.55028355, 'auroc': 0.8664045}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   673     0   3  133    0   29    43    15     6   97   171
1     0  1156   0   28    1    0     1   249     8    3    53
2     1     0  54   43   64   14     0    34   244   51   510
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  209    0     1     2    17    0  1404
5     0     0   3  109    1  279     1     0    12  176    11
6     0     0   1    3    1    0  2498     0    23    0   541
7     0     0   0   69    0    0     0  1086     6    1     2
8     0     0   0   58    0    0     2     9  1289    5     7
9     2     0  68  198    7   81     2    62   119  482   116
10    0     0   0    0   12    0     0     1     0    0  1633
early stop counter: 3
val acc:0.9918683767318726, best validation acc: 0.9930453300476074, corresponding to test acc:                         0.730497419834137 / 0.7502273917198181
after epoch: 28,now: 2024-07-15 05:14:04.271689,epoch time: 0:36:08.097736,used: 17:12:59.469971,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9914116, 'precision': 0.9814443, 'recall': 0.97937083, 'specificity': 0.9990613, 'f1': 0.98014414, 'auroc': 0.99995667}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    5    0     0     0     0    0      1
1     0  1329    0     1    0    0     0     2     0    0      0
2     1     0  305     0    1    2     0     2     0    1      0
3     0     0    0  8434    0    0     0     5     1    0      0
4     4     0    1     2  514    0     1     1     8    0      8
5     0     0    0     0    0  517     0     0     0    3      1
6     8     0    0     5    0    0  1890     1     2    0      1
7     0     1    0   117    0    0     0  7121    22    0      2
8     0     0    0    32    0    0     0     3  3258    0      1
9     0     0   14     1    2   27     0     0     1  448      0
10    2     0    1     5    4    0     3     4    10    0  12764
---- Validation: 
scalar performance:
{'acc': 0.99149394, 'precision': 0.9812489, 'recall': 0.9796062, 'specificity': 0.9990622, 'f1': 0.9801936, 'auroc': 0.99995285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    3    0     0     1     1    0      3
1     0  1327    0     3    0    0     0     2     0    0      0
2     1     0  307     0    2    0     0     0     1    1      0
3     0     0    0  8436    0    0     0     3     1    0      0
4     4     0    4     0  521    0     0     0     3    0      7
5     0     0    0     2    0  510     0     0     3    5      1
6    10     0    0     6    0    0  1885     2     1    0      4
7     0     2    0   131    0    0     0  7116    16    0      0
8     0     0    0    26    1    0     0     3  3264    0      2
9     0     0   15     5    0   23     0     0     1  449      0
10    3     0    1     2    3    0     0     4     6    0  12777
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69264674, 'precision': 0.66439515, 'recall': 0.58348346, 'specificity': 0.9694955, 'f1': 0.5761094, 'auroc': 0.87393886}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   937     0   0  113    3    6     8   38    41    7    17
1     0  1288   0   26    0    0     1  148    13    0    23
2    11     0  91   55  201   23     1   23   336   44   230
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   1    0  350    0     2    1    26    0  1253
5     2     0   3  140    3  330     2    0    25   83     4
6    15     3   0   11    1    0  2749    1    78    0   209
7     0     0   0  179    0    0     0  970    14    0     1
8     0     0   0   68    0    1     1    8  1288    1     3
9     6     0  52  254    9  216     1   25   263  274    37
10    0     0   0    0   20    0     3    0     0    0  1623
early stop counter: 4
val acc:0.9914939403533936, best validation acc: 0.9930453300476074, corresponding to test acc:                         0.730497419834137 / 0.7502273917198181
after epoch: 29,now: 2024-07-15 05:49:32.183681,epoch time: 0:35:27.911992,used: 17:48:27.381963,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9948898, 'precision': 0.9910383, 'recall': 0.98807776, 'specificity': 0.99944305, 'f1': 0.98949987, 'auroc': 0.9999742}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    0     3     0     0    0      2
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  307     1    0    1     0     0     1    1      1
3     0     0    0  8400    0    1     0    24    10    0      0
4     5     0    2     0  524    0     0     0     4    0      4
5     0     0    0     1    0  519     0     0     1    0      0
6     0     0    0     0    0    0  1902     2     1    0      3
7     0     0    0    22    0    0     0  7236     6    0      0
8     0     0    0    27    1    1     0    14  3250    0      2
9     0     0    0     0    0   14     0     2     4  473      0
10    2     0    0     2    7    0     0     3    10    0  12771
---- Validation: 
scalar performance:
{'acc': 0.99435604, 'precision': 0.99024975, 'recall': 0.9860079, 'specificity': 0.9993836, 'f1': 0.9881027, 'auroc': 0.9999654}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    3    0     7     0     0    1      3
1     0  1320    0     0    0    0     0    12     0    0      0
2     1     0  305     0    2    1     0     1     0    1      1
3     1     0    0  8400    0    0     0    31     8    0      0
4     4     0    1     0  523    0     0     0     2    0      9
5     0     0    0     1    0  517     0     0     1    2      0
6     0     0    0     1    0    0  1903     0     1    0      3
7     0     1    0    17    0    0     0  7237     9    0      1
8     0     0    0    24    3    0     0    10  3256    0      3
9     0     0    1     0    1    8     0     1     4  478      0
10    1     0    0     2    6    0     2     3    16    0  12766
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6956552, 'precision': 0.6547618, 'recall': 0.5782695, 'specificity': 0.9694525, 'f1': 0.5635554, 'auroc': 0.8770199}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   788     0   0   71    2    6   169    24    45   15    50
1     0  1133   0   12    0    0     0   337     6    0    11
2     6     0  49   27  176   23     9    98   343   42   242
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  514    0     2     4    28    0  1084
5     4     0   0  127    3  330     8     3    24   89     4
6     0     1   0    4    0    0  2913    10    45    0    94
7     0     0   0   56    0    0     0  1103     3    0     2
8     0     0   0   83    1    1     1    31  1247    2     4
9     4     0  32  146   17  175    12   181   257  257    56
10    0     0   0    0   35    0     0     1     1    0  1609
better model found
persisted
after epoch: 30,now: 2024-07-15 06:25:15.153842,epoch time: 0:35:42.970161,used: 18:24:10.352124,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:24:10.352124 at 2024-07-15 06:25:15.153842
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6956552, 'precision': 0.6547618, 'recall': 0.5782695, 'specificity': 0.9694525, 'f1': 0.5635554, 'auroc': 0.8770199}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   788     0   0   71    2    6   169    24    45   15    50
1     0  1133   0   12    0    0     0   337     6    0    11
2     6     0  49   27  176   23     9    98   343   42   242
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  514    0     2     4    28    0  1084
5     4     0   0  127    3  330     8     3    24   89     4
6     0     1   0    4    0    0  2913    10    45    0    94
7     0     0   0   56    0    0     0  1103     3    0     2
8     0     0   0   83    1    1     1    31  1247    2     4
9     4     0  32  146   17  175    12   181   257  257    56
10    0     0   0    0   35    0     0     1     1    0  1609
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7502274, 'precision': 0.6725247, 'recall': 0.62149596, 'specificity': 0.97496736, 'f1': 0.6191242, 'auroc': 0.88003826}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   705     2    3  71    1   41    57    35    25  211    19
1     0  1334    0  18    3    0     0   136     2    0     6
2     2     1  141   6  215    7     1    85   292   72   193
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    3   0  786    0     1     3    22    1   817
5     0     0    6  59    1  230     0     1    19  273     3
6     0     1    0   1    2    0  2981     4    17    0    61
7     0     0    0  25    0    0     0  1136     1    1     1
8     0     0    0  41    2    2     5    33  1281    4     2
9     1     1  103  53   11   70     2   136   157  584    19
10    0     0    0   0   99    0     0     1     1    0  1545
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971817_instance_wise_predictions.txt
accuracy from prediction file 0.6956552158399216
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/2.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 322949 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool | 293117 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |  29832 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 322949 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool | 293117 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |  29832 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 315422 KiB |   3546 MiB |   1083 TiB |   1083 TiB |
|       from large pool | 286862 KiB |   3521 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  28560 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3958 MiB |   3958 MiB |   3958 MiB |      0 B   |
|       from large pool |   3908 MiB |   3908 MiB |   3908 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 252538 KiB | 409343 KiB |    796 TiB |    796 TiB |
|       from large pool | 247555 KiB | 401804 KiB |    780 TiB |    780 TiB |
|       from small pool |   4983 KiB |   9979 KiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4298    |    6541    |  190765 K  |  190761 K  |
|       from large pool |     130    |     436    |  102399 K  |  102399 K  |
|       from small pool |    4168    |    6336    |   88366 K  |   88362 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4298    |    6541    |  190765 K  |  190761 K  |
|       from large pool |     130    |     436    |  102399 K  |  102399 K  |
|       from small pool |    4168    |    6336    |   88366 K  |   88362 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     188    |     188    |     188    |       0    |
|       from large pool |     163    |     163    |     163    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |    1617    |  117505 K  |  117505 K  |
|       from large pool |      25    |     163    |   74866 K  |   74866 K  |
|       from small pool |      18    |    1593    |   42638 K  |   42638 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3546 MiB |   1083 TiB |   1083 TiB |
|       from large pool |  16640 KiB |   3521 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 575488 KiB |   3958 MiB |   3958 MiB |   3396 MiB |
|       from large pool | 540672 KiB |   3908 MiB |   3908 MiB |   3380 MiB |
|       from small pool |  34816 KiB |     50 MiB |     50 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 409343 KiB |    796 TiB |    796 TiB |
|       from large pool |  24320 KiB | 401804 KiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |  25939 KiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  190765 K  |  190765 K  |
|       from large pool |       2    |     436    |  102399 K  |  102399 K  |
|       from small pool |       0    |    6336    |   88366 K  |   88366 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  190765 K  |  190765 K  |
|       from large pool |       2    |     436    |  102399 K  |  102399 K  |
|       from small pool |       0    |    6336    |   88366 K  |   88366 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |     188    |     188    |     147    |
|       from large pool |      24    |     163    |     163    |     139    |
|       from small pool |      17    |      25    |      25    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1617    |  117506 K  |  117506 K  |
|       from large pool |       4    |     163    |   74866 K  |   74866 K  |
|       from small pool |       0    |    1593    |   42639 K  |   42639 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3551 MiB |   1084 TiB |   1084 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   1068 TiB |   1068 TiB |
|       from small pool |      0 KiB |     49 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3546 MiB |   1083 TiB |   1083 TiB |
|       from large pool |  16640 KiB |   3521 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 575488 KiB |   3958 MiB |   3958 MiB |   3396 MiB |
|       from large pool | 540672 KiB |   3908 MiB |   3908 MiB |   3380 MiB |
|       from small pool |  34816 KiB |     50 MiB |     50 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 409343 KiB |    796 TiB |    796 TiB |
|       from large pool |  24320 KiB | 401804 KiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |  25939 KiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  190765 K  |  190765 K  |
|       from large pool |       2    |     436    |  102399 K  |  102399 K  |
|       from small pool |       0    |    6336    |   88366 K  |   88366 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  190765 K  |  190765 K  |
|       from large pool |       2    |     436    |  102399 K  |  102399 K  |
|       from small pool |       0    |    6336    |   88366 K  |   88366 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |     188    |     188    |     147    |
|       from large pool |      24    |     163    |     163    |     139    |
|       from small pool |      17    |      25    |      25    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1617    |  117506 K  |  117506 K  |
|       from large pool |       4    |     163    |   74866 K  |   74866 K  |
|       from small pool |       0    |    1593    |   42639 K  |   42639 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817

 Experiment start at: 2024-07-15 07:04:38.219814
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9327108, 'precision': 0.83319306, 'recall': 0.7574694, 'specificity': 0.9929057, 'f1': 0.73078716, 'auroc': 0.99491936}
confusion matrix:
     0     1    2     3   4   5     6     7     8    9      10
0   428     0    0     3   0   0     5     4     3   11     29
1     0  1287    0     9   0   0     0    30     5    0      1
2     2     1  167     0   1   0     1    13     7  120      0
3     4     4    1  7985   0   1     4   287   144    9      0
4     7     1  196     1  76   0     4     5    58   24    167
5     2     0    0   115   0  48     0     0    10  345      1
6    34     1    0     1   0   0  1846     2     5    5     13
7     4    81    7   134   0   0     4  6923    97    4      8
8     3     2    7   120   2   0     2    72  3063    4     20
9     5     0   11     9   0   0     0     2     6  459      1
10   34     3   39     6  11   0    22    20    73    6  12579
---- Validation: 
scalar performance:
{'acc': 0.93176407, 'precision': 0.83007306, 'recall': 0.75367105, 'specificity': 0.9928287, 'f1': 0.72515726, 'auroc': 0.9951023}
confusion matrix:
     0     1    2     3   4   5     6     7     8    9      10
0   427     0    0     4   0   0     5     7     4    9     27
1     0  1295    0     7   0   0     0    25     5    0      0
2     1     0  160     1   1   0     1    11     9  127      1
3     5     6    1  8002   0   0     5   273   141    7      0
4     9     2  191     0  73   0     3     8    61   27    165
5     1     0    0   113   0  44     0     0     8  354      1
6    36     5    0     1   0   0  1847     0     4    4     11
7     6    97    6   143   0   0     2  6912    90    3      6
8     2     3    1   127   2   0     1    75  3056    8     21
9     3     1   14     9   0   0     0     1     9  456      0
10   43     8   45     6  11   0    18    17    77    9  12562
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74358076, 'precision': 0.7253652, 'recall': 0.60955065, 'specificity': 0.97425723, 'f1': 0.57515764, 'auroc': 0.8911476}
confusion matrix:
      0     1    2    3    4   5     6     7     8    9     10
0   1131    10    0    7    0   0     3    10     2    4     3
1      0  1325    0   16    0   0     1   146     4    0     7
2     65     2  224    4   47   0     4    78   238  160   193
3      0     0    0    0    0   0     0     0     0    0     0
4      4     0    8    0  156   0     4     1    15    0  1445
5     36     0    0  123    0  10     0     0    21  399     3
6      3     0    0    1    1   0  3001     2    19    1    39
7      4     1    0   49    0   0     2  1102     3    0     3
8      3     0    0   49    1   0     3    17  1292    2     3
9     58     9   42   41    0   0     0    78   144  746    19
10     0     0    1    0    3   0     1     0     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-15 07:42:19.819990,epoch time: 0:37:41.600176,used: 0:37:41.600176,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95012844, 'precision': 0.86302507, 'recall': 0.85813916, 'specificity': 0.9947115, 'f1': 0.8531902, 'auroc': 0.99713874}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     5    3    0     0     4     0    8     27
1     0  1289    0     7    2    0     0    25     4    0      4
2     0     1  192     0   43    0     2     1     3   70      0
3     1     3    1  8100    1   24     0   213    90    5      1
4     7     0   26     0  391    0     0     1    12    8     94
5     0     0    0    26    0  280     1     0     3  209      1
6    17     2    0     5    2    0  1841     4     5    3     28
7     2    27   10   192    9    0     1  6900   109    4      8
8     5     1    4   118   30    5     0    38  3066    6     22
9     0     0   20     4    4   16     0     2     3  444      0
10   21     0    6     6  146    0     3    12    25    3  12573
---- Validation: 
scalar performance:
{'acc': 0.9506754, 'precision': 0.86951756, 'recall': 0.85712063, 'specificity': 0.99474096, 'f1': 0.85580206, 'auroc': 0.9970472}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     7    2    0     3     5     0   14     30
1     0  1293    0     8    0    0     0    25     5    0      1
2     0     1  188     0   40    1     1     1     2   77      1
3     0     1    1  8124    1   21     0   215    74    3      0
4     6     0   22     0  392    0     1     4     9    7     98
5     0     0    0    16    1  294     0     0     5  204      1
6    17     1    0     7    3    0  1843     4     4    3     26
7     3    16    9   202   13    0     1  6906   106    3      6
8     2     0    4   130   24    4     0    34  3064    6     28
9     0     1   22     5    3   12     0     2     5  443      0
10   14     0    1     6  147    1     6    19    28    2  12572
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74316096, 'precision': 0.6688364, 'recall': 0.6286928, 'specificity': 0.9741446, 'f1': 0.61808884, 'auroc': 0.8858632}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1065     2   0  46    2    2     4    12    10   24     3
1      1  1226   0  27    0    0     0   217     8    0    20
2      4     0  65   9  560    4     0    45   114  108   106
3      0     0   0   0    0    0     0     0     0    0     0
4      2     0   0   0  423    0     2     1     7    1  1197
5      3     0   0  42    4  246     0     0    11  285     1
6     13     0   0   1   10    0  2841     7    44    0   151
7      0     0   0  27    0    0     0  1136     0    0     1
8      0     0   0  49    4    3     0     7  1298    4     5
9      5     2  75  54   53   42     1    59   145  693     8
10     0     0   0   0   16    0     0     1     0    0  1629
better model found
persisted
after epoch: 2,now: 2024-07-15 08:18:12.175317,epoch time: 0:35:52.355327,used: 1:13:33.955503,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9530715, 'precision': 0.85325503, 'recall': 0.8814064, 'specificity': 0.995109, 'f1': 0.86352277, 'auroc': 0.99755377}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     2    0    1     2     2     2    4      8
1     0  1304    0     8    0    1     0    17     2    0      0
2     3     0  247     0   10    3     1     4     2   42      0
3     1     4    1  8104    0   65     0   150   113    1      0
4     6     1   79     0  315    3     0     4    30   10     91
5     0     0    2    11    0  475     0     0     7   25      1
6    31     1    0     5    0    1  1851     2     5    1     10
7     1    59    5   176    0    2     1  6940    73    3      3
8     2     2    6   103    7    4     0    49  3113    2      8
9     1     0   45     3    2  110     0     0     4  328      0
10   64     1   24     7  112    1    16    29    50    4  12483
---- Validation: 
scalar performance:
{'acc': 0.95343053, 'precision': 0.8586613, 'recall': 0.88300407, 'specificity': 0.9951195, 'f1': 0.86734504, 'auroc': 0.99756235}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     3    0    0     1     4     2    3     12
1     0  1306    0     6    0    0     0    15     5    0      0
2     1     1  248     2    8    3     1     3     3   42      0
3     2     4    1  8123    0   52     0   152   104    2      0
4     8     1   80     0  323    4     0     5    21    8     89
5     0     0    0    12    0  471     0     0     6   31      1
6    19     3    3     5    0    1  1858     4     6    0      9
7     1    54    7   190    0    1     1  6922    81    4      4
8     1     5    4   100    9    9     0    52  3101    2     13
9     0     0   43     2    0  106     1     1     5  335      0
10   73     2   20     8   95    0     7    31    58    3  12499
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7711467, 'precision': 0.6957957, 'recall': 0.66717136, 'specificity': 0.9770589, 'f1': 0.64890003, 'auroc': 0.8906013}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1087    10    0  20    2    3     6    22     2   16     2
1      1  1334    0  16    0    0     0   135     3    0    10
2     26     2  202   5  189   32     2    78   309   73    97
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    4   0  515    0     2     2    25    1  1082
5      1     0    0  37    1  445     1     1    23   83     0
6      5     2    0   1    1    0  2946     7    66    0    39
7      0     0    0  10    0    1     0  1152     0    0     1
8      0     0    0  37    0    2     0    15  1315    0     1
9      8    21   91  64    5  212     0    63   251  415     7
10     0     0    1   0   30    0     1     2     1    0  1611
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-15 08:53:41.347108,epoch time: 0:35:29.171791,used: 1:49:03.127294,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95761985, 'precision': 0.9117849, 'recall': 0.8508568, 'specificity': 0.9951876, 'f1': 0.87686896, 'auroc': 0.9981858}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     4    2    0    18     6     1    2     37
1     0  1170    1    11    0    0     0   137     6    0      7
2     0     0  221     1   13    1     1    25     7   41      2
3     0     0    0  8319    1    2     2    80    33    0      1
4     4     0   45     2  293    1     0     8    11    9    166
5     0     0    0    57    0  397     0     0     8   58      1
6     4     0    1     4    1    0  1870     3     4    0     21
7     0     3    0   158    1    0     1  7078    17    0      5
8     1     0    3   206    4    0     1    99  2927    1     52
9     0     0   29     8    1   52     1     5     5  389      3
10    3     0    3     7   26    0     9    18    10    2  12715
---- Validation: 
scalar performance:
{'acc': 0.9580313, 'precision': 0.9096924, 'recall': 0.8539877, 'specificity': 0.9952327, 'f1': 0.87798357, 'auroc': 0.9982343}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     3    1    0    13     6     0    5     39
1     0  1190    0    14    0    0     0   119     1    0      8
2     1     0  222     1   10    2     2    25     4   40      5
3     0     0    0  8310    0    1     3    93    33    0      0
4     3     0   49     1  300    3     0     7    13    6    157
5     0     0    0    54    0  399     0     0     7   59      2
6     7     0    1     3    0    1  1876     2     4    0     14
7     0     0    0   150    1    0     1  7089    14    0     10
8     1     0    2   207   10    0     0   112  2901    2     61
9     1     0   33     7    0   51     1     5     6  388      1
10    6     0    2     8   31    0     3    14     7    0  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6280697, 'precision': 0.6873747, 'recall': 0.5088398, 'specificity': 0.9629773, 'f1': 0.48350215, 'auroc': 0.8767055}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   957    0   0   59    0    0    93    30     7   10    14
1     0  491   0   25    0    0     0   914    10    0    59
2     2    0   9   48   40    6     1   174   345   56   334
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0  243    0     1     3    25    0  1361
5     2    0   0  273    0  181     1     0    45   85     5
6     0    0   0    1    0    0  2895     9    64    0    98
7     0    0   0   53    0    0     0  1110     0    0     1
8     0    0   0  108    1    0     0    34  1224    0     3
9     3    0   1  310    1   51     1   163   323  232    52
10    0    0   0    0   11    0     0     0     0    0  1635
better model found
persisted
after epoch: 4,now: 2024-07-15 09:32:08.514683,epoch time: 0:38:27.167575,used: 2:27:30.294869,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96388054, 'precision': 0.89068466, 'recall': 0.90218145, 'specificity': 0.9961406, 'f1': 0.89425373, 'auroc': 0.9985832}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     2    0    0     2     2     0    5     32
1     0  1300    0     2    0    0     0    24     5    0      0
2     0     0  257     0    2    1     0     1     0   51      0
3     3     2    0  8021    1   50     2   278    76    4      0
4     3     0   66     0  366    2     0     1     7    6     88
5     0     0    0     6    0  484     0     0     2   28      1
6    16     0    3     3    0    1  1875     0     2    1      7
7     5     9    4    44    3    2     1  7160    29    2      6
8     3     0   11    39   12   13     1    92  3082    7     35
9     0     0   28     1    0   86     0     1     0  375      1
10   11     1   14     6   66    1     7     6    13    1  12667
---- Validation: 
scalar performance:
{'acc': 0.9630868, 'precision': 0.8905137, 'recall': 0.90066004, 'specificity': 0.9960555, 'f1': 0.89292574, 'auroc': 0.998549}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    3     2    1    0     3     0     0   11     24
1     0  1296    0     2    0    0     0    29     4    0      1
2     0     0  257     0    3    0     0     0     1   51      0
3     5     1    1  7995    0   66     2   280    84    5      1
4     4     0   73     0  356    2     1     1     8    6     88
5     0     0    1     5    0  485     0     0     1   28      1
6    14     0    2     1    0    2  1875     3     2    0      9
7     1    13    1    39    1    1     1  7166    31    3      8
8     1     0    6    52   12   15     2    73  3080    9     46
9     0     0   21     1    0   91     0     1     0  379      0
10    5     0   12     7   57    1    12    10    11    4  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7708669, 'precision': 0.7060293, 'recall': 0.6712734, 'specificity': 0.97703373, 'f1': 0.6568327, 'auroc': 0.8917785}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1081     5    1  31    1   10     2     9     6   20     4
1      0  1181    0  10    0    0     0   289     8    0    11
2      3     0  255   8  162   33     1    65   149   78   261
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   0  427    0     2     1    10    1  1189
5      2     0    1  38    0  478     0     0     7   64     2
6      1     0    0   1    0    0  3023     2     8    0    32
7      1     0    0   6    0    1     0  1153     2    0     1
8      0     0    0  42    2   19     1    13  1289    1     3
9      3     2  125  64    3  216     1   100    78  516    29
10     0     0    0   0   29    0     1     1     0    0  1615
better model found
persisted
after epoch: 5,now: 2024-07-15 10:10:32.634634,epoch time: 0:38:24.119951,used: 3:05:54.414820,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9653789, 'precision': 0.9123795, 'recall': 0.89707285, 'specificity': 0.99626106, 'f1': 0.9023154, 'auroc': 0.99859196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    0    0     3     0     1    0     20
1     0  1310    0     4    0    0     0    10     5    0      2
2     0     0  246     0   42    2     1     0     6   14      1
3     2     1    0  8160    1   26     1   105   138    1      3
4     3     0    5     0  353    1     0     0    26    0    151
5     2     0    0     6    0  478     0     0     4   30      1
6    10     0    1     0    0    0  1883     1     1    0     12
7     0    59    3   101    3    0     4  6923   151    1     19
8     1     0    1    48    1    8     3    22  3189    1     20
9     4     0   64     1    3   67     1     0     7  346      0
10    8     0    1     6   16    1     5     2    19    0  12735
---- Validation: 
scalar performance:
{'acc': 0.9653337, 'precision': 0.9108475, 'recall': 0.8913689, 'specificity': 0.99625033, 'f1': 0.89847106, 'auroc': 0.9986307}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     0    2    0     3     0     0    1     25
1     0  1312    0     4    0    0     0     8     6    0      2
2     1     0  237     0   43    2     1     1    11   14      2
3     2     1    0  8174    1   23     1   103   134    0      1
4     4     0    4     0  352    1     0     0    27    0    151
5     0     0    0     5    1  479     0     0     4   31      1
6    14     0    1     1    0    0  1874     1     1    0     16
7     0    43    1    97    2    0     1  6937   164    1     19
8     1     0    2    35    0    8     1    18  3204    0     27
9     2     0   66     1    6   78     1     0     4  335      0
10    7     1    0     7   15    0     2     2    29    0  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70580006, 'precision': 0.6040373, 'recall': 0.60874194, 'specificity': 0.9702864, 'f1': 0.5593154, 'auroc': 0.8656454}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1108     7   0  10    2    1     2     4    23    4     9
1      0  1332   0   7    0    0     0   108    17    0    35
2      3     1  39   0  219   17     0     8   452   13   263
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0   37    0     2     0    34    0  1560
5      8     0   2  28    8  467     0     0    31   45     3
6      1     0   0   0    0    0  2831     0    90    0   145
7      0     0   0  32    0    1     0  1113    15    0     3
8      0     0   0  17    1    3     0     1  1346    0     2
9     14     4  82  31   55  247     2     9   482  170    41
10     0     0   0   0    0    0     0     1     0    0  1645
better model found
persisted
after epoch: 6,now: 2024-07-15 10:47:38.914158,epoch time: 0:37:06.279524,used: 3:43:00.694344,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97305757, 'precision': 0.9120745, 'recall': 0.9072366, 'specificity': 0.9971392, 'f1': 0.90829206, 'auroc': 0.99898624}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     0    5    0     2     1     2    5     22
1     0  1294    0     1    0    0     1    32     4    0      0
2     0     0  198     0    5    0     0     1     1  107      0
3     2     0    0  8314    0   10     0    67    43    1      0
4     2     0   51     0  404    1     0     1    11   10     59
5     0     0    0     9    0  489     0     0     2   20      1
6     5     0    1     1    0    0  1888     0     2    1      8
7     0     4    4   113    0    0     2  7107    26    3      4
8     1     0    1    58    5    5     0    56  3153    6     11
9     0     0    3     1    0   63     0     0     1  425      0
10    5     1    9     7   62    0    10    14    27    8  12651
---- Validation: 
scalar performance:
{'acc': 0.9715394, 'precision': 0.90416265, 'recall': 0.89846903, 'specificity': 0.99700105, 'f1': 0.8995222, 'auroc': 0.9989105}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    1     0    3    1     5     0     2    4     17
1     0  1302    0     4    0    0     0    25     1    0      0
2     0     0  184     0    8    2     0     0     2  116      0
3     2     0    0  8301    0   13     0    81    40    3      0
4     2     0   58     0  386    1     0     3    23    7     59
5     0     0    0     8    0  482     0     0     2   29      0
6     4     0    1     0    0    1  1892     1     2    1      6
7     1     6    3   109    1    0     2  7109    27    2      5
8     0     1    2    59    4    5     1    65  3147    4      8
9     0     0    1     3    0   72     0     0     0  417      0
10    7     0    7     8   60    0    16    10    29    8  12651
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74477017, 'precision': 0.6956264, 'recall': 0.63019466, 'specificity': 0.9743582, 'f1': 0.62147003, 'auroc': 0.8871332}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1006     7    1  26    7    0    23    20    27   25    28
1      0  1132    0  12    0    0     0   312    13    0    30
2      2     0  209  16  155    8     0    67   231  127   200
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   0  294    0     2     2    25    1  1306
5      3     0    4  81    0  242     0     1    19  241     1
6      0     0    0   6    0    0  2966     2    37    1    55
7      0     0    0  11    0    0     0  1151     2    0     0
8      0     0    0  32    0    3     0    18  1312    3     2
9      3     3   77  84    5   61     0    51   125  704    24
10     0     0    0   0   14    0     1     1     1    0  1629
better model found
persisted
after epoch: 7,now: 2024-07-15 11:25:36.811282,epoch time: 0:37:57.897124,used: 4:20:58.591468,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9764822, 'precision': 0.9355271, 'recall': 0.9194057, 'specificity': 0.99745256, 'f1': 0.9269823, 'auroc': 0.99934286}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     2    1    2     4     0     1    0      1
1     0  1297    0     5    0    0     0    29     1    0      0
2     0     0  242     0   35    1     1     6     1   26      0
3     0     0    0  8309    0    7     1    77    43    0      0
4     4     0    4     1  431    0     1     3     9    0     86
5     0     0    1    13    0  459     0     0     2   45      1
6     3     0    0     2    0    0  1895     2     1    0      5
7     1     4    0    81    1    0     1  7160    12    0      3
8     0     2    1    59    4    2     0    69  3148    0     11
9     0     0   29     5    3   59     1     3     1  392      0
10   18     0    3     7   19    1    18     5    29    0  12692
---- Validation: 
scalar performance:
{'acc': 0.9754447, 'precision': 0.93401325, 'recall': 0.9184871, 'specificity': 0.99733794, 'f1': 0.9258704, 'auroc': 0.99934745}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     2    1    1     4     0     1    1      3
1     0  1297    0     8    0    0     0    27     0    0      0
2     1     0  240     0   38    1     1     6     1   24      0
3     2     0    0  8316    0    6     0    75    41    0      0
4     5     0    7     0  425    1     2     3     9    1     86
5     0     0    1    16    1  460     0     0     2   40      1
6     4     0    0     6    1    0  1890     1     4    1      1
7     0     3    0    91    1    0     1  7150    14    0      5
8     0     1    2    65    8    0     1    85  3127    1      6
9     0     0   31     5    1   49     0     3     1  402      1
10   18     0    3     6   21    0    16     5    37    0  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69768417, 'precision': 0.627657, 'recall': 0.5820524, 'specificity': 0.9697552, 'f1': 0.56939334, 'auroc': 0.8777036}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1045     6    0   29    4    3    40    12    20    8     3
1      0  1045    0   21    0    0     0   413     3    0    17
2     12     1   96   23  337    5    10    74   235   33   189
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    0    0  107    0     4     2    25    0  1494
5      5     0    6  135    6  297     2     0    15  126     0
6      0     0    0    1    0    0  3046     1    13    0     6
7      0     0    0  112    0    0     0  1049     1    0     2
8      0     0    0   82    1    1     4    17  1262    1     2
9     15     0  132  188   36   61     4   105   181  385    30
10     0     0    0    0    3    0     1     0     2    0  1640
better model found
persisted
after epoch: 8,now: 2024-07-15 12:03:08.630306,epoch time: 0:37:31.819024,used: 4:58:30.410492,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9767498, 'precision': 0.94334674, 'recall': 0.9128207, 'specificity': 0.9974178, 'f1': 0.9244292, 'auroc': 0.99950135}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     2    0    0     2     0     0    0     15
1     0  1318    0     2    0    0     0     8     3    0      1
2     0     0  256     0   38    0     0     4     3    9      2
3     1     2    0  8323    0    5     0    64    43    0      0
4     3     0    4     1  383    0     0     1    18    1    128
5     0     0    0    14    0  501     0     0     2    4      0
6     9     1    0     1    1    0  1882     0     1    0     13
7     1    23    0   113    1    0     1  7089    27    0      9
8     0     0    0    38    1    0     0    32  3207    0     17
9     0     0   37     2    1  109     1     1     6  335      1
10    2     0    0     7    8    0     2     2    21    0  12749
---- Validation: 
scalar performance:
{'acc': 0.9773171, 'precision': 0.9419614, 'recall': 0.9111408, 'specificity': 0.997494, 'f1': 0.9224382, 'auroc': 0.99949163}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     0    0    0     1     0     1    1     19
1     0  1318    0     2    0    0     0     7     5    0      0
2     0     0  250     1   38    2     0     2     4    9      6
3     2     1    0  8334    0    4     0    54    45    0      0
4     5     1    4     0  386    1     0     0    20    1    121
5     0     0    0     8    0  508     0     0     2    2      1
6     9     2    0     2    0    0  1874     1     6    0     14
7     0    21    0   111    1    0     1  7099    24    0      8
8     0     0    0    34    1    1     0    30  3220    0     10
9     1     0   46     4    0  108     0     0     6  328      0
10    2     0    0     6    3    0     2     2    22    0  12759
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6592038, 'precision': 0.6441828, 'recall': 0.57483655, 'specificity': 0.96591616, 'f1': 0.5404657, 'auroc': 0.88086337}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1093     2   0   33    0    1     3    12    14    6     6
1      0  1195   0   21    0    0     0   257     9    0    17
2      7     0  33   26   81   12     1    39   585   28   203
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  148    0     0     1    47    0  1437
5      6     0   0  117    2  396     0     0    37   30     4
6      5     0   0    3    0    0  2357     4   515    0   183
7      0     0   0  117    0    0     0  1041     3    0     3
8      0     0   0   50    0    1     0     8  1310    0     1
9     10     1  46  168    6  179     5    44   418  211    49
10     0     0   0    0    5    0     0     0     3    0  1638
better model found
persisted
after epoch: 9,now: 2024-07-15 12:40:46.967708,epoch time: 0:37:38.337402,used: 5:36:08.747894,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98177975, 'precision': 0.9521649, 'recall': 0.94292724, 'specificity': 0.9979762, 'f1': 0.94627225, 'auroc': 0.99964476}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    0    0     5     0     1    2      7
1     0  1300    0     4    0    0     0    24     1    0      2
2     0     0  294     0    8    1     1     0     0    8      0
3     0     0    0  8335    1    4     0    51    47    0      1
4     5     0   11     0  433    1     1     0     4    0     84
5     0     0    0    10    0  484     0     0     1   25      1
6     2     0    1     0    0    0  1898     0     0    0      7
7     1     1    6   100    1    0     0  7112    32    2      8
8     2     0    4    13    4    0     3    25  3208    2     35
9     0     0   48     2    0   35     1     0     3  404      0
10    5     0    2     4   10    0     4     3     3    1  12759
---- Validation: 
scalar performance:
{'acc': 0.9804467, 'precision': 0.9539582, 'recall': 0.94436777, 'specificity': 0.9978061, 'f1': 0.9482788, 'auroc': 0.99961853}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    0    0     1     0     0    1      6
1     0  1303    0     2    0    0     0    23     0    0      4
2     1     0  292     0    8    0     2     0     1    8      0
3     0     0    1  8306    0    4     0    60    69    0      0
4     2     0    9     0  439    1     1     0     3    1     83
5     0     0    0    12    0  485     0     0     2   21      1
6     3     1    0     2    0    0  1894     2     1    0      5
7     0     3    4   105    1    0     1  7117    27    0      7
8     1     0    2    17    4    1     1    25  3178    3     64
9     0     0   45     2    2   31     1     1     2  409      0
10    3     0    1     4   19    0     7     1     3    1  12757
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6739663, 'precision': 0.62946653, 'recall': 0.5481006, 'specificity': 0.9672334, 'f1': 0.53366685, 'auroc': 0.8735153}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   962    4    0   44    5    1    95    10    18   17    14
1     3  849    0   15    0    0     1   561    14    0    56
2     4    0   90   19  206    2    14    36   349   32   263
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    1    0  161    0     3     1    16    0  1451
5     2    0    5  173    6  170     8     0    38  186     4
6     1    0    0    1    0    0  3039     1     6    0    19
7     0    0    0   98    0    0     2  1059     4    0     1
8     0    0    0   46    0    0    17     6  1294    1     6
9     5    0  106  156   37   28    21    37   341  369    37
10    0    0    0    0    6    0     0     0     0    0  1640
better model found
persisted
after epoch: 10,now: 2024-07-15 13:20:16.079929,epoch time: 0:39:29.112221,used: 6:15:37.860115,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9796661, 'precision': 0.9471118, 'recall': 0.9265445, 'specificity': 0.99780333, 'f1': 0.9340966, 'auroc': 0.9995353}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    3    0     5     0     0    0      2
1     0  1319    0     2    0    0     0    11     0    0      0
2     2     0  203     0   67    0     0     7     4   26      3
3     0     0    0  8197    0    2     1   205    32    1      0
4     4     0    0     1  479    0     0     3     3    0     49
5     2     0    0    13    3  490     0     0     3    8      1
6     5     0    0     0    0    0  1899     1     1    0      2
7     0     5    0    31    0    0     0  7210    14    0      4
8     5     0    0    37    4    0     0    26  3200    0     20
9     8     0   16     2    3   52     0     2     7  401      2
10   15     0    0     3   16    0     5     8     3    0  12745
---- Validation: 
scalar performance:
{'acc': 0.9804467, 'precision': 0.948051, 'recall': 0.92638594, 'specificity': 0.99788785, 'f1': 0.9342924, 'auroc': 0.99959934}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    2    0     3     0     0    0      2
1     0  1315    0     2    0    0     0    14     0    0      1
2     1     0  200     0   67    2     0     9     1   27      5
3     2     0    0  8236    0    4     2   169    27    0      0
4     7     0    1     1  476    0     0     2     8    0     44
5     3     0    0    17    0  486     0     0     1   13      1
6     5     0    0     0    0    0  1897     1     0    0      5
7     1     5    0    27    1    0     1  7213    14    0      3
8     0     0    0    44    2    1     0    36  3196    0     17
9     8     0   12     1    2   49     0     2     4  410      5
10   13     0    0     3   19    0     5     3     4    0  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6884489, 'precision': 0.578336, 'recall': 0.56660616, 'specificity': 0.96868193, 'f1': 0.5326369, 'auroc': 0.87416637}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1062     3   0   10    1    0    43    35     3    2    11
1      0  1011   0   14    0    0     0   449     4    0    21
2     79     1   0   21  270    5     3    97   229   11   299
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0  306    0     2     2    22    0  1301
5     70     0   0  132    9  258     4     3    19   80    17
6      7     0   0    1    0    0  2989     9    16    0    45
7      0     0   0    7    0    0     0  1154     1    0     2
8      2     0   0   64    1    1    13    39  1244    1     5
9    176     1   4  115   72   85     8   156   223  184   113
10     0     0   0    0   13    0     0     0     1    0  1632
early stop counter: 1
val acc:0.9804466962814331, best validation acc: 0.9804466962814331, corresponding to test acc:                         0.6739662885665894 / 0.7711467146873474
after epoch: 11,now: 2024-07-15 14:00:51.023121,epoch time: 0:40:34.943192,used: 6:56:12.803307,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.977927, 'precision': 0.9505945, 'recall': 0.9295915, 'specificity': 0.99746716, 'f1': 0.9367645, 'auroc': 0.9996503}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    1     2    1    0     5     0     0    5     23
1     0  1306    0     4    0    0     0    21     0    0      1
2     0     0  295     0    1    1     0     1     0   14      0
3     0     0    0  8404    1    1     0    25     7    0      0
4     3     0   19     2  389    4     2     3     2    4    111
5     0     0    0     2    0  515     0     0     0    4      0
6     1     0    1     1    0    1  1900     0     0    0      4
7     1     4    0   147    1    0     3  7093     5    1      7
8     0     1   14    85   12    5     6    59  3044    0     69
9     0     0   28     1    0   82     0     0     0  382      0
10    2     0    3     5    0    0     2     2     0    2  12777
---- Validation: 
scalar performance:
{'acc': 0.9782533, 'precision': 0.95104355, 'recall': 0.92816895, 'specificity': 0.9975066, 'f1': 0.93606776, 'auroc': 0.9996553}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    2     5    0    1    10     1     0    3     22
1     0  1317    0     1    0    0     1    13     0    0      0
2     0     0  299     0    1    0     0     0     0   12      0
3     0     0    0  8391    0    4     0    28    15    1      1
4     3     0   23     1  388    2     0     3     3    3    113
5     0     0    0     6    0  509     0     0     0    5      1
6     0     0    0     2    0    1  1899     0     0    3      3
7     0     2    4   133    0    0     1  7111     5    1      8
8     0     0    5    64   12   11     2    63  3063    2     74
9     0     0   23     3    0   89     0     2     1  375      0
10    1     0    2     4    3    0     1     1     3    0  12781
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66717976, 'precision': 0.64036167, 'recall': 0.56150866, 'specificity': 0.9666559, 'f1': 0.55482876, 'auroc': 0.8774022}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   680     1    0  100    0   13   231    25    10   61    49
1     0  1111    0   24    0    0     6   314     5    0    39
2     0     0  190   48  136   25     3   103   134   41   335
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0   88    0     1     2    13    0  1528
5     0     0    7  141    0  362     2     0     5   72     3
6     0     0    0    2    0    1  2877     2     7    0   178
7     0     0    0  146    0    0     1  1014     1    0     2
8     0     0    0   83    0    3     4    14  1251    3    12
9     0     0  129  261    3  174     3   128    92  319    28
10    0     0    0    0    0    0     1     1     0    0  1644
early stop counter: 2
val acc:0.9782533049583435, best validation acc: 0.9804466962814331, corresponding to test acc:                         0.6739662885665894 / 0.7711467146873474
after epoch: 12,now: 2024-07-15 14:41:46.333504,epoch time: 0:40:55.310383,used: 7:37:08.113690,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98212755, 'precision': 0.9558693, 'recall': 0.9449917, 'specificity': 0.998098, 'f1': 0.94859666, 'auroc': 0.99972606}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    2    0     1     0     0    0      9
1     0  1324    0     0    0    0     0     8     0    0      0
2     0     0  303     0    2    0     1     1     1    4      0
3     1     1    1  8291    0    0     1    80    63    0      0
4     4     0   17     1  444    0     0     1    25    0     47
5     0     0    0    22    0  435     2     0    10   51      1
6     6     0    0     0    0    0  1892     0     4    0      5
7     1     5    1    70    0    0     0  7142    43    0      1
8     0     1    0    16    0    1     0     9  3269    0      0
9     3     0   48     0    0   12     2     2     6  420      0
10    3     0    2     4    3    0     2     5    56    0  12717
---- Validation: 
scalar performance:
{'acc': 0.98106194, 'precision': 0.95228374, 'recall': 0.9405856, 'specificity': 0.9979707, 'f1': 0.944239, 'auroc': 0.99969625}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    1    0     1     0     0    0      8
1     0  1325    0     0    0    0     0     6     1    0      0
2     2     0  304     0    1    0     0     0     1    3      1
3     0     2    0  8315    0    0     1    69    53    0      0
4     5     0   19     0  434    0     0     0    21    0     60
5     0     0    0    18    0  426     3     0    12   61      1
6     7     0    0     0    0    0  1889     2     1    0      9
7     1     8    0    88    1    0     0  7125    40    0      2
8     0     0    1    18    0    0     0    11  3264    0      2
9     1     1   51     2    1   10     3     2     9  413      0
10    8     0    1     4    5    1     0     5    62    0  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.688239, 'precision': 0.62603426, 'recall': 0.56137896, 'specificity': 0.9686647, 'f1': 0.5343012, 'auroc': 0.87443095}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   957     7    0   49    0    0    42    34    70    3     8
1     0  1210    0   12    0    0     0   256    11    0    10
2    29     1   90   11  113    2     4    95   388   29   253
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  117    0     2     2    47    0  1463
5    10     0    4  132    2  139     6     1    55  234     9
6     0     0    0    1    0    0  2930     2    58    0    76
7     0     0    0   31    0    0     0  1130     1    0     2
8     0     0    0   34    0    0     3    25  1306    1     1
9    40     1  108   96   25   24     3   139   349  316    36
10    0     0    0    0    1    0     0     0     3    0  1642
better model found
persisted
after epoch: 13,now: 2024-07-15 15:18:38.546502,epoch time: 0:36:52.212998,used: 8:14:00.326688,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9863549, 'precision': 0.95425826, 'recall': 0.96025836, 'specificity': 0.99859977, 'f1': 0.956304, 'auroc': 0.9997924}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    0    1     2     0     0    0      6
1     0  1319    0     0    0    0     0    13     0    0      0
2     0     0  254     1    7    5     1     3     2   38      1
3     1     1    0  8362    0    5     1    47    21    0      1
4     6     0    6     0  506    2     1     1     5    2      9
5     0     0    0     0    0  514     0     0     0    7      0
6     2     0    0     0    0    0  1904     0     1    0      0
7     0     5    0    49    0    0     2  7189    15    0      3
8     1     1    2    20    2    1     0    18  3246    0      4
9     0     0    5     0    0   44     0     2     0  442      0
10    8     0    0     3   88    1    14     4    19    0  12657
---- Validation: 
scalar performance:
{'acc': 0.9876421, 'precision': 0.95875144, 'recall': 0.9654435, 'specificity': 0.9987292, 'f1': 0.9613974, 'auroc': 0.9998296}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   482     0    0     0    0    0     0     0     0    0      1
1     0  1323    0     0    0    0     0     9     0    0      0
2     0     0  262     0    6    3     1     2     1   36      1
3     0     0    0  8359    0    6     2    47    26    0      0
4     6     0    7     0  512    1     0     0     5    0      8
5     0     0    0     1    0  508     0     0     0   12      0
6     2     0    0     0    0    0  1903     0     1    0      2
7     1     6    0    56    1    0     0  7185    13    0      3
8     1     0    0    20    2    3     0    14  3253    0      3
9     0     0    4     0    0   40     0     0     1  448      0
10    7     0    0     5   72    1     9     2    12    0  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73301613, 'precision': 0.65341556, 'recall': 0.60998464, 'specificity': 0.9731174, 'f1': 0.59474623, 'auroc': 0.8846201}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   925     5   0   42    1    2    97    33    49   11     5
1     0  1155   0    6    0    0     1   316     4    0    17
2     6     1  29   18  261   34    29   103   234   33   267
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  606    0     6     1    18    0  1002
5     3     0   0   88    2  306     5     4    20  161     3
6     0     0   0    1    0    0  3027     2    16    0    21
7     0     0   0   23    0    0     0  1138     1    0     2
8     0     0   0   36    0    2     5    21  1302    1     3
9     6     0  37  117   29  140    20   168   166  400    54
10    0     0   0    0   53    0     3     1     0    0  1589
better model found
persisted
after epoch: 14,now: 2024-07-15 15:54:53.372324,epoch time: 0:36:14.825822,used: 8:50:15.152510,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9893247, 'precision': 0.97653043, 'recall': 0.96706563, 'specificity': 0.9987947, 'f1': 0.9717126, 'auroc': 0.99988604}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    4    0     0     0     0    0     12
1     0  1326    0     1    0    0     0     4     0    0      0
2     0     0  281     0   13    0     0     6     0   10      2
3     0     0    0  8373    0    5     0    45    15    0      0
4     2     0    2     0  503    0     0     1     2    0     29
5     0     0    0     2    1  503     0     0     2   13      0
6     2     0    0     2    0    0  1884     1     1    0     17
7     0     3    0    30    0    0     1  7225     2    0      2
8     0     1    0    30    7    0     0    54  3178    1     23
9     2     0   13     1    0   13     0     1     0  463      0
10    3     0    1     5    7    0     0     2     2    0  12775
---- Validation: 
scalar performance:
{'acc': 0.98903304, 'precision': 0.9750786, 'recall': 0.9662498, 'specificity': 0.99876153, 'f1': 0.97057736, 'auroc': 0.9998783}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    3    0     0     1     0    0     17
1     0  1329    0     0    0    0     0     3     0    0      0
2     0     1  287     0   13    0     0     4     0    6      1
3     0     2    0  8367    0    4     0    49    17    0      1
4     2     1    3     0  496    0     0     2     0    0     35
5     0     0    0     0    0  504     0     0     1   16      0
6     4     0    0     0    0    0  1890     1     1    0     12
7     0     3    0    32    1    1     0  7225     1    0      2
8     0     0    0    21    8    1     0    59  3181    0     26
9     1     0   13     0    0   20     0     0     0  457      2
10    2     0    0     0    9    0     1     6     1    0  12777
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6868397, 'precision': 0.6459317, 'recall': 0.57922053, 'specificity': 0.9686938, 'f1': 0.5743019, 'auroc': 0.8731254}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   834     6    0   95    5   11    42    82    32   30    33
1     0  1071    0   21    0    1     0   377     8    0    21
2     0     1  114   32  243   16     3    91   134   54   327
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    1  306    0     1     1     9    0  1314
5     0     0   10   91    3  313     0     2     7  160     6
6     1     0    0    4    2    1  2793     4    26    0   236
7     0     0    0   86    0    0     0  1075     1    0     2
8     0     0    0   72    4    3     1    29  1248    3    10
9     1     0  107  162   16  145     2   120   103  431    50
10    0     0    0    0   13    0     0     1     0    0  1632
better model found
persisted
after epoch: 15,now: 2024-07-15 16:34:36.988641,epoch time: 0:39:43.616317,used: 9:29:58.768827,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98886985, 'precision': 0.9722037, 'recall': 0.9644529, 'specificity': 0.9987569, 'f1': 0.96797377, 'auroc': 0.99986374}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    0     1     0     0    0      6
1     0  1324    0     0    0    0     0     8     0    0      0
2     0     0  293     0    9    1     0     1     0    5      3
3     0     0    0  8395    0    4     0    36     2    1      0
4     6     0    1     0  484    0     0     0     3    0     45
5     0     0    0     4    0  499     0     0     1   17      0
6     2     0    0     2    0    0  1897     1     0    0      4
7     1     8    1    43    0    0     1  7205     2    0      4
8     0     1    1    57    1    0     1    50  3177    1      7
9     1     0   38     0    0   13     0     0     1  440      0
10    1     0    1     3    1    0     3     3     8    0  12772
---- Validation: 
scalar performance:
{'acc': 0.9890865, 'precision': 0.9734653, 'recall': 0.9674524, 'specificity': 0.9987799, 'f1': 0.97011167, 'auroc': 0.9998646}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    0     1     0     0    0      7
1     0  1329    0     1    0    0     0     1     1    0      0
2     1     0  301     0    4    0     1     0     0    4      1
3     0     1    0  8393    0    2     0    40     3    1      0
4     5     0    3     0  483    0     0     0     4    0     44
5     0     0    1     3    0  500     0     0     1   16      0
6     3     1    0     1    0    0  1897     1     0    0      5
7     0     7    0    43    1    0     0  7208     2    0      4
8     0     0    0    56    3    1     0    45  3181    1      9
9     0     0   34     0    1   12     0     2     1  443      0
10    0     0    0     3    9    0     3     3    10    0  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6859302, 'precision': 0.6127856, 'recall': 0.55952334, 'specificity': 0.96856344, 'f1': 0.5458986, 'auroc': 0.8650045}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   942     5    1   58    6    0    30    73    24   10    21
1     0  1237    0   14    0    0     0   210     5    0    33
2     1     0   93   36  319    1     3    63   253   15   231
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  155    0     2     2    20    0  1454
5     0     0   12  202   12  161     5     1    27  167     5
6     0     0    0    3    0    0  2938     3    28    0    95
7     0     0    0   40    0    0     0  1121     2    0     1
8     0     0    0   82    2    0     6    31  1243    1     5
9     4     1  190  179   47   54    14   115   218  275    40
10    0     0    0    0    5    0     1     1     0    0  1639
better model found
persisted
after epoch: 16,now: 2024-07-15 17:12:44.707183,epoch time: 0:38:07.718542,used: 10:08:06.487369,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9861944, 'precision': 0.9731525, 'recall': 0.9576613, 'specificity': 0.99849236, 'f1': 0.9647585, 'auroc': 0.99986285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    1    0     3     5     0    0      9
1     0  1314    0     1    0    0     0    16     1    0      0
2     0     0  278     1    2    1     1     6     1   20      2
3     0     0    0  8297    0   14     0    82    46    0      0
4     4     0    7     0  464    0     1     4    19    2     38
5     0     0    0     1    0  505     0     0     2   11      1
6     0     0    0     1    0    0  1902     2     1    0      2
7     0     0    0    22    0    0     1  7235     3    0      2
8     0     0    0    16    1    1     0    75  3198    0      5
9     0     0    1     0    0   37     0     0     2  453      0
10    2     0    1     4    5    0     5    15    10    0  12749
---- Validation: 
scalar performance:
{'acc': 0.9864384, 'precision': 0.9752121, 'recall': 0.96063936, 'specificity': 0.9985157, 'f1': 0.96739185, 'auroc': 0.9998739}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    1    0     4     3     1    0     10
1     0  1312    0     2    0    0     0    16     2    0      0
2     0     0  282     0    2    1     1     6     2   17      1
3     0     0    0  8281    0   16     0    96    47    0      0
4     3     0    8     0  470    0     0     1    18    1     38
5     0     0    0     1    0  508     0     0     3    9      0
6     0     0    0     0    0    1  1903     1     1    0      2
7     0     1    0    23    0    0     1  7236     2    0      2
8     0     0    0    17    0    0     1    60  3211    0      7
9     0     0    2     0    0   29     1     1     4  456      0
10    1     1    0     3    5    0     3    14    14    0  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6841111, 'precision': 0.6691462, 'recall': 0.57931215, 'specificity': 0.96830416, 'f1': 0.55441356, 'auroc': 0.8775481}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   979    4   0   37    1    6    61    57     8   10     7
1     0  911   0   11    0    0     0   538    21    0    18
2     2    0  43   21  115    9     6    72   519   49   179
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0  310    0     2     2    42    0  1277
5     4    0   0   81    0  366     2     1    39   98     1
6     0    0   0    2    0    0  2837     5   132    0    91
7     0    0   0   54    0    0     0  1106     2    0     2
8     0    0   0   53    0    0     0    21  1294    1     1
9     4    0  16  117    5  130     9    67   449  309    31
10    0    0   0    0   21    0     1     1     0    0  1623
early stop counter: 1
val acc:0.9864383935928345, best validation acc: 0.9890865087509155, corresponding to test acc:                         0.6859301924705505 / 0.7711467146873474
after epoch: 17,now: 2024-07-15 17:50:13.062506,epoch time: 0:37:28.355323,used: 10:45:34.842692,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9913581, 'precision': 0.98265415, 'recall': 0.9722526, 'specificity': 0.99902856, 'f1': 0.977206, 'auroc': 0.99990606}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    0    0     0     0     0    0      8
1     0  1309    0     1    0    0     0    22     0    0      0
2     0     0  291     1    3    0     1     0     1   14      1
3     0     0    0  8381    0    4     0    26    23    1      0
4     5     0    6     0  481    0     0     0     2    1     43
5     0     0    0     2    0  514     0     0     1    4      0
6     3     0    0     5    0    1  1889     0     1    0      9
7     0     0    0    38    1    0     0  7200    23    0      2
8     1     0    0     9    1    0     0    12  3263    0      9
9     0     0    1     1    0   18     0     0     3  470      0
10    2     0    0     3    6    0     0     1     2    0  12781
---- Validation: 
scalar performance:
{'acc': 0.99085194, 'precision': 0.9816821, 'recall': 0.96855444, 'specificity': 0.9989712, 'f1': 0.9747224, 'auroc': 0.99990654}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     4    0    0     1     0     0    0      4
1     0  1308    0     0    0    0     0    21     1    0      2
2     0     0  280     0    3    0     0     1     0   24      4
3     0     0    0  8382    0    1     0    21    35    1      0
4     6     0    3     0  478    1     0     0     3    0     48
5     0     0    0     2    0  517     0     0     0    2      0
6     3     0    0     6    0    0  1891     0     1    1      6
7     0     1    0    46    0    0     0  7193    21    0      4
8     1     0    0     8    1    1     0     7  3268    0     10
9     0     0    5     1    0   17     0     2     0  468      0
10    0     0    0     4    4    0     2     0     2    0  12784
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6349962, 'precision': 0.60097265, 'recall': 0.5371084, 'specificity': 0.9633418, 'f1': 0.5158965, 'auroc': 0.8573158}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   839     0   0  100    0    4    19    30   118   25    35
1     1  1073   0    7    0    0     0   356    17    0    45
2     2     0  41   14  172   11     2    35   377   34   327
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0   84    0     0     1    26    0  1522
5     0     0   4  113    0  260     1     1    42  162     9
6     0     0   0    8    1    0  2443     8   207    0   400
7     0     0   0  103    1    0     0  1055     3    0     2
8     0     0   0   32    1    0     2    12  1320    1     2
9     5     0  64  125   14   70     2    65   388  318    86
10    0     0   0    0    2    0     0     1     0    0  1643
better model found
persisted
after epoch: 18,now: 2024-07-15 18:28:01.915858,epoch time: 0:37:48.853352,used: 11:23:23.696044,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9871575, 'precision': 0.9677497, 'recall': 0.9666844, 'specificity': 0.9986395, 'f1': 0.96684414, 'auroc': 0.9998937}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    0    1     5     1     0    0      6
1     0  1309    0     0    0    0     0    21     1    0      1
2     0     0  299     0    2    0     1     3     0    5      1
3     0     0    0  8232    0    2     1   140    62    0      2
4     4     0    5     0  501    0     5     0     6    0     18
5     0     0    0     7    0  489     0     0     2   23      0
6     0     0    0     0    0    0  1904     1     0    0      2
7     0     0    0     8    0    0     0  7244    10    0      1
8     0     0    0     7    0    0     4    12  3272    0      1
9     0     0   41     1    0   12     0     0     1  438      0
10    0     0    0     0   25    0     9     3    17    0  12738
---- Validation: 
scalar performance:
{'acc': 0.9874549, 'precision': 0.9688592, 'recall': 0.97095287, 'specificity': 0.9986755, 'f1': 0.9695069, 'auroc': 0.99988836}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    0    0     2     2     1    2      3
1     0  1306    0     0    0    0     0    24     1    0      1
2     0     0  303     0    3    0     0     2     1    2      1
3     0     0    0  8254    0    3     0   126    56    1      0
4     4     0    3     0  511    0     2     1     4    1     13
5     0     0    0     6    0  499     0     0     1   15      0
6     0     0    0     0    0    0  1904     1     0    0      3
7     0     0    0     9    0    0     0  7247     6    1      2
8     0     0    1     5    1    0     6    16  3263    0      4
9     0     0   41     0    0   12     0     0     1  438      1
10    0     0    0     1   26    0    16     2    32    0  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72126216, 'precision': 0.6408014, 'recall': 0.599671, 'specificity': 0.97182006, 'f1': 0.5860039, 'auroc': 0.87902904}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   928     2   0  38    1    0    53    78    45   13    12
1     1  1000   0  11    0    0     2   446     9    0    30
2    13     0  61  11  205   16    72    65   325   52   195
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  619    0    27     1    45    0   941
5     1     0   2  84    2  310    17     2    20  147     7
6     0     0   0   1    0    0  3053     1     6    0     6
7     0     0   0  17    1    0     1  1142     1    0     2
8     0     0   0  32    0    1    53    20  1262    1     1
9    10     0  91  84   20  171    55    66   218  370    52
10    0     0   0   0   70    0     5     1     6    0  1564
early stop counter: 1
val acc:0.987454891204834, best validation acc: 0.9908519387245178, corresponding to test acc:                         0.6349961757659912 / 0.7711467146873474
after epoch: 19,now: 2024-07-15 19:04:54.471655,epoch time: 0:36:52.555797,used: 12:00:16.251841,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9877729, 'precision': 0.96899104, 'recall': 0.9788545, 'specificity': 0.9987202, 'f1': 0.9735271, 'auroc': 0.9999038}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    3    0     0     0     0    0      0
1     0  1321    0     1    0    0     0    10     0    0      0
2     0     0  302     0    3    1     0     0     1    5      0
3     0     0    0  8363    0   14     0     3    60    0      0
4     1     0    3     0  524    0     0     0     0    0     11
5     0     0    0     1    0  515     0     0     1    4      0
6     4     0    0     0    0    0  1902     0     0    0      2
7     0     2    4   108    0    1     1  7071    73    1      1
8     1     0    1    15    4    1     0     4  3259    1      7
9     0     0    6     0    1   39     0     0     0  447      0
10   10     0    1     4   30    0     3     3     6    1  12735
---- Validation: 
scalar performance:
{'acc': 0.98855156, 'precision': 0.97146183, 'recall': 0.97931516, 'specificity': 0.99879885, 'f1': 0.9749586, 'auroc': 0.9999193}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     2    5    0     0     0     0    0      1
1     0  1317    0     3    0    0     0    12     0    0      0
2     0     0  305     0    1    1     0     0     0    5      0
3     0     0    0  8385    0    7     0     2    46    0      0
4     2     1    2     0  527    0     0     0     2    0      5
5     0     0    0     0    0  519     0     0     0    2      0
6     4     0    0     0    0    1  1903     0     0    0      0
7     0     0    4   113    0    0     0  7071    75    1      1
8     2     0    0    13    6    0     0     3  3262    1      9
9     0     0    6     0    2   42     0     0     0  443      0
10   12     0    2     2   20    0     3     2     5    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69285667, 'precision': 0.6415618, 'recall': 0.56910205, 'specificity': 0.96948105, 'f1': 0.57373863, 'auroc': 0.87129223}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   994     6   0   97    7    0    17   13    26    5     5
1     7  1016   0   36    0    2     1  394    17    1    25
2    14     0  83   24  414    9     1   21   221   44   184
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  469    0     2    1    13    0  1148
5     4     0   4  101    8  251     3    0    18  198     5
6     4     0   0    1    3    0  2977    1    16    0    65
7     0     0   0  407    0    0     0  751     4    0     2
8     0     0   0   47    4    1     8    6  1295    3     6
9    14     0  82  109   56  113     5   22   240  452    44
10    0     0   0    0   29    0     0    1     1    0  1615
early stop counter: 2
val acc:0.9885515570640564, best validation acc: 0.9908519387245178, corresponding to test acc:                         0.6349961757659912 / 0.7711467146873474
after epoch: 20,now: 2024-07-15 19:44:39.683667,epoch time: 0:39:45.212012,used: 12:40:01.463853,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99109054, 'precision': 0.97591734, 'recall': 0.973243, 'specificity': 0.99904805, 'f1': 0.97410655, 'auroc': 0.9999213}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    1    0     1     0     0    0      3
1     0  1323    0     0    0    0     0     5     4    0      0
2     0     0  278     0   15    2     0     0     0   17      0
3     1     0    0  8369    0    8     1    21    38    0      0
4     5     0    1     0  518    0     0     0     0    0     15
5     0     0    0     1    0  518     0     0     1    1      0
6     0     0    0     0    1    1  1905     0     0    0      1
7     0     2    1    50    0    0     0  7175    25    1      5
8     0     0    0     4    9    1     1     4  3251    2     24
9     1     0    0     1    0   40     1     0     0  450      0
10    1     0    1     3    7    1     2     1     1    0  12778
---- Validation: 
scalar performance:
{'acc': 0.99037045, 'precision': 0.9727545, 'recall': 0.96971136, 'specificity': 0.9989648, 'f1': 0.9708197, 'auroc': 0.9999083}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    0    0     2     1     1    0      4
1     0  1323    0     0    0    0     0     7     2    0      0
2     0     0  279     0   10    2     0     1     0   17      3
3     2     0    1  8357    0    9     2    21    45    2      1
4     4     0    3     0  505    0     0     0     1    0     26
5     0     0    0     1    0  519     0     0     0    1      0
6     2     0    0     0    0    0  1904     0     0    0      2
7     0     0    1    47    0    0     0  7191    20    0      6
8     0     0    1     3    3    1     0     2  3266    1     19
9     2     0    4     0    1   44     0     0     0  442      0
10    1     0    1     5   15    0     5     4     1    0  12764
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6975443, 'precision': 0.65322316, 'recall': 0.5831771, 'specificity': 0.969862, 'f1': 0.57262784, 'auroc': 0.8765918}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   969    10   0   48    4    0    33   41    42    3    20
1     0  1209   0   23    0    0     0  236    14    0    17
2     6     1  64   28  332   35     5   40   230   37   237
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   2    1  371    0     1    1    15    0  1242
5    12     0   1   76    9  362     5    1    12  102    12
6     0     1   0    1    2    0  2935    4    51    0    73
7     0     0   0  285    0    0     0  873     4    0     2
8     0     0   0   75    3    1     6    9  1267    1     8
9    14     1  30  167   35  229     7   70   225  295    64
10    0     0   0    0   18    0     2    1     0    0  1625
early stop counter: 3
val acc:0.9903704524040222, best validation acc: 0.9908519387245178, corresponding to test acc:                         0.6349961757659912 / 0.7711467146873474
after epoch: 21,now: 2024-07-15 20:23:55.495178,epoch time: 0:39:15.811511,used: 13:19:17.275364,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9907962, 'precision': 0.9756069, 'recall': 0.97905433, 'specificity': 0.99902034, 'f1': 0.97711605, 'auroc': 0.9999414}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    4    0     0     0     0    0      4
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     0  289     0   17    0     0     1     0    5      0
3     1     0    0  8292    0    0     0   115    24    3      1
4     3     0    0     0  528    0     0     0     1    0      6
5     0     0    0     4    1  501     0     0     2   13      0
6     3     0    0     1    2    0  1897     1     0    0      3
7     0     3    4     9    0    0     0  7242     3    0      2
8     0     1    1     9   11    0     0    14  3250    1      9
9     0     0   10     0    2    4     1     1     0  475      0
10    4     0    1     0   23    0     1     2     7    0  12757
---- Validation: 
scalar performance:
{'acc': 0.9922161, 'precision': 0.9799485, 'recall': 0.9830213, 'specificity': 0.999171, 'f1': 0.98130155, 'auroc': 0.999948}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    3    0     0     0     0    0      2
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     0  290     0   13    0     0     1     0    8      0
3     1     0    1  8300    0    0     2   119    16    0      1
4     2     0    0     0  528    0     0     0     0    0      9
5     0     0    0     2    1  510     0     0     1    7      0
6     5     0    0     0    0    0  1902     0     0    0      1
7     0     0    1     4    0    0     0  7252     5    0      3
8     0     0    1     4   13    0     0     9  3265    0      4
9     0     0    7     0    2    4     0     0     0  480      0
10    1     0    1     0   24    0     3     0     4    0  12763
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7027916, 'precision': 0.6266458, 'recall': 0.58267707, 'specificity': 0.9700672, 'f1': 0.57407093, 'auroc': 0.86748064}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   921    7    8  24   46    0     9    66    38   25    26
1     0  985    0   2    0    0     0   458    16    0    38
2     3    0  105   3  499    3     0    71   155   18   158
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    2   0  501    0     1     1    21    0  1107
5     2    0   19  60   28  232     2     4    33  200    12
6     1    0    0   2   11    0  2897     3    21    0   132
7     0    0    0  39    0    0     1  1122     1    0     1
8     0    0    1  15   19    0     6    31  1296    1     1
9    12    0  183  35   93   77     2   136   193  375    31
10    0    0    0   0   32    0     0     1     2    0  1611
better model found
persisted
after epoch: 22,now: 2024-07-15 21:00:08.333533,epoch time: 0:36:12.838355,used: 13:55:30.113719,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98975277, 'precision': 0.97800136, 'recall': 0.9712785, 'specificity': 0.9988607, 'f1': 0.97443974, 'auroc': 0.9999161}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    5    0     1     0     0    1     12
1     0  1327    0     0    0    0     0     1     3    0      1
2     0     0  282     0   15    0     1     2     0    8      2
3     2     1    0  8298    0    3     0    62    69    0      2
4     0     0    1     0  514    0     0     0     1    0     23
5     0     0    0     1    0  509     0     0     4    7      0
6     1     0    0     0    0    0  1876     0     1    1     29
7     0     4    0    11    1    0     0  7214    16    3     16
8     0     0    0     3    6    0     0     2  3266    1     18
9     0     0    5     0    2   24     0     0     0  462      0
10    0     0    0     2    9    0     0     0     0    0  12781
---- Validation: 
scalar performance:
{'acc': 0.98988897, 'precision': 0.9778193, 'recall': 0.97116953, 'specificity': 0.99887943, 'f1': 0.9743323, 'auroc': 0.999915}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    4    0     0     1     1    0     17
1     0  1328    0     0    0    0     0     3     0    0      1
2     0     0  286     0   12    0     0     0     0   11      3
3     0     0    0  8305    0    4     0    54    77    0      0
4     1     0    1     0  515    0     0     0     0    0     22
5     0     0    0     3    0  507     0     0     3    8      0
6     1     0    0     1    1    0  1878     0     0    2     25
7     0     4    0    18    0    0     1  7208    15    1     18
8     0     0    0     1    7    0     0     2  3275    0     11
9     0     0    8     0    2   21     0     1     0  461      0
10    0     0    0     0   10    0     0     0     2    0  12784
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60791993, 'precision': 0.60309124, 'recall': 0.5357461, 'specificity': 0.9602939, 'f1': 0.5174377, 'auroc': 0.85818994}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   860    12   2  32   10    2    20    28    85   42    77
1     0  1190   0   4    1    0     0   218    14    0    72
2     0     1  49   7  417    7     0    41   196   24   273
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  315    0     0     1    14    0  1303
5     3     0   3  81   22  223     0     0    68  170    22
6     2     0   0   0   17    0  1645     1   283    0  1119
7     0     0   0  20    0    0     0  1135     7    0     2
8     0     0   0  18    3    0     0    18  1326    1     4
9     8     3  66  56   99   97     1    93   320  312    82
10    0     0   0   0   11    0     0     1     0    0  1634
early stop counter: 1
val acc:0.9898889660835266, best validation acc: 0.9922161102294922, corresponding to test acc:                         0.7027915716171265 / 0.7711467146873474
after epoch: 23,now: 2024-07-15 21:37:03.834505,epoch time: 0:36:55.500972,used: 14:32:25.614691,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99274933, 'precision': 0.980831, 'recall': 0.9749009, 'specificity': 0.9991985, 'f1': 0.9776981, 'auroc': 0.99994594}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    1    0     0     0     1    0      6
1     0  1326    0     0    0    0     0     6     0    0      0
2     1     0  290     0    2    0     0     3     0   12      4
3     2     1    0  8385    0    1     0    40     7    1      0
4     7     0    5     0  490    0     1     0     2    2     31
5     0     0    0     4    0  502     0     0     0   15      0
6     7     0    0     2    0    0  1892     4     1    1      1
7     0     0    0    20    0    0     1  7232     8    1      2
8     0     0    0    18    1    0     0     5  3264    0      8
9     2     0    6     0    0    5     0     0     0  480      0
10    0     0    1     2   10    1     5     1     2    0  12770
---- Validation: 
scalar performance:
{'acc': 0.99312556, 'precision': 0.9834882, 'recall': 0.9778831, 'specificity': 0.99924326, 'f1': 0.98058414, 'auroc': 0.9999447}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    2    0     0     0     0    0      8
1     0  1320    0     0    0    0     0    11     1    0      0
2     1     0  295     1    0    0     2     0     0   11      2
3     0     0    0  8398    0    0     0    34     8    0      0
4     6     0    2     0  502    0     1     0     3    1     24
5     0     0    0     3    0  504     0     0     0   14      0
6     6     0    0     1    0    1  1894     0     2    0      4
7     0     1    0    21    0    0     1  7226    12    1      3
8     0     1    0    15    1    1     1     8  3263    1      5
9     0     0    4     1    0    7     0     0     2  479      0
10    2     0    1     2    8    1     2     0     6    0  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6641713, 'precision': 0.6254347, 'recall': 0.5538222, 'specificity': 0.96631896, 'f1': 0.53215986, 'auroc': 0.8638208}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   996    7   0   18    3    0     3    49    59   10    25
1     0  868   0   17    0    0     0   559    11    0    44
2    13    1  61   30  169    9     0    45   288   73   326
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   1    1  244    0     1     2    26    0  1358
5     9    0  11   93    1  179     1     1    32  258     7
6    11    0   0    3    1    1  2669     4   201    0   177
7     0    0   0   24    0    0     0  1137     1    0     2
8     0    0   0   57    1    2     1    31  1274    1     3
9    18    0  40  142   16   82     1    50   266  435    87
10    0    0   0    0   13    0     2     0     1    0  1630
better model found
persisted
after epoch: 24,now: 2024-07-15 22:14:25.963554,epoch time: 0:37:22.129049,used: 15:09:47.743740,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99280286, 'precision': 0.98491347, 'recall': 0.97456425, 'specificity': 0.9991579, 'f1': 0.9795605, 'auroc': 0.9999422}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    4    0     1     0     0    0     14
1     0  1327    0     0    0    0     0     3     0    0      2
2     1     0  297     0    4    0     0     0     0    9      1
3     0     0    0  8411    0    0     0    22     4    0      0
4     3     0    2     0  496    0     0     0     1    0     37
5     0     0    0     0    0  519     0     0     0    2      0
6     3     1    0     1    0    1  1863     0     1    1     37
7     0     1    0    19    0    0     0  7225    12    2      5
8     0     0    0    25    1    4     0     2  3257    0      6
9     0     0    7     0    1   19     0     1     0  464      1
10    0     0    0     1    1    0     0     0     5    0  12785
---- Validation: 
scalar performance:
{'acc': 0.99245685, 'precision': 0.98472106, 'recall': 0.97208345, 'specificity': 0.99911773, 'f1': 0.9782183, 'auroc': 0.9999563}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     2    4    0     0     2     0    0     24
1     0  1328    0     0    0    0     0     3     0    0      1
2     0     0  296     0    5    0     1     0     1    7      2
3     0     0    0  8408    0    2     0    26     3    0      1
4     3     0    3     0  498    0     0     0     2    0     33
5     0     0    1     3    0  514     0     0     0    3      0
6     4     0    0     1    1    0  1868     1     1    0     32
7     0     4    0    12    1    0     0  7231    11    0      6
8     0     1    0    25    2    1     0     3  3256    0      8
9     0     0    4     1    0   20     0     1     1  466      0
10    0     0    1     0    2    0     0     1     5    0  12787
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6374449, 'precision': 0.6181272, 'recall': 0.5326823, 'specificity': 0.9635962, 'f1': 0.515552, 'auroc': 0.8544132}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   818     7   0  113    1    0    41    38    79   29    44
1     0  1159   0   14    0    0     0   243    15    0    68
2     1     0  54   27  173    5     1    57   385   36   276
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    1  129    0     0     1    37    0  1464
5     2     0   1  138    5  178     1     1    35  219    12
6     0     1   0    6    0    3  2429     1   102    0   525
7     0     0   0   56    0    0     0  1104     1    0     3
8     0     0   0   78    0    1     0    17  1270    1     3
9     2     1  48  138   29   53     3   119   350  331    63
10    0     0   0    0    5    0     0     0     2    0  1639
early stop counter: 1
val acc:0.99245685338974, best validation acc: 0.9931255578994751, corresponding to test acc:                         0.6641712784767151 / 0.7711467146873474
after epoch: 25,now: 2024-07-15 22:50:17.686972,epoch time: 0:35:51.723418,used: 15:45:39.467158,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9941674, 'precision': 0.9835776, 'recall': 0.98161834, 'specificity': 0.9993771, 'f1': 0.98252326, 'auroc': 0.9999527}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    4    0     1     0     1    0      2
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  293     0   14    0     1     1     0    2      1
3     0     0    0  8409    0    0     0    18     7    0      4
4     2     0    1     0  523    0     0     0     6    0      7
5     0     0    0     3    0  505     0     0     2   11      0
6     4     0    0     0    2    0  1900     0     1    0      1
7     0     6    0    29    1    0     1  7213     6    0      6
8     0     0    0    12    2    0     0     8  3268    0      4
9     0     0    8     0    4    5     1     1     0  474      0
10    2     0    0     0   12    0     1     2     9    0  12768
---- Validation: 
scalar performance:
{'acc': 0.99465024, 'precision': 0.9852279, 'recall': 0.9846962, 'specificity': 0.99942386, 'f1': 0.9848852, 'auroc': 0.9999702}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    5    0     0     0     0    0      2
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  296     0   11    0     1     1     0    2      1
3     0     0    0  8417    0    0     0    15     5    0      3
4     2     0    1     0  530    0     0     0     2    0      4
5     0     0    0     2    0  509     0     0     0   10      0
6     1     0    0     2    0    0  1899     2     1    0      3
7     0     6    0    29    0    0     0  7220     5    0      5
8     0     1    0    11    2    0     0    12  3264    0      6
9     0     0    8     1    2    4     1     0     1  476      0
10    2     0    0     0   17    0     1     1     7    0  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67977333, 'precision': 0.6593993, 'recall': 0.54506, 'specificity': 0.9682175, 'f1': 0.5425413, 'auroc': 0.86910397}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   853    11   0  146    7    0    68    30    47    4     4
1     0  1146   0   26    0    0     0   295     5    0    27
2     4     1  81   61  214    2     4    30   382   28   208
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  346    0     1     1    31    0  1254
5     5     0   2  211    5  117     2     2    44  199     5
6     0     2   0    8    2    0  2973     2    44    0    36
7     0     0   0  137    0    0     0  1021     2    0     4
8     0     0   0   96    1    0     4    10  1255    1     3
9     8     2  59  335   25   25     5    68   266  299    45
10    0     0   0    0   20    0     0     0     1    0  1625
better model found
persisted
after epoch: 26,now: 2024-07-15 23:27:54.395256,epoch time: 0:37:36.708284,used: 16:23:16.175442,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9907962, 'precision': 0.97617, 'recall': 0.9741355, 'specificity': 0.9990071, 'f1': 0.97478247, 'auroc': 0.9999317}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     2    3    1     7     2     0    0     12
1     0  1283    0     5    0    0     0    34     4    0      4
2     0     0  291     1    8    0     1     0     1    9      1
3     0     0    0  8417    0    5     1     4     9    0      3
4     2     0    2     0  524    0     0     1     4    0      6
5     0     0    0     3    0  513     0     0     0    4      1
6     3     0    0     2    0    0  1899     2     1    0      1
7     0     0    0    65    1    0     0  7176    16    1      3
8     0     0    0     5    3    0     0     1  3277    0     10
9     0     0    4     4    1   13     0     0     3  466      1
10    1     0    1     1   58    0     1     0     2    0  12730
---- Validation: 
scalar performance:
{'acc': 0.9913602, 'precision': 0.97983897, 'recall': 0.978061, 'specificity': 0.99905854, 'f1': 0.978559, 'auroc': 0.99994886}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     1    5    0     7     0     0    0     11
1     0  1279    0     2    2    0     0    42     4    0      3
2     0     0  294     0    9    1     0     0     0    8      0
3     0     0    0  8418    0    3     0     5    10    0      4
4     2     0    0     0  528    0     1     0     0    0      8
5     0     0    0     2    0  518     0     0     0    0      1
6     0     0    0     3    0    0  1901     2     1    0      1
7     0     0    0    68    2    0     0  7173    17    0      5
8     0     0    0     6    3    0     0     2  3275    0     10
9     0     0    4     1    0   13     0     0     1  474      0
10    1     0    0     0   50    0     0     0     2    0  12743
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65325683, 'precision': 0.65173197, 'recall': 0.53785616, 'specificity': 0.96523136, 'f1': 0.5293883, 'auroc': 0.86530775}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   587    2   0  128    3    6   176    84    69   35    80
1     0  584   0   38    1    0     0   781    18    0    77
2     1    0  72   25  217   13     1    64   274   54   294
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0  483    0     2     1    19    0  1128
5     0    0   4   74    3  316     4     1    18  165     7
6     0    0   0    3    2    0  2968     1    14    0    79
7     0    0   0  119    0    0     0  1041     2    0     2
8     0    0   0   46    2    1     1    10  1304    1     5
9     0    0  34  165   24  101     0    82   267  392    72
10    0    0   0    0   55    0     0     0     1    0  1590
early stop counter: 1
val acc:0.9913601875305176, best validation acc: 0.9946502447128296, corresponding to test acc:                         0.6797733306884766 / 0.7711467146873474
after epoch: 27,now: 2024-07-16 00:04:40.555445,epoch time: 0:36:46.160189,used: 17:00:02.335631,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99379283, 'precision': 0.9777154, 'recall': 0.98349464, 'specificity': 0.99937105, 'f1': 0.98027635, 'auroc': 0.99994886}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     2     0     0    0      0
1     0  1324    0     0    0    0     0     6     0    0      0
2     0     0  305     0    3    0     0     0     0    3      1
3     2     0    0  8377    0    1     1    38    20    1      0
4     5     0    3     0  521    0     0     1     3    0      4
5     0     0    0     1    1  477     0     0     1   41      0
6     0     0    0     0    0    0  1908     0     0    0      0
7     0     2    3     9    0    0     1  7239     9    0      1
8     0     0    0     3    6    0     0     7  3277    2      1
9     0     0    5     0    1    1     0     0     0  486      0
10   10     0    2     0   15    0     1     3    10    1  12750
---- Validation: 
scalar performance:
{'acc': 0.9940083, 'precision': 0.97949666, 'recall': 0.98536825, 'specificity': 0.9993857, 'f1': 0.9822464, 'auroc': 0.99996006}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     0    1    0     1     0     0    0      0
1     0  1330    0     0    0    0     0     1     1    0      0
2     1     0  308     0    1    0     0     0     0    1      1
3     0     0    0  8389    0    1     1    32    17    0      0
4     5     0    4     0  522    0     0     1     1    1      5
5     0     0    0     2    0  485     0     0     1   33      0
6     1     0    1     0    0    0  1904     1     0    0      1
7     1     1    1    12    0    0     0  7240     8    2      0
8     0     0    0     8    0    3     0     4  3277    0      4
9     0     0    7     0    1    1     0     0     1  483      0
10    6     0    0     0   22    0     9     6    10    1  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7086686, 'precision': 0.6522636, 'recall': 0.5933174, 'specificity': 0.97043365, 'f1': 0.58679396, 'auroc': 0.87370443}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   787    11    1  23    2    0   196    51    61   21    17
1     0  1000    1  14    0    1     0   441    24    3    15
2     5     0  176   6  274   10    13    42   231   40   218
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    6   0  335    0     3     1    20    0  1268
5     6     0    7  63    7  289    17     1    20  174     8
6     1     0    0   1    1    0  2986     1    36    0    41
7     0     0    0  23    0    0     0  1129    10    0     2
8     0     0    0  31    4    0     2     2  1326    2     3
9     3     1  142  54   39   81    31    56   187  486    57
10    0     0    0   0   28    0     1     0     2    0  1615
early stop counter: 2
val acc:0.9940083026885986, best validation acc: 0.9946502447128296, corresponding to test acc:                         0.6797733306884766 / 0.7711467146873474
after epoch: 28,now: 2024-07-16 00:44:14.883762,epoch time: 0:39:34.328317,used: 17:39:36.663948,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941674, 'precision': 0.9862461, 'recall': 0.97870255, 'specificity': 0.9993497, 'f1': 0.98236567, 'auroc': 0.9999603}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     2    3    0     0     0     0    0      1
1     0  1326    0     1    0    0     0     3     0    0      0
2     0     0  292     0   12    0     0     2     1    4      1
3     0     0    0  8418    0    0     0    15     7    0      0
4     3     0    1     0  498    0     0     0     1    0     36
5     1     0    0     3    0  512     0     0     2    3      0
6     4     0    0     1    0    0  1899     0     3    0      0
7     0     1    0    37    1    0     0  7211    13    0      0
8     0     0    0     7    0    1     0     1  3277    0      9
9     0     0    3     1    1   14     0     0     1  473      0
10    5     1    1     2    4    0     0     0     5    0  12775
---- Validation: 
scalar performance:
{'acc': 0.9940083, 'precision': 0.98535895, 'recall': 0.97918355, 'specificity': 0.9993377, 'f1': 0.9821782, 'auroc': 0.99995947}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    6    0     0     1     0    0      0
1     0  1327    0     2    0    0     0     3     0    0      0
2     0     0  295     0    7    1     0     2     1    6      0
3     0     0    0  8416    0    1     0     8    15    0      0
4     1     0    1     0  510    0     0     0     0    0     27
5     0     0    0     3    0  515     0     0     2    1      0
6     3     0    1     3    2    0  1895     1     1    0      2
7     0     3    0    31    0    0     0  7220     9    0      2
8     0     0    0    11    1    1     0     3  3267    0     13
9     0     0    6     2    1   17     0     0     5  462      0
10    3     0    1     3    3    0     0     0     7    0  12779
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6610928, 'precision': 0.6016643, 'recall': 0.55219126, 'specificity': 0.9660217, 'f1': 0.5362138, 'auroc': 0.85323274}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   934     5   0   53    1    0     7    50    84   11    25
1     0  1100   0   23    0    0     0   344     9    0    23
2     3     1  43   20  315    8     0    51   229   25   320
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0   96    0     1     1    11    0  1524
5     9     0   3  108   14  252     1     1    31  161    12
6     1     0   0    2    2    0  2712     3    44    1   302
7     0     0   0  148    0    0     0  1013     1    0     2
8     0     0   0   41    5    0     0    20  1297    1     6
9    15     2  70  165   60   94     2    77   227  359    66
10    0     0   0    0    1    0     2     0     0    0  1643
early stop counter: 3
val acc:0.9940083026885986, best validation acc: 0.9946502447128296, corresponding to test acc:                         0.6797733306884766 / 0.7711467146873474
after epoch: 29,now: 2024-07-16 01:21:12.640331,epoch time: 0:36:57.756569,used: 18:16:34.420517,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99299014, 'precision': 0.9849525, 'recall': 0.9836383, 'specificity': 0.99924165, 'f1': 0.98414063, 'auroc': 0.9999676}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     1    5    0    11     1     0    1      7
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  308     0    2    0     0     1     0    0      1
3     0     0    0  8330    0    2     0    99     7    0      1
4     0     0   10     0  521    0     0     1     3    0      4
5     0     0    0     2    0  518     0     0     1    0      0
6     0     0    1     0    0    0  1907     0     0    0      0
7     0    10    2     4    0    0     0  7240     4    0      3
8     0     0    0    12    2    0     0    17  3256    1      6
9     0     0    3     0    0   16     2     0     1  471      0
10    2     0    0     1    8    0     4     0     3    0  12774
---- Validation: 
scalar performance:
{'acc': 0.99216264, 'precision': 0.9818518, 'recall': 0.9794384, 'specificity': 0.9991485, 'f1': 0.9804113, 'auroc': 0.9999669}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     2    5    0    15     1     0    0      8
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  306     0    0    0     0     1     0    4      1
3     0     1    0  8329    0    3     0    96    11    0      0
4     0     0   10     0  521    0     0     0     1    0      7
5     0     0    0     0    0  514     2     0     2    3      0
6     0     0    1     0    0    0  1905     1     0    0      1
7     0    13    0     1    0    0     0  7244     1    0      6
8     0     0    0    10    0    0     0    18  3253    0     15
9     0     0   10     0    0   18     1     0     2  462      0
10    0     1    1     1   11    0     2     2     3    0  12775
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7142657, 'precision': 0.65301335, 'recall': 0.59899807, 'specificity': 0.9711116, 'f1': 0.58789325, 'auroc': 0.87261647}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   687     8    7  73    0    6   232    65    30   42    20
1     0  1206    0   7    0    1     0   257     7    1    20
2     0     0  222  11  153   18     7    52   333   45   174
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   11   0  268    0     4     1    27    0  1322
5     0     0   11  87    0  320     9     1    14  150     0
6     0     0    0   1    1    0  3008     4    21    0    32
7     0     0    0  12    0    0     0  1149     1    0     2
8     0     0    1  38    1    2     2    18  1304    1     3
9     0     1  173  66    9  168    10    75   189  411    35
10    0     0    0   0   10    0     2     0     0    0  1634
early stop counter: 4
val acc:0.9921626448631287, best validation acc: 0.9946502447128296, corresponding to test acc:                         0.6797733306884766 / 0.7711467146873474
after epoch: 30,now: 2024-07-16 01:57:14.734115,epoch time: 0:36:02.093784,used: 18:52:36.514301,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:52:36.514301 at 2024-07-16 01:57:14.734115
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67977333, 'precision': 0.6593993, 'recall': 0.54506, 'specificity': 0.9682175, 'f1': 0.5425413, 'auroc': 0.86910397}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   853    11   0  146    7    0    68    30    47    4     4
1     0  1146   0   26    0    0     0   295     5    0    27
2     4     1  81   61  214    2     4    30   382   28   208
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  346    0     1     1    31    0  1254
5     5     0   2  211    5  117     2     2    44  199     5
6     0     2   0    8    2    0  2973     2    44    0    36
7     0     0   0  137    0    0     0  1021     2    0     4
8     0     0   0   96    1    0     4    10  1255    1     3
9     8     2  59  335   25   25     5    68   266  299    45
10    0     0   0    0   20    0     0     0     1    0  1625
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7711467, 'precision': 0.6957957, 'recall': 0.66717136, 'specificity': 0.9770589, 'f1': 0.64890003, 'auroc': 0.8906013}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1087    10    0  20    2    3     6    22     2   16     2
1      1  1334    0  16    0    0     0   135     3    0    10
2     26     2  202   5  189   32     2    78   309   73    97
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    4   0  515    0     2     2    25    1  1082
5      1     0    0  37    1  445     1     1    23   83     0
6      5     2    0   1    1    0  2946     7    66    0    39
7      0     0    0  10    0    1     0  1152     0    0     1
8      0     0    0  37    0    2     0    15  1315    0     1
9      8    21   91  64    5  212     0    63   251  415     7
10     0     0    1   0   30    0     1     2     1    0  1611
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_15_07_04_38_seed_1_21971817_instance_wise_predictions.txt
accuracy from prediction file 0.6797733156090394
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 322395 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool | 292563 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |  29832 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 322395 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool | 292563 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |  29832 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 315422 KiB |   3546 MiB |   2167 TiB |   2167 TiB |
|       from large pool | 286862 KiB |   3521 MiB |   2135 TiB |   2135 TiB |
|       from small pool |  28560 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3966 MiB |   3966 MiB |   7362 MiB |   3396 MiB |
|       from large pool |   3916 MiB |   3916 MiB |   7296 MiB |   3380 MiB |
|       from small pool |     50 MiB |     50 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 208036 KiB | 416257 KiB |   1600 TiB |   1600 TiB |
|       from large pool | 201005 KiB | 410766 KiB |   1568 TiB |   1568 TiB |
|       from small pool |   7031 KiB |  25939 KiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4298    |    6541    |  381530 K  |  381526 K  |
|       from large pool |     130    |     436    |  204798 K  |  204798 K  |
|       from small pool |    4168    |    6336    |  176731 K  |  176727 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4298    |    6541    |  381530 K  |  381526 K  |
|       from large pool |     130    |     436    |  204798 K  |  204798 K  |
|       from small pool |    4168    |    6336    |  176731 K  |  176727 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     189    |     189    |     336    |     147    |
|       from large pool |     164    |     164    |     303    |     139    |
|       from small pool |      25    |      25    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    1617    |  240726 K  |  240726 K  |
|       from large pool |      22    |     169    |  149236 K  |  149236 K  |
|       from small pool |      18    |    1593    |   91490 K  |   91490 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3546 MiB |   2167 TiB |   2167 TiB |
|       from large pool |  16640 KiB |   3521 MiB |   2135 TiB |   2135 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 530432 KiB |   3966 MiB |   7362 MiB |   6844 MiB |
|       from large pool | 493568 KiB |   3916 MiB |   7296 MiB |   6814 MiB |
|       from small pool |  36864 KiB |     50 MiB |     66 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 416257 KiB |   1600 TiB |   1600 TiB |
|       from large pool |  24320 KiB | 410766 KiB |   1568 TiB |   1568 TiB |
|       from small pool |      0 KiB |  27987 KiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  381530 K  |  381530 K  |
|       from large pool |       2    |     436    |  204798 K  |  204798 K  |
|       from small pool |       0    |    6336    |  176731 K  |  176731 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  381530 K  |  381530 K  |
|       from large pool |       2    |     436    |  204798 K  |  204798 K  |
|       from small pool |       0    |    6336    |  176731 K  |  176731 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |     189    |     336    |     296    |
|       from large pool |      22    |     164    |     303    |     281    |
|       from small pool |      18    |      25    |      33    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1617    |  240727 K  |  240727 K  |
|       from large pool |       4    |     169    |  149236 K  |  149236 K  |
|       from small pool |       0    |    1593    |   91491 K  |   91491 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3551 MiB |   2168 TiB |   2168 TiB |
|       from large pool |  16640 KiB |   3525 MiB |   2136 TiB |   2136 TiB |
|       from small pool |      0 KiB |     49 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3546 MiB |   2167 TiB |   2167 TiB |
|       from large pool |  16640 KiB |   3521 MiB |   2135 TiB |   2135 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 530432 KiB |   3966 MiB |   7362 MiB |   6844 MiB |
|       from large pool | 493568 KiB |   3916 MiB |   7296 MiB |   6814 MiB |
|       from small pool |  36864 KiB |     50 MiB |     66 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 416257 KiB |   1600 TiB |   1600 TiB |
|       from large pool |  24320 KiB | 410766 KiB |   1568 TiB |   1568 TiB |
|       from small pool |      0 KiB |  27987 KiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6541    |  381530 K  |  381530 K  |
|       from large pool |       2    |     436    |  204798 K  |  204798 K  |
|       from small pool |       0    |    6336    |  176731 K  |  176731 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6541    |  381530 K  |  381530 K  |
|       from large pool |       2    |     436    |  204798 K  |  204798 K  |
|       from small pool |       0    |    6336    |  176731 K  |  176731 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |     189    |     336    |     296    |
|       from large pool |      22    |     164    |     303    |     281    |
|       from small pool |      18    |      25    |      33    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1617    |  240727 K  |  240727 K  |
|       from large pool |       4    |     169    |  149236 K  |  149236 K  |
|       from small pool |       0    |    1593    |   91491 K  |   91491 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817

 Experiment start at: 2024-07-16 02:37:03.511677
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9309985, 'precision': 0.8441175, 'recall': 0.76896036, 'specificity': 0.9923408, 'f1': 0.78819597, 'auroc': 0.9946371}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   345     0   0     6    0    1    10     9     4    3    105
1     0  1281   0     9    0    0     0    35     4    0      3
2     0     0  48     1  191    0     1    11     7   50      3
3     0     1   0  7564    1   16     2   663   190    1      0
4     1     0   2     0  310    1     0     3    22    7    193
5     1     0   1    41    7  334     0     0    11  124      2
6    10     3   1     2    3    1  1768     2    14    3    100
7     0    15   0    76    5    0     1  7089    63    1     15
8     0     2   0    74   29    3     0   109  3015    1     63
9     0     0  19     4   37   57     0     9    13  348      6
10    1     2   0     6   43    0     1    16    25    1  12695
---- Validation: 
scalar performance:
{'acc': 0.9297312, 'precision': 0.85444474, 'recall': 0.7660185, 'specificity': 0.99218357, 'f1': 0.7853388, 'auroc': 0.9944812}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   338     0   0     7    1    0     8    10     4    8    107
1     0  1275   0    10    0    0     0    41     4    0      2
2     0     0  44     0  189    0     1    14     5   56      3
3     0     2   0  7539    0   12     1   692   189    4      1
4     1     0   1     1  305    1     0     7    25    9    189
5     1     0   0    38    5  332     0     1    10  132      2
6     7     2   0     5    6    0  1766     4    14    1    103
7     0    20   0    76   10    0     1  7079    61    0     18
8     0     0   0    68   22    3     1   105  3023    1     73
9     4     0  10    10   39   54     0     7     9  356      4
10    2     0   0     5   34    0     3    24    25    2  12701
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.61974394, 'precision': 0.5963644, 'recall': 0.53850347, 'specificity': 0.9615666, 'f1': 0.50836945, 'auroc': 0.8683267}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1025     5   0   34    0    1    33    23    17    2    30
1      0  1234   0   24    0    0     0   215     8    0    18
2     11     0   2   12  116    0     3   119   217   54   481
3      0     0   0    0    0    0     0     0     0    0     0
4      1     0   0    0   28    0     0     2     8    0  1594
5     19     0   0  111    0  181     0     0    44  228     9
6      2     1   0    1    2    0  1903     9   102    0  1047
7      0     1   0   77    0    0     0  1081     1    0     4
8      0     0   0   36    1    0     0    15  1310    1     7
9     44     0   4   77   40   19     3   177   259  448    66
10     0     0   0    0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-16 03:14:52.671110,epoch time: 0:37:49.159433,used: 0:37:49.159433,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94164705, 'precision': 0.85702616, 'recall': 0.8042697, 'specificity': 0.99380773, 'f1': 0.8142972, 'auroc': 0.9967903}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   355     0    0    11    1    4    60     1     7    5     39
1     0  1275    0    20    0    0     0    26    10    0      1
2     0     0  115     0   34   21     2     3    20  117      0
3     0     0    0  8211    0   30     0    48   147    1      0
4     1     0   13     0  336    4     3     3    48   13    118
5     0     0    0    13    0  498     0     0     6    3      1
6     2     0    0     6    1    3  1877     2     7    0     10
7     1    10    0   446    2    0     2  6584   204    6      8
8     1     0    0    77    5    8     1    26  3160    2     14
9     0     0    5     2    0  274     3     0    11  197      0
10    2     0    3     7   68    1    38    13    71    5  12587
---- Validation: 
scalar performance:
{'acc': 0.94088537, 'precision': 0.8518897, 'recall': 0.80109566, 'specificity': 0.99373245, 'f1': 0.810579, 'auroc': 0.99692714}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   356     0    0     7    0    2    58     1    14    6     39
1     0  1271    0    16    0    0     1    32    11    0      1
2     0     0  110     1   36   17     2     2    20  124      0
3     0     0    0  8198    0   23     1    50   166    2      0
4     1     0   18     0  333    3     3     3    51   11    116
5     0     0    0    14    0  500     1     0     4    1      1
6     4     0    0     3    2    1  1883     0     7    0      8
7     0    12    1   442    3    0     5  6584   207    4      7
8     0     0    0    91    6    8     1    24  3152    1     13
9     0     0    6     5    0  280     3     0     9  190      0
10    3     0    1    10   67    1    36    18    58    4  12598
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.656895, 'precision': 0.6786356, 'recall': 0.5455297, 'specificity': 0.9659307, 'f1': 0.5197771, 'auroc': 0.88620806}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   774     1   0  214   0    4   106   10    49    3     9
1     0  1191   0   59   0    0     2  191    45    0    11
2     3     0  22   13  28   25     4   49   628   57   186
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    0  65    0     3    4    35    0  1526
5     2     0   0  114   0  418     0    0    40   16     2
6     0     0   0    1   0    0  2981    3    59    0    23
7     0     0   0  411   0    0     1  743     6    0     3
8     0     0   0   53   0    1     0    3  1312    0     1
9     5     1   6  140   2  263     5   34   419  240    22
10    0     0   0    0   0    0     3    0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-16 03:50:41.419318,epoch time: 0:35:48.748208,used: 1:13:37.907641,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93907857, 'precision': 0.85892904, 'recall': 0.8347813, 'specificity': 0.9935746, 'f1': 0.8361114, 'auroc': 0.9975992}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     2    0    1    31     5     4    0      5
1     0  1266    0     6    0    0     0    55     4    0      1
2     3     0  149     0   77    8     5    25    11   32      2
3     0     0    0  7521    0   24    15   662   216    0      0
4     5     0    6     0  370    4    10     5    30    6    103
5     0     0    0    13    0  482     2     0    13    9      1
6     7     0    0     0    0    1  1895     0     4    0      1
7     1     8    0    29    1    0     1  7178    40    0      4
8     0     0    1    25   11    4     5    93  3138    0     17
9     9     0   40     1    4  191     2    14    14  218      0
10   55     0    1     5   64    2   136    31    53    1  12447
---- Validation: 
scalar performance:
{'acc': 0.94048417, 'precision': 0.86530757, 'recall': 0.8409917, 'specificity': 0.99369705, 'f1': 0.84276813, 'auroc': 0.9975704}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     0    0    0    29     4     2    0      6
1     0  1258    0     3    0    0     0    64     6    0      1
2     6     0  161     0   71    3     6    30     8   26      1
3     1     0    0  7542    0   27    14   658   198    0      0
4     7     0    5     0  368    4     7     5    26    2    115
5     3     0    0    12    0  484     1     0    11    9      1
6     4     0    0     0    0    0  1898     1     3    0      2
7     1     3    0    28    1    0     3  7180    45    0      4
8     1     0    0    28    7    4     3    86  3149    0     18
9    11     0   44     1    4  181     4    10    12  226      0
10   56     0    0     6   66    3   134    30    48    1  12452
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67403626, 'precision': 0.6171001, 'recall': 0.56317496, 'specificity': 0.9665504, 'f1': 0.5099461, 'auroc': 0.88606393}
confusion matrix:
     0    1   2   3    4    5     6     7     8   9     10
0   879    0   0  19    0    1   231    26    13   0     1
1     0  918   0  13    0    0     1   532    22   0    13
2    13    0   2   2  107   22   222    89   372  12   174
3     0    0   0   0    0    0     0     0     0   0     0
4     0    0   0   0  168    0    49     4    16   0  1396
5    13    0   0  71    0  420    28     1    56   2     1
6     0    0   0   0    0    0  3061     3     3   0     0
7     0    0   0   8    0    0     1  1153     1   0     1
8     0    0   0  13    1    1    13    14  1326   0     2
9    30    0   5  46    9  222   117   163   438  86    21
10    0    0   0   0    4    0    20     1     0   0  1621
new oracle model saved
early stop counter: 1
val acc:0.9404841661453247, best validation acc: 0.9408853650093079, corresponding to test acc:                         0.6568949818611145 / 0.6740362644195557
after epoch: 3,now: 2024-07-16 04:27:23.729360,epoch time: 0:36:42.310042,used: 1:50:20.217683,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9612318, 'precision': 0.883884, 'recall': 0.89397424, 'specificity': 0.99592614, 'f1': 0.88783145, 'auroc': 0.99812144}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     3    0    1     2     1     1    1     15
1     0  1283    0     6    0    0     0    41     1    0      1
2     0     0  207     0   21    1     1     3     3   76      0
3     2     1    1  8125    0   13     0   210    79    5      0
4     7     0   27     0  402    2     1     1    17   16     66
5     0     0    0    18    0  461     0     0     1   40      1
6    26     0    1     0    1    2  1860     4     4    0     10
7     1     7    2    93    3    0     1  7098    53    0      6
8     4     0    2    71   13    6     1    62  3121    5     11
9     0     0   17     3    1   81     0     3     1  387      0
10   29     0    5     8  150    0     5     6    62    3  12524
---- Validation: 
scalar performance:
{'acc': 0.9626856, 'precision': 0.8913338, 'recall': 0.8984986, 'specificity': 0.9960529, 'f1': 0.8940523, 'auroc': 0.99809945}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     1    0    0     1     1     0    2     16
1     0  1284    0     9    0    0     0    37     1    0      1
2     2     0  218     0   15    1     1     2     2   69      2
3     2     0    0  8147    0    9     2   207    71    1      1
4     4     0   27     0  405    1     0     1    16   15     70
5     0     0    0    18    0  448     0     0     3   51      1
6    23     0    0     0    0    2  1867     1     4    1     10
7     0     7    2    81    6    0     1  7102    55    1     10
8     3     1    5    79    9    4     1    55  3119    5     15
9     1     0   12     3    0   76     0     2     1  397      1
10   25     0    3     6  144    2     8    11    55    1  12541
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7561743, 'precision': 0.6915426, 'recall': 0.6428542, 'specificity': 0.97566605, 'f1': 0.6278597, 'auroc': 0.890587}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1099     0    0   18    0    1    11    25    11    2     3
1      0  1173    0   20    0    0     0   284    10    0    12
2     40     0  103   15  113   18     9    61   413   88   155
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    1    0  706    0     2     1    31    0   889
5     11     0    1  112    1  396     2     0    20   48     1
6      2     0    0    1    0    0  3007     6    41    0    10
7      0     0    0   26    0    0     0  1135     2    0     1
8      0     0    0   41    0    2     1    25  1301    0     0
9     33     0   58  136    2  163     4   106   258  348    29
10     0     0    0    0  101    0     3     1     1    0  1540
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-16 05:03:28.745427,epoch time: 0:36:05.016067,used: 2:26:25.233750,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96476346, 'precision': 0.92038786, 'recall': 0.8807374, 'specificity': 0.9960747, 'f1': 0.8941685, 'auroc': 0.9987077}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     1    0     0    0    0     0     1     0    3     30
1     0  1303    0     4    0    0     0    20     2    0      2
2     0     0  193     0   34    0     1     1     1   76      6
3     0     1    0  8107    0    2     0   234    83    9      0
4     2     0   10     0  345    0     1     1     8    4    168
5     0     0    0    21    0  391     0     0     3  105      1
6    19     1    0     1    0    1  1852     4     4    4     21
7     0    18    2    57    1    0     1  7127    38    5     16
8     1     2    2    58   14    4     0    47  3092   20     56
9     0     0    9     1    0   26     0     0     0  456      1
10    5     0    0     9   12    0     2     5    12    3  12745
---- Validation: 
scalar performance:
{'acc': 0.96471846, 'precision': 0.9173028, 'recall': 0.8786105, 'specificity': 0.9960965, 'f1': 0.89106953, 'auroc': 0.9986621}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     1    0     3    0    0     0     1     1    2     28
1     0  1301    0     5    0    0     0    18     3    0      5
2     0     0  179     1   39    1     1     1     2   85      3
3     0     0    0  8088    0    5     0   251    88    8      0
4     4     0   11     0  353    0     0     1     5    8    157
5     1     0    0    26    0  387     0     0     2  104      1
6    20     0    1     1    1    1  1855     2     3    1     23
7     0    17    0    46    1    0     1  7148    39    4      9
8     2     2    1    41   11    3     0    56  3113   14     53
9     0     0    8     2    0   21     0     0     0  462      0
10    5     0    3     4   21    0     3    10    15    2  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6937662, 'precision': 0.69849455, 'recall': 0.57824236, 'specificity': 0.9695543, 'f1': 0.5719757, 'auroc': 0.875455}
confusion matrix:
      0     1   2    3   4    5     6    7     8    9     10
0   1037     1   0   77   1    0     1   23     8    7    15
1      0  1300   0   19   0    0     0  151    10    0    19
2      2     0  38   35  86    9     0   54   166   97   528
3      0     0   0    0   0    0     0    0     0    0     0
4      0     0   1    0  94    0     0    1     5    0  1532
5      2     0   0  265   2  206     1    0     9  102     5
6      5     0   0   13   0    0  2801    6    36    0   206
7      0     0   0  222   0    0     0  938     2    0     2
8      0     0   0   93   1    0     0    6  1258    2    10
9      3     1  12  222   4   52     0   73   107  601    62
10     0     0   0    0   2    0     0    1     0    0  1643
better model found
persisted
after epoch: 5,now: 2024-07-16 05:40:01.140778,epoch time: 0:36:32.395351,used: 3:02:57.629101,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.965031, 'precision': 0.92070997, 'recall': 0.8665885, 'specificity': 0.99607354, 'f1': 0.8872875, 'auroc': 0.9986404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     2    2    0    12     1     1    0     21
1     0  1297    0     7    0    0     0    25     2    0      1
2     1     0  171     3   77    1     1     9     5   39      5
3     1     0    0  8306    0    1     5    54    72    0      0
4     5     0    0     1  360    0     0     1    11    0    160
5     2     0    0    40    1  360     1     0    11  104      2
6     6     0    0     1    1    0  1833     0     6    0     61
7     3     8    0   206    1    0     2  6967    59    0     17
8     0     0    0    55   10    0     0    35  3169    0     27
9     3     0   22     8    7   13     0     1     6  429      4
10   15     0    0     7   14    0     0     7    14    1  12733
---- Validation: 
scalar performance:
{'acc': 0.964558, 'precision': 0.9163668, 'recall': 0.86494255, 'specificity': 0.99603695, 'f1': 0.883696, 'auroc': 0.9986179}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     0    1    0     8     1     0    0     18
1     0  1296    0     4    0    0     0    25     6    0      1
2     1     0  159     2   84    1     1     7     6   46      5
3     0     1    0  8306    0    2     7    46    76    2      0
4     4     0    2     0  361    0     0     0    11    1    160
5     1     0    0    36    2  364     0     0     9  108      1
6     8     0    0     0    4    0  1828     1     4    0     63
7     0     8    0   197    2    0     4  6973    61    1     19
8     1     0    0    56    8    0     0    39  3158    1     33
9     0     0   19    11    7   17     1     1     6  427      4
10   13     0    0     7   21    2     2     6    12    0  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6289792, 'precision': 0.6231947, 'recall': 0.53717476, 'specificity': 0.96256495, 'f1': 0.5234351, 'auroc': 0.86935157}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   919     2   0   49    1    0   163     6     5    2    23
1     3  1182   0   13    0    0     0   265     9    0    27
2     6     0  17   20  318    6     7    69   239   31   302
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  120    0     0     1     8    0  1504
5     6     0   0  184   18  260     4     0    30   81     9
6     0     0   0    1    1    0  2250     1    26    0   788
7     0     0   0  150    0    0     2  1007     2    0     3
8     0     0   0   63    2    0     2    17  1279    1     6
9    12     4  16  181   58   77    18   153   242  312    64
10    0     0   0    0    2    0     0     0     0    0  1644
early stop counter: 1
val acc:0.9645580053329468, best validation acc: 0.9647184610366821, corresponding to test acc:                         0.693766176700592 / 0.7561743259429932
after epoch: 6,now: 2024-07-16 06:16:03.732167,epoch time: 0:36:02.591389,used: 3:39:00.220490,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97324485, 'precision': 0.9300648, 'recall': 0.9097771, 'specificity': 0.9971054, 'f1': 0.9192128, 'auroc': 0.999171}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    1     3    0    0     1     2     1    4     46
1     0  1293    0     2    0    0     0    32     3    0      1
2     0     0  242     0   48    1     1     2     6   12      0
3     0     1    1  8290    0    4     0    86    55    1      0
4     2     0    5     0  448    0     0     3    14    1     65
5     0     0    0    27    0  451     1     0    11   30      1
6     4     0    0     0    1    0  1880     0     7    0     16
7     0     3    0    83    1    0     1  7135    38    0      3
8     0     0    1    41    4    0     0    47  3196    0      7
9     0     0   53     1    0   48     2     2     5  382      0
10    1     0    2     6   59    0     5    15    69    1  12634
---- Validation: 
scalar performance:
{'acc': 0.97448176, 'precision': 0.93176556, 'recall': 0.9172028, 'specificity': 0.99725515, 'f1': 0.92391634, 'auroc': 0.99921376}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     0    1    0     1     3     1    1     35
1     0  1296    0     2    0    0     0    30     4    0      0
2     0     0  246     0   44    0     1     5     3   13      0
3     0     0    0  8288    0    2     0    88    61    1      0
4     3     0    9     0  451    0     0     1    16    2     57
5     0     0    0    18    1  464     0     0     7   30      1
6     2     0    0     5    0    0  1883     1     8    0      9
7     0     2    0    98    1    0     1  7133    27    0      3
8     0     0    1    39    4    0     0    44  3203    0      5
9     0     0   54     1    0   46     0     1     8  383      0
10    0     0    3     9   64    0     4    11    61    1  12643
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7023018, 'precision': 0.6751585, 'recall': 0.58958364, 'specificity': 0.97033846, 'f1': 0.5836965, 'auroc': 0.8833081}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   958    1    0   62    3    2    35    46    26   13    24
1     0  983    0   26    0    0     0   470     9    0    11
2     0    0  137   15  207   13     3    58   367   50   165
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    2    0  421    0     1     5    29    0  1175
5     3    0    1  148    4  331     1     0    34   70     0
6     0    0    0    7    1    0  2933     7    66    0    53
7     0    0    0  156    0    0     0  1006     1    0     1
8     0    0    0   47    0    1     0    18  1304    0     0
9     4    0   61  142    9  127     1   106   334  341    12
10    0    0    0    0   20    0     0     1     1    0  1624
better model found
persisted
after epoch: 7,now: 2024-07-16 06:52:24.605602,epoch time: 0:36:20.873435,used: 4:15:21.093925,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9732181, 'precision': 0.938298, 'recall': 0.91071594, 'specificity': 0.9970884, 'f1': 0.9197749, 'auroc': 0.9994127}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     1    0     0    0    2     4     0     1    3     23
1     0  1325    0     2    0    0     0     4     1    0      0
2     0     0  240     0    7    1     1     3     2   55      3
3     0     2    1  8230    0   16     0    53   137    0      0
4     2     0   22     0  323    2     0     1    32    7    150
5     0     0    0     3    0  476     0     0     4   37      1
6     6     1    0     2    0    0  1881     1     3    0     12
7     1    77    1    95    0    0     1  7003    71    0     13
8     0     0    2    13    2    2     0    10  3256    2      9
9     0     0    9     0    0   39     0     0     1  444      0
10    3     0    0     6    2    0     1     1    28    4  12748
---- Validation: 
scalar performance:
{'acc': 0.97234184, 'precision': 0.93904173, 'recall': 0.910289, 'specificity': 0.99699885, 'f1': 0.91974044, 'auroc': 0.9993858}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     1    0     1    0    0     1     0     1    2     16
1     0  1326    0     1    0    0     0     4     1    0      0
2     0     0  234     0   12    1     1     3     2   57      2
3     0     3    1  8219    0   12     0    55   148    2      0
4     4     1   17     0  324    1     0     1    32    5    154
5     0     0    0     3    0  469     0     0     3   45      1
6     5     0    0     1    0    0  1887     0     1    1     13
7     1    84    0    92    0    0     1  6979    91    3     14
8     0     0    1    13    2    0     0    13  3254    2     11
9     0     0    7     1    0   37     0     0     1  446      1
10    1     0    1     7    0    0     1     2    30    2  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71272653, 'precision': 0.6953677, 'recall': 0.6078573, 'specificity': 0.97148484, 'f1': 0.59009254, 'auroc': 0.88439685}
confusion matrix:
      0     1    2    3   4    5     6    7     8    9     10
0   1028     0    0   60   0   11    13    4    24   24     6
1      0  1355    0   27   0    2     0   89    15    1    10
2      2     0  123   24  29   25     4   34   375  115   284
3      0     0    0    0   0    0     0    0     0    0     0
4      0     0    1    0  57    0     1    2    41    1  1530
5      1     0    1   82   0  427     0    0    10   69     2
6      0     0    0    2   0    0  2973    0    43    0    49
7      1     1    0  375   0    0     0  778     6    0     3
8      0     0    0   59   0    3     0    3  1303    1     1
9      6     1   35  156   3  232     4   32   144  499    25
10     0     0    0    0   1    0     0    0     1    0  1644
early stop counter: 1
val acc:0.9723418354988098, best validation acc: 0.9744817614555359, corresponding to test acc:                         0.7023018002510071 / 0.7561743259429932
after epoch: 8,now: 2024-07-16 07:30:42.524324,epoch time: 0:38:17.918722,used: 4:53:39.012647,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97950554, 'precision': 0.954732, 'recall': 0.9251144, 'specificity': 0.9977069, 'f1': 0.9382162, 'auroc': 0.999452}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    3    0     4     0     1    1     10
1     0  1316    0     2    0    0     0     9     2    0      2
2     0     0  237     1   29    0     0     5     3   33      4
3     0     4    0  8317    0    1     2    73    40    2      0
4     3     0    4     0  411    0     0     2     7    1    111
5     0     0    0    21    1  449     1     0     2   46      1
6     5     0    0     1    2    0  1884     0     1    1     14
7     0    10    0    67    2    0     5  7146    25    0      9
8     1     0    1    52    3    1     1    33  3186    0     17
9     0     0   10     1    4   19     1     1     0  456      1
10    3     0    0     6    8    0     4     5    19    1  12745
---- Validation: 
scalar performance:
{'acc': 0.9799652, 'precision': 0.9543497, 'recall': 0.925787, 'specificity': 0.9977635, 'f1': 0.93867785, 'auroc': 0.99946684}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     2    4    0     4     0     1    0     11
1     0  1313    0     1    0    0     1    14     2    0      1
2     1     0  233     0   30    0     0     5     2   35      6
3     1     1    0  8323    0    3     3    69    38    1      1
4     3     0    4     0  421    0     0     2     9    0    100
5     0     0    1    24    1  460     0     0     2   32      1
6     5     0    0     0    3    0  1886     0     2    0     12
7     0     9    0    78    1    0     5  7143    23    0      6
8     0     0    0    56    7    0     0    34  3187    0     12
9     1     0   11     0    3   26     0     1     1  449      1
10    8     0    0     7    6    0     1     2    12    0  12760
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7092283, 'precision': 0.6469592, 'recall': 0.5926626, 'specificity': 0.97081053, 'f1': 0.56812, 'auroc': 0.87911713}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1036     0   0   37    0    4    65     9     7    7     5
1      0  1265   0   16    0    0     0   189    14    0    15
2      3     0  36   12  144   10     8    35   367   51   349
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   1    0   52    0     2     1    30    0  1547
5      5     0   0  160    3  311     3     0    38   72     0
6      0     0   0    1    0    0  3035     1    15    0    15
7      0     0   0  133    0    0     0  1026     4    0     1
8      0     0   0   40    0    2     5    10  1311    1     1
9      6     0  22  127    9  127     4    48   330  422    42
10     0     0   0    0    1    0     1     1     0    0  1643
better model found
persisted
after epoch: 9,now: 2024-07-16 08:09:06.662811,epoch time: 0:38:24.138487,used: 5:32:03.151134,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97760594, 'precision': 0.93539286, 'recall': 0.92280304, 'specificity': 0.9975854, 'f1': 0.92418814, 'auroc': 0.99956167}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    1     1    5    1     3     1     1    0     64
1     0  1307    0     2    0    0     0    19     4    0      0
2     0     0  275     0   28    2     1     0     2    3      1
3     0     0    0  8276    0   19     0    91    51    0      0
4     0     0    5     0  491    0     0     0     8    0     35
5     0     0    1     2    0  506     0     0     5    6      1
6     1     0    0     0    0    0  1896     0     0    0     11
7     0     6    2    53    1    0     3  7147    39    0     12
8     0     0    0    37    4    1     0    34  3201    0     17
9     0     0   83     0    5   86     0     1     2  316      0
10    0     0    1     7   50    1     2     4    11    0  12718
---- Validation: 
scalar performance:
{'acc': 0.9776648, 'precision': 0.9328563, 'recall': 0.9232882, 'specificity': 0.9976101, 'f1': 0.9235238, 'auroc': 0.9995364}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     1    7    0     6     1     0    0     55
1     0  1311    0     4    0    0     0    14     3    0      0
2     0     0  277     0   22    0     2     0     2    7      2
3     0     0    0  8274    0   22     2    90    51    0      1
4     0     0    5     0  493    0     0     1     4    0     36
5     0     0    1     1    1  502     1     0     4   10      1
6     4     0    0     0    1    0  1888     0     1    0     14
7     0    12    0    58    1    0     1  7156    32    0      5
8     0     1    0    39    2    1     0    35  3208    0     10
9     0     0   81     0    6   91     1     0     4  310      0
10    0     0    2     8   49    0     6     3    10    0  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69131744, 'precision': 0.64261216, 'recall': 0.5784656, 'specificity': 0.9691266, 'f1': 0.57104623, 'auroc': 0.87941074}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   876     0    1  105    5   15    99   15     7    2    45
1     0  1150    0   20    1    0     0  290     8    0    30
2     0     0  155   15  278   13    12   26   217    7   292
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    1    0  344    0     2    2     9    0  1275
5     2     0    4  110   15  379     4    0    24   48     6
6     0     0    0    2    0    0  2966    2     5    0    92
7     0     0    0  207    0    0     0  954     2    0     1
8     0     0    0   75    4    1     5   10  1270    1     4
9     0     0  278  135   38  189    19   45   226  163    44
10    0     0    0    0   21    0     1    0     0    0  1624
early stop counter: 1
val acc:0.9776648283004761, best validation acc: 0.9799652099609375, corresponding to test acc:                         0.7092282772064209 / 0.7561743259429932
after epoch: 10,now: 2024-07-16 08:47:31.139192,epoch time: 0:38:24.476381,used: 6:10:27.627515,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9764822, 'precision': 0.93839526, 'recall': 0.9092697, 'specificity': 0.99741197, 'f1': 0.9203133, 'auroc': 0.9995061}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    1    4     2     0     0    3      6
1     0  1282    1     7    0    0     0    38     3    0      0
2     0     0  233     0    0    3     0     5     2   69      0
3     0     0    0  8369    0    2     1    55    11    1      0
4     5     0   34     1  378    0     0     5    20   11     85
5     0     0    0     5    0  511     0     0     2    2      1
6     1     0    0     1    0    1  1884     1     3    0     17
7     2     1    0   104    0    0     2  7136    12    1      5
8     0     0    0   106    2    0     0    54  3118    0     14
9     0     0    2     1    0  124     0     1     0  364      0
10    5     0    1     9    6    0     1     7     7    2  12756
---- Validation: 
scalar performance:
{'acc': 0.9770496, 'precision': 0.93901557, 'recall': 0.90751654, 'specificity': 0.9974699, 'f1': 0.91996086, 'auroc': 0.9994693}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    0    4     4     0     0    5      6
1     0  1289    0     5    0    0     0    36     1    0      1
2     0     0  231     0    1    3     0     5     2   68      2
3     0     0    0  8392    0    2     0    43     3    0      0
4     6     1   34     2  384    2     0     2    16    5     87
5     0     0    0    18    0  497     0     0     0    5      1
6     2     0    0     1    0    2  1892     2     1    1      7
7     0     4    0    90    0    0     1  7150    12    0      8
8     0     0    1   108    0    1     0    66  3105    0     15
9     0     0    1     5    0  122     0     0     0  365      0
10    5     0    1     8    7    0     1     7     6    2  12759
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65619534, 'precision': 0.66223145, 'recall': 0.5558595, 'specificity': 0.9658778, 'f1': 0.5452294, 'auroc': 0.87374085}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   738    0    0  203    0   38    63    36    25   46    21
1     0  925    0   37    0    0     0   516     4    0    17
2     1    0  100   46  116   17     1    81   252  135   266
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    2    0  110    1     0     3    22    0  1495
5     0    0    0  170    0  355     1     0     9   56     1
6     1    0    0   32    0    0  2775    12    27    0   220
7     0    0    0  143    0    0     0  1019     1    0     1
8     0    0    1   98    0    1     1    23  1241    1     4
9     0    0   18  220    3  172     0    79   150  476    19
10    0    0    0    0    4    0     0     1     1    0  1640
early stop counter: 2
val acc:0.9770495891571045, best validation acc: 0.9799652099609375, corresponding to test acc:                         0.7092282772064209 / 0.7561743259429932
after epoch: 11,now: 2024-07-16 09:26:21.737785,epoch time: 0:38:50.598593,used: 6:49:18.226108,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98022795, 'precision': 0.93788207, 'recall': 0.9454724, 'specificity': 0.9979704, 'f1': 0.9395639, 'auroc': 0.9996726}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    1    0     5     0     0    0      2
1     0  1322    0     3    0    0     0     4     3    0      0
2     2     0  248     0   51    0     1     3     3    3      1
3     2     1    0  8364    1    2     3    43    23    0      0
4     5     0    0     0  522    0     0     0     3    0      9
5     3     0    1     9    1  486     0     0     3   17      1
6     2     0    0     1    0    0  1904     0     0    0      1
7     1    25    0    61    4    0     4  7083    71    0     15
8     2     1    0    37   15    0    10    10  3201    0     20
9     8     1   34     1    3   33     2     2    12  396      0
10   19     1    0     7   96    1    24     3     3    0  12636
---- Validation: 
scalar performance:
{'acc': 0.9796175, 'precision': 0.93751234, 'recall': 0.94407105, 'specificity': 0.99789405, 'f1': 0.9384182, 'auroc': 0.999686}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    0    0     2     0     0    0      3
1     0  1319    0     5    0    0     0     7     1    0      0
2     1     0  246     0   57    0     0     2     4    1      1
3     3     1    0  8351    0    0     3    55    26    0      1
4     6     0    0     0  520    0     0     0     0    0     13
5     3     0    0     9    1  489     1     0     2   15      1
6     2     0    0     0    0    0  1903     0     1    0      2
7     2    25    0    75    4    0     2  7075    73    0      9
8     1     0    0    36   18    0     9     8  3199    0     25
9    12     1   36     1    2   35     3     0    12  391      0
10   15     0    1     6   98    0    20     2     2    0  12652
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71181697, 'precision': 0.6502441, 'recall': 0.5840627, 'specificity': 0.97119594, 'f1': 0.5644401, 'auroc': 0.8800853}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1056     1   0   57    0    0    46     6     1    1     2
1      3  1300   0   18    0    0     2   158     7    0    11
2     56     2  18   28  363   12    31    29   229   13   234
3      0     0   0    0    0    0     0     0     0    0     0
4      4     0   0    1  422    0     5     1     9    0  1191
5     15     0   0  224    8  279     6     1    28   29     2
6      2     0   0    1    1    0  3051     3     4    0     5
7      0     0   0  112    0    0     1  1047     3    0     1
8      1     0   0   77    5    0    13     6  1261    0     7
9     57     6  23  237   52  120    32    67   376  131    36
10     0     0   0    0   33    0     3     1     0    0  1609
early stop counter: 3
val acc:0.9796174764633179, best validation acc: 0.9799652099609375, corresponding to test acc:                         0.7092282772064209 / 0.7561743259429932
after epoch: 12,now: 2024-07-16 10:03:04.944018,epoch time: 0:36:43.206233,used: 7:26:01.432341,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97487694, 'precision': 0.9504515, 'recall': 0.94014716, 'specificity': 0.9973192, 'f1': 0.94268835, 'auroc': 0.99966973}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    1     0    4    0     2     3     3    0     19
1     0  1303    0     0    0    0     0    28     1    0      0
2     0     0  289     0    0    0     0     7     3   13      0
3     1     0    0  8005    0    1     0   275   156    0      1
4     1     1   21     0  474    0     0     1    11    0     30
5     0     0    0    11    0  391     0     0    11  107      1
6     2     0    1     0    1    0  1885     1     2    0     16
7     0     3    1    11    0    0     0  7224    20    0      5
8     0     1    0     3    2    0     0    31  3252    2      4
9     0     0    9     0    3    2     0     1     3  475      0
10    0     1    2     5   30    0     1    13    49    1  12688
---- Validation: 
scalar performance:
{'acc': 0.9746155, 'precision': 0.9527389, 'recall': 0.94176954, 'specificity': 0.99728024, 'f1': 0.94478774, 'auroc': 0.9997176}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    5    0     1     1     1    0     18
1     0  1306    0     0    0    0     0    25     1    0      0
2     0     0  290     0    2    0     0     3     3   14      0
3     0     2    1  7991    0    1     2   282   158    1      2
4     1     0   18     0  468    0     0     2    14    1     35
5     0     0    1    14    0  398     0     0     5  102      1
6     0     0    0     1    0    0  1886     1     5    0     15
7     0     2    0    13    1    0     0  7224    18    1      6
8     0     0    0     1    0    0     1    37  3251    0      6
9     0     0   11     1    1    1     0     1     2  476      0
10    2     0    1     6   25    0     1     6    65    0  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6585042, 'precision': 0.6565589, 'recall': 0.5466629, 'specificity': 0.96560174, 'f1': 0.52286077, 'auroc': 0.87566984}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   757     2   1   57    7   1   114    69    56   45    61
1     0  1250   0   13    0   0     0   214    11    0    11
2     3     1  70    8  148   1     2    81   499   79   123
3     0     0   0    0    0   0     0     0     0    0     0
4     0     0   5    0  226   0     0     2    58    2  1340
5     1     0   1  131    4  88     0     3    85  276     3
6     0     0   0    2    1   0  2412     7   341    0   304
7     0     0   0   18    0   0     0  1139     3    0     4
8     0     0   0   31    0   0     0    19  1318    1     1
9     0     0  32  117    9  11     1   143   274  522    28
10    0     0   0    0   11   0     0     0     5    0  1630
early stop counter: 4
val acc:0.9746155142784119, best validation acc: 0.9799652099609375, corresponding to test acc:                         0.7092282772064209 / 0.7561743259429932
after epoch: 13,now: 2024-07-16 10:39:21.625825,epoch time: 0:36:16.681807,used: 8:02:18.114148,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9799069, 'precision': 0.9597188, 'recall': 0.94226, 'specificity': 0.99777836, 'f1': 0.9489806, 'auroc': 0.9997819}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    2    0     0     0     1    0     21
1     0  1321    0     3    0    0     0     5     2    0      1
2     0     0  284     0    4    0     0     0     5   16      3
3     0     0    1  8305    0   11     0    16   106    0      0
4     3     0   12     1  422    0     0     0    13    1     87
5     0     0    1     1    0  516     0     0     2    0      0
6     2     0    2     1    0    0  1871     0     2    0     29
7     2     5    2   122    1    0     1  7006   107    0     17
8     0     0    0    11    2    1     1     2  3269    0     10
9     0     0   13     0    0   74     0     0     2  403      1
10    1     0    1     6    5    0     0     1     9    0  12769
---- Validation: 
scalar performance:
{'acc': 0.9805002, 'precision': 0.95973253, 'recall': 0.9461842, 'specificity': 0.9978723, 'f1': 0.9509845, 'auroc': 0.99978936}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     0    0    0     2     0     2    0     18
1     0  1322    0     6    0    0     0     2     2    0      0
2     0     0  292     0    2    1     0     1     1   15      0
3     1     0    1  8293    0    6     1    12   125    0      1
4     2     1    8     0  430    0     0     0    17    0     81
5     0     0    0     1    0  517     0     0     0    3      0
6     3     0    0     0    0    1  1883     0     2    0     19
7     2     7    5   111    2    0     0  7020    98    2     18
8     0     0    0    16    0    5     1     0  3270    1      3
9     0     0   17     1    0   72     0     0     3  399      1
10    2     0    0     6    5    1     1     0    12    0  12769
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63947386, 'precision': 0.6547688, 'recall': 0.5472701, 'specificity': 0.9641458, 'f1': 0.53976583, 'auroc': 0.870844}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   842     3   1  110    1    7    29   15    60    3    99
1     2  1189   0   40    0    0     1  216    14    0    37
2     3     0  95   31  101   31     0   20   279   39   416
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   2    0  201    1     0    1    14    0  1414
5     4     0   0  143    2  376     0    1    16   44     6
6     0     0   0   22    0    1  2445    3   104    0   492
7     0     0   0  349    0    0     2  805     7    0     1
8     0     0   0   72    2    2     0    6  1284    1     3
9     9     0  70  187    6  299     1   32   194  269    70
10    0     0   0    0   12    0     0    0     0    0  1634
better model found
persisted
after epoch: 14,now: 2024-07-16 11:19:18.903343,epoch time: 0:39:57.277518,used: 8:42:15.391666,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_16_02_37_03_seed_2_21971817
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
slurmstepd: error: *** JOB 21971817 ON gpusrv12 CANCELLED AT 2024-07-16T11:34:04 DUE TO TIME LIMIT ***
