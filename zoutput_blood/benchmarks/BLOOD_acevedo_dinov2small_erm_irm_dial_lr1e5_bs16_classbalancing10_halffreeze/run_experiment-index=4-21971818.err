Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 14 11:33:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818

 Experiment start at: 2024-07-14 12:01:05.082518
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.34227848, 'precision': 0.031116227, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363294, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3294
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12793
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-14 12:35:02.865072,epoch time: 0:33:57.782554,used: 0:33:57.782554,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.34233198, 'precision': 0.03112109, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046368692, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    520
6    0   0   0   0   0   0   0   0   0   0   1906
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3294
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12795
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 1
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 2,now: 2024-07-14 13:08:49.803470,epoch time: 0:33:46.938398,used: 1:07:44.720952,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1906
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 2
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 3,now: 2024-07-14 13:42:38.405866,epoch time: 0:33:48.602396,used: 1:41:33.323348,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.34227848, 'precision': 0.031116227, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363294, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12793
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 3
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 4,now: 2024-07-14 14:16:21.032441,epoch time: 0:33:42.626575,used: 2:15:15.949923,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    520
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 4
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 5,now: 2024-07-14 14:50:07.034804,epoch time: 0:33:46.002363,used: 2:49:01.952286,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    482
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 5
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 6,now: 2024-07-14 15:23:36.488593,epoch time: 0:33:29.453789,used: 3:22:31.406075,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    520
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 6
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 7,now: 2024-07-14 15:57:20.455653,epoch time: 0:33:43.967060,used: 3:56:15.373135,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 7
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 8,now: 2024-07-14 16:31:04.021090,epoch time: 0:33:43.565437,used: 4:29:58.938572,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 8
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 9,now: 2024-07-14 17:04:52.432217,epoch time: 0:33:48.411127,used: 5:03:47.349699,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    520
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7262
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 9
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 10,now: 2024-07-14 17:38:45.276021,epoch time: 0:33:52.843804,used: 5:37:40.193503,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.34227848, 'precision': 0.031116227, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363294, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7262
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12793
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 10
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 11,now: 2024-07-14 18:13:08.891667,epoch time: 0:34:23.615646,used: 6:12:03.809149,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 11
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 12,now: 2024-07-14 18:47:23.143161,epoch time: 0:34:14.251494,used: 6:46:18.060643,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 12
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 13,now: 2024-07-14 19:21:02.801551,epoch time: 0:33:39.658390,used: 7:19:57.719033,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    311
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3293
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 13
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 14,now: 2024-07-14 19:54:40.391046,epoch time: 0:33:37.589495,used: 7:53:35.308528,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1906
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3293
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 14
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 15,now: 2024-07-14 20:28:10.529939,epoch time: 0:33:30.138893,used: 8:27:05.447421,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    520
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3294
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 15
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 16,now: 2024-07-14 21:01:39.464224,epoch time: 0:33:28.934285,used: 9:00:34.381706,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7262
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 16
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 17,now: 2024-07-14 21:35:15.301708,epoch time: 0:33:35.837484,used: 9:34:10.219190,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.34227848, 'precision': 0.031116227, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363294, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    482
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    311
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12793
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 17
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 18,now: 2024-07-14 22:08:34.065445,epoch time: 0:33:18.763737,used: 10:07:28.982927,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.34227848, 'precision': 0.031116227, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363294, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    482
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12793
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 18
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 19,now: 2024-07-14 22:41:46.877258,epoch time: 0:33:12.811813,used: 10:40:41.794740,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 19
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 20,now: 2024-07-14 23:15:13.357901,epoch time: 0:33:26.480643,used: 11:14:08.275383,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 20
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 21,now: 2024-07-14 23:48:35.319773,epoch time: 0:33:21.961872,used: 11:47:30.237255,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 11:47:30.237255 at 2024-07-14 23:48:35.319773
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_14_12_01_04_seed_0_21971818_instance_wise_predictions.txt
accuracy from prediction file 0.11516126775344575
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 322626 KiB |   1934 MiB |    775 TiB |    775 TiB |
|       from large pool | 292783 KiB |   1909 MiB |    764 TiB |    764 TiB |
|       from small pool |  29842 KiB |     47 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 322626 KiB |   1934 MiB |    775 TiB |    775 TiB |
|       from large pool | 292783 KiB |   1909 MiB |    764 TiB |    764 TiB |
|       from small pool |  29842 KiB |     47 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 315425 KiB |   1930 MiB |    775 TiB |    775 TiB |
|       from large pool | 286862 KiB |   1906 MiB |    763 TiB |    763 TiB |
|       from small pool |  28563 KiB |     45 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2190 MiB |   2190 MiB |   2190 MiB |      0 B   |
|       from large pool |   2140 MiB |   2140 MiB |   2140 MiB |      0 B   |
|       from small pool |     50 MiB |     50 MiB |     50 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 189374 KiB | 275888 KiB | 577721 GiB | 577720 GiB |
|       from large pool | 182352 KiB | 271529 KiB | 565576 GiB | 565576 GiB |
|       from small pool |   7021 KiB |   9890 KiB |  12144 GiB |  12144 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4318    |    6569    |  138902 K  |  138898 K  |
|       from large pool |     130    |     276    |   73974 K  |   73974 K  |
|       from small pool |    4188    |    6364    |   64927 K  |   64923 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4318    |    6569    |  138902 K  |  138898 K  |
|       from large pool |     130    |     276    |   73974 K  |   73974 K  |
|       from small pool |    4188    |    6364    |   64927 K  |   64923 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     114    |     114    |     114    |       0    |
|       from large pool |      89    |      89    |      89    |       0    |
|       from small pool |      25    |      25    |      25    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    2315    |   77255 K  |   77255 K  |
|       from large pool |      19    |      87    |   48178 K  |   48178 K  |
|       from small pool |      21    |    2296    |   29077 K  |   29077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1934 MiB |    775 TiB |    775 TiB |
|       from large pool |  16640 KiB |   1909 MiB |    764 TiB |    764 TiB |
|       from small pool |      0 KiB |     47 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1934 MiB |    775 TiB |    775 TiB |
|       from large pool |  16640 KiB |   1909 MiB |    764 TiB |    764 TiB |
|       from small pool |      0 KiB |     47 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1930 MiB |    775 TiB |    775 TiB |
|       from large pool |  16640 KiB |   1906 MiB |    763 TiB |    763 TiB |
|       from small pool |      0 KiB |     45 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 512000 KiB |   2190 MiB |   2190 MiB |   1690 MiB |
|       from large pool | 475136 KiB |   2140 MiB |   2140 MiB |   1676 MiB |
|       from small pool |  36864 KiB |     50 MiB |     50 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 275888 KiB | 577721 GiB | 577721 GiB |
|       from large pool |  24320 KiB | 271529 KiB | 565577 GiB | 565577 GiB |
|       from small pool |      0 KiB |  25937 KiB |  12144 GiB |  12144 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6569    |  138902 K  |  138902 K  |
|       from large pool |       2    |     276    |   73974 K  |   73974 K  |
|       from small pool |       0    |    6364    |   64927 K  |   64927 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6569    |  138902 K  |  138902 K  |
|       from large pool |       2    |     276    |   73974 K  |   73974 K  |
|       from small pool |       0    |    6364    |   64927 K  |   64927 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |     114    |     114    |      74    |
|       from large pool |      22    |      89    |      89    |      67    |
|       from small pool |      18    |      25    |      25    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2315    |   77256 K  |   77256 K  |
|       from large pool |       3    |      87    |   48178 K  |   48178 K  |
|       from small pool |       0    |    2296    |   29078 K  |   29078 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1934 MiB |    775 TiB |    775 TiB |
|       from large pool |  16640 KiB |   1909 MiB |    764 TiB |    764 TiB |
|       from small pool |      0 KiB |     47 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1934 MiB |    775 TiB |    775 TiB |
|       from large pool |  16640 KiB |   1909 MiB |    764 TiB |    764 TiB |
|       from small pool |      0 KiB |     47 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1930 MiB |    775 TiB |    775 TiB |
|       from large pool |  16640 KiB |   1906 MiB |    763 TiB |    763 TiB |
|       from small pool |      0 KiB |     45 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 512000 KiB |   2190 MiB |   2190 MiB |   1690 MiB |
|       from large pool | 475136 KiB |   2140 MiB |   2140 MiB |   1676 MiB |
|       from small pool |  36864 KiB |     50 MiB |     50 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 275888 KiB | 577721 GiB | 577721 GiB |
|       from large pool |  24320 KiB | 271529 KiB | 565577 GiB | 565577 GiB |
|       from small pool |      0 KiB |  25937 KiB |  12144 GiB |  12144 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6569    |  138902 K  |  138902 K  |
|       from large pool |       2    |     276    |   73974 K  |   73974 K  |
|       from small pool |       0    |    6364    |   64927 K  |   64927 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6569    |  138902 K  |  138902 K  |
|       from large pool |       2    |     276    |   73974 K  |   73974 K  |
|       from small pool |       0    |    6364    |   64927 K  |   64927 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |     114    |     114    |      74    |
|       from large pool |      22    |      89    |      89    |      67    |
|       from small pool |      18    |      25    |      25    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2315    |   77256 K  |   77256 K  |
|       from large pool |       3    |      87    |   48178 K  |   48178 K  |
|       from small pool |       0    |    2296    |   29078 K  |   29078 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818

 Experiment start at: 2024-07-15 00:25:52.889993
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.34233198, 'precision': 0.03112109, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046368692, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    520
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12795
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-15 00:59:31.266295,epoch time: 0:33:38.376302,used: 0:33:38.376302,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3294
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 1
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 2,now: 2024-07-15 01:32:51.526421,epoch time: 0:33:20.260126,used: 1:06:58.636428,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.34227848, 'precision': 0.031116227, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363294, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12793
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 2
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 3,now: 2024-07-15 02:06:35.460126,epoch time: 0:33:43.933705,used: 1:40:42.570133,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 3
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 4,now: 2024-07-15 02:39:20.983430,epoch time: 0:32:45.523304,used: 2:13:28.093437,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8435
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 4
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 5,now: 2024-07-15 03:12:15.661151,epoch time: 0:32:54.677721,used: 2:46:22.771158,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 5
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 6,now: 2024-07-15 03:45:05.157552,epoch time: 0:32:49.496401,used: 3:19:12.267559,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    482
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 6
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 7,now: 2024-07-15 04:17:41.848461,epoch time: 0:32:36.690909,used: 3:51:48.958468,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7261
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 7
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 8,now: 2024-07-15 04:50:35.747168,epoch time: 0:32:53.898707,used: 4:24:42.857175,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8437
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 8
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 9,now: 2024-07-15 05:23:27.230029,epoch time: 0:32:51.482861,used: 4:57:34.340036,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 9
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 10,now: 2024-07-15 05:56:41.333749,epoch time: 0:33:14.103720,used: 5:30:48.443756,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    537
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 10
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 11,now: 2024-07-15 06:30:11.284605,epoch time: 0:33:29.950856,used: 6:04:18.394612,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.34233198, 'precision': 0.03112109, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046368692, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    482
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    311
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7262
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12795
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 11
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 12,now: 2024-07-15 07:03:30.439894,epoch time: 0:33:19.155289,used: 6:37:37.549901,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 12
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 13,now: 2024-07-15 07:36:40.031345,epoch time: 0:33:09.591451,used: 7:10:47.141352,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.3421982, 'precision': 0.031108927, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046355195, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12790
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 13
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 14,now: 2024-07-15 08:09:46.850314,epoch time: 0:33:06.818969,used: 7:43:53.960321,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1330
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3294
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 14
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 15,now: 2024-07-15 08:42:42.059240,epoch time: 0:32:55.208926,used: 8:16:49.169247,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.34233198, 'precision': 0.03112109, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046368692, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    482
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    311
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12795
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 15
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 16,now: 2024-07-15 09:16:40.417446,epoch time: 0:33:58.358206,used: 8:50:47.527453,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.34227848, 'precision': 0.031116227, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363294, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1331
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7263
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12793
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 16
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 17,now: 2024-07-15 09:53:30.322381,epoch time: 0:36:49.904935,used: 9:27:37.432388,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.3423052, 'precision': 0.031118657, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046365995, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1905
7    0   0   0   0   0   0   0   0   0   0   7264
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12794
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 17
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 18,now: 2024-07-15 10:31:13.509639,epoch time: 0:37:43.187258,used: 10:05:20.619646,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.34233198, 'precision': 0.03112109, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046368692, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8438
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7261
8    0   0   0   0   0   0   0   0   0   0   3294
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12795
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 18
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 19,now: 2024-07-15 11:07:28.871514,epoch time: 0:36:15.361875,used: 10:41:35.981521,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.34225172, 'precision': 0.031113794, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046360593, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7262
8    0   0   0   0   0   0   0   0   0   0   3295
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12792
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 19
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 20,now: 2024-07-15 11:43:49.927560,epoch time: 0:36:21.056046,used: 11:17:57.037567,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.34222496, 'precision': 0.03111136, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046357892, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8439
4    0   0   0   0   0   0   0   0   0   0    538
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1907
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    492
10   0   0   0   0   0   0   0   0   0   0  12791
---- Validation: 
scalar performance:
{'acc': 0.3422763, 'precision': 0.03111603, 'recall': 0.09090909, 'specificity': 0.90909094, 'f1': 0.046363074, 'auroc': 0.5}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9      10
0    0   0   0   0   0   0   0   0   0   0    483
1    0   0   0   0   0   0   0   0   0   0   1332
2    0   0   0   0   0   0   0   0   0   0    312
3    0   0   0   0   0   0   0   0   0   0   8440
4    0   0   0   0   0   0   0   0   0   0    539
5    0   0   0   0   0   0   0   0   0   0    521
6    0   0   0   0   0   0   0   0   0   0   1908
7    0   0   0   0   0   0   0   0   0   0   7265
8    0   0   0   0   0   0   0   0   0   0   3296
9    0   0   0   0   0   0   0   0   0   0    493
10   0   0   0   0   0   0   0   0   0   0  12796
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 20
val acc:0.34227630496025085, best validation acc: 0.34227630496025085, corresponding to test acc:                         0.11516126990318298 / 0.11516126990318298
after epoch: 21,now: 2024-07-15 12:18:43.291781,epoch time: 0:34:53.364221,used: 11:52:50.401788,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 11:52:50.401788 at 2024-07-15 12:18:43.291781
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45454547}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_00_25_52_seed_1_21971818_instance_wise_predictions.txt
accuracy from prediction file 0.11516126775344575
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 322733 KiB |   1934 MiB |   1551 TiB |   1551 TiB |
|       from large pool | 291525 KiB |   1909 MiB |   1528 TiB |   1528 TiB |
|       from small pool |  31208 KiB |     47 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 322733 KiB |   1934 MiB |   1551 TiB |   1551 TiB |
|       from large pool | 291525 KiB |   1909 MiB |   1528 TiB |   1528 TiB |
|       from small pool |  31208 KiB |     47 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 316155 KiB |   1930 MiB |   1551 TiB |   1551 TiB |
|       from large pool | 286862 KiB |   1906 MiB |   1527 TiB |   1527 TiB |
|       from small pool |  29293 KiB |     45 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2198 MiB |   2198 MiB |   3888 MiB |   1690 MiB |
|       from large pool |   2148 MiB |   2148 MiB |   3824 MiB |   1676 MiB |
|       from small pool |     50 MiB |     50 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 199506 KiB | 275888 KiB |   1126 TiB |   1126 TiB |
|       from large pool | 189754 KiB | 271529 KiB |   1103 TiB |   1103 TiB |
|       from small pool |   9752 KiB |  25937 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6154    |    8136    |  277804 K  |  277798 K  |
|       from large pool |     130    |     276    |  147949 K  |  147949 K  |
|       from small pool |    6024    |    7964    |  129855 K  |  129849 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6154    |    8136    |  277804 K  |  277798 K  |
|       from large pool |     130    |     276    |  147949 K  |  147949 K  |
|       from small pool |    6024    |    7964    |  129855 K  |  129849 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     115    |     189    |      74    |
|       from large pool |      90    |      90    |     157    |      67    |
|       from small pool |      25    |      25    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      55    |    2324    |  153854 K  |  153854 K  |
|       from large pool |      25    |      91    |   92585 K  |   92585 K  |
|       from small pool |      30    |    2299    |   61269 K  |   61269 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1934 MiB |   1551 TiB |   1551 TiB |
|       from large pool |  16640 KiB |   1909 MiB |   1528 TiB |   1528 TiB |
|       from small pool |      0 KiB |     47 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1934 MiB |   1551 TiB |   1551 TiB |
|       from large pool |  16640 KiB |   1909 MiB |   1528 TiB |   1528 TiB |
|       from small pool |      0 KiB |     47 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1930 MiB |   1551 TiB |   1551 TiB |
|       from large pool |  16640 KiB |   1906 MiB |   1527 TiB |   1527 TiB |
|       from small pool |      0 KiB |     45 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 522240 KiB |   2198 MiB |   3888 MiB |   3378 MiB |
|       from large pool | 481280 KiB |   2148 MiB |   3824 MiB |   3354 MiB |
|       from small pool |  40960 KiB |     50 MiB |     64 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 275888 KiB |   1126 TiB |   1126 TiB |
|       from large pool |  24320 KiB | 271529 KiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |  32764 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8136    |  277804 K  |  277804 K  |
|       from large pool |       2    |     276    |  147949 K  |  147949 K  |
|       from small pool |       0    |    7964    |  129855 K  |  129855 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8136    |  277804 K  |  277804 K  |
|       from large pool |       2    |     276    |  147949 K  |  147949 K  |
|       from small pool |       0    |    7964    |  129855 K  |  129855 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     115    |     189    |     147    |
|       from large pool |      22    |      90    |     157    |     135    |
|       from small pool |      20    |      25    |      32    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2324    |  153857 K  |  153857 K  |
|       from large pool |       3    |      91    |   92585 K  |   92585 K  |
|       from small pool |       0    |    2299    |   61272 K  |   61272 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1934 MiB |   1551 TiB |   1551 TiB |
|       from large pool |  16640 KiB |   1909 MiB |   1528 TiB |   1528 TiB |
|       from small pool |      0 KiB |     47 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1934 MiB |   1551 TiB |   1551 TiB |
|       from large pool |  16640 KiB |   1909 MiB |   1528 TiB |   1528 TiB |
|       from small pool |      0 KiB |     47 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1930 MiB |   1551 TiB |   1551 TiB |
|       from large pool |  16640 KiB |   1906 MiB |   1527 TiB |   1527 TiB |
|       from small pool |      0 KiB |     45 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 522240 KiB |   2198 MiB |   3888 MiB |   3378 MiB |
|       from large pool | 481280 KiB |   2148 MiB |   3824 MiB |   3354 MiB |
|       from small pool |  40960 KiB |     50 MiB |     64 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 275888 KiB |   1126 TiB |   1126 TiB |
|       from large pool |  24320 KiB | 271529 KiB |   1103 TiB |   1103 TiB |
|       from small pool |      0 KiB |  32764 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8136    |  277804 K  |  277804 K  |
|       from large pool |       2    |     276    |  147949 K  |  147949 K  |
|       from small pool |       0    |    7964    |  129855 K  |  129855 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8136    |  277804 K  |  277804 K  |
|       from large pool |       2    |     276    |  147949 K  |  147949 K  |
|       from small pool |       0    |    7964    |  129855 K  |  129855 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     115    |     189    |     147    |
|       from large pool |      22    |      90    |     157    |     135    |
|       from small pool |      20    |      25    |      32    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2324    |  153857 K  |  153857 K  |
|       from large pool |       3    |      91    |   92585 K  |   92585 K  |
|       from small pool |       0    |    2299    |   61272 K  |   61272 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818

 Experiment start at: 2024-07-15 12:57:11.858918
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7838988, 'precision': 0.46899223, 'recall': 0.46808246, 'specificity': 0.97575456, 'f1': 0.41652286, 'auroc': 0.9632966}
confusion matrix:
     0     1   2     3   4    5   6     7   8   9      10
0   333     4   0     6   0    5   0    63   0   0     72
1     4  1143   2    11   0    2   0   166   0   0      4
2    10    50   1    31   0   43   0   117   1   1     58
3    12    18   2  7928   0   44   0   423   1   0     11
4     5    25   0    26   0   11   0   161   2   0    308
5     1     1   0   130   0  372   0    12   0   1      4
6   118   347   0    15   0    4   0  1394   0   0     29
7     5    15   4   294   0    2   0  6927   0   0     15
8    11    13   0    96   0    6   0  3097   2   0     71
9    12    33   1    49   0  314   0    50   1   3     30
10   53     1   0     6   0    4   0   139   0   0  12590
---- Validation: 
scalar performance:
{'acc': 0.7846463, 'precision': 0.4950921, 'recall': 0.4688517, 'specificity': 0.975815, 'f1': 0.4185159, 'auroc': 0.9627519}
confusion matrix:
     0     1   2     3   4    5   6     7   8   9      10
0   342     3   0     6   0    5   0    62   0   0     65
1     5  1144   2    15   0    0   0   160   0   0      6
2    13    59   2    37   0   35   0   109   0   0     57
3    10    25   1  7935   0   27   0   421   2   0     19
4     7    20   0    17   0    8   0   166   0   1    320
5     4     3   0   135   0  364   0    13   0   0      2
6    99   343   1    20   0    6   0  1406   0   1     32
7     4     8   1   291   0    1   0  6946   0   0     14
8    10    11   0    96   0    7   0  3104   2   0     66
9    14    45   1    51   0  314   0    40   0   2     26
10   56     1   0     9   0    3   0   130   0   0  12597
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33365983, 'precision': 0.293758, 'recall': 0.3582626, 'specificity': 0.9336978, 'f1': 0.24370292, 'auroc': 0.7627866}
confusion matrix:
     0    1   2    3   4    5   6     7   8   9     10
0   967    5   0   48   0   12   0   131   0   0     7
1    13  717   5   27   0    0   0   719   0   0    18
2   114  227   2   48   0   46   0   430   1   0   147
3     0    0   0    0   0    0   0     0   0   0     0
4    19   12   0    5   0    0   0    64   0   0  1533
5    25   19   0   61   0  478   0     8   0   0     1
6   250  779   1    2   0    0   0  1960   0   0    75
7     0    1   0  187   0    0   0   969   0   0     7
8    15   98   2   59   0    9   0  1175   0   0    12
9   135  374  12   71   0  329   0   194   0   1    21
10    1    3   0    0   0    0   0     7   0   0  1635
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-15 13:31:14.361661,epoch time: 0:34:02.502743,used: 0:34:02.502743,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.79395866, 'precision': 0.47008115, 'recall': 0.48661152, 'specificity': 0.9768679, 'f1': 0.43265218, 'auroc': 0.9634834}
confusion matrix:
     0     1   2     3   4    5   6     7   8   9      10
0   363     3   0    10   0    0   0    31   0   0     76
1     1  1217   0     7   0    0   0    97   0   0     10
2    18     4  66     9   0   31   0    35   2   0    147
3     3     3   0  7920   0   12   0   477   0   0     20
4     7     1   8     3   0   50   0    18   0   0    452
5    17     0   8   166   0  294   0    13   1   0     22
6    40   708  15    23   0    5   0  1023   3   0     91
7     0     9   0   140   0    4   0  7069   0   0     43
8    10     0   2    60   0  565   0  2431  15   0    212
9    61     6  49    40   0  186   1    28   0   0    122
10   15     3   0     7   0    7   0    29   1   0  12731
---- Validation: 
scalar performance:
{'acc': 0.7924034, 'precision': 0.59675205, 'recall': 0.48093498, 'specificity': 0.97668725, 'f1': 0.42889202, 'auroc': 0.9630823}
confusion matrix:
     0     1   2     3   4    5   6     7   8   9      10
0   348     5   0     7   0    3   0    42   0   0     78
1     0  1211   0    11   0    0   0   100   0   0     10
2    18     2  66     6   0   34   0    36   1   0    149
3     2     0   0  7914   0   15   0   487   2   0     20
4    10     0   9     3   0   35   0    11   0   0    471
5    18     0  10   171   0  280   1    15   0   0     26
6    44   704  12    25   0    3   1  1045   2   0     72
7     3     5   0   151   0    4   1  7048   0   0     53
8     7     0   1    58   0  553   0  2454  20   0    203
9    70     0  57    39   0  189   0    27   0   1    110
10   19     0   0     7   0    6   0    29   0   0  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33911705, 'precision': 0.22602811, 'recall': 0.3468388, 'specificity': 0.9340509, 'f1': 0.23608294, 'auroc': 0.74905777}
confusion matrix:
     0     1   2    3   4    5   6     7   8   9     10
0   880    29   1   57   0    1   0   185   0   0    17
1     2  1017   1   26   0    1   0   392   1   0    59
2   104     4  16    9   0   87   0   177   0   0   618
3     0     0   0    0   0    0   0     0   0   0     0
4     2     0   0    0   0    6   0     5   0   0  1620
5    66    13  10  137   0  317   1    26   2   0    20
6   281   745  30   48   0   24   1  1346  17   0   575
7     1     0   0  186   0    0   0   968   0   0     9
8     3     7   0   36   0  142   0  1094   2   0    86
9   232    25  48   92   0  187   3   311  14   0   225
10    0     0   0    0   0    0   0     0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-15 14:05:01.336175,epoch time: 0:33:46.974514,used: 1:07:49.477257,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.83435893, 'precision': 0.6965358, 'recall': 0.57122105, 'specificity': 0.9818126, 'f1': 0.5409154, 'auroc': 0.9820756}
confusion matrix:
     0     1   2     3   4     5   6     7     8    9      10
0   378     3   0     4   0     3   0    19     0    1     75
1     0  1282   0     8   0     3   0    34     1    0      4
2     3     2  64    16   1    15   0     4     0   28    179
3     6     2   0  8074   0   115   0   211    16    0     14
4     2     2   9     6   0    12   0     4     1   10    493
5     3     0   0    58   0   440   0     0     0   14      5
6    17    47  68    62   0     6  11  1645     0    2     50
7     2    36   2   151   0    16   0  6982    31    0     42
8     6     6   1   109   0  1666   0   181  1101    0    226
9     5     1  11    33   0   258   0     1     0  115     69
10    4     0   0    12   0    20   0    15     4    0  12738
---- Validation: 
scalar performance:
{'acc': 0.8342116, 'precision': 0.69137, 'recall': 0.5685684, 'specificity': 0.98177844, 'f1': 0.5367368, 'auroc': 0.982275}
confusion matrix:
     0     1   2     3   4     5   6     7     8    9      10
0   371     3   0     8   0     2   0    16     1    0     82
1     0  1285   0     7   0     0   0    38     1    0      1
2    10     1  65    19   0     9   0     6     0   34    168
3     4     3   1  8075   0   100   0   220    18    1     18
4     5     1   9     6   0    13   0     4     1    8    492
5     1     0   2    53   0   445   0     0     0   14      6
6    19    57  58    62   0     7   9  1640     3    0     53
7     1    37   5   141   0    19   0  6987    30    1     44
8     6     3   0   124   0  1661   0   182  1095    1    224
9     5     2  15    30   0   257   0     1     0  102     81
10    3     1   0    10   0    12   0    15     2    0  12753
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42230463, 'precision': 0.48285985, 'recall': 0.4359602, 'specificity': 0.9427275, 'f1': 0.35187715, 'auroc': 0.822689}
confusion matrix:
     0     1    2    3   4    5   6     7    8    9     10
0   812     7   14   94   0    9   1   210    2    1    20
1     0  1367    0   20   0    0   0   101    0    0    11
2     5     5    9   84   0   55   0    31    2   78   746
3     0     0    0    0   0    0   0     0    0    0     0
4     0     1    1    3   0    2   0     1    0    0  1625
5     7     0    0   60   0  446   0     0    0   76     3
6     5   584  113  417   0    2  97  1545    9    0   295
7     0     0    0   90   0    0   0  1068    0    1     5
8     0     4    3  139   0  550   2   124  278    6   264
9    14    13   21  219   0  211   1    18    0  313   327
10    0     0    0    0   0    0   0     0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-15 14:40:42.924705,epoch time: 0:35:41.588530,used: 1:43:31.065787,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8699165, 'precision': 0.78937954, 'recall': 0.5923714, 'specificity': 0.9850505, 'f1': 0.59122974, 'auroc': 0.9830815}
confusion matrix:
     0     1    2     3   4    5   6     7     8   9      10
0   204    67   45     9   0    0  18    74     5   0     60
1     0  1284    0     8   0    0   1    35     2   0      2
2     3     1  128     7   0    5   1     5     3   5    154
3     0    19    1  8181   0   27   0   110    69   0     32
4     0     3   48     5   5   10   2    12    10   1    443
5     0     3    5    48   0  421   1     4     3  17     19
6     0    14   44     3   0    0  39  1789     4   1     13
7     2    21    4   314   0    6   1  6831    46   0     37
8     0    18    5    90   0  134   0   286  2618   0    144
9     1     6   43    22   0  192   0     5     6  90    128
10    3     1   23    11   0    1   3    29    10   0  12713
---- Validation: 
scalar performance:
{'acc': 0.87032235, 'precision': 0.7656007, 'recall': 0.58895445, 'specificity': 0.98504126, 'f1': 0.5888417, 'auroc': 0.98297817}
confusion matrix:
     0     1    2     3   4    5   6     7     8   9      10
0   188    73   33    15   0    0  21    88     1   0     64
1     1  1286    1     8   1    0   1    29     3   0      2
2     0     5  128     5   0    3   1     9     6   6    149
3     0    19    4  8192   0   33   0   101    59   0     32
4     2     1   31     1   3   10   2    16    10   1    462
5     1     1    9    48   0  423   1     2     2  11     23
6     0    14   42     6   0    0  38  1783     6   0     19
7     1    19    9   295   0    2   2  6850    46   0     41
8     0    14    5    92   0  113   2   285  2633   0    152
9     0     5   47    19   0  187   3     5     6  84    137
10    4     6   13    13   0    8   4    26    10   0  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4027846, 'precision': 0.4714408, 'recall': 0.39694226, 'specificity': 0.94016147, 'f1': 0.3368441, 'auroc': 0.80817217}
confusion matrix:
     0     1    2    3   4    5    6     7    8   9     10
0   189   271  210   24   0    1  153   317    0   0     5
1     0  1360    2   15   0    0    0   115    0   0     7
2     0    37  329   30   0   14   59   131   33   9   373
3     0     0    0    0   0    0    0     0    0   0     0
4     0     2   23    0   0    1    4    30    5   0  1568
5     0    26   82   74   0  327   15    22    2  26    18
6     0   244   88   31   0    0  269  2400    0   0    35
7     0     0    3  152   0    0    0  1006    0   0     3
8     0    23   33   48   0   17   15   617  596   0    21
9     1    68  391   93   0  127   94   137   14  47   165
10    0     2    1    2   0    0    2     5    0   0  1634
better model found
persisted
after epoch: 4,now: 2024-07-15 15:14:44.360927,epoch time: 0:34:01.436222,used: 2:17:32.502009,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.87342143, 'precision': 0.7353304, 'recall': 0.6118716, 'specificity': 0.98499554, 'f1': 0.618876, 'auroc': 0.98642814}
confusion matrix:
     0     1   2     3   4    5   6     7     8    9      10
0   407     0   0     2   0    1   0    25     0    0     48
1     0  1276   1     6   1    0   0    41     3    0      4
2     1     0  19     0   0    2   0     3     0    9    278
3     4     0   0  7664   0   22   1   610    77    3     58
4     4     0   2     0   0    2   0     0     3    2    526
5     0     0   1    32   0  385   0     0     3   83     17
6     8     6   6     3   0    1   8  1829     4    2     40
7     0    21   1    36   0    0   0  7123    29    0     53
8     3     0   4    49   0   40   1   217  2833    0    149
9     1     0   9     6   0   82   0     0     1  188    206
10    5     0   0     6   0    2   0    16    18    2  12742
---- Validation: 
scalar performance:
{'acc': 0.87270296, 'precision': 0.8071538, 'recall': 0.6061333, 'specificity': 0.9849102, 'f1': 0.6125784, 'auroc': 0.98671067}
confusion matrix:
     0     1   2     3   4    5   6     7     8    9      10
0   400     0   0     2   0    0   0    28     2    1     50
1     0  1276   0     4   0    0   0    46     1    0      5
2     3     0  14     0   0    0   0     3     1    6    285
3     1     1   2  7668   0   26   2   610    73    1     56
4     3     0   2     0   1    4   0     1     5    6    517
5     1     0   1    31   0  376   0     0     3   92     17
6    10     2   3     5   0    0   6  1832     6    3     41
7     0    18   4    43   0    0   0  7119    29    1     51
8     4     0   3    43   0   44   1   217  2842    0    142
9     1     0   5     8   0   74   0     0     2  179    224
10    7     0   0     5   0    4   0    19    14    2  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48303366, 'precision': 0.54019284, 'recall': 0.49636433, 'specificity': 0.9481698, 'f1': 0.4245732, 'auroc': 0.8290246}
confusion matrix:
     0     1   2   3   4    5   6     7     8    9     10
0   959     3   0  13   0    3   0   182     3    1     6
1     1  1267   2  13   1    0   0   197     0    0    18
2     3     0  13   7   0   35   0    63    22   39   833
3     0     0   0   0   0    0   0     0     0    0     0
4     1     0   0   0   0    4   0     3     2    0  1623
5     8     0   0  74   0  415   0     6     5   76     8
6     1     2   2  13   1    1  22  2793    15    0   217
7     0     0   0   8   0    0   0  1153     0    1     2
8     0     0   0  25   0   17   0   128  1160    3    37
9    25     1  74  59   0  148   1    80    30  270   449
10    0     0   0   0   0    0   0     1     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-15 15:49:29.484165,epoch time: 0:34:45.123238,used: 2:52:17.625247,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8842305, 'precision': 0.8492522, 'recall': 0.617126, 'specificity': 0.98642564, 'f1': 0.6331786, 'auroc': 0.98899376}
confusion matrix:
     0     1   2     3   4    5   6     7     8    9      10
0   419     0   0    10   0    0   0    30     1    1     22
1     0  1252   0     8   0    0   1    68     2    0      1
2     2     0  58     3   0    1   0    17     1    9    221
3     0     9   0  8237   0    4   1   116    59    0     10
4     4     1  10     3   1    1   0    24     9    8    478
5     2     0   0    69   0  235   0     1     3  198     13
6     9     4   1     8   0    0  20  1839     3    3     19
7     0     6   0   176   0    0   1  7035    35    0     11
8     1     4   0   118   0    8   5   210  2848    0    102
9     5     0   6    23   0   24   0     9     2  262    162
10   25     0   0    13   0    1   0    39    33    1  12682
---- Validation: 
scalar performance:
{'acc': 0.88468635, 'precision': 0.86990213, 'recall': 0.61629146, 'specificity': 0.9864707, 'f1': 0.6320746, 'auroc': 0.98907906}
confusion matrix:
     0     1   2     3   4    5   6     7     8    9      10
0   419     0   0     8   0    0   0    26     2    1     27
1     0  1256   0     5   0    0   0    68     2    0      1
2     3     1  54     6   0    0   1     9     2   12    224
3     1     7   0  8243   0    3   0   116    59    1     10
4     3     0   6     2   1    0   0    18     8    7    494
5     3     0   0    73   0  223   0     1     2  208     11
6     8     0   1     8   0    0  27  1843     3    1     17
7     0     6   0   170   0    0   1  7048    29    0     11
8     1    13   1   118   0    5   1   206  2856    0     95
9     5     0   7    28   0   17   0    10     1  270    155
10   24     0   0    13   0    1   0    39    41    1  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44056532, 'precision': 0.560638, 'recall': 0.42936897, 'specificity': 0.9445708, 'f1': 0.39990008, 'auroc': 0.8186738}
confusion matrix:
     0    1    2    3   4    5    6     7     8    9     10
0   983    0    0   60   0    0    3   119     1    1     3
1     2  996    1   27   0    0    1   457     0    0    15
2    11    1  108   75   0    2   11   133    45   49   580
3     0    0    0    0   0    0    0     0     0    0     0
4     1    1    6    6   0    0    3    11     6    0  1599
5    10    1    0  230   0  147    4    11     4  182     3
6     1    0    4  130   0    0  164  2729     1    0    38
7     0    0    0  187   0    0    0   974     0    0     3
8     0    6    1   93   0    0   25   196  1034    0    15
9    13    1   62  349   0   26   11   188    21  257   209
10    0    0    1    1   0    0    3     6     1    0  1634
better model found
persisted
after epoch: 6,now: 2024-07-15 16:28:18.801611,epoch time: 0:38:49.317446,used: 3:31:06.942693,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92570096, 'precision': 0.875312, 'recall': 0.71171296, 'specificity': 0.9913312, 'f1': 0.7609217, 'auroc': 0.9911239}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   347     0   0    11    0    3    20    68     5    3     26
1     0  1267   0    12    0    0     2    51     0    0      0
2     0     0  63    23    4    1     4    16     3    6    192
3     1     2   1  8320    0    3     1    75    34    0      2
4     3     3  14     4  168    2     4    15    25    4    297
5     0     0   0    99    0  376     0     3     3   36      3
6     2     1   0     7    0    0  1412   476     4    1      5
7     0    11   1   205    1    0     1  7010    27    0      5
8     3    11   2   206    0    0    13   192  2843    0     26
9     0     1   5    40    0  128     2     7     3  189    118
10   12     7   4    21   30    1    17    53    43    1  12604
---- Validation: 
scalar performance:
{'acc': 0.9255316, 'precision': 0.8773837, 'recall': 0.7087744, 'specificity': 0.99128866, 'f1': 0.75910115, 'auroc': 0.9912049}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   335     1   0     9    0    5    14    89     1    1     28
1     0  1269   0    11    0    0     0    52     0    0      0
2     0     0  58    16    3    2     1    20     0   10    202
3     1     3   0  8329    0    6     1    67    32    0      1
4     5     3  14     7  171    1     1    12    23    2    300
5     0     1   0   106    0  370     1     3     4   33      3
6     2     3   0    10    0    0  1402   480     4    0      7
7     0    13   0   214    1    0     2  7009    22    0      4
8     2    14   6   209    0    1    13   175  2853    0     23
9     0     0   4    43    0  116     3     6     3  197    121
10   16    15   2    22   27    1    15    53    37    0  12608
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52109426, 'precision': 0.66346204, 'recall': 0.43587267, 'specificity': 0.9527016, 'f1': 0.44934195, 'auroc': 0.8139263}
confusion matrix:
     0     1   2    3    4    5     6     7    8    9     10
0   478    52   0  131    0   23   113   364    2    2     5
1     0  1202   0   34    0    0     2   257    0    0     4
2     1     6  94  125    7   12    93   186   79   32   380
3     0     0   0    0    0    0     0     0    0    0     0
4     0     6   7    3  280    0     6     9   10    0  1312
5     0     1   0  363    0  202     7     3    2   14     0
6     0     7   0   48    0    0  1807  1170    1    0    34
7     0     0   0  405    0    0     0   757    0    0     2
8     0     3   0  205    0    0   112   154  891    0     5
9     0    11  28  542    0  108    74   166   23  124    61
10    0     5   0    2   18    0     4     4    0    0  1613
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-15 17:02:35.423072,epoch time: 0:34:16.621461,used: 4:05:23.564154,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94207513, 'precision': 0.8945257, 'recall': 0.7658652, 'specificity': 0.9931574, 'f1': 0.78999317, 'auroc': 0.991275}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   408     0   0     6    0    0     0    15     0    1     53
1     0  1270   0     3    0    0     2    55     1    0      1
2     2     0  13     6   28    0     1     0     1   67    194
3     1     0   0  8313    0    9     4    90    12    2      6
4     4     0   1     1  244    1     1     8     3   16    260
5     0     0   0    46    0  331     0     0     2  138      4
6    15     1   0     7    1    0  1782    76     1    2     22
7     1     4   2   159    1    0     1  7054    20    0     21
8     4     0   0   327   11    2    30   155  2658    6    103
9     1     0   0    10    0   39     0     3     0  396     44
10    3     0   0     8   12    1     2    15     9    1  12742
---- Validation: 
scalar performance:
{'acc': 0.94318575, 'precision': 0.9058929, 'recall': 0.7665551, 'specificity': 0.99326706, 'f1': 0.7898333, 'auroc': 0.991496}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   404     0   0     6    1    0     1    16     0    0     55
1     0  1275   0     3    0    0     0    49     4    0      1
2     0     0   8     3   26    0     1     2     1   71    200
3     2     0   0  8338    0    7     1    76     9    1      6
4     2     0   0     0  245    0     1     7     4   15    265
5     0     0   0    43    0  333     0     2     0  141      2
6    14     0   0     5    1    0  1796    69     2    2     19
7     0     8   1   154    1    0     2  7062    20    1     16
8     2     3   0   334   13    3    27   144  2651    6    113
9     1     0   0     8    0   32     0     4     0  403     45
10    3     0   0     7    7    0     2    16    11    4  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6286294, 'precision': 0.60417944, 'recall': 0.5249047, 'specificity': 0.9629202, 'f1': 0.50218546, 'auroc': 0.82559085}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1083     0   0   17   0    2     1    47     1    3    16
1      1  1054   0   16   0    0     1   414     0    0    13
2      1     2   1   35  18    1     8   156    50   88   655
3      0     0   0    0   0    0     0     0     0    0     0
4      0     0   0    0  12    0     2     3     8    0  1608
5      7     0   0  173   0  161     0     7     3  238     3
6      1     0   0   39   0    0  2498   438     2    0    89
7      0     0   0   74   0    0     0  1087     0    0     3
8      0     1   0  170   0    0    54   113  1020    1    11
9      6     4   7  263   0   23     5   187    31  423   188
10     0     0   0    0   0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-15 17:35:55.757610,epoch time: 0:33:20.334538,used: 4:38:43.898692,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9474529, 'precision': 0.9068341, 'recall': 0.7614695, 'specificity': 0.99375194, 'f1': 0.7978586, 'auroc': 0.9937724}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   422     2   0     1    0    0    14    25     2    1     16
1     0  1277   0     3    0    0     0    46     5    0      1
2     4     0  74     7    2    0     3     8     5   12    197
3     1     1   0  8145    0    4     8   124   126    0     29
4     6     0  11     0  131    0     3     8    13    4    363
5     8     3   0    65    1  314     3     2     9  110      6
6     3     0   0     1    0    0  1878    13     3    0      8
7     0     9   0   112    0    0     1  7079    48    1     14
8     1     0   0    22    0    1     2   116  3091    0     61
9    15     0   6    16    0   41     0     7     5  298    105
10   21     0   0    10    3    0     7    23    27    0  12703
---- Validation: 
scalar performance:
{'acc': 0.94717133, 'precision': 0.90876126, 'recall': 0.7599568, 'specificity': 0.99372643, 'f1': 0.79849327, 'auroc': 0.9934101}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   414     3   0     1    0    0    16    28     1    0     20
1     0  1276   0     4    0    0     1    46     4    0      1
2     6     0  84     9    1    0     2     8     1   14    187
3     1     1   0  8137    0    4    15   133   118    1     30
4     5     0   7     1  135    0     3     9    16    7    356
5     6     1   0    74    0  307     1     2     7  115      8
6     7     0   0     0    0    0  1882     9     1    1      8
7     0     3   1   112    0    0     1  7095    42    1     10
8     1     0   1    23    1    1     1   129  3081    0     58
9    17     0   3    22    0   44     1     4     7  286    109
10   13     0   0     9    5    1    15    18    21    1  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.676555, 'precision': 0.64443743, 'recall': 0.56250495, 'specificity': 0.96745193, 'f1': 0.521621, 'auroc': 0.83673394}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1034     3   0    5   0    0    38    86     1    0     3
1      2  1248   0   14   0    0     1   220     2    0    12
2    124     0   5   15   6    5    16    75    91   29   649
3      0     0   0    0   0    0     0     0     0    0     0
4      4     0   0    0  23    0     4     1     6    0  1595
5     67     0   0  125   0  304     2     5    13   70     6
6      7     0   0    6   0    0  2917    70     5    0    62
7      1     0   0   84   0    0     0  1077     0    0     2
8      3     0   0   40   0    1     7    55  1229    1    34
9    214     6   8  142   0  117    17    98   108  190   237
10     0     0   0    0   0    0     2     1     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-15 18:09:02.988998,epoch time: 0:33:07.231388,used: 5:11:51.130080,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9527772, 'precision': 0.9084122, 'recall': 0.7858767, 'specificity': 0.9943948, 'f1': 0.8208652, 'auroc': 0.99336463}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    0     5    0    1     4    12     1    1     58
1     0  1283    0     5    0    0     2    34     7    0      1
2     2     0  100     3    5    0     1     4     0   31    166
3     0     0    0  8168    0   25     0   147    85    2      8
4     3     0    4     0  164    1     0     6     9    8    344
5     1     0    0    37    0  331     0     0     4  144      4
6     2     0    0     2    0    0  1843    32     3    6     19
7     2    11    2    69    1    0     2  7110    57    0     10
8     2     0    7    42    2    3     0    76  3093    3     68
9     3     0    9     7    0   42     0     0     0  366     66
10    2     0    1     9    3    0     4    11    11    1  12752
---- Validation: 
scalar performance:
{'acc': 0.9535643, 'precision': 0.91059434, 'recall': 0.7854687, 'specificity': 0.9944743, 'f1': 0.82061285, 'auroc': 0.9936645}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   400     0   0     2    0    0     2    21     2    1     55
1     0  1285   0     2    0    0     1    36     7    0      1
2     2     0  96     3    3    0     1     6     1   32    168
3     0     0   0  8189    0   21     1   129    93    2      5
4     2     0   3     0  160    1     0     6    10    5    352
5     0     0   0    33    1  333     0     0     5  145      4
6     7     0   0     4    0    0  1837    29     5    3     23
7     0    11   5    77    1    0     1  7104    55    0     11
8     1     0   5    34    2    3     1    67  3106    1     76
9     1     0  12     9    0   40     0     4     1  371     55
10    2     0   0     7    1    1     3     7     4    3  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6813825, 'precision': 0.653676, 'recall': 0.58078146, 'specificity': 0.9679483, 'f1': 0.54894006, 'auroc': 0.83844995}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1070     0   0   26   0    2     3    60     1    2     6
1      1  1213   0   16   0    1     4   251     1    0    12
2     25     0   5   24   1    3     0    73    98   84   702
3      0     0   0    0   0    0     0     0     0    0     0
4      0     0   0    0   4    0     2     1     4    0  1622
5     10     0   0   94   0  265     0     1     6  213     3
6      2     0   0    6   0    0  2615   278     6    0   160
7      0     0   0   40   0    0     0  1121     0    1     2
8      1     0   0   37   0    1     0    45  1265    3    18
9     40     1  22  120   0   56     0   110    62  536   190
10     0     0   0    0   0    0     0     1     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-15 18:43:00.047338,epoch time: 0:33:57.058340,used: 5:45:48.188420,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.954436, 'precision': 0.9062431, 'recall': 0.8186238, 'specificity': 0.9946258, 'f1': 0.85029423, 'auroc': 0.99464583}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     8    0    1     9    26     0    1     28
1     0  1266    0     6    0    0     0    55     3    0      2
2     3     0  128     3   20    3     1     6     1   42    105
3     2     1    1  8281    0   17     0    74    58    3      3
4     3     0    8     4  253    1     1     8     2    9    250
5     2     0    0    23    0  411     0     0     3   81      1
6     2     0    1     3    0    0  1871    17     0    1     13
7     0     5    2   141    1    1     2  7064    23    3     22
8     3     0    5    73   11    4     4   114  2896    2    183
9     3     0    9    11    1   71     0     4     2  359     33
10   12     0    0     9    9    1     8    13     2    1  12734
---- Validation: 
scalar performance:
{'acc': 0.9535375, 'precision': 0.9046778, 'recall': 0.8164825, 'specificity': 0.9945125, 'f1': 0.84856874, 'auroc': 0.99486434}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     8    0    0    11    27     0    2     26
1     0  1257    0     7    0    0     1    64     2    0      1
2     2     0  127     5   20    2     1    11     0   35    109
3     2     0    0  8271    2   19     0    90    51    1      4
4     3     0    7     0  245    1     1    11     3   11    257
5     3     0    1    25    1  410     0     0     2   78      1
6     5     0    1     7    0    0  1873    11     1    1      9
7     0     4    3   126    1    0     1  7087    22    3     18
8     2     0    6    81   10    2     3   138  2865    5    184
9     2     0    9     6    0   68     0     3     1  365     39
10   13     0    2    10   12    1     3    11     3    2  12739
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6623522, 'precision': 0.6378599, 'recall': 0.5602526, 'specificity': 0.96642953, 'f1': 0.54255426, 'auroc': 0.82497966}
confusion matrix:
      0     1   2    3   4    5     6    7     8    9     10
0   1060     0   0   43   0    0     5   46     1    1    14
1      0  1054   0   27   0    0     1  387     1    0    29
2     32     0  38   64  14   28     3   71    20   64   681
3      0     0   0    0   0    0     0    0     0    0     0
4      2     0   0    1  13    0     1    1     1    0  1614
5     33     0   0   94   1  378     0    3     5   76     2
6      1     0   0   99   0    0  2856   44     2    0    65
7      0     0   0  258   0    1     0  901     0    0     4
8      1     0   1   58   0    2     7   39  1160    2   100
9     65     0  59  261   0  165     0   57    42  362   126
10     0     0   0    0   0    0     0    1     0    0  1645
early stop counter: 1
val acc:0.9535375237464905, best validation acc: 0.9535642862319946, corresponding to test acc:                         0.6813824772834778 / 0.6813824772834778
after epoch: 11,now: 2024-07-15 19:16:42.623235,epoch time: 0:33:42.575897,used: 6:19:30.764317,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95194775, 'precision': 0.8626512, 'recall': 0.8380476, 'specificity': 0.9947156, 'f1': 0.8459054, 'auroc': 0.9948835}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    1     4    2    0     7    32     1    7     20
1     0  1297    0     3    0    0     0    26     5    0      0
2     0     0  222     1   25    0     2     1     1   19     41
3     1     2    4  8055    0   19     1   274    69    8      5
4     1     0   40     1  331    1     0     6     3    8    148
5     0     0    1    21    0  290     0     1     3  201      4
6     4     0    5     1    0    0  1858    27     3    1      9
7     1    15   21    36    2    0     3  7128    42    1     14
8     1     0   31    44   23    7     2   103  3002   11     70
9     0     0   41     4    0   24     1     0     1  348     74
10   12     1    4     7   96    1     4    20     5    4  12640
---- Validation: 
scalar performance:
{'acc': 0.9530293, 'precision': 0.87171555, 'recall': 0.8443949, 'specificity': 0.99478865, 'f1': 0.8536953, 'auroc': 0.99496126}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    2     5    2    0     0    33     0    5     22
1     0  1293    0     2    0    0     0    32     5    0      0
2     0     0  231     3   17    0     1     0     0   16     44
3     0     3    3  8069    0   25     0   241    86    8      5
4     1     1   32     1  326    0     1     6     1   10    160
5     0     0    1    19    0  303     0     0     4  190      4
6     6     0    2     1    2    0  1860    25     3    1      8
7     1    14   18    40    1    0     2  7131    41    1     16
8     2     0   27    44   21    3     3   102  3003   10     81
9     0     0   41     4    0   17     0     0     2  356     73
10   12     0    8     6   83    1     3    30     5    5  12643
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7202127, 'precision': 0.6833931, 'recall': 0.6050676, 'specificity': 0.9720401, 'f1': 0.6073054, 'auroc': 0.86387765}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   965     2    0   48    1    1     4   121    15    8     5
1     1  1176    0   13    0    0     1   299     2    0     7
2     1     0  246   24  143    4     2    58    65  109   363
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    3    0  232    0     2     5     3    1  1386
5     3     0    0   85    1  254     0     2     1  246     0
6     1     0    1   20    1    0  2967    51    12    0    14
7     0     0    0  116    0    0     0  1041     4    0     3
8     0     0    0   55    1    0     4    30  1248    6    26
9     4     0  198  139    3   51     9    53    32  533   115
10    0     0    0    0   11    0     0     3     0    0  1632
new oracle model saved
early stop counter: 2
val acc:0.9530292749404907, best validation acc: 0.9535642862319946, corresponding to test acc:                         0.6813824772834778 / 0.7202126979827881
after epoch: 12,now: 2024-07-15 19:49:48.786243,epoch time: 0:33:06.163008,used: 6:52:36.927325,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9618472, 'precision': 0.9131743, 'recall': 0.84122777, 'specificity': 0.9956163, 'f1': 0.8713604, 'auroc': 0.99565285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     4    2    0     1    19     3    1     28
1     0  1291    0     2    0    0     0    33     6    0      0
2     1     0  179     4   21    0     1     2     4   19     81
3     0     0    1  8223    0    4     0   122    84    0      3
4     2     0   11     1  303    1     0     2    15    2    202
5     0     0    0    42    1  408     0     0    10   57      2
6     3     0    0     3    1    0  1873    13     7    0      8
7     0     6    1   102    1    0     3  7066    67    1     15
8     1     0    5    32    3    0     0    46  3172    0     37
9     0     0   21    10    1   95     0     3     3  295     65
10    8     0    1     9   28    1     4    10    18    0  12715
---- Validation: 
scalar performance:
{'acc': 0.9622041, 'precision': 0.9141811, 'recall': 0.8440235, 'specificity': 0.995662, 'f1': 0.8732276, 'auroc': 0.9956138}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     1    2    0     1    18     4    1     20
1     0  1293    0     3    0    0     0    31     5    0      0
2     1     0  169     1   25    0     1     4     3   16     92
3     0     1    1  8221    1    4     0   118    92    0      2
4     2     0   11     1  310    1     1     3    16    3    191
5     0     0    1    38    1  410     0     0    11   58      2
6     4     0    0     1    1    0  1871    16     5    0     10
7     0     4    2   105    2    0     1  7066    67    1     17
8     0     0    4    36    1    0     1    39  3176    1     38
9     1     0   16     9    1   85     0     8     3  307     63
10   13     0    1     6   28    1     4    11    18    1  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6601833, 'precision': 0.6286355, 'recall': 0.5445605, 'specificity': 0.9660628, 'f1': 0.51309776, 'auroc': 0.8325998}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1010     0   0   36   0    1     6    75    34    1     7
1      0  1030   0   22   1    0     0   416    12    0    18
2      8     0  27   26  39    4     0    59   356   26   470
3      0     0   0    0   0    0     0     0     0    0     0
4      2     0   0    0  37    0     2     3    11    0  1578
5     13     0   0  259   0  213     1     1    29   74     2
6      0     0   0   39   0    0  2827    66    41    0    94
7      0     0   0   39   0    0     0  1118     3    0     4
8      0     0   0   47   0    0     3    10  1308    1     1
9     18     1  40  234   0   65     2   104   314  221   138
10     0     0   0    0   0    0     1     0     0    0  1645
better model found
persisted
after epoch: 13,now: 2024-07-15 20:23:37.319595,epoch time: 0:33:48.533352,used: 7:26:25.460677,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95208156, 'precision': 0.9079751, 'recall': 0.830928, 'specificity': 0.9945568, 'f1': 0.8539622, 'auroc': 0.99523705}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   408     0   0     6    2    0    16    22     6    0     23
1     0  1306   0     8    0    0     1    12     5    0      0
2     1     0  89     7    9    0     2     0     3   58    143
3     0     1   0  8359    0   12     2    18    43    0      3
4     3     0  12     2  360    0     1     8    15    6    132
5     1     0   0    33    0  378     0     2     4  101      2
6     1     1   0     3    1    0  1888     2     3    0      9
7     0    48   0   468    3    0    12  6571   138    3     20
8     0     2   1    91    4    1     3    19  3136    2     35
9     1     0   2    12    0   41     3     2     5  398     29
10    5     0   0    11   52    0     7     5    20    1  12692
---- Validation: 
scalar performance:
{'acc': 0.95104986, 'precision': 0.9119679, 'recall': 0.82895017, 'specificity': 0.9944156, 'f1': 0.8539362, 'auroc': 0.99536484}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   404     0   0     3    1    0    11    39     3    1     21
1     0  1312   0     9    0    0     1     6     4    0      0
2     1     0  94     9    5    0     2     3     7   47    144
3     1     2   0  8368    0    8     2    11    46    0      2
4     3     0   5     1  346    0     3     8    15    4    154
5     0     0   0    30    0  383     0     1     4  100      3
6     2     1   0     5    1    0  1880     4     5    2      8
7     2    52   1   504    3    0     9  6551   130    2     11
8     1     0   0    90    5    3     2    18  3136    1     40
9     3     0   3     9    0   41     2     6     6  393     30
10    9     0   0    10   56    0     5     7    19    2  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6438816, 'precision': 0.6709763, 'recall': 0.51199853, 'specificity': 0.96515226, 'f1': 0.52446115, 'auroc': 0.81880677}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   896     0   0   64    0    0    38  148    15    3     6
1     9  1254   0   49    0    0     4  162    11    0    10
2     4     0   7  120   35    4    10   19   283   47   486
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   1    0  345    0     3    2    17    0  1265
5     3     0   0  243    0  238     2    2     5   97     2
6     0     0   0   26    1    0  2970   12    13    0    45
7     0     0   0  799    0    0     9  338    12    0     6
8     0     0   0  137    0    0    10    0  1220    0     3
9    10     2   5  427    1   89    10   22   150  311   110
10    0     0   0    0   19    0     2    0     1    0  1624
early stop counter: 1
val acc:0.9510498642921448, best validation acc: 0.962204098701477, corresponding to test acc:                         0.660183310508728 / 0.7202126979827881
after epoch: 14,now: 2024-07-15 20:56:32.474630,epoch time: 0:32:55.155035,used: 7:59:20.615712,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9575396, 'precision': 0.9283774, 'recall': 0.8089773, 'specificity': 0.9950124, 'f1': 0.84833753, 'auroc': 0.99518025}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     1    0     3    1    0     9    25     1    0     26
1     0  1284    0     8    0    0    11    23     6    0      0
2     0     0  172     6    3    0     2     1     6    5    116
3     1     2    0  8326    0    4     0    47    54    0      3
4     2     1    7     9  237    0     0     4    12    0    267
5     0     0    0    46    0  252     0     1     8  203     11
6     6     1    1     9    0    0  1873     3     3    1     10
7     2    13    0   168    1    0     4  6985    81    0     11
8     0     1    2    64    1    0     1    26  3162    0     39
9     0     0   10    27    0    6     0     5     2  350     93
10    6     1    1    19    2    0     8    11    12    1  12731
---- Validation: 
scalar performance:
{'acc': 0.95701486, 'precision': 0.922405, 'recall': 0.80582416, 'specificity': 0.9949794, 'f1': 0.844099, 'auroc': 0.9954661}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     2    0     2    1    0     6    26     0    0     26
1     0  1281    0     8    0    0    12    27     3    0      1
2     0     0  170    10    9    0     2     3     6    6    106
3     1     1    0  8323    0    2     0    47    63    1      2
4     2     2    7     9  228    0     2     3    12    2    272
5     1     0    0    47    0  250     0     0     6  210      7
6     2     0    1     7    0    0  1879     7     4    2      6
7     1     9    1   177    2    0     3  6984    76    1     11
8     0     0    2    63    1    0     1    23  3172    0     34
9     0     0   12    35    0    9     0     3     5  343     86
10    7     0    2    19    3    0     8    12    16    1  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6545162, 'precision': 0.6725334, 'recall': 0.51607746, 'specificity': 0.9657209, 'f1': 0.48748046, 'auroc': 0.8357799}
confusion matrix:
      0     1   2    3   4   5     6    7     8    9     10
0   1035     0   0   17   0   0    18   87     2    3     8
1      1  1120   0   56   0   0    67  238     3    0    14
2      2     0  42  116   4   0     7   83   265   10   486
3      0     0   0    0   0   0     0    0     0    0     0
4      0     0   0    0  14   0     4    2    18    0  1595
5      6     0   0  279   0  42     3    8    14  223    17
6      1     0   0   20   0   0  3002   14    17    0    13
7      0     0   0  182   0   0     0  977     3    0     2
8      0     0   0   61   0   0     2    9  1294    0     4
9     12     1  40  503   0   3    16  100   156  185   121
10     0     0   0    0   0   0     2    0     0    0  1644
early stop counter: 2
val acc:0.9570148587226868, best validation acc: 0.962204098701477, corresponding to test acc:                         0.660183310508728 / 0.7202126979827881
after epoch: 15,now: 2024-07-15 21:30:54.574942,epoch time: 0:34:22.100312,used: 8:33:42.716024,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.95761985, 'precision': 0.9117487, 'recall': 0.84441394, 'specificity': 0.99521977, 'f1': 0.864711, 'auroc': 0.996524}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     3    0    1     2    15     1    2      6
1     0  1291    0     9    0    0     4    24     4    0      0
2     0     0  141     9    7    0     1     4     4   51     95
3     2     0    0  8272    0   11     3    30   111    5      5
4     4     1   16     0  294    0     0    10     8    6    199
5     0     0    0    19    0  333     0     3     7  156      3
6     3     0    1     3    1    0  1881     7     4    0      8
7     1     5    0   321    1    0     7  6824    95    2      7
8     3     0    0    25    8    0     4    30  3185    0     41
9     0     0    3     8    0   19     2     6     5  434     16
10   41     0    2    10   21    0     5    11    15    2  12684
---- Validation: 
scalar performance:
{'acc': 0.95827204, 'precision': 0.91183555, 'recall': 0.8424927, 'specificity': 0.99530995, 'f1': 0.8623574, 'auroc': 0.99611145}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     1    0    1     6    14     2    3      3
1     0  1291    0    11    1    0     0    24     5    0      0
2     0     0  128     7   10    0     3     3     6   63     92
3     3     0    0  8284    0   12     2    24   107    2      6
4     6     1   11     3  306    0     1     8     9    4    190
5     1     0    0    18    0  332     0     5     7  156      2
6     4     0    1     3    0    0  1887     6     3    0      4
7     3     7    0   302    2    0     3  6826   108    1     13
8     2     0    0    23    4    0     6    22  3193    0     46
9     0     0    5    10    2   19     2     5     3  431     16
10   37     0    1    11   19    0     7    10    15    2  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6684391, 'precision': 0.68236524, 'recall': 0.52806, 'specificity': 0.9670832, 'f1': 0.5187886, 'auroc': 0.83993185}
confusion matrix:
      0     1   2    3    4   5     6    7     8    9     10
0   1057     0   0   12    1   1    14   73     9    2     1
1      5  1251   0   44    0   0     6  183     6    0     4
2     15     0  93   88   43   1    39   89   169   60   418
3      0     0   0    0    0   0     0    0     0    0     0
4      6     1   1    2  123   0     7    8    10    0  1475
5      9     0   0   93    0  52     5   20    12  397     4
6      0     0   0    4    0   0  3031   16     3    0    13
7      1     0   0  592    0   0     1  563     3    0     4
8      0     0   0   52    0   0    38    6  1267    2     5
9     17     1  22  255    0   9    36   83   149  489    76
10     0     0   0    0   10   0     4    4     0    0  1628
early stop counter: 3
val acc:0.9582720398902893, best validation acc: 0.962204098701477, corresponding to test acc:                         0.660183310508728 / 0.7202126979827881
after epoch: 16,now: 2024-07-15 22:05:11.306943,epoch time: 0:34:16.732001,used: 9:07:59.448025,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9670109, 'precision': 0.9201657, 'recall': 0.865405, 'specificity': 0.9962858, 'f1': 0.88550496, 'auroc': 0.9972217}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     1    0    0     5    15     0    0     15
1     0  1307    0     2    0    0     0    21     2    0      0
2     0     0  215    18    6    0     1    10     5   25     32
3     5     2    0  8297    0   16     0    73    41    2      3
4     4     1   18     0  308    0     1     9     8    8    182
5     0     0    1    14    1  332     0     0     6  165      1
6     2     0    1     3    0    0  1878    13     2    2      7
7     0    10    0    88    1    0     1  7131    26    2      6
8     1     0    4    39    6    3     2   100  3093    3     44
9     0     0   16    24    0   21     0     8     0  409     14
10   17     0    4     7   10    0     3    15     7    2  12727
---- Validation: 
scalar performance:
{'acc': 0.9672061, 'precision': 0.9199238, 'recall': 0.8657842, 'specificity': 0.9962993, 'f1': 0.88614976, 'auroc': 0.9972278}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     0    0    0     4    14     1    2     14
1     0  1306    0     3    0    0     0    21     2    0      0
2     0     0  211    24    4    0     2    12     3   19     37
3     0     0    0  8292    0   23     0    78    39    4      4
4     4     0   25     1  314    1     1     8     3    7    175
5     0     0    0    12    0  337     0     3     6  162      1
6     3     0    1     1    0    0  1884     9     0    1      9
7     0    12    0    73    1    0     2  7143    27    1      6
8     3     1    4    38    4    3     3    94  3095    1     50
9     0     0   15    24    0   17     0     9     2  406     20
10   16     0    2     8   14    0    10    13     8    2  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72287136, 'precision': 0.70908076, 'recall': 0.59959626, 'specificity': 0.9721371, 'f1': 0.5831967, 'auroc': 0.8637848}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1012     0   0   21    0    1    10   110     7    3     6
1      1  1264   0   14    0    0     5   209     0    0     6
2     18     3  70   61   17    2    67   148   140  121   368
3      0     0   0    0    0    0     0     0     0    0     0
4      1     1   0    4  187    0    20    14    11    0  1395
5      8     0   0   56    0  202     0    14     4  307     1
6      0     0   0    8    0    0  3029    12     4    1    13
7      1     0   0   59    0    0     1  1098     0    1     4
8      0     0   0   74    0    4    36    41  1202    5     8
9     14     7  26  146    0   46     9   142    61  649    37
10     0     0   0    0   14    0    13     0     0    0  1619
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-15 22:39:11.497575,epoch time: 0:34:00.190632,used: 9:41:59.638657,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96222174, 'precision': 0.9363474, 'recall': 0.819054, 'specificity': 0.9956439, 'f1': 0.84911984, 'auroc': 0.9976265}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   448     0   0     2    0    0     2    17     1    2     11
1     0  1287   0     7    0    0     0    29     7    1      1
2     1     0  99     8    1    0     2     8    34   53    106
3     0     0   0  8325    0    1     0    28    83    1      0
4     4     0   3     4  214    0     1     3    21    7    282
5     0     0   0    44    0  334     0     3     9  128      3
6     4     0   0     2    0    0  1888     3     6    0      5
7     1     4   0   139    1    0     3  7023    85    1      6
8     0     0   1    22    0    0     2    33  3207    2     29
9     3     0   3    12    0   21     0     8     9  419     18
10   16     0   0    11    2    0     4    10    28    0  12720
---- Validation: 
scalar performance:
{'acc': 0.9622843, 'precision': 0.93605185, 'recall': 0.82150424, 'specificity': 0.9956459, 'f1': 0.8516524, 'auroc': 0.997302}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     2    0    0     3     8     3    0     12
1     0  1291    0     6    0    0     1    28     6    0      0
2     4     0  101     8    1    0     2    13    34   44    105
3     0     0    0  8315    0    1     0    32    91    0      1
4     3     0    6     2  225    0     1     5    27    7    263
5     0     0    0    53    0  328     0     6     7  124      3
6     6     0    0     0    0    0  1884     2     3    1     12
7     4     6    0   146    1    0     2  7026    74    0      6
8     1     0    0    23    0    0     2    26  3205    1     38
9     2     0    2    14    0   23     1     9     4  418     20
10   15     0    0     8    1    0     3    10    30    2  12727
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66857904, 'precision': 0.7037903, 'recall': 0.5355498, 'specificity': 0.9670533, 'f1': 0.50193214, 'auroc': 0.8582826}
confusion matrix:
      0     1   2    3   4   5     6    7     8    9     10
0   1072     0   0    6   0   0     5   71    14    0     2
1     14  1033   0   48   0   0     0  363    14    0    27
2     12     0   6   65   0   0     5   72   414   61   380
3      0     0   0    0   0   0     0    0     0    0     0
4      3     0   0    0   5   0     4    2    21    0  1598
5     17     0   0  197   0  73     1   25    18  260     1
6      0     0   0    5   0   0  3008   15    29    0    10
7      1     0   0  231   0   0     0  928     2    0     2
8      0     0   0   42   0   0     2   14  1306    3     3
9     24     1   3  286   0  11     7  109   171  482    43
10     0     0   0    0   0   0     1    0     2    0  1643
early stop counter: 1
val acc:0.9622843265533447, best validation acc: 0.9672061204910278, corresponding to test acc:                         0.7228713631629944 / 0.7228713631629944
after epoch: 18,now: 2024-07-15 23:12:34.868859,epoch time: 0:33:23.371284,used: 10:15:23.009941,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9665561, 'precision': 0.92295885, 'recall': 0.85838306, 'specificity': 0.9961904, 'f1': 0.88368237, 'auroc': 0.9966758}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     4    0    1     3    36     6    4     16
1     0  1283    0     8    0    0     0    39     2    0      0
2     1     0  207     6    8    0     1     5     8   24     52
3     0     0    0  8372    0   17     0    16    31    2      0
4     2     0   18     1  280    4     0     2    16    8    208
5     0     0    0    18    0  445     0     2     3   51      1
6     2     0    0     2    0    0  1874     7     9    4      9
7     0     5    1   173    1    0     1  7025    49    2      8
8     0     0    6    68    4    4     0    36  3159    0     18
9     0     0   17    10    0  101     0     2     3  340     20
10    6     0    2     7    7    1     4    11    25    1  12728
---- Validation: 
scalar performance:
{'acc': 0.9680353, 'precision': 0.9339558, 'recall': 0.8632568, 'specificity': 0.9963175, 'f1': 0.89054346, 'auroc': 0.99686193}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     5    1    0     1    29     6    5     14
1     0  1291    0     5    0    0     0    30     6    0      0
2     0     0  220     4    5    1     1     5     7   20     49
3     0     0    0  8379    0   14     0    14    32    0      1
4     0     0   16     1  275    2     0     8    21    8    208
5     0     0    0    18    0  447     0     1     3   50      2
6     0     0    1     1    0    0  1879     9     8    1      9
7     0     2    0   178    0    0     1  7034    42    0      8
8     0     0    2    61    3    4     1    39  3157    1     28
9     0     0   12     8    0  102     0     3     2  335     31
10    3     0    2     7    2    2     5    10    14    0  12751
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6749458, 'precision': 0.6756516, 'recall': 0.5662858, 'specificity': 0.96752495, 'f1': 0.53667104, 'auroc': 0.8321926}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   708     0   0   29   0    6    16  356    29   21     5
1     1  1106   0   45   0    0     1  295    21    0    30
2     0     0  42   30   5   17     1   43   339  107   431
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   1    0  40    0     3    3    11    1  1574
5     0     1   0   59   0  381     0    2     8  140     1
6     0     0   0    7   0    0  2970   13    40    0    37
7     0     0   0  167   0    0     0  987     8    0     2
8     0     0   0   56   0    2     2    4  1302    0     4
9     0     0  21  127   0  211     1   50   188  469    70
10    0     0   0    0   1    0     2    1     0    0  1642
better model found
persisted
after epoch: 19,now: 2024-07-15 23:46:16.939650,epoch time: 0:33:42.070791,used: 10:49:05.080732,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9630779, 'precision': 0.9258222, 'recall': 0.8388752, 'specificity': 0.99568605, 'f1': 0.86958915, 'auroc': 0.99777067}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     2    1    0     1    21     5    3     24
1     0  1253    0     3    0    0     0    69     6    0      0
2     0     0  175     2    1    0     1     3     6   36     87
3     0     0    0  8297    0    6     0    90    38    3      5
4     2     1   20     1  227    0     0     5     6   10    267
5     0     0    0    33    0  439     0     0     3   44      2
6     1     0    0     9    0    0  1876     6     4    2     10
7     1     3    1    77    1    0     2  7102    56    3     17
8     1     0    4    85    2    1     0    37  3117    0     49
9     0     0    5     7    0  113     0     2     2  341     23
10    9     1    2     9    4    0     2     5    16    1  12743
---- Validation: 
scalar performance:
{'acc': 0.9635683, 'precision': 0.92529696, 'recall': 0.8331844, 'specificity': 0.99574983, 'f1': 0.86556387, 'auroc': 0.9977748}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0     4    1    0     3    23     7    0     21
1     0  1255    0     4    0    0     0    68     5    0      0
2     0     0  162     1    1    0     1     1     8   34    104
3     0     0    0  8309    0    7     0    82    40    0      2
4     2     0   19     0  235    0     0     1    10    9    263
5     0     0    0    32    0  440     0     0     4   43      2
6     1     0    0     7    1    0  1865    12     7    2     13
7     1     2    2    62    1    0     1  7126    54    1     15
8     0     0    1    76    3    1     1    35  3134    1     44
9     0     0    4     2    0  135     0     2     2  323     25
10    6     0    2     9    3    0     5     2    18    1  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64891905, 'precision': 0.65818787, 'recall': 0.53890824, 'specificity': 0.9649321, 'f1': 0.51558834, 'auroc': 0.8427213}
confusion matrix:
     0    1   2    3   4    5     6     7     8    9     10
0   853    0   0   34   0    2    16   196    52    5    12
1     1  691   0   45   0    0     4   745     3    0    10
2     0    0  49   36   9    7     9    65   119   86   635
3     0    0   0    0   0    0     0     0     0    0     0
4     0    0   0    2  12    0     5     3     9    0  1602
5     2    0   0  199   0  252     0     7     2  125     5
6     0    0   0   62   0    0  2926    15    12    0    52
7     0    0   0    4   0    0     0  1157     1    0     2
8     0    0   0  126   0    1     4    34  1195    1     9
9     1    1  28  143   0  123     2   110    90  501   138
10    0    0   0    3   0    0     2     0     2    0  1639
early stop counter: 1
val acc:0.9635682702064514, best validation acc: 0.9680352807044983, corresponding to test acc:                         0.6749457716941833 / 0.7228713631629944
after epoch: 20,now: 2024-07-16 00:20:19.883292,epoch time: 0:34:02.943642,used: 11:23:08.024374,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96281034, 'precision': 0.93346894, 'recall': 0.8194387, 'specificity': 0.99570894, 'f1': 0.85355496, 'auroc': 0.9973596}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   353     0   0     9    0    0     9    67     3    8     34
1     0  1287   0     3    1    0     0    38     3    0      0
2     0     0  94     4   16    0     1    13    16   49    119
3     0     0   0  8382    1    7     0    19    28    0      1
4     1     0   3     3  319    0     1     9    18    8    177
5     0     0   0    21    0  340     0     4     7  146      2
6     0     0   0     3    0    0  1888     5     3    1      8
7     0     7   1   187    1    0     1  7017    35    0     14
8     0     0   0    82    4    2     2    54  3123    0     28
9     0     0   3     5    0   25     0    12     2  432     14
10    0     0   0     9    6    0     4     8    12    3  12751
---- Validation: 
scalar performance:
{'acc': 0.96217734, 'precision': 0.9388809, 'recall': 0.8202238, 'specificity': 0.9955845, 'f1': 0.8577327, 'auroc': 0.9971982}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   347     0    0    12    0    0     5    67     2    9     41
1     0  1288    0     3    0    0     0    37     3    0      1
2     0     0  105     3    9    0     1    15    16   39    124
3     0     0    0  8394    1    3     0    25    16    1      0
4     0     0    4     1  317    0     0     5    14    8    190
5     0     0    0    26    0  345     0     1     7  140      2
6     0     0    0     4    0    0  1880     7     6    1     10
7     0     9    0   195    2    0     2  7018    23    0     16
8     0     0    0   101    3    0     0    60  3097    1     34
9     0     0    2     7    0   27     0    15     1  428     13
10    0     0    0    10    8    0     4     7    14    1  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6298888, 'precision': 0.64038473, 'recall': 0.49694014, 'specificity': 0.9628855, 'f1': 0.46886313, 'auroc': 0.8275026}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   213     0   0  126    0    0   149   510    28  117    27
1     1  1147   0   39    0    0     2   275     2    0    33
2     0     0   7   23   58    0     8    82   213   58   566
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  100    0     2     1     4    1  1525
5     0     0   0  134    1  156     2    10    15  273     1
6     0     0   0    8    0    0  2983     2     5    0    69
7     0     0   0  131    0    0     0  1026     4    0     3
8     0     0   0   90    1    0    13    15  1232    2    17
9     0     0   7  152    1   33     9   191   146  495   103
10    0     0   0    0    2    0     0     0     0    0  1644
early stop counter: 2
val acc:0.9621773362159729, best validation acc: 0.9680352807044983, corresponding to test acc:                         0.6749457716941833 / 0.7228713631629944
after epoch: 21,now: 2024-07-16 00:55:02.801802,epoch time: 0:34:42.918510,used: 11:57:50.942884,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9632652, 'precision': 0.93698776, 'recall': 0.8100591, 'specificity': 0.9958611, 'f1': 0.844051, 'auroc': 0.99802494}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   328     0   0     2    0    0    10   123     2    3     15
1     0  1300   0     9    0    0     0    22     0    0      1
2     0     0  93    10    6    0     2    18    61   63     59
3     0     0   0  8305    0    7     0    74    51    1      1
4     2     0   1     4  273    0     5    15    17    6    216
5     0     0   0    29    0  327     0     1     5  158      1
6     0     0   0     5    0    0  1884    12     5    1      1
7     0     9   0    64    2    0     3  7128    46    2      8
8     0     0   0    51    1    2     3    28  3193    1     17
9     0     0   0    14    1   14     1     6     5  447      5
10   10     0   1     9    5    0     6    19    16    0  12725
---- Validation: 
scalar performance:
{'acc': 0.96445096, 'precision': 0.9355266, 'recall': 0.81438893, 'specificity': 0.9959916, 'f1': 0.84740305, 'auroc': 0.9978929}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   344     0    0     1    0    0    12   111     2    3     10
1     0  1300    0     3    0    0     0    28     1    0      0
2     1     0  101    11    8    0     3    13    47   63     65
3     0     0    0  8309    0   11     0    71    48    1      0
4     1     0    0     1  266    0     1    15    24    8    223
5     0     0    0    32    0  323     0     2     4  159      1
6     0     0    0     4    0    0  1890     5     3    2      4
7     0     8    0    51    1    0     2  7149    45    2      7
8     0     0    0    51    1    2     1    33  3190    0     18
9     0     0    3    11    1   17     1     3     4  449      4
10    9     0    0    10    4    0     6    14    16    2  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.615756, 'precision': 0.68755627, 'recall': 0.47376496, 'specificity': 0.96197015, 'f1': 0.4490478, 'auroc': 0.83911914}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   490     0   0   42   0   0    61  542    33    0     2
1     0  1103   0   38   0   1     4  332     2    0    19
2     3     0   7  152   2   0    40   96   264   26   425
3     0     0   0    0   0   0     0    0     0    0     0
4     0     0   0    1   6   0     8    8    17    0  1593
5     0     0   0  347   0  58     3   22     6  155     1
6     0     0   0    3   0   0  3040   15     3    0     6
7     0     0   0  178   0   0     0  981     3    0     2
8     0     0   0  112   0   0    32   17  1205    0     4
9     1     0   2  534   0   7    11  108   150  271    53
10    0     0   0    0   0   0     4    2     0    0  1640
early stop counter: 3
val acc:0.9644509553909302, best validation acc: 0.9680352807044983, corresponding to test acc:                         0.6749457716941833 / 0.7228713631629944
after epoch: 22,now: 2024-07-16 01:29:23.148194,epoch time: 0:34:20.346392,used: 12:32:11.289276,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9669039, 'precision': 0.9401723, 'recall': 0.8353976, 'specificity': 0.99622256, 'f1': 0.8768661, 'auroc': 0.9978294}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   293     0    0     1    2    0    11   101    32    5     38
1     0  1308    0     1    0    0     0    19     2    0      0
2     0     0  214     9    3    0     4     5    44    2     31
3     0     2    0  8324    0    2     0    67    41    1      1
4     0     0   11     2  342    0     2     6    35    0    141
5     0     0    0    35    1  342     2     5     9  125      2
6     0     0    1     0    0    0  1890     8     4    0      5
7     0    13    0    52    1    0     1  7163    25    0      8
8     0     0    1    24    5    0     1    53  3174    0     37
9     0     0    8    14    0   17     0    13    17  345     79
10    0     0    1     8   10    0     8    11    12    0  12744
---- Validation: 
scalar performance:
{'acc': 0.9652267, 'precision': 0.9317834, 'recall': 0.8256229, 'specificity': 0.9960557, 'f1': 0.8671142, 'auroc': 0.9980296}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   287     0    0     4    1    0     7   109    35    0     40
1     0  1308    0     1    0    0     0    21     1    1      0
2     0     0  208     8    3    0     7     4    53    4     25
3     0     1    0  8327    0    2     1    59    47    2      1
4     1     0   14     3  333    0     3    10    24    1    150
5     0     0    0    36    0  331     0     3     9  139      3
6     0     0    1     1    0    0  1894     5     4    0      3
7     0    21    2    61    1    0     1  7146    26    0      7
8     0     1    1    25    3    0     2    57  3184    0     23
9     0     0    8    12    0   26     2    18    15  326     86
10    0     0    3    11   10    0     8    11    12    0  12741
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6005737, 'precision': 0.65119475, 'recall': 0.45143813, 'specificity': 0.9599547, 'f1': 0.41125482, 'auroc': 0.8335921}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   160     0   0   72   0   0   181  568   140   27    22
1     0  1208   0   19   0   0     2  259     2    0     9
2     0     0  31   54  41   0    23   46   325   16   479
3     0     0   0    0   0   0     0    0     0    0     0
4     0     0   1    3  70   0     3    2     9    0  1545
5     0     0   0  224   0  26    12   11    24  281    14
6     0     0   0    3   0   0  3043    3     5    0    13
7     0     0   0  230   0   0     0  928     3    0     3
8     0     0   0  111   0   0    32   12  1204    2     9
9     0     2  11  233   0   1    54  131   271  275   159
10    0     0   0    1   3   0     3    0     0    0  1639
early stop counter: 4
val acc:0.9652267098426819, best validation acc: 0.9680352807044983, corresponding to test acc:                         0.6749457716941833 / 0.7228713631629944
after epoch: 23,now: 2024-07-16 02:03:27.018220,epoch time: 0:34:03.870026,used: 13:06:15.159302,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9662885, 'precision': 0.93022144, 'recall': 0.8433115, 'specificity': 0.9962234, 'f1': 0.8649453, 'auroc': 0.99797165}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     2    2    0     0    17    14    7     22
1     0  1315    0     0    0    0     0    11     5    0      0
2     0     0  105     0   17    0     1     4    50   44     91
3     0     2    0  8316    0   10     1    82    25    2      1
4     1     0    1     1  370    0     0    13    12    4    136
5     0     0    0    16    0  300     0     0     8  195      1
6     3     0    0     1    1    0  1861    17    14    3      6
7     0    26    1    50    2    0     1  7127    39    3     15
8     0     1    0    74    6    3     0    25  3131    3     52
9     0     0    1     1    2    5     0     3     2  460     19
10   15     0    0     6   23    0     7    20    11    1  12712
---- Validation: 
scalar performance:
{'acc': 0.9658419, 'precision': 0.92918193, 'recall': 0.8462315, 'specificity': 0.996145, 'f1': 0.8680749, 'auroc': 0.9979192}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     0    0     0    1    0     1    19    15    8     24
1     0  1311    0     2    0    0     0    15     4    0      0
2     0     0  110     0   11    1     0     1    36   41    112
3     0     1    0  8318    0   12     0    82    21    3      3
4     1     0    1     1  370    0     0    11    11    7    137
5     0     0    0    10    0  314     0     1     3  190      3
6     2     0    0     2    1    0  1861    20     9    2     11
7     0    23    2    59    1    0     4  7117    41    3     15
8     1     0    0    72    6    2     0    39  3120    4     52
9     0     0    3     1    1    9     0     3     0  465     11
10   11     0    0     5   27    0     9    22    12    3  12707
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65969354, 'precision': 0.6877081, 'recall': 0.5340852, 'specificity': 0.96594536, 'f1': 0.5099388, 'auroc': 0.8392341}
confusion matrix:
     0     1   2    3    4   5     6    7     8    9     10
0   765     1   0   23    0   1    17  188    78   79    18
1    28  1063   0   17    0   1     1  372     2    4    11
2     0     0   8   13   49   1     0   32   249  118   545
3     0     0   0    0    0   0     0    0     0    0     0
4     0     0   0    1  155   0     2    5    14    0  1456
5     0     0   0   57    0  87     1    5     9  423    10
6     5     0   0   31    0   0  2806  138    56    0    31
7     0     0   0  229    0   0     0  930     3    1     1
8     0     0   0   99    1   1     3   12  1239    7     8
9     1     0   1   70    0  21     2   50    84  737   171
10    0     0   0    0    4   0     2    1     0    0  1639
early stop counter: 5
val acc:0.9658418893814087, best validation acc: 0.9680352807044983, corresponding to test acc:                         0.6749457716941833 / 0.7228713631629944
after epoch: 24,now: 2024-07-16 02:37:35.857322,epoch time: 0:34:08.839102,used: 13:40:23.998404,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9639608, 'precision': 0.9371475, 'recall': 0.8295409, 'specificity': 0.99589026, 'f1': 0.86537063, 'auroc': 0.9965803}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     0    2    0     0    12     4    1     32
1     0  1261    0    11    0    0     0    56     4    0      0
2     0     0  119     5   28    0     2     6    80    7     65
3     0     0    0  8215    0    2     0   143    75    2      2
4     2     0    2     0  338    1     0     1    28    0    167
5     0     0    0    24    0  312     0     3    11  169      1
6     3     0    0     3    2    0  1784    39    21    0     53
7     0     6    0    24    1    0     2  7180    43    0      8
8     1     0    1     9    2    1     0    30  3238    0     13
9     0     0    3     4    1    4     0    15     9  393     64
10    1     0    0     4    9    0     1     9    13    0  12757
---- Validation: 
scalar performance:
{'acc': 0.96399623, 'precision': 0.9360562, 'recall': 0.82637906, 'specificity': 0.99592423, 'f1': 0.86098397, 'auroc': 0.99678314}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     1    1    0     0    12     2    0     32
1     0  1261    0    16    0    0     0    52     3    0      0
2     0     0  105     5   21    0     1     8    97   10     65
3     0     0    0  8232    0    4     0   123    80    0      1
4     3     0    1     0  342    1     0     3    32    0    157
5     0     0    0    22    0  310     0     1    10  177      1
6     3     1    0     2    2    0  1801    44    21    1     33
7     0     6    0    26    1    0     1  7178    48    0      5
8     0     0    0    20    3    0     0    30  3220    0     23
9     0     0    3     5    0   11     0    17     7  392     58
10    1     0    1     5    7    0     1     5    13    0  12763
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5681802, 'precision': 0.67495376, 'recall': 0.47710788, 'specificity': 0.9569841, 'f1': 0.43611786, 'auroc': 0.8000381}
confusion matrix:
     0     1   2    3   4   5     6     7     8    9     10
0   994     0   0   31   0   0     1   107    27    1     9
1     0  1026   0   46   0   0     0   410     5    0    12
2     5     0   3   43   5   0     0    96   318   14   531
3     0     0   0    0   0   0     0     0     0    0     0
4     1     0   0    0   9   0     0     2    19    0  1602
5    11     0   0  251   0  62     0    21    20  189    38
6     6     0   0   67   0   0  1889   592   253    0   260
7     0     0   0  126   0   0     0  1032     2    0     4
8     0     0   0  100   0   0     0    25  1241    0     4
9    12     1   0  268   0   6     0   174   223  219   234
10    0     0   0    0   0   0     0     0     0    0  1646
early stop counter: 6
val acc:0.9639962315559387, best validation acc: 0.9680352807044983, corresponding to test acc:                         0.6749457716941833 / 0.7228713631629944
after epoch: 25,now: 2024-07-16 03:11:50.323711,epoch time: 0:34:14.466389,used: 14:14:38.464793,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97067636, 'precision': 0.94190705, 'recall': 0.8607073, 'specificity': 0.9967336, 'f1': 0.8865259, 'auroc': 0.998065}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     1    0     1    0    0     3    11     3    2      9
1     0  1289    0     6    0    0     2    33     1    0      0
2     4     0  139     3    4    0     1    10    60   26     65
3     0     0    0  8336    0    7     2    28    65    1      0
4     3     0    2     3  351    0     1    16    25    2    136
5     0     0    0    19    0  337     0     3    12  148      1
6     5     1    0     0    0    0  1891     4     5    1      1
7     0     8    0    93    1    0     4  7126    28    0      5
8     2     0    0    13    3    0     3    48  3203    0     22
9     1     0    2     9    0   15     0    10     2  439     15
10   15     0    1    10    7    0    16    15    12    0  12716
---- Validation: 
scalar performance:
{'acc': 0.97068346, 'precision': 0.9413041, 'recall': 0.86009574, 'specificity': 0.9967335, 'f1': 0.8866877, 'auroc': 0.99830353}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     1    0     0    0    0     3    15     4    1      7
1     0  1292    0     8    0    0     0    31     1    0      0
2     1     0  146     6    7    0     4     6    60   27     55
3     0     0    0  8342    0    2     0    29    65    1      1
4     1     1    3     4  340    1     1    22    24    4    138
5     1     0    0    21    0  336     0     2    12  148      1
6     4     0    0     2    0    0  1886     5     7    1      3
7     0     5    0    92    1    0     4  7139    19    0      5
8     3     0    0    17    3    0     3    54  3195    1     20
9     0     0    3     3    0   16     1     9     5  438     18
10   14     0    1    11    9    0    10    14    13    1  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6580844, 'precision': 0.69216037, 'recall': 0.5246309, 'specificity': 0.96596026, 'f1': 0.49119937, 'auroc': 0.8285554}
confusion matrix:
      0     1   2    3   4   5     6    7     8    9     10
0   1007     0   0   21   0   0    14   85    35    1     7
1      0  1024   0   40   0   0     2  419     3    1    10
2     33     0   1   54  16   0     7  109   396   48   351
3      0     0   0    0   0   0     0    0     0    0     0
4      3     0   0    0  36   0     6    6    16    0  1566
5     33     0   0  194   0  89     0   26    37  211     2
6      3     0   0    8   0   0  3005   21    19    0    11
7      0     0   0  224   0   0     0  934     3    0     3
8      0     0   0   48   0   0     2   24  1294    0     2
9     37     2   0  211   0  16     3  195   242  376    55
10     0     0   0    1   0   0     3    2     0    0  1640
better model found
persisted
after epoch: 26,now: 2024-07-16 03:45:54.749269,epoch time: 0:34:04.425558,used: 14:48:42.890351,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9652986, 'precision': 0.9298754, 'recall': 0.82651657, 'specificity': 0.9961172, 'f1': 0.8358972, 'auroc': 0.99810517}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   416     0   0     0    2    0     2    18    16    1     28
1     0  1292   0     5    0    0     0    29     6    0      0
2     0     0  15     1   20    0     1     3    74    6    192
3     0     0   0  8286    1    4     2    73    71    2      0
4     0     0   0     0  472    0     0     3    18    1     45
5     0     0   0    26    4  352     0     2    12  123      2
6     0     0   0     1    2    0  1879     4    10    0     10
7     0     9   0    54    1    0     2  7153    37    1      7
8     0     0   0    10   11    0     1    27  3227    0     18
9     0     0   0     3   11   21     1    22     6  366     63
10    2     0   0     6  123    1     4    10    26    0  12621
---- Validation: 
scalar performance:
{'acc': 0.96661764, 'precision': 0.9325758, 'recall': 0.8276622, 'specificity': 0.996282, 'f1': 0.8388988, 'auroc': 0.9983174}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   414     0   0     2    4    0     1    21    16    1     24
1     0  1287   0     7    0    0     1    32     5    0      0
2     0     0  19     0   22    0     1     2    83   10    175
3     0     0   0  8284    1    2     1    82    66    1      3
4     0     0   0     0  479    0     0     1    24    1     34
5     0     0   0    25    4  341     1     4    12  132      2
6     0     0   0     0    1    0  1894     3     4    0      6
7     0     5   0    46    1    0     1  7158    45    1      8
8     1     0   0    12    9    0     0    27  3236    0     11
9     0     0   0     4   10   19     0    20     8  368     64
10    1     0   0     8  100    0     4     7    19    0  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6751557, 'precision': 0.6085434, 'recall': 0.53700227, 'specificity': 0.9677499, 'f1': 0.5304648, 'auroc': 0.84327096}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   749     0   0   57    0    3    54  204    84   13     6
1     0  1107   0   44    0    0     1  319    14    0    14
2     0     0   0   25   84    1     7   55   555   39   249
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   0    1  519    0     4    3    42    0  1063
5     0     0   0  259    0  160     3   17    35  117     1
6     0     0   0    5    0    0  3027    9    15    0    11
7     0     0   0  242    0    0     1  916     3    0     2
8     0     0   0   63    0    0     3    9  1295    0     0
9     1     0   0  205    1   69    10  134   348  297    72
10    0     0   0    0   59    0     2    2     3    0  1580
early stop counter: 1
val acc:0.9666176438331604, best validation acc: 0.9706834554672241, corresponding to test acc:                         0.6580843925476074 / 0.7228713631629944
after epoch: 27,now: 2024-07-16 04:20:13.591775,epoch time: 0:34:18.842506,used: 15:23:01.732857,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.94636714, 'recall': 0.82128966, 'specificity': 0.99632895, 'f1': 0.8378704, 'auroc': 0.9984779}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   428     0   0     2    0    0     4    16    13    2     18
1     0  1293   0     2    0    0     0    33     4    0      0
2     0     0  15     0    3    0     1     2   161   53     77
3     0     0   0  8268    0    6     1   101    58    2      2
4     1     0   0     1  303    1     0     4    26    4    199
5     0     0   0    21    0  390     0     1     6  102      1
6     0     0   0     1    0    0  1881     7     9    1      9
7     0     4   0    28    1    0     4  7163    49    0     13
8     0     0   0    14    3    0     1    22  3226    2     27
9     0     0   0     6    0   31     0     3     3  439     11
10    7     0   0     4    5    0     3     9    10    1  12754
---- Validation: 
scalar performance:
{'acc': 0.968276, 'precision': 0.9504483, 'recall': 0.82737625, 'specificity': 0.9963809, 'f1': 0.8441893, 'auroc': 0.99863005}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   441     0   0     1    0    0     1    12     6    1     21
1     0  1290   0     2    0    0     0    35     4    0      1
2     0     0  18     1    1    0     1     4   146   53     88
3     0     0   0  8269    0    5     3   104    56    2      1
4     1     0   0     1  305    1     0     4    17    7    203
5     0     0   0    21    0  398     0     1     6   94      1
6     0     0   0     2    0    0  1887     3     7    1      8
7     0     4   0    31    2    0     1  7167    49    2      9
8     0     0   0    15    3    1     0    27  3221    0     29
9     0     0   0     2    0   24     0     3     1  445     18
10    6     0   0     7    4    0     4     7     9    1  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.645141, 'precision': 0.6033313, 'recall': 0.520159, 'specificity': 0.96423584, 'f1': 0.48455852, 'auroc': 0.8326623}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   431     0   0   63   0    0    95   255   222   60    44
1     1  1057   0   24   0    0     1   383    11    1    21
2     0     0   0   14   5    0     2    28   280   77   609
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  13    0     3     1    12    0  1604
5     1     0   0  118   0  163     3     3    19  278     7
6     0     0   0   11   0    0  2923    27    36    0    70
7     0     0   0   35   0    0     1  1122     4    0     2
8     0     0   0   49   0    0     4    13  1297    3     4
9     0     1   0   79   0   48     4    90   175  572   168
10    0     0   0    0   0    0     0     0     3    0  1643
early stop counter: 2
val acc:0.9682760238647461, best validation acc: 0.9706834554672241, corresponding to test acc:                         0.6580843925476074 / 0.7228713631629944
after epoch: 28,now: 2024-07-16 04:54:32.453793,epoch time: 0:34:18.862018,used: 15:57:20.594875,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9702215, 'precision': 0.9380237, 'recall': 0.84493077, 'specificity': 0.9967042, 'f1': 0.8700832, 'auroc': 0.998743}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   433     0   0     2    0    0     2    27     6    0     13
1     0  1288   0     3    0    0     1    37     2    0      0
2     0     0  76     1    1    0     1     9   135   31     58
3     0     0   0  8327    0    5     1    63    39    0      0
4     1     0   1     0  366    1     0     5    28    8    129
5     0     0   0    28    1  438     0     1     8   45      0
6     1     0   0     0    0    0  1888    10     7    1      1
7     0     2   0    64    1    0     2  7170    23    0      3
8     0     0   0    26    3    2     0    34  3218    0     13
9     0     0   2     2    0   95     1    14     4  362     13
10   17     0   1     8   15    1     7    14    33    0  12697
---- Validation: 
scalar performance:
{'acc': 0.96964025, 'precision': 0.93811214, 'recall': 0.8446226, 'specificity': 0.9966423, 'f1': 0.8714514, 'auroc': 0.9985417}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   434     0   0     1    0    0     0    34     7    1      6
1     0  1289   0     1    0    0     1    39     2    0      0
2     0     0  82     2    3    0     1     6   133   30     55
3     0     0   0  8324    0    4     1    63    46    0      2
4     1     0   2     1  365    1     0     5    31    7    126
5     0     0   0    26    0  434     0     0     9   49      3
6     2     0   0     1    0    0  1886     9     8    0      2
7     0     2   0    68    1    0     5  7157    26    1      5
8     0     0   0    30    3    1     3    34  3211    1     13
9     0     0   2     7    1   88     1    11    12  357     14
10   11     0   1     8   11    1     7    17    28    1  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.61498636, 'precision': 0.6575096, 'recall': 0.4906531, 'specificity': 0.96180004, 'f1': 0.47158197, 'auroc': 0.8203468}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   675     0   0   58   0    5    63  346    15    5     3
1     5  1062   0   38   0    0     2  357    19    0    16
2     3     0   2   61  20    5    27   58   422   32   385
3     0     0   0    0   0    0     0    0     0    0     0
4     3     0   0    1  77    0     6    4    20    0  1522
5     0     0   0  312   0  187     4   17    21   49     2
6     0     0   0   49   0    0  2841   17   136    0    24
7     0     0   0  290   0    0     4  865     2    0     3
8     0     0   0  101   0    0     6   15  1246    1     1
9     0     1   1  306   0   85    24  141   317  195    67
10    0     0   0    0   1    0     5    0     0    0  1640
early stop counter: 3
val acc:0.9696402549743652, best validation acc: 0.9706834554672241, corresponding to test acc:                         0.6580843925476074 / 0.7228713631629944
after epoch: 29,now: 2024-07-16 05:29:01.085271,epoch time: 0:34:28.631478,used: 16:31:49.226353,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.970168, 'precision': 0.94953597, 'recall': 0.824311, 'specificity': 0.9966662, 'f1': 0.83888686, 'auroc': 0.99866456}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   436     0   0     3    2    0     0    17     7    0     18
1     0  1309   0     4    0    0     0    16     2    0      0
2     0     0   1     3   12    0     1     7   225   13     49
3     0     0   0  8387    0    3     0    16    31    1      1
4     0     0   0     1  378    0     0     2    23    1    134
5     0     0   0    27    1  374     0     2     8  108      0
6     3     1   0     1    0    0  1874    16     7    1      5
7     0     5   0    87    1    0     2  7140    19    0     10
8     0     0   0    34    3    1     0    39  3205    0     14
9     0     0   0     8    0   25     0     9    12  409     30
10    2     0   0    11   12    0     2     5    12    0  12748
---- Validation: 
scalar performance:
{'acc': 0.9707369, 'precision': 0.9515601, 'recall': 0.8267902, 'specificity': 0.99672955, 'f1': 0.8403744, 'auroc': 0.99858433}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   439     0   0     2    2    0     0    19     5    1     15
1     0  1309   0     2    1    0     0    19     1    0      0
2     0     0   1     0    6    0     1     6   230   11     57
3     0     0   0  8369    0    5     0    26    39    0      1
4     1     0   0     0  371    0     0     3    25    2    137
5     0     0   0    32    1  366     0     0     8  114      0
6     1     0   0     1    0    0  1889     8     5    1      3
7     0     5   0    75    1    0     2  7158    17    0      7
8     0     0   0    36    7    1     0    36  3200    0     16
9     0     0   0     3    0   18     0     9     6  431     26
10    2     0   0     8   10    0     1     6    10    1  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.660813, 'precision': 0.6991302, 'recall': 0.53551847, 'specificity': 0.9662197, 'f1': 0.5114199, 'auroc': 0.83781576}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   882     0   0   47    0    0    17   170    44    6     4
1     0  1138   0   32    0    0     0   302    14    0    13
2     0     0   1   57   75    0     4    76   400   40   362
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    1  111    0     2     2    17    0  1500
5     0     0   0  245    0  125     2     8    22  188     2
6     0     0   0   14    1    0  2829    31   110    0    82
7     0     0   0   77    0    0     0  1082     3    0     2
8     0     0   0   70    0    0     5    24  1268    1     2
9     1     0   0  291    0   18     2   143   243  366    73
10    0     0   0    0    2    0     0     0     1    0  1643
better model found
persisted
after epoch: 30,now: 2024-07-16 06:03:22.048869,epoch time: 0:34:20.963598,used: 17:06:10.189951,model: blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:06:10.189951 at 2024-07-16 06:03:22.048869
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.660813, 'precision': 0.6991302, 'recall': 0.53551847, 'specificity': 0.9662197, 'f1': 0.5114199, 'auroc': 0.83781576}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   882     0   0   47    0    0    17   170    44    6     4
1     0  1138   0   32    0    0     0   302    14    0    13
2     0     0   1   57   75    0     4    76   400   40   362
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    1  111    0     2     2    17    0  1500
5     0     0   0  245    0  125     2     8    22  188     2
6     0     0   0   14    1    0  2829    31   110    0    82
7     0     0   0   77    0    0     0  1082     3    0     2
8     0     0   0   70    0    0     5    24  1268    1     2
9     1     0   0  291    0   18     2   143   243  366    73
10    0     0   0    0    2    0     0     0     1    0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72287136, 'precision': 0.70908076, 'recall': 0.59959626, 'specificity': 0.9721371, 'f1': 0.5831967, 'auroc': 0.8637848}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1012     0   0   21    0    1    10   110     7    3     6
1      1  1264   0   14    0    0     5   209     0    0     6
2     18     3  70   61   17    2    67   148   140  121   368
3      0     0   0    0    0    0     0     0     0    0     0
4      1     1   0    4  187    0    20    14    11    0  1395
5      8     0   0   56    0  202     0    14     4  307     1
6      0     0   0    8    0    0  3029    12     4    1    13
7      1     0   0   59    0    0     1  1098     0    1     4
8      0     0   0   74    0    4    36    41  1202    5     8
9     14     7  26  146    0   46     9   142    61  649    37
10     0     0   0    0   14    0    13     0     0    0  1619
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b44271c83_not_commited_2024md_07md_15_12_57_11_seed_2_21971818_instance_wise_predictions.txt
accuracy from prediction file 0.6608129853774575
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 322829 KiB |   1934 MiB |   2651 TiB |   2651 TiB |
|       from large pool | 291621 KiB |   1909 MiB |   2610 TiB |   2610 TiB |
|       from small pool |  31208 KiB |     49 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 322829 KiB |   1934 MiB |   2651 TiB |   2651 TiB |
|       from large pool | 291621 KiB |   1909 MiB |   2610 TiB |   2610 TiB |
|       from small pool |  31208 KiB |     49 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 316155 KiB |   1930 MiB |   2648 TiB |   2648 TiB |
|       from large pool | 286862 KiB |   1906 MiB |   2608 TiB |   2608 TiB |
|       from small pool |  29293 KiB |     47 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2178 MiB |   2198 MiB |   5556 MiB |   3378 MiB |
|       from large pool |   2128 MiB |   2148 MiB |   5482 MiB |   3354 MiB |
|       from small pool |     50 MiB |     50 MiB |     74 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 201458 KiB | 277216 KiB |   1925 TiB |   1925 TiB |
|       from large pool | 189658 KiB | 271595 KiB |   1884 TiB |   1884 TiB |
|       from small pool |  11800 KiB |  32764 KiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6154    |    8136    |  474636 K  |  474630 K  |
|       from large pool |     130    |     276    |  252626 K  |  252625 K  |
|       from small pool |    6024    |    7964    |  222010 K  |  222004 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6154    |    8136    |  474636 K  |  474630 K  |
|       from large pool |     130    |     276    |  252626 K  |  252625 K  |
|       from small pool |    6024    |    7964    |  222010 K  |  222004 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     114    |     115    |     261    |     147    |
|       from large pool |      89    |      90    |     224    |     135    |
|       from small pool |      25    |      25    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |    2324    |  265696 K  |  265695 K  |
|       from large pool |      22    |      91    |  164715 K  |  164715 K  |
|       from small pool |      27    |    2299    |  100980 K  |  100980 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1934 MiB |   2651 TiB |   2651 TiB |
|       from large pool |  16640 KiB |   1909 MiB |   2610 TiB |   2610 TiB |
|       from small pool |      0 KiB |     49 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1934 MiB |   2651 TiB |   2651 TiB |
|       from large pool |  16640 KiB |   1909 MiB |   2610 TiB |   2610 TiB |
|       from small pool |      0 KiB |     49 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1930 MiB |   2648 TiB |   2648 TiB |
|       from large pool |  16640 KiB |   1906 MiB |   2608 TiB |   2608 TiB |
|       from small pool |      0 KiB |     47 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   2198 MiB |   5556 MiB |   5044 MiB |
|       from large pool | 481280 KiB |   2148 MiB |   5482 MiB |   5012 MiB |
|       from small pool |  43008 KiB |     50 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 277216 KiB |   1925 TiB |   1925 TiB |
|       from large pool |  24320 KiB | 271595 KiB |   1884 TiB |   1884 TiB |
|       from small pool |      0 KiB |  34812 KiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8136    |  474636 K  |  474636 K  |
|       from large pool |       2    |     276    |  252626 K  |  252626 K  |
|       from small pool |       0    |    7964    |  222010 K  |  222010 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8136    |  474636 K  |  474636 K  |
|       from large pool |       2    |     276    |  252626 K  |  252626 K  |
|       from small pool |       0    |    7964    |  222010 K  |  222010 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     115    |     261    |     218    |
|       from large pool |      22    |      90    |     224    |     202    |
|       from small pool |      21    |      25    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2324    |  265698 K  |  265698 K  |
|       from large pool |       3    |      91    |  164715 K  |  164715 K  |
|       from small pool |       0    |    2299    |  100982 K  |  100982 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul 16 06:31:43 2024]
Finished job 0.
1 of 1 steps (100%) done
