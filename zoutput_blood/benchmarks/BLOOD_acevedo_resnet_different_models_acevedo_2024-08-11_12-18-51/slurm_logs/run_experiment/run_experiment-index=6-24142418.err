Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 23:00:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418

 Experiment start at: 2024-08-11 23:11:12.776500
before training, model accuracy: 0.08472679555416107
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.28579837, 'precision': 0.23733012, 'recall': 0.2528326, 'specificity': 0.9297854, 'f1': 0.18585187, 'auroc': 0.7992502}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     20     0   0   0   0   0   128    39   295   0   0
1      3  1116   0   0   0   0     9   184    20   0   0
2      3     0   0   4   0   0    97    56   150   2   0
3      8    67   0   5   0   0  5795  1079  1483   1   0
4     57     1   0   0   0   0    39    28   413   0   0
5      0     1   0   0   0   0   258     3   255   4   0
6     70     1   0   2   0   0   262    92  1481   0   0
7     40   172   0   0   0   0   259  6429   363   0   0
8     26     1   0   1   0   0   171   252  2842   2   0
9      0     1   0   2   0   0   233    28   221   8   0
10  4169     8   0   1   0   0    26   132  8458   0   0
---- Validation: 
scalar performance:
{'acc': 0.28447238, 'precision': 0.21727705, 'recall': 0.24990943, 'specificity': 0.9296565, 'f1': 0.18304831, 'auroc': 0.79591364}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     17     0   0   1   0   0   145    33   286   1   0
1      6  1107   0   0   0   0     4   200    15   0   0
2      8     3   0   2   0   0   100    54   140   5   0
3      4    58   0   5   0   0  5793  1091  1489   0   0
4     53     0   0   0   0   0    38    29   417   2   0
5      0     2   0   0   0   0   267     2   247   3   0
6     61     3   0   2   0   0   269    74  1497   2   0
7     33   167   0   0   0   0   272  6424   369   0   0
8     28     7   0   1   0   0   178   271  2811   0   0
9      0     1   0   0   0   0   257    31   202   2   0
10  4243     8   0   0   0   0    24   157  8364   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20184706, 'precision': 0.1857547, 'recall': 0.21891597, 'specificity': 0.91933495, 'f1': 0.15508224, 'auroc': 0.6253662}
confusion matrix:
     0    1   2   3   4   5    6    7     8   9   10
0    17    0   0   0   0   0   42   11  1098   2   0
1    73  631   0   0   0   0   11  460   324   0   0
2    20    0   0   0   0   0   32    7   952   4   0
3     0    0   0   0   0   0    0    0     0   0   0
4   234    0   0   0   0   0    0    0  1399   0   0
5     0    0   0   0   0   0  182    1   375  34   0
6   325    0   0   0   0   0    3    2  2737   0   0
7    14   30   0   0   0   0   60  939   121   0   0
8     2    0   0   0   0   0   77    0  1290   1   0
9     4    3   0   0   0   0  162   14   949   5   0
10  549    0   0   0   0   0    0    0  1097   0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 23:45:19.927614,epoch time: 0:34:07.151114,used: 0:34:07.151114,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.3478168, 'precision': 0.36894125, 'recall': 0.34260073, 'specificity': 0.9364406, 'f1': 0.2578593, 'auroc': 0.8745624}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9   10
0     61     1   0   33   0   0   267    25    88   8   0
1      7  1131   0    7   0   0     3   175     8   1   0
2      8     3   0   27   0   0   167    26    70  11   0
3      9     2   0  629   0   0  6020   685  1095   0   0
4     68     0   0    4   0   0   127    14   321   5   0
5      0     0   0   59   0   7   265     0   107  83   0
6     78     0   0   10   0   0  1366    41   410   3   0
7     31    21   0   83   0   0   119  6752   257   0   0
8      9     1   0   45   0   0   113   146  2977   4   0
9      1     0   0   66   1   2   260    15    71  77   0
10  5882     8   0    1   0   0   158    94  6647   0   0
---- Validation: 
scalar performance:
{'acc': 0.3458874, 'precision': 0.3733161, 'recall': 0.3419636, 'specificity': 0.9362489, 'f1': 0.26013952, 'auroc': 0.8749735}
confusion matrix:
      0     1   2    3   4   5     6     7     8   9   10
0     57     0   0   40   0   0   270    22    90   4   0
1      6  1135   0    4   0   0     8   164    15   0   0
2     10     3   0   32   0   0   165    23    67  12   0
3      6     0   0  600   0   0  5989   731  1109   5   0
4     72     1   0    7   0   0   115    14   328   2   0
5      0     0   0   51   0   8   258     2   116  86   0
6     85     1   0    9   0   0  1324    44   443   2   0
7     30    15   0  104   0   0   117  6744   255   0   0
8      8     0   0   41   0   0   115   156  2974   2   0
9      1     2   0   50   0   2   256    15    78  89   0
10  5985     3   0    4   0   0   154    80  6570   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2684531, 'precision': 0.30758393, 'recall': 0.24175793, 'specificity': 0.925205, 'f1': 0.19176015, 'auroc': 0.6921641}
confusion matrix:
     0    1   2    3   4   5    6     7     8    9   10
0    20    0   0    6   0   0  663    11   469    1   0
1    47  930   0    3   0   0   17   298   204    0   0
2    10    0   0    9   0   0  151    13   828    4   0
3     0    0   0    0   0   0    0     0     0    0   0
4   175    0   0    0   0   0   16     1  1441    0   0
5     0    0   0  132   0   1  154     0   182  123   0
6   148    0   0    1   0   0  549     2  2367    0   0
7     8    7   0    7   0   0   60  1008    74    0   0
8     0    0   0    5   0   0   67     0  1295    3   0
9     5    5   0   70   0   0  317    24   682   34   0
10  400    0   0    0   0   0    0     0  1246    0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 00:17:37.978236,epoch time: 0:32:18.050622,used: 1:06:25.201736,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5432363, 'precision': 0.5195588, 'recall': 0.52951866, 'specificity': 0.9556304, 'f1': 0.4464126, 'auroc': 0.92316854}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9   10
0    316     0   0    22   0    0    56    18    57   14   0
1      4  1153   0     9   0    0     0   150    15    0   0
2     26     9   0    36   5    0    52    28    75   75   5
3      3     0   0  6986   0    5    67   577   766   34   0
4    115     1   0     9   2    1    47    17   303   20  24
5      4     1   0   124   8  119     2     1    24  238   0
6    119     0   0    32   0    2  1506    26   204   16   2
7     31     6   0   158   0    0     5  6842   218    0   4
8     11     0   0   108   0    0     5   100  3066    6   0
9     27     5   0    60   5   25    21    14    50  286   0
10  8016     3   0    21   0    0    40    53  4628    4  28
---- Validation: 
scalar performance:
{'acc': 0.54291826, 'precision': 0.5239059, 'recall': 0.5277694, 'specificity': 0.955575, 'f1': 0.4450643, 'auroc': 0.9228006}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9   10
0    312     0   0    23   0    0    54    25    56   13   0
1      7  1162   0    12   0    0     1   133    17    0   0
2     29    10   0    36   0    1    48    39    61   85   3
3      4     3   0  6961   0    8    60   576   786   42   0
4    101     1   0     7   2    0    43    16   324   16  29
5      5     0   0   120  10  116     0     1    30  239   0
6    114     1   0    39   0    0  1519    24   193   18   0
7     34     5   0   144   0    0     4  6839   238    0   1
8     13     0   0    95   0    0     4   109  3071    4   0
9     27     3   0    66   7   25    20    18    45  278   4
10  7922     1   0    15   0    0    29    76  4711    5  37
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3560484, 'precision': 0.39023054, 'recall': 0.30581945, 'specificity': 0.93525887, 'f1': 0.25786257, 'auroc': 0.7385213}
confusion matrix:
     0    1   2    3   4   5     6    7     8    9   10
0   551    0   0    4   0   0   246   11   356    2   0
1    52  874   0   15   0   0    13  353   189    0   3
2    71    0   0   16   0   0    29    9   871   16   3
3     0    0   0    0   0   0     0    0     0    0   0
4   242    0   0    0   0   0     6    0  1377    0   8
5    35    0   0  120   0   2     7    0   171  257   0
6   319    0   0    3   0   0  1251    2  1491    0   1
7    25    1   0   32   0   0    26  943   137    0   0
8     5    0   0    4   0   0     2    0  1352    7   0
9   134    5   0   57   0   0    27   15   783  115   1
10  433    0   0    0   0   0     1    0  1211    0   1
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 00:50:01.809250,epoch time: 0:32:23.831014,used: 1:38:49.032750,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85720783, 'precision': 0.65553445, 'recall': 0.64771354, 'specificity': 0.9852201, 'f1': 0.613112, 'auroc': 0.9537267}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9      10
0    380     0   0    15   0    0    16    20    19    5     28
1      3  1205   0    11   0    0     1    93    15    0      3
2     33    16   0    46   6    1    37    37    53   70     13
3      5     3   0  7590   0    5     7   452   358   16      3
4     42     6   0    11   9    2    39    32   196   21    181
5      6     2   0   147   2  245     2     0    18   99      0
6    101     3   0    45   0    1  1630    21    76    9     22
7     25    29   0   169   0    0     2  6906   111    0     18
8      7     0   0   166   0    0     5   105  2987    3     23
9     37     8   0    68   2   82    12    10    32  240      2
10  1185     1   0    15   1    0    17    78   644    6  10847
---- Validation: 
scalar performance:
{'acc': 0.8564665, 'precision': 0.6688484, 'recall': 0.6479816, 'specificity': 0.98512137, 'f1': 0.6135351, 'auroc': 0.9537631}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9      10
0    376     0   0    20   0    0    15    21    18    6     27
1      3  1204   0    12   0    0     0   101     9    0      3
2     30    24   0    31   3    4    38    24    57   87     14
3      7     1   0  7596   0    7    11   453   356    9      0
4     47     2   0    15  10    3    29    32   189   25    187
5      7     2   0   146   1  238     1     1    21  104      0
6    100     2   0    41   0    0  1645    20    64   11     25
7     23    23   0   195   0    0     1  6891   109    0     23
8      6     1   0   156   0    0     6   124  2971    1     31
9     47     5   0    61   2   67    13     7    36  252      3
10  1176     3   0    19   1    0    23    75   658    5  10836
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51220876, 'precision': 0.486266, 'recall': 0.4193827, 'specificity': 0.9510953, 'f1': 0.372019, 'auroc': 0.75941765}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   649     0   0   22   0   0   266   13   216   0     4
1    28  1095   0   28   0   0     7  220    76   0    45
2    55     2   0   79   0   0    36   14   775  15    39
3     0     0   0    0   0   0     0    0     0   0     0
4    24     1   0    0   0   0     5    0   620   0   983
5    28     0   0  392   0   3     4    0    66  99     0
6   239     1   0   19   0   0  1741    4   878   0   185
7    17    13   0   69   0   0    25  960    79   0     1
8     2     0   0   31   0   0     5    1  1328   3     0
9   129    10   0  293   0   0    25   31   561  83     5
10   16     0   0    1   0   0     0    0   167   0  1462
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 01:22:55.515787,epoch time: 0:32:53.706537,used: 2:11:42.739287,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9067316, 'precision': 0.70406485, 'recall': 0.67838997, 'specificity': 0.98979574, 'f1': 0.6709109, 'auroc': 0.96621084}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   377     0   0     8   0    0     9    22     7    1     59
1     0  1211   0    16   0    0     0    93     8    0      4
2    20    20   0    54  14    5    27    35    22  105     10
3     5     3   0  7834   0   14     3   341   226    8      3
4    38     1   0     8  27    5    22    71   107   29    231
5     7     0   0   101   1  347     0     0    11   53      1
6    73     3   0    49   0    1  1680    18    42    9     32
7     8    10   0   215   0    0     2  6923    76    0     29
8     7     1   0   184   0    0     3   131  2903    4     63
9    32     3   0    57   6  138     7     7    20  220      3
10  143     1   0    20   4    1    15    90   146    5  12368
---- Validation: 
scalar performance:
{'acc': 0.90654004, 'precision': 0.70682377, 'recall': 0.678043, 'specificity': 0.9897883, 'f1': 0.67008555, 'auroc': 0.9668262}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   370     0   0    10   1    1     7    20     5    3     66
1     1  1203   0    13   0    0     0   101    11    0      3
2    26    21   0    50  11    4    27    38    26   99     10
3     2     5   0  7848   0   16     4   320   234    8      3
4    27     2   0    13  33    5    13    70   102   35    239
5     6     1   0    95   3  337     1     1    10   65      2
6    82     1   0    43   0    4  1692     9    35   10     32
7     9    13   0   214   0    0     1  6912    86    1     29
8     3     1   0   197   1    0     6   121  2893    6     68
9    36     2   0    48   6  140     2     9    15  231      4
10  169     2   0    13   1    0    15    73   148    3  12372
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52676135, 'precision': 0.4873491, 'recall': 0.43247092, 'specificity': 0.95259917, 'f1': 0.38232183, 'auroc': 0.76405126}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   771     0   0   41   0   0   231    6   117    0     4
1    10  1075   0   43   0   0    12  253    62    0    44
2   104     3   0   62   1   0    18   20   717   13    77
3     0     0   0    0   0   0     0    0     0    0     0
4    14     0   0    0   0   0     5    0   182    0  1432
5    79     0   0  326   0  21     1    0    50  115     0
6   229     0   0   27   0   0  1764    4   758    4   281
7    22     5   0  220   0   0    28  832    53    0     4
8     9     0   0   35   0   0     1    0  1321    4     0
9   222     8   0  241   3   0    15   37   488  115     8
10    3     0   0    1   0   0     0    0    11    1  1630
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-12 01:54:23.828173,epoch time: 0:31:28.312386,used: 2:43:11.051673,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9144638, 'precision': 0.71950006, 'recall': 0.6917243, 'specificity': 0.9905556, 'f1': 0.68714535, 'auroc': 0.97192717}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   355     0   0    12   0    0     9    14    11    5     77
1     0  1242   0    13   0    0     0    64    11    0      2
2    11    11   0    31  14    3    43    36    42  114      7
3     2     2   0  7858   0   27     2   364   175    3      5
4    16     1   0    10  24    4    18    69   105   34    258
5     9     0   0    61   3  384     1     1     6   55      1
6    69     3   0    53   1    1  1678    14    33   11     44
7     2    16   0   184   0    0     2  6948    88    1     22
8     1     1   0   196   0    0     2   106  2905    5     78
9    17     2   0    41   4  126    10     6    20  262      5
10   80     1   0    14   1    0    10    45   114    6  12523
---- Validation: 
scalar performance:
{'acc': 0.91333425, 'precision': 0.724236, 'recall': 0.689837, 'specificity': 0.99040186, 'f1': 0.6864565, 'auroc': 0.9723697}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   352     0   0    13   0    0     1    20     4    7     86
1     2  1236   0    13   0    0     1    64    13    0      3
2    15     6   0    40  11    5    50    33    30  111     11
3     3     1   0  7859   0   24     2   362   181    5      3
4    25     1   0     5  26    3    16    76   101   29    257
5     7     0   0    66   3  385     0     1     4   54      1
6    58     0   0    64   0    1  1660    11    47    7     60
7     5    26   0   189   0    0     0  6917    96    0     32
8     3     1   0   184   0    2     1   109  2922    8     66
9    18     3   0    45   4  125    11    11    15  259      2
10   78     2   0    18   2    1     6    50   108    2  12529
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4976562, 'precision': 0.49114457, 'recall': 0.42593566, 'specificity': 0.9496827, 'f1': 0.36477244, 'auroc': 0.74572307}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   795     0   0   52   0   0   123   12   167   0    21
1    10  1140   0   30   0   0     0  213    59   0    47
2    74     2   0   43   0   0     5   25   700   7   159
3     0     0   0    0   0   0     0    0     0   0     0
4     3     0   0    0   0   0     3    0    69   0  1558
5    65     0   0  386   0  15     0    0    65  60     1
6   285     1   0   25   0   0  1184    4   798   2   768
7    21    12   0  132   0   0    16  933    42   0     8
8     4     0   0   31   0   0     1    1  1330   2     1
9   183     9   0  245   3   0     2   64   542  70    19
10    0     0   0    0   0   0     0    0     0   0  1646
better model found
persisted
after epoch: 6,now: 2024-08-12 02:26:00.008412,epoch time: 0:31:36.180239,used: 3:14:47.231912,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.91582835, 'precision': 0.740445, 'recall': 0.6826162, 'specificity': 0.9905702, 'f1': 0.6885712, 'auroc': 0.97707075}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   337     0   0    14   0    0     3    10     5    4    110
1     4  1225   0    18   0    0     1    71     7    0      6
2     6    13   0    47   9    0    56    46    35   91      9
3     2     1   0  7869   0   16     0   270   270    2      6
4     7     1   0    12  14    2    22    98    94   28    261
5     3     0   0    83   0  365     1     2    12   53      2
6    31     1   0    60   0    2  1710     5    28    5     63
7     2    17   0   245   0    0     1  6841   111    1     46
8     0     1   0   113   0    0     1    85  3020    1     74
9    11     3   0    66   1  115    11    10    26  242      8
10   33     1   0    13   1    0    16    33    90    2  12607
---- Validation: 
scalar performance:
{'acc': 0.9175873, 'precision': 0.75023866, 'recall': 0.68702626, 'specificity': 0.99075896, 'f1': 0.6941798, 'auroc': 0.9767652}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   332     0   0    18   0    0     5     7     8    4    109
1     2  1232   0    13   0    0     1    66    12    0      6
2    10    11   0    48   8    3    57    40    37   83     15
3     2     0   0  7883   0   15     0   267   263    0     10
4     6     3   0    12  17    3    21   107    92   23    255
5     3     0   0    83   0  364     0     0    13   57      1
6    34     0   0    60   0    2  1704     6    32    4     66
7     3    10   0   224   0    0     0  6868   115    0     45
8     0     0   0   119   0    1     3    78  3022    1     72
9    13     2   0    56   2   98    14     8    27  266      7
10   31     1   0    11   1    1    10    30    95    0  12616
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5005947, 'precision': 0.50589937, 'recall': 0.40135548, 'specificity': 0.9500034, 'f1': 0.36876675, 'auroc': 0.73925257}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   611     0   0   62   0   0   298    0   175    0    24
1    18  1060   0   56   0   0     8  179    92    0    86
2    33     0   0   54   2   0    12    5   740   13   156
3     0     0   0    0   0   0     0    0     0    0     0
4     2     0   0    0   0   0     4    0    81    0  1546
5    25     0   0  392   0  40     3    0    76   55     1
6    58     0   0   68   0   0  1827    0   623    0   491
7    47     1   0  448   0   0    24  520    91    0    33
8     1     0   0   20   0   0     3    0  1343    1     2
9    91     2   0  248   0   2    14   17   626  109    28
10    0     0   0    0   0   0     0    0     1    0  1645
better model found
persisted
after epoch: 7,now: 2024-08-12 02:58:38.288334,epoch time: 0:32:38.279922,used: 3:47:25.511834,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9242027, 'precision': 0.74868834, 'recall': 0.7036965, 'specificity': 0.991647, 'f1': 0.70156753, 'auroc': 0.98265254}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   367     0   0    19   1    0    10     9     5    3     69
1     1  1257   0    21   0    0     1    42     8    0      1
2     6    27   0    34   6    4    69    24    24  111      7
3     2     0   0  8101   0   14     0   149   163    3      2
4    11     5   0    14  33    4    35    86    82   40    229
5     2     0   0    76   0  374     1     0    11   55      2
6    20     0   0    46   1    1  1782     3    23    7     25
7     1    34   0   295   0    0     3  6790   117    0     24
8     3     1   0   147   0    0     1    69  3007    3     65
9    14     4   0    47   4  128    13     2    13  263      5
10   71     2   0    17   2    0    18    33    79    4  12569
---- Validation: 
scalar performance:
{'acc': 0.92341846, 'precision': 0.7457727, 'recall': 0.70438415, 'specificity': 0.9915283, 'f1': 0.70372057, 'auroc': 0.9832036}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   371     0   0    16   1    1     8     8     4    3     71
1     0  1249   0    18   0    0     1    53     9    0      2
2     7    23   0    32  13    1    72    25    20  112      7
3     0     0   0  8081   0   15     3   162   174    1      4
4     9    10   0    15  35    4    30    76    80   37    243
5     4     0   0    74   1  385     1     0    10   44      2
6    18     0   0    47   0    2  1780     4    22    7     28
7     1    30   0   313   0    0     1  6791   107    2     20
8     2     1   0   143   0    0     3    80  2997    1     69
9    11     3   0    44   2  135    17     8    12  257      4
10   60     1   0    18   3    1    22    38    73    4  12576
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5252921, 'precision': 0.5081857, 'recall': 0.42170545, 'specificity': 0.95264214, 'f1': 0.38347736, 'auroc': 0.7439931}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   603     0   0   99   0   0   282    5   170   1    10
1    15  1136   0   41   0   0     4  202    60   0    41
2    57     1   0   98   0   0     7   16   668  17   151
3     0     0   0    0   0   0     0    0     0   0     0
4     3     1   0    0   0   0     3    0    95   0  1531
5    16     0   0  464   0  22     0    0    58  31     1
6    96     0   0   44   0   1  1926    3   632   1   364
7    16     7   0  297   0   0    27  766    43   0     8
8     1     0   0   46   0   0     0    2  1320   0     1
9    84     8   0  364   0   2     3   38   523  91    24
10    0     0   0    0   0   0     0    0     2   0  1644
better model found
persisted
after epoch: 8,now: 2024-08-12 03:31:57.543116,epoch time: 0:33:19.254782,used: 4:20:44.766616,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92843, 'precision': 0.7362982, 'recall': 0.7046404, 'specificity': 0.9920211, 'f1': 0.70530957, 'auroc': 0.98412895}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   377     0   0    12   2    0     5     7     6    1     73
1     0  1265   0    13   0    0     0    45     5    0      4
2    11    39   0    20   9    1    96    37    20   66     13
3     2     1   0  8079   0   19     0   193   138    1      2
4    11     9   0     5  12    1    27   133    62   21    258
5     2     0   0    61   2  350     2     0     5   98      1
6    30     0   0    40   0    2  1758     7    25    3     43
7     1    24   0   175   1    0     1  6945    80    0     37
8     1     2   0   140   0    0     1    96  2992    1     62
9    10     5   0    41   4   81    26    11    15  294      6
10   37     0   0    15   1    1     7    28    75    1  12629
---- Validation: 
scalar performance:
{'acc': 0.9273505, 'precision': 0.75604, 'recall': 0.70641047, 'specificity': 0.9919073, 'f1': 0.707945, 'auroc': 0.9840705}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   381     0   0    11   0    0     3     9     7    3     69
1     0  1261   0    16   0    0     0    43     7    0      5
2     6    33   0    13   6    3   103    49    22   66     11
3     2     1   0  8041   0   14     0   231   142    4      5
4     9     6   0     3  20    0    26   134    59   25    257
5     3     0   0    56   2  358     0     2     9   89      2
6    32     0   0    45   1    1  1749     4    30    4     42
7     0    21   0   172   0    0     2  6966    69    0     35
8     1     1   0   144   0    0     4   113  2979    0     54
9    19     6   0    36   4   79    26     6    19  292      6
10   41     1   0    11   0    0     9    38    71    3  12622
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5737074, 'precision': 0.5118878, 'recall': 0.45864028, 'specificity': 0.957044, 'f1': 0.41658103, 'auroc': 0.7582555}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   737     0   0   30   0   0   333    3    60    0     7
1    22  1142   0   33   0   0     7  182    48    0    65
2    88     5   0   40   3   0    15   28   608   12   216
3     0     0   0    0   0   0     0    0     0    0     0
4     2     1   0    0   0   0     3    4    63    0  1560
5    60     0   0  344   0  53     5    0    59   69     2
6    91     0   0   10   0   1  2326    2   329    0   308
7    17     8   0  224   0   0    34  836    31    0    14
8     6     0   0   29   0   0     4    1  1322    2     6
9   194     8   0  183   4   2    19   46   510  141    30
10    0     0   0    0   0   0     0    0     3    0  1643
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 04:04:27.360970,epoch time: 0:32:29.817854,used: 4:53:14.584470,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9315336, 'precision': 0.75868815, 'recall': 0.7170868, 'specificity': 0.9924151, 'f1': 0.71534723, 'auroc': 0.9874854}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   374     0   0    10   1    0     6     7     4    1     80
1     0  1272   0    14   0    0     1    39     2    0      3
2     7    37   0     7   6    5    97    46    22   80      5
3     2     3   0  8101   0   31     3   167   125    2      6
4     7     8   0     3  21    2    21   195    63   23    195
5     5     0   0    41   2  392     1     0     7   72      1
6    19     0   0    23   1    1  1806     6    14    3     35
7     2    31   0   210   0    0     4  6928    63    1     24
8     2     3   0   147   1    0     5    87  2984    3     62
9     9     7   0    27   2   98    28     7     8  302      5
10   29     1   0    13   1    0    13    50    46    3  12637
---- Validation: 
scalar performance:
{'acc': 0.93146986, 'precision': 0.7657167, 'recall': 0.7183692, 'specificity': 0.99239355, 'f1': 0.71649027, 'auroc': 0.98755467}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   379     0   0    11   1    0    10     4     1    4     73
1     0  1280   0    15   0    0     1    31     3    0      2
2     5    39   0    10   5    2   100    48    21   74      8
3     1     3   0  8116   0   23     3   157   130    4      3
4     5     9   0     1  23    4    25   217    50   19    186
5     3     0   0    47   0  400     1     1     3   64      2
6    22     0   0    24   1    3  1806     5    12    4     31
7     5    26   0   226   1    1     3  6909    66    0     28
8     1     3   0   141   0    1     5    89  2975    3     78
9    11     4   0    34   2  106    25     4     8  294      5
10   40     2   0    12   1    0     3    52    44    1  12641
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5750367, 'precision': 0.5119189, 'recall': 0.46409047, 'specificity': 0.95698696, 'f1': 0.42761505, 'auroc': 0.7620319}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   634     0   0   27   0   0   456    2    39    0    12
1     9  1176   0   34   0   0     4  185    32    0    59
2    70     3   0   44   3   0    14   37   582   21   241
3     0     0   0    0   0   0     0    0     0    0     0
4     2     0   0    0   0   0     4   21    46    0  1560
5    56     0   0  317   2  94     9    0    55   57     2
6    43     0   0   17   0   1  2302    2   269    0   433
7    15     2   0  174   0   0    26  908    17    0    22
8     8     0   0   42   0   0     7    2  1299    2    10
9   181     9   0  186   7   7    18   53   480  161    35
10    0     0   0    0   0   0     0    1     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-12 04:38:01.078866,epoch time: 0:33:33.717896,used: 5:26:48.302366,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:26:48.302366 at 2024-08-12 04:38:01.078866
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5750367, 'precision': 0.5119189, 'recall': 0.46409047, 'specificity': 0.95698696, 'f1': 0.42761505, 'auroc': 0.7620319}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   634     0   0   27   0   0   456    2    39    0    12
1     9  1176   0   34   0   0     4  185    32    0    59
2    70     3   0   44   3   0    14   37   582   21   241
3     0     0   0    0   0   0     0    0     0    0     0
4     2     0   0    0   0   0     4   21    46    0  1560
5    56     0   0  317   2  94     9    0    55   57     2
6    43     0   0   17   0   1  2302    2   269    0   433
7    15     2   0  174   0   0    26  908    17    0    22
8     8     0   0   42   0   0     7    2  1299    2    10
9   181     9   0  186   7   7    18   53   480  161    35
10    0     0   0    0   0   0     0    1     0    0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5750367, 'precision': 0.5119189, 'recall': 0.46409047, 'specificity': 0.95698696, 'f1': 0.42761505, 'auroc': 0.7620319}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   634     0   0   27   0   0   456    2    39    0    12
1     9  1176   0   34   0   0     4  185    32    0    59
2    70     3   0   44   3   0    14   37   582   21   241
3     0     0   0    0   0   0     0    0     0    0     0
4     2     0   0    0   0   0     4   21    46    0  1560
5    56     0   0  317   2  94     9    0    55   57     2
6    43     0   0   17   0   1  2302    2   269    0   433
7    15     2   0  174   0   0    26  908    17    0    22
8     8     0   0   42   0   0     7    2  1299    2    10
9   181     9   0  186   7   7    18   53   480  161    35
10    0     0   0    0   0   0     0    1     0    0  1645
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_23_11_12_seed_0_24142418_instance_wise_predictions.txt
accuracy from prediction file 0.5750367312670538
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/6.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 498660 KiB |   5696 MiB | 349956 GiB | 349955 GiB |
|       from large pool | 407936 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |  90724 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 498660 KiB |   5696 MiB | 349956 GiB | 349955 GiB |
|       from large pool | 407936 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |  90724 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478101 KiB |   5656 MiB | 348532 GiB | 348532 GiB |
|       from large pool | 387840 KiB |   5585 MiB | 347704 GiB | 347704 GiB |
|       from small pool |  90261 KiB |    126 MiB |    828 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6104 MiB |   6104 MiB |   6104 MiB |      0 B   |
|       from large pool |   5976 MiB |   5976 MiB |   5976 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 543771 KiB |    944 MiB | 171683 GiB | 171682 GiB |
|       from large pool | 534144 KiB |    942 MiB | 170808 GiB | 170807 GiB |
|       from small pool |   9627 KiB |     17 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3029    |    4672    |   28374 K  |   28371 K  |
|       from large pool |      87    |     281    |   12326 K  |   12326 K  |
|       from small pool |    2942    |    4550    |   16048 K  |   16045 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3029    |    4672    |   28374 K  |   28371 K  |
|       from large pool |      87    |     281    |   12326 K  |   12326 K  |
|       from small pool |    2942    |    4550    |   16048 K  |   16045 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     183    |     183    |     183    |       0    |
|       from large pool |     119    |     119    |     119    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    1178    |   13213 K  |   13213 K  |
|       from large pool |      18    |      61    |    6906 K  |    6906 K  |
|       from small pool |      22    |    1160    |    6307 K  |    6307 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5656 MiB | 348532 GiB | 348532 GiB |
|       from large pool |  16640 KiB |   5585 MiB | 347704 GiB | 347704 GiB |
|       from small pool |      0 KiB |    126 MiB |    828 GiB |    828 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1018 MiB |   6104 MiB |   6104 MiB |   5086 MiB |
|       from large pool |    920 MiB |   5976 MiB |   5976 MiB |   5056 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    944 MiB | 171683 GiB | 171683 GiB |
|       from large pool |  59136 KiB |    942 MiB | 170808 GiB | 170808 GiB |
|       from small pool |      0 KiB |     28 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4672    |   28374 K  |   28374 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16048 K  |   16048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4672    |   28374 K  |   28374 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16048 K  |   16048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |     183    |     183    |     107    |
|       from large pool |      27    |     119    |     119    |      92    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1178    |   13214 K  |   13214 K  |
|       from large pool |       3    |      61    |    6906 K  |    6906 K  |
|       from small pool |       0    |    1160    |    6308 K  |    6308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5656 MiB | 348532 GiB | 348532 GiB |
|       from large pool |  16640 KiB |   5585 MiB | 347704 GiB | 347704 GiB |
|       from small pool |      0 KiB |    126 MiB |    828 GiB |    828 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1018 MiB |   6104 MiB |   6104 MiB |   5086 MiB |
|       from large pool |    920 MiB |   5976 MiB |   5976 MiB |   5056 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    944 MiB | 171683 GiB | 171683 GiB |
|       from large pool |  59136 KiB |    942 MiB | 170808 GiB | 170808 GiB |
|       from small pool |      0 KiB |     28 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4672    |   28374 K  |   28374 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16048 K  |   16048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4672    |   28374 K  |   28374 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16048 K  |   16048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |     183    |     183    |     107    |
|       from large pool |      27    |     119    |     119    |      92    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1178    |   13214 K  |   13214 K  |
|       from large pool |       3    |      61    |    6906 K  |    6906 K  |
|       from small pool |       0    |    1160    |    6308 K  |    6308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418

 Experiment start at: 2024-08-12 04:54:14.723071
before training, model accuracy: 0.10193801671266556
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.75144476, 'precision': 0.34167325, 'recall': 0.341951, 'specificity': 0.9702015, 'f1': 0.30995062, 'auroc': 0.89708817}
confusion matrix:
    0     1    2     3   4   5   6     7    8   9      10
0    0    29   10   196   0   0   1    63   31   1    152
1    0  1179    0    14   0   0   0   124    0   0     15
2    0    38    0    76   0   0   0    56   32   1    108
3    0    41    0  7661   0   0   0   709   12   0     17
4    0    29    4    56   0   0   0    24   12   1    413
5    0     4    3   476   0   0   0     5   29   0      4
6    0   195   26   295   0   0   0    77   48   0   1267
7    0   241    3   561   0   0   0  6343   10   0    107
8    0    77  121  1625   0   0   1   427  376   0    667
9    0    34    7   325   0   0   0    52   44   1     30
10   0   109   14    52   0   0   0    77   12   0  12526
---- Validation: 
scalar performance:
{'acc': 0.7529223, 'precision': 0.33647805, 'recall': 0.34403333, 'specificity': 0.9704497, 'f1': 0.3127922, 'auroc': 0.89878273}
confusion matrix:
    0     1    2     3   4   5   6     7    8   9      10
0    0    33   10   201   0   0   1    58   33   0    147
1    0  1169    0    14   0   0   0   130    1   0     18
2    0    42    6    63   0   0   1    56   30   0    114
3    0    45    0  7679   0   0   0   691   17   0      8
4    0    24    8    54   0   1   0    26   12   0    414
5    0     3    3   471   0   0   0    10   28   0      6
6    0   211   26   316   0   0   1    72   55   0   1227
7    0   237    4   546   0   0   0  6364    6   0    108
8    0    82  132  1600   0   1   1   454  403   0    623
9    0    17    4   325   0   0   1    62   57   0     27
10   0   111   13    66   0   0   1    67   12   0  12526
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26222625, 'precision': 0.2153676, 'recall': 0.23900466, 'specificity': 0.92627263, 'f1': 0.17687815, 'auroc': 0.6921032}
confusion matrix:
    0    1    2    3   4   5   6     7   8   9     10
0    0    2  102  216   0   0   0   153   4   0   693
1    0  955    2   33   0   0   1   182   9   0   317
2    0    3   92  268   0   0   0    67   7   0   578
3    0    0    0    0   0   0   0     0   0   0     0
4    0    0    5    5   0   0   0     0   0   0  1623
5    0    2   24  531   0   0   0    17   3   0    15
6    0    2   52   36   0   0   0    11   2   0  2964
7    0   34    2    6   0   0   0  1016   1   0   105
8    0    1  145  349   0   0   0    98  39   0   738
9    0    4   70  642   0   0   0   223  18   0   180
10   0    0    0    0   0   0   0     0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 05:27:19.601378,epoch time: 0:33:04.878307,used: 0:33:04.878307,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.81193817, 'precision': 0.33633178, 'recall': 0.3976484, 'specificity': 0.97905886, 'f1': 0.3589254, 'auroc': 0.9229257}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0    84   0    38   0   0   0    24   267   0     70
1    0  1149   0    22   0   0   0   143     6   0     11
2    0    89   2    12   0   0   0    37   106   0     66
3    0     5   0  7956   0   0   0   330   147   0      1
4    0    70   5    10   0   0   0    16    95   0    343
5    0     4   0   249   0   0   0     1   266   0      1
6    0   710   1    79   0   0   0    35   536   0    545
7    0    31   1   503   0   1   0  6587    99   0     41
8    0    39  13   624   0   0   0   214  2261   0    144
9    0    48   0    95   0   0   0    20   322   0      8
10   0   102  10    27   0   0   0    78   185   0  12392
---- Validation: 
scalar performance:
{'acc': 0.8121707, 'precision': 0.33044058, 'recall': 0.3973932, 'specificity': 0.97906566, 'f1': 0.3576738, 'auroc': 0.9224807}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0    75   1    59   0   0   1    28   252   0     67
1    0  1154   0    25   0   0   0   134     8   0     11
2    0    92   0    10   0   0   0    26   113   0     71
3    0     3   0  7947   0   0   0   343   143   0      4
4    0    55   1     7   0   0   0    18   101   0    357
5    0     9   0   243   0   0   0     3   264   0      2
6    0   752   1    73   0   0   0    46   498   0    538
7    0    24   0   498   0   0   1  6623    78   0     41
8    0    61  12   628   0   0   0   191  2254   0    150
9    0    43   0   107   0   1   0    26   309   0      7
10   0   128   7    28   0   0   0    74   174   0  12385
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34996152, 'precision': 0.20296723, 'recall': 0.3207747, 'specificity': 0.93443406, 'f1': 0.21319398, 'auroc': 0.71869653}
confusion matrix:
    0     1   2    3   4   5   6     7     8   9     10
0    0   144   0   50   0   0   1    38   886   0    51
1    0  1006   2   21   0   0   1   294    41   0   134
2    0    33   6   76   0   0   0    52   578   0   270
3    0     0   0    0   0   0   0     0     0   0     0
4    0     2   1    3   0   0   0     0    19   0  1608
5    0     0   1  201   0   0   0     1   387   0     2
6    0   176   6   12   0   0   0     6   712   0  2155
7    0    16   0    4   0   0   0  1088    34   0    22
8    0    18   3   33   0   0   0     4  1256   0    56
9    0    21   2  242   0   0   0    90   749   0    33
10   0     0   0    0   0   0   0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 05:59:52.273499,epoch time: 0:32:32.672121,used: 1:05:37.550428,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8232823, 'precision': 0.3518114, 'recall': 0.40756482, 'specificity': 0.9807101, 'f1': 0.36167422, 'auroc': 0.9420581}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0   217   1    56   0   1  14    23   114   1     56
1    0  1156   0    29   0   0   0   132     6   0      9
2    0   100   0    20   0   0   1    31    65   0     95
3    0     1   0  7974   0   0   0   313   148   0      2
4    0    79   0    17   0   0   0    16    72   0    354
5    0    36   0   201   0   0   1     8   268   2      5
6    0  1220   0    69   0   0   4    42   244   0    328
7    0    21   1   462   0   0   0  6697    64   0     19
8    0    33   2   480   0   0   0   152  2568   0     61
9    0   149   0    84   0   0   2    31   209   0     18
10   0   142   2    52   0   0   0    85   139   0  12372
---- Validation: 
scalar performance:
{'acc': 0.82332486, 'precision': 0.4949745, 'recall': 0.40826046, 'specificity': 0.980703, 'f1': 0.36276245, 'auroc': 0.94222003}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    1   229   0    57   0   0  10    23   112   0     51
1    0  1163   0    27   0   0   0   130     4   0      8
2    0    97   0    16   0   0   2    31    69   0     97
3    0     0   0  7996   0   0   0   285   156   0      3
4    0    59   4    20   0   0   0    18    89   0    349
5    0    50   1   202   0   2   2     2   256   1      5
6    0  1180   0    82   0   0   2    37   264   0    343
7    0    12   0   457   0   0   0  6692    77   0     27
8    0    37   5   474   0   0   0   163  2557   0     60
9    0   141   0    77   0   0   6    29   216   0     24
10   0   136   4    51   0   1   0    80   157   0  12367
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3505912, 'precision': 0.20939426, 'recall': 0.32056144, 'specificity': 0.93451464, 'f1': 0.20596063, 'auroc': 0.75375456}
confusion matrix:
    0     1   2    3   4   5   6     7     8   9     10
0    0   246   0   21   0   0   9    17   870   0     7
1    0  1004   0   40   0   0   2   265    80   0   108
2    0    43   1   37   0   0   2    14   777   0   141
3    0     0   0    0   0   0   0     0     0   0     0
4    0    17   0    0   0   0   0     0    70   0  1546
5    0     0   0  124   0   0   0     0   468   0     0
6    0   961   0    2   0   0   0     3  1204   0   897
7    0     7   0   30   0   0   0  1026    89   0    12
8    0     7   1   22   0   0   0     0  1336   0     4
9    0    23   0  174   0   0   1    20   892   0    27
10   0     1   0    0   0   0   0     0     1   0  1644
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 06:32:15.101208,epoch time: 0:32:22.827709,used: 1:38:00.378137,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.84979665, 'precision': 0.5043762, 'recall': 0.47606066, 'specificity': 0.9832313, 'f1': 0.45887744, 'auroc': 0.9612277}
confusion matrix:
    0     1   2     3   4    5    6     7     8   9      10
0    0    56   0    31   0   18  234    36    38   4     66
1    0  1190   0    25   0    0    0   104     2   0     10
2    0    11   5    13   0   10   48    40    29   2    154
3    0     1   1  7910   0    1    0   373   152   0      1
4    0    13   2    11   0    2   24    16    51   2    418
5    0     2  25   148   0  234   21     2    79   5      5
6    0   955   0    62   0   11  374    29    76   0    400
7    0    39   1   250   0    0    0  6889    51   0     34
8    0    18   7   331   0    6    1   190  2605   0    136
9    0     6  10    53   0  168  107    35    57  12     45
10   0    79   1    30   0    0   24    54    62   0  12543
---- Validation: 
scalar performance:
{'acc': 0.8487361, 'precision': 0.59621704, 'recall': 0.47610638, 'specificity': 0.98313254, 'f1': 0.45926502, 'auroc': 0.96129334}
confusion matrix:
    0     1   2     3   4    5    6     7     8   9      10
0    1    61   0    26   0   16  228    30    44   3     74
1    0  1188   0    29   0    0    0   102     4   0      9
2    0    24   5    10   0    9   46    27    32   1    158
3    0     2   2  7927   0    2    0   367   137   0      3
4    0    16   1    12   0    2   30    12    39   1    426
5    0     0  15   141   0  245   29     2    76   8      5
6    0   997   0    48   0   14  348    38    77   1    385
7    0    47   1   251   0    0    1  6894    40   0     31
8    0    23   7   363   0    3    4   208  2563   0    125
9    0     7  15    60   0  151  106    34    60  14     46
10   0    76   2    35   0    0   29    55    53   1  12545
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38130555, 'precision': 0.26687285, 'recall': 0.34480178, 'specificity': 0.9371478, 'f1': 0.24839729, 'auroc': 0.7576191}
confusion matrix:
    0     1   2    3   4   5    6     7     8   9     10
0    0    52   0  101   0  48  559   119   280   1    10
1    0  1113   0   35   0   0    0   246    14   0    91
2    0    13  10   92   0  15   42    88   423   0   332
3    0     0   0    0   0   0    0     0     0   0     0
4    0     3   0    1   0   0    3     1    20   0  1605
5    0     0   5  281   0  43    1     4   256   0     2
6    0   471   1    3   0   5  258    14   420   0  1895
7    0     5   0    8   0   0    0  1134     4   0    13
8    0     8   5   53   0   0    8    14  1246   0    36
9    0    13   4  306   0  48   43   162   499   0    62
10   0     0   0    0   0   0    0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 07:04:09.483637,epoch time: 0:31:54.382429,used: 2:09:54.760566,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8904645, 'precision': 0.6211019, 'recall': 0.559966, 'specificity': 0.98742694, 'f1': 0.5588754, 'auroc': 0.9708311}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    0     3   1    94   0   10   269    27    19   0     60
1    0  1170   0    21   0    0     1   126     1   0     13
2    0     6  28    12   0   11    42    35    31   1    146
3    0     0  10  8006   0    3     0   313   105   0      2
4    0     1  14    23   0    1    38    10    32   0    420
5    0     1  29   114   0  326    11     2    29   3      5
6    0    10   1    77   0    8  1647    21    29   1    114
7    0     7   0   264   0    0     1  6914    40   0     37
8    0     4   6   414   0    1    10   152  2583   0    125
9    0     3  53    73   0  180    68    24    35  16     41
10   0    13   1    21   0    0    83    38    43   1  12592
---- Validation: 
scalar performance:
{'acc': 0.88845795, 'precision': 0.61425805, 'recall': 0.5541174, 'specificity': 0.9871961, 'f1': 0.5531088, 'auroc': 0.9707578}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    0     0   4    94   0   11   268    26    23   0     57
1    0  1177   0    23   0    0     0   114     5   0     13
2    0     3  25    15   0   11    42    38    27   1    150
3    0     0   2  8008   0    4     0   313   111   0      2
4    0     4  12    14   0    6    30    13    34   0    426
5    0     0  28   135   0  309    10     0    33   4      2
6    0    15   1    91   0    8  1616    20    33   0    124
7    0     9   0   267   0    0     1  6903    39   0     46
8    0     7   2   427   0    1    13   152  2571   0    123
9    0     0  55    70   0  186    73    31    35  14     29
10   0    15   2    29   0    0    82    36    39   1  12592
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.45637724, 'precision': 0.37485975, 'recall': 0.37508065, 'specificity': 0.94537044, 'f1': 0.31099862, 'auroc': 0.76651764}
confusion matrix:
    0     1   2    3   4   5     6     7     8   9     10
0    0     0   0  446   0   4   472    62   177   1     8
1    0  1097   0   44   0   0     1   240    12   0   105
2    0     8   6  160   0   5    50    50   356   0   380
3    0     0   0    0   0   0     0     0     0   0     0
4    0     0   0    2   0   0     6     1    13   0  1611
5    0     0   6  394   0  40     5     1   145   0     1
6    0    59   0   26   0   1  1359     8   227   0  1387
7    0     1   0   18   0   0     0  1114     8   0    23
8    0     3   0   62   0   0     3    10  1261   0    31
9    0     9   5  530   0  13    36   121   353   0    70
10   0     0   0    0   0   0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-12 07:36:50.266089,epoch time: 0:32:40.782452,used: 2:42:35.543018,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9059022, 'precision': 0.7254597, 'recall': 0.6156748, 'specificity': 0.9893106, 'f1': 0.6180835, 'auroc': 0.9795437}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   71     3   4   105   0    5   199    15    25   2     54
1    0  1217   0    24   0    0     1    74     4   0     12
2    0     5  61    17   0   17    25    14    27   9    137
3    0     1   1  8008   0   15     0   218   194   0      1
4    0     2  17    29   0    5    21     3    32   4    426
5    0     0  17    71   0  404     5     0    19   4      1
6    0     7   3    50   0    6  1739    10    24   0     69
7    0    14   0   261   0    0     2  6848    89   0     49
8    1     2   3   223   0    5     9    87  2898   0     68
9    0     1  77    39   0  218    48     9    25  37     39
10   0    14   2    28   0    3    85    21    62   0  12576
---- Validation: 
scalar performance:
{'acc': 0.90509564, 'precision': 0.7320434, 'recall': 0.6155952, 'specificity': 0.9892234, 'f1': 0.6173944, 'auroc': 0.9795005}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   66     2   3    96   0    7   215    14    25   0     55
1    0  1216   0    23   0    0     0    71     6   0     16
2    0     5  64    19   0   24    21    13    20   6    140
3    0     1   0  8026   0   11     1   228   172   0      1
4    0     3  18    31   0    5    17     4    29   0    432
5    0     0  13    72   0  403     4     0    21   7      1
6    0     5   0    45   0    6  1752     9    28   0     63
7    0    16   0   277   0    0     2  6828   101   0     41
8    0     4   3   216   0   10    12    94  2887   1     69
9    0     1  79    39   0  211    42    12    31  38     40
10   0    19   5    29   0    2    95    23    65   1  12557
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5085706, 'precision': 0.53170556, 'recall': 0.40901572, 'specificity': 0.949664, 'f1': 0.3525176, 'auroc': 0.78857493}
confusion matrix:
    0     1   2    3   4    5     6     7     8   9     10
0    3     1   0  153   0    2   835    15   150   6     5
1    0  1179   0   41   0    0     2   116    53   0   108
2    0     6   7  109   0   10   121    17   446   3   296
3    0     0   0    0   0    0     0     0     0   0     0
4    0     0   0    2   0    0     8     0    30   0  1593
5    0     0   4  255   0  127    29     2   167   7     1
6    0    22   0    7   0    1  1955     2   230   0   850
7    0    27   0   41   0    0    17  1006    29   0    44
8    0     1   1   28   0    0    12     3  1316   0     9
9    0     9   9  360   0   59    97    53   458  30    62
10   0     0   0    0   0    0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 08:08:50.408108,epoch time: 0:32:00.142019,used: 3:14:35.685037,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.911601, 'precision': 0.7171347, 'recall': 0.64094484, 'specificity': 0.98986864, 'f1': 0.65027857, 'auroc': 0.9819266}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   183     4   4    77   0    8    87    14    33   2     71
1     0  1225   0    19   0    0     0    74     6   0      8
2     1     8  53    17   0   28     8    14    16  30    137
3     0     3   3  8150   0   10     1   165   106   0      0
4     0     1  15    29   0    4    10     5    35   6    433
5     0     0  11    67   0  424     2     0    11   4      2
6     7     5   2    44   0    7  1744    14    18   1     65
7     0    31   0   322   0    1     0  6809    75   0     24
8     0     3   6   286   0    6     6   101  2826   3     59
9     2     3  57    41   0  272     8    13    17  53     27
10    0    15   6    37   0    3    44    31    52   1  12605
---- Validation: 
scalar performance:
{'acc': 0.9106861, 'precision': 0.7229745, 'recall': 0.64444345, 'specificity': 0.9897532, 'f1': 0.6551584, 'auroc': 0.9816886}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   188     2   3    59   0   11   102    17    28   2     71
1     0  1222   0    20   0    0     1    75     8   0      6
2     0     5  62    25   0   24     5    19    15  25    132
3     0     2   1  8130   0   18     0   172   116   0      1
4     0     1  12    20   0    7    10    12    33   8    436
5     0     0  16    66   0  425     1     0     9   3      1
6     7     7   2    42   0    4  1738    11    24   1     72
7     0    27   0   355   0    1     2  6782    76   0     22
8     0     2   3   281   0   10     7    98  2831   2     62
9     2     1  67    41   0  255     5     9    18  57     38
10    0    12   5    34   0    1    47    34    48   4  12611
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48541245, 'precision': 0.5196066, 'recall': 0.40277672, 'specificity': 0.94804066, 'f1': 0.36251605, 'auroc': 0.7806921}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   146     2   0  305   0   2   544    14   133   5    19
1     0  1257   0   48   0   0     2    88    26   0    78
2     0    19   2  145   0  11    50    18   345   8   417
3     0     0   0    0   0   0     0     0     0   0     0
4     0     0   0    3   0   0     4     0    13   0  1613
5     0     0   7  376   0  85    16     2    97   8     1
6     0    24   0   14   0   1  1467     3   177   1  1380
7     0    28   0   52   0   0     8  1027    19   0    30
8     0     1   0   53   0   0    10     5  1266   0    35
9     3    23   5  529   0  36    46    39   329  42    85
10    0     0   0    0   0   0     0     0     0   0  1646
better model found
persisted
after epoch: 7,now: 2024-08-12 08:41:20.362246,epoch time: 0:32:29.954138,used: 3:47:05.639175,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.91729987, 'precision': 0.7099211, 'recall': 0.66278696, 'specificity': 0.9904503, 'f1': 0.6730522, 'auroc': 0.9849359}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   263     0   4    31   0    6    48    21    26    0     84
1     0  1256   0    23   0    0     0    44     3    0      6
2     0     1  26    27   0   18     3     9    15   75    138
3     1     6   0  8092   0   13     0   182   142    0      2
4     1     1   7    36   0    6     2     4    22   13    447
5     1     0  13    56   0  419     4     0    10   14      3
6    35     9   1    38   0    4  1698     9    23    2     89
7     0    47   1   264   0    0     2  6849    62    0     36
8     1     0   4   205   0    5     5   105  2887    3     80
9     6     2  37    28   0  228     8    10    16  126     32
10    6    18   6    16   0    2    21    21    36    0  12669
---- Validation: 
scalar performance:
{'acc': 0.91772103, 'precision': 0.70722586, 'recall': 0.6654618, 'specificity': 0.99052006, 'f1': 0.6731401, 'auroc': 0.9849493}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   270     3   5    29   0    5    41    13    23    0     94
1     0  1246   0    22   0    0     1    52     2    0      9
2     2     7  21    33   0   15     3     9    10   86    126
3     0     7   3  8084   0   12     0   183   149    0      2
4     1     2  12    38   0    2     0     4    25   13    442
5     2     0   4    46   0  442     2     0    12   11      2
6    29    11   2    48   0    3  1714     7    20    0     74
7     0    40   0   259   0    0     2  6858    66    1     39
8     1     6   2   192   0   10     1   109  2907    1     67
9     5     0  44    41   0  225     8     8    13  118     31
10    3    25   0    24   0    2    32    22    39    0  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5337578, 'precision': 0.5597126, 'recall': 0.44514608, 'specificity': 0.9530774, 'f1': 0.40821326, 'auroc': 0.7957218}
confusion matrix:
     0     1   2    3   4    5     6     7     8   9     10
0   390     0   0  219   0    1   298    21   225   1    15
1     0  1244   0   40   0    0     4    87    49   0    75
2     3     5   6  106   0   13    28    18   509   6   321
3     0     0   0    0   0    0     0     0     0   0     0
4     0     0   0    5   0    0     4     0    29   0  1595
5     3     0   1  268   0  146    14     5   148   5     2
6     2    13   2   11   0    1  1793     1   353   0   891
7     0    14   0   43   0    0     3  1056    28   0    20
8     0     2   1   36   0    0     1     7  1314   0     9
9     9    10   6  424   0   59    36    39   458  34    62
10    0     0   0    0   0    0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-12 09:14:19.972651,epoch time: 0:32:59.610405,used: 4:20:05.249580,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92160743, 'precision': 0.72005635, 'recall': 0.6669472, 'specificity': 0.99119586, 'f1': 0.6710988, 'auroc': 0.985414}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   257     1   2    35   0    4    74    26    18    4     62
1     0  1236   0    20   0    0     1    65     4    0      5
2     1     2  14    35   0   26     8    13    27  107     79
3     0     1   0  8061   0    9     1   246   119    0      1
4     0     2   4    50   0    5    14    17    40   33    372
5     0     0   1    51   0  433     4     1    20   10      1
6     3     4   0    18   0    4  1822     9    12    1     35
7     0    18   0   193   0    0     6  6974    63    2      7
8     0     3   1   188   0    1    13   101  2958    1     30
9     0     0  13    24   0  272    10    11    29  123     11
10    3    17   2    42   0    1    53    39    67    2  12568
---- Validation: 
scalar performance:
{'acc': 0.9217333, 'precision': 0.72638184, 'recall': 0.66899073, 'specificity': 0.991217, 'f1': 0.67671037, 'auroc': 0.9858827}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   249     2   2    29   0    2    96    26    18    3     56
1     0  1242   0    21   0    0     2    60     3    0      4
2     3     1  31    37   0   25     5    12    18  104     76
3     0     3   0  8060   0    8     1   257   111    0      0
4     0     1   7    52   0    5    12    10    37   26    389
5     1     0   3    55   0  423     4     0    23   11      1
6     5     2   2    25   0    3  1818     8    16    1     28
7     0    20   0   166   0    0     4  6999    64    1     11
8     1     3   0   183   0    3    17   119  2942    1     27
9     2     1  19    30   0  270     9    10    21  125      6
10    2    17   4    39   0    3    54    53    54    0  12570
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5390051, 'precision': 0.5424762, 'recall': 0.42362046, 'specificity': 0.95359397, 'f1': 0.37249178, 'auroc': 0.7851202}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   158     0   0  255   0   0   473    19   258   1     6
1     0  1217   0   42   0   0     9   125    62   0    44
2     1     3   1  102   0   7    25    16   621   4   235
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0    5   0   0     6     0    37   0  1584
5     1     0   2  392   0  56     7     1   128   4     1
6     4    13   1    7   0   1  2228     3   336   0   474
7     0     6   0   32   0   0    18  1060    40   0     8
8     0     0   0   46   0   0     3     2  1314   0     5
9     2    11   0  412   0  25    19    37   576  24    31
10    0     0   0    0   0   0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 09:46:41.866633,epoch time: 0:32:21.893982,used: 4:52:27.143562,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9174069, 'precision': 0.71410143, 'recall': 0.6774554, 'specificity': 0.99056953, 'f1': 0.6852747, 'auroc': 0.98533946}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   297     6   0    21   0    2    44    33    16    2     62
1     0  1240   0    42   0    0     0    38     3    0      8
2     1     3   6    60   0    3     5    17     9  136     72
3     0     9   1  8054   0    9     0   274    90    0      2
4     0     2   3    95   0    3     2    10    19   22    383
5     2     2   4    66   0  393     3     1     8   40      2
6    13    15   2    21   0    1  1785    12    14    1     44
7     0    70   0   231   0    0     2  6902    36    1     21
8     0     7   0   263   0    1     2   153  2807    2     60
9     3     2  13    51   0  156    15     8     4  225     16
10    7    63   0    48   0    1    33    35    23    2  12580
---- Validation: 
scalar performance:
{'acc': 0.91657084, 'precision': 0.7023943, 'recall': 0.6766967, 'specificity': 0.9904757, 'f1': 0.68349725, 'auroc': 0.98400605}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   287     7   0    32   0    1    47    30    18    1     60
1     0  1231   0    42   0    0     0    47     6    0      6
2     0     6   1    68   0    5     4    20     8  127     73
3     0    11   1  8067   0    5     1   273    82    0      0
4     1     5   3    87   0    1     6     6    26   21    383
5     0     0   0    55   0  397     7     1    11   48      2
6    10    10   2    27   0    0  1796    11    12    1     39
7     0    67   0   269   0    1     2  6879    28    0     19
8     0     7   0   255   0    2     9   153  2798    4     68
9     6     0   9    50   0  147     6    11    12  239     13
10    8    81   1    46   0    1    33    30    25    0  12571
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5403344, 'precision': 0.53372157, 'recall': 0.43188056, 'specificity': 0.95414793, 'f1': 0.38375556, 'auroc': 0.78966856}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   332     0   0  271   0   0   300   104   151   0    12
1     0  1199   0   31   0   0     2   184    12   0    71
2     2     4   0  141   0   1    11   119   421   4   312
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0    7   0   0     2     1    21   0  1601
5     2     0   2  468   0  40     8     5    56   9     2
6    17     4   0   25   0   1  2080    13   267   0   660
7     0     1   0    9   0   0     5  1134     7   0     8
8     0     0   0   66   0   0     2    28  1267   0     7
9     5     9   2  571   0   2    14   199   263  26    46
10    0     0   0    0   0   0     0     0     1   0  1645
new oracle model saved
early stop counter: 1
val acc:0.9165708422660828, best validation acc: 0.9217333197593689, corresponding to test acc:                         0.5390051007270813 / 0.5403344035148621
after epoch: 10,now: 2024-08-12 10:18:26.214316,epoch time: 0:31:44.347683,used: 5:24:11.491245,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:24:11.491245 at 2024-08-12 10:18:26.214316
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5390051, 'precision': 0.5424762, 'recall': 0.42362046, 'specificity': 0.95359397, 'f1': 0.37249178, 'auroc': 0.7851202}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   158     0   0  255   0   0   473    19   258   1     6
1     0  1217   0   42   0   0     9   125    62   0    44
2     1     3   1  102   0   7    25    16   621   4   235
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0    5   0   0     6     0    37   0  1584
5     1     0   2  392   0  56     7     1   128   4     1
6     4    13   1    7   0   1  2228     3   336   0   474
7     0     6   0   32   0   0    18  1060    40   0     8
8     0     0   0   46   0   0     3     2  1314   0     5
9     2    11   0  412   0  25    19    37   576  24    31
10    0     0   0    0   0   0     0     0     0   0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5403344, 'precision': 0.53372157, 'recall': 0.43188056, 'specificity': 0.95414793, 'f1': 0.38375556, 'auroc': 0.78966856}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   332     0   0  271   0   0   300   104   151   0    12
1     0  1199   0   31   0   0     2   184    12   0    71
2     2     4   0  141   0   1    11   119   421   4   312
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0    7   0   0     2     1    21   0  1601
5     2     0   2  468   0  40     8     5    56   9     2
6    17     4   0   25   0   1  2080    13   267   0   660
7     0     1   0    9   0   0     5  1134     7   0     8
8     0     0   0   66   0   0     2    28  1267   0     7
9     5     9   2  571   0   2    14   199   263  26    46
10    0     0   0    0   0   0     0     0     1   0  1645
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_04_54_14_seed_1_24142418_instance_wise_predictions.txt
accuracy from prediction file 0.5390051073952284
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 498916 KiB |   5696 MiB | 699925 GiB | 699925 GiB |
|       from large pool | 408192 KiB |   5625 MiB | 698265 GiB | 698264 GiB |
|       from small pool |  90724 KiB |    127 MiB |   1660 GiB |   1660 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 498916 KiB |   5696 MiB | 699925 GiB | 699925 GiB |
|       from large pool | 408192 KiB |   5625 MiB | 698265 GiB | 698264 GiB |
|       from small pool |  90724 KiB |    127 MiB |   1660 GiB |   1660 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478101 KiB |   5656 MiB | 697065 GiB | 697065 GiB |
|       from large pool | 387840 KiB |   5585 MiB | 695409 GiB | 695409 GiB |
|       from small pool |  90261 KiB |    126 MiB |   1656 GiB |   1656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5952 MiB |   6104 MiB |  11038 MiB |   5086 MiB |
|       from large pool |   5824 MiB |   5976 MiB |  10880 MiB |   5056 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 664347 KiB |    944 MiB | 332461 GiB | 332461 GiB |
|       from large pool | 654720 KiB |    942 MiB | 330699 GiB | 330698 GiB |
|       from small pool |   9627 KiB |     28 MiB |   1762 GiB |   1762 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3029    |    4672    |   56749 K  |   56746 K  |
|       from large pool |      87    |     281    |   24652 K  |   24652 K  |
|       from small pool |    2942    |    4550    |   32096 K  |   32093 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3029    |    4672    |   56749 K  |   56746 K  |
|       from large pool |      87    |     281    |   24652 K  |   24652 K  |
|       from small pool |    2942    |    4550    |   32096 K  |   32093 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     186    |     186    |     293    |     107    |
|       from large pool |     122    |     122    |     214    |      92    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |    1178    |   26359 K  |   26359 K  |
|       from large pool |      21    |      64    |   13933 K  |   13933 K  |
|       from small pool |      22    |    1160    |   12425 K  |   12425 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5696 MiB | 699925 GiB | 699925 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 698265 GiB | 698264 GiB |
|       from small pool |      0 KiB |    127 MiB |   1660 GiB |   1660 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5696 MiB | 699925 GiB | 699925 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 698265 GiB | 698264 GiB |
|       from small pool |      0 KiB |    127 MiB |   1660 GiB |   1660 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5656 MiB | 697065 GiB | 697065 GiB |
|       from large pool |  16640 KiB |   5585 MiB | 695409 GiB | 695409 GiB |
|       from small pool |      0 KiB |    126 MiB |   1656 GiB |   1656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1136 MiB |   6104 MiB |  11038 MiB |   9902 MiB |
|       from large pool |   1038 MiB |   5976 MiB |  10880 MiB |   9842 MiB |
|       from small pool |     98 MiB |    128 MiB |    158 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    944 MiB | 332462 GiB | 332462 GiB |
|       from large pool |  59136 KiB |    942 MiB | 330699 GiB | 330699 GiB |
|       from small pool |      0 KiB |     28 MiB |   1762 GiB |   1762 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4672    |   56749 K  |   56749 K  |
|       from large pool |       2    |     281    |   24652 K  |   24652 K  |
|       from small pool |       0    |    4550    |   32096 K  |   32096 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4672    |   56749 K  |   56749 K  |
|       from large pool |       2    |     281    |   24652 K  |   24652 K  |
|       from small pool |       0    |    4550    |   32096 K  |   32096 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     186    |     293    |     211    |
|       from large pool |      33    |     122    |     214    |     181    |
|       from small pool |      49    |      64    |      79    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1178    |   26360 K  |   26360 K  |
|       from large pool |       3    |      64    |   13933 K  |   13933 K  |
|       from small pool |       0    |    1160    |   12426 K  |   12426 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 10:24:55 2024]
Finished job 0.
1 of 1 steps (100%) done
