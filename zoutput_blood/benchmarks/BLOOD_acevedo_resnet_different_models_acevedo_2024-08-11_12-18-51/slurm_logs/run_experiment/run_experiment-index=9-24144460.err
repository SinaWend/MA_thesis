Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 08:46:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460

 Experiment start at: 2024-08-12 08:57:01.835850
before training, model accuracy: 0.08472679555416107
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.28796554, 'precision': 0.26361206, 'recall': 0.25407234, 'specificity': 0.9300177, 'f1': 0.1925514, 'auroc': 0.80176115}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     21     0   0   0   0   0   118    36   307   0   0
1      4  1080   0   1   0   0     8   221    18   0   0
2      5     0   0   1   0   0    91    54   157   4   0
3     10     7   0   6   0   0  5769  1081  1565   0   0
4     55     2   0   1   0   0    37    23   420   0   0
5      0     0   0   1   0   0   260     3   254   3   0
6     78     0   0   0   0   0   272    85  1472   1   0
7     34    93   0   2   0   0   232  6504   398   0   0
8     20     0   0   2   0   0   153   254  2864   2   0
9      1     0   0   2   0   0   206    29   239  16   0
10  4379     3   0   0   0   0    23    87  8302   0   0
---- Validation: 
scalar performance:
{'acc': 0.28599706, 'precision': 0.23749593, 'recall': 0.24969873, 'specificity': 0.92982996, 'f1': 0.18797241, 'auroc': 0.799279}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     16     0   0   2   0   0   137    34   292   2   0
1      7  1072   0   0   0   0     5   226    22   0   0
2      7     2   0   3   0   0    92    44   156   8   0
3      7     9   0   7   0   0  5796  1071  1549   1   0
4     48     0   0   0   0   0    29    22   439   1   0
5      0     1   0   0   0   0   256     2   254   8   0
6     71     0   0   0   0   0   269    72  1492   4   0
7     32   102   0   1   0   0   250  6487   393   0   0
8     24     2   0   1   0   0   166   269  2834   0   0
9      0     1   0   0   0   0   245    29   211   7   0
10  4365     2   0   0   0   0    18   111  8299   1   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19715945, 'precision': 0.18378036, 'recall': 0.21574025, 'specificity': 0.9190942, 'f1': 0.14496508, 'auroc': 0.62447894}
confusion matrix:
     0    1   2   3   4   5    6    7     8   9   10
0     9    0   0   0   0   0   49   16  1088   8   0
1    58  484   0   0   0   0    8  594   355   0   0
2    18    0   0   0   0   0   13    7   969   8   0
3     0    0   0   0   0   0    0    0     0   0   0
4   215    0   0   0   0   0    0    0  1418   0   0
5     0    0   0   0   0   0  133    1   373  85   0
6   393    0   0   0   0   0    1    2  2671   0   0
7    11   15   0   0   0   0   40  989   109   0   0
8     0    0   0   0   0   0   44    0  1319   7   0
9     0    3   0   0   0   0   86   17  1015  16   0
10  529    0   0   0   0   0    0    0  1117   0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 09:31:25.304056,epoch time: 0:34:23.468206,used: 0:34:23.468206,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.34631848, 'precision': 0.34270367, 'recall': 0.35157824, 'specificity': 0.9362347, 'f1': 0.2612437, 'auroc': 0.8776762}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0     77     1   0   59   0   0   212    28    85   21   0
1      5  1143   0    6   0   0     6   159    12    1   0
2     12     2   0   36   0   1   138    25    76   22   0
3      7     3   0  535   0   0  5933   748  1214    0   0
4     69     0   0    9   0   0   114    11   332    4   0
5      0     1   0   56   0   4   236     0   113  111   0
6     95     1   0   11   0   0  1371    38   387    5   0
7     29    49   0   80   0   0   109  6724   272    0   0
8     12     0   0   40   0   0   109   153  2976    5   0
9      2     0   0   75   0   2   207    13    80  114   0
10  5816     4   0    1   0   0   141    83  6745    0   0
---- Validation: 
scalar performance:
{'acc': 0.34671658, 'precision': 0.37527996, 'recall': 0.35379148, 'specificity': 0.93629396, 'f1': 0.26714545, 'auroc': 0.8777666}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0     64     0   0   50   0   0   234    24    94   17   0
1      6  1164   0    2   0   0     7   136    17    0   0
2      8     4   0   40   0   0   132    29    74   25   0
3      9     6   0  547   0   0  5914   763  1197    4   0
4     59     1   0   13   0   0    93    13   357    3   0
5      0     0   0   44   0   7   244     3   110  113   0
6     87     0   0   11   0   0  1333    48   425    4   0
7     33    45   0   76   0   0   106  6740   265    0   0
8     12     2   0   48   0   0    99   164  2969    2   0
9      2     2   0   69   1   1   198    11    71  138   0
10  5920     1   0    5   0   0   147    74  6646    3   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2564892, 'precision': 0.21441871, 'recall': 0.23491287, 'specificity': 0.9238758, 'f1': 0.18608606, 'auroc': 0.6800109}
confusion matrix:
     0    1   2    3   4   5    6     7     8    9   10
0    18    0   0    7   0   0  838    15   289    3   0
1    57  836   0    4   0   0   16   344   242    0   0
2    15    0   0    6   0   0  119    11   852   12   0
3     0    0   0    0   0   0    0     0     0    0   0
4   140    0   0    0   0   0   10     0  1483    0   0
5     0    0   0  114   0   0  163     0   153  162   0
6   391    0   0    1   0   0  452     1  2222    0   0
7     8    6   0    5   0   0   53  1017    75    0   0
8     0    0   0    5   0   0   76     0  1279   10   0
9     2    3   0   58   0   0  290    19   701   64   0
10  291    0   0    0   0   0    0     0  1355    0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 10:04:32.368363,epoch time: 0:33:07.064307,used: 1:07:30.532513,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.539009, 'precision': 0.5014222, 'recall': 0.5106584, 'specificity': 0.9551664, 'f1': 0.42193457, 'auroc': 0.9172706}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    300     0   0    33   1   0    50    18    60   18   3
1      5  1105   0    14   0   0     0   191    15    1   0
2     30     4   0    36   3   3    45    23    76   83   8
3      1     2   0  7025   0   1   101   567   699   42   0
4    115     1   0    13   1   0    29    21   320   18  21
5      6     1   0   131  14  43     1     0    27  298   0
6    105     1   0    43   0   3  1461    33   237   23   1
7     28    16   0   149   0   0     7  6844   217    1   2
8     12     2   0   126   0   0     7   113  3031    3   2
9     30     4   0    63   8  12     6    11    54  305   0
10  7941     6   0    14   0   0    39    65  4690    7  31
---- Validation: 
scalar performance:
{'acc': 0.5381035, 'precision': 0.5085907, 'recall': 0.51251674, 'specificity': 0.9550395, 'f1': 0.42483842, 'auroc': 0.9193139}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    302     0   0    27   0   1    41    28    54   27   3
1      8  1124   0    15   0   0     0   170    14    1   0
2     36     3   0    40   1   2    39    31    67   85   8
3      5     1   0  6987   0   2   118   576   711   40   0
4    106     3   0     6   3   1    36    14   323   16  31
5      5     1   0   130  16  50     0     2    31  286   0
6    117     0   0    56   0   0  1455    32   223   25   0
7     28    15   0   156   0   0     2  6843   219    0   2
8     13     0   0   117   0   0     3   136  3018    9   0
9     29     1   0    67  11  10    11    12    47  304   1
10  7902     3   0    19   0   0    28    87  4721    5  31
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32141608, 'precision': 0.2829128, 'recall': 0.28892606, 'specificity': 0.93156266, 'f1': 0.24266407, 'auroc': 0.7259131}
confusion matrix:
     0    1   2    3   4   5    6     7     8    9   10
0   344    0   0   11   0   0  439    16   352    7   1
1    47  857   0   15   0   1    4   388   183    0   4
2    15    0   0   21   0   0   30    13   891   40   5
3     0    0   0    0   0   0    0     0     0    0   0
4   133    0   0    0   0   0    7     0  1481    0  12
5     9    0   0  110   0   0   21     0   115  337   0
6   436    0   0    1   0   0  812     3  1809    0   6
7    10    2   0   20   0   0   17  1016    98    0   1
8     0    0   0    7   0   0    5     0  1344   14   0
9    48    5   0  106   0   1   47    21   689  219   1
10  302    0   0    1   0   0    0     0  1341    0   2
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 10:37:40.191788,epoch time: 0:33:07.823425,used: 1:40:38.355938,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85038525, 'precision': 0.64754784, 'recall': 0.6352235, 'specificity': 0.9846174, 'f1': 0.5998955, 'auroc': 0.95447385}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9      10
0    369     0   0    26   0    0    24    20    18    6     20
1      3  1152   0     8   0    0     0   146    19    0      3
2     29    11   0    41   6    6    36    28    76   73      6
3      2     0   0  7639   0    3     9   409   367   10      0
4     55     3   0    12   9    8    26    31   228   20    147
5      7     2   0   164   3  185     2     0    19  139      0
6     66     2   0    62   0    2  1652    21    79    9     15
7     26    39   0   183   0    0     4  6860   133    0     15
8      6     0   0   169   0    0     6    91  3007    2     15
9     37     5   0    72   3   54    11     8    43  259      1
10  1334     2   0    20   0    0    30    77   674    5  10652
---- Validation: 
scalar performance:
{'acc': 0.8470777, 'precision': 0.6353388, 'recall': 0.63236195, 'specificity': 0.98424554, 'f1': 0.59659696, 'auroc': 0.9552845}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9      10
0    363     0   0    26   1    0    21    18    23    4     27
1      4  1156   0    11   0    0     0   147     9    0      5
2     30    13   0    31   6    6    48    22    73   76      7
3      5     1   0  7608   0    8    13   432   366    5      2
4     55     1   0    12   7    6    26    22   232   26    152
5      6     0   0   169   3  179     0     0    20  144      0
6     56     3   0    62   0    1  1664    22    64   11     25
7     28    30   0   196   0    0     0  6849   148    0     14
8      7     2   0   163   0    1     7   110  2979    1     26
9     40     4   0    74   5   48    16     4    37  262      3
10  1357     2   0    21   0    0    42    71   697    5  10601
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5185056, 'precision': 0.475303, 'recall': 0.41035894, 'specificity': 0.95110875, 'f1': 0.3635587, 'auroc': 0.74798906}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   390     0   0   20   0   0   587    9   163    0     1
1    29  1026   0   17   0   0    10  245   117    0    55
2    40     1   0   47   0   0    48    8   809   21    41
3     0     0   0    0   0   0     0    0     0    0     0
4    29     0   0    0   0   0     8    0   553    0  1043
5    32     0   0  315   0   3    16    0    88  138     0
6   115     0   0   11   0   0  2089    2   723    0   127
7    14     7   0   36   0   0    30  972   105    0     0
8     1     0   0   11   0   0     7    0  1347    4     0
9    93     9   0  175   0   0    47   18   683  108     4
10   15     0   0    2   0   0     0    0   153    0  1476
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 11:10:48.117078,epoch time: 0:33:07.925290,used: 2:13:46.281228,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90515304, 'precision': 0.6992747, 'recall': 0.6686134, 'specificity': 0.98964167, 'f1': 0.6629962, 'auroc': 0.9649707}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   359     1   0    13   1    0     7    23    10    4     65
1     2  1213   0    15   0    0     0    87    10    0      5
2    28    14   0    35  13   16    24    33    51   92      6
3     6     3   0  7857   0    9     2   326   218   10      6
4    40     0   0     7  22   19    10    55   133   24    229
5     5     0   0   115   2  278     0     0    14  106      1
6    69     2   0    54   0    1  1662    17    53   13     36
7     6    15   0   206   0    1     1  6919    84    1     30
8     6     1   0   191   0    0     4   129  2889    6     70
9    37     2   0    59   5   85    10     7    26  260      2
10  139     3   0    21   1    1    15    78   157    6  12372
---- Validation: 
scalar performance:
{'acc': 0.9050421, 'precision': 0.70245993, 'recall': 0.66580117, 'specificity': 0.98960966, 'f1': 0.66205215, 'auroc': 0.965241}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   357     1   0    16   1    1     7    18     8    2     72
1     2  1196   0    17   0    0     0   103     8    0      6
2    24    11   0    46  12    6    26    40    49   89      9
3     1     2   0  7859   0   12     5   316   234    7      4
4    31     0   0     4  27   19     8    56   130   27    237
5     8     1   0   115   0  268     0     1    18  109      1
6    70     2   0    53   0    3  1677    19    31   13     40
7     6    13   0   211   0    0     3  6925    81    0     26
8     8     1   0   200   0    0     4   129  2887    2     65
9    38     1   0    44   8  101     3    11    31  254      2
10  149     1   0    19   1    2    16    71   150    2  12385
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5026237, 'precision': 0.4477113, 'recall': 0.42329043, 'specificity': 0.9498217, 'f1': 0.360999, 'auroc': 0.74214643}
confusion matrix:
     0     1   2    3   4   5     6     7     8    9     10
0   669     0   0   17   0   0   255    12   209    0     8
1    13  1007   0   21   0   0     7   319    67    0    65
2    85     1   0   24   2   1     3    25   769   12    93
3     0     0   0    0   0   0     0     0     0    0     0
4    10     0   0    0   0   0     1     1   123    0  1498
5    72     0   0  253   0  15     2     0    94  156     0
6   285     0   0   15   0   1  1399     5   778    2   582
7    24     4   0   52   0   0    13  1004    61    0     6
8     6     0   0   11   0   0     1     0  1352    0     0
9   190     7   0  127   3   2     9    33   656   95    15
10    0     0   0    0   1   0     0     0     2    0  1643
better model found
persisted
after epoch: 5,now: 2024-08-12 11:43:54.916536,epoch time: 0:33:06.799458,used: 2:46:53.080686,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9125642, 'precision': 0.72932816, 'recall': 0.68254536, 'specificity': 0.99034655, 'f1': 0.6786106, 'auroc': 0.9703841}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   354     0   0    15   0    1    13    16     9    3     72
1     0  1209   0    16   0    0     0    91    12    0      4
2    16    12   0    57   6   13    43    29    42   88      6
3     2     3   0  7908   0   16     1   336   163    4      5
4    15     0   0    18  16   26    25    50   112   33    244
5     8     1   0    76   0  374     0     0     7   54      1
6    58     2   0    58   0    3  1681    18    37   11     39
7     2    24   0   194   0    1     2  6916   101    2     21
8     1     1   0   204   0    2     2    98  2909    4     73
9    12     2   0    67   1  134     6     8    17  241      5
10   85     1   0    25   1    0    15    55   107    5  12500
---- Validation: 
scalar performance:
{'acc': 0.91116756, 'precision': 0.731497, 'recall': 0.6804128, 'specificity': 0.9901883, 'f1': 0.6764306, 'auroc': 0.971365}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   349     0   0    17   0    0     7    19     5    8     78
1     1  1203   0    18   0    0     1    94     8    0      7
2    13     5   0    70   5   12    45    15    42   89     16
3     3     2   0  7885   0   24     5   340   173    1      7
4    19     0   0    13  18   28    30    45   121   22    243
5     7     0   0    73   0  374     0     0     4   62      1
6    54     0   0    50   0    1  1705    14    37    4     43
7     5    30   0   191   1    0     0  6893   112    1     32
8     4     2   0   191   0    3     3   100  2923    2     68
9    15     4   0    73   1  131     8    10    19  231      1
10   92     0   0    21   0    3    16    65   113    3  12483
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4950675, 'precision': 0.47457826, 'recall': 0.42434394, 'specificity': 0.94925463, 'f1': 0.36323467, 'auroc': 0.7373264}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   755     0   0   24   0   0   141    8   219   0    23
1     8  1077   0   26   0   0     1  226    76   0    85
2    68     1   0   43   0   1     2   16   699   6   179
3     0     0   0    0   0   0     0    0     0   0     0
4     1     0   0    0   0   0     2    0    58   0  1572
5    61     0   0  360   0  18     1    0    71  80     1
6   236     0   0   15   0   0  1182    2   823   0   809
7    32     7   0   46   0   0    11  986    72   0    10
8     4     0   0   18   0   0     1    1  1342   1     3
9   168     5   0  219   1   2     4   47   598  70    23
10    0     0   0    0   0   0     0    0     0   0  1646
better model found
persisted
after epoch: 6,now: 2024-08-12 12:17:25.763706,epoch time: 0:33:30.847170,used: 3:20:23.927856,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9133401, 'precision': 0.73611146, 'recall': 0.6728586, 'specificity': 0.9903321, 'f1': 0.6830637, 'auroc': 0.97601163}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   327     0   0    12   0    2     7    11     9    2    113
1     0  1231   0    17   0    0     0    63    12    0      9
2     5    10   0    68  15   13    35    34    49   73     10
3     2     1   0  7843   0   13     0   266   304    0      7
4     5     1   0    16  30   28    11    64   118   19    247
5     5     0   0   113   2  343     1     0    12   44      1
6    27     2   0    61   0    3  1707     5    41    4     55
7     1    26   0   215   0    0     0  6819   152    0     51
8     0     1   0   107   0    0     1    83  3028    1     74
9     8     1   0    87   4  131     9     8    30  206      9
10   32     1   0    22   2    1    12    28    94    1  12603
---- Validation: 
scalar performance:
{'acc': 0.91461813, 'precision': 0.74769366, 'recall': 0.6750586, 'specificity': 0.99046564, 'f1': 0.68481195, 'auroc': 0.97578555}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   327     0   0    15   1    1     6    12     8    0    113
1     2  1239   0    12   0    0     1    56    15    0      7
2    10     8   0    80  12   11    31    36    55   56     13
3     0     1   0  7857   0    9     2   263   295    1     12
4    10     2   0    19  27   18    11    67   116   18    251
5     3     0   0   102   0  344     0     0    14   57      1
6    35     0   0    54   0    2  1704    10    42    4     57
7     1    26   0   212   0    1     1  6836   146    0     42
8     0     1   0   121   0    1     3    72  3030    1     67
9    22     3   0    85   0  117    10     2    30  216      8
10   28     1   0    18   0    2     7    30    96    1  12613
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5017141, 'precision': 0.46707863, 'recall': 0.3925919, 'specificity': 0.94953614, 'f1': 0.3567297, 'auroc': 0.7182514}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   389     0   0   19   0   0   592    0   155   0    15
1    17  1025   0   41   0   0    15  152   128   0   121
2    37     0   0   47   1   3    18    1   766  10   132
3     0     0   0    0   0   0     0    0     0   0     0
4     3     0   0    0   0   0     3    0    82   0  1545
5    23     0   0  391   0  59    16    0    65  37     1
6    72     0   0   28   0   0  2076    0   504   0   387
7    31     2   0  265   0   0    76  577   177   0    36
8     0     0   0   21   0   0     4    0  1340   0     5
9    79     4   0  272   3  22    34    4   635  59    25
10    0     0   0    0   0   0     0    0     0   0  1646
better model found
persisted
after epoch: 7,now: 2024-08-12 12:50:50.025003,epoch time: 0:33:24.261297,used: 3:53:48.189153,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92281145, 'precision': 0.7496556, 'recall': 0.69727004, 'specificity': 0.99146515, 'f1': 0.7014178, 'auroc': 0.98226905}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   354     0   0    21   2    1    15     8     4    1     77
1     2  1250   0    22   0    0     1    46     8    0      2
2     5    17   0    66  16    6    67    12    36   80      7
3     1     2   0  8081   0   12     1   163   169    1      4
4    16     4   0    15  58   31    34    29   110   19    223
5     1     0   0    89   1  374     0     0    12   42      2
6    20     1   0    42   0    2  1792     3    22    5     21
7     0    41   0   281   1    1     3  6800   103    0     34
8     3     2   0   158   0    1     5    70  2986    1     70
9    15     5   0    80   0  143     8     2    12  222      6
10   64     4   0    23   2    0    18    34    75    1  12574
---- Validation: 
scalar performance:
{'acc': 0.92151934, 'precision': 0.7390443, 'recall': 0.69678426, 'specificity': 0.99131227, 'f1': 0.69942856, 'auroc': 0.98275256}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   360     0   0    15   1    1     9     9     4    3     81
1     0  1255   0    21   1    0     1    43     8    0      3
2     7    19   0    69  20    8    65    16    27   75      6
3     1     3   0  8054   0   18     3   181   174    0      6
4    10     0   0    15  53   26    35    28   118   24    230
5     3     0   0    85   2  376     0     0     8   45      2
6    22     0   0    37   0    2  1795     4    18    8     22
7     3    47   0   274   1    0     1  6807    99    0     33
8     4     2   0   157   0    0     5    76  2970    1     81
9    18     4   0    80   3  137    13     5     9  218      6
10   59     2   0    28   4    3    25    36    74    2  12563
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5355069, 'precision': 0.4912603, 'recall': 0.42559552, 'specificity': 0.95318365, 'f1': 0.387279, 'auroc': 0.73506165}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   433     0   0   52   0   0   542    3   134   0     6
1    14  1166   0   38   0   0     6  160    60   0    55
2    60     6   0   89   2   2    17   15   676  12   136
3     0     0   0    0   0   0     0    0     0   0     0
4     4     1   0    0   0   0     4    0   102   0  1522
5    13     0   0  454   0  54     3    0    46  21     1
6   105     0   0   11   0   0  2121    1   517   0   312
7    15     6   0  174   0   0    59  847    55   0     8
8     0     0   0   46   0   0     4    1  1315   0     4
9    58    11   0  390   3  18    27   31   509  72    18
10    0     0   0    0   0   0     0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-12 13:23:37.481224,epoch time: 0:32:47.456221,used: 4:26:35.645374,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9279752, 'precision': 0.7685389, 'recall': 0.71079147, 'specificity': 0.991947, 'f1': 0.72390527, 'auroc': 0.98416644}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   374     3   0    10   1    0     7     6     7    2     73
1     0  1261   0    19   0    0     0    43     6    0      3
2     9    28   0    82  25    6    62    17    40   35      8
3     1     3   0  8073   0   19     0   195   141    0      3
4    13     4   0    16  99    8    14    53    90   11    231
5     6     0   0    73   5  370     1     0     4   61      1
6    40     0   0    37   1    2  1748     6    31    2     41
7     1    33   0   202   1    0     1  6902    87    0     37
8     2     1   0   146   1    1     2    92  2978    1     71
9    10     4   0    93   4   99    15     8    12  241      7
10   35     2   0    20   2    2     8    26    61    0  12638
---- Validation: 
scalar performance:
{'acc': 0.92788553, 'precision': 0.7724867, 'recall': 0.71008694, 'specificity': 0.99191916, 'f1': 0.7230141, 'auroc': 0.98428243}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   382     0   0    13   0    0     6    11     4    1     66
1     0  1253   0    19   0    0     0    50     5    0      5
2    11    20   0    74  23    6    62    22    47   39      8
3     1     0   0  8069   0   14     1   214   132    1      8
4    11     1   0    16  98    5    15    50    87   15    241
5     3     0   0    73   1  379     0     0    10   54      1
6    45     0   0    31   0    3  1753     5    24    3     44
7     1    30   0   193   0    0     2  6936    73    0     30
8     0     1   0   157   0    0     4    98  2972    0     64
9    14     5   0   101   3  102    16     5    14  223     10
10   42     1   0    22   3    1     6    29    66    2  12624
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5724481, 'precision': 0.49508047, 'recall': 0.45100772, 'specificity': 0.9565409, 'f1': 0.41299164, 'auroc': 0.7521016}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   524     0   0   19   0   0   565    1    56   0     5
1    14  1162   0   33   0   0     9  151    52   0    78
2    72     4   0   51  15   3    28   15   626   8   193
3     0     0   0    0   0   0     0    0     0   0     0
4     3     1   0    0   0   0     3    8    56   0  1562
5    51     0   0  337   4  93    16    0    49  41     1
6    45     0   0    3   0   0  2510    1   246   0   262
7    47     6   0  140   0   0    67  848    36   0    20
8     5     0   0   36   0   0    10    0  1313   0     6
9   132     9   0  261  10  22    60   34   496  86    27
10    0     0   0    0   0   0     0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 13:56:38.493090,epoch time: 0:33:01.011866,used: 4:59:36.657240,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.93024933, 'precision': 0.77428484, 'recall': 0.715271, 'specificity': 0.9922633, 'f1': 0.7272719, 'auroc': 0.98687756}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   382     0   0    10    0    1     7     7     7    1     68
1     0  1214   0    27    0    0     1    83     2    0      4
2     6    14   0    78   25    9    86    20    37   31      6
3     2     4   0  8130    0   24     4   160   111    0      5
4    11     4   0     8  119   11    22    72   108   16    167
5     5     0   0    61    1  406     0     0     4   43      1
6    18     0   0    29    0    3  1806     6     9    4     33
7     2    19   0   199    1    0     2  6946    72    0     22
8     1     5   0   167    0    0     5    84  2964    2     66
9     9     2   0    90    1  146    22     3     9  204      7
10   38     1   0    27    6    3    14    51    55    0  12598
---- Validation: 
scalar performance:
{'acc': 0.9307744, 'precision': 0.77864826, 'recall': 0.71951544, 'specificity': 0.992308, 'f1': 0.73144174, 'auroc': 0.98745346}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   381     0   0    10    2    2    11     5     2    2     68
1     0  1228   0    25    1    0     0    72     3    0      3
2     5    15   0    67   23    6    93    23    33   39      8
3     1     3   0  8129    0   21     1   159   119    2      5
4     6     2   0     8  125   16    24    74    98   13    173
5     2     0   0    63    0  417     1     0     3   33      2
6    20     0   0    27    0    6  1807     4    11    4     29
7     2    17   0   213    1    1     1  6921    81    0     28
8     2     4   0   154    0    5     5    86  2971    4     65
9     6     2   0    98    1  141    20     4     6  208      7
10   40     2   0    25    3    2     5    57    51    1  12610
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5359966, 'precision': 0.50122386, 'recall': 0.4331494, 'specificity': 0.95290995, 'f1': 0.40118164, 'auroc': 0.74388236}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   344     0   0   32   0    0   750    2    33   0     9
1    12  1191   0   36   0    0     3  162    33   0    62
2    29     6   0  106  16   12    21   18   605  10   192
3     0     0   0    0   0    0     0    0     0   0     0
4     0     1   0    1   3    0     2   35    66   0  1525
5    15     0   0  367   0  143    13    0    33  20     1
6    40     0   0   21   1    1  2116    2   360   0   526
7    27     4   0  175   0    0    59  859    22   0    18
8     2     0   0   78   0    1     8    0  1275   0     6
9    49    12   0  388   3   55    46   41   433  85    25
10    0     0   0    0   0    0     0    1     0   0  1645
better model found
persisted
after epoch: 10,now: 2024-08-12 14:30:30.089414,epoch time: 0:33:51.596324,used: 5:33:28.253564,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:33:28.253564 at 2024-08-12 14:30:30.089414
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5359966, 'precision': 0.50122386, 'recall': 0.4331494, 'specificity': 0.95290995, 'f1': 0.40118164, 'auroc': 0.74388236}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   344     0   0   32   0    0   750    2    33   0     9
1    12  1191   0   36   0    0     3  162    33   0    62
2    29     6   0  106  16   12    21   18   605  10   192
3     0     0   0    0   0    0     0    0     0   0     0
4     0     1   0    1   3    0     2   35    66   0  1525
5    15     0   0  367   0  143    13    0    33  20     1
6    40     0   0   21   1    1  2116    2   360   0   526
7    27     4   0  175   0    0    59  859    22   0    18
8     2     0   0   78   0    1     8    0  1275   0     6
9    49    12   0  388   3   55    46   41   433  85    25
10    0     0   0    0   0    0     0    1     0   0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5724481, 'precision': 0.49508047, 'recall': 0.45100772, 'specificity': 0.9565409, 'f1': 0.41299164, 'auroc': 0.7521016}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   524     0   0   19   0   0   565    1    56   0     5
1    14  1162   0   33   0   0     9  151    52   0    78
2    72     4   0   51  15   3    28   15   626   8   193
3     0     0   0    0   0   0     0    0     0   0     0
4     3     1   0    0   0   0     3    8    56   0  1562
5    51     0   0  337   4  93    16    0    49  41     1
6    45     0   0    3   0   0  2510    1   246   0   262
7    47     6   0  140   0   0    67  848    36   0    20
8     5     0   0   36   0   0    10    0  1313   0     6
9   132     9   0  261  10  22    60   34   496  86    27
10    0     0   0    0   0   0     0    0     0   0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_08_57_01_seed_0_24144460_instance_wise_predictions.txt
accuracy from prediction file 0.5359966417127265
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/9.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 498660 KiB |   5696 MiB | 349956 GiB | 349955 GiB |
|       from large pool | 407936 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |  90724 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 498660 KiB |   5696 MiB | 349956 GiB | 349955 GiB |
|       from large pool | 407936 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |  90724 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478101 KiB |   5656 MiB | 348532 GiB | 348532 GiB |
|       from large pool | 387840 KiB |   5585 MiB | 347704 GiB | 347704 GiB |
|       from small pool |  90261 KiB |    126 MiB |    828 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6104 MiB |   6104 MiB |   6104 MiB |      0 B   |
|       from large pool |   5976 MiB |   5976 MiB |   5976 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 543771 KiB |    944 MiB | 171683 GiB | 171682 GiB |
|       from large pool | 534144 KiB |    942 MiB | 170807 GiB | 170807 GiB |
|       from small pool |   9627 KiB |     17 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3029    |    4672    |   28373 K  |   28370 K  |
|       from large pool |      87    |     281    |   12326 K  |   12326 K  |
|       from small pool |    2942    |    4550    |   16047 K  |   16044 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3029    |    4672    |   28373 K  |   28370 K  |
|       from large pool |      87    |     281    |   12326 K  |   12326 K  |
|       from small pool |    2942    |    4550    |   16047 K  |   16044 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     183    |     183    |     183    |       0    |
|       from large pool |     119    |     119    |     119    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    1178    |   13213 K  |   13213 K  |
|       from large pool |      18    |      61    |    6906 K  |    6906 K  |
|       from small pool |      22    |    1160    |    6307 K  |    6307 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5656 MiB | 348532 GiB | 348532 GiB |
|       from large pool |  16640 KiB |   5585 MiB | 347704 GiB | 347704 GiB |
|       from small pool |      0 KiB |    126 MiB |    828 GiB |    828 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1018 MiB |   6104 MiB |   6104 MiB |   5086 MiB |
|       from large pool |    920 MiB |   5976 MiB |   5976 MiB |   5056 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    944 MiB | 171683 GiB | 171683 GiB |
|       from large pool |  59136 KiB |    942 MiB | 170808 GiB | 170808 GiB |
|       from small pool |      0 KiB |     28 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4672    |   28373 K  |   28373 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4672    |   28373 K  |   28373 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |     183    |     183    |     107    |
|       from large pool |      27    |     119    |     119    |      92    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1178    |   13214 K  |   13214 K  |
|       from large pool |       3    |      61    |    6906 K  |    6906 K  |
|       from small pool |       0    |    1160    |    6308 K  |    6308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5656 MiB | 348532 GiB | 348532 GiB |
|       from large pool |  16640 KiB |   5585 MiB | 347704 GiB | 347704 GiB |
|       from small pool |      0 KiB |    126 MiB |    828 GiB |    828 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1018 MiB |   6104 MiB |   6104 MiB |   5086 MiB |
|       from large pool |    920 MiB |   5976 MiB |   5976 MiB |   5056 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    944 MiB | 171683 GiB | 171683 GiB |
|       from large pool |  59136 KiB |    942 MiB | 170808 GiB | 170808 GiB |
|       from small pool |      0 KiB |     28 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4672    |   28373 K  |   28373 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4672    |   28373 K  |   28373 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |     183    |     183    |     107    |
|       from large pool |      27    |     119    |     119    |      92    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1178    |   13214 K  |   13214 K  |
|       from large pool |       3    |      61    |    6906 K  |    6906 K  |
|       from small pool |       0    |    1160    |    6308 K  |    6308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_14_46_06_seed_1_24144460

 Experiment start at: 2024-08-12 14:46:06.657056
before training, model accuracy: 0.10193801671266556
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7533444, 'precision': 0.3547118, 'recall': 0.34294555, 'specificity': 0.97028935, 'f1': 0.3130479, 'auroc': 0.8964356}
confusion matrix:
    0     1    2     3   4   5   6     7    8   9      10
0    0    25    8   229   0   0   1    55   20   0    145
1    0  1168    0    14   0   0   0   134    0   0     16
2    0    35    6    79   0   0   1    60   21   0    109
3    0    29    0  7685   0   0   0   698    8   0     20
4    0    22    7    59   0   0   0    18    8   0    425
5    0     5    5   487   0   0   0     5   16   0      3
6    0   178   23   345   0   0   1    77   27   0   1257
7    0   158    2   526   0   0   0  6459    6   0    114
8    0    71  117  1711   0   0   1   420  321   0    653
9    0    22    7   346   0   0   0    61   29   0     28
10   0    90   22    71   0   0   0    80   10   0  12517
---- Validation: 
scalar performance:
{'acc': 0.75335026, 'precision': 0.4226183, 'recall': 0.34367132, 'specificity': 0.9703702, 'f1': 0.3137844, 'auroc': 0.898334}
confusion matrix:
    0     1    2     3   4   5   6     7    8   9      10
0    0    32    6   230   0   0   0    58   23   0    134
1    0  1164    0    15   0   0   0   129    1   0     23
2    0    39    9    73   0   0   0    62   19   0    110
3    0    24    1  7681   0   0   0   710   11   0     13
4    0    19   15    51   0   0   0    27    8   1    418
5    0     6    3   481   0   0   0    12   14   0      5
6    0   172   17   365   0   0   2    75   35   0   1242
7    0   157    6   536   0   0   0  6450    3   0    113
8    1    85  143  1664   0   0   0   460  328   0    615
9    0    14    8   351   0   0   0    64   33   0     23
10   0   104   20    76   0   0   0    61    5   0  12530
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2733506, 'precision': 0.2298198, 'recall': 0.25052857, 'specificity': 0.92789596, 'f1': 0.18945917, 'auroc': 0.6943008}
confusion matrix:
    0     1    2    3   4   5   6     7   8   9     10
0    0     4  121  354   0   0   0   174  15   0   502
1    0  1011    5   37   0   0   1   207   2   0   236
2    0     6  130  351   0   0   0    79  10   0   439
3    0     0    0    0   0   0   0     0   0   0     0
4    0     0    6    4   0   0   1     1   0   0  1621
5    0     0    9  562   0   0   0     9   3   0     9
6    0     2   75   49   0   0   0    13   3   0  2925
7    0    27    4   10   0   0   0  1051   0   0    72
8    0     3  184  500   0   0   0    91  69   0   523
9    0    12   73  760   0   0   0   202  16   0    74
10   0     0    0    0   0   0   0     0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 15:19:56.031627,epoch time: 0:33:49.374571,used: 0:33:49.374571,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_14_46_06_seed_1_24144460
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
slurmstepd: error: *** JOB 24144460 ON gpusrv12 CANCELLED AT 2024-08-12T15:38:25 ***
