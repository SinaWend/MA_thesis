Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 07:00:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/30.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=30
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622

 Experiment start at: 2024-08-12 07:09:30.996584
before training, model accuracy: 0.05282306298613548
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.83649933, 'precision': 0.623791, 'recall': 0.4599206, 'specificity': 0.98153156, 'f1': 0.45957232, 'auroc': 0.9627286}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    1   0    36   0   2   316    25    34   2     67
1    0  872   0    84   0   0     2   321     2   0     51
2    0    4   1    14   0   4   143    32    87   2     25
3    0    2   0  7588   0   0     5   513   305   1     21
4    0    0   0     9   0   0   126     6    90   0    308
5    0    0   0   320   0  56    81     3    50  10      1
6    0    1   0    37   0   1  1479    32   105   1    251
7    0   31   0   479   0   0     8  6438   183   0    125
8    0    0   0   308   0   0    71   174  2432   0    311
9    0    2   0   121   0  29   215    26    83  13      4
10   0    8   0    32   0   0   200    77    91   0  12386
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8371272, 'precision': 0.5275398, 'recall': 0.4623948, 'specificity': 0.9816309, 'f1': 0.46116042, 'auroc': 0.96453124}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    1   0    32   0   5   321    26    26   1     71
1    0  904   0    81   0   0     0   287     6   0     54
2    0    1   0    15   0   2   151    27    82   3     31
3    0    0   0  7572   0   0     3   532   317   0     16
4    0    0   0     5   0   0   121     9    87   1    316
5    0    0   0   310   0  61    80     1    52  15      2
6    0    3   0    35   0   1  1492    32   113   0    232
7    0   36   0   497   0   0     8  6428   168   0    128
8    0    2   0   313   0   0    94   179  2422   0    286
9    0    1   0   120   0  26   221    19    92  11      3
10   0    6   0    28   0   0   189    80    87   0  12406
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42643252, 'precision': 0.4165715, 'recall': 0.33339843, 'specificity': 0.9394889, 'f1': 0.2861561, 'auroc': 0.76925725}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     1   0   19   0   2  1115   25    6   0     2
1    0  1084   0   23   0   0    49  160    9   0   174
2    0     3   0   87   0   1   552   31  209   0   132
3    0     0   0    0   0   0     0    0    0   0     0
4    0     1   0    0   0   0    55    1   13   0  1563
5    0     0   0  393   0  14   115    1   67   0     2
6    0     2   0    1   0   0  1591    2   39   0  1432
7    0   108   0    3   0   0    92  903   25   0    33
8    0     0   0   76   0   1   395    3  859   0    36
9    0    13   0  389   0   4   458   53  206   1    13
10   0     0   0    0   0   0     3    0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 07:40:05.694635,epoch time: 0:30:34.698051,used: 0:30:34.698051,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8843643, 'precision': 0.7671118, 'recall': 0.6268986, 'specificity': 0.98725307, 'f1': 0.6565146, 'auroc': 0.9832177}
confusion matrix:
     0    1   2     3   4    5     6     7     8    9      10
0   142    2   2    30   0    6   172    14    28   47     40
1     0  888   0   153   0    0     3   204     5    0     79
2     5    2  57     8  25    6    13    31    57   97     11
3     0    3   0  7809   0   16     2   393   208    2      7
4     1    0  27     8  73    2    27    13   116   28    244
5     1    0   0   135   0  304     0     0    12   67      1
6     6    3   1    28   1    6  1740    19    44    7     53
7     0   29   0   366   1    0     6  6697   129    0     34
8     0    0   0   244   1    0    16   148  2826    2     58
9     0    2  16    49   0  143     4    16    36  224      3
10    4   34   3    42   7    2   133    94   172    7  12294
---- Validation: 
scalar performance:
{'acc': 0.8841514, 'precision': 0.7702074, 'recall': 0.6310316, 'specificity': 0.98722726, 'f1': 0.659734, 'auroc': 0.98311955}
confusion matrix:
     0    1   2     3   4    5     6     7     8    9      10
0   142    2   0    24   0    9   168    32    20   39     47
1     0  936   0   141   0    0     2   188     7    0     58
2     0    0  71     7  19   11    11    26    61   98      8
3     0    3   0  7771   0   17     3   416   221    1      8
4     1    0  32     7  58    1    31    11   120   26    252
5     0    0   1   133   0  310     0     0    15   61      1
6     3    1   0    32   0    5  1726    16    48   15     62
7     1   35   0   367   1    0     5  6700   117    0     39
8     1    1   2   262   1    0    15   145  2811    3     55
9     3    1  24    50   0  138     3    16    33  223      2
10    3   29   1    56   8    2   147    65   176    3  12306
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5347373, 'precision': 0.51848257, 'recall': 0.4187125, 'specificity': 0.9517677, 'f1': 0.36503032, 'auroc': 0.8375886}
confusion matrix:
    0     1   2    3   4    5     6     7     8   9     10
0    4     0   0   54   0    3  1012    44    20  33     0
1    0  1151   0   26   0    0    28   207     6   0    81
2    0     3   3   85   0   11   351    65   347   7   143
3    0     0   0    0   0    0     0     0     0   0     0
4    0     1   0    0   0    0    35     1    20   0  1576
5    0     0   0  415   0  104    30     0    31  12     0
6    0     2   0    1   0    0  2354     2    30   4   674
7    0    40   0    2   0    0    20  1076    17   0     9
8    0     0   1   68   0    3    44     5  1232   9     8
9    0    15   5  382   0   59   219   139   231  75    12
10   0     1   0    0   0    0     1     0     0   0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 08:09:28.075122,epoch time: 0:29:22.380487,used: 0:59:57.078538,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9181025, 'precision': 0.80448204, 'recall': 0.74870014, 'specificity': 0.990902, 'f1': 0.7705296, 'auroc': 0.99137706}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   283     1    0    12    1    3    67    10    10   10     86
1     0  1238    1    19    1    0     0    59     2    0     12
2     2     1  116     5   61    3     2     9    19   88      6
3     2     1    1  7967    1   32     3   236   187    3      5
4     1     0   26     0  254    3     6     6    34   15    194
5     1     0    1    60    0  397     1     0     9   50      2
6    15     1    0    13    2    3  1736     3    18   10    105
7     1    47    2   354    4    0     4  6637   136    1     78
8     1     2    7   187   28    2    11    84  2859    5    107
9     4     0   46    16    2  153     4     4    14  244      6
10    9     2    2    11   71    1    34    21    57    3  12584
---- Validation: 
scalar performance:
{'acc': 0.9196469, 'precision': 0.813376, 'recall': 0.7524609, 'specificity': 0.99105704, 'f1': 0.77676666, 'auroc': 0.9913812}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   282     1    1    11    2    3    59     8    12   11     93
1     0  1233    1    19    1    0     0    57     5    0     16
2     2     2  126     2   57    4     2     6    18   84      9
3     0     4    0  7948    0   39     5   236   199    3      6
4     2     0   29     2  242    2     1     5    49   14    193
5     1     0    1    69    0  379     0     0     5   65      1
6    14     0    3    10    6    1  1746     6    19    8     95
7     0    44    4   344    4    0     2  6656   137    0     74
8     1     1    6   196   23    3    11    79  2875    7     94
9     3     0   39    23    1  125     3     4    13  274      8
10    9     1    1    11   56    1    22    19    55    1  12620
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49611697, 'precision': 0.56011415, 'recall': 0.43055066, 'specificity': 0.9483919, 'f1': 0.39193544, 'auroc': 0.8337238}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   69     0   2   64   0    9   827    30    54   86    29
1    0  1172   0   33   0    0    15   149     9    0   121
2    0     7  14   72  23   27    56    40   427   15   334
3    0     0   0    0   0    0     0     0     0    0     0
4    0     1   0    0  32    0     2     1    21    0  1576
5    0     0   0  272   0  264    11     0    28   16     1
6    5     1   2    1   3    1  1445     1    25    1  1582
7    0    21   0   13   0    0    39  1035    27    0    29
8    0     0   1   75   1    4     6     1  1259    7    16
9    0    27  25  342   1  127    51    59   304  156    45
10   0     0   0    0   1    0     0     0     0    0  1645
better model found
persisted
after epoch: 3,now: 2024-08-12 08:38:26.879605,epoch time: 0:28:58.804483,used: 1:28:55.883021,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92404217, 'precision': 0.8017229, 'recall': 0.8005399, 'specificity': 0.99178654, 'f1': 0.80035233, 'auroc': 0.99251056}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   363     0    0     2    0    3    19     5     7   12     72
1     1  1168    1    18    1    0     0    88     5    1     49
2     6     1  177     0   38    2     0     4     6   75      3
3     9     3    0  7826    0   62     7   276   238   12      4
4     1     0   57     2  300    1     3     4    24   18    129
5     1     0    1    34    0  390     0     0     4   90      1
6    55     0    4     4    7    0  1765     5    13    9     44
7     7    40   12   238   14    1    10  6715   158    5     64
8     2     1   15   143   38   10    22    52  2928   11     74
9     5     1   34     8    1  109     1     1     6  323      4
10   14     3   11     7   98    3    19    14    37    5  12582
---- Validation: 
scalar performance:
{'acc': 0.9228033, 'precision': 0.7948311, 'recall': 0.79264873, 'specificity': 0.9916302, 'f1': 0.79276425, 'auroc': 0.992436}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   362     0    2     3    0    0    19    10     4   10     73
1     0  1186    1    23    1    0     1    67     8    0     45
2     1     2  166     2   35    1     1     3     5   94      2
3    10     3    1  7823    1   59    13   290   228    9      3
4     4     0   64     0  278    3     4     4    22   13    147
5     2     0    1    34    0  387     0     0     4   92      1
6    61     2    2     5    1    2  1769     3     7   10     46
7     5    49   19   238    9    0     9  6706   152    3     75
8     6     2   13   131   28    3    12    60  2942   13     86
9     4     0   41     7    0  117     1     0     5  314      4
10   19     6    8     8   97    3    23    15    46    5  12566
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58595115, 'precision': 0.60775083, 'recall': 0.4975259, 'specificity': 0.95758176, 'f1': 0.4758841, 'auroc': 0.85140455}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   238     0   1   31   0   10   599    13     6  259    13
1     1  1183   0   39   0    0    14   167     2    0    93
2     2     3  29   57  24   31   115    46   233   94   381
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   2    0  50    0    11     1    18    0  1550
5     0     0   0  178   0  330     3     0     6   73     2
6    21     0   1    1   2    0  2266     1     2    4   769
7     2    10   1   19   0    0    66  1035    11    3    17
8     0     0   2  101   1   12    24     1  1145   49    35
9     1    21  31  235   0  133    65    67    80  458    46
10    0     1   0    0   1    0     3     0     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 09:07:49.428812,epoch time: 0:29:22.549207,used: 1:58:18.432228,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92941993, 'precision': 0.8347002, 'recall': 0.7948028, 'specificity': 0.99229646, 'f1': 0.81034064, 'auroc': 0.9944759}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   357     0    0     1    0    2    29     4     7    2     79
1     0  1191    1    16    0    0     0    63    12    0     49
2     3     0  150     1   41    1     1     6     6   97      6
3     2     4    1  7603    0   25    18   431   350    0      6
4     1     1   39     0  284    2     2     5    32   12    161
5     3     0    0    36    0  432     0     1    11   36      2
6     9     0    0     2    0    2  1833     3    14    2     42
7     3    24    7   105    4    0     4  6943   129    3     42
8     1     4    1    62   16    0    12    78  3048    4     70
9     5     0   28    11    1  164     3     3     9  266      3
10    7     1    7     5   60    2    21    16    41    0  12631
---- Validation: 
scalar performance:
{'acc': 0.92759126, 'precision': 0.8342047, 'recall': 0.79553705, 'specificity': 0.99209285, 'f1': 0.8108613, 'auroc': 0.99415004}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   349     0    0     2    0    2    40     5     7    4     74
1     0  1168    1    18    2    0     1    84     6    0     52
2     2     0  161     1   43    2     2     2     7   84      8
3     5     0    1  7595    0   33    14   435   352    3      2
4     2     0   38     0  289    2     5     3    30   10    160
5     1     0    1    39    0  433     0     0     9   37      1
6    10     0    2     2    2    2  1821     5    13    1     50
7     1    16    8    95    3    0    12  6935   150    2     43
8     3     2    4    66   18    3    10    88  3020    2     80
9     8     0   31     7    1  151     2     3    12  274      4
10    7     0    7     5   58    1    29    14    42    0  12633
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5672007, 'precision': 0.61871237, 'recall': 0.46306726, 'specificity': 0.95508516, 'f1': 0.42831248, 'auroc': 0.83620346}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   58     0   1   26   0    5   981    10    12   66    11
1    0  1127   0   32   0    0    32   194     5    0   109
2    0     1   6   43  10   18   106    53   382   51   345
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   1    0  31    0    10     1    24    0  1566
5    0     0   0  235   0  256    28     0    18   54     1
6    5     0   0    1   1    0  2424     3     9    0   624
7    0     2   0   17   0    0   109  1008    17    0    11
8    0     0   0   70   0    4    24     2  1247    4    19
9    1    15   5  235   0   80   142   105   191  308    55
10   0     0   0    0   1    0     3     0     0    0  1642
better model found
persisted
after epoch: 5,now: 2024-08-12 09:38:33.297683,epoch time: 0:30:43.868871,used: 2:29:02.301099,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9303296, 'precision': 0.8321623, 'recall': 0.83548117, 'specificity': 0.99258024, 'f1': 0.8320613, 'auroc': 0.99490005}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     0    0     1    2    1    18     4     7    5     68
1     0  1269    1     6    1    0     1    39    11    0      4
2     1     0  178     0   42    1     2     6     4   77      1
3     1     4    1  7551    0   25     8   477   363    9      0
4     3     0   43     0  374    1     2     2    15    9     90
5     1     0    0    28    1  422     1     0     5   62      1
6     8     1    1     1    4    0  1847     2     7    2     35
7     2    37    9    84    9    0     9  6885   183    2     43
8     0     0   13    60   51    0    11    65  3011    3     80
9     2     0   41     6    1   98     1     0     9  334      0
10    8     8    6     7  181    3    21    14    20    1  12524
---- Validation: 
scalar performance:
{'acc': 0.9320048, 'precision': 0.8418162, 'recall': 0.8397128, 'specificity': 0.99274075, 'f1': 0.83887076, 'auroc': 0.9951123}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   373     1    0     2    1    1    24     3     6    3     69
1     0  1262    1     6    2    0     0    50     8    0      3
2     2     0  199     0   33    1     0     3     7   64      3
3     2     9    0  7563    1   28     5   459   366    4      3
4     1     2   43     0  370    1     1     5    14   11     91
5     1     0    0    39    0  418     0     0     6   56      1
6     6     1    1     1    6    0  1844     4     9    3     33
7     1    34   11    95   10    0     1  6875   195    2     41
8     0     0    7    46   43    5     4    58  3057    3     73
9     2     1   32     6    2  107     1     1     8  332      1
10    3     4    5     5  174    3    14    12    25    1  12550
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6032323, 'precision': 0.6373842, 'recall': 0.5032011, 'specificity': 0.95880914, 'f1': 0.47617877, 'auroc': 0.8471133}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   107     0   1   15    0    0   820    18    13  173    23
1     0  1205   0   31    0    0    23   163     9    0    68
2     0     3  11   21   47   12   116    42   330   87   346
3     0     0   0    0    0    0     0     0     0    0     0
4     0     1   1    0  167    0     9     1    19    0  1435
5     0     0   0  146    0  285    10     0    15  135     1
6     5     0   0    1    2    0  2389     2     6    1   661
7     0     7   0    6    0    0    82  1047    13    0     9
8     0     0   1   41    3    2    21     1  1263   17    21
9     1    19   8  123    3   49   104   103   178  515    34
10    0     1   0    0   11    0     1     0     0    0  1633
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 10:08:14.904761,epoch time: 0:29:41.607078,used: 2:58:43.908177,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9430383, 'precision': 0.8614828, 'recall': 0.83364093, 'specificity': 0.9939037, 'f1': 0.8439928, 'auroc': 0.9956865}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   375     0    0     2    1    3    21    12    10    5     54
1     0  1281    0    10    0    0     0    34     5    0      1
2     1     2  208     0   26    7     0     8     9   50      1
3     2     4    0  7911    0   13     2   306   200    0      0
4     2     1   38     0  338    2     2     6    44    9     97
5     0     0    0    44    0  439     1     0     9   26      1
6     7     2    3     4    0    4  1833     8    14    3     30
7     1    25    3   116    3    0     2  7016    86    1     11
8     1     0    3    88    5    1     5    98  3073    1     21
9     4     0   38    10    1  166     0     9     9  255      0
10   11    10    2     7   75    1    19    30   116    4  12518
---- Validation: 
scalar performance:
{'acc': 0.9427578, 'precision': 0.8584153, 'recall': 0.82903874, 'specificity': 0.9938673, 'f1': 0.84016526, 'auroc': 0.9961414}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     1    1     4    2    2    15    11     8   10     47
1     0  1277    0    12    0    0     1    37     2    0      3
2     2     0  194     2   26    3     1     7    11   65      1
3     0     4    0  7919    0   14     0   315   187    1      0
4     3     0   43     0  329    3     0     7    45    8    101
5     0     0    0    43    0  439     0     0     8   30      1
6     8     1    0     2    1    2  1835     7    15    2     35
7     2    21    2   115    0    0     3  7017    84    1     20
8     2     3    4    79    5    3     4    94  3085    0     17
9     3     0   34    10    1  172     1    10     8  254      0
10    4     8   10     5   62    3    16    35   138    1  12514
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5374659, 'precision': 0.5875318, 'recall': 0.454112, 'specificity': 0.9531566, 'f1': 0.41003436, 'auroc': 0.8387591}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   76     0   0   71   0    9   641   105    18  236    14
1    0  1177   0   37   0    0     2   229     2    0    52
2    0     5   3   90   4   30    42   144   406   64   227
3    0     0   0    0   0    0     0     0     0    0     0
4    0     4   1    1  37    0     2     1   119    0  1468
5    0     0   0  300   0  235     3     0    16   37     1
6    6     0   1    3   2    1  1876    15   166    4   993
7    0     5   0    7   0    0    12  1133     2    0     5
8    0     0   0  123   0    2     1    17  1224    0     3
9    0    29   3  379   0  100    22   228    81  283    12
10   0     1   0    0   2    0     0     0     5    0  1638
better model found
persisted
after epoch: 7,now: 2024-08-12 10:38:25.516481,epoch time: 0:30:10.611720,used: 3:28:54.519897,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94533926, 'precision': 0.8551996, 'recall': 0.8560949, 'specificity': 0.9941664, 'f1': 0.85411644, 'auroc': 0.99630916}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   391     0    1     1    1    0    21     3     4    4     56
1     0  1272    1    13    1    0     1    35     4    0      5
2     1     0  224     0   44    1     0     2     5   31      4
3     4     2    1  7923    1   32    10   169   284    7      6
4     2     0   28     0  392    1     3     1    16    8     88
5     1     0    1    30    0  428     1     0     6   51      2
6    10     0    1     2    2    0  1856     1     6    2     28
7     4    28   16   136    8    0    10  6833   180    3     46
8     3     1    8    47   24    3    10    39  3086    2     72
9     4     0   63     2    2  110     1     0    10  299      2
10    7     2    5     6  107    3     8     4    19    2  12629
---- Validation: 
scalar performance:
{'acc': 0.94591415, 'precision': 0.85513365, 'recall': 0.859258, 'specificity': 0.99423593, 'f1': 0.8557794, 'auroc': 0.99635124}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     0    0     1    1    1    16     2     4    2     59
1     0  1272    0    11    0    0     1    36     7    0      5
2     3     0  222     0   45    1     2     1     3   35      0
3     7     5    1  7902    2   24     5   171   313    7      3
4     2     0   28     0  399    2     1     3    10    5     89
5     1     0    2    22    0  435     0     0     9   51      1
6    10     0    0     1    3    1  1857     2     4    4     26
7     6    26   22   128    5    0     3  6858   160    3     54
8     1     0    6    48   32    0     5    37  3097    8     62
9     3     1   65     6    3  108     0     2     4  300      1
10    7     1    7     6  101    2    12     9    26    1  12624
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55852515, 'precision': 0.62885344, 'recall': 0.4637735, 'specificity': 0.9546317, 'f1': 0.438791, 'auroc': 0.83455235}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   92     0   1   28    0    1   803    25    11  172    37
1    1  1102   0   40    0    0    12   230     4    0   110
2    0     1   7   47   23    7    65    50   320   83   412
3    0     0   0    0    0    0     0     0     0    0     0
4    0     0   1    0  117    0     3     1    25    0  1486
5    0     0   0  268    0  170    17     0    28  108     1
6    2     0   0    2    2    1  2056     4    26    1   973
7    0     4   0   11    0    0    50  1077     4    1    17
8    0     0   1   81    0    0    15     4  1246    7    16
9    0     8   7  272    3   32    79    87   113  483    53
10   0     0   0    0   13    0     0     0     0    0  1633
better model found
persisted
after epoch: 8,now: 2024-08-12 11:08:05.558907,epoch time: 0:29:40.042426,used: 3:58:34.562323,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95061004, 'precision': 0.88128495, 'recall': 0.8575358, 'specificity': 0.9946475, 'f1': 0.8674824, 'auroc': 0.9963884}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    0     1    1    0     8     3     2    6     70
1     0  1255    2    12    2    0     0    52     5    0      4
2     1     0  190     1   48    3     0     5     5   55      4
3     3     2    0  7959    0   25     1   178   267    3      1
4     3     1   18     0  375    2     0     3    23    8    106
5     0     0    1    20    0  411     0     0     8   80      1
6     6     0    0     2    5    0  1842     3     8    3     39
7     2    17    2   142    7    0     1  6966    93    5     29
8     0     0    4    64   14    2     2    53  3113    4     39
9     3     0   25     7    1   61     0     1     5  387      3
10    4     0    0     6   84    2     5     9    38    2  12640
---- Validation: 
scalar performance:
{'acc': 0.9497392, 'precision': 0.8807769, 'recall': 0.8565792, 'specificity': 0.99453497, 'f1': 0.8665484, 'auroc': 0.9967035}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   381     1    0     3    0    0    14     3     4    2     75
1     0  1257    1     8    0    0     0    51     8    1      6
2     0     0  186     1   51    1     0     4     4   63      2
3     1     1    1  7940    1   23     1   201   262    5      4
4     1     0   15     0  391    2     1     2    14    7    106
5     0     0    0    18    0  415     0     0     5   82      1
6    10     0    1     3    4    1  1835     3     4    5     42
7     3     9    4   143    3    0     3  6954   108    3     35
8     0     0    3    68   10    0     0    47  3122    3     43
9     2     0   30     3    2   62     0     1     7  383      3
10    4     2    1     6   88    2     5    10    35    1  12642
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5266214, 'precision': 0.6266258, 'recall': 0.4496639, 'specificity': 0.95185375, 'f1': 0.42473698, 'auroc': 0.83566046}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   149     0   0   46    0    1   570    66    16  258    64
1     1  1031   0   40    0    0     9   293     2    0   123
2     0     1   3   65   16    6    22    85   274   84   459
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  137    0     1     2    38    0  1455
5     0     0   0  278    0  138     2     1    21  151     1
6     2     0   0    3    2    0  1580     4    64    0  1412
7     0     0   0   10    0    0    11  1126     6    0    11
8     0     0   1   96    0    0     3     9  1242    3    16
9     2     1   4  296    0   15    31   134    91  491    72
10    0     0   0    0   14    0     0     0     2    0  1630
better model found
persisted
after epoch: 9,now: 2024-08-12 11:38:39.924568,epoch time: 0:30:34.365661,used: 4:29:08.927984,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9480148, 'precision': 0.8714127, 'recall': 0.8512793, 'specificity': 0.9944866, 'f1': 0.8574747, 'auroc': 0.9970664}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     1    0     2    0    0    16     1     2    6     29
1     0  1280    1     9    0    0     0    33     6    0      3
2     1     0  181     0   35    4     2     1     4   80      4
3     4     3    0  7935    1   22    12   156   298    2      4
4     2     0   23     0  347    3     2     1    37    9    115
5     0     0    0    24    0  457     0     0     9   30      1
6    10     0    0     3    2    2  1867     0     4    3     16
7    14    19    2   144    1    0     9  6843   192    3     36
8     1     0    3    58    2    1     6    21  3165    6     32
9     1     0   16     4    1  159     0     1     9  301      1
10   13     3    1     6   43    3    27    10    56    1  12631
---- Validation: 
scalar performance:
{'acc': 0.94960546, 'precision': 0.879666, 'recall': 0.854357, 'specificity': 0.9946482, 'f1': 0.86234295, 'auroc': 0.99732316}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     2    0    1    16     2     1    2     31
1     0  1282    0     9    0    0     1    30     5    0      5
2     0     0  175     1   33    4     1     5     7   83      3
3     6     4    0  7944    0   17    11   165   288    2      3
4     7     0   16     1  349    1     6     2    29   10    118
5     0     0    0    21    0  459     0     0     7   33      1
6     8     0    0     0    0    1  1870     2     3    6     18
7    12    19    1   152    3    0     9  6838   198    4     29
8     1     0    1    39    5    3     7    24  3190    3     23
9     1     0   13     5    1  145     1     3     8  316      0
10   10     2    2     6   36    3    28    11    47    1  12650
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58805007, 'precision': 0.604352, 'recall': 0.47395286, 'specificity': 0.9576466, 'f1': 0.4470472, 'auroc': 0.83966815}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   188     0   0   30   0    2   751    24     8  151    16
1     2  1053   0   36   0    0    27   276     8    1    96
2     1     1   0   67   4   10   154    44   346   75   313
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  46    0    13     1    38    0  1535
5     1     0   0  264   0  171    16     0    24  115     1
6     0     0   0    2   0    1  2574     5    23    1   461
7     0     0   0    7   0    0    37  1101     9    0    10
8     0     0   0  100   0    0    26     4  1227    3    10
9     2     5   1  320   0   36   122    79   130  405    37
10    0     0   0    0   2    0     1     0     3    0  1640
early stop counter: 1
val acc:0.9496054649353027, best validation acc: 0.9497392177581787, corresponding to test acc:                         0.526621401309967 / 0.6032323241233826
after epoch: 10,now: 2024-08-12 12:08:56.499962,epoch time: 0:30:16.575394,used: 4:59:25.503378,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:59:25.503378 at 2024-08-12 12:08:56.499962
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5266214, 'precision': 0.6266258, 'recall': 0.4496639, 'specificity': 0.95185375, 'f1': 0.42473698, 'auroc': 0.83566046}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   149     0   0   46    0    1   570    66    16  258    64
1     1  1031   0   40    0    0     9   293     2    0   123
2     0     1   3   65   16    6    22    85   274   84   459
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  137    0     1     2    38    0  1455
5     0     0   0  278    0  138     2     1    21  151     1
6     2     0   0    3    2    0  1580     4    64    0  1412
7     0     0   0   10    0    0    11  1126     6    0    11
8     0     0   1   96    0    0     3     9  1242    3    16
9     2     1   4  296    0   15    31   134    91  491    72
10    0     0   0    0   14    0     0     0     2    0  1630
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6032323, 'precision': 0.6373842, 'recall': 0.5032011, 'specificity': 0.95880914, 'f1': 0.47617877, 'auroc': 0.8471133}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   107     0   1   15    0    0   820    18    13  173    23
1     0  1205   0   31    0    0    23   163     9    0    68
2     0     3  11   21   47   12   116    42   330   87   346
3     0     0   0    0    0    0     0     0     0    0     0
4     0     1   1    0  167    0     9     1    19    0  1435
5     0     0   0  146    0  285    10     0    15  135     1
6     5     0   0    1    2    0  2389     2     6    1   661
7     0     7   0    6    0    0    82  1047    13    0     9
8     0     0   1   41    3    2    21     1  1263   17    21
9     1    19   8  123    3   49   104   103   178  515    34
10    0     1   0    0   11    0     1     0     0    0  1633
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_09_30_seed_0_24142622_instance_wise_predictions.txt
accuracy from prediction file 0.5266214230742321
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/30.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/30.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/30.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 489073 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool | 397440 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |  91633 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 489073 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool | 397440 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |  91633 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478828 KiB |  10851 MiB |    848 TiB |    848 TiB |
|       from large pool | 387840 KiB |  10780 MiB |    847 TiB |    847 TiB |
|       from small pool |  90988 KiB |    126 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11310 MiB |  11310 MiB |  11310 MiB |      0 B   |
|       from large pool |  11182 MiB |  11182 MiB |  11182 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 782735 KiB |    807 MiB | 443781 GiB | 443780 GiB |
|       from large pool | 767872 KiB |    806 MiB | 442982 GiB | 442981 GiB |
|       from small pool |  14863 KiB |     15 MiB |    799 GiB |    799 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3951    |    5175    |   44483 K  |   44479 K  |
|       from large pool |      87    |     490    |   24459 K  |   24459 K  |
|       from small pool |    3864    |    5069    |   20023 K  |   20019 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3951    |    5175    |   44483 K  |   44479 K  |
|       from large pool |      87    |     490    |   24459 K  |   24459 K  |
|       from small pool |    3864    |    5069    |   20023 K  |   20019 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     181    |     181    |     181    |       0    |
|       from large pool |     117    |     117    |     117    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      47    |     989    |   18709 K  |   18709 K  |
|       from large pool |      17    |      65    |    9974 K  |    9974 K  |
|       from small pool |      30    |     972    |    8735 K  |    8735 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10851 MiB |    848 TiB |    848 TiB |
|       from large pool |  16640 KiB |  10780 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |    126 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1242 MiB |  11310 MiB |  11310 MiB |  10068 MiB |
|       from large pool |   1138 MiB |  11182 MiB |  11182 MiB |  10044 MiB |
|       from small pool |    104 MiB |    128 MiB |    128 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    836 MiB | 443781 GiB | 443781 GiB |
|       from large pool | 134912 KiB |    810 MiB | 442982 GiB | 442982 GiB |
|       from small pool |      0 KiB |     35 MiB |    799 GiB |    799 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5175    |   44483 K  |   44483 K  |
|       from large pool |       2    |     490    |   24459 K  |   24459 K  |
|       from small pool |       0    |    5069    |   20023 K  |   20023 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5175    |   44483 K  |   44483 K  |
|       from large pool |       2    |     490    |   24459 K  |   24459 K  |
|       from small pool |       0    |    5069    |   20023 K  |   20023 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      73    |     181    |     181    |     108    |
|       from large pool |      21    |     117    |     117    |      96    |
|       from small pool |      52    |      64    |      64    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     989    |   18711 K  |   18711 K  |
|       from large pool |       3    |      65    |    9974 K  |    9974 K  |
|       from small pool |       0    |     972    |    8736 K  |    8736 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10851 MiB |    848 TiB |    848 TiB |
|       from large pool |  16640 KiB |  10780 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |    126 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1242 MiB |  11310 MiB |  11310 MiB |  10068 MiB |
|       from large pool |   1138 MiB |  11182 MiB |  11182 MiB |  10044 MiB |
|       from small pool |    104 MiB |    128 MiB |    128 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    836 MiB | 443781 GiB | 443781 GiB |
|       from large pool | 134912 KiB |    810 MiB | 442982 GiB | 442982 GiB |
|       from small pool |      0 KiB |     35 MiB |    799 GiB |    799 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5175    |   44483 K  |   44483 K  |
|       from large pool |       2    |     490    |   24459 K  |   24459 K  |
|       from small pool |       0    |    5069    |   20023 K  |   20023 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5175    |   44483 K  |   44483 K  |
|       from large pool |       2    |     490    |   24459 K  |   24459 K  |
|       from small pool |       0    |    5069    |   20023 K  |   20023 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      73    |     181    |     181    |     108    |
|       from large pool |      21    |     117    |     117    |      96    |
|       from small pool |      52    |      64    |      64    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     989    |   18711 K  |   18711 K  |
|       from large pool |       3    |      65    |    9974 K  |    9974 K  |
|       from small pool |       0    |     972    |    8736 K  |    8736 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_12_21_14_seed_1_24142622

 Experiment start at: 2024-08-12 12:21:14.479180
before training, model accuracy: 0.06989435851573944
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.82111514, 'precision': 0.4807756, 'recall': 0.44321078, 'specificity': 0.97948563, 'f1': 0.43625933, 'auroc': 0.9571897}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    2   0    16   0   4   295    18    48   0    100
1    0  972   0    18   0   0     1   284     7   0     50
2    0    1   0    11   0   0   146    18    67   0     69
3    0    8   0  7334   0   0     8   508   547   0     33
4    0    1   0     4   0   0    90    13    57   0    374
5    0    0   0   329   0  20    89     6    74   1      2
6    0    5   0     9   0   0  1352    32   108   0    401
7    0   82   0   480   0   0    12  6125   294   0    270
8    0    5   0   225   0   0   136   121  2317   0    491
9    0    1   0   118   0   8   221    19   117   0      9
10   0    3   0    11   0   0    87    58    64   0  12570
---- Validation: 
scalar performance:
{'acc': 0.8230039, 'precision': 0.48369923, 'recall': 0.44480222, 'specificity': 0.97972196, 'f1': 0.43717456, 'auroc': 0.95690054}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    3   0    17   0   4   303    20    43   0     93
1    0  968   0    13   0   0     0   284    11   0     56
2    0    1   0    11   0   0   147    22    64   0     67
3    0   12   0  7344   0   0    11   480   558   0     35
4    0    1   0     1   0   0    94    10    57   0    376
5    0    0   0   323   0  18    86     1    91   0      2
6    0    5   0    19   0   0  1347    34   122   0    381
7    0   68   0   491   0   0    12  6116   297   0    281
8    0    4   0   180   0   0   105   118  2412   0    477
9    0    0   0   126   0   6   217    24   115   0      5
10   0   14   0    13   0   0    90    54    62   0  12563
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36493388, 'precision': 0.2493017, 'recall': 0.27565473, 'specificity': 0.9320637, 'f1': 0.23651418, 'auroc': 0.7430034}
confusion matrix:
    0    1   2    3   4   5     6    7    8   9     10
0    0    0   0    4   0   0  1127    1   35   0     3
1    0  948   0   11   0   0    78   42   63   0   357
2    0    1   0   14   0   0   640    2  121   0   237
3    0    0   0    0   0   0     0    0    0   0     0
4    0    0   0    0   0   0    49    0    3   0  1581
5    0    0   0  300   0   0    97    0  194   0     1
6    0    0   0    0   0   0  1475    1    9   0  1582
7    0  120   0    1   0   0   255  630   82   0    76
8    0    0   0   24   0   0   704    1  519   0   122
9    0   10   0   80   0   0   584    7  431   0    25
10   0    0   0    0   0   0     2    0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 12:52:34.572024,epoch time: 0:31:20.092844,used: 0:31:20.092844,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_12_21_14_seed_1_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88045806, 'precision': 0.7411525, 'recall': 0.61682856, 'specificity': 0.9866128, 'f1': 0.6249558, 'auroc': 0.98256654}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   97     0   2    12   0   29   122    15    31   85     90
1    0  1086   0    20   0    0     0   188    10    1     26
2    6     3  37    10   6    9     3    24    43  105     66
3    0     4   0  7619   0   61     3   384   355    2     10
4    6     0   7     2   9    4     9     3    88   26    385
5    1     0   1    90   0  372     0     0    10   45      2
6   18     5   1    15   0   12  1619    19    57   17    144
7    0    70   0   378   0    0     2  6443   260    2    110
8    0     2   1   177   0    5    17    95  2845   10    141
9    2     3  10    33   0  175     3    10    36  214      7
10  10    10   2     8   0    1    41    44   105    6  12567
---- Validation: 
scalar performance:
{'acc': 0.88276047, 'precision': 0.73798037, 'recall': 0.61750835, 'specificity': 0.9868566, 'f1': 0.62574905, 'auroc': 0.9822574}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   85     1   2    12   0   30   126    17    27   94     89
1    0  1090   0    13   0    1     0   195    10    1     22
2    4     2  37     6  11    7     3    17    49  109     67
3    0     5   0  7632   0   55     3   401   335    3      6
4    4     0   3     4  12    7     6     8    81   30    384
5    1     0   0    96   0  367     0     0    12   44      1
6   18     5   1    10   0    9  1624    19    53   19    150
7    0    66   1   349   0    1     5  6506   221    1    115
8    0     4   1   175   0    7    13    96  2860    7    133
9    0     2  13    31   0  169     2    13    32  223      8
10   5     8   0    11   2    2    44    45   106    7  12566
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47547752, 'precision': 0.55227745, 'recall': 0.39513984, 'specificity': 0.946287, 'f1': 0.3561651, 'auroc': 0.81390953}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   21     1   0   19   0   20   778    4   130  183    14
1    0  1131   0   26   0    0    20   76    88    0   158
2    0     4   1   39   0   21    56    7   528   49   310
3    0     0   0    0   0    0     0    0     0    0     0
4    0     0   0    0   0    0     6    0    19    0  1608
5    0     0   0  334   0  188     8    0    40   21     1
6    2     1   0    1   0    0  1630    1   132    9  1291
7    0    83   0   11   0    0    66  822   136    3    43
8    0     0   0  101   0    2    10    0  1174    8    75
9    0    15   0  241   0   89    37   11   531  183    30
10   0     0   0    0   0    0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 13:22:40.787954,epoch time: 0:30:06.215930,used: 1:01:26.308774,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_12_21_14_seed_1_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9055811, 'precision': 0.7872416, 'recall': 0.73416364, 'specificity': 0.9896619, 'f1': 0.7553421, 'auroc': 0.9892669}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   243     0    0     6    5    0   117     8     8    3     93
1     0  1227    3     9    1    1     2    70     6    0     13
2    13     1  150     1   72    0     4     1    13   42     15
3     2     0    1  7421    1   22    20   470   493    6      4
4     4     0   16     0  236    1     8     3    31    6    233
5    11     0    3    74    1  292     4     0    12  121      3
6    16     0    1     2    1    1  1813     7     9    3     55
7     2    24    7   182    8    0    10  6673   246    2    109
8     1     2   12    83   41    1    43    65  2914    3    131
9    25     2   70    14    7   68     4     4    19  273      7
10   11     1    1     6   36    2    54    22    51    1  12605
---- Validation: 
scalar performance:
{'acc': 0.9083857, 'precision': 0.7983377, 'recall': 0.7427697, 'specificity': 0.989952, 'f1': 0.7649405, 'auroc': 0.9898689}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   250     0    2     4    2    1    99     9    14    7     95
1     0  1226    1     9    2    0     0    72     6    0     16
2     5     2  148     1   74    0     3     5    12   48     14
3     1     1    0  7475    0   27    18   435   474    4      5
4     5     0   14     1  255    1     8     2    24    8    221
5    10     0    3    68    1  308     5     0     9  115      2
6     8     1    1     2    0    1  1817     9    16    3     50
7     1    26    5   184    5    0    11  6695   230    1    107
8     0     3    9    82   47    0    41    73  2906    1    134
9    25     1   73    21    4   53     9     4    15  280      8
10    9     0    2     8   45    1    60    20    51    0  12600
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50192404, 'precision': 0.5574117, 'recall': 0.3890106, 'specificity': 0.9479301, 'f1': 0.3531108, 'auroc': 0.8309695}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0   62     0   0    6   0   0  1038    2    27    6    29
1    0  1190   0   23   0   0    24   99    26    0   137
2    3     8   7   21  16   0   129   13   226    6   586
3    0     0   0    0   0   0     0    0     0    0     0
4    0     0   0    0  17   0     6    0     6    0  1604
5    6     0   0  301   0  50   101    0    97   35     2
6    5     1   0    1   0   0  2160    1     5    0   894
7    3    21   0    4   0   0   147  897    47    0    45
8    0     0   0   39   2   0    60    1  1016    0   252
9   17    27  32  128   5   3   191   23   458  131   122
10   0     0   0    0   2   0     0    0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 13:52:25.749966,epoch time: 0:29:44.962012,used: 1:31:11.270786,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_12_21_14_seed_1_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.907561, 'precision': 0.7844788, 'recall': 0.773239, 'specificity': 0.9899969, 'f1': 0.7754743, 'auroc': 0.987585}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   302    10    2     9    4    0    42    11     4    6     93
1     0  1191    2    20    1    0     0   101     6    0     11
2     5     4  181     1   48    2     2     4     4   56      5
3     1   101    0  7769    0   46    12   263   230    8      6
4     0     2   32     0  307    4     5     3    23    5    158
5     3     3    2    53    1  404     1     0     4   49      1
6    36    25    0    11    2    6  1745     9     9    2     61
7     2   189   14   328    3    0     9  6449   179    4     87
8     2    31   14   149   41    7    26    56  2840    8    121
9     6     2   50    15    1  153     1     4    10  246      5
10   12    81    7     8  106    1    19    36    38    0  12487
---- Validation: 
scalar performance:
{'acc': 0.907503, 'precision': 0.7814565, 'recall': 0.7676625, 'specificity': 0.98997664, 'f1': 0.7710749, 'auroc': 0.98767745}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   303     9    4     4    1    3    45     8     6    4     96
1     0  1176    0    10    1    1     1   126     6    0     11
2     5     1  170     1   53    4     2     3     7   60      6
3     2   109    1  7767    0   49     5   267   222   10      8
4     1     3   34     1  303    1     3     2    22   12    157
5     0     4    4    49    0  403     2     0     7   51      1
6    33    34    2     6    5    1  1748     8     8    2     61
7     4   154   14   304    5    0    12  6479   183    3    107
8     1    42   11   148   43   10    19    60  2832    4    126
9     1     2   55    13    4  154     5     5     7  241      6
10   13    93    6    11   88    1    22    28    29    0  12505
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57300776, 'precision': 0.6287348, 'recall': 0.45873746, 'specificity': 0.9555997, 'f1': 0.4493305, 'auroc': 0.8483903}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   189     0   1   16    0    1   891    1     8   32    31
1     0  1294   0   27    0    0    15   59    14    0    90
2     1    17  26   31   26   12   102   18   234   42   506
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   0    0  127    0     7    0     9    0  1489
5     1     0   0  290    0  185    40    1    28   46     1
6     9     3   0    1    1    0  2471    1     4    1   576
7     1    68   1   12    0    0   198  821    28    2    33
8     0     0   1   72    5    0    49    2  1110    8   123
9     3    48  47  189    2   51   110   33   268  328    58
10    0     1   0    0    6    0     0    0     0    0  1639
new oracle model saved
early stop counter: 1
val acc:0.9075030088424683, best validation acc: 0.908385694026947, corresponding to test acc:                         0.5019240379333496 / 0.5730077624320984
after epoch: 4,now: 2024-08-12 14:22:51.628569,epoch time: 0:30:25.878603,used: 2:01:37.149389,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_12_21_14_seed_1_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9201627, 'precision': 0.8315072, 'recall': 0.78833944, 'specificity': 0.99139196, 'f1': 0.8063799, 'auroc': 0.9931476}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   341     2    1     4    2    0    46    16     7    2     61
1     0  1103    1     8    0    0     0   206     5    0      9
2     6     0  184     2   48    1     2    10    18   37      4
3     3    22    0  7499    0    7     4   538   362    0      1
4     3     1   36     0  311    3     4     5    46    5    125
5     4     0    3    65    0  389     1     1    16   41      1
6    20     5    1     2    3    0  1794    16    23    2     41
7     1    24    1    94    1    0     1  6982   127    0     33
8     1     6    3    64   12    0     6   104  3067    0     33
9    12     0   57    16    3  109     1     9    23  260      3
10   12    21    3     6  105    1    24    54   106    0  12462
---- Validation: 
scalar performance:
{'acc': 0.9215461, 'precision': 0.83088493, 'recall': 0.7944475, 'specificity': 0.99155223, 'f1': 0.80975544, 'auroc': 0.99301577}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     2    1     4    1    0    33    15    13    3     65
1     0  1125    2     9    0    0     0   176     9    0     11
2     4     1  198     0   42    1     3     5    13   43      2
3     1    25    0  7507    0    9     3   556   337    0      2
4     2     1   30     0  327    1     4     7    42    5    120
5     2     2    2    59    0  380     1     0    18   55      2
6    19     7    1     0    1    1  1806    14    15    1     43
7     1    32    2    91    1    0     2  6971   140    1     24
8     2    12    4    65    9    0     5   108  3055    0     36
9     9     1   65    13    0  117     5     8    22  251      2
10   19    19    2     4   96    2    28    52    88    0  12486
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5720283, 'precision': 0.6617503, 'recall': 0.44424462, 'specificity': 0.956143, 'f1': 0.39410943, 'auroc': 0.84588814}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   123     0   0   22    0   0   853    65    61    6    40
1     0  1208   0   27    0   0     5   186    19    0    54
2     0     8   5   53    6   1    59    59   564    8   252
3     0     0   0    0    0   0     0     0     0    0     0
4     0     2   0    0  125   0     7     0    55    0  1444
5     0     0   0  402    0  54    26     4    87   18     1
6     5     3   0    2    1   0  2524     2    69    0   461
7     0     5   0    5    0   0    13  1124    10    0     7
8     0     0   0   63    0   0     6    18  1276    0     7
9     1    21   3  254    0  15    61   177   476  102    27
10    0     1   0    0    7   0     0     0     3    0  1635
better model found
persisted
after epoch: 5,now: 2024-08-12 14:53:55.642696,epoch time: 0:31:04.014127,used: 2:32:41.163516,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_12_21_14_seed_1_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92725277, 'precision': 0.8237552, 'recall': 0.8180978, 'specificity': 0.9923606, 'f1': 0.81762147, 'auroc': 0.9934389}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   340     5    0     4    1    2    46     5    10    9     61
1     0  1215    0    11    0    0     0    91     8    1      5
2     0     3  173     0   32    0     1     2     3   98      0
3     1    55    1  7752    1   66     7   254   289   11      0
4     4     1   41     1  322    2     2     3    38   17    107
5     0     0    2    24    0  428     2     0     9   55      1
6     9     4    0     4    0    1  1854     9     8    4     15
7     0    62   11   214    3    0    13  6732   203    9     17
8     0    15    7    72    6    7    13    61  3085    7     22
9     0     1   15     5    1  121     2     0     9  337      2
10   14    34    8     6  113    1    32    45   119    3  12419
---- Validation: 
scalar performance:
{'acc': 0.9273773, 'precision': 0.82322943, 'recall': 0.8154055, 'specificity': 0.99237, 'f1': 0.8155408, 'auroc': 0.9934449}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   330     4    0     3    1    1    56     9     9   10     60
1     0  1233    0    13    1    0     1    72     9    0      3
2     0     1  168     0   27    1     2     3     8   98      4
3     1    48    0  7756    0   68     7   248   303    7      2
4     0     2   46     2  321    2     1     4    43   13    105
5     1     4    0    19    0  428     0     0     7   61      1
6     5     6    0     6    1    1  1844     6    10    6     23
7     1    68    5   210    5    1    11  6722   210   13     19
8     1     9    6    72    5    5    11    70  3086    9     22
9     4     0   20     5    0  114     3     1     7  338      1
10   12    39   13     6  108    2    32    44    90    6  12444
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5895893, 'precision': 0.6474244, 'recall': 0.47266006, 'specificity': 0.9576522, 'f1': 0.44094783, 'auroc': 0.84669185}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   48     0   0   17   0    1   847    6    34  135    82
1    0  1250   0   34   0    0    14  102    31    0    68
2    0     7  11   31  22   13    40   15   549   90   237
3    0     0   0    0   0    0     0    0     0    0     0
4    0     2   0    0  85    0    11    0    60    0  1475
5    0     0   0  255   0  209    21    0    36   70     1
6    3     1   0    2   1    1  2602    1    48    2   406
7    0    12   0   29   0    0   152  878    76    7    10
8    0     0   0   60   1    2    13    1  1271    5    17
9    0    21   6  190   0   57    48   22   334  436    23
10   0     1   0    0   3    0     3    0     2    0  1637
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 15:24:01.328663,epoch time: 0:30:05.685967,used: 3:02:46.849483,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_12_21_14_seed_1_24142622
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
slurmstepd: error: *** JOB 24142622 ON gpusrv33 CANCELLED AT 2024-08-12T15:40:29 ***
