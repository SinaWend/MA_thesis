Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 23:18:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/29.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=29
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419

 Experiment start at: 2024-08-11 23:27:03.610873
before training, model accuracy: 0.05282306298613548
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.83334225, 'precision': 0.6224258, 'recall': 0.45347196, 'specificity': 0.98116404, 'f1': 0.4528979, 'auroc': 0.960789}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    43   0   3   315    21    34   3     64
1    0  814   0   328   0   0     2   136     6   0     46
2    0    3   1    15   0   2   141    29    96   2     23
3    0    0   0  7686   0   0     5   400   330   0     14
4    0    0   0     8   0   0   123     7    95   0    306
5    1    0   0   326   0  47    82     1    57   6      1
6    0    4   0    63   0   2  1466    20   110   1    241
7    0   25   0   630   0   0     8  6275   201   0    125
8    0    0   0   334   0   0    60   143  2482   0    277
9    0    1   0   133   0  26   208    21    91  10      3
10   0    7   0    89   0   0   194    40    98   0  12366
---- Validation: 
scalar performance:
{'acc': 0.8334359, 'precision': 0.52758867, 'recall': 0.45529985, 'specificity': 0.9811795, 'f1': 0.45516318, 'auroc': 0.9621026}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    1   0    49   0   4   316    19    30   1     63
1    0  818   0   294   0   0     0   164     7   0     49
2    0    1   0    16   0   2   138    23    99   1     32
3    0    1   0  7677   0   0     3   422   327   0     10
4    0    1   0     5   0   0   106     8   100   0    319
5    0    0   0   313   0  56    80     0    56  15      1
6    0    4   0    49   0   1  1476    19   119   1    239
7    0   38   0   625   0   0     6  6265   195   0    136
8    0    0   0   333   0   0    78   150  2477   0    258
9    0    1   0   124   0  26   214    17    98  11      2
10   0    4   0   100   0   0   178    37    99   0  12378
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4076821, 'precision': 0.41086322, 'recall': 0.32999057, 'specificity': 0.93826616, 'f1': 0.2785117, 'auroc': 0.77001184}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     2   0   34   0   0  1092   30   10   0     2
1    0  1054   0   26   0   0    39  181   14   0   185
2    0     2   0  119   0   1   387   32  293   0   181
3    0     0   0    0   0   0     0    0    0   0     0
4    0     1   0    1   0   0    34    1   12   0  1584
5    0     0   0  438   0   9    71    0   72   0     2
6    0     2   0    1   0   0  1199    2   50   0  1813
7    0    87   0    5   0   0    81  926   34   0    31
8    0     0   0   85   0   1   240    4  993   0    47
9    0    13   0  470   0   3   320   56  257   1    17
10   0     0   0    0   0   0     1    0    0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 00:04:14.121114,epoch time: 0:37:10.510241,used: 0:37:10.510241,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8928457, 'precision': 0.7755562, 'recall': 0.6410803, 'specificity': 0.98823905, 'f1': 0.665817, 'auroc': 0.98505354}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   149     0   2    23   0    8   171    14    26   48     42
1     0  1050   0   131   0    0     2   129     4    0     16
2     6     2  45     8  23    6    13    28    67  103     11
3     0     4   0  7834   0   19     2   367   210    3      1
4     0     0  23     6  67    3    31    17   113   28    251
5     1     0   0   122   0  320     1     0    13   62      1
6     7     2   0    16   1    6  1759    15    42    8     52
7     0    26   0   357   1    0     4  6710   128    0     36
8     0     0   0   248   1    1    14   135  2831    0     65
9     2     2  12    47   0  143     3    14    34  232      4
10    4     9   1    30   3    2   147    51   166    5  12374
---- Validation: 
scalar performance:
{'acc': 0.89255047, 'precision': 0.78150123, 'recall': 0.64642936, 'specificity': 0.988217, 'f1': 0.6734052, 'auroc': 0.98482966}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   158     1   1    20   0   10   179    23    20   34     37
1     0  1066   0   111   0    0     1   132     6    0     16
2     1     0  66     6  16   11    13    23    68  100      8
3     0     4   0  7832   0   17     4   382   199    1      1
4     0     0  24     5  62    1    35     9   122   28    253
5     0     0   1   126   0  323     0     0    14   56      1
6     7     6   0    21   0    8  1749    12    46    8     51
7     0    21   0   358   1    0     6  6718   124    0     37
8     0     1   2   263   1    0    16   138  2812    3     60
9     4     1  19    49   0  142     4    15    37  221      1
10    3    10   1    36   9    3   155    45   170    3  12361
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53067935, 'precision': 0.502173, 'recall': 0.41924936, 'specificity': 0.95144576, 'f1': 0.3679636, 'auroc': 0.8366344}
confusion matrix:
    0     1   2    3   4    5     6     7     8   9     10
0    8     0   0   49   0    6  1014    35    19  39     0
1    0  1107   0   27   0    0    28   244     9   0    84
2    0     1   1   95   0   14   290    63   391   6   154
3    0     0   0    0   0    0     0     0     0   0     0
4    0     1   0    0   0    0    30     1    26   0  1575
5    1     0   0  396   0  131    28     0    28   7     1
6    0     1   0    1   0    3  2309     2    24   2   725
7    0    13   0    3   0    0    36  1080    22   0    10
8    0     0   0   83   0    3    39     3  1224  11     7
9    0    11   3  402   0   76   208   109   233  81    14
10   0     0   0    0   0    0     2     0     0   0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 00:40:16.958766,epoch time: 0:36:02.837652,used: 1:13:13.347893,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91879815, 'precision': 0.8027771, 'recall': 0.74930286, 'specificity': 0.9909845, 'f1': 0.76984185, 'auroc': 0.9913084}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   281     0    1    12    3    3    67    11     9   14     82
1     0  1242    1    20    1    0     0    52     3    0     13
2     1     3  115     4   61    4     3     8    17   90      6
3     1     0    1  7980    1   34     4   225   179    4      9
4     2     0   29     0  255    3     5     5    33   15    192
5     2     0    2    56    0  402     1     0     7   49      2
6    18     2    0     9    3    3  1733     6    17   11    104
7     0    43    3   366    4    0     4  6648   118    2     76
8     0     2    5   194   31    4    10    88  2851    5    103
9     5     1   38    16    1  163     5     3    11  244      6
10   12     2    2    11   69    1    36    20    50    2  12590
---- Validation: 
scalar performance:
{'acc': 0.9195399, 'precision': 0.81071705, 'recall': 0.7503552, 'specificity': 0.9910461, 'f1': 0.7739943, 'auroc': 0.9915073}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   279     0    2    14    1    3    56     8    10   16     94
1     0  1231    1    22    2    0     1    58     4    0     13
2     1     1  118     2   68    4     4     7    16   85      6
3     1     1    0  7947    0   43     5   239   193    3      8
4     1     0   26     2  246    2     1     5    46   14    196
5     1     0    0    63    0  387     1     0     6   61      2
6    12     0    2    10    7    2  1749     4    20    6     96
7     0    37    5   337    5    0     1  6670   138    1     71
8     1     2    7   198   25    3    12    83  2854    8    103
9     3     0   38    22    3  132     3     5    13  269      5
10   11     2    1    10   51    1    26    17    48    2  12627
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5007346, 'precision': 0.5674015, 'recall': 0.43877983, 'specificity': 0.94879174, 'f1': 0.4046794, 'auroc': 0.8360761}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   96     0   1   54   0   13   809    19    48  103    27
1    0  1169   0   33   0    0    18   144    15    0   120
2    0     6  23   58  24   30    58    28   424   21   343
3    0     0   0    0   0    0     0     0     0    0     0
4    0     1   0    0  50    0     2     1    14    0  1565
5    0     0   0  244   0  296     6     0    27   17     2
6    5     1   2    1   8    2  1429     1    19    1  1598
7    1    18   0   17   0    0    63  1008    30    1    26
8    0     0   1   72   1   10     8     0  1252    7    19
9    0    21  45  299   2  151    58    44   282  189    46
10   0     0   0    0   1    0     0     0     0    0  1645
better model found
persisted
after epoch: 3,now: 2024-08-12 01:16:02.721281,epoch time: 0:35:45.762515,used: 1:48:59.110408,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9239352, 'precision': 0.8043288, 'recall': 0.79921913, 'specificity': 0.9917735, 'f1': 0.80058736, 'auroc': 0.992678}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   361     0    1     4    0    3    16     5     7   14     72
1     2  1183    1    30    0    0     0    78     7    0     31
2     4     1  175     0   36    2     0     4     7   78      5
3     7     4    1  7821    0   70     5   260   252   14      3
4     1     0   51     2  291    1     3     3    29   19    139
5     1     0    2    31    0  389     0     0     5   92      1
6    62     0    4     7    5    0  1747     4    13   11     53
7     7    40    9   241   11    0     7  6710   171    6     62
8     3     3    8   135   29    8    25    54  2948   10     73
9     4     1   34     9    0  104     1     2     7  327      4
10   16     3    9    11   86    3    20    14    44    6  12581
---- Validation: 
scalar performance:
{'acc': 0.9217601, 'precision': 0.79515004, 'recall': 0.7912239, 'specificity': 0.99152726, 'f1': 0.7918035, 'auroc': 0.99247503}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   363     0    3     2    0    1    17     8     5   12     72
1     0  1196    1    30    1    0     2    68     7    0     27
2     2     2  157     1   37    1     1     4     7   97      3
3     9     4    0  7799    0   63    11   290   251   10      3
4     4     0   60     0  271    3     3     4    26   14    154
5     2     0    1    32    1  389     0     0     6   89      1
6    64     2    1    11    3    2  1747     1     9   13     55
7     6    58   16   248    8    0     9  6696   156    2     66
8     4     2   15   121   23    4    14    64  2949   13     87
9     2     1   32     8    0  113     0     1     6  327      3
10   20     4    6    13   91    4    23    16    46    7  12566
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5775554, 'precision': 0.617794, 'recall': 0.49675483, 'specificity': 0.9567915, 'f1': 0.4744647, 'auroc': 0.8491542}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   243     0   1   26   0   12   560    13     7  294    14
1     1  1193   0   38   0    0    18   156     4    1    88
2     0     7  28   55  15   35    85    47   262   93   388
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   1    0  65    0    12     1    18    0  1535
5     1     0   0  175   0  345     3     0     6   60     2
6    23     0   2    1   2    2  2098     1     2    2   934
7     3     9   0   13   0    0    81  1026    10    6    16
8     0     0   2  108   1   12    16     1  1154   41    35
9     1    21  26  230   0  137    49    74    94  460    45
10    0     1   0    0   2    0     0     0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 01:51:48.182500,epoch time: 0:35:45.461219,used: 2:24:44.571627,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.930838, 'precision': 0.8352633, 'recall': 0.79456705, 'specificity': 0.99247116, 'f1': 0.8098439, 'auroc': 0.99428993}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   357     1    0     0    0    1    35     7     6    2     72
1     0  1195    1    21    1    0     0    80     8    0     26
2     3     0  140     1   37    1     2     7     9  108      4
3     3     0    0  7670    0   41    16   390   315    1      4
4     0     1   32     0  293    2     6     5    31   12    157
5     2     0    0    40    0  435     0     1    10   31      2
6    12     0    0     2    0    1  1835     4    14    1     38
7     2    15    7   123    3    0     8  6936   124    3     43
8     1     3    3    60   18    2    11    76  3044    4     74
9     5     0   26    11    1  166     3     4     9  265      3
10    8     0    7    11   56    2    25    15    46    0  12621
---- Validation: 
scalar performance:
{'acc': 0.9296509, 'precision': 0.8366436, 'recall': 0.7951612, 'specificity': 0.99235344, 'f1': 0.81071216, 'auroc': 0.99408567}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   354     0    0     2    0    0    41     7     6    4     69
1     1  1190    0    21    2    0     2    88     6    0     22
2     2     0  148     1   46    2     2     3     9   91      8
3     4     1    0  7657    0   38    10   386   341    2      1
4     2     0   34     1  292    1     8     4    35   10    152
5     1     0    1    35    0  442     0     0    10   30      2
6     8     0    2     3    1    1  1832     5    11    2     43
7     0    12    4   111    3    0    11  6936   146    2     40
8     2     1    5    74   18    3    10    84  3019    2     78
9     7     0   21     7    1  169     3     4    14  262      5
10    9     1    6    12   57    1    29    13    44    1  12623
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56405234, 'precision': 0.62126124, 'recall': 0.460558, 'specificity': 0.954731, 'f1': 0.42656022, 'auroc': 0.83627564}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   61     0   0   27   0    5   988    7     9   62    11
1    0  1118   0   28   0    0    28  201     6    0   118
2    0     1   6   46   9   20   109   52   379   46   347
3    0     0   0    0   0    0     0    0     0    0     0
4    0     0   1    0  52    0    10    1    25    0  1544
5    0     0   0  227   0  270    29    0    22   42     2
6    4     0   0    1   1    0  2419    2    11    0   629
7    0     1   0   14   0    0   141  976    18    0    14
8    0     0   1   64   1    4    28    3  1244    3    22
9    2    13   5  248   0  101   140  119   182  276    51
10   0     0   0    0   3    0     3    0     0    0  1640
better model found
persisted
after epoch: 5,now: 2024-08-12 02:27:35.298841,epoch time: 0:35:47.116341,used: 3:00:31.687968,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9314266, 'precision': 0.8379195, 'recall': 0.8359005, 'specificity': 0.99268365, 'f1': 0.83468974, 'auroc': 0.9947902}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   369     1    0     3    2    1    22     2     6    6     71
1     1  1268    0     7    1    0     0    41     9    0      5
2     1     0  180     0   41    1     4     5     5   74      1
3     1     3    1  7567    0   22     9   462   364   10      0
4     3     0   39     0  381    2     1     2    16    9     86
5     1     0    0    28    1  430     0     0     6   53      2
6     7     0    1     4    3    0  1841     3     8    3     38
7     2    35    9    80    8    0     8  6899   176    2     44
8     0     0    8    58   48    0     8    68  3026    3     75
9     3     0   31     6    1  116     1     0     9  325      0
10    6     1    4    11  176    3    21    17    26    1  12527
---- Validation: 
scalar performance:
{'acc': 0.9321118, 'precision': 0.84324384, 'recall': 0.8401518, 'specificity': 0.99277145, 'f1': 0.83950925, 'auroc': 0.995226}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     2    0     2    2    1    24     2     8    4     64
1     0  1256    1     7    3    0     0    54     9    0      2
2     1     0  198     0   39    1     0     3     5   63      2
3     3     7    1  7533    0   25     6   475   381    4      5
4     1     1   34     0  380    1     1     5    14   12     90
5     1     0    1    38    0  424     0     0     8   48      1
6     4     0    1     2    7    0  1849     4     8    4     29
7     1    36   11    83    8    0     5  6888   193    2     38
8     1     0    7    44   47    5     3    58  3068    1     62
9     4     1   29     5    2  122     0     1     7  320      2
10    4     2    5    10  160    3    17    11    26    1  12557
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60554117, 'precision': 0.62849545, 'recall': 0.5040112, 'specificity': 0.9592486, 'f1': 0.47719622, 'auroc': 0.85068583}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   88     0   1   19    0    2   758    24    27  223    28
1    0  1214   0   28    0    0    21   159     9    0    68
2    0     4  14   25   57   17    97    47   359   78   317
3    0     0   0    0    0    0     0     0     0    0     0
4    0     0   1    0  255    0    12     1    19    0  1345
5    0     0   0  181    0  301     4     0    23   81     2
6    5     0   2    1    6    1  2406     2    12    1   631
7    0     6   0    6    0    0    86  1040    13    0    13
8    0     0   1   50    3    5    14     3  1272    8    14
9    1    16  10  159    2   77    86   118   196  440    32
10   0     1   0    0   19    0     1     0     0    0  1625
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 03:03:25.177960,epoch time: 0:35:49.879119,used: 3:36:21.567087,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9425032, 'precision': 0.8610119, 'recall': 0.83365023, 'specificity': 0.99385357, 'f1': 0.8437218, 'auroc': 0.99561435}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     0    0     3    1    3    21    10    11    3     52
1     0  1273    0     9    0    0     0    43     5    0      1
2     0     3  206     0   31    6     2     8     7   48      1
3     1     2    0  7908    0   12     3   295   213    0      4
4     3     1   38     0  338    2     2     6    47    9     93
5     0     0    0    43    0  443     1     0     6   26      1
6     8     2    3     3    1    3  1826     9    20    4     29
7     1    19    2   116    2    0     2  7021    87    1     13
8     2     0    5    90    5    1     6    85  3077    1     24
9     4     1   34     9    1  168     0     7    13  255      0
10   11     4    3     7   79    2    24    34   125    3  12501
---- Validation: 
scalar performance:
{'acc': 0.94192857, 'precision': 0.85741746, 'recall': 0.8296318, 'specificity': 0.99379253, 'f1': 0.8401117, 'auroc': 0.9958921}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     0    1     4    1    3    16    11     7   10     51
1     0  1271    0    11    0    0     0    46     1    0      3
2     2     0  196     1   26    1     2     9    13   61      1
3     0     4    1  7920    0   15     2   301   194    1      2
4     4     0   38     0  329    3     0     9    53    5     98
5     0     0    0    39    0  441     0     0    11   29      1
6     8     1    1     3    0    2  1835     6    14    2     36
7     3    24    1   119    0    0     2  6999    97    1     19
8     4     4    4    77    4    2     4    89  3095    1     12
9     2     1   34    11    1  167     1     9     9  258      0
10    7     8    8     5   79    4    17    32   144    1  12491
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5351571, 'precision': 0.5674298, 'recall': 0.44746664, 'specificity': 0.95314157, 'f1': 0.40568033, 'auroc': 0.8392641}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   60     0   0  107   0    9   591   106    26  257    14
1    0  1177   0   40   0    0     3   224     3    0    52
2    0     3   1  119   4   33    39   133   422   56   205
3    0     0   0    0   0    0     0     0     0    0     0
4    0     3   1    1  75    0     5     2   107    0  1439
5    0     0   0  329   0  228     1     0    13   20     1
6    5     0   1    5   1    2  1936    10   157    6   944
7    0     3   0    7   0    0    20  1126     2    0     6
8    0     0   0  147   0    2     2    13  1204    0     2
9    0    20   2  472   0  125    16   196    83  210    13
10   0     1   0    0   8    0     0     0     5    0  1632
better model found
persisted
after epoch: 7,now: 2024-08-12 03:39:24.637421,epoch time: 0:35:59.459461,used: 4:12:21.026548,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9450182, 'precision': 0.8592159, 'recall': 0.8519918, 'specificity': 0.99410087, 'f1': 0.8540218, 'auroc': 0.99623525}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   388     0    1     1    0    0    26     4     4    3     55
1     0  1266    1    11    2    0     0    42     6    0      4
2     2     0  216     1   51    0     0     3     6   30      3
3     3     4    1  7914    1   24    10   170   298    6      8
4     2     0   22     0  384    1     2     1    16    7    104
5     1     0    1    33    0  429     1     0     8   45      2
6     7     0    3     1    2    1  1855     1     6    2     30
7     4    22   18   144    7    0    11  6830   176    6     46
8     3     0    7    40   23    1    13    34  3096    1     77
9     2     0   58     2    2  113     2     0    12  300      2
10    4     2    5     6   96    2     8     6    17    3  12643
---- Validation: 
scalar performance:
{'acc': 0.9448977, 'precision': 0.85859144, 'recall': 0.8540062, 'specificity': 0.9940952, 'f1': 0.85471356, 'auroc': 0.99634296}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   391     0    0     1    1    2    21     2     4    3     58
1     0  1261    0    11    0    0     1    44    10    0      5
2     3     0  213     0   47    1     2     1     4   40      1
3     5     4    2  7901    2   20     8   161   326    7      4
4     2     0   23     0  396    1     2     3    11    5     96
5     1     0    1    23    1  442     0     0     6   46      1
6     8     0    0     1    2    2  1848     3     6    3     35
7     4    21   13   139    8    0     8  6844   166    3     59
8     0     0    6    48   31    0     6    36  3096    5     68
9     2     0   58     6    3  118     0     1     8  295      2
10    6     4    5     6   95    2    11     7    22    0  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5668509, 'precision': 0.63642734, 'recall': 0.4595613, 'specificity': 0.95551705, 'f1': 0.43763167, 'auroc': 0.83960426}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   84     0   0   35    0    1   837    22    12  150    29
1    1  1109   0   42    0    0    20   209     5    0   113
2    0     1   5   58   22    9    67    44   340   76   393
3    0     0   0    0    0    0     0     0     0    0     0
4    0     0   1    0  180    0     3     1    22    0  1426
5    0     0   0  314    0  156    12     0    31   77     2
6    2     0   0    1    2    1  2278     2    27    1   753
7    0     2   0   21    0    0    80  1037     5    1    18
8    0     0   0   84    2    1    18     3  1243    1    18
9    1     9   4  334    2   44    87    80   148  378    50
10   0     0   0    0   14    0     0     0     0    0  1632
better model found
persisted
after epoch: 8,now: 2024-08-12 04:15:05.181598,epoch time: 0:35:40.544177,used: 4:48:01.570725,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94956654, 'precision': 0.8811673, 'recall': 0.8561672, 'specificity': 0.9945222, 'f1': 0.86673033, 'auroc': 0.99639183}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     0    0     2    1    1     9     4     3    5     68
1     0  1240    1    13    2    0     0    67     4    1      4
2     1     0  192     0   46    3     0     7     4   56      3
3     2     1    0  7934    1   26     2   207   260    3      3
4     2     1   21     0  374    1     0     3    21    9    107
5     0     0    1    20    0  412     0     0     7   80      1
6     6     0    0     1    7    0  1835     3     9    3     44
7     2    14    3   127    5    0     0  6988    91    5     29
8     0     0    4    68   18    1     2    61  3098    2     41
9     3     0   21     7    1   63     0     0     7  388      3
10    4     0    1     5   83    3     8    11    35    0  12640
---- Validation: 
scalar performance:
{'acc': 0.9497392, 'precision': 0.8821268, 'recall': 0.85388756, 'specificity': 0.9945247, 'f1': 0.8657355, 'auroc': 0.99682015}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     1    0     5    0    1    13     3     3    0     71
1     0  1243    0     8    0    0     0    66     8    0      7
2     0     0  183     1   54    1     1     3     5   62      2
3     1     0    1  7944    0   20     0   204   263    3      4
4     1     0   14     0  384    2     1     3    15    9    110
5     0     0    0    20    0  416     0     0     6   78      1
6     9     0    1     3    4    1  1835     2     4    6     43
7     2    11    2   132    3    0     3  6972   104    3     33
8     0     0    5    68   16    3     0    48  3106    2     48
9     1     0   28     3    1   69     0     1     8  379      3
10    3     1    1     6   78    2     5     9    32    1  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53872526, 'precision': 0.6439861, 'recall': 0.45451522, 'specificity': 0.9532375, 'f1': 0.4347579, 'auroc': 0.8422349}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   132    0   0   72    0    0   525    69    12  285    75
1     1  992   0   39    0    0     8   331     2    0   126
2     0    0   4   71   20    5    18    90   261   93   453
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   1    0  227    0     1     3    34    0  1367
5     0    0   0  290    0  153     2     1    15  130     1
6     4    0   0    2    4    1  1762     2    44    1  1247
7     0    0   0   13    0    0    15  1117     7    0    12
8     0    0   1  110    0    0     4     7  1226    5    17
9     1    3   1  332    1   26    24   133    91  466    59
10    0    0   0    0   24    0     0     0     1    0  1621
better model found
persisted
after epoch: 9,now: 2024-08-12 04:50:59.255563,epoch time: 0:35:54.073965,used: 5:23:55.644690,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94956654, 'precision': 0.8757882, 'recall': 0.8492396, 'specificity': 0.99462706, 'f1': 0.8583519, 'auroc': 0.9969505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     2    0    1    15     1     2    5     31
1     0  1280    0    10    0    0     0    33     7    0      2
2     0     0  185     0   33    4     2     1     4   80      3
3     2     3    0  8009    1   15    13   128   257    3      6
4     1     0   20     0  344    3     2     0    37    7    125
5     0     0    0    30    0  449     0     0    10   31      1
6     9     1    0     1    2    1  1868     1     3    3     18
7    11    20    3   154    1    0     6  6822   207    3     36
8     3     0    2    56    2    1     4    19  3173    4     31
9     1     0   15     5    1  168     0     1    11  289      2
10   11     2    1     5   39    4    23     8    54    1  12646
---- Validation: 
scalar performance:
{'acc': 0.94992644, 'precision': 0.87917614, 'recall': 0.85195535, 'specificity': 0.9946709, 'f1': 0.8609496, 'auroc': 0.99717045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     1    0    1    17     1     2    2     29
1     0  1280    0    10    0    0     0    34     5    0      3
2     0     1  179     1   31    4     1     5     7   79      4
3     7     5    0  8005    0   14     9   140   256    1      3
4     6     0   19     0  341    2     4     3    32   11    121
5     0     0    0    28    0  453     0     0     8   31      1
6     8     0    0     0    1    0  1871     2     3    6     17
7    14    19    2   169    2    0     5  6802   217    4     31
8     1     0    1    41    3    1     9    22  3188    4     26
9     2     0   12     4    1  154     0     3     9  307      1
10   11     4    3     7   29    3    22     9    48    3  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57944447, 'precision': 0.641417, 'recall': 0.46730134, 'specificity': 0.9570371, 'f1': 0.4424463, 'auroc': 0.84232044}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   190     0   0   41   0    1   669    31     9  206    23
1     2  1038   0   40   0    0    39   272     9    0    99
2     0     1   3   76   4   10    99    43   381   84   314
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    0  59    0    10     1    41    0  1521
5     0     0   0  287   0  164    10     0    21  109     1
6     3     0   0    2   0    1  2504     4    27    1   525
7     0     0   0   11   0    0    50  1083    10    0    10
8     0     0   0  111   0    1    18     5  1220    3    12
9     3     4   2  373   0   34    80    79   139  383    40
10    0     0   0    0   6    0     1     0     1    0  1638
better model found
persisted
after epoch: 10,now: 2024-08-12 05:26:49.050326,epoch time: 0:35:49.794763,used: 5:59:45.439453,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:59:45.439453 at 2024-08-12 05:26:49.050326
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57944447, 'precision': 0.641417, 'recall': 0.46730134, 'specificity': 0.9570371, 'f1': 0.4424463, 'auroc': 0.84232044}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   190     0   0   41   0    1   669    31     9  206    23
1     2  1038   0   40   0    0    39   272     9    0    99
2     0     1   3   76   4   10    99    43   381   84   314
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    0  59    0    10     1    41    0  1521
5     0     0   0  287   0  164    10     0    21  109     1
6     3     0   0    2   0    1  2504     4    27    1   525
7     0     0   0   11   0    0    50  1083    10    0    10
8     0     0   0  111   0    1    18     5  1220    3    12
9     3     4   2  373   0   34    80    79   139  383    40
10    0     0   0    0   6    0     1     0     1    0  1638
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60554117, 'precision': 0.62849545, 'recall': 0.5040112, 'specificity': 0.9592486, 'f1': 0.47719622, 'auroc': 0.85068583}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   88     0   1   19    0    2   758    24    27  223    28
1    0  1214   0   28    0    0    21   159     9    0    68
2    0     4  14   25   57   17    97    47   359   78   317
3    0     0   0    0    0    0     0     0     0    0     0
4    0     0   1    0  255    0    12     1    19    0  1345
5    0     0   0  181    0  301     4     0    23   81     2
6    5     0   2    1    6    1  2406     2    12    1   631
7    0     6   0    6    0    0    86  1040    13    0    13
8    0     0   1   50    3    5    14     3  1272    8    14
9    1    16  10  159    2   77    86   118   196  440    32
10   0     1   0    0   19    0     1     0     0    0  1625
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_27_03_seed_0_24142419_instance_wise_predictions.txt
accuracy from prediction file 0.5794444833135101
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/29.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/29.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/29.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496026 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool | 405312 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |  90714 KiB |    127 MiB |    914 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 496026 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool | 405312 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |  90714 KiB |    127 MiB |    914 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10868 MiB | 598032 GiB | 598032 GiB |
|       from large pool | 387840 KiB |  10797 MiB | 597121 GiB | 597121 GiB |
|       from small pool |  90258 KiB |    126 MiB |    911 GiB |    911 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11236 MiB |  11236 MiB |  11236 MiB |      0 B   |
|       from large pool |  11108 MiB |  11108 MiB |  11108 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 239205 KiB |    851 MiB | 278082 GiB | 278082 GiB |
|       from large pool | 229568 KiB |    835 MiB | 277123 GiB | 277123 GiB |
|       from small pool |   9637 KiB |     17 MiB |    958 GiB |    958 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   44633 K  |   44630 K  |
|       from large pool |      87    |     490    |   20876 K  |   20876 K  |
|       from small pool |    2922    |    4522    |   23756 K  |   23753 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   44633 K  |   44630 K  |
|       from large pool |      87    |     490    |   20876 K  |   20876 K  |
|       from small pool |    2922    |    4522    |   23756 K  |   23753 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     284    |     284    |     284    |       0    |
|       from large pool |     220    |     220    |     220    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     996    |   19284 K  |   19284 K  |
|       from large pool |      14    |     112    |   10076 K  |   10076 K  |
|       from small pool |      22    |     982    |    9208 K  |    9208 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10868 MiB | 598032 GiB | 598032 GiB |
|       from large pool |  16640 KiB |  10797 MiB | 597121 GiB | 597121 GiB |
|       from small pool |      0 KiB |    126 MiB |    911 GiB |    911 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 735232 KiB |  11236 MiB |  11236 MiB |  10518 MiB |
|       from large pool | 634880 KiB |  11108 MiB |  11108 MiB |  10488 MiB |
|       from small pool | 100352 KiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    851 MiB | 278082 GiB | 278082 GiB |
|       from large pool |  59136 KiB |    835 MiB | 277123 GiB | 277123 GiB |
|       from small pool |      0 KiB |     32 MiB |    958 GiB |    958 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   44633 K  |   44633 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23756 K  |   23756 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   44633 K  |   44633 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23756 K  |   23756 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     284    |     284    |     209    |
|       from large pool |      26    |     220    |     220    |     194    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     996    |   19285 K  |   19285 K  |
|       from large pool |       3    |     112    |   10076 K  |   10076 K  |
|       from small pool |       0    |     982    |    9209 K  |    9209 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10868 MiB | 598032 GiB | 598032 GiB |
|       from large pool |  16640 KiB |  10797 MiB | 597121 GiB | 597121 GiB |
|       from small pool |      0 KiB |    126 MiB |    911 GiB |    911 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 735232 KiB |  11236 MiB |  11236 MiB |  10518 MiB |
|       from large pool | 634880 KiB |  11108 MiB |  11108 MiB |  10488 MiB |
|       from small pool | 100352 KiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    851 MiB | 278082 GiB | 278082 GiB |
|       from large pool |  59136 KiB |    835 MiB | 277123 GiB | 277123 GiB |
|       from small pool |      0 KiB |     32 MiB |    958 GiB |    958 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   44633 K  |   44633 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23756 K  |   23756 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   44633 K  |   44633 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23756 K  |   23756 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     284    |     284    |     209    |
|       from large pool |      26    |     220    |     220    |     194    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     996    |   19285 K  |   19285 K  |
|       from large pool |       3    |     112    |   10076 K  |   10076 K  |
|       from small pool |       0    |     982    |    9209 K  |    9209 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419

 Experiment start at: 2024-08-12 05:41:39.800564
before training, model accuracy: 0.06982439011335373
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8242455, 'precision': 0.51990706, 'recall': 0.447415, 'specificity': 0.97981477, 'f1': 0.43963408, 'auroc': 0.95836866}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    18   0   1   311    15    45   0     93
1    0  1049   0    27   0   0     1   187     8   0     60
2    0     1   0    10   0   0   160    21    60   0     60
3    0     7   0  7287   0   0     6   490   611   0     37
4    0     0   0     2   0   1    99     8    56   0    373
5    0     0   0   341   0  14    87     2    73   2      2
6    0     2   0    10   0   0  1354    32    98   0    411
7    0    35   0   421   0   0    11  6241   286   0    269
8    0     0   0   206   0   0   162   113  2266   0    548
9    0     0   0   113   0   5   222    19   125   1      8
10   0     0   0    13   0   0    96    33    56   0  12595
---- Validation: 
scalar performance:
{'acc': 0.8262405, 'precision': 0.49181333, 'recall': 0.4489696, 'specificity': 0.98006845, 'f1': 0.44081312, 'auroc': 0.95764387}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     2   0    17   0   3   303    18    47   0     93
1    0  1038   0    20   0   0     0   202    11   0     61
2    0     0   0    11   0   0   161    23    54   0     63
3    0     4   0  7295   0   0    13   475   615   0     38
4    0     0   0     2   0   0   103     9    52   0    373
5    0     0   0   320   0  15    84     0   100   0      2
6    0     5   0    17   0   0  1349    25   109   0    403
7    0    41   0   426   0   0    16  6229   284   0    269
8    0     1   0   159   0   0   130   129  2364   0    513
9    0     1   0   127   0   4   217    25   114   0      5
10   0     1   0    11   0   0    85    39    61   0  12599
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36241516, 'precision': 0.24485594, 'recall': 0.28116882, 'specificity': 0.93226856, 'f1': 0.23934516, 'auroc': 0.7415212}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     1   0    4   0   0  1118    1   42   0     4
1    0  1014   0   13   0   0    46   47   63   0   316
2    0     5   0   21   0   0   577    3  153   0   256
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    45    0    3   0  1585
5    0     0   0  327   0   0    65    0  198   0     2
6    0     0   0    0   0   0  1269    1    9   0  1788
7    0   153   0    2   0   0   158  691   74   0    86
8    0     0   0   35   0   0   617    1  562   0   155
9    0    12   0  101   0   0   485    9  501   0    29
10   0     0   0    0   0   0     2    0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 06:18:43.867186,epoch time: 0:37:04.066622,used: 0:37:04.066622,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88786924, 'precision': 0.7433423, 'recall': 0.6339418, 'specificity': 0.9874699, 'f1': 0.64290535, 'auroc': 0.9838609}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   120     1   3     9   1   28   109    13    30   78     91
1     0  1190   0    21   0    0     0    91     9    1     19
2     5     1  43     9  10    9     2    24    48  111     50
3     0     2   0  7656   0   64     1   343   367    1      4
4     8     0   7     2  11    5    11     4    85   22    384
5     1     0   1    92   0  363     0     0     9   54      1
6    21     6   0    13   1    7  1631    11    61   19    137
7     0    55   0   355   0    0     4  6483   258    3    107
8     0     2   1   168   0    4     7    90  2874   11    136
9     1     2  11    36   0  160     6    10    31  229      7
10    8     7   2     8   0    2    44    18   118    2  12585
---- Validation: 
scalar performance:
{'acc': 0.88893944, 'precision': 0.7568097, 'recall': 0.63442004, 'specificity': 0.98757696, 'f1': 0.6441217, 'auroc': 0.9832858}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   105     1   1    11   0   24   104    16    30   95     96
1     0  1188   0    18   0    1     0    90    12    1     22
2     4     1  46     4  12    7     4    18    50  110     56
3     0     4   0  7666   0   53     1   356   351    2      7
4     6     1   4     3  17    8     6     5    94   26    369
5     1     0   0    89   0  371     0     0    14   45      1
6    21     5   1    10   1    9  1625    19    62   21    134
7     0    57   0   332   0    2     6  6538   221    1    108
8     0     3   0   182   0    5     8    86  2862   10    140
9     1     2  12    27   1  161     1    14    38  230      6
10    9     9   0    10   0    3    39    26   111    4  12585
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4837333, 'precision': 0.5246579, 'recall': 0.40915734, 'specificity': 0.9468907, 'f1': 0.36640078, 'auroc': 0.81394416}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   42     1   0    8   0   21   871    2   112   94    19
1    0  1146   0   26   0    0    16   91    73    0   147
2    1     6   2   30   0   27    71   11   506   30   331
3    0     0   0    0   0    0     0    0     0    0     0
4    0     0   0    0   0    0     7    0    17    0  1609
5    0     0   0  258   0  254     9    0    57   13     1
6    3     1   0    1   0    0  1622    1    84    7  1348
7    0    83   0    9   0    0    64  857   109    2    40
8    0     0   0   90   0    4    12    0  1195    7    62
9    1    17   1  188   0  138    43   16   552  150    31
10   0     0   0    0   0    0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 06:54:27.699397,epoch time: 0:35:43.832211,used: 1:12:47.898833,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9064373, 'precision': 0.7926767, 'recall': 0.7362008, 'specificity': 0.98972446, 'f1': 0.75841904, 'auroc': 0.9892404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   248     0    0     5    5    0   110    12     9    3     91
1     0  1219    4    10    1    1     1    74    10    0     12
2     9     0  157     0   74    1     3     1    14   42     11
3     0     0    0  7422    1   20    24   475   485    5      8
4     5     0   17     0  221    1     8     3    30    7    246
5    10     0    4    75    1  289     6     0    12  121      3
6    16     0    1     1    0    1  1815     6    10    3     55
7     3    23    7   184    7    0    10  6679   232    2    116
8     0     0    9    77   39    2    39    69  2927    3    131
9    18     1   70    14    7   65     5     6    19  284      4
10   12     2    1     6   32    2    56    19    41    1  12618
---- Validation: 
scalar performance:
{'acc': 0.9075298, 'precision': 0.79636115, 'recall': 0.7401775, 'specificity': 0.9898225, 'f1': 0.76276624, 'auroc': 0.9898296}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   243     1    3     3    2    1    98     8    10    7    107
1     0  1219    2     7    1    0     0    77     8    0     18
2     5     1  155     0   70    1     3     5    13   47     12
3     0     1    0  7443    1   30    17   458   482    5      3
4     9     0   11     1  249    1     6     3    21    9    229
5    11     0    3    73    1  307     3     0    10  111      2
6     9     1    1     2    1    1  1817     7    15    3     51
7     0    25    7   180    7    0     9  6695   223    1    118
8     1     1    9    88   40    0    42    75  2898    4    138
9    28     1   76    20    4   54    12     4    13  273      8
10    9     1    2     6   40    1    48    15    45    0  12629
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5150773, 'precision': 0.5432536, 'recall': 0.40364918, 'specificity': 0.94927746, 'f1': 0.3724299, 'auroc': 0.8305431}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   122     0   0    4   0   0   974    1    33    6    30
1     0  1180   0   21   0   0    27   91    37    0   143
2     4     8  11   10  21   2   132   10   248   12   557
3     0     0   0    0   0   0     0    0     0    0     0
4     0     0   0    0   8   0     7    0     7    0  1611
5     8     0   0  260   0  75   104    0   104   38     3
6     4     1   0    0   0   0  2188    1     5    0   868
7     2    23   1    2   0   0   151  876    56    1    52
8     0     0   1   25   2   0    58    1  1099    0   184
9    30    23  43   88  16   6   167   22   469  157   116
10    0     0   0    0   0   0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 07:30:22.100335,epoch time: 0:35:54.400938,used: 1:48:42.299771,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92241013, 'precision': 0.8111512, 'recall': 0.7918333, 'specificity': 0.9915245, 'f1': 0.7991288, 'auroc': 0.99245393}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   325     2    2     6    4    1    57     2     3    3     78
1     0  1228    3    22    0    0     1    52    10    0     16
2     5     0  175     2   46    1     3     3     4   69      4
3     3     6    0  7958    0   58     7   188   206    4      6
4     2     0   33     1  300    4     7     2    24    7    159
5     3     0    2    41    0  417     1     0     5   51      1
6    25     0    1     8    2    6  1819     5     8    2     30
7     2    52   14   369    3    0    11  6520   203    4     86
8     3     3   13   156   33    7    36    49  2884    6    105
9     5     1   44    13    1  144     2     3     8  268      4
10   12     8    7     8   91    3    25    19    40    0  12582
---- Validation: 
scalar performance:
{'acc': 0.9221078, 'precision': 0.8078804, 'recall': 0.7865782, 'specificity': 0.99146926, 'f1': 0.795216, 'auroc': 0.99245405}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   321     1    2     5    2    3    48     4     4    3     90
1     0  1227    0    21    1    1     4    57     9    0     12
2     5     0  168     1   52    3     2     1     9   68      3
3     1     7    1  7981    1   54     6   166   213    8      2
4     3     0   32     0  301    3     5     3    21   13    158
5     3     0    1    46    0  408     1     0     7   54      1
6    36     0    2     7    5    0  1802     8     7    4     37
7     4    42   13   381    2    0     9  6525   183    6    100
8     0     4   10   173   44   13    27    42  2875    6    102
9     3     0   43    11    4  142     6     5     8  267      4
10   14    12    5     9   81    1    25    18    33    0  12598
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57349753, 'precision': 0.62599486, 'recall': 0.46686262, 'specificity': 0.9557594, 'f1': 0.4563466, 'auroc': 0.84619236}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   250     0   0   18   0    3   816    1    13   36    33
1     0  1290   0   30   0    0    11   71    19    0    78
2     5    11  17   29  19   10    99   18   271   56   480
3     0     0   0    0   0    0     0    0     0    0     0
4     0     2   0    0  60    0     6    0    14    0  1551
5     5     0   0  260   0  214    37    0    24   50     2
6     9     2   0    1   1    0  2385    1     5    1   662
7     0    62   1   23   0    0   180  830    29    5    34
8     0     0   1   83   1    0    48    0  1131   10    96
9    12    34  25  198   3   50   105   27   245  378    60
10    0     1   0    0   3    0     0    0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 08:06:23.328474,epoch time: 0:36:01.228139,used: 2:24:43.527910,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9279752, 'precision': 0.84543794, 'recall': 0.8014618, 'specificity': 0.9922117, 'f1': 0.8203145, 'auroc': 0.9941631}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   342     1    1     4    3    1    41    15     9    2     63
1     0  1213    1     8    0    0     0    96     5    1      8
2     5     0  186     1   47    1     1     8    19   40      4
3     2     2    0  7578    0    8     1   473   369    1      2
4     1     1   33     0  318    3     3     4    42    6    128
5     2     0    3    68    0  379     0     0    20   48      1
6    16     0    2     2    2    0  1812    11    20    2     40
7     1     7    2   109    3    0     2  6988   123    0     29
8     0     1    5    70   11    0     4    87  3078    0     40
9     4     0   57    13    2   99     3    10    23  276      6
10   12     7    4     7   80    1    24    31   114    0  12514
---- Validation: 
scalar performance:
{'acc': 0.9305871, 'precision': 0.8394427, 'recall': 0.80157495, 'specificity': 0.9925236, 'f1': 0.81789434, 'auroc': 0.99420583}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   343     1    1     5    2    0    35    13    10    2     71
1     0  1232    2     8    1    0     1    74     8    0      6
2     3     1  187     0   51    1     5     3    12   46      3
3     1     3    0  7634    0    8     3   457   333    0      1
4     1     0   32     0  326    1     4     5    37    6    127
5     2     0    1    62    0  370     1     0    20   63      2
6    14     0    0     1    2    2  1830    12    12    1     34
7     2     9    2   104    1    0     2  6981   137    2     25
8     2     1    6    64    8    0     3    89  3093    0     30
9     6     0   62    14    1  110     6     7    24  259      4
10   18     4    4     5   87    1    21    33    88    0  12535
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.54166377, 'precision': 0.65885293, 'recall': 0.43377241, 'specificity': 0.95317924, 'f1': 0.3816052, 'auroc': 0.8429849}
confusion matrix:
     0     1   2    3   4   5     6     7     8    9     10
0   148     0   0   28   0   1   742    89   102    6    54
1     0  1208   0   27   0   0     2   194    14    0    54
2     1    10   3   43   1   1    41    85   568    9   253
3     0     0   0    0   0   0     0     0     0    0     0
4     0     4   0    0  54   0     4     1    79    0  1491
5     0     0   0  381   0  73    24     4    86   23     1
6    11     2   0    2   1   1  2100     3   107    0   840
7     0     4   0    5   0   0    10  1128    12    0     5
8     0     0   0   60   0   0     2    19  1283    0     6
9     5    21   1  252   0  16    55   237   416  108    26
10    0     1   0    0   4   0     0     0     4    0  1637
better model found
persisted
after epoch: 5,now: 2024-08-12 08:42:00.452646,epoch time: 0:35:37.124172,used: 3:00:20.652082,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93268406, 'precision': 0.8290224, 'recall': 0.82701445, 'specificity': 0.9929449, 'f1': 0.8254025, 'auroc': 0.99477226}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   345     1    1     3    2    5    48     4     9   11     54
1     0  1276    1    13    0    0     0    28     8    0      5
2     0     0  187     0   29    1     2     1     4   88      0
3     2     4    2  7830    1   64    12   243   274    5      0
4     4     0   43     1  324    1     4     3    37   17    104
5     0     1    2    22    0  426     2     0    11   56      1
6     8     2    1     3    1    4  1862     5     8    1     13
7     1    58   10   197    2    1    11  6745   221    3     15
8     1     4    8    80    8    9    17    56  3083    6     23
9     0     0   23     6    1  124     2     1     8  327      1
10   10     9   10     6  128    1    30    32   110    3  12455
---- Validation: 
scalar performance:
{'acc': 0.93344927, 'precision': 0.82829666, 'recall': 0.82024825, 'specificity': 0.99302644, 'f1': 0.8206853, 'auroc': 0.99486864}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   329     0    0     4    2    2    65     4    10    9     58
1     0  1275    0    11    0    0     1    34    10    0      1
2     0     1  169     0   28    2     3     3     9   96      1
3     1     6    0  7832    0   74     7   221   291    6      2
4     1     1   51     2  314    3     2     3    42   11    109
5     0     0    0    19    0  436     0     0     8   57      1
6     6     2    0     3    1    1  1852     4    12    5     22
7     2    59    7   187    5    0     8  6766   210    7     14
8     2     3    8    74    4    5     8    53  3114    6     19
9     3     0   27     4    1  115     2     0     9  332      0
10   12    12    9     6  109    3    33    27   103    4  12478
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58378226, 'precision': 0.6465589, 'recall': 0.46836862, 'specificity': 0.9573835, 'f1': 0.43367082, 'auroc': 0.8467773}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   78     0   0   35   0    1   727   14    60  157    98
1    1  1259   0   37   0    0     8  111    25    0    58
2    1     8   6   41  12    8    36   21   588   80   214
3    0     0   0    0   0    0     0    0     0    0     0
4    0     2   0    0  31    0     5    0    72    0  1523
5    0     0   0  296   0  175    11    0    32   77     1
6    4     2   0    2   1    1  2524    2    71    3   457
7    0    16   0   26   0    0   104  962    48    1     7
8    0     0   0   87   0    1     5    5  1265    1     6
9    0    23   2  243   1   40    38   38   324  406    22
10   0     1   0    0   2    0     1    0     4    0  1638
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 09:17:40.973925,epoch time: 0:35:40.521279,used: 3:36:01.173361,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9445366, 'precision': 0.85763836, 'recall': 0.8410343, 'specificity': 0.99402297, 'f1': 0.8476038, 'auroc': 0.99599695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   388     0    0     4    1    0    13     5     5    3     64
1     0  1269    1    11    0    0     0    41     5    0      5
2     2     0  173     0   39    1     1     1     5   86      4
3     2     6    2  8075    0   21     3   151   171    4      2
4     3     1   27     0  363    1     0     3    20   14    107
5     0     0    0    42    0  418     0     0     7   53      1
6    17     2    0     3    6    1  1838     3    10    3     24
7     1    26    4   233    6    0     1  6807   147    4     36
8     0     1    3   111   28    4     3    43  3062    5     36
9     1     0   22    10    1  105     1     3     5  343      2
10    7     8    4     7  124    3     7     9    55    0  12567
---- Validation: 
scalar performance:
{'acc': 0.94329274, 'precision': 0.84937465, 'recall': 0.8350561, 'specificity': 0.9939178, 'f1': 0.84050965, 'auroc': 0.9955419}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     1    1     4    2    1    13     3     6    5     60
1     0  1262    1    13    1    0     0    46     5    0      4
2     0     0  162     2   48    1     1     1    10   86      1
3     2     3    1  8079    0   19     6   152   172    3      3
4     3     1   29     4  371    1     1     2    23    9     95
5     1     0    0    41    0  426     0     0     7   45      1
6    16     1    2     2    3    1  1833     7    12    3     28
7     3    23    4   220    3    0     5  6822   151    4     30
8     2     1    7   110   24    2     7    52  3047    1     43
9     3     0   26    14    2  122     2     1     3  320      0
10    8     8    5     8  137    1    10    13    48    2  12556
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5564962, 'precision': 0.65324426, 'recall': 0.459232, 'specificity': 0.95492923, 'f1': 0.43442798, 'auroc': 0.8425869}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   224     0   0   38   1    0   520    35    42  131   179
1     1  1282   0   39   0    0     4    99     7    0    67
2     1    14   6   42  29    1    15    33   456   71   347
3     0     0   0    0   0    0     0     0     0    0     0
4     0     2   0    0  60    0     2     0    30    0  1539
5     0     0   0  338   0  107     8     2    21  113     3
6     3     3   0    3   3    1  1959     2    54    2  1037
7     0    13   0   39   0    0    39  1046    20    0     7
8     0     0   0  105   0    1     4     9  1237    0    14
9     0    32   2  296   2   16    23    64   276  390    36
10    0     1   0    0   2    0     0     0     0    0  1643
better model found
persisted
after epoch: 7,now: 2024-08-12 09:54:48.763005,epoch time: 0:37:07.789080,used: 4:13:08.962441,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9487104, 'precision': 0.87139785, 'recall': 0.8425498, 'specificity': 0.9943535, 'f1': 0.8543216, 'auroc': 0.9961561}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   368     2    0     3    1    0    18     7     1    3     80
1     0  1288    1     8    0    0     1    27     4    0      3
2     1     1  190     0   37    0     2     4     2   72      3
3     3    10    2  7983    0   43     5   231   155    2      3
4     3     0   31     0  334    1     0     4    13   12    140
5     1     0    0    20    0  446     0     0     5   48      1
6     6     1    0     2    1    1  1844     4     5    6     38
7     1    42    5   137    2    0     3  6963    72    6     31
8     0     3    6    75   19    3    11    68  3021    4     86
9     2     0   20     6    2  119     1     1     4  332      6
10    6    13    3     7   38    1     5    16    14    1  12690
---- Validation: 
scalar performance:
{'acc': 0.9466096, 'precision': 0.86698425, 'recall': 0.8387611, 'specificity': 0.99413025, 'f1': 0.85012954, 'auroc': 0.9957345}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     4    0     2    1    1    18     5     1    6     71
1     0  1290    1    10    0    0     0    26     4    0      1
2     0     1  186     0   35    0     2     3     4   77      4
3     0     7    1  7994    0   47     3   224   157    5      2
4     1     1   29     1  327    2     1     3    14    9    151
5     0     0    0    26    0  442     1     0     3   48      1
6     9     2    2     4    4    2  1833     2     5    6     39
7     1    46    4   158    2    0     5  6922    75    8     44
8     0     5    3    81   17    5    10    70  3019    5     81
9     1     1   24     5    3  115     3     5     5  328      3
10    3    15    2     7   52    1    10    15    16    1  12674
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57125866, 'precision': 0.6925434, 'recall': 0.4599399, 'specificity': 0.95606583, 'f1': 0.42100024, 'auroc': 0.840479}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   148     0   0   24   0    0   648    41    17   43   249
1     0  1335   0   30   0    0     2    79     5    0    48
2     0    41   2   26   3    1    21    41   390   40   450
3     0     0   0    0   0    0     0     0     0    0     0
4     0     7   0    0  13    0     2     2    19    0  1590
5     0     0   0  269   0  114    15     9    44  136     5
6     1     3   0    3   0    1  2292     2    33    0   732
7     0    33   0   12   0    0    25  1074     8    0    12
8     0     1   0   61   0    1     9    17  1246    0    35
9     1    77   0  197   0   11    39   143   283  298    88
10    0     2   0    0   0    0     1     0     0    0  1643
better model found
persisted
after epoch: 8,now: 2024-08-12 10:30:54.409953,epoch time: 0:36:05.646948,used: 4:49:14.609389,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94980735, 'precision': 0.87298316, 'recall': 0.8546363, 'specificity': 0.9946228, 'f1': 0.86188304, 'auroc': 0.9968113}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   373     1    1     3    1    0    40     4     3    4     52
1     0  1298    0     8    0    0     1    18     6    0      1
2     0     0  204     0   35    0     2     5     8   57      1
3     2     4    0  8089    0   32    10   133   164    1      2
4     4     2   24     0  368    1     1     4    22    8    105
5     0     0    0    24    1  448     0     0     3   44      1
6     4     2    0     4    1    0  1868     1     4    1     21
7     3    60    3   204    3    0     9  6808   155    3     17
8     1     0    3    91   13    2     6    34  3098    1     45
9     3     0   30     5    1  119     2     1     9  322      1
10    5     8    3     7   78    0    16    16    36    2  12624
---- Validation: 
scalar performance:
{'acc': 0.9472248, 'precision': 0.8683989, 'recall': 0.8504975, 'specificity': 0.994349, 'f1': 0.8574414, 'auroc': 0.99648255}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     1    0     3    0    0    33     5     3    4     52
1     0  1287    0     9    0    0     0    26     8    0      2
2     0     0  196     0   35    3     2     4     9   61      2
3     1    10    0  8092    0   25    10   136   166    0      0
4     1     0   27     0  361    2     2     4    23   11    108
5     1     0    1    21    0  453     1     0     6   37      1
6     7     1    0     0    2    0  1867     1     7    0     23
7     4    73    1   224    3    0     7  6757   171    4     21
8     1     3    3    92   10    1    13    40  3088    1     44
9     3     0   31     6    2  123     4     1     6  316      1
10    7     7    2     5   83    0    13    14    49    3  12613
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56887984, 'precision': 0.683228, 'recall': 0.4532634, 'specificity': 0.9556831, 'f1': 0.41090333, 'auroc': 0.84494966}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   124     0   0   23   0    0   784    35    13   28   163
1     0  1290   0   30   0    0     3   128     7    0    41
2     0    22   2   24   6    1    44    50   513   32   321
3     0     0   0    0   0    0     0     0     0    0     0
4     0     5   0    0  21    0     6     2    48    0  1551
5     0     0   0  257   0  110    34     5    50  131     5
6     1     2   0    4   0    1  2382     2    62    0   613
7     0     6   0   13   0    0    45  1080    14    0     6
8     0     0   0   79   0    0    18    13  1237    0    23
9     1    30   0  239   0    8    62   140   370  243    44
10    0     2   0    0   1    0     0     0     1    0  1642
better model found
persisted
after epoch: 9,now: 2024-08-12 11:07:26.362457,epoch time: 0:36:31.952504,used: 5:25:46.561893,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9492455, 'precision': 0.8755984, 'recall': 0.8552259, 'specificity': 0.99460965, 'f1': 0.8608259, 'auroc': 0.99703306}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     1    0     1    0    2    39     4     4    6     48
1     0  1283    0     7    0    0     2    30     7    0      2
2     0     0  171     0   45    0     3     1     3   86      3
3     2     5    1  8029    0   75     3    99   220    3      0
4     2     0   16     2  378    2     2     1    20    6    110
5     0     0    0     7    0  459     0     0     5   49      1
6     3     1    0     0    2    0  1875     2     6    1     18
7     2    29    5   231    3    1     9  6749   200    8     25
8     1     2    4    59   10    8     7    22  3151    5     27
9     1     0   13     1    1  109     2     2     6  356      2
10    6     1    2     7   43    2    19     6    57    1  12650
---- Validation: 
scalar performance:
{'acc': 0.948803, 'precision': 0.8734745, 'recall': 0.8509497, 'specificity': 0.9945437, 'f1': 0.8569638, 'auroc': 0.9971795}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   373     1    0     2    2    1    38     2     4    3     57
1     0  1283    0     8    1    0     0    27     9    0      4
2     0     1  162     0   55    1     3     1     3   84      2
3     3     6    0  8050    1   74     5   100   197    3      1
4     1     0   11     1  369    1     3     2    24   11    116
5     0     0    0     6    0  465     1     0     5   43      1
6     3     1    0     1    1    0  1873     2     3    2     22
7     5    16    4   223    4    0    10  6758   213    5     27
8     0     0    4    72    7   10     5    26  3141    6     25
9     2     0   16     6    2  105     2     0     4  356      0
10    6     6    1     6   63    3    16     6    48    0  12641
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6009935, 'precision': 0.6020028, 'recall': 0.47448024, 'specificity': 0.958604, 'f1': 0.44056022, 'auroc': 0.8438972}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   134     0   0    9   0    0   806    5    18   38   160
1     0  1231   0   28   0    0    12  118    18    0    92
2     0     9   0   11  12    1    53   16   495   38   380
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  36    0     9    0    49    0  1538
5     0     0   0  171   0  175    48    0    61  133     4
6     0     0   0    1   0    0  2792    1    37    0   236
7     0     6   0   23   0    0   110  983    34    0     8
8     0     0   0   42   0    1    24    3  1283    1    16
9     0    23   2  152   3   18    98   44   412  317    68
10    0     0   0    0   2    0     4    0     1    0  1639
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-12 11:45:10.250699,epoch time: 0:37:43.888242,used: 6:03:30.450135,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:03:30.450135 at 2024-08-12 11:45:10.250699
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6009935, 'precision': 0.6020028, 'recall': 0.47448024, 'specificity': 0.958604, 'f1': 0.44056022, 'auroc': 0.8438972}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   134     0   0    9   0    0   806    5    18   38   160
1     0  1231   0   28   0    0    12  118    18    0    92
2     0     9   0   11  12    1    53   16   495   38   380
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  36    0     9    0    49    0  1538
5     0     0   0  171   0  175    48    0    61  133     4
6     0     0   0    1   0    0  2792    1    37    0   236
7     0     6   0   23   0    0   110  983    34    0     8
8     0     0   0   42   0    1    24    3  1283    1    16
9     0    23   2  152   3   18    98   44   412  317    68
10    0     0   0    0   2    0     4    0     1    0  1639
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6009935, 'precision': 0.6020028, 'recall': 0.47448024, 'specificity': 0.958604, 'f1': 0.44056022, 'auroc': 0.8438972}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   134     0   0    9   0    0   806    5    18   38   160
1     0  1231   0   28   0    0    12  118    18    0    92
2     0     9   0   11  12    1    53   16   495   38   380
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  36    0     9    0    49    0  1538
5     0     0   0  171   0  175    48    0    61  133     4
6     0     0   0    1   0    0  2792    1    37    0   236
7     0     6   0   23   0    0   110  983    34    0     8
8     0     0   0   42   0    1    24    3  1283    1    16
9     0    23   2  152   3   18    98   44   412  317    68
10    0     0   0    0   2    0     4    0     1    0  1639
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_05_41_39_seed_1_24142419_instance_wise_predictions.txt
accuracy from prediction file 0.6009934933184076
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/29.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/29.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 497754 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool | 407040 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |  90714 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 497754 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool | 407040 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |  90714 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10868 MiB |   1168 TiB |   1168 TiB |
|       from large pool | 387840 KiB |  10797 MiB |   1166 TiB |   1166 TiB |
|       from small pool |  90258 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11244 MiB |  11244 MiB |  21762 MiB |  10518 MiB |
|       from large pool |  11116 MiB |  11116 MiB |  21604 MiB |  10488 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 286629 KiB |    957 MiB | 547747 GiB | 547747 GiB |
|       from large pool | 276992 KiB |    941 MiB | 545812 GiB | 545812 GiB |
|       from small pool |   9637 KiB |     32 MiB |   1935 GiB |   1935 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   89268 K  |   89265 K  |
|       from large pool |      87    |     490    |   41753 K  |   41753 K  |
|       from small pool |    2922    |    4522    |   47514 K  |   47512 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   89268 K  |   89265 K  |
|       from large pool |      87    |     490    |   41753 K  |   41753 K  |
|       from small pool |    2922    |    4522    |   47514 K  |   47512 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     291    |     291    |     500    |     209    |
|       from large pool |     227    |     227    |     421    |     194    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |    1035    |   38995 K  |   38995 K  |
|       from large pool |      19    |     117    |   20582 K  |   20582 K  |
|       from small pool |      24    |    1016    |   18412 K  |   18412 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool |  16640 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool |  16640 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10868 MiB |   1168 TiB |   1168 TiB |
|       from large pool |  16640 KiB |  10797 MiB |   1166 TiB |   1166 TiB |
|       from small pool |      0 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 784384 KiB |  11244 MiB |  21762 MiB |  20996 MiB |
|       from large pool | 684032 KiB |  11116 MiB |  21604 MiB |  20936 MiB |
|       from small pool | 100352 KiB |    128 MiB |    158 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    957 MiB | 547748 GiB | 547748 GiB |
|       from large pool |  59136 KiB |    941 MiB | 545812 GiB | 545812 GiB |
|       from small pool |      0 KiB |     32 MiB |   1935 GiB |   1935 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   89268 K  |   89268 K  |
|       from large pool |       2    |     490    |   41753 K  |   41753 K  |
|       from small pool |       0    |    4522    |   47514 K  |   47514 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   89268 K  |   89268 K  |
|       from large pool |       2    |     490    |   41753 K  |   41753 K  |
|       from small pool |       0    |    4522    |   47514 K  |   47514 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     291    |     500    |     421    |
|       from large pool |      30    |     227    |     421    |     391    |
|       from small pool |      49    |      64    |      79    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1035    |   38995 K  |   38995 K  |
|       from large pool |       3    |     117    |   20582 K  |   20582 K  |
|       from small pool |       0    |    1016    |   18413 K  |   18413 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 11:51:43 2024]
Finished job 0.
1 of 1 steps (100%) done
