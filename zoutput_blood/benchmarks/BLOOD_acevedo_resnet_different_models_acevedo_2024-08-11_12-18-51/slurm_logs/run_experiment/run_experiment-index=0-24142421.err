Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 23:20:20 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421

 Experiment start at: 2024-08-11 23:28:37.011611
before training, model accuracy: 0.05282306298613548
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.85022473, 'precision': 0.5523073, 'recall': 0.48422852, 'specificity': 0.9832822, 'f1': 0.482417, 'auroc': 0.9689672}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    37   0   3   315    30    44   3     50
1    0  1087   0    22   0   0     0   204     4   0     15
2    0     1   0    13   0   0   134    49    93   0     22
3    0     0   0  7621   0   0     4   576   226   0     11
4    0     0   0     3   0   2   112    20   101   0    301
5    0     0   0   311   0  91    63     2    43  10      1
6    0    14   0    29   0   3  1476    45   153   0    188
7    0    33   0   349   0   0     2  6674   129   0     75
8    0     2   0   376   0   0    56   234  2449   0    179
9    0     2   0   123   0  36   199    25    92  15      1
10   0     7   0    17   0   0   184    71   149   0  12365
---- Validation: 
scalar performance:
{'acc': 0.84699744, 'precision': 0.55332625, 'recall': 0.48078364, 'specificity': 0.9829571, 'f1': 0.48014408, 'auroc': 0.96847415}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     2   0    37   0   5   321    22    42   2     52
1    0  1069   0    22   0   0     1   220     5   0     15
2    0     2   0    14   0   4   117    41   109   1     24
3    0     1   0  7611   0   0     5   578   239   0      6
4    0     0   0     4   0   1   113    16   114   0    291
5    0     0   0   313   0  87    62     1    46  11      1
6    0     6   0    29   0   1  1452    56   172   0    192
7    0    35   0   391   0   0     6  6644   117   0     72
8    0     0   0   383   0   0    70   257  2424   0    162
9    0     1   0   116   0  35   185    15   119  20      2
10   0     2   0    18   0   0   189    71   158   0  12358
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40460366, 'precision': 0.3212272, 'recall': 0.3327088, 'specificity': 0.93757015, 'f1': 0.2762925, 'auroc': 0.77823085}
confusion matrix:
    0     1   2    3   4   5     6     7    8   9     10
0    0     0   0   14   0   1  1095    37   20   1     2
1    0  1078   0   19   0   0    20   228   17   0   137
2    0     3   0   72   0   1   423    66  267   0   183
3    0     0   0    0   0   0     0     0    0   0     0
4    0     1   0    1   0   0    35     1   12   0  1583
5    0     0   0  376   0  19   113     2   81   1     0
6    0     4   0    1   0   0  1091     7   51   0  1913
7    0    57   0    2   0   0    47  1007   39   0    12
8    0     0   0   58   0   2   329     5  943   0    33
9    0    15   0  324   0   2   384   116  282   0    14
10   0     0   0    0   0   0     1     0    0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 23:59:43.268076,epoch time: 0:31:06.256465,used: 0:31:06.256465,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8973673, 'precision': 0.7858072, 'recall': 0.65543145, 'specificity': 0.98847425, 'f1': 0.69465816, 'auroc': 0.9861337}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   223     0   2    23   1    3   102    25    26   10     68
1     0  1060   0    13   0    0     0   242     5    0     12
2    11     2  61     6  52    1     4    28    59   65     23
3     0     1   0  7783   0   17     0   472   159    1      4
4     3     0  16     3  98    1    14    17    89   10    288
5     2     0   0   128   0  322     1     0    15   52      1
6    14     0   0    22   0    4  1694    17    59    9     89
7     0    13   0   290   1    0     4  6851    70    1     34
8     0     1   1   287   1    0     8   165  2723    3    106
9     6     2  24    53   4  139     6    15    45  196      3
10    8     3   1    19   8    2    55    59   108    0  12529
---- Validation: 
scalar performance:
{'acc': 0.897927, 'precision': 0.7875773, 'recall': 0.65043443, 'specificity': 0.9885533, 'f1': 0.69000995, 'auroc': 0.9853263}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   206     0   1    19   0    4   111    31    26   14     71
1     0  1038   0    15   0    0     2   260     7    0     10
2     6     4  61     6  46    1     4    30    63   65     26
3     0     0   0  7833   0   12     0   430   162    1      2
4     4     0  10     7  97    1    13    14    94   18    281
5     2     0   1   125   0  315     0     0    16   61      1
6    15     5   0    18   1    6  1712    24    41    7     79
7     1    19   0   265   1    0     0  6861    72    0     46
8     0     0   2   276   2    0     6   188  2716    5    101
9    10     2  24    45   2  136     5    19    50  195      5
10    6     1   0    17   6    1    47    68   112    3  12535
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4790457, 'precision': 0.4807996, 'recall': 0.391362, 'specificity': 0.94606316, 'f1': 0.34134215, 'auroc': 0.827127}
confusion matrix:
    0    1   2    3   4    5     6     7     8   9     10
0   27    0   0   30   0    4  1041    40    12   8     8
1    0  998   0   24   0    0    19   335     5   0   118
2    0    1   0   81   0    8   233    81   300   1   310
3    0    0   0    0   0    0     0     0     0   0     0
4    0    0   0    1   0    0    11     2    10   0  1609
5    0    0   0  370   0  130    48     1    29  13     1
6    0    2   0    1   0    0  1748     6    23   0  1287
7    0    4   0    3   0    0    22  1110    13   0    12
8    0    0   0   94   0    3    66    13  1149   7    38
9    2   12   2  361   0   43   233   155   259  39    31
10   0    0   0    0   0    0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 00:29:05.146264,epoch time: 0:29:21.878188,used: 1:00:28.134653,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9187179, 'precision': 0.808625, 'recall': 0.7495346, 'specificity': 0.9911155, 'f1': 0.77367955, 'auroc': 0.9913734}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   302     0    0    10    4    1    80    18     7    5     56
1     0  1240    0    15    0    0     0    66     4    0      6
2     8     3  148     2   50    2     1    17    18   58      5
3     2     3    0  7837    0   14     1   353   223    4      1
4     3     0   41     2  213    1     6     7    68   10    188
5     6     0    2    75    1  334     2     0    14   86      1
6    17     2    1    12    1    1  1789     9    27    5     42
7     2    49    1   271    1    0     3  6805    99    2     32
8     0     3    5   187    4    0     8   117  2907    3     61
9    18     2   65    25    3   93     5     8    18  253      3
10   11     1    5    18   41    1    50    44   112    0  12510
---- Validation: 
scalar performance:
{'acc': 0.92077035, 'precision': 0.8153632, 'recall': 0.7573414, 'specificity': 0.99134636, 'f1': 0.7810776, 'auroc': 0.991122}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   319     1    2    11    1    0    66    14    11    4     54
1     0  1241    0    17    0    0     0    60     3    0     11
2     4     5  149     3   44    4     2    13    25   58      5
3     2     4    0  7873    1   13     1   342   200    2      2
4     0     1   38     1  215    1     7     9    67   11    189
5     9     0    1    75    0  336     0     1    10   88      1
6    18     2    0    10    4    2  1786    12    32    2     40
7     2    56    3   263    2    0     6  6795   105    0     33
8     1     2    2   182    6    1     8   119  2925    1     49
9    19     3   58    23    2   88     5     4    21  270      0
10   11     3    6    15   41    1    52    36   115    2  12514
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5368362, 'precision': 0.5498289, 'recall': 0.43475485, 'specificity': 0.95131695, 'f1': 0.3965314, 'auroc': 0.837051}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   60     0   0    9   0    1  1077    13     3    6     1
1    0  1181   0   28   0    0    20   192     5    0    73
2    2     6   7   45   8    9   304    61   227   11   335
3    0     0   0    0   0    0     0     0     0    0     0
4    0     1   0    0   2    0    17     1    21    0  1591
5   10     0   0  231   0  197    79     1    33   39     2
6    0     3   0    1   0    0  2221     4     8    1   829
7    0     8   0    3   0    0    83  1052     9    0     9
8    1     0   1   62   0    1    84    10  1173    7    31
9    8    30  11  209   1   34   343   135   194  135    37
10   0     0   0    0   0    0     1     0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 00:58:28.638447,epoch time: 0:29:23.492183,used: 1:29:51.626836,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93086475, 'precision': 0.83742696, 'recall': 0.7864264, 'specificity': 0.99236697, 'f1': 0.80815065, 'auroc': 0.99331236}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   355     1    1    12    1    2    38    10     6    3     53
1     0  1228    0    15    0    0     0    68     8    0     13
2     5     2  163     5   51    2     2     8     8   57      8
3     1     5    1  7932    1   28     0   326   143    0      0
4     3     0   32     2  256    1     4     6    46    5    184
5     4     0    2    57    0  388     1     0     4   64      1
6    23     1    0    13    1    1  1800     7    14    2     46
7     0    13    4   226    3    0     5  6902    88    0     23
8     0     1    3   183    7    2    10   116  2911    3     60
9     9     0   50    20    3  116     3     6    12  270      4
10   22     1    3    12   30    3    44    36    53    2  12587
---- Validation: 
scalar performance:
{'acc': 0.9314431, 'precision': 0.83634186, 'recall': 0.7873146, 'specificity': 0.99243593, 'f1': 0.8082012, 'auroc': 0.9932132}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    0    12    1    0    30    10     7    2     50
1     0  1223    0    20    0    0     0    74     5    1      9
2     7     0  155     1   50    6     2    10    19   56      6
3     1     2    0  7960    1   27     1   303   141    3      1
4     3     0   33     2  259    0     4     9    39   10    180
5     2     0    3    50    0  389     2     0     5   69      1
6    28     1    0     8    0    1  1806    11    20    2     31
7     1    21    1   225    2    0     1  6897    87    4     26
8     2     1    1   180    7    3     5   112  2907    4     74
9    10     0   51    26    1  110     3     3    12  269      8
10   19     4    4    23   32    0    39    36    50    3  12586
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5140978, 'precision': 0.572592, 'recall': 0.43382183, 'specificity': 0.9500401, 'f1': 0.4035499, 'auroc': 0.8358804}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   192     0   0   48   0    1   853    28    10   19    19
1     0  1134   0   33   0    0    11   237     5    0    79
2     1     6   9   74   2   11   103    79   240   15   475
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    0   1    0     3     1    16    0  1611
5     4     0   0  315   0  184    23     1    37   25     3
6     4     1   0    1   0    0  1704     6    15    0  1336
7     0     2   0    7   0    0    30  1114     1    0    10
8     0     0   1   83   0    2    16    13  1211    5    39
9     6    22  11  342   1   57   134   159   170  153    82
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 4,now: 2024-08-12 01:27:49.381677,epoch time: 0:29:20.743230,used: 1:59:12.370066,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93867725, 'precision': 0.8413491, 'recall': 0.81730515, 'specificity': 0.9933386, 'f1': 0.827575, 'auroc': 0.99474895}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    1    10    0    0    18     7     6    1     54
1     0  1261    1    14    0    0     0    44     7    0      5
2     5     0  209     1   22    2     1     4     6   58      4
3     0     1    0  8035    1   15     1   255   127    2      1
4     2     0   60     6  281    0     1     2    34   10    143
5     6     0    2    50    0  361     0     0     5   96      1
6    21     0    2     4    2    0  1822     3    16    7     29
7     0    23    5   198    3    0     5  6904   104    0     23
8     0     2    8   169   17    2    10    87  2964    3     32
9     8     1   57    16    1   88     0     5     8  306      3
10   16     0    7    13   74    3    25    21    78    1  12555
---- Validation: 
scalar performance:
{'acc': 0.93877226, 'precision': 0.8419084, 'recall': 0.8129388, 'specificity': 0.9933303, 'f1': 0.8249631, 'auroc': 0.9947999}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     1    1     8    0    0    16     5     8    2     57
1     0  1257    2    15    0    0     0    50     5    0      3
2     5     2  199     2   26    1     1     6     8   59      3
3     2     1    0  8034    0   13     2   257   129    0      2
4     1     0   65     2  276    1     3     6    31    9    145
5     4     0    2    55    0  361     0     0     6   92      1
6    27     0    1     6    2    2  1819     5    14    3     29
7     0    24    3   212    4    0     4  6904    92    1     21
8     3     2    9   163    7    1     6    77  2978    7     43
9     8     0   61    18    1   85     3     4     8  304      1
10   18     1    9    11   56    1    26    19    75    1  12579
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5124886, 'precision': 0.66648304, 'recall': 0.42309904, 'specificity': 0.9496292, 'f1': 0.39821595, 'auroc': 0.8263704}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   184     0   0   29   0    0   923    12     2   12     8
1     0  1208   0   40   0    0     6   167     6    0    72
2     2    10   3   84   2    5   175    73   227   19   415
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    1   4    0     5     1    25    0  1596
5     2     0   0  324   0  119    50     0    15   80     2
6    16     1   0    1   0    1  1780     4    22    0  1242
7     2     4   0   16   0    0    67  1062     3    0    10
8     0     0   0  139   0    1    47    12  1125    5    41
9     2    49   0  385   0   10   209   132   106  194    50
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 5,now: 2024-08-12 01:57:19.018558,epoch time: 0:29:29.636881,used: 2:28:42.006947,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94271725, 'precision': 0.85059744, 'recall': 0.82873535, 'specificity': 0.99378353, 'f1': 0.8386358, 'auroc': 0.9954484}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    1     8    1    0    25     4     4    5     48
1     0  1263    1    13    2    0     0    43     5    0      5
2     4     0  181     1   63    2     1     5     5   50      0
3     3     1    0  8057    0   21     3   208   143    4      0
4     3     1   23     0  336    1     3     6    20    7    139
5     4     0    1    41    1  357     1     0     6  109      1
6    16     1    0     8    1    0  1849     2    10    2     18
7     3    33    9   230    3    0     6  6864    95    2     16
8     1     0    7   146   19    1    14    63  2983    5     57
9     7     0   46    10    4   60     0     0     9  354      3
10   34     1    6     9   53    1    33    18    32    1  12604
---- Validation: 
scalar performance:
{'acc': 0.94297177, 'precision': 0.85371494, 'recall': 0.83026165, 'specificity': 0.99381137, 'f1': 0.8407824, 'auroc': 0.99559206}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     0    1     3    2    0    29     4     3    2     35
1     0  1262    0    14    0    0     1    45     4    0      6
2     2     2  179     0   64    0     3     2     4   54      2
3     3     2    0  8058    1   17     4   209   141    2      3
4     3     1   22     1  320    1     2     4    23    9    153
5     5     0    0    36    0  367     1     0     7  104      1
6    18     0    0     3    2    0  1850     2    10    1     22
7     4    26    6   204    5    0     4  6889   102    0     25
8     2     3    5   148   20    0    16    63  2982    4     53
9     8     0   45    11    8   58     0     1     8  353      1
10   22     3    2     8   59    3    43    15    50    2  12589
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5772056, 'precision': 0.6421578, 'recall': 0.45461863, 'specificity': 0.9553806, 'f1': 0.43335444, 'auroc': 0.8376697}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   227     0   0   12   0    0   917     2     2    9     1
1     1  1200   0   35   0    0    23   164     6    0    70
2     1     8   7   26  11    0   346    40   148   44   384
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    0  20    0    22     1    15    0  1574
5     2     0   0  172   0  106    84     0    17  209     2
6    24     0   0    1   1    0  2602     2     7    0   430
7     2     2   0   15   0    0   129  1005     1    0    10
8     0     0   0   82   1    0   108     5  1124   10    40
9     5    35   3  191   6    4   384    65    88  315    41
10    0     0   0    0   1    0     1     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 02:26:34.447651,epoch time: 0:29:15.429093,used: 2:57:57.436040,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94854987, 'precision': 0.8641115, 'recall': 0.8483868, 'specificity': 0.9944097, 'f1': 0.8545076, 'auroc': 0.99624765}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     6    0    0     7     6     7    4     41
1     0  1272    0    10    0    0     0    40     5    0      5
2     1     1  216     1   34    1     1     3     6   44      4
3     0     2    1  8076    0   26     1   223   105    5      0
4     4     1   49     1  324    1     0     4    26    9    120
5     3     0    2    30    0  446     0     0     5   34      1
6    19     1    0    11    2    0  1849     5     7    2     11
7     0    23    4   177    1    0     1  6990    49    2     15
8     1     2    5   142   15    4     3   113  2965    4     41
9     5     1   39     8    1  129     2     4     6  296      2
10   27     1    5    10   65    3    20    19    35    1  12607
---- Validation: 
scalar performance:
{'acc': 0.9473853, 'precision': 0.8651119, 'recall': 0.84333754, 'specificity': 0.99428797, 'f1': 0.8526168, 'auroc': 0.99591225}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    0     6    1    0    16     5     3    5     42
1     0  1271    0    12    0    0     0    44     3    0      2
2     5     0  218     1   31    2     1     5     7   40      2
3     0     2    0  8065    0   24     0   227   118    4      0
4     3     0   41     1  321    1     2     7    32    6    125
5     1     0    1    32    0  427     0     0     6   53      1
6    16     1    0    11    4    0  1839     9    10    1     17
7     1    32    1   170    3    0     1  6987    60    0     10
8     2     2    5   147   11    2     5   109  2976    3     34
9     5     0   37     9    3  131     1     9     2  296      0
10   24     1    4    11   57    2    22    27    34    1  12613
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5866508, 'precision': 0.67049706, 'recall': 0.46754527, 'specificity': 0.9567057, 'f1': 0.43939847, 'auroc': 0.83702713}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   252     0   0   12   0    0   887     7     1    7     4
1     1  1200   0   36   0    0    12   172     5    0    73
2     2     5   4   35   3    2   256    57   244   27   380
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  14    0    14     1    26    0  1578
5     1     0   0  197   0  142    82     0    38  131     1
6    20     0   0    1   0    0  2586     3    18    0   439
7     2     2   0   15   0    0    65  1070     2    0     8
8     0     0   0   65   0    0    61     6  1215    1    22
9     5    33   1  183   1    9   290   109   202  257    47
10    0     0   0    0   1    0     0     0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-12 02:55:40.201339,epoch time: 0:29:05.753688,used: 3:27:03.189728,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94747967, 'precision': 0.8646326, 'recall': 0.83041, 'specificity': 0.9942637, 'f1': 0.8422553, 'auroc': 0.9952277}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     4    0     6    1    0    13     5     1    3     35
1     0  1272    0    13    0    0     0    41     2    0      4
2     3     0  149     0   39    0     1     3     4  111      2
3     3    27    0  8103    0   22     0   182    97    3      1
4     5     0   32     2  294    0     5     5    21   13    162
5     3     0    0    28    0  443     0     0     2   44      1
6     7     6    0     8    1    0  1854     3     6    1     22
7     1    56    2   183    0    1     2  6941    57    2     17
8     0     7    1   141    9    5     8    87  2964    8     65
9    10     0   13     5    2  124     2     1     3  331      2
10   19    25    2     7   25    1    21    20    24    2  12648
---- Validation: 
scalar performance:
{'acc': 0.94762605, 'precision': 0.8666072, 'recall': 0.8327352, 'specificity': 0.9942801, 'f1': 0.84471226, 'auroc': 0.99567026}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     1    0     4    0    2    20     7     0    4     40
1     0  1277    0    10    0    0     0    38     4    0      3
2     7     0  145     1   37    1     2     6     4  107      2
3     0    23    0  8090    0   26     2   184   109    4      2
4     6     1   28     0  315    3     3     6    16   14    147
5     1     0    0    28    0  446     0     0     3   41      2
6    12     4    0     6    0    0  1857     5     5    2     17
7     0    43    1   182    1    0     3  6965    48    2     20
8     1     6    3   162   10    2     5    83  2962    4     58
9     6     0    9    12    1  117     3     2     4  336      3
10   14    22    4     8   46    2    18    26    25    2  12629
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58126354, 'precision': 0.6900799, 'recall': 0.4704661, 'specificity': 0.9560972, 'f1': 0.4440419, 'auroc': 0.83043265}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   269     0   0    8   0    1   874     4     1    9     4
1     1  1202   0   28   0    0     6   191     5    0    66
2     5     4   2   21   2    3   201    92   164   41   480
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    0   8    0     9     1    10    0  1604
5     2     0   0  138   0  161    97     0    21  171     2
6    13     0   0    1   0    1  2446     3    10    0   593
7     1     0   0    6   0    0    57  1093     1    0     6
8     1     0   0   48   0    0    80    13  1167    5    56
9     7    21   0  135   0   14   285   190   113  314    58
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 8,now: 2024-08-12 03:24:44.935940,epoch time: 0:29:04.734601,used: 3:56:07.924329,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95267016, 'precision': 0.87472045, 'recall': 0.8563512, 'specificity': 0.99491477, 'f1': 0.86422014, 'auroc': 0.9970121}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     1    0     7    1    1    17     3     3    5     40
1     0  1282    0    13    0    0     0    31     5    0      1
2     3     0  206     0   35    1     0     2     6   58      1
3     2     3    0  8181    1   28     1   115   102    3      0
4     4     0   29     0  350    1     1     7    39    7    101
5     0     0    0    25    0  441     0     0     3   51      1
6    10     0    0     8    2    0  1863     1     8    4     12
7     1    27    3   231    2    0     3  6914    74    1      8
8     2     4    3   121    5    2     2    61  3067    5     24
9     4     0   30     6    1  122     1     3     5  321      0
10   14     2    2    15   61    3    29    19    69    1  12577
---- Validation: 
scalar performance:
{'acc': 0.95409924, 'precision': 0.87799585, 'recall': 0.85535336, 'specificity': 0.99505895, 'f1': 0.8649347, 'auroc': 0.99704415}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    1     8    1    0     8     3     4    0     41
1     0  1282    1    14    0    0     0    32     2    0      1
2     1     0  194     1   33    1     0     4     8   67      3
3     1     4    0  8192    0   23     2   114   104    0      0
4     3     1   29     0  356    2     4     3    35    7     99
5     1     0    0    23    0  445     0     0     6   45      1
6     7     0    0     7    0    1  1864     2    12    2     13
7     0    17    1   230    2    1     2  6922    78    1     11
8     0     0    3   122    5    1     4    67  3079    3     12
9     4     0   30     8    2  134     1     1     4  309      0
10   17     1    4    11   56    2    12    14    69    1  12609
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6044917, 'precision': 0.6945006, 'recall': 0.50614834, 'specificity': 0.95934415, 'f1': 0.48490632, 'auroc': 0.83994156}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   471     0   0   22   0    4   594    10     1   41    27
1     0  1222   0   36   0    0     6   175     5    0    55
2     4     9   6   60   5    7   122    94   307   43   358
3     0     0   0    0   0    0     0     0     0    0     0
4     0     2   0    1  27    0     4     1    37    0  1561
5     4     0   0  180   0  238    18     0    26  124     2
6    14     0   0    1   0    1  2339     3    37    0   672
7     1     0   0   10   0    0    38  1108     1    0     6
8     0     0   0   82   0    0    30    17  1220    5    16
9     5    28   0  240   0   33   119   165   142  367    38
10    0     0   0    0   3    0     0     0     1    0  1642
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 03:53:37.296395,epoch time: 0:28:52.360455,used: 4:25:00.284784,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95588076, 'precision': 0.89412993, 'recall': 0.8598724, 'specificity': 0.99518937, 'f1': 0.87465096, 'auroc': 0.99740446}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     1    0     3    1    1     9     2     4    0     39
1     0  1273    0    12    0    0     0    33     4    0     10
2     2     1  191     2   43    0     2     4     5   59      3
3     1     2    0  8182    0   11     1    93   147    1      0
4     4     1   16     2  363    2     0     4    25    3    119
5     0     0    0    30    0  436     0     0    11   43      1
6     8     0    0     7    1    0  1859     2     8    3     18
7     3    23    1   237    1    0     3  6873   109    2     12
8     1     2    2    94    6    3     3    33  3116    2     33
9     5     0   17    10    5  106     3     0    12  333      1
10   13     1    3    13   37    2     9    13    25    0  12678
---- Validation: 
scalar performance:
{'acc': 0.95487493, 'precision': 0.88965327, 'recall': 0.85423005, 'specificity': 0.99508786, 'f1': 0.8692662, 'auroc': 0.99711293}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    1     4    0    0    11     4     5    1     40
1     0  1272    0    11    0    0     1    35     6    0      7
2     1     0  181     1   42    3     1     3    10   66      4
3     0     4    0  8177    0   14     2    98   144    1      0
4     2     0   16     2  355    1     2     4    31    5    121
5     0     0    1    27    0  444     0     0     8   40      1
6    15     0    0    10    2    0  1858     2     4    2     15
7     2    19    0   224    3    0     4  6876   118    0     19
8     0     2    2    96    5    0     2    34  3120    1     34
9     4     0   26     8    1  110     1     1    13  326      3
10   10     0    2    12   35    3    17    10    35    0  12672
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55047923, 'precision': 0.6831838, 'recall': 0.45564458, 'specificity': 0.9538747, 'f1': 0.42664725, 'auroc': 0.83179945}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   439     0   0   28   0    0   601    31     4   17    50
1     0  1096   0   32   0    0     7   279     6    0    79
2     0     1   1   43   4    1    66   109   243   23   524
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1  19    0     2     2    16    0  1593
5     3     0   0  252   0  119    44     2    56  111     5
6    10     0   0    1   0    0  1985     4    17    0  1050
7     0     0   0   12   0    0    24  1121     1    0     6
8     0     0   0   47   0    0    19    18  1250    2    34
9     9     7   0  243   0    8   127   242   229  194    78
10    0     0   0    0   2    0     0     0     0    0  1644
better model found
persisted
after epoch: 10,now: 2024-08-12 04:22:25.138726,epoch time: 0:28:47.842331,used: 4:53:48.127115,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:53:48.127115 at 2024-08-12 04:22:25.138726
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55047923, 'precision': 0.6831838, 'recall': 0.45564458, 'specificity': 0.9538747, 'f1': 0.42664725, 'auroc': 0.83179945}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   439     0   0   28   0    0   601    31     4   17    50
1     0  1096   0   32   0    0     7   279     6    0    79
2     0     1   1   43   4    1    66   109   243   23   524
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1  19    0     2     2    16    0  1593
5     3     0   0  252   0  119    44     2    56  111     5
6    10     0   0    1   0    0  1985     4    17    0  1050
7     0     0   0   12   0    0    24  1121     1    0     6
8     0     0   0   47   0    0    19    18  1250    2    34
9     9     7   0  243   0    8   127   242   229  194    78
10    0     0   0    0   2    0     0     0     0    0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6044917, 'precision': 0.6945006, 'recall': 0.50614834, 'specificity': 0.95934415, 'f1': 0.48490632, 'auroc': 0.83994156}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   471     0   0   22   0    4   594    10     1   41    27
1     0  1222   0   36   0    0     6   175     5    0    55
2     4     9   6   60   5    7   122    94   307   43   358
3     0     0   0    0   0    0     0     0     0    0     0
4     0     2   0    1  27    0     4     1    37    0  1561
5     4     0   0  180   0  238    18     0    26  124     2
6    14     0   0    1   0    1  2339     3    37    0   672
7     1     0   0   10   0    0    38  1108     1    0     6
8     0     0   0   82   0    0    30    17  1220    5    16
9     5    28   0  240   0   33   119   165   142  367    38
10    0     0   0    0   3    0     0     0     1    0  1642
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_36_seed_0_24142421_instance_wise_predictions.txt
accuracy from prediction file 0.5504792555796544
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/0.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 492058 KiB |   3074 MiB | 228279 GiB | 228278 GiB |
|       from large pool | 401344 KiB |   3003 MiB | 227750 GiB | 227749 GiB |
|       from small pool |  90714 KiB |    127 MiB |    529 GiB |    529 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 492058 KiB |   3074 MiB | 228279 GiB | 228278 GiB |
|       from large pool | 401344 KiB |   3003 MiB | 227750 GiB | 227749 GiB |
|       from small pool |  90714 KiB |    127 MiB |    529 GiB |    529 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |   3052 MiB | 227120 GiB | 227119 GiB |
|       from large pool | 387840 KiB |   2982 MiB | 226593 GiB | 226592 GiB |
|       from small pool |  90258 KiB |    126 MiB |    527 GiB |    527 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3406 MiB |   3406 MiB |   3406 MiB |      0 B   |
|       from large pool |   3278 MiB |   3278 MiB |   3278 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 617957 KiB | 760158 KiB | 108070 GiB | 108070 GiB |
|       from large pool | 608320 KiB | 756928 KiB | 107459 GiB | 107459 GiB |
|       from small pool |   9637 KiB |  15946 KiB |    610 GiB |    610 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   20035 K  |   20032 K  |
|       from large pool |      87    |     177    |    8191 K  |    8191 K  |
|       from small pool |    2922    |    4522    |   11844 K  |   11841 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   20035 K  |   20032 K  |
|       from large pool |      87    |     177    |    8191 K  |    8191 K  |
|       from small pool |    2922    |    4522    |   11844 K  |   11841 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     128    |     128    |       0    |
|       from large pool |      64    |      64    |      64    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |    1086    |    9855 K  |    9855 K  |
|       from large pool |      21    |      39    |    4963 K  |    4963 K  |
|       from small pool |      22    |    1065    |    4891 K  |    4891 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3074 MiB | 228279 GiB | 228279 GiB |
|       from large pool |  16640 KiB |   3003 MiB | 227750 GiB | 227750 GiB |
|       from small pool |      0 KiB |    127 MiB |    529 GiB |    529 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3074 MiB | 228279 GiB | 228279 GiB |
|       from large pool |  16640 KiB |   3003 MiB | 227750 GiB | 227750 GiB |
|       from small pool |      0 KiB |    127 MiB |    529 GiB |    529 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3052 MiB | 227120 GiB | 227120 GiB |
|       from large pool |  16640 KiB |   2982 MiB | 226593 GiB | 226593 GiB |
|       from small pool |      0 KiB |    126 MiB |    527 GiB |    527 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1084 MiB |   3406 MiB |   3406 MiB |   2322 MiB |
|       from large pool |    986 MiB |   3278 MiB |   3278 MiB |   2292 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB | 760158 KiB | 108071 GiB | 108071 GiB |
|       from large pool | 134912 KiB | 756928 KiB | 107460 GiB | 107460 GiB |
|       from small pool |      0 KiB |  30894 KiB |    610 GiB |    610 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   20035 K  |   20035 K  |
|       from large pool |       2    |     177    |    8191 K  |    8191 K  |
|       from small pool |       0    |    4522    |   11844 K  |   11844 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   20035 K  |   20035 K  |
|       from large pool |       2    |     177    |    8191 K  |    8191 K  |
|       from small pool |       0    |    4522    |   11844 K  |   11844 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     128    |     128    |      53    |
|       from large pool |      26    |      64    |      64    |      38    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1086    |    9855 K  |    9855 K  |
|       from large pool |       3    |      39    |    4963 K  |    4963 K  |
|       from small pool |       0    |    1065    |    4892 K  |    4892 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3074 MiB | 228279 GiB | 228279 GiB |
|       from large pool |  16640 KiB |   3003 MiB | 227750 GiB | 227750 GiB |
|       from small pool |      0 KiB |    127 MiB |    529 GiB |    529 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3074 MiB | 228279 GiB | 228279 GiB |
|       from large pool |  16640 KiB |   3003 MiB | 227750 GiB | 227750 GiB |
|       from small pool |      0 KiB |    127 MiB |    529 GiB |    529 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3052 MiB | 227120 GiB | 227120 GiB |
|       from large pool |  16640 KiB |   2982 MiB | 226593 GiB | 226593 GiB |
|       from small pool |      0 KiB |    126 MiB |    527 GiB |    527 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1084 MiB |   3406 MiB |   3406 MiB |   2322 MiB |
|       from large pool |    986 MiB |   3278 MiB |   3278 MiB |   2292 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB | 760158 KiB | 108071 GiB | 108071 GiB |
|       from large pool | 134912 KiB | 756928 KiB | 107460 GiB | 107460 GiB |
|       from small pool |      0 KiB |  30894 KiB |    610 GiB |    610 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   20035 K  |   20035 K  |
|       from large pool |       2    |     177    |    8191 K  |    8191 K  |
|       from small pool |       0    |    4522    |   11844 K  |   11844 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   20035 K  |   20035 K  |
|       from large pool |       2    |     177    |    8191 K  |    8191 K  |
|       from small pool |       0    |    4522    |   11844 K  |   11844 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     128    |     128    |      53    |
|       from large pool |      26    |      64    |      64    |      38    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1086    |    9855 K  |    9855 K  |
|       from large pool |       3    |      39    |    4963 K  |    4963 K  |
|       from small pool |       0    |    1065    |    4892 K  |    4892 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421

 Experiment start at: 2024-08-12 04:37:14.108512
before training, model accuracy: 0.06982439011335373
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8419039, 'precision': 0.52144927, 'recall': 0.47118044, 'specificity': 0.98218215, 'f1': 0.46426547, 'auroc': 0.96606725}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     1   0    26   0   2   301    25    64   0     64
1    0  1126   0    19   0   0     0   160     5   0     22
2    0     2   0    18   0   1   111    49    94   1     36
3    0     3   0  7509   0   0     1   586   328   0     11
4    0     0   0     6   0   0   109    15    81   0    327
5    0     0   0   368   0  46    48     2    53   2      2
6    0     2   0    34   0   2  1453    48   151   0    216
7    0    28   0   434   0   0     7  6534   153   0    109
8    0     0   0   321   0   1    72   250  2393   0    259
9    0     0   0   154   0  19   176    26   115   1      1
10   0     2   0    17   0   0   168    60   141   0  12405
---- Validation: 
scalar performance:
{'acc': 0.841514, 'precision': 0.54452693, 'recall': 0.4689678, 'specificity': 0.9821283, 'f1': 0.46037513, 'auroc': 0.9658642}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    26   0   1   313    31    55   0     57
1    0  1136   0    15   0   0     0   151     4   0     26
2    0     0   0    16   0   0   123    58    83   2     30
3    0     1   0  7524   0   0     3   574   324   0     14
4    0     0   0     4   0   0   106    24    86   0    319
5    0     0   0   360   0  30    62     2    65   0      2
6    0     2   0    33   0   2  1440    43   158   0    230
7    0    33   0   462   0   0     3  6502   161   0    104
8    0     0   0   303   0   0    59   246  2408   0    280
9    0     0   0   147   0  21   162    36   123   3      1
10   0     4   0    24   0   0   166    64   121   0  12417
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42937103, 'precision': 0.3471793, 'recall': 0.31788042, 'specificity': 0.93932307, 'f1': 0.2672066, 'auroc': 0.76548386}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     0   0    3   0   0  1094    6   66   0     1
1    0  1136   0   19   0   0    36   56   66   0   186
2    0     8   0   14   0   0   535    3  275   0   180
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    71    0    5   0  1557
5    0     0   0  272   0   8    72    0  238   1     1
6    0     1   0    0   0   0  2000    0   49   0  1017
7    0   179   0    5   0   0   128  694  113   0    45
8    0     0   0   19   0   0   632    0  656   0    63
9    0    12   0   83   0   0   348    7  664   0    23
10   0     0   0    0   0   0     3    0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 05:07:19.192298,epoch time: 0:30:05.083786,used: 0:30:05.083786,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8917487, 'precision': 0.7698616, 'recall': 0.64228976, 'specificity': 0.98784935, 'f1': 0.670699, 'auroc': 0.98443156}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   128     0   1    18   1    6   212    14    20   23     60
1     0  1152   1    18   0    0     2   136    10    0     13
2     7     0  94     5  18    3     9    26    47   69     34
3     0     4   0  7755   0   17     4   454   197    3      4
4     5     0  12     3  21    1    35    13    83   15    351
5     3     0   0   128   0  304     4     1    17   63      1
6     4     2   2    22   0    3  1739    16    34    6     80
7     0    24   0   310   0    0     8  6733   136    1     51
8     0     0   2   282   2    0    33   178  2650    3    143
9    16     0  27    47   1   99    18    21    29  232      3
10    5     3   0    25   2    2    82    57    96    0  12522
---- Validation: 
scalar performance:
{'acc': 0.8911863, 'precision': 0.76318413, 'recall': 0.63858694, 'specificity': 0.9877939, 'f1': 0.6650213, 'auroc': 0.9841863}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   127     0   1    16   1    8   198    19    25   22     66
1     0  1156   1    17   0    0     1   137     7    0     13
2     9     2  85     8  18    3    11    25    50   74     27
3     0     2   0  7733   0   18     3   474   203    3      4
4     4     0  18     2  21    3    41    15    69   12    354
5     2     0   0   134   0  301     2     1    13   67      1
6     2     0   1    14   0    7  1753    16    37    9     69
7     0    20   1   310   0    0     4  6720   147    0     63
8     1     1   0   277   0    2    31   155  2675    8    146
9    11     0  34    53   1   98     8    22    40  224      2
10    5     2   0    26   3    3   103    51    79    2  12522
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4858322, 'precision': 0.4963585, 'recall': 0.3895986, 'specificity': 0.946632, 'f1': 0.34815502, 'auroc': 0.8179121}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   11     0   0   11   0    7  1064    6    45   21     5
1    0  1258   0   28   0    0     9   89    41    0    74
2    1    20   6   44   0    7   152   21   390   13   361
3    0     0   0    0   0    0     0    0     0    0     0
4    0     3   0    0   0    0    16    0     9    0  1605
5    0     0   0  326   0  137    31    1    59   37     1
6    0     2   0    0   0    0  1897    1    82    0  1085
7    0   112   0   10   0    0    67  881    60    0    34
8    0     0   1   76   0    1   100    2  1010    2   178
9    6    32   6  218   0   29   128   44   540  101    33
10   0     2   0    0   0    0     1    0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 05:36:30.340788,epoch time: 0:29:11.148490,used: 0:59:16.232276,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9160959, 'precision': 0.80121624, 'recall': 0.7560358, 'specificity': 0.9908093, 'f1': 0.77246225, 'auroc': 0.98995245}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   275     0    3     8    2    1    94    15    15   14     56
1     0  1216    1    15    1    1     0    87     4    0      7
2     4     0  188     4   41    3     0    11    14   43      4
3     1     0    0  7836    0   44     3   363   182    2      4
4     3     0   56     1  188    2     7    12    45   14    211
5     3     0    4    60    0  372     0     1     7   73      1
6    26     0    3    15    1    6  1781     7    25    7     37
7     1    27    4   253    0    0     8  6816   112    1     42
8     1     3    8   231   13    8    26   124  2798    6     77
9     9     3   76    20    0   93     2     9    12  267      2
10   21     2    8    25   49    2    63    35    83    3  12503
---- Validation: 
scalar performance:
{'acc': 0.9150996, 'precision': 0.8017229, 'recall': 0.7518337, 'specificity': 0.990694, 'f1': 0.76925045, 'auroc': 0.9898757}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   258     0    3    10    6    3    95     9    16   14     69
1     0  1218    0    16    1    0     0    81     6    0     10
2     5     1  184     1   32    4     1    10    16   50      8
3     1     0    0  7800    1   45     5   390   193    3      2
4     1     0   56     1  177    5    11    13    52    9    214
5     2     0    6    63    0  376     0     0     6   67      1
6    15     0    1     8    4    4  1803    10    20    4     39
7     0    30    6   256    3    0     6  6793   127    0     44
8     1     1   10   221   15    7    29   118  2822    5     67
9     3     0   74    23    3   99     1     7    13  268      2
10   18     3    7    18   53    1    52    39    92    1  12512
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56202334, 'precision': 0.522137, 'recall': 0.46252483, 'specificity': 0.95437336, 'f1': 0.43528077, 'auroc': 0.84156007}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   195     0   2    4   0    2   902    1    34   20    10
1     0  1302   0   26   0    0    15   74    29    0    53
2     8    27  35   24  57   16   111   19   346   37   335
3     0     0   0    0   0    0     0    0     0    0     0
4     0     3   0    0   3    0    13    0    12    0  1602
5     4     0   0  145   0  279    41    0    53   68     2
6    13     3   0    0   2    0  2326    1    33    2   687
7     1    79   1    7   0    0   133  880    41    0    22
8     4     0   2   36   5    3    47    1  1152    7   113
9    28    31  97   89  23   69    94   39   410  217    40
10    0     1   0    0   0    0     1    0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 06:05:38.530532,epoch time: 0:29:08.189744,used: 1:28:24.422020,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92321277, 'precision': 0.82260036, 'recall': 0.781322, 'specificity': 0.99158555, 'f1': 0.79916334, 'auroc': 0.99248195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   324     0    1     8    1    3    42    16    13    9     65
1     0  1246    0    15    0    0     0    62     6    0      3
2     4     0  177     2   38    0     2     5    15   67      2
3     0     1    0  7815    0   17     3   453   144    2      3
4     2     0   45     0  251    2     2     8    47   15    167
5     2     0    0    62    1  385     0     0     3   67      1
6    30     1    2     9    2    3  1790     9    16    6     40
7     1    28    8   209    1    0     3  6887   110    1     16
8     2     2    4   238   17    1     5   126  2843    4     54
9     6     1   59    21    1  109     2     5     9  277      3
10   14     6    6    16   61    2    26    54    95    0  12511
---- Validation: 
scalar performance:
{'acc': 0.9243012, 'precision': 0.82800245, 'recall': 0.78437907, 'specificity': 0.9916973, 'f1': 0.80342346, 'auroc': 0.9931523}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   329     0    1     7    0    3    39    11    17    9     67
1     0  1246    0    13    0    0     1    62     6    1      3
2     3     1  181     5   34    0     1     5    12   68      2
3     1     0    0  7830    0   17     1   454   134    3      0
4     2     0   36     0  261    2     2     8    45   14    169
5     2     0    3    64    0  380     0     0     7   64      1
6    20     0    0     8    1    0  1807    12    21    5     34
7     1    26    7   225    1    0     3  6879   106    1     16
8     5     2    2   220   16    1    16   125  2856    2     51
9     5     0   54    25    3  113     1     5    12  272      3
10   11     3   11    17   70    2    28    52    87    1  12514
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5690898, 'precision': 0.5658443, 'recall': 0.45633185, 'specificity': 0.9549946, 'f1': 0.42939377, 'auroc': 0.83638644}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   56     0   0   11   0    0  1035    2    30   16    20
1    1  1334   0   29   0    0    15   69    26    0    25
2    3    25  26   30  57   10   130   19   338   39   338
3    0     0   0    0   0    0     0    0     0    0     0
4    0     6   0    0  49    0    25    0    27    0  1526
5    1     0   0  228   0  220    54    0    23   61     5
6   10     2   0    1   0    0  2514    2    33    2   503
7    1    55   1   13   0    0   122  915    46    0    11
8    0     0   1   74   5    1    77    1  1087    5   119
9    3    42  68  137  16   55   121   33   314  298    50
10   0     3   0    0   3    0     3    0     2    0  1635
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 06:34:42.296855,epoch time: 0:29:03.766323,used: 1:57:28.188343,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93343323, 'precision': 0.8473924, 'recall': 0.7924954, 'specificity': 0.9925791, 'f1': 0.8151993, 'auroc': 0.9943862}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   339     0    1    10    0    0    45     8     5   10     65
1     0  1254    0    20    1    0     1    49     2    0      5
2     0     1  186     5   34    2     3     7     9   59      6
3     3     1    0  8069    0   16     0   239   107    2      0
4     5     0   47     2  240    3     5     6    25   10    196
5     1     0    2    59    0  388     2     0     5   63      1
6    13     1    0    14    2    0  1827     6     7    5     33
7     1    18    4   304    3    0     8  6796    94    0     36
8     0     0    2   237   15    2     9    93  2865    4     69
9     3     0   53    19    0  110     2     5    10  286      4
10    6     0    4    16   33    3    28    20    43    1  12638
---- Validation: 
scalar performance:
{'acc': 0.93406445, 'precision': 0.8518424, 'recall': 0.8020567, 'specificity': 0.99265844, 'f1': 0.8228322, 'auroc': 0.9946842}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   353     0    1     8    2    0    43     6     8    5     57
1     0  1256    1    14    0    0     0    53     4    0      4
2     1     1  194     1   30    1     2     4    12   60      6
3     0     3    0  8059    0   18     0   243   114    2      1
4     2     0   45     3  250    1     2     8    26   11    191
5     0     0    2    54    0  394     1     0     3   66      1
6     6     0    2     4    2    0  1848     7    10    6     23
7     3    21    3   316    1    0     6  6796    82    2     35
8     2     1    4   257   13    1    13    85  2843    2     75
9     6     0   47    16    1  110     5     2     8  295      3
10    7     1    4    18   41    1    28    23    40    1  12632
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5425733, 'precision': 0.6027529, 'recall': 0.4467604, 'specificity': 0.9525916, 'f1': 0.42357326, 'auroc': 0.830256}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   63     0   0   17   0    3   948    2    28   29    80
1    0  1300   0   37   0    0     9   94    16    0    43
2    1    15  17   38  12   14    52   22   241   41   562
3    0     0   0    0   0    0     0    0     0    0     0
4    0     2   0    0  36    0     6    0     8    0  1581
5    0     0   0  208   0  263    40    0    18   55     8
6    7     0   0    1   0    0  2191    1    18    2   847
7    0    36   0   45   0    0   102  907    49    0    25
8    0     0   1   95   1    2    48    2  1039    2   180
9    2    25  40  176   3   67    88   57   274  295   110
10   0     1   0    0   1    0     0    0     0    0  1644
better model found
persisted
after epoch: 5,now: 2024-08-12 07:03:38.830891,epoch time: 0:28:56.534036,used: 2:26:24.722379,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9366706, 'precision': 0.84668297, 'recall': 0.812281, 'specificity': 0.99304664, 'f1': 0.8262424, 'auroc': 0.9948408}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     1    2     7    1    1    17    12    10    5     56
1     0  1254    0    14    1    0     0    58     1    0      4
2     1     0  220     2   40    0     1     4    10   32      2
3     2    43    1  8050    0    9     1   203   126    1      1
4     4     0   44     1  279    2     1     8    30    5    165
5     2     0    3    48    0  365     0     0     6   95      1
6    18     1    1    11    4    1  1805     6    22    3     35
7     0    41    6   258    3    0     1  6861    77    0     16
8     1    15    5   201   11    1     3    98  2906    1     53
9     4     0   95    15    2   70     0     7     8  290      2
10   19     7    4    17   40    1    13    40    44    2  12608
---- Validation: 
scalar performance:
{'acc': 0.93641835, 'precision': 0.84717035, 'recall': 0.8181496, 'specificity': 0.99305433, 'f1': 0.8300617, 'auroc': 0.99513274}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     0    2     9    1    1    18     9     4    2     52
1     0  1253    0    16    0    0     0    54     3    0      6
2     2     0  217     0   42    1     1     9     9   28      3
3     1    63    0  8017    0   14     1   215   126    3      0
4     3     0   35     1  290    3     2     8    31    5    161
5     1     0    5    43    0  371     0     0     8   92      1
6    16     0    1    13    2    2  1815     7    16    4     32
7     1    71    6   253    4    0     2  6840    72    2     14
8     0    16    3   184   12    1     2   100  2930    2     46
9     1     1   94    14    1   71     3     5     6  296      1
10   18     3    4    20   42    1    14    33    66    1  12594
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51990485, 'precision': 0.5740147, 'recall': 0.43444568, 'specificity': 0.9508146, 'f1': 0.40404585, 'auroc': 0.83595467}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   192     0   2   33   0    0   771    22    36   23    91
1     0  1334   0   31   0    0     1    89     6    0    38
2     1    38  24   34  26    4    16    58   391   31   392
3     0     0   0    0   0    0     0     0     0    0     0
4     0     6   0    0  25    0     3     1    18    0  1580
5     0     0   0  307   0  121    31     1    32   96     4
6     7     3   1    4   0    0  1650     3    97    2  1300
7     0    36   0   74   0    0    22  1005    17    0    10
8     0     0   0   85   1    0    17     7  1216    2    42
9     0    56  59  222   6   13    49   158   297  221    56
10    0     1   0    0   2    0     0     0     0    0  1643
better model found
persisted
after epoch: 6,now: 2024-08-12 07:32:38.232976,epoch time: 0:28:59.402085,used: 2:55:24.124464,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9440818, 'precision': 0.8539024, 'recall': 0.8376306, 'specificity': 0.99394935, 'f1': 0.8447663, 'auroc': 0.9964158}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     1    1     5    0    0    18     6     5    1     42
1     0  1266    0    12    1    0     0    44     6    0      3
2     2     0  218     1   34    0     1     6     8   38      3
3     3    25    0  7986    0   23     2   234   161    4      1
4     3     0   44     0  309    1     2     8    24    5    143
5     1     0    1    36    0  381     2     0     4   95      1
6    17     0    0     6    2    0  1845     6     9    1     22
7     0    36    7   185    2    0     5  6928    82    3     17
8     3     4    4   132   24    1     8    73  3007    2     36
9    14     0   63     6    2   70     3     3     8  323      1
10   20     0    3    10   60    2    14    22    41    0  12619
---- Validation: 
scalar performance:
{'acc': 0.9439615, 'precision': 0.85557985, 'recall': 0.8349595, 'specificity': 0.9939156, 'f1': 0.8440758, 'auroc': 0.996065}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    1     4    0    1    16     9     5    0     46
1     0  1269    0    14    0    0     0    42     3    0      4
2     2     1  209     1   36    0     4     5     7   46      1
3     1    28    0  7998    0   17     1   229   163    2      1
4     5     0   44     1  314    1     4     3    21    6    140
5     3     0    6    34    0  388     0     0     5   84      1
6    13     0    0     8    1    0  1836     4    13    2     31
7     3    47    4   186    1    0     1  6919    84    3     17
8     1     7    4   117   24    0     5    86  2997    6     49
9     9     0   67     9    2   76     2     2     6  318      2
10   20     1    1    12   44    0    12    19    46    0  12641
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5668509, 'precision': 0.5928807, 'recall': 0.44437826, 'specificity': 0.95477486, 'f1': 0.40940195, 'auroc': 0.83764815}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   140     0   0   13   0   0   963    2    22    5    25
1     0  1347   0   30   0   0     2   74     8    0    38
2     2    36  13   20  21   0   111   31   340   23   418
3     0     0   0    0   0   0     0    0     0    0     0
4     0     5   0    0  28   0     7    0    13    0  1580
5     0     0   0  209   0  97   114    0    49  118     5
6     6     3   0    1   0   0  2488    1    30    0   538
7     0    57   0   57   0   0    75  936    28    0    11
8     0     0   0   48   2   0    77    1  1185    1    56
9     5    79  38  128   4   5   182   87   319  224    66
10    0     1   0    0   1   0     0    0     0    0  1644
better model found
persisted
after epoch: 7,now: 2024-08-12 08:01:28.600822,epoch time: 0:28:50.367846,used: 3:24:14.492310,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9402825, 'precision': 0.85604167, 'recall': 0.8399896, 'specificity': 0.9935541, 'f1': 0.84375066, 'auroc': 0.99551517}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     2    2     5    0    0    14     5     3    1     43
1     0  1271    0    12    1    0     0    42     3    0      3
2     1     0  222     0   21    0     3     2     3   55      5
3     2   135    0  7898    0   19     0   221   153    7      0
4     3     0   58     1  276    0     1     6    23    5    166
5     0     0    2    23    0  412     0     0     2   81      1
6    17     3    2     9    2    0  1822     6     9    4     33
7     1   119    1   177    2    1     2  6891    57    2     11
8     2    40    7   114   13    1     3    96  2961    6     52
9     2     0   52     8    1   71     2     4     5  345      3
10   13    32    5    19   21    3     7    23    34    0  12638
---- Validation: 
scalar performance:
{'acc': 0.9392537, 'precision': 0.85124445, 'recall': 0.83985364, 'specificity': 0.9934861, 'f1': 0.842397, 'auroc': 0.9948493}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     1    0     7    1    0     8     3     2    3     49
1     0  1270    0    15    0    0     0    42     2    0      3
2     1     1  218     0   24    0     1     5     3   55      4
3     0   141    0  7904    0   26     0   205   158    6      0
4     3     1   52     1  298    0     0     6    19   12    147
5     1     2    0    28    0  396     0     0     6   87      1
6    14     4    2     8    2    1  1834     5    12    2     24
7     3   142    4   172    1    0     2  6848    74    5     14
8     1    34    3   100   10    6     4   106  2965   11     56
9     3     1   45     8    1   79     3     1     6  345      1
10    8    29    6    21   35    2     9    23    34    2  12627
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57174844, 'precision': 0.58957034, 'recall': 0.4572497, 'specificity': 0.95570934, 'f1': 0.42635652, 'auroc': 0.8412735}
confusion matrix:
     0     1   2    3   4   5     6     7     8    9     10
0   242     0   0   13   0   0   721    23    16   16   139
1     0  1335   0   29   0   0     0    89     3    0    43
2     1    49  10   12   6   0    38    51   148   37   663
3     0     0   0    0   0   0     0     0     0    0     0
4     0     5   0    0   5   0     3     1     5    0  1614
5     1     0   0  179   0  88    56     2    53  198    15
6     4     3   0    1   0   0  2355     1    10    0   693
7     0    27   0   23   0   0    26  1073     5    0    10
8     0     0   1   42   1   0    27     7  1112    3   177
9     4    85  25   94   2   5    88   176   178  307   173
10    0     1   0    0   0   0     0     0     0    0  1645
new oracle model saved
early stop counter: 1
val acc:0.9392536878585815, best validation acc: 0.943961501121521, corresponding to test acc:                         0.5668509006500244 / 0.5717484354972839
after epoch: 8,now: 2024-08-12 08:30:44.225060,epoch time: 0:29:15.624238,used: 3:53:30.116548,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9476937, 'precision': 0.86773694, 'recall': 0.85511386, 'specificity': 0.99438244, 'f1': 0.8607977, 'auroc': 0.99664724}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     0    0     4    3    2    12     5     6    7     36
1     0  1253    0    13    0    0     0    60     4    0      2
2     0     0  204     0   32    0     3     4     5   62      2
3     1    53    0  8062    0   15     0   196   108    3      1
4     5     0   37     2  360    2     1     5    28    8     90
5     0     0    0    31    0  439     0     0     3   47      1
6     9     1    1     9    1    2  1850     4    10    2     18
7     2    44    2   177    2    0     1  6970    53    4      9
8     1    12    4   169   11    1     1    94  2974    6     22
9     4     0   25    10    1  107     1     1     6  338      0
10   15     5    4    15   89    1     9    23    65    3  12563
---- Validation: 
scalar performance:
{'acc': 0.9480273, 'precision': 0.8628949, 'recall': 0.8498487, 'specificity': 0.9944025, 'f1': 0.85568696, 'auroc': 0.99686635}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     5    1    0     8     5     6    3     45
1     0  1252    0    16    0    0     0    59     3    0      2
2     2     0  186     0   35    2     2     8     4   72      1
3     0    38    0  8074    0   21     0   204    99    2      2
4     6     0   41     2  357    1     1     4    22   11     94
5     2     0    0    27    0  438     0     0     4   49      1
6    11     2    0     7    1    1  1853     5     8    1     19
7     0    36    1   170    3    0     1  6985    55    4     10
8     2    13    3   155   13    4     1    98  2976    5     26
9     5     0   30     9    2  102     0     4     3  338      0
10   16     2    6    14   91    2    10    28    52    2  12573
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62051356, 'precision': 0.6517614, 'recall': 0.49583864, 'specificity': 0.9608951, 'f1': 0.4757688, 'auroc': 0.8534602}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   283     0   0   33   0    0   761    12    12   42    27
1     0  1268   0   36   0    0     3   145     8    0    39
2     4    28   9   37  28    4    91    52   337   70   355
3     0     0   0    0   0    0     0     0     0    0     0
4     0     5   0    0  82    0     9     1    20    0  1516
5     0     0   0  205   0  180    37     0    17  152     1
6     4     0   0    3   1    0  2812     2    20    0   225
7     0     7   0   52   0    0    34  1055     9    0     7
8     0     0   0  120   2    0    58     4  1143    6    37
9     5    40   7  206   2   19    79   131   197  398    53
10    0     1   0    0   5    0     1     0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 08:59:50.222450,epoch time: 0:29:05.997390,used: 4:22:36.113938,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9483358, 'precision': 0.875211, 'recall': 0.8566253, 'specificity': 0.99436736, 'f1': 0.8647715, 'auroc': 0.996614}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     2    0     2    1    1    23     3     3    3     39
1     0  1262    0    12    0    0     0    53     3    0      2
2     1     1  196     0   35    0     1     4     4   66      4
3     1    66    0  7977    0   18     3   279    93    1      2
4     4     2   26     1  374    1     1     8     7   10    105
5     1     0    0    25    0  437     0     0     4   53      1
6     6     1    0     4    1    1  1862     3     6    2     22
7     3    49    6   134    0    0     4  6979    63    2     23
8     4    22    5   131   26    2     9    76  2923    5     90
9     2     0   24     6    3   94     2     5     5  351      0
10    7     9    1    10   53    1    13     9    10    2  12678
---- Validation: 
scalar performance:
{'acc': 0.949873, 'precision': 0.87503666, 'recall': 0.8603364, 'specificity': 0.9945696, 'f1': 0.866685, 'auroc': 0.9968521}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     1    0     4    1    2    29     2     0    6     33
1     0  1264    0    12    1    0     0    50     3    0      2
2     0     0  196     0   41    0     1     4     2   68      0
3     2    56    0  8020    1   17     1   229   112    2      0
4     5     1   24     1  378    3     1     3    12    9    102
5     1     0    0    29    0  434     0     0     3   53      1
6    11     2    0     1    0    0  1862     6     6    2     18
7     2    59    4   131    3    0     2  6977    64    3     20
8     1    15    5   136   13    1     7    68  2961    5     84
9     2     0   26     6    1   85     2     4     2  365      0
10   12    11    2    13   64    2    16    10    15    2  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58336246, 'precision': 0.6390954, 'recall': 0.4758643, 'specificity': 0.95686376, 'f1': 0.44729382, 'auroc': 0.84099376}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   89     0   0   20   0    0   902    14    14   71    60
1    1  1251   0   36   0    0     0   150     8    1    52
2    0    11   8   21  13    4    38    33   257   76   554
3    0     0   0    0   0    0     0     0     0    0     0
4    0     2   0    0  40    0     4     0     9    0  1578
5    0     0   0  157   0  226    27     0    20  160     2
6    0     0   0    2   0    1  2468     1    17    0   578
7    0     4   0   50   0    0    39  1044    16    0    11
8    0     0   0   81   2    0    44     4  1140    8    91
9    0    28   8  138   3   27    77   101   232  431    92
10   0     1   0    0   4    0     0     0     0    0  1641
better model found
persisted
after epoch: 10,now: 2024-08-12 09:28:57.929711,epoch time: 0:29:07.707261,used: 4:51:43.821199,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:51:43.821199 at 2024-08-12 09:28:57.929711
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58336246, 'precision': 0.6390954, 'recall': 0.4758643, 'specificity': 0.95686376, 'f1': 0.44729382, 'auroc': 0.84099376}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   89     0   0   20   0    0   902    14    14   71    60
1    1  1251   0   36   0    0     0   150     8    1    52
2    0    11   8   21  13    4    38    33   257   76   554
3    0     0   0    0   0    0     0     0     0    0     0
4    0     2   0    0  40    0     4     0     9    0  1578
5    0     0   0  157   0  226    27     0    20  160     2
6    0     0   0    2   0    1  2468     1    17    0   578
7    0     4   0   50   0    0    39  1044    16    0    11
8    0     0   0   81   2    0    44     4  1140    8    91
9    0    28   8  138   3   27    77   101   232  431    92
10   0     1   0    0   4    0     0     0     0    0  1641
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62051356, 'precision': 0.6517614, 'recall': 0.49583864, 'specificity': 0.9608951, 'f1': 0.4757688, 'auroc': 0.8534602}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   283     0   0   33   0    0   761    12    12   42    27
1     0  1268   0   36   0    0     3   145     8    0    39
2     4    28   9   37  28    4    91    52   337   70   355
3     0     0   0    0   0    0     0     0     0    0     0
4     0     5   0    0  82    0     9     1    20    0  1516
5     0     0   0  205   0  180    37     0    17  152     1
6     4     0   0    3   1    0  2812     2    20    0   225
7     0     7   0   52   0    0    34  1055     9    0     7
8     0     0   0  120   2    0    58     4  1143    6    37
9     5    40   7  206   2   19    79   131   197  398    53
10    0     1   0    0   5    0     1     0     0    0  1639
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_37_13_seed_1_24142421_instance_wise_predictions.txt
accuracy from prediction file 0.5833624851325824
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494682 KiB |   3074 MiB | 456068 GiB | 456067 GiB |
|       from large pool | 403968 KiB |   3003 MiB | 455009 GiB | 455009 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1058 GiB |   1058 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 494682 KiB |   3074 MiB | 456068 GiB | 456067 GiB |
|       from large pool | 403968 KiB |   3003 MiB | 455009 GiB | 455009 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1058 GiB |   1058 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |   3052 MiB | 454240 GiB | 454240 GiB |
|       from large pool | 387840 KiB |   2982 MiB | 453186 GiB | 453185 GiB |
|       from small pool |  90258 KiB |    126 MiB |   1054 GiB |   1054 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3432 MiB |   3432 MiB |   5754 MiB |   2322 MiB |
|       from large pool |   3304 MiB |   3304 MiB |   5596 MiB |   2292 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    828 MiB |   1017 MiB | 218769 GiB | 218768 GiB |
|       from large pool |    819 MiB |   1016 MiB | 217581 GiB | 217580 GiB |
|       from small pool |      9 MiB |     30 MiB |   1188 GiB |   1188 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   40070 K  |   40067 K  |
|       from large pool |      87    |     177    |   16382 K  |   16382 K  |
|       from small pool |    2922    |    4522    |   23687 K  |   23684 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   40070 K  |   40067 K  |
|       from large pool |      87    |     177    |   16382 K  |   16382 K  |
|       from small pool |    2922    |    4522    |   23687 K  |   23684 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     130    |     183    |      53    |
|       from large pool |      66    |      66    |     104    |      38    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    1086    |   19790 K  |   19790 K  |
|       from large pool |      20    |      40    |   10121 K  |   10121 K  |
|       from small pool |      18    |    1065    |    9669 K  |    9669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3074 MiB | 456068 GiB | 456068 GiB |
|       from large pool |  16640 KiB |   3003 MiB | 455009 GiB | 455009 GiB |
|       from small pool |      0 KiB |    127 MiB |   1058 GiB |   1058 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3074 MiB | 456068 GiB | 456068 GiB |
|       from large pool |  16640 KiB |   3003 MiB | 455009 GiB | 455009 GiB |
|       from small pool |      0 KiB |    127 MiB |   1058 GiB |   1058 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3052 MiB | 454240 GiB | 454240 GiB |
|       from large pool |  16640 KiB |   2982 MiB | 453186 GiB | 453186 GiB |
|       from small pool |      0 KiB |    126 MiB |   1054 GiB |   1054 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1312 MiB |   3432 MiB |   5754 MiB |   4442 MiB |
|       from large pool |   1214 MiB |   3304 MiB |   5596 MiB |   4382 MiB |
|       from small pool |     98 MiB |    128 MiB |    158 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1017 MiB | 218770 GiB | 218769 GiB |
|       from large pool | 134912 KiB |   1016 MiB | 217581 GiB | 217581 GiB |
|       from small pool |      0 KiB |     30 MiB |   1188 GiB |   1188 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   40070 K  |   40070 K  |
|       from large pool |       2    |     177    |   16382 K  |   16382 K  |
|       from small pool |       0    |    4522    |   23687 K  |   23687 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   40070 K  |   40070 K  |
|       from large pool |       2    |     177    |   16382 K  |   16382 K  |
|       from small pool |       0    |    4522    |   23687 K  |   23687 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     130    |     183    |     104    |
|       from large pool |      30    |      66    |     104    |      74    |
|       from small pool |      49    |      64    |      79    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1086    |   19791 K  |   19791 K  |
|       from large pool |       3    |      40    |   10121 K  |   10121 K  |
|       from small pool |       0    |    1065    |    9669 K  |    9669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 09:35:18 2024]
Finished job 0.
1 of 1 steps (100%) done
