Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 13:25:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_13_33_24_seed_0_24144521

 Experiment start at: 2024-08-12 13:33:24.383556
before training, model accuracy: 0.08479675650596619
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.2856111, 'precision': 0.22756544, 'recall': 0.24902223, 'specificity': 0.92973083, 'f1': 0.18931626, 'auroc': 0.80011785}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     20     1   0   1   0   0   128    34   297   1   0
1      2  1028   0   0   0   0     7   274    21   0   0
2      7     2   0   3   0   0   101    60   135   4   0
3      8    21   0   2   0   0  5989  1028  1389   1   0
4     53     0   0   0   0   0    37    19   427   2   0
5      0     0   0   0   0   0   298     3   211   9   0
6     77     1   0   1   0   0   253    87  1485   4   0
7     39    87   0   2   0   0   243  6527   365   0   0
8     20     2   0   1   0   0   181   262  2827   2   0
9      0     0   0   1   0   0   244    31   199  18   0
10  3954     9   0   0   0   0    29   100  8702   0   0
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.28455263, 'precision': 0.21996984, 'recall': 0.24615152, 'specificity': 0.9296235, 'f1': 0.18572058, 'auroc': 0.7985666}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     19     1   0   2   0   0   142    33   284   2   0
1      6  1023   0   0   0   0     5   281    17   0   0
2      7     2   0   2   0   0   105    52   140   4   0
3      4    22   0   4   0   0  5984  1036  1389   1   0
4     53     1   0   0   0   0    36    23   424   2   0
5      1     2   0   2   0   0   288     0   217  11   0
6     71     1   0   2   0   0   235    76  1517   6   0
7     30   100   0   2   0   0   259  6523   351   0   0
8     32     2   0   1   0   0   175   263  2823   0   0
9      0     1   0   0   0   0   270    29   182  11   0
10  3956     9   0   0   0   0    27   126  8677   1   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20653467, 'precision': 0.17279193, 'recall': 0.20479041, 'specificity': 0.9198709, 'f1': 0.14238387, 'auroc': 0.62393737}
confusion matrix:
     0    1   2   3   4   5    6     7     8   9   10
0    25    0   0   1   0   0   38    16  1088   2   0
1    49  597   0   0   0   0    8   525   320   0   0
2    18    0   0   0   0   0   26     9   953   9   0
3     0    0   0   0   0   0    0     0     0   0   0
4   186    0   0   0   0   0    0     0  1447   0   0
5     0    0   0   1   0   0  217     1   298  75   0
6   294    0   0   0   0   0    1     4  2768   0   0
7    10   23   0   1   0   0   14  1009   107   0   0
8     2    0   0   0   0   0   62     0  1304   2   0
9     3    2   0   2   0   0  135    23   956  16   0
10  431    0   0   0   0   0    0     0  1215   0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 13:58:33.637093,epoch time: 0:25:09.253537,used: 0:25:09.253537,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_13_33_24_seed_0_24144521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.35035852, 'precision': 0.3314259, 'recall': 0.36604416, 'specificity': 0.9367817, 'f1': 0.26974028, 'auroc': 0.88117343}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0     79     4   0   75   0   0   192    21    88   24   0
1      5  1142   0    5   0   0     6   155    18    1   0
2      5     2   0   44   0   0   128    25    75   33   0
3      5    23   0  573   0   0  6079   643  1109    8   0
4     79     0   0   13   0   0   113    13   310   11   0
5      0     1   0   88   1   1   168     0    62  200   0
6     95     3   0   16   0   0  1398    42   343   11   0
7     35    31   0   79   0   0   123  6731   264    0   0
8     13     4   0   41   0   0   113   128  2989    7   0
9      3     0   0   92   0   1   144    14    57  182   0
10  6293    36   0    1   0   0   141    70  6247    2   0
---- Validation: 
scalar performance:
{'acc': 0.34955195, 'precision': 0.37602657, 'recall': 0.3660295, 'specificity': 0.9366834, 'f1': 0.27084973, 'auroc': 0.88132876}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0     80     1   0   59   0   0   217    20    83   23   0
1      8  1157   0    2   0   0     7   142    15    1   0
2     11     1   0   55   0   0   132    23    58   32   0
3     10    36   0  579   0   0  6031   689  1074   21   0
4     82     1   0   16   0   0   101    12   317   10   0
5      1     2   0   88   0   2   159     0    71  198   0
6     96     6   0   17   0   0  1331    39   411    8   0
7     31    25   0   89   0   0   115  6738   267    0   0
8      9     5   0   46   0   0    99   142  2990    5   0
9      3     2   0   96   0   0   130    11    60  191   0
10  6304    30   0    5   0   0   158    56  6241    2   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26957253, 'precision': 0.23296127, 'recall': 0.25201297, 'specificity': 0.9259373, 'f1': 0.20381871, 'auroc': 0.69650567}
confusion matrix:
     0    1   2   3   4   5    6     7     8    9   10
0    65    0   0  12   0   0  509    11   565    8   0
1    32  932   0   5   0   0    6   303   221    0   0
2     7    0   0   7   0   0   63    13   901   24   0
3     0    0   0   0   0   0    0     0     0    0   0
4   151    0   0   0   0   0    8     0  1474    0   0
5     0    0   0  75   0   0   79     0   147  291   0
6   263    0   0   1   0   0  359     3  2439    2   0
7     5    7   0   5   0   0   28  1017   102    0   0
8     0    0   0   8   0   0   25     0  1321   16   0
9     2    3   0  69   0   0  138    21   745  159   0
10  364    0   0   0   0   0    2     0  1280    0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 14:23:04.972406,epoch time: 0:24:31.335313,used: 0:49:40.588850,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_13_33_24_seed_0_24144521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.54419947, 'precision': 0.52333564, 'recall': 0.5253096, 'specificity': 0.95574796, 'f1': 0.43262014, 'auroc': 0.9234954}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    335     1   0    23   1   0    40    16    51   14   2
1      7  1152   0    11   0   0     0   146    15    0   0
2     29     5   0    41   1   0    59    28    63   77   8
3      4    23   0  7086   0   4    61   556   666   37   1
4    118     2   0    11   2   0    50    17   300   15  24
5      5     3   0   129   9  62     1     1    25  286   0
6    134     3   0    37   0   2  1497    24   198   12   0
7     36    22   0   167   0   0     4  6844   191    0   0
8     10     4   0   123   0   0     6   119  3027    7   0
9     33     4   0    67   5   9    24     9    42  300   0
10  8110    20   0    16   0   0    29    53  4528    2  35
---- Validation: 
scalar performance:
{'acc': 0.54366726, 'precision': 0.5277047, 'recall': 0.52748376, 'specificity': 0.9556656, 'f1': 0.43415782, 'auroc': 0.9240711}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    340     0   0    26   0   0    32    23    51   10   1
1      7  1160   0    11   0   0     1   132    18    2   1
2     33     8   0    36   4   0    58    31    59   79   4
3      3    20   0  7057   0   5    60   574   685   36   0
4     83     3   0     7   2   0    42    18   338   21  25
5      6     2   0   133   9  65     0     1    30  275   0
6    142     3   0    38   0   0  1494    25   187   18   1
7     32    17   0   165   0   0     1  6838   210    0   2
8     13     3   0   112   0   0     7   126  3030    5   0
9     31     2   0    66   2   8    21    14    44  304   1
10  8052    25   0    17   0   0    22    68  4571    6  35
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33967677, 'precision': 0.39372173, 'recall': 0.3118371, 'specificity': 0.9338751, 'f1': 0.25376463, 'auroc': 0.7295394}
confusion matrix:
     0    1   2    3   4   5    6    7     8    9   10
0   736    0   0    6   0   0  116    9   302    1   0
1    65  903   0   20   0   0   11  288   208    0   4
2    71    1   0   19   0   0   23    5   877   14   5
3     0    0   0    0   0   0    0    0     0    0   0
4   233    0   0    0   0   0    4    0  1388    0   8
5    39    0   0  123   0   1    2    0   155  272   0
6   817    0   0    2   0   0  740    2  1502    0   4
7    27    1   0   37   0   0   13  986    99    0   1
8     8    0   0   10   0   0    1    0  1343    8   0
9   137    3   0   84   0   0   20   21   723  146   3
10  447    0   0    2   0   0    0    0  1197    0   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 14:48:23.204379,epoch time: 0:25:18.231973,used: 1:14:58.820823,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_13_33_24_seed_0_24144521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8557631, 'precision': 0.65534794, 'recall': 0.64799666, 'specificity': 0.9851394, 'f1': 0.61216486, 'auroc': 0.9572591}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9      10
0    393     1   0    16   0    0    14    17    18    3     21
1      5  1189   0     9   0    0     0   111    16    0      1
2     25    11   0    35  11    3    42    27    74   75      9
3      6     1   0  7651   0    5     9   446   313    8      0
4     55     3   0     9  10    1    28    34   223   18    158
5      3     2   0   160   0  220     1     0    20  115      0
6     88     2   0    45   0    1  1646    17    87    8     14
7     31    36   0   164   0    0     2  6905   106    0     16
8      3     0   0   183   0    0     6   113  2968    2     21
9     36     3   0    72   4   58    10     9    43  256      2
10  1318     4   0    22   0    0    25    75   600    3  10747
---- Validation: 
scalar performance:
{'acc': 0.85216, 'precision': 0.65736586, 'recall': 0.6409726, 'specificity': 0.98475516, 'f1': 0.6052691, 'auroc': 0.9586683}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9      10
0    383     2   0    17   0    0    16    15    19    3     28
1      6  1172   0    10   0    0     0   131     9    0      4
2     34    10   0    29   6    4    49    23    79   73      5
3      7     0   0  7647   0    9     9   457   304    6      1
4     52     0   0     8   9    1    27    24   221   24    173
5      3     2   0   149   1  213     2     1    26  124      0
6     74     4   0    56   0    0  1673    17    57    6     21
7     28    28   0   196   0    0     0  6894   108    0     11
8      5     2   0   165   0    0     7   116  2969    2     30
9     40     4   0    77   2   65    19     5    39  240      2
10  1397     2   0    16   0    0    31    79   610    3  10658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4693906, 'precision': 0.47867748, 'recall': 0.39929458, 'specificity': 0.9467364, 'f1': 0.3474066, 'auroc': 0.74311364}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   590     0   0   25   0   0   283    17   251   0     4
1    25  1046   0   31   0   0     3   229   105   0    60
2    28     2   0   63   0   0    12    12   837   7    54
3     0     0   0    0   0   0     0     0     0   0     0
4    18     0   0    0   0   0     4     0   551   0  1060
5    16     0   0  404   0   2     4     0    88  78     0
6   272     0   0   16   0   0  1164     2  1281   1   331
7    13    16   0   45   0   0    15  1001    73   0     1
8     0     0   0   26   0   0     1     1  1341   1     0
9    83     6   0  261   0   0    15    28   672  65     7
10    8     0   0    1   0   0     0     0   137   0  1500
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 15:12:15.653734,epoch time: 0:23:52.449355,used: 1:38:51.270178,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_13_33_24_seed_0_24144521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.904832, 'precision': 0.7103635, 'recall': 0.6746842, 'specificity': 0.98959684, 'f1': 0.6703733, 'auroc': 0.9665094}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   371     0   0    12   1    0    10    21    10    5     53
1     2  1162   0    18   0    0     0   140     7    0      3
2    18    11   0    56  17    8    27    25    33  105     12
3     2     0   0  7903   0   11     2   330   174    9      6
4    40     0   0     7  29    6    18    41   146   30    222
5     1     0   0   114   1  314     0     0     9   81      1
6    66     2   0    50   0    1  1684    17    44   10     33
7     9     9   0   223   0    0     1  6908    88    1     24
8     6     0   0   237   0    1     2   123  2872    4     51
9    20     1   0    59   3  108     9     7    28  256      2
10  153     1   0    21   0    0    17    85   189    7  12320
---- Validation: 
scalar performance:
{'acc': 0.90394545, 'precision': 0.70856404, 'recall': 0.67342657, 'specificity': 0.9894976, 'f1': 0.66804504, 'auroc': 0.9672446}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   364     0   0    15   1    0     9    18    11    5     60
1     2  1151   0    14   0    0     0   152    10    0      3
2    20    12   0    54  13    3    28    28    40  103     11
3     0     4   0  7915   0   14     3   308   185    6      5
4    34     0   0    12  27   13    11    46   139   34    223
5     3     1   0   113   1  312     0     2    10   78      1
6    73     1   0    55   0    5  1685    12    37    9     31
7     7     6   0   233   0    0     1  6906    86    1     25
8     3     0   0   252   0    0     6   115  2853    5     62
9    24     1   0    53   3  112     3     8    20  267      2
10  176     1   0    19   2    1    17    68   195    3  12314
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47785628, 'precision': 0.45997566, 'recall': 0.4131706, 'specificity': 0.9475721, 'f1': 0.35862637, 'auroc': 0.7477672}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   677     0   0   49   0   0   239    7   181    1    16
1     3  1022   0   34   0   0     2  300    67    0    71
2    61     2   0   61   1   0     7   21   730   15   117
3     0     0   0    0   0   0     0    0     0    0     0
4     8     0   0    0   0   0     3    0   150    0  1472
5    32     0   0  364   0  24     1    0    58  113     0
6   189     0   0   23   0   0  1056    2  1061    2   734
7    28     4   0   90   0   0     8  975    55    0     4
8     2     0   0   35   0   0     2    3  1323    4     1
9   130     8   0  264   2   7     5   40   550  115    16
10    1     0   0    1   0   0     0    0     6    0  1638
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-12 15:36:04.750150,epoch time: 0:23:49.096416,used: 2:02:40.366594,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_13_33_24_seed_0_24144521
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 24144521 ON gpusrv76 CANCELLED AT 2024-08-12T15:39:58 ***
