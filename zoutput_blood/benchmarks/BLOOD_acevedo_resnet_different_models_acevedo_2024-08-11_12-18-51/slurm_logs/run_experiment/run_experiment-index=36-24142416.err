Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 20:07:17 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/36.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=36
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142416

 Experiment start at: 2024-08-11 20:17:34.007306
before training, model accuracy: 0.07954943180084229
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6962757, 'precision': 0.4126857, 'recall': 0.3227502, 'specificity': 0.9651004, 'f1': 0.3216659, 'auroc': 0.8493859}
confusion matrix:
    0    1   2     3   4   5    6     7    8    9      10
0    0    0   0   195   1   0   64    57   26  104     36
1    0  222   0   251   0   0    6   738    1    2    112
2    0    0   0   134   0   0   41    59   25   44      9
3    0    0   0  7960   0   0    0   423   15    5     35
4    0    1   0   128   1   0   94    59   42   37    176
5    0    0   0   413   0   0    2     4    8   90      4
6    0    1   0   462   0   0  780   123  121  223    198
7    0    0   0  2097   0   0    4  5039   38    5     81
8    0    0   0  1835   3   1   62   385  598   72    339
9    0    0   0   288   1   0   29    30    7  134      4
10   0    0   0   543   3   0  294   347  246   69  11290
---- Validation: 
scalar performance:
{'acc': 0.69493115, 'precision': 0.49635488, 'recall': 0.32395136, 'specificity': 0.964957, 'f1': 0.32246435, 'auroc': 0.84551674}
confusion matrix:
    0    1   2     3   4   5    6     7    8    9      10
0    1    1   0   189   1   0   67    54   15  106     49
1    0  214   0   273   1   1    3   733    0    1    106
2    0    1   0   127   2   0   45    57   17   44     19
3    0    0   0  7946   1   1    1   437   18    7     29
4    0    0   0   121   1   0   88    51   51   41    186
5    0    0   0   415   0   0    6     4   11   82      3
6    0    1   0   459   1   0  802   136  110  218    181
7    0    2   0  2073   1   0    5  5041   42    7     94
8    0    0   0  1823   2   0   55   405  605   64    342
9    0    0   0   297   1   0   19    26   10  139      1
10   0    3   0   516   5   0  318   376  285   62  11231
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29259077, 'precision': 0.2275557, 'recall': 0.25847095, 'specificity': 0.92797136, 'f1': 0.17907923, 'auroc': 0.68403274}
confusion matrix:
    0    1   2    3   4   5    6    7    8    9     10
0    0    0   0   98   0   0  240   46   29  746    11
1    0  159   0    3   3   0   49  892   16   10   367
2    0    0   0   56   0   0  197  221  150  196   195
3    0    0   0    0   0   0    0    0    0    0     0
4    0    0   0    5   0   0   85   14    6    9  1514
5    0    0   0  152   0   0   29   10   55  344     2
6    0    0   0   21   0   0  470  295  384   96  1801
7    1    3   0   26   0   1   53  964   44   28    44
8    0    0   0   66   0   0  215   34  509  390   156
9    0    1   0  118   0   2  113  230  182  443    48
10   0    0   0    0   0   0    9    0    0    0  1637
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 21:01:56.077467,epoch time: 0:44:22.070161,used: 0:44:22.070161,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142416
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.32146296, 'precision': 0.124565125, 'recall': 0.120905176, 'specificity': 0.9210024, 'f1': 0.0981698, 'auroc': 0.5619904}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   304   0   0   0   141   0   0    38
1    0   0   0   267   2   0   0  1030   0   0    33
2    0   0   0   173   0   0   0   113   1   0    25
3    0   0   0  6038   9   0   0  2260   7   1   124
4    0   0   0   294   0   0   0   187   0   1    57
5    0   0   0   351   0   0   0   142   2   0    26
6    0   0   0  1047   1   0   0   659   8   0   192
7    0   0   0  4640   4   0   0  2444   1   2   172
8    0   0   0  2303   0   0   0   731   8   0   253
9    0   0   0   294   0   0   0   170   2   0    26
10   0   0   0  5287   3   0   0  3913  63   2  3525
---- Validation: 
scalar performance:
{'acc': 0.3266551, 'precision': 0.1377936, 'recall': 0.122984916, 'specificity': 0.92161155, 'f1': 0.10036564, 'auroc': 0.55885786}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   302   0   0   0   144   0   0    37
1    0   0   0   278   0   0   0  1015   0   0    39
2    0   0   0   196   0   0   0   105   0   0    11
3    0   0   0  6100   3   0   0  2184   5   0   148
4    0   0   0   307   1   0   0   165   3   1    62
5    0   0   0   379   0   0   0   122   0   0    20
6    0   0   0   990   0   0   0   732   5   1   180
7    0   0   0  4584   5   0   0  2483   4   2   187
8    0   0   0  2285   1   0   0   762  13   0   235
9    0   0   0   301   0   0   0   163   1   0    28
10   0   0   0  5129   3   0   1  3983  59   6  3615
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.06576646, 'precision': 0.07965156, 'recall': 0.0620716, 'specificity': 0.911193, 'f1': 0.039120436, 'auroc': 0.4816325}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9    10
0    0   0   0   362   0   0   0  773   0   0   35
1    0   0   0   579   0   0   0  721   2   0  197
2    0   0   0   447   0   0   0  415   1   0  152
3    0   0   0     0   0   0   0    0   0   0    0
4    0   0   0   864   3   2   0  425  41   1  297
5    0   0   0   227   0   0   0  343   0   0   22
6    0   0   0  1984   0   1   0  804   6   0  272
7    0   0   0   577   0   0   0  443   2   0  142
8    0   0   0   735   0   0   0  567   2   0   66
9    0   0   0   554   0   0   0  463   1   0  119
10   0   0   0   773   3  14   0  306  58   0  492
early stop counter: 1
val acc:0.3266550898551941, best validation acc: 0.694931149482727, corresponding to test acc:                         0.29259076714515686 / 0.29259076714515686
after epoch: 2,now: 2024-08-11 21:45:02.474709,epoch time: 0:43:06.397242,used: 1:27:28.467403,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142416
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.33192423, 'precision': 0.085001215, 'recall': 0.099246874, 'specificity': 0.9130827, 'f1': 0.08010147, 'auroc': 0.5217169}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0    96   0   0   0    66   0   0   320
1    0   0   0   167   0   0   0   737   0   0   427
2    0   0   0    67   0   0   0    26   0   0   219
3    0   0   0  1683   0   0   0   944   1   0  5809
4    0   0   0    96   0   0   0    60   0   0   383
5    0   0   0   100   0   0   0    43   0   0   378
6    0   0   0   387   0   0   0   280   1   0  1239
7    0   0   0  1766   0   0   0   898   0   0  4600
8    0   0   0   654   0   0   0   285   3   0  2354
9    0   0   0   104   0   0   0    51   0   0   338
10   0   0   0  1695   0   0   0  1256  21   0  9822
---- Validation: 
scalar performance:
{'acc': 0.33334225, 'precision': 0.08342896, 'recall': 0.099687845, 'specificity': 0.9132909, 'f1': 0.08043413, 'auroc': 0.527638}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0    94   0   0   0    57   0   0   332
1    0   0   0   196   0   0   0   733   0   0   403
2    0   0   0    70   0   0   0    27   0   0   215
3    0   0   0  1735   0   0   0   940   0   0  5765
4    0   0   0   107   0   0   0    60   0   0   372
5    0   0   0   110   0   0   0    45   0   0   366
6    0   0   0   447   0   0   0   267   2   0  1192
7    0   0   0  1728   0   0   0   878   1   0  4658
8    0   0   0   646   0   0   0   292   2   0  2356
9    0   0   0   114   0   0   0    48   0   0   331
10   0   0   0  1684   0   0   0  1249  16   0  9847
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.09697054, 'precision': 0.011946372, 'recall': 0.076594956, 'specificity': 0.9087484, 'f1': 0.01822922, 'auroc': 0.456891}
confusion matrix:
    0   1   2    3   4   5   6   7   8   9     10
0    0   0   0  165   0   0   0   9   0   0   996
1    0   0   0   41   0   0   0   2   0   0  1456
2    0   0   0  106   0   0   0   0   0   0   909
3    0   0   0    0   0   0   0   0   0   0     0
4    0   0   0  214   0   0   0  17   0   0  1402
5    0   0   0  103   0   0   0   2   0   0   487
6    0   0   0  552   0   0   0  45   0   0  2470
7    0   0   0   25   0   0   0   2   0   0  1137
8    0   0   0  210   0   0   0   3   0   0  1157
9    0   0   0  155   0   0   0   1   0   0   981
10   0   0   0  241   0   0   0  21   0   0  1384
early stop counter: 2
val acc:0.3333422541618347, best validation acc: 0.694931149482727, corresponding to test acc:                         0.29259076714515686 / 0.29259076714515686
after epoch: 3,now: 2024-08-11 22:28:00.400854,epoch time: 0:42:57.926145,used: 2:10:26.393548,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142416
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.33839896, 'precision': 0.07705854, 'recall': 0.094860196, 'specificity': 0.91090655, 'f1': 0.061823357, 'auroc': 0.54118097}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9      10
0    0   0   0   2   0   0   0    51   0   0    430
1    0   0   0  18   0   0   0   752   0   0    562
2    0   0   0   1   0   0   0    43   0   0    268
3    0   0   0  67   0   0   0   819   0   0   7552
4    0   0   0   3   0   0   0    55   0   0    481
5    0   0   0   1   0   0   0    31   0   0    488
6    0   0   0   5   0   0   0   260   0   0   1643
7    0   0   0  65   0   0   0   875   0   0   6322
8    0   0   0  15   0   0   0   239   0   0   3042
9    0   0   0   5   0   0   0    41   0   0    447
10   0   0   0  54   0   0   0  1033   0   0  11706
---- Validation: 
scalar performance:
{'acc': 0.33869198, 'precision': 0.07709023, 'recall': 0.09509058, 'specificity': 0.9109802, 'f1': 0.06220118, 'auroc': 0.53718835}
confusion matrix:
    0   1   2   3   4   5   6     7   8   9      10
0    0   0   0   3   0   0   0    51   0   0    429
1    0   0   0  14   0   0   0   750   0   0    568
2    0   0   0   0   0   0   0    38   0   0    274
3    0   0   0  68   0   0   0   877   0   0   7495
4    0   0   0   2   0   0   0    53   0   0    484
5    0   0   0   2   0   0   0    38   0   0    481
6    0   0   0   6   0   0   0   258   0   0   1644
7    0   0   0  58   0   0   0   903   0   0   6304
8    0   0   0  21   0   0   0   225   0   0   3050
9    0   0   0   1   0   0   0    42   0   0    450
10   0   0   0  67   0   0   0  1038   0   0  11691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.10543623, 'precision': 0.010347323, 'recall': 0.08327782, 'specificity': 0.9081967, 'f1': 0.01780864, 'auroc': 0.47701785}
confusion matrix:
    0   1   2   3   4   5   6    7   8   9     10
0    0   0   0   0   0   0   0    5   0   0  1165
1    0   0   0   0   0   0   0    1   0   0  1498
2    0   0   0   0   0   0   0    6   0   0  1009
3    0   0   0   0   0   0   0    0   0   0     0
4    0   0   0   3   0   0   0  112   0   0  1518
5    0   0   0   0   0   0   0    0   0   0   592
6    0   0   0  14   0   0   0   78   0   0  2975
7    0   0   0   0   0   0   0    2   0   0  1162
8    0   0   0   0   0   0   0    1   0   0  1369
9    0   0   0   0   0   0   0    0   0   0  1137
10   0   0   0   0   0   0   0  141   0   0  1505
early stop counter: 3
val acc:0.33869197964668274, best validation acc: 0.694931149482727, corresponding to test acc:                         0.29259076714515686 / 0.29259076714515686
after epoch: 4,now: 2024-08-11 23:11:03.132410,epoch time: 0:43:02.731556,used: 2:53:29.125104,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142416
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 2:53:29.125104 at 2024-08-11 23:11:03.132410
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29259077, 'precision': 0.2275557, 'recall': 0.25847095, 'specificity': 0.92797136, 'f1': 0.17907923, 'auroc': 0.68403274}
confusion matrix:
    0    1   2    3   4   5    6    7    8    9     10
0    0    0   0   98   0   0  240   46   29  746    11
1    0  159   0    3   3   0   49  892   16   10   367
2    0    0   0   56   0   0  197  221  150  196   195
3    0    0   0    0   0   0    0    0    0    0     0
4    0    0   0    5   0   0   85   14    6    9  1514
5    0    0   0  152   0   0   29   10   55  344     2
6    0    0   0   21   0   0  470  295  384   96  1801
7    1    3   0   26   0   1   53  964   44   28    44
8    0    0   0   66   0   0  215   34  509  390   156
9    0    1   0  118   0   2  113  230  182  443    48
10   0    0   0    0   0   0    9    0    0    0  1637
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29259077, 'precision': 0.2275557, 'recall': 0.25847095, 'specificity': 0.92797136, 'f1': 0.17907923, 'auroc': 0.68403274}
confusion matrix:
    0    1   2    3   4   5    6    7    8    9     10
0    0    0   0   98   0   0  240   46   29  746    11
1    0  159   0    3   3   0   49  892   16   10   367
2    0    0   0   56   0   0  197  221  150  196   195
3    0    0   0    0   0   0    0    0    0    0     0
4    0    0   0    5   0   0   85   14    6    9  1514
5    0    0   0  152   0   0   29   10   55  344     2
6    0    0   0   21   0   0  470  295  384   96  1801
7    1    3   0   26   0   1   53  964   44   28    44
8    0    0   0   66   0   0  215   34  509  390   156
9    0    1   0  118   0   2  113  230  182  443    48
10   0    0   0    0   0   0    9    0    0    0  1637
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142416_instance_wise_predictions.txt
accuracy from prediction file 0.29259077870286154
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/36.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/36.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/36.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1704 MiB |  20452 MiB | 395647 GiB | 395645 GiB |
|       from large pool |   1511 MiB |  20295 MiB | 394825 GiB | 394824 GiB |
|       from small pool |    193 MiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1704 MiB |  20452 MiB | 395647 GiB | 395645 GiB |
|       from large pool |   1511 MiB |  20295 MiB | 394825 GiB | 394824 GiB |
|       from small pool |    193 MiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  20353 MiB | 394085 GiB | 394083 GiB |
|       from large pool |   1476 MiB |  20196 MiB | 393265 GiB | 393264 GiB |
|       from small pool |    192 MiB |    273 MiB |    819 GiB |    819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20988 MiB |  20988 MiB |  20988 MiB |      0 B   |
|       from large pool |  20712 MiB |  20712 MiB |  20712 MiB |      0 B   |
|       from small pool |    276 MiB |    276 MiB |    276 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 562322 KiB |   1192 MiB | 174604 GiB | 174603 GiB |
|       from large pool | 555344 KiB |   1191 MiB | 173701 GiB | 173700 GiB |
|       from small pool |   6978 KiB |     19 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   27942 K  |   27937 K  |
|       from large pool |     182    |     799    |   12408 K  |   12408 K  |
|       from small pool |    4194    |    6508    |   15533 K  |   15529 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   27942 K  |   27937 K  |
|       from large pool |     182    |     799    |   12408 K  |   12408 K  |
|       from small pool |    4194    |    6508    |   15533 K  |   15529 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|       from large pool |     356    |     356    |     356    |       0    |
|       from small pool |     138    |     138    |     138    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |    1098    |   13207 K  |   13206 K  |
|       from large pool |      21    |     176    |    6940 K  |    6940 K  |
|       from small pool |      22    |    1077    |    6266 K  |    6266 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  20353 MiB | 394085 GiB | 394085 GiB |
|       from large pool |  16640 KiB |  20196 MiB | 393265 GiB | 393265 GiB |
|       from small pool |      0 KiB |    273 MiB |    819 GiB |    819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2254 MiB |  20988 MiB |  20988 MiB |  18734 MiB |
|       from large pool |   2054 MiB |  20712 MiB |  20712 MiB |  18658 MiB |
|       from small pool |    200 MiB |    276 MiB |    276 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1192 MiB | 174605 GiB | 174605 GiB |
|       from large pool |  59136 KiB |   1191 MiB | 173701 GiB | 173701 GiB |
|       from small pool |      0 KiB |     32 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     160    |     494    |     494    |     334    |
|       from large pool |      60    |     356    |     356    |     296    |
|       from small pool |     100    |     138    |     138    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1098    |   13208 K  |   13208 K  |
|       from large pool |       4    |     176    |    6940 K  |    6940 K  |
|       from small pool |       0    |    1077    |    6267 K  |    6267 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  20353 MiB | 394085 GiB | 394085 GiB |
|       from large pool |  16640 KiB |  20196 MiB | 393265 GiB | 393265 GiB |
|       from small pool |      0 KiB |    273 MiB |    819 GiB |    819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2254 MiB |  20988 MiB |  20988 MiB |  18734 MiB |
|       from large pool |   2054 MiB |  20712 MiB |  20712 MiB |  18658 MiB |
|       from small pool |    200 MiB |    276 MiB |    276 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1192 MiB | 174605 GiB | 174605 GiB |
|       from large pool |  59136 KiB |   1191 MiB | 173701 GiB | 173701 GiB |
|       from small pool |      0 KiB |     32 MiB |    903 GiB |    903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     160    |     494    |     494    |     334    |
|       from large pool |      60    |     356    |     356    |     296    |
|       from small pool |     100    |     138    |     138    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1098    |   13208 K  |   13208 K  |
|       from large pool |       4    |     176    |    6940 K  |    6940 K  |
|       from small pool |       0    |    1077    |    6267 K  |    6267 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_23_26_07_seed_1_24142416

 Experiment start at: 2024-08-11 23:26:08.526029
before training, model accuracy: 0.06254810094833374
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6362104, 'precision': 0.3913721, 'recall': 0.25058353, 'specificity': 0.95346165, 'f1': 0.2557208, 'auroc': 0.81503296}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    3   0    48   0   1   73    26   13   0    319
1    0  326   0   252   0   0    0   269    2   0    483
2    0    3   0    24   0   0   17    13   13   0    242
3    0   55   0  6242   0   2   31  1246  167   0    695
4    0    1   0    20   0   0   10     5    4   0    499
5    0    1   1   367   0   6   24    12   58   2     50
6    0    5   0    74   0   3  193    26   29   0   1578
7    0  154   0   818   0   8   18  3959   94   0   2210
8    0    1   0   653   0   1   57   222  390   0   1972
9    0    4   0   164   0   3   44    27   58   3    190
10   0    2   0    99   0   0   11    10   11   0  12660
---- Validation: 
scalar performance:
{'acc': 0.6325264, 'precision': 0.34699118, 'recall': 0.24708903, 'specificity': 0.95307606, 'f1': 0.2515607, 'auroc': 0.81571615}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    2   0    52   0   2   78    20   18   0    311
1    0  303   0   293   0   0    0   277    2   0    457
2    0    0   0    38   0   1    7    18   12   0    236
3    0   30   0  6144   0   3   31  1319  180   1    732
4    0    0   0    25   0   0    8     9    8   0    489
5    0    3   0   355   0   5   22    10   52   3     71
6    0    1   0    72   0   0  191    30   31   0   1583
7    0  137   1   871   0   9   20  3974  106   0   2147
8    0    3   1   711   0   3   57   201  380   0   1940
9    0    6   0   185   0   7   47    24   49   1    174
10   0    0   0   112   0   1    9    16    9   0  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.16889386, 'precision': 0.15225399, 'recall': 0.1485589, 'specificity': 0.91477954, 'f1': 0.09641491, 'auroc': 0.6379879}
confusion matrix:
    0    1   2    3   4   5    6    7   8   9     10
0    0    2   0   18   0   6  313   19   1   0   811
1    0  184   0   18   0   0    1   70   0   0  1226
2    0    6   0   29   0   6   16   15   8   0   935
3    0    0   0    0   0   0    0    0   0   0     0
4    0    0   0    0   0   0    0    0   0   0  1633
5    0    1   0  291   0  24   18   32  29   0   197
6    0    4   0    1   0   2   18    1   0   0  3041
7    0  224   0   14   0   2    7  537   0   0   380
8    0   11   0   42   0  10   34   45   5   0  1223
9    0   21   0  104   0  16   41  109  21   0   825
10   0    0   0    0   0   0    0    0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 00:10:11.114120,epoch time: 0:44:02.588091,used: 0:44:02.588091,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_23_26_07_seed_1_24142416
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.39648438, 'precision': 0.12823588, 'recall': 0.11551322, 'specificity': 0.9180696, 'f1': 0.09036314, 'auroc': 0.53135604}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0    19   0   0   0    5   0   0    459
1    0   0   0   341   0   0   0  205   3   0    783
2    0   0   0    11   0   0   0   17   1   0    283
3    0   0   0  2221   0   0   0  130  12   0   6073
4    0   0   0    17   0   0   0   14   0   0    508
5    0   0   0    91   0   0   0    2   2   0    426
6    0   0   0    32   0   0   0   82   2   0   1792
7    0   0   0   508   0   0   0  361   5   0   6389
8    0   0   0   306   0   0   0   50   5   0   2935
9    0   0   0    27   0   0   0   10   0   0    456
10   0   0   0   195   0   0   0  363   3   0  12232
---- Validation: 
scalar performance:
{'acc': 0.39847532, 'precision': 0.12507808, 'recall': 0.11637205, 'specificity': 0.9183731, 'f1': 0.0916322, 'auroc': 0.54067284}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0    21   0   0   0    4   0   0    458
1    0   0   0   337   0   0   0  249   1   0    745
2    0   0   0    10   0   0   0   13   0   0    289
3    0   0   0  2280   0   0   0  127   8   0   6025
4    0   0   0     8   0   0   0   13   0   0    518
5    0   0   0    94   0   0   0    6   4   0    417
6    0   0   0    36   0   0   0  101   1   0   1770
7    0   0   0   508   0   0   0  391   5   0   6361
8    0   0   0   287   0   0   0   55   3   0   2951
9    0   0   0    25   0   0   0    8   1   0    459
10   0   0   0   213   0   0   0  354   6   0  12223
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.010469939, 'recall': 0.09090909, 'specificity': 0.9090918, 'f1': 0.018777309, 'auroc': 0.4696098}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   1   0   0   0   0   0   0   591
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 1
val acc:0.39847531914711, best validation acc: 0.6325263977050781, corresponding to test acc:                         0.16889385879039764 / 0.16889385879039764
after epoch: 2,now: 2024-08-12 00:52:43.655804,epoch time: 0:42:32.541684,used: 1:26:35.129775,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_23_26_07_seed_1_24142416
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.41748714, 'precision': 0.109152876, 'recall': 0.122594655, 'specificity': 0.9206882, 'f1': 0.09259132, 'auroc': 0.550367}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    29   0   0   0   0   0   0    454
1    0   0   0   443   0   0   0   4   0   0    884
2    0   0   0    15   0   0   0   0   0   0    297
3    0   0   0  3184   0   0   0  10   0   0   5244
4    0   0   0    18   0   0   0   0   0   0    521
5    0   0   0   135   0   0   0   0   0   0    386
6    0   0   0    70   0   0   0   0   0   0   1837
7    0   0   0   719   0   0   0   6   0   0   6538
8    0   0   0   295   0   0   0   3   0   0   2998
9    0   0   0    34   0   0   0   1   0   0    458
10   0   0   0   375   0   0   0   4   0   0  12414
---- Validation: 
scalar performance:
{'acc': 0.41497928, 'precision': 0.10593981, 'recall': 0.121561676, 'specificity': 0.92036855, 'f1': 0.09137962, 'auroc': 0.5515914}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    33   0   0   0   0   0   0    450
1    0   0   0   469   0   0   0   3   0   0    860
2    0   0   0    16   0   0   0   0   0   0    296
3    0   0   0  3086   0   0   0   9   1   0   5344
4    0   0   0    16   0   0   0   0   0   0    523
5    0   0   0   123   0   0   0   1   0   0    397
6    0   0   0    74   0   0   0   0   0   0   1834
7    0   0   0   735   0   0   0   5   0   0   6525
8    0   0   0   318   0   0   0   1   0   0   2977
9    0   0   0    31   0   0   0   0   0   0    462
10   0   0   0   366   0   0   0   7   0   0  12423
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.4389863}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 2
val acc:0.4149792790412903, best validation acc: 0.6325263977050781, corresponding to test acc:                         0.16889385879039764 / 0.16889385879039764
after epoch: 3,now: 2024-08-12 01:35:22.106342,epoch time: 0:42:38.450538,used: 2:09:13.580313,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_23_26_07_seed_1_24142416
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.4327376, 'precision': 0.09585114, 'recall': 0.1282591, 'specificity': 0.92264247, 'f1': 0.09844607, 'auroc': 0.5593217}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    26   0   0   0   0   0   0    457
1    0   0   0   397   0   0   0   0   0   0    935
2    0   0   0     5   0   0   0   0   0   0    307
3    0   0   0  3631   0   0   0  10   0   0   4797
4    0   0   0    19   0   0   0   0   0   0    520
5    0   0   0   174   0   0   0   2   0   0    345
6    0   0   0    58   0   0   0   0   0   0   1850
7    0   0   0   550   0   0   0   0   0   0   6715
8    0   0   0   335   0   0   0   0   0   0   2958
9    0   0   0    51   0   0   0   0   0   0    442
10   0   0   0   249   0   0   0   0   0   0  12543
---- Validation: 
scalar performance:
{'acc': 0.43199143, 'precision': 0.1040311, 'recall': 0.12795419, 'specificity': 0.9224608, 'f1': 0.0984705, 'auroc': 0.56177473}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0    24   0   0   0   0   0   0    459
1    0   0   0   358   0   0   0   0   0   0    974
2    0   0   0    15   0   0   0   0   0   0    297
3    0   0   0  3603   0   0   0  11   0   0   4826
4    0   0   0    10   0   0   0   0   0   0    529
5    0   0   0   161   0   0   0   1   0   0    359
6    0   0   0    49   0   0   0   0   0   0   1859
7    0   0   0   545   0   0   0   1   0   0   6719
8    0   0   0   280   0   0   0   0   0   0   3016
9    0   0   0    36   0   0   0   0   0   0    457
10   0   0   0   250   0   0   0   0   0   0  12546
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.44802874}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 3
val acc:0.43199142813682556, best validation acc: 0.6325263977050781, corresponding to test acc:                         0.16889385879039764 / 0.16889385879039764
after epoch: 4,now: 2024-08-12 02:18:04.676873,epoch time: 0:42:42.570531,used: 2:51:56.150844,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_23_26_07_seed_1_24142416
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 2:51:56.150844 at 2024-08-12 02:18:04.676873
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.16889386, 'precision': 0.15225399, 'recall': 0.1485589, 'specificity': 0.91477954, 'f1': 0.09641491, 'auroc': 0.6379879}
confusion matrix:
    0    1   2    3   4   5    6    7   8   9     10
0    0    2   0   18   0   6  313   19   1   0   811
1    0  184   0   18   0   0    1   70   0   0  1226
2    0    6   0   29   0   6   16   15   8   0   935
3    0    0   0    0   0   0    0    0   0   0     0
4    0    0   0    0   0   0    0    0   0   0  1633
5    0    1   0  291   0  24   18   32  29   0   197
6    0    4   0    1   0   2   18    1   0   0  3041
7    0  224   0   14   0   2    7  537   0   0   380
8    0   11   0   42   0  10   34   45   5   0  1223
9    0   21   0  104   0  16   41  109  21   0   825
10   0    0   0    0   0   0    0    0   0   0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.16889386, 'precision': 0.15225399, 'recall': 0.1485589, 'specificity': 0.91477954, 'f1': 0.09641491, 'auroc': 0.6379879}
confusion matrix:
    0    1   2    3   4   5    6    7   8   9     10
0    0    2   0   18   0   6  313   19   1   0   811
1    0  184   0   18   0   0    1   70   0   0  1226
2    0    6   0   29   0   6   16   15   8   0   935
3    0    0   0    0   0   0    0    0   0   0     0
4    0    0   0    0   0   0    0    0   0   0  1633
5    0    1   0  291   0  24   18   32  29   0   197
6    0    4   0    1   0   2   18    1   0   0  3041
7    0  224   0   14   0   2    7  537   0   0   380
8    0   11   0   42   0  10   34   45   5   0  1223
9    0   21   0  104   0  16   41  109  21   0   825
10   0    0   0    0   0   0    0    0   0   0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_23_26_07_seed_1_24142416_instance_wise_predictions.txt
accuracy from prediction file 0.16889386412929405
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/36.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/36.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1711 MiB |  20456 MiB |    772 TiB |    772 TiB |
|       from large pool |   1517 MiB |  20299 MiB |    770 TiB |    770 TiB |
|       from small pool |    193 MiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1711 MiB |  20456 MiB |    772 TiB |    772 TiB |
|       from large pool |   1517 MiB |  20299 MiB |    770 TiB |    770 TiB |
|       from small pool |    193 MiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  20353 MiB |    769 TiB |    769 TiB |
|       from large pool |   1476 MiB |  20196 MiB |    768 TiB |    768 TiB |
|       from small pool |    192 MiB |    273 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20960 MiB |  20988 MiB |  39694 MiB |  18734 MiB |
|       from large pool |  20684 MiB |  20712 MiB |  39342 MiB |  18658 MiB |
|       from small pool |    276 MiB |    276 MiB |    352 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 500658 KiB |   1192 MiB | 339763 GiB | 339763 GiB |
|       from large pool | 491632 KiB |   1191 MiB | 337964 GiB | 337964 GiB |
|       from small pool |   9026 KiB |     32 MiB |   1798 GiB |   1798 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   55884 K  |   55880 K  |
|       from large pool |     182    |     799    |   24817 K  |   24817 K  |
|       from small pool |    4194    |    6508    |   31066 K  |   31062 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   55884 K  |   55880 K  |
|       from large pool |     182    |     799    |   24817 K  |   24817 K  |
|       from small pool |    4194    |    6508    |   31066 K  |   31062 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     497    |     497    |     831    |     334    |
|       from large pool |     359    |     359    |     655    |     296    |
|       from small pool |     138    |     138    |     176    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    1098    |   25970 K  |   25970 K  |
|       from large pool |      26    |     177    |   13467 K  |   13467 K  |
|       from small pool |      27    |    1077    |   12502 K  |   12502 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  20456 MiB |    772 TiB |    772 TiB |
|       from large pool |  16640 KiB |  20299 MiB |    770 TiB |    770 TiB |
|       from small pool |      0 KiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  20456 MiB |    772 TiB |    772 TiB |
|       from large pool |  16640 KiB |  20299 MiB |    770 TiB |    770 TiB |
|       from small pool |      0 KiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  20353 MiB |    769 TiB |    769 TiB |
|       from large pool |  16640 KiB |  20196 MiB |    768 TiB |    768 TiB |
|       from small pool |      0 KiB |    273 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2200 MiB |  20988 MiB |  39694 MiB |  37494 MiB |
|       from large pool |   1998 MiB |  20712 MiB |  39342 MiB |  37344 MiB |
|       from small pool |    202 MiB |    276 MiB |    352 MiB |    150 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1192 MiB | 339764 GiB | 339764 GiB |
|       from large pool |  59136 KiB |   1191 MiB | 337965 GiB | 337965 GiB |
|       from small pool |      0 KiB |     39 MiB |   1799 GiB |   1799 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   55884 K  |   55884 K  |
|       from large pool |       2    |     799    |   24817 K  |   24817 K  |
|       from small pool |       0    |    6508    |   31066 K  |   31066 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   55884 K  |   55884 K  |
|       from large pool |       2    |     799    |   24817 K  |   24817 K  |
|       from small pool |       0    |    6508    |   31066 K  |   31066 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     167    |     497    |     831    |     664    |
|       from large pool |      66    |     359    |     655    |     589    |
|       from small pool |     101    |     138    |     176    |      75    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1098    |   25971 K  |   25971 K  |
|       from large pool |       4    |     177    |   13467 K  |   13467 K  |
|       from small pool |       0    |    1077    |   12503 K  |   12503 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 02:24:25 2024]
Finished job 0.
1 of 1 steps (100%) done
