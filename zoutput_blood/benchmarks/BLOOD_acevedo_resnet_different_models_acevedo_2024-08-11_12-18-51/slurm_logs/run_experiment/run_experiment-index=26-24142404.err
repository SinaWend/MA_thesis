Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 12:20:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/26.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=26
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404

 Experiment start at: 2024-08-11 12:29:42.132688
before training, model accuracy: 0.05282306298613548
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8318172, 'precision': 0.53430444, 'recall': 0.45889688, 'specificity': 0.9808755, 'f1': 0.45325422, 'auroc': 0.96235466}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    34   0   2   335    20    34   0     58
1    0  971   0   102   0   0     1   148     2   0    108
2    0    3   0    13   0   2   146    29    93   1     25
3    0   20   0  7531   0   1     7   470   332   0     74
4    0    0   0     7   0   0   127     6    91   0    308
5    0    0   0   321   0  43   102     0    48   3      4
6    0    4   0    30   0   1  1494    27   108   0    243
7    0   37   0   562   0   0     6  6240   191   0    228
8    0    3   0   327   0   0    80   161  2378   0    347
9    0    2   0   126   0  21   228    20    85   4      7
10   0    8   0    33   0   0   206    34    84   0  12429
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8332754, 'precision': 0.5375951, 'recall': 0.45926392, 'specificity': 0.98105234, 'f1': 0.4531102, 'auroc': 0.9634776}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    21   0   2   339    25    27   1     68
1    0  982   0    88   0   0     0   158     4   0    100
2    0    1   0    14   0   0   148    26    83   0     40
3    0   22   0  7557   0   1     1   479   315   0     65
4    0    0   0     7   0   0   126     9    82   0    315
5    0    0   0   325   0  36   103     0    50   5      2
6    0    5   0    29   0   0  1495    28   117   0    234
7    0   42   0   542   0   0    11  6261   180   0    229
8    0    9   0   335   0   0    92   165  2366   0    329
9    0    1   0   119   0  20   234    16    92   7      4
10   0    3   0    27   0   0   192    36    90   0  12448
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43461835, 'precision': 0.33379734, 'recall': 0.34030432, 'specificity': 0.94064045, 'f1': 0.29367787, 'auroc': 0.772268}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     0   0   30   0   2  1107   23    6   0     2
1    0  1094   0   32   0   0    37  173   13   0   150
2    0     2   0  108   0   1   517   27  244   0   116
3    0     0   0    0   0   0     0    0    0   0     0
4    0     1   0    1   0   0    54    1   12   0  1564
5    0     0   0  422   0  20    94    1   53   0     2
6    0     2   0    2   0   0  1636    3   44   0  1380
7    0    76   0    8   0   0    89  934   33   0    24
8    0     0   0  106   0   2   349    1  883   0    29
9    0    12   0  456   0   5   405   39  206   0    14
10   0     0   0    0   0   0     1    0    0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 13:02:15.314335,epoch time: 0:32:33.181647,used: 0:32:33.181647,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8864512, 'precision': 0.76697224, 'recall': 0.64746124, 'specificity': 0.9875752, 'f1': 0.6717858, 'auroc': 0.98322856}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   146     0   2    17   0    5   194    19    23   36     41
1     0  1133   0    25   0    0     1   149     4    0     20
2     7     2  74     9  25    7    14    26    55   85      8
3     0    36   0  7655   0   14     3   493   219    3     17
4     0     1  30     4  74    2    43    19   113   25    228
5     1     0   0   125   0  312     0     0    13   68      1
6     5     5   0    14   0    7  1767    19    33    6     52
7     0    50   0   332   1    0     5  6690   121    0     63
8     0     4   1   239   1    1    19   176  2772    1     81
9     4     3  22    50   0  138     7    14    36  216      3
10    3     8   4    21  10    2   183    78   184    6  12293
---- Validation: 
scalar performance:
{'acc': 0.8863983, 'precision': 0.7689636, 'recall': 0.6479124, 'specificity': 0.9876028, 'f1': 0.67327416, 'auroc': 0.98351395}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   149     1   2    18   0    5   204    23    20   25     36
1     0  1121   0    34   0    0     0   157     6    0     14
2     2     0  79     4  23   10    15    24    62   87      6
3     0    38   0  7632   0   20     3   517   209    1     20
4     3     1  32     4  75    2    46    13   112   20    231
5     1     0   1   128   0  309     0     2    13   65      2
6     3     3   0    22   0    5  1765    20    35   10     45
7     0    46   0   315   1    0     5  6717   129    0     52
8     0     9   2   255   1    0    28   158  2776    2     65
9     6     1  26    49   0  132     9    14    40  214      2
10    2     5   1    16  12    3   194    80   180    2  12301
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5479605, 'precision': 0.524692, 'recall': 0.42746675, 'specificity': 0.953038, 'f1': 0.37388656, 'auroc': 0.8401944}
confusion matrix:
    0     1   2    3   4    5     6     7     8   9     10
0    6     0   0   44   0    5  1037    41    17  20     0
1    0  1123   0   27   0    0    23   235     9   0    82
2    0     1   3   83   1   14   348    63   379   4   119
3    0     0   0    0   0    0     0     0     0   0     0
4    0     0   0    0   0    0    55     1    24   0  1553
5    1     0   0  374   0  140    41     0    25  11     0
6    0     2   0    1   0    0  2550     3    29   1   481
7    0    15   0    5   0    0    28  1091    18   0     7
8    0     0   1   81   0    2    60     3  1212   7     4
9    0    12   3  376   0   79   216   111   262  66    12
10   0     1   0    0   0    0     4     0     0   0  1641
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 13:33:36.658315,epoch time: 0:31:21.343980,used: 1:03:54.525627,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9187179, 'precision': 0.8082869, 'recall': 0.7537503, 'specificity': 0.99098057, 'f1': 0.77501553, 'auroc': 0.9910995}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   265     0    2    12    1    3    76    12    11   14     87
1     0  1250    1    16    1    0     0    49     3    0     12
2     1     2  135     5   60    3     3     5    21   70      7
3     1     0    0  7950    1   30     4   254   186    1     11
4     0     0   34     2  256    2     7     6    32   13    187
5     1     0    3    53    1  398     1     0     9   53      2
6    15     0    0     9    4    3  1742     4    17   11    101
7     0    56    2   336    5    0     3  6658   132    1     71
8     0     3    6   195   34    3     9    92  2841    3    107
9     3     0   47    16    2  147     2     6    11  253      6
10    8     2    2    10   74    1    36    17    52    3  12590
---- Validation: 
scalar performance:
{'acc': 0.91932595, 'precision': 0.8131386, 'recall': 0.7522925, 'specificity': 0.9910394, 'f1': 0.7761349, 'auroc': 0.9915004}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   258     0    2    14    2    3    73     9    11   19     92
1     0  1243    1    16    1    0     0    52     5    0     14
2     1     3  134     2   68    5     4     4    20   66      5
3     1     2    0  7931    0   34     3   267   195    3      4
4     1     0   31     2  243    2     1     6    52   13    188
5     0     0    1    60    0  386     2     0     6   64      2
6    10     0    4     7    5    1  1761     4    21    8     87
7     0    50    3   343    7    0     1  6658   135    0     68
8     1     1    8   195   28    3     8    93  2850    6    103
9     3     0   47    22    2  115     3     7    14  274      6
10    7     2    2    11   54    1    23    20    44    1  12631
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48464283, 'precision': 0.5427784, 'recall': 0.42252165, 'specificity': 0.94749683, 'f1': 0.3805223, 'auroc': 0.836696}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   60     0   1   97   0   23   798    35    57   75    24
1    0  1172   0   41   0    0     5   176     6    0    99
2    0     4  12  101  18   27    53    51   440   10   299
3    0     0   0    0   0    0     0     0     0    0     0
4    0     2   0    0  24    0     2     1    23    0  1581
5    2     0   0  297   0  258     4     0    25    5     1
6    7     1   1    1   5    2  1345     1    40    1  1663
7    0    14   0   25   0    0    21  1066    22    0    16
8    0     0   1  111   1    4     5     2  1231    5    10
9    1    21  22  435   3  138    40    78   251  113    35
10   0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 3,now: 2024-08-11 14:04:55.365211,epoch time: 0:31:18.706896,used: 1:35:13.232523,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9034675, 'precision': 0.79167503, 'recall': 0.77989614, 'specificity': 0.9890467, 'f1': 0.7847234, 'auroc': 0.9880351}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   353     0    1     4    0    2    18     5     5   15     80
1     0  1165    1    13    0    0     0    57     5    0     91
2     5     3  175     0   33    2     1     4     6   74      9
3     2    33    0  7543    0   60     4   327   247   11    210
4     1     1   61     3  277    0     3     4    24   17    148
5     1     0    3    40    0  380     0     0     6   82      9
6    63     2    3     7    6    1  1736     5    11    9     63
7     2   101    9   217    9    0    10  6442   167    4    303
8     1     5    8   137   28    6    24    75  2816   10    186
9     7     0   32     8    1  111     0     1     8  316      9
10   15    10   11    14   91    4    24    14    39    6  12565
---- Validation: 
scalar performance:
{'acc': 0.90373147, 'precision': 0.7846496, 'recall': 0.77661026, 'specificity': 0.98910034, 'f1': 0.7790127, 'auroc': 0.98886275}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   355     3    1     2    1    1    18     4     7    9     82
1     0  1185    0    12    1    0     1    52     6    0     75
2     1     3  167     1   33    1     0     5     4   89      8
3     6    34    1  7552    0   51     6   323   233    6    228
4     4     1   77     1  256    3     5     5    24   11    152
5     2     0    1    35    0  386     0     0     5   86      6
6    60     2    2     6    1    3  1740     5    10   13     66
7     4   123   19   229    7    0     7  6434   149    3    290
8     5    14   12   122   23    3    17    67  2834   14    185
9     4     0   37     9    0  115     1     0     5  312     10
10   19     8   11     8   83    4    30    25    39    4  12565
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5519485, 'precision': 0.599445, 'recall': 0.47057375, 'specificity': 0.9544414, 'f1': 0.44197875, 'auroc': 0.8491582}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   187     0   0   61   0   31   627    22    11  218    13
1     1  1161   0   43   0    0    10   197     3    0    84
2     0     3  21   84  11   48    75    55   306   64   348
3     0     0   0    0   0    0     0     0     0    0     0
4     0     2   0    0  35    0     9     1    22    0  1564
5     0     0   0  238   0  318     4     0     7   24     1
6    22     0   2    2   1    2  2024     4     7    3  1000
7     1     4   0   21   0    0    40  1075     9    0    14
8     0     0   2  153   0    8    19     2  1148   14    24
9     1    19  17  363   0  190    43    78   112  275    39
10    0     0   0    0   1    0     0     0     0    0  1645
new oracle model saved
early stop counter: 1
val acc:0.9037314653396606, best validation acc: 0.9193259477615356, corresponding to test acc:                         0.4846428334712982 / 0.5519484877586365
after epoch: 4,now: 2024-08-11 14:36:05.464975,epoch time: 0:31:10.099764,used: 2:06:23.332287,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.91360766, 'precision': 0.82150465, 'recall': 0.7779366, 'specificity': 0.99033356, 'f1': 0.7947095, 'auroc': 0.9888214}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   355     1    0     2    0    1    27     8     7    1     79
1     0  1115    1    12    0    0     0   103    10    0     91
2     2     0  148     1   43    2     2     9     6   94      5
3     2    67    0  7389    0   32    15   476   341    0    118
4     0     0   35     0  291    2     4     6    26   11    164
5     3     0    1    41    0  425     1     2    10   32      6
6    10     0    1     2    0    2  1810     7    15    2     58
7     2    66    7   104    5    0     6  6799   128    4    143
8     3    13    5    54   11    2    14    97  2947    5    145
9     5     2   24     9    0  177     4     3    12  252      5
10    8    13    7     8   51    3    17    23    45    0  12616
---- Validation: 
scalar performance:
{'acc': 0.9146984, 'precision': 0.8237001, 'recall': 0.7838967, 'specificity': 0.99047, 'f1': 0.7996243, 'auroc': 0.98943895}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   353     0    0     1    0    2    37     9     5    3     73
1     0  1122    1    13    2    0     1   103     7    0     83
2     4     0  163     1   42    3     2     4     5   79      9
3     4    58    0  7411    0   30    11   477   347    3     99
4     1     0   38     1  296    3     6     4    29    8    153
5     1     1    1    39    0  429     1     0     8   36      5
6    11     0    2     1    2    1  1806     6    11    2     66
7     3    70    7    93    3    0     9  6801   136    4    139
8     2    15    5    66   14    2    10    94  2933    0    155
9     9     0   31     7    1  162     3     3    14  255      8
10    9     9    4     8   49    1    26    25    38    0  12627
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5374659, 'precision': 0.5809153, 'recall': 0.44972652, 'specificity': 0.9520791, 'f1': 0.4092913, 'auroc': 0.8321117}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   31     0   0   25   0    8  1015    16    11   50    14
1    0  1078   0   31   0    0    25   246     6    0   113
2    0     1   5   42  11   29    75    66   341   43   402
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   0    0  25    0     8     1    23    0  1576
5    2     0   0  224   0  286    30     1    21   26     2
6    6     0   0    1   1    1  2080     4    11    0   963
7    0     1   0    7   0    0    95  1037    11    0    13
8    0     0   1   63   0    4    26     3  1239    3    31
9    1    11   8  239   0  123   123   134   176  256    66
10   0     0   0    0   1    0     0     0     0    0  1645
early stop counter: 2
val acc:0.9146984219551086, best validation acc: 0.9193259477615356, corresponding to test acc:                         0.4846428334712982 / 0.5519484877586365
after epoch: 5,now: 2024-08-11 15:07:03.320449,epoch time: 0:30:57.855474,used: 2:37:21.187761,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9241492, 'precision': 0.8266655, 'recall': 0.82774204, 'specificity': 0.9918949, 'f1': 0.82522255, 'auroc': 0.99412435}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   362     0    1     3    1    0    33     4     5    5     69
1     0  1283    0     4    0    0     0    35     7    0      3
2     2     0  175     0   43    0     5     5     1   79      2
3     2    30    2  7324    0   25     9   615   422    9      1
4     2     0   36     1  378    2     2     3    17    7     91
5     0     1    0    33    0  412     1     1     7   64      2
6    11     0    1     0    2    0  1844     4     7    2     37
7     2    56   15    69    9    0     9  6896   159    2     46
8     1    12   13    42   47    0    10    80  2983    4    102
9     3     0   39     6    1  102     1     0    10  329      1
10    5     8    4     6  152    3    25    16    16    3  12555
---- Validation: 
scalar performance:
{'acc': 0.9241942, 'precision': 0.8325532, 'recall': 0.8302382, 'specificity': 0.9918695, 'f1': 0.82952845, 'auroc': 0.99405587}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   373     0    0     2    1    0    28     4     6    5     64
1     0  1267    1     3    1    0     0    46    11    0      3
2     2     0  194     0   40    1     1     4    10   59      1
3     2    28    1  7331    3   24    11   620   407    3     10
4     1     2   39     0  364    1     1     5    16    8    102
5     0     0    1    43    0  408     0     1     8   59      1
6     7     0    1     0    6    0  1842     6     8    4     34
7     1    56   14    85    9    0     8  6876   161    2     53
8     0    17    9    37   52    3     6    63  3011    2     96
9     4     1   29     6    3  114     1     2     8  322      3
10    6     8    5     6  151    3    15    16    22    1  12563
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59910446, 'precision': 0.6173684, 'recall': 0.4980843, 'specificity': 0.9584006, 'f1': 0.46775907, 'auroc': 0.84857666}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   75     0   0   13    0    2   878    22    16  149    15
1    0  1207   0   28    0    0    17   178     7    0    62
2    0     3  12   21   57   19   101    69   320   74   339
3    0     0   0    0    0    0     0     0     0    0     0
4    0     1   1    0  191    0    12     1    19    0  1408
5    0     0   0  167    0  307    14     0    19   84     1
6    7     0   1    1    3    1  2419     3     7    0   625
7    0     5   0    5    0    0    93  1044     6    0    11
8    0     0   1   42    4    3    27     4  1263    6    20
9    1    16  13  148    2   74    87   149   198  413    36
10   0     1   0    0   13    0     0     0     0    0  1632
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-11 15:38:01.189988,epoch time: 0:30:57.869539,used: 3:08:19.057300,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92966074, 'precision': 0.84176564, 'recall': 0.8176974, 'specificity': 0.9924756, 'f1': 0.8255901, 'auroc': 0.99203503}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   384     1    0     3    1    4    18    12     9    3     48
1     0  1210    0    22    0    0     0    76     4    0     19
2     2     2  199     0   31    6     1     9    11   50      1
3     1   131    0  7720    0   10     4   365   197    0     10
4     2     1   38     2  312    2     2     5    56    8    111
5     0     3    0    42    0  438     0     1     6   29      1
6     8     4    3     9    0    2  1826     9    16    4     27
7     1    96    2   115    2    0     2  6932    82    1     31
8     5    23    4   102    6    2     5   109  3009    0     31
9     4     2   36    14    1  161     1     8    10  255      0
10   16    33    4    10   59    3    19    49   134    4  12462
---- Validation: 
scalar performance:
{'acc': 0.92997193, 'precision': 0.84718287, 'recall': 0.81657475, 'specificity': 0.99249053, 'f1': 0.82764924, 'auroc': 0.9926604}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   370     0    1     6    1    2    23    14     5    7     54
1     0  1223    0    16    0    0     0    76     2    0     15
2     2     0  198     3   22    3     2    10    12   58      2
3     0   115    0  7755    0   15     2   360   176    1     16
4     3     1   41     0  315    3     0     9    55    8    104
5     0     0    0    53    1  425     0     0    10   31      1
6     7     3    0     7    0    2  1826     9    14    2     38
7     2   114    1   123    1    0     4  6898    92    1     29
8     3    32    3    90    5    2     8   112  3019    1     21
9     3     1   29    14    1  155     1     9     9  270      1
10    7    22    8     8   51    4    17    66   144    1  12468
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5116491, 'precision': 0.5711758, 'recall': 0.42398039, 'specificity': 0.9507696, 'f1': 0.37426037, 'auroc': 0.83415866}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   36     1   0  107   0   22   684   121    18  170    11
1    0  1104   0   36   0    0     1   306     3    0    49
2    0     3   1  137   1   26    36   181   409   41   180
3    0     0   0    0   0    0     0     0     0    0     0
4    0     1   0    1  23    0     3     7   117    0  1481
5    0     0   0  380   0  183     1     1    18    8     1
6    4     0   1    7   1    2  1856    18   197    4   977
7    0     2   0    4   0    0    13  1140     1    0     4
8    0     0   0  152   0    1     3    20  1192    0     2
9    0    16   1  518   0  105    15   245    85  138    14
10   0     1   0    0   0    0     0     0     5    0  1640
better model found
persisted
after epoch: 7,now: 2024-08-11 16:09:07.062948,epoch time: 0:31:05.872960,used: 3:39:24.930260,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92955375, 'precision': 0.83586156, 'recall': 0.84409773, 'specificity': 0.992474, 'f1': 0.83780015, 'auroc': 0.99114645}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     1    1     1    2    0    26     3     4    3     54
1     0  1226    3    12    1    0     1    58     4    0     27
2     2     0  225     1   47    0     0     2     5   27      3
3     5   171    1  7628    1   28    13   259   296    5     32
4     2     0   27     0  384    1     1     1    13    7    103
5     1     0    4    31    0  422     0     0     7   52      3
6     6     1    1     2    2    0  1853     7     3    3     30
7     5   136   14   133    3    0     9  6719   164    5     76
8     4    47    5    46   24    1    11    49  3013    3     92
9     4     2   62     3    1  103     1     1    10  305      1
10    3    38    7     6  100    3    13    21    19    1  12581
---- Validation: 
scalar performance:
{'acc': 0.9300789, 'precision': 0.83223575, 'recall': 0.84443325, 'specificity': 0.99253297, 'f1': 0.83574843, 'auroc': 0.9897298}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     4    1     2    0    2    18     2     3    2     55
1     0  1236    2    11    0    0     1    45     7    0     30
2     2     0  229     0   43    1     2     0     3   30      2
3     7   158    2  7626    2   27     8   259   310    9     32
4     2     3   31     0  380    2     1     3    10    5    102
5     1     4    3    25    1  430     0     0     7   48      2
6    10     3    0     0    3    2  1844     5     4    2     35
7     5   135   15   118    8    0     6  6760   148    1     69
8     2    41    8    42   29    0     6    52  3011    4    101
9     6     1   69     6    2  110     0     3     4  288      4
10   11    43    5     5   94    2    10    26    27    0  12573
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55341774, 'precision': 0.6378553, 'recall': 0.4572305, 'specificity': 0.9541287, 'f1': 0.4325714, 'auroc': 0.8376629}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   87     0   0   31    0    0   858    18     8  133    35
1    1  1081   0   39    0    0    11   261     5    0   101
2    0     2   9   64   23   11    62    64   322   61   397
3    0     0   0    0    0    0     0     0     0    0     0
4    0     0   0    0  132    0     4     2    25    0  1470
5    0     0   0  293    0  201    14     1    27   55     1
6    2     0   0    1    2    1  2119     5    27    0   910
7    0     1   0    9    0    0    70  1067     4    0    13
8    0     0   1   91    1    1    21     3  1232    2    18
9    0     8   5  322    1   73    82   109   133  345    59
10   0     0   0    0    9    0     0     0     0    0  1637
better model found
persisted
after epoch: 8,now: 2024-08-11 16:40:31.214776,epoch time: 0:31:24.151828,used: 4:10:49.082088,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9473727, 'precision': 0.88049924, 'recall': 0.8520611, 'specificity': 0.99422204, 'f1': 0.8647938, 'auroc': 0.9961217}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     1    0     1    1    0    10     3     2    2     69
1     0  1213    2    12    2    0     0    69     5    0     29
2     1     0  199     0   48    2     0     4     3   48      7
3     2     9    0  7882    0   23     3   249   258    1     12
4     2     0   18     0  366    3     0     3    20    8    119
5     0     0    1    20    0  401     0     0     7   90      2
6     5     0    0     2    5    0  1839     5     9    2     41
7     2    13    3   118    7    0     0  6997    91    1     32
8     0     2    6    57   17    2     3    71  3078    2     57
9     3     0   30     4    2   58     0     2     9  382      3
10    4     3    1     8   70    2     4    11    28    1  12658
---- Validation: 
scalar performance:
{'acc': 0.94602114, 'precision': 0.8762934, 'recall': 0.84845734, 'specificity': 0.99407566, 'f1': 0.86086667, 'auroc': 0.99609107}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     1    0     5    0    0    11     3     3    2     76
1     0  1223    1     8    0    0     0    65     6    0     29
2     2     0  194     1   59    0     1     3     3   48      1
3     2    16    1  7853    1   19     2   266   266    7      7
4     1     0   11     0  385    3     0     3    16    4    116
5     0     0    1    25    0  396     0     0     5   93      1
6     9     1    2     4    1    1  1829     6     5    5     45
7     3    10    2   120    4    0     1  6994    91    3     37
8     0     6    8    63   17    3     1    66  3070    1     61
9     4     0   42     3    2   60     0     3     4  372      3
10    1     1    1     9   64    2     7    11    30    1  12669
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5033233, 'precision': 0.63652134, 'recall': 0.44959688, 'specificity': 0.9494289, 'f1': 0.43053043, 'auroc': 0.84017706}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   178     0   0   46    0    0   521    55     3  267   100
1     3  1043   0   37    0    0     4   297     3    0   112
2     0     1   8   48   29    5     9    92   175   97   551
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  136    0     1     3    20    0  1473
5     0     0   0  218    0  206     2     1    18  145     2
6     8     0   0    1    2    1  1159     4    16    1  1875
7     0     1   0   10    0    0    18  1121     3    0    11
8     0     0   1  110    1    0     6    10  1188   10    44
9     0     8   5  259    0   31    16   147    72  519    80
10    0     0   0    0   10    0     0     0     0    0  1636
better model found
persisted
after epoch: 9,now: 2024-08-11 17:12:09.236749,epoch time: 0:31:38.021973,used: 4:42:27.104061,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9407909, 'precision': 0.85869056, 'recall': 0.8426749, 'specificity': 0.99372935, 'f1': 0.8470361, 'auroc': 0.9950078}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     1    0     3    0    0    13     2     2    6     33
1     0  1256    0    11    0    0     0    43     6    0     16
2     1     0  178     0   32    4     3     1     4   85      4
3     4    87    0  7834    0   16    16   188   278    4     10
4     3     2   24     0  342    3     1     0    40    9    115
5     0     0    0    29    0  439     0     0    11   41      1
6    11     1    0     1    2    1  1858     2     4    3     24
7    13    75    3   149    1    0     7  6786   195    2     32
8     3    16    4    57    3    1     7    24  3138    3     39
9     1     0   16     7    1  147     0     0    10  310      1
10   11    17    2     6   38    2    29    21    64    5  12599
---- Validation: 
scalar performance:
{'acc': 0.9421961, 'precision': 0.8653707, 'recall': 0.84641135, 'specificity': 0.99385154, 'f1': 0.85167634, 'auroc': 0.9949916}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     1    0     3    0    0    15     3     1    2     33
1     0  1264    0     8    0    0     0    37     4    0     19
2     0     0  174     1   33    4     1     5     6   83      5
3     6    90    0  7857    0   16    13   180   267    3      8
4     6     1   22     0  333    1     4     3    31   13    125
5     0     0    0    26    0  448     0     0     6   40      1
6     8     0    0     0    0    0  1870     2     4    5     19
7    11    71    3   164    3    0     7  6755   213    3     35
8     0    22    3    47    3    1     4    30  3142    3     41
9     2     0   12     5    1  131     2     2     9  328      1
10   13     8    2     6   37    3    24    18    54    3  12628
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5753865, 'precision': 0.61339414, 'recall': 0.46238503, 'specificity': 0.95645165, 'f1': 0.43524128, 'auroc': 0.8443719}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   123     0   0   38   0    1   800    23     1  171    13
1     1  1072   0   43   0    0    22   265     8    0    88
2     0     1   1   82   7   14   154    49   333   77   297
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    0  36    0    13     1    37    0  1545
5     0     0   0  295   0  198    13     0    12   73     1
6     1     0   0    1   0    1  2574     6    19    1   464
7     0     1   0   14   0    0    64  1068     6    0    11
8     0     0   0  152   0    1    33     2  1161    4    17
9     0     9   3  384   0   64   100    85   115  348    29
10    0     0   0    0   1    0     1     0     1    0  1643
early stop counter: 1
val acc:0.9421960711479187, best validation acc: 0.9460211396217346, corresponding to test acc:                         0.5033233165740967 / 0.5991044640541077
after epoch: 10,now: 2024-08-11 17:43:45.011171,epoch time: 0:31:35.774422,used: 5:14:02.878483,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:14:02.878483 at 2024-08-11 17:43:45.011171
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5033233, 'precision': 0.63652134, 'recall': 0.44959688, 'specificity': 0.9494289, 'f1': 0.43053043, 'auroc': 0.84017706}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   178     0   0   46    0    0   521    55     3  267   100
1     3  1043   0   37    0    0     4   297     3    0   112
2     0     1   8   48   29    5     9    92   175   97   551
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  136    0     1     3    20    0  1473
5     0     0   0  218    0  206     2     1    18  145     2
6     8     0   0    1    2    1  1159     4    16    1  1875
7     0     1   0   10    0    0    18  1121     3    0    11
8     0     0   1  110    1    0     6    10  1188   10    44
9     0     8   5  259    0   31    16   147    72  519    80
10    0     0   0    0   10    0     0     0     0    0  1636
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59910446, 'precision': 0.6173684, 'recall': 0.4980843, 'specificity': 0.9584006, 'f1': 0.46775907, 'auroc': 0.84857666}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   75     0   0   13    0    2   878    22    16  149    15
1    0  1207   0   28    0    0    17   178     7    0    62
2    0     3  12   21   57   19   101    69   320   74   339
3    0     0   0    0    0    0     0     0     0    0     0
4    0     1   1    0  191    0    12     1    19    0  1408
5    0     0   0  167    0  307    14     0    19   84     1
6    7     0   1    1    3    1  2419     3     7    0   625
7    0     5   0    5    0    0    93  1044     6    0    11
8    0     0   1   42    4    3    27     4  1263    6    20
9    1    16  13  148    2   74    87   149   198  413    36
10   0     1   0    0   13    0     0     0     0    0  1632
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_29_41_seed_0_24142404_instance_wise_predictions.txt
accuracy from prediction file 0.5033233051143916
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/26.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/26.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/26.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488154 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool | 397440 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |  90714 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488154 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool | 397440 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |  90714 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10851 MiB |    848 TiB |    848 TiB |
|       from large pool | 387840 KiB |  10780 MiB |    847 TiB |    847 TiB |
|       from small pool |  90258 KiB |    126 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11310 MiB |  11310 MiB |  11310 MiB |      0 B   |
|       from large pool |  11182 MiB |  11182 MiB |  11182 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 775461 KiB |    807 MiB | 443778 GiB | 443777 GiB |
|       from large pool | 767872 KiB |    806 MiB | 442982 GiB | 442981 GiB |
|       from small pool |   7589 KiB |     15 MiB |    796 GiB |    796 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   44482 K  |   44479 K  |
|       from large pool |      87    |     490    |   24459 K  |   24459 K  |
|       from small pool |    2922    |    4522    |   20022 K  |   20019 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   44482 K  |   44479 K  |
|       from large pool |      87    |     490    |   24459 K  |   24459 K  |
|       from small pool |    2922    |    4522    |   20022 K  |   20019 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     181    |     181    |     181    |       0    |
|       from large pool |     117    |     117    |     117    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    1002    |   18753 K  |   18753 K  |
|       from large pool |      17    |      65    |    9974 K  |    9974 K  |
|       from small pool |      22    |     985    |    8778 K  |    8778 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10851 MiB |    848 TiB |    848 TiB |
|       from large pool |  16640 KiB |  10780 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |    126 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1234 MiB |  11310 MiB |  11310 MiB |  10076 MiB |
|       from large pool |   1138 MiB |  11182 MiB |  11182 MiB |  10044 MiB |
|       from small pool |     96 MiB |    128 MiB |    128 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    829 MiB | 443778 GiB | 443778 GiB |
|       from large pool | 134912 KiB |    810 MiB | 442982 GiB | 442982 GiB |
|       from small pool |      0 KiB |     30 MiB |    796 GiB |    796 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   44482 K  |   44482 K  |
|       from large pool |       2    |     490    |   24459 K  |   24459 K  |
|       from small pool |       0    |    4522    |   20022 K  |   20022 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   44482 K  |   44482 K  |
|       from large pool |       2    |     490    |   24459 K  |   24459 K  |
|       from small pool |       0    |    4522    |   20022 K  |   20022 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     181    |     181    |     112    |
|       from large pool |      21    |     117    |     117    |      96    |
|       from small pool |      48    |      64    |      64    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1002    |   18753 K  |   18753 K  |
|       from large pool |       3    |      65    |    9974 K  |    9974 K  |
|       from small pool |       0    |     985    |    8779 K  |    8779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10867 MiB |    849 TiB |    849 TiB |
|       from large pool |  16640 KiB |  10795 MiB |    848 TiB |    848 TiB |
|       from small pool |      0 KiB |    127 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10851 MiB |    848 TiB |    848 TiB |
|       from large pool |  16640 KiB |  10780 MiB |    847 TiB |    847 TiB |
|       from small pool |      0 KiB |    126 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1234 MiB |  11310 MiB |  11310 MiB |  10076 MiB |
|       from large pool |   1138 MiB |  11182 MiB |  11182 MiB |  10044 MiB |
|       from small pool |     96 MiB |    128 MiB |    128 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    829 MiB | 443778 GiB | 443778 GiB |
|       from large pool | 134912 KiB |    810 MiB | 442982 GiB | 442982 GiB |
|       from small pool |      0 KiB |     30 MiB |    796 GiB |    796 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   44482 K  |   44482 K  |
|       from large pool |       2    |     490    |   24459 K  |   24459 K  |
|       from small pool |       0    |    4522    |   20022 K  |   20022 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   44482 K  |   44482 K  |
|       from large pool |       2    |     490    |   24459 K  |   24459 K  |
|       from small pool |       0    |    4522    |   20022 K  |   20022 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     181    |     181    |     112    |
|       from large pool |      21    |     117    |     117    |      96    |
|       from small pool |      48    |      64    |      64    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1002    |   18753 K  |   18753 K  |
|       from large pool |       3    |      65    |    9974 K  |    9974 K  |
|       from small pool |       0    |     985    |    8779 K  |    8779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404

 Experiment start at: 2024-08-11 17:56:34.792807
before training, model accuracy: 0.06989435851573944
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8185734, 'precision': 0.5058003, 'recall': 0.43970278, 'specificity': 0.9791614, 'f1': 0.43241516, 'auroc': 0.9564909}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    18   0   2   310    18    40   0     95
1    0  971   0    22   0   0     0   268    10   0     61
2    0    1   0    11   0   0   150    20    61   0     69
3    0    4   0  7258   0   0    13   571   552   0     40
4    0    1   0     4   0   0    94    13    51   0    376
5    0    0   0   336   0  10    95     5    71   2      2
6    0    2   0    12   0   0  1358    32    97   0    406
7    0   53   0   473   0   0    17  6176   265   0    279
8    0    2   0   238   0   0   162   144  2243   0    506
9    0    0   0   106   0   6   244    16   110   1     10
10   0    2   0    11   0   0    92    54    56   0  12578
---- Validation: 
scalar performance:
{'acc': 0.81958, 'precision': 0.48802587, 'recall': 0.44048303, 'specificity': 0.97930545, 'f1': 0.43334013, 'auroc': 0.9561874}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    1   0    17   0   4   311    21    39   0     90
1    0  963   0    16   0   0     0   277    11   0     65
2    0    1   0    10   0   0   161    25    47   0     68
3    0    6   0  7291   0   0    16   551   541   0     35
4    0    0   0     3   0   0    97     7    54   0    378
5    0    0   0   324   0  14    92     1    87   0      3
6    0    3   0    21   0   0  1337    27   112   0    408
7    0   60   0   487   0   0    15  6144   287   0    272
8    0    1   0   199   0   0   138   150  2315   0    493
9    0    0   0   120   0   2   236    16   114   0      5
10   0    7   0     7   0   0    93    57    56   0  12576
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3907507, 'precision': 0.25705206, 'recall': 0.2909073, 'specificity': 0.93484074, 'f1': 0.24827021, 'auroc': 0.7475452}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     0   0    4   0   0  1123    0   40   0     3
1    0  1011   0   15   0   0    68   42   69   0   294
2    0     2   0   15   0   0   634    1  163   0   200
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    57    0    4   0  1572
5    0     0   0  302   0   0    88    0  201   0     1
6    0     0   0    0   0   0  1709    0   21   0  1337
7    0   109   0    6   0   0   250  606  134   0    59
8    0     0   0   28   0   0   649    0  615   0    78
9    0     9   0   78   0   0   564    6  458   0    22
10   0     0   0    0   0   0     2    0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 18:29:13.579386,epoch time: 0:32:38.786579,used: 0:32:38.786579,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88599634, 'precision': 0.73871505, 'recall': 0.6279441, 'specificity': 0.9872383, 'f1': 0.63616455, 'auroc': 0.98393524}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   123     1   1    11   0   32   122    14    26   71     82
1     0  1149   0    18   0    0     0   133    10    1     20
2     4     3  36    12   7    9     2    26    45  111     57
3     0     1   0  7684   0   71     2   332   338    1      9
4     6     0   6     2   7    4    12     4    83   24    391
5     2     0   1    94   0  369     0     0     8   45      2
6    19     5   1    13   0    7  1657    13    58   16    118
7     0    50   1   396   0    2     3  6443   262    2    106
8     0     2   0   185   0    4     6    84  2865    8    139
9     3     2  12    39   0  167     5    13    31  214      7
10   17     2   2    11   0    2    43    34   113    2  12568
---- Validation: 
scalar performance:
{'acc': 0.88762873, 'precision': 0.7680831, 'recall': 0.6282821, 'specificity': 0.98738384, 'f1': 0.6379453, 'auroc': 0.98339355}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   108     0   1    13   0   29   120    15    27   80     90
1     0  1152   0    22   0    1     0   125    12    0     20
2     3     2  39     7   4    9     3    23    49  108     65
3     0     1   0  7720   0   54     1   341   315    3      5
4     5     0   3     4  11    7     8     5    88   28    380
5     1     0   0    97   0  365     0     0    13   44      1
6    20     2   1    12   0   10  1647    22    57   17    120
7     0    52   1   366   0    2     7  6511   213    1    112
8     1     2   1   205   0    5     9    89  2825   12    147
9     2     2  13    34   0  165     3    15    27  228      4
10   11     2   0     9   0    3    52    40    98    3  12578
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49758622, 'precision': 0.46725523, 'recall': 0.41845948, 'specificity': 0.94815457, 'f1': 0.373509, 'auroc': 0.8178411}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   31     0   0    7   0   39   914    1    87   80    11
1    0  1146   0   27   0    0    23   86    79    0   138
2    0     5   0   23   0   30    90    7   504   32   324
3    0     0   0    0   0    0     0    0     0    0     0
4    0     0   0    0   0    0     8    0    19    0  1606
5    0     0   0  228   0  294    13    0    42   14     1
6    2     1   0    1   0    0  1810    1   117    7  1128
7    0    62   0   10   0    0    91  809   151    2    39
8    0     0   0   78   0    8    12    0  1203   13    56
9    3    17   0  150   0  157    61   13   529  173    34
10   0     0   0    0   0    0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 19:00:44.810776,epoch time: 0:31:31.231390,used: 1:04:10.017969,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9066513, 'precision': 0.79664826, 'recall': 0.7343687, 'specificity': 0.9897717, 'f1': 0.7578402, 'auroc': 0.9893312}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   239     0    2     5    3    0   118    11     8    3     94
1     0  1210    3    10    1    1     2    84     9    0     12
2     4     1  155     1   67    0     5     1    18   46     14
3     1     0    0  7432    0   22    20   453   498    7      7
4     2     0   16     1  227    1     8     1    37    8    237
5     8     0    4    77    1  287     4     0    14  123      3
6    10     0    1     1    1    1  1827     7     9    3     48
7     2    20   10   188    9    0    10  6679   237    2    106
8     1     0   10    75   26    2    43    68  2947    2    122
9    14     1   70    14    9   67     7     5    22  280      4
10   10     0    1     7   32    3    55    28    49    1  12604
---- Validation: 
scalar performance:
{'acc': 0.90774375, 'precision': 0.8042189, 'recall': 0.74175906, 'specificity': 0.98986065, 'f1': 0.7654624, 'auroc': 0.98980784}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   240     0    3     4    3    1   100     9    11    7    105
1     0  1220    1     7    1    0     0    77     8    0     18
2     2     1  155     1   68    1     4     6    12   48     14
3     0     1    0  7443    0   28    19   453   487    5      4
4     2     0   17     2  242    0    11     3    26   10    226
5     7     0    3    69    1  314     5     0    10  110      2
6     6     1    2     1    0    1  1817    10    13    3     54
7     1    18    8   173    5    0     9  6708   238    1    104
8     1     3    9    80   42    0    46    76  2904    3    132
9    12     1   77    20    3   50    15     4    18  283     10
10    7     0    2     8   43    1    51    21    52    1  12610
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5050724, 'precision': 0.54857826, 'recall': 0.3988304, 'specificity': 0.94822896, 'f1': 0.36583954, 'auroc': 0.8301713}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0   78     0   0    6   0   0  1005    1    34    5    41
1    0  1210   0   17   0   0    28   81    34    0   129
2    0     8  10   11  21   2   107   12   238   11   595
3    0     0   0    0   0   0     0    0     0    0     0
4    0     0   0    0  15   0     4    0     7    0  1607
5    3     0   0  247   0  94   100    0   113   31     4
6    3     1   0    0   1   0  2070    1     5    0   986
7    3    29   0    2   0   0   158  849    66    0    57
8    0     0   0   21   2   0    46    1  1109    0   191
9   17    27  31   78  15  22   168   20   496  139   124
10   0     0   0    0   1   0     0    0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 19:32:20.597130,epoch time: 0:31:35.786354,used: 1:35:45.804323,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.91804904, 'precision': 0.8036593, 'recall': 0.78406525, 'specificity': 0.99105114, 'f1': 0.79136425, 'auroc': 0.99149644}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   323     3    2     2    3    0    54     8     3    4     81
1     0  1153    2    31    0    0     0   118     8    0     20
2     5     0  176     2   49    1     3     3     5   65      3
3     1     7    0  7923    0   59    11   207   215    6      7
4     2     0   34     0  306    4     6     3    19    8    157
5     3     0    2    39    0  417     1     0     5   53      1
6    25     2    0     6    2    4  1811     7     9    4     36
7     5    71   21   372    3    1    15  6496   195    4     81
8     1     2   15   162   34    9    33    51  2874    8    106
9     5     1   52    14    1  146     3     3     8  256      4
10    8     6    6     7   98    2    28    26    36    0  12578
---- Validation: 
scalar performance:
{'acc': 0.9184432, 'precision': 0.8045032, 'recall': 0.7819959, 'specificity': 0.9910759, 'f1': 0.7908058, 'auroc': 0.9917236}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   328     2    1     2    2    3    47     7     7    6     78
1     0  1150    0    32    1    0     2   119     6    0     22
2     4     0  169     2   53    3     2     1    10   64      4
3     3     8    1  7928    1   59    10   189   225   11      5
4     1     0   32     0  305    4     4     3    25   10    155
5     0     0    2    43    0  414     2     0     8   51      1
6    32     1    2     6    2    1  1810     8     8    2     36
7     3    59   20   356    4    0    13  6513   190    5    102
8     4     3    6   164   36   12    29    52  2873    6    111
9     2     0   50    11    4  150     6     4     7  255      4
10   12     8    5    11   81    2    32    22    32    0  12591
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56915975, 'precision': 0.622751, 'recall': 0.45717555, 'specificity': 0.95526224, 'f1': 0.44141263, 'auroc': 0.84653634}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   164     0   0   20    0    6   889    0    11   32    48
1     0  1288   0   32    0    0    14   62    20    0    83
2     1    17  11   32   22   13   101   11   282   46   479
3     0     0   0    0    0    0     0    0     0    0     0
4     0     3   0    0  101    0     8    0    14    0  1507
5     1     0   0  273    0  216    39    0    29   32     2
6     5     2   0    1    1    1  2461    1     5    1   589
7     1    64   0   26    0    0   198  790    50    2    33
8     0     0   0   77    3    1    39    0  1159    6    85
9     2    38  20  196    3   87   102   21   306  306    56
10    0     1   0    0    6    0     0    0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 20:03:51.631292,epoch time: 0:31:31.034162,used: 2:07:16.838485,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9268782, 'precision': 0.84297025, 'recall': 0.7973493, 'specificity': 0.992102, 'f1': 0.816651, 'auroc': 0.9941949}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   341     0    1     5    2    0    47    15     8    1     62
1     0  1209    1     8    0    0     0   103     4    0      7
2     4     0  185     1   48    2     3    11    16   37      5
3     3     2    0  7559    0    7     2   473   387    0      3
4     2     0   29     0  313    3     1     5    47    7    132
5     2     0    3    70    0  376     0     0    21   48      1
6    14     0    1     3    2    0  1812    10    22    2     41
7     0     9    2   109    1    0     2  7002   111    0     28
8     1     2    2    62   12    0     6    91  3085    0     35
9     5     0   52    15    3  113     2     9    24  265      5
10   14     2    5     8   95    1    22    33   118    0  12496
---- Validation: 
scalar performance:
{'acc': 0.93037313, 'precision': 0.8424671, 'recall': 0.8054334, 'specificity': 0.9925064, 'f1': 0.8213878, 'auroc': 0.9940515}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   348     0    0     3    1    0    36    13    11    4     67
1     0  1214    2     9    0    0     1    91     7    0      8
2     4     1  191     0   49    2     3     5    12   43      2
3     1     4    0  7626    0    8     3   450   345    0      3
4     1     0   22     0  337    1     3     5    40    8    122
5     2     0    0    71    0  372     1     0    19   55      1
6    15     1    0     1    2    2  1832     7    17    1     30
7     1    15    3   103    1    0     3  6992   120    1     26
8     1     1    4    66   10    0     4    85  3095    0     30
9     8     0   65    14    1  109     3     6    21  263      3
10   18     1    4     6   96    1    27    35    96    0  12512
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55733573, 'precision': 0.6482351, 'recall': 0.43722907, 'specificity': 0.95471555, 'f1': 0.3827755, 'auroc': 0.842654}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   108     0   0   23   0   1   787    64   117   7    63
1     0  1230   0   27   0   0     2   167    19   0    54
2     0    10   2   46   3   2    48    54   588   9   253
3     0     0   0    0   0   0     0     0     0   0     0
4     0     3   0    0  95   0     4     1    81   0  1449
5     0     0   0  396   0  66    20     3    89  17     1
6     3     2   0    2   1   0  2347     2    77   0   633
7     0     8   0    5   0   0    10  1116    19   0     6
8     0     0   0   48   0   0     5    13  1299   0     5
9     1    23   1  254   1  27    61   150   530  67    22
10    0     1   0    0   6   0     0     0     3   0  1636
better model found
persisted
after epoch: 5,now: 2024-08-11 20:35:19.860948,epoch time: 0:31:28.229656,used: 2:38:45.068141,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.933781, 'precision': 0.83387256, 'recall': 0.82660055, 'specificity': 0.99301314, 'f1': 0.8275301, 'auroc': 0.9945774}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   352     0    1     3    0    3    41     5     9   10     59
1     0  1271    1    13    0    0     1    32     9    0      4
2     1     0  174     0   35    1     1     2     5   92      1
3     3     9    1  7798    1   63     9   246   294    7      6
4     1     0   35     1  330    2     2     3    36   15    113
5     0     0    1    26    0  425     1     0     9   58      1
6     7     2    0     1    0    2  1862     3     9    4     18
7     2    52   10   208    3    0    12  6751   197    6     23
8     1     6    7    65    9    7    14    57  3095    7     27
9     1     0   21     4    1  117     3     1    11  333      1
10   11     9   10     5  111    1    27    18    89    3  12510
---- Validation: 
scalar performance:
{'acc': 0.9329678, 'precision': 0.8293736, 'recall': 0.818821, 'specificity': 0.99294585, 'f1': 0.82043886, 'auroc': 0.9946983}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   341     0    0     2    1    2    52     5     9   10     61
1     0  1273    0    12    0    0     1    35     9    0      2
2     0     1  154     0   36    1     3     1    13  100      3
3     1     9    0  7804    0   68    13   232   302    8      3
4     1     1   40     2  323    2     2     4    36   17    111
5     0     2    0    21    0  427     0     0     7   63      1
6     6     2    1     2    0    1  1850     5    11    6     24
7     1    57    6   200    6    0    10  6758   200    7     20
8     1     7    6    72    8    5    11    54  3103    6     23
9     4     1   22     5    1  109     3     0     8  340      0
10   13     9    8     7  111    2    28    25    84    3  12506
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58553135, 'precision': 0.6683292, 'recall': 0.46954498, 'specificity': 0.9572428, 'f1': 0.43387595, 'auroc': 0.8458957}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   32     0   0   23   0    2   818   10    39  124   122
1    0  1289   0   34   0    0     8   82    27    0    59
2    0    10   7   31  10   11    48   12   546   81   259
3    0     0   0    0   0    0     0    0     0    0     0
4    0     4   0    0  66    0     7    0    63    0  1493
5    0     0   0  245   0  228    23    0    30   64     2
6    2     2   0    1   1    1  2595    2    33    2   428
7    0    30   0   27   0    0   174  856    68    2     7
8    0     0   0   68   0    1    11    4  1271    2    13
9    0    26   1  188   0   83    48   35   346  389    21
10   0     1   0    0   3    0     4    0     2    0  1636
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-11 21:06:47.387336,epoch time: 0:31:27.526388,used: 3:10:12.594529,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94410855, 'precision': 0.8589501, 'recall': 0.83807963, 'specificity': 0.9939413, 'f1': 0.8471296, 'auroc': 0.99551666}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0     3    1    0    15     5     6    3     64
1     0  1259    0    11    0    0     0    50     5    0      7
2     2     0  177     0   38    0     1     3     6   81      4
3     1     3    3  8073    0   20     3   168   157    4      5
4     3     0   26     0  362    1     0     4    21   13    109
5     1     0    0    42    0  410     0     0     5   62      1
6    18     0    0     4    5    1  1837     4    10    4     24
7     2    23    6   213    5    0     1  6814   156    4     41
8     0     2    3   125   23    1     4    50  3041    4     43
9     2     0   26    11    1  103     0     2     6  337      5
10    6     0    3     8  112    2    10     9    50    0  12591
---- Validation: 
scalar performance:
{'acc': 0.9430253, 'precision': 0.8540081, 'recall': 0.8341074, 'specificity': 0.99384785, 'f1': 0.8421376, 'auroc': 0.9954271}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     2    1     4    3    1    15     4     7    5     64
1     0  1257    1    12    0    0     0    52     4    0      6
2     1     0  168     1   48    1     1     3     9   80      0
3     3     2    2  8074    1   22     4   163   161    3      5
4     1     0   25     2  361    2     1     5    24   11    107
5     0     0    0    36    0  424     1     0     7   52      1
6    12     0    0     2    2    0  1835     6    15    3     33
7     2    24    6   217    4    0     5  6820   148    5     34
8     2     0    5   111   24    4     6    51  3039    2     52
9     3     0   25    11    2  115     2     1     5  329      0
10    8     0    3     7  127    1    12    11    55    1  12571
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55299795, 'precision': 0.64887655, 'recall': 0.45450538, 'specificity': 0.9545158, 'f1': 0.42812777, 'auroc': 0.84223646}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   119     0   0   40    0    0   557    43    48  126   237
1     1  1276   0   40    0    0     3    93    12    0    74
2     0    13   4   39   31    3    12    25   476   69   343
3     0     0   0    0    0    0     0     0     0    0     0
4     0     2   0    0  100    0     2     0    33    0  1496
5     0     0   0  337    0  135    10     1    21   86     2
6     2     3   0    1    2    1  2005     2    46    1  1004
7     0    11   0   30    0    0    54  1025    33    0    11
8     0     0   0  107    0    1     3     5  1237    1    16
9     0    33   2  284    1   29    19    58   310  365    36
10    0     1   0    0    6    0     0     0     1    0  1638
better model found
persisted
after epoch: 7,now: 2024-08-11 21:38:16.390079,epoch time: 0:31:29.002743,used: 3:41:41.597272,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9462222, 'precision': 0.86761117, 'recall': 0.8348481, 'specificity': 0.99404573, 'f1': 0.847952, 'auroc': 0.99582016}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   343     2    0     2    1    2    29     8     0    4     92
1     0  1288    0    10    0    0     1    26     3    0      4
2     1     1  199     0   36    0     2     4     2   65      2
3     1    12    0  7972    0   38     5   229   169    4      7
4     1     2   32     0  325    1     0     4    10   11    152
5     1     0    1    20    1  450     0     0     5   42      1
6     5     2    1     2    2    1  1834     4     5    6     46
7     0    50    6   142    2    0     4  6938    78    6     36
8     0     1    6    83   24    3     9    66  2996    6    102
9     3     0   31     6    2  127     1     1     3  314      5
10    5     2    3     6   36    1     6    15    12    1  12707
---- Validation: 
scalar performance:
{'acc': 0.9446837, 'precision': 0.86403584, 'recall': 0.83307177, 'specificity': 0.9938753, 'f1': 0.8453546, 'auroc': 0.9953515}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   361     4    0     2    1    1    18     6     2    8     80
1     0  1291    1     9    0    0     1    25     3    0      2
2     0     2  191     0   40    2     1     1     5   67      3
3     0     9    1  7976    0   44     4   231   163    6      6
4     0     1   32     1  313    2     0     1    12    9    168
5     1     0    0    27    0  447     0     0     3   42      1
6     5     2    1     4    3    2  1839     4     5    5     38
7     1    56    5   166    3    0     5  6895    71    4     59
8     1     5    4    75   19    6    11    73  2998    6     98
9     2     1   27     4    3  127     2     5     6  314      2
10    4    10    1     7   49    2     8    14     8    1  12692
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5727979, 'precision': 0.6813892, 'recall': 0.4623362, 'specificity': 0.95616907, 'f1': 0.42494354, 'auroc': 0.83993447}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   102     0   0   30   0    0   749    42    16   50   181
1     0  1334   0   31   0    0     4    71     4    0    55
2     0    41   1   37   7    3    27    38   381   44   436
3     0     0   0    0   0    0     0     0     0    0     0
4     0     7   0    0  20    0     4     2    18    0  1582
5     0     0   0  290   0  166    21     5    27   78     5
6     1     3   0    2   1    1  2359     2    29    0   669
7     0    31   0   14   0    0    33  1062     9    0    15
8     0     1   0   76   0    1     9    14  1232    0    37
9     0    72   0  235   0   26    41   118   316  269    60
10    0     1   0    0   1    0     2     0     0    0  1642
better model found
persisted
after epoch: 8,now: 2024-08-11 22:10:00.772177,epoch time: 0:31:44.382098,used: 4:13:25.979370,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94782746, 'precision': 0.86547023, 'recall': 0.8517851, 'specificity': 0.9944277, 'f1': 0.85648984, 'auroc': 0.99622416}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   372     1    1     4    3    1    41     2     4    6     47
1     0  1295    0    11    0    1     0    21     3    0      1
2     1     1  198     0   34    0     2     3    10   62      1
3     1    14    0  8088    0   36     6   127   161    2      2
4     2     1   35     1  358    2     1     3    24    7    105
5     0     0    0    21    0  458     0     0     2   39      1
6     5     5    0     3    1    0  1858     1     6    1     26
7     4    69    3   223    2    0     6  6783   155    3     17
8     1     2    3    96   13    2     6    33  3092    1     45
9     2     0   26     3    1  126     2     3     5  324      1
10    7    15    3     6   91    1    11    17    43    1  12600
---- Validation: 
scalar performance:
{'acc': 0.9466631, 'precision': 0.86198115, 'recall': 0.84742403, 'specificity': 0.9943152, 'f1': 0.8523538, 'auroc': 0.99573547}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     3    0     2    1    3    34     4     3    5     51
1     0  1291    0     8    0    0     0    25     7    0      1
2     0     1  191     1   33    2     2     4    10   67      1
3     2    16    0  8087    0   31     8   130   163    0      3
4     1     0   35     0  354    2     2     3    28    9    105
5     0     0    1    16    0  461     2     0     5   35      1
6     8     5    0     2    3    1  1856     1     8    0     24
7     3    77    2   222    4    0     5  6776   153    4     19
8     1     2    1   101   11    4     9    42  3089    2     34
9     2     0   28     7    2  131     3     2     4  312      2
10    7     9    4     5   90    0    14    17    50    3  12597
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5682502, 'precision': 0.5883712, 'recall': 0.45887467, 'specificity': 0.9555578, 'f1': 0.4231165, 'auroc': 0.8433585}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   164     0   0   22   0    0   770    32    14   36   132
1     0  1293   0   31   0    0     5   118     8    0    44
2     0    28   0   26  11    3    50    41   515   36   305
3     0     0   0    0   0    0     0     0     0    0     0
4     0     4   0    0  42    0     7     2    48    0  1530
5     0     0   0  253   0  142    41     3    35  116     2
6     2     3   0    1   1    0  2291     2    52    0   715
7     0     6   0   13   0    0    71  1058    12    0     4
8     0     0   0   78   0    0    20    12  1240    1    19
9     1    34   0  223   0   17    69   117   384  253    39
10    0     1   0    0   3    0     1     0     2    0  1639
better model found
persisted
after epoch: 9,now: 2024-08-11 22:41:29.967138,epoch time: 0:31:29.194961,used: 4:44:55.174331,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9486034, 'precision': 0.873396, 'recall': 0.8539779, 'specificity': 0.9945344, 'f1': 0.8592504, 'auroc': 0.99653834}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     1    0     1    1    2    38     4     4    4     49
1     0  1280    0     8    0    0     0    29    11    0      3
2     1     0  172     0   47    0     3     1     3   84      1
3     2     9    1  8000    0   79     4   109   230    3      0
4     2     0   15     1  372    3     2     2    22    6    114
5     0     0    0     9    0  461     0     1     4   45      1
6     3     3    0     0    2    0  1874     2     5    2     17
7     3    31    8   225    4    1    12  6767   177    8     26
8     1     2    2    63    6    7    10    24  3144    5     32
9     1     0   15     1    1  112     1     3     5  353      1
10    7     7    2     8   43    2    16     8    47    1  12653
---- Validation: 
scalar performance:
{'acc': 0.9492042, 'precision': 0.8747497, 'recall': 0.85553044, 'specificity': 0.994575, 'f1': 0.860446, 'auroc': 0.9963012}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     2    0     1    1    1    33     2     4    3     57
1     0  1284    0     7    0    0     1    27     9    0      4
2     1     1  170     0   49    1     2     1     3   82      2
3     3    11    0  8032    0   87     6   106   190    3      2
4     1     0   11     1  374    1     2     2    24    8    115
5     0     0    0     7    0  464     1     0     4   44      1
6     3     2    0     2    0    0  1874     1     3    2     21
7     6    21    6   223    6    1     8  6767   194    4     29
8     0     2    4    69    8    7     5    30  3134    5     32
9     1     0   16     3    2  106     1     0     4  359      1
10    4    14    1     6   59    3    13     7    40    0  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5928776, 'precision': 0.70362216, 'recall': 0.46674296, 'specificity': 0.95766675, 'f1': 0.43528476, 'auroc': 0.8423835}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   136     0   0    9   0    0   837    4    21   20   143
1     0  1236   0   32   0    0    12  103    15    0   101
2     0    10   1   17   8    5    82   10   461   28   393
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  42    0     9    0    43    0  1538
5     0     0   0  204   0  181    62    1    54   88     2
6     0     0   0    1   0    0  2768    1    27    0   270
7     0     8   0   24   0    0   142  930    37    0    23
8     0     0   0   42   0    0    33    0  1281    0    14
9     0    29   0  176   1   24   127   41   421  260    58
10    0     1   0    0   2    0     3    0     1    0  1639
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-11 23:13:06.537729,epoch time: 0:31:36.570591,used: 5:16:31.744922,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:16:31.744922 at 2024-08-11 23:13:06.537729
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5928776, 'precision': 0.70362216, 'recall': 0.46674296, 'specificity': 0.95766675, 'f1': 0.43528476, 'auroc': 0.8423835}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   136     0   0    9   0    0   837    4    21   20   143
1     0  1236   0   32   0    0    12  103    15    0   101
2     0    10   1   17   8    5    82   10   461   28   393
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  42    0     9    0    43    0  1538
5     0     0   0  204   0  181    62    1    54   88     2
6     0     0   0    1   0    0  2768    1    27    0   270
7     0     8   0   24   0    0   142  930    37    0    23
8     0     0   0   42   0    0    33    0  1281    0    14
9     0    29   0  176   1   24   127   41   421  260    58
10    0     1   0    0   2    0     3    0     1    0  1639
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5928776, 'precision': 0.70362216, 'recall': 0.46674296, 'specificity': 0.95766675, 'f1': 0.43528476, 'auroc': 0.8423835}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   136     0   0    9   0    0   837    4    21   20   143
1     0  1236   0   32   0    0    12  103    15    0   101
2     0    10   1   17   8    5    82   10   461   28   393
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  42    0     9    0    43    0  1538
5     0     0   0  204   0  181    62    1    54   88     2
6     0     0   0    1   0    0  2768    1    27    0   270
7     0     8   0   24   0    0   142  930    37    0    23
8     0     0   0   42   0    0    33    0  1281    0    14
9     0    29   0  176   1   24   127   41   421  260    58
10    0     1   0    0   2    0     3    0     1    0  1639
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_56_34_seed_1_24142404_instance_wise_predictions.txt
accuracy from prediction file 0.5928776324074722
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/26.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/26.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488346 KiB |  10867 MiB |   1699 TiB |   1699 TiB |
|       from large pool | 397632 KiB |  10795 MiB |   1697 TiB |   1697 TiB |
|       from small pool |  90714 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488346 KiB |  10867 MiB |   1699 TiB |   1699 TiB |
|       from large pool | 397632 KiB |  10795 MiB |   1697 TiB |   1697 TiB |
|       from small pool |  90714 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10851 MiB |   1696 TiB |   1696 TiB |
|       from large pool | 387840 KiB |  10780 MiB |   1695 TiB |   1695 TiB |
|       from small pool |  90258 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11324 MiB |  11324 MiB |  21400 MiB |  10076 MiB |
|       from large pool |  11196 MiB |  11196 MiB |  21240 MiB |  10044 MiB |
|       from small pool |    128 MiB |    128 MiB |    160 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    969 MiB |   1016 MiB |    876 TiB |    876 TiB |
|       from large pool |    959 MiB |   1013 MiB |    874 TiB |    874 TiB |
|       from small pool |      9 MiB |     30 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   88967 K  |   88964 K  |
|       from large pool |      87    |     490    |   48919 K  |   48919 K  |
|       from small pool |    2922    |    4522    |   40047 K  |   40045 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   88967 K  |   88964 K  |
|       from large pool |      87    |     490    |   48919 K  |   48919 K  |
|       from small pool |    2922    |    4522    |   40047 K  |   40045 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     184    |     184    |     296    |     112    |
|       from large pool |     120    |     120    |     216    |      96    |
|       from small pool |      64    |      64    |      80    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |    1077    |   37687 K  |   37687 K  |
|       from large pool |      25    |      78    |   20159 K  |   20159 K  |
|       from small pool |      24    |    1052    |   17528 K  |   17528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10867 MiB |   1699 TiB |   1699 TiB |
|       from large pool |  16640 KiB |  10795 MiB |   1697 TiB |   1697 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10867 MiB |   1699 TiB |   1699 TiB |
|       from large pool |  16640 KiB |  10795 MiB |   1697 TiB |   1697 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10851 MiB |   1696 TiB |   1696 TiB |
|       from large pool |  16640 KiB |  10780 MiB |   1695 TiB |   1695 TiB |
|       from small pool |      0 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1446 MiB |  11324 MiB |  21400 MiB |  19954 MiB |
|       from large pool |   1348 MiB |  11196 MiB |  21240 MiB |  19892 MiB |
|       from small pool |     98 MiB |    128 MiB |    160 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1174 MiB |    876 TiB |    876 TiB |
|       from large pool | 134912 KiB |   1152 MiB |    874 TiB |    874 TiB |
|       from small pool |      0 KiB |     32 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   88967 K  |   88967 K  |
|       from large pool |       2    |     490    |   48919 K  |   48919 K  |
|       from small pool |       0    |    4522    |   40047 K  |   40047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   88967 K  |   88967 K  |
|       from large pool |       2    |     490    |   48919 K  |   48919 K  |
|       from small pool |       0    |    4522    |   40047 K  |   40047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |     184    |     296    |     226    |
|       from large pool |      21    |     120    |     216    |     195    |
|       from small pool |      49    |      64    |      80    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1077    |   37688 K  |   37688 K  |
|       from large pool |       3    |      78    |   20159 K  |   20159 K  |
|       from small pool |       0    |    1052    |   17529 K  |   17529 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 23:18:27 2024]
Finished job 0.
1 of 1 steps (100%) done
