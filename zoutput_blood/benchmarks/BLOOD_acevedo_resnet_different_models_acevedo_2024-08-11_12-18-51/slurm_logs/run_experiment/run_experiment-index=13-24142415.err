Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 20:06:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/13.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=13
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415

 Experiment start at: 2024-08-11 20:17:33.631322
before training, model accuracy: 0.05282306298613548
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.81006527, 'precision': 0.41767645, 'recall': 0.42451468, 'specificity': 0.9785559, 'f1': 0.4191321, 'auroc': 0.941459}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    28   0   0  207    35   148   0     65
1    0  1090   0    14   0   0    0   186     5   0     37
2    0     0   0    10   0   0   65    39   176   0     22
3    0     0   0  7343   0   0    0   735   346   0     13
4    0     0   0     6   0   0   71    22   149   0    291
5    0     0   0   340   0   0   34     2   144   0      1
6    0     4   0    30   0   0  928    73   486   0    387
7    0    41   0   534   0   0    4  6409   159   0    116
8    0     0   0   448   0   0   53   338  2123   0    334
9    0     0   0   126   0   0   83    27   255   0      2
10   0     6   0    11   0   0  125    86   180   0  12384
---- Validation: 
scalar performance:
{'acc': 0.8094155, 'precision': 0.41780332, 'recall': 0.42493537, 'specificity': 0.9784825, 'f1': 0.4194451, 'auroc': 0.93967456}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    30   0   0  214    35   131   0     73
1    0  1095   0    13   0   0    0   179     6   0     39
2    0     1   0    15   0   0   64    45   166   0     21
3    0     1   0  7336   0   0    0   729   353   0     21
4    0     0   0     8   0   0   71    25   138   0    297
5    0     0   0   328   0   0   38     2   152   0      1
6    0     3   0    26   0   0  932    69   479   0    399
7    0    31   0   571   0   0    2  6366   183   0    112
8    0     0   0   469   0   0   59   322  2143   0    303
9    0     0   0   118   0   0   87    27   260   0      1
10   0     5   0    13   0   0  130    82   178   0  12388
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34968168, 'precision': 0.24461336, 'recall': 0.27189285, 'specificity': 0.9301557, 'f1': 0.23432368, 'auroc': 0.7398413}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     7   0    2   0   0  1139   11    9   0     2
1    0  1000   0   18   0   0    76   83    7   0   315
2    0     2   0   36   0   0   789    3   51   0   134
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    75    0    0   0  1558
5    0     0   0  252   0   0   185    2  151   0     2
6    0     4   0    0   0   0  1191    1    4   0  1867
7    0   281   0    1   0   0   134  676   21   0    51
8    0     0   0   40   0   0   765    1  490   0    74
9    0     6   0  170   0   0   764   20  156   0    21
10   0     0   0    0   0   0     5    0    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 20:50:15.384951,epoch time: 0:32:41.753629,used: 0:32:41.753629,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.85926795, 'precision': 0.6445947, 'recall': 0.5111943, 'specificity': 0.984497, 'f1': 0.50521207, 'auroc': 0.9735302}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    2     0   0    30   0    8   322    20    40   1     60
1    0  1134   0    19   0    0     0   147     8   0     23
2    0     0   0     6   0    3    99    42   138   2     22
3    0     0   0  7568   0    7     1   487   371   0      4
4    0     0   0     5   0    0    96    14   146   0    278
5    0     0   0   229   0  154    68     0    58  11      1
6    0     0   0    18   0    1  1609    29    89   1    161
7    0    38   0   413   0    0     5  6554   191   0     61
8    0     0   0   225   0    1    36   149  2742   0    143
9    0     0   0    78   0   68   191    23   116  16      1
10   0     5   0    11   0    1   208    54   177   0  12337
---- Validation: 
scalar performance:
{'acc': 0.85874015, 'precision': 0.6452087, 'recall': 0.5089826, 'specificity': 0.9843967, 'f1': 0.50365037, 'auroc': 0.97422665}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    2     1   0    24   0    7   329    14    44   2     60
1    0  1142   0    15   0    0     0   148     8   0     19
2    0     0   0     6   0    1   105    39   141   2     18
3    0     1   0  7549   0    8     1   480   397   0      4
4    0     0   0     3   0    1   100    11   145   0    279
5    0     0   0   257   0  150    49     0    54   9      2
6    0     3   0    15   0    3  1585    32    92   0    178
7    0    31   0   409   0    0     2  6588   165   0     70
8    0     0   0   243   0    1    37   159  2704   0    152
9    0     2   0    89   0   70   181    14   121  15      1
10   0     5   0    11   0    0   173    54   184   0  12369
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.45574757, 'precision': 0.39306575, 'recall': 0.35900068, 'specificity': 0.9404361, 'f1': 0.3286517, 'auroc': 0.77220035}
confusion matrix:
    0     1   2   3   4    5     6    7    8   9     10
0    0     1   0   2   0    1  1157    4    3   2     0
1    0  1172   0  23   0    0   117   64    7   0   116
2    0     3   0   4   0   19   859    4   30   1    95
3    0     0   0   0   0    0     0    0    0   0     0
4    0     0   0   0   0    0    98    0    0   0  1535
5    0     0   0  49   0  301   206    1   25   8     2
6    0     3   0   0   0    0  2235    0    0   0   829
7    0   270   0   4   0    0   247  601   15   1    26
8    0     0   0  13   0   30   738    1  525  31    32
9    0    11   0  34   0  100   879    9   56  36    12
10   0     0   0   0   0    0     2    0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 21:21:24.144253,epoch time: 0:31:08.759302,used: 1:03:50.512931,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8915347, 'precision': 0.78360015, 'recall': 0.63408995, 'specificity': 0.9878476, 'f1': 0.65948296, 'auroc': 0.9841049}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   157     1   0    22   0   18   148    23    17   29     68
1     0  1166   0    17   0    0     0   130     9    0     10
2     4     1  29     6  22   10    13    40    84   76     27
3     0     0   0  7827   0   35     0   407   168    1      2
4     1     0   2     3  72    6    23    13   112   18    289
5     0     0   0   118   0  354     1     0    14   33      1
6     6     2   0    16   0   15  1666    24    33    9    136
7     0    26   1   374   0    0     1  6675   129    1     56
8     1     0   0   298   6    5    11   160  2683    5    126
9     2     1  13    46   0  184     9    10    48  175      4
10    3     5   1    15   5    2    90    58    93    2  12518
---- Validation: 
scalar performance:
{'acc': 0.89321923, 'precision': 0.77129495, 'recall': 0.6289543, 'specificity': 0.98802173, 'f1': 0.65346134, 'auroc': 0.98423976}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   154     0   0    21   0   23   140    21    11   32     81
1     0  1155   0    16   0    0     0   146     3    0     12
2     6     1  24     8  29    8    19    37    75   75     30
3     0     0   0  7860   0   37     1   377   160    2      3
4     2     0   8     4  67    2    35    11   109   13    288
5     1     0   0   124   0  349     4     1    12   29      1
6    12     0   0    21   2    8  1668    24    34    9    130
7     0    16   0   349   1    0     2  6725   127    0     45
8     0     0   0   298   4   10    16   142  2689    3    134
9     8     0   6    50   1  179    11    18    49  165      6
10    5     3   1    12   3    2    84    57    91    1  12537
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47281885, 'precision': 0.4975126, 'recall': 0.42346466, 'specificity': 0.94438076, 'f1': 0.39436173, 'auroc': 0.82498103}
confusion matrix:
    0     1   2   3   4    5     6    7    8    9     10
0   28     1   0   3   0    4  1011    5    2  112     4
1    0  1202   0  29   0    0    64   76    8    5   115
2    2     3   9   6  73   33   435    5   84  106   259
3    0     0   0   0   0    0     0    0    0    0     0
4    0     0   0   0  15    0    20    0    2    1  1595
5    3     0   0  38   0  403    13    0    4  128     3
6    1     3   0   0   4    1  1391    0    0    4  1663
7    3   165   4  16   1    0   183  709   16   38    29
8    1     0   1  32  15   42   191    0  808  177   103
9    5    14  15  47   4  181   255    8   39  547    22
10   0     0   0   0   0    0     0    0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 21:52:34.473067,epoch time: 0:31:10.328814,used: 1:35:00.841745,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90841717, 'precision': 0.8014811, 'recall': 0.71108556, 'specificity': 0.9898469, 'f1': 0.7437341, 'auroc': 0.9887172}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   283     0    2     9    0    0    97    17    12    3     60
1     0  1188    0    14    1    0     0   116     2    0     11
2    11     1  105     4   36    1     5    40    36   60     13
3     0     0    0  7759    0   15     2   485   174    1      1
4     7     0   23     3  155    0    17    16    87   13    218
5     5     0    3   105    0  306     2     0     7   91      1
6    16     1    0     9    0    3  1769    21    22    3     63
7     1    23    0   226    1    0     3  6861    86    3     59
8     0     1    4   224    8    2    12   187  2774    2     82
9    31     1   40    39    0   78     8    10    27  257      2
10   16     4    6     6   27    1    84    41   109    4  12496
---- Validation: 
scalar performance:
{'acc': 0.90651333, 'precision': 0.78988725, 'recall': 0.7062385, 'specificity': 0.9896716, 'f1': 0.7371187, 'auroc': 0.9884946}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   273     0    0     8    0    0   102    17    10    7     66
1     0  1193    0    10    0    0     0   117     3    0      9
2    13     1  108     4   35    2     7    38    35   59     10
3     0     0    0  7716    0   20     1   504   189    6      4
4     7     0   34     4  162    1    20    14    83   10    204
5     8     0    2   108    0  299     4     0    12   87      1
6    21     0    1     5    0    0  1767    18    27    5     64
7     1    19    0   236    1    0     4  6866    88    1     49
8     1     0    2   236    9    5     7   183  2761    2     90
9    38     2   42    32    0   99     6     7    25  240      2
10   13     3    3     8   34    2    85    41   101    1  12505
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5299797, 'precision': 0.55308765, 'recall': 0.43488783, 'specificity': 0.950081, 'f1': 0.43531188, 'auroc': 0.83474994}
confusion matrix:
    0     1    2   3    4    5     6    7    8    9     10
0   94     1    1   4    0    0  1044    2    2   19     3
1    1  1301    0  27    0    0    36   53    3    2    76
2    8    11   63   7  205    6   418    4   72   71   150
3    0     0    0   0    0    0     0    0    0    0     0
4    0     0    1   0  220    0    23    0    2    0  1387
5   31     0    0  73    0  209    51    0    7  218     3
6    5     4    1   0   45    0  2029    0    2    1   980
7    6   257   13  14    1    0   208  619   10    3    33
8    2     0   24  53   42   10   190    0  912   95    42
9   33    36  105  58    5   16   331   13   28  492    20
10   0     0    0   0   10    0     0    0    0    0  1636
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 22:23:34.044608,epoch time: 0:30:59.571541,used: 2:06:00.413286,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.91574806, 'precision': 0.8064202, 'recall': 0.75334734, 'specificity': 0.990772, 'f1': 0.7735811, 'auroc': 0.99079335}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   350     0    1     8    1    0    14    22    11    3     73
1     0  1210    0    11    1    0     0   101     4    0      3
2     9     2  142     3   34    0     0    32    24   60      6
3     4     1    0  7731    0   16     0   473   207    4      1
4     5     0   48     2  246    0     3    10    58   10    157
5    10     0    3    97    0  253     0     0     7  150      1
6    69     0    1    14    1    1  1670    27    30    6     87
7     1    27    2   173    2    0     1  6938    93    2     25
8     0     1    5   174   20    1     3   155  2876    6     55
9    17     0   51    21    0   42     1     9    26  325      1
10   19     3    6    12   74    1    25    61   105    3  12486
---- Validation: 
scalar performance:
{'acc': 0.9164371, 'precision': 0.8082821, 'recall': 0.75298023, 'specificity': 0.99084985, 'f1': 0.7744955, 'auroc': 0.9909248}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   343     0    1    10    0    0    22    21    14    5     67
1     0  1203    0    10    1    0     0   109     3    0      6
2    11     2  146     2   37    1     1    27    26   55      4
3     1     0    0  7749    0   17     0   465   204    4      0
4     2     0   52     5  234    0     4    15    62   11    154
5     6     0    1    88    0  264     1     0    13  147      1
6    70     0    1    12    7    0  1663    25    37    5     88
7     0    21    1   179    3    0     1  6955    83    1     21
8     1     0    6   178   16    2     4   161  2871    7     50
9    15     2   45    31    2   40     1     9    19  328      1
10   24     8    5     7   68    1    26    68    82    2  12505
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5080109, 'precision': 0.57681954, 'recall': 0.44806895, 'specificity': 0.94890475, 'f1': 0.4503469, 'auroc': 0.84098786}
confusion matrix:
     0     1    2   3    4    5     6    7     8    9     10
0   329     1    2   9    0    0   762    4     6   33    24
1     1  1338    0  30    0    0     8   53     6    1    62
2     8    16  105   8  254    0   114    7   116   78   309
3     0     0    0   0    0    0     0    0     0    0     0
4     0     1    2   0  271    0     3    0     1    0  1355
5    26     0    0  75    0  118    23    0    11  333     6
6    11     6    2   0   46    0  1052    0     3    2  1945
7    12   144   20  25    1    0    97  802    26    8    29
8     4     0   21  51   46    4    54    0  1050   70    70
9    29    45  175  60    6    4   134   11    64  565    44
10    0     0    0   0   15    0     0    0     0    0  1631
better model found
persisted
after epoch: 5,now: 2024-08-11 22:54:24.825583,epoch time: 0:30:50.780975,used: 2:36:51.194261,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.924497, 'precision': 0.8199925, 'recall': 0.77295065, 'specificity': 0.99169743, 'f1': 0.7907319, 'auroc': 0.99260414}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     0    1     6    0    0    14    14     4    3     59
1     0  1230    0    18    0    0     1    70     5    0      8
2    14     1  149     2   23    6     2    18    21   68      8
3     5     0    0  8051    0   25     0   239   118    1      0
4     8     0   45     4  219    1     5    10    64   15    167
5    11     0    1    76    0  353     1     0     8   70      1
6    54     0    0     8    1    1  1770     8    16    2     48
7     3    27    3   351    1    0     2  6770    80    3     24
8     2     1    4   276   12    3    13   115  2820    5     44
9    28     2   32    24    0  100     3     3    14  284      2
10   38     0    6     9   40    2    38    32    99    2  12526
---- Validation: 
scalar performance:
{'acc': 0.9248094, 'precision': 0.82407045, 'recall': 0.77257574, 'specificity': 0.9917263, 'f1': 0.7916273, 'auroc': 0.99273163}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     0    0    10    0    0    27     9     6    4     49
1     0  1224    0    15    0    0     0    79     3    0     11
2    16     1  156     3   23    1     1    23    17   65      6
3     2     0    0  8075    0   19     3   216   122    3      0
4     5     0   51     1  207    1     9    14    66   15    170
5     7     0    1    82    0  347     1     0     6   76      1
6    63     0    2    11    2    2  1759    10    16    3     40
7     3    22    1   364    1    0     3  6761    81    2     27
8     4     1    3   279    8    3     5   103  2840    5     45
9    24     2   28    21    0   97     5     7    12  294      3
10   35     5    4    14   34    1    42    38    89    1  12533
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5320786, 'precision': 0.59913725, 'recall': 0.45012295, 'specificity': 0.950711, 'f1': 0.4569047, 'auroc': 0.83274704}
confusion matrix:
     0     1    2   3    4    5     6    7     8    9     10
0   201     1    1  11    0    0   936    0     1    9    10
1     2  1295    0  39    0    0    26   63     3    0    71
2     5    11   86  14  119    4   256    7   102   53   358
3     0     0    0   0    0    0     0    0     0    0     0
4     0     1    2   0  115    0    10    0     6    0  1499
5    16     0    0  96    0  245    70    0     7  155     3
6     7     4    1   0   13    0  1841    0     3    0  1198
7     4    82    9  82    0    0   239  686    27    4    31
8     1     0   13  73   10    8   115    0  1033   46    71
9    17    41  108  95    3   24   293    3    50  461    42
10    0     0    0   0    4    0     0    0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-11 23:25:31.847763,epoch time: 0:31:07.022180,used: 3:07:58.216441,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92859054, 'precision': 0.8402804, 'recall': 0.77744144, 'specificity': 0.99205554, 'f1': 0.8047372, 'auroc': 0.9927634}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   347     0    0    10    1    0    26    11    10    5     73
1     0  1176    0    72    1    0     0    71     3    0      8
2     3     1  145     2   50    1     2    22    10   69      7
3     0     0    0  8009    0   25     0   303   100    2      0
4     2     0   28     4  277    1     3    14    44   12    154
5     4     0    2    76    0  331     1     0    11   95      1
6    21     0    1    17    2    0  1794     2    18    2     51
7     0    23    4   251    2    0     1  6879    71    2     30
8     4     0    2   240   13    5     7   123  2842    4     55
9    12     2   36    24    1   68     3     6    11  322      8
10   13     6    1    32   55    2    17    29    51    1  12585
---- Validation: 
scalar performance:
{'acc': 0.92817974, 'precision': 0.84406567, 'recall': 0.78131866, 'specificity': 0.99200773, 'f1': 0.8085717, 'auroc': 0.9926925}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   356     0    1     9    1    0    30    10     5    3     68
1     0  1171    0    81    0    0     0    65     6    0      9
2     6     2  151     1   41    0     2    20    19   62      8
3     1     1    0  8021    0   15     0   297   104    1      0
4     4     0   22     1  284    3     3    11    49    8    154
5     0     0    1    79    0  327     2     0     3  108      1
6    19     0    3    13    0    1  1793     7    11    2     59
7     0    25    6   247    2    0     2  6875    77    1     30
8     3     1    4   250   14    2    10   124  2828    4     56
9     9     1   39    23    1   69     6     3    10  327      5
10   14     5    4    34   49    1    28    35    58    1  12567
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5042328, 'precision': 0.60112715, 'recall': 0.41855654, 'specificity': 0.9478419, 'f1': 0.4219039, 'auroc': 0.82986134}
confusion matrix:
    0     1    2    3    4    5     6    7     8    9     10
0   68     0    2   12    0    0  1023    0     1   18    46
1    0  1332    0   47    0    0    30   44     4    0    42
2    0    10   70   16  178    1   221    3   140   46   330
3    0     0    0    0    0    0     0    0     0    0     0
4    0     2    2    0  276    0    11    0     6    0  1336
5    3     0    0  117    0  163    78    0    10  211    10
6    2     4    0    0   35    0  1637    0     7    1  1381
7    0   104    9  130    0    0   309  556    23    7    26
8    1     0   14   87   20    4    81    0  1039   46    78
9    2    40  108  111   11   13   301    5    52  438    56
10   0     1    0    0   17    0     0    0     0    0  1628
better model found
persisted
after epoch: 7,now: 2024-08-11 23:57:09.857025,epoch time: 0:31:38.009262,used: 3:39:36.225703,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9337008, 'precision': 0.8317257, 'recall': 0.8136431, 'specificity': 0.9927861, 'f1': 0.8208463, 'auroc': 0.99343807}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   376     0    1     6    1    1    22    10     3    3     60
1     0  1238    0    22    0    0     0    63     3    0      5
2     3     1  220     1   26    2     2     6     9   40      2
3     2     0    0  7872    0   41     1   333   184    3      1
4     3     0   57     1  294    3     3     6    33    8    131
5     4     0    4    47    0  371     0     0     8   86      1
6    14     1    2    14    6    0  1804     7    14    3     43
7     1    45    9   181    3    0     2  6894    97    1     30
8     3     1    5   129   28    6     5    91  2955    4     68
9     7     2   83    14    2   86     3     4     9  281      2
10   22     6    6    24   75    2    10    20    36    0  12593
---- Validation: 
scalar performance:
{'acc': 0.93205833, 'precision': 0.8287785, 'recall': 0.8109951, 'specificity': 0.9926001, 'f1': 0.8180965, 'auroc': 0.99363124}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   383     0    1     7    0    1    17     4     9    2     59
1     0  1242    1    20    2    0     0    58     4    0      5
2     7     0  212     1   27    1     4     9    12   32      7
3     3     0    1  7863    0   35     0   341   192    4      1
4     5     0   58     2  282    1     4     9    27    8    143
5     4     0    2    51    0  356     0     0     8   99      1
6    26     0    3     9    5    0  1793     7    13    4     48
7     1    41    7   191    3    0     4  6888   100    2     28
8     1     1   12   123   22   11     7    93  2958    6     62
9     9     0   73    11    2   79     1     5    10  301      2
10   24     4    9    33   68    3    12    29    46    1  12567
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5311691, 'precision': 0.6165853, 'recall': 0.47096476, 'specificity': 0.95132923, 'f1': 0.4875232, 'auroc': 0.84380585}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   279     0    4   18    1    0   752    0     2   41    73
1     1  1308    1   49    0    0    18   57     5    1    59
2     2     7  147   10  193    6   116    3    89   59   383
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  270    0     4    0     3    0  1354
5     3     0    0   68    2  286    23    0     9  194     7
6     9     4    2    0   26    0  1399    0     0    1  1626
7     1    47   21  140    0    0   189  697    26   16    27
8     0     0   22   64   28   12    37    0  1031   55   121
9     3    25  197   89    3   37   116    4    51  542    70
10    0     0    0    0   13    0     0    0     0    0  1633
better model found
persisted
after epoch: 8,now: 2024-08-12 00:28:34.243949,epoch time: 0:31:24.386924,used: 4:11:00.612627,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9372592, 'precision': 0.84580994, 'recall': 0.8154506, 'specificity': 0.9930114, 'f1': 0.8289234, 'auroc': 0.9951879}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     0    0     7    0    0     9     5     2    1     52
1     0  1232    0    16    0    0     0    68     6    0     10
2     4     0  203     1   33    3     2    14     4   43      5
3     1     0    0  8143    0   27     1   155   104    4      1
4     6     0   38     1  296    2     3     7    21    4    160
5     4     0    1    57    0  364     0     0     8   85      1
6    38     0    1     8    3    1  1799     5     5    2     45
7     4    17    4   348    1    0     3  6781    64    6     36
8     7     0    6   225   32    8     4    89  2837    5     83
9    12     0   58    20    2   86     1     4     6  300      4
10   33     0    3     9   37    0    12    12    18    2  12669
---- Validation: 
scalar performance:
{'acc': 0.9355089, 'precision': 0.84336746, 'recall': 0.808759, 'specificity': 0.9928061, 'f1': 0.8238192, 'auroc': 0.9949567}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     0    0     1    0    0    10     5     1    3     55
1     0  1236    1    16    0    0     2    67     3    0      7
2     7     1  191     0   27    2     2    12     5   51     14
3     2     1    0  8112    0   32     0   170   116    6      1
4     7     0   37     1  285    2     3     8    26    8    162
5     2     0    3    68    0  352     0     0     5   90      1
6    29     0    2    11    1    0  1802     3     8    2     50
7     3    11    6   344    2    0     3  6777    80    3     36
8     5     0    8   206   20    4     5   100  2851    4     93
9    11     0   56    21    0   83     1     2     9  303      7
10   36     0    4     8   43    1     6    13    27    1  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48541245, 'precision': 0.60188764, 'recall': 0.43678442, 'specificity': 0.9469776, 'f1': 0.45889425, 'auroc': 0.8291774}
confusion matrix:
     0     1    2    3    4    5     6    7    8    9     10
0   426     0    3   22    0    0   547    1    3   32   136
1     1  1285    2   50    0    0    15   64    1    1    80
2     2     4  104   12  154    3    40    6   38   43   609
3     0     0    0    0    0    0     0    0    0    0     0
4     0     0    2    0  137    0     2    0    0    0  1492
5     3     0    0   79    2  243    14    0    8  211    32
6    15     1    1    0    8    0  1076    1    0    1  1964
7     7    32   11  186    0    0   199  656   13   10    50
8     1     0   20   73   44    8    26    1  868   52   277
9     5    17  204   93    8   24    69    9   28  502   178
10    0     0    0    0    5    0     0    0    0    0  1641
better model found
persisted
after epoch: 9,now: 2024-08-12 00:59:08.703523,epoch time: 0:30:34.459574,used: 4:41:35.072201,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9412725, 'precision': 0.8418358, 'recall': 0.8327166, 'specificity': 0.9936761, 'f1': 0.8359839, 'auroc': 0.99548256}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     8    2    0    15     8     5    4     31
1     0  1251    0    12    0    0     0    63     2    0      4
2     6     0  225     0   16    3     3    11     7   40      1
3     1     2    0  8095    0   30     0   192   115    5      0
4     4     0   61     2  307    0     3    10    34    8    110
5     3     0    2    53    0  376     1     0     5   80      1
6    32     0    1    10    2    2  1822     4    13    2     20
7     2    19    7   224    2    0     2  6912    79    3     12
8     3     1    8   175   19    4     4    89  2949    7     34
9    15     0   48    19    0   91     0     2    10  305      3
10   44     1    7     9   83    2    18    32    67    1  12529
---- Validation: 
scalar performance:
{'acc': 0.94107264, 'precision': 0.8390174, 'recall': 0.82991695, 'specificity': 0.9936741, 'f1': 0.8324869, 'auroc': 0.995594}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     8    0    0    13     5     7    3     35
1     0  1254    0    14    1    0     0    56     3    0      4
2     5     0  213     0   22    3     3    10     9   46      1
3     1     2    0  8069    0   34     0   208   125    1      0
4     6     0   73     0  287    1     4     8    43    9    108
5     7     0    3    50    0  381     0     0     4   75      1
6    38     0    0     5    1    0  1825    10     8    1     20
7     3    11    8   239    1    0     2  6912    75    1     13
8     4     1    5   177   16    8     9    79  2970    7     20
9    13     0   47    11    2   91     1     2     8  317      1
10   48     0   10     9   65    2    17    25    75    3  12542
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5874204, 'precision': 0.63925016, 'recall': 0.49926937, 'specificity': 0.95766664, 'f1': 0.52084345, 'auroc': 0.8540125}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   530     0    2   33    0    1   540    0     2   21    41
1     2  1304    1   59    0    0    16   62     1    0    54
2     2     5  126   28  169   10    86    5   143   52   389
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  242    0     8    0     6    0  1375
5     6     0    0  114    2  289    19    0     5  144    13
6    35     1    1    0    6    1  2116    0     3    1   903
7     7    15   11  328    0    0   151  600    29   10    13
8     1     0    7  106   19    8    42    0  1049   41    97
9    12    22  132  156    6   53    99    6    58  505    88
10    0     0    0    0   11    0     0    0     0    0  1635
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-12 01:29:44.703983,epoch time: 0:30:36.000460,used: 5:12:11.072661,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:12:11.072661 at 2024-08-12 01:29:44.703983
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5874204, 'precision': 0.63925016, 'recall': 0.49926937, 'specificity': 0.95766664, 'f1': 0.52084345, 'auroc': 0.8540125}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   530     0    2   33    0    1   540    0     2   21    41
1     2  1304    1   59    0    0    16   62     1    0    54
2     2     5  126   28  169   10    86    5   143   52   389
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  242    0     8    0     6    0  1375
5     6     0    0  114    2  289    19    0     5  144    13
6    35     1    1    0    6    1  2116    0     3    1   903
7     7    15   11  328    0    0   151  600    29   10    13
8     1     0    7  106   19    8    42    0  1049   41    97
9    12    22  132  156    6   53    99    6    58  505    88
10    0     0    0    0   11    0     0    0     0    0  1635
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5874204, 'precision': 0.63925016, 'recall': 0.49926937, 'specificity': 0.95766664, 'f1': 0.52084345, 'auroc': 0.8540125}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   530     0    2   33    0    1   540    0     2   21    41
1     2  1304    1   59    0    0    16   62     1    0    54
2     2     5  126   28  169   10    86    5   143   52   389
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  242    0     8    0     6    0  1375
5     6     0    0  114    2  289    19    0     5  144    13
6    35     1    1    0    6    1  2116    0     3    1   903
7     7    15   11  328    0    0   151  600    29   10    13
8     1     0    7  106   19    8    42    0  1049   41    97
9    12    22  132  156    6   53    99    6    58  505    88
10    0     0    0    0   11    0     0    0     0    0  1635
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_20_17_33_seed_0_24142415_instance_wise_predictions.txt
accuracy from prediction file 0.5874204155880501
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/13.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494810 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool | 404096 KiB |  10877 MiB | 344198 GiB | 344197 GiB |
|       from small pool |  90714 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 494810 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool | 404096 KiB |  10877 MiB | 344198 GiB | 344197 GiB |
|       from small pool |  90714 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 342301 GiB | 342300 GiB |
|       from small pool |  90258 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11418 MiB |  11418 MiB |  11418 MiB |      0 B   |
|       from large pool |  11290 MiB |  11290 MiB |  11290 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 717605 KiB |   1129 MiB | 107908 GiB | 107907 GiB |
|       from large pool | 707968 KiB |   1126 MiB | 107201 GiB | 107201 GiB |
|       from small pool |   9637 KiB |     11 MiB |    706 GiB |    706 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   27226 K  |   27223 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2922    |    4522    |   15171 K  |   15168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   27226 K  |   27223 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2922    |    4522    |   15171 K  |   15168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     293    |     293    |     293    |       0    |
|       from large pool |     229    |     229    |     229    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |    1081    |   14537 K  |   14537 K  |
|       from large pool |      16    |     119    |    7024 K  |    7024 K  |
|       from small pool |      33    |    1064    |    7513 K  |    7513 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342301 GiB | 342301 GiB |
|       from small pool |      0 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |  11418 MiB |  11418 MiB |  10234 MiB |
|       from large pool |   1086 MiB |  11290 MiB |  11290 MiB |  10204 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1129 MiB | 107908 GiB | 107908 GiB |
|       from large pool |  59136 KiB |   1126 MiB | 107202 GiB | 107201 GiB |
|       from small pool |      0 KiB |     33 MiB |    706 GiB |    706 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     293    |     293    |     216    |
|       from large pool |      28    |     229    |     229    |     201    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1081    |   14537 K  |   14537 K  |
|       from large pool |       3    |     119    |    7024 K  |    7024 K  |
|       from small pool |       0    |    1064    |    7513 K  |    7513 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342301 GiB | 342301 GiB |
|       from small pool |      0 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |  11418 MiB |  11418 MiB |  10234 MiB |
|       from large pool |   1086 MiB |  11290 MiB |  11290 MiB |  10204 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1129 MiB | 107908 GiB | 107908 GiB |
|       from large pool |  59136 KiB |   1126 MiB | 107202 GiB | 107201 GiB |
|       from small pool |      0 KiB |     33 MiB |    706 GiB |    706 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     293    |     293    |     216    |
|       from large pool |      28    |     229    |     229    |     201    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1081    |   14537 K  |   14537 K  |
|       from large pool |       3    |     119    |    7024 K  |    7024 K  |
|       from small pool |       0    |    1064    |    7513 K  |    7513 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415

 Experiment start at: 2024-08-12 01:44:26.890602
before training, model accuracy: 0.06982439011335373
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8028681, 'precision': 0.4186405, 'recall': 0.4136051, 'specificity': 0.9774849, 'f1': 0.4132204, 'auroc': 0.9401729}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    33   0   0  183    42   139   0     86
1    0  1023   0    16   0   0    0   221     6   0     65
2    0     0   0    25   0   0   52    56   162   0     17
3    0     2   0  7781   0   0    0   424   216   0     14
4    0     0   0    12   0   0   69    22   158   0    278
5    0     0   0   373   0   0   11     4   131   0      2
6    0     0   0    50   0   0  918    68   444   0    427
7    0    19   0   954   0   0    8  5992   157   0    135
8    0     0   0   724   0   0   95   224  1932   0    320
9    0     0   0   155   0   0   44    38   255   0      1
10   0     1   0    20   0   0  112    92   206   0  12362
---- Validation: 
scalar performance:
{'acc': 0.80179214, 'precision': 0.4167651, 'recall': 0.4136808, 'specificity': 0.97743666, 'f1': 0.41239616, 'auroc': 0.94069624}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    30   0   0  189    32   157   0     75
1    0  1031   0    14   0   0    0   215     2   0     70
2    0     0   0    20   0   0   64    45   166   0     17
3    0     0   0  7802   0   0    1   425   195   0     17
4    0     0   0    10   0   0   75    22   152   0    280
5    0     0   0   352   0   0   10     2   155   0      2
6    0     0   0    50   0   0  906    74   456   0    422
7    0    23   0   989   0   0   10  5917   178   0    148
8    0     0   0   709   0   0  105   238  1970   0    274
9    0     0   0   142   0   0   48    38   264   0      1
10   0     2   0    21   0   0  106    93   225   0  12349
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.394109, 'precision': 0.24794433, 'recall': 0.29134873, 'specificity': 0.9359013, 'f1': 0.24393368, 'auroc': 0.74522793}
confusion matrix:
    0    1   2    3   4   5     6    7    8   9     10
0    0    0   0    3   0   0   909    3  252   0     3
1    0  887   0   16   0   0    48   96   93   0   359
2    0    1   0   13   0   0   538    1  370   0    92
3    0    0   0    0   0   0     0    0    0   0     0
4    0    0   0    0   0   0   106    0    5   0  1522
5    0    0   0  204   0   0    26    0  360   0     2
6    0    0   0    0   0   0  1825    0   71   0  1171
7    0   85   0    5   0   0   118  670  229   0    57
8    0    0   0   19   0   0   698    0  612   0    41
9    0    9   0   69   0   0   281    3  760   0    15
10   0    0   0    0   0   0     7    0    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 02:16:38.824018,epoch time: 0:32:11.933416,used: 0:32:11.933416,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8543718, 'precision': 0.55131525, 'recall': 0.49453506, 'specificity': 0.98377407, 'f1': 0.49153277, 'auroc': 0.9729287}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    20   0   0   331    13    50   4     64
1    0  1130   0    17   0   0     0   151     4   0     30
2    0     0   0    17   0   2   109    56    99   6     23
3    0     0   0  7759   0   2     2   379   283   0     12
4    0     0   0    10   0   0   125     7   129   1    267
5    0     0   0   334   0  88    42     1    38  16      1
6    0     0   0    24   0   3  1548    28   119   0    185
7    0    33   0   535   0   0     6  6410   182   0     97
8    0     0   0   368   0   1    55   128  2608   0    136
9    0     0   0   132   0  37   158    27   113  25      1
10   0     2   0    15   0   0   202    50   161   0  12365
---- Validation: 
scalar performance:
{'acc': 0.8525077, 'precision': 0.65043, 'recall': 0.49442255, 'specificity': 0.9835912, 'f1': 0.49141544, 'auroc': 0.97313535}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    32   0   3   326    16    50   3     53
1    0  1138   0    15   0   0     1   147     6   0     25
2    0     0   1    13   0   0   115    51   112   3     17
3    0     0   0  7759   0   0     1   372   302   0      6
4    0     0   0     5   0   0   111    16   139   0    268
5    0     0   0   331   0  90    49     2    38  11      0
6    0     2   0    27   0   5  1550    27   113   0    184
7    0    35   0   547   0   0     5  6384   191   0    103
8    0     1   0   365   0   0    51   156  2579   0    144
9    0     1   0   124   0  38   154    25   124  25      2
10   0     1   0    17   0   1   217    54   161   0  12345
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4702302, 'precision': 0.38149205, 'recall': 0.33842787, 'specificity': 0.9426279, 'f1': 0.30673575, 'auroc': 0.7955039}
confusion matrix:
    0     1   2    3   4    5     6    7    8   9     10
0    0     0   0    4   0    2  1127    1   27   8     1
1    0  1123   0   22   0    0    94   47   51   0   162
2    0     2   0   26   0    8   762    1  136  11    69
3    0     0   0    0   0    0     0    0    0   0     0
4    0     0   0    0   0    0   155    0    8   0  1470
5    0     0   0  267   0  115    97    0   66  46     1
6    0     0   0    0   0    0  2707    0   16   0   344
7    0   207   0    6   0    0   379  473   63   0    36
8    0     0   0   47   0    2   681    0  607   6    27
9    0    11   0  124   0   45   582    2  297  62    14
10   0     0   0    0   0    0    12    0    0   0  1634
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 02:47:20.829547,epoch time: 0:30:42.005529,used: 1:02:53.938945,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.884177, 'precision': 0.77511585, 'recall': 0.6069263, 'specificity': 0.9872478, 'f1': 0.6218982, 'auroc': 0.9832353}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   98     0   0    19   0    5   200    28    31   44     58
1    0  1139   0    17   0    0     0   155     5    0     15
2    9     1  11     7   5    2    12    48   105   92     20
3    0     0   0  7684   0   26     3   467   255    4      0
4    5     0   2     2  21    1    40    21   172   22    253
5    3     0   0   164   0  261     2     2    13   75      1
6    2     1   0    11   1   11  1668    29    62    8    114
7    0    16   0   282   0    0     4  6782   144    0     35
8    0     0   0   244   0    5    12   173  2785    5     71
9   10     1   4    63   1   73    14    29    45  253      0
10   5     2   0    10   1    3   119    84   220    4  12345
---- Validation: 
scalar performance:
{'acc': 0.8822255, 'precision': 0.77928746, 'recall': 0.60527766, 'specificity': 0.9870062, 'f1': 0.62128246, 'auroc': 0.9827295}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   106     0   0    18   0    3   190    23    32   48     63
1     0  1147   0    15   0    0     1   154     4    0     11
2     6     0  12     3   5    1    19    60    97   95     14
3     0     0   0  7665   0   29     0   485   257    2      2
4     4     0   2     1  19    1    48    26   158   30    250
5     3     0   0   168   0  260     2     0    16   71      1
6     3     2   0    12   0    9  1626    35    73   10    138
7     0    14   0   293   0    0     1  6773   142    1     41
8     0     0   0   257   0    5     9   159  2792    3     71
9     9     0   3    64   0   74    15    28    51  247      2
10   12     3   0    11   2    2   118    96   215    2  12335
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.54642135, 'precision': 0.60700583, 'recall': 0.44693014, 'specificity': 0.95218176, 'f1': 0.4083075, 'auroc': 0.83718294}
confusion matrix:
    0     1   2    3   4    5     6    7    8    9     10
0   14     0   0    2   0   14  1028    0   28   82     2
1    0  1211   0   29   0    0    49   74   62    2    72
2    0     7   1   16   2   25   312    4  337  148   163
3    0     0   0    0   0    0     0    0    0    0     0
4    0     2   0    0   1    0    59    0   30    1  1540
5    0     0   0  113   0  337    23    0   21   97     1
6    1     1   0    0   0    0  2460    0   55    5   545
7    0   129   0   12   0    0   252  600  138   11    22
8    0     0   0   53   0   20   145    0  990   90    72
9    1    15   0   62   0  113   152    2  221  556    15
10   0     1   0    0   0    0     5    0    0    0  1640
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 03:18:04.671275,epoch time: 0:30:43.841728,used: 1:33:37.780673,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9002569, 'precision': 0.78689146, 'recall': 0.69862866, 'specificity': 0.988809, 'f1': 0.73136246, 'auroc': 0.9875163}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   247     1    2    11    2    3    84    14    18   12     89
1     0  1186    0    16    0    0     0   109     6    0     15
2    11     0  114     4   44    2     5    31    24   70      7
3     0     1    0  7973    0   42     0   254   163    1      3
4     8     0   21     6  158    2     8    16    69   14    237
5     3     0    3   119    0  280     0     1    10  104      1
6    29     1    1    18    2    3  1683    20    33    8    109
7     0    45    1   543    0    1     4  6489   114    1     64
8     0     1    4   318   10    6    10   115  2712    7    112
9    11     1   41    44    1   77     6    11    21  278      2
10   24     4    4    11   28    1    40    54    96    5  12528
---- Validation: 
scalar performance:
{'acc': 0.90242076, 'precision': 0.7866976, 'recall': 0.69657737, 'specificity': 0.98907435, 'f1': 0.72893655, 'auroc': 0.98750305}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   251     0    2    14    1    1    76    19    22   19     78
1     0  1190    0    22    0    0     0   102     9    0      9
2     9     3  107     3   37    1     1    23    37   76     15
3     0     0    0  7963    0   44     0   277   150    3      3
4    10     0   22     5  153    1     9     7    75   17    240
5     4     0    1   120    0  277     0     0    10  108      1
6    32     0    2    20    1    5  1704    14    27    9     94
7     0    54    2   469    1    0     2  6553   119    1     64
8     0     1    3   336   11    2    13   132  2688    4    106
9    12     0   50    38    1   74     4    15    22  273      4
10   20     4    1    10   20    1    45    42    74    1  12578
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50955015, 'precision': 0.54371375, 'recall': 0.43763342, 'specificity': 0.9488784, 'f1': 0.42811126, 'auroc': 0.84252566}
confusion matrix:
     0     1   2   3    4    5     6    7     8    9     10
0   316     0   0   4    0    2   728    0    34   48    38
1     0  1280   0  27    1    0    39   26    46    1    79
2    13     7  41  15  152   13   143    1   225   97   308
3     0     0   0   0    0    0     0    0     0    0     0
4     0     0   0   0   99    0    11    0     7    0  1516
5     4     0   0  80    0  325    26    0    27  128     2
6    16     1   0   0   37    0  1708    0    37    2  1266
7     4   320  17  26    0    0   290  339   113    3    52
8     4     0   5  41   27    5    47    0  1026   49   166
9    23    15  91  50   26   56   110    0   221  505    40
10    0     1   0   0    1    0     0    0     0    0  1644
better model found
persisted
after epoch: 4,now: 2024-08-12 03:48:45.193102,epoch time: 0:30:40.521827,used: 2:04:18.302500,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.91248393, 'precision': 0.8015665, 'recall': 0.743783, 'specificity': 0.99036, 'f1': 0.7642062, 'auroc': 0.99019367}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   303     1    1     8    1    3    56    13     9   13     74
1     0  1224    0    14    0    0     1    86     2    0      5
2     8     1  148     2   22    2     2    15    17   79     16
3     0     8    1  7734    0   35     0   461   194    6      1
4    10     0   50     0  176    1     7    13    66   22    194
5     2     0    1    80    0  317     1     1     8  109      2
6    40     1    2     5    0    6  1722    19    26    4     82
7     0    58    0   223    1    0     6  6821   107    2     43
8     3     1    7   241    7    5    13   133  2802    5     77
9     6     0   42    20    1   83     4     6    16  313      2
10   26    13    7     8   34    3    34    41    81    3  12545
---- Validation: 
scalar performance:
{'acc': 0.9128795, 'precision': 0.8014712, 'recall': 0.7419783, 'specificity': 0.99041295, 'f1': 0.763095, 'auroc': 0.9903861}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   299     0    1     7    0    2    58    16    19   15     66
1     0  1207    1    14    0    0     2    94     6    0      8
2     9     0  161     2   19    1     1    14    17   79      9
3     0     6    0  7734    0   45     2   463   185    5      0
4    13     0   42     1  168    4     8    13    64   19    207
5     3     0    2    89    0  318     0     2     5  101      1
6    41     1    2     4    2    3  1721    16    36    7     75
7     2    51    2   192    2    0     2  6872   102    3     37
8     2     3    7   223    9    6    12   135  2815    3     81
9     5     1   45    25    1   85     2    11    17  296      5
10   22    18    8    10   32    0    35    49    85    0  12537
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5243826, 'precision': 0.5953894, 'recall': 0.4480123, 'specificity': 0.950379, 'f1': 0.43567494, 'auroc': 0.8503362}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   189     0   0   11    0    5   856    0    40   53    16
1     0  1308   0   28    0    0    23   36    40    1    63
2     1    10  76   17   55   16   138    3   262   98   339
3     0     0   0    0    0    0     0    0     0    0     0
4     0     2   2    0  140    0     9    0     7    0  1473
5     0     0   0  100    0  334    31    0    30   96     1
6     9     1   1    0    9    0  1812    0    34    7  1194
7     1   312  13   28    0    0   248  417   103    7    35
8     0     0   1   41    8    8    51    0  1099   32   130
9     1    26  90   65    1   81   112    2   248  478    33
10    0     1   0    0    3    0     0    0     0    0  1642
better model found
persisted
after epoch: 5,now: 2024-08-12 04:19:31.508854,epoch time: 0:30:46.315752,used: 2:35:04.618252,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92043024, 'precision': 0.8212173, 'recall': 0.7649759, 'specificity': 0.9911905, 'f1': 0.7893558, 'auroc': 0.991834}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   325     0    0     5    0    1    42     8    13    4     85
1     0  1217    0     8    1    0     0    97     3    1      5
2     8     2  160     1   46    3     1    19    19   47      6
3     0     1    0  7679    0   32     2   472   248    2      1
4     3     0   30     1  237    1     4     8    54    7    194
5     3     0    3    71    0  340     1     1     5   96      1
6    25     0    1     3    2    0  1759    16    18    1     83
7     1    19    2   152    1    0     1  6930   114    0     44
8     1     2   10   141   17    4     9   132  2882    1     95
9     9     1   63    20    1   79     5     9    18  285      3
10   17     6    4     9   50    3    22    37    57    0  12588
---- Validation: 
scalar performance:
{'acc': 0.9217333, 'precision': 0.82228446, 'recall': 0.7660998, 'specificity': 0.9913257, 'f1': 0.79053783, 'auroc': 0.9923457}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   329     0    3     7    1    0    33    17     8    3     82
1     0  1214    0    13    0    0     1    97     4    0      3
2     3     0  164     2   46    0     4    21    10   51     11
3     0     0    0  7684    0   33     1   466   249    5      2
4     7     0   30     0  245    3     3    13    40    8    190
5     4     1    5    75    0  327     1     1    12   93      2
6    28     1    1     3    1    1  1747    20    21    1     84
7     1    29    1   163    2    0     2  6922    97    1     47
8     2     0    4   120   21    3     5   132  2926    1     82
9    14     1   64    18    2   81     3     8    13  283      6
10   15     3    6     8   38    2    21    37    47    1  12618
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5106695, 'precision': 0.58644366, 'recall': 0.4286492, 'specificity': 0.9487488, 'f1': 0.41027102, 'auroc': 0.83904773}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   41     0   0    7    0    2  1024    0    44   15    37
1    0  1307   0   34    0    0    26   44    29    0    59
2    0     8  37   15   85   16   155    6   240   37   416
3    0     0   0    0    0    0     0    0     0    0     0
4    0     1   0    0  174    0     7    0     7    0  1444
5    0     0   0  129    0  309    65    0    42   44     3
6    3     1   0    1    7    1  1826    0    23    2  1203
7    1   201   2   46    0    0   178  598   104    2    32
8    0     0   2   41   11    6    63    0  1100    6   141
9    0    27  86   87    5   80   189    5   317  267    74
10   0     1   0    0    5    0     0    0     0    0  1640
better model found
persisted
after epoch: 6,now: 2024-08-12 04:50:26.321860,epoch time: 0:30:54.813006,used: 3:05:59.431258,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.925594, 'precision': 0.8338803, 'recall': 0.7748348, 'specificity': 0.9917844, 'f1': 0.79747593, 'auroc': 0.9933491}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   339     0    1     6    0    0    34    15    11    6     71
1     0  1217    0    17    0    0     0    88     5    0      5
2     3     1  196     1   22    2     3    17    16   47      4
3     0     0    0  7893    0   24     1   379   137    2      1
4     3     0   56     0  216    2     6    16    67    7    166
5     2     0    3    71    0  365     0     1     6   72      1
6    18     0    2    17    2    1  1771    17    24    2     53
7     0    23    1   205    2    0     3  6920    88    0     21
8     0     1    3   231   10    3     4   135  2855    2     51
9     6     1   77    29    1   97     3     9    15  252      2
10   26     2    8    16   30    3    18    44    77    0  12571
---- Validation: 
scalar performance:
{'acc': 0.9255316, 'precision': 0.83273494, 'recall': 0.7765151, 'specificity': 0.9917989, 'f1': 0.79826266, 'auroc': 0.99289143}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   344     0    1    13    0    0    34    16    15    4     56
1     0  1220    1    13    0    0     0    84     5    0      9
2     7     0  194     4   22    2     1    21    17   38      6
3     0     0    0  7900    0   28     0   375   135    2      0
4     5     0   56     1  226    1     2    13    59    9    167
5     3     0    4    78    0  353     2     0     8   72      1
6    22     0    1    15    1    3  1766    13    29    1     57
7     0    23    0   209    1    0     2  6924    89    0     17
8     1     0    6   221    8    2     7   122  2878    1     50
9     6     1   75    26    0   94     3    13    13  260      2
10   28     5   11    15   34    1    24    38   102    2  12536
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5043728, 'precision': 0.60271406, 'recall': 0.4233197, 'specificity': 0.9487455, 'f1': 0.40201676, 'auroc': 0.84216243}
confusion matrix:
    0     1    2    3    4    5     6    7     8    9     10
0   50     0    1   20    0    2   965    0    62   21    49
1    0  1296    0   49    0    0    23   42    34    0    55
2    0     6   70   36   41   26    86    4   394   30   322
3    0     0    0    0    0    0     0    0     0    0     0
4    0     0    2    0  154    0     5    0    10    0  1462
5    0     0    0  200    0  299    39    0    25   27     2
6    3     0    0    1    3    1  1774    0    59    3  1223
7    0   160    1  134    0    0   154  558   137    1    19
8    0     0    1  104    4    4    29    0  1176    2    50
9    0    28  102  185    1  130   108    6   348  190    39
10   0     1    0    0    3    0     0    0     0    0  1642
better model found
persisted
after epoch: 7,now: 2024-08-12 05:21:19.383588,epoch time: 0:30:53.061728,used: 3:36:52.492986,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93062395, 'precision': 0.8408587, 'recall': 0.79639405, 'specificity': 0.992339, 'f1': 0.8163181, 'auroc': 0.9937576}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     0    0     4    1    1    18     7    12    1     65
1     0  1196    0    14    0    0     0   106     4    0     12
2     6     0  179     3   43    0     3    12    13   44      9
3     2     1    0  7851    0   38     0   342   198    4      3
4     5     0   37     1  273    1     6    11    41    6    158
5     3     0    1    50    0  358     1     1    12   94      1
6    20     0    0     6    2    1  1790    17    17    1     53
7     3    15    6   206    2    0     1  6919    70    3     37
8     4     1    3   134   17    1     8   125  2928    3     70
9     4     0   56    13    1   74     7     8    15  308      7
10   18     2    7    10   43    1    21    28    56    1  12607
---- Validation: 
scalar performance:
{'acc': 0.9297312, 'precision': 0.8395151, 'recall': 0.7914545, 'specificity': 0.99223256, 'f1': 0.8130578, 'auroc': 0.99394923}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    0     9    1    0    27    12     3    1     59
1     0  1180    0    14    0    0     0   123     3    0     12
2     4     0  177     2   46    1     1    21    11   39     10
3     1     1    1  7848    0   36     1   351   199    2      0
4     3     0   28     2  267    1     5     7    43    8    175
5     3     0    3    57    1  355     1     0     9   91      1
6    30     0    0    11    1    1  1789    10    18    1     47
7     2    18    1   195    1    0     1  6928    82    0     37
8     3     1    4   127   24    5     8   147  2903    2     72
9     7     0   64    15    2   70     7     6    12  305      5
10   18     1    5    10   40    1    21    20    44    1  12635
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5269013, 'precision': 0.60886645, 'recall': 0.4402254, 'specificity': 0.9504775, 'f1': 0.42035872, 'auroc': 0.83786505}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   52     0   0   10    0    2  1025    0    32   12    37
1    0  1279   0   47    0    0    26   42    43    0    62
2    0     3  38   19   76   18   136    3   346   32   344
3    0     0   0    0    0    0     0    0     0    0     0
4    0     0   0    0  177    0     6    0    14    0  1436
5    0     0   0  105    0  348    71    0    26   39     3
6    3     0   0    1    3    1  2012    0    34    0  1013
7    1    81   0  144    0    0   231  554   121    2    30
8    0     0   1   43    5    7    68    0  1175    5    66
9    0    16  62   92    4  107   184    5   345  256    66
10   0     0   0    0    6    0     0    0     0    0  1640
better model found
persisted
after epoch: 8,now: 2024-08-12 05:52:10.634024,epoch time: 0:30:51.250436,used: 4:07:43.743422,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9289383, 'precision': 0.8226177, 'recall': 0.81832063, 'specificity': 0.9923377, 'f1': 0.81905067, 'auroc': 0.9937944}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   383     6    0     2    2    1    17     4     6    4     58
1     0  1262    0    13    0    0     0    48     4    0      4
2     6     3  208     3   26    0     3     9     6   45      3
3     3    44    0  7933    1   29     0   291   133    3      2
4     5     3   48     2  325    1     1     6    23    9    116
5     3     1    2    61    0  334     1     0     4  111      4
6    23     4    1     9    5    1  1790    11    16    2     46
7     1   161    8   175    3    0     3  6802    76    1     33
8     2    15    8   211   40    6     2   110  2832    2     67
9     1     0   63    16    1   55     5     2     4  344      2
10   21    39   10     8  123    3    15    28    38    0  12507
---- Validation: 
scalar performance:
{'acc': 0.92927647, 'precision': 0.82249033, 'recall': 0.8158599, 'specificity': 0.9923976, 'f1': 0.81727505, 'auroc': 0.99385995}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     3    0     4    2    0    16     9     6    4     54
1     0  1268    0    11    0    0     0    46     2    0      5
2     4     6  194     1   35    1     1    14     6   47      3
3     0    67    0  7934    0   21     2   286   123    2      5
4     4     2   33     3  347    0     4     6    27    9    104
5     1     0    2    71    0  319     1     0     7  119      1
6    39     3    0    11    3    0  1780    12     9    4     47
7     3   170    7   172    5    0     3  6808    63    2     32
8     4    15   10   195   37    3     2   114  2855    5     56
9     2     0   59    18    2   53     3     2     9  342      3
10   32    34    7    15  116    0    14    26    42    1  12509
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5518786, 'precision': 0.61128664, 'recall': 0.4667938, 'specificity': 0.95337427, 'f1': 0.46318996, 'auroc': 0.85468054}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   117     0    2   11    0    1   916    0    25   33    65
1     0  1366    0   38    0    0    12   24    19    1    39
2     1    12  113   17  170   16    71    3   275   62   275
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1    2    0  452    0     6    0    11    0  1161
5     0     0    0  114    0  316    40    0    23   94     5
6     3     3    0    1   18    1  1870    0    55    4  1112
7     0   301    9  104    0    0   166  483    75    1    25
8     0     0    3   49   18   11    40    0  1177    6    66
9     0    45  161   92    0   69   129    6   202  391    42
10    0     1    1    0   41    0     0    0     0    0  1603
new oracle model saved
early stop counter: 1
val acc:0.9292764663696289, best validation acc: 0.9297311902046204, corresponding to test acc:                         0.5269013047218323 / 0.5518785715103149
after epoch: 9,now: 2024-08-12 06:22:56.859973,epoch time: 0:30:46.225949,used: 4:38:29.969371,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.93867725, 'precision': 0.8504173, 'recall': 0.81351054, 'specificity': 0.99327934, 'f1': 0.8260316, 'auroc': 0.9953351}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     1    0     7    0    0    18     4     6    3     37
1     0  1244    0    16    0    0     0    62     3    0      7
2     3     0  205     0   25    0     2    10     9   50      8
3     1     0    0  7966    0   18     0   309   144    1      0
4     6     0   43     0  240    2     5     5    43   10    185
5     3     0    1    59    0  318     1     0     5  132      1
6    53     0    1    10    1    2  1784     7    14    3     32
7     2    11    6   150    1    0     2  6982    87    1     21
8     6     0    2   145   11    1     4   101  2976    3     47
9     8     0   45    12    2   48     2     3     9  359      4
10   48     2    5    10   30    3    10    27    55    0  12604
---- Validation: 
scalar performance:
{'acc': 0.9381035, 'precision': 0.8534062, 'recall': 0.81348604, 'specificity': 0.99321556, 'f1': 0.82698333, 'auroc': 0.9952117}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     7    0    0    17     5     8    1     33
1     0  1240    0    13    0    0     0    67     5    0      7
2     6     0  196     3   21    1     2    10    10   55      8
3     1     0    0  7970    0   25     1   290   151    2      0
4     7     0   39     1  251    1     5     4    45    9    177
5     4     0    3    62    0  314     0     1     7  129      1
6    55     0    1     6    0    1  1781     8     8    3     45
7     0    13    1   167    2    0     1  6957    96    5     23
8     6     0    5   150   12    3     7    96  2967    3     47
9     8     0   37    16    1   48     4     4     7  368      0
10   50     2    0     9   22    2    14    29    50    3  12615
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5245225, 'precision': 0.6109679, 'recall': 0.45227605, 'specificity': 0.9510768, 'f1': 0.44559026, 'auroc': 0.8448244}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   260     0   1   17    0    0   701    3    53   28   107
1     0  1280   2   53    0    0    14   41    52    0    57
2     2     3  56   20   70   14    39    3   402   57   349
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   1    0  119    0     3    0    17    0  1493
5     0     0   0  141    0  304    32    0    26   83     6
6     2     0   0    1    4    1  1659    0    92    1  1307
7     0    73   3  214    0    0   110  589   157    3    15
8     0     0   1   55    3    6    12    0  1227    4    62
9     0    12  80  114    1   75    90    4   341  360    60
10    0     0   0    0    3    0     0    0     0    0  1643
better model found
persisted
after epoch: 10,now: 2024-08-12 06:53:41.626856,epoch time: 0:30:44.766883,used: 5:09:14.736254,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:09:14.736254 at 2024-08-12 06:53:41.626856
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5245225, 'precision': 0.6109679, 'recall': 0.45227605, 'specificity': 0.9510768, 'f1': 0.44559026, 'auroc': 0.8448244}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   260     0   1   17    0    0   701    3    53   28   107
1     0  1280   2   53    0    0    14   41    52    0    57
2     2     3  56   20   70   14    39    3   402   57   349
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   1    0  119    0     3    0    17    0  1493
5     0     0   0  141    0  304    32    0    26   83     6
6     2     0   0    1    4    1  1659    0    92    1  1307
7     0    73   3  214    0    0   110  589   157    3    15
8     0     0   1   55    3    6    12    0  1227    4    62
9     0    12  80  114    1   75    90    4   341  360    60
10    0     0   0    0    3    0     0    0     0    0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5518786, 'precision': 0.61128664, 'recall': 0.4667938, 'specificity': 0.95337427, 'f1': 0.46318996, 'auroc': 0.85468054}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   117     0    2   11    0    1   916    0    25   33    65
1     0  1366    0   38    0    0    12   24    19    1    39
2     1    12  113   17  170   16    71    3   275   62   275
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1    2    0  452    0     6    0    11    0  1161
5     0     0    0  114    0  316    40    0    23   94     5
6     3     3    0    1   18    1  1870    0    55    4  1112
7     0   301    9  104    0    0   166  483    75    1    25
8     0     0    3   49   18   11    40    0  1177    6    66
9     0    45  161   92    0   69   129    6   202  391    42
10    0     1    1    0   41    0     0    0     0    0  1603
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_44_26_seed_1_24142415_instance_wise_predictions.txt
accuracy from prediction file 0.5245224935283006
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496602 KiB |  10950 MiB | 689803 GiB | 689802 GiB |
|       from large pool | 405888 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 496602 KiB |  10950 MiB | 689803 GiB | 689802 GiB |
|       from large pool | 405888 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10882 MiB | 685930 GiB | 685930 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 684602 GiB | 684602 GiB |
|       from small pool |  90258 KiB |    126 MiB |   1328 GiB |   1328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11544 MiB |  11544 MiB |  21778 MiB |  10234 MiB |
|       from large pool |  11416 MiB |  11416 MiB |  21620 MiB |  10204 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1285 MiB |   1530 MiB | 226545 GiB | 226543 GiB |
|       from large pool |   1275 MiB |   1527 MiB | 225131 GiB | 225130 GiB |
|       from small pool |      9 MiB |     33 MiB |   1413 GiB |   1413 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   54451 K  |   54448 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    2922    |    4522    |   30341 K  |   30338 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   54451 K  |   54448 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    2922    |    4522    |   30341 K  |   30338 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     300    |     300    |     516    |     216    |
|       from large pool |     236    |     236    |     437    |     201    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      67    |    1102    |   29575 K  |   29575 K  |
|       from large pool |      31    |     135    |   14493 K  |   14493 K  |
|       from small pool |      36    |    1070    |   15081 K  |   15081 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10950 MiB | 689803 GiB | 689803 GiB |
|       from large pool |  16640 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |      0 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10950 MiB | 689803 GiB | 689803 GiB |
|       from large pool |  16640 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |      0 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 685930 GiB | 685930 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 684602 GiB | 684602 GiB |
|       from small pool |      0 KiB |    126 MiB |   1328 GiB |   1328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1770 MiB |  11544 MiB |  21778 MiB |  20008 MiB |
|       from large pool |   1672 MiB |  11416 MiB |  21620 MiB |  19948 MiB |
|       from small pool |     98 MiB |    128 MiB |    158 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1530 MiB | 226545 GiB | 226545 GiB |
|       from large pool |  59136 KiB |   1527 MiB | 225131 GiB | 225131 GiB |
|       from small pool |      0 KiB |     33 MiB |   1413 GiB |   1413 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   54451 K  |   54451 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    4522    |   30341 K  |   30341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   54451 K  |   54451 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    4522    |   30341 K  |   30341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     300    |     516    |     432    |
|       from large pool |      35    |     236    |     437    |     402    |
|       from small pool |      49    |      64    |      79    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1102    |   29576 K  |   29576 K  |
|       from large pool |       3    |     135    |   14493 K  |   14493 K  |
|       from small pool |       0    |    1070    |   15082 K  |   15082 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 07:00:02 2024]
Finished job 0.
1 of 1 steps (100%) done
