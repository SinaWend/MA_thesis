Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 01:49:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/22.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=22
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423

 Experiment start at: 2024-08-12 01:58:33.643009
before training, model accuracy: 0.07954943180084229
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.71741223, 'precision': 0.40992054, 'recall': 0.28239942, 'specificity': 0.96604866, 'f1': 0.27608585, 'auroc': 0.89210373}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   0   0   148   0   0   31    84   56  31    133
1    0  45   0    26   0   0    1  1162    2   0     96
2    0   0   0    82   0   0   17    89   44  16     64
3    0   0   0  7707   0   0    0   645   36   0     48
4    0   0   0    57   0   1   12    56   31   8    374
5    0   0   0   462   0   0    0     9   21  23      6
6    0   2   0   313   1   0  252   163  172  53    951
7    0   0   0  1177   1   0    1  5859   23   0    203
8    0   0   0  1321   0   0   17   599  456   8    893
9    0   1   0   317   0   1   14    55   37  54     14
10   0   0   0    81   0   0   21   166   80   6  12441
---- Validation: 
scalar performance:
{'acc': 0.7164638, 'precision': 0.44470528, 'recall': 0.27896643, 'specificity': 0.96590245, 'f1': 0.27005565, 'auroc': 0.891201}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   0   0   146   0   0   20    93   54  37    133
1    0  31   0    33   0   0    0  1171    0   0     97
2    0   0   0    87   0   0   14    84   35  21     71
3    0   0   0  7727   0   0    0   633   29   1     50
4    0   0   0    47   1   0   17    41   40   7    386
5    0   0   0   465   0   0    1    12   12  24      7
6    0   0   0   329   2   0  205   162  180  50    980
7    0   0   0  1173   0   0    1  5880   31   1    179
8    0   0   0  1342   0   1   12   596  437   9    899
9    0   0   0   319   0   1   11    67   28  52     15
10   0   0   0    83   0   0    9   162   81   9  12452
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23598965, 'precision': 0.20644613, 'recall': 0.21637645, 'specificity': 0.9223405, 'f1': 0.13484818, 'auroc': 0.6512023}
confusion matrix:
    0   1   2    3   4   5    6     7    8    9     10
0    0   1   0   99   2   0  263    54   97  590    64
1    0  29   0   12   6   0   46   958    4   12   432
2    0   0   0   93   0   0  123   127   63  103   506
3    0   0   0    0   0   0    0     0    0    0     0
4    0   0   0    3   0   0   21     7    0    3  1599
5    0   0   0  247   0   0   10    17   59  235    24
6    0   0   0   14   0   1  128   118   26   10  2770
7    0   2   0   17   4   1   35  1016   27   21    41
8    0   0   0  120   0   1  127    52  278  259   533
9    0   0   0  243   2   2  114   187  104  278   207
10   0   0   0    0   0   0    0     2    0    0  1644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 02:30:45.967969,epoch time: 0:32:12.324960,used: 0:32:12.324960,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8232823, 'precision': 0.54256064, 'recall': 0.4627887, 'specificity': 0.9802198, 'f1': 0.4607308, 'auroc': 0.9458076}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    61   0   0   236    39    84  16     47
1    0  1128   0    17   0   0     0   172     2   0     13
2    0     1   0    31   0   0   104    53   105  13      5
3    0     0   0  7773   0   0     0   510   151   0      3
4    0     0   0    22   0   0   133    27   132   6    219
5    0     0   0   387   0   5    11     0    41  75      2
6    0    13   0    93   0   0  1318    61   203  12    207
7    0    43   0   652   1   0     4  6416   103   0     43
8    0     2   0   685   0   0    85   327  1974   2    221
9    0     0   0   201   0   1    77    35    81  97      1
10   0    13   0    27   0   0   285   142   265   2  12060
---- Validation: 
scalar performance:
{'acc': 0.8249833, 'precision': 0.5169568, 'recall': 0.46189415, 'specificity': 0.9804474, 'f1': 0.45970085, 'auroc': 0.9462341}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    55   0   1   234    44    88  20     41
1    0  1132   0    16   0   0     0   167     5   0     12
2    0     0   0    32   0   0   108    57    95  15      5
3    0     1   0  7821   0   0     1   480   132   0      5
4    0     0   0    17   0   0   131    38   141   4    208
5    0     0   0   398   0   6    18     1    31  66      1
6    0    13   0    96   1   0  1305    59   227   5    202
7    0    45   0   637   0   0     6  6436   101   0     40
8    0     1   0   709   0   0    75   307  1998   0    206
9    0     0   0   198   0   4    85    27    92  86      1
10   0    10   0    27   0   0   298   125   278   0  12058
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43839642, 'precision': 0.34003127, 'recall': 0.3038599, 'specificity': 0.93834233, 'f1': 0.26402593, 'auroc': 0.74289626}
confusion matrix:
    0     1   2    3   4   5     6    7    8    9     10
0    0     2   0    2   0   0  1135    3   18    8     2
1    0  1159   0    7   1   0   159   63    7    5    98
2    0     4   0   19   0   0   883    6   42   14    47
3    0     0   0    0   0   0     0    0    0    0     0
4    0     1   0    0   1   0   250    0    1    0  1380
5    0     0   0  133   0   0   190    1   78  188     2
6    0     3   0    2   0   0  2548    4   17    1   492
7    0   345   0    0   0   0   371  430   10    0     8
8    0     0   0   14   0   0   823    0  438   28    67
9    0    11   0   46   0   0   885   12   96   81     6
10   0     1   0    0   0   0    36    0    0    0  1609
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 03:02:06.274668,epoch time: 0:31:20.306699,used: 1:03:32.631659,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.85629815, 'precision': 0.6308055, 'recall': 0.5279703, 'specificity': 0.9840306, 'f1': 0.5336052, 'auroc': 0.96431303}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    4     1   0    27   0   18   203    33    92   48     57
1    0  1118   0    14   0    0     0   175     8    1     15
2    0     0   0    18   4    6    56    57   105   49     17
3    0     0   0  7535   0   16     1   641   243    0      2
4    0     0   0     5   1    1    79    20   186   11    236
5    0     0   0   255   0  177     3     1    24   60      1
6    1     6   0    31   0   11  1463    52   109   18    217
7    0    21   0   334   0    0     3  6705   141    0     59
8    0     0   0   300   0    3    18   256  2563    1    154
9    0     0   0   101   2   97    39    26    80  146      2
10   0     1   0    11   0    0   136    78   271    3  12293
---- Validation: 
scalar performance:
{'acc': 0.85761666, 'precision': 0.7046802, 'recall': 0.5311286, 'specificity': 0.98418343, 'f1': 0.5377749, 'auroc': 0.9653112}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    8     1   0    31   0   12   194    38    97   42     60
1    0  1119   0    15   0    0     0   180     3    0     15
2    1     0   0    10   0    2    59    61   122   50      7
3    0     0   0  7532   0    8     0   648   248    2      2
4    0     0   0     6   2    3    88    23   167   12    238
5    1     0   0   239   0  184     7     1    28   60      1
6    0     3   0    30   0    4  1471    43   106   32    219
7    0    20   0   303   0    0     2  6749   141    0     50
8    0     0   0   316   0    3    16   253  2548    3    157
9    0     2   0   103   0  106    35    25    71  149      2
10   1     2   0    13   0    0   132    70   274    4  12300
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4462324, 'precision': 0.38992837, 'recall': 0.35617387, 'specificity': 0.94092816, 'f1': 0.32291403, 'auroc': 0.7613306}
confusion matrix:
    0     1   2   3   4   5     6    7    8    9     10
0    0     0   0   3   0   1  1087    8   34   33     4
1    0  1166   0   7   0   0   101   77   26    3   119
2    0     5   0  15   0   0   479   12  247   48   209
3    0     0   0   0   0   0     0    0    0    0     0
4    0     2   0   0   0   0    52    0    6    0  1573
5    0     0   0  89   0  91    63    0   49  297     3
6    0     3   0   1   0   0  1645    0   47    0  1371
7    0   241   0   0   0   0   334  550   30    0     9
8    0     0   0   7   0   1   217    0  995   59    91
9    0     9   0  40   0   2   514   11  247  287    27
10   0     1   0   0   0   0     1    0    0    0  1644
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 03:33:19.770184,epoch time: 0:31:13.495516,used: 1:34:46.127175,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8759899, 'precision': 0.7071992, 'recall': 0.58383405, 'specificity': 0.98640007, 'f1': 0.59823513, 'auroc': 0.97469264}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   66     0   0    24   0    6   232    32    51   18     53
1    0  1126   0    18   1    0     0   172     6    0      9
2    4     0   3     6  33    3    56    46    89   65      6
3    0     0   0  7673   0   34     2   467   261    1      0
4    2     0   1     5  46    2    84    19   138   14    228
5    3     0   0   152   0  274     7     1    25   58      1
6    0     1   0    19   0    0  1677    43    50   17    101
7    0    13   0   347   2    0     7  6707   142    0     46
8    0     0   0   265   2    5    26   179  2697    3    118
9    9     0   6    63   7  116    39    19    70  161      3
10   5     2   0    18   3    0   163    78   210    3  12311
---- Validation: 
scalar performance:
{'acc': 0.8781597, 'precision': 0.7484206, 'recall': 0.5904237, 'specificity': 0.9866298, 'f1': 0.60661864, 'auroc': 0.97470427}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   71     0   0    28   0    6   232    31    43   16     56
1    0  1134   0    18   0    0     0   159     9    1     11
2    3     0   6     8  26    4    51    49    86   67     12
3    0     0   0  7682   0   25     1   453   275    2      2
4    1     1   0     6  43    1    88    17   150    9    223
5    1     0   1   163   0  273     5     0    23   54      1
6    4     0   0    22   0    0  1684    29    48   18    103
7    0    17   0   334   0    0     5  6711   151    0     47
8    0     0   0   239   4    6    15   190  2734    4    104
9    3     1   3    71   5  105    35    20    68  180      2
10   5     2   0    14   7    0   172    76   208    0  12312
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46624222, 'precision': 0.4581176, 'recall': 0.3602755, 'specificity': 0.94254744, 'f1': 0.33227444, 'auroc': 0.7777405}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   15     0   0    5   0    1  1123    4    16    3     3
1    0  1164   0   18   0    0   133   68    25    2    89
2    3     5   0   21  21    0   470    6   303   25   161
3    0     0   0    0   0    0     0    0     0    0     0
4    0     1   0    0  19    0    62    0    14    0  1537
5    3     0   0  109   0  121   151    0    21  185     2
6    0     2   0    1   4    0  2046    0    82    0   932
7    1   114   0    6   3    0   590  410    33    0     7
8    9     0   0   15   1    3   227    0  1041   33    41
9   21    11   0   59   7   12   581    7   218  205    16
10   0     1   0    0   0    0     2    0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 04:04:31.347442,epoch time: 0:31:11.577258,used: 2:05:57.704433,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8934878, 'precision': 0.76789373, 'recall': 0.64529365, 'specificity': 0.9882269, 'f1': 0.67184186, 'auroc': 0.9795634}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   167     0   0    24    3    3   123    20    37   29     77
1     0  1165   0    21    0    0     0   128     6    0     12
2     3     1  20    11   65    2     7    39    59   99      6
3     0     0   0  7812    0   31     2   405   184    1      1
4     2     3   6     5  120    0    18    12   137   28    208
5     0     0   0   122    0  318     1     0    12   67      1
6    14     3   0    20    0    2  1633    25    33   17    161
7     0    37   0   292    1    0     1  6750   137    0     46
8     0     1   0   267    3    8     4   146  2785    9     73
9     1     2  10    66    8  112     6    15    44  224      4
10    7     3   0    11   16    0    80    44   227    4  12401
---- Validation: 
scalar performance:
{'acc': 0.89121306, 'precision': 0.766274, 'recall': 0.6415857, 'specificity': 0.9879404, 'f1': 0.6696604, 'auroc': 0.9793996}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   158     0   1    25    2    6   117    20    39   37     78
1     0  1161   0    16    0    0     0   137     7    1     10
2     3     2  20     8   58    5     4    47    57  102      6
3     0     1   0  7799    0   34     0   415   185    2      4
4     3     0   3     7  129    0    11    11   131   20    224
5     1     0   0   142    0  301     2     0    11   63      1
6    12     1   0    20    3    1  1639    26    42   16    148
7     0    46   0   304    1    0     4  6698   157    3     52
8     0     0   0   292    8    1     8   145  2750    8     84
9     2     0  12    62    6  102    11    25    40  230      3
10   12     2   1    13   13    1    61    40   218    2  12433
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4374169, 'precision': 0.479712, 'recall': 0.37715796, 'specificity': 0.94137716, 'f1': 0.352345, 'auroc': 0.78695375}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   117     0   0   17   1    1   919    7    63   28    17
1     0  1245   0   34   6    0    26   66    32    1    89
2     4     6   1   37  76    2   119   10   435   67   258
3     0     0   0    0   0    0     0    0     0    0     0
4     0     2   0    0  39    0     9    0    13    0  1570
5     5     0   0  184   0  152    46    0    18  186     1
6     1     2   0    1  40    0  1016    0   120    4  1883
7     6   227   5   38  17    0   337  428    84    1    21
8     8     0   0   40   2    8    60    0  1181   35    36
9    24    17   4  135  33   15   185    8   258  427    31
10    0     0   0    0   0    0     0    0     0    0  1646
better model found
persisted
after epoch: 5,now: 2024-08-12 04:35:50.763759,epoch time: 0:31:19.416317,used: 2:37:17.120750,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90520656, 'precision': 0.7874608, 'recall': 0.7018485, 'specificity': 0.9896709, 'f1': 0.7331261, 'auroc': 0.9843879}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   244     0   2    19    2    1    75    25    45    7     63
1     0  1172   0    14    0    0     0   125    10    0     11
2     9     2  78     7   67    3     3    24    45   73      1
3     0     0   0  7746    0   25     0   489   174    4      0
4     3     1  20     3  211    0    11    20   106   15    149
5     4     0   0   111    0  297     1     0    13   94      1
6    25     1   0    14    5    2  1728    25    35    7     66
7     1    33   2   189    2    0     3  6891   114    0     29
8     2     1   2   233    8    5     4   150  2836    1     52
9     9     1  34    54    5   71     8    15    37  258      1
10   19     3   0    13   52    0    69    52   210    2  12372
---- Validation: 
scalar performance:
{'acc': 0.90413266, 'precision': 0.78950065, 'recall': 0.70331407, 'specificity': 0.9895388, 'f1': 0.73489255, 'auroc': 0.9844}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   249     0   1    20    6    0    56    22    53   12     64
1     0  1172   4    17    3    0     0   122     7    0      7
2     5     1  83     6   68    0     8    33    41   64      3
3     0     1   0  7735    0   28     1   496   173    4      2
4     2     1  17     5  203    0    18    14   105   16    158
5     6     0   2   114    0  299     1     0    14   85      0
6    29     0   0    10    4    0  1735    28    31    8     63
7     0    40   3   193    2    0     2  6884   114    0     27
8     0     0   0   231   11    3     3   164  2821    5     58
9    18     1  29    56    4   67     4    15    35  261      3
10   16     2   0     9   51    0    75    59   220    5  12359
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52249354, 'precision': 0.52874637, 'recall': 0.4049722, 'specificity': 0.94966155, 'f1': 0.38565785, 'auroc': 0.8133445}
confusion matrix:
     0     1   2    3    4   5     6    7     8    9     10
0   191     0   0    8    1   0   936    3    23    1     7
1     1  1292   0   26    5   0    31   46    39    0    59
2    20     7  13   29  235   1   190   10   365   39   106
3     0     0   0    0    0   0     0    0     0    0     0
4     0     3   0    0  231   0    20    0    21    0  1358
5    15     0   0  164    0  94   110    0    19  189     1
6     2     3   1    1   98   0  2211    0   108    2   641
7     6   255   5   39   19   0   432  307    90    1    10
8    14     0   0   32   10   4   101    0  1173   20    16
9    71    22  28  102   58   7   283    5   229  321    11
10    0     1   0    0    9   0     1    0     0    0  1635
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 05:07:08.957102,epoch time: 0:31:18.193343,used: 3:08:35.314093,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.911494, 'precision': 0.8026079, 'recall': 0.7333222, 'specificity': 0.9901439, 'f1': 0.7626921, 'auroc': 0.9860791}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   286     0    4    18    2    0    42    22    18   13     78
1     0  1183    2    18    1    0     1   115     4    0      8
2     3     0  132     5   54    0     4    30    16   62      6
3     1     0    0  7874    0   44     1   404   108    3      2
4     2     0   26     7  218    0     4    22    65   21    174
5     4     0    2   102    0  323     0     0     6   83      1
6    50     0    2    15    2    0  1712    17    10    9     91
7     2    18    0   251    2    0     3  6893    60    0     34
8     2     0    2   304   20    5     9   183  2662   12     96
9     2     0   49    42    1   80     1    14    18  283      3
10   29     3    2     9   44    1    27    55   117    4  12502
---- Validation: 
scalar performance:
{'acc': 0.91071284, 'precision': 0.7993987, 'recall': 0.7324829, 'specificity': 0.99008787, 'f1': 0.76037514, 'auroc': 0.98587143}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   280     0    2    19    2    3    45    23    20   12     77
1     0  1181    0    21    1    0     0   113     5    1     10
2     6     1  125     5   48    0     2    31    18   69      7
3     0     0    0  7868    0   38     1   431    98    2      2
4     5     0   30     5  219    1     7    21    65   19    167
5     4     0    2    77    0  331     1     0     7   98      1
6    58     0    1    13    1    1  1706    22    16    7     83
7     0    33    1   243    2    0     2  6893    62    2     27
8     4     1    5   294   18    6     4   197  2651   10    106
9     7     0   43    40    0   73     5    11    18  292      4
10   22     2    1    12   52    1    32    51   119    3  12501
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50052476, 'precision': 0.54903466, 'recall': 0.3971824, 'specificity': 0.9474951, 'f1': 0.3915053, 'auroc': 0.80584276}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   277     0   1   15    1    0   852    1     4    4    15
1     0  1274   1   46    6    0    45   33    16    0    78
2    20     6  40   34  250    1   164    6   223   54   217
3     0     0   0    0    0    0     0    0     0    0     0
4     0     2   0    0  207    0    12    0     8    0  1404
5    12     0   0  123    0  105   113    0     6  231     2
6     2     1   1    1   61    0  1930    0    29    2  1040
7     5   119  19  197   15    0   554  189    47    3    16
8    17     0   4   44   14    5   108    0  1090   32    56
9    67    13  63  104   66    6   253    5   122  408    30
10    0     1   0    0   11    0     0    0     0    0  1634
better model found
persisted
after epoch: 7,now: 2024-08-12 05:38:07.155110,epoch time: 0:30:58.198008,used: 3:39:33.512101,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9167113, 'precision': 0.80824196, 'recall': 0.7549614, 'specificity': 0.9907566, 'f1': 0.7781045, 'auroc': 0.9881927}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   329     0    2    10    2    1    21    18    11   10     79
1     1  1207    0    16    1    0     0    85     7    0     15
2     8     2  143     4   53    0     1    21    15   63      2
3     1     0    0  7848    0   32     2   384   168    1      3
4     5     0   29     3  258    0     6    15    50   12    161
5     4     0    1    82    0  306     1     1    12  113      1
6    68     0    0    14    2    0  1686    15    14    5    103
7     1    26    4   252    2    0     5  6844    79    1     49
8     2     0    3   201   22    2     7   159  2791    9    100
9    15     0   50    35    3   59     3     7    17  300      4
10   35     1    2    11   58    1    19    33    79    1  12551
---- Validation: 
scalar performance:
{'acc': 0.9185502, 'precision': 0.8098967, 'recall': 0.7556092, 'specificity': 0.9909558, 'f1': 0.7789454, 'auroc': 0.9885185}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   320     0    0    12    0    0    30    13    15    6     87
1     0  1195    1    16    0    0     0    98     9    0     13
2     7     1  138     4   53    0     1    22    18   65      3
3     0     1    0  7874    0   40     2   373   145    4      1
4     5     0   29     2  254    0     6    10    46   17    170
5     5     0    2    67    0  316     0     0    13  117      1
6    64     0    1    10    3    0  1708    15    11    6     90
7     1    20    1   250    1    0     3  6851    80    1     57
8     7     1    3   194   25    2     3   152  2808    6     95
9     7     1   48    31    3   64     4     6    17  309      3
10   36     0    2     8   47    2    13    38    80    3  12567
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50360316, 'precision': 0.5489551, 'recall': 0.40073645, 'specificity': 0.94798386, 'f1': 0.3886024, 'auroc': 0.8062467}
confusion matrix:
     0     1   2    3    4   5     6    7     8    9     10
0   457     0   0   12    1   0   668    0     8    2    22
1     0  1277   0   32    5   0    49   20    26    0    90
2    37     4  38   21  232   1   116    2   194   48   322
3     0     0   0    0    0   0     0    0     0    0     0
4     0     0   0    0  204   0     7    0     6    0  1416
5    32     0   0  101    0  88   103    0    13  252     3
6    10     0   1    1   28   0  1894    0    16    2  1115
7     9   141  16  176   15   0   569  125    92    1    20
8    21     0   1   18   11   3    91    0  1098   30    97
9   138    10  66   62   61   4   217    2   149  378    50
10    0     0   0    0    7   0     0    0     0    0  1639
better model found
persisted
after epoch: 8,now: 2024-08-12 06:09:05.335339,epoch time: 0:30:58.180229,used: 4:10:31.692330,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92238337, 'precision': 0.8103074, 'recall': 0.77886546, 'specificity': 0.9915291, 'f1': 0.79312706, 'auroc': 0.9904016}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   328     0    3    11    2    0    42    15     9   11     62
1     0  1205    1    17    0    0     0    94     5    0     10
2     6     1  182     2   43    0     2     9     9   55      3
3     1     1    0  7867    0   43     3   351   163    8      2
4     2     0   36     2  275    1     9     9    45   12    148
5     4     0    2    65    0  332     1     1     9  106      1
6    32     0    2    14    3    1  1787    14     9    3     43
7     0    38   11   226    6    0     2  6854    86    2     37
8     1     1    8   166   37    4    11   138  2833   17     80
9     7     0   64    28    1   67     7    10    10  297      2
10   27     2    6    12   77    0    35    39    76    2  12515
---- Validation: 
scalar performance:
{'acc': 0.92301726, 'precision': 0.81320274, 'recall': 0.7820583, 'specificity': 0.9916022, 'f1': 0.79638743, 'auroc': 0.9900877}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   336     0    2     8    1    0    37    23    10    8     58
1     0  1210    2    20    1    0     0    90     3    0      6
2     4     1  173     4   46    0     1    14     6   62      1
3     0     1    0  7869    0   38     1   357   164    9      1
4     3     0   30     2  291    1    11    12    40   15    134
5     3     0    4    63    1  334     0     0     8  107      1
6    36     0    1     9    1    1  1782    10    10    4     54
7     1    25    7   232    5    0     5  6854    93    2     41
8     2     1   12   171   35    3    11   145  2836    7     73
9     2     2   64    24    2   74     2     7    12  303      1
10   30     2    4    10   76    0    31    36    84    4  12519
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52928007, 'precision': 0.5802198, 'recall': 0.4174822, 'specificity': 0.9510367, 'f1': 0.41449136, 'auroc': 0.8183052}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   294     0   1   24    1    0   814    1     9    3    23
1     0  1307   4   47    5    0    29   17    16    0    74
2     6     3  62   32  286    2   123    2   181   56   262
3     0     0   0    0    0    0     0    0     0    0     0
4     0     2   0    0  252    0     9    0     7    0  1363
5     8     0   0  149    0  149    77    0    10  196     3
6     1     0   0    1   40    0  2207    0    14    2   802
7     2   158  35  387   11    0   351  115    79    5    21
8     3     0   3   51   19    5    68    0  1119   26    76
9    33    14  98  119   67   13   195    2   123  424    49
10    0     0   0    0   10    0     0    0     0    0  1636
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 06:40:24.130874,epoch time: 0:31:18.795535,used: 4:41:50.487865,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.92650366, 'precision': 0.8382225, 'recall': 0.7743362, 'specificity': 0.99180245, 'f1': 0.8019501, 'auroc': 0.99092937}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   343     0    0    13    0    1    28    14     7    5     71
1     0  1192    2    23    1    0     0   103     3    0      7
2     6     2  158     3   47    0     3    15    16   58      4
3     2     0    0  8075    0   35     0   199   123    4      0
4     1     0   26     3  257    1     4    15    49   15    168
5     2     0    0    66    0  339     0     0    10  102      2
6    24     0    0    14    3    1  1764    13    11    4     73
7     1    27    1   354    2    0     3  6776    79    3     19
8     0     0    3   235   16    3     5   118  2832    3     81
9     9     1   42    28    0   74     1     8    15  305     10
10   17     1    3    19   33    0    26    45    59    1  12588
---- Validation: 
scalar performance:
{'acc': 0.9274575, 'precision': 0.8373355, 'recall': 0.77408576, 'specificity': 0.99190295, 'f1': 0.8013107, 'auroc': 0.99094063}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   347     0    0    15    0    0    26    16     8    7     64
1     0  1198    0    26    1    0     0    93     4    0     10
2     6     1  153     6   44    1     3    22     9   61      6
3     0     0    0  8079    0   27     0   211   120    2      1
4     1     0   31     3  239    1     4    17    53   11    179
5     3     0    3    67    0  349     1     0     9   88      1
6    28     0    2    17    0    0  1773    13    16    3     56
7     0    15    3   353    3    0     1  6789    69    1     31
8     1     1    4   214   17    5     5   119  2847    5     78
9     7     0   49    28    0   77     3     5    13  308      3
10   15     1    1    16   36    1    19    44    72    0  12591
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48464283, 'precision': 0.57756424, 'recall': 0.3997695, 'specificity': 0.94756746, 'f1': 0.3926675, 'auroc': 0.80349404}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   417     0   0   66    0    0   584    0    46    1    56
1     0  1287   1   68    1    0    15   34    24    0    69
2     9     5  25   47  112    5    39    2   369   38   364
3     0     0   0    0    0    0     0    0     0    0     0
4     0     2   0    0  108    0     4    0    17    0  1502
5    22     0   0  235    0  171    40    0    24   90    10
6     4     0   1    2   14    0  1608    0    68    2  1368
7     2   106   4  619    4    0   160  160    92    6    11
8     1     0   0   68    6    2    14    0  1224    6    49
9    70    18  33  244   25   19    87    2   267  283    89
10    0     0   0    0    2    0     0    0     0    0  1644
better model found
persisted
after epoch: 10,now: 2024-08-12 07:11:45.960802,epoch time: 0:31:21.829928,used: 5:13:12.317793,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:13:12.317793 at 2024-08-12 07:11:45.960802
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48464283, 'precision': 0.57756424, 'recall': 0.3997695, 'specificity': 0.94756746, 'f1': 0.3926675, 'auroc': 0.80349404}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   417     0   0   66    0    0   584    0    46    1    56
1     0  1287   1   68    1    0    15   34    24    0    69
2     9     5  25   47  112    5    39    2   369   38   364
3     0     0   0    0    0    0     0    0     0    0     0
4     0     2   0    0  108    0     4    0    17    0  1502
5    22     0   0  235    0  171    40    0    24   90    10
6     4     0   1    2   14    0  1608    0    68    2  1368
7     2   106   4  619    4    0   160  160    92    6    11
8     1     0   0   68    6    2    14    0  1224    6    49
9    70    18  33  244   25   19    87    2   267  283    89
10    0     0   0    0    2    0     0    0     0    0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52928007, 'precision': 0.5802198, 'recall': 0.4174822, 'specificity': 0.9510367, 'f1': 0.41449136, 'auroc': 0.8183052}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   294     0   1   24    1    0   814    1     9    3    23
1     0  1307   4   47    5    0    29   17    16    0    74
2     6     3  62   32  286    2   123    2   181   56   262
3     0     0   0    0    0    0     0    0     0    0     0
4     0     2   0    0  252    0     9    0     7    0  1363
5     8     0   0  149    0  149    77    0    10  196     3
6     1     0   0    1   40    0  2207    0    14    2   802
7     2   158  35  387   11    0   351  115    79    5    21
8     3     0   3   51   19    5    68    0  1119   26    76
9    33    14  98  119   67   13   195    2   123  424    49
10    0     0   0    0   10    0     0    0     0    0  1636
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_58_33_seed_0_24142423_instance_wise_predictions.txt
accuracy from prediction file 0.48464283215560067
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/22.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/22.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/22.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    971 MiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |    839 MiB |  11810 MiB | 343488 GiB | 343487 GiB |
|       from small pool |    131 MiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    971 MiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |    839 MiB |  11810 MiB | 343488 GiB | 343487 GiB |
|       from small pool |    131 MiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    949 MiB |  11839 MiB | 343106 GiB | 343106 GiB |
|       from large pool |    817 MiB |  11761 MiB | 342319 GiB | 342318 GiB |
|       from small pool |    131 MiB |    212 MiB |    787 GiB |    787 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  12192 MiB |  12192 MiB |  12192 MiB |      0 B   |
|       from large pool |  11978 MiB |  11978 MiB |  11978 MiB |      0 B   |
|       from small pool |    214 MiB |    214 MiB |    214 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1532 MiB |   1793 MiB | 178413 GiB | 178411 GiB |
|       from large pool |   1522 MiB |   1788 MiB | 177595 GiB | 177593 GiB |
|       from small pool |     10 MiB |     14 MiB |    818 GiB |    818 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3767    |    6154    |   28180 K  |   28176 K  |
|       from large pool |     125    |     528    |   12055 K  |   12055 K  |
|       from small pool |    3642    |    5956    |   16124 K  |   16120 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3767    |    6154    |   28180 K  |   28176 K  |
|       from large pool |     125    |     528    |   12055 K  |   12055 K  |
|       from small pool |    3642    |    5956    |   16124 K  |   16120 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     301    |     301    |     301    |       0    |
|       from large pool |     194    |     194    |     194    |       0    |
|       from small pool |     107    |     107    |     107    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    1046    |   14694 K  |   14694 K  |
|       from large pool |      18    |      95    |    6534 K  |    6534 K  |
|       from small pool |      34    |    1027    |    8159 K  |    8159 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |  16640 KiB |  11810 MiB | 343488 GiB | 343488 GiB |
|       from small pool |      0 KiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |  16640 KiB |  11810 MiB | 343488 GiB | 343488 GiB |
|       from small pool |      0 KiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  11839 MiB | 343106 GiB | 343106 GiB |
|       from large pool |  16640 KiB |  11761 MiB | 342319 GiB | 342319 GiB |
|       from small pool |      0 KiB |    212 MiB |    787 GiB |    787 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2504 MiB |  12192 MiB |  12192 MiB |   9688 MiB |
|       from large pool |   2362 MiB |  11978 MiB |  11978 MiB |   9616 MiB |
|       from small pool |    142 MiB |    214 MiB |    214 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   1793 MiB | 178413 GiB | 178413 GiB |
|       from large pool | 405248 KiB |   1788 MiB | 177595 GiB | 177595 GiB |
|       from small pool |      0 KiB |     36 MiB |    818 GiB |    818 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6154    |   28180 K  |   28180 K  |
|       from large pool |       2    |     528    |   12055 K  |   12055 K  |
|       from small pool |       0    |    5956    |   16124 K  |   16124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6154    |   28180 K  |   28180 K  |
|       from large pool |       2    |     528    |   12055 K  |   12055 K  |
|       from small pool |       0    |    5956    |   16124 K  |   16124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     301    |     301    |     189    |
|       from large pool |      41    |     194    |     194    |     153    |
|       from small pool |      71    |     107    |     107    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1046    |   14695 K  |   14695 K  |
|       from large pool |       4    |      95    |    6534 K  |    6534 K  |
|       from small pool |       0    |    1027    |    8160 K  |    8160 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |  16640 KiB |  11810 MiB | 343488 GiB | 343488 GiB |
|       from small pool |      0 KiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |  16640 KiB |  11810 MiB | 343488 GiB | 343488 GiB |
|       from small pool |      0 KiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  11839 MiB | 343106 GiB | 343106 GiB |
|       from large pool |  16640 KiB |  11761 MiB | 342319 GiB | 342319 GiB |
|       from small pool |      0 KiB |    212 MiB |    787 GiB |    787 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2504 MiB |  12192 MiB |  12192 MiB |   9688 MiB |
|       from large pool |   2362 MiB |  11978 MiB |  11978 MiB |   9616 MiB |
|       from small pool |    142 MiB |    214 MiB |    214 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   1793 MiB | 178413 GiB | 178413 GiB |
|       from large pool | 405248 KiB |   1788 MiB | 177595 GiB | 177595 GiB |
|       from small pool |      0 KiB |     36 MiB |    818 GiB |    818 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6154    |   28180 K  |   28180 K  |
|       from large pool |       2    |     528    |   12055 K  |   12055 K  |
|       from small pool |       0    |    5956    |   16124 K  |   16124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6154    |   28180 K  |   28180 K  |
|       from large pool |       2    |     528    |   12055 K  |   12055 K  |
|       from small pool |       0    |    5956    |   16124 K  |   16124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     301    |     301    |     189    |
|       from large pool |      41    |     194    |     194    |     153    |
|       from small pool |      71    |     107    |     107    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1046    |   14695 K  |   14695 K  |
|       from large pool |       4    |      95    |    6534 K  |    6534 K  |
|       from small pool |       0    |    1027    |    8160 K  |    8160 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423

 Experiment start at: 2024-08-12 07:27:03.751615
before training, model accuracy: 0.06254810094833374
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7006635, 'precision': 0.38910317, 'recall': 0.26579052, 'specificity': 0.9635738, 'f1': 0.25478387, 'auroc': 0.8956556}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   0   0    78   0   3   68   104   16   0    214
1    0  47   0    42   0   0    1   939    0   0    302
2    0   0   0    75   0   1   20    98   29   0     89
3    0   0   0  7695   0   0    6   643   21   0     74
4    0   0   0    52   0   2   19    56   19   0    391
5    0   0   0   466   0   4   11    12   13   0     15
6    0   0   0   147   0   3  332   124  104   0   1198
7    0   0   0  1623   0   0    1  5352   11   0    277
8    0   0   0  1462   0   3   57   639  269   0    866
9    0   0   0   307   0   7   31    81   38   0     29
10   0   1   0    93   0   0   41   131   35   0  12489
---- Validation: 
scalar performance:
{'acc': 0.69979936, 'precision': 0.38276786, 'recall': 0.26527923, 'specificity': 0.9634715, 'f1': 0.25389618, 'auroc': 0.89652497}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   0   0    68   0   2   69   105   26   0    213
1    0  41   0    38   0   0    0   928    0   0    325
2    0   0   0    85   0   0   27    89   20   0     91
3    0   0   0  7663   0   0    4   665   23   0     85
4    0   0   0    63   0   0   18    61   13   0    384
5    0   0   0   465   0   1   10    22   13   0     10
6    0   0   0   160   0   6  348   136  101   0   1157
7    0   0   0  1628   0   0    3  5343    5   0    286
8    0   0   0  1471   0   4   49   639  275   0    858
9    0   0   0   305   0   7   31    76   39   0     35
10   0   0   0    79   0   1   38   162   25   0  12491
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18736444, 'precision': 0.16812932, 'recall': 0.167042, 'specificity': 0.9166541, 'f1': 0.09607336, 'auroc': 0.65689695}
confusion matrix:
    0   1   2    3   4   5    6    7   8   9     10
0    0   0   0   34   0  50  599   49  55   0   383
1    0  55   0   40   0   1   10  637   1   0   755
2    0   0   0   66   0  13   68   41  10   0   817
3    0   0   0    0   0   0    0    0   0   0     0
4    0   0   0    0   0   0    6    1   1   0  1625
5    0   0   0  334   0  34   39   82  17   1    85
6    0   1   0    2   0   6  119    3   0   0  2936
7    0  11   0   31   0   5   39  797   6   0   275
8    0   1   0   78   0  56  177   96  28   0   934
9    0   2   0  245   0  32   88  164  24   0   582
10   0   0   0    0   0   0    1    0   0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 07:59:44.597337,epoch time: 0:32:40.845722,used: 0:32:40.845722,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.820366, 'precision': 0.42547113, 'recall': 0.43956012, 'specificity': 0.97969306, 'f1': 0.43096635, 'auroc': 0.9460817}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    22   0   0   243    27   114   0     77
1    0  1072   0    13   0   0     0   207     5   0     33
2    0     0   0    16   0   0    71    44   157   0     24
3    0     2   0  7663   0   0     7   534   218   0     14
4    0     3   0    14   0   0   105    28   112   0    277
5    0     0   0   360   0   0    40     2   117   0      1
6    0     2   0    42   0   0  1286    48   221   0    308
7    0    12   0   696   0   0    12  6307   120   0    118
8    0     0   0   572   0   0   158   257  2034   0    275
9    0     0   0   149   0   1    97    23   218   0      4
10   0    11   0    22   0   0   249    68   144   0  12300
---- Validation: 
scalar performance:
{'acc': 0.8192056, 'precision': 0.6058631, 'recall': 0.43962035, 'specificity': 0.97956145, 'f1': 0.4309197, 'auroc': 0.94526815}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    28   0   0   253    21   114   0     67
1    0  1078   0    19   0   0     2   195     7   0     31
2    0     1   0    25   0   0    69    47   143   0     27
3    0     1   0  7692   0   0     6   513   217   0     11
4    0     0   0    10   0   0    99    27   111   0    292
5    0     0   0   355   0   1    41     2   119   0      3
6    0     3   0    31   0   0  1287    47   226   0    314
7    0    23   0   703   0   0    10  6277   133   0    119
8    0     0   0   578   0   0   146   281  2024   0    267
9    0     0   0   172   0   0    95    24   198   1      3
10   0    16   0    23   0   0   264    75   152   0  12266
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4162177, 'precision': 0.2881638, 'recall': 0.28902647, 'specificity': 0.9368814, 'f1': 0.24437183, 'auroc': 0.73462975}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     1   0    4   0   0   977    1  185   0     2
1    0  1026   0   29   0   0   144   76   29   0   195
2    0     3   0   18   0   0   672    1  109   0   212
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0   191    0    0   0  1442
5    0     0   0  168   0   2   156    0  261   0     5
6    0     0   0    0   0   0  2400    0    3   0   664
7    0   107   0   16   0   0   357  522  112   0    50
8    0     0   0   19   0   2   871    0  376   0   102
9    0     7   0   88   0   1   586    4  357   0    94
10   0     0   0    0   0   0    23    0    0   0  1623
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 08:30:50.991043,epoch time: 0:31:06.393706,used: 1:03:47.239428,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.837302, 'precision': 0.56861603, 'recall': 0.45982045, 'specificity': 0.98161566, 'f1': 0.46109337, 'auroc': 0.96041334}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    1    0   1    54   0   2   201    26   127   7     64
1    0  983   0    57   0   0     0   275     4   0     13
2    2    0   0    27   0   0    49    70   135   6     23
3    0    0   0  7971   0   0     0   314   148   0      5
4    0    0   0    23   0   0    67    27   154   1    267
5    0    0   0   431   0   6    11     0    59  13      1
6    0    1   0    70   0   0  1391    35   220   0    191
7    0   13   0   813   0   0     1  6276    99   0     61
8    0    0   0   553   0   0    19   184  2432   0    107
9    0    1   0   219   0   6    61    24   140  38      4
10   0    6   0    68   0   0   156   119   246   0  12197
---- Validation: 
scalar performance:
{'acc': 0.835977, 'precision': 0.5553488, 'recall': 0.45766854, 'specificity': 0.9814932, 'f1': 0.4579475, 'auroc': 0.960283}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    44   0   1   217    31   128   7     55
1    0  996   0    48   0   0     0   267     3   0     18
2    0    2   0    33   0   0    47    60   142   1     27
3    0    0   0  7982   0   0     0   298   150   0     10
4    0    1   0    17   0   0    66    28   157   1    269
5    0    0   0   417   0   9    17     1    60  16      1
6    0    1   0    72   0   0  1368    38   217   2    210
7    0   13   0   815   0   0     3  6278   109   0     47
8    0    0   0   592   0   0    21   187  2395   0    101
9    0    1   1   222   0   3    60    25   149  31      1
10   0    6   0    58   0   0   169   108   261   0  12194
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4507801, 'precision': 0.31858873, 'recall': 0.3418054, 'specificity': 0.94317585, 'f1': 0.28755596, 'auroc': 0.7804132}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    1     2   0   18   0   0   820    3  321   1     4
1    0  1155   1   43   0   0    34  115   41   0   110
2    1     3   0   88   0   0   271   11  311   0   330
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    1   0   0    56    0   10   0  1566
5    1     0   0  387   0   0    34    0  158   8     4
6    0     1   0    1   0   0  1900    0   40   0  1125
7    1    73   0   70   0   0    99  752  131   0    38
8    1     0   0   89   0   0   197    0  982   5    96
9    2    10   0  343   0   1   181    5  504   7    84
10   0     0   0    0   0   0     0    0    0   0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 09:01:50.683691,epoch time: 0:30:59.692648,used: 1:34:46.932076,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87371576, 'precision': 0.7116823, 'recall': 0.55506027, 'specificity': 0.9859052, 'f1': 0.5611746, 'auroc': 0.9757024}
confusion matrix:
    0     1   2     3   4   5     6     7     8    9      10
0   56     0   2    13   0   0   239    24    42   44     63
1    0  1114   0    14   0   0     0   174    12    0     16
2   29     0   7    11   1   0    45    51    75   47     46
3    0     0   0  7771   0   5     2   375   277    7      2
4   10     0   1     4   1   2    56    19   107   15    324
5    0     0   0   240   0  78    13     2    19  168      1
6    5     0   0    16   0   1  1651    23    46   20    145
7    0    22   0   466   0   0     7  6576   122    1     70
8    2     0   0   281   0   1    31   145  2722    9    104
9    8     1   3    80   0  20    45    18    69  240      8
10  11     2   0     8   0   0   132    56   141    4  12440
---- Validation: 
scalar performance:
{'acc': 0.87385315, 'precision': 0.6679453, 'recall': 0.5550815, 'specificity': 0.98589075, 'f1': 0.56043994, 'auroc': 0.97515124}
confusion matrix:
    0     1   2     3   4   5     6     7     8    9      10
0   71     0   0    15   0   0   200    25    44   48     80
1    0  1098   0    18   0   0     1   188    12    0     15
2   21     1   6    10   0   2    41    50    73   53     55
3    0     0   0  7814   0   4     4   367   242    4      5
4   16     1   1     5   0   1    63    22   101    8    321
5    0     0   0   253   0  58    13     0    24  171      2
6    4     0   2    21   0   1  1658    19    45   18    140
7    0    32   0   453   0   0     8  6587   131    0     54
8    0     1   0   281   0   0    32   144  2714    8    116
9    4     1   4    76   0  14    50    19    66  251      8
10  12     4   0    16   0   0   134    54   161    3  12412
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44791156, 'precision': 0.4397694, 'recall': 0.34396753, 'specificity': 0.942451, 'f1': 0.30897862, 'auroc': 0.80957866}
confusion matrix:
     0     1   2    3   4   5     6    7    8    9     10
0   107     0   0    6   0   0   888    0  137   21    11
1     3  1186   1   33   0   0    50   59   60    2   105
2    45     2   2   33   0   0   243    3  238   41   408
3     0     0   0    0   0   0     0    0    0    0     0
4     1     0   0    0   0   0    27    0    6    0  1599
5     9     0   0  172   0   5    25    0   99  278     4
6     0     1   0    0   0   0  1810    0   22    0  1234
7    18   110   0   67   0   0   196  516  212    4    41
8    65     0   0   31   0   1   159    0  914   40   160
9   117     9   1  150   0   2   183    1  356  216   102
10    0     0   0    0   0   0     0    0    0    0  1646
better model found
persisted
after epoch: 4,now: 2024-08-12 09:32:51.327134,epoch time: 0:31:00.643443,used: 2:05:47.575519,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8897421, 'precision': 0.77774334, 'recall': 0.6153101, 'specificity': 0.98745394, 'f1': 0.6344739, 'auroc': 0.9812366}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   199     0   0    12   0    0    87    31    15   39    100
1     0  1168   0    17   0    0     1   127     7    0     12
2    30     3  23     8   3    2     9    58    49   54     73
3     0     0   0  7727   0   17     4   488   193    3      4
4    19     0   4     2   7    0    17    13    78   16    383
5     0     0   0   176   0  143     3     0    20  177      2
6    20     1   0    28   0    1  1638    19    39   17    143
7     0    31   0   295   0    0     3  6760   110    0     63
8     2     1   1   262   0    4    20   159  2737    6    104
9    17     1  10    55   0   28     9    25    41  296     11
10   15     3   0    10   0    0    41    65   101    4  12557
---- Validation: 
scalar performance:
{'acc': 0.8891801, 'precision': 0.8049232, 'recall': 0.6098772, 'specificity': 0.9874226, 'f1': 0.6264458, 'auroc': 0.98140526}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   193     0   0    16   0    1   101    20    22   37     93
1     0  1157   0    16   0    0     0   133    11    0     15
2    27     2  21     7   0    0     6    63    44   71     71
3     0     1   0  7722   0   15     0   486   201    8      7
4    18     1   3     3   2    1    17    21    74   13    386
5     2     0   0   175   0  135     1     1    18  188      1
6    21     2   0    16   0    1  1647    19    42   21    139
7     0    32   0   298   0    0     2  6798    89    1     45
8     1     2   0   281   0    0    16   139  2736    6    115
9    21     0   8    57   0   28    10    19    50  289     11
10   20     4   0    10   0    1    58    54   104    3  12542
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43384874, 'precision': 0.4296142, 'recall': 0.35787252, 'specificity': 0.94186103, 'f1': 0.3369758, 'auroc': 0.81141645}
confusion matrix:
     0     1   2    3   4   5     6    7    8    9     10
0   345     1   0   15   0   0   662    1   87   32    27
1     1  1260   2   34   0   0    20   54   49    0    79
2    73     4   0   42   2   0    68    3  169   53   601
3     0     0   0    0   0   0     0    0    0    0     0
4     1     0   0    0   0   0     5    0    4    0  1623
5    17     0   0  236   0  39     6    0   29  261     4
6     9     1   0    0   2   0  1234    0   22    0  1799
7    14   183   1   97   2   1   135  530  161    2    38
8   100     0   0   59   0   4    47    0  877   41   242
9   182    16   1  202   0   9    54    3  222  270   178
10    0     0   0    0   0   0     0    0    0    0  1646
better model found
persisted
after epoch: 5,now: 2024-08-12 10:04:13.134887,epoch time: 0:31:21.807753,used: 2:37:09.383272,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90143406, 'precision': 0.8019664, 'recall': 0.6584568, 'specificity': 0.9887799, 'f1': 0.68233395, 'auroc': 0.9849256}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   284     0   0    10   0    0    48    24    10   29     78
1     0  1137   0    19   0    0     2   156     5    0     13
2    20     0  38     6   7    0     8    81    20   87     45
3     0     1   0  7948   0   18     0   332   133    5      3
4    16     1  13     1  43    2    11    31    46   20    355
5     3     0   1   140   0  204     3     1    10  158      1
6    32     0   0    12   0    3  1732    20    22   13     74
7     0    11   1   364   0    0     5  6789    51    1     40
8     5     0   1   312   0    3    22   211  2613    6    122
9     6     2  12    44   0   54     5    34    15  319      2
10   40     1   0    13   2    1    42    58    45    4  12585
---- Validation: 
scalar performance:
{'acc': 0.8996924, 'precision': 0.80126595, 'recall': 0.6610759, 'specificity': 0.98854345, 'f1': 0.68418515, 'auroc': 0.98522717}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   292     0   0    11   0    0    42    27    10   27     74
1     0  1129   0    19   0    0     0   162     8    0     14
2    25     0  36     9   5    0     4    70    20   89     54
3     0     0   0  7930   0   23     1   348   130    3      5
4    23     0   5     5  39    1    13    31    48   20    354
5     3     0   1   126   0  231     2     2     8  147      1
6    33     0   1    15   0    2  1706    22    22   16     91
7     0    10   1   359   1    0     2  6799    47    1     45
8     2     0   2   309   2    3    22   229  2583    4    140
9    17     1  15    45   0   42     6    25     9  322     11
10   41     0   2    13   2    0    50    58    57    5  12568
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50241375, 'precision': 0.49433723, 'recall': 0.39938837, 'specificity': 0.94884884, 'f1': 0.3854912, 'auroc': 0.8245035}
confusion matrix:
     0     1   2    3   4   5     6    7    8    9     10
0   452     0   0   16   0   0   609    0   63   13    17
1     1  1187   5   38   0   0    47  100   40    2    79
2   113     1   2   29  12   0    97    5  156   53   547
3     0     0   0    0   0   0     0    0    0    0     0
4     1     0   0    0  10   0    12    0    5    0  1605
5    32     0   0  216   0  69     7    0    8  257     3
6    12     0   1    1   5   0  2027    0   12    0  1009
7    15    54   9  145   0   2   210  610  103    2    14
8   108     0   0   60   1  10    47    1  873   36   234
9   275     8  19  172   2   9    44    5  154  305   144
10    0     0   0    0   0   0     0    0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 10:35:33.839908,epoch time: 0:31:20.705021,used: 3:08:30.088293,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9111729, 'precision': 0.8070415, 'recall': 0.7117059, 'specificity': 0.99010444, 'f1': 0.7401657, 'auroc': 0.98741466}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   296     0    2    11    0    0    51    20    16   20     67
1     0  1194    0    20    0    0     0   106     6    0      6
2    11     3  106     6   18    2     7    41    28   72     18
3     0     1    0  7987    0   29     0   280   138    2      1
4    16     0   39     4  113    4    10    20    70   11    252
5     1     0    1   117    0  302     2     2     7   87      2
6    20     0    0    20    0    4  1750    12    31   10     61
7     0    20    1   389    1    1     4  6731    99    0     17
8     1     1    6   286    1    7    10   105  2815    1     62
9    10     0   32    38    0   96     5    15    14  281      2
10   32     5    8    31    8    2    56    62   105    2  12481
---- Validation: 
scalar performance:
{'acc': 0.91247827, 'precision': 0.81303304, 'recall': 0.71376216, 'specificity': 0.99022806, 'f1': 0.74312055, 'auroc': 0.9881376}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   295     0   3     8    0    1    53    22    20   24     57
1     0  1191   0    23    0    0     0   103     8    0      7
2    13     3  93     7   21    1     5    38    33   71     27
3     0     0   0  7990    0   27     0   287   134    1      1
4    13     0  29     3  114    4    15    21    81   15    244
5     1     0   0   108    0  333     0     1     8   70      0
6    15     2   0    23    0    2  1760    11    23    9     63
7     1    15   1   375    0    1     2  6756    95    0     19
8     1     1   3   316    0    8     8   101  2793    2     63
9     3     1  36    40    1   93     3    11    16  283      6
10   37     2   6    26    6    0    53    57    98    6  12505
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4905898, 'precision': 0.5125731, 'recall': 0.3940394, 'specificity': 0.94776547, 'f1': 0.37449598, 'auroc': 0.8259014}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   303     0   0   22   0    0   652    0   168    6    19
1     0  1289   2   38   1    0    28   26    70    1    44
2    62     1  23   36  44    5    68    2   338   34   402
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    0  29    0     6    0    16    0  1582
5    26     0   0  250   0  166    12    0    21  115     2
6     8     0   1    1  16    0  1911    0    42    0  1088
7     2   181   6  257   0    0   212  278   218    1     9
8    26     0   2   60   1   11    29    0  1133   12    96
9   178    10  61  164   9   29    56    0   335  234    61
10    0     0   0    0   0    0     0    0     0    0  1646
better model found
persisted
after epoch: 7,now: 2024-08-12 11:06:56.364553,epoch time: 0:31:22.524645,used: 3:39:52.612938,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.91863763, 'precision': 0.81219685, 'recall': 0.74855864, 'specificity': 0.9908914, 'f1': 0.77325726, 'auroc': 0.9890239}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   339     0    3     5    0    0    17    20     7   11     81
1     0  1208    0    13    0    1     0    95     7    0      8
2    12     5  141     4   33    4     2    30    10   46     25
3     0     0    1  7839    1   32     0   366   198    1      0
4     7     0   34     3  188    2     6    10    44   13    232
5     4     0    1    82    0  334     0     1     7   91      1
6    53     0    1    14    1    2  1704    14    22    6     91
7     1    25    7   238    2    0     0  6828   109    2     51
8     3     1    9   201    7    7     5   106  2858    0     99
9    10     0   45    22    0  105     3    10    12  280      6
10   32     2    7    10   27    1    12    35    48    1  12616
---- Validation: 
scalar performance:
{'acc': 0.91932595, 'precision': 0.8084076, 'recall': 0.74811655, 'specificity': 0.99096364, 'f1': 0.77223986, 'auroc': 0.98969096}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   334     0    2     7    0    2    21    18     6    8     85
1     0  1202    1    16    0    0     0    98     5    0     10
2    14     2  127     3   47    2     1    28    17   57     14
3     0     0    0  7875    0   40     0   343   177    4      1
4     8     0   29     0  193    3     6    17    37   13    233
5     4     0    2    70    0  349     0     1     5   89      1
6    63     0    1     9    2    0  1680    14    27    7    105
7     0    15    5   238    1    0     1  6856    97    2     50
8     2     1    5   197    9    7     5   117  2844    2    107
9    11     2   46    16    1   92     2     9    16  293      5
10   32     1    5    13   35    0    12    24    58    0  12616
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46463305, 'precision': 0.5106137, 'recall': 0.40381444, 'specificity': 0.94539905, 'f1': 0.39743263, 'auroc': 0.82339245}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   545     0    3   10    0    0   375    0   150    3    84
1     0  1305    6   34    1    0    14   31    37    1    70
2    37     2   49   19  163    6    11    5   187   28   508
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    0   82    0     2    0     3    0  1546
5    42     0    2  186    0  173     2    0    32  150     5
6     6     0    2    0  112    1  1108    0    21    0  1817
7     5   189   19  255    3    1   132  434   103    1    22
8    15     0    6   38   11   18     5    0  1085   10   182
9   181    14  197   94   34   31    19    4   224  216   123
10    0     0    0    0    2    0     0    0     0    0  1644
better model found
persisted
after epoch: 8,now: 2024-08-12 11:39:43.102769,epoch time: 0:32:46.738216,used: 4:12:39.351154,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92010915, 'precision': 0.8170868, 'recall': 0.7571816, 'specificity': 0.991066, 'f1': 0.78167444, 'auroc': 0.99070257}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   354     0    4     9    1    0    17    11     4    6     77
1     0  1177    0    17    0    0     0   108     8    0     22
2     9     4  147     5   38    2     2    32    17   46     10
3     1     0    1  7958    0   26     1   272   179    1      0
4    12     1   32     1  220    1     2    12    47    9    202
5     3     0    6    73    0  339     0     0     6   91      3
6    63     0    1    10    0    2  1688     7    33    5     99
7     0    22    8   300    2    0     1  6803    88    2     38
8     6     1    5   219    8    3     2   123  2826    3    100
9    15     1   61    23    0   79     2    12    10  284      6
10   34     1    4    13   29    2    16    30    66    0  12594
---- Validation: 
scalar performance:
{'acc': 0.9221345, 'precision': 0.81982946, 'recall': 0.75907606, 'specificity': 0.99126995, 'f1': 0.7844827, 'auroc': 0.990569}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   353     0    1     9    0    0    16    16    13    6     69
1     0  1180    1    19    0    0     0   103     6    0     23
2    11     1  156     3   38    2     1    31    17   40     12
3     0     0    0  7989    0   29     2   271   143    5      1
4    10     0   34     0  211    1     3    16    43    7    214
5     4     0    1    70    0  337     0     2    11   94      2
6    45     0    1    14    1    2  1694    13    30    5    103
7     1    25    4   274    1    1     1  6822    92    1     43
8     3     0    5   210   11    3     3   114  2850    0     97
9    15     1   59    27    1   85     1     5    14  282      3
10   32     1    5    18   41    1    16    27    54    1  12600
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.462744, 'precision': 0.5421916, 'recall': 0.38946715, 'specificity': 0.9453778, 'f1': 0.38283944, 'auroc': 0.82246643}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   457     0    2   28    0    0   443    0   160    3    77
1     0  1271    4   40    1    0     9   32    53    1    88
2    21     0   27   34   81    3    13    1   316   26   493
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    0  116    0     2    0     6    0  1509
5    20     0    1  255    0  145     4    0    41  123     3
6     4     0    2    1   79    0  1298    0    34    0  1649
7     2   121   12  361    1    0   130  314   203    0    20
8     7     0    3   60    4    7     8    0  1137    7   137
9    86    13  120  182   14   20    16    0   367  209   110
10    0     0    0    0    6    0     0    0     0    0  1640
better model found
persisted
after epoch: 9,now: 2024-08-12 12:12:45.436373,epoch time: 0:33:02.333604,used: 4:45:41.684758,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9268782, 'precision': 0.83201694, 'recall': 0.77451104, 'specificity': 0.9918635, 'f1': 0.79758215, 'auroc': 0.9913495}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   360     0    2     5    0    1    11    19     9    5     71
1     0  1235    0    19    0    0     0    68     4    0      5
2    13     2  175     4   36    1     0    24    20   32      5
3     0     0    0  8032    0   16     1   267   122    0      0
4     7     1   40     3  224    2     3    16    45    6    192
5     4     0    3    76    0  337     1     0    10   89      1
6    70     0    0    23    2    1  1706    11    24    4     67
7     0    38    5   291    2    0     1  6837    69    1     20
8     2     1    4   235    9    1     3   111  2861    2     65
9    14     1   66    28    1   75     0     3    15  287      2
10   26     4    5    26   21    0    13    37    72    1  12589
---- Validation: 
scalar performance:
{'acc': 0.92681557, 'precision': 0.82707536, 'recall': 0.7709457, 'specificity': 0.9918474, 'f1': 0.79322547, 'auroc': 0.9910922}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   368     0    1     9    2    1     5    14    11    7     65
1     0  1243    0    15    0    0     0    63     7    0      4
2     9     7  166     3   29    1     1    25    18   46      7
3     1     0    0  8053    1   18     0   238   126    2      1
4     9     0   47     2  208    2     0    12    49    8    202
5     3     0    2    75    0  326     0     0    12  100      3
6    58     1    0    24    3    1  1706     9    20    4     82
7     0    29    1   305    2    0     1  6825    73    0     29
8     1     2    4   241   10    3     1    95  2883    1     55
9    10     3   55    33    0   72     2     6    13  294      5
10   40     6    5    20   33    1     9    37    67    1  12577
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4719793, 'precision': 0.56536865, 'recall': 0.41471064, 'specificity': 0.946718, 'f1': 0.41077024, 'auroc': 0.830417}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   567     1    6   50    0    0   309    1   141    5    90
1     0  1376    1   46    0    0     3   14    27    1    31
2    19    12   70   34   91    5     5    4   341   41   393
3     0     0    0    0    0    0     0    0     0    0     0
4     0     2    0    0  119    0     2    0    14    0  1496
5    23     0    2  210    0  200     1    0    18  135     3
6     4     2    3    2   77    0  1043    0    66    0  1870
7     0   193    7  519    0    0    48  279   107    1    10
8     7     0    4   90    6   13     3    1  1155    7    84
9    67    40  172  208    8   30     9    8   243  294    58
10    0     0    0    0    3    0     0    0     0    0  1643
better model found
persisted
after epoch: 10,now: 2024-08-12 12:45:37.940723,epoch time: 0:32:52.504350,used: 5:18:34.189108,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:18:34.189108 at 2024-08-12 12:45:37.940723
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4719793, 'precision': 0.56536865, 'recall': 0.41471064, 'specificity': 0.946718, 'f1': 0.41077024, 'auroc': 0.830417}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   567     1    6   50    0    0   309    1   141    5    90
1     0  1376    1   46    0    0     3   14    27    1    31
2    19    12   70   34   91    5     5    4   341   41   393
3     0     0    0    0    0    0     0    0     0    0     0
4     0     2    0    0  119    0     2    0    14    0  1496
5    23     0    2  210    0  200     1    0    18  135     3
6     4     2    3    2   77    0  1043    0    66    0  1870
7     0   193    7  519    0    0    48  279   107    1    10
8     7     0    4   90    6   13     3    1  1155    7    84
9    67    40  172  208    8   30     9    8   243  294    58
10    0     0    0    0    3    0     0    0     0    0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50241375, 'precision': 0.49433723, 'recall': 0.39938837, 'specificity': 0.94884884, 'f1': 0.3854912, 'auroc': 0.8245035}
confusion matrix:
     0     1   2    3   4   5     6    7    8    9     10
0   452     0   0   16   0   0   609    0   63   13    17
1     1  1187   5   38   0   0    47  100   40    2    79
2   113     1   2   29  12   0    97    5  156   53   547
3     0     0   0    0   0   0     0    0    0    0     0
4     1     0   0    0  10   0    12    0    5    0  1605
5    32     0   0  216   0  69     7    0    8  257     3
6    12     0   1    1   5   0  2027    0   12    0  1009
7    15    54   9  145   0   2   210  610  103    2    14
8   108     0   0   60   1  10    47    1  873   36   234
9   275     8  19  172   2   9    44    5  154  305   144
10    0     0   0    0   0   0     0    0    0    0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_07_27_03_seed_1_24142423_instance_wise_predictions.txt
accuracy from prediction file 0.4719792905618135
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/22.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/22.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    973 MiB |  11890 MiB | 688413 GiB | 688412 GiB |
|       from large pool |    841 MiB |  11812 MiB | 686833 GiB | 686832 GiB |
|       from small pool |    131 MiB |    213 MiB |   1579 GiB |   1579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    973 MiB |  11890 MiB | 688413 GiB | 688412 GiB |
|       from large pool |    841 MiB |  11812 MiB | 686833 GiB | 686832 GiB |
|       from small pool |    131 MiB |    213 MiB |   1579 GiB |   1579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    949 MiB |  11847 MiB | 686213 GiB | 686212 GiB |
|       from large pool |    817 MiB |  11769 MiB | 684638 GiB | 684637 GiB |
|       from small pool |    131 MiB |    212 MiB |   1574 GiB |   1574 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  12216 MiB |  12216 MiB |  21904 MiB |   9688 MiB |
|       from large pool |  12002 MiB |  12002 MiB |  21618 MiB |   9616 MiB |
|       from small pool |    214 MiB |    214 MiB |    286 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1706 MiB |   2174 MiB | 370142 GiB | 370140 GiB |
|       from large pool |   1698 MiB |   2172 MiB | 368500 GiB | 368498 GiB |
|       from small pool |      8 MiB |     36 MiB |   1642 GiB |   1642 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3767    |    6154    |   56357 K  |   56353 K  |
|       from large pool |     125    |     528    |   24111 K  |   24111 K  |
|       from small pool |    3642    |    5956    |   32246 K  |   32242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3767    |    6154    |   56357 K  |   56353 K  |
|       from large pool |     125    |     528    |   24111 K  |   24111 K  |
|       from small pool |    3642    |    5956    |   32246 K  |   32242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     291    |     301    |     480    |     189    |
|       from large pool |     184    |     194    |     337    |     153    |
|       from small pool |     107    |     107    |     143    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    1063    |   29517 K  |   29517 K  |
|       from large pool |      21    |     100    |   13259 K  |   13259 K  |
|       from small pool |      33    |    1041    |   16258 K  |   16258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11890 MiB | 688413 GiB | 688413 GiB |
|       from large pool |  16640 KiB |  11812 MiB | 686833 GiB | 686833 GiB |
|       from small pool |      0 KiB |    213 MiB |   1579 GiB |   1579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11890 MiB | 688413 GiB | 688413 GiB |
|       from large pool |  16640 KiB |  11812 MiB | 686833 GiB | 686833 GiB |
|       from small pool |      0 KiB |    213 MiB |   1579 GiB |   1579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  11847 MiB | 686213 GiB | 686213 GiB |
|       from large pool |  16640 KiB |  11769 MiB | 684638 GiB | 684638 GiB |
|       from small pool |      0 KiB |    212 MiB |   1574 GiB |   1574 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2680 MiB |  12216 MiB |  21904 MiB |  19224 MiB |
|       from large pool |   2540 MiB |  12002 MiB |  21618 MiB |  19078 MiB |
|       from small pool |    140 MiB |    214 MiB |    286 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   2174 MiB | 370142 GiB | 370142 GiB |
|       from large pool | 405248 KiB |   2172 MiB | 368500 GiB | 368499 GiB |
|       from small pool |      0 KiB |     36 MiB |   1642 GiB |   1642 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6154    |   56357 K  |   56357 K  |
|       from large pool |       2    |     528    |   24111 K  |   24111 K  |
|       from small pool |       0    |    5956    |   32246 K  |   32246 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6154    |   56357 K  |   56357 K  |
|       from large pool |       2    |     528    |   24111 K  |   24111 K  |
|       from small pool |       0    |    5956    |   32246 K  |   32246 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     301    |     480    |     365    |
|       from large pool |      45    |     194    |     337    |     292    |
|       from small pool |      70    |     107    |     143    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1063    |   29518 K  |   29518 K  |
|       from large pool |       4    |     100    |   13259 K  |   13259 K  |
|       from small pool |       0    |    1041    |   16259 K  |   16259 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 12:52:17 2024]
Finished job 0.
1 of 1 steps (100%) done
