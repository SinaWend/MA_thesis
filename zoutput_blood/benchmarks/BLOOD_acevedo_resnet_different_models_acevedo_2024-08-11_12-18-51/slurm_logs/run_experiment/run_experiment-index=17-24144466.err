Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 10:23:06 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/17.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=17
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466

 Experiment start at: 2024-08-12 10:31:19.155243
before training, model accuracy: 0.08479675650596619
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.2588292, 'precision': 0.25847283, 'recall': 0.21241376, 'specificity': 0.9266918, 'f1': 0.15546736, 'auroc': 0.7556154}
confusion matrix:
      0    1   2   3   4   5     6     7     8   9   10
0     60    0   0   0   0   0     5    34   384   0   0
1     17  661   0   0   0   0     5   616    33   0   0
2     23    0   0   0   0   0     4    34   251   0   0
3     64    1   0   0   0   0  2835  1194  4344   0   0
4     93    0   0   0   0   0     2    15   428   0   0
5      1    0   0   0   0   0    38     0   482   0   0
6    190    0   0   0   0   0     7    79  1632   0   0
7    149   23   0   1   0   0   188  6067   836   0   0
8    108    0   0   0   0   0    57   253  2877   0   0
9      9    0   0   0   0   0    16    22   444   2   0
10  4626    2   0   0   0   0     4    87  8073   0   0
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.2574562, 'precision': 0.18999225, 'recall': 0.20993781, 'specificity': 0.9265547, 'f1': 0.15539289, 'auroc': 0.7547136}
confusion matrix:
      0    1   2   3   4   5     6     7     8   9   10
0     45    0   0   0   0   0     1    40   397   0   0
1     11  681   0   0   0   0     3   604    33   0   0
2     22    1   0   0   0   0     3    40   245   1   0
3     55    1   0   0   0   0  2914  1167  4303   0   0
4     92    0   0   0   0   0     0    17   430   0   0
5      1    0   0   0   0   0    28     2   488   2   0
6    190    0   0   0   0   0     4    67  1647   0   0
7    160   24   0   0   0   0   177  6019   885   0   0
8    113    0   0   0   0   0    61   247  2875   0   0
9      4    1   0   0   0   0    16    16   455   1   0
10  4532    0   0   0   0   0     5    96  8163   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1778493, 'precision': 0.17621897, 'recall': 0.17870545, 'specificity': 0.91743493, 'f1': 0.10734288, 'auroc': 0.61429435}
confusion matrix:
     0    1   2   3   4   5   6    7     8    9   10
0    33    0   0   0   0   0   4   12  1118    3   0
1   108  204   0   0   0   0   1  807   379    0   0
2    36    0   0   0   0   0  13    2   954   10   0
3     0    0   0   0   0   0   0    0     0    0   0
4   164    0   0   0   0   0   2    0  1466    1   0
5     4    0   0   0   0   0  26    1   441  120   0
6   398    0   0   0   0   0  17    3  2645    4   0
7    34   10   0   1   0   0  19  936   164    0   0
8    19    0   0   0   0   0  20    0  1319   12   0
9    24    1   0   0   0   0  29    9  1041   33   0
10  248    0   0   0   0   0   1    0  1397    0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 10:54:43.318852,epoch time: 0:23:24.163609,used: 0:23:24.163609,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.2916845, 'precision': 0.27598977, 'recall': 0.2605832, 'specificity': 0.93082845, 'f1': 0.20160234, 'auroc': 0.8246797}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     38     1   0   1   0   0    69    32   340   2   0
1      7  1139   0   0   0   0    10   154    22   0   0
2      4     1   0   2   0   0    52    49   200   4   0
3     14     4   0   8   0   0  5778   996  1635   2   0
4     53     0   0   0   0   0     8    17   459   2   0
5      1     0   0   0   0   0   220     1   282  17   0
6     89     3   0   0   0   0   118    68  1629   1   0
7     47    71   0   2   0   0   165  6596   382   0   0
8     21     3   0   0   0   0   114   182  2974   0   0
9      1     0   0   1   0   0   168    21   273  29   0
10  6131    11   0   0   0   0     9    55  6588   0   0
---- Validation: 
scalar performance:
{'acc': 0.29268423, 'precision': 0.2527465, 'recall': 0.2592318, 'specificity': 0.9308901, 'f1': 0.19924203, 'auroc': 0.82615787}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     41     0   0   1   0   0    71    40   329   1   0
1     12  1135   0   0   0   0     9   157    19   0   0
2      6     0   0   0   0   0    52    51   202   1   0
3     18     6   0   4   0   0  5794  1001  1616   1   0
4     41     0   0   0   0   0    12     9   477   0   0
5      0     0   0   0   0   0   200     2   297  22   0
6    100     2   0   1   0   0   116    69  1619   1   0
7     49    41   0   2   0   0   165  6673   335   0   0
8     24     3   0   0   0   0   120   193  2954   2   0
9      1     0   0   2   0   0   161    15   295  19   0
10  5999    12   0   0   0   0     9    62  6714   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24858323, 'precision': 0.22746997, 'recall': 0.2297838, 'specificity': 0.9233961, 'f1': 0.19802563, 'auroc': 0.66940725}
confusion matrix:
     0    1   2   3   4   5    6    7     8    9   10
0     8    0   0   0   0   0  107    6  1036   13   0
1   102  917   0   2   0   0   39  167   271    1   0
2     5    0   0   1   0   0  199    0   733   77   0
3     0    0   0   0   0   0    0    0     0    0   0
4   330    0   0   0   0   0   25    0  1274    4   0
5     0    0   0   2   0   0  176    0   124  290   0
6    78    0   0   2   0   0  380    1  2568   38   0
7    14   32   0   6   0   0  122  847   143    0   0
8     0    0   0   0   0   0  149    0  1168   53   0
9     9    2   0   1   0   0  381    1   510  233   0
10  791    0   0   1   0   0    6    0   848    0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 11:17:31.280715,epoch time: 0:22:47.961863,used: 0:46:12.125472,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.33358306, 'precision': 0.26781726, 'recall': 0.36296773, 'specificity': 0.93539166, 'f1': 0.25771675, 'auroc': 0.8734504}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0    141     1   0   27   0   0   180    27    96   11   0
1     12  1153   0    7   0   0     6   138    14    0   0
2     12     1   0   22   1   0   110    45    76   45   0
3      7     5   0  142   0   0  6566   566  1121   32   0
4     80     0   0    3   0   0    94    10   344    8   0
5      2     0   0   67   0   0   201     1    68  182   0
6    120     2   0    5   0   0  1309    50   411   10   0
7     48    43   0   36   0   0   214  6623   300    0   0
8     16     2   0   16   0   0   147   158  2939   16   0
9      9     2   0   55   0   0   181    22    63  161   0
10  6761     9   0    2   0   0   123    63  5833    3   0
---- Validation: 
scalar performance:
{'acc': 0.33451918, 'precision': 0.27066368, 'recall': 0.36204505, 'specificity': 0.9354639, 'f1': 0.25739503, 'auroc': 0.87260944}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0    138     1   0   28   0   0   182    26    95   13   0
1      9  1168   0    0   0   0    11   129    15    0   0
2      8     0   0   24   0   0   110    50    83   37   0
3      5     1   0  134   0   0  6563   582  1122   33   0
4     81     1   0    3   0   0    89    17   344    4   0
5      1     0   0   59   0   0   219     0    75  167   0
6    118     1   0    2   0   0  1316    58   401   12   0
7     35    37   0   18   0   0   224  6652   298    1   0
8     22     2   0   10   0   0   148   151  2948   15   0
9      3     0   0   62   0   0   188    18    72  150   0
10  6644     9   0    1   0   0   124    59  5958    1   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37794724, 'precision': 0.26342997, 'recall': 0.26541466, 'specificity': 0.9335966, 'f1': 0.24335527, 'auroc': 0.72258437}
confusion matrix:
      0     1   2   3   4   5     6    7    8    9   10
0     30     0   0   1   0   0  1017    2  114    6   0
1    125  1027   0  24   0   0   123   70  124    6   0
2      9     0   0   4   0   0   746    0  183   73   0
3      0     0   0   0   0   0     0    0    0    0   0
4    615     0   0   0   0   0   343    0  674    1   0
5      0     0   0  10   0   0   181    0   12  389   0
6     75     1   0   1   0   0  2687    0  292   11   0
7     42    69   0  78   0   0   318  522  128    7   0
8      0     0   0   3   0   0   529    0  768   70   0
9     13     2   0  13   0   0   655    0   86  368   0
10  1128     0   0   0   0   0    72    0  446    0   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 11:40:02.906326,epoch time: 0:22:31.625611,used: 1:08:43.751083,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.41636345, 'precision': 0.31941095, 'recall': 0.45406035, 'specificity': 0.9432071, 'f1': 0.32601517, 'auroc': 0.91162884}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    308     1   0    43   0   0    56    19    38   17   0
1     10  1144   0    14   0   0     2   151    10    0   0
2     18     1   0    59   1   0    66    28    56   81   2
3     16     3   0  2867   0   0  4580   437   473   62   0
4     94     0   0    15   0   0    64    16   332   16   2
5      0     1   0   158   0   0    35     0    23  304   0
6    141     3   0    44   0   0  1468    43   195   14   0
7     47    21   0   318   0   0    87  6604   185    2   0
8     31     3   0   176   0   0    72   118  2872   24   0
9      9     1   0   104   1   1    37     9    32  299   0
10  7119    13   0    13   0   0    67    85  5486    9   0
---- Validation: 
scalar performance:
{'acc': 0.41473854, 'precision': 0.3194512, 'recall': 0.45483965, 'specificity': 0.94305766, 'f1': 0.32593507, 'auroc': 0.9120668}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    308     1   0    43   0   0    56    17    45   13   0
1     12  1149   0    18   0   0     3   133    17    0   0
2     24     2   0    60   0   0    46    29    57   94   0
3     12     5   0  2788   0   0  4639   447   490   59   0
4    101     0   0     6   0   0    65    13   332   20   2
5      1     1   0   164   0   0    42     0    16  297   0
6    159     1   0    43   0   0  1478    40   168   19   0
7     47    20   0   347   0   0    70  6581   200    0   0
8     27     2   0   174   0   0    56   119  2899   19   0
9     13     1   0    96   0   0    31    10    40  302   0
10  7138    11   0    14   0   0    68    68  5489    8   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38228503, 'precision': 0.2795688, 'recall': 0.2902102, 'specificity': 0.93617177, 'f1': 0.25266325, 'auroc': 0.7360004}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9   10
0   239     0   0    6   0   0   704    0   209   12   0
1    86  1063   0   31   0   0    98   64   152    5   0
2    40     0   0   13   0   0   349    0   499  114   0
3     0     0   0    0   0   0     0    0     0    0   0
4   475     0   0    1   0   0    75    0  1080    2   0
5     5     0   0   32   0   0    85    0    32  438   0
6   272     1   0    8   0   0  2162    0   611   13   0
7    53    55   0  125   0   0   273  367   288    3   0
8     0     0   0    5   0   0   120    0  1187   58   0
9    64     2   0   32   0   0   313    0   280  446   0
10  641     0   0    1   0   0     4    0  1000    0   0
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 12:02:46.429258,epoch time: 0:22:43.522932,used: 1:31:27.274015,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5444135, 'precision': 0.52479434, 'recall': 0.52836347, 'specificity': 0.9554649, 'f1': 0.4114462, 'auroc': 0.9323535}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    366     0   0    22   0   0    28    26    31   10   0
1      7  1195   0    12   0   0     1   108     9    0   0
2     26    21   0    31   3   2    33    50    62   83   1
3      6     3   0  7102   0   0   261   633   384   49   0
4     68     1   0     8   2   0    47    26   355   26   6
5      4     0   0   166   0   8     3     0    13  327   0
6     97     4   0    45   0   0  1564    30   141   25   0
7     24    43   0   202   0   0     5  6871   117    1   0
8     10     2   0   170   0   0     8   171  2914   21   0
9     24     4   0    73   0   1    14    19    40  318   0
10  7013    13   0    17   1   0    61    94  5578    8   8
---- Validation: 
scalar performance:
{'acc': 0.5456199, 'precision': 0.5478121, 'recall': 0.5286281, 'specificity': 0.95561016, 'f1': 0.4130563, 'auroc': 0.9313159}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    349     0   0    30   0   0    34    20    36   14   0
1      8  1214   0    13   0   0     1    88     8    0   0
2     25    13   0    30   2   0    34    47    69   92   0
3      5     6   0  7129   0   0   266   598   389   47   0
4     77     0   0     5   3   0    54    27   337   25  11
5      5     1   0   152   0   8     3     2    17  333   0
6    104     1   0    38   0   0  1565    38   143   19   0
7     27    47   0   195   0   0     6  6884   106    0   0
8     13     2   0   170   0   0     6   175  2913   17   0
9     15     7   0    75   0   1    17    16    35  327   0
10  6979     9   0    14   0   0    63    91  5623   11   6
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.39683762, 'precision': 0.29777744, 'recall': 0.3273678, 'specificity': 0.9388921, 'f1': 0.27405906, 'auroc': 0.7551916}
confusion matrix:
     0     1   2   3   4   5     6    7     8    9   10
0   692     1   0   3   0   0   293    0   174    7   0
1    56  1212   0  17   0   0    46   45   120    3   0
2   192     0   0  10   1   0   132    0   590   90   0
3     0     0   0   0   0   0     0    0     0    0   0
4   364     0   0   0   0   0    13    0  1254    2   0
5    68     0   0  38   0   0    19    0    27  440   0
6   577     1   0  12   0   0  1656    0   803   18   0
7    37   255   0  69   0   0   203  389   210    1   0
8    15     0   0   5   0   0    21    0  1260   69   0
9   240     9   0  24   0   0    89    0   312  463   0
10  509     0   0   1   0   0     0    0  1136    0   0
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-12 12:25:35.618211,epoch time: 0:22:49.188953,used: 1:54:16.462968,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.54767764, 'precision': 0.5205962, 'recall': 0.55055594, 'specificity': 0.9558747, 'f1': 0.435283, 'auroc': 0.9491045}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    409     2   0     7   0   0    20    15    25    4   1
1      9  1214   0     9   0   0     0    86    13    0   0
2     50    26   0    18   7   1    34    16    78   76   6
3     11     7   0  6969   0   3   130   558   706   54   0
4     89     0   0     2   3   0    30    11   354   18  32
5     15     1   0   113   1  60     2     0    24  305   0
6    126     3   0    15   0   0  1638    17    97   12   0
7     57    67   0   158   0   0     7  6781   187    0   6
8     25     3   0    94   0   0     7    87  3064   13   2
9     54     9   0    42   0   9    25     6    37  309   2
10  6357     9   0     8   0   0    29    29  6334    4  23
---- Validation: 
scalar performance:
{'acc': 0.54805404, 'precision': 0.54235363, 'recall': 0.5491812, 'specificity': 0.95591736, 'f1': 0.43391323, 'auroc': 0.9478788}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    400     1   0     6   0   0    29    12    29    5   1
1     12  1214   0    11   0   0     1    82    12    0   0
2     52    19   0    16   5   1    44    21    74   76   4
3     14     8   0  6977   0   5   118   556   702   60   0
4     97     1   0     5   4   1    37     9   342   14  29
5     13     2   0   109   0  54     4     0    19  320   0
6    131     3   0     8   0   0  1652    20    82   10   2
7     44    62   0   160   0   0     5  6778   210    2   4
8     25     4   0    86   0   0     5    95  3063   16   2
9     53     8   0    39   1   6    30     8    36  312   0
10  6309    10   0     9   0   0    25    36  6369    3  35
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33638844, 'precision': 0.36237442, 'recall': 0.27872318, 'specificity': 0.93236, 'f1': 0.21499933, 'auroc': 0.7239752}
confusion matrix:
      0     1   2   3   4   5     6    7     8    9   10
0    745     0   0   0   0   0   367    0    57    1   0
1     76  1221   0   6   0   0    46   22   128    0   0
2    294     0   0   1   0   0   121    0   570   27   2
3      0     0   0   0   0   0     0    0     0    0   0
4    392     0   0   0   0   0     4    0  1225    0  12
5    144     0   0  28   0   5    57    0    49  309   0
6   1195     0   0   0   0   0  1263    0   598    3   8
7     38   324   0  10   0   0   423  155   213    1   0
8     38     0   0   1   0   0    54    0  1245   32   0
9    419     8   0  10   2   0   150    0   376  172   0
10   425     0   0   0   0   0     0    0  1219    0   2
better model found
persisted
after epoch: 6,now: 2024-08-12 12:48:21.985173,epoch time: 0:22:46.366962,used: 2:17:02.829930,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7163688, 'precision': 0.6635654, 'recall': 0.6160161, 'specificity': 0.97217274, 'f1': 0.55791074, 'auroc': 0.9571336}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9     10
0    404     0   0    16   0    0    13    25    10    4    11
1      5  1196   0    12   0    0     0   110     7    0     1
2     32    15   0    40   5    2    28    48    33  105     4
3      6     2   0  7617   0   10     8   549   222   25     0
4     62     2   0    19  20    2    40    48   194   29   123
5      7     1   0   137   0  171     0     1    10  194     0
6     86     0   0    39   0    0  1684    30    47    9    12
7     18    16   0   161   0    0     5  6995    60    0     9
8     13     4   0   209   0    1     7   193  2832    9    26
9     32     5   0    72   0   34     7    14    16  312     0
10  5929     4   0    17   1    0    33    77  1180    9  5544
---- Validation: 
scalar performance:
{'acc': 0.71614283, 'precision': 0.65505385, 'recall': 0.6165528, 'specificity': 0.97212327, 'f1': 0.55541694, 'auroc': 0.9570102}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9     10
0    418     0   0    11   0    0     9    20    13    4     8
1      6  1194   0    15   0    0     0   111     5    0     1
2     33    17   0    43   5    3    32    31    40  100     8
3      4     4   0  7597   0   11    10   588   204   21     1
4     63     1   0    13  17    3    34    50   187   29   142
5     10     0   0   141   2  158     0     0     7  203     0
6     83     2   0    44   0    1  1682    25    44   13    14
7     16    17   0   158   0    0     1  6985    76    1    11
8     12     3   0   227   0    0     5   188  2835   10    16
9     34     7   0    61   0   30     5    18    19  319     0
10  5930     7   0    18   1    0    26    86  1153    7  5568
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43846637, 'precision': 0.4241901, 'recall': 0.36278048, 'specificity': 0.9425806, 'f1': 0.30783945, 'auroc': 0.746668}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   766     0   0    3   0   0   325    0    76    0     0
1    49  1244   0   15   0   0    53   38    79    0    21
2   212     1   0   14   5   0   110    1   608   34    30
3     0     0   0    0   0   0     0    0     0    0     0
4   183     0   0    0   0   0     5    0   593    1   851
5    96     0   0  100   0  20    41    0    32  303     0
6   737     1   0    2   0   0  1329    0   806    5   187
7    24   314   0   45   0   0   405  226   150    0     0
8    15     0   0   12   0   0    30    0  1286   27     0
9   312     8   0   63   4   0   155    0   378  213     4
10  292     0   0    1   0   0     0    0   170    0  1183
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-12 13:10:46.430834,epoch time: 0:22:24.445661,used: 2:39:27.275591,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8846319, 'precision': 0.68811715, 'recall': 0.6774663, 'specificity': 0.9878456, 'f1': 0.6495572, 'auroc': 0.9619999}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   417     0   0    12   0    0     5    11    11    1     26
1     1  1238   0    15   0    0     0    69     3    0      6
2    23    22   0    40   8    7    36    37    52   80      7
3     9     5   0  7492   0   29    41   465   383   11      1
4    30     2   0     5  24   17    19    50   203   13    176
5    10     0   0    99   2  282     2     1    11  113      1
6    93     2   0    20   0    2  1658    13    77    5     38
7    18    55   0   200   0    0     2  6826   137    0     25
8     3     2   0   130   0    2     7   108  2998    6     39
9    50     6   0    45   4   75    20     5    20  266      2
10  391    15   0     8   0    1    11    51   450    4  11863
---- Validation: 
scalar performance:
{'acc': 0.8874682, 'precision': 0.6756833, 'recall': 0.6770455, 'specificity': 0.9881234, 'f1': 0.64851725, 'auroc': 0.96399456}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   414     0   0     9   0    0     7    10    10    2     31
1     3  1227   0    13   0    0     0    79     7    0      3
2    23    19   0    37   6    7    36    41    56   76     11
3     8     5   0  7536   0   30    33   445   362   17      4
4    29     3   0     8  18   20    24    60   189   22    166
5    10     0   0    96   5  286     1     1    12  109      1
6    89     4   0    14   0    1  1676    15    63    6     40
7    14    57   0   189   0    0     3  6856   111    1     34
8    10     2   0   128   0    6     7    94  3000    7     42
9    32     7   0    64   7   77    17     9    18  262      0
10  397    12   0    13   0    3    14    49   401    4  11903
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46484292, 'precision': 0.4197681, 'recall': 0.38727558, 'specificity': 0.94480956, 'f1': 0.32491744, 'auroc': 0.728998}
confusion matrix:
     0     1   2   3   4   5     6    7     8    9     10
0   819     0   0   1   0   0   283    0    66    1     0
1    37  1232   0   8   0   0    70   18   106    0    28
2   171     2   0   5  16   1    84    3   668   22    43
3     0     0   0   0   0   0     0    0     0    0     0
4    31     0   0   0   2   0     5    0   387    0  1208
5   111     0   0  58   2  84    51    0    41  245     0
6   460     1   0   1   1   2  1333    0   921    3   345
7    24   247   0  15   0   0   571  134   169    0     4
8    19     0   0   5   0   3    27    0  1292   22     2
9   313     7   0  12  26  13   177    0   435  148     6
10    3     0   0   1   0   0     1    0    41    0  1600
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-12 13:33:13.780594,epoch time: 0:22:27.349760,used: 3:01:54.625351,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9013003, 'precision': 0.71441853, 'recall': 0.6809679, 'specificity': 0.98919964, 'f1': 0.6686936, 'auroc': 0.9651949}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   403     0   0    12   0    0     2    11     2    3     50
1     2  1229   0    10   0    0     0    81     7    0      2
2    26    30   0    40   6    4    29    76    25   62     14
3     6     5   0  7481   0   41    14   605   276    6      4
4    23     5   0    10  13   12     9    89   120   16    242
5     6     2   0    87   2  307     2     1    12  102      0
6    69     4   0    31   0    2  1677    21    41    6     57
7     6    47   0   133   0    0     1  6995    59    0     22
8     4     5   0   139   0    3     4   155  2911    0     73
9    30    12   0    61   0   69    20    16    16  265      4
10  176     5   0     7   0    2     7    60   127    4  12406
---- Validation: 
scalar performance:
{'acc': 0.89888996, 'precision': 0.7130326, 'recall': 0.6778435, 'specificity': 0.98894715, 'f1': 0.66377306, 'auroc': 0.9648923}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   391     0   0     9   0    0     5    14     3    0     61
1     3  1241   0    12   0    0     0    67     8    0      1
2    22    31   0    50   2    5    35    66    21   67     13
3    11     6   0  7445   0   32    10   642   279   12      3
4    23     8   0    13  10    9    13    95   112   18    238
5    11     0   0    71   1  315     0     1     7  114      1
6    68     3   0    23   0    0  1694    19    40    6     55
7    11    37   0   124   1    0     3  6999    66    0     24
8     5     7   0   131   0    4     3   174  2882    4     86
9    46    10   0    60   0   86     8    12    13  255      3
10  163     9   0     8   1    0    13    72   153    4  12373
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47946548, 'precision': 0.43437922, 'recall': 0.41206956, 'specificity': 0.9466507, 'f1': 0.3566024, 'auroc': 0.7461538}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   920     0   0    3   0    0   216    0    28    0     3
1    34  1253   0   23   0    0    48   43    56    0    42
2   229     1   0    7   5    2    81    9   498   24   159
3     0     0   0    0   0    0     0    0     0    0     0
4    15     0   0    0   0    0     4    0   124    0  1490
5   123     0   0   89   0  122    30    0    31  197     0
6   557     0   0    5   0    0  1202    1   499    1   802
7    28   191   0  131   0    0   408  307    94    0     5
8    41     0   0    9   0    3    34    0  1245   24    14
9   410    15   0   47  11    8   133    1   335  162    15
10    2     0   0    1   0    0     0    0     1    0  1642
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 13:56:12.754957,epoch time: 0:22:58.974363,used: 3:24:53.599714,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9063303, 'precision': 0.73684067, 'recall': 0.67807555, 'specificity': 0.9897875, 'f1': 0.67738986, 'auroc': 0.97136855}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   374     0   0    21   0    0     8    14     6    9     51
1     2  1197   0    20   0    0     0   103     6    0      4
2     8    21   0    83   6    4    30    37    52   70      1
3     1     0   0  7964   0   20     1   291   156    2      0
4     9     2   0    26  19   23    14    63   198   20    165
5     1     0   0   107   0  324     0     1     8   80      0
6    26     0   0    66   0    1  1695    17    57    5     41
7     2     9   0   270   0    0     2  6884    84    0     11
8     1     1   0   228   0    2     3    93  2937    2     29
9    13     5   0    87   1  104    10     2    23  247      1
10  118     4   0    25   0    1     9    68   330    6  12234
---- Validation: 
scalar performance:
{'acc': 0.9056841, 'precision': 0.73950195, 'recall': 0.6800902, 'specificity': 0.9897441, 'f1': 0.67807275, 'auroc': 0.97141147}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   377     0   0    20   1    2     9    14     7    3     50
1     1  1202   0    16   0    0     0    98    10    0      5
2     9    14   0    85   3    5    44    32    49   66      5
3     2     0   0  7953   0   23     1   298   162    0      1
4    11     2   0    19  14   21    14    80   222   18    138
5     3     0   0   108   0  325     1     0     8   75      1
6    32     0   0    60   0    4  1678    17    70    4     43
7     5     7   0   250   0    0     1  6883   106    1     12
8     2     1   0   219   0    4     1   112  2924    1     32
9    10     2   0    76   0   96    14     4    24  264      3
10  118     1   0    25   1    1     7    79   320    5  12239
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4515497, 'precision': 0.45960054, 'recall': 0.38816687, 'specificity': 0.94444275, 'f1': 0.35409427, 'auroc': 0.7348921}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   657     0   0   17   0    0   347    0   144    0     5
1    19  1154   0   37   0    0    39   61   141    0    48
2    75     1   0   34   0    1    12    3   786   33    70
3     0     0   0    0   0    0     0    0     0    0     0
4     5     0   0    0   0    1     2    0   268    0  1357
5    28     0   0  203   0  117    18    0    46  180     0
6   139     0   0   23   0    2  1067    1  1259    5   571
7     8    35   0  358   0    0   229  289   241    0     4
8     3     0   0   26   0    0     1    0  1334    6     0
9   104     6   0  130   1   18    44    0   620  204    10
10    0     0   0    1   1    0     0    0    12    0  1632
better model found
persisted
after epoch: 10,now: 2024-08-12 14:19:14.752041,epoch time: 0:23:01.997084,used: 3:47:55.596798,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 3:47:55.596798 at 2024-08-12 14:19:14.752041
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4515497, 'precision': 0.45960054, 'recall': 0.38816687, 'specificity': 0.94444275, 'f1': 0.35409427, 'auroc': 0.7348921}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   657     0   0   17   0    0   347    0   144    0     5
1    19  1154   0   37   0    0    39   61   141    0    48
2    75     1   0   34   0    1    12    3   786   33    70
3     0     0   0    0   0    0     0    0     0    0     0
4     5     0   0    0   0    1     2    0   268    0  1357
5    28     0   0  203   0  117    18    0    46  180     0
6   139     0   0   23   0    2  1067    1  1259    5   571
7     8    35   0  358   0    0   229  289   241    0     4
8     3     0   0   26   0    0     1    0  1334    6     0
9   104     6   0  130   1   18    44    0   620  204    10
10    0     0   0    1   1    0     0    0    12    0  1632
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47946548, 'precision': 0.43437922, 'recall': 0.41206956, 'specificity': 0.9466507, 'f1': 0.3566024, 'auroc': 0.7461538}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   920     0   0    3   0    0   216    0    28    0     3
1    34  1253   0   23   0    0    48   43    56    0    42
2   229     1   0    7   5    2    81    9   498   24   159
3     0     0   0    0   0    0     0    0     0    0     0
4    15     0   0    0   0    0     4    0   124    0  1490
5   123     0   0   89   0  122    30    0    31  197     0
6   557     0   0    5   0    0  1202    1   499    1   802
7    28   191   0  131   0    0   408  307    94    0     5
8    41     0   0    9   0    3    34    0  1245   24    14
9   410    15   0   47  11    8   133    1   335  162    15
10    2     0   0    1   0    0     0    0     1    0  1642
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_10_31_18_seed_0_24144466_instance_wise_predictions.txt
accuracy from prediction file 0.4515497096480795
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/17.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/17.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/17.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 487393 KiB |  10925 MiB | 516609 GiB | 516609 GiB |
|       from large pool | 396672 KiB |  10852 MiB | 515976 GiB | 515975 GiB |
|       from small pool |  90721 KiB |    127 MiB |    633 GiB |    633 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 487393 KiB |  10925 MiB | 516609 GiB | 516609 GiB |
|       from large pool | 396672 KiB |  10852 MiB | 515976 GiB | 515975 GiB |
|       from small pool |  90721 KiB |    127 MiB |    633 GiB |    633 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478101 KiB |  10910 MiB | 515757 GiB | 515756 GiB |
|       from large pool | 387840 KiB |  10837 MiB | 515125 GiB | 515125 GiB |
|       from small pool |  90261 KiB |    126 MiB |    631 GiB |    631 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11302 MiB |  11302 MiB |  11302 MiB |      0 B   |
|       from large pool |  11174 MiB |  11174 MiB |  11174 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1938 MiB |   2369 MiB | 211824 GiB | 211822 GiB |
|       from large pool |   1928 MiB |   2367 MiB | 211145 GiB | 211143 GiB |
|       from small pool |      9 MiB |     13 MiB |    678 GiB |    678 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3023    |    4666    |   27517 K  |   27514 K  |
|       from large pool |      87    |     491    |   14221 K  |   14220 K  |
|       from small pool |    2936    |    4544    |   13296 K  |   13293 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3023    |    4666    |   27517 K  |   27514 K  |
|       from large pool |      87    |     491    |   14221 K  |   14220 K  |
|       from small pool |    2936    |    4544    |   13296 K  |   13293 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     182    |     182    |     182    |       0    |
|       from large pool |     118    |     118    |     118    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |    1151    |   13796 K  |   13796 K  |
|       from large pool |      29    |      70    |    6945 K  |    6945 K  |
|       from small pool |      33    |    1121    |    6851 K  |    6851 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10925 MiB | 516609 GiB | 516609 GiB |
|       from large pool |  16640 KiB |  10852 MiB | 515976 GiB | 515976 GiB |
|       from small pool |      0 KiB |    127 MiB |    633 GiB |    633 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10925 MiB | 516609 GiB | 516609 GiB |
|       from large pool |  16640 KiB |  10852 MiB | 515976 GiB | 515976 GiB |
|       from small pool |      0 KiB |    127 MiB |    633 GiB |    633 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10910 MiB | 515757 GiB | 515757 GiB |
|       from large pool |  16640 KiB |  10837 MiB | 515125 GiB | 515125 GiB |
|       from small pool |      0 KiB |    126 MiB |    631 GiB |    631 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2414 MiB |  11302 MiB |  11302 MiB |   8888 MiB |
|       from large pool |   2316 MiB |  11174 MiB |  11174 MiB |   8858 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2369 MiB | 211824 GiB | 211824 GiB |
|       from large pool | 134912 KiB |   2367 MiB | 211146 GiB | 211145 GiB |
|       from small pool |      0 KiB |     38 MiB |    678 GiB |    678 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4666    |   27517 K  |   27517 K  |
|       from large pool |       2    |     491    |   14221 K  |   14221 K  |
|       from small pool |       0    |    4544    |   13296 K  |   13296 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4666    |   27517 K  |   27517 K  |
|       from large pool |       2    |     491    |   14221 K  |   14221 K  |
|       from small pool |       0    |    4544    |   13296 K  |   13296 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     182    |     182    |     103    |
|       from large pool |      30    |     118    |     118    |      88    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1151    |   13797 K  |   13797 K  |
|       from large pool |       3    |      70    |    6945 K  |    6945 K  |
|       from small pool |       0    |    1121    |    6852 K  |    6852 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10925 MiB | 516609 GiB | 516609 GiB |
|       from large pool |  16640 KiB |  10852 MiB | 515976 GiB | 515976 GiB |
|       from small pool |      0 KiB |    127 MiB |    633 GiB |    633 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10925 MiB | 516609 GiB | 516609 GiB |
|       from large pool |  16640 KiB |  10852 MiB | 515976 GiB | 515976 GiB |
|       from small pool |      0 KiB |    127 MiB |    633 GiB |    633 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10910 MiB | 515757 GiB | 515757 GiB |
|       from large pool |  16640 KiB |  10837 MiB | 515125 GiB | 515125 GiB |
|       from small pool |      0 KiB |    126 MiB |    631 GiB |    631 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2414 MiB |  11302 MiB |  11302 MiB |   8888 MiB |
|       from large pool |   2316 MiB |  11174 MiB |  11174 MiB |   8858 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2369 MiB | 211824 GiB | 211824 GiB |
|       from large pool | 134912 KiB |   2367 MiB | 211146 GiB | 211145 GiB |
|       from small pool |      0 KiB |     38 MiB |    678 GiB |    678 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4666    |   27517 K  |   27517 K  |
|       from large pool |       2    |     491    |   14221 K  |   14221 K  |
|       from small pool |       0    |    4544    |   13296 K  |   13296 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4666    |   27517 K  |   27517 K  |
|       from large pool |       2    |     491    |   14221 K  |   14221 K  |
|       from small pool |       0    |    4544    |   13296 K  |   13296 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     182    |     182    |     103    |
|       from large pool |      30    |     118    |     118    |      88    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1151    |   13797 K  |   13797 K  |
|       from large pool |       3    |      70    |    6945 K  |    6945 K  |
|       from small pool |       0    |    1121    |    6852 K  |    6852 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_14_32_02_seed_1_24144466

 Experiment start at: 2024-08-12 14:32:02.620320
before training, model accuracy: 0.1021479070186615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7240208, 'precision': 0.3238162, 'recall': 0.3204734, 'specificity': 0.9673213, 'f1': 0.29214674, 'auroc': 0.85373306}
confusion matrix:
    0    1    2     3   4   5   6     7   8   9      10
0    0   13   43   191   0   0   0   106   3   6    121
1    0  983    0    22   0   0   0   289   0   0     38
2    0    3   20    99   0   0   0   122   1   1     66
3    0    7    6  7608   0   0   0   811   1   1      5
4    0   18   26   102   0   0   0    72   2   2    317
5    0    2    8   490   0   0   0    17   2   0      2
6    0   50  150   414   0   0   0   225   4   3   1060
7    0   69    3   882   0   0   0  6248   0   0     62
8    0   24  191  1903   0   0   0   719  16   4    439
9    0    6   10   350   0   0   0   108   2   2     15
10   0  143   79   187   0   0   0   197   1   0  12184
---- Validation: 
scalar performance:
{'acc': 0.72467566, 'precision': 0.44259506, 'recall': 0.32002097, 'specificity': 0.96736276, 'f1': 0.29279584, 'auroc': 0.85650986}
confusion matrix:
    0    1    2     3   4   5   6     7   8   9      10
0    0    9   49   207   0   0   0   105   0   3    110
1    0  965    0    25   0   0   0   304   0   0     38
2    0    8   19   101   0   0   0   124   0   2     58
3    0    6    1  7627   0   0   0   801   1   0      4
4    0   11   24    90   0   0   0    81   1   1    331
5    0    2    8   488   0   0   0    18   1   0      4
6    0   49  143   429   0   0   2   206   4   4   1071
7    0   64    2   875   0   0   0  6266   0   0     58
8    0   27  174  1895   0   0   0   721  24   1    454
9    0    5    9   357   0   0   0   110   3   4      5
10   0  155   66   181   0   0   0   206   3   0  12185
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24844329, 'precision': 0.2374092, 'recall': 0.22775452, 'specificity': 0.9256235, 'f1': 0.1658876, 'auroc': 0.66556567}
confusion matrix:
    0    1    2    3   4   5   6     7   8   9     10
0    0    6  205  335   0   0   0   182   2   3   437
1    0  768   10   44   0   0   0   219   0   0   458
2    0    6  131  412   0   0   0    96   0   0   370
3    0    0    0    0   0   0   0     0   0   0     0
4    0    0    8    5   0   0   0     4   0   0  1616
5    0    0   10  560   0   0   0    15   0   1     6
6    0    8  142  118   0   0   0    22   0   2  2775
7    0   22    9   23   0   0   1  1002   0   0   107
8    0    0  149  601   0   0   2   134   3   0   481
9    0    3   62  807   0   0   0   192   0   1    72
10   0    0    0    0   0   0   0     0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 14:56:25.409445,epoch time: 0:24:22.789125,used: 0:24:22.789125,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_14_32_02_seed_1_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.78743047, 'precision': 0.37719512, 'recall': 0.37711284, 'specificity': 0.97562194, 'f1': 0.35149425, 'auroc': 0.90128887}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0    39   4   109   0   2   1    40   211   0     76
1    0  1132   0    15   0   0   0   167     4   0     14
2    0    35   8    45   0   0   0    67   126   0     31
3    0     1   0  7784   0   0   0   590    59   0      3
4    0    23  23    34   0   0   0    25   118   0    316
5    0     0   1   382   0   0   0     4   132   0      2
6    0   333  27   182   0   0   1    72   539   0    754
7    0    65   3   520   0   0   0  6573    40   0     63
8    0    58  53  1115   0   1   0   247  1579   0    243
9    0    11   0   226   0   0   0    51   202   0      2
10   0    88  39    90   0   0   0    87   135   0  12354
---- Validation: 
scalar performance:
{'acc': 0.78860503, 'precision': 0.3297496, 'recall': 0.37642774, 'specificity': 0.97575915, 'f1': 0.35036334, 'auroc': 0.90298724}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0    46   5    97   0   0   0    43   217   0     75
1    0  1126   0    21   0   0   0   167     2   0     16
2    0    25   4    44   0   0   0    71   132   0     36
3    0     2   0  7807   0   0   0   567    62   0      2
4    0    40  22    38   0   0   0    23   111   0    305
5    0     0   0   384   0   0   0     2   134   0      1
6    0   325  18   178   0   0   0    82   531   0    774
7    0    54   2   519   0   0   0  6585    38   0     67
8    0    50  73  1038   0   1   0   286  1599   0    249
9    0     6   5   210   0   0   0    52   216   0      4
10   0   105  29    73   0   0   0    86   142   0  12361
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32673338, 'precision': 0.23226705, 'recall': 0.30027485, 'specificity': 0.93336284, 'f1': 0.24112183, 'auroc': 0.69882405}
confusion matrix:
    0     1    2    3   4   5   6    7    8   9     10
0    0    46   83  467   0   0   0   34  444   0    96
1    0  1030    8   65   0   1   0  148   22   0   225
2    0    14  132  304   0   0   0   10  271   0   284
3    0     0    0    0   0   0   0    0    0   0     0
4    0     1    8    6   0   0   0    0    6   0  1612
5    0     0    3  493   0   0   0    0   94   0     2
6    0    36  266  108   0   0   0    5  170   0  2482
7    0    21    6   70   0   0   0  981   35   0    51
8    0     6   72  312   0   0   0    1  881   0    98
9    1    10   39  698   0   0   0   31  315   0    43
10   0     0    0    0   0   0   0    0    0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 15:19:05.292263,epoch time: 0:22:39.882818,used: 0:47:02.671943,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_14_32_02_seed_1_24144466
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.81097496, 'precision': 0.36389047, 'recall': 0.4007274, 'specificity': 0.9792613, 'f1': 0.3571501, 'auroc': 0.9183648}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0   133   0    43   0   0   1    38   213   0     55
1    0  1159   0    15   0   0   0   144     2   0     12
2    0    85   2    10   0   0   0    61   126   0     28
3    0     0   0  7707   0   0   0   533   198   0      2
4    0    84   3     8   0   0   0    25   126   0    293
5    0    11   1   243   0   0   0     5   257   0      3
6    0   795   1    44   0   0   1    78   504   0    484
7    0    74   1   360   0   0   0  6709    72   0     47
8    0    87  13   397   0   0   0   257  2407   0    134
9    0    55   0    88   0   0   0    43   305   0      2
10   0   193  12    27   0   0   1    75   158   0  12326
---- Validation: 
slurmstepd: error: *** JOB 24144466 ON gpusrv68 CANCELLED AT 2024-08-12T15:39:24 ***
