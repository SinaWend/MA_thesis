Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 12:20:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/27.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=27
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409

 Experiment start at: 2024-08-11 12:30:39.156128
before training, model accuracy: 0.05282306298613548
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.83245933, 'precision': 0.5311089, 'recall': 0.45318568, 'specificity': 0.9810546, 'f1': 0.45430058, 'auroc': 0.9611187}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    44   0   2   315    18    35   4     65
1    0  796   0   310   0   0     1   165     5   0     55
2    0    3   0    18   0   3   140    29    91   4     24
3    0    0   0  7707   0   0     4   388   324   0     12
4    0    0   0    11   0   0   126     4    95   0    303
5    0    0   0   333   0  53    72     1    50  11      1
6    0    2   0    66   0   0  1459    21   123   2    234
7    0   27   0   651   0   0     7  6248   208   0    123
8    0    0   0   330   0   0    61   148  2472   0    285
9    0    1   0   135   0  27   196    22    94  15      3
10   0    6   0    88   0   0   192    42   102   0  12364
---- Validation: 
scalar performance:
{'acc': 0.83255315, 'precision': 0.5289368, 'recall': 0.45417553, 'specificity': 0.98109573, 'f1': 0.4548673, 'auroc': 0.9623909}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    1   0    46   0   7   310    16    38   2     63
1    0  805   0   289   0   0     0   180     5   0     53
2    0    1   0    13   0   3   137    21   105   2     30
3    0    0   0  7702   0   0     2   404   321   0     11
4    0    0   0     6   0   0   122     8    96   0    307
5    0    0   0   319   0  52    77     0    58  14      1
6    0    3   0    52   0   1  1469    17   132   1    233
7    0   32   0   668   0   0     8  6229   198   0    130
8    0    1   0   346   0   0    78   143  2472   0    256
9    0    1   0   131   0  32   195    15   101  17      1
10   0    3   0    93   0   0   178    38   105   0  12379
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4166375, 'precision': 0.41197813, 'recall': 0.33222675, 'specificity': 0.93894684, 'f1': 0.28167263, 'auroc': 0.76877946}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     1   0   28   0   0  1106   24    9   0     2
1    0  1050   0   24   0   0    55  171   15   0   184
2    0     3   0  108   0   1   440   28  260   0   175
3    0     0   0    0   0   0     0    0    0   0     0
4    0     1   0    1   0   0    40    1   12   0  1578
5    0     0   0  421   0   8    81    0   80   0     2
6    0     1   0    1   0   0  1360    2   34   0  1669
7    0    98   0    5   0   0    89  902   32   0    38
8    0     0   0   72   0   1   262    2  989   0    44
9    0    12   0  430   0   3   359   41  275   1    16
10   0     0   0    0   0   0     1    0    0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 13:07:57.885010,epoch time: 0:37:18.728882,used: 0:37:18.728882,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8902772, 'precision': 0.7751299, 'recall': 0.63984364, 'specificity': 0.9879437, 'f1': 0.6677832, 'auroc': 0.9843551}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   152     0   1    19   1    5   183    19    21   37     45
1     0  1000   0    67   0    0     2   242     4    0     17
2     8     2  53     7  23    6    16    33    57   96     11
3     0     3   0  7734   0   17     2   461   216    2      5
4     1     1  22     6  71    2    32    13   114   28    249
5     1     0   0   118   0  315     2     1    12   69      2
6     5     4   0    15   1    6  1756    20    41    8     52
7     0    18   0   311   1    0     4  6770   117    0     41
8     0     0   0   223   0    0    12   162  2833    1     64
9     4     2  18    48   0  134     4    17    29  232      5
10    3     9   3    21   7    2   143    79   159    7  12359
---- Validation: 
scalar performance:
{'acc': 0.8911863, 'precision': 0.7810813, 'recall': 0.6466973, 'specificity': 0.98805666, 'f1': 0.67561334, 'auroc': 0.98473966}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   158     0   1    15   0    7   191    25    16   28     42
1     0  1030   0    72   0    0     0   215     8    0      7
2     5     0  71     7  17    9    13    25    63   93      9
3     0     3   0  7755   0   19     4   453   203    1      2
4     2     0  24     5  64    1    38    13   116   26    250
5     1     0   2   120   0  327     0     1    11   57      2
6     7     2   0    24   0    6  1738    22    43   10     56
7     0    21   0   314   2    0     5  6776   105    0     42
8     0     1   2   241   2    0    16   162  2818    1     53
9     5     1  21    48   0  131     8    15    37  225      2
10    3     6   1    24   8    2   147    74   173    3  12355
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5337578, 'precision': 0.4879096, 'recall': 0.41609627, 'specificity': 0.95138097, 'f1': 0.3643761, 'auroc': 0.83522224}
confusion matrix:
    0     1   2    3   4    5     6     7     8   9     10
0    1     0   0   31   0    1  1077    29    10  21     0
1    0  1079   0   23   0    0    31   271     9   0    86
2    0     1   3   77   2   13   364    62   341   6   146
3    0     0   0    0   0    0     0     0     0   0     0
4    0     1   0    0   0    0    42     1    19   0  1570
5    1     0   0  382   0  118    53     0    22  16     0
6    0     1   0    1   0    0  2444     2    14   2   603
7    0    13   0    2   0    0    45  1079    14   0    11
8    0     0   1   77   0    2    82     5  1189   6     8
9    0    11   3  358   0   69   279   124   205  73    15
10   0     1   0    0   0    0     2     0     0   0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 13:44:10.535094,epoch time: 0:36:12.650084,used: 1:13:31.378966,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9185039, 'precision': 0.80528766, 'recall': 0.7498607, 'specificity': 0.99097407, 'f1': 0.77133924, 'auroc': 0.99130714}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   271     0    1     9    2    2    77    10    11   13     87
1     0  1234    1    20    0    0     1    56     4    0     16
2     1     2  120     4   60    4     3     9    18   84      7
3     1     0    1  7988    1   29     4   218   185    4      7
4     1     0   25     0  259    2     5     5    37   17    188
5     1     0    2    59    0  396     1     0     8   52      2
6    17     1    0    11    3    2  1747     3    23    8     91
7     0    41    3   400    3    0     6  6610   130    1     70
8     1     2    7   189   30    2    10    78  2880    5     89
9     4     1   43    17    1  154     3     3    12  249      6
10    9     2    3    10   78    1    37    18    58    3  12576
---- Validation: 
scalar performance:
{'acc': 0.91911197, 'precision': 0.81260586, 'recall': 0.7489929, 'specificity': 0.9910203, 'f1': 0.7736645, 'auroc': 0.9915262}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   268     0    3    17    2    3    68    10     7   11     94
1     0  1226    1    22    1    0     1    62     5    0     14
2     2     2  120     2   63    4     2     6    20   83      8
3     0     1    0  7968    0   36     6   218   199    3      9
4     2     0   28     1  245    3     1     4    53   13    189
5     0     0    0    63    0  385     2     0     5   65      1
6    14     0    2    11    7    1  1749     4    19    8     93
7     0    37    5   381    4    0     2  6627   149    0     60
8     1     1    5   198   19    4     8    78  2892    7     83
9     2     0   38    24    2  128     2     5    14  271      7
10    9     1    1    10   54    2    24    18    66    1  12610
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48128456, 'precision': 0.5571822, 'recall': 0.42010036, 'specificity': 0.9468005, 'f1': 0.38028258, 'auroc': 0.83127546}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   30     0   2   64   0    9   898    21    53   70    23
1    0  1165   0   37   0    0    16   152    12    0   117
2    0     8  21   66  28   28    55    36   477   12   284
3    0     0   0    0   0    0     0     0     0    0     0
4    0     1   1    0  58    0     2     0    30    0  1541
5    0     0   0  279   0  254     8     0    34   15     2
6    5     2   2    1   9    3  1293     1    49    1  1701
7    0    22   0   16   0    0    59  1007    32    1    27
8    0     0   1   77   1    4     5     0  1268    3    11
9    0    24  31  361   4  119    68    52   304  138    36
10   0     0   0    0   1    0     0     0     0    0  1645
better model found
persisted
after epoch: 3,now: 2024-08-11 14:20:11.187255,epoch time: 0:36:00.652161,used: 1:49:32.031127,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92026967, 'precision': 0.80122584, 'recall': 0.79224515, 'specificity': 0.9913573, 'f1': 0.7952753, 'auroc': 0.99231523}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   361     0    0     2    0    4    21     6     6   12     71
1     0  1074    1    53    1    0     1   147     5    1     49
2     4     2  175     0   34    2     0     4     6   81      4
3     8     2    1  7810    1   65     9   265   260   14      2
4     1     0   59     2  293    1     2     3    22   19    137
5     1     0    1    34    0  387     0     0     4   93      1
6    56     0    4     6    6    0  1752     4    14   10     54
7     6    34   11   250   13    0     7  6699   179    4     61
8     5     2   10   128   32    8    19    63  2950    9     70
9     5     1   33     9    1  100     2     3     7  330      2
10   17     1   10    15   94    3    24    15    45    4  12565
---- Validation: 
scalar performance:
{'acc': 0.9209041, 'precision': 0.7951534, 'recall': 0.78907204, 'specificity': 0.99143213, 'f1': 0.79083824, 'auroc': 0.9922635}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   357     0    2     2    0    1    24     7     9   10     71
1     0  1127    1    57    1    0     2   103     6    0     35
2     3     1  167     1   35    0     1     5     6   91      2
3     9     1    2  7817    0   60    13   271   255    8      4
4     4     0   66     0  279    3     4     3    25   13    142
5     2     0    1    33    0  387     0     0     6   91      1
6    64     2    1    11    2    3  1748     3     5   13     56
7     6    43   15   241    8    0     9  6711   160    3     69
8     3     2   12   117   27    2    17    63  2954   15     84
9     4     0   36     8    1  111     1     0     6  323      3
10   21     7    8    15   95    5    26    15    41    5  12558
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56237316, 'precision': 0.6230215, 'recall': 0.48345733, 'specificity': 0.9551635, 'f1': 0.46167728, 'auroc': 0.8482759}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   180     0   2   28   0    8   645    21     7  266    13
1     1  1187   0   36   0    0    10   169     1    1    94
2     0     8  39   53   9   30   101    53   250   83   389
3     0     0   0    0   0    0     0     0     0    0     0
4     0     2   2    0  58    0    10     1    18    0  1542
5     1     0   0  203   0  303     3     0     6   74     2
6    25     1   1    2   1    2  1968     2     7    4  1054
7     1    11   0   12   0    0    60  1047     6    3    24
8     0     0   2  115   2    5    23     2  1146   45    30
9     1    30  25  235   1  113    58    86    73  467    48
10    0     1   0    0   2    0     0     0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 14:56:16.877670,epoch time: 0:36:05.690415,used: 2:25:37.721542,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92917913, 'precision': 0.8409976, 'recall': 0.7921721, 'specificity': 0.99228543, 'f1': 0.8103161, 'auroc': 0.99428165}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   352     0    0     2    0    3    34     3     9    2     76
1     0  1135    0    28    1    0     0   124     8    0     36
2     3     0  143     1   43    2     1     7    10   97      5
3     2     3    0  7634    0   34    21   404   338    2      2
4     0     0   27     0  301    2     4     5    32   10    158
5     1     0    0    39    0  441     0     1     7   31      1
6     7     0    0     3    0    1  1839     3    15    1     38
7     2    16    5   114    6    0     8  6934   140    4     35
8     0     4    2    67   16    1    14    70  3052    4     66
9     3     0   25    11    1  174     4     2     9  261      3
10    6     0    7    11   49    2    21    11    47    0  12637
---- Validation: 
scalar performance:
{'acc': 0.92780524, 'precision': 0.835675, 'recall': 0.79332197, 'specificity': 0.99215084, 'f1': 0.8095356, 'auroc': 0.9939876}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   350     0    1     2    0    2    39     6     7    3     73
1     1  1143    0    23    2    0     3   116     9    0     35
2     3     0  148     1   50    4     3     3     6   85      9
3     4     1    0  7627    0   35     9   414   343    4      3
4     1     0   29     0  304    2     7     3    31   12    150
5     1     0    1    35    0  436     0     0    10   37      1
6     8     0    2     3    1    2  1836     4    12    1     39
7     1    18    9   108    3    0    15  6916   157    1     37
8     0     2    6    66   20    3    11    76  3034    2     76
9     9     0   23     7    1  159     3     4    14  268      5
10    8     1    5    14   51    1    31    11    50    0  12624
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5553068, 'precision': 0.6073599, 'recall': 0.4554153, 'specificity': 0.95377433, 'f1': 0.4185813, 'auroc': 0.8328544}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   18     0   1   23   0    1  1052    13     5   44    13
1    0  1088   0   32   0    0    26   225     7    0   121
2    0     3   7   41   8   19   110    59   378   43   347
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   1    0  36    0    11     1    26    0  1558
5    0     0   0  241   0  248    37     0    19   46     1
6    5     0   0    1   1    1  2309     3    11    0   736
7    0     1   0   10   0    0   100  1025    16    0    12
8    0     0   1   61   0    2    35     3  1242    5    21
9    1    18   6  228   1   79   138   118   172  321    55
10   0     0   0    0   1    0     2     0     0    0  1643
better model found
persisted
after epoch: 5,now: 2024-08-11 15:32:17.935882,epoch time: 0:36:01.058212,used: 3:01:38.779754,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9323095, 'precision': 0.8380438, 'recall': 0.8361521, 'specificity': 0.99279785, 'f1': 0.83499706, 'auroc': 0.9949878}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   370     0    0     1    2    1    24     5     6    5     69
1     0  1276    1     8    1    0     0    34     8    0      4
2     2     0  178     0   45    1     4     4     6   71      1
3     2     4    1  7584    0   22     9   461   350    6      0
4     3     0   40     0  379    2     2     3    17    8     85
5     1     0    0    32    0  433     0     0     5   48      2
6     9     0    0     4    3    1  1842     3     8    4     34
7     2    33    7    87    8    0     8  6902   180    2     34
8     0     1    7    60   45    0    12    62  3042    3     62
9     4     0   28     8    1  119     0     0    10  321      1
10   11     2    5    11  168    3    23    19    29    3  12519
---- Validation: 
scalar performance:
{'acc': 0.9306941, 'precision': 0.83790016, 'recall': 0.8358949, 'specificity': 0.99262524, 'f1': 0.83461535, 'auroc': 0.99526757}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     1    0     2    0    1    25     2     6    4     63
1     0  1264    1     7    2    0     1    44     8    0      5
2     1     0  190     0   37    2     1     4     7   66      4
3     2     4    1  7545    2   28     5   481   366    2      4
4     1     1   38     0  375    1     1     5    17    9     91
5     0     0    2    44    0  425     0     0     6   43      1
6     8     0    2     2    5    0  1848     5    11    3     24
7     2    39   11   102    9    0     4  6867   192    3     36
8     1     0    6    51   46    5     4    59  3062    2     60
9     3     1   26     6    2  134     0     1    10  308      2
10    6     2    6    11  176    2    19    11    31    1  12531
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6062408, 'precision': 0.6415268, 'recall': 0.5052968, 'specificity': 0.9592527, 'f1': 0.47832465, 'auroc': 0.8512319}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   86     0   0   18    0    0   808    26    23  180    29
1    0  1202   0   30    0    0    18   170     5    0    74
2    0     4  17   21   65   15    84    49   352   80   328
3    0     0   0    0    0    0     0     0     0    0     0
4    0     1   1    0  240    0    11     1    20    0  1359
5    0     0   0  173    0  280    10     0    25  103     1
6    4     0   1    1    4    1  2371     2    13    2   668
7    0     2   0    4    0    0    66  1070    11    0    11
8    0     0   1   40    5    3    13     3  1287    9     9
9    1    16  10  136    2   56    80   116   200  483    37
10   0     1   0    0   15    0     1     0     0    0  1629
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-11 16:08:12.013014,epoch time: 0:35:54.077132,used: 3:37:32.856886,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94180757, 'precision': 0.85847384, 'recall': 0.8307706, 'specificity': 0.9937941, 'f1': 0.8410283, 'auroc': 0.9956739}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   381     0    0     3    1    1    20    12    11    2     52
1     0  1280    0    10    0    0     0    34     4    0      3
2     1     2  207     0   28    7     0    11     8   46      2
3     1     3    0  7929    0   11     1   290   203    0      0
4     4     2   37     0  326    2     2     4    59    9     94
5     0     0    0    45    0  435     1     0     6   32      1
6     8     1    2     3    1    3  1831     9    19    4     27
7     0    21    0   127    2    0     2  7009    92    1     10
8     1     0    6    93    3    1     5    87  3086    0     14
9     4     0   40    11    1  163     2     7    14  250      0
10   12     3    4     7   82    3    26    33   152    4  12467
---- Validation: 
scalar performance:
{'acc': 0.9406714, 'precision': 0.85586786, 'recall': 0.8255838, 'specificity': 0.9936714, 'f1': 0.83690107, 'auroc': 0.99588954}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   375     0    1     5    1    3    17    12     8   10     51
1     0  1268    0    13    0    0     1    45     2    0      3
2     2     0  193     3   25    4     2     7    11   63      2
3     0     4    0  7904    0   14     2   320   195    1      0
4     3     0   38     0  328    3     0     9    57    5     96
5     0     0    0    42    0  438     0     0     9   31      1
6     8     1    0     4    0    2  1838     7    14    2     32
7     3    22    1   108    0    0     2  6996   112    1     20
8     3     6    3    76    3    2     2    90  3099    1     11
9     4     1   35    10    1  174     1     8     9  250      0
10    6     7    5     4   75    3    22    31   163    2  12478
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5339677, 'precision': 0.59864867, 'recall': 0.44998458, 'specificity': 0.9529675, 'f1': 0.40708995, 'auroc': 0.8396977}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   58     0   0   97   0   10   608   117    23  243    14
1    0  1164   0   37   0    0     2   235     3    0    58
2    0    10   5  113   5   32    39   143   432   62   174
3    0     0   0    0   0    0     0     0     0    0     0
4    0     5   1    1  72    0     5     3   109    1  1436
5    0     0   0  314   0  232     3     0    15   27     1
6    7     0   1    9   1    2  1869    14   216   11   937
7    0     3   0    6   0    0    11  1139     1    0     4
8    0     0   0  134   0    2     2    19  1210    1     2
9    0    29   2  448   0  103    17   201    76  249    12
10   0     1   0    0   7    0     0     0     4    0  1634
better model found
persisted
after epoch: 7,now: 2024-08-11 16:44:10.521406,epoch time: 0:35:58.508392,used: 4:13:31.365278,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9444028, 'precision': 0.8538785, 'recall': 0.85665447, 'specificity': 0.9940804, 'f1': 0.8535671, 'auroc': 0.9962819}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    0     1    1    0    26     3     2    5     50
1     0  1272    2    14    2    0     2    30     5    0      5
2     3     0  221     0   47    0     0     3     5   30      3
3     4     3    1  7891    1   41    13   168   298   10      9
4     1     0   26     0  387    1     3     1    14    8     98
5     1     0    1    24    0  440     1     0     8   43      2
6     9     0    1     2    2    0  1860     1     6    2     25
7     2    24   22   150   10    0    12  6802   187    7     48
8     3     1    5    46   22    2    12    32  3105    3     64
9     4     0   56     2    2  119     1     0    11  297      1
10    6     2    4     6  104    2    12     4    19    4  12629
---- Validation: 
scalar performance:
{'acc': 0.9435335, 'precision': 0.8525422, 'recall': 0.8561266, 'specificity': 0.99397665, 'f1': 0.8524984, 'auroc': 0.9963769}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   395     0    0     1    1    1    19     1     4    4     57
1     0  1271    1    10    0    0     2    35     9    0      4
2     1     0  221     0   43    1     2     1     2   38      3
3     6     3    1  7878    2   34    11   171   322    8      4
4     2     0   27     0  393    1     2     3    11    6     94
5     1     0    1    20    0  443     0     0     8   47      1
6     8     0    0     3    3    2  1858     1     5    3     25
7     4    21   19   148   11    0     8  6795   192    3     64
8     1     0    8    50   29    1     8    31  3097    7     64
9     4     0   65     7    2  118     0     2     4  290      1
10    6     2    7     6   98    2     9     8    25    0  12633
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57678586, 'precision': 0.63462937, 'recall': 0.47599673, 'specificity': 0.9564781, 'f1': 0.45386565, 'auroc': 0.84223586}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   103     0   1   31    0    1   799    23    13  162    37
1     1  1106   0   40    0    0    15   214     3    2   118
2     0     2  10   44   34   10    64    38   362   85   366
3     0     0   0    0    0    0     0     0     0    0     0
4     0     1   1    0  173    0     6     1    21    0  1430
5     0     0   0  267    0  191    17     0    27   89     1
6     2     0   0    2    2    1  2227     2    16    1   814
7     0     1   0   15    0    0    58  1062     7    4    17
8     0     0   1   67    1    1    18     0  1263    6    13
9     0    11   9  254    3   49    76    79   134  478    44
10    0     0   0    0   15    0     0     0     0    0  1631
better model found
persisted
after epoch: 8,now: 2024-08-11 17:20:22.624628,epoch time: 0:36:12.103222,used: 4:49:43.468500,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94863015, 'precision': 0.8833317, 'recall': 0.8561084, 'specificity': 0.9943998, 'f1': 0.867743, 'auroc': 0.99638784}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   399     0    0     2    0    0     5     2     3    3     69
1     0  1252    1    11    2    0     0    55     6    1      4
2     1     0  193     0   47    2     0     6     2   56      5
3     1     1    1  7880    0   22     2   214   313    2      3
4     2     0   19     0  364    3     0     2    22    8    119
5     1     0    1    18    1  408     0     0     7   84      1
6     4     0    0     0    5    0  1831     3     7    3     55
7     3    12    3   126    6    0     1  6962   112    5     34
8     0     0    2    54   14    3     2    56  3114    3     47
9     4     0   25     6    1   59     1     1     5  388      3
10    4     0    0     5   66    1     6     9    32    2  12665
---- Validation: 
scalar performance:
{'acc': 0.9487227, 'precision': 0.8827323, 'recall': 0.85264844, 'specificity': 0.99440336, 'f1': 0.8654237, 'auroc': 0.9968406}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    0     2    0    0    10     3     4    2     75
1     0  1263    0     7    1    0     0    47     8    1      5
2     0     0  181     0   59    1     1     6     4   58      2
3     2     1    1  7880    1   19     2   226   300    2      6
4     1     0   13     0  383    2     1     2    15    6    116
5     0     0    0    21    0  404     1     0     7   87      1
6     7     0    1     3    4    1  1836     2     4    4     46
7     2     6    3   127    2    0     4  6962   119    4     36
8     0     0    5    59   13    1     0    53  3110    3     52
9     2     0   35     4    1   58     0     1     8  382      2
10    1     0    1     6   61    2     5    10    29    1  12680
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51731616, 'precision': 0.6508664, 'recall': 0.44303104, 'specificity': 0.9509332, 'f1': 0.4178766, 'auroc': 0.83765936}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   171    0   0   57    0    0   535    88     8  228    83
1     2  984   0   38    0    0     6   338     2    0   129
2     0    1   4   57   14    3    17    85   299   76   459
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0  136    0     1     2    39    0  1455
5     0    0   0  278    0  131     4     2    25  150     2
6     4    0   0    2    1    0  1505     5    44    0  1506
7     0    0   0   10    0    0    11  1127     3    0    13
8     0    0   1   84    0    0     6    10  1251    4    14
9     2    8   1  290    0   15    30   163   100  454    74
10    0    0   0    0   13    0     0     0     2    0  1631
better model found
persisted
after epoch: 9,now: 2024-08-11 17:56:36.157308,epoch time: 0:36:13.532680,used: 5:25:57.001180,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9482823, 'precision': 0.87210345, 'recall': 0.84996283, 'specificity': 0.9945211, 'f1': 0.8569373, 'auroc': 0.9969932}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     2    0    0    19     1     2    4     35
1     0  1283    1     9    0    0     1    31     4    0      3
2     1     0  181     0   30    6     3     1     5   83      2
3     3     4    0  7965    1   20    14   133   288    3      6
4     2     0   24     0  336    4     4     1    39    9    120
5     0     0    0    26    0  454     0     0     8   32      1
6    10     0    0     1    1    1  1869     1     4    3     17
7    13    17    5   157    1    0    11  6818   213    4     24
8     3     0    3    51    2    2     5    21  3172    5     31
9     2     0   14     5    1  153     0     1     7  310      0
10   12     3    1     5   37    4    32     8    55    2  12635
---- Validation: 
scalar performance:
{'acc': 0.94891, 'precision': 0.8739346, 'recall': 0.8502083, 'specificity': 0.99458694, 'f1': 0.85737014, 'auroc': 0.99726593}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     2    0    0    21     2     2    2     29
1     0  1285    0    10    0    0     0    29     5    0      3
2     1     1  166     1   34    4     2     4     7   88      4
3     5     6    0  7961    0   16    10   145   292    2      3
4     4     0   23     0  344    1     6     2    31   13    115
5     0     0    0    20    0  459     0     0     8   33      1
6     7     0    0     1    0    1  1872     1     5    4     17
7    11    17    3   165    2    0     6  6823   206    4     28
8     0     0    1    46    3    3     6    20  3184    4     29
9     2     0   11     3    1  149     0     2    10  315      0
10   15     2    2     6   41    3    25    10    47    4  12641
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5732876, 'precision': 0.5977539, 'recall': 0.46562773, 'specificity': 0.95619345, 'f1': 0.43725878, 'auroc': 0.8397832}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   160     0   0   39   0    0   741    34     7  165    24
1     3  1039   0   38   0    0    25   285     8    0   101
2     0     1   0   63   6    8   125    39   381   79   313
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    0  52    0    12     1    33    0  1534
5     0     0   0  273   0  161    20     0    26  111     1
6     2     0   0    2   0    1  2391     4    20    0   647
7     1     0   0    8   0    0    37  1099     9    0    10
8     0     0   0   91   0    0    27     5  1232    3    12
9     1    11   0  308   0   35   100    80   149  418    35
10    0     0   0    0   2    0     0     0     2    0  1642
better model found
persisted
after epoch: 10,now: 2024-08-11 18:32:47.076969,epoch time: 0:36:10.919661,used: 6:02:07.920841,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:02:07.920841 at 2024-08-11 18:32:47.076969
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5732876, 'precision': 0.5977539, 'recall': 0.46562773, 'specificity': 0.95619345, 'f1': 0.43725878, 'auroc': 0.8397832}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   160     0   0   39   0    0   741    34     7  165    24
1     3  1039   0   38   0    0    25   285     8    0   101
2     0     1   0   63   6    8   125    39   381   79   313
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    0  52    0    12     1    33    0  1534
5     0     0   0  273   0  161    20     0    26  111     1
6     2     0   0    2   0    1  2391     4    20    0   647
7     1     0   0    8   0    0    37  1099     9    0    10
8     0     0   0   91   0    0    27     5  1232    3    12
9     1    11   0  308   0   35   100    80   149  418    35
10    0     0   0    0   2    0     0     0     2    0  1642
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6062408, 'precision': 0.6415268, 'recall': 0.5052968, 'specificity': 0.9592527, 'f1': 0.47832465, 'auroc': 0.8512319}
confusion matrix:
    0     1   2    3    4    5     6     7     8    9     10
0   86     0   0   18    0    0   808    26    23  180    29
1    0  1202   0   30    0    0    18   170     5    0    74
2    0     4  17   21   65   15    84    49   352   80   328
3    0     0   0    0    0    0     0     0     0    0     0
4    0     1   1    0  240    0    11     1    20    0  1359
5    0     0   0  173    0  280    10     0    25  103     1
6    4     0   1    1    4    1  2371     2    13    2   668
7    0     2   0    4    0    0    66  1070    11    0    11
8    0     0   1   40    5    3    13     3  1287    9     9
9    1    16  10  136    2   56    80   116   200  483    37
10   0     1   0    0   15    0     1     0     0    0  1629
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142409_instance_wise_predictions.txt
accuracy from prediction file 0.5732876233121108
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/27.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/27.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/27.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496026 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool | 405312 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |  90714 KiB |    127 MiB |    914 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 496026 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool | 405312 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |  90714 KiB |    127 MiB |    914 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10868 MiB | 598032 GiB | 598032 GiB |
|       from large pool | 387840 KiB |  10797 MiB | 597121 GiB | 597121 GiB |
|       from small pool |  90258 KiB |    126 MiB |    911 GiB |    911 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11236 MiB |  11236 MiB |  11236 MiB |      0 B   |
|       from large pool |  11108 MiB |  11108 MiB |  11108 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 239205 KiB |    849 MiB | 278093 GiB | 278092 GiB |
|       from large pool | 229568 KiB |    835 MiB | 277123 GiB | 277123 GiB |
|       from small pool |   9637 KiB |     15 MiB |    969 GiB |    969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   44633 K  |   44630 K  |
|       from large pool |      87    |     490    |   20876 K  |   20876 K  |
|       from small pool |    2922    |    4522    |   23756 K  |   23753 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   44633 K  |   44630 K  |
|       from large pool |      87    |     490    |   20876 K  |   20876 K  |
|       from small pool |    2922    |    4522    |   23756 K  |   23753 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     284    |     284    |     284    |       0    |
|       from large pool |     220    |     220    |     220    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     998    |   19311 K  |   19311 K  |
|       from large pool |      14    |     112    |   10076 K  |   10076 K  |
|       from small pool |      22    |     984    |    9235 K  |    9235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10868 MiB | 598032 GiB | 598032 GiB |
|       from large pool |  16640 KiB |  10797 MiB | 597121 GiB | 597121 GiB |
|       from small pool |      0 KiB |    126 MiB |    911 GiB |    911 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 735232 KiB |  11236 MiB |  11236 MiB |  10518 MiB |
|       from large pool | 634880 KiB |  11108 MiB |  11108 MiB |  10488 MiB |
|       from small pool | 100352 KiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    849 MiB | 278093 GiB | 278093 GiB |
|       from large pool |  59136 KiB |    835 MiB | 277123 GiB | 277123 GiB |
|       from small pool |      0 KiB |     29 MiB |    969 GiB |    969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   44633 K  |   44633 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23756 K  |   23756 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   44633 K  |   44633 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23756 K  |   23756 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     284    |     284    |     209    |
|       from large pool |      26    |     220    |     220    |     194    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     998    |   19312 K  |   19312 K  |
|       from large pool |       3    |     112    |   10076 K  |   10076 K  |
|       from small pool |       0    |     984    |    9236 K  |    9236 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    914 GiB |    914 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10868 MiB | 598032 GiB | 598032 GiB |
|       from large pool |  16640 KiB |  10797 MiB | 597121 GiB | 597121 GiB |
|       from small pool |      0 KiB |    126 MiB |    911 GiB |    911 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 735232 KiB |  11236 MiB |  11236 MiB |  10518 MiB |
|       from large pool | 634880 KiB |  11108 MiB |  11108 MiB |  10488 MiB |
|       from small pool | 100352 KiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    849 MiB | 278093 GiB | 278093 GiB |
|       from large pool |  59136 KiB |    835 MiB | 277123 GiB | 277123 GiB |
|       from small pool |      0 KiB |     29 MiB |    969 GiB |    969 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   44633 K  |   44633 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23756 K  |   23756 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   44633 K  |   44633 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23756 K  |   23756 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     284    |     284    |     209    |
|       from large pool |      26    |     220    |     220    |     194    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     998    |   19312 K  |   19312 K  |
|       from large pool |       3    |     112    |   10076 K  |   10076 K  |
|       from small pool |       0    |     984    |    9236 K  |    9236 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409

 Experiment start at: 2024-08-11 18:47:36.712617
before training, model accuracy: 0.06982439011335373
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.81787777, 'precision': 0.50784624, 'recall': 0.43875578, 'specificity': 0.97916955, 'f1': 0.4293911, 'auroc': 0.9560652}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    6   0    16   0   0   300    18    48   0     95
1    0  947   0    15   0   0     0   317    12   0     41
2    0    1   0     8   0   0   138    21    74   0     70
3    0   19   0  7233   0   0     7   509   639   0     31
4    0    4   0     3   0   0    85    10    57   0    380
5    0    0   0   326   0   9    95     7    80   2      2
6    0    5   0    13   0   0  1334    33   104   0    418
7    0   81   0   435   0   0    11  6148   304   0    284
8    0   10   0   200   0   0   127   116  2345   0    497
9    0    0   0   104   0   5   221    19   133   1     10
10   0   25   0    10   0   0    87    56    63   0  12552
---- Validation: 
scalar performance:
{'acc': 0.82011503, 'precision': 0.4857961, 'recall': 0.44231504, 'specificity': 0.9794558, 'f1': 0.4329009, 'auroc': 0.95582134}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    3   0    17   0   4   299    20    47   0     93
1    0  943   0    11   0   0     0   321    10   0     47
2    0    2   0    10   0   0   149    18    67   0     66
3    0   19   0  7253   0   0    10   500   626   0     32
4    0    1   0     3   0   0    87     7    59   0    382
5    0    0   0   323   0  16    87     2    90   1      2
6    0    9   0    16   0   0  1348    29   110   0    396
7    0   99   0   451   0   0    16  6121   308   0    270
8    0    6   0   159   0   0   102   117  2432   0    480
9    0    2   0   125   0   2   221    22   117   0      4
10   0   30   0    13   0   0    84    62    60   0  12547
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3794165, 'precision': 0.2526922, 'recall': 0.28445083, 'specificity': 0.9337704, 'f1': 0.24377377, 'auroc': 0.7464331}
confusion matrix:
    0    1   2    3   4   5     6    7    8   9     10
0    0    0   0    4   0   0  1125    0   38   0     3
1    0  976   0   16   0   0    70   48   63   0   326
2    0    2   0   19   0   0   626    3  140   0   225
3    0    0   0    0   0   0     0    0    0   0     0
4    0    0   0    0   0   0    51    0    3   0  1579
5    0    0   0  337   0   0    91    0  163   0     1
6    0    0   0    0   0   0  1610    1   14   0  1442
7    0  120   0    4   0   0   234  646   81   0    79
8    0    0   0   40   0   0   665    1  546   0   118
9    0   11   0  107   0   0   524    8  463   0    24
10   0    0   0    0   0   0     1    0    0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 19:24:53.796001,epoch time: 0:37:17.083384,used: 0:37:17.083384,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88128746, 'precision': 0.74052274, 'recall': 0.617486, 'specificity': 0.9867271, 'f1': 0.6281324, 'auroc': 0.9826657}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   113     0   1    11   1   25   101    14    26  100     91
1     0  1041   0    27   0    0     0   236     9    1     17
2     3     1  33    11  10    8     1    24    49  121     51
3     0     5   0  7689   0   58     1   327   350    1      7
4     8     0   2     2  13    5    11     5    85   28    380
5     0     0   1    98   0  361     0     0     8   52      1
6    15     6   1    14   1    8  1608    17    64   22    151
7     0    67   0   388   0    0     3  6426   272    2    107
8     0     2   1   170   2    5     6    84  2883   10    130
9     0     3   9    35   0  166     5    10    33  226      6
10   11     6   3    12   0    1    38    59   113    5  12546
---- Validation: 
scalar performance:
{'acc': 0.882921, 'precision': 0.7472839, 'recall': 0.6164186, 'specificity': 0.9869272, 'f1': 0.6249656, 'auroc': 0.9822147}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   86     1   1    13   0   24   110    18    27  110     93
1    0  1035   0    22   0    1     0   249    10    1     14
2    4     2  34     6   7    6     3    18    54  119     59
3    0     4   0  7701   0   47     0   335   346    2      5
4    8     0   3     2  14    7     6     6   101   29    363
5    1     0   0    94   0  366     0     0    11   48      1
6   23     8   0    13   0    8  1612    20    57   25    142
7    0    58   1   364   0    2     5  6482   241    1    111
8    0     1   0   184   0    6     8    82  2882   11    122
9    0     2  12    27   1  161     1    12    33  238      6
10  10     7   0    11   1    1    41    48   112    7  12558
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48296368, 'precision': 0.4832341, 'recall': 0.41417873, 'specificity': 0.94686544, 'f1': 0.37147436, 'auroc': 0.8160915}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   21     1   0   12   0   36   834    5    92  153    16
1    0  1143   0   29   0    0    17   95    66    0   149
2    0     9   1   32   0   28    57   11   467   64   346
3    0     0   0    0   0    0     0    0     0    0     0
4    0     1   0    0   0    0     8    0    15    0  1609
5    0     0   0  239   0  287     9    0    35   21     1
6    4     1   0    1   0    0  1564    1    92   14  1390
7    0    82   0    8   0    0    75  858    97    3    41
8    0     0   0   90   0    5    12    0  1163   15    85
9    1    17   2  196   0  149    43   15   460  221    33
10   0     1   0    0   0    0     0    0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 20:01:00.484654,epoch time: 0:36:06.688653,used: 1:13:23.772037,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9054741, 'precision': 0.79205227, 'recall': 0.72989035, 'specificity': 0.9896303, 'f1': 0.75386274, 'auroc': 0.98907447}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   235     0    2     6    4    0   118     8     8    4     98
1     0  1182    3    10    0    1     2   112     9    0     13
2     7     1  148     0   69    1     5     1    17   45     18
3     1     3    0  7457    1   25    21   426   495    6      5
4     2     0   15     0  221    1     8     2    34    8    247
5     8     0    3    77    1  296     4     0    10  119      3
6    15     1    0     1    1    1  1821     7    10    4     47
7     2    20    7   201    7    0     9  6650   256    2    109
8     1     0    8    80   34    2    40    67  2940    2    122
9    17     1   70    14   10   66     7     2    19  281      6
10   12     8    1     9   27    3    53    22    43    0  12612
---- Validation: 
scalar performance:
{'acc': 0.90774375, 'precision': 0.7983154, 'recall': 0.7374078, 'specificity': 0.9898393, 'f1': 0.76127183, 'auroc': 0.98970985}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   242     0    3     5    2    1    98     6    10    9    107
1     0  1198    1    10    1    0     0    96     7    0     19
2     4     1  150     1   68    0     3     7    10   52     16
3     0     4    0  7486    0   31    21   409   477    6      6
4     6     0   13     2  238    0     8     2    27    9    234
5    10     0    3    66    1  309     2     0    10  118      2
6     8     1    1     4    0    1  1818     8    13    3     51
7     1    19    6   179    5    0     8  6694   236    1    116
8     0     3    9    91   38    0    39    63  2910    3    140
9    24     1   76    20    4   49    12     4    16  279      8
10    8     4    2     8   36    1    57    19    48    1  12612
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5113692, 'precision': 0.55698824, 'recall': 0.4051294, 'specificity': 0.9489072, 'f1': 0.37395304, 'auroc': 0.8343005}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0   73     1   0    5   0   0  1017    1    36    8    29
1    0  1199   0   24   0   0    22   93    26    0   135
2    1    11  17   15  18   3   120   17   221   13   579
3    0     0   0    0   0   0     0    0     0    0     0
4    0     0   0    0  11   0     5    0     8    0  1609
5    0     0   0  255   0  90    92    0   104   48     3
6    5     2   0    1   0   0  2089    1     4    0   965
7    1    23   2    3   0   0   143  897    39    0    56
8    0     0   1   26   4   0    43    1  1105    0   190
9   10    29  57   98   8  11   177   32   431  183   101
10   0     0   0    0   1   0     0    0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 20:37:12.460301,epoch time: 0:36:11.975647,used: 1:49:35.747684,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9187714, 'precision': 0.80230534, 'recall': 0.78807986, 'specificity': 0.9911324, 'f1': 0.7928203, 'auroc': 0.9913637}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   326     3    2    10    2    1    42     6     2    3     86
1     0  1206    3    24    0    0     2    80     8    0      9
2     6     0  179     2   52    1     2     2     3   62      3
3     3    13    1  7906    0   66     9   205   219    7      7
4     2     0   33     1  301    3     6     2    20    8    163
5     2     0    2    46    0  418     2     0     5   45      1
6    31     4    1     8    3    6  1800     6     8    3     36
7     4    68   20   374    4    3    12  6500   193    2     84
8     4     4   18   151   37    6    34    47  2872    8    114
9     6     1   51    14    1  148     2     3     7  258      2
10   10    13    6     7   95    2    24    29    35    0  12574
---- Validation: 
scalar performance:
{'acc': 0.9196737, 'precision': 0.8038136, 'recall': 0.785554, 'specificity': 0.991213, 'f1': 0.79239035, 'auroc': 0.99153}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   319     3    2     2    2    4    42     6     6    6     91
1     0  1206    0    27    0    0     3    82     8    0      6
2     4     0  170     1   57    5     2     1     6   63      3
3     1    14    1  7944    2   56    11   176   224    8      3
4     2     0   28     0  315    3     3     2    18    9    159
5     1     0    1    43    0  413     1     0     9   52      1
6    34     1    3     7    4    1  1792    10     5    4     47
7     3    53   22   362    3    0     8  6522   185    5    102
8     3     3    6   154   45   15    31    58  2863    5    113
9     0     0   53    11    5  145     6     5     7  258      3
10   14    31    6     9   82    2    22    22    28    0  12580
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55558664, 'precision': 0.62321496, 'recall': 0.44922423, 'specificity': 0.95383024, 'f1': 0.43625683, 'auroc': 0.8452754}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   170     1   0   15   0    1   869    1    18   38    57
1     0  1296   0   30   0    0    10   63    16    0    84
2     1    23  19   30  21   10    88   14   257   43   509
3     0     0   0    0   0    0     0    0     0    0     0
4     0     2   0    0  86    0     6    0    11    0  1528
5     1     0   0  267   0  193    50    1    30   49     1
6     7     3   0    1   2    0  2284    1     7    2   760
7     0    92   1   27   0    0   201  772    26    1    44
8     0     0   1   66   4    0    33    0  1156    7   103
9     2    47  30  195   3   49   126   22   277  326    60
10    0     1   0    0   6    0     0    0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 21:13:13.595805,epoch time: 0:36:01.135504,used: 2:25:36.883188,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.927226, 'precision': 0.840903, 'recall': 0.8017962, 'specificity': 0.9921877, 'f1': 0.81838757, 'auroc': 0.9939305}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   347     2    1     4    3    1    44    14     7    0     59
1     0  1221    2     9    0    0     0    90     5    0      5
2     5     0  179     1   49    2     3     8    17   44      4
3     2    11    0  7560    0    6     1   457   395    1      3
4     4     2   29     0  324    3     2     4    46    6    119
5     3     0    3    65    0  382     0     0    19   48      1
6    15     1    2     5    1    0  1806     9    22    2     44
7     0    18    2   104    2    0     3  6994   113    0     28
8     0     3    3    63   12    1     5    90  3092    0     27
9     5     0   49    15    5  109     2     8    23  274      3
10   14    25    3     6   86    2    22    32   127    0  12477
---- Validation: 
scalar performance:
{'acc': 0.9296242, 'precision': 0.837435, 'recall': 0.80476856, 'specificity': 0.9924694, 'f1': 0.8187503, 'auroc': 0.99400854}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   353     1    1     3    2    0    34    15    11    2     61
1     0  1225    2    10    0    0     1    82     7    0      5
2     3     1  182     0   57    3     4     5    12   44      1
3     1    11    0  7632    0    9     3   435   347    0      2
4     1     2   23     0  334    1     4     4    44    8    118
5     2     1    1    64    0  376     1     0    17   57      2
6    12     2    1     1    1    2  1829    10    15    1     34
7     2    23    2    99    1    0     2  6973   138    1     24
8     1     5    5    67   11    0     2    87  3095    0     23
9     7     0   60    16    2  108     2     6    23  266      3
10   23    21    3     6   99    1    24    35    95    0  12489
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5561464, 'precision': 0.6410544, 'recall': 0.44124418, 'specificity': 0.95450485, 'f1': 0.39045942, 'auroc': 0.84611887}
confusion matrix:
     0     1   2    3   4   5     6     7     8    9     10
0   100     0   1   22   0   1   805    71   106   11    53
1     0  1237   0   27   0   0     4   163    10    0    58
2     1    16   4   48   2   5    54    75   524   17   269
3     0     0   0    0   0   0     0     0     0    0     0
4     0     4   0    0  83   0     4     1    58    0  1483
5     0     0   0  363   0  84    27     4    94   19     1
6     6     3   0    2   1   0  2274     4    70    0   707
7     0     8   0    6   0   0    14  1120     9    0     7
8     0     0   0   54   0   0     5    18  1285    0     8
9     0    29   3  233   0  18    71   196   442  126    19
10    0     1   0    0   6   0     0     0     3    0  1636
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 21:49:26.231379,epoch time: 0:36:12.635574,used: 3:01:49.518762,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9327911, 'precision': 0.83041584, 'recall': 0.82717276, 'specificity': 0.9929472, 'f1': 0.8260484, 'auroc': 0.9939567}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   357     2    1     2    1    4    39     3     9    8     57
1     0  1258    0    12    1    0     0    45     9    1      5
2     0     0  166     0   39    0     1     2     4   99      1
3     1    25    1  7790    1   53     7   243   303   10      3
4     1     0   39     1  338    1     3     3    37   15    100
5     0     1    1    27    0  419     1     0    11   60      1
6     7     5    0     1    1    1  1858     3    11    5     16
7     2    49   10   195    2    0     9  6769   200    4     24
8     1     8    5    63   11    7    11    53  3102    9     25
9     1     0   18     4    1  105     2     2    10  348      2
10   10    35    9     5  140    1    23    22    87    3  12459
---- Validation: 
scalar performance:
{'acc': 0.93224555, 'precision': 0.83012676, 'recall': 0.8216905, 'specificity': 0.9928812, 'f1': 0.82230115, 'auroc': 0.9942905}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     1    0     1    1    1    49     5     9   10     60
1     0  1259    0    13    0    0     0    48    10    0      2
2     0     2  154     1   39    1     3     2    10   98      2
3     2    27    0  7766    0   67    10   246   313    7      2
4     2     2   38     1  341    2     1     4    32   11    105
5     0     2    0    19    0  424     0     0     8   67      1
6     6     4    0     3    1    2  1845     2    13    7     25
7     2    50    5   184    6    0     5  6787   195    9     22
8     2     7    3    70    7    4     8    60  3107    6     22
9     3     0   22     4    0  107     2     1     9  344      1
10    9    25   10     6  117    2    29    24    91    4  12479
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5879102, 'precision': 0.65714747, 'recall': 0.4764737, 'specificity': 0.9576418, 'f1': 0.44252175, 'auroc': 0.84931046}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   58     0   0   18   0    2   719    8    71  169   125
1    0  1275   0   32   0    0    10   94    28    0    60
2    1    13   7   32  20   10    29   15   552   91   245
3    0     0   0    0   0    0     0    0     0    0     0
4    0     4   0    0  84    0     4    0    60    0  1481
5    0     0   0  240   0  238    10    0    33   70     1
6    2     2   0    1   1    1  2514    1    53    3   489
7    0    24   0   23   0    0   157  888    64    2     6
8    0     0   0   61   0    3     3    2  1287    2    12
9    0    29   2  182   0   71    38   28   360  412    15
10   0     1   0    0   3    0     1    0     1    0  1640
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-11 22:25:36.367981,epoch time: 0:36:10.136602,used: 3:37:59.655364,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94368047, 'precision': 0.8561197, 'recall': 0.83718526, 'specificity': 0.9939153, 'f1': 0.8448934, 'auroc': 0.9953813}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   380     1    0     4    1    0    20     4     4    2     67
1     0  1267    0    12    0    0     0    42     5    0      6
2     2     0  170     1   43    0     1     2     8   82      3
3     0    13    2  8061    0   22     1   166   163    4      5
4     2     1   26     0  365    2     0     3    20   13    107
5     0     0    0    42    0  417     0     0     4   57      1
6    10     1    0     4    6    1  1845     2    10    4     24
7     3    35    4   225    6    0     1  6800   149    4     38
8     0     4    2   118   23    2     3    50  3047    4     43
9     2     0   29    12    1  106     0     2     3  336      2
10    8    17    5     7  115    1    10     8    36    1  12583
---- Validation: 
scalar performance:
{'acc': 0.9433998, 'precision': 0.85479987, 'recall': 0.83564925, 'specificity': 0.9938921, 'f1': 0.84342664, 'auroc': 0.9952067}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     3    1     5    2    1    15     3     8    4     67
1     0  1252    0    16    0    0     0    54     5    0      5
2     0     0  168     2   47    1     1     1     8   83      1
3     3    12    2  8070    1   16     4   167   157    4      4
4     2     1   24     2  372    1     1     3    22   10    101
5     1     0    2    36    0  429     0     0     8   44      1
6    12     5    2     2    3    0  1837     5    11    1     30
7     3    34    8   218    4    0     5  6825   138    2     28
8     2     2    5   118   21    2     6    52  3036    1     51
9     1     0   25    14    2  119     2     0     3  327      0
10    8    12    3     8  119    1    11    11    42    2  12579
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55985445, 'precision': 0.6488521, 'recall': 0.4527406, 'specificity': 0.9552039, 'f1': 0.42425093, 'auroc': 0.8453548}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   122     0   0   51   0    0   622    41    47  112   175
1     0  1283   0   41   0    0     3    93     7    0    72
2     1    29   7   50  26    2    18    29   427   65   361
3     0     0   0    0   0    0     0     0     0    0     0
4     0     3   0    0  74    0     2     1    34    0  1519
5     0     0   0  373   0  111    11     2    19   74     2
6     2     3   0    2   2    0  2171     2    39    1   845
7     0    20   0   33   0    0    53  1029    15    0    14
8     0     1   0  106   0    1     3     8  1231    1    19
9     0    44   3  321   1   28    33    67   271  333    36
10    0     1   0    0   4    0     0     0     0    0  1641
better model found
persisted
after epoch: 7,now: 2024-08-11 23:01:42.983803,epoch time: 0:36:06.615822,used: 4:14:06.271186,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9457941, 'precision': 0.8670405, 'recall': 0.8376564, 'specificity': 0.99402475, 'f1': 0.8494488, 'auroc': 0.99563634}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   367     3    0     2    2    2    17     7     1    4     78
1     0  1285    1     7    0    0     1    29     5    0      4
2     2     1  185     0   44    0     2     3     2   69      4
3     2    24    0  7928    0   40     4   255   174    3      7
4     2     2   26     0  332    1     0     6    10   11    148
5     1     0    0    19    0  447     0     0     4   49      1
6     5     3    2     0    2    1  1831     5     5    5     49
7     1    58    4   114    2    0     5  6969    68    6     35
8     1     4    3    76   22    3    12    71  2992    6    106
9     2     0   27     6    2  119     1     1     3  327      5
10    4    25    3     6   33    1     4    16    14    1  12687
---- Validation: 
scalar performance:
{'acc': 0.943373, 'precision': 0.8600141, 'recall': 0.8333973, 'specificity': 0.99377096, 'f1': 0.84386986, 'auroc': 0.9953285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     5    0     2    0    3    15     5     2    5     72
1     0  1287    0     7    0    0     1    27     7    0      3
2     0     1  185     0   43    0     1     3     3   71      5
3     0    22    0  7925    0   44     4   262   175    5      3
4     1     1   28     1  320    2     2     3    12    9    160
5     0     0    0    25    0  444     0     0     2   48      2
6     8     5    2     2    3    2  1838     2     5    4     37
7     2    65    5   142    2    0     3  6935    58    6     47
8     1     6    4    76   18    5    11    83  2981    5    106
9     2     1   29     5    3  125     2     4     6  314      2
10    3    28    0     6   56    1     9    16    11    1  12665
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56615126, 'precision': 0.68993664, 'recall': 0.45567977, 'specificity': 0.955418, 'f1': 0.41454345, 'auroc': 0.8423413}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   70     0   0   30   0    0   796    28    36   44   166
1    0  1332   0   31   0    0     3    74     5    0    54
2    0    48   1   35   4    2    28    29   402   38   428
3    0     0   0    0   0    0     0     0     0    0     0
4    0     8   0    0  19    0     2     2    24    0  1578
5    0     0   0  298   0  148    17     7    44   75     3
6    1     4   0    2   0    1  2310     2    30    0   717
7    0    36   0   12   0    0    40  1048    13    0    15
8    0     1   0   61   0    1     8    11  1255    0    33
9    0    75   0  213   0   21    43   106   355  265    59
10   0     1   0    0   1    0     0     0     0    0  1644
early stop counter: 1
val acc:0.9433730244636536, best validation acc: 0.9433997869491577, corresponding to test acc:                         0.5598544478416443 / 0.5879101753234863
after epoch: 8,now: 2024-08-11 23:38:01.067700,epoch time: 0:36:18.083897,used: 4:50:24.355083,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94838935, 'precision': 0.8709632, 'recall': 0.8587295, 'specificity': 0.9944985, 'f1': 0.86308444, 'auroc': 0.99619365}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   375     2    1     2    1    1    38     5     4    6     47
1     0  1294    0     9    0    1     0    23     4    0      1
2     1     0  213     0   30    0     3     5     7   52      1
3     1    20    0  8078    0   27    12   137   161    0      1
4     1     2   28     1  371    1     2     2    20    7    104
5     0     0    1    24    1  450     0     0     3   41      1
6     4     7    0     3    1    0  1863     1     4    1     22
7     1    89    4   207    2    0     9  6791   146    3     13
8     2     3    4    99   13    3     6    42  3084    0     38
9     2     0   33     4    1  111     2     3     6  331      0
10    6    37    2     5   86    0    13    18    30    1  12597
---- Validation: 
scalar performance:
{'acc': 0.9470911, 'precision': 0.86395234, 'recall': 0.85445, 'specificity': 0.9943683, 'f1': 0.85762215, 'auroc': 0.9955052}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   384     6    0     2    0    1    27     4     4    4     51
1     0  1291    0     7    0    0     0    24     7    0      3
2     0     0  208     1   29    3     2     3     7   57      2
3     1    28    0  8090    0   24     9   128   160    0      0
4     1     1   34     0  362    2     3     1    24   10    101
5     1     0    0    18    0  452     1     0     5   43      1
6     7     5    0     2    2    0  1863     2     6    0     21
7     5    91    3   226    3    1     9  6770   137    4     16
8     1     4    3    98    9    3    12    50  3083    1     32
9     4     1   34     7    2  116     3     2     4  317      3
10   11    31    2     5   85    0    13    20    39    3  12587
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5672007, 'precision': 0.6852889, 'recall': 0.45222223, 'specificity': 0.9554851, 'f1': 0.4123599, 'auroc': 0.84360594}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   127     0   0   26   0    0   823    26    22   16   130
1     0  1294   0   33   0    0     5   115     8    0    44
2     0    26   1   34   9    2    40    40   492   30   341
3     0     0   0    0   0    0     0     0     0    0     0
4     0     9   0    0  34    0     3     2    47    0  1538
5     0     0   0  287   0  120    41     2    45   92     5
6     1     2   0    1   0    0  2366     2    51    0   644
7     0     8   0   19   0    0    54  1063    13    0     7
8     0     0   0   71   0    0    15     6  1258    2    18
9     0    32   0  270   0   16    74    99   396  202    48
10    0     1   0    0   2    0     0     0     1    0  1642
better model found
persisted
after epoch: 9,now: 2024-08-12 00:13:58.752277,epoch time: 0:35:57.684577,used: 5:26:22.039660,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9498609, 'precision': 0.8766144, 'recall': 0.859083, 'specificity': 0.994682, 'f1': 0.8641965, 'auroc': 0.9966642}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     1    1     2    1    0    37     4     3    5     47
1     0  1278    0    10    0    0     0    30    10    0      3
2     0     0  183     0   43    0     2     1     4   77      2
3     1    11    1  8017    0   65     3   120   217    2      0
4     3     1   14     2  382    3     3     1    21    5    104
5     0     0    0     8    0  459     0     0     4   49      1
6     2     4    0     1    2    0  1874     2     4    1     18
7     1    38    5   203    3    1     6  6799   177    7     22
8     1     3    3    65    8    6     6    26  3147    5     26
9     1     0   17     1    2  112     2     2     3  351      2
10    9    18    1     7   48    2    18     6    54    1  12630
---- Validation: 
scalar performance:
{'acc': 0.9499532, 'precision': 0.8747776, 'recall': 0.85719985, 'specificity': 0.99467146, 'f1': 0.86180425, 'auroc': 0.9967853}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   380     3    0     1    2    1    33     2     5    3     53
1     0  1284    1     9    0    1     0    26     5    0      6
2     0     1  173     0   53    2     3     1     3   74      2
3     4    17    0  8032    0   73     7   115   191    0      1
4     2     0   12     1  379    0     2     2    22    7    112
5     0     0    0     6    0  471     1     0     4   38      1
6     5     2    0     2    0    0  1872     2     2    2     21
7     4    32    5   198    5    1     7  6798   185    4     26
8     0     0    4    72   10    7     2    31  3141    3     26
9     0     0   19     2    3  112     2     0     5  349      1
10    5    19    2     6   56    3    16     8    46    0  12635
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59672564, 'precision': 0.6127446, 'recall': 0.4678709, 'specificity': 0.95837647, 'f1': 0.43725652, 'auroc': 0.843188}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   225     0   0   16   0    0   707    5    39   20   158
1     0  1246   0   32   0    0    12  107    17    0    85
2     0    12   0   18  10    1    45   14   488   28   399
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  44    0     7    0    47    0  1534
5     0     0   0  240   0  138    39    0    81   90     4
6     0     0   0    1   0    0  2755    2    27    0   282
7     0     8   0   30   0    0   126  950    37    0    13
8     0     0   0   38   0    0    15    1  1299    0    17
9     1    24   0  181   0   18    77   26   508  232    70
10    0     1   0    0   2    0     1    0     2    0  1640
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-12 00:50:01.798698,epoch time: 0:36:03.046421,used: 6:02:25.086081,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:02:25.086081 at 2024-08-12 00:50:01.798698
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59672564, 'precision': 0.6127446, 'recall': 0.4678709, 'specificity': 0.95837647, 'f1': 0.43725652, 'auroc': 0.843188}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   225     0   0   16   0    0   707    5    39   20   158
1     0  1246   0   32   0    0    12  107    17    0    85
2     0    12   0   18  10    1    45   14   488   28   399
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  44    0     7    0    47    0  1534
5     0     0   0  240   0  138    39    0    81   90     4
6     0     0   0    1   0    0  2755    2    27    0   282
7     0     8   0   30   0    0   126  950    37    0    13
8     0     0   0   38   0    0    15    1  1299    0    17
9     1    24   0  181   0   18    77   26   508  232    70
10    0     1   0    0   2    0     1    0     2    0  1640
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59672564, 'precision': 0.6127446, 'recall': 0.4678709, 'specificity': 0.95837647, 'f1': 0.43725652, 'auroc': 0.843188}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   225     0   0   16   0    0   707    5    39   20   158
1     0  1246   0   32   0    0    12  107    17    0    85
2     0    12   0   18  10    1    45   14   488   28   399
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  44    0     7    0    47    0  1534
5     0     0   0  240   0  138    39    0    81   90     4
6     0     0   0    1   0    0  2755    2    27    0   282
7     0     8   0   30   0    0   126  950    37    0    13
8     0     0   0   38   0    0    15    1  1299    0    17
9     1    24   0  181   0   18    77   26   508  232    70
10    0     1   0    0   2    0     1    0     2    0  1640
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_47_36_seed_1_24142409_instance_wise_predictions.txt
accuracy from prediction file 0.5967256699083467
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/27.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/27.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 497754 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool | 407040 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |  90714 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 497754 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool | 407040 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |  90714 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10868 MiB |   1168 TiB |   1168 TiB |
|       from large pool | 387840 KiB |  10797 MiB |   1166 TiB |   1166 TiB |
|       from small pool |  90258 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11244 MiB |  11244 MiB |  21762 MiB |  10518 MiB |
|       from large pool |  11116 MiB |  11116 MiB |  21604 MiB |  10488 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 286629 KiB |    955 MiB | 547752 GiB | 547752 GiB |
|       from large pool | 276992 KiB |    941 MiB | 545812 GiB | 545812 GiB |
|       from small pool |   9637 KiB |     29 MiB |   1940 GiB |   1940 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   89268 K  |   89265 K  |
|       from large pool |      87    |     490    |   41753 K  |   41753 K  |
|       from small pool |    2922    |    4522    |   47514 K  |   47512 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   89268 K  |   89265 K  |
|       from large pool |      87    |     490    |   41753 K  |   41753 K  |
|       from small pool |    2922    |    4522    |   47514 K  |   47512 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     291    |     291    |     500    |     209    |
|       from large pool |     227    |     227    |     421    |     194    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    1035    |   39014 K  |   39014 K  |
|       from large pool |      19    |     117    |   20582 K  |   20582 K  |
|       from small pool |      20    |    1016    |   18431 K  |   18431 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool |  16640 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool |  16640 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10868 MiB |   1168 TiB |   1168 TiB |
|       from large pool |  16640 KiB |  10797 MiB |   1166 TiB |   1166 TiB |
|       from small pool |      0 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 784384 KiB |  11244 MiB |  21762 MiB |  20996 MiB |
|       from large pool | 684032 KiB |  11116 MiB |  21604 MiB |  20936 MiB |
|       from small pool | 100352 KiB |    128 MiB |    158 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    955 MiB | 547752 GiB | 547752 GiB |
|       from large pool |  59136 KiB |    941 MiB | 545812 GiB | 545812 GiB |
|       from small pool |      0 KiB |     29 MiB |   1940 GiB |   1940 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   89268 K  |   89268 K  |
|       from large pool |       2    |     490    |   41753 K  |   41753 K  |
|       from small pool |       0    |    4522    |   47514 K  |   47514 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   89268 K  |   89268 K  |
|       from large pool |       2    |     490    |   41753 K  |   41753 K  |
|       from small pool |       0    |    4522    |   47514 K  |   47514 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     291    |     500    |     421    |
|       from large pool |      30    |     227    |     421    |     391    |
|       from small pool |      49    |      64    |      79    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1035    |   39015 K  |   39015 K  |
|       from large pool |       3    |     117    |   20582 K  |   20582 K  |
|       from small pool |       0    |    1016    |   18432 K  |   18432 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 00:56:23 2024]
Finished job 0.
1 of 1 steps (100%) done
