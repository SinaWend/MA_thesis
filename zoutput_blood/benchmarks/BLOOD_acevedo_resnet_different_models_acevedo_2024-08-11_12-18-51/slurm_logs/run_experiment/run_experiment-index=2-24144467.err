Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 10:25:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_10_32_31_seed_0_24144467

 Experiment start at: 2024-08-12 10:32:32.532991
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.07954943180084229
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.79337007, 'precision': 0.4561399, 'recall': 0.4196021, 'specificity': 0.9762558, 'f1': 0.42669243, 'auroc': 0.92721814}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0    0    0   0    67   0   0   214    65    24   48     65
1    0  819   0    25   0   0     4   455     1    1     27
2    0    1   0    45   0   0   139    56    25   28     18
3    0    0   0  7790   4   1     4   565    57    2     14
4    0    2   0    34   0   0   134    38    46   10    275
5    0    0   0   389   0   0    12     6     2  110      2
6    0    2   0   189   0   0  1162   116    93   38    308
7    0    2   0   790   1   0    14  6323    54    1     75
8    0    0   0   976   0   0   144   500  1236    9    431
9    0    0   0   201   0   0    93    42    23  133      1
10   0    5   0    72   0   0   193   212   118    5  12190
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.79486424, 'precision': 0.4593416, 'recall': 0.42075768, 'specificity': 0.97638524, 'f1': 0.428681, 'auroc': 0.92604345}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0    0    0   0    68   2   0   219    51    28   47     68
1    0  812   0    29   0   0     4   466     1    0     20
2    0    1   0    42   0   0   139    70    14   26     20
3    0    1   0  7794   1   0     4   562    65    0     13
4    0    1   0    21   0   0   133    64    54    6    260
5    0    0   0   391   0   0    18     9     6   95      2
6    0    2   0   180   0   0  1191   108    92   24    311
7    0    6   0   782   1   0    12  6326    66    1     71
8    0    0   0   950   1   0   116   500  1237   17    475
9    0    1   0   209   1   1    88    44    14  133      2
10   0    7   0    61   0   0   178   208   116    3  12223
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32582384, 'precision': 0.23733789, 'recall': 0.26738632, 'specificity': 0.92928946, 'f1': 0.21269435, 'auroc': 0.70251536}
confusion matrix:
    0    1   2    3   4   5    6    7    8    9     10
0    0    0   0    8   0   0  976   23   17  140     6
1    0  403   0    8   0   0   63  837    6    6   176
2    0    0   0   36   0   0  400  175  163   77   164
3    0    0   0    0   0   0    0    0    0    0     0
4    0    0   0    0   0   0   95   17    9    2  1510
5    0    0   0  167   0   0   51    5   58  305     6
6    0    0   0    5   0   0  959  182  216    6  1699
7    0   26   0    4   1   0  225  865   23    4    16
8    0    0   0   24   0   0  498   23  504  122   199
9    0    2   0  127   1   0  351  168  177  289    22
10   0    0   0    0   0   0    7    1    1    0  1637
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 11:00:18.843029,epoch time: 0:27:46.310038,used: 0:27:46.310038,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_10_32_31_seed_0_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.85423803, 'precision': 0.6251584, 'recall': 0.5345038, 'specificity': 0.9840633, 'f1': 0.5325008, 'auroc': 0.9652351}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    4     1   0    25   0   47   239    34    53   47     33
1    0  1130   0    17   0    0     0   174     3    0      8
2    0     3   0    21   2   10    86    74    55   47     14
3    0     0   0  7871   0    6     3   425   130    1      1
4    0     0   0     8   0    4   106    37   145   16    223
5    0     0   0   234   0  211     4     1    15   54      1
6    0     5   0    50   0   11  1586    48   111   25     71
7    0    16   0   534   0    0     6  6585   101    0     22
8    0     2   0   479   1    6    21   297  2442    7     41
9    0     0   0   101   0  131    46    37    45  133      0
10   0    12   0    15   0    0   250   137   407    6  11966
---- Validation: 
scalar performance:
{'acc': 0.8553163, 'precision': 0.63240194, 'recall': 0.53950465, 'specificity': 0.98415935, 'f1': 0.5385026, 'auroc': 0.96612376}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    3     0   0    35   0   45   243    28    44   47     38
1    0  1128   0    18   0    0     1   174     1    0     10
2    0     0   0    13   2   10    92    76    60   54      5
3    0     1   0  7863   0    7     0   425   143    0      1
4    0     1   0     5   0    6   109    42   142   13    221
5    0     0   0   233   0  212     7     1    17   50      1
6    0     6   0    60   0   11  1573    51   110   29     68
7    0    12   0   529   0    0     4  6604    91    0     25
8    0     1   0   474   0    4    19   297  2447    7     47
9    0     0   0   101   1  114    37    31    45  163      1
10   0    11   0    22   0    2   244   142   389    3  11983
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5171063, 'precision': 0.47192168, 'recall': 0.39679256, 'specificity': 0.948845, 'f1': 0.34048378, 'auroc': 0.7763955}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0    0     0   0    3   0   4  1057   13    45   46     2
1    0  1123   0   17   0   0    30  234    19    2    74
2    0     3   0   16   0   0   415   93   406   31    51
3    0     0   0    0   0   0     0    0     0    0     0
4    0     5   0    0   2   0   156    4    80    0  1386
5    0     0   0  132   0  40    35    1    63  318     3
6    0     2   0    0   0   0  2357   22   332    0   354
7    0    65   0    1   0   0   158  892    39    2     7
8    0     0   0    8   0   3   212    0  1110   28     9
9    0    13   0   63   0   1   335   89   382  248     6
10   0     1   0    0   0   0    22    0     4    0  1619
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 11:27:17.298050,epoch time: 0:26:58.455021,used: 0:54:44.765059,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_10_32_31_seed_0_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.57761663, 'precision': 0.40388247, 'recall': 0.21578598, 'specificity': 0.9508394, 'f1': 0.19924869, 'auroc': 0.82972354}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9     10
0    0   0   0   374   0   0    2    87    0   1    19
1    0  31   0    66   0   0    0  1221    0   0    13
2    0   0   0   213   0   0    2    89    1   1     6
3    0   0   0  8248   0   0    0   184    0   0     4
4    0   0   0   246   0   0    6   151    6   2   128
5    0   0   0   508   0   1    0     4    1   5     2
6    0   3   0   948   1   0  163   520   12   3   258
7    0   0   0  3464   0   0    0  3790    0   0    10
8    0   0   0  2759   0   0    0   331  117   0    89
9    0   0   0   453   0   0    0    34    0   3     3
10   0   3   0  1268   1   1   40  2017  225   2  9236
---- Validation: 
scalar performance:
{'acc': 0.5737328, 'precision': 0.36821595, 'recall': 0.2145066, 'specificity': 0.9503909, 'f1': 0.19827645, 'auroc': 0.82974946}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9     10
0    0   0   0   368   0   0    3    83    0   1    28
1    0  30   0    55   0   0    0  1240    0   0     7
2    0   0   0   212   0   0    2    92    0   0     6
3    0   0   0  8266   0   0    0   171    1   0     2
4    0   0   0   230   0   0    3   174    7   4   121
5    0   0   0   510   0   0    0     6    0   4     1
6    0   0   0   914   0   0  169   557    3   4   261
7    0   0   0  3551   0   0    1  3698    0   0    15
8    0   0   0  2774   0   0    1   316  118   0    87
9    0   0   0   458   0   0    0    27    0   4     4
10   0   4   0  1312   6   1   28  2030  249   2  9164
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.19897853, 'precision': 0.2801275, 'recall': 0.17774767, 'specificity': 0.9226281, 'f1': 0.10784809, 'auroc': 0.69243795}
confusion matrix:
    0   1   2    3   4   5    6     7    8   9     10
0    0   0   0  778   0  14    8   247   46  50    27
1    0   3   0   40   0   0    1  1415    2   0    38
2    0   0   0  426   0   0    1   494   30   2    62
3    0   0   0    0   0   0    0     0    0   0     0
4    0   0   0   26   0   0    7   189   25   0  1386
5    0   0   0  573   0   0    0    10    2   6     1
6    0   0   0  631   0   0  105  1551   19   5   756
7    0   0   0  247   0   0    0   911    0   0     6
8    0   0   0  954   0   0    0   145  221   1    49
9    0   0   0  847   0   1    0   274    7   2     6
10   0   0   0    1   0   0    1    36    6   0  1602
early stop counter: 1
val acc:0.5737327933311462, best validation acc: 0.8553162813186646, corresponding to test acc:                         0.517106294631958 / 0.517106294631958
after epoch: 3,now: 2024-08-12 11:54:23.061814,epoch time: 0:27:05.763764,used: 1:21:50.528823,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_10_32_31_seed_0_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.47712436, 'precision': 0.15198027, 'recall': 0.17129715, 'specificity': 0.9386967, 'f1': 0.14661252, 'auroc': 0.67113894}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   251   0   0   0   147   0   0    85
1    0   0   0   135   0   0   0  1168   0   0    28
2    0   0   0   126   0   0   0   142   0   0    44
3    0   0   0  6412   0   0   0  1827   0   0   197
4    0   0   0   209   0   0   0   181   1   0   148
5    0   0   0   365   0   0   0   121   0   0    35
6    0   0   0   660   0   0   0   786   0   0   462
7    0   0   0  3220   0   0   0  3879   0   0   166
8    0   0   0  2053   0   0   0   889   3   0   351
9    0   0   0   304   0   0   0   133   0   0    56
10   0   0   0  2834   0   0   0  2399  20   0  7539
---- Validation: 
scalar performance:
{'acc': 0.47666177, 'precision': 0.14585903, 'recall': 0.17120704, 'specificity': 0.93863165, 'f1': 0.14646126, 'auroc': 0.6767634}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   236   0   0   0   144   0   0   103
1    0   0   0   158   0   0   0  1137   0   0    37
2    0   0   0   142   0   0   0   124   0   0    46
3    0   0   0  6365   0   0   0  1883   0   0   192
4    0   0   0   226   0   0   0   158   1   0   154
5    0   0   0   394   0   0   0    86   0   0    41
6    0   0   0   649   0   0   0   820   0   0   439
7    0   0   0  3175   0   0   0  3928   0   0   162
8    0   0   0  2037   0   0   0   890   1   0   368
9    0   0   0   312   0   0   0   133   0   0    48
10   0   0   0  2815   0   0   0  2440  15   0  7526
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.10949416, 'precision': 0.029032217, 'recall': 0.09366245, 'specificity': 0.91355956, 'f1': 0.043853838, 'auroc': 0.5734189}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9     10
0    0   0   0  710   0   0   0  124   0   0   336
1    0   0   0  233   0   0   0  967   0   0   299
2    0   0   0  480   0   0   0  121   0   0   414
3    0   0   0    0   0   0   0    0   0   0     0
4    0   0   0  196   0   0   0  277  14   0  1146
5    0   0   0  534   0   0   0   14   0   0    44
6    0   0   0  775   0   0   0  395   0   0  1897
7    0   0   0  532   0   0   0  316   0   0   316
8    0   0   0  895   0   0   0  153   0   0   322
9    0   0   0  822   0   0   0   95   0   0   220
10   0   0   0  171   0   0   0  187  39   0  1249
early stop counter: 2
val acc:0.4766617715358734, best validation acc: 0.8553162813186646, corresponding to test acc:                         0.517106294631958 / 0.517106294631958
after epoch: 4,now: 2024-08-12 12:21:28.469052,epoch time: 0:27:05.407238,used: 1:48:55.936061,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_10_32_31_seed_0_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.32692102, 'precision': 0.08243931, 'recall': 0.10803465, 'specificity': 0.915644, 'f1': 0.09295573, 'auroc': 0.56123483}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   113   0   0   0   101   0   0   269
1    0   0   0   199   0   0   0   786   0   0   347
2    0   0   0    55   0   0   0   107   0   0   150
3    0   0   0  2311   0   0   0  1957   0   0  4169
4    0   0   0    98   0   0   0   136   0   0   305
5    0   0   0   125   0   0   0    89   0   0   307
6    0   0   0   382   0   0   0   610   0   0   916
7    0   0   0  2040   0   0   0  2352   0   0  2871
8    0   0   0   855   0   0   0   809   0   0  1631
9    0   0   0    95   0   0   0   106   0   0   292
10   0   0   0  2276   0   0   0  2961   0   0  7556
---- Validation: 
scalar performance:
{'acc': 0.33152333, 'precision': 0.08391085, 'recall': 0.109945565, 'specificity': 0.91624427, 'f1': 0.094629765, 'auroc': 0.5606846}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0    97   0   0   0   101   0   0   285
1    0   0   0   152   0   0   0   843   0   0   337
2    0   0   0    37   0   0   0   123   0   0   152
3    0   0   0  2361   0   0   0  1903   0   0  4176
4    0   0   0    98   0   0   0   143   0   0   298
5    0   0   0   130   0   0   0    82   0   0   309
6    0   0   0   381   0   0   0   633   0   0   894
7    0   0   0  2037   0   0   0  2447   0   0  2781
8    0   0   0   844   0   0   0   807   0   0  1645
9    0   0   0    97   0   0   0   131   0   0   265
10   0   0   0  2352   0   0   0  2858   0   0  7586
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.07989925, 'precision': 0.022906918, 'recall': 0.06330172, 'specificity': 0.9086702, 'f1': 0.018596383, 'auroc': 0.48417538}
confusion matrix:
    0   1   2    3   4   5   6   7   8   9     10
0    0   0   0  288   0   0   0   7   0   0   875
1    0   0   0  352   0   0   0  25   0   0  1122
2    0   0   0  299   0   0   0   1   0   0   715
3    0   0   0    0   0   0   0   0   0   0     0
4    0   0   0  417   0   0   0  10   0   0  1206
5    0   0   0  176   0   0   0   0   0   0   416
6    0   0   0  581   0   0   0   4   0   0  2482
7    0   0   0  373   0   0   0  10   0   0   781
8    0   0   0  465   0   0   0   1   0   0   904
9    0   0   0  396   0   0   0   0   0   0   741
10   0   0   0  502   0   0   0  12   0   0  1132
early stop counter: 3
val acc:0.3315233290195465, best validation acc: 0.8553162813186646, corresponding to test acc:                         0.517106294631958 / 0.517106294631958
after epoch: 5,now: 2024-08-12 12:48:33.567234,epoch time: 0:27:05.098182,used: 2:16:01.034243,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_10_32_31_seed_0_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:16:01.034243 at 2024-08-12 12:48:33.567234
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5171063, 'precision': 0.47192168, 'recall': 0.39679256, 'specificity': 0.948845, 'f1': 0.34048378, 'auroc': 0.7763955}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0    0     0   0    3   0   4  1057   13    45   46     2
1    0  1123   0   17   0   0    30  234    19    2    74
2    0     3   0   16   0   0   415   93   406   31    51
3    0     0   0    0   0   0     0    0     0    0     0
4    0     5   0    0   2   0   156    4    80    0  1386
5    0     0   0  132   0  40    35    1    63  318     3
6    0     2   0    0   0   0  2357   22   332    0   354
7    0    65   0    1   0   0   158  892    39    2     7
8    0     0   0    8   0   3   212    0  1110   28     9
9    0    13   0   63   0   1   335   89   382  248     6
10   0     1   0    0   0   0    22    0     4    0  1619
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5171063, 'precision': 0.47192168, 'recall': 0.39679256, 'specificity': 0.948845, 'f1': 0.34048378, 'auroc': 0.7763955}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0    0     0   0    3   0   4  1057   13    45   46     2
1    0  1123   0   17   0   0    30  234    19    2    74
2    0     3   0   16   0   0   415   93   406   31    51
3    0     0   0    0   0   0     0    0     0    0     0
4    0     5   0    0   2   0   156    4    80    0  1386
5    0     0   0  132   0  40    35    1    63  318     3
6    0     2   0    0   0   0  2357   22   332    0   354
7    0    65   0    1   0   0   158  892    39    2     7
8    0     0   0    8   0   3   212    0  1110   28     9
9    0    13   0   63   0   1   335   89   382  248     6
10   0     1   0    0   0   0    22    0     4    0  1619
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_10_32_31_seed_0_24144467_instance_wise_predictions.txt
accuracy from prediction file 0.5171062757993423
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/2.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1690 MiB |  13159 MiB | 444743 GiB | 444741 GiB |
|       from large pool |   1497 MiB |  13003 MiB | 444023 GiB | 444022 GiB |
|       from small pool |    193 MiB |    274 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1690 MiB |  13159 MiB | 444743 GiB | 444741 GiB |
|       from large pool |   1497 MiB |  13003 MiB | 444023 GiB | 444022 GiB |
|       from small pool |    193 MiB |    274 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  13138 MiB | 443984 GiB | 443982 GiB |
|       from large pool |   1476 MiB |  12982 MiB | 443265 GiB | 443264 GiB |
|       from small pool |    192 MiB |    273 MiB |    718 GiB |    718 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14626 MiB |  14626 MiB |  14626 MiB |      0 B   |
|       from large pool |  14350 MiB |  14350 MiB |  14350 MiB |      0 B   |
|       from small pool |    276 MiB |    276 MiB |    276 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   2985 MiB |   3018 MiB | 306767 GiB | 306764 GiB |
|       from large pool |   2976 MiB |   3016 MiB | 305985 GiB | 305982 GiB |
|       from small pool |      8 MiB |     23 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   21975 K  |   21970 K  |
|       from large pool |     182    |     489    |   10574 K  |   10574 K  |
|       from small pool |    4194    |    6508    |   11400 K  |   11396 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   21975 K  |   21970 K  |
|       from large pool |     182    |     489    |   10574 K  |   10574 K  |
|       from small pool |    4194    |    6508    |   11400 K  |   11396 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     244    |     244    |     244    |       0    |
|       from large pool |     106    |     106    |     106    |       0    |
|       from small pool |     138    |     138    |     138    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      67    |    1140    |    8762 K  |    8761 K  |
|       from large pool |      41    |      53    |    4077 K  |    4077 K  |
|       from small pool |      26    |    1099    |    4684 K  |    4684 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13159 MiB | 444743 GiB | 444743 GiB |
|       from large pool |  16640 KiB |  13003 MiB | 444023 GiB | 444023 GiB |
|       from small pool |      0 KiB |    274 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13159 MiB | 444743 GiB | 444743 GiB |
|       from large pool |  16640 KiB |  13003 MiB | 444023 GiB | 444023 GiB |
|       from small pool |      0 KiB |    274 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13138 MiB | 443984 GiB | 443983 GiB |
|       from large pool |  16640 KiB |  12982 MiB | 443265 GiB | 443265 GiB |
|       from small pool |      0 KiB |    273 MiB |    718 GiB |    718 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4676 MiB |  14626 MiB |  14626 MiB |   9950 MiB |
|       from large pool |   4474 MiB |  14350 MiB |  14350 MiB |   9876 MiB |
|       from small pool |    202 MiB |    276 MiB |    276 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 407296 KiB |   3115 MiB | 306767 GiB | 306767 GiB |
|       from large pool | 407296 KiB |   3100 MiB | 305985 GiB | 305985 GiB |
|       from small pool |      0 KiB |     44 MiB |    782 GiB |    782 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   21975 K  |   21975 K  |
|       from large pool |       2    |     489    |   10574 K  |   10574 K  |
|       from small pool |       0    |    6508    |   11400 K  |   11400 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   21975 K  |   21975 K  |
|       from large pool |       2    |     489    |   10574 K  |   10574 K  |
|       from small pool |       0    |    6508    |   11400 K  |   11400 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     157    |     244    |     244    |      87    |
|       from large pool |      56    |     106    |     106    |      50    |
|       from small pool |     101    |     138    |     138    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1140    |    8763 K  |    8763 K  |
|       from large pool |       4    |      53    |    4077 K  |    4077 K  |
|       from small pool |       0    |    1099    |    4686 K  |    4686 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13159 MiB | 444743 GiB | 444743 GiB |
|       from large pool |  16640 KiB |  13003 MiB | 444023 GiB | 444023 GiB |
|       from small pool |      0 KiB |    274 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13159 MiB | 444743 GiB | 444743 GiB |
|       from large pool |  16640 KiB |  13003 MiB | 444023 GiB | 444023 GiB |
|       from small pool |      0 KiB |    274 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13138 MiB | 443984 GiB | 443983 GiB |
|       from large pool |  16640 KiB |  12982 MiB | 443265 GiB | 443265 GiB |
|       from small pool |      0 KiB |    273 MiB |    718 GiB |    718 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4676 MiB |  14626 MiB |  14626 MiB |   9950 MiB |
|       from large pool |   4474 MiB |  14350 MiB |  14350 MiB |   9876 MiB |
|       from small pool |    202 MiB |    276 MiB |    276 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 407296 KiB |   3115 MiB | 306767 GiB | 306767 GiB |
|       from large pool | 407296 KiB |   3100 MiB | 305985 GiB | 305985 GiB |
|       from small pool |      0 KiB |     44 MiB |    782 GiB |    782 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   21975 K  |   21975 K  |
|       from large pool |       2    |     489    |   10574 K  |   10574 K  |
|       from small pool |       0    |    6508    |   11400 K  |   11400 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   21975 K  |   21975 K  |
|       from large pool |       2    |     489    |   10574 K  |   10574 K  |
|       from small pool |       0    |    6508    |   11400 K  |   11400 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     157    |     244    |     244    |      87    |
|       from large pool |      56    |     106    |     106    |      50    |
|       from small pool |     101    |     138    |     138    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1140    |    8763 K  |    8763 K  |
|       from large pool |       4    |      53    |    4077 K  |    4077 K  |
|       from small pool |       0    |    1099    |    4686 K  |    4686 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_13_01_00_seed_1_24144467

 Experiment start at: 2024-08-12 13:01:01.428267
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.06254810094833374
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.790427, 'precision': 0.45369038, 'recall': 0.4028877, 'specificity': 0.97550595, 'f1': 0.40237522, 'auroc': 0.9311069}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    2   0    30   0   0   237    36    76   0    102
1    0  977   0    62   0   0     1   226     0   0     66
2    0    0   0    31   0   0    89    43   104   0     45
3    0    5   0  7704   0   0     8   530   146   0     45
4    0    2   0    15   0   0    88    21    57   0    356
5    0    0   0   399   0   1    31     1    87   0      2
6    0    7   0    72   0   0  1085    53   139   0    552
7    0   44   0   936   0   0    15  5991   101   0    177
8    0    7   0   823   0   0   184   322  1386   0    574
9    0    1   0   202   0   1    99    29   149   0     12
10   0   14   0    56   0   0   162    85    74   0  12399
---- Validation: 
scalar performance:
{'acc': 0.7937676, 'precision': 0.41180664, 'recall': 0.40410626, 'specificity': 0.97586143, 'f1': 0.40429085, 'auroc': 0.92883754}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    2   0    30   0   0   213    35    86   0    117
1    0  962   0    72   0   0     0   234     5   0     59
2    0    2   0    36   0   0    84    43   101   0     46
3    0    1   0  7737   0   0     9   547   117   0     29
4    0    1   0    17   0   0   105    24    56   0    336
5    0    0   0   407   0   0    37     0    75   0      2
6    0   10   0    64   0   0  1098    50   140   0    546
7    0   36   0   905   0   0     9  6027   109   0    179
8    0    2   0   824   0   0   163   297  1415   0    595
9    0    0   0   197   0   0   116    23   144   0     13
10   0   16   0    52   0   0   140    69    83   0  12436
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.29748827, 'precision': 0.2131819, 'recall': 0.25509402, 'specificity': 0.92755497, 'f1': 0.20599496, 'auroc': 0.69948286}
confusion matrix:
    0    1   2    3   4   5    6    7    8   9     10
0    0    0   0   21   0   0  862   14  232   0    41
1    0  880   0   31   0   1   18  185   42   0   342
2    0    2   0   68   0   1  134   24  267   0   519
3    0    0   0    0   0   0    0    0    0   0     0
4    0    0   0    0   0   0   16    0    8   0  1609
5    0    0   0  397   0   0   13    6  171   0     5
6    0    5   0    1   0   1  351    1   54   0  2654
7    0   55   0   16   0   0   78  780  151   0    84
8    0    0   0  107   0   3  301   13  596   0   350
9    0    8   0  308   0   1   84   61  556   0   119
10   0    0   0    0   0   0    1    0    0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 13:28:48.719296,epoch time: 0:27:47.291029,used: 0:27:47.291029,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_13_01_00_seed_1_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.83433217, 'precision': 0.5260191, 'recall': 0.46985537, 'specificity': 0.98091507, 'f1': 0.47244567, 'auroc': 0.9396489}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     1   0    26   0   6   255    24    42  15    114
1    0  1065   0    40   0   0     0   183     7   0     37
2    0     2   0    25   0   5    70    25    93   5     87
3    0     0   0  7207   0   0     5   840   375   0     10
4    0     0   0     8   0   1    76    10    65   2    377
5    0     0   0   291   0  51    63     0    91  22      3
6    0     2   0    30   0   1  1463    27    78   2    304
7    0    20   0   450   0   0     4  6464   142   0    184
8    0     0   0   328   0   0    58   170  2360   1    377
9    0     2   0   122   0  35   141    15   127  31     20
10   0     2   0    44   0   0   114    36    55   0  12543
---- Validation: 
scalar performance:
{'acc': 0.8318042, 'precision': 0.52873147, 'recall': 0.4684131, 'specificity': 0.98060274, 'f1': 0.4718476, 'auroc': 0.93894947}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    34   0  12   247    26    44  10    110
1    0  1051   0    37   0   0     0   193     8   0     43
2    0     3   0    30   0   2    77    27    86   3     84
3    0     0   0  7183   0   0     5   860   379   0     13
4    0     0   0    14   0   1    76    18    62   0    368
5    0     1   0   288   0  56    57     1    91  24      3
6    0     0   0    23   0   2  1475    34    70   1    303
7    0    30   0   476   0   0     8  6447   116   0    188
8    0     0   0   352   0   0    70   158  2312   0    404
9    0     1   0   129   0  37   131    16   133  31     15
10   0     1   0    50   0   0   112    25    66   0  12542
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40110543, 'precision': 0.28761166, 'recall': 0.32809108, 'specificity': 0.9377527, 'f1': 0.26341414, 'auroc': 0.7691215}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     2   0    8   0   5  1013   36   98   1     7
1    0  1045   0   21   0   0     4  216   15   0   198
2    0    14   0   35   0   8   156   56  317   0   429
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    18    2    6   0  1607
5    0     0   0  210   0  16    33    8  321   2     2
6    0     7   0    1   0   3  1120    1   51   0  1884
7    0    58   0    2   0   0    56  993   25   0    30
8    0     1   0   32   0   3   235   25  912   0   162
9    0    26   0  159   0  26   117  125  618   1    65
10   0     0   0    0   0   0     0    0    0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 13:56:15.315656,epoch time: 0:27:26.596360,used: 0:55:13.887389,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_13_01_00_seed_1_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5070633, 'precision': 0.29756266, 'recall': 0.174378, 'specificity': 0.93454015, 'f1': 0.1697057, 'auroc': 0.72825986}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    23   0   0  16    23    4   8    409
1    0   1   0    15   0   0   0   349    1   0    966
2    0   0   0    11   0   0   1    21    5   7    267
3    0   1   0  4017   0   0   9   826  479  10   3096
4    0   0   0    19   0   0   2     9    3   5    500
5    0   0   0   141   0   0   7     9   46  49    269
6    0   0   0    53   0   0  47    64   12  32   1700
7    0   0   0   574   0   0   0  1953   64   3   4669
8    0   0   0   398   0   0   3   130  252  17   2496
9    0   0   0    56   0   0   9    16   19  41    352
10   0   0   0    49   0   0   3    90    6   3  12641
---- Validation: 
scalar performance:
{'acc': 0.5067006, 'precision': 0.34768802, 'recall': 0.17436326, 'specificity': 0.9345087, 'f1': 0.17043549, 'auroc': 0.7242839}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9      10
0    0   0   0    25   0   0  15    25    8  12    398
1    0   2   0    13   0   0   0   335    1   1    980
2    0   0   0    17   0   0   1    26    6   8    254
3    0   0   0  3970   0   0  12   756  542   8   3152
4    0   0   0    13   0   0   0    13    2   5    506
5    0   0   0   161   0   0   7    17   39  33    264
6    0   0   0    61   0   0  60    73    9  25   1680
7    0   0   0   579   0   0   0  1959   62   3   4662
8    0   0   0   381   0   0   4   117  278  23   2493
9    0   0   0    76   0   0  13    17   18  36    333
10   0   0   0    56   0   0   0    91    7   4  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.12138809, 'precision': 0.14154948, 'recall': 0.098383345, 'specificity': 0.90976226, 'f1': 0.03312422, 'auroc': 0.58311397}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   1   0   0   2   1   0   1  1165
1    0   0   0   2   0   0   0  13   0   0  1484
2    0   0   0   0   0   1   3   0   2   3  1006
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0  18   0   7  21   3  47  86   410
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0  70   0   0  1094
8    0   0   0   0   0   2   0   3   2   3  1360
9    0   0   0   0   0   3   6   1   7  10  1110
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 1
val acc:0.5067005753517151, best validation acc: 0.8318042159080505, corresponding to test acc:                         0.40110543370246887 / 0.40110543370246887
after epoch: 3,now: 2024-08-12 14:23:57.266725,epoch time: 0:27:41.951069,used: 1:22:55.838458,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_13_01_00_seed_1_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.43533283, 'precision': 0.17332989, 'recall': 0.12900324, 'specificity': 0.9225024, 'f1': 0.10522095, 'auroc': 0.61795706}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     6   0   0   0    2   0   0    475
1    0   0   0     6   0   0   0  102   0   0   1224
2    0   0   0     1   0   0   0    1   0   0    310
3    0   0   0  3394   0   0   2  352  12   1   4678
4    0   0   0     2   0   0   0    4   0   0    533
5    0   0   0    94   0   0   0    4   2   0    421
6    0   0   0     6   0   0   1   11   0   0   1890
7    0   0   0    78   0   0   0  154   0   0   7033
8    0   0   0    35   0   0   0   22   2   0   3237
9    0   0   0    21   0   0   1    0   0   0    469
10   0   0   0    22   0   0   0   48   0   0  12720
---- Validation: 
scalar performance:
{'acc': 0.43381035, 'precision': 0.14206097, 'recall': 0.12831876, 'specificity': 0.92233837, 'f1': 0.104328506, 'auroc': 0.6198232}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     4   0   0   0    4   0   0    475
1    0   0   0     9   0   0   0  125   0   0   1198
2    0   0   0     0   0   0   0    2   0   0    310
3    0   0   0  3363   0   0   3  381  11   0   4682
4    0   0   0     6   0   0   0    0   0   0    533
5    0   0   0    95   0   0   1   18   2   1    404
6    0   0   0    10   0   0   0   10   0   0   1888
7    0   0   0    71   0   0   0  138   0   0   7056
8    0   0   0    36   0   0   0   24   1   0   3235
9    0   0   0    20   0   0   0    4   0   0    469
10   0   0   0    24   0   0   0   56   0   0  12716
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.010470672, 'recall': 0.09090909, 'specificity': 0.9090926, 'f1': 0.018778486, 'auroc': 0.46366078}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   2   0   0   0   0   0   0   590
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 2
val acc:0.43381035327911377, best validation acc: 0.8318042159080505, corresponding to test acc:                         0.40110543370246887 / 0.40110543370246887
after epoch: 4,now: 2024-08-12 14:52:06.507712,epoch time: 0:28:09.240987,used: 1:51:05.079445,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_13_01_00_seed_1_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.42441675, 'precision': 0.12576495, 'recall': 0.124121055, 'specificity': 0.9207313, 'f1': 0.097459726, 'auroc': 0.5652563}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0     5   0   0   0   2   0   0    476
1    0   0   0    12   0   0   0  23   0   0   1296
2    0   0   0     1   0   0   0   0   0   0    311
3    0   0   0  3083   0   0   0  81   0   0   5273
4    0   0   0     4   0   0   0   3   0   0    532
5    0   0   0    99   0   0   0   5   0   0    417
6    0   0   0    11   0   0   0   1   0   0   1896
7    0   0   0   123   0   0   0  17   0   0   7124
8    0   0   0    60   0   0   0  12   0   0   3222
9    0   0   0    15   0   0   0   3   0   0    475
10   0   0   0    20   0   0   0  11   0   0  12763
---- Validation: 
scalar performance:
{'acc': 0.4235121, 'precision': 0.2208528, 'recall': 0.123791836, 'specificity': 0.92060393, 'f1': 0.09711136, 'auroc': 0.56378937}
confusion matrix:
    0   1   2     3   4   5   6   7   8   9      10
0    0   0   0     4   0   0   0   0   0   0    479
1    0   0   0     8   0   0   0  15   0   0   1309
2    0   0   0     0   0   0   0   0   0   0    312
3    0   0   0  3044   0   0   0  82   0   0   5314
4    0   0   0     4   0   0   0   0   0   0    535
5    0   0   0    96   0   0   0   1   0   0    424
6    0   0   0     5   0   0   0   2   0   0   1901
7    0   0   0   135   0   0   0  23   0   0   7107
8    0   0   0    68   0   0   0  10   1   0   3217
9    0   0   0    21   0   0   0   3   0   0    469
10   0   0   0    22   0   0   0   9   0   0  12765
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.010483876, 'recall': 0.09090909, 'specificity': 0.90910697, 'f1': 0.01879972, 'auroc': 0.49097937}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   3   0   0   0   0   0   0  1496
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0  16   0   0   0   1   0   0   575
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 3
val acc:0.4235121011734009, best validation acc: 0.8318042159080505, corresponding to test acc:                         0.40110543370246887 / 0.40110543370246887
after epoch: 5,now: 2024-08-12 15:19:15.527214,epoch time: 0:27:09.019502,used: 2:18:14.098947,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_13_01_00_seed_1_24144467
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:18:14.098947 at 2024-08-12 15:19:15.527214
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40110543, 'precision': 0.28761166, 'recall': 0.32809108, 'specificity': 0.9377527, 'f1': 0.26341414, 'auroc': 0.7691215}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     2   0    8   0   5  1013   36   98   1     7
1    0  1045   0   21   0   0     4  216   15   0   198
2    0    14   0   35   0   8   156   56  317   0   429
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    18    2    6   0  1607
5    0     0   0  210   0  16    33    8  321   2     2
6    0     7   0    1   0   3  1120    1   51   0  1884
7    0    58   0    2   0   0    56  993   25   0    30
8    0     1   0   32   0   3   235   25  912   0   162
9    0    26   0  159   0  26   117  125  618   1    65
10   0     0   0    0   0   0     0    0    0   0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40110543, 'precision': 0.28761166, 'recall': 0.32809108, 'specificity': 0.9377527, 'f1': 0.26341414, 'auroc': 0.7691215}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     2   0    8   0   5  1013   36   98   1     7
1    0  1045   0   21   0   0     4  216   15   0   198
2    0    14   0   35   0   8   156   56  317   0   429
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    18    2    6   0  1607
5    0     0   0  210   0  16    33    8  321   2     2
6    0     7   0    1   0   3  1120    1   51   0  1884
7    0    58   0    2   0   0    56  993   25   0    30
8    0     1   0   32   0   3   235   25  912   0   162
9    0    26   0  159   0  26   117  125  618   1    65
10   0     0   0    0   0   0     0    0    0   0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_13_01_00_seed_1_24144467_instance_wise_predictions.txt
accuracy from prediction file 0.401105436227524
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1686 MiB |  13159 MiB |    868 TiB |    868 TiB |
|       from large pool |   1492 MiB |  13003 MiB |    866 TiB |    866 TiB |
|       from small pool |    193 MiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1686 MiB |  13159 MiB |    868 TiB |    868 TiB |
|       from large pool |   1492 MiB |  13003 MiB |    866 TiB |    866 TiB |
|       from small pool |    193 MiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  13138 MiB |    867 TiB |    867 TiB |
|       from large pool |   1476 MiB |  12982 MiB |    865 TiB |    865 TiB |
|       from small pool |    192 MiB |    273 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14678 MiB |  14678 MiB |  24628 MiB |   9950 MiB |
|       from large pool |  14402 MiB |  14402 MiB |  24278 MiB |   9876 MiB |
|       from small pool |    276 MiB |    276 MiB |    350 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   4555 MiB |   4566 MiB | 616763 GiB | 616759 GiB |
|       from large pool |   4547 MiB |   4564 MiB | 615197 GiB | 615192 GiB |
|       from small pool |      8 MiB |     44 MiB |   1566 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   43950 K  |   43946 K  |
|       from large pool |     182    |     489    |   21149 K  |   21149 K  |
|       from small pool |    4194    |    6508    |   22800 K  |   22796 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   43950 K  |   43946 K  |
|       from large pool |     182    |     489    |   21149 K  |   21149 K  |
|       from small pool |    4194    |    6508    |   22800 K  |   22796 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     238    |     244    |     325    |      87    |
|       from large pool |     100    |     106    |     150    |      50    |
|       from small pool |     138    |     138    |     175    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    1140    |   17348 K  |   17348 K  |
|       from large pool |      50    |      68    |    7797 K  |    7797 K  |
|       from small pool |      28    |    1099    |    9551 K  |    9551 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13159 MiB |    868 TiB |    868 TiB |
|       from large pool |  16640 KiB |  13003 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13159 MiB |    868 TiB |    868 TiB |
|       from large pool |  16640 KiB |  13003 MiB |    866 TiB |    866 TiB |
|       from small pool |      0 KiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13138 MiB |    867 TiB |    867 TiB |
|       from large pool |  16640 KiB |  12982 MiB |    865 TiB |    865 TiB |
|       from small pool |      0 KiB |    273 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6242 MiB |  14678 MiB |  24628 MiB |  18386 MiB |
|       from large pool |   6040 MiB |  14402 MiB |  24278 MiB |  18238 MiB |
|       from small pool |    202 MiB |    276 MiB |    350 MiB |    148 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 407296 KiB |   4665 MiB | 616764 GiB | 616764 GiB |
|       from large pool | 407296 KiB |   4650 MiB | 615197 GiB | 615197 GiB |
|       from small pool |      0 KiB |     44 MiB |   1566 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   43950 K  |   43950 K  |
|       from large pool |       2    |     489    |   21149 K  |   21149 K  |
|       from small pool |       0    |    6508    |   22800 K  |   22800 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   43950 K  |   43950 K  |
|       from large pool |       2    |     489    |   21149 K  |   21149 K  |
|       from small pool |       0    |    6508    |   22800 K  |   22800 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     164    |     244    |     325    |     161    |
|       from large pool |      63    |     106    |     150    |      87    |
|       from small pool |     101    |     138    |     175    |      74    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1140    |   17349 K  |   17349 K  |
|       from large pool |       4    |      68    |    7797 K  |    7797 K  |
|       from small pool |       0    |    1099    |    9552 K  |    9552 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 15:23:52 2024]
Finished job 0.
1 of 1 steps (100%) done
