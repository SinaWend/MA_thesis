Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 02:24:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602

 Experiment start at: 2024-08-12 02:33:00.502859
before training, model accuracy: 0.08472679555416107
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.28520977, 'precision': 0.24198723, 'recall': 0.25518373, 'specificity': 0.92979157, 'f1': 0.18859157, 'auroc': 0.8033204}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     15     2   0   2   0   0   136    28   296   3   0
1      4  1145   0   0   0   0     8   158    17   0   0
2      4     4   0   3   0   0    97    50   146   8   0
3     10    60   0  11   0   0  5841   906  1609   1   0
4     48     1   0   1   0   0    38    22   428   0   0
5      0     1   0   2   0   0   270     1   237  10   0
6     66     4   0   0   0   0   252    68  1513   5   0
7     27   240   0   0   0   0   254  6352   390   0   0
8     20    10   0   2   0   0   172   223  2866   2   0
9      0     0   0   2   0   0   229    26   217  19   0
10  3847    12   0   0   0   0    28    84  8823   0   0
---- Validation: 
scalar performance:
{'acc': 0.28297445, 'precision': 0.219526, 'recall': 0.252546, 'specificity': 0.92958176, 'f1': 0.18459612, 'auroc': 0.8014609}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     16     1   0   1   0   0   150    31   282   2   0
1      8  1143   0   0   0   0     6   153    22   0   0
2      8     3   0   2   0   0    97    47   147   8   0
3      3    57   0   4   0   0  5796   952  1626   2   0
4     43     1   0   0   0   0    37    26   430   2   0
5      0     3   0   0   0   0   276     0   226  16   0
6     62     2   0   1   0   0   240    70  1527   6   0
7     34   277   0   1   0   0   269  6310   374   0   0
8     26    12   0   0   0   0   181   224  2853   0   0
9      0     2   0   1   0   0   265    23   189  13   0
10  3957    14   0   0   0   0    23   105  8695   2   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20828378, 'precision': 0.17150041, 'recall': 0.20449126, 'specificity': 0.91992676, 'f1': 0.14839435, 'auroc': 0.6284936}
confusion matrix:
     0    1   2   3   4   5    6    7     8   9   10
0     8    0   0   0   0   0   61   13  1084   4   0
1    48  725   0   0   0   0    7  363   356   0   0
2     8    0   0   0   0   0   36    8   955   8   0
3     0    0   0   0   0   0    0    0     0   0   0
4   116    0   0   0   0   0    0    0  1517   0   0
5     0    0   0   1   0   0  173    1   323  94   0
6   175    0   0   0   0   0    7    2  2883   0   0
7    10   52   0   0   0   0   47  942   113   0   0
8     0    0   0   0   0   0   86    0  1281   3   0
9     1    3   0   1   0   0  150   16   952  14   0
10  305    0   0   0   0   0    0    0  1341   0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 03:05:13.256102,epoch time: 0:32:12.753243,used: 0:32:12.753243,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.3528735, 'precision': 0.34911764, 'recall': 0.36678302, 'specificity': 0.93679726, 'f1': 0.27498972, 'auroc': 0.88036954}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0     74     0   0   48   0   0   198    33    84   46   0
1      6  1147   0    7   0   0     3   158    10    1   0
2     11     4   0   44   0   0   113    28    75   37   0
3      6     2   0  693   0   0  5768   737  1226    8   0
4     68     0   0   11   0   0    99    13   334   14   0
5      0     1   0   56   1  15   181     0    85  182   0
6    100     0   0   16   0   0  1366    47   367   12   0
7     27    37   0   95   0   0   106  6743   255    0   0
8     16     0   0   50   0   0    92   159  2972    6   0
9      3     1   0   68   1   9   147    17    68  179   0
10  5517     5   0    9   0   0   147    89  7022    1   0
---- Validation: 
scalar performance:
{'acc': 0.35492843, 'precision': 0.36424035, 'recall': 0.37119263, 'specificity': 0.936997, 'f1': 0.28031495, 'auroc': 0.8805082}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0     68     0   0   48   0   0   212    24    88   43   0
1      7  1157   0    2   0   0     5   147    14    0   0
2     11     2   0   40   0   0   109    35    69   46   0
3      9     1   0  732   0   0  5717   761  1208   12   0
4     71     1   0   15   0   0    87    14   342    9   0
5      2     1   0   63   1  17   171     0    89  177   0
6     87     1   0   16   0   0  1334    48   411   11   0
7     28    40   0   80   0   0    97  6771   248    1   0
8     10     1   0   42   0   0    89   164  2984    6   0
9      3     2   0   73   2   6   130    12    59  206   0
10  5495     3   0    5   0   0   156    76  7057    4   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2660743, 'precision': 0.30815202, 'recall': 0.24588978, 'specificity': 0.9250369, 'f1': 0.19489822, 'auroc': 0.6829831}
confusion matrix:
     0    1   2   3   4   5    6     7     8    9   10
0    13    0   0  10   0   0  694    17   426   10   0
1    28  967   0   7   0   0   10   250   237    0   0
2     7    0   0   9   0   0  128    16   838   17   0
3     0    0   0   0   0   0    0     0     0    0   0
4    75    0   0   0   0   0   10     1  1547    0   0
5     0    0   0  97   0   1  134     1   143  216   0
6   186    0   0   1   0   0  394     2  2484    0   0
7     7   11   0   2   0   0   31  1040    73    0   0
8     0    0   0   4   0   0   47     0  1309   10   0
9     2    4   0  60   0   0  273    26   693   79   0
10  149    0   0   0   0   0    0     0  1497    0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 03:36:10.546210,epoch time: 0:30:57.290108,used: 1:03:10.043351,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5383133, 'precision': 0.5112484, 'recall': 0.52322006, 'specificity': 0.95501304, 'f1': 0.4407751, 'auroc': 0.9187417}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9   10
0    317     0   0    30   0    0    29    20    71   16   0
1      8  1138   0    12   0    0     0   160    12    1   0
2     24     4   0    71   2    3    16    27    72   80  12
3      2     0   0  6901   0    3    80   617   805   30   0
4     88     1   0    21   0    3    25    25   314   26  36
5      9     0   0   122  20  105     0     0    29  236   0
6    123     0   0    63   0    2  1425    34   240   20   0
7     28    15   0   149   0    0     2  6824   242    0   4
8      6     0   0    94   0    0     6   117  3065    3   5
9     21     3   0    63  17   20     4    12    53  298   2
10  7881     2   0    20   0    0    32    64  4741    6  47
---- Validation: 
scalar performance:
{'acc': 0.5376488, 'precision': 0.50501347, 'recall': 0.5225119, 'specificity': 0.9549595, 'f1': 0.4388638, 'auroc': 0.9205825}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9   10
0    316     0   0    28   1    1    23    28    60   21   5
1      9  1152   0     8   0    0     0   139    22    2   0
2     24     8   0    50   4    2    20    43    60   92   9
3      7     1   0  6860   0    7    83   592   853   37   0
4     79     2   0    16   1    4    21    22   331   19  44
5      6     0   0   120  24  101     1     3    27  239   0
6    126     0   0    67   0    1  1448    31   211   23   1
7     28    14   0   141   0    0     1  6810   268    0   3
8      8     0   0    91   0    0     3   117  3070    5   2
9     24     1   0    65  16   28     6     9    51  290   3
10  7835     2   0    24   0    0    26    78  4773    6  52
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.31581894, 'precision': 0.36500713, 'recall': 0.27127543, 'specificity': 0.9309553, 'f1': 0.22888105, 'auroc': 0.7133477}
confusion matrix:
     0    1   2    3   4   5     6    7     8    9   10
0   243    0   0   14   0   0   394   12   501    2   4
1    40  891   0   12   0   0     6  297   246    0   7
2    18    1   0   15   0   0    40    5   924    4   8
3     0    0   0    0   0   0     0    0     0    0   0
4   164    0   0    0   0   0     7    0  1450    0  12
5     7    0   0  134   0   1    19    0   261  170   0
6   335    0   0    3   0   0  1027    1  1696    0   5
7    22    2   0   17   0   0    20  934   168    0   1
8     0    0   0    2   0   0     3    0  1363    2   0
9    37    2   0   73   0   0    57   14   898   54   2
10  252    0   0    0   0   0     0    0  1393    0   1
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 04:07:08.693861,epoch time: 0:30:58.147651,used: 1:34:08.191002,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.85447884, 'precision': 0.63471186, 'recall': 0.6347545, 'specificity': 0.9848465, 'f1': 0.6028467, 'auroc': 0.95136297}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9      10
0    370     0   0    26   1    0    12    21    24    6     23
1      3  1149   0    10   0    0     0   155    11    0      3
2     14    21   0    67   3    6    24    34    46   80     17
3      2     1   0  7637   0    5     5   443   339    5      2
4     42     8   0    19   5    7    17    37   194   32    178
5      8     2   0   166   2  210     0     1    16  116      0
6     55     1   0    95   1    2  1601    24    99   10     20
7     17    36   0   176   0    0     1  6901   110    0     19
8      2     1   0   165   0    0     7   105  2996    2     18
9     32     6   0    76   5   76     6     7    42  242      1
10  1112     1   0    32   0    0    25    78   714    6  10826
---- Validation: 
scalar performance:
{'acc': 0.8518925, 'precision': 0.6276776, 'recall': 0.6374167, 'specificity': 0.9845494, 'f1': 0.60515666, 'auroc': 0.950789}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9      10
0    366     0   0    31   0    0    16    23    21    4     22
1      1  1149   0     9   0    0     0   155    14    0      4
2     22    28   0    68   3    7    22    29    45   80      8
3      3     0   0  7630   0    4    10   463   322    6      2
4     43     6   0    23   3    6    20    37   185   30    186
5      8     0   0   165   3  220     2     1    19  103      0
6     45     1   0    93   1    0  1636    26    72    8     26
7     19    30   0   203   0    0     0  6874   119    0     20
8      4     1   0   157   0    0     4   126  2977    2     25
9     24     7   0    80   6   75     8     7    29  253      4
10  1158     3   0    33   0    0    30    76   753    3  10740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4304205, 'precision': 0.47671905, 'recall': 0.3603391, 'specificity': 0.9430164, 'f1': 0.31069785, 'auroc': 0.7218347}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   190     0   0  102   0   0   169    34   659   0    16
1    11  1078   0   22   0   0     0   247    99   0    42
2     5     2   0   62   0   0    12    21   863   1    49
3     0     0   0    0   0   0     0     0     0   0     0
4     5     1   0    0   0   0     4     1   730   0   892
5     7     0   0  405   0   2     4     0   146  28     0
6    91     1   0   56   0   0  1129     3  1546   0   241
7     5    16   0   21   0   0     1  1031    89   0     1
8     0     0   0   10   0   0     1     2  1357   0     0
9    17    14   0  267   0   0    13    43   759  19     5
10    9     0   0    1   0   0     0     0   290   0  1346
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 04:38:12.397079,epoch time: 0:31:03.703218,used: 2:05:11.894220,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90520656, 'precision': 0.7033052, 'recall': 0.67661965, 'specificity': 0.98964643, 'f1': 0.6714337, 'auroc': 0.9654252}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   367     0   0    16   1    0     8    23     9    2     57
1     2  1209   0    15   0    0     0    97     6    0      3
2    22    23   0    54  19    7    26    29    32   95      5
3     6     0   0  7862   0   14     2   341   197    8      7
4    41     2   0     7  36    9    14    57   132   25    216
5    13     0   0    99   4  326     0     0     7   71      1
6    43     1   0    73   1    4  1686    19    45    7     28
7     7    11   0   232   0    1     1  6890    91    1     29
8     3     1   0   202   0    0     4   113  2902    3     68
9    45     5   0    60   8  110     7     4    19  234      1
10  168     1   0    28   1    1    20    81   168    4  12321
---- Validation: 
scalar performance:
{'acc': 0.90472114, 'precision': 0.7100337, 'recall': 0.6755085, 'specificity': 0.9895946, 'f1': 0.6711616, 'auroc': 0.966085}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   353     0   0    19   0    1    12    17    10    2     69
1     2  1199   0    16   0    0     0   104     8    0      3
2    27    20   0    46  14    5    23    33    36  100      8
3     1     1   0  7854   0   19     6   317   228    9      5
4    32     3   0     7  44   12    16    50   123   26    226
5    13     0   0   100   3  315     0     1    12   76      1
6    52     1   0    63   0    4  1692    19    35    9     33
7     7    15   0   252   0    1     1  6870    86    1     32
8     3     1   0   197   0    0     5   118  2911    3     58
9    32     3   0    51   8  119     4     8    17  248      3
10  179     2   0    23   1    1    19    68   165    1  12337
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5035332, 'precision': 0.4541328, 'recall': 0.4093837, 'specificity': 0.9499799, 'f1': 0.35864335, 'auroc': 0.73947287}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   529     0   0   47   0   0   353    9   219   0    13
1     8  1054   0   33   0   0    11  258    84   0    51
2    76     1   0   39   1   1    20    9   807   6    55
3     0     0   0    0   0   0     0    0     0   0     0
4     6     1   0    0   0   0     3    0   213   0  1410
5    73     0   0  322   0  19     9    0    82  87     0
6    98     0   0   21   0   0  1705    3   909   0   331
7    14     4   0  156   0   0    19  867    99   0     5
8     4     0   0   17   0   0     3    0  1343   2     1
9   205     8   0  198   3   3    26   22   613  52     7
10    0     0   0    0   0   0     1    0    17   0  1628
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-12 05:09:16.209550,epoch time: 0:31:03.812471,used: 2:36:15.706691,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9095944, 'precision': 0.7179113, 'recall': 0.6747161, 'specificity': 0.9900116, 'f1': 0.6753501, 'auroc': 0.9711498}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   352     0   0    13   0    1     8    15    13    4     77
1     2  1097   0    21   0    0     0   196    12    0      4
2    16    15   0    55  15    5    41    27    37   92      9
3     2     1   0  7850   0   18     2   367   191    2      5
4    20     2   0    16  22    7    17    58   126   28    243
5    11     0   0    78   1  374     0     0     6   50      1
6    63     2   0    60   0    3  1679    16    37    6     41
7     5    14   0   170   0    0     2  6951   100    2     19
8     2     1   0   196   0    2     1    91  2927    4     70
9    17     2   0    71   3  136     5     6    14  235      4
10   84     1   0    20   0    1    11    57   107    3  12510
---- Validation: 
scalar performance:
{'acc': 0.9094824, 'precision': 0.7378664, 'recall': 0.6767224, 'specificity': 0.98997766, 'f1': 0.67834425, 'auroc': 0.97149295}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   353     0   0    16   0    3     1    18     7    2     83
1     3  1086   0    22   0    0     0   208    10    0      3
2    15    13   0    59   5    5    48    29    37   92      9
3     4     0   0  7858   0   24     3   363   182    3      3
4    21     3   0    15  31   12    18    58   113   25    243
5     8     0   0    68   1  380     0     0     6   57      1
6    55     1   0    58   0    1  1688    12    43    5     45
7     6    16   0   185   0    0     1  6924   102    1     30
8     3     2   0   179   0    1     2    94  2940    4     71
9    17     3   0    71   4  128    12    11    13  233      1
10   89     0   0    19   0    2     7    67   102    2  12508
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48478276, 'precision': 0.48451006, 'recall': 0.41500342, 'specificity': 0.9484023, 'f1': 0.35297242, 'auroc': 0.73574173}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   750     0   0   54   0   0   126   12   205   0    23
1    10  1097   0   32   0   0     2  239    62   0    57
2    73     4   0   46   1   0     3   24   719   2   143
3     0     0   0    0   0   0     0    0     0   0     0
4     2     0   0    0   0   0     1    0    79   0  1551
5    67     0   0  405   0  11     1    0    65  43     0
6   125     0   0   30   0   0  1120    4  1101   0   687
7    15     4   0  130   0   0     9  937    58   0    11
8     5     0   0   23   0   0     0    1  1337   1     3
9   213     9   0  241   1   0     4   52   567  32    18
10    0     0   0    0   0   0     0    0     1   0  1645
better model found
persisted
after epoch: 6,now: 2024-08-12 05:40:16.586945,epoch time: 0:31:00.377395,used: 3:07:16.084086,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9157748, 'precision': 0.7493128, 'recall': 0.68511796, 'specificity': 0.9906086, 'f1': 0.69709206, 'auroc': 0.97674084}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   334     0   0    13   0    1     6    11     6    2    110
1     4  1238   0    16   0    0     0    62     8    0      4
2     5    32   0    62  20    3    37    32    36   76      9
3     4     1   0  7799   0   15     0   304   305    2      6
4     6     4   0    10  58   11     9    70   104   23    244
5     5     0   0    98   2  353     1     1     9   51      1
6    26     1   0    51   0    3  1727     6    38    3     50
7     3    25   0   199   0    0     1  6867   130    0     39
8     0     1   0   100   0    0     3    96  3018    0     77
9    13     4   0    84   3  120     7     7    23  223      9
10   29     0   0    25   3    0     9    42    75    2  12611
---- Validation: 
scalar performance:
{'acc': 0.91571486, 'precision': 0.75218093, 'recall': 0.68628967, 'specificity': 0.99059576, 'f1': 0.6984958, 'auroc': 0.9763612}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   334     0   0    15   0    1     4    11     6    2    110
1     3  1228   0    13   0    0     0    73    12    0      3
2    11    16   0    63  19    4    47    34    45   61     12
3     3     4   0  7810   0    8     1   301   305    0      8
4    11     6   0    15  51    5    15    71   101   21    243
5     3     0   0    96   1  352     0     0    11   57      1
6    31     0   0    52   1    3  1717     6    47    4     47
7     2    30   0   183   0    1     0  6884   127    0     38
8     0     0   0   107   1    1     2    95  3008    1     81
9    17     6   0    77   3  101    11     6    16  244     12
10   29     0   0    27   1    3    10    38    82    0  12606
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49247885, 'precision': 0.47892404, 'recall': 0.38478127, 'specificity': 0.9487652, 'f1': 0.34840733, 'auroc': 0.7301116}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   401     0   0   34   0   0   561    0   156   1    17
1     8  1085   0   53   0   0    15  168    71   0    99
2    39     2   0   55   1   1    29    2   755   8   123
3     0     0   0    0   0   0     0    0     0   0     0
4     3     0   0    0   0   0     3    0   105   0  1522
5    33     0   0  387   0  32    28    0    60  52     0
6    22     0   0   10   0   0  1964    0   708   0   363
7    40     5   0  440   0   0    45  512    98   0    24
8     2     0   0   26   0   0     8    0  1330   1     3
9   100     5   0  295   5   3    65    8   563  70    23
10    0     0   0    0   0   0     0    0     1   0  1645
better model found
persisted
after epoch: 7,now: 2024-08-12 06:11:15.253411,epoch time: 0:30:58.666466,used: 3:38:14.750552,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92281145, 'precision': 0.75977004, 'recall': 0.69871354, 'specificity': 0.9914181, 'f1': 0.70873696, 'auroc': 0.98173404}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   358     0   0    22   2    1    17     7     6    1     69
1     1  1237   0    18   0    0     0    64     7    0      4
2     7    24   0    76   9    5    63    15    32   73      8
3     2     1   0  8089   0   10     0   185   143    1      3
4    11     6   0    21  70   14    26    34   114   25    218
5     3     0   0    99   2  356     0     0     8   50      3
6    12     0   0    44   0    2  1807     5    17    2     19
7     0    33   0   277   1    0     6  6823    97    0     27
8     3     2   0   186   0    0     5    74  2954    1     71
9    16     7   0    84   5  121     6     1    12  236      5
10   49     2   0    37   5    0    19    43    78    1  12561
---- Validation: 
scalar performance:
{'acc': 0.92352545, 'precision': 0.75661755, 'recall': 0.70274615, 'specificity': 0.99150515, 'f1': 0.7120398, 'auroc': 0.9825183}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   362     0   0    16   2    1    14     7     5    1     75
1     0  1237   0    20   0    0     1    66     6    0      2
2     6    23   0    75  21    4    56    13    28   82      4
3     0     1   0  8047   0   10     2   213   162    0      5
4    10     8   0    20  73   10    31    36   109   22    220
5     3     0   0    96   2  369     0     0     6   42      3
6    13     0   0    37   0    2  1804     6    19    5     22
7     3    28   0   256   2    0     2  6852   102    0     20
8     1     1   0   162   0    0     6    81  2969    1     75
9    14     4   0    86   2  119    12     6     8  238      4
10   53     3   0    35   4    1    27    31    63    4  12575
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5161967, 'precision': 0.48670876, 'recall': 0.4139799, 'specificity': 0.9511844, 'f1': 0.36925507, 'auroc': 0.7334028}
confusion matrix:
     0     1   2    3   4   5     6    7     8   9     10
0   439     0   0   50   0   0   548    2   118   0    13
1     8  1185   0   37   0   0     7  154    53   0    55
2    74     6   0   81   3   0    18   24   659   6   144
3     0     0   0    0   0   0     0    0     0   0     0
4     5     1   0    0   0   0     2    1    77   0  1547
5    33     0   0  445   0  28     6    0    52  28     0
6    35     1   0   20   0   0  1868    2   714   0   427
7    12     9   0  180   0   0    54  850    51   0     8
8     2     0   0   44   0   0     3    2  1317   0     2
9   127    18   0  362   3   4    31   33   495  47    17
10    1     0   0    0   0   0     0    0     1   0  1644
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-12 06:42:16.092449,epoch time: 0:31:00.839038,used: 4:09:15.589590,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9286173, 'precision': 0.77108943, 'recall': 0.71151733, 'specificity': 0.99203867, 'f1': 0.7237979, 'auroc': 0.9845414}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   383     1   0    14   1    1     4     7     8    1     63
1     2  1263   0    19   0    0     0    40     6    0      2
2     7    28   0    84  21    4    66    12    43   38      9
3     1     1   0  8072   0   22     0   194   143    0      2
4    13     6   0    17  96    5    19    40    92   11    240
5     6     0   0    66   1  363     1     0     6   77      1
6    31     0   0    35   0    2  1764     4    38    2     32
7     1    26   0   209   1    0     1  6913    83    0     30
8     1     2   0   148   0    2     2    80  2992    1     67
9    10     4   0    99   7   93    16     5    15  238      6
10   40     0   0    21   0    2     9    31    67    0  12624
---- Validation: 
scalar performance:
{'acc': 0.9271098, 'precision': 0.769799, 'recall': 0.710147, 'specificity': 0.99188596, 'f1': 0.72084856, 'auroc': 0.98435754}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   382     1   0    14   0    0     6     7    11    2     60
1     1  1259   0    17   0    0     1    46     5    0      3
2     3    30   0    75  18    3    66    22    46   42      7
3     3     1   0  8059   0   17     0   218   136    2      4
4    11     3   0    11  88    6    15    50   102   15    238
5     3     0   0    66   1  369     0     0     9   72      1
6    40     1   0    41   0    3  1758     4    25    2     34
7     2    44   0   202   0    0     2  6906    82    0     27
8     0     2   0   145   0    1     4    97  2989    1     57
9    14     5   0    95   4   90    18     5     9  239     14
10   46     0   0    27   3    1     4    27    75    2  12611
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57440704, 'precision': 0.50145215, 'recall': 0.45809194, 'specificity': 0.95701456, 'f1': 0.41932368, 'auroc': 0.7619442}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   729     0   0   18   0   0   363    0    50    0    10
1    18  1188   0   39   0   0     7  139    42    0    66
2   109     6   0   44   5   1    31    9   621   11   178
3     0     0   0    0   0   0     0    0     0    0     0
4     5     1   0    0   0   0     3    3    61    0  1560
5    91     0   0  289   1  91    11    0    42   65     2
6    44     0   0    3   1   1  2399    2   348    0   269
7    28     8   0  269   0   0    46  756    46    0    11
8    21     0   0   33   1   0     8    0  1300    1     6
9   240    19   0  184  18   8    45   24   475  102    22
10    0     0   0    0   0   0     0    0     1    0  1645
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 07:13:19.946593,epoch time: 0:31:03.854144,used: 4:40:19.443734,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9318814, 'precision': 0.7742393, 'recall': 0.721586, 'specificity': 0.99245447, 'f1': 0.7320087, 'auroc': 0.9871383}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   386     0   0     8    1    1     9     7     6    1     64
1     0  1255   0    15    0    0     1    54     3    0      3
2     4    27   0    78   28    8    76    14    36   36      5
3     2     4   0  8103    0   28     5   183   112    0      3
4     7     5   0     9  127   12    17    65    99   16    181
5     3     0   0    51    1  413     0     0     6   45      2
6    12     2   0    31    0    1  1818     5     8    3     28
7     1    43   0   198    2    0     3  6928    68    0     20
8     1     5   0   154    1    2     6    82  2976    1     66
9     9     3   0    91    1  149    19     4     7  202      8
10   30     2   0    27    6    3    12    44    47    0  12622
---- Validation: 
scalar performance:
{'acc': 0.9327805, 'precision': 0.7793466, 'recall': 0.7267413, 'specificity': 0.9925348, 'f1': 0.73807883, 'auroc': 0.98751277}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   384     0   0    15    2    1     8     5     4    3     61
1     0  1265   0    13    0    0     0    48     3    0      3
2     4    30   0    75   28    5    76    19    32   35      8
3     0     3   0  8120    0   25     4   172   109    2      5
4     6     4   0    15  140   11    15    72    95    9    172
5     1     0   0    54    2  425     1     0     5   32      1
6    15     0   0    28    1    5  1814     4    14    3     24
7     4    35   0   209    1    1     1  6928    62    1     23
8     1     5   0   158    1    3     8    88  2963    2     67
9     7     5   0    97    5  143    13     3     5  208      7
10   36     2   0    22    4    2     7    54    42    2  12625
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53879523, 'precision': 0.5222558, 'recall': 0.44644263, 'specificity': 0.9533948, 'f1': 0.41484147, 'auroc': 0.75258225}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   519     0   0   41   1    0   553    6    32   0    18
1    11  1177   0   42   0    0     1  175    36   0    57
2    46     4   0   97   7    8    13   13   618   9   200
3     0     0   0    0   0    0     0    0     0   0     0
4     1     1   0    1   4    0     1   17    61   0  1547
5    24     0   0  364   4  136    16    0    31  16     1
6    27     0   0   43   1    1  1903    2   453   0   637
7    20     5   0  121   0    0    21  961    18   0    18
8    10     0   0   80   0    0     5    1  1258   0    16
9    94     9   0  356   9   35    34   32   435  98    35
10    0     0   0    0   0    0     0    1     0   0  1645
better model found
persisted
after epoch: 10,now: 2024-08-12 07:44:42.248343,epoch time: 0:31:22.301750,used: 5:11:41.745484,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:11:41.745484 at 2024-08-12 07:44:42.248343
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53879523, 'precision': 0.5222558, 'recall': 0.44644263, 'specificity': 0.9533948, 'f1': 0.41484147, 'auroc': 0.75258225}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   519     0   0   41   1    0   553    6    32   0    18
1    11  1177   0   42   0    0     1  175    36   0    57
2    46     4   0   97   7    8    13   13   618   9   200
3     0     0   0    0   0    0     0    0     0   0     0
4     1     1   0    1   4    0     1   17    61   0  1547
5    24     0   0  364   4  136    16    0    31  16     1
6    27     0   0   43   1    1  1903    2   453   0   637
7    20     5   0  121   0    0    21  961    18   0    18
8    10     0   0   80   0    0     5    1  1258   0    16
9    94     9   0  356   9   35    34   32   435  98    35
10    0     0   0    0   0    0     0    1     0   0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57440704, 'precision': 0.50145215, 'recall': 0.45809194, 'specificity': 0.95701456, 'f1': 0.41932368, 'auroc': 0.7619442}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   729     0   0   18   0   0   363    0    50    0    10
1    18  1188   0   39   0   0     7  139    42    0    66
2   109     6   0   44   5   1    31    9   621   11   178
3     0     0   0    0   0   0     0    0     0    0     0
4     5     1   0    0   0   0     3    3    61    0  1560
5    91     0   0  289   1  91    11    0    42   65     2
6    44     0   0    3   1   1  2399    2   348    0   269
7    28     8   0  269   0   0    46  756    46    0    11
8    21     0   0   33   1   0     8    0  1300    1     6
9   240    19   0  184  18   8    45   24   475  102    22
10    0     0   0    0   0   0     0    0     1    0  1645
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_02_33_00_seed_0_24142602_instance_wise_predictions.txt
accuracy from prediction file 0.5387952144406353
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/7.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 498660 KiB |   5696 MiB | 349956 GiB | 349955 GiB |
|       from large pool | 407936 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |  90724 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 498660 KiB |   5696 MiB | 349956 GiB | 349955 GiB |
|       from large pool | 407936 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |  90724 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478101 KiB |   5656 MiB | 348532 GiB | 348532 GiB |
|       from large pool | 387840 KiB |   5585 MiB | 347704 GiB | 347704 GiB |
|       from small pool |  90261 KiB |    126 MiB |    828 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6104 MiB |   6104 MiB |   6104 MiB |      0 B   |
|       from large pool |   5976 MiB |   5976 MiB |   5976 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 543771 KiB |    944 MiB | 171683 GiB | 171682 GiB |
|       from large pool | 534144 KiB |    942 MiB | 170808 GiB | 170807 GiB |
|       from small pool |   9627 KiB |     17 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3029    |    4672    |   28374 K  |   28371 K  |
|       from large pool |      87    |     281    |   12326 K  |   12326 K  |
|       from small pool |    2942    |    4550    |   16048 K  |   16045 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3029    |    4672    |   28374 K  |   28371 K  |
|       from large pool |      87    |     281    |   12326 K  |   12326 K  |
|       from small pool |    2942    |    4550    |   16048 K  |   16045 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     183    |     183    |     183    |       0    |
|       from large pool |     119    |     119    |     119    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    1178    |   13213 K  |   13213 K  |
|       from large pool |      18    |      61    |    6906 K  |    6906 K  |
|       from small pool |      22    |    1160    |    6307 K  |    6307 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5656 MiB | 348532 GiB | 348532 GiB |
|       from large pool |  16640 KiB |   5585 MiB | 347704 GiB | 347704 GiB |
|       from small pool |      0 KiB |    126 MiB |    828 GiB |    828 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1018 MiB |   6104 MiB |   6104 MiB |   5086 MiB |
|       from large pool |    920 MiB |   5976 MiB |   5976 MiB |   5056 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    944 MiB | 171683 GiB | 171683 GiB |
|       from large pool |  59136 KiB |    942 MiB | 170808 GiB | 170808 GiB |
|       from small pool |      0 KiB |     28 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4672    |   28374 K  |   28374 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16048 K  |   16048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4672    |   28374 K  |   28374 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16048 K  |   16048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |     183    |     183    |     107    |
|       from large pool |      27    |     119    |     119    |      92    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1178    |   13214 K  |   13214 K  |
|       from large pool |       3    |      61    |    6906 K  |    6906 K  |
|       from small pool |       0    |    1160    |    6308 K  |    6308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5696 MiB | 349956 GiB | 349956 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 349125 GiB | 349125 GiB |
|       from small pool |      0 KiB |    127 MiB |    830 GiB |    830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5656 MiB | 348532 GiB | 348532 GiB |
|       from large pool |  16640 KiB |   5585 MiB | 347704 GiB | 347704 GiB |
|       from small pool |      0 KiB |    126 MiB |    828 GiB |    828 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1018 MiB |   6104 MiB |   6104 MiB |   5086 MiB |
|       from large pool |    920 MiB |   5976 MiB |   5976 MiB |   5056 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    944 MiB | 171683 GiB | 171683 GiB |
|       from large pool |  59136 KiB |    942 MiB | 170808 GiB | 170808 GiB |
|       from small pool |      0 KiB |     28 MiB |    875 GiB |    875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4672    |   28374 K  |   28374 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16048 K  |   16048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4672    |   28374 K  |   28374 K  |
|       from large pool |       2    |     281    |   12326 K  |   12326 K  |
|       from small pool |       0    |    4550    |   16048 K  |   16048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |     183    |     183    |     107    |
|       from large pool |      27    |     119    |     119    |      92    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1178    |   13214 K  |   13214 K  |
|       from large pool |       3    |      61    |    6906 K  |    6906 K  |
|       from small pool |       0    |    1160    |    6308 K  |    6308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602

 Experiment start at: 2024-08-12 07:59:45.229534
before training, model accuracy: 0.10193801671266556
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7542006, 'precision': 0.33534682, 'recall': 0.34438565, 'specificity': 0.970389, 'f1': 0.3152303, 'auroc': 0.8975668}
confusion matrix:
    0     1    2     3   4   5   6     7    8   9      10
0    0    33    7   222   0   0   0    62   15   1    143
1    0  1169    0    13   0   0   0   136    0   0     14
2    0    32    9    71   0   0   0    66   20   0    113
3    0    33    1  7693   0   0   0   686   10   0     17
4    0    20    5    54   0   0   0    25    8   0    427
5    0     4    3   489   0   0   0     7   14   0      4
6    0   167   28   316   0   0   0    82   29   0   1286
7    0   159    1   542   0   0   0  6440    6   0    117
8    0    67  131  1729   0   0   0   412  341   0    614
9    0    21    7   342   0   0   0    53   36   0     34
10   0    86   22    68   0   0   1    73    3   0  12537
---- Validation: 
scalar performance:
{'acc': 0.75388527, 'precision': 0.3643297, 'recall': 0.3447396, 'specificity': 0.9704063, 'f1': 0.31633183, 'auroc': 0.89922273}
confusion matrix:
    0     1    2     3   4   5   6     7    8   9      10
0    0    25   13   225   0   0   1    56   26   1    136
1    0  1161    0    16   0   0   0   130    0   0     25
2    0    31   11    66   0   0   1    69   13   1    120
3    0    23    2  7702   0   0   0   690   12   0     11
4    0    17   15    50   0   0   0    28    8   0    421
5    0     5    4   476   0   0   0    14   17   0      5
6    0   163   24   349   0   0   1    77   36   0   1258
7    0   186    8   551   0   0   0  6407    6   0    107
8    0    72  130  1687   0   0   0   432  364   0    611
9    0    11    8   347   0   0   0    62   38   0     27
10   0    88   21    78   0   0   0    63    8   0  12538
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.27523962, 'precision': 0.2203657, 'recall': 0.25278154, 'specificity': 0.9282465, 'f1': 0.18856803, 'auroc': 0.6935853}
confusion matrix:
    0    1    2    3   4   5   6     7    8   9     10
0    0    1  150  313   0   0   0   367   17   0   322
1    0  969    8   34   0   0   0   235    4   0   249
2    0    2  136  385   0   0   0   115   15   0   362
3    0    0    0    0   0   0   0     0    0   0     0
4    0    0   10    9   0   0   0     2    0   0  1612
5    0    0    7  562   0   0   0    15    5   0     3
6    0    2  181   74   0   0   0    30   11   0  2769
7    0   31    3    5   0   0   0  1058    0   0    67
8    0    1  246  489   0   0   0   108  125   0   401
9    0    5   39  756   0   0   0   255   36   0    46
10   0    0    0    0   0   0   0     0    0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 08:32:08.236507,epoch time: 0:32:23.006973,used: 0:32:23.006973,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.816219, 'precision': 0.39756542, 'recall': 0.4012238, 'specificity': 0.97965115, 'f1': 0.3604883, 'auroc': 0.9234208}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0    96   0    42   0   0   1    24   260   0     60
1    0  1145   0    20   0   0   0   147     5   0     14
2    0    81   1    13   0   0   0    37   112   0     68
3    0     5   0  7917   0   0   0   361   155   0      1
4    0    72   3     8   0   0   0    15   100   0    341
5    0     8   0   240   0   0   0     1   271   0      1
6    0   745   0    66   0   0   2    34   532   0    527
7    0    29   0   425   0   1   0  6685    95   0     28
8    0    53   8   525   0   0   0   203  2383   0    123
9    0    47   0    87   0   0   0    23   329   0      7
10   0   129   6    21   0   0   0    71   193   0  12374
---- Validation: 
scalar performance:
{'acc': 0.8149525, 'precision': 0.42685303, 'recall': 0.4008392, 'specificity': 0.97950655, 'f1': 0.36024737, 'auroc': 0.9231935}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    2    83   0    46   0   0   2    30   259   0     61
1    0  1148   0    24   0   0   0   140     7   0     13
2    0    91   1    10   0   0   0    28   120   0     62
3    0    12   0  7888   0   0   0   378   158   0      4
4    0    66   3     9   0   0   0    18   105   0    338
5    0    11   0   232   0   0   0     0   276   0      2
6    0   763   1    52   0   0   0    56   514   0    522
7    0    28   0   436   0   0   1  6684    79   0     37
8    0    52  12   548   0   0   2   190  2367   0    125
9    0    46   0    96   0   0   0    35   311   0      5
10   0   145   2    21   0   0   0    76   175   0  12377
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.35478905, 'precision': 0.187459, 'recall': 0.325409, 'specificity': 0.9347664, 'f1': 0.2128371, 'auroc': 0.72465783}
confusion matrix:
    0     1   2    3   4   5   6     7     8   9     10
0    0    75   0   14   0   0   0    85   971   0    25
1    0  1015   0   15   0   0   0   310    37   0   122
2    0    21   1   32   0   0   0    60   688   0   213
3    0     0   0    0   0   0   0     0     0   0     0
4    0     1   0    0   0   0   1     1    31   0  1599
5    0     0   0  138   0   0   0     3   449   0     2
6    0   176   6    2   0   0   0    11   782   0  2090
7    0     9   0    0   0   0   1  1107    28   0    19
8    0    10   2   17   0   0   0     4  1302   0    35
9    0    15   1  127   0   0   0   105   863   0    26
10   0     0   0    0   0   0   0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 09:03:11.387537,epoch time: 0:31:03.151030,used: 1:03:26.158003,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8284461, 'precision': 0.44613442, 'recall': 0.41784853, 'specificity': 0.98127145, 'f1': 0.37945005, 'auroc': 0.9445073}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0   192   0    52   0   0  67    25    90   2     55
1    0  1176   0    25   0   0   0   116     4   0     11
2    0    89   0    14   0   0   8    32    70   1     98
3    0     9   0  8009   0   0   0   284   135   0      1
4    0    66   1    18   0   0   1    13    79   0    360
5    0    20   9   235   0  24  16     0   197  15      5
6    0  1250   0    69   0   0   9    35   212   2    330
7    0    35   1   421   0   1   0  6717    65   0     24
8    0    35   3   451   0   0   0   142  2596   0     69
9    0   112   2   117   0  11  35    26   154  15     21
10   0   152   3    16   0   0   2    60   141   0  12418
---- Validation: 
scalar performance:
{'acc': 0.8270162, 'precision': 0.54055053, 'recall': 0.4172396, 'specificity': 0.9811116, 'f1': 0.37884542, 'auroc': 0.9437274}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    3   196   2    48   0   0  54    25    99   3     53
1    0  1179   0    26   0   0   0   114     3   0     10
2    0    93   0    16   0   0   7    27    74   0     95
3    0     8   0  8007   0   0   0   286   136   0      3
4    0    60   2    15   0   0   0    13    92   0    357
5    0    18   8   238   0  25  19     0   189  18      6
6    0  1245   0    66   0   0  11    39   203   2    342
7    0    29   0   428   0   0   0  6700    78   0     30
8    0    38   1   463   0   0   1   149  2577   0     67
9    0   101   1    96   0   6  42    30   185  11     21
10   0   161   1    22   0   0   1    61   145   0  12405
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.35555866, 'precision': 0.23399137, 'recall': 0.32597226, 'specificity': 0.9350101, 'f1': 0.21102917, 'auroc': 0.7501047}
confusion matrix:
    0     1   2    3   4   5   6     7     8   9     10
0    0   144   0   22   0   2  56    38   904   0     4
1    0  1021   0   28   0   0   0   293    67   0    90
2    0    23   2   48   0   0   0    20   786   0   136
3    0     0   0    0   0   0   0     0     0   0     0
4    0     8   2    0   0   0   0     2    77   0  1544
5    0     0   0  174   0   2   0     0   415   0     1
6    0   764   0    1   0   0   0     4  1178   0  1120
7    0     7   0   10   0   0   0  1077    61   0     9
8    0     3   1   28   0   0   0     0  1336   0     2
9    0    16   0  195   0   2   3    37   864   0    20
10   0     1   0    0   0   0   0     0     1   0  1644
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 09:34:09.848700,epoch time: 0:30:58.461163,used: 1:34:24.619166,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8741706, 'precision': 0.56097496, 'recall': 0.52427936, 'specificity': 0.98574114, 'f1': 0.51965237, 'auroc': 0.96338135}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    0    18   0    31   0   14   285    32    38   2     63
1    0  1201   0    19   0    1     0    96     4   0     10
2    0     9  16     5   0   12    57    29    32   2    150
3    0    11   2  7877   0    4     0   389   154   1      1
4    0     6   5    13   0    5    35    11    51   2    411
5    0     1  44   143   0  248    15     1    58   7      4
6    0   226   3    57   0   10  1171    21    60   2    357
7    0    51   0   215   0    0     1  6894    68   0     35
8    0    12   3   291   0    9     7   154  2700   1    117
9    0     7  30    53   0  180    93    22    52  20     36
10   0    67   1    17   0    1    53    40    68   0  12546
---- Validation: 
scalar performance:
{'acc': 0.87363917, 'precision': 0.55632347, 'recall': 0.5250936, 'specificity': 0.9856569, 'f1': 0.52043766, 'auroc': 0.96386504}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    0    18   1    26   0   13   275    32    32   3     83
1    0  1201   0    20   0    0     1    94     8   0      8
2    0    11  15    10   0   11    55    24    28   6    152
3    0     8   2  7895   0    6     0   375   152   0      2
4    0     4   5     9   0    2    34     8    44   0    433
5    0     1  44   130   0  259    23     1    50  10      3
6    0   226   1    41   0   10  1183    31    71   1    344
7    0    61   1   232   0    0     1  6880    61   0     29
8    0    19   8   321   0    4     3   162  2662   0    117
9    0     1  32    56   0  180    91    28    51  19     35
10   0    63   5    18   0    0    61    44    58   0  12547
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.39005107, 'precision': 0.2969919, 'recall': 0.34872738, 'specificity': 0.93813586, 'f1': 0.2580854, 'auroc': 0.75425464}
confusion matrix:
    0     1   2    3   4   5    6     7     8   9     10
0    0    13   0  102   0  40  472   106   424   2    11
1    0  1067   0   33   0   0    0   290    20   0    89
2    0     7   9   71   0  15   28    71   539   0   275
3    0     0   0    0   0   0    0     0     0   0     0
4    0     1   1    1   0   0    4     2    21   0  1603
5    0     0   3  280   0  43    1     4   259   0     2
6    0   170   1    5   0   7  380    21   354   0  2129
7    0     3   0    6   0   0    1  1123    12   0    19
8    0     0   2   32   0   0    1    11  1307   0    17
9    0    11   4  309   0  57   24   126   570   0    36
10   0     0   0    0   0   0    0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 10:05:07.585940,epoch time: 0:30:57.737240,used: 2:05:22.356406,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.89156145, 'precision': 0.63214314, 'recall': 0.5648895, 'specificity': 0.987566, 'f1': 0.5644124, 'auroc': 0.9724538}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    0     4   2   102   0    4   253    26    29   1     62
1    0  1201   0    19   0    0     0   100     1   0     11
2    0     6  44    19   0   10    32    33    21   1    146
3    0     4   2  7965   0    4     0   350   112   0      2
4    0     1  18    19   0    2    30    10    34   0    425
5    0     0  44   127   0  312     9     1    23   1      3
6    0    20   2    89   0    5  1631    19    29   1    112
7    0    23   1   230   0    0     1  6930    43   0     35
8    0     7   6   380   0    1     7   149  2618   0    127
9    0     3  73    70   0  179    53    20    36  19     40
10   0    26   2    16   0    1    75    28    41   0  12603
---- Validation: 
scalar performance:
{'acc': 0.89075834, 'precision': 0.616711, 'recall': 0.56144434, 'specificity': 0.98748416, 'f1': 0.560436, 'auroc': 0.9722681}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    0     4   3   108   0    7   253    26    25   0     57
1    0  1216   0    17   0    0     0    83     6   0     10
2    0     6  42    18   0   11    34    32    23   1    145
3    0     3   2  7963   0    5     0   346   117   0      4
4    0     5  17    15   0    6    22     9    33   0    432
5    0     0  49   142   0  292     8     1    21   5      3
6    0    14   1    96   0    8  1615    15    38   1    120
7    0    22   0   225   0    0     2  6919    50   0     47
8    0    10   7   363   0    1     8   143  2648   0    116
9    0     1  65    78   0  194    52    24    23  19     37
10   0    29   0    23   0    0    80    34    42   1  12587
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44994053, 'precision': 0.38306022, 'recall': 0.3703358, 'specificity': 0.94458646, 'f1': 0.30049378, 'auroc': 0.7642506}
confusion matrix:
    0     1   2    3   4   5     6     7     8   9     10
0    0     2   0  405   0   0   387    41   320   4    11
1    0  1105   0   32   0   0     2   200    23   0   137
2    0    10   2   99   0   2    40    47   442   2   371
3    0     0   0    0   0   0     0     0     0   0     0
4    0     0   0    0   0   0     4     0    15   0  1614
5    0     0   4  383   0  22     8     2   170   2     1
6    0    75   1   18   0   1  1267     7   167   1  1530
7    0     4   0   18   0   0     3  1083    16   0    40
8    0     0   0   36   0   0     2     6  1302   0    24
9    0     5   5  398   0  10    32   115   500   4    68
10   0     0   0    0   0   0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-12 10:36:05.472194,epoch time: 0:30:57.886254,used: 2:36:20.242660,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90437716, 'precision': 0.7094566, 'recall': 0.6069615, 'specificity': 0.98921883, 'f1': 0.5965411, 'auroc': 0.9790725}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    1     3   5   138   0    5   235    11    31   2     52
1    0  1205   0    24   0    0     0    85     5   0     13
2    0     6  70    23   0   17    16    14    18  20    128
3    0     5   3  8006   0   15     0   198   210   0      1
4    0     4  24    39   0    7    15     2    28   6    414
5    0     0  18    60   0  409     5     1    19   8      1
6    0    13   2    46   0    4  1746    11    28   1     57
7    0    16   0   275   0    0     0  6815   103   1     53
8    0     5   4   199   0    3     7    72  2942   1     63
9    0     1  89    35   0  231    32     8    20  41     36
10   0    30   5    24   0    2    88    15    60   0  12567
---- Validation: 
scalar performance:
{'acc': 0.9020195, 'precision': 0.61868036, 'recall': 0.6035385, 'specificity': 0.9889309, 'f1': 0.5922781, 'auroc': 0.9794487}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    0     5   4   145   0    5   232    11    22   2     57
1    0  1202   0    26   0    0     0    82     7   0     15
2    0     6  74    21   0   19    16     8    16  17    135
3    0     8   1  8016   0   13     1   203   197   0      1
4    0     2  18    35   0    6    16     3    26   3    430
5    0     0  18    67   0  404     5     0    21   5      1
6    0     8   1    53   0    7  1744     8    28   1     58
7    0    17   0   305   0    0     2  6786   112   0     43
8    0     7   4   215   0    9    12    82  2906   0     61
9    0     0  91    32   0  241    27    12    25  31     34
10   0    30   5    29   0    1    83    19    69   1  12559
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47442803, 'precision': 0.40469474, 'recall': 0.38533875, 'specificity': 0.94661355, 'f1': 0.32123026, 'auroc': 0.77845365}
confusion matrix:
    0     1   2    3   4   5     6    7     8   9     10
0    0     1   0  164   0   2   531   10   445   8     9
1    0  1098   0   34   0   0     4  173    60   0   130
2    0     3   2   56   0   5    39   16   645   5   244
3    0     0   0    0   0   0     0    0     0   0     0
4    0     0   0    5   0   0     4    0    34   0  1590
5    0     0   4  236   0  74     8    2   261   6     1
6    0    39   2    6   0   2  1594    2   286   2  1134
7    0     3   0   61   0   0    12  996    60   0    32
8    0     0   0   16   0   0     0    2  1350   0     2
9    0     6   5  258   0  34    25   45   700  21    43
10   0     0   0    0   0   0     0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 11:07:21.881552,epoch time: 0:31:16.409358,used: 3:07:36.652018,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.91312605, 'precision': 0.72369653, 'recall': 0.6418357, 'specificity': 0.9899775, 'f1': 0.65544826, 'auroc': 0.98288393}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   164     2   6    99   0    5    83    20    27   1     76
1     0  1233   0    20   0    0     1    65     6   0      7
2     1     6  46    19   0   16     7    16    13  50    138
3     0     2   0  8136   0   10     0   173   117   0      0
4     0     0  14    27   0    2     5     5    30  10    445
5     0     0   7    70   0  422     1     1     8  10      2
6     3     5   2    43   0    5  1749    11    18   2     69
7     0    22   0   296   0    2     2  6834    82   0     24
8     0     3   4   283   0    4     7    85  2825   1     84
9     0     3  55    46   0  247     7    12    14  84     25
10    0    20   5    22   0    2    42    28    38   1  12636
---- Validation: 
scalar performance:
{'acc': 0.9111141, 'precision': 0.7202869, 'recall': 0.63593113, 'specificity': 0.9897544, 'f1': 0.6495962, 'auroc': 0.98231214}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   151     2   5    99   0    5    96    14    30   1     80
1     0  1225   0    21   0    0     1    76     5   0      4
2     0     6  39    23   0   22     6    17    11  49    139
3     0     3   1  8123   0   17     0   177   117   0      2
4     0     1  11    22   0    1    12     8    28  11    445
5     0     0  10    69   0  411     3     0    12  14      2
6     4     6   3    46   0    8  1737    13    16   1     74
7     0    28   1   308   0    0     1  6835    71   0     21
8     0     2   2   273   0   11    10    89  2822   4     83
9     0     1  42    41   0  234    15    12    14  95     39
10    1    22   2    22   0    2    44    34    41   4  12624
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.45714685, 'precision': 0.50339544, 'recall': 0.3837121, 'specificity': 0.94550645, 'f1': 0.3246536, 'auroc': 0.7702829}
confusion matrix:
    0     1   2    3   4   5     6     7     8   9     10
0   82     1   0  344   0   1   300    61   348   4    29
1    0  1217   0   32   0   0     1   146    20   0    83
2    0    15   0  119   0   3    23    37   447   7   364
3    0     0   0    0   0   0     0     0     0   0     0
4    0     1   0    1   0   0     2     1    13   0  1615
5    0     0   1  424   0  34     5     3   119   4     2
6    0     6   2   34   0   4  1139    12   157   0  1713
7    0     8   0   12   0   0     4  1101    21   0    18
8    0     0   0   51   0   0     3    10  1286   1    19
9    0    17   4  482   0   9    11    98   432  29    55
10   0     0   0    0   0   0     0     0     0   0  1646
better model found
persisted
after epoch: 7,now: 2024-08-12 11:39:48.668656,epoch time: 0:32:26.787104,used: 3:40:03.439122,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9200289, 'precision': 0.7081422, 'recall': 0.67179334, 'specificity': 0.99078023, 'f1': 0.6793758, 'auroc': 0.9853872}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   286     2   3    37   0    3    30    21    17    0     84
1     0  1270   0    19   0    0     0    33     4    0      6
2     3     3  15    20   0    9     4    12    14   99    133
3     1     2   5  8047   0   13     1   207   162    0      0
4     0     2   1    32   0    2     3     7    21   20    451
5     2     1   3    53   0  416     4     0    15   23      3
6    51     4   1    48   0    7  1698     8    22    1     68
7     0    32   1   234   0    0     2  6905    56    0     31
8     0     5   2   163   0    7     2   112  2931    3     70
9     8     1  27    26   0  195    15    13    16  159     33
10    8    21   3    15   0    2    22    29    35    0  12660
---- Validation: 
scalar performance:
{'acc': 0.91988766, 'precision': 0.7139899, 'recall': 0.67329437, 'specificity': 0.9907424, 'f1': 0.68120164, 'auroc': 0.9856416}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   296     2   3    24   0    1    37    25    14    0     81
1     0  1250   0    21   0    0     0    48     4    0      9
2     4     6  14    26   0   12     3    11     9   81    146
3     0     5   0  8049   0    9     0   220   155    0      2
4     1     2   4    40   0    2     0     4    25   14    447
5     6     0   7    49   0  426     1     0    12   19      1
6    30     8   0    54   0    1  1722    10    19    2     62
7     0    30   0   238   0    0     2  6894    68    1     32
8     1     4   1   153   0    7     4   118  2934    3     71
9    13     1  26    30   0  206     9    15    10  152     31
10    9    24   0    18   0    1    28    25    37    1  12653
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49212903, 'precision': 0.5540845, 'recall': 0.41286203, 'specificity': 0.9490053, 'f1': 0.35729533, 'auroc': 0.7806185}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   373     2   0  108   0   0    94    80   493   0    20
1     0  1181   0   30   0   0     0   150    58   0    80
2     1     1   1   79   0   2     8    38   627   1   257
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0    5   0   0     1     1    35   0  1590
5     2     0   0  309   0  38     2     8   230   2     1
6    18     8   0   26   0   3  1347     8   438   0  1219
7     0     2   0   18   0   0     1  1100    30   0    13
8     0     0   0   20   0   0     1     6  1338   0     5
9     2     2   2  344   0  10     4    96   622  10    45
10    0     0   0    0   0   0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-12 12:12:44.812745,epoch time: 0:32:56.144089,used: 4:12:59.583211,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92374784, 'precision': 0.7148175, 'recall': 0.67257404, 'specificity': 0.9914121, 'f1': 0.67421794, 'auroc': 0.98570186}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   271     1   2    27   0    6    62    27    18    2     67
1     0  1239   0    13   0    0     0    67     5    0      7
2     0     1   9    33   0   26     5    14    21  123     80
3     2     1   0  8033   0    9     2   268   122    0      1
4     1     2   2    48   0    5    10    15    36   35    383
5     0     0   5    44   0  442     3     0    16    9      2
6     8     2   0    18   0    4  1816     8    14    1     37
7     0    17   1   153   0    0     4  7021    58    1      8
8     0     2   2   169   0    2     8   116  2960    1     36
9     2     1   7    26   0  271     9    14    19  136      8
10    6    25   0    33   0    0    42    42    45    2  12599
---- Validation: 
scalar performance:
{'acc': 0.9242477, 'precision': 0.7235825, 'recall': 0.6757309, 'specificity': 0.9914757, 'f1': 0.6803788, 'auroc': 0.98625827}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   266     3   2    23   0    3    77    28    20    3     58
1     0  1239   0    15   0    0     2    64     5    0      7
2     2     2  16    34   0   17     4    15    17  132     73
3     0     3   1  8037   0    8     0   269   120    0      2
4     0     1   4    55   0    5     9     9    37   35    384
5     0     0   4    57   0  433     2     1    12   11      1
6     8     2   2    15   0    2  1828    11    13    0     27
7     0    15   0   153   0    1     2  7025    54    1     14
8     1     0   0   172   0    4     8   123  2950    0     38
9     0     1  12    22   0  259     9     9    22  154      5
10    6    21   1    26   0    2    43    49    42    1  12605
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52515215, 'precision': 0.5122959, 'recall': 0.41836208, 'specificity': 0.9524784, 'f1': 0.3610373, 'auroc': 0.7813116}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   222     1   0  224   0   0   193    69   450   1    10
1     0  1171   0   37   0   0     9   192    40   0    50
2     0     0   0   97   0   0     7    37   663   4   207
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0    5   0   0     5     1    38   0  1583
5     0     0   0  401   0  26     1     3   157   3     1
6    12     8   0   21   0   1  1984     9   350   0   682
7     0     1   0    6   0   0     3  1118    28   0     8
8     0     0   0   33   0   0     1     9  1323   0     4
9     1     9   0  369   0  13     3    70   626  16    30
10    0     0   0    0   0   0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 12:45:37.362304,epoch time: 0:32:52.549559,used: 4:45:52.132770,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9269585, 'precision': 0.7242291, 'recall': 0.69157964, 'specificity': 0.99163187, 'f1': 0.6978022, 'auroc': 0.9879375}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   321     2   0    20   0    2    47    23    10    2     56
1     0  1263   0    15   0    0     0    43     3    0      7
2     0     3   4    47   0    5     7    16     5  146     79
3     0     3   0  8080   0   11     0   263    80    1      1
4     0     0   3    83   0    2     6     7    19   28    391
5     1     0   2    68   0  395     7     1     5   41      1
6     9     1   2    12   0    1  1831    15    10    1     26
7     0    26   0   149   0    0     2  7037    32    0     17
8     0     4   0   230   0    3     6   141  2842    3     66
9     3     1   9    51   0  154    17     5     2  240     11
10    7    16   0    26   0    1    46    28    31    4  12633
---- Validation: 
scalar performance:
{'acc': 0.92625386, 'precision': 0.7310336, 'recall': 0.6911016, 'specificity': 0.99154323, 'f1': 0.6976003, 'auroc': 0.9877151}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   302     1   0    22   0    1    59    23    16    4     55
1     0  1258   0    15   0    0     0    46     5    0      8
2     2     2   4    58   0    6     5    13     7  143     72
3     0     4   0  8079   0    6     1   267    83    0      0
4     1     1   3    71   0    1     5     7    23   22    405
5     1     0   0    54   0  407     5     0    11   41      2
6     8     2   1    14   0    0  1832    11    13    1     26
7     0    23   0   144   0    0     2  7035    38    0     23
8     1     2   0   247   0    6    11   144  2812    6     67
9     3     0   6    46   0  148    10     8     9  252     11
10   11    12   1    28   0    1    43    26    25    2  12647
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53914505, 'precision': 0.51910424, 'recall': 0.42427945, 'specificity': 0.95417815, 'f1': 0.3679236, 'auroc': 0.78345543}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   283     0   0  238   0   0   213   138   291   1     6
1     0  1207   0   33   0   0     6   165    16   0    72
2     0     4   0  143   0   0     7    90   542   3   226
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0   11   0   0     3     4    32   0  1582
5     0     0   2  490   0   7     1     4    79   8     1
6    51     8   0   34   0   1  2151    14   332   0   476
7     0     3   0   23   0   0     3  1108    17   0    10
8     0     0   0   64   0   0     1    17  1285   0     3
9     1    12   0  542   0   0     3   178   349  20    32
10    0     0   0    0   0   0     0     0     1   0  1645
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-12 13:18:15.545264,epoch time: 0:32:38.182960,used: 5:18:30.315730,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:18:30.315730 at 2024-08-12 13:18:15.545264
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53914505, 'precision': 0.51910424, 'recall': 0.42427945, 'specificity': 0.95417815, 'f1': 0.3679236, 'auroc': 0.78345543}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   283     0   0  238   0   0   213   138   291   1     6
1     0  1207   0   33   0   0     6   165    16   0    72
2     0     4   0  143   0   0     7    90   542   3   226
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0   11   0   0     3     4    32   0  1582
5     0     0   2  490   0   7     1     4    79   8     1
6    51     8   0   34   0   1  2151    14   332   0   476
7     0     3   0   23   0   0     3  1108    17   0    10
8     0     0   0   64   0   0     1    17  1285   0     3
9     1    12   0  542   0   0     3   178   349  20    32
10    0     0   0    0   0   0     0     0     1   0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53914505, 'precision': 0.51910424, 'recall': 0.42427945, 'specificity': 0.95417815, 'f1': 0.3679236, 'auroc': 0.78345543}
confusion matrix:
     0     1   2    3   4   5     6     7     8   9     10
0   283     0   0  238   0   0   213   138   291   1     6
1     0  1207   0   33   0   0     6   165    16   0    72
2     0     4   0  143   0   0     7    90   542   3   226
3     0     0   0    0   0   0     0     0     0   0     0
4     0     1   0   11   0   0     3     4    32   0  1582
5     0     0   2  490   0   7     1     4    79   8     1
6    51     8   0   34   0   1  2151    14   332   0   476
7     0     3   0   23   0   0     3  1108    17   0    10
8     0     0   0   64   0   0     1    17  1285   0     3
9     1    12   0  542   0   0     3   178   349  20    32
10    0     0   0    0   0   0     0     0     1   0  1645
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_07_59_44_seed_1_24142602_instance_wise_predictions.txt
accuracy from prediction file 0.5391450360316239
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 499833 KiB |   5696 MiB | 699925 GiB | 699925 GiB |
|       from large pool | 408192 KiB |   5625 MiB | 698265 GiB | 698264 GiB |
|       from small pool |  91641 KiB |    127 MiB |   1660 GiB |   1660 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 499833 KiB |   5696 MiB | 699925 GiB | 699925 GiB |
|       from large pool | 408192 KiB |   5625 MiB | 698265 GiB | 698264 GiB |
|       from small pool |  91641 KiB |    127 MiB |   1660 GiB |   1660 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478830 KiB |   5656 MiB | 697065 GiB | 697065 GiB |
|       from large pool | 387840 KiB |   5585 MiB | 695409 GiB | 695409 GiB |
|       from small pool |  90990 KiB |    126 MiB |   1656 GiB |   1656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5952 MiB |   6104 MiB |  11038 MiB |   5086 MiB |
|       from large pool |   5824 MiB |   5976 MiB |  10880 MiB |   5056 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 669575 KiB |    944 MiB | 332461 GiB | 332461 GiB |
|       from large pool | 654720 KiB |    942 MiB | 330699 GiB | 330698 GiB |
|       from small pool |  14855 KiB |     28 MiB |   1762 GiB |   1762 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3969    |    5197    |   56749 K  |   56745 K  |
|       from large pool |      87    |     281    |   24652 K  |   24652 K  |
|       from small pool |    3882    |    5091    |   32097 K  |   32093 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3969    |    5197    |   56749 K  |   56745 K  |
|       from large pool |      87    |     281    |   24652 K  |   24652 K  |
|       from small pool |    3882    |    5091    |   32097 K  |   32093 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     186    |     186    |     293    |     107    |
|       from large pool |     122    |     122    |     214    |      92    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    1178    |   26360 K  |   26360 K  |
|       from large pool |      21    |      64    |   13933 K  |   13933 K  |
|       from small pool |      31    |    1160    |   12427 K  |   12427 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5696 MiB | 699925 GiB | 699925 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 698265 GiB | 698265 GiB |
|       from small pool |      0 KiB |    127 MiB |   1660 GiB |   1660 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5696 MiB | 699925 GiB | 699925 GiB |
|       from large pool |  16640 KiB |   5625 MiB | 698265 GiB | 698265 GiB |
|       from small pool |      0 KiB |    127 MiB |   1660 GiB |   1660 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5656 MiB | 697065 GiB | 697065 GiB |
|       from large pool |  16640 KiB |   5585 MiB | 695409 GiB | 695409 GiB |
|       from small pool |      0 KiB |    126 MiB |   1656 GiB |   1656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1142 MiB |   6104 MiB |  11038 MiB |   9896 MiB |
|       from large pool |   1038 MiB |   5976 MiB |  10880 MiB |   9842 MiB |
|       from small pool |    104 MiB |    128 MiB |    158 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    944 MiB | 332462 GiB | 332462 GiB |
|       from large pool |  59136 KiB |    942 MiB | 330699 GiB | 330699 GiB |
|       from small pool |      0 KiB |     31 MiB |   1762 GiB |   1762 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5197    |   56749 K  |   56749 K  |
|       from large pool |       2    |     281    |   24652 K  |   24652 K  |
|       from small pool |       0    |    5091    |   32097 K  |   32097 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5197    |   56749 K  |   56749 K  |
|       from large pool |       2    |     281    |   24652 K  |   24652 K  |
|       from small pool |       0    |    5091    |   32097 K  |   32097 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      85    |     186    |     293    |     208    |
|       from large pool |      33    |     122    |     214    |     181    |
|       from small pool |      52    |      64    |      79    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1178    |   26361 K  |   26361 K  |
|       from large pool |       3    |      64    |   13933 K  |   13933 K  |
|       from small pool |       0    |    1160    |   12428 K  |   12428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 13:24:48 2024]
Finished job 0.
1 of 1 steps (100%) done
