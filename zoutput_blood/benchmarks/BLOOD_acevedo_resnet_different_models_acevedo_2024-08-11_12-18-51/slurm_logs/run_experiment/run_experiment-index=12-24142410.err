Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 12:20:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/12.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=12
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410

 Experiment start at: 2024-08-11 12:30:39.151382
before training, model accuracy: 0.05282306298613548
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8103061, 'precision': 0.41738665, 'recall': 0.42471203, 'specificity': 0.97855926, 'f1': 0.41929865, 'auroc': 0.9407516}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    25   0   0  207    37   147   0     67
1    0  1086   0    14   0   0    0   190     4   0     38
2    0     0   0    12   0   0   76    37   161   0     26
3    0     0   0  7352   0   0    0   727   342   0     16
4    0     0   0     6   0   0   73    22   149   0    289
5    0     0   0   337   0   0   37     2   144   0      1
6    0     2   0    31   0   0  945    70   469   0    391
7    0    40   0   541   0   0    3  6387   166   0    126
8    0     0   0   443   0   0   67   328  2112   0    346
9    0     1   0   123   0   0   87    29   251   0      2
10   0     7   0     8   0   0  129    80   164   0  12404
---- Validation: 
scalar performance:
{'acc': 0.8083456, 'precision': 0.41621447, 'recall': 0.42458913, 'specificity': 0.9783304, 'f1': 0.41879714, 'auroc': 0.9388881}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    30   0   0  221    35   120   0     77
1    0  1092   0    15   0   0    0   178     5   0     42
2    0     1   0    14   0   0   75    45   153   0     24
3    0     0   0  7333   0   0    0   734   352   0     21
4    0     0   0     7   0   0   72    22   139   0    299
5    0     0   0   328   0   0   42     2   148   0      1
6    0     4   0    21   0   0  952    69   453   0    409
7    0    37   0   580   0   0    3  6339   179   0    127
8    0     0   0   468   0   0   72   317  2117   0    322
9    0     0   0   112   0   0   95    25   259   0      2
10   0     5   0    12   0   0  139    74   179   0  12387
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3522004, 'precision': 0.2453207, 'recall': 0.27622974, 'specificity': 0.9306364, 'f1': 0.23795548, 'auroc': 0.7366826}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     8   0    4   0   0  1134   12   10   0     2
1    0  1015   0   19   0   0    73   83    7   0   302
2    0     2   0   47   0   0   765    3   63   0   135
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    69    0    0   0  1564
5    0     0   0  269   0   0   169    2  149   0     3
6    0     4   0    0   0   0  1143    1    4   0  1915
7    0   269   0    2   0   0   117  701   24   0    51
8    0     0   0   45   0   0   710    2  532   0    81
9    0     9   0  199   0   0   714   21  176   0    18
10   0     0   0    0   0   0     3    0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 13:02:28.266533,epoch time: 0:31:49.115151,used: 0:31:49.115151,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8592145, 'precision': 0.6497878, 'recall': 0.5091495, 'specificity': 0.98445547, 'f1': 0.50281525, 'auroc': 0.97351205}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    2     0   0    29   0    8   321    18    39   1     65
1    0  1141   0    16   0    0     0   142     9   0     23
2    0     0   0     8   0    1   105    42   133   1     22
3    0     0   0  7583   0    4     2   505   342   0      2
4    0     0   0     5   0    0   101    15   140   0    278
5    0     0   0   242   0  147    72     0    53   6      1
6    0     1   0    17   0    1  1608    27    90   1    163
7    0    42   0   406   0    0     3  6558   186   0     67
8    0     0   0   251   0    1    33   151  2712   0    148
9    0     1   0    82   0   66   194    22   115  12      1
10   0     4   0     8   0    2   196    54   178   0  12351
---- Validation: 
scalar performance:
{'acc': 0.85809815, 'precision': 0.6440097, 'recall': 0.50718707, 'specificity': 0.9843123, 'f1': 0.5022793, 'auroc': 0.97416276}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    4     0   0    21   0    3   329    17    48   2     59
1    0  1142   0    15   0    0     0   147     8   0     20
2    0     0   0     6   0    2   109    41   133   1     20
3    0     0   0  7546   0    7     1   507   376   0      3
4    0     0   0     3   0    1   106     9   138   0    282
5    0     0   0   264   0  145    51     0    51   8      2
6    0     2   0    13   0    3  1588    32    96   0    174
7    0    24   0   406   0    0     2  6592   171   0     70
8    0     1   0   258   0    0    49   164  2676   0    148
9    0     2   0    98   0   64   182    14   121  11      1
10   0     3   0    11   0    0   169    53   184   0  12376
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.458826, 'precision': 0.39208317, 'recall': 0.35764074, 'specificity': 0.94062597, 'f1': 0.32857257, 'auroc': 0.7707563}
confusion matrix:
    0     1   2   3   4    5     6    7    8   9     10
0    0     1   0   2   0    0  1159    4    3   1     0
1    0  1172   0  21   0    0   121   62    7   1   115
2    0     2   0   4   0   14   876    3   31   1    84
3    0     0   0   0   0    0     0    0    0   0     0
4    0     0   0   0   0    0   106    0    0   0  1527
5    0     0   0  52   0  282   223    0   24   9     2
6    0     3   0   0   0    0  2303    0    0   0   761
7    0   248   0   3   0    0   265  603   16   1    28
8    0     0   0  10   0   24   753    1  529  27    26
9    0    10   0  31   0   78   908    8   65  25    12
10   0     0   0   0   0    0     2    0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 13:33:01.865614,epoch time: 0:30:33.599081,used: 1:02:22.714232,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.89049125, 'precision': 0.7790128, 'recall': 0.62959343, 'specificity': 0.9877243, 'f1': 0.6534823, 'auroc': 0.98390937}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   154     1   0    22   0   17   144    24    15   34     72
1     0  1170   0    17   0    0     0   127     9    0      9
2     6     0  23     9  26    7    14    42    80   78     27
3     1     0   0  7818   0   33     0   422   164    0      2
4     3     0   1     3  69    6    27    13   108   18    291
5     0     0   0   120   0  348     2     0    16   34      1
6     6     1   0    15   0   13  1678    24    37    8    125
7     0    27   1   379   0    0     1  6664   131    1     59
8     2     0   0   315   2    6    12   158  2663    4    133
9     3     1   9    48   2  185     8    13    49  171      3
10    4     6   0    15   8    1    88    53    90    2  12525
---- Validation: 
scalar performance:
{'acc': 0.8923365, 'precision': 0.77597904, 'recall': 0.628612, 'specificity': 0.98791766, 'f1': 0.6536282, 'auroc': 0.98396194}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   160     0   0    21   0   23   140    21    12   28     78
1     0  1156   0    15   0    0     0   142     5    0     14
2     7     1  21     7  26    8    20    40    76   74     32
3     0     0   0  7840   0   37     1   394   162    3      3
4     5     0   4     4  70    2    42    12   105   10    285
5     1     0   0   125   0  344     5     2    13   30      1
6     9     0   0    26   2    8  1667    21    32   10    133
7     0    16   0   339   1    0     2  6733   127    0     47
8     0     0   1   315   4    7    17   149  2664    4    135
9     8     1   6    50   2  177    13    19    44  168      5
10    3     4   1    10   3    2    89    56    90    1  12537
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48443294, 'precision': 0.49633688, 'recall': 0.42608783, 'specificity': 0.945445, 'f1': 0.39712346, 'auroc': 0.82465}
confusion matrix:
    0     1   2   3   4    5     6    7    8    9     10
0   15     1   0   2   0    3  1029    3    2  111     4
1    0  1214   2  24   0    0    64   66    7   10   112
2    1     2  11   3  83   33   441    4   74  120   243
3    0     0   0   0   0    0     0    0    0    0     0
4    0     0   0   0  15    0    22    0    3    1  1592
5    2     0   0  25   0  388    16    0    2  156     3
6    1     3   0   0   1    0  1587    0    0    6  1469
7    4   177   5  11   1    0   219  645   16   53    33
8    1     0   1  23  17   30   218    0  780  204    96
9    3    11  16  28   2  145   246    4   37  623    22
10   0     0   0   0   0    0     0    0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 14:03:15.362120,epoch time: 0:30:13.496506,used: 1:32:36.210738,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90718645, 'precision': 0.803035, 'recall': 0.70496345, 'specificity': 0.98970014, 'f1': 0.7390383, 'auroc': 0.9884629}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   280     0   2     8    0    0    95    18    13    3     64
1     0  1189   0    13    1    0     0   115     2    0     12
2    11     1  94     3   37    1     5    42    41   62     15
3     0     0   0  7728    0   16     1   509   180    2      1
4     7     0  15     3  153    0    19    13    94   12    223
5     5     0   2   107    0  299     3     0     8   95      1
6    18     1   0    10    0    3  1770    18    23    3     61
7     2    21   0   223    1    0     3  6872    83    2     56
8     0     1   3   231    8    3    10   191  2767    1     81
9    27     1  35    44    0   79    14    10    25  254      4
10   14     3   5     6   22    1    79    38   122    3  12501
---- Validation: 
scalar performance:
{'acc': 0.9053364, 'precision': 0.78919625, 'recall': 0.70131266, 'specificity': 0.98951674, 'f1': 0.73323846, 'auroc': 0.98834264}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   269     0   0     8    0    1   101    17    12    6     69
1     0  1194   0    11    1    0     0   115     1    0     10
2    13     1  98     3   36    1     8    34    36   68     14
3     0     0   0  7666    0   18     2   558   188    6      2
4     7     0  27     4  164    1    18    14    74   11    219
5     8     0   2   113    0  291     3     2    11   90      1
6    20     0   0     6    0    0  1760    19    31    6     66
7     2    18   0   223    1    0     2  6880    82    2     55
8     2     0   3   228    8    5     9   186  2767    3     85
9    39     2  40    30    1   94     9    11    23  241      3
10   10     3   2     7   33    2    86    39    98    0  12516
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5401945, 'precision': 0.5584708, 'recall': 0.43720832, 'specificity': 0.95084715, 'f1': 0.4356062, 'auroc': 0.83364457}
confusion matrix:
    0     1   2   3    4    5     6    7    8    9     10
0   86     0   0   3    0    0  1057    0    2   20     2
1    1  1288   0  25    0    0    60   38    4    3    80
2   10     4  55   4  186    6   450    3   79   77   141
3    0     0   0   0    0    0     0    0    0    0     0
4    0     0   1   0  200    0    27    0    2    0  1403
5   26     0   0  54    0  222    54    0    5  228     3
6    6     4   0   0   32    0  2245    0    1    1   778
7   10   240  15  10    1    0   299  537   15    7    30
8    4     0  14  31   28    9   221    0  932   98    33
9   29    19  88  31    6   19   363    7   35  520    20
10   0     1   0   0    8    0     1    0    0    0  1636
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 14:33:35.037705,epoch time: 0:30:19.675585,used: 2:02:55.886323,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.91486514, 'precision': 0.8051746, 'recall': 0.75279474, 'specificity': 0.9906882, 'f1': 0.7727739, 'auroc': 0.99096507}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   350     0    1     7    2    0    15    19    10    5     74
1     0  1205    0    10    2    0     0   104     5    0      4
2     9     1  140     5   41    0     0    29    20   62      5
3     3     0    0  7688    0   15     1   507   218    5      0
4     7     0   48     2  245    0     4     9    59   10    155
5    11     0    2    94    0  254     0     0    10  149      1
6    65     0    1    13    2    1  1675    26    30    7     86
7     2    20    1   168    2    0     3  6947    94    2     25
8     1     1    7   160   17    1     3   167  2881    5     53
9    14     0   48    21    0   44     1    10    26  327      2
10   20     5    4    10   74    2    30    55   111    2  12482
---- Validation: 
scalar performance:
{'acc': 0.91493917, 'precision': 0.807677, 'recall': 0.74757206, 'specificity': 0.9906807, 'f1': 0.77068484, 'auroc': 0.9910655}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   335     0    1     8    1    0    26    22    14    6     70
1     0  1203    0    11    1    0     0   108     4    0      5
2    10     3  135     2   41    1     1    29    28   58      4
3     1     0    0  7710    0   12     0   497   216    4      0
4     2     0   51     5  236    0     5    12    62   11    155
5     5     0    1    93    0  260     0     0    12  149      1
6    68     0    1    11    5    0  1672    22    35    5     89
7     0    23    2   164    2    0     1  6957    97    0     19
8     1     0    4   179   11    1     3   166  2864    8     59
9    14     1   46    27    0   42     1    12    21  327      2
10   22     9    4     6   65    1    27    68    87    1  12506
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5182257, 'precision': 0.58625495, 'recall': 0.45812088, 'specificity': 0.9498825, 'f1': 0.46309778, 'auroc': 0.8414332}
confusion matrix:
     0     1    2   3    4    5     6    7     8    9     10
0   349     1    2   8    0    0   733    1     6   43    27
1     1  1344    0  28    0    0    13   48     5    1    59
2     7    10  113   7  234    1   130    6   113   85   309
3     0     0    0   0    0    0     0    0     0    0     0
4     0     1    2   0  267    0     4    0     1    0  1358
5    18     0    0  59    0  152    23    0    10  325     5
6    10     4    2   0   41    0  1138    0     4    1  1867
7    12   175   31  19    1    0   122  739    25    7    33
8     4     0   25  41   36    5    62    0  1041   85    71
9    24    35  157  42    8    8   137    9    49  631    37
10    0     1    0   0   12    0     0    0     0    0  1633
better model found
persisted
after epoch: 5,now: 2024-08-11 15:04:03.480943,epoch time: 0:30:28.443238,used: 2:33:24.329561,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92438996, 'precision': 0.821457, 'recall': 0.7717215, 'specificity': 0.99168015, 'f1': 0.7901348, 'auroc': 0.9928407}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   384     0    0     4    0    0    13    12     7    2     61
1     0  1224    0    17    0    0     1    76     6    0      8
2    13     1  149     3   27    4     2    20    20   68      5
3     3     0    0  8046    0   21     0   245   122    2      0
4    11     0   43     4  215    2     6     8    64   17    168
5    13     0    1    80    0  349     0     0     7   70      1
6    61     0    0    10    0    0  1757     9    15    2     54
7     1    24    0   345    1    0     5  6777    83    3     25
8     3     1    3   250    9    4     8   122  2842    4     49
9    29     2   34    25    0   94     3     3    15  285      2
10   45     0    6     7   37    2    31    31   110    1  12522
---- Validation: 
scalar performance:
{'acc': 0.9250234, 'precision': 0.8258379, 'recall': 0.77013993, 'specificity': 0.99175245, 'f1': 0.7906802, 'auroc': 0.9930248}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     0    0     9    0    0    28     9     7    4     49
1     0  1216    0    13    0    0     0    89     3    0     11
2    15     1  151     3   23    1     2    21    24   65      6
3     2     0    0  8062    0   16     2   227   126    3      2
4     6     0   47     2  205    1    10    12    68   15    173
5     9     0    1    81    0  342     1     0     7   79      1
6    55     0    1    11    2    2  1760    11    19    4     43
7     2    18    1   348    1    0     2  6779    84    2     28
8     1     1    2   252   10    2     8   108  2864    4     44
9    30     3   25    21    0   93     2     6    13  295      5
10   40     3    3    10   32    1    45    31    99    1  12531
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53053945, 'precision': 0.60328126, 'recall': 0.45799106, 'specificity': 0.95067716, 'f1': 0.46588522, 'auroc': 0.83246815}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   257     0    1   12    0    0   872    0     1   12    15
1     2  1284    0   39    0    0    29   58     5    1    81
2     8     4   81   15  101    7   231    5   120   53   390
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  111    0     8    0     5    0  1507
5    17     0    0  101    0  268    54    0     7  140     5
6    10     3    0    0    9    0  1675    0     2    1  1367
7     4    78   10   72    0    0   237  691    29    5    38
8     2     0   11   59   12    9    94    0  1073   44    66
9    24    29  102   86    2   26   261    3    55  501    48
10    0     0    0    0    4    0     0    0     0    0  1642
better model found
persisted
after epoch: 6,now: 2024-08-11 15:34:00.741522,epoch time: 0:29:57.260579,used: 3:03:21.590140,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93014234, 'precision': 0.83979857, 'recall': 0.7773059, 'specificity': 0.9922256, 'f1': 0.80428493, 'auroc': 0.99382454}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   341     0    0    11    0    0    33    10     7    6     75
1     0  1235    0    17    0    0     1    68     5    0      5
2     3     1  135     1   60    2     2    24    12   66      6
3     1     0    0  8001    0   24     2   309   100    2      0
4     1     0   25     3  274    1     4    10    45   13    163
5     2     0    1    77    0  342     2     0     9   86      2
6    18     0    0    13    2    0  1800     5    16    1     53
7     0    24    1   250    2    0     2  6883    68    2     31
8     2     0    3   241   12    6     8   126  2831    4     62
9    10     1   43    28    1   70     3     6    10  313      8
10   16     3    1    12   54    1    22    27    45    1  12610
---- Validation: 
scalar performance:
{'acc': 0.9312559, 'precision': 0.84454334, 'recall': 0.7841098, 'specificity': 0.9923531, 'f1': 0.81072265, 'auroc': 0.9938262}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     0    1     9    1    0    38    12     5    3     68
1     0  1237    0    16    2    0     0    65     7    0      5
2     5     1  154     2   46    0     2    19    16   59      8
3     1     1    0  8020    0   16     0   297   103    2      0
4     3     0   27     2  281    1     5     9    48    7    156
5     0     0    1    79    0  337     1     0     4   98      1
6    18     0    3     9    1    1  1802     8     8    2     56
7     0    18    3   238    1    0     2  6900    68    0     35
8     2     1    3   241   11    2     6   124  2839    3     64
9    10     1   44    19    1   81     6     9     9  310      3
10   13     4    1    20   50    1    25    37    55    1  12589
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51577693, 'precision': 0.6036376, 'recall': 0.4372084, 'specificity': 0.94919044, 'f1': 0.44166744, 'auroc': 0.8323905}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   100     0    2   13    0    0   963    1     5   21    65
1     0  1326    0   35    0    0    31   42     6    1    58
2     1     5   74   13  192    2   145    4   143   44   392
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    1    0  253    0     5    0     3    0  1371
5     4     0    0  103    1  201    64    0    12  192    15
6     3     4    0    0   23    0  1581    0     4    1  1451
7     0    84   11   88    1    0   246  668    30    4    32
8     1     0    9   65   22    6    71    0  1075   36    85
9     1    30  133   79   16   17   243    3    74  462    79
10    0     1    0    0   13    0     0    0     0    0  1632
better model found
persisted
after epoch: 7,now: 2024-08-11 16:04:00.953737,epoch time: 0:30:00.212215,used: 3:33:21.802355,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93455696, 'precision': 0.8347293, 'recall': 0.8171063, 'specificity': 0.9928597, 'f1': 0.82448447, 'auroc': 0.99416476}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     0    1     3    1    1    17    10     4    3     64
1     0  1255    0    15    0    0     0    53     3    0      5
2     4     1  214     1   28    1     3     7    10   39      4
3     2     0    0  7861    0   42     1   348   179    3      1
4     4     0   49     0  301    3     3    10    32    7    130
5     5     0    5    48    0  377     0     0     5   80      1
6    17     1    3    12    4    0  1801     3    12    4     51
7     0    47   10   167    3    0     2  6908    93    1     32
8     3     0    9   130   24    6     7    99  2941    2     74
9     7     1   78    14    1   83     3     4    10  290      2
10   22     5    3     8   83    3     7    24    36    0  12603
---- Validation: 
scalar performance:
{'acc': 0.93443894, 'precision': 0.83245915, 'recall': 0.81389546, 'specificity': 0.9928484, 'f1': 0.82117754, 'auroc': 0.9943759}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   381     0    1     5    1    1    16     6     8    1     63
1     0  1254    1    12    2    0     0    52     4    0      7
2     6     0  215     1   28    1     4     8    12   30      7
3     1     0    1  7876    0   33     1   344   177    6      1
4     5     1   61     1  286    1     3     8    27    5    141
5     4     0    2    50    0  367     0     0     7   90      1
6    26     0    3     8    5    0  1792     5    13    4     52
7     0    34    7   171    3    0     3  6911   101    2     33
8     1     2   10   129   20   10     6    92  2959    5     62
9     8     0   77    12    2   86     2     4     8  292      2
10   25     5    9    11   66    3    11    23    41    1  12601
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5441825, 'precision': 0.61677575, 'recall': 0.48965037, 'specificity': 0.9527983, 'f1': 0.50225353, 'auroc': 0.8475869}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   293     0    6   16    0    0   682    0     8   68    97
1     0  1319    0   47    0    0    21   46     4    3    59
2     2     3  161    6  228   13    61    4   102   63   372
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  295    0     4    0     2    0  1330
5     2     0    0   46    0  338    17    0     7  176     6
6    10     3    4    0   31    0  1371    0     2    1  1645
7     1    49   28  136    1    0   167  701    28   20    33
8     0     0   22   40   30   13    27    0  1086   57    95
9     3    20  216   49    3   59    77    3    53  583    71
10    0     1    0    0   14    0     0    0     0    0  1631
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-11 16:34:13.095591,epoch time: 0:30:12.141854,used: 4:03:33.944209,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9375, 'precision': 0.843406, 'recall': 0.8136147, 'specificity': 0.993058, 'f1': 0.8267782, 'auroc': 0.9954046}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   402     0    0     6    0    0    11     6     3    1     54
1     0  1242    0    17    0    0     0    61     5    0      7
2     4     0  202     1   36    2     2    14     3   42      6
3     3     0    0  8145    0   23     0   155   106    3      1
4     8     0   38     2  293    2     3     7    23    3    159
5     8     0    1    58    0  359     0     0     8   85      1
6    35     0    1    10    3    1  1806     1     6    1     43
7     3    14    4   347    2    0     2  6797    61    4     30
8     9     0   10   221   32    6     5   102  2836    4     71
9    16     0   62    20    3   80     1     3     6  298      4
10   33     0    4     9   41    1    16    14    16    1  12660
---- Validation: 
scalar performance:
{'acc': 0.93553567, 'precision': 0.84082973, 'recall': 0.80711544, 'specificity': 0.9928257, 'f1': 0.82182264, 'auroc': 0.9950208}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     3    1    0    10     5     2    2     51
1     0  1237    1    17    0    0     2    66     2    0      7
2     7     1  190     0   29    2     3    13     6   48     13
3     3     1    1  8107    0   27     0   179   117    5      0
4     8     0   36     2  287    2     3     5    25    8    163
5     4     0    2    66    0  345     0     0     6   97      1
6    28     0    2     9    1    0  1808     3     8    2     47
7     3    13    5   344    1    0     4  6784    74    2     35
8     6     0    7   205   28    4     5    98  2853    3     87
9    16     0   59    21    0   81     1     3     9  297      6
10   35     0    6     8   40    1     8    16    23    1  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4923389, 'precision': 0.59555453, 'recall': 0.4415065, 'specificity': 0.9475399, 'f1': 0.46412587, 'auroc': 0.82993805}
confusion matrix:
     0     1    2    3    4    5     6    7    8    9     10
0   418     0    4   14    0    0   565    1    2   32   134
1     1  1292    2   49    0    0    29   50    2    2    72
2     3     2  119    7  211    6    41    4   35   42   545
3     0     0    0    0    0    0     0    0    0    0     0
4     0     0    2    0  169    0     2    0    0    0  1460
5     5     0    0   60    2  264    19    0    6  213    23
6    14     0    2    0   12    0  1153    1    0    1  1884
7     7    27   18  182    0    0   248  614   12   10    46
8     1     0   29   46   60   10    31    1  884   61   247
9     5     8  271   53   11   32    83    9   24  484   157
10    0     0    0    0    6    0     0    0    0    0  1640
better model found
persisted
after epoch: 9,now: 2024-08-11 17:04:24.998615,epoch time: 0:30:11.903024,used: 4:33:45.847233,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94116545, 'precision': 0.8431734, 'recall': 0.8341334, 'specificity': 0.9936555, 'f1': 0.83736426, 'auroc': 0.9954274}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0     8    2    0    13     6     6    5     29
1     0  1251    1    12    0    0     1    60     4    0      3
2     7     0  227     1   18    3     3    10     5   36      2
3     1     1    0  8098    0   33     1   205    97    4      0
4     3     0   58     2  312    0     3     7    39    7    108
5     5     0    2    59    0  370     0     0     4   80      1
6    29     0    2    12    1    2  1821     4    14    2     21
7     3    21    5   236    2    0     2  6895    82    3     13
8     3     1    8   182   19    4     3    81  2946    9     37
9    14     0   50    17    0   83     3     4    12  308      2
10   50     1    5    10   83    2    18    23    66    0  12535
---- Validation: 
scalar performance:
{'acc': 0.9395747, 'precision': 0.8365234, 'recall': 0.8276906, 'specificity': 0.9934966, 'f1': 0.8305026, 'auroc': 0.9956813}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     0    0     8    0    0    18     4     6    3     37
1     0  1246    0    14    1    0     0    62     4    0      5
2     6     0  216     1   20    2     3    11     7   45      1
3     3     1    0  8057    0   38     0   221   120    0      0
4     5     0   67     0  299    1     6     9    41    8    103
5     7     0    3    51    0  368     0     0     4   87      1
6    32     0    0     7    1    1  1828     6     8    1     24
7     2    15    6   242    1    0     2  6908    70    2     17
8     5     3    6   194   14    9     7    82  2942    7     27
9    11     0   54    10    2   90     2     1     7  314      2
10   48     1   10     8   74    2    14    27    68    3  12541
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59833485, 'precision': 0.63370943, 'recall': 0.5091317, 'specificity': 0.9586213, 'f1': 0.5300643, 'auroc': 0.8541208}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   488     0    2   28    0    0   561    0     2   30    59
1     1  1315    1   53    0    0    15   55     1    1    57
2     4     2  153   13  250    9    65    4   124   47   344
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  299    0     6    0     6    0  1320
5     7     0    0   83    2  278    16    0     5  189    12
6    29     1    2    0   14    0  2120    0     4    1   896
7     3    16   15  261    1    0   171  642    33   10    12
8     1     0   14   64   30   12    38    2  1075   54    80
9     9    16  215   76    8   39    86    5    46  550    87
10    0     0    0    0   14    0     0    0     0    0  1632
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-11 17:34:38.987077,epoch time: 0:30:13.988462,used: 5:03:59.835695,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:03:59.835695 at 2024-08-11 17:34:38.987077
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59833485, 'precision': 0.63370943, 'recall': 0.5091317, 'specificity': 0.9586213, 'f1': 0.5300643, 'auroc': 0.8541208}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   488     0    2   28    0    0   561    0     2   30    59
1     1  1315    1   53    0    0    15   55     1    1    57
2     4     2  153   13  250    9    65    4   124   47   344
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  299    0     6    0     6    0  1320
5     7     0    0   83    2  278    16    0     5  189    12
6    29     1    2    0   14    0  2120    0     4    1   896
7     3    16   15  261    1    0   171  642    33   10    12
8     1     0   14   64   30   12    38    2  1075   54    80
9     9    16  215   76    8   39    86    5    46  550    87
10    0     0    0    0   14    0     0    0     0    0  1632
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59833485, 'precision': 0.63370943, 'recall': 0.5091317, 'specificity': 0.9586213, 'f1': 0.5300643, 'auroc': 0.8541208}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   488     0    2   28    0    0   561    0     2   30    59
1     1  1315    1   53    0    0    15   55     1    1    57
2     4     2  153   13  250    9    65    4   124   47   344
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  299    0     6    0     6    0  1320
5     7     0    0   83    2  278    16    0     5  189    12
6    29     1    2    0   14    0  2120    0     4    1   896
7     3    16   15  261    1    0   171  642    33   10    12
8     1     0   14   64   30   12    38    2  1075   54    80
9     9    16  215   76    8   39    86    5    46  550    87
10    0     0    0    0   14    0     0    0     0    0  1632
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142410_instance_wise_predictions.txt
accuracy from prediction file 0.5983348492268943
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/12.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494810 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool | 404096 KiB |  10877 MiB | 344198 GiB | 344197 GiB |
|       from small pool |  90714 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 494810 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool | 404096 KiB |  10877 MiB | 344198 GiB | 344197 GiB |
|       from small pool |  90714 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 342301 GiB | 342300 GiB |
|       from small pool |  90258 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11418 MiB |  11418 MiB |  11418 MiB |      0 B   |
|       from large pool |  11290 MiB |  11290 MiB |  11290 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 717605 KiB |   1129 MiB | 107908 GiB | 107907 GiB |
|       from large pool | 707968 KiB |   1126 MiB | 107201 GiB | 107201 GiB |
|       from small pool |   9637 KiB |     11 MiB |    706 GiB |    706 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   27226 K  |   27223 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2922    |    4522    |   15171 K  |   15168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   27226 K  |   27223 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2922    |    4522    |   15171 K  |   15168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     293    |     293    |     293    |       0    |
|       from large pool |     229    |     229    |     229    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      47    |    1129    |   14481 K  |   14481 K  |
|       from large pool |      16    |     119    |    7024 K  |    7024 K  |
|       from small pool |      31    |    1112    |    7457 K  |    7457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342301 GiB | 342301 GiB |
|       from small pool |      0 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |  11418 MiB |  11418 MiB |  10234 MiB |
|       from large pool |   1086 MiB |  11290 MiB |  11290 MiB |  10204 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1129 MiB | 107908 GiB | 107908 GiB |
|       from large pool |  59136 KiB |   1126 MiB | 107202 GiB | 107201 GiB |
|       from small pool |      0 KiB |     32 MiB |    706 GiB |    706 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     293    |     293    |     216    |
|       from large pool |      28    |     229    |     229    |     201    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1129    |   14481 K  |   14481 K  |
|       from large pool |       3    |     119    |    7024 K  |    7024 K  |
|       from small pool |       0    |    1112    |    7457 K  |    7457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342301 GiB | 342301 GiB |
|       from small pool |      0 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |  11418 MiB |  11418 MiB |  10234 MiB |
|       from large pool |   1086 MiB |  11290 MiB |  11290 MiB |  10204 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1129 MiB | 107908 GiB | 107908 GiB |
|       from large pool |  59136 KiB |   1126 MiB | 107202 GiB | 107201 GiB |
|       from small pool |      0 KiB |     32 MiB |    706 GiB |    706 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     293    |     293    |     216    |
|       from large pool |      28    |     229    |     229    |     201    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1129    |   14481 K  |   14481 K  |
|       from large pool |       3    |     119    |    7024 K  |    7024 K  |
|       from small pool |       0    |    1112    |    7457 K  |    7457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410

 Experiment start at: 2024-08-11 17:49:38.381211
before training, model accuracy: 0.06982439011335373
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8023063, 'precision': 0.41672665, 'recall': 0.4123807, 'specificity': 0.9774219, 'f1': 0.41186506, 'auroc': 0.93956864}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    33   0   0  196    48   122   0     84
1    0  1011   0    16   0   0    0   243     4   0     57
2    0     0   0    25   0   0   61    54   156   0     16
3    0     2   0  7770   0   0    0   433   217   0     15
4    0     0   0    14   0   0   73    25   150   0    277
5    0     0   0   366   0   0   11     4   138   0      2
6    0     1   0    45   0   0  921    70   427   0    443
7    0    21   0   915   0   0    9  6020   160   0    140
8    0     0   0   721   0   0  105   238  1904   0    327
9    0     0   0   156   0   0   44    37   255   0      1
10   0     4   0    21   0   0  112    90   205   0  12361
---- Validation: 
scalar performance:
{'acc': 0.8003745, 'precision': 0.41472656, 'recall': 0.41097477, 'specificity': 0.9772412, 'f1': 0.4101107, 'auroc': 0.94007206}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    31   0   0  188    34   153   0     77
1    0  1011   0    16   0   0    1   237     2   0     65
2    0     0   0    19   0   0   63    45   168   0     17
3    0     0   0  7777   0   0    1   440   203   0     19
4    0     0   0     7   0   0   80    23   142   0    287
5    0     0   0   353   0   0    9     2   155   0      2
6    0     2   0    47   0   0  902    77   435   0    445
7    0    28   0   943   0   0   10  5960   176   0    148
8    0     0   0   705   0   0  115   257  1917   0    302
9    0     0   0   141   0   0   49    38   264   0      1
10   0     2   0    27   0   0  107    90   215   0  12355
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3815854, 'precision': 0.24503621, 'recall': 0.28475633, 'specificity': 0.93462, 'f1': 0.23803702, 'auroc': 0.74603397}
confusion matrix:
    0    1   2    3   4   5     6    7    8   9     10
0    0    0   0    3   0   0   908    2  254   0     3
1    0  918   0   16   0   0    43   70  102   0   350
2    0    1   0   14   0   0   542    1  351   0   106
3    0    0   0    0   0   0     0    0    0   0     0
4    0    0   0    0   0   0    99    0    6   0  1528
5    0    0   0  192   0   0    26    0  371   0     3
6    0    0   0    0   0   0  1659    0   71   0  1337
7    0  113   0   10   0   0   116  619  246   0    60
8    0    0   0   14   0   0   693    0  616   0    47
9    0    9   0   56   0   0   274    3  781   0    14
10   0    0   0    0   0   0     4    0    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 18:21:20.578483,epoch time: 0:31:42.197272,used: 0:31:42.197272,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8538634, 'precision': 0.5468178, 'recall': 0.49335766, 'specificity': 0.98374677, 'f1': 0.48985738, 'auroc': 0.9730043}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    17   0   1   329    12    56   5     62
1    0  1130   0    17   0   0     0   150     4   0     31
2    0     0   0    16   0   2   115    51   101   7     20
3    0     0   0  7772   0   3     1   370   284   0      7
4    0     0   0     9   0   0   122    10   138   1    259
5    0     0   0   335   0  83    41     1    42  16      2
6    0     0   0    28   0   2  1546    30   121   0    180
7    0    32   0   551   0   0     9  6405   180   0     86
8    0     0   0   375   0   0    58   127  2601   0    135
9    0     0   0   138   0  40   143    21   125  25      1
10   0     2   0    15   0   0   200    58   168   0  12352
---- Validation: 
scalar performance:
{'acc': 0.85408586, 'precision': 0.6574726, 'recall': 0.49707294, 'specificity': 0.9837661, 'f1': 0.49544978, 'auroc': 0.9732295}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    33   0   4   319    19    49   3     56
1    0  1134   0    19   0   0     1   151     3   0     24
2    0     0   1    13   0   0   113    47   119   3     16
3    0     0   0  7782   0   0     2   366   286   0      4
4    0     0   0     7   0   0   106    15   144   0    267
5    0     0   0   328   0  96    45     2    40  10      0
6    0     2   0    26   0   5  1553    27   116   1    178
7    0    26   0   558   0   0     5  6396   185   0     95
8    0     1   0   348   0   1    53   150  2603   0    140
9    0     1   0   130   0  34   143    26   129  29      1
10   0     1   0    15   0   1   212    59   172   0  12336
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4635136, 'precision': 0.3736158, 'recall': 0.32913518, 'specificity': 0.9417877, 'f1': 0.2957587, 'auroc': 0.7897072}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     0   0    4   0   2  1128    1   27   7     1
1    0  1133   0   20   0   0    91   40   55   0   160
2    0     2   0   23   0   6   793    1  107  10    73
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0   154    0    5   0  1474
5    0     0   0  271   0  93   102    0   72  53     1
6    0     0   0    0   0   0  2719    0    6   0   342
7    0   217   0    7   0   0   394  444   65   0    37
8    0     0   0   44   0   1   736    0  554   7    28
9    0    11   0  113   0  36   618    1  295  49    14
10   0     0   0    0   0   0    13    0    0   0  1633
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 18:51:29.693205,epoch time: 0:30:09.114722,used: 1:01:51.311994,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.88441783, 'precision': 0.76498497, 'recall': 0.60560334, 'specificity': 0.9872694, 'f1': 0.61988, 'auroc': 0.9830205}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   96     0   0    21   0    4   201    26    31   48     56
1    0  1131   0    16   0    0     0   164     5    0     15
2    9     0  11     5   9    3     9    49    99  102     16
3    0     0   0  7727   0   23     0   436   250    3      0
4    4     0   2     3  17    1    38    18   175   25    256
5    3     0   0   167   0  256     2     1    13   78      1
6    2     1   0    11   1    9  1665    32    64   12    110
7    0    13   0   300   0    0     5  6764   141    0     40
8    0     0   0   255   0    4    13   152  2791    4     76
9    4     1   4    66   1   76    14    24    45  258      0
10   3     3   0    11   2    1   120    89   219    5  12340
---- Validation: 
scalar performance:
{'acc': 0.8847399, 'precision': 0.777041, 'recall': 0.60797834, 'specificity': 0.9873017, 'f1': 0.6236776, 'auroc': 0.9827165}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   93     0   0    19   0    3   198    20    36   52     62
1    0  1145   0    16   0    0     1   158     2    0     10
2    7     0  16     5   7    1    14    50    98  101     13
3    0     0   0  7695   0   22     0   462   256    3      2
4    4     0   4     1  19    1    47    22   159   28    254
5    2     0   0   169   0  262     1     0    15   71      1
6    1     1   0    14   0    8  1643    33    73   14    121
7    0     9   0   297   0    0     2  6772   146    1     38
8    0     0   0   254   0    5     6   144  2815    5     67
9    6     0   3    66   0   71    13    22    54  257      1
10  12     1   2    11   0    2   115    81   211    2  12359
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5494298, 'precision': 0.5822863, 'recall': 0.44207188, 'specificity': 0.9523166, 'f1': 0.40760043, 'auroc': 0.8349761}
confusion matrix:
    0     1   2    3   4    5     6    7    8    9     10
0   12     0   0    3   0    7  1051    0   27   69     1
1    0  1221   0   27   0    0    49   67   60    2    73
2    0     7   1   14   1   17   371    3  283  138   180
3    0     0   0    0   0    0     0    0    0    0     0
4    0     1   0    0   0    0    61    0   17    2  1552
5    0     0   0  124   0  291    27    0   29  120     1
6    0     1   0    0   0    0  2561    0   35    3   467
7    0   121   0   14   0    0   243  611  137   17    21
8    1     0   0   47   0   11   183    0  962   95    71
9    1    15   0   60   0   81   182    1  227  553    17
10   0     1   0    0   0    0     4    0    0    0  1641
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 19:21:43.582203,epoch time: 0:30:13.888998,used: 1:32:05.200992,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8987318, 'precision': 0.7825617, 'recall': 0.69082713, 'specificity': 0.98863196, 'f1': 0.7238033, 'auroc': 0.9872045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   237     1    4    10    0    2    86    21    16   15     91
1     0  1156    0    16    0    0     0   139     6    0     15
2    11     0  113     4   42    3     4    27    21   78      9
3     0     1    0  7974    0   40     0   258   162    1      1
4     9     0   24     6  142    2     4    14    74   17    247
5     4     0    2   121    0  279     0     0    10  104      1
6    26     2    0    24    0    3  1691    22    31    8    100
7     0    46    2   525    0    1     2  6522   108    0     56
8     1     1    4   335   10    7    12   114  2687    4    120
9     8     1   43    43    1   84     5     8    22  274      4
10   22     5    5    20   24    1    42    65    90    5  12516
---- Validation: 
scalar performance:
{'acc': 0.9012438, 'precision': 0.79204655, 'recall': 0.6921079, 'specificity': 0.98890287, 'f1': 0.72632277, 'auroc': 0.9871191}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   245     0    1    15    2    2    77    25    16   20     80
1     0  1150    0    22    0    0     0   146     7    0      7
2     9     3  109     3   30    1     1    23    37   80     16
3     0     1    0  7992    0   35     0   264   143    3      2
4    11     1   22     5  135    0     9     7    78   18    253
5     3     0    1   120    0  281     0     0     9  106      1
6    27     0    1    21    1    6  1709    20    23    8     92
7     0    49    2   478    1    0     4  6548   119    0     64
8     0     0    2   340    5    3    12   137  2682    2    113
9    10     0   47    40    0   76     3    14    22  278      3
10   23     5    2    14   18    1    47    53    69    0  12564
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51227874, 'precision': 0.54335654, 'recall': 0.4369077, 'specificity': 0.94914794, 'f1': 0.42534775, 'auroc': 0.84255916}
confusion matrix:
     0     1   2   3    4    5     6    7    8    9     10
0   286     0   0   5    0    2   786    0   29   41    21
1     0  1285   2  29    1    0    36   27   40    2    77
2    12     7  45  16  125   14   155    1  219  110   311
3     0     0   0   0    0    0     0    0    0    0     0
4     0     0   1   0   60    0     8    0    7    1  1556
5     3     0   0  84    0  315    20    0   27  141     2
6    15     1   0   0   24    0  1795    0   28    3  1201
7     4   300  12  40    0    0   274  355  128    8    43
8     3     0   1  46   27    7    63    0  999   72   152
9    24    17  69  66   20   62   106    0  204  537    32
10    0     1   0   0    0    0     0    0    0    0  1645
better model found
persisted
after epoch: 4,now: 2024-08-11 19:52:04.396249,epoch time: 0:30:20.814046,used: 2:02:26.015038,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9123502, 'precision': 0.80180395, 'recall': 0.741457, 'specificity': 0.9903269, 'f1': 0.7626945, 'auroc': 0.98959434}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   302     1    4     8    0    3    51    15    10   13     75
1     0  1213    0    13    0    0     1    93     4    0      8
2    10     1  145     1   21    2     1    20    14   82     15
3     0    18    1  7737    0   34     1   448   193    7      1
4    12     0   48     1  173    2     6    15    65   17    200
5     2     0    1    79    0  323     1     1     7  105      2
6    42     0    2     3    0    7  1719    23    25    4     82
7     0    57    3   228    1    0     3  6819   104    0     46
8     2     1    5   230    8    7    11   141  2806    5     78
9     5     1   40    21    1   88     5     8    15  307      2
10   25    11    6     7   30    2    25    51    79    3  12556
---- Validation: 
scalar performance:
{'acc': 0.9126388, 'precision': 0.8062526, 'recall': 0.7417524, 'specificity': 0.99036807, 'f1': 0.76366484, 'auroc': 0.9898941}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   300     1    0     6    0    2    54    18    17   17     68
1     0  1198    1    15    0    0     2   100     6    0     10
2     7     0  154     2   19    1     1    19    17   86      6
3     0    15    0  7750    0   41     2   443   184    5      0
4    10     1   36     0  164    4     6    13    67   21    217
5     4     0    2    87    0  325     0     1     8   93      1
6    42     0    2     7    2    1  1719    19    25   11     80
7     2    65    2   198    2    0     2  6841   107    3     43
8     1     5    6   210   10    8     8   137  2828    5     78
9     3     1   38    29    1   84     2    14    12  305      4
10   27    18    8     8   20    0    38    58    83    1  12535
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52795076, 'precision': 0.59155375, 'recall': 0.45182836, 'specificity': 0.9506755, 'f1': 0.4378478, 'auroc': 0.84959257}
confusion matrix:
     0     1   2   3   4    5     6    7     8    9     10
0   206     0   0   9   0    5   865    0    32   43    10
1     0  1323   0  31   0    0    25   30    26    2    62
2     3    12  76  17  54   16   154    2   210  108   363
3     0     0   0   0   0    0     0    0     0    0     0
4     0     3   1   0  98    0     7    0     6    0  1518
5     0     0   0  86   0  353    32    0    25   95     1
6    12     2   0   0   9    0  1868    0    16   10  1150
7     1   326  17  32   0    0   255  386    98   15    34
8     0     0   1  48   7   10    67    0  1069   43   125
9     4    26  76  59   1   98   121    1   190  525    36
10    0     1   0   0   3    0     0    0     0    0  1642
better model found
persisted
after epoch: 5,now: 2024-08-11 20:22:00.601458,epoch time: 0:29:56.205209,used: 2:32:22.220247,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9196811, 'precision': 0.821978, 'recall': 0.7622752, 'specificity': 0.9910828, 'f1': 0.7878052, 'auroc': 0.9917272}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   329     0    0     4    0    1    40    11    13    5     80
1     0  1219    0    10    1    0     0    91     3    1      7
2     7     2  156     0   46    3     1    19    21   49      8
3     0     1    0  7656    0   32     2   494   248    3      1
4     2     2   30     2  231    1     4     7    50    6    204
5     0     0    4    75    0  330     4     1     6  100      1
6    27     0    0     4    2    0  1750    18    17    1     89
7     0    21    3   148    1    0     3  6929   109    0     50
8     1     1    5   143   14    3     8   140  2882    2     95
9     8     0   66    17    0   77     3     9    20  290      3
10   18     2    4     9   45    3    22    34    54    0  12602
---- Validation: 
scalar performance:
{'acc': 0.9215461, 'precision': 0.82451576, 'recall': 0.76511, 'specificity': 0.9912863, 'f1': 0.7904952, 'auroc': 0.99218404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   330     1    0     7    2    0    37    17     7    2     80
1     0  1216    0    13    0    0     1    92     4    0      6
2     5     0  162     2   48    0     4    22     9   51      9
3     1     0    0  7660    0   34     0   493   245    5      2
4     9     0   23     0  238    2     3    12    36    8    208
5     4     0    5    76    0  320     2     1    12   99      2
6    27     1    1     6    1    1  1747    19    18    2     85
7     1    31    2   134    2    0     2  6943   105    1     44
8     2     0    5   125   16    2     4   140  2909    1     92
9    13     1   64    14    1   77     3     8    15  294      3
10   14     3    6     8   31    2    22    28    48    1  12633
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51395786, 'precision': 0.5826411, 'recall': 0.4323192, 'specificity': 0.9489947, 'f1': 0.41274858, 'auroc': 0.83710545}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   41     0   1    6    0    2  1053    0    31   14    22
1    0  1325   0   34    0    0    24   31    25    0    60
2    0    13  41   16   98   15   167    4   212   39   410
3    0     0   0    0    0    0     0    0     0    0     0
4    0     1   0    0  147    0     6    0     6    0  1473
5    0     0   0  110    0  338    62    0    33   47     2
6    3     2   0    1   11    0  1882    0     8    2  1158
7    0   220   3   48    0    0   199  546   111    5    32
8    0     0   1   42   13    9    78    0  1087    8   132
9    0    32  95   84    6  109   202    4   247  298    60
10   0     1   0    0    4    0     0    0     0    0  1641
better model found
persisted
after epoch: 6,now: 2024-08-11 20:52:16.793519,epoch time: 0:30:16.192061,used: 3:02:38.412308,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92554045, 'precision': 0.8326827, 'recall': 0.7741623, 'specificity': 0.99176073, 'f1': 0.7963959, 'auroc': 0.9931871}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   342     0    1     7    0    0    33    15    10    5     70
1     0  1228    1    16    0    0     0    76     6    0      5
2     4     0  199     2   27    2     2    18    12   43      3
3     0     0    0  7880    0   24     1   395   136    1      0
4     3     0   58     0  212    2     5    17    58    6    178
5     2     0    3    78    0  359     0     1     7   70      1
6    23     0    1    13    1    3  1764    20    23    3     56
7     0    19    0   191    1    0     3  6949    76    2     22
8     0     1    7   236   12    1     7   139  2837    2     53
9     6     1   83    29    1   98     3     6    13  249      3
10   20     3    6     7   29    3    20    62    71    0  12574
---- Validation: 
scalar performance:
{'acc': 0.9261201, 'precision': 0.82988995, 'recall': 0.7759279, 'specificity': 0.9918637, 'f1': 0.79760504, 'auroc': 0.9931091}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   342     1    1    10    0    0    34    17    11    5     62
1     0  1228    1    13    0    0     0    78     5    0      7
2     6     0  194     3   26    1     2    19    17   39      5
3     0     0    0  7891    0   25     0   383   139    2      0
4     4     0   57     0  233    2     2    15    54    9    163
5     2     0    4    87    0  347     2     0     6   72      1
6    28     0    1    13    1    2  1756    16    25    2     64
7     0    19    1   186    2    0     3  6962    81    0     11
8     1     0    8   225   11    2     8   135  2858    1     47
9     5     1   76    29    0   96     2    12    12  258      2
10   24     2    9    11   43    1    19    43    88    2  12554
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48891065, 'precision': 0.5957944, 'recall': 0.4172934, 'specificity': 0.94725716, 'f1': 0.39794475, 'auroc': 0.8420036}
confusion matrix:
    0     1    2    3    4    5     6    7     8    9     10
0   53     0    1   26    0    2   960    0    46   23    59
1    0  1308    0   51    0    0    15   40    24    0    61
2    0    13   64   38   36   25    72    3   360   37   367
3    0     0    0    0    0    0     0    0     0    0     0
4    0     1    1    1  120    0     4    0    13    0  1493
5    0     0    0  205    0  308    31    0    22   24     2
6    3     2    1    2    2    1  1576    0    37    2  1441
7    0   166    4  137    0    0   151  558   122    1    25
8    0     0    2  129    2    5    25    0  1140    4    63
9    0    32  125  211    1  133    91    3   276  219    46
10   0     1    0    0    3    0     0    0     0    0  1642
better model found
persisted
after epoch: 7,now: 2024-08-11 21:22:22.230184,epoch time: 0:30:05.436665,used: 3:32:43.848973,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93228275, 'precision': 0.840321, 'recall': 0.79884374, 'specificity': 0.9925356, 'f1': 0.817284, 'auroc': 0.9937642}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   376     0    0     6    1    0    17    10     7    0     66
1     0  1203    0    14    0    0     0    96     4    0     15
2     5     0  185     3   38    0     2    14    15   42      8
3     3     0    0  7866    0   31     0   356   177    3      3
4     5     1   40     2  270    1     3    10    43    6    158
5     3     0    1    57    0  353     1     0    10   95      1
6    30     0    1     6    2    1  1795    15    11    1     45
7     3    15    4   171    2    0     0  6969    67    2     29
8     4     1    5   152   17    2     7   131  2917    3     55
9     3     0   62    10    1   75     7     6    12  311      6
10   22     2    8     7   47    1    18    38    50    1  12600
---- Validation: 
scalar performance:
{'acc': 0.93157685, 'precision': 0.84072375, 'recall': 0.7967226, 'specificity': 0.9924358, 'f1': 0.81636393, 'auroc': 0.9939136}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     0    0    10    1    0    22    10     3    0     59
1     0  1202    0    14    0    0     0   100     3    0     13
2     7     0  188     1   38    1     1    20    13   35      8
3     1     0    1  7862    0   32     0   364   179    1      0
4     4     0   33     2  274    1     5     7    39    7    167
5     3     0    3    59    1  351     1     0     7   95      1
6    34     0    1     7    1    1  1790    15    12    2     45
7     1    17    2   169    1    0     1  6958    77    0     39
8     1     0    5   146   26    6     8   131  2899    1     73
9     8     0   69    18    2   73     8     5    11  296      3
10   21     1    4     8   37    1    16    32    46    1  12629
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5131183, 'precision': 0.60704315, 'recall': 0.43271846, 'specificity': 0.9493406, 'f1': 0.41422755, 'auroc': 0.8377379}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   58     0   0   14    0    2  1000    0    31   17    48
1    0  1285   0   51    0    0    18   39    41    0    65
2    0     7  38   29   68   16    90    2   347   42   376
3    0     0   0    0    0    0     0    0     0    0     0
4    0     0   0    0  150    0     4    0    12    0  1467
5    0     0   0  147    0  328    52    0    23   40     2
6    1     0   0    1    3    1  1827    0    30    2  1202
7    0    96   2  133    0    0   203  553   128    5    44
8    0     0   1   61    4    9    42    0  1182    4    67
9    0    19  65  139    4  104   137    3   329  272    65
10   0     1   0    0    4    0     0    0     0    0  1641
better model found
persisted
after epoch: 8,now: 2024-08-11 21:52:32.638390,epoch time: 0:30:10.408206,used: 4:02:54.257179,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9328179, 'precision': 0.8290417, 'recall': 0.8184782, 'specificity': 0.99270844, 'f1': 0.82228416, 'auroc': 0.9940674}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     3    0     3    2    0    13     7     5    3     53
1     0  1254    0    12    0    0     0    55     4    0      6
2     5     1  209     2   26    1     2    10     6   46      4
3     2    10    0  7954    0   26     1   309   135    1      1
4     3     0   51     2  321    1     1     9    22    7    122
5     5     0    3    64    0  319     1     0     5  123      1
6    40     2    2     5    4    0  1779    12    14    3     47
7     1    66    8   175    2    0     2  6904    73    2     30
8     3     3    7   218   36    3     5   112  2856    2     50
9     1     1   67    15    2   51     3     2     7  343      1
10   26     6    9     5  122    3    12    30    46    1  12532
---- Validation: 
scalar performance:
{'acc': 0.93414474, 'precision': 0.8280837, 'recall': 0.8142471, 'specificity': 0.9928585, 'f1': 0.81970763, 'auroc': 0.9941118}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     1    2     5    3    0    11    11     3    4     51
1     0  1253    0    12    0    0     0    57     1    0      9
2     4     2  197     1   37    1     1    11    11   44      3
3     0     9    0  7988    0   26     3   286   121    2      5
4     4     0   36     2  337    1     3     8    26    8    114
5     0     0    1    69    0  304     1     1     9  135      1
6    48     0    1     6    1    0  1777    15    11    4     45
7     3    61    5   176    4    0     2  6918    69    2     25
8     3     6   10   197   35    4     2   109  2875    2     53
9     4     0   65    16    2   57     1     2     7  336      3
10   32    11    8    10  109    0     9    24    46    1  12546
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5433429, 'precision': 0.6111754, 'recall': 0.4659304, 'specificity': 0.9527596, 'f1': 0.46499974, 'auroc': 0.85465115}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   163     1    2   18    0    0   838    0    18   43    87
1     0  1378    0   46    0    0     8   19    10    1    37
2     1    19  108   26  156   15    57    3   264   74   292
3     0     0    0    0    0    0     0    0     0    0     0
4     0     3    4    0  376    0     4    0    11    0  1235
5     0     0    0  131    0  321    29    0    14   93     4
6     3     4    2    2   24    1  1729    0    44    4  1254
7     0   270    8  128    0    0   146  495    85    5    27
8     0     0    3   70   14   12    26    0  1156   14    75
9     0    54  148  124    0   82    90    3   168  425    43
10    0     1    1    0   29    0     0    0     0    0  1615
better model found
persisted
after epoch: 9,now: 2024-08-11 22:23:04.336720,epoch time: 0:30:31.698330,used: 4:33:25.955509,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9386505, 'precision': 0.8452537, 'recall': 0.81145215, 'specificity': 0.9933068, 'f1': 0.8229356, 'auroc': 0.9952113}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     1    0     7    0    0    12     5     6    3     40
1     0  1242    0    17    0    0     0    63     4    0      6
2     3     0  201     0   30    0     2    10     7   54      5
3     0     0    0  7998    0   22     0   286   133    0      0
4     7     0   37     0  253    2     4     9    43   11    173
5     4     0    1    65    0  308     0     0     5  136      1
6    64     0    0    11    0    2  1773     6    16    2     33
7     1    10    5   167    1    0     2  6976    87    2     12
8     5     0    2   142   12    2     4   100  2986    3     40
9    10     0   50    11    1   50     2     4     9  351      4
10   55     7    6     9   32    3     8    35    52    0  12587
---- Validation: 
scalar performance:
{'acc': 0.9384245, 'precision': 0.8504797, 'recall': 0.8138715, 'specificity': 0.99326193, 'f1': 0.8261619, 'auroc': 0.9951276}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0     5    0    0    16     5     8    1     34
1     0  1239    0    13    0    0     0    71     5    0      4
2     3     0  199     3   21    1     3     9     9   56      8
3     2     0    0  7994    0   26     0   269   145    4      0
4     6     0   36     0  256    1     4     7    42    7    180
5     5     0    3    63    0  309     0     1     6  133      1
6    61     0    1     5    0    1  1773    10     8    3     46
7     0    14    2   168    2    0     1  6968    84    6     20
8     5     0    4   154   10    2     8    97  2970    5     41
9    10     0   40    16    1   46     4     7     5  364      0
10   55     2    0     8   34    2    12    30    54    2  12597
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5334779, 'precision': 0.61693066, 'recall': 0.46202096, 'specificity': 0.9519814, 'f1': 0.4602448, 'auroc': 0.84663}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   330     0   1   18    0    0   640    0    36   20   125
1     0  1302   0   51    0    0    18   32    44    1    51
2     2     4  68   20   69   15    26    1   317   63   430
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   1    0  111    0     4    0    10    0  1506
5     0     0   0  112    0  318    26    0    23  108     5
6     2     0   0    1    5    1  1697    0    54    2  1305
7     0    63   5  205    0    0   146  537   178    7    23
8     0     0   1   48    3    8    14    0  1187    8   101
9     2    15  92   99    2   77    66    5   261  433    85
10    0     1   0    0    3    0     0    0     0    0  1642
better model found
persisted
after epoch: 10,now: 2024-08-11 22:53:20.971640,epoch time: 0:30:16.634920,used: 5:03:42.590429,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:03:42.590429 at 2024-08-11 22:53:20.971640
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5334779, 'precision': 0.61693066, 'recall': 0.46202096, 'specificity': 0.9519814, 'f1': 0.4602448, 'auroc': 0.84663}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   330     0   1   18    0    0   640    0    36   20   125
1     0  1302   0   51    0    0    18   32    44    1    51
2     2     4  68   20   69   15    26    1   317   63   430
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   1    0  111    0     4    0    10    0  1506
5     0     0   0  112    0  318    26    0    23  108     5
6     2     0   0    1    5    1  1697    0    54    2  1305
7     0    63   5  205    0    0   146  537   178    7    23
8     0     0   1   48    3    8    14    0  1187    8   101
9     2    15  92   99    2   77    66    5   261  433    85
10    0     1   0    0    3    0     0    0     0    0  1642
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5494298, 'precision': 0.5822863, 'recall': 0.44207188, 'specificity': 0.9523166, 'f1': 0.40760043, 'auroc': 0.8349761}
confusion matrix:
    0     1   2    3   4    5     6    7    8    9     10
0   12     0   0    3   0    7  1051    0   27   69     1
1    0  1221   0   27   0    0    49   67   60    2    73
2    0     7   1   14   1   17   371    3  283  138   180
3    0     0   0    0   0    0     0    0    0    0     0
4    0     1   0    0   0    0    61    0   17    2  1552
5    0     0   0  124   0  291    27    0   29  120     1
6    0     1   0    0   0    0  2561    0   35    3   467
7    0   121   0   14   0    0   243  611  137   17    21
8    1     0   0   47   0   11   183    0  962   95    71
9    1    15   0   60   0   81   182    1  227  553    17
10   0     1   0    0   0    0     4    0    0    0  1641
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_17_49_38_seed_1_24142410_instance_wise_predictions.txt
accuracy from prediction file 0.5334779262576086
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496602 KiB |  10950 MiB | 689803 GiB | 689802 GiB |
|       from large pool | 405888 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 496602 KiB |  10950 MiB | 689803 GiB | 689802 GiB |
|       from large pool | 405888 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10882 MiB | 685930 GiB | 685930 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 684602 GiB | 684602 GiB |
|       from small pool |  90258 KiB |    126 MiB |   1328 GiB |   1328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11544 MiB |  11544 MiB |  21778 MiB |  10234 MiB |
|       from large pool |  11416 MiB |  11416 MiB |  21620 MiB |  10204 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1285 MiB |   1530 MiB | 226543 GiB | 226542 GiB |
|       from large pool |   1275 MiB |   1527 MiB | 225131 GiB | 225130 GiB |
|       from small pool |      9 MiB |     32 MiB |   1412 GiB |   1412 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   54451 K  |   54448 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    2922    |    4522    |   30341 K  |   30338 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   54451 K  |   54448 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    2922    |    4522    |   30341 K  |   30338 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     300    |     300    |     516    |     216    |
|       from large pool |     236    |     236    |     437    |     201    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      64    |    1129    |   29344 K  |   29344 K  |
|       from large pool |      31    |     135    |   14493 K  |   14493 K  |
|       from small pool |      33    |    1112    |   14850 K  |   14850 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10950 MiB | 689803 GiB | 689803 GiB |
|       from large pool |  16640 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |      0 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10950 MiB | 689803 GiB | 689803 GiB |
|       from large pool |  16640 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |      0 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 685930 GiB | 685930 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 684602 GiB | 684602 GiB |
|       from small pool |      0 KiB |    126 MiB |   1328 GiB |   1328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1770 MiB |  11544 MiB |  21778 MiB |  20008 MiB |
|       from large pool |   1672 MiB |  11416 MiB |  21620 MiB |  19948 MiB |
|       from small pool |     98 MiB |    128 MiB |    158 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1530 MiB | 226544 GiB | 226544 GiB |
|       from large pool |  59136 KiB |   1527 MiB | 225131 GiB | 225131 GiB |
|       from small pool |      0 KiB |     33 MiB |   1412 GiB |   1412 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   54451 K  |   54451 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    4522    |   30341 K  |   30341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   54451 K  |   54451 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    4522    |   30341 K  |   30341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     300    |     516    |     432    |
|       from large pool |      35    |     236    |     437    |     402    |
|       from small pool |      49    |      64    |      79    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1129    |   29345 K  |   29345 K  |
|       from large pool |       3    |     135    |   14493 K  |   14493 K  |
|       from small pool |       0    |    1112    |   14851 K  |   14851 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 22:59:38 2024]
Finished job 0.
1 of 1 steps (100%) done
