Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 14:49:08 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/20.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=20
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412

 Experiment start at: 2024-08-11 15:00:59.719862
before training, model accuracy: 0.08472679555416107
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.25821382, 'precision': 0.19841278, 'recall': 0.21090001, 'specificity': 0.9266723, 'f1': 0.15478967, 'auroc': 0.7538869}
confusion matrix:
      0    1   2   3   4   5     6     7     8   9   10
0     57    0   0   0   0   0     1    32   393   0   0
1     17  652   0   0   0   0     5   615    43   0   0
2     16    0   0   0   0   0     5    40   251   0   0
3     65    0   0   0   0   0  2985  1229  4158   1   0
4     89    0   0   0   0   0     2    14   433   0   0
5      1    0   0   0   0   0    42     0   478   0   0
6    206    0   0   0   0   0    11    73  1618   0   0
7    133   19   0   0   0   0   207  6064   841   0   0
8    111    0   0   0   0   0    65   252  2866   1   0
9      6    0   0   0   0   0    14    20   452   1   0
10  4810    2   0   0   0   0     4    93  7883   0   0
---- Validation: 
scalar performance:
{'acc': 0.25689447, 'precision': 0.24260142, 'recall': 0.20801227, 'specificity': 0.9265381, 'f1': 0.15393966, 'auroc': 0.75379133}
confusion matrix:
      0    1   2   3   4   5     6     7     8   9   10
0     43    0   0   0   0   0     1    41   398   0   0
1     11  653   0   0   0   0     4   622    42   0   0
2     20    0   0   0   0   0     4    42   245   1   0
3     45    1   0   1   0   0  3092  1175  4126   0   0
4     85    0   0   0   0   0     0    18   436   0   0
5      1    0   0   0   0   0    37     2   481   0   0
6    195    0   0   0   0   0     9    69  1634   1   0
7    144   27   0   1   0   0   188  6017   888   0   0
8    100    0   0   0   0   0    66   250  2880   0   0
9      2    1   0   0   0   0    16    20   453   1   0
10  4751    0   0   0   0   0     5   105  7935   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.17756943, 'precision': 0.19164349, 'recall': 0.19645517, 'specificity': 0.91743934, 'f1': 0.11876835, 'auroc': 0.6056471}
confusion matrix:
     0    1   2   3   4   5   6    7     8   9   10
0    46    0   0   0   0   0   1   11  1111   1   0
1   122  211   0   0   0   0   1  782   383   0   0
2    50    0   0   0   0   0  12    2   945   6   0
3     0    0   0   0   0   0   0    0     0   0   0
4   198    0   0   0   0   0   0    0  1435   0   0
5     2    0   0   0   0   0  22    1   471  96   0
6   507    0   0   0   0   0  10    1  2544   5   0
7    36   12   0   0   0   0  20  924   172   0   0
8    29    0   0   0   0   0  12    0  1319  10   0
9    30    2   0   0   0   0  28    8  1041  28   0
10  252    0   0   0   0   0   0    0  1394   0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 15:33:56.209610,epoch time: 0:32:56.489748,used: 0:32:56.489748,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.29213935, 'precision': 0.25148943, 'recall': 0.26178694, 'specificity': 0.9308614, 'f1': 0.20004982, 'auroc': 0.8246044}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     45     1   0   2   0   0    63    34   336   2   0
1      6  1142   0   0   0   0     8   153    23   0   0
2      5     1   0   0   0   0    46    49   209   2   0
3     16    12   0   3   0   0  5728   998  1678   2   0
4     48     0   0   0   0   0    11    21   458   1   0
5      0     1   0   0   0   0   185     1   318  16   0
6    103     4   0   1   0   0   114    69  1617   0   0
7     39    81   0   1   0   0   158  6599   385   0   0
8     19     6   0   1   0   0   106   172  2990   0   0
9      1     0   0   2   0   0   146    20   298  26   0
10  6168    14   0   0   0   0    10    82  6520   0   0
---- Validation: 
scalar performance:
{'acc': 0.29230976, 'precision': 0.27938622, 'recall': 0.25942189, 'specificity': 0.9308712, 'f1': 0.19782488, 'auroc': 0.8265227}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     45     1   0   0   0   0    66    34   337   0   0
1      9  1138   0   0   0   0     9   154    22   0   0
2      8     0   0   0   0   0    40    53   210   1   0
3     13    10   0   5   0   0  5760   970  1680   2   0
4     40     1   0   0   0   0    10     9   479   0   0
5      0     0   0   0   0   0   177     1   328  15   0
6    123     2   0   1   0   0   101    72  1609   0   0
7     48    71   0   1   0   0   169  6654   322   0   0
8     24     3   0   0   0   0   113   189  2967   0   0
9      1     0   0   1   0   0   146    14   313  18   0
10  6045    14   0   0   0   0    10    72  6655   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26299587, 'precision': 0.23127928, 'recall': 0.23463333, 'specificity': 0.9244271, 'f1': 0.20727721, 'auroc': 0.6727123}
confusion matrix:
     0    1   2   3   4   5    6    7     8    9   10
0    13    0   0   1   0   0  179    6   953   18   0
1   100  968   0   2   0   0   61  156   210    2   0
2     9    0   0   3   0   0  295    0   634   74   0
3     0    0   0   0   0   0    0    0     0    0   0
4   390    0   0   0   0   0   38    0  1201    4   0
5     0    0   0   6   0   0  201    0    96  289   0
6   129    0   0   2   0   0  612    1  2290   33   0
7    11   43   0  12   0   0  159  832   106    1   0
8     0    0   0   1   0   0  214    0  1093   62   0
9    12    4   0   4   0   0  477    2   397  241   0
10  917    0   0   1   0   0    7    0   721    0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 16:05:03.702880,epoch time: 0:31:07.493270,used: 1:04:03.983018,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.33505458, 'precision': 0.2750828, 'recall': 0.36774564, 'specificity': 0.93556917, 'f1': 0.2602647, 'auroc': 0.87457323}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0    164     0   0   25   0   0   168    25    92    9   0
1     11  1143   0    4   0   0     6   145    21    0   0
2     15     1   0   20   1   0   110    39    86   40   0
3      9     3   0  184   0   0  6454   617  1133   39   0
4     79     0   0    2   0   0    92    12   346    8   0
5      1     0   0   68   0   0   197     0    72  183   0
6    127     2   0    9   0   0  1293    44   423    9   0
7     49    42   0   45   0   0   202  6619   307    0   0
8     20     2   0   14   0   0   148   140  2953   17   0
9      9     1   0   51   0   0   165    18    82  167   0
10  7029     4   0    3   0   0   127    67  5558    6   0
---- Validation: 
scalar performance:
{'acc': 0.33596364, 'precision': 0.27692252, 'recall': 0.3681263, 'specificity': 0.93566716, 'f1': 0.260528, 'auroc': 0.8740694}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0    157     0   0   26   0   0   175    27    90    8   0
1      8  1164   0    1   0   0     8   131    20    0   0
2     13     1   0   18   0   0   119    43    85   33   0
3      7     1   0  162   0   0  6494   612  1128   36   0
4     76     0   0    2   0   0    81    14   360    6   0
5      1     0   0   59   0   0   199     1    78  183   0
6    138     1   0    1   0   0  1317    52   386   13   0
7     43    39   0   30   0   0   198  6634   320    1   0
8     12     2   0   16   0   0   152   132  2964   18   0
9      4     1   0   49   0   0   180    10    87  162   0
10  6940     7   0    0   0   0   122    59  5668    0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.37046108, 'precision': 0.26974052, 'recall': 0.25556374, 'specificity': 0.93262815, 'f1': 0.23751694, 'auroc': 0.7205377}
confusion matrix:
      0     1   2   3   4   5     6    7    8    9   10
0     98     0   0   5   0   0   961    0   96   10   0
1    173  1016   0  25   0   0   158   48   73    6   0
2     20     0   0  11   0   0   787    0  131   66   0
3      0     0   0   0   0   0     0    0    0    0   0
4    729     0   0   1   0   0   327    0  575    1   0
5      3     0   0  10   0   0   206    0    5  368   0
6    121     1   0   5   0   0  2734    0  197    9   0
7     76    51   0  78   0   0   466  410   77    6   0
8      0     0   0   4   0   0   581    0  709   76   0
9     35     3   0  20   0   0   700    0   51  328   0
10  1257     0   0   0   0   0    54    0  335    0   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 16:37:05.409248,epoch time: 0:32:01.706368,used: 1:36:05.689386,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.42602205, 'precision': 0.32412678, 'recall': 0.45880312, 'specificity': 0.944196, 'f1': 0.33313274, 'auroc': 0.91165155}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    314     1   0    45   0   0    50    20    36   16   0
1     11  1154   0    12   0   0     3   139    12    0   0
2     18     1   0    55   0   0    57    29    74   77   1
3     11     3   0  3194   0   0  4188   484   512   46   0
4     87     0   0     8   0   0    56    17   350   20   1
5      0     1   0   175   0   0    39     1    25  280   0
6    145     3   0    42   0   0  1462    51   186   19   0
7     49    30   0   315   0   0    77  6606   186    1   0
8     25     2   0   157   0   0    63   126  2900   23   0
9      8     0   0   111   1   0    32    11    37  293   0
10  7608    10   0    16   0   0    63    96  4989   10   0
---- Validation: 
scalar performance:
{'acc': 0.42591947, 'precision': 0.3254081, 'recall': 0.45769787, 'specificity': 0.94418776, 'f1': 0.3338532, 'auroc': 0.9116182}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    309     0   0    47   0   0    46    19    45   17   0
1     11  1151   0    17   0   0     3   133    17    0   0
2     22     1   0    51   0   0    42    33    72   90   1
3     12     4   0  3179   0   0  4206   491   502   46   0
4    101     0   0    12   0   0    57    14   337   17   1
5      1     0   0   185   0   0    39     0    21  275   0
6    166     0   0    46   0   0  1455    44   184   13   0
7     53    21   0   314   0   0    68  6612   197    0   0
8     27     0   0   168   0   0    44   118  2924   15   0
9      9     1   0   117   0   0    22    11    40  293   0
10  7632    11   0    14   0   0    76    79  4977    7   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38571328, 'precision': 0.28311563, 'recall': 0.2830959, 'specificity': 0.93612814, 'f1': 0.24145395, 'auroc': 0.73740613}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9   10
0   266     0   0   12   0   0   658    0   225    9   0
1    99  1085   0   33   0   0   144   30   107    1   0
2    42     0   0   29   0   0   390    0   447  106   1
3     0     0   0    0   0   0     0    0     0    0   0
4   520     0   0    0   0   0    97    0  1015    1   0
5     9     0   0   35   0   0   145    0    34  369   0
6   238     0   0   15   0   0  2378    0   422   14   0
7    55    47   0  125   0   0   459  223   251    4   0
8     0     0   0    4   0   0   128    0  1183   55   0
9    56     2   0   61   0   0   392    0   248  378   0
10  697     0   0    3   0   0     8    0   938    0   0
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 17:08:29.936460,epoch time: 0:31:24.527212,used: 2:07:30.216598,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.5488549, 'precision': 0.5520065, 'recall': 0.53103656, 'specificity': 0.9559985, 'f1': 0.4162215, 'auroc': 0.93139374}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    363     0   0    21   0   0    29    29    31   10   0
1      8  1207   0    11   0   0     2    92    12    0   0
2     26    12   0    28   1   0    42    51    76   74   2
3      7     4   0  7222   0   1   212   577   371   44   0
4     77     1   0     9   2   1    44    25   356   20   4
5      6     0   0   177   0   5     2     0    15  316   0
6     89     4   0    43   0   0  1576    31   140   23   0
7     28    41   0   197   0   0     4  6882   110    1   0
8      8     2   0   174   0   0     8   163  2928   13   0
9     20     5   0    70   0   1    17    16    42  321   1
10  7387     8   0    19   0   0    65    86  5214    6   8
---- Validation: 
scalar performance:
{'acc': 0.5481878, 'precision': 0.5177125, 'recall': 0.5257027, 'specificity': 0.9559642, 'f1': 0.41401985, 'auroc': 0.93016815}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    331     0   0    30   0   0    42    22    45   12   1
1     10  1213   0    16   0   0     0    83    10    0   0
2     15    10   0    32   2   0    47    48    68   89   1
3      5     3   0  7228   0   0   194   561   402   47   0
4     73     0   0     6   3   0    43    26   358   24   6
5      6     1   0   158   0   1     4     0    21  330   0
6     90     1   0    35   0   0  1581    36   147   18   0
7     31    47   0   203   0   0     4  6877   103    0   0
8     12     1   0   172   0   0    10   159  2926   16   0
9     15     6   0    73   0   2    17    16    39  325   0
10  7422     9   0    13   0   0    64    78  5187   14   9
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40915135, 'precision': 0.41077763, 'recall': 0.31657442, 'specificity': 0.93947554, 'f1': 0.256431, 'auroc': 0.75656}
confusion matrix:
     0     1   2   3   4   5     6    7     8    9   10
0   580     0   0   4   0   0   400    0   182    4   0
1    77  1245   0  12   0   0    72   18    74    1   0
2   150     0   0  11   0   0   208    0   539  107   0
3     0     0   0   0   0   0     0    0     0    0   0
4   406     2   0   0   1   0    53    0  1163    2   6
5    69     0   0  33   0   0    38    0    57  395   0
6   328     1   0   9   0   0  2143    0   569   17   0
7    29   285   0  52   0   0   420  170   207    1   0
8    10     0   0   0   0   0    32    0  1281   47   0
9   180    10   0  21   0   0   153    0   347  425   1
10  606     0   0   1   0   0     0    0  1036    0   3
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 17:39:34.535806,epoch time: 0:31:04.599346,used: 2:38:34.815944,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.54534996, 'precision': 0.53848493, 'recall': 0.5395701, 'specificity': 0.95562214, 'f1': 0.42092368, 'auroc': 0.9464397}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    393     1   0    11   0   0    30    16    24    7   1
1      9  1163   0     7   0   0     0   135    17    0   0
2     35    23   0    15   7   1    43    25    83   74   6
3     10     2   0  6984   0   1   136   586   669   50   0
4     85     0   0     5   5   1    34    22   343   17  27
5     14     1   0   116   1  17     2     3    25  342   0
6    111     0   0    17   0   0  1645    17   108    9   1
7     47    71   0   168   0   0     5  6782   183    1   6
8     23     1   0   104   0   0    11   109  3032   13   2
9     39     6   0    45   2   0    34     8    34  325   0
10  6568     5   0    10   0   0    42    45  6081    5  37
---- Validation: 
scalar performance:
{'acc': 0.5455397, 'precision': 0.5580963, 'recall': 0.5357624, 'specificity': 0.95562345, 'f1': 0.41954735, 'auroc': 0.9449432}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    380     1   0    12   0   0    36    13    34    6   1
1     12  1157   0     8   0   0     1   135    18    0   1
2     38    21   0    21   4   0    46    26    80   72   4
3     12     7   0  7019   0   1   107   571   666   57   0
4     86     0   0     4   5   0    37    15   356   11  25
5      9     1   0   116   0  15     1     1    18  360   0
6    118     0   0    17   0   0  1642    24    94   11   2
7     45    57   0   181   0   0     5  6783   191    0   3
8     27     2   0    83   0   0     5   121  3040   16   2
9     42     4   0    48   0   2    23     6    47  320   1
10  6449     6   0     9   0   0    40    47  6206    5  34
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33149093, 'precision': 0.27798092, 'recall': 0.26736483, 'specificity': 0.93160164, 'f1': 0.20057563, 'auroc': 0.72537595}
confusion matrix:
     0     1   2   3   4   5     6   7     8    9   10
0   569     0   0   0   0   0   492   0   108    1   0
1    71  1271   0   1   0   0    51   6    99    0   0
2   192     3   0   2   1   0   142   0   630   42   3
3     0     0   0   0   0   0     0   0     0    0   0
4   344     2   0   0   0   0    15   0  1234    0  38
5    95     0   0  20   0   0    56   0   112  309   0
6   873     1   0   2   0   0  1343   0   831    3  14
7    27   414   0   5   0   0   407  57   254    0   0
8    16     0   0   0   0   0    28   0  1299   27   0
9   224    12   0  15   0   0   190   0   509  187   0
10  463     0   0   0   0   0     0   0  1171    0  12
early stop counter: 1
val acc:0.5455396771430969, best validation acc: 0.548187792301178, corresponding to test acc:                         0.4091513454914093 / 0.4091513454914093
after epoch: 6,now: 2024-08-11 18:11:00.807237,epoch time: 0:31:26.271431,used: 3:10:01.087375,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7239405, 'precision': 0.65841883, 'recall': 0.6023871, 'specificity': 0.97279423, 'f1': 0.5457318, 'auroc': 0.9557521}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9     10
0    402     0   0    16   0    0    15    29     8    4     9
1      7  1130   0    10   0    0     0   167    16    0     1
2     39    17   0    41   6    2    20    53    30  101     3
3      6     1   0  7654   0    7     7   557   181   25     1
4     68     1   0    14  18    4    38    58   207   21   110
5     11     0   0   154   0  114     0     3     5  234     0
6    103     2   0    43   0    0  1665    33    42    6    13
7     18    18   0   200   0    0     2  6958    64    0     4
8     17     2   0   246   0    0     5   197  2797   10    20
9     38     5   0    80   0   19     7    13    17  313     0
10  5516     2   0    17   1    0    29    91  1124    7  6007
---- Validation: 
scalar performance:
{'acc': 0.7208239, 'precision': 0.65245086, 'recall': 0.59859264, 'specificity': 0.9724541, 'f1': 0.54102254, 'auroc': 0.95456004}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9     10
0    405     0   0    13   0    0    10    29    12    3    11
1      8  1124   0    14   0    0     0   176     9    0     1
2     39    16   0    50   5    3    24    45    39   86     5
3      5     0   0  7637   0    8     9   599   161   21     0
4     71     1   0    13   9    4    30    53   199   32   127
5      9     0   0   150   0  113     0     0     7  242     0
6    104     1   0    42   0    0  1653    30    49   14    15
7     28    24   0   199   0    0     2  6956    55    0     1
8     12     2   0   259   0    0     3   204  2788    9    19
9     48     6   0    78   0   13     3    20    15  310     0
10  5585     3   0    26   0    0    28    93  1100    8  5953
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43328902, 'precision': 0.41992998, 'recall': 0.3549171, 'specificity': 0.9421376, 'f1': 0.28625387, 'auroc': 0.7518026}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   793     1   0    2   0   0   270    0   104    0     0
1    52  1303   0   13   0   0    42   18    56    0    15
2   211     4   0   13   6   0   111    0   613   30    27
3     0     0   0    0   0   0     0    0     0    0     0
4   144     2   0    0   0   0    11    0   579    0   897
5   138     0   0  109   0   5    22    0    57  261     0
6   700     3   0    9   0   0  1303    0   870    4   178
7    11   406   0   37   0   0   418  104   187    0     1
8    28     0   0    7   0   0    14    0  1298   23     0
9   338    19   0   57   2   0   133    0   422  163     3
10  240     1   0    1   0   0     0    0   180    0  1224
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-11 18:41:56.979334,epoch time: 0:30:56.172097,used: 3:40:57.259472,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.883963, 'precision': 0.6817455, 'recall': 0.66544414, 'specificity': 0.9877586, 'f1': 0.64099205, 'auroc': 0.96244514}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   409     0   0    12   0    0     4    18    11    1     28
1     1  1167   0     7   0    0     1   140    11    0      5
2    31    22   0    39  10    2    38    41    52   70      7
3     5     2   0  7590   0   26    39   394   361   19      0
4    31     1   0     3  19    7    27    53   220   14    164
5    10     0   0   115   3  244     1     1    13  133      1
6    94     0   0    20   0    0  1655    26    69    7     37
7    18    42   0   240   0    0     3  6814   132    1     13
8     5     1   0   129   0    2    10   113  2992    6     37
9    43     5   0    55   1   65    21     7    21  272      3
10  421     3   0    13   1    1    16    77   381    4  11877
---- Validation: 
scalar performance:
{'acc': 0.8847131, 'precision': 0.682104, 'recall': 0.6687195, 'specificity': 0.9878597, 'f1': 0.6450264, 'auroc': 0.9636573}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   404     0   0    14   0    0    14    12    11    2     26
1     4  1142   0    12   0    0     1   158    12    0      3
2    30    20   0    38   9    2    39    39    64   68      3
3     9     1   0  7637   0   21    27   367   354   22      2
4    30     2   0     8  26   10    23    58   207   22    153
5     9     0   0    97   5  260     1     1    14  133      1
6    85     2   0    11   0    1  1679    26    58    5     41
7    18    39   0   243   0    0     3  6814   127    1     20
8    17     0   0   135   0    4     9   112  2978    5     36
9    43     4   0    55   8   59    21     8    17  277      1
10  441     3   0    13   0    2    15    66   396    2  11858
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46407333, 'precision': 0.42832068, 'recall': 0.38012645, 'specificity': 0.9444556, 'f1': 0.31495208, 'auroc': 0.7265384}
confusion matrix:
     0     1   2   3   4   5     6   7     8    9     10
0   743     0   0   1   0   0   340   0    86    0     0
1    35  1280   0   8   0   0    63   7    84    0    22
2   156     5   0  11  12   1   133   2   617   34    44
3     0     0   0   0   0   0     0   0     0    0     0
4    29     1   0   0   3   1    16   3   351    0  1229
5    79     0   0  78   3  61    67   0    52  252     0
6   476     1   0   3   3   0  1410   1   824    3   346
7    14   230   0  22   0   0   654  55   188    0     1
8    19     0   0   4   1   0    29   0  1288   27     2
9   233    11   0  27  22   4   242   0   406  188     4
10    4     1   0   1   0   0     0   0    35    0  1605
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-11 19:13:03.488624,epoch time: 0:31:06.509290,used: 4:12:03.768762,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.899802, 'precision': 0.7134116, 'recall': 0.6735281, 'specificity': 0.9890275, 'f1': 0.6650447, 'auroc': 0.96505445}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   402     0   0    12   0    0     4    14     3    1     47
1     3  1154   0    12   0    0     0   153     6    0      3
2    34    22   0    48   5    2    26    68    33   61     13
3     7     1   0  7610   0   33     9   507   260    9      2
4    23     2   0     9  17   15    14    85   127   16    231
5     5     2   0    93   4  298     2     1     9  106      1
6    69     1   0    40   0    0  1652    26    34    9     77
7     7    20   0   151   0    0     2  6993    71    1     18
8     7     3   0   157   0    2     8   158  2895    4     60
9    32     8   0    67   2   66    22    20    12  262      2
10  190     1   0    10   0    2     9    92   140    2  12348
---- Validation: 
scalar performance:
{'acc': 0.89720476, 'precision': 0.70934165, 'recall': 0.6682768, 'specificity': 0.98873806, 'f1': 0.6602969, 'auroc': 0.96447}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   386     0   0     8   0    0    10    16     5    0     58
1     2  1136   0    12   0    0     2   169     7    0      4
2    27    21   0    50   8    6    32    61    23   69     15
3     9     0   0  7590   0   33     5   525   265   11      2
4    22     4   0    13  18    4    14    98   128   19    219
5    12     0   0    77   2  301     0     0    11  117      1
6    63     0   0    35   0    2  1669    25    34    4     76
7    11    10   0   151   0    0     3  6990    80    1     19
8     7     2   0   154   0    2     5   174  2863    1     88
9    50     9   0    53   1   85     7    12    17  256      3
10  186     1   0    11   0    0    11   104   146    4  12333
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44126496, 'precision': 0.42749834, 'recall': 0.39200562, 'specificity': 0.9430276, 'f1': 0.33020177, 'auroc': 0.7434894}
confusion matrix:
     0     1   2    3   4   5    6    7     8    9     10
0   904     0   0    7   0   0  206    0    50    0     3
1    34  1292   0   28   0   0   29   39    40    0    37
2   199     8   0   20   3   0   67    7   517   28   166
3     0     0   0    0   0   0    0    0     0    0     0
4    13     2   0    0   0   0    2    0    88    0  1528
5   107     0   0  118   0  91   18    0    39  219     0
6   508     4   0   11   0   0  670    0   539    1  1334
7    27   210   0  258   0   0  320  257    90    0     2
8    33     0   0   12   0   0   17    0  1263   30    15
9   332    23   0   81   4   3  127    1   367  187    12
10    2     0   0    0   0   0    0    0     1    0  1643
better model found
persisted
after epoch: 9,now: 2024-08-11 19:44:13.913118,epoch time: 0:31:10.424494,used: 4:43:14.193256,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90758777, 'precision': 0.7381988, 'recall': 0.680276, 'specificity': 0.9899345, 'f1': 0.6791661, 'auroc': 0.97149837}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   376     0   0    20   0    1     9    14     9    4     50
1     1  1201   0    19   0    0     0    95     9    0      7
2     8    17   0    77   6    8    36    26    44   83      7
3     0     0   0  8016   0   19     3   240   153    4      0
4    11     1   0    20  26   23    13    46   219   21    159
5     2     0   0   114   0  331     0     1     8   65      0
6    34     1   0    73   1    2  1663    19    62    8     45
7     3    10   0   290   0    0     3  6858    88    0     10
8     3     1   0   242   0    3     1    92  2921    3     30
9    11     4   0    76   0  118    11     3    19  250      1
10  119     3   0    29   1    0     7    55   295    6  12280
---- Validation: 
scalar performance:
{'acc': 0.90699476, 'precision': 0.7402208, 'recall': 0.68099743, 'specificity': 0.98989385, 'f1': 0.6792222, 'auroc': 0.9716459}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   380     0   0    21   0    2     8    14     6    5     47
1     0  1208   0    18   0    0     0    92     7    0      7
2    13    12   0    82   5    5    37    33    45   76      4
3     2     0   0  8006   0   20     2   254   155    0      1
4     6     1   0    21  29   24    13    50   229   28    138
5     3     0   0   111   0  322     1     0    10   74      0
6    39     1   0    64   0    3  1668    20    60    7     46
7     5    10   0   275   0    0     1  6860   102    1     11
8     0     1   0   228   0    4     1   110  2916    3     33
9     9     4   0    77   0  113     9     4    20  254      3
10  126     1   0    34   2    3     7    62   289    7  12265
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43475828, 'precision': 0.4782171, 'recall': 0.38748956, 'specificity': 0.9432219, 'f1': 0.3467558, 'auroc': 0.74098176}
confusion matrix:
     0     1   2    3   4    5    6    7     8    9     10
0   707     1   0   29   0    0  175    0   252    2     4
1    22  1240   0   53   0    0   20   42    85    0    37
2    79     4   0   35   4    6   25    0   731   65    66
3     0     0   0    0   0    0    0    0     0    0     0
4     7     2   0    0   2    0    2    1   240    0  1379
5    27     0   0  199   0  130    2    0    42  192     0
6   246     0   0   33   1    1  688    2  1277   13   806
7     5    62   0  527   0    0  131  225   211    0     3
8     3     0   0   34   0    1    0    0  1311   19     2
9   100    10   0  165   0   18   34    2   528  274     6
10    0     0   0    1   1    0    1    0     6    0  1637
better model found
persisted
after epoch: 10,now: 2024-08-11 20:15:24.654546,epoch time: 0:31:10.741428,used: 5:14:24.934684,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:14:24.934684 at 2024-08-11 20:15:24.654546
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43475828, 'precision': 0.4782171, 'recall': 0.38748956, 'specificity': 0.9432219, 'f1': 0.3467558, 'auroc': 0.74098176}
confusion matrix:
     0     1   2    3   4    5    6    7     8    9     10
0   707     1   0   29   0    0  175    0   252    2     4
1    22  1240   0   53   0    0   20   42    85    0    37
2    79     4   0   35   4    6   25    0   731   65    66
3     0     0   0    0   0    0    0    0     0    0     0
4     7     2   0    0   2    0    2    1   240    0  1379
5    27     0   0  199   0  130    2    0    42  192     0
6   246     0   0   33   1    1  688    2  1277   13   806
7     5    62   0  527   0    0  131  225   211    0     3
8     3     0   0   34   0    1    0    0  1311   19     2
9   100    10   0  165   0   18   34    2   528  274     6
10    0     0   0    1   1    0    1    0     6    0  1637
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46407333, 'precision': 0.42832068, 'recall': 0.38012645, 'specificity': 0.9444556, 'f1': 0.31495208, 'auroc': 0.7265384}
confusion matrix:
     0     1   2   3   4   5     6   7     8    9     10
0   743     0   0   1   0   0   340   0    86    0     0
1    35  1280   0   8   0   0    63   7    84    0    22
2   156     5   0  11  12   1   133   2   617   34    44
3     0     0   0   0   0   0     0   0     0    0     0
4    29     1   0   0   3   1    16   3   351    0  1229
5    79     0   0  78   3  61    67   0    52  252     0
6   476     1   0   3   3   0  1410   1   824    3   346
7    14   230   0  22   0   0   654  55   188    0     1
8    19     0   0   4   1   0    29   0  1288   27     2
9   233    11   0  27  22   4   242   0   406  188     4
10    4     1   0   1   0   0     0   0    35    0  1605
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_15_00_59_seed_0_24142412_instance_wise_predictions.txt
accuracy from prediction file 0.4347582732806269
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/20.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494945 KiB |  10947 MiB | 344774 GiB | 344773 GiB |
|       from large pool | 404224 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |  90721 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 494945 KiB |  10947 MiB | 344774 GiB | 344773 GiB |
|       from large pool | 404224 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |  90721 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478101 KiB |  10882 MiB | 343021 GiB | 343020 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 342304 GiB | 342304 GiB |
|       from small pool |  90261 KiB |    126 MiB |    716 GiB |    716 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11432 MiB |  11432 MiB |  11432 MiB |      0 B   |
|       from large pool |  11304 MiB |  11304 MiB |  11304 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1014 MiB |   1360 MiB | 137194 GiB | 137193 GiB |
|       from large pool |   1005 MiB |   1356 MiB | 136422 GiB | 136421 GiB |
|       from small pool |      9 MiB |     13 MiB |    772 GiB |    772 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3023    |    4666    |   27570 K  |   27567 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2936    |    4544    |   15515 K  |   15512 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3023    |    4666    |   27570 K  |   27567 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2936    |    4544    |   15515 K  |   15512 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     294    |     294    |     294    |       0    |
|       from large pool |     230    |     230    |     230    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    1141    |   13981 K  |   13981 K  |
|       from large pool |      18    |     121    |    6564 K  |    6564 K  |
|       from small pool |      33    |    1121    |    7416 K  |    7416 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10947 MiB | 344774 GiB | 344773 GiB |
|       from large pool |  16640 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |      0 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10947 MiB | 344774 GiB | 344773 GiB |
|       from large pool |  16640 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |      0 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 343021 GiB | 343021 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342304 GiB | 342304 GiB |
|       from small pool |      0 KiB |    126 MiB |    716 GiB |    716 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1498 MiB |  11432 MiB |  11432 MiB |   9934 MiB |
|       from large pool |   1400 MiB |  11304 MiB |  11304 MiB |   9904 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1360 MiB | 137195 GiB | 137195 GiB |
|       from large pool |  59136 KiB |   1356 MiB | 136423 GiB | 136422 GiB |
|       from small pool |      0 KiB |     34 MiB |    772 GiB |    772 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4666    |   27570 K  |   27570 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4544    |   15515 K  |   15515 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4666    |   27570 K  |   27570 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4544    |   15515 K  |   15515 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     294    |     294    |     214    |
|       from large pool |      31    |     230    |     230    |     199    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1141    |   13982 K  |   13982 K  |
|       from large pool |       3    |     121    |    6564 K  |    6564 K  |
|       from small pool |       0    |    1121    |    7417 K  |    7417 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10947 MiB | 344774 GiB | 344773 GiB |
|       from large pool |  16640 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |      0 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10947 MiB | 344774 GiB | 344773 GiB |
|       from large pool |  16640 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |      0 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 343021 GiB | 343021 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342304 GiB | 342304 GiB |
|       from small pool |      0 KiB |    126 MiB |    716 GiB |    716 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1498 MiB |  11432 MiB |  11432 MiB |   9934 MiB |
|       from large pool |   1400 MiB |  11304 MiB |  11304 MiB |   9904 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1360 MiB | 137195 GiB | 137195 GiB |
|       from large pool |  59136 KiB |   1356 MiB | 136423 GiB | 136422 GiB |
|       from small pool |      0 KiB |     34 MiB |    772 GiB |    772 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4666    |   27570 K  |   27570 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4544    |   15515 K  |   15515 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4666    |   27570 K  |   27570 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4544    |   15515 K  |   15515 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     294    |     294    |     214    |
|       from large pool |      31    |     230    |     230    |     199    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1141    |   13982 K  |   13982 K  |
|       from large pool |       3    |     121    |    6564 K  |    6564 K  |
|       from small pool |       0    |    1121    |    7417 K  |    7417 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412

 Experiment start at: 2024-08-11 20:30:30.878143
before training, model accuracy: 0.10193801671266556
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.72455585, 'precision': 0.32969067, 'recall': 0.31999284, 'specificity': 0.9673643, 'f1': 0.29226387, 'auroc': 0.8539273}
confusion matrix:
    0    1    2     3   4   5   6     7   8   9      10
0    0   10   36   196   0   0   0   112   2   4    123
1    0  991    0    20   0   0   0   277   0   0     44
2    0    7   17    97   0   0   0   129   0   1     61
3    0    4    6  7617   0   0   0   806   1   0      5
4    0   14   25   110   0   0   0    69   1   1    319
5    0    4    6   490   0   0   0    17   2   0      2
6    0   49  153   434   0   0   0   217   5   1   1047
7    0   67    1   913   0   0   0  6223   0   0     60
8    0   23  199  1911   0   0   1   711  17   2    432
9    0    6   11   351   0   0   0   110   1   1     13
10   0  123   74   192   0   0   0   185   1   1  12215
---- Validation: 
scalar performance:
{'acc': 0.72590613, 'precision': 0.3540857, 'recall': 0.32144415, 'specificity': 0.96750045, 'f1': 0.29403344, 'auroc': 0.8568769}
confusion matrix:
    0    1    2     3   4   5   6     7   8   9      10
0    0   10   39   220   0   0   0   100   1   2    111
1    0  992    0    21   0   0   0   280   0   0     39
2    0    8   19    97   0   0   1   122   0   2     63
3    0    1    5  7630   0   0   0   799   1   0      4
4    0    8   22    93   0   0   0    80   1   1    334
5    0    1    5   489   0   0   0    19   2   0      5
6    0   48  150   454   0   0   1   206   7   1   1041
7    0   57    3   890   0   0   0  6261   0   0     54
8    0   29  183  1934   0   0   2   682  17   1    448
9    0    5   12   364   0   0   0   100   4   2      6
10   0  129   75   189   0   0   0   182   4   1  12216
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24788357, 'precision': 0.2218076, 'recall': 0.22761665, 'specificity': 0.9255117, 'f1': 0.16540311, 'auroc': 0.66770893}
confusion matrix:
    0    1    2    3   4   5   6     7   8   9     10
0    0    8  207  333   0   0   0   187   1   4   430
1    0  748   10   48   0   0   0   235   0   0   458
2    0    4  142  382   0   0   0    86   1   0   400
3    0    0    0    0   0   0   0     0   0   0     0
4    0    0    7    6   0   0   0     2   0   0  1618
5    0    1   11  562   0   0   0    12   0   0     6
6    0    3  148  119   0   0   0    29   0   1  2767
7    0   17   16   21   0   0   1  1004   0   0   105
8    0    1  192  556   0   0   0   129   2   0   490
9    0    2   78  782   0   0   0   180   1   1    93
10   0    0    0    0   0   0   0     0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 21:02:47.544648,epoch time: 0:32:16.666505,used: 0:32:16.666505,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.78967786, 'precision': 0.39420542, 'recall': 0.37826502, 'specificity': 0.975829, 'f1': 0.35319865, 'auroc': 0.90193266}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0    34   4   114   0   1   1    37   211   0     80
1    0  1137   0    15   0   0   0   164     3   0     13
2    0    34   7    46   0   0   0    62   128   0     35
3    0     0   1  7834   0   0   0   539    60   0      3
4    0    23  16    42   0   0   0    24   115   0    319
5    0     0   0   388   0   0   0     2   129   0      2
6    0   321  26   180   0   0   2    65   555   0    759
7    0    61   1   545   0   0   0  6547    43   0     67
8    0    52  60  1105   0   0   0   226  1601   0    252
9    0    11   0   245   0   0   0    47   187   0      2
10   0    83  40    86   0   0   0    69   128   0  12387
---- Validation: 
scalar performance:
{'acc': 0.78980875, 'precision': 0.4221658, 'recall': 0.37686956, 'specificity': 0.9758618, 'f1': 0.35159698, 'auroc': 0.9034707}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0    43   2   118   0   0   0    34   209   0     77
1    0  1135   0    19   0   0   0   159     2   0     17
2    0    29   3    52   0   0   0    64   128   0     36
3    0     0   0  7849   0   0   0   519    70   0      2
4    0    46  16    36   0   0   0    22   109   0    310
5    0     0   0   388   0   0   0     2   130   0      1
6    0   304  22   178   0   0   1    76   560   0    767
7    0    43   5   569   0   0   0  6530    47   0     71
8    0    59  84  1054   0   1   0   253  1597   0    248
9    0     8   4   227   0   0   0    52   201   0      1
10   0    71  25    71   0   0   0    78   139   0  12412
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32771286, 'precision': 0.22957645, 'recall': 0.29995254, 'specificity': 0.93340987, 'f1': 0.23925042, 'auroc': 0.70524657}
confusion matrix:
    0     1    2    3   4   5   6    7    8   9     10
0    0    66   50  527   0   0   1   27  411   0    88
1    0  1068    3   59   0   1   0  135   22   0   211
2    0    20   93  295   0   0   0    8  259   0   340
3    0     0    0    0   0   0   0    0    0   0     0
4    0     0    7    6   0   0   0    0    7   0  1613
5    0     0    3  489   0   0   0    0   98   0     2
6    0    35  239   99   0   0   0    6  152   0  2536
7    0    31    2   64   0   0   1  970   39   0    57
8    0     7   72  270   0   1   0    1  907   0   112
9    0    20   20  698   0   0   0   33  322   0    44
10   0     0    0    0   0   0   0    0    0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 21:33:50.235895,epoch time: 0:31:02.691247,used: 1:03:19.357752,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8125535, 'precision': 0.42354524, 'recall': 0.40145904, 'specificity': 0.9793849, 'f1': 0.35840005, 'auroc': 0.9195325}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    1   117   0    49   0   0   2    39   215   0     60
1    0  1161   0    15   0   0   0   142     2   0     12
2    0    79   1    14   0   0   1    63   125   0     29
3    0     0   0  7667   0   0   0   571   200   0      2
4    0    75   4     6   0   0   0    19   139   0    296
5    0     9   1   247   0   0   0     6   255   0      2
6    0   786   2    40   0   0   0    73   505   0    501
7    0    76   1   325   0   0   0  6741    71   0     49
8    0    84   8   399   0   1   1   244  2422   0    136
9    0    49   0   101   0   0   0    37   302   0      4
10   0   158  11    18   0   0   2    63   163   0  12377
---- Validation: 
scalar performance:
{'acc': 0.81243813, 'precision': 0.370608, 'recall': 0.40081242, 'specificity': 0.9793187, 'f1': 0.35796523, 'auroc': 0.9193549}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0   129   0    35   0   0   0    35   221   0     63
1    0  1157   0    14   0   0   0   143     3   0     15
2    0    83   1    10   0   0   0    66   126   0     26
3    0     0   0  7667   0   0   0   567   204   0      2
4    0    83   5    12   0   0   0    19   121   0    299
5    0     8   0   238   0   0   0     2   271   0      2
6    0   779   1    61   0   0   2    70   462   1    532
7    0    67   0   303   0   0   0  6789    58   0     48
8    0    73   6   433   0   0   1   233  2397   0    153
9    0    54   0   101   0   0   2    38   294   0      4
10   0   161   5    20   0   0   0    63   187   0  12360
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3511509, 'precision': 0.19476865, 'recall': 0.3191774, 'specificity': 0.9345722, 'f1': 0.2148077, 'auroc': 0.72919685}
confusion matrix:
    0     1   2    3   4   5   6    7     8   9     10
0    0   529   0  161   0   0  15   26   414   0    25
1    0  1212   0   44   0   0   1   99    18   0   125
2    0   181   2  113   0   0   3    8   388   0   320
3    0     0   0    0   0   0   0    0     0   0     0
4    0    18   1    1   0   0   0    0     7   0  1606
5    0     8   3  187   0   0   0    1   389   0     4
6    0   459   2   21   0   0   0    3   167   0  2415
7    0    90   0   24   0   0  10  964    29   0    47
8    0    72   0   63   0   0   0    1  1195   0    39
9    0   159   2  344   0   0   4   21   559   0    48
10   0     0   0    0   0   0   0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 22:04:56.043899,epoch time: 0:31:05.808004,used: 1:34:25.165756,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.82058007, 'precision': 0.48507366, 'recall': 0.40984246, 'specificity': 0.9802424, 'f1': 0.36681515, 'auroc': 0.9346116}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    3   177   0    49   0   2  24    29   135   2     62
1    0  1187   0    19   0   0   0   111     3   0     12
2    0   106   2    11   0   0   1    47    98   0     47
3    0     1   0  7890   0   0   0   373   172   0      1
4    0    66   1     9   0   0   0    13   130   0    319
5    0    23   0   279   0   4   0     2   205   6      2
6    0   980   0    53   0   0   7    44   320   0    504
7    0    91   0   427   0   0   0  6593    79   0     75
8    0    44   4   418   0   2   0   169  2553   0    105
9    1   103   1   115   0   2   6    31   227   2      5
10   0   153   9    21   0   0   0    40   140   0  12429
---- Validation: 
scalar performance:
{'acc': 0.8206232, 'precision': 0.5006343, 'recall': 0.40878958, 'specificity': 0.98026955, 'f1': 0.3647332, 'auroc': 0.9342239}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    4   182   0    61   0   1  18    24   135   1     57
1    0  1185   0    21   0   0   0   109     3   0     14
2    0   105   0    13   0   0   2    42   105   0     45
3    0     1   0  7908   0   0   0   374   154   0      3
4    0    71   3    13   0   0   2    11   128   0    311
5    0    28   1   275   0   2   1     4   201   6      3
6    0   993   1    56   0   0   3    50   310   0    495
7    0    93   0   434   0   0   0  6594    94   0     50
8    0    49   4   415   0   0   0   163  2548   0    117
9    0   101   0   122   0   1   3    31   228   2      5
10   0   150   6    25   0   0   0    42   140   0  12433
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.337228, 'precision': 0.2459564, 'recall': 0.30257374, 'specificity': 0.9331815, 'f1': 0.20453645, 'auroc': 0.73766106}
confusion matrix:
    0     1   2    3   4   5   6    7     8   9     10
0    0   710   0  125   0   0  72    7   243   1    12
1    0  1243   0   65   0   0   0   56    23   0   112
2    0   216   1   94   0   0   6    3   367   0   328
3    0     0   0    0   0   0   0    0     0   0     0
4    0    11   1    2   0   0   0    0    10   0  1609
5    0    16   3  227   0   0   0    1   342   0     3
6    0   619   0   11   0   0   4    1   130   0  2302
7    0   168   0  167   0   0  26  703    47   0    53
8    0    54   0   65   0   0   1    1  1222   0    27
9    0   172   0  372   0   0   8   13   523   1    48
10   0     0   0    0   0   0   0    0     0   0  1646
better model found
persisted
after epoch: 4,now: 2024-08-11 22:35:51.029915,epoch time: 0:30:54.986016,used: 2:05:20.151772,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8380779, 'precision': 0.5671249, 'recall': 0.46037722, 'specificity': 0.98248744, 'f1': 0.4433607, 'auroc': 0.9485961}
confusion matrix:
    0     1   2     3   4    5    6     7     8   9      10
0    7    75   1    58   0   28  159    31    78   7     39
1    0  1190   0    20   0    0    0   104     9   0      9
2    0    34   6     9   0   11   54    43   101   8     45
3    0     1   2  7919   0    3    0   338   174   0      0
4    0    44  10    17   0    1   22    16   141   6    282
5    0     0  47   215   0  126    9     1    84  37      2
6    0   980   2    66   0   10  257    46   236   5    306
7    0    28   1   371   0    2    0  6719   106   0     34
8    0    17   7   355   0    4    0   134  2730   0     49
9    0    11  14    97   0   92   73    23   124  52      7
10   0   144  18    31   0    3   29    63   188   1  12318
---- Validation: 
scalar performance:
{'acc': 0.8362712, 'precision': 0.5761455, 'recall': 0.46008524, 'specificity': 0.9822894, 'f1': 0.44352978, 'auroc': 0.9489574}
confusion matrix:
    0     1   2     3   4    5    6     7     8   9      10
0    2    69   0    58   0   34  165    29    78   3     45
1    0  1171   2    22   0    0    0   121     7   0      9
2    0    36   7    16   0   12   57    37   102   9     36
3    0     0   4  7922   0    3    0   336   175   0      0
4    0    48  14    16   0    0   25     9   141   7    279
5    0     1  49   211   0  135   10     0    94  20      1
6    0   966   0    59   0   14  248    45   248   5    323
7    0    32   0   368   0    0    0  6732   100   0     33
8    0    12  11   375   0    5    1   135  2699   0     58
9    0    10  14    90   0  102   62    22   127  60      6
10   0   158  16    30   0    0   30    62   212   0  12288
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.39082068, 'precision': 0.32569942, 'recall': 0.33020505, 'specificity': 0.93796194, 'f1': 0.27338767, 'auroc': 0.76189303}
confusion matrix:
    0     1   2    3   4   5    6    7     8   9     10
0    0    86   4  140   0  19  696    1   197  24     3
1    0  1235   1   89   0   1    8   47    30   0    88
2    0    77  23  109   0  15  150    1   398  11   231
3    0     0   0    0   0   0    0    0     0   0     0
4    0     8   3    1   0   0    8    0    15   0  1598
5    0     0  62  215   0  83   12    0   195  23     2
6    0   581  10   12   0  13  808    1   160  14  1468
7    0   128   0  343   0   0   68  528    58   3    36
8    0    19   1   70   0  15   30    0  1221   2    12
9    0    27  35  376   0  70  149    5   394  43    38
10   0     1   0    0   0   0    0    0     0   0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 23:06:51.593476,epoch time: 0:31:00.563561,used: 2:36:20.715333,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8753478, 'precision': 0.6508701, 'recall': 0.5341786, 'specificity': 0.98607457, 'f1': 0.5314876, 'auroc': 0.95947295}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    9    13   4    45   0   18   288    27    25   4     50
1    0  1192   0    19   0    1     1   106     2   0      9
2    0     7  18     8   0   26    83    53    35   9     73
3    0     0   4  7871   0   16     0   382   164   1      1
4    0     5  17    11   0    4    65    17    60   2    358
5    0     0  49   153   0  248    17     3    40  10      1
6    0   126   0    50   0   10  1339    46    84   2    250
7    0    23   2   259   0    1     0  6866    64   0     48
8    0    15  13   293   0   14     5   184  2666   1    104
9    0     7  13    63   0  172   118    32    50  31      7
10   0    58   9    31   0    1   101    53    64   0  12477
---- Validation: 
scalar performance:
{'acc': 0.8751371, 'precision': 0.65534544, 'recall': 0.5356585, 'specificity': 0.9860638, 'f1': 0.5321603, 'auroc': 0.95922023}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    9    13   1    54   0   22   273    21    32   2     56
1    0  1196   0    20   0    1     0   103     3   0      9
2    0     9  20    10   0   24    86    45    45   4     69
3    0     0   4  7872   0   14     0   383   167   0      0
4    0     2  13    13   0    4    63    14    66   5    359
5    0     1  52   144   0  259    16     0    40   8      1
6    0   131   1    62   0   13  1334    45    84   2    236
7    0    36   0   259   0    1     3  6856    60   0     50
8    0    19  21   314   0    7     6   167  2658   0    104
9    0     4  17    76   0  169   107    32    50  28     10
10   0    67  13    18   0    0   102    38    72   1  12485
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4284615, 'precision': 0.4006179, 'recall': 0.35013783, 'specificity': 0.941709, 'f1': 0.30886525, 'auroc': 0.76560456}
confusion matrix:
    0     1   2    3   4    5     6    7     8   9     10
0    0    14   0  203   0   20   808    1   118   1     5
1    0  1242   0   98   0    0    10   34    25   0    90
2    0    13  18  112   0   37   239    0   292   7   297
3    0     0   0    0   0    0     0    0     0   0     0
4    0     1   2    1   0    0    15    0     7   0  1607
5    0     0  37  217   0  216    27    0    86   7     2
6    0    73   5   10   0   11  1477    1    57   0  1433
7    0   130   1  575   0    0    66  320    33   3    36
8    0    10   5   89   0   20    48    0  1178   0    20
9    0    15  13  381   0  168   218    2   270  28    42
10   0     1   0    0   0    0     0    0     0   0  1645
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-11 23:38:00.023912,epoch time: 0:31:08.430436,used: 3:07:29.145769,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8847656, 'precision': 0.67528945, 'recall': 0.56159997, 'specificity': 0.98704135, 'f1': 0.5693555, 'auroc': 0.9639529}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   40     1   0    87   0    7   246    27    18   2     55
1    0  1191   0    24   0    1     0   102     6   0      8
2    2     2  28    14   0   23    59    32    52   8     92
3    0     0   4  7985   0   14     0   299   135   0      1
4    0     1  20    22   0    1    51    14    80   1    349
5    0     0  41   141   0  265    22     1    29  20      2
6    2    15   0    73   0    7  1588    28    29   3    163
7    0    39   1   329   0    0     2  6775    73   0     44
8    0     4  14   330   0    3    10   165  2696   0     74
9    0     2  30    77   0  152   105    22    39  49     17
10   0    36  13    39   0    1   130    44    75   1  12452
---- Validation: 
scalar performance:
{'acc': 0.8848736, 'precision': 0.67589486, 'recall': 0.55847347, 'specificity': 0.9870537, 'f1': 0.56610096, 'auroc': 0.9637941}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   36     1   1    79   0    2   262    34    21   4     43
1    0  1177   0    26   0    0     0   110     9   0     10
2    0     5  32    14   0   20    62    47    44   5     83
3    0     0   6  7972   0   11     0   313   137   1      0
4    0     3  18    21   0    5    48    10    69   4    361
5    0     0  39   143   0  253    20     1    34  30      1
6    0    14   0    62   0    5  1587    27    29   2    182
7    0    29   3   324   0    0     6  6809    62   0     32
8    0     4  19   313   0    6    11   147  2710   0     86
9    0     0  29    80   0  151   103    28    40  43     19
10   0    35  12    33   0    2   144    41    67   0  12462
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44546282, 'precision': 0.49791598, 'recall': 0.34784386, 'specificity': 0.94413793, 'f1': 0.3205437, 'auroc': 0.7673103}
confusion matrix:
    0     1   2    3   4    5     6    7     8   9     10
0    6     2   0  387   0    5   711    0    53   3     3
1    0  1196   1  117   0    0    25   40    19   0   101
2    0     4  23  157   0   24   186    1   320   9   291
3    0     0   0    0   0    0     0    0     0   0     0
4    0     1   0    2   0    0    11    0    11   0  1608
5    0     0  31  311   0  171    33    0    29  15     2
6    0    32   5   22   0    4  1868    1    54   8  1073
7    0    61   1  737   0    0    60  241    33   0    31
8    1     7   3  136   0    9    34    0  1162   3    15
9    1    12  16  520   0  104   162    2   218  54    48
10   0     0   0    0   0    0     0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-12 00:09:48.002099,epoch time: 0:31:47.978187,used: 3:39:17.123956,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8952269, 'precision': 0.67932075, 'recall': 0.6079664, 'specificity': 0.9882498, 'f1': 0.61495906, 'auroc': 0.97308856}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   138     2   2    94   0   10   134    26    22   4     50
1     0  1209   0    22   0    0     0    85     6   0     10
2     3     6  63    19   0   29    28    23    38  15     88
3     0     0  18  7845   0   35     0   350   189   0      0
4     0     0  22    43   0    4    22     9    70   4    365
5     0     0  31    85   0  356    11     0    28   9      1
6    20     2   0   106   0   11  1590    25    40   0    114
7     0    17   1   227   0    1     3  6878    94   0     42
8     0     7  11   214   0   14     8   129  2839   1     73
9     2     0  49    58   0  221    51    18    49  29     16
10    0    16  17    37   0    1    91    37    80   1  12513
---- Validation: 
scalar performance:
{'acc': 0.89704424, 'precision': 0.6861353, 'recall': 0.60938925, 'specificity': 0.9884682, 'f1': 0.61748934, 'auroc': 0.9730414}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   148     1   0    89   0    4   133    22    29   5     52
1     0  1206   0    20   0    0     0    89     8   0      9
2     2     6  55    15   0   37    23    29    43  17     85
3     0     1   5  7860   0   38     1   324   211   0      0
4     0     2  29    44   0    8    30     8    56   3    359
5     0     0  26    91   0  353    13     0    26  11      1
6    13     3   3   104   0    7  1607    19    31   0    121
7     0    17   0   225   0    1     1  6885   103   0     33
8     0     4   7   213   0   15     7   126  2863   0     61
9     0     2  43    58   0  229    55    13    41  34     18
10    0    20  15    36   0    2    89    33    75   1  12525
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47099978, 'precision': 0.5149146, 'recall': 0.3770147, 'specificity': 0.94733906, 'f1': 0.3530757, 'auroc': 0.784777}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   149     3   0  562   0   16   349    0    86   2     3
1     1  1210   0  120   0    0    27   29    38   0    74
2     3     5  51  174   0   45   145    1   306  15   270
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   3    7   0    0    11    0    11   0  1601
5     8     0  25  239   0  260    26    0    25   7     2
6     0    16  42   25   0   12  1982    0    63  10   917
7     2    55   1  788   0    0    48  161    74   2    33
8    10     2   1   86   0   25    25    0  1210   2     9
9    13     6  31  430   0  202   124    2   222  63    44
10    0     0   0    0   0    0     0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-12 00:40:54.634044,epoch time: 0:31:06.631945,used: 4:10:23.755901,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90349424, 'precision': 0.6887836, 'recall': 0.62302494, 'specificity': 0.9891175, 'f1': 0.63639396, 'auroc': 0.97601354}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   197     1   1    73   0    7   103    31    18   2     50
1     0  1189   0    14   0    0     0   112     6   0     11
2     2     3  42    27   0   29    12    38    33  32     94
3     0     1   8  7827   0   29     0   387   186   0      0
4     0     1  21    49   0    5    18    15    40  16    374
5     0     0  28    77   0  352    16     2    25  20      1
6    20     1   1    72   0    6  1684    27    19   1     77
7     0     9   0   156   0    0     1  7014    55   0     30
8     0     3   3   183   0    6    10   144  2852   1     92
9     2     0  48    55   0  214    48    29    26  59     12
10    1    11   6    26   0    1    91    42    58   2  12553
---- Validation: 
scalar performance:
{'acc': 0.9032232, 'precision': 0.69541824, 'recall': 0.62759775, 'specificity': 0.98910636, 'f1': 0.6414027, 'auroc': 0.9755924}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   203     1   3    67   0    5   108    29    19   2     46
1     0  1185   0    13   0    0     0   119     7   0      8
2     5     6  53    24   0   36    10    38    32  21     87
3     0     0   3  7843   0   27     0   384   182   1      0
4     1     3  25    42   0    4    11    16    50  16    371
5     0     0  22    88   0  356     9     0    27  18      1
6    18     6   2    72   0    6  1693    22    19   2     68
7     0     9   2   158   0    1     2  7002    60   0     31
8     1     4   5   203   0   13     6   170  2811   2     81
9     4     4  41    65   0  206    53    18    27  62     13
10    3    12   7    41   0    3    84    32    53   2  12559
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48877072, 'precision': 0.5223259, 'recall': 0.39807948, 'specificity': 0.9489471, 'f1': 0.3843482, 'auroc': 0.7907198}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   299     9   0  433   0    8   304    0   108   4     5
1     1  1178   0   90   0    0    26   45    60   0    99
2     2     7  45  169   0   31    99    3   339  17   303
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   1   15   0    0     6    0     9   0  1602
5    15     0  13  247   0  224    23    1    40  27     2
6     1    18  39   12   0    7  1901    0    85   8   996
7     2    33   0  583   0    1    47  363    99   1    35
8    12     4   2   64   0   16    14    0  1248   1     9
9    26     9  28  401   0  152    89    3   290  82    57
10    0     0   0    0   0    0     0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 01:12:04.437734,epoch time: 0:31:09.803690,used: 4:41:33.559591,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9049925, 'precision': 0.69680625, 'recall': 0.6328603, 'specificity': 0.9891862, 'f1': 0.65407336, 'auroc': 0.97688156}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   269     5   2    63   0    2    45    18    26    0     53
1     0  1201   0    22   0    0     0    97     3    0      9
2     5     4  26    54   0   15     2    34    46   50     76
3     0     0   0  8002   0   19     0   272   145    0      0
4     0     3  10    75   0    3     7    11    54   24    352
5     2     0  29   111   0  317     2     3    32   24      1
6    44     4   1   107   0    3  1590    17    40    3     99
7     1    10   0   255   0    0     1  6920    52    1     25
8     0     1   2   248   0    4     1   127  2851    0     59
9    11     3  35    95   0  137    17    23    44  114     14
10    6    15   7    52   0    0    52    52    71    2  12535
---- Validation: 
scalar performance:
{'acc': 0.90576434, 'precision': 0.6890866, 'recall': 0.63040066, 'specificity': 0.98926926, 'f1': 0.65043694, 'auroc': 0.9763364}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   240     3   2    75   0    2    40    25    36    2     58
1     0  1203   0    23   0    0     0    90     8    0      8
2     3     4  17    46   0   16     4    41    37   71     73
3     0     0   4  8029   0   14     0   247   146    0      0
4     1     2   9    66   0    2     5    11    52   25    366
5     2     0  23   106   0  329     3     0    33   24      1
6    48     9   0   116   0    2  1590    14    38    2     89
7     0    10   0   245   0    0     1  6907    63    1     38
8     0     1   3   220   0    6     0   135  2870    0     61
9     6     3  37    98   0  139    12    18    35  129     16
10   11    13   8    57   0    1    47    41    69    1  12548
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44476318, 'precision': 0.50882864, 'recall': 0.36630502, 'specificity': 0.9451021, 'f1': 0.34751153, 'auroc': 0.77534467}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   357    27   1  409   0    1   125    0   238   0    12
1     0  1218   0  105   0    0     6   37    53   0    80
2     6     7  35  205   0   15    21    2   416  13   295
3     0     0   0    0   0    0     0    0     0   0     0
4     0     1   0   21   0    0     3    0    18   0  1590
5     8     0  19  357   0  125     5    1    59  16     2
6     4    60  49   32   0    5  1361    0   275  16  1265
7     2    41   0  666   0    1    17  289   113   0    35
8     5     0   3   65   0    6     2    0  1285   0     4
9    16     9  36  503   0   69    23    4   378  41    58
10    0     0   0    0   0    0     0    0     0   0  1646
better model found
persisted
after epoch: 10,now: 2024-08-12 01:43:14.424110,epoch time: 0:31:09.986376,used: 5:12:43.545967,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:12:43.545967 at 2024-08-12 01:43:14.424110
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44476318, 'precision': 0.50882864, 'recall': 0.36630502, 'specificity': 0.9451021, 'f1': 0.34751153, 'auroc': 0.77534467}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   357    27   1  409   0    1   125    0   238   0    12
1     0  1218   0  105   0    0     6   37    53   0    80
2     6     7  35  205   0   15    21    2   416  13   295
3     0     0   0    0   0    0     0    0     0   0     0
4     0     1   0   21   0    0     3    0    18   0  1590
5     8     0  19  357   0  125     5    1    59  16     2
6     4    60  49   32   0    5  1361    0   275  16  1265
7     2    41   0  666   0    1    17  289   113   0    35
8     5     0   3   65   0    6     2    0  1285   0     4
9    16     9  36  503   0   69    23    4   378  41    58
10    0     0   0    0   0    0     0    0     0   0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48877072, 'precision': 0.5223259, 'recall': 0.39807948, 'specificity': 0.9489471, 'f1': 0.3843482, 'auroc': 0.7907198}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   299     9   0  433   0    8   304    0   108   4     5
1     1  1178   0   90   0    0    26   45    60   0    99
2     2     7  45  169   0   31    99    3   339  17   303
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   1   15   0    0     6    0     9   0  1602
5    15     0  13  247   0  224    23    1    40  27     2
6     1    18  39   12   0    7  1901    0    85   8   996
7     2    33   0  583   0    1    47  363    99   1    35
8    12     4   2   64   0   16    14    0  1248   1     9
9    26     9  28  401   0  152    89    3   290  82    57
10    0     0   0    0   0    0     0    0     0   0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_20_30_30_seed_1_24142412_instance_wise_predictions.txt
accuracy from prediction file 0.44476317078290073
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/20.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/20.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 500536 KiB |  10952 MiB | 689545 GiB | 689544 GiB |
|       from large pool | 408896 KiB |  10880 MiB | 688106 GiB | 688106 GiB |
|       from small pool |  91640 KiB |    127 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 500536 KiB |  10952 MiB | 689545 GiB | 689544 GiB |
|       from large pool | 408896 KiB |  10880 MiB | 688106 GiB | 688106 GiB |
|       from small pool |  91640 KiB |    127 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478831 KiB |  10882 MiB | 686042 GiB | 686042 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 684609 GiB | 684609 GiB |
|       from small pool |  90991 KiB |    126 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11550 MiB |  11550 MiB |  21484 MiB |   9934 MiB |
|       from large pool |  11422 MiB |  11422 MiB |  21326 MiB |   9904 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1331 MiB |   1548 MiB | 275367 GiB | 275366 GiB |
|       from large pool |   1320 MiB |   1545 MiB | 273838 GiB | 273836 GiB |
|       from small pool |     10 MiB |     34 MiB |   1529 GiB |   1529 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3965    |    5193    |   55141 K  |   55137 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    3878    |    5087    |   31031 K  |   31027 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3965    |    5193    |   55141 K  |   55137 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    3878    |    5087    |   31031 K  |   31027 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     294    |     294    |     508    |     214    |
|       from large pool |     230    |     230    |     429    |     199    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      60    |    1153    |   27533 K  |   27533 K  |
|       from large pool |      28    |     129    |   12766 K  |   12766 K  |
|       from small pool |      32    |    1123    |   14766 K  |   14766 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10952 MiB | 689545 GiB | 689545 GiB |
|       from large pool |  16640 KiB |  10880 MiB | 688106 GiB | 688106 GiB |
|       from small pool |      0 KiB |    127 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10952 MiB | 689545 GiB | 689545 GiB |
|       from large pool |  16640 KiB |  10880 MiB | 688106 GiB | 688106 GiB |
|       from small pool |      0 KiB |    127 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 686042 GiB | 686042 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 684609 GiB | 684609 GiB |
|       from small pool |      0 KiB |    126 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1820 MiB |  11550 MiB |  21484 MiB |  19664 MiB |
|       from large pool |   1720 MiB |  11422 MiB |  21326 MiB |  19606 MiB |
|       from small pool |    100 MiB |    128 MiB |    158 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1548 MiB | 275368 GiB | 275368 GiB |
|       from large pool |  59136 KiB |   1545 MiB | 273838 GiB | 273838 GiB |
|       from small pool |      0 KiB |     35 MiB |   1529 GiB |   1529 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5193    |   55141 K  |   55141 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    5087    |   31031 K  |   31031 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5193    |   55141 K  |   55141 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    5087    |   31031 K  |   31031 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      87    |     294    |     508    |     421    |
|       from large pool |      37    |     230    |     429    |     392    |
|       from small pool |      50    |      64    |      79    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1153    |   27534 K  |   27534 K  |
|       from large pool |       3    |     129    |   12766 K  |   12766 K  |
|       from small pool |       0    |    1123    |   14768 K  |   14768 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 01:49:35 2024]
Finished job 0.
1 of 1 steps (100%) done
