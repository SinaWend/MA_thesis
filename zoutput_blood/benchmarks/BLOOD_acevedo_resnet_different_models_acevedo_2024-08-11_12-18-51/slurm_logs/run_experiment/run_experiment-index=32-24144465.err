Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 09:35:32 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/32.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=32
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_09_44_56_seed_0_24144465

 Experiment start at: 2024-08-12 09:44:57.255608
before training, model accuracy: 0.08472679555416107
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.057309505, 'precision': 0.070765465, 'recall': 0.07951813, 'specificity': 0.9091263, 'f1': 0.017627157, 'auroc': 0.5383242}
confusion matrix:
      0   1   2   3   4   5   6   7     8    9   10
0    109   0   0   0   0   0   0   0   358   16   0
1    766   0   0   0   0   0   0   0   464  101   0
2     50   0   0   0   0   0   0   0   242   20   0
3   2830   0   0   0   0   0   0   3  5278  327   0
4    106   0   0   0   0   0   0   0   400   33   0
5     75   0   0   0   0   0   0   0   431   15   0
6    452   0   0   0   0   0   0   1  1367   87   0
7   3133   0   0   0   0   0   0   2  3788  341   0
8   1175   0   0   0   0   0   0   1  2011  108   1
9     70   0   0   0   0   0   0   0   404   19   0
10  5124   0   0   0   0   0   0   5  7155  507   1
---- Validation: 
scalar performance:
{'acc': 0.057723686, 'precision': 0.04939572, 'recall': 0.08459462, 'specificity': 0.909183, 'f1': 0.018688865, 'auroc': 0.540607}
confusion matrix:
      0   1   2   3   4   5   6   7     8    9   10
0    127   0   0   0   0   0   0   0   341   15   0
1    793   0   0   0   0   0   0   0   428  111   0
2     53   0   0   0   0   0   0   0   231   28   0
3   2734   0   0   1   0   0   0   2  5322  381   0
4    108   0   0   0   0   0   0   0   398   33   0
5     79   0   0   0   0   0   0   0   429   13   0
6    500   0   0   0   0   0   0   0  1312   96   0
7   3141   0   0   2   0   0   0   1  3794  327   0
8   1185   0   0   0   0   0   0   2  1999  109   1
9     71   0   0   0   0   0   0   0   392   30   0
10  5140   0   0   0   0   0   0   6  7153  497   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.05457217, 'precision': 0.03768377, 'recall': 0.05428243, 'specificity': 0.9058511, 'f1': 0.022245917, 'auroc': 0.45530564}
confusion matrix:
      0   1   2   3   4   5   6   7    8   9   10
0    189   0   0   0   0   0   0   0  975   6   0
1    492   0   0   1   0   3   0   9  990   4   0
2    521   0   0   3   0   0   0   2  484   5   0
3      0   0   0   0   0   0   0   0    0   0   0
4   1186   0   0   1   0   0   0   5  436   5   0
5    262   0   0   0   0   0   0   2  319   9   0
6   2299   0   0  10   0   0   0  23  647  88   0
7    597   0   0   4   0   1   0  15  509  38   0
8    784   0   0   1   0   1   0   2  561  21   0
9    570   0   0   2   0   0   0   6  544  15   0
10  1360   0   0   0   0   0   0   5  276   5   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 10:25:06.678343,epoch time: 0:40:09.422735,used: 0:40:09.422735,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_09_44_56_seed_0_24144465
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.061429795, 'precision': 0.020734932, 'recall': 0.074875176, 'specificity': 0.9087843, 'f1': 0.016375152, 'auroc': 0.53100127}
confusion matrix:
      0   1   2   3   4   5   6   7     8    9   10
0     58   0   0   0   0   0   0   0   408   17   0
1    415   0   0   0   0   0   0   0   754  160   3
2     15   0   0   0   0   0   0   0   287   10   0
3   2048   0   0   0   0   0   0   0  6046  342   1
4     55   0   0   0   0   0   0   0   465   19   0
5     45   0   0   0   0   0   0   0   459   17   0
6    235   0   0   0   0   0   0   0  1628   44   0
7   2332   0   0   0   0   0   0   0  4662  268   3
8    976   0   0   3   0   0   0   0  2223   91   0
9     26   0   0   0   0   0   0   0   453   14   0
10  4218   0   0   7   0   0   0   1  8255  312   1
---- Validation: 
scalar performance:
{'acc': 0.06170924, 'precision': 0.064340085, 'recall': 0.076680385, 'specificity': 0.90881896, 'f1': 0.016595356, 'auroc': 0.5359095}
confusion matrix:
      0   1   2   3   4   5   6   7     8    9   10
0     68   0   0   0   0   0   0   0   401   14   0
1    419   0   0   0   0   0   0   0   775  136   2
2     11   0   0   0   0   0   0   0   296    5   0
3   2080   0   0   2   0   0   0   2  5986  370   0
4     60   0   0   0   0   0   0   0   464   15   0
5     40   0   0   1   0   0   0   0   463   17   0
6    239   0   0   1   0   0   0   0  1621   47   0
7   2403   0   0   3   0   0   0   1  4551  306   1
8    988   0   0   1   0   0   0   0  2221   86   0
9     20   0   0   0   0   0   0   0   459   14   0
10  4122   0   0   5   0   0   0   2  8356  310   1
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.081718326, 'precision': 0.007532763, 'recall': 0.0907537, 'specificity': 0.90905976, 'f1': 0.01391089, 'auroc': 0.4570617}
confusion matrix:
      0   1   2   3   4   5   6   7    8   9   10
0   1168   0   0   0   0   0   0   0    2   0   0
1   1305   0   0   4   0   0   0  10  180   0   0
2   1015   0   0   0   0   0   0   0    0   0   0
3      0   0   0   0   0   0   0   0    0   0   0
4   1633   0   0   0   0   0   0   0    0   0   0
5    592   0   0   0   0   0   0   0    0   0   0
6   3067   0   0   0   0   0   0   0    0   0   0
7   1163   0   0   0   0   0   0   0    1   0   0
8   1370   0   0   0   0   0   0   0    0   0   0
9   1137   0   0   0   0   0   0   0    0   0   0
10  1646   0   0   0   0   0   0   0    0   0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 11:04:23.759899,epoch time: 0:39:17.081556,used: 1:19:26.504291,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_09_44_56_seed_0_24144465
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.103087544, 'precision': 0.09149915, 'recall': 0.06671491, 'specificity': 0.9067294, 'f1': 0.026991282, 'auroc': 0.53612167}
confusion matrix:
      0   1   2   3   4   5   6     7    8    9   10
0     84   0   0   0   0   0   0   365    7   26   0
1    329   0   0   0   0   0   0   744   34  224   1
2     17   0   0   0   0   0   0   274    6   15   0
3   2930   0   0   8   0   0   0  4934  112  453   1
4     77   0   0   0   0   0   0   442    4   16   0
5     79   0   0   0   0   0   0   411    8   23   0
6    293   0   0   0   0   0   0  1530   22   63   0
7   3146   0   0   4   0   0   0  3708   86  320   0
8   1335   0   0   7   0   0   0  1846   31   77   0
9     32   0   0   0   0   0   0   432   10   19   0
10  4184   0   0  33   0   0   0  8036  115  420   3
---- Validation: 
scalar performance:
{'acc': 0.10370469, 'precision': 0.07716805, 'recall': 0.065821365, 'specificity': 0.9067506, 'f1': 0.027469445, 'auroc': 0.53226334}
confusion matrix:
      0   1   2   3   4   5   6     7    8    9   10
0     74   0   0   1   0   0   0   382    6   20   0
1    333   0   0   0   0   0   0   741   30  227   1
2     16   0   0   0   0   0   0   280    2   14   0
3   2878   0   0   7   0   0   0  4976  112  467   0
4     86   0   0   0   0   0   0   428    5   20   0
5     68   0   0   1   0   0   0   426    5   20   1
6    313   0   0   0   0   0   0  1500   17   77   1
7   3129   0   0   5   0   0   0  3733   72  325   1
8   1320   0   0   6   0   0   0  1842   37   90   1
9     40   0   0   0   0   0   0   428    3   22   0
10  4169   0   0  36   0   0   0  8090   93  404   4
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.081998184, 'precision': 0.009272518, 'recall': 0.09106569, 'specificity': 0.9091127, 'f1': 0.014310533, 'auroc': 0.45702168}
confusion matrix:
      0   1   2   3   4   5   6    7   8   9   10
0   1169   0   0   0   0   0   0    1   0   0   0
1   1336   0   0  13   0   0   0  150   0   0   0
2   1015   0   0   0   0   0   0    0   0   0   0
3      0   0   0   0   0   0   0    0   0   0   0
4   1633   0   0   0   0   0   0    0   0   0   0
5    592   0   0   0   0   0   0    0   0   0   0
6   3067   0   0   0   0   0   0    0   0   0   0
7   1161   0   0   0   0   0   0    3   0   0   0
8   1369   0   0   0   0   0   0    1   0   0   0
9   1137   0   0   0   0   0   0    0   0   0   0
10  1645   0   0   0   0   0   0    1   0   0   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 11:44:43.515243,epoch time: 0:40:19.755344,used: 1:59:46.259635,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_09_44_56_seed_0_24144465
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.1234482, 'precision': 0.07878032, 'recall': 0.06768925, 'specificity': 0.905746, 'f1': 0.026548333, 'auroc': 0.5126113}
confusion matrix:
      0   1   2   3   4   5   6      7   8    9   10
0     38   0   0   0   0   0   0    426   4   15   0
1    339   0   0   0   0   0   0    828  39  124   2
2     12   0   0   0   0   0   0    284   1   14   1
3   2426   0   0   2   0   0   0   5629  91  290   0
4     36   0   0   0   0   0   0    484   3   16   0
5     52   0   0   0   0   0   0    450   6   13   0
6    107   0   0   1   0   0   0   1737  22   41   0
7   2433   0   0   2   0   0   0   4542  55  231   0
8    874   0   0   0   0   0   0   2361  12   49   0
9     35   0   0   0   0   0   0    438   2   18   0
10   805   0   0   3   0   0   0  11610  89  282   2
---- Validation: 
scalar performance:
{'acc': 0.123445235, 'precision': 0.0668848, 'recall': 0.070101924, 'specificity': 0.9058033, 'f1': 0.026979314, 'auroc': 0.51349336}
confusion matrix:
      0   1   2   3   4   5   6      7   8    9   10
0     53   0   0   0   0   0   0    414   4   12   0
1    342   0   0   0   0   0   0    817  47  126   0
2      9   0   0   0   0   0   0    283   3   17   0
3   2496   0   0   0   0   0   0   5561  82  300   1
4     46   0   0   0   0   0   0    464   9   20   0
5     58   0   0   0   0   0   0    445   6   12   0
6    116   0   0   1   0   0   0   1724  24   43   0
7   2449   0   0   3   0   0   0   4524  60  229   0
8    881   0   0   0   0   0   0   2339  20   55   1
9     29   0   0   0   0   0   0    441   7   16   0
10   764   0   0   4   0   0   0  11651  94  281   2
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.06884489, 'precision': 0.0075591886, 'recall': 0.07684738, 'specificity': 0.9078536, 'f1': 0.013543817, 'auroc': 0.442465}
confusion matrix:
     0   1   2   3   4   5   6     7   8   9   10
0     9   0   0   0   0   0   0  1161   0   0   0
1   316   0   0   4   0   0   0  1179   0   0   0
2   144   0   0   1   0   0   0   870   0   0   0
3     0   0   0   0   0   0   0     0   0   0   0
4    34   0   0   0   0   0   0  1599   0   0   0
5   180   0   0   4   0   0   0   408   0   0   0
6   386   0   0   6   0   0   0  2675   0   0   0
7   184   0   0   5   0   0   0   975   0   0   0
8   283   0   0   3   0   0   0  1084   0   0   0
9   240   0   0   3   0   0   0   894   0   0   0
10    8   0   0   0   0   0   0  1638   0   0   0
better model found
persisted
after epoch: 4,now: 2024-08-12 12:25:36.637947,epoch time: 0:40:53.122704,used: 2:40:39.382339,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_09_44_56_seed_0_24144465
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.11633134, 'precision': 0.019846313, 'recall': 0.06760635, 'specificity': 0.9053025, 'f1': 0.024825005, 'auroc': 0.5169771}
confusion matrix:
      0   1   2   3   4   5   6      7   8   9   10
0     70   0   0   0   0   0   0    403   4   6   0
1    453   0   0   0   0   0   0    825  31  23   0
2     15   0   0   0   0   0   0    284  10   3   0
3   2982   0   0   0   0   0   0   5308  68  81   0
4     50   0   0   0   0   0   0    477   7   5   0
5     61   0   0   0   0   0   0    454   3   2   0
6    186   0   0   0   0   0   0   1699   9  14   0
7   2902   0   0   0   0   0   0   4262  44  53   0
8    976   0   0   0   0   0   0   2293  12  15   0
9     40   0   0   0   0   0   0    445   3   4   0
10   927   0   0   0   0   0   0  11720  80  67   0
---- Validation: 
scalar performance:
{'acc': 0.1169453, 'precision': 0.01876203, 'recall': 0.06490028, 'specificity': 0.90529335, 'f1': 0.023965223, 'auroc': 0.514268}
confusion matrix:
      0   1   2   3   4   5   6      7   8   9   10
0     56   0   0   0   0   0   0    419   3   5   0
1    490   0   0   0   0   0   0    791  29  22   0
2     21   0   0   0   0   0   0    286   4   1   0
3   2946   0   0   0   0   0   0   5336  67  91   0
4     33   0   0   0   0   0   0    500   6   0   0
5     69   0   0   0   0   0   0    448   2   2   0
6    185   0   0   0   0   0   0   1703   9  11   0
7   2851   0   0   1   0   0   0   4303  59  51   0
8    979   0   0   0   0   0   0   2298  12   7   0
9     24   0   0   0   0   0   0    464   4   1   0
10   869   0   0   0   0   0   0  11776  77  74   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.033163086, 'precision': 0.0059582237, 'recall': 0.036948793, 'specificity': 0.9042931, 'f1': 0.010256747, 'auroc': 0.4126103}
confusion matrix:
      0   1   2   3   4   5   6     7   8   9   10
0    177   0   0   0   0   0   0   993   0   0   0
1    754   0   0   1   0   0   0   744   0   0   0
2    593   0   0   0   0   0   0   422   0   0   0
3      0   0   0   0   0   0   0     0   0   0   0
4    356   0   0   0   0   0   0  1277   0   0   0
5    476   0   0   0   0   0   0   116   0   0   0
6   1878   0   0   0   0   0   0  1189   0   0   0
7    867   0   0   0   0   0   0   297   0   0   0
8    745   0   0   0   0   0   0   625   0   0   0
9    736   0   0   0   0   0   0   401   0   0   0
10   120   0   0   0   0   0   0  1526   0   0   0
early stop counter: 1
val acc:0.1169452965259552, best validation acc: 0.12344523519277573, corresponding to test acc:                         0.06884489208459854 / 0.08199818432331085
after epoch: 5,now: 2024-08-12 13:05:50.236497,epoch time: 0:40:13.598550,used: 3:20:52.980889,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_09_44_56_seed_0_24144465
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.12542808, 'precision': 0.021590572, 'recall': 0.068706475, 'specificity': 0.9058343, 'f1': 0.024913186, 'auroc': 0.5219448}
confusion matrix:
      0   1   2   3   4   5   6      7   8   9   10
0     56   0   0   0   0   0   0    423   4   0   0
1    464   0   0   0   0   0   0    852  15   0   0
2     18   0   0   0   0   0   0    294   0   0   0
3   2876   0   0   0   0   0   0   5513  44   0   3
4     45   0   0   0   0   0   0    493   1   0   0
5     57   0   0   0   0   0   0    463   1   0   0
6    139   0   0   0   0   0   0   1761   7   0   0
7   2611   0   0   0   0   0   0   4620  30   1   0
8    960   0   0   0   0   0   0   2324  12   0   0
9     40   0   0   0   0   0   0    450   3   0   0
10   832   0   0   0   0   0   0  11914  50   0   0
---- Validation: 
scalar performance:
{'acc': 0.12264277, 'precision': 0.018481152, 'recall': 0.06749409, 'specificity': 0.9055805, 'f1': 0.024224574, 'auroc': 0.52123976}
confusion matrix:
      0   1   2   3   4   5   6      7   8   9   10
0     57   0   0   0   0   0   0    422   4   0   0
1    479   0   0   0   0   0   0    836  17   0   0
2     19   0   0   0   0   0   0    292   1   0   0
3   2925   0   0   0   0   0   0   5477  36   0   2
4     62   0   0   0   0   0   0    477   0   0   0
5     56   0   0   0   0   0   0    461   4   0   0
6    125   0   0   0   0   0   0   1774   9   0   0
7   2704   0   0   0   0   0   0   4521  40   0   0
8    969   0   0   0   0   0   0   2320   7   0   0
9     35   0   0   0   0   0   0    457   1   0   0
10   777   0   0   0   0   0   0  11965  54   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.06170853, 'precision': 0.007828973, 'recall': 0.07576615, 'specificity': 0.9071323, 'f1': 0.013813223, 'auroc': 0.43699154}
confusion matrix:
     0   1   2   3   4   5   6     7   8   9   10
0    16   0   0   0   0   0   0  1154   0   0   0
1   344   0   0   0   0   0   0  1155   0   0   0
2   165   0   0   0   0   0   0   850   0   0   0
3     0   0   0   0   0   0   0     0   0   0   0
4    28   0   0   0   0   0   0  1605   0   0   0
5   208   0   0   0   0   0   0   384   0   0   0
6   293   0   0   0   0   0   0  2774   0   0   0
7   298   0   0   0   0   0   0   866   0   0   0
8   261   0   0   0   0   0   0  1109   0   0   0
9   276   0   0   0   0   0   0   861   0   0   0
10    3   0   0   0   0   0   0  1643   0   0   0
early stop counter: 2
val acc:0.12264277040958405, best validation acc: 0.12344523519277573, corresponding to test acc:                         0.06884489208459854 / 0.08199818432331085
after epoch: 6,now: 2024-08-12 13:46:44.744562,epoch time: 0:40:54.508065,used: 4:01:47.488954,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_09_44_56_seed_0_24144465
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.116251074, 'precision': 0.03247898, 'recall': 0.06838246, 'specificity': 0.90564984, 'f1': 0.024687141, 'auroc': 0.5171524}
confusion matrix:
      0   1   2   3   4   5   6      7    8   9   10
0     78   0   0   0   0   0   0    401    4   0   0
1    570   0   0   0   0   0   0    746   16   0   0
2     44   0   0   0   0   0   0    266    2   0   0
3   3027   0   0   0   0   0   0   5297  101   0  14
4     69   0   0   0   0   0   0    468    1   0   1
5     80   0   0   0   0   0   0    437    4   0   0
6    275   0   0   0   0   0   0   1618   15   0   0
7   2963   0   0   0   0   0   0   4244   52   0   3
8   1098   0   0   0   0   0   0   2176   20   0   1
9     63   0   0   0   0   0   0    424    5   0   1
10  1322   0   0   0   0   0   0  11375   92   0   3
---- Validation: 
scalar performance:
{'acc': 0.11376221, 'precision': 0.03622113, 'recall': 0.06758526, 'specificity': 0.9053645, 'f1': 0.024323469, 'auroc': 0.5224438}
confusion matrix:
      0   1   2   3   4   5   6      7    8   9   10
0     80   0   0   0   0   0   0    396    7   0   0
1    587   0   0   0   0   0   0    733   12   0   0
2     30   0   0   0   0   0   0    278    4   0   0
3   3009   0   0   0   0   0   0   5308  106   0  17
4     67   0   0   0   0   0   0    467    5   0   0
5     92   0   0   0   0   0   0    426    2   0   1
6    264   0   0   0   0   0   0   1635    8   0   1
7   3053   0   0   0   0   0   0   4147   65   0   0
8   1110   0   0   0   0   0   0   2164   22   0   0
9     50   0   0   0   0   0   0    437    6   0   0
10  1232   0   0   0   0   0   0  11459  101   0   4
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.036871195, 'precision': 0.0064702085, 'recall': 0.04524672, 'specificity': 0.9046626, 'f1': 0.011287056, 'auroc': 0.40845013}
confusion matrix:
      0   1   2   3   4   5   6     7   8   9   10
0     64   0   0   0   0   0   0  1106   0   0   0
1    641   0   0   0   0   0   0   858   0   0   0
2    575   0   0   0   0   0   0   440   0   0   0
3      0   0   0   0   0   0   0     0   0   0   0
4    239   0   0   0   0   0   0  1394   0   0   0
5    410   0   0   0   0   0   0   182   0   0   0
6   1447   0   0   0   0   0   0  1620   0   0   0
7    701   0   0   0   0   0   0   463   0   0   0
8    741   0   0   0   0   0   0   629   0   0   0
9    724   0   0   0   0   0   0   413   0   0   0
10    61   0   0   0   0   0   0  1585   0   0   0
early stop counter: 3
val acc:0.11376220732927322, best validation acc: 0.12344523519277573, corresponding to test acc:                         0.06884489208459854 / 0.08199818432331085
after epoch: 7,now: 2024-08-12 14:28:24.513137,epoch time: 0:41:39.768575,used: 4:43:27.257529,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_09_44_56_seed_0_24144465
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 4:43:27.257529 at 2024-08-12 14:28:24.513137
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.06884489, 'precision': 0.0075591886, 'recall': 0.07684738, 'specificity': 0.9078536, 'f1': 0.013543817, 'auroc': 0.442465}
confusion matrix:
     0   1   2   3   4   5   6     7   8   9   10
0     9   0   0   0   0   0   0  1161   0   0   0
1   316   0   0   4   0   0   0  1179   0   0   0
2   144   0   0   1   0   0   0   870   0   0   0
3     0   0   0   0   0   0   0     0   0   0   0
4    34   0   0   0   0   0   0  1599   0   0   0
5   180   0   0   4   0   0   0   408   0   0   0
6   386   0   0   6   0   0   0  2675   0   0   0
7   184   0   0   5   0   0   0   975   0   0   0
8   283   0   0   3   0   0   0  1084   0   0   0
9   240   0   0   3   0   0   0   894   0   0   0
10    8   0   0   0   0   0   0  1638   0   0   0
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.081998184, 'precision': 0.009272518, 'recall': 0.09106569, 'specificity': 0.9091127, 'f1': 0.014310533, 'auroc': 0.45702168}
confusion matrix:
      0   1   2   3   4   5   6    7   8   9   10
0   1169   0   0   0   0   0   0    1   0   0   0
1   1336   0   0  13   0   0   0  150   0   0   0
2   1015   0   0   0   0   0   0    0   0   0   0
3      0   0   0   0   0   0   0    0   0   0   0
4   1633   0   0   0   0   0   0    0   0   0   0
5    592   0   0   0   0   0   0    0   0   0   0
6   3067   0   0   0   0   0   0    0   0   0   0
7   1161   0   0   0   0   0   0    3   0   0   0
8   1369   0   0   0   0   0   0    1   0   0   0
9   1137   0   0   0   0   0   0    0   0   0   0
10  1645   0   0   0   0   0   0    1   0   0   0
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_09_44_56_seed_0_24144465_instance_wise_predictions.txt
accuracy from prediction file 0.06884488910655566
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/32.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/32.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/32.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 495908 KiB |  13548 MiB | 509085 GiB | 509085 GiB |
|       from large pool | 405184 KiB |  13475 MiB | 508200 GiB | 508200 GiB |
|       from small pool |  90724 KiB |    125 MiB |    884 GiB |    884 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 495908 KiB |  13548 MiB | 509085 GiB | 509085 GiB |
|       from large pool | 405184 KiB |  13475 MiB | 508200 GiB | 508200 GiB |
|       from small pool |  90724 KiB |    125 MiB |    884 GiB |    884 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478101 KiB |  13472 MiB | 506407 GiB | 506406 GiB |
|       from large pool | 387840 KiB |  13400 MiB | 505524 GiB | 505524 GiB |
|       from small pool |  90261 KiB |    125 MiB |    882 GiB |    882 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  13888 MiB |  13888 MiB |  13888 MiB |      0 B   |
|       from large pool |  13762 MiB |  13762 MiB |  13762 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 290523 KiB |    961 MiB | 231510 GiB | 231509 GiB |
|       from large pool | 280896 KiB |    960 MiB | 230562 GiB | 230562 GiB |
|       from small pool |   9627 KiB |     13 MiB |    947 GiB |    947 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3029    |    4672    |   37515 K  |   37512 K  |
|       from large pool |      87    |     594    |   17609 K  |   17609 K  |
|       from small pool |    2942    |    4550    |   19906 K  |   19903 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3029    |    4672    |   37515 K  |   37512 K  |
|       from large pool |      87    |     594    |   17609 K  |   17609 K  |
|       from small pool |    2942    |    4550    |   19906 K  |   19903 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     339    |     339    |     339    |       0    |
|       from large pool |     276    |     276    |     276    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1162    |   16279 K  |   16279 K  |
|       from large pool |      12    |     139    |    8545 K  |    8545 K  |
|       from small pool |      21    |    1150    |    7734 K  |    7734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13548 MiB | 509085 GiB | 509085 GiB |
|       from large pool |  16640 KiB |  13475 MiB | 508200 GiB | 508200 GiB |
|       from small pool |      0 KiB |    125 MiB |    884 GiB |    884 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13548 MiB | 509085 GiB | 509085 GiB |
|       from large pool |  16640 KiB |  13475 MiB | 508200 GiB | 508200 GiB |
|       from small pool |      0 KiB |    125 MiB |    884 GiB |    884 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13472 MiB | 506407 GiB | 506407 GiB |
|       from large pool |  16640 KiB |  13400 MiB | 505524 GiB | 505524 GiB |
|       from small pool |      0 KiB |    125 MiB |    882 GiB |    882 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    768 MiB |  13888 MiB |  13888 MiB |  13120 MiB |
|       from large pool |    670 MiB |  13762 MiB |  13762 MiB |  13092 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    961 MiB | 231510 GiB | 231510 GiB |
|       from large pool |  59136 KiB |    960 MiB | 230562 GiB | 230562 GiB |
|       from small pool |      0 KiB |     32 MiB |    947 GiB |    947 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4672    |   37515 K  |   37515 K  |
|       from large pool |       2    |     594    |   17609 K  |   17609 K  |
|       from small pool |       0    |    4550    |   19906 K  |   19906 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4672    |   37515 K  |   37515 K  |
|       from large pool |       2    |     594    |   17609 K  |   17609 K  |
|       from small pool |       0    |    4550    |   19906 K  |   19906 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     339    |     339    |     264    |
|       from large pool |      26    |     276    |     276    |     250    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1162    |   16280 K  |   16280 K  |
|       from large pool |       3    |     139    |    8545 K  |    8545 K  |
|       from small pool |       0    |    1150    |    7735 K  |    7735 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13548 MiB | 509085 GiB | 509085 GiB |
|       from large pool |  16640 KiB |  13475 MiB | 508200 GiB | 508200 GiB |
|       from small pool |      0 KiB |    125 MiB |    884 GiB |    884 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13548 MiB | 509085 GiB | 509085 GiB |
|       from large pool |  16640 KiB |  13475 MiB | 508200 GiB | 508200 GiB |
|       from small pool |      0 KiB |    125 MiB |    884 GiB |    884 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13472 MiB | 506407 GiB | 506407 GiB |
|       from large pool |  16640 KiB |  13400 MiB | 505524 GiB | 505524 GiB |
|       from small pool |      0 KiB |    125 MiB |    882 GiB |    882 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    768 MiB |  13888 MiB |  13888 MiB |  13120 MiB |
|       from large pool |    670 MiB |  13762 MiB |  13762 MiB |  13092 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    961 MiB | 231510 GiB | 231510 GiB |
|       from large pool |  59136 KiB |    960 MiB | 230562 GiB | 230562 GiB |
|       from small pool |      0 KiB |     32 MiB |    947 GiB |    947 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4672    |   37515 K  |   37515 K  |
|       from large pool |       2    |     594    |   17609 K  |   17609 K  |
|       from small pool |       0    |    4550    |   19906 K  |   19906 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4672    |   37515 K  |   37515 K  |
|       from large pool |       2    |     594    |   17609 K  |   17609 K  |
|       from small pool |       0    |    4550    |   19906 K  |   19906 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     339    |     339    |     264    |
|       from large pool |      26    |     276    |     276    |     250    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1162    |   16280 K  |   16280 K  |
|       from large pool |       3    |     139    |    8545 K  |    8545 K  |
|       from small pool |       0    |    1150    |    7735 K  |    7735 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_14_45_11_seed_1_24144465

 Experiment start at: 2024-08-12 14:45:11.943562
before training, model accuracy: 0.10193801671266556
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.22300407, 'precision': 0.07773852, 'recall': 0.066148266, 'specificity': 0.9076025, 'f1': 0.056709483, 'auroc': 0.5407274}
confusion matrix:
    0   1     2    3   4   5   6    7   8   9     10
0    0   0    62   51   0   0   0   20   0   0   350
1    0   0   204  200   0   0   0  196   0   0   732
2    0   0     8   42   0   0   0    8   0   0   254
3    0   0  1944  670   0   0   0  463   0   0  5362
4    0   0    66   70   0   0   0   12   0   0   391
5    0   0    41   64   0   0   0   12   0   0   403
6    0   0   253  186   0   0   0   37   0   0  1431
7    0   0  2320  402   0   0   0  403   0   0  4139
8    0   0  1067  190   0   0   0   71   0   0  1968
9    0   0    28   59   0   0   0    9   0   0   397
10   0   0  4603  751   0   0   0  183   0   0  7254
---- Validation: 
scalar performance:
{'acc': 0.2236191, 'precision': 0.07950342, 'recall': 0.06767659, 'specificity': 0.9076458, 'f1': 0.05753745, 'auroc': 0.546954}
confusion matrix:
    0   1     2    3   4   5   6    7   8   9     10
0    0   0    59   45   0   0   0   17   0   0   362
1    0   0   199  215   0   0   0  188   0   1   729
2    0   0    12   49   0   0   0    1   0   0   250
3    0   0  1959  715   0   0   0  426   0   0  5340
4    0   0    67   58   0   0   0   10   0   0   404
5    0   0    49   69   0   0   0   16   0   0   387
6    0   0   232  175   0   0   0   35   0   0  1466
7    0   0  2327  413   0   0   0  416   0   0  4109
8    0   0  1020  234   0   0   0   75   0   0  1967
9    0   0    32   57   0   0   0    9   0   0   395
10   0   0  4600  789   0   0   0  190   0   0  7217
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.06555656, 'precision': 0.04021266, 'recall': 0.079928555, 'specificity': 0.90730727, 'f1': 0.017550355, 'auroc': 0.47138804}
confusion matrix:
    0   1     2   3   4   5   6   7   8   9     10
0    0   0   304  15   0   0   0   0   0   0   851
1    0   0   422  38   0   0   0   2   0   0  1037
2    0   0   818   3   0   0   0   0   0   0   194
3    0   0     0   0   0   0   0   0   0   0     0
4    0   0  1402   4   0   0   0   3   0   0   224
5    0   0   407   3   0   0   0   0   0   0   182
6    0   0  2790   6   0   0   0   2   0   0   269
7    0   0   469  15   0   0   0   4   0   0   676
8    0   0  1257   1   0   0   0   0   0   0   112
9    0   0   884   8   0   0   0   0   0   0   245
10   0   0  1529   1   0   0   0   1   0   0   115
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 15:27:41.328613,epoch time: 0:42:29.385051,used: 0:42:29.385051,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_12_14_45_11_seed_1_24144465
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 24144465 ON supergpu02 CANCELLED AT 2024-08-12T15:40:19 ***
