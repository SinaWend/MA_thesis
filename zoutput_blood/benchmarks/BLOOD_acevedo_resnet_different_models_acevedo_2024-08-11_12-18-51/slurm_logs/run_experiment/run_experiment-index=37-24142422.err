Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 00:56:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/37.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=37
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_06_34_seed_0_24142422

 Experiment start at: 2024-08-12 01:06:34.617209
before training, model accuracy: 0.07954943180084229
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.76361835, 'precision': 0.5241763, 'recall': 0.39542156, 'specificity': 0.9729873, 'f1': 0.39878482, 'auroc': 0.90843934}
confusion matrix:
    0    1   2     3    4   5     6     7     8    9      10
0    0    2   0    55    1   0   282    36    25   28     54
1    0  593   0   104    8   0     8   567     4    0     48
2    0    2   0    35    1   0   167    36    27   20     24
3    0    3   0  7549  119   0    21   588   111   12     35
4    0    6   0    29    1   0   141    22    43    7    289
5    0    0   0   350    3   1    41     4     9  111      2
6    0   16   0   138    3   0  1313    66    67   13    292
7    0   31   0   943   74   0    43  5860   126    2    185
8    0    0   0   791   16   0   305   339  1106   23    715
9    0    2   0   164    2   0   165    28    10  117      5
10   0   19   0   181   11   0   269   241    70    0  12001
---- Validation: 
scalar performance:
{'acc': 0.7628193, 'precision': 0.48401076, 'recall': 0.39546666, 'specificity': 0.9728533, 'f1': 0.40026748, 'auroc': 0.9077104}
confusion matrix:
    0    1   2     3    4   5     6     7     8    9      10
0    0    0   0    60    3   0   266    42    18   32     62
1    0  583   0   110    7   0     9   586     4    0     33
2    0    2   0    50    1   0   167    25    15   21     31
3    0    1   0  7531  130   1    33   583   123   10     28
4    0    4   0    30    1   0   152    26    33    6    287
5    0    0   0   343    6   1    42     5     7  114      3
6    0    6   0   149    8   0  1310    63    55   18    299
7    0   17   0  1003   74   0    38  5820   131    0    182
8    0    2   0   768   12   0   275   354  1143   16    726
9    0    1   0   162    0   0   165    18    19  120      8
10   0   16   0   164   14   0   253   272    67    1  12009
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32141608, 'precision': 0.23865744, 'recall': 0.2420959, 'specificity': 0.9272174, 'f1': 0.2022633, 'auroc': 0.68785924}
confusion matrix:
    0    1   2   3   4   5     6    7    8    9     10
0    0    0   0   4   0   0  1046    4    6  107     3
1    0  399   0  13   0   0   210  544   20    8   305
2    0    0   0  32   0   0   639   18  117   58   151
3    0    0   0   0   0   0     0    0    0    0     0
4    0    0   0   0   0   0   116    3    4    1  1509
5    0    0   0  84   0   0   111    0   45  349     3
6    0    0   0   2   0   0  1445   15  122    2  1481
7    0   22   0  10   1   0   472  594   40    2    23
8    0    0   0  20   0   0   879    0  236  140    95
9    0    4   0  79   0   0   576   22  151  282    23
10   0    0   0   0   0   0     8    0    0    0  1638
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 01:50:41.634553,epoch time: 0:44:07.017344,used: 0:44:07.017344,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_06_34_seed_0_24142422
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.38797623, 'precision': 0.16033864, 'recall': 0.14610396, 'specificity': 0.9289083, 'f1': 0.12091859, 'auroc': 0.6394394}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9     10
0    0   0   0   238   0   0   0   194    3   0    48
1    0   0   0   292   1   0   0  1029    0   0    10
2    0   0   0   147   0   0   0   141    1   0    23
3    0   0   0  6481   2   0   0  1925    1   0    30
4    0   0   0   248   1   0   0   226    4   0    60
5    0   0   0   396   0   0   0   115    2   0     8
6    0   0   0   829   3   0   4   820    7   0   244
7    0   0   0  3648   6   0   1  3480    2   0   126
8    0   0   0  2147   2   0   0   931    7   0   208
9    0   0   0   289   0   0   1   182    4   0    16
10   0   0   0  4613  14   0  13  3521  103   1  4528
---- Validation: 
scalar performance:
{'acc': 0.3918149, 'precision': 0.19434813, 'recall': 0.14777276, 'specificity': 0.9293772, 'f1': 0.12215083, 'auroc': 0.6408674}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9     10
0    0   0   0   239   0   0   1   189    5   0    49
1    0   1   0   313   1   0   0   996    1   0    20
2    0   0   0   140   0   0   0   154    0   0    18
3    0   0   0  6492   4   0   0  1914    4   0    26
4    0   0   0   256   0   0   0   220    0   0    63
5    0   0   0   403   0   0   1   108    2   0     7
6    0   0   0   818   1   0   2   830   12   0   245
7    0   0   0  3523   7   0   0  3604    0   0   131
8    0   0   0  2152   1   0   0   955   13   0   175
9    0   0   0   318   0   0   0   149    4   0    22
10   0   1   0  4551   8   0  23  3564  113   0  4536
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.15168265, 'precision': 0.07129827, 'recall': 0.13082032, 'specificity': 0.9144682, 'f1': 0.064911336, 'auroc': 0.57796884}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9     10
0    0   0   0  279   0   0   0   68  30   0   793
1    0   0   0   36   1   0   0  170   7   0  1285
2    0   0   0  146   0   1   0   94  46   0   728
3    0   0   0    0   0   0   0    0   0   0     0
4    0   0   0    0   0   0   0    0   0   0  1633
5    0   0   0  318   0   0   0  173  13   0    88
6    0   0   0   29   0   0   0    6  29   0  3003
7    0   0   0  110   0   0   0  449   8   0   597
8    0   0   0  315   0   0   0  104  73   0   878
9    0   0   0  427   0   0   0  229  47   0   434
10   0   0   0    0   0   0   0    0   0   0  1646
early stop counter: 1
val acc:0.3918148875236511, best validation acc: 0.7628192901611328, corresponding to test acc:                         0.32141607999801636 / 0.32141607999801636
after epoch: 2,now: 2024-08-12 02:33:45.112371,epoch time: 0:43:03.477818,used: 1:27:10.495162,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_06_34_seed_0_24142422
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.32718858, 'precision': 0.08401452, 'recall': 0.10940608, 'specificity': 0.91655874, 'f1': 0.09474483, 'auroc': 0.5395261}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   181   0   0   0    94   0   0   207
1    0   0   0   200   0   0   0   995   0   0   136
2    0   0   0    98   0   0   0    80   0   0   134
3    0   0   0  3160   0   0   0  1761   0   0  3516
4    0   0   0   179   0   0   0   105   0   0   255
5    0   0   0   184   0   0   0    66   0   0   271
6    0   0   0   643   0   0   0   419   0   0   845
7    0   0   0  3043   0   0   0  2018   0   0  2203
8    0   0   0  1299   0   0   0   467   0   0  1530
9    0   0   0   181   0   0   0    81   0   0   231
10   0   0   0  3687   0   0   0  2056   0   0  7051
---- Validation: 
scalar performance:
{'acc': 0.32826, 'precision': 0.084040835, 'recall': 0.10959015, 'specificity': 0.9167573, 'f1': 0.09485555, 'auroc': 0.54577273}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   168   0   0   0    97   0   0   218
1    0   0   0   190   0   0   0  1014   0   0   128
2    0   0   0   103   0   0   0    63   0   0   146
3    0   0   0  3179   0   0   0  1829   0   0  3432
4    0   0   0   182   0   0   0   112   0   0   245
5    0   0   0   170   0   0   0    81   0   0   270
6    0   0   0   628   0   0   0   439   0   0   841
7    0   0   0  3093   0   0   0  1987   0   0  2185
8    0   0   0  1296   0   0   0   482   0   0  1518
9    0   0   0   173   0   0   0    75   0   0   245
10   0   0   0  3638   0   0   0  2051   1   0  7106
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.09711047, 'precision': 0.016511604, 'recall': 0.077574484, 'specificity': 0.9101955, 'f1': 0.024448436, 'auroc': 0.49691176}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9     10
0    0   0   0  438   0   0   0   47   0   0   685
1    0   0   0  263   0   0   0  370   0   0   866
2    0   0   0  254   0   0   0   39   0   0   722
3    0   0   0    0   0   0   0    0   0   0     0
4    0   0   0  280   0   0   0   91   0   0  1262
5    0   0   0  116   0   0   0   15   0   0   461
6    0   0   0  783   0   0   0   74   0   0  2210
7    0   0   0  254   0   0   0   40   0   0   870
8    0   0   0  446   0   0   0   31   0   0   893
9    0   0   0  279   0   0   0   28   0   0   830
10   0   0   0  213   0   0   0   85   0   0  1348
early stop counter: 2
val acc:0.32826000452041626, best validation acc: 0.7628192901611328, corresponding to test acc:                         0.32141607999801636 / 0.32141607999801636
after epoch: 3,now: 2024-08-12 03:16:34.533665,epoch time: 0:42:49.421294,used: 2:09:59.916456,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_06_34_seed_0_24142422
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.3429741, 'precision': 0.07316267, 'recall': 0.09674528, 'specificity': 0.91142464, 'f1': 0.06622898, 'auroc': 0.52405083}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9      10
0    0   0   0   13   0   0   0   34   0   0    436
1    0   0   0   48   0   0   0  647   0   0    637
2    0   0   0    6   0   0   0   22   0   0    284
3    0   0   0  229   0   0   0  696   0   0   7513
4    0   0   0   19   0   0   0   25   0   0    495
5    0   0   0   13   0   0   0   21   0   0    486
6    0   0   0   53   0   0   0  149   0   0   1706
7    0   0   0  384   0   0   0  889   0   0   5989
8    0   0   0   76   0   0   0  138   0   0   3082
9    0   0   0   18   0   0   0   27   0   0    448
10   0   0   0  404   0   0   0  688   0   0  11701
---- Validation: 
scalar performance:
{'acc': 0.3446302, 'precision': 0.07445727, 'recall': 0.09735566, 'specificity': 0.9116574, 'f1': 0.06683953, 'auroc': 0.5203861}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9      10
0    0   0   0    4   0   0   0   38   0   0    441
1    0   0   0   39   0   0   0  651   0   0    642
2    0   0   0   10   0   0   0   17   0   0    285
3    0   0   0  232   0   0   0  714   0   0   7494
4    0   0   0   12   0   0   0   34   0   0    493
5    0   0   0    6   0   0   0   24   0   0    491
6    0   0   0   51   0   0   0  151   0   0   1706
7    0   0   0  400   0   0   0  919   0   0   5946
8    0   0   0   83   0   0   0  145   0   0   3068
9    0   0   0   12   0   0   0   23   0   0    458
10   0   0   0  358   0   0   0  705   0   0  11733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1150913, 'precision': 0.014387992, 'recall': 0.09105969, 'specificity': 0.90933526, 'f1': 0.020394739, 'auroc': 0.53664774}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0  33   0   0   0  44   0   0  1093
1    0   0   0  18   0   0   0  52   0   0  1429
2    0   0   0  10   0   0   0   6   0   0   999
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0  14   0   0   0  15   0   0  1604
5    0   0   0   2   0   0   0  11   0   0   579
6    0   0   0  92   0   0   0  64   0   0  2911
7    0   0   0  12   0   0   0   9   0   0  1143
8    0   0   0  37   0   0   0  13   0   0  1320
9    0   0   0  12   0   0   0   6   0   0  1119
10   0   0   0   5   0   0   0   5   0   0  1636
early stop counter: 3
val acc:0.3446302115917206, best validation acc: 0.7628192901611328, corresponding to test acc:                         0.32141607999801636 / 0.32141607999801636
after epoch: 4,now: 2024-08-12 03:59:26.777375,epoch time: 0:42:52.243710,used: 2:52:52.160166,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_06_34_seed_0_24142422
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 2:52:52.160166 at 2024-08-12 03:59:26.777375
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32141608, 'precision': 0.23865744, 'recall': 0.2420959, 'specificity': 0.9272174, 'f1': 0.2022633, 'auroc': 0.68785924}
confusion matrix:
    0    1   2   3   4   5     6    7    8    9     10
0    0    0   0   4   0   0  1046    4    6  107     3
1    0  399   0  13   0   0   210  544   20    8   305
2    0    0   0  32   0   0   639   18  117   58   151
3    0    0   0   0   0   0     0    0    0    0     0
4    0    0   0   0   0   0   116    3    4    1  1509
5    0    0   0  84   0   0   111    0   45  349     3
6    0    0   0   2   0   0  1445   15  122    2  1481
7    0   22   0  10   1   0   472  594   40    2    23
8    0    0   0  20   0   0   879    0  236  140    95
9    0    4   0  79   0   0   576   22  151  282    23
10   0    0   0   0   0   0     8    0    0    0  1638
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32141608, 'precision': 0.23865744, 'recall': 0.2420959, 'specificity': 0.9272174, 'f1': 0.2022633, 'auroc': 0.68785924}
confusion matrix:
    0    1   2   3   4   5     6    7    8    9     10
0    0    0   0   4   0   0  1046    4    6  107     3
1    0  399   0  13   0   0   210  544   20    8   305
2    0    0   0  32   0   0   639   18  117   58   151
3    0    0   0   0   0   0     0    0    0    0     0
4    0    0   0   0   0   0   116    3    4    1  1509
5    0    0   0  84   0   0   111    0   45  349     3
6    0    0   0   2   0   0  1445   15  122    2  1481
7    0   22   0  10   1   0   472  594   40    2    23
8    0    0   0  20   0   0   879    0  236  140    95
9    0    4   0  79   0   0   576   22  151  282    23
10   0    0   0   0   0   0     8    0    0    0  1638
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_01_06_34_seed_0_24142422_instance_wise_predictions.txt
accuracy from prediction file 0.32141607780032183
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/37.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/37.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/37.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1704 MiB |  20452 MiB | 395647 GiB | 395645 GiB |
|       from large pool |   1511 MiB |  20295 MiB | 394825 GiB | 394824 GiB |
|       from small pool |    193 MiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1704 MiB |  20452 MiB | 395647 GiB | 395645 GiB |
|       from large pool |   1511 MiB |  20295 MiB | 394825 GiB | 394824 GiB |
|       from small pool |    193 MiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  20353 MiB | 394085 GiB | 394083 GiB |
|       from large pool |   1476 MiB |  20196 MiB | 393265 GiB | 393264 GiB |
|       from small pool |    192 MiB |    273 MiB |    819 GiB |    819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20988 MiB |  20988 MiB |  20988 MiB |      0 B   |
|       from large pool |  20712 MiB |  20712 MiB |  20712 MiB |      0 B   |
|       from small pool |    276 MiB |    276 MiB |    276 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 564370 KiB |   1192 MiB | 174603 GiB | 174603 GiB |
|       from large pool | 555344 KiB |   1191 MiB | 173701 GiB | 173700 GiB |
|       from small pool |   9026 KiB |     19 MiB |    902 GiB |    902 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   27942 K  |   27937 K  |
|       from large pool |     182    |     799    |   12408 K  |   12408 K  |
|       from small pool |    4194    |    6508    |   15533 K  |   15529 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   27942 K  |   27937 K  |
|       from large pool |     182    |     799    |   12408 K  |   12408 K  |
|       from small pool |    4194    |    6508    |   15533 K  |   15529 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|       from large pool |     356    |     356    |     356    |       0    |
|       from small pool |     138    |     138    |     138    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      48    |    1077    |   13192 K  |   13192 K  |
|       from large pool |      21    |     176    |    6940 K  |    6940 K  |
|       from small pool |      27    |    1056    |    6251 K  |    6251 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  20353 MiB | 394085 GiB | 394085 GiB |
|       from large pool |  16640 KiB |  20196 MiB | 393265 GiB | 393265 GiB |
|       from small pool |      0 KiB |    273 MiB |    819 GiB |    819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2256 MiB |  20988 MiB |  20988 MiB |  18732 MiB |
|       from large pool |   2054 MiB |  20712 MiB |  20712 MiB |  18658 MiB |
|       from small pool |    202 MiB |    276 MiB |    276 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1192 MiB | 174604 GiB | 174604 GiB |
|       from large pool |  59136 KiB |   1191 MiB | 173701 GiB | 173701 GiB |
|       from small pool |      0 KiB |     36 MiB |    902 GiB |    902 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     161    |     494    |     494    |     333    |
|       from large pool |      60    |     356    |     356    |     296    |
|       from small pool |     101    |     138    |     138    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1077    |   13193 K  |   13193 K  |
|       from large pool |       4    |     176    |    6940 K  |    6940 K  |
|       from small pool |       0    |    1056    |    6252 K  |    6252 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  20353 MiB | 394085 GiB | 394085 GiB |
|       from large pool |  16640 KiB |  20196 MiB | 393265 GiB | 393265 GiB |
|       from small pool |      0 KiB |    273 MiB |    819 GiB |    819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2256 MiB |  20988 MiB |  20988 MiB |  18732 MiB |
|       from large pool |   2054 MiB |  20712 MiB |  20712 MiB |  18658 MiB |
|       from small pool |    202 MiB |    276 MiB |    276 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1192 MiB | 174604 GiB | 174604 GiB |
|       from large pool |  59136 KiB |   1191 MiB | 173701 GiB | 173701 GiB |
|       from small pool |      0 KiB |     36 MiB |    902 GiB |    902 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     161    |     494    |     494    |     333    |
|       from large pool |      60    |     356    |     356    |     296    |
|       from small pool |     101    |     138    |     138    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1077    |   13193 K  |   13193 K  |
|       from large pool |       4    |     176    |    6940 K  |    6940 K  |
|       from small pool |       0    |    1056    |    6252 K  |    6252 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_04_14_23_seed_1_24142422

 Experiment start at: 2024-08-12 04:14:23.920442
before training, model accuracy: 0.06254810094833374
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7842198, 'precision': 0.59131056, 'recall': 0.39033046, 'specificity': 0.97412336, 'f1': 0.39589164, 'auroc': 0.9269056}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0    0   0    39   0   0  182    40    68   0    154
1    0  980   0    22   0   0    0   249     3   0     78
2    0    0   0    21   0   0   56    42    78   0    115
3    0    1   0  7517   0   0    8   643   202   0     67
4    0    0   0    15   0   0   53    15    50   0    406
5    0    2   0   371   0   1   32     3   110   0      2
6    0    1   0    62   0   0  867    52   154   0    772
7    0   25   0   730   0   0    8  6094   110   0    294
8    0    0   0   594   0   0  141   347  1273   0    941
9    0    0   0   175   0   0   95    30   158   1     34
10   0    2   0    13   0   0   90    56    54   0  12578
---- Validation: 
scalar performance:
{'acc': 0.7828541, 'precision': 0.40930524, 'recall': 0.3887498, 'specificity': 0.97391677, 'f1': 0.39429486, 'auroc': 0.92661035}
confusion matrix:
    0    1   2     3   4   5    6     7     8   9      10
0    0    1   0    38   0   0  182    37    61   0    164
1    0  981   0    24   0   0    0   242     4   0     81
2    0    1   0    23   0   0   51    37    89   0    111
3    0    4   0  7503   0   0    3   656   213   0     61
4    0    0   0    14   0   0   52    19    50   0    404
5    0    0   0   377   0   0   36     6    97   1      4
6    0    3   1    57   0   0  848    52   133   0    814
7    0   17   0   714   0   0    7  6098   109   0    320
8    0    1   0   593   0   0  128   361  1268   0    945
9    0    1   0   160   0   1   99    32   170   0     30
10   0    0   0    15   0   0   95    63    54   0  12569
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.27384034, 'precision': 0.21866846, 'recall': 0.23881188, 'specificity': 0.9248562, 'f1': 0.19491908, 'auroc': 0.6879102}
confusion matrix:
    0    1   2    3   4   5    6    7    8   9     10
0    0    1   0   18   0   3  827    8  152   0   161
1    0  861   0   25   0   0    6  146   28   0   433
2    0    3   0   48   0   3   93   10  182   0   676
3    0    0   0    0   0   0    0    0    0   0     0
4    0    0   0    0   0   0   11    0    3   0  1619
5    0    0   0  344   0   4   35    4  179   0    26
6    0    0   0    1   0   5  213    2   39   0  2807
7    0   40   0    8   0   0   67  833   77   0   139
8    0    0   0   57   0  15  349   12  358   0   579
9    0    9   1  198   0   5  115   46  449   0   314
10   0    0   0    0   0   0    1    0    0   0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 04:58:18.470085,epoch time: 0:43:54.549643,used: 0:43:54.549643,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_04_14_23_seed_1_24142422
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.39985552, 'precision': 0.190526, 'recall': 0.11520141, 'specificity': 0.9178806, 'f1': 0.08820976, 'auroc': 0.58447945}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0    20   0   0   0    5   1   0    457
1    0   0   0    35   0   0   0   61   0   0   1236
2    0   0   0    16   0   0   0    4   1   0    291
3    0   0   0  1977   0   0   2  246   7   0   6204
4    0   0   0     9   0   0   0    3   0   0    527
5    0   0   0   110   0   0   0    7   2   0    402
6    0   0   0    42   0   0   3   29   1   0   1833
7    0   0   0   277   0   0   0  262   7   0   6717
8    0   0   0   272   0   0   2   48  10   0   2964
9    0   0   0    53   0   0   2    5   1   0    432
10   0   0   0    43   0   0   0   57   0   0  12693
---- Validation: 
scalar performance:
{'acc': 0.4010432, 'precision': 0.18717931, 'recall': 0.115653805, 'specificity': 0.9180429, 'f1': 0.08899455, 'auroc': 0.5903722}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     9   0   0   0    9   0   0    465
1    0   0   0    31   0   0   0   60   0   0   1241
2    0   0   0     8   0   0   0    0   1   0    303
3    0   0   0  1978   0   0   1  253  17   0   6191
4    0   0   0     4   0   0   1    5   0   0    529
5    0   0   0   123   0   0   0    8   1   0    389
6    0   0   0    44   0   0   3   41   0   0   1820
7    0   0   0   262   0   0   3  303   1   0   6696
8    0   0   0   273   0   0   0   53   6   0   2964
9    0   0   0    55   0   0   0    5   1   0    432
10   0   0   0    48   0   0   0   45   0   0  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1153012, 'precision': 0.024472095, 'recall': 0.091065295, 'specificity': 0.9091165, 'f1': 0.019112214, 'auroc': 0.47431687}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   8   0   0   0   1   0   0  1490
2    0   0   0   1   0   0   0   1   0   0  1013
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   5   0   0   587
6    0   0   0   0   0   0   0   2   0   0  3065
7    0   0   0   0   0   0   0   2   0   0  1162
8    0   0   0   0   0   0   0   1   0   0  1369
9    0   0   0   1   0   0   0   1   0   0  1135
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 1
val acc:0.40104320645332336, best validation acc: 0.7828540802001953, corresponding to test acc:                         0.2738403379917145 / 0.2738403379917145
after epoch: 2,now: 2024-08-12 05:41:03.213184,epoch time: 0:42:44.743099,used: 1:26:39.292742,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_04_14_23_seed_1_24142422
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.4178885, 'precision': 0.16939448, 'recall': 0.121720895, 'specificity': 0.92008483, 'f1': 0.09418783, 'auroc': 0.56696045}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     6   0   0   0    2   0   0    475
1    0   0   0    21   0   0   0   45   0   0   1265
2    0   0   0     2   0   0   0    1   0   0    309
3    0   0   0  2848   0   0   0  115   2   0   5473
4    0   0   0     6   0   0   0    0   0   0    533
5    0   0   0   120   0   0   0    2   0   0    399
6    0   0   0    19   0   0   0    3   0   0   1885
7    0   0   0   232   0   0   0   45   0   0   6986
8    0   0   0   238   0   0   0   16   2   0   3040
9    0   0   0    29   0   0   0    4   0   0    460
10   0   0   0    65   0   0   0    4   0   0  12724
---- Validation: 
scalar performance:
{'acc': 0.41669118, 'precision': 0.12187505, 'recall': 0.121175684, 'specificity': 0.91990244, 'f1': 0.09343506, 'auroc': 0.5691571}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     6   0   0   0    1   0   0    476
1    0   0   0    24   0   0   0   42   0   0   1266
2    0   0   0     1   0   0   0    0   0   0    311
3    0   0   0  2811   0   0   0  106   2   0   5521
4    0   0   0     8   0   0   0    2   0   0    529
5    0   0   0    93   0   0   0    3   0   0    425
6    0   0   0    21   0   0   0    3   0   0   1884
7    0   0   0   241   0   0   0   36   2   0   6986
8    0   0   0   240   0   0   0   12   0   0   3044
9    0   0   0    27   0   0   0    3   0   0    463
10   0   0   0    55   0   0   0   10   0   0  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11523123, 'precision': 0.033217028, 'recall': 0.09098719, 'specificity': 0.9091188, 'f1': 0.018964838, 'auroc': 0.42687595}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0  16   0   0   0   2   0   0  1481
2    0   0   0   3   0   0   0   0   0   0  1012
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   2   0   0   0   0   0   0  1631
5    0   0   0   1   0   0   0   0   0   0   591
6    0   0   0   1   0   0   0   1   0   0  3065
7    0   0   0   1   0   0   0   1   0   0  1162
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 2
val acc:0.4166911840438843, best validation acc: 0.7828540802001953, corresponding to test acc:                         0.2738403379917145 / 0.2738403379917145
after epoch: 3,now: 2024-08-12 06:23:22.737469,epoch time: 0:42:19.524285,used: 2:08:58.817027,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_04_14_23_seed_1_24142422
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.41256422, 'precision': 0.12185563, 'recall': 0.11953098, 'specificity': 0.91965306, 'f1': 0.09050637, 'auroc': 0.5567051}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     8   0   0   0    0   0   0    475
1    0   0   0    10   0   0   0    2   0   0   1320
2    0   0   0     9   0   0   0    0   0   0    303
3    0   0   0  2603   0   0   0  134   0   0   5701
4    0   0   0     6   0   0   0    0   0   0    533
5    0   0   0   140   0   0   0    2   0   0    379
6    0   0   0    28   0   0   0    5   0   0   1875
7    0   0   0   492   0   0   0   74   0   0   6699
8    0   0   0   516   0   0   0   30   0   0   2747
9    0   0   0    43   0   0   0    3   0   0    447
10   0   0   0    43   0   0   0    6   0   0  12743
---- Validation: 
scalar performance:
{'acc': 0.41452456, 'precision': 0.21041122, 'recall': 0.12033079, 'specificity': 0.91990006, 'f1': 0.0914792, 'auroc': 0.56145793}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     9   0   0   0    1   0   0    473
1    0   0   0     6   0   0   0    7   0   0   1319
2    0   0   0     9   0   0   0    0   0   0    303
3    0   0   0  2688   0   0   0  129   0   0   5623
4    0   0   0     6   0   0   0    1   0   0    532
5    0   0   0   131   0   0   0    6   0   0    384
6    0   0   0    21   0   0   0    1   0   0   1886
7    0   0   0   481   0   0   0   62   0   0   6722
8    0   0   0   497   0   0   0   38   2   0   2759
9    0   0   0    42   0   0   0    2   0   0    449
10   0   0   0    48   0   0   0    3   0   0  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.010483142, 'recall': 0.09090909, 'specificity': 0.9091033, 'f1': 0.018798538, 'auroc': 0.48744702}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0  12   0   0   0   5   0   0   575
6    0   0   0   1   0   0   0   0   0   0  3066
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   1   0   0  1369
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 3
val acc:0.41452455520629883, best validation acc: 0.7828540802001953, corresponding to test acc:                         0.2738403379917145 / 0.2738403379917145
after epoch: 4,now: 2024-08-12 07:05:36.194039,epoch time: 0:42:13.456570,used: 2:51:12.273597,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_04_14_23_seed_1_24142422
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 2:51:12.273597 at 2024-08-12 07:05:36.194039
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.27384034, 'precision': 0.21866846, 'recall': 0.23881188, 'specificity': 0.9248562, 'f1': 0.19491908, 'auroc': 0.6879102}
confusion matrix:
    0    1   2    3   4   5    6    7    8   9     10
0    0    1   0   18   0   3  827    8  152   0   161
1    0  861   0   25   0   0    6  146   28   0   433
2    0    3   0   48   0   3   93   10  182   0   676
3    0    0   0    0   0   0    0    0    0   0     0
4    0    0   0    0   0   0   11    0    3   0  1619
5    0    0   0  344   0   4   35    4  179   0    26
6    0    0   0    1   0   5  213    2   39   0  2807
7    0   40   0    8   0   0   67  833   77   0   139
8    0    0   0   57   0  15  349   12  358   0   579
9    0    9   1  198   0   5  115   46  449   0   314
10   0    0   0    0   0   0    1    0    0   0  1645
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.27384034, 'precision': 0.21866846, 'recall': 0.23881188, 'specificity': 0.9248562, 'f1': 0.19491908, 'auroc': 0.6879102}
confusion matrix:
    0    1   2    3   4   5    6    7    8   9     10
0    0    1   0   18   0   3  827    8  152   0   161
1    0  861   0   25   0   0    6  146   28   0   433
2    0    3   0   48   0   3   93   10  182   0   676
3    0    0   0    0   0   0    0    0    0   0     0
4    0    0   0    0   0   0   11    0    3   0  1619
5    0    0   0  344   0   4   35    4  179   0    26
6    0    0   0    1   0   5  213    2   39   0  2807
7    0   40   0    8   0   0   67  833   77   0   139
8    0    0   0   57   0  15  349   12  358   0   579
9    0    9   1  198   0   5  115   46  449   0   314
10   0    0   0    0   0   0    1    0    0   0  1645
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_04_14_23_seed_1_24142422_instance_wise_predictions.txt
accuracy from prediction file 0.2738403414258728
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/37.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/37.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1711 MiB |  20456 MiB |    772 TiB |    772 TiB |
|       from large pool |   1517 MiB |  20299 MiB |    770 TiB |    770 TiB |
|       from small pool |    193 MiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1711 MiB |  20456 MiB |    772 TiB |    772 TiB |
|       from large pool |   1517 MiB |  20299 MiB |    770 TiB |    770 TiB |
|       from small pool |    193 MiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  20353 MiB |    769 TiB |    769 TiB |
|       from large pool |   1476 MiB |  20196 MiB |    768 TiB |    768 TiB |
|       from small pool |    192 MiB |    273 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20960 MiB |  20988 MiB |  39692 MiB |  18732 MiB |
|       from large pool |  20684 MiB |  20712 MiB |  39342 MiB |  18658 MiB |
|       from small pool |    276 MiB |    276 MiB |    350 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 498610 KiB |   1192 MiB | 339764 GiB | 339763 GiB |
|       from large pool | 491632 KiB |   1191 MiB | 337964 GiB | 337964 GiB |
|       from small pool |   6978 KiB |     36 MiB |   1799 GiB |   1799 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   55884 K  |   55880 K  |
|       from large pool |     182    |     799    |   24817 K  |   24817 K  |
|       from small pool |    4194    |    6508    |   31066 K  |   31062 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   55884 K  |   55880 K  |
|       from large pool |     182    |     799    |   24817 K  |   24817 K  |
|       from small pool |    4194    |    6508    |   31066 K  |   31062 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     497    |     497    |     830    |     333    |
|       from large pool |     359    |     359    |     655    |     296    |
|       from small pool |     138    |     138    |     175    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    1085    |   25844 K  |   25844 K  |
|       from large pool |      26    |     177    |   13467 K  |   13467 K  |
|       from small pool |      25    |    1059    |   12376 K  |   12376 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  20456 MiB |    772 TiB |    772 TiB |
|       from large pool |  16640 KiB |  20299 MiB |    770 TiB |    770 TiB |
|       from small pool |      0 KiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  20456 MiB |    772 TiB |    772 TiB |
|       from large pool |  16640 KiB |  20299 MiB |    770 TiB |    770 TiB |
|       from small pool |      0 KiB |    274 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  20353 MiB |    769 TiB |    769 TiB |
|       from large pool |  16640 KiB |  20196 MiB |    768 TiB |    768 TiB |
|       from small pool |      0 KiB |    273 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2198 MiB |  20988 MiB |  39692 MiB |  37494 MiB |
|       from large pool |   1998 MiB |  20712 MiB |  39342 MiB |  37344 MiB |
|       from small pool |    200 MiB |    276 MiB |    350 MiB |    150 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1192 MiB | 339765 GiB | 339765 GiB |
|       from large pool |  59136 KiB |   1191 MiB | 337965 GiB | 337965 GiB |
|       from small pool |      0 KiB |     36 MiB |   1799 GiB |   1799 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   55884 K  |   55884 K  |
|       from large pool |       2    |     799    |   24817 K  |   24817 K  |
|       from small pool |       0    |    6508    |   31066 K  |   31066 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   55884 K  |   55884 K  |
|       from large pool |       2    |     799    |   24817 K  |   24817 K  |
|       from small pool |       0    |    6508    |   31066 K  |   31066 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     166    |     497    |     830    |     664    |
|       from large pool |      66    |     359    |     655    |     589    |
|       from small pool |     100    |     138    |     175    |      75    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1085    |   25845 K  |   25845 K  |
|       from large pool |       4    |     177    |   13467 K  |   13467 K  |
|       from small pool |       0    |    1059    |   12377 K  |   12377 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 07:11:54 2024]
Finished job 0.
1 of 1 steps (100%) done
