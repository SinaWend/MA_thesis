Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 12:20:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/19.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=19
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407

 Experiment start at: 2024-08-11 12:30:39.280496
before training, model accuracy: 0.08472679555416107
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.26011345, 'precision': 0.20286417, 'recall': 0.21256897, 'specificity': 0.92683023, 'f1': 0.15711471, 'auroc': 0.7555747}
confusion matrix:
      0    1   2   3   4   5     6     7     8   9   10
0     48    0   0   0   0   0     2    33   399   1   0
1     16  693   0   0   0   0     6   579    38   0   0
2     20    0   0   0   0   0     4    39   249   0   0
3     64    9   0   0   0   0  2911  1134  4319   1   0
4     84    0   0   0   0   0     1    13   440   0   0
5      1    0   0   0   0   0    44     1   474   1   0
6    193    0   0   0   0   0     7    78  1630   0   0
7    139   28   0   0   0   0   187  6103   807   0   0
8    115    2   0   0   0   0    64   245  2869   0   0
9      5    0   0   0   0   0    17    24   445   2   0
10  4468    2   0   0   0   0     5    92  8225   0   0
---- Validation: 
scalar performance:
{'acc': 0.25911462, 'precision': 0.18973696, 'recall': 0.21219257, 'specificity': 0.92672, 'f1': 0.15718886, 'auroc': 0.7544919}
confusion matrix:
      0    1   2   3   4   5     6     7     8   9   10
0     43    0   0   0   0   0     3    38   399   0   0
1     12  706   0   0   0   0     6   576    32   0   0
2     17    0   0   0   0   0     4    44   246   1   0
3     39    5   0   0   0   0  2994  1102  4300   0   0
4     88    1   0   0   0   0     1    15   434   0   0
5      1    0   0   0   0   0    34     2   483   1   0
6    173    0   0   0   0   0     7    68  1659   1   0
7    149   29   0   1   0   0   206  6033   847   0   0
8     97    0   0   0   0   0    64   238  2897   0   0
9      5    1   0   0   0   0    26    24   436   1   0
10  4381    1   0   0   0   0     6   106  8302   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18589519, 'precision': 0.19942962, 'recall': 0.20464605, 'specificity': 0.9181738, 'f1': 0.12707698, 'auroc': 0.61691856}
confusion matrix:
     0    1   2   3   4   5   6    7     8    9   10
0    28    0   0   0   0   0   2   13  1126    1   0
1    86  268   0   0   0   0   3  783   359    0   0
2    26    0   0   0   0   0  25    1   955    8   0
3     0    0   0   0   0   0   0    0     0    0   0
4   160    0   0   0   0   0   1    0  1472    0   0
5     0    0   0   0   0   0  35    1   445  111   0
6   371    0   0   0   0   0  26    4  2660    6   0
7    18   10   0   0   0   0  20  975   141    0   0
8     8    0   0   0   0   0  27    0  1327    8   0
9    12    1   0   0   0   0  47   11  1033   33   0
10  203    0   0   0   0   0   1    0  1442    0   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 13:03:13.812632,epoch time: 0:32:34.532136,used: 0:32:34.532136,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.29296875, 'precision': 0.23989606, 'recall': 0.26085216, 'specificity': 0.9310049, 'f1': 0.20225856, 'auroc': 0.82536936}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     35     1   0   1   0   0    72    33   339   2   0
1      6  1137   0   0   0   0    10   157    22   0   0
2      1     0   0   0   0   0    59    44   206   2   0
3      7    14   0   2   0   0  5736   988  1688   2   0
4     40     0   0   0   0   0     5    15   479   0   0
5      1     1   0   1   0   0   217     0   278  23   0
6    102     3   0   0   0   0   123    68  1609   3   0
7     41    43   0   2   0   0   157  6642   378   0   0
8     18     4   0   0   0   0   115   175  2982   0   0
9      1     0   0   4   0   0   171    21   267  29   0
10  6409    25   0   0   0   0     8    71  6281   0   0
---- Validation: 
scalar performance:
{'acc': 0.2933262, 'precision': 0.2615831, 'recall': 0.2604183, 'specificity': 0.9310319, 'f1': 0.20114233, 'auroc': 0.82660264}
confusion matrix:
      0     1   2   3   4   5     6     7     8   9   10
0     39     1   0   0   0   0    79    29   334   1   0
1     11  1138   0   0   0   0    11   156    16   0   0
2      4     0   0   0   0   0    47    48   211   2   0
3     13    10   0   4   0   0  5753   958  1702   0   0
4     44     0   0   0   0   0    12     9   474   0   0
5      0     2   0   0   0   0   204     0   291  24   0
6    101     3   0   1   0   0   116    73  1613   1   0
7     45    35   0   1   0   0   178  6677   329   0   0
8     22     5   0   0   0   0   121   180  2968   0   0
9      1     0   0   3   0   0   165    21   279  24   0
10  6285    26   0   0   0   0     6    67  6412   0   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.25935772, 'precision': 0.22653113, 'recall': 0.23974934, 'specificity': 0.9243157, 'f1': 0.204873, 'auroc': 0.6855177}
confusion matrix:
     0     1   2   3   4   5    6    7     8    9   10
0     3     0   0   0   0   0   82   12  1069    4   0
1    62  1056   0   1   0   0   37  157   186    0   0
2     1     0   0   2   0   0  234    4   717   57   0
3     0     0   0   0   0   0    0    0     0    0   0
4   238     0   0   0   0   0   18    0  1376    1   0
5     0     0   0   1   0   0  216    0   110  265   0
6    52     2   0   0   0   0  380    2  2606   25   0
7     6    45   0   1   0   0   86  921   105    0   0
8     0     0   0   1   0   0  186    0  1134   49   0
9     3     6   0   4   0   0  457    6   448  213   0
10  705     0   0   0   0   0    3    0   938    0   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 13:34:36.046718,epoch time: 0:31:22.234086,used: 1:03:56.766222,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.33628532, 'precision': 0.26842368, 'recall': 0.3692888, 'specificity': 0.93560696, 'f1': 0.25877228, 'auroc': 0.874608}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0    154     3   0   20   0   0   160    27   107   12   0
1      9  1154   0    4   0   0     6   142    15    0   0
2     13     0   0   19   1   0   117    40    82   40   0
3      4    16   0  147   0   0  6550   644  1041   37   0
4     71     0   0    4   0   0    89     8   359    8   0
5      1     1   0   58   0   0   201     1    64  195   0
6    137     5   0    6   0   0  1321    37   392    9   0
7     46    45   0   34   0   0   175  6665   299    0   0
8     14     4   0   21   0   0   141   140  2955   19   0
9      9     0   0   54   0   0   166    19    72  173   0
10  6534    22   0    1   0   0   111    61  6060    5   0
---- Validation: 
scalar performance:
{'acc': 0.33553565, 'precision': 0.26639867, 'recall': 0.36706534, 'specificity': 0.93549967, 'f1': 0.25805053, 'auroc': 0.87397265}
confusion matrix:
      0     1   2    3   4   5     6     7     8    9   10
0    151     3   0   41   0   0   149    24    98   17   0
1      9  1162   0    3   0   0     6   139    13    0   0
2     10     0   0   18   0   0   123    47    86   28   0
3      9    14   0  141   0   0  6609   645   985   37   0
4     70     0   0    2   0   0    85    14   361    7   0
5      3     1   0   62   0   0   191     1    68  195   0
6    131     4   0    6   0   0  1297    48   409   13   0
7     46    37   0   30   0   0   179  6665   308    0   0
8     19     2   0   11   0   0   151   137  2960   16   0
9      3     1   0   63   0   0   166    12    80  168   0
10  6396    25   0    0   0   0   122    47  6205    1   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3886518, 'precision': 0.26688707, 'recall': 0.2846899, 'specificity': 0.93589306, 'f1': 0.25236803, 'auroc': 0.73431313}
confusion matrix:
     0     1   2   3   4   5     6    7    8    9   10
0    42     0   0   9   0   0   748    0  329   42   0
1    87  1073   0  32   0   0   110   61  128    8   0
2     6     0   0  10   0   0   594    0  298  107   0
3     0     0   0   0   0   0     0    0    0    0   0
4   434     0   0   0   0   0   254    0  944    1   0
5     1     0   0  17   0   0   117    0   16  441   0
6    60     0   0   1   0   0  2478    0  512   16   0
7    26    95   0  99   0   0   245  501  188   10   0
8     0     0   0   5   0   0   295    0  959  111   0
9    12     3   0  41   0   0   459    0  120  502   0
10  987     0   0   0   0   0    43    0  616    0   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 14:05:54.349006,epoch time: 0:31:18.302288,used: 1:35:15.068510,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.42511237, 'precision': 0.32261634, 'recall': 0.4640355, 'specificity': 0.944188, 'f1': 0.3323438, 'auroc': 0.9163492}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    313     2   0    47   0   0    48    18    36   18   0
1      6  1162   0    12   0   0     3   130    18    0   0
2     12     0   0    59   0   0    63    23    76   78   1
3     14    12   0  3062   0   0  4383   368   531   68   0
4     91     1   0    13   0   0    54    11   349   20   0
5      1     2   0   155   0   0    38     1    18  306   0
6    119     3   0    53   0   0  1535    32   147   19   0
7     47    25   0   324   0   0    72  6608   186    2   0
8     21     5   0   163   0   0    73    99  2901   34   0
9     12     0   0    98   0   0    35     8    32  308   0
10  7468    23   0    14   0   0    82    60  5137    8   0
---- Validation: 
scalar performance:
{'acc': 0.4236726, 'precision': 0.32236168, 'recall': 0.45937434, 'specificity': 0.9440435, 'f1': 0.3320879, 'auroc': 0.9156398}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    294     3   0    45   0   0    66    12    42   21   0
1      9  1155   0    19   0   0     2   129    17    1   0
2     14     2   0    56   0   0    55    24    71   90   0
3     14    14   0  3084   0   0  4366   376   531   55   0
4     86     1   0    11   0   0    64    10   347   18   2
5      0     1   0   155   0   0    47     0    23  295   0
6    146     4   0    40   0   0  1519    37   143   19   0
7     42    22   0   363   0   0    60  6566   212    0   0
8     21     3   0   178   0   0    49   103  2911   31   0
9     10     1   0    95   0   0    29     6    42  310   0
10  7579    26   0    13   0   0    83    61  5027    7   0
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3962779, 'precision': 0.28945082, 'recall': 0.2975033, 'specificity': 0.9382135, 'f1': 0.25960773, 'auroc': 0.7444642}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9   10
0   219     0   0   72   0   0   609    0   218   52   0
1    66  1068   0   77   0   0   105   53   127    3   0
2    18     0   0   39   0   0   357    0   448  153   0
3     0     0   0    0   0   0     0    0     0    0   0
4   328     0   0    1   0   0   103    0  1197    4   0
5     3     0   0   73   0   0    40    0    11  465   0
6   172     0   0   24   0   0  2356    0   495   20   0
7    21    34   0  378   0   0   192  294   236    9   0
8     0     0   0   16   0   0   117    0  1115  122   0
9    38     3   0  111   0   0   216    0   157  612   0
10  595     0   0    1   0   0     8    0  1042    0   0
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 14:37:09.744505,epoch time: 0:31:15.395499,used: 2:06:30.464009,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.54898864, 'precision': 0.5114866, 'recall': 0.5288876, 'specificity': 0.95611894, 'f1': 0.41679808, 'auroc': 0.9393655}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    363     1   0    23   0   0    29    24    35    8   0
1      8  1196   0    13   0   0     1   103    11    0   0
2     22    13   0    25   1   1    32    46    98   74   0
3      8     9   0  7299   0   2   176   576   310   58   0
4     80     2   0    12   1   1    26    22   367   22   6
5      4     1   0   163   0   9     1     0    13  330   0
6    103     6   0    42   0   0  1579    30   116   30   0
7     30    33   0   217   0   0     4  6874   105    0   0
8     11     2   0   194   0   0     8   178  2881   22   0
9     22     4   0    72   0   1    14    19    48  313   0
10  7969    20   0    13   1   0    66    98  4613    9   4
---- Validation: 
scalar performance:
{'acc': 0.5478668, 'precision': 0.582664, 'recall': 0.5283803, 'specificity': 0.9560015, 'f1': 0.4176316, 'auroc': 0.9382943}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    361     2   0    27   0   0    37    19    26   11   0
1     10  1200   0    11   0   0     0   100    11    0   0
2     19    13   0    25   0   1    40    52    84   76   2
3      4     6   0  7266   0   1   172   597   342   52   0
4     76     0   0     9   3   0    36    29   357   21   8
5      5     1   0   150   0  12     2     0    20  331   0
6     97     1   0    50   0   0  1572    36   131   20   1
7     31    39   0   206   0   0     5  6881   103    0   0
8     12     4   0   202   0   0     6   182  2867   23   0
9     18     7   0    83   0   2    14    18    39  312   0
10  8008    18   0    16   0   0    71    73  4590   12   8
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43601763, 'precision': 0.36945945, 'recall': 0.34609917, 'specificity': 0.9428608, 'f1': 0.28960013, 'auroc': 0.7746076}
confusion matrix:
     0     1   2   3   4   5     6    7     8    9   10
0   667     0   0  13   0   0   256    0   213   21   0
1    61  1249   0  21   0   0    48   31    88    1   0
2   111     2   0  13   0   0   156    1   584  148   0
3     0     0   0   0   0   0     0    0     0    0   0
4   309     2   0   0   0   0    28    0  1289    3   2
5    52     0   0  44   0   0     5    0    22  469   0
6   349     1   0  17   0   0  2165    0   508   27   0
7    22   267   0  81   0   0   206  332   255    1   0
8     8     0   0   9   0   0    16    0  1244   93   0
9   155    11   0  36   1   0    81    0   282  571   0
10  595     0   0   1   0   0     1    0  1044    1   4
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 15:08:31.318618,epoch time: 0:31:21.574113,used: 2:37:52.038122,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.55308217, 'precision': 0.54685277, 'recall': 0.5529067, 'specificity': 0.9564558, 'f1': 0.4389655, 'auroc': 0.95415777}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    404     0   0    11   0   0    25    15    22    5   1
1     11  1215   0    10   0   0     0    84    11    0   0
2     35    24   0    20   4   2    47    22    89   67   2
3     15     4   0  7108   0   6   117   489   635   64   0
4     78     2   0     6   3   0    39    15   360   14  22
5     17     1   0   100   1  64     1     0    29  308   0
6    106     2   0    15   0   0  1664    16    89   12   4
7     53    44   0   165   0   0     9  6836   154    0   2
8     26     1   0   100   0   0     7   108  3035   17   1
9     45     6   0    39   1   5    38     9    42  308   0
10  6493     4   0     8   0   0    42    34  6172    5  35
---- Validation: 
scalar performance:
{'acc': 0.553484, 'precision': 0.54944247, 'recall': 0.5534929, 'specificity': 0.95646787, 'f1': 0.44002897, 'auroc': 0.9529418}
confusion matrix:
      0     1   2     3   4   5     6     7     8    9   10
0    399     1   0    10   0   0    31    12    25    4   1
1     10  1214   0     9   0   0     1    82    16    0   0
2     40    18   0    23   3   1    57    24    76   65   5
3     12     5   0  7143   0   7    86   490   630   67   0
4     73     2   0     3   2   0    49    11   364   11  24
5     13     1   0    98   0  64     3     0    25  317   0
6    123     1   0    15   0   0  1665    17    74   13   0
7     47    36   0   176   0   0     3  6827   173    0   3
8     31     3   0    99   0   0     3   127  3017   14   2
9     43     9   0    38   1   6    24    10    43  319   0
10  6423     6   0    11   0   0    43    33  6233    5  42
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36185545, 'precision': 0.37372923, 'recall': 0.2871967, 'specificity': 0.9347844, 'f1': 0.22270294, 'auroc': 0.7445405}
confusion matrix:
     0     1   2   3   4   5     6    7     8    9   10
0   649     0   0   0   0   0   373    0   147    1   0
1    51  1278   0   7   0   0    47   17    98    0   1
2   193     2   0   2   1   0   167    1   611   36   2
3     0     0   0   0   0   0     0    0     0    0   0
4   242     2   0   0   0   0    17    0  1348    0  24
5   139     0   0  22   0   1    44    0    69  317   0
6   804     2   0   2   0   0  1637    0   615    2   5
7    14   375   0  34   0   0   396  127   218    0   0
8    17     0   0   0   0   0    36    0  1290   27   0
9   300    13   0  12   0   0   187    0   440  185   0
10  333     1   0   1   0   0     0    0  1306    0   5
better model found
persisted
after epoch: 6,now: 2024-08-11 15:39:53.140409,epoch time: 0:31:21.821791,used: 3:09:13.859913,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7325289, 'precision': 0.66246223, 'recall': 0.6184518, 'specificity': 0.9737523, 'f1': 0.5622515, 'auroc': 0.9591453}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9     10
0    409     0   0    18   0    0     9    25    11    4     7
1      4  1208   0    15   0    0     0    96     8    0     0
2     33    16   0    56   4    1    40    36    34   90     2
3      5     3   0  7747   0   12     4   449   193   26     0
4     60     2   0    15  10    0    57    41   197   24   133
5      9     1   0   142   0  180     1     1     8  179     0
6     95     2   0    50   0    0  1669    25    47   11     8
7     17    22   0   181   0    0     3  6968    69    0     4
8     16     2   0   235   0    1     7   175  2819   11    28
9     30     7   0    82   0   38    13    11    15  296     0
10  5673     4   0    18   0    0    27    65   927    7  6073
---- Validation: 
scalar performance:
{'acc': 0.73085463, 'precision': 0.66900516, 'recall': 0.6225207, 'specificity': 0.97360885, 'f1': 0.56350565, 'auroc': 0.9592763}
confusion matrix:
      0     1   2     3   4    5     6     7     8    9     10
0    420     1   0    13   0    0     5    19    12    6     7
1      6  1210   0    16   0    0     0    98     1    0     1
2     28    18   0    56   2    1    37    39    34   95     2
3      4     4   0  7743   0   11     6   459   191   22     0
4     67     4   0    15   9    2    44    40   206   29   123
5     11     0   0   132   1  181     0     0     9  187     0
6    100     3   0    57   0    0  1661    18    46   14     9
7     24    18   0   192   0    0     3  6947    75    1     5
8     12     2   0   245   0    0     5   165  2840    7    20
9     33     8   0    70   0   32     4    18    17  311     0
10  5735     6   0    28   0    0    21    73   921   11  6001
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.45714685, 'precision': 0.44571418, 'recall': 0.36955312, 'specificity': 0.94451505, 'f1': 0.31295237, 'auroc': 0.7635667}
confusion matrix:
     0     1   2    3   4   5     6    7     8    9     10
0   715     2   0    4   0   0   310    0   139    0     0
1    46  1287   0   23   0   0    46   27    59    0    11
2   169     4   0   15   1   0   170    2   577   47    30
3     0     0   0    0   0   0     0    0     0    0     0
4   133     2   0    0   1   0    20    1   612    0   864
5    93     0   0  120   0  12    22    0    42  303     0
6   694     2   0   10   3   0  1570    0   611    3   174
7     5   356   0   96   0   0   342  180   185    0     0
8    14     0   0    9   0   0    18    0  1302   27     0
9   236    14   0   79   2   0   177    0   382  244     3
10  239     1   0    1   0   0     0    0   181    1  1223
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-11 16:10:50.550275,epoch time: 0:30:57.409866,used: 3:40:11.269779,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8928992, 'precision': 0.6996249, 'recall': 0.68311876, 'specificity': 0.9887208, 'f1': 0.6577514, 'auroc': 0.9655328}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   411     1   0    11   0    0     7    12     7    1     33
1     3  1238   0    14   0    0     0    68     6    0      3
2    23    14   0    52   9    5    49    28    46   76     10
3     5     4   0  7718   0   40    20   297   345    6      1
4    31     0   0     9  28    6    30    44   229   11    151
5     8     0   0    91   2  315     1     0    13   90      1
6    68     1   0    16   0    3  1696    11    64    6     43
7    19    37   0   229   0    0     2  6826   135    0     15
8     9     2   0   147   0    4     8   103  2976    4     42
9    40     4   0    56   1   93    22     6    23  246      2
10  417     9   0    11   1    1    14    45   375    2  11919
---- Validation: 
scalar performance:
{'acc': 0.89239, 'precision': 0.6971789, 'recall': 0.6797073, 'specificity': 0.98868304, 'f1': 0.65267634, 'auroc': 0.9663928}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   404     2   0    14   0    0    12     9     5    3     34
1     2  1237   0    13   0    0     0    69     9    0      2
2    26    16   0    49   5    4    52    31    53   70      6
3     8     5   0  7732   0   47    19   290   322   14      3
4    30     3   0     7  27    4    27    64   196   22    159
5     9     0   0    94   3  310     3     0    11   90      1
6    79     3   0    22   0    1  1706    11    47    8     31
7    25    44   0   241   0    0     6  6810   122    0     17
8    11     1   0   146   0    4     4   103  2983   11     33
9    39     2   0    66   2  101    21     8    16  238      0
10  420    10   0    10   0    2    20    44   372    3  11915
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49023998, 'precision': 0.4623812, 'recall': 0.40613294, 'specificity': 0.94743776, 'f1': 0.347265, 'auroc': 0.7536786}
confusion matrix:
     0     1   2   3   4   5     6    7     8    9     10
0   863     0   0   4   0   0   226    0    77    0     0
1    34  1270   0  18   0   0    76    9    66    0    26
2   150     3   0  10  17   1   143    2   592   38    59
3     0     0   0   0   0   0     0    0     0    0     0
4    23     0   0   0   6   0    15    1   445    0  1143
5   119     0   0  88   0  96    32    0    32  225     0
6   436     1   0   1   3   0  1540    0   670    3   413
7     5   253   0  92   0   0   544  112   157    0     1
8    22     0   0   6   1   0    18    0  1286   36     1
9   286    10   0  43  12   6   230    0   305  241     4
10    3     1   0   1   1   0     0    0    47    0  1593
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-11 16:42:05.606142,epoch time: 0:31:15.055867,used: 4:11:26.325646,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9054741, 'precision': 0.7262831, 'recall': 0.6857196, 'specificity': 0.98970807, 'f1': 0.6743983, 'auroc': 0.9672895}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   397     1   0    13   0    0     8    14     4    2     44
1     1  1238   0    14   0    0     0    70     6    0      2
2    19    20   0    66   4    5    48    51    32   59      8
3     8     2   0  7727   0   43    13   448   192    3      2
4    22     2   0    12  23   13    22    86   159   17    183
5     2     3   0    85   2  334     2     1     9   83      0
6    40     1   0    36   0    2  1710    16    38    6     59
7     8    30   0   153   0    0     3  7000    52    0     17
8     7     6   0   187   0    2    10   153  2852    4     73
9    19     8   0    77   1   95    20    13    12  248      0
10  215     4   0     9   1    2    16    70   161    2  12314
---- Validation: 
scalar performance:
{'acc': 0.9041594, 'precision': 0.72072625, 'recall': 0.68596435, 'specificity': 0.9895674, 'f1': 0.6724301, 'auroc': 0.9668745}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   387     0   0     9   0    0     9    17     3    1     57
1     3  1238   0    16   0    0     0    67     4    0      4
2    16    21   0    71   6    5    54    43    26   61      9
3    12     3   0  7696   0   48    14   453   203    9      2
4    17     1   0    16  21    6    28    80   159   21    190
5     8     0   0    61   1  349     0     0     6   95      1
6    41     0   0    23   0    2  1730    15    36    8     53
7    11    23   0   160   0    0     3  6981    69    0     18
8     2     3   0   190   1    3     4   166  2839    5     83
9    35     7   0    60   0  108     9    11    15  248      0
10  204     2   0    14   0    0    20    75   164    4  12313
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49401805, 'precision': 0.44749337, 'recall': 0.4176783, 'specificity': 0.947943, 'f1': 0.36943167, 'auroc': 0.76221573}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   832     1   0    6   0    0   296    0    33    1     1
1    31  1297   0   29   0    0    43   33    33    0    33
2   161     9   0   10  13    2   172    5   456   38   149
3     0     0   0    0   0    0     0    0     0    0     0
4    13     0   0    0   0    0    10    1   148    0  1461
5   106     0   0   87   1  121    37    0    21  219     0
6   376     2   0   10   3    0  1410    1   455    4   806
7    11   273   0  241   0    0   310  249    78    0     2
8    29     0   0   12   0    0    38    0  1246   34    11
9   270    24   0   75   4    9   268    0   214  267     6
10    1     1   0    1   0    0     0    0     4    0  1639
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-11 17:13:21.198769,epoch time: 0:31:15.592627,used: 4:42:41.918273,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9063035, 'precision': 0.7414982, 'recall': 0.67808694, 'specificity': 0.98976076, 'f1': 0.68077505, 'auroc': 0.97173834}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   371     0   0    22   1    0     7    14    10    4     54
1     2  1218   0    23   0    0     0    80     5    0      4
2     6    14   0    93   7    5    31    36    43   72      5
3     2     2   0  8022   0   18     1   239   146    5      0
4    11     0   0    32  35   14     8    64   203   18    154
5     2     0   0   113   0  323     0     1     7   75      0
6    36     1   0    84   0    1  1651    18    66    9     42
7     2    15   0   266   0    0     1  6874    90    1     13
8     1     1   0   263   0    3     2   102  2889    2     33
9    14     2   0    99   1  101     4     2    23  244      3
10  121     9   0    29   1    0     5    62   315    6  12247
---- Validation: 
scalar performance:
{'acc': 0.90726227, 'precision': 0.7477651, 'recall': 0.68285644, 'specificity': 0.9899006, 'f1': 0.68260896, 'auroc': 0.971014}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   380     0   0    22   0    2     8    11    10    4     46
1     1  1223   0    20   0    0     0    77     5    0      6
2    10     7   0   110   4    2    25    31    47   72      4
3     2     4   0  8028   0   21     0   247   137    0      1
4     9     1   0    23  34   13     9    65   225   21    139
5     2     0   0   100   0  332     1     0    10   76      0
6    48     2   0    82   0    2  1645    14    69    4     42
7     6    15   0   252   0    0     1  6871   103    1     16
8     1     3   0   239   0    5     0   108  2902    2     36
9    13     3   0    91   0  103     8     4    19  251      1
10  128     8   0    29   2    1     5    71   294    6  12252
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47016022, 'precision': 0.5046494, 'recall': 0.3936524, 'specificity': 0.9463854, 'f1': 0.3585179, 'auroc': 0.75468576}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   598     0   0   25   0    0   306    0   236    1     4
1    22  1242   0   46   0    0    47   22    83    0    37
2    53     3   0   34   5    2    63    2   715   62    76
3     0     0   0    0   0    0     0    0     0    0     0
4     3     0   0    0   6    2    10    2   289    0  1321
5    22     0   0  208   0  117     9    0    47  189     0
6   101     0   0   33   2    4  1355    0   998    7   567
7     1   139   0  463   0    0   199  148   212    0     2
8     1     0   0   30   0    0     2    0  1326   10     1
9    79     8   0  154   3   12    82    1   494  298     6
10    0     0   0    1   1    0     1    0    13    0  1630
better model found
persisted
after epoch: 10,now: 2024-08-11 17:44:30.957197,epoch time: 0:31:09.758428,used: 5:13:51.676701,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:13:51.676701 at 2024-08-11 17:44:30.957197
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47016022, 'precision': 0.5046494, 'recall': 0.3936524, 'specificity': 0.9463854, 'f1': 0.3585179, 'auroc': 0.75468576}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   598     0   0   25   0    0   306    0   236    1     4
1    22  1242   0   46   0    0    47   22    83    0    37
2    53     3   0   34   5    2    63    2   715   62    76
3     0     0   0    0   0    0     0    0     0    0     0
4     3     0   0    0   6    2    10    2   289    0  1321
5    22     0   0  208   0  117     9    0    47  189     0
6   101     0   0   33   2    4  1355    0   998    7   567
7     1   139   0  463   0    0   199  148   212    0     2
8     1     0   0   30   0    0     2    0  1326   10     1
9    79     8   0  154   3   12    82    1   494  298     6
10    0     0   0    1   1    0     1    0    13    0  1630
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49401805, 'precision': 0.44749337, 'recall': 0.4176783, 'specificity': 0.947943, 'f1': 0.36943167, 'auroc': 0.76221573}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   832     1   0    6   0    0   296    0    33    1     1
1    31  1297   0   29   0    0    43   33    33    0    33
2   161     9   0   10  13    2   172    5   456   38   149
3     0     0   0    0   0    0     0    0     0    0     0
4    13     0   0    0   0    0    10    1   148    0  1461
5   106     0   0   87   1  121    37    0    21  219     0
6   376     2   0   10   3    0  1410    1   455    4   806
7    11   273   0  241   0    0   310  249    78    0     2
8    29     0   0   12   0    0    38    0  1246   34    11
9   270    24   0   75   4    9   268    0   214  267     6
10    1     1   0    1   0    0     0    0     4    0  1639
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142407_instance_wise_predictions.txt
accuracy from prediction file 0.47016021828867277
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/19.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494945 KiB |  10947 MiB | 344774 GiB | 344773 GiB |
|       from large pool | 404224 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |  90721 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 494945 KiB |  10947 MiB | 344774 GiB | 344773 GiB |
|       from large pool | 404224 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |  90721 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478101 KiB |  10882 MiB | 343021 GiB | 343021 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 342304 GiB | 342304 GiB |
|       from small pool |  90261 KiB |    126 MiB |    716 GiB |    716 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11432 MiB |  11432 MiB |  11432 MiB |      0 B   |
|       from large pool |  11304 MiB |  11304 MiB |  11304 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1014 MiB |   1360 MiB | 137195 GiB | 137194 GiB |
|       from large pool |   1005 MiB |   1356 MiB | 136422 GiB | 136421 GiB |
|       from small pool |      9 MiB |     13 MiB |    772 GiB |    772 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3023    |    4666    |   27571 K  |   27568 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2936    |    4544    |   15516 K  |   15513 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3023    |    4666    |   27571 K  |   27568 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2936    |    4544    |   15516 K  |   15513 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     294    |     294    |     294    |       0    |
|       from large pool |     230    |     230    |     230    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    1141    |   13992 K  |   13992 K  |
|       from large pool |      18    |     121    |    6564 K  |    6564 K  |
|       from small pool |      33    |    1121    |    7427 K  |    7427 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10947 MiB | 344774 GiB | 344774 GiB |
|       from large pool |  16640 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |      0 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10947 MiB | 344774 GiB | 344774 GiB |
|       from large pool |  16640 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |      0 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 343021 GiB | 343021 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342304 GiB | 342304 GiB |
|       from small pool |      0 KiB |    126 MiB |    716 GiB |    716 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1498 MiB |  11432 MiB |  11432 MiB |   9934 MiB |
|       from large pool |   1400 MiB |  11304 MiB |  11304 MiB |   9904 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1360 MiB | 137195 GiB | 137195 GiB |
|       from large pool |  59136 KiB |   1356 MiB | 136423 GiB | 136423 GiB |
|       from small pool |      0 KiB |     33 MiB |    772 GiB |    772 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4666    |   27571 K  |   27571 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4544    |   15516 K  |   15516 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4666    |   27571 K  |   27571 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4544    |   15516 K  |   15516 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     294    |     294    |     214    |
|       from large pool |      31    |     230    |     230    |     199    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1141    |   13993 K  |   13993 K  |
|       from large pool |       3    |     121    |    6564 K  |    6564 K  |
|       from small pool |       0    |    1121    |    7428 K  |    7428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10947 MiB | 344774 GiB | 344774 GiB |
|       from large pool |  16640 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |      0 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10947 MiB | 344774 GiB | 344774 GiB |
|       from large pool |  16640 KiB |  10875 MiB | 344054 GiB | 344054 GiB |
|       from small pool |      0 KiB |    127 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 343021 GiB | 343021 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342304 GiB | 342304 GiB |
|       from small pool |      0 KiB |    126 MiB |    716 GiB |    716 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1498 MiB |  11432 MiB |  11432 MiB |   9934 MiB |
|       from large pool |   1400 MiB |  11304 MiB |  11304 MiB |   9904 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1360 MiB | 137195 GiB | 137195 GiB |
|       from large pool |  59136 KiB |   1356 MiB | 136423 GiB | 136423 GiB |
|       from small pool |      0 KiB |     33 MiB |    772 GiB |    772 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4666    |   27571 K  |   27571 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4544    |   15516 K  |   15516 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4666    |   27571 K  |   27571 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4544    |   15516 K  |   15516 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     294    |     294    |     214    |
|       from large pool |      31    |     230    |     230    |     199    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1141    |   13993 K  |   13993 K  |
|       from large pool |       3    |     121    |    6564 K  |    6564 K  |
|       from small pool |       0    |    1121    |    7428 K  |    7428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407

 Experiment start at: 2024-08-11 17:59:36.636009
before training, model accuracy: 0.10193801671266556
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7269906, 'precision': 0.3363578, 'recall': 0.32395554, 'specificity': 0.9676049, 'f1': 0.29540622, 'auroc': 0.85462695}
confusion matrix:
    0     1    2     3   4   5   6     7   8   9      10
0    0    13   37   195   0   0   0   104   3   4    127
1    0  1015    0    18   0   0   0   257   0   0     42
2    0     5   22   100   0   0   0   119   1   1     64
3    0     2    4  7627   0   0   0   800   0   0      6
4    0    17   27   103   0   0   0    70   1   0    321
5    0     1    7   493   0   0   0    17   1   0      2
6    0    49  149   416   0   0   0   220   3   3   1066
7    0    67    1   868   0   0   0  6270   0   0     58
8    0    31  171  1935   0   0   0   703  15   2    439
9    0     6    9   348   0   0   0   113   1   2     14
10   0   117   76   197   0   0   0   177   2   1  12221
---- Validation: 
scalar performance:
{'acc': 0.7275645, 'precision': 0.37030458, 'recall': 0.32398236, 'specificity': 0.9676647, 'f1': 0.29604027, 'auroc': 0.8578577}
confusion matrix:
    0     1    2     3   4   5   6     7   8   9      10
0    0     9   44   208   0   0   0   112   0   3    107
1    0  1017    0    17   0   0   0   256   0   0     42
2    0     8   20    94   0   0   1   128   0   1     60
3    0     3    3  7608   0   0   0   822   1   0      3
4    0    12   23    89   0   0   1    81   0   0    333
5    0     3   10   490   0   0   0    14   0   0      4
6    0    51  141   444   0   0   1   209   7   2   1053
7    0    59    1   859   0   0   0  6292   1   0     53
8    0    27  159  1929   0   0   2   695  18   1    465
9    0     6   10   360   0   0   0   105   3   3      6
10   0   122   71   179   0   0   0   182   1   0  12241
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.24942279, 'precision': 0.21557575, 'recall': 0.22883232, 'specificity': 0.9256444, 'f1': 0.1673111, 'auroc': 0.66566676}
confusion matrix:
    0    1    2    3   4   5   6    7   8   9     10
0    0    8  234  325   0   0   0  162   1   1   439
1    0  778    9   47   0   0   0  219   1   0   445
2    0    6  144  377   0   0   0   79   0   0   409
3    0    0    0    0   0   0   0    0   0   0     0
4    0    1    8    4   0   0   0    3   0   0  1617
5    0    1   13  563   0   0   0   10   0   0     5
6    0    7  145   99   0   0   0   23   0   1  2792
7    0   20   21   21   0   0   1  995   0   0   106
8    0    1  194  565   0   0   0  125   2   0   483
9    0    3  100  777   0   0   0  169   0   0    88
10   0    0    0    0   0   0   0    0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 18:32:24.056369,epoch time: 0:32:47.420360,used: 0:32:47.420360,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7894638, 'precision': 0.32949853, 'recall': 0.3781625, 'specificity': 0.97596437, 'f1': 0.3503595, 'auroc': 0.9020791}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0    44   1   109   0   0   0    35   222   0     71
1    0  1125   0    19   0   0   0   168     4   0     16
2    0    37   5    42   0   0   0    60   136   0     32
3    0     3   0  7835   0   0   0   531    65   0      3
4    0    35  17    36   0   0   0    23   125   0    303
5    0     1   0   381   0   0   0     2   134   0      3
6    0   368  23   170   0   0   0    68   570   0    709
7    0    72   1   538   0   0   0  6540    46   0     67
8    0    64  44  1067   0   0   0   221  1668   0    232
9    0    12   0   225   0   0   0    42   212   0      1
10   0   115  34    93   0   0   0    71   145   1  12334
---- Validation: 
scalar performance:
{'acc': 0.78860503, 'precision': 0.419335, 'recall': 0.3770713, 'specificity': 0.9758663, 'f1': 0.34960002, 'auroc': 0.90352666}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0    53   1   100   0   0   0    33   228   0     68
1    0  1128   0    23   0   0   0   162     2   0     17
2    0    27   4    44   0   0   0    59   144   0     34
3    0     2   0  7842   0   0   0   529    65   0      2
4    0    45  15    29   0   0   0    19   134   0    297
5    0     0   0   389   0   0   0     2   129   0      1
6    0   353  14   172   0   0   1    74   575   0    719
7    0    61   3   570   0   0   0  6529    39   0     63
8    0    62  64  1063   0   1   0   242  1631   0    233
9    0     6   4   216   0   0   0    51   214   0      2
10   0   112  24    74   0   0   0    81   158   0  12347
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32967186, 'precision': 0.23135908, 'recall': 0.3023041, 'specificity': 0.9335814, 'f1': 0.24126936, 'auroc': 0.7026759}
confusion matrix:
    0     1    2    3   4   5   6    7    8   9     10
0    0    59   71  484   0   0   1   23  455   0    77
1    0  1077    5   66   0   1   0  129   25   0   196
2    0    15  118  273   0   0   0   11  282   0   316
3    0     0    0    0   0   0   0    0    0   0     0
4    0     0    5    4   0   0   0    0    8   0  1616
5    0     0    4  491   0   0   0    0   95   0     2
6    0    52  236   77   0   0   0    3  196   0  2503
7    0    26    2   82   0   0   0  967   43   0    44
8    0     8   67  291   0   0   0    1  904   0    99
9    0    17   40  669   0   0   0   24  346   0    41
10   0     0    0    0   0   0   0    0    0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 19:03:47.640264,epoch time: 0:31:23.583895,used: 1:04:11.004255,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8101991, 'precision': 0.45642477, 'recall': 0.40012273, 'specificity': 0.9792176, 'f1': 0.35681322, 'auroc': 0.9190528}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    1   132   0    40   0   0   3    41   208   0     58
1    0  1132   0    24   0   0   0   163     3   0     10
2    0    89   2     9   0   0   1    60   125   0     26
3    0     8   0  7634   0   0   0   573   223   0      2
4    0    80   5     6   0   0   0    21   136   0    291
5    0    13   1   235   0   0   0     7   262   0      2
6    0   828   2    40   0   0   3    74   491   0    469
7    0    77   0   333   0   0   0  6737    73   0     43
8    0    80   5   367   0   0   1   241  2461   0    140
9    0    53   0   102   0   0   0    40   296   0      2
10   0   202   8    26   0   0   1    78   165   0  12312
---- Validation: 
scalar performance:
{'acc': 0.81013775, 'precision': 0.5626383, 'recall': 0.4003266, 'specificity': 0.97919565, 'f1': 0.35720843, 'auroc': 0.918782}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    2   150   0    29   0   0   1    32   214   0     55
1    0  1136   0    21   0   0   0   162     5   0      8
2    0    88   2     7   0   0   0    60   132   0     23
3    0     8   0  7649   0   0   0   558   224   0      1
4    0    85   5     8   0   0   0    22   124   0    295
5    0    15   0   232   0   0   0     2   270   0      2
6    0   802   2    49   0   0   3    68   474   0    510
7    0    81   1   303   0   0   0  6777    58   0     45
8    0    98   6   385   0   1   0   230  2430   0    146
9    0    63   0   103   0   0   2    34   287   1      3
10   0   210   6    29   0   0   0    81   183   0  12287
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.35171062, 'precision': 0.18822327, 'recall': 0.3194335, 'specificity': 0.93451715, 'f1': 0.21373047, 'auroc': 0.72910744}
confusion matrix:
    0     1   2    3   4   5   6    7     8   9     10
0    0   588   1  100   0   0   8   25   414   0    34
1    0  1229   0   44   0   0   0   92    19   0   115
2    0   181   2   91   0   0   0    9   396   0   336
3    0     0   0    0   0   0   0    0     0   0     0
4    0    15   2    1   0   0   0    0     6   0  1609
5    0    14   8  168   0   0   0    1   395   0     6
6    0   431   3   10   0   0   1    1   140   0  2481
7    0    98   0   26   0   0   9  952    35   0    44
8    0    79   1   55   0   0   0    2  1197   0    36
9    0   171   5  302   0   0   3   28   566   0    62
10   0     0   0    0   0   0   0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 19:34:53.768231,epoch time: 0:31:06.127967,used: 1:35:17.132222,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8206603, 'precision': 0.43245178, 'recall': 0.4112705, 'specificity': 0.98031425, 'f1': 0.36941823, 'auroc': 0.93470734}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    0   172   0    51   0   3  27    27   142   4     57
1    0  1175   0    17   0   0   0   126     3   0     11
2    0   105   2    14   0   0   2    45   104   0     40
3    0    10   0  7913   0   0   0   311   202   0      1
4    0    67   2    11   0   0   0    13   132   0    313
5    0    19   2   281   0  11   0     1   193  13      1
6    0  1001   0    55   0   0   4    41   320   0    487
7    0    67   2   458   0   1   0  6583    91   0     63
8    0    44   6   421   0   2   0   130  2588   0    104
9    0    84   0   126   0   2   6    30   235   7      3
10   0   178   6    21   0   0   0    43   154   0  12390
---- Validation: 
scalar performance:
{'acc': 0.82008827, 'precision': 0.5178115, 'recall': 0.41020113, 'specificity': 0.98030126, 'f1': 0.3672424, 'auroc': 0.93399143}
confusion matrix:
    0     1   2     3   4   5   6     7     8   9      10
0    1   178   0    59   0   2  24    22   136   4     57
1    0  1171   0    22   0   0   0   120     5   0     14
2    0    95   0    14   0   0   1    44   119   1     38
3    0     6   1  7926   0   0   0   341   165   0      1
4    0    68   5    14   0   0   1    15   135   0    301
5    0    23   9   279   0   9   1     4   184  10      2
6    0  1027   1    71   0   0   1    40   312   2    454
7    0    87   1   475   0   0   0  6554    98   0     50
8    0    54   5   392   0   0   0   133  2603   0    109
9    0    98   0   127   0   2   4    27   222   7      6
10   0   185   9    26   0   0   0    40   149   0  12387
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33456936, 'precision': 0.27841312, 'recall': 0.29922858, 'specificity': 0.9327533, 'f1': 0.20198888, 'auroc': 0.7384022}
confusion matrix:
    0     1   2    3   4   5   6    7     8   9     10
0    0   775   1   80   0   0  76    7   211   0    20
1    0  1265   0   66   0   0   0   45    26   0    97
2    0   229   3   77   0   1   4    2   329   0   370
3    0     0   0    0   0   0   0    0     0   0     0
4    0    10   0    1   0   0   0    0     8   0  1614
5    0    23   9  199   0   1   0    1   355   1     3
6    0   502   0    5   0   0  10    0   101   1  2448
7    0   232   0  186   0   0  20  650    40   0    36
8    0    74   0   57   0   0   1    0  1207   0    31
9    0   226   4  283   0   0  21   10   541   1    51
10   0     1   0    0   0   0   0    0     0   0  1645
better model found
persisted
after epoch: 4,now: 2024-08-11 20:06:07.900910,epoch time: 0:31:14.132679,used: 2:06:31.264901,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.83861303, 'precision': 0.46969146, 'recall': 0.46079776, 'specificity': 0.9826319, 'f1': 0.4405913, 'auroc': 0.9497194}
confusion matrix:
    0     1   2     3   4    5    6     7     8   9      10
0    0    78   2    56   0   22  161    27    88  11     38
1    0  1187   1    17   0    1    0   109     9   0      8
2    0    35   4    14   0   14   47    42   105  11     39
3    0     1   4  7888   0    5    0   358   181   0      0
4    0    36  14    14   0    0   24    21   145   6    279
5    0     0  59   211   0  143    7     0    63  37      1
6    0  1053   1    65   0    8  225    42   213  10    291
7    0    35   0   335   0    1    2  6768    97   0     23
8    0    14   9   335   0    6    0   139  2742   0     51
9    0    11  16    89   0  105   63    22   127  54      6
10   0   157  17    18   0    2   26    61   177   4  12333
---- Validation: 
scalar performance:
{'acc': 0.8391601, 'precision': 0.4849341, 'recall': 0.46494272, 'specificity': 0.9826821, 'f1': 0.44700158, 'auroc': 0.94988936}
confusion matrix:
    0     1   2     3   4    5    6     7     8   9      10
0    0    74   2    57   0   29  158    34    76  12     41
1    0  1174   2    20   0    0    0   120     8   0      8
2    0    36  15    15   0   12   51    39   104   6     34
3    0     1   7  7921   0    3    0   341   167   0      0
4    0    46  18    14   0    1   29     9   136   4    282
5    0     0  67   208   0  145    6     0    69  25      1
6    0  1025   0    63   0   14  229    40   232   8    297
7    0    40   1   309   0    0    1  6783    96   0     35
8    0    16   4   343   0    6    0   130  2739   0     58
9    0     7  26    83   0  111   55    22   121  60      8
10   0   177  19    20   0    0   26    54   193   1  12306
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.40152523, 'precision': 0.33870113, 'recall': 0.33563685, 'specificity': 0.9387821, 'f1': 0.2820562, 'auroc': 0.76203585}
confusion matrix:
    0     1   2    3   4    5    6    7     8   9     10
0    0   109   3  103   0   19  738    1   179  15     3
1    0  1255   1   86   0    0    8   39    30   0    80
2    0    73  28   89   0   20  180    0   355  16   254
3    0     0   0    0   0    0    0    0     0   0     0
4    0     9   1    3   0    0    8    0    11   0  1601
5    0     1  93  200   0  104   15    0   153  24     2
6    0   467  14    3   0   17  971    0   105   8  1482
7    0   183   1  325   0    1  105  461    61   4    23
8    0    31   2   61   0   21   26    0  1216   3    10
9    0    39  40  323   0   97  199    2   346  59    32
10   0     1   0    0   0    0    0    0     0   0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-11 20:37:12.476818,epoch time: 0:31:04.575908,used: 2:37:35.840809,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.87406355, 'precision': 0.64602304, 'recall': 0.5327431, 'specificity': 0.985958, 'f1': 0.5289358, 'auroc': 0.9597248}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    5    17   2    62   0   16   264    30    29   6     52
1    0  1195   0    20   0    1     0   100     4   0     10
2    0     8  18     9   0   26    76    55    40   9     71
3    0     2   5  7830   0   22     0   429   149   1      1
4    0     6   7    16   0    6    58    17    74   1    354
5    0     0  56   145   0  248    17     3    37  14      1
6    0   149   1    50   0   11  1312    50    93   3    238
7    0    39   1   224   0    1     0  6888    61   0     49
8    0    17  14   296   0   11     6   181  2668   1    101
9    0     8  13    70   0  171   104    37    49  34      7
10   0    59   8    18   0    1   101    57    78   1  12471
---- Validation: 
scalar performance:
{'acc': 0.87363917, 'precision': 0.64939106, 'recall': 0.5331068, 'specificity': 0.9859146, 'f1': 0.5279441, 'auroc': 0.9587274}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    6    19   0    70   0   20   257    23    31   4     53
1    0  1205   0    19   0    0     0    96     3   0      9
2    0    11  17    14   0   22    73    53    48   4     70
3    0     6  10  7804   0   20     0   446   154   0      0
4    0     4  10    13   0    5    60    13    66   7    361
5    0     1  43   147   0  260    20     1    42   6      1
6    0   174   2    70   0   13  1292    38    83   4    232
7    0    44   1   211   0    1     4  6900    56   0     48
8    0    19  13   317   0   10     8   173  2661   0     95
9    0     5  13    77   0  172   105    36    49  29      7
10   0    62   8    22   0    0    88    42    86   1  12487
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.41572797, 'precision': 0.39360583, 'recall': 0.34134436, 'specificity': 0.94012654, 'f1': 0.29554552, 'auroc': 0.7627867}
confusion matrix:
    0     1   2    3   4    5     6    7     8   9     10
0    0    10   0  159   0   11   841    1   143   0     5
1    0  1264   0   88   0    0     7   25    31   0    84
2    0    22  11   91   0   33   255    0   248   4   351
3    0     0   0    0   0    0     0    0     0   0     0
4    0     2   0    1   0    0    11    0     6   0  1613
5    1     0  34  213   0  215    29    0    89   9     2
6    0    55   5    4   0   11  1354    0    40   1  1597
7    0   237   1  541   0    0    61  247    43   1    33
8    0    14   3   76   0   21    49    0  1178   0    29
9    0    25  16  332   0  146   292    1   249  28    48
10   0     1   0    0   0    0     0    0     0   0  1645
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-11 21:08:26.572370,epoch time: 0:31:14.095552,used: 3:08:49.936361,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8868258, 'precision': 0.68118644, 'recall': 0.55960846, 'specificity': 0.9872761, 'f1': 0.5645492, 'auroc': 0.9658949}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   18     2   1   126   0    3   239    25    13   5     51
1    0  1200   1    19   0    0     0    95     8   0      9
2    0     2  34    17   0   18    55    35    49  10     92
3    0     1   6  7930   0   19     0   342   140   0      0
4    0     2  23    18   0    1    48    16    75   2    354
5    0     0  51   144   0  257    20     2    29  16      2
6    1    13   1    86   0    3  1597    35    22   0    150
7    0    32   1   244   0    0     1  6869    71   0     45
8    0    11  18   296   0    5     9   164  2715   0     78
9    0     2  31    75   0  144   107    32    39  46     17
10   0    28  12    22   0    1   137    42    68   1  12480
---- Validation: 
scalar performance:
{'acc': 0.8870135, 'precision': 0.67593485, 'recall': 0.55682504, 'specificity': 0.98727286, 'f1': 0.5607611, 'auroc': 0.96514046}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0   19     0   1   115   0    3   247    31    16   3     48
1    0  1193   0    22   0    0     0   101     3   0     13
2    0     3  32    17   0   16    56    49    48   4     87
3    0     0  10  7936   0   16     0   343   134   0      1
4    0     3  16    19   0    3    46    14    67   3    368
5    0     0  36   142   0  258    26     1    31  26      1
6    0    13   0    78   0    5  1595    24    26   2    165
7    0    29   2   261   0    0     0  6872    68   0     33
8    0    10  23   289   0   10     9   149  2724   1     81
9    0     0  30    89   0  149   104    27    41  33     20
10   0    18   9    20   0    1   136    42    70   1  12499
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44931084, 'precision': 0.46055079, 'recall': 0.35001704, 'specificity': 0.9441162, 'f1': 0.3182259, 'auroc': 0.7723672}
confusion matrix:
    0     1   2    3   4    5     6    7     8   9     10
0    1     2   0  312   0    1   801    0    48   1     4
1    0  1237   0  103   0    0    21   30    18   0    90
2    0    13  26  142   0   18   209    1   262  13   331
3    0     0   0    0   0    0     0    0     0   0     0
4    0     0   1    4   0    0    14    0     8   0  1606
5    1     0  31  289   0  176    42    0    30  21     2
6    0    14  10   12   0    5  1901    0    35   4  1086
7    0   147   1  684   0    0    60  199    33   0    40
8    1     5   2  120   0    7    33    0  1181   1    20
9    0    12  21  445   0   89   226    2   224  55    63
10   0     0   0    0   0    0     0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-11 21:39:44.924157,epoch time: 0:31:18.351787,used: 3:40:08.288148,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.89651114, 'precision': 0.7014419, 'recall': 0.6042426, 'specificity': 0.9884461, 'f1': 0.60907125, 'auroc': 0.9731731}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   107     3   1   115   0   10   149    23    28   2     44
1     0  1220   0    24   0    0     0    77     3   0      8
2     1     5  50    21   0   34    34    31    50   6     80
3     0     2   9  7859   0   50     0   341   176   0      0
4     0     6  24    36   0    5    24     9    79   3    353
5     0     0  28    88   0  360     8     1    29   6      1
6     8     5   1   101   0    9  1622    19    45   1     97
7     0    31   2   240   0    2     4  6867    84   0     33
8     0     7   8   198   0   13     6   120  2872   1     71
9     1     0  36    59   0  230    54    22    40  40     11
10    0    16  13    29   0    2    95    35    92   0  12511
---- Validation: 
scalar performance:
{'acc': 0.8969908, 'precision': 0.69366294, 'recall': 0.60380095, 'specificity': 0.9884949, 'f1': 0.60931325, 'auroc': 0.97291327}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   111     5   2   108   0    6   143    25    30   3     50
1     0  1219   0    21   0    0     0    78     8   0      6
2     2     7  46    20   0   35    31    35    45  14     77
3     0     3   3  7878   0   44     0   321   190   1      0
4     0     4  27    38   0    9    34    12    63   2    350
5     0     0  26    92   0  358    10     0    24  10      1
6     4    10   3   100   0    6  1614    22    32   0    117
7     0    35   0   226   0    1     1  6881    89   0     32
8     0     4   8   206   0   18     4   120  2878   0     58
9     0     1  32    58   0  222    60    14    46  42     18
10    0    28   9    32   0    2   101    34    80   3  12507
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47540754, 'precision': 0.49916047, 'recall': 0.38102323, 'specificity': 0.94728667, 'f1': 0.34279004, 'auroc': 0.78976965}
confusion matrix:
    0     1   2    3   4    5     6    7     8   9     10
0   64     2   0  426   0   12   512    0   148   3     3
1    0  1232   0  104   0    0    28   26    42   0    67
2    1     7  36  138   0   45   140    0   350  22   276
3    0     0   0    0   0    0     0    0     0   0     0
4    0     0   1    6   0    0    11    0    15   0  1600
5    7     0  12  203   0  294    24    0    39  12     1
6    0     7  34   13   0   23  2034    0    62  14   880
7    0   110   1  714   0    0    59  165    90   2    23
8    6     4   3   57   0   23    16    0  1249   3     9
9    7    10  27  338   0  198   156    0   278  75    48
10   0     0   0    0   0    0     0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-11 22:11:15.203384,epoch time: 0:31:30.279227,used: 4:11:38.567375,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9027183, 'precision': 0.6944068, 'recall': 0.62124324, 'specificity': 0.98906827, 'f1': 0.63380545, 'auroc': 0.97561616}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   182     0   0    78   0    6   104    38    27   1     47
1     0  1194   0    16   0    0     0   106     5   0     11
2     3     4  45    26   0   25    15    43    34  23     94
3     0     1   2  7774   0   34     0   416   211   0      0
4     1     1  20    49   0    5    23    15    44   9    372
5     0     0  22    76   0  353    15     3    32  19      1
6    15     5   0    65   0    6  1691    29    25   1     71
7     0    15   0   141   0    0     1  7016    61   0     31
8     0     3   7   142   0    6     8   155  2890   1     82
9     2     1  46    48   0  202    59    31    38  53     13
10    1    15   6    24   0    0    99    43    59   2  12542
---- Validation: 
scalar performance:
{'acc': 0.9031697, 'precision': 0.69797885, 'recall': 0.62455237, 'specificity': 0.9891108, 'f1': 0.63658684, 'auroc': 0.9750465}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   197     3   2    81   0    3    93    32    24   1     47
1     0  1199   0    15   0    0     0   105     4   0      9
2     4     4  39    22   0   39    13    41    34  22     94
3     0     1   4  7786   0   37     0   410   202   0      0
4     0     1  18    32   0    6    18    15    56  12    381
5     1     0  15    83   0  363    13     1    33  11      1
6    10     9   0    72   0    6  1694    27    24   1     65
7     0    13   1   131   0    0     2  7023    64   0     31
8     0     1   7   169   0    7     6   167  2866   2     71
9     6     2  39    58   0  194    59    27    36  56     16
10    1    18   6    28   0    4    89    38    68   2  12542
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49639684, 'precision': 0.5156431, 'recall': 0.3992087, 'specificity': 0.9494072, 'f1': 0.37850443, 'auroc': 0.792809}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   220     4   0  358   0    4   379    0   197   2     6
1     0  1200   0   77   0    0    35   51    49   0    87
2     5    10  29  141   0   21    94    2   382  23   308
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   0    9   0    0     6    0    12   1  1605
5    11     0   8  245   0  203    23    1    71  28     2
6     0    19  27    7   0    7  1999    0    67  12   929
7     0    57   1  509   0    0    57  430    94   0    16
8     8     2   1   39   0    7     9    0  1291   2    11
9    17     9  28  352   0  105    98    3   385  77    63
10    0     0   0    0   0    0     0    0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-11 22:42:36.643994,epoch time: 0:31:21.440610,used: 4:43:00.007985,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90504605, 'precision': 0.7011651, 'recall': 0.6278429, 'specificity': 0.98918366, 'f1': 0.649534, 'auroc': 0.9772891}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   241     6   2    76   0    1    35    31    37   0     54
1     0  1204   0    20   0    0     0    95     2   0     11
2     4     4  28    49   0   11     4    40    43  45     84
3     0     2   0  8002   0   23     0   271   140   0      0
4     0     4   8    87   0    2     5    12    53  20    348
5     2     0  18   114   0  328     1     3    32  22      1
6    27    14   0   117   0    1  1585    19    41   4    100
7     0    19   0   232   0    0     3  6934    50   1     26
8     0     1   3   223   0    6     1   136  2871   0     52
9    10     3  34    98   0  154    19    29    37  98     11
10    4    21   7    55   0    0    48    49    69   3  12536
---- Validation: 
scalar performance:
{'acc': 0.90605855, 'precision': 0.69750756, 'recall': 0.6291305, 'specificity': 0.98930585, 'f1': 0.6507031, 'auroc': 0.9764047}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   226     3   3    88   0    1    39    27    42    2     52
1     0  1213   0    19   0    0     0    88     6    0      6
2     4     4  25    43   0   15     5    46    36   56     78
3     0     2   3  8036   0   18     0   239   142    0      0
4     1     2   9    74   0    1     7    12    54   18    361
5     3     0  22   109   0  329     3     1    26   26      2
6    27    10   0   124   0    2  1597    19    38    3     88
7     0    15   0   227   0    0     0  6914    68    1     40
8     0     3   3   213   0    8     0   137  2874    0     58
9     5     4  43    90   0  147    15    21    34  117     17
10    8    18   8    50   0    1    47    48    73    1  12542
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46162456, 'precision': 0.50873053, 'recall': 0.3746724, 'specificity': 0.946619, 'f1': 0.35443574, 'auroc': 0.7843668}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   297    10   0  370   0    1   179    0   304   0     9
1     0  1237   0   94   0    0     8   41    59   0    60
2     5     8  20  206   0    8    27    2   441  17   281
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   0   20   0    0     5    0    18   0  1590
5     6     0  15  346   0  126     7    1    67  22     2
6     6    46  32   24   0    4  1565    0   230  15  1145
7     1    71   0  591   0    0    23  360    98   2    18
8     5     0   3   50   0    3     4    1  1300   0     4
9    16    12  41  497   0   48    24    4   394  47    54
10    0     0   0    0   0    0     0    0     0   0  1646
better model found
persisted
after epoch: 10,now: 2024-08-11 23:13:42.688148,epoch time: 0:31:06.044154,used: 5:14:06.052139,model: blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:14:06.052139 at 2024-08-11 23:13:42.688148
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46162456, 'precision': 0.50873053, 'recall': 0.3746724, 'specificity': 0.946619, 'f1': 0.35443574, 'auroc': 0.7843668}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   297    10   0  370   0    1   179    0   304   0     9
1     0  1237   0   94   0    0     8   41    59   0    60
2     5     8  20  206   0    8    27    2   441  17   281
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   0   20   0    0     5    0    18   0  1590
5     6     0  15  346   0  126     7    1    67  22     2
6     6    46  32   24   0    4  1565    0   230  15  1145
7     1    71   0  591   0    0    23  360    98   2    18
8     5     0   3   50   0    3     4    1  1300   0     4
9    16    12  41  497   0   48    24    4   394  47    54
10    0     0   0    0   0    0     0    0     0   0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49639684, 'precision': 0.5156431, 'recall': 0.3992087, 'specificity': 0.9494072, 'f1': 0.37850443, 'auroc': 0.792809}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   220     4   0  358   0    4   379    0   197   2     6
1     0  1200   0   77   0    0    35   51    49   0    87
2     5    10  29  141   0   21    94    2   382  23   308
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   0    9   0    0     6    0    12   1  1605
5    11     0   8  245   0  203    23    1    71  28     2
6     0    19  27    7   0    7  1999    0    67  12   929
7     0    57   1  509   0    0    57  430    94   0    16
8     8     2   1   39   0    7     9    0  1291   2    11
9    17     9  28  352   0  105    98    3   385  77    63
10    0     0   0    0   0    0     0    0     0   0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_dann_b8efecac6_not_commited_2024md_08md_11_17_59_36_seed_1_24142407_instance_wise_predictions.txt
accuracy from prediction file 0.461624571468551
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/19.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/19.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 500536 KiB |  10952 MiB | 689545 GiB | 689544 GiB |
|       from large pool | 408896 KiB |  10880 MiB | 688106 GiB | 688106 GiB |
|       from small pool |  91640 KiB |    127 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 500536 KiB |  10952 MiB | 689545 GiB | 689544 GiB |
|       from large pool | 408896 KiB |  10880 MiB | 688106 GiB | 688106 GiB |
|       from small pool |  91640 KiB |    127 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478831 KiB |  10882 MiB | 686043 GiB | 686042 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 684609 GiB | 684609 GiB |
|       from small pool |  90991 KiB |    126 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11550 MiB |  11550 MiB |  21484 MiB |   9934 MiB |
|       from large pool |  11422 MiB |  11422 MiB |  21326 MiB |   9904 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1333 MiB |   1548 MiB | 275369 GiB | 275368 GiB |
|       from large pool |   1320 MiB |   1545 MiB | 273838 GiB | 273837 GiB |
|       from small pool |     12 MiB |     33 MiB |   1531 GiB |   1531 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3965    |    5193    |   55142 K  |   55138 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    3878    |    5087    |   31033 K  |   31029 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3965    |    5193    |   55142 K  |   55138 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    3878    |    5087    |   31033 K  |   31029 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     294    |     294    |     508    |     214    |
|       from large pool |     230    |     230    |     429    |     199    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    1153    |   27521 K  |   27521 K  |
|       from large pool |      28    |     129    |   12766 K  |   12766 K  |
|       from small pool |      37    |    1123    |   14755 K  |   14755 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10952 MiB | 689545 GiB | 689545 GiB |
|       from large pool |  16640 KiB |  10880 MiB | 688106 GiB | 688106 GiB |
|       from small pool |      0 KiB |    127 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10952 MiB | 689545 GiB | 689545 GiB |
|       from large pool |  16640 KiB |  10880 MiB | 688106 GiB | 688106 GiB |
|       from small pool |      0 KiB |    127 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 686043 GiB | 686043 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 684609 GiB | 684609 GiB |
|       from small pool |      0 KiB |    126 MiB |   1433 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1822 MiB |  11550 MiB |  21484 MiB |  19662 MiB |
|       from large pool |   1720 MiB |  11422 MiB |  21326 MiB |  19606 MiB |
|       from small pool |    102 MiB |    128 MiB |    158 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1548 MiB | 275369 GiB | 275369 GiB |
|       from large pool |  59136 KiB |   1545 MiB | 273838 GiB | 273838 GiB |
|       from small pool |      0 KiB |     34 MiB |   1531 GiB |   1531 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5193    |   55142 K  |   55142 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    5087    |   31033 K  |   31033 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5193    |   55142 K  |   55142 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    5087    |   31033 K  |   31033 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      88    |     294    |     508    |     420    |
|       from large pool |      37    |     230    |     429    |     392    |
|       from small pool |      51    |      64    |      79    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1153    |   27522 K  |   27522 K  |
|       from large pool |       3    |     129    |   12766 K  |   12766 K  |
|       from small pool |       0    |    1123    |   14756 K  |   14756 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 23:20:14 2024]
Finished job 0.
1 of 1 steps (100%) done
