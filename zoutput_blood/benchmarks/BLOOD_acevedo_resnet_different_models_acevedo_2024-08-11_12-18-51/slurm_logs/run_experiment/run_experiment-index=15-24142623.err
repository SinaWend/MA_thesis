Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 07:12:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/15.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=15
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623

 Experiment start at: 2024-08-12 07:19:00.356560
before training, model accuracy: 0.05282306298613548
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.81105524, 'precision': 0.41823882, 'recall': 0.42524755, 'specificity': 0.97864956, 'f1': 0.41985038, 'auroc': 0.941426}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    26   0   0  206    37   146   0     68
1    0  1084   0    14   0   0    0   190     4   0     40
2    0     0   0    11   0   0   71    37   169   0     24
3    0     0   0  7365   0   0    0   704   349   0     19
4    0     0   0     7   0   0   77    21   147   0    287
5    0     0   0   337   0   0   35     3   145   0      1
6    0     3   0    35   0   0  941    64   479   0    386
7    0    36   0   555   0   0    4  6387   164   0    117
8    0     1   0   426   0   0   57   319  2140   0    353
9    0     2   0   126   0   0   87    24   252   0      2
10   0     7   0    12   0   0  126    76   174   0  12397
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.81032497, 'precision': 0.41791236, 'recall': 0.42636085, 'specificity': 0.9785875, 'f1': 0.42035383, 'auroc': 0.93992615}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    29   0   0  216    33   131   0     74
1    0  1091   0    13   0   0    0   182     7   0     39
2    0     1   0    15   0   0   69    44   161   0     22
3    0     0   0  7346   0   0    0   712   361   0     21
4    0     0   0     9   0   0   76    20   141   0    293
5    0     0   0   326   0   0   41     2   151   0      1
6    0     4   0    23   0   0  956    63   460   0    402
7    0    34   0   581   0   0    3  6345   187   0    115
8    0     1   0   450   0   0   63   295  2169   0    318
9    0     0   0   117   0   0   99    21   255   0      1
10   0     5   0    12   0   0  133    80   179   0  12387
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.35478905, 'precision': 0.24640048, 'recall': 0.27522194, 'specificity': 0.9307108, 'f1': 0.23751882, 'auroc': 0.738021}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     7   0    2   0   0  1141    9    9   0     2
1    0  1004   0   19   0   0    88   81   10   0   297
2    0     1   0   40   0   0   793    2   63   0   116
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    76    0    0   0  1557
5    0     0   0  255   0   0   172    2  161   0     2
6    0     4   0    0   0   0  1231    1    5   0  1826
7    0   255   0    1   0   0   152  674   33   0    49
8    0     0   0   38   0   0   741    1  521   0    69
9    0     6   0  176   0   0   746   18  171   0    20
10   0     0   0    0   0   0     5    0    0   0  1641
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 07:44:29.912067,epoch time: 0:25:29.555507,used: 0:25:29.555507,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.85843855, 'precision': 0.6458752, 'recall': 0.5095195, 'specificity': 0.984424, 'f1': 0.50359493, 'auroc': 0.9733884}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    2     0   0    28   0    6   331    19    39   1     57
1    0  1132   0    15   0    0     0   156     9   0     19
2    0     0   0     7   0    3    99    45   136   3     19
3    0     0   0  7548   0    5     2   505   374   0      4
4    0     0   0     4   0    0   102    15   151   0    267
5    0     0   0   244   0  148    68     0    51   9      1
6    0     0   0    17   0    1  1606    29    89   1    165
7    0    36   0   406   0    0     5  6566   191   0     58
8    0     0   0   228   0    1    29   160  2741   0    137
9    0     0   0    78   0   61   204    23   111  15      1
10   0     6   0     8   0    1   199    57   195   0  12327
---- Validation: 
scalar performance:
{'acc': 0.85836565, 'precision': 0.6389502, 'recall': 0.50757957, 'specificity': 0.9843888, 'f1': 0.5011679, 'auroc': 0.9743246}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    1     0   0    22   0    6   328    19    46   2     59
1    0  1140   0    16   0    0     0   151     7   0     18
2    0     0   0     6   0    1   105    45   136   2     17
3    0     1   0  7534   0    6     1   480   412   0      6
4    0     0   0     4   0    1   103     9   153   0    269
5    0     0   0   267   0  145    51     0    47   9      2
6    0     2   0    13   0    4  1592    32    93   0    172
7    0    28   0   391   0    0     3  6605   174   0     64
8    0     0   0   243   0    0    39   154  2715   0    145
9    0     3   0    95   0   66   191    15   111  11      1
10   0     4   0    10   0    0   174    56   205   0  12347
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4505702, 'precision': 0.40002507, 'recall': 0.34890926, 'specificity': 0.9396013, 'f1': 0.32174385, 'auroc': 0.76958823}
confusion matrix:
    0     1   2   3   4    5     6    7    8   9     10
0    0     1   0   1   0    1  1159    3    4   1     0
1    0  1162   0  22   0    0   126   63    6   1   119
2    0     2   0   3   0   11   885    2   28   1    83
3    0     0   0   0   0    0     0    0    0   0     0
4    0     0   0   0   0    0   102    0    0   0  1531
5    0     0   0  45   0  258   262    0   20   5     2
6    0     3   0   0   0    0  2267    0    0   0   797
7    0   234   0   4   0    0   291  594   16   0    25
8    0     0   0  10   0   21   796    1  496  16    30
9    0     9   0  26   0   59   949    9   54  19    12
10   0     0   0   0   0    0     2    0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 08:09:28.053445,epoch time: 0:24:58.141378,used: 0:50:27.696885,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8908658, 'precision': 0.7768738, 'recall': 0.6322082, 'specificity': 0.98776746, 'f1': 0.6576699, 'auroc': 0.98403925}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   169     1   0    26   0   12   145    23    13   27     67
1     0  1167   0    19   0    0     0   124    10    0     12
2     4     1  23     7  26   11    13    45    83   76     23
3     0     0   0  7837   0   29     1   411   157    3      2
4     2     0   2     3  72    6    28    12   114   17    283
5     0     0   0   126   0  341     1     0    16   36      1
6     6     2   0    19   0   12  1678    20    37    9    124
7     0    28   1   400   0    0     1  6646   128    1     58
8     2     0   1   316   3    4    13   147  2671    6    132
9     4     1  11    53   1  182     3    12    48  174      3
10    5     5   0    13   7    1    88    56    96    2  12519
---- Validation: 
scalar performance:
{'acc': 0.8924435, 'precision': 0.77421105, 'recall': 0.628404, 'specificity': 0.9879382, 'f1': 0.6537048, 'auroc': 0.98405373}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   156     0   0    22   0   20   149    21    11   28     76
1     0  1157   0    18   0    0     0   141     3    0     13
2     4     1  22     7  25    7    19    40    79   81     27
3     0     0   0  7863   0   32     1   375   165    1      3
4     2     0   7     4  69    2    46    11   109   11    278
5     1     0   0   133   0  339     5     3    10   29      1
6    13     0   0    25   2    7  1668    23    33    7    130
7     1    15   0   362   1    0     1  6728   109    0     48
8     0     0   0   314   6    8    19   144  2663    4    138
9     8     1   6    50   1  177     9    16    47  174      4
10    4     4   0    10   5    3    93    55    96    1  12525
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47596726, 'precision': 0.51089835, 'recall': 0.4170477, 'specificity': 0.94444174, 'f1': 0.39121938, 'auroc': 0.8235664}
confusion matrix:
    0     1   2   3   4    5     6    7    8    9     10
0   27     1   0   2   0    1  1045    4    2   85     3
1    0  1195   0  28   0    0    78   67    8    8   115
2    1     2   8   6  57   31   466    3   89  115   237
3    0     0   0   0   0    0     0    0    0    0     0
4    0     0   0   0  16    0    26    0    4    1  1586
5    4     0   0  26   0  377    24    0    1  158     2
6    1     3   0   0   1    0  1563    0    1    5  1493
7    6   180   3  24   1    0   269  584   20   46    31
8    1     0   1  32   7   32   222    0  792  193    90
9    5    10   8  36   1  133   284    4   40  595    21
10   0     0   0   0   0    0     0    0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 08:34:30.942756,epoch time: 0:25:02.889311,used: 1:15:30.586196,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9083102, 'precision': 0.80459905, 'recall': 0.71015763, 'specificity': 0.98982185, 'f1': 0.74401563, 'auroc': 0.98865235}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   285     0   2     5    0    0    87    20    12    5     67
1     0  1188   0    11    1    0     0   119     2    0     11
2    11     1  99     3   42    1     5    39    41   58     12
3     0     0   0  7730    0   17     1   500   186    2      1
4     5     0  18     1  158    0    16    16    92   11    222
5     5     0   2   113    0  292     1     0     9   97      1
6    19     1   0    10    0    2  1759    18    29    2     67
7     2    23   0   215    1    0     3  6883    79    2     55
8     0     0   3   211   10    3    12   191  2776    2     88
9    27     1  35    41    1   69    11     8    25  272      3
10   15     3   5     6   26    1    83    32   113    3  12507
---- Validation: 
scalar performance:
{'acc': 0.90651333, 'precision': 0.7918135, 'recall': 0.70447934, 'specificity': 0.9896536, 'f1': 0.7366825, 'auroc': 0.98838454}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   270     0   0     9    0    0   102    19     8    7     68
1     0  1196   0    10    1    0     0   112     3    0     10
2    10     1  96     5   40    1     9    39    35   67      9
3     2     0   0  7667    0   19     1   548   196    5      2
4     4     0  32     2  169    1    20    15    79   12    205
5     6     0   2   112    0  295     4     1    11   89      1
6    18     0   1     6    0    0  1763    19    32    5     64
7     1    17   0   226    2    0     2  6883    80    1     53
8     1     1   2   220   10    4     8   183  2771    2     94
9    33     2  40    30    0   92     8     8    28  249      3
10   12     2   1     7   33    2    75    38    95    0  12531
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52767086, 'precision': 0.5573988, 'recall': 0.42907184, 'specificity': 0.9496648, 'f1': 0.42863154, 'auroc': 0.8367284}
confusion matrix:
    0     1   2   3    4    5     6    7    8    9     10
0   99     1   1   3    0    0  1038    2    2   22     2
1    1  1291   0  26    0    0    55   40    4    2    80
2    8     7  68   7  175    5   429    3   84   79   150
3    0     0   0   0    0    0     0    0    0    0     0
4    0     0   2   0  199    0    33    0    3    0  1396
5   29     0   0  56    0  202    57    0    4  241     3
6    7     4   0   0   27    0  2094    0    1    1   933
7   10   250  14  18    0    0   299  520   15    5    33
8    4     0  18  43   30    9   189    0  937   96    44
9   30    28  98  35    4   16   357    9   42  497    21
10   0     1   0   0    9    0     1    0    0    0  1635
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 08:59:34.165709,epoch time: 0:25:03.222953,used: 1:40:33.809149,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9148384, 'precision': 0.8084405, 'recall': 0.7511077, 'specificity': 0.9906588, 'f1': 0.7726639, 'auroc': 0.9909986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   348     0    0     9    1    0    15    19     8    4     79
1     0  1206    0    12    1    0     0   104     4    0      3
2    10     0  143     4   38    1     0    27    23   61      5
3     4     1    0  7714    0   14     1   483   218    2      0
4     5     0   37     2  246    0     4     8    62    9    166
5    10     0    4    97    0  243     0     0    10  156      1
6    65     0    1    12    0    0  1672    26    32    6     92
7     2    24    1   175    2    0     1  6933   101    2     23
8     0     1    5   166   19    2     2   153  2885    5     58
9    15     0   52    24    0   36     2     7    30  324      3
10   19     4    4    12   80    2    24    59   111    1  12479
---- Validation: 
scalar performance:
{'acc': 0.9156881, 'precision': 0.80869824, 'recall': 0.74843776, 'specificity': 0.9907497, 'f1': 0.77202666, 'auroc': 0.9908799}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   335     0    1    10    0    0    25    22    13    6     71
1     0  1198    0    11    1    0     0   111     4    0      7
2     9     2  141     2   38    1     1    29    26   58      5
3     1     0    0  7723    0   15     0   480   216    4      1
4     3     0   51     4  240    0     4    14    59   10    154
5     6     0    2    96    0  256     1     0    12  147      1
6    59     0    0    11    4    0  1674    24    37    5     94
7     0    19    2   165    2    1     1  6957    92    1     25
8     1     0    5   174   18    1     3   155  2875    9     55
9    15     0   48    27    1   44     1    10    23  321      3
10   21     8    2     7   64    1    24    67    87    2  12513
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48975024, 'precision': 0.571012, 'recall': 0.43200457, 'specificity': 0.94697064, 'f1': 0.4338224, 'auroc': 0.83887607}
confusion matrix:
     0     1    2   3    4    5    6    7     8    9     10
0   316     1    2  11    0    0  770    1     7   29    33
1     1  1340    0  29    0    0   16   42     9    1    61
2     7    11  111   8  220    1  102    5   120   73   357
3     0     0    0   0    0    0    0    0     0    0     0
4     0     1    2   0  225    0    4    0     2    0  1399
5    20     0    0  72    0  108   33    0    13  341     5
6    11     4    2   0   23    0  969    0     4    2  2052
7    13   168   28  31    1    0  139  703    35    7    39
8     3     0   26  40   43    5   49    0  1038   77    89
9    21    35  197  52    7    2  142    7    74  553    47
10    0     0    0   0    9    0    0    0     0    0  1637
better model found
persisted
after epoch: 5,now: 2024-08-12 09:25:09.661288,epoch time: 0:25:35.495579,used: 2:06:09.304728,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9250856, 'precision': 0.8206439, 'recall': 0.7730737, 'specificity': 0.99177253, 'f1': 0.7908862, 'auroc': 0.9926643}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   388     0    2     7    0    0    13    11     4    2     56
1     0  1233    0    19    1    0     1    70     3    0      5
2    13     0  141     2   25    4     1    22    22   75      7
3     4     0    0  8059    0   19     0   236   119    1      1
4     7     0   49     3  225    2     5     9    64   11    163
5    12     0    0    78    0  346     0     0     7   77      1
6    56     0    0     9    0    0  1765     8    17    1     52
7     2    28    2   338    1    0     2  6766    97    3     25
8     2     1    3   256    9    3    10   109  2852    3     47
9    27     2   36    24    0   89     3     4    17  288      2
10   47     0    4     8   38    2    35    34   110    1  12513
---- Validation: 
scalar performance:
{'acc': 0.9248094, 'precision': 0.82631755, 'recall': 0.7732472, 'specificity': 0.9917333, 'f1': 0.7930833, 'auroc': 0.9930291}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   380     0    0     9    0    0    26     9     7    4     48
1     0  1225    0    15    1    0     0    80     3    0      8
2    15     1  151     3   23    1     1    23    22   67      5
3     2     0    0  8071    0   19     3   215   127    2      1
4     6     0   46     1  215    1     7    11    66   12    174
5    10     0    1    80    0  337     1     0     9   82      1
6    60     0    1    13    2    1  1756    10    21    1     43
7     1    20    2   361    1    0     2  6748   101    2     27
8     2     1    2   256    9    5     5   113  2855    4     44
9    26     0   25    21    0   90     2     7    13  305      4
10   38     5    4     9   35    1    40    35    97    1  12531
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53445745, 'precision': 0.6018563, 'recall': 0.4514494, 'specificity': 0.95092154, 'f1': 0.45746893, 'auroc': 0.83442056}
confusion matrix:
     0     1    2   3    4    5     6    7     8    9     10
0   226     0    1   7    0    0   909    0     4   10    13
1     1  1300    0  36    0    0    32   50     7    1    72
2     5     9  107   8  106    6   219    3   140   54   358
3     0     0    0   0    0    0     0    0     0    0     0
4     0     1    2   0  108    0    12    0     9    0  1501
5    16     0    0  85    0  237    79    0     7  165     3
6    12     2    0   0    7    0  1850    0     1    0  1195
7     3    91   12  82    0    0   285  613    40    6    32
8     1     0   15  51    8    8   103    0  1083   42    59
9    17    38  120  63    2   22   290    2    67  472    44
10    0     0    0   0    3    0     0    0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 09:50:50.559568,epoch time: 0:25:40.898280,used: 2:31:50.203008,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9305169, 'precision': 0.84007937, 'recall': 0.7795861, 'specificity': 0.9922705, 'f1': 0.8059191, 'auroc': 0.9938833}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   352     0    0     9    0    0    26    11     7    5     73
1     0  1240    0    15    1    0     0    66     4    0      5
2     3     1  142     1   58    1     2    24    12   63      5
3     1     0    0  7990    0   22     2   309   114    1      0
4     0     1   23     2  283    0     3    11    43   15    158
5     5     0    1    82    0  323     2     0     8   99      1
6    16     1    0    11    2    0  1792     4    18    2     62
7     0    28    3   233    2    0     2  6890    65    1     39
8     2     0    3   231   11    5     7   132  2837    4     63
9    12     0   42    27    1   67     4     7    13  312      8
10   17     3    2     8   61    1    17    22    43    0  12618
---- Validation: 
scalar performance:
{'acc': 0.9311756, 'precision': 0.8475452, 'recall': 0.78498906, 'specificity': 0.9923424, 'f1': 0.8118403, 'auroc': 0.99386173}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   359     0    1     8    0    0    29     9     5    6     66
1     0  1240    0    15    2    0     0    61     7    0      7
2     4     2  147     1   43    0     4    23    21   59      8
3     1     1    0  7998    0   14     0   311   112    3      0
4     2     0   20     0  284    2     5    13    46    8    159
5     0     0    2    80    0  320     2     0     7  109      1
6    20     0    3    10    1    0  1792     8    13    2     59
7     0    28    4   236    2    0     2  6880    75    0     38
8     1     1    3   219   11    2     5   126  2862    1     65
9     8     1   41    19    1   71     3    10    10  326      3
10   12     3    2    15   47    1    26    33    52    1  12604
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5124886, 'precision': 0.5965731, 'recall': 0.4272114, 'specificity': 0.94878745, 'f1': 0.42828667, 'auroc': 0.8332426}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   123     0    2   10    1    0   945    0     5   19    65
1     0  1333    1   37    0    0    28   39     4    1    56
2     1    10   66   11  166    3   149    3   176   35   395
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    1    0  203    0     8    0     8    0  1413
5     1     0    0   98    0  187    81    0    15  192    18
6     4     3    0    0   10    0  1694    0     6    0  1350
7     0   102   11  104    0    0   314  556    43    4    30
8     1     0    9   52   14    5    65    0  1116   29    79
9     2    33  136   79   13   18   256    3   106  410    81
10    0     1    0    0    8    0     0    0     0    0  1637
better model found
persisted
after epoch: 7,now: 2024-08-12 10:15:52.833647,epoch time: 0:25:02.274079,used: 2:56:52.477087,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9346907, 'precision': 0.83351094, 'recall': 0.8144546, 'specificity': 0.9928968, 'f1': 0.8224119, 'auroc': 0.99412495}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    1     3    1    1    20    10     5    3     68
1     0  1256    0    13    0    0     0    52     5    1      4
2     3     1  215     1   30    1     3     7    11   37      3
3     2     0    0  7858    0   39     1   340   193    3      1
4     2     1   51     0  301    3     2     7    34   10    128
5     6     0    4    46    0  369     0     0     6   89      1
6    16     1    2     9    3    1  1802     3    14    4     53
7     2    43    9   166    5    0     1  6900   107    1     29
8     3     0    5   124   25    6     3    88  2973    2     66
9     9     1   82    17    1   78     2     5    12  285      1
10   22     5    5     6   73    2    10    24    41    1  12605
---- Validation: 
scalar performance:
{'acc': 0.93358296, 'precision': 0.8323339, 'recall': 0.8145017, 'specificity': 0.9927784, 'f1': 0.8215839, 'auroc': 0.9943199}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     0    1     5    0    0    21     6    10    1     60
1     0  1254    1    13    2    0     0    51     4    0      7
2     5     1  215     1   30    2     4     8    14   26      6
3     2     0    1  7852    0   35     0   361   183    5      1
4     5     0   60     2  292    1     4     9    27    6    133
5     4     0    2    47    0  361     0     1     8   97      1
6    23     0    4     6    5    0  1792     5    16    4     53
7     1    33    6   175    3    0     3  6890   118    2     34
8     0     2   11   122   20   11     5    91  2977    3     54
9    10     0   74    11    2   80     1     5    10  298      2
10   23     7   10    10   69    3     7    23    51    1  12592
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5358567, 'precision': 0.61631846, 'recall': 0.47855747, 'specificity': 0.9518651, 'f1': 0.49107018, 'auroc': 0.8454942}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   292     1    6   17    0    0   704    0     7   45    98
1     0  1342    1   42    0    0    15   37     3    1    58
2     3     8  151    8  202    9    67    3   116   53   395
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  237    0     4    0     3    0  1387
5     2     0    0   51    1  307    28    0    10  181    12
6    10     5    1    0   18    0  1369    0     4    1  1659
7     0    68   21  146    0    0   191  660    38   13    27
8     0     0   24   38   22   10    25    0  1104   49    98
9     3    31  204   56    6   36    93    4    71  562    71
10    0     1    0    0   10    0     0    0     0    0  1635
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-12 10:40:24.601887,epoch time: 0:24:31.768240,used: 3:21:24.245327,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93664384, 'precision': 0.8418521, 'recall': 0.81455594, 'specificity': 0.9929645, 'f1': 0.8267437, 'auroc': 0.99524325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     0    0     7    0    0     9     5     2    1     52
1     0  1245    0    15    0    0     0    59     5    0      8
2     4     0  198     1   41    2     1    15     3   43      4
3     3     0    0  8114    0   24     0   180   110    4      1
4     8     0   36     2  305    2     1     6    24    3    151
5     7     0    1    58    0  354     0     0     9   90      1
6    41     0    1     9    3    0  1797     3     4    2     47
7     3    17    5   338    2    0     3  6798    62    5     31
8    10     0    7   219   34    5     2    98  2830    5     86
9    16     0   57    18    3   82     2     3     6  302      4
10   37     0    4    11   40    1    10    16    17    1  12658
---- Validation: 
scalar performance:
{'acc': 0.9349739, 'precision': 0.842164, 'recall': 0.80878335, 'specificity': 0.9927539, 'f1': 0.82329786, 'auroc': 0.99491954}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    0     2    1    0     6     6     4    3     50
1     0  1238    1    17    1    0     2    65     2    0      6
2     3     1  189     0   33    1     3    13     6   51     12
3     4     1    0  8098    1   29     0   184   118    5      0
4     5     0   39     1  288    2     3     8    22    7    164
5     3     0    3    69    0  343     0     0     5   97      1
6    34     0    2    10    1    0  1801     2     7    2     49
7     3    11    6   344    1    0     3  6784    73    2     38
8     6     0    9   209   25    4     4   119  2829    3     88
9    14     0   56    19    1   75     0     2     9  312      5
10   35     0    6     7   36    1    10    17    23    0  12661
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48898062, 'precision': 0.5970205, 'recall': 0.43128568, 'specificity': 0.9470123, 'f1': 0.45400384, 'auroc': 0.8305454}
confusion matrix:
     0     1    2    3    4    5     6    7    8    9     10
0   419     0    2   13    0    0   594    1    1   18   122
1     1  1305    2   46    0    0    43   37    1    1    63
2     4     2  112    6  187    6    51    3   32   40   572
3     0     0    0    0    0    0     0    0    0    0     0
4     0     0    2    0  143    0     4    0    0    0  1484
5     1     0    0   52    2  257    35    0    4  213    28
6    12     0    1    0    6    0  1283    0    0    1  1764
7     4    46   18  212    0    0   318  492   14   10    50
8     1     0   25   44   51   10    42    0  874   59   264
9     7    17  239   52   15   25   114    5   26  464   173
10    0     0    0    0    6    0     0    0    0    0  1640
better model found
persisted
after epoch: 9,now: 2024-08-12 11:05:33.039703,epoch time: 0:25:08.437816,used: 3:46:32.683143,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94140625, 'precision': 0.8444778, 'recall': 0.83383435, 'specificity': 0.9936791, 'f1': 0.83801645, 'auroc': 0.9957044}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     8    1    0    14     8     5    5     29
1     0  1252    0    12    0    0     0    61     4    0      3
2     5     0  224     1   22    3     2     9     7   37      2
3     1     0    0  8084    0   31     0   206   114    4      0
4     4     0   54     1  315    0     3     8    38    6    110
5     6     0    3    55    0  367     0     0     4   85      1
6    30     0    2    10    1    2  1823     4    14    1     21
7     1    15    6   233    2    0     3  6902    83    3     14
8     3     1    7   167   18    5     3    87  2956    8     38
9    16     0   50    18    0   80     1     3    12  310      3
10   44     1    6     9   82    2    19    26    64    0  12540
---- Validation: 
scalar performance:
{'acc': 0.94085866, 'precision': 0.8388163, 'recall': 0.82877314, 'specificity': 0.9936409, 'f1': 0.8316867, 'auroc': 0.9956752}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     0    0     5    0    0    17     5     5    3     40
1     0  1251    0    15    1    0     0    59     3    0      3
2     5     1  223     0   21    1     2    10    10   38      1
3     2     1    0  8055    0   35     0   212   134    1      0
4     6     0   67     0  293    1     5    10    40    8    109
5     8     0    3    50    0  367     0     0     5   87      1
6    37     0    0     9    1    0  1821     8     6    1     25
7     2    18    6   225    1    0     2  6928    68    0     15
8     3     2    6   167   15   12    11    82  2965    6     27
9    15     0   61    13    1   79     3     2    10  309      0
10   46     0    9     8   68    2    17    28    62    2  12554
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5955363, 'precision': 0.63680106, 'recall': 0.49832177, 'specificity': 0.9581559, 'f1': 0.51939327, 'auroc': 0.85451275}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   550     0    2   23    0    0   536    0     1   18    40
1     2  1326    2   49    0    0    27   36     1    1    55
2     4     4  130   12  230    5    97    3   117   49   364
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  244    0    13    0     5    0  1369
5     7     0    0   83    2  259    38    0     4  181    18
6    20     0    1    0    4    0  2266    0     4    1   771
7     4    28   13  301    0    0   224  537    30   10    17
8     1     0    9   67   30   10    63    0  1053   40    97
9    14    20  162   80   17   30   141    4    54  510   105
10    0     0    0    0    9    0     0    0     0    0  1637
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-12 11:31:10.279615,epoch time: 0:25:37.239912,used: 4:12:09.923055,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:12:09.923055 at 2024-08-12 11:31:10.279615
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5955363, 'precision': 0.63680106, 'recall': 0.49832177, 'specificity': 0.9581559, 'f1': 0.51939327, 'auroc': 0.85451275}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   550     0    2   23    0    0   536    0     1   18    40
1     2  1326    2   49    0    0    27   36     1    1    55
2     4     4  130   12  230    5    97    3   117   49   364
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  244    0    13    0     5    0  1369
5     7     0    0   83    2  259    38    0     4  181    18
6    20     0    1    0    4    0  2266    0     4    1   771
7     4    28   13  301    0    0   224  537    30   10    17
8     1     0    9   67   30   10    63    0  1053   40    97
9    14    20  162   80   17   30   141    4    54  510   105
10    0     0    0    0    9    0     0    0     0    0  1637
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5955363, 'precision': 0.63680106, 'recall': 0.49832177, 'specificity': 0.9581559, 'f1': 0.51939327, 'auroc': 0.85451275}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   550     0    2   23    0    0   536    0     1   18    40
1     2  1326    2   49    0    0    27   36     1    1    55
2     4     4  130   12  230    5    97    3   117   49   364
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  244    0    13    0     5    0  1369
5     7     0    0   83    2  259    38    0     4  181    18
6    20     0    1    0    4    0  2266    0     4    1   771
7     4    28   13  301    0    0   224  537    30   10    17
8     1     0    9   67   30   10    63    0  1053   40    97
9    14    20  162   80   17   30   141    4    54  510   105
10    0     0    0    0    9    0     0    0     0    0  1637
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_07_19_00_seed_0_24142623_instance_wise_predictions.txt
accuracy from prediction file 0.5955362764989856
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/15.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 487514 KiB |  10924 MiB | 516788 GiB | 516787 GiB |
|       from large pool | 396800 KiB |  10851 MiB | 516207 GiB | 516206 GiB |
|       from small pool |  90714 KiB |    127 MiB |    580 GiB |    580 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 487514 KiB |  10924 MiB | 516788 GiB | 516787 GiB |
|       from large pool | 396800 KiB |  10851 MiB | 516207 GiB | 516206 GiB |
|       from small pool |  90714 KiB |    127 MiB |    580 GiB |    580 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10910 MiB | 515698 GiB | 515698 GiB |
|       from large pool | 387840 KiB |  10837 MiB | 515119 GiB | 515119 GiB |
|       from small pool |  90258 KiB |    126 MiB |    579 GiB |    578 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11368 MiB |  11368 MiB |  11368 MiB |      0 B   |
|       from large pool |  11240 MiB |  11240 MiB |  11240 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1963 MiB |   2515 MiB | 227909 GiB | 227907 GiB |
|       from large pool |   1954 MiB |   2513 MiB | 227291 GiB | 227289 GiB |
|       from small pool |      9 MiB |     10 MiB |    617 GiB |    617 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   27173 K  |   27170 K  |
|       from large pool |      87    |     491    |   14220 K  |   14220 K  |
|       from small pool |    2922    |    4522    |   12952 K  |   12949 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   27173 K  |   27170 K  |
|       from large pool |      87    |     491    |   14220 K  |   14220 K  |
|       from small pool |    2922    |    4522    |   12952 K  |   12949 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     184    |     184    |     184    |       0    |
|       from large pool |     120    |     120    |     120    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      61    |    1102    |   13947 K  |   13947 K  |
|       from large pool |      28    |      72    |    7070 K  |    7070 K  |
|       from small pool |      33    |    1072    |    6876 K  |    6876 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10924 MiB | 516788 GiB | 516788 GiB |
|       from large pool |  16640 KiB |  10851 MiB | 516207 GiB | 516207 GiB |
|       from small pool |      0 KiB |    127 MiB |    580 GiB |    580 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10924 MiB | 516788 GiB | 516788 GiB |
|       from large pool |  16640 KiB |  10851 MiB | 516207 GiB | 516207 GiB |
|       from small pool |      0 KiB |    127 MiB |    580 GiB |    580 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10910 MiB | 515698 GiB | 515698 GiB |
|       from large pool |  16640 KiB |  10837 MiB | 515119 GiB | 515119 GiB |
|       from small pool |      0 KiB |    126 MiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2440 MiB |  11368 MiB |  11368 MiB |   8928 MiB |
|       from large pool |   2342 MiB |  11240 MiB |  11240 MiB |   8898 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2515 MiB | 227909 GiB | 227909 GiB |
|       from large pool | 134912 KiB |   2513 MiB | 227291 GiB | 227291 GiB |
|       from small pool |      0 KiB |     33 MiB |    617 GiB |    617 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27173 K  |   27173 K  |
|       from large pool |       2    |     491    |   14220 K  |   14220 K  |
|       from small pool |       0    |    4522    |   12952 K  |   12952 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27173 K  |   27173 K  |
|       from large pool |       2    |     491    |   14220 K  |   14220 K  |
|       from small pool |       0    |    4522    |   12952 K  |   12952 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     184    |     184    |     104    |
|       from large pool |      31    |     120    |     120    |      89    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1102    |   13947 K  |   13947 K  |
|       from large pool |       3    |      72    |    7071 K  |    7071 K  |
|       from small pool |       0    |    1072    |    6876 K  |    6876 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10924 MiB | 516788 GiB | 516788 GiB |
|       from large pool |  16640 KiB |  10851 MiB | 516207 GiB | 516207 GiB |
|       from small pool |      0 KiB |    127 MiB |    580 GiB |    580 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10924 MiB | 516788 GiB | 516788 GiB |
|       from large pool |  16640 KiB |  10851 MiB | 516207 GiB | 516207 GiB |
|       from small pool |      0 KiB |    127 MiB |    580 GiB |    580 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10910 MiB | 515698 GiB | 515698 GiB |
|       from large pool |  16640 KiB |  10837 MiB | 515119 GiB | 515119 GiB |
|       from small pool |      0 KiB |    126 MiB |    579 GiB |    579 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2440 MiB |  11368 MiB |  11368 MiB |   8928 MiB |
|       from large pool |   2342 MiB |  11240 MiB |  11240 MiB |   8898 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2515 MiB | 227909 GiB | 227909 GiB |
|       from large pool | 134912 KiB |   2513 MiB | 227291 GiB | 227291 GiB |
|       from small pool |      0 KiB |     33 MiB |    617 GiB |    617 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27173 K  |   27173 K  |
|       from large pool |       2    |     491    |   14220 K  |   14220 K  |
|       from small pool |       0    |    4522    |   12952 K  |   12952 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27173 K  |   27173 K  |
|       from large pool |       2    |     491    |   14220 K  |   14220 K  |
|       from small pool |       0    |    4522    |   12952 K  |   12952 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     184    |     184    |     104    |
|       from large pool |      31    |     120    |     120    |      89    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1102    |   13947 K  |   13947 K  |
|       from large pool |       3    |      72    |    7071 K  |    7071 K  |
|       from small pool |       0    |    1072    |    6876 K  |    6876 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623

 Experiment start at: 2024-08-12 11:43:45.458129
before training, model accuracy: 0.06989435851573944
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.80292165, 'precision': 0.41704586, 'recall': 0.41361094, 'specificity': 0.97744197, 'f1': 0.4128568, 'auroc': 0.94004524}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    30   0   0  194    40   126   0     93
1    0  1021   0    17   0   0    0   224     4   0     65
2    0     0   0    23   0   0   60    49   160   0     20
3    0     2   0  7744   0   0    0   457   216   0     18
4    0     0   0    13   0   0   70    19   148   0    289
5    0     0   0   360   0   0   14     4   141   0      2
6    0     1   0    47   0   0  928    66   408   0    457
7    0    24   0   896   0   0   10  6020   160   0    155
8    0     0   0   698   0   0  107   237  1917   0    336
9    0     0   0   152   0   0   59    38   243   0      1
10   0     2   0    22   0   0  112    86   191   0  12380
---- Validation: 
scalar performance:
{'acc': 0.8025144, 'precision': 0.41505548, 'recall': 0.4146767, 'specificity': 0.977463, 'f1': 0.41269422, 'auroc': 0.94006205}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    32   0   0  197    29   145   0     80
1    0  1047   0    17   0   0    0   199     2   0     67
2    0     0   0    20   0   0   66    47   158   0     21
3    0     1   0  7743   0   0    2   468   203   0     23
4    0     0   0    10   0   0   76    20   138   0    295
5    0     0   0   351   0   0   12     2   154   0      2
6    0     2   0    45   0   0  920    72   423   0    446
7    0    36   0   894   0   0   11  5994   180   0    150
8    0     0   0   689   0   0  119   251  1924   0    313
9    0     1   0   138   0   0   52    39   262   0      1
10   0     2   0    27   0   0  106    88   199   0  12374
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.380396, 'precision': 0.24554202, 'recall': 0.2903314, 'specificity': 0.93489754, 'f1': 0.2411882, 'auroc': 0.7475395}
confusion matrix:
    0    1   2    3   4   5     6    7    8   9     10
0    0    0   0    5   0   0   900    3  259   0     3
1    0  935   0   18   0   0    29   72  107   0   338
2    0    1   0   16   0   0   457    0  415   0   126
3    0    0   0    0   0   0     0    0    0   0     0
4    0    0   0    0   0   0    78    0    9   0  1546
5    0    0   0  247   0   0    19    0  324   0     2
6    0    0   0    0   0   0  1485    0   94   0  1488
7    0  134   0    7   0   0    78  655  228   0    62
8    0    0   0   24   0   0   583    0  719   0    44
9    0    9   0   90   0   0   222    3  794   0    19
10   0    0   0    0   0   0     3    0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 12:09:28.292333,epoch time: 0:25:42.834204,used: 0:25:42.834204,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.854131, 'precision': 0.5494939, 'recall': 0.49116427, 'specificity': 0.9837656, 'f1': 0.48603258, 'auroc': 0.9731136}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    22   0   0   328    15    51   4     62
1    0  1135   0    18   0   0     0   145     2   0     32
2    0     0   0    15   0   3   116    53    97   3     25
3    0     0   0  7780   0   1     2   359   287   0      8
4    0     0   0     9   0   0   131    10   129   1    259
5    0     0   0   339   0  74    52     1    40  12      2
6    0     0   0    25   0   3  1544    31   114   0    190
7    0    35   0   559   0   0     9  6400   179   0     81
8    0     0   0   362   0   0    58   137  2605   0    134
9    0     0   0   132   0  34   162    29   116  19      1
10   0     3   0    17   0   0   202    49   157   0  12367
---- Validation: 
scalar performance:
{'acc': 0.8536846, 'precision': 0.65709513, 'recall': 0.4950943, 'specificity': 0.98372704, 'f1': 0.4918189, 'auroc': 0.9732299}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    30   0   2   326    17    51   1     56
1    0  1142   0    17   0   0     0   143     4   0     26
2    0     0   1    13   0   0   118    51   107   2     20
3    0     0   0  7785   0   0     1   364   284   0      6
4    0     0   0     4   0   0   110    12   144   0    269
5    0     0   0   326   0  87    54     2    40  12      0
6    0     2   0    25   0   4  1558    28   110   0    181
7    0    36   0   559   0   0     6  6375   193   0     96
8    0     1   0   355   0   1    61   157  2591   0    130
9    0     0   0   127   0  30   161    30   118  25      2
10   0     3   0    18   0   1   205    57   161   0  12351
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4464423, 'precision': 0.3600396, 'recall': 0.31397957, 'specificity': 0.9399692, 'f1': 0.27639014, 'auroc': 0.78571814}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     0   0    3   0   1  1143    1   15   6     1
1    0  1147   0   21   0   0    92   33   48   0   158
2    0     2   0   16   0   6   795    1   97  12    86
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0   130    0    5   0  1498
5    0     0   0  257   0  66   112    0   62  94     1
6    0     0   0    0   0   0  2592    0    7   0   468
7    0   353   0    8   0   0   375  336   54   0    38
8    0     0   0   39   0   1   751    0  547   7    25
9    0    10   0  102   0  24   661    2  263  57    18
10   0     0   0    0   0   0    10    0    0   0  1636
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 12:34:51.013775,epoch time: 0:25:22.721442,used: 0:51:05.555646,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.88334763, 'precision': 0.7692553, 'recall': 0.6011946, 'specificity': 0.9871733, 'f1': 0.61418205, 'auroc': 0.9826974}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   81     0   0    19   0    3   214    23    41   49     53
1    0  1132   0    17   0    0     2   164     5    0     11
2    7     0   8     6   7    4    11    52   103   96     18
3    0     0   0  7704   0   22     0   452   258    2      1
4    3     0   2     2  21    1    40    20   166   18    266
5    4     0   0   153   0  267     4     1    16   75      1
6    1     1   0    13   0    8  1670    33    68    8    105
7    0    16   0   289   0    0     4  6757   158    0     39
8    0     0   0   252   0    5    10   149  2800    6     73
9    7     1   3    63   1   84    17    25    53  239      0
10   3     4   0     7   1    3   116    95   222    5  12337
---- Validation: 
scalar performance:
{'acc': 0.8828407, 'precision': 0.7742424, 'recall': 0.60218817, 'specificity': 0.9870934, 'f1': 0.61654246, 'auroc': 0.9822294}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   82     0   0    18   0    7   211    22    37   46     60
1    0  1140   0    17   0    0     1   158     6    0     10
2    7     0  13     4   5    2    14    53   101   94     19
3    0     0   0  7670   0   26     0   471   271    1      1
4    2     0   2     2  18    2    45    23   159   27    259
5    1     0   0   172   0  262     2     0    15   67      2
6    0     1   0    17   0    8  1637    34    74   11    126
7    0    15   0   289   0    0     1  6759   159    0     42
8    0     0   0   258   0    5     9   133  2825    3     63
9    7     0   4    60   0   76    15    28    54  247      2
10  10     5   2    13   1    2   118    82   209    2  12352
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5085706, 'precision': 0.4857577, 'recall': 0.41835082, 'specificity': 0.9483799, 'f1': 0.37997466, 'auroc': 0.8309665}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0    9     0   0    4   0   10  1054    0    25   65     3
1    0  1253   0   27   0    0    41   47    57    2    72
2    0    10   0   16   0   20   325    5   332   95   212
3    0     0   0    0   0    0     0    0     0    0     0
4    0     2   0    0   0    0    37    0    16    1  1577
5    0     0   0  152   0  289    21    0    33   96     1
6    0     1   0    0   0    0  2070    0    56    2   938
7    0   324   0   14   0    0   202  460   119   14    31
8    0     0   0   60   0   12   114    1  1048   62    73
9    0    21   0   75   0  103   156    2   266  496    18
10   0     1   0    0   0    0     1    0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 12:59:52.366598,epoch time: 0:25:01.352823,used: 1:16:06.908469,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90210295, 'precision': 0.7886957, 'recall': 0.6982443, 'specificity': 0.9889802, 'f1': 0.73246187, 'auroc': 0.98721665}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   254     1    3    13    2    2    69    15    20   12     92
1     0  1193    1    19    0    0     0   103     4    0     12
2    11     0  109     4   47    1     4    28    24   72     12
3     0     0    0  7998    0   35     0   251   148    2      3
4    11     0   23     6  166    1     5    13    65   11    238
5     5     0    2   119    0  276     0     1    12  105      1
6    35     3    0    25    3    3  1651    15    35    8    129
7     0    35    1   505    0    0     2  6542   119    1     57
8     1     1    4   324   13    5    12   102  2705    7    121
9    12     1   36    42    2   80     2    15    27  274      2
10   20     6    3    13   26    1    31    52    90    4  12549
---- Validation: 
scalar performance:
{'acc': 0.90279526, 'precision': 0.7873132, 'recall': 0.6929827, 'specificity': 0.9890582, 'f1': 0.7266135, 'auroc': 0.98712206}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   251     1    1    14    2    2    63    17    18   21     93
1     0  1190    0    24    0    0     0   102     5    0     11
2    10     2  101     2   45    1     1    25    36   77     12
3     0     0    0  7971    0   38     0   262   163    3      3
4     8     1   23     2  145    1    10    11    72   15    251
5     2     0    1   117    0  269     0     0    12  119      1
6    32     0    2    27    1    5  1690    16    23    8    104
7     0    43    3   473    3    0     2  6557   115    0     69
8     0     1    1   320    9    3    10   121  2710    2    119
9    14     0   47    45    1   67     3    12    24  277      3
10   21     2    2    15   15    0    29    45    77    0  12590
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.45357868, 'precision': 0.5236503, 'recall': 0.4050726, 'specificity': 0.9433577, 'f1': 0.3897289, 'auroc': 0.8374837}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   294     0   0    4    0    2   750    0    23   52    45
1     0  1316   0   31    1    0    28   20    29    2    72
2    10    12  30   15  139   14    98    1   190   88   418
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   0    0   73    0     4    0     5    0  1550
5     4     0   0  105    0  290    15    0    34  140     4
6     9     2   0    0   36    0  1040    0    24    4  1952
7     1   523  17   30    0    0   186  251    81    6    69
8     1     0   5   54   16    8    26    0  1002   53   205
9    23    23  64   69   29   51    82    1   208  543    44
10    0     1   0    0    1    0     0    0     0    0  1644
better model found
persisted
after epoch: 4,now: 2024-08-12 13:24:19.917055,epoch time: 0:24:27.550457,used: 1:40:34.458926,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9149454, 'precision': 0.80288863, 'recall': 0.7447877, 'specificity': 0.99062276, 'f1': 0.7655221, 'auroc': 0.9899352}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   299     0    2     6    1    2    62    13    11   14     72
1     0  1228    0    14    0    0     1    79     4    0      6
2     7     1  141     2   21    2     3    19    14   90     12
3     0     0    1  7781    0   32     2   442   175    6      1
4    10     0   54     1  176    2     7    10    67   17    195
5     2     0    1    78    0  326     0     0    10  102      2
6    42     0    1     4    1    6  1736    16    20    4     77
7     2    44    2   221    0    0     2  6848   100    1     41
8     1     1    5   236    8    6    12   144  2797    6     78
9     6     1   34    16    0   86     6     8    17  316      3
10   34     7    6     6   38    2    32    49    70    2  12549
---- Validation: 
scalar performance:
{'acc': 0.9161161, 'precision': 0.80632424, 'recall': 0.7483982, 'specificity': 0.9907727, 'f1': 0.7691841, 'auroc': 0.9900584}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   305     0    1     6    0    1    56    15    19   17     63
1     0  1228    1    18    0    0     2    73     4    0      6
2     9     1  155     2   19    1     2    16    16   85      6
3     1     0    0  7789    0   39     1   432   173    4      1
4    15     0   41     1  176    2     7    15    68   18    196
5     3     0    2    85    0  328     0     1     6   95      1
6    44     0    1     5    2    0  1737    16    26    7     70
7     1    43    2   200    1    0     3  6881    88    4     42
8     3     1    7   229   11    5     9   134  2822    4     71
9     8     1   36    31    0   87     2    11    13  301      3
10   32     6    7     8   33    0    46    48    88    1  12527
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50206393, 'precision': 0.5900148, 'recall': 0.43781376, 'specificity': 0.94821, 'f1': 0.4262863, 'auroc': 0.84843636}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   234     0   1    9    0    2   836    0    29   40    19
1     0  1335   0   33    0    0    19   31    22    1    58
2     2    16  61   18   50   15   114    3   224   91   421
3     0     0   0    0    0    0     0    0     0    0     0
4     0     2   1    0  136    0     6    0     6    0  1482
5     1     0   0  120    0  324    28    0    31   86     2
6     9     4   0    1   24    0  1487    0    17   11  1514
7     1   431   4   39    0    0   215  333    81   14    46
8     0     0   1   53    7    7    34    0  1093   34   141
9     9    33  69   77    2   77    99    1   197  536    37
10    0     1   0    0    8    0     0    0     0    0  1637
better model found
persisted
after epoch: 5,now: 2024-08-12 13:50:05.336780,epoch time: 0:25:45.419725,used: 2:06:19.878651,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.91962755, 'precision': 0.8205172, 'recall': 0.7650379, 'specificity': 0.9911063, 'f1': 0.78823775, 'auroc': 0.99152946}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   333     1    0     3    0    1    43     8    14    3     77
1     0  1232    0     9    1    0     0    78     4    1      7
2     9     2  158     0   40    2     1    17    19   54     10
3     0     1    0  7626    0   27     2   512   265    3      1
4     5     2   35     1  232    0     3    10    47    7    197
5     3     0    3    75    0  320     3     1     5  110      1
6    25     0    1     0    1    0  1759    17    20    2     83
7     1    32    5   137    1    0     1  6927   112    0     48
8     1     2    7   125   14    3    11   134  2891    3    103
9    13     1   60    19    1   67     5     9    15  300      3
10   21     2    5     6   41    2    28    43    50    1  12594
---- Validation: 
scalar performance:
{'acc': 0.9216263, 'precision': 0.8233233, 'recall': 0.77181005, 'specificity': 0.99132884, 'f1': 0.79347867, 'auroc': 0.99207467}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   340     0    0     4    0    0    34    13     9    2     81
1     0  1223    0    14    0    0     1    84     4    0      6
2     5     0  174     1   37    0     4    20    14   50      7
3     1     0    0  7619    0   34     1   517   260    6      2
4    11     0   30     0  235    2     3    12    37    8    201
5     4     0    6    72    0  326     1     1    10  100      1
6    25     1    1     2    1    1  1764    19    15    1     78
7     1    39    2   133    2    0     2  6945    97    1     43
8     4     0    7   117   25    4     9   136  2907    0     87
9    16     1   67    13    1   75     3     6    13  294      4
10   17     3    6     6   29    2    27    32    45    1  12628
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48170432, 'precision': 0.5797309, 'recall': 0.40496883, 'specificity': 0.94571143, 'f1': 0.38602936, 'auroc': 0.831705}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   66     0   0    5   0    0  1029    0    22   13    35
1    0  1346   0   31   0    0    24   27    18    0    53
2    0    20  31   14  63   10   149    3   164   36   525
3    0     0   0    0   0    0     0    0     0    0     0
4    0     0   0    0  98    0     7    0     5    0  1523
5    0     0   0  127   0  296    69    0    45   50     5
6    3     3   0    0   3    1  1662    0     4    1  1390
7    0   411   4   42   0    0   198  385    80    1    43
8    0     0   1   43   6    5    60    0  1041    5   209
9    0    46  77   78   9   72   186    1   258  318    92
10   0     1   0    0   3    0     0    0     0    0  1642
better model found
persisted
after epoch: 6,now: 2024-08-12 14:15:28.756108,epoch time: 0:25:23.419328,used: 2:31:43.297979,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9278681, 'precision': 0.83973604, 'recall': 0.7800642, 'specificity': 0.99199665, 'f1': 0.8027297, 'auroc': 0.9932059}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   355     0    0     6    0    0    27    17    12    0     66
1     0  1238    0    15    0    0     0    69     6    0      4
2     4     1  197     2   26    3     3    19    13   39      5
3     0     0    0  7896    0   24     0   377   138    2      0
4     4     0   58     0  210    2     4    14    61    5    181
5     1     0    3    74    0  359     0     1     9   73      1
6    21     0    2    15    0    1  1771    16    18    2     61
7     0    22    1   194    2    0     1  6956    67    0     20
8     0     1    4   231   11    1     6   139  2845    2     55
9     5     1   81    29    0   87     4     6    12  264      3
10   27     2    6     9   26    1    20    52    63    0  12589
---- Validation: 
scalar performance:
{'acc': 0.9273773, 'precision': 0.8312005, 'recall': 0.7760472, 'specificity': 0.99198246, 'f1': 0.79798377, 'auroc': 0.99312073}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     1    0     8    1    0    31    17    15    5     59
1     0  1235    1    13    0    0     0    72     5    0      6
2     8     0  194     4   24    2     2    20    14   38      6
3     1     0    0  7929    0   28     0   350   132    0      0
4     5     0   52     0  233    2     2    15    54    7    169
5     2     0    4    86    0  340     2     0     8   77      2
6    27     1    1    16    2    2  1752    11    24    1     71
7     0    21    1   191    1    0     2  6954    76    0     19
8     1     1    6   221    8    1     6   132  2869    1     50
9     6     1   79    28    0   91     5    12    12  256      3
10   30     3   11     7   38    1    20    43    79    2  12562
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4582663, 'precision': 0.5849, 'recall': 0.39167264, 'specificity': 0.94413936, 'f1': 0.37271833, 'auroc': 0.83761615}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   79     0   2   26    0    0   921    1    39   19    83
1    0  1333   0   48    0    0    17   27    16    0    58
2    0    18  43   44   37   13    70    3   329   32   426
3    0     0   0    0    0    0     0    0     0    0     0
4    0     1   0    1  103    0     4    0     9    0  1515
5    0     0   0  264    0  242    29    0    27   28     2
6    3     2   1    1    2    1  1286    0    29    1  1741
7    0   273   2  141    0    0   158  473    93    1    23
8    0     0   1  120    1    3    15    0  1150    1    79
9    0    45  99  209    2   90   104    4   328  198    58
10   0     0   0    0    3    0     0    0     0    0  1643
better model found
persisted
after epoch: 7,now: 2024-08-12 14:43:33.925152,epoch time: 0:28:05.169044,used: 2:59:48.467023,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9333797, 'precision': 0.83823705, 'recall': 0.8002295, 'specificity': 0.9926824, 'f1': 0.8174405, 'auroc': 0.993797}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     0    1     6    0    0    20     8     7    2     65
1     0  1238    0    14    0    0     0    72     4    0      4
2     6     0  182     3   41    0     2    14    15   44      5
3     1     0    0  7870    0   39     0   326   197    2      4
4     7     0   36     1  280    1     5     7    42    7    153
5     2     0    0    58    0  356     1     0    10   93      1
6    31     0    0     5    2    1  1790    11    18    1     48
7     1    15    4   172    2    0     2  6946    76    3     41
8     4     0    4   131   22    2     5   120  2941    3     62
9     8     0   58    13    1   78     7     8    15  299      6
10   19     3    9     6   48    2    15    28    54    0  12610
---- Validation: 
scalar performance:
{'acc': 0.9337435, 'precision': 0.84543884, 'recall': 0.8039057, 'specificity': 0.9927107, 'f1': 0.8227341, 'auroc': 0.9940933}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     0    0     7    1    0    25     7     6    0     55
1     0  1237    0    15    0    0     0    71     3    0      6
2     7     1  182     1   40    1     2    21    13   35      9
3     1     0    0  7850    0   34     0   344   209    2      0
4     4     0   26     2  293    1     6     6    36    8    157
5     2     0    3    52    1  355     1     0    10   96      1
6    24     0    0    10    0    1  1802     8    20    1     42
7     1    15    4   186    1    0     1  6940    82    0     35
8     2     0    3   129   24    6     8   120  2931    1     72
9    10     0   64    16    2   71     8     8    13  300      1
10   21     1    4     7   37    2    18    21    48    1  12636
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5025537, 'precision': 0.5999377, 'recall': 0.43201128, 'specificity': 0.94802487, 'f1': 0.4178639, 'auroc': 0.83565205}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   89     0   0    5    0    0   983    0    26   12    55
1    0  1296   0   47    0    0    27   34    26    0    69
2    1     5  35   13   76   14    92    2   274   39   464
3    0     0   0    0    0    0     0    0     0    0     0
4    0     0   0    0  152    0     4    0     7    0  1470
5    0     0   0   82    0  346    63    0    29   67     5
6    3     1   0    1    2    1  1630    0    16    2  1411
7    0   121   3  120    0    0   243  508   105    4    60
8    0     0   1   40    8   13    38    0  1154    6   110
9    0    21  65   89    8   88   158    2   295  333    78
10   0     0   0    0    6    0     0    0     0    0  1640
better model found
persisted
after epoch: 8,now: 2024-08-12 15:08:59.812982,epoch time: 0:25:25.887830,used: 3:25:14.354853,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93506527, 'precision': 0.8332609, 'recall': 0.82496995, 'specificity': 0.99297523, 'f1': 0.8276986, 'auroc': 0.9942537}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     0    0     2    1    0    13     7     6    2     54
1     0  1266    0    12    1    0     0    46     3    0      3
2     4     1  208     1   32    1     2     9     6   47      1
3     2     2    0  7946    1   27     1   321   136    3      0
4     4     0   47     2  345    1     1     9    20    6    104
5     3     0    3    69    0  317     0     0     6  122      1
6    35     0    1     4    5    0  1800     9    12    2     40
7     2    59    7   159    5    0     3  6923    75    1     29
8     3     2    7   198   38    4     6   102  2877    2     56
9     5     1   63    17    2   47     5     5     5  342      1
10   23     2    7     5  134    2    15    29    46    2  12527
---- Validation: 
scalar performance:
{'acc': 0.9350274, 'precision': 0.83026457, 'recall': 0.8222501, 'specificity': 0.99299705, 'f1': 0.8249378, 'auroc': 0.99439406}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   395     1    0     6    3    0    15     7     4    3     49
1     0  1267    1    13    0    0     1    45     2    0      3
2     6     3  202     1   35    1     1    12     8   40      3
3     3     0    0  7963    0   26     1   322   122    3      0
4     5     0   33     2  353    0     4     8    26    8    100
5     0     0    2    72    1  315     1     0     7  122      1
6    48     0    0     3    2    0  1785    13    13    4     40
7     3    64    2   148    8    0     2  6926    85    2     25
8     4     2   10   187   38    2     5   111  2887    4     46
9     5     0   62    19    2   55     1     2     8  336      3
10   33     3    9     8  134    1    13    25    42    1  12527
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5072413, 'precision': 0.59845, 'recall': 0.425786, 'specificity': 0.9487024, 'f1': 0.416937, 'auroc': 0.84731174}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   129     1    1    7    0    0   938    0    12   24    58
1     0  1394    0   39    0    0    10    6    14    0    36
2     1    23   73   13  140    7    91    0   220   64   383
3     0     0    0    0    0    0     0    0     0    0     0
4     0     2    0    0  369    0     4    0    10    0  1248
5     0     0    0  130    0  265    55    0    15  122     5
6     3     5    1    1   23    1  1638    0    14    4  1377
7     0   510    5  109    0    0   188  233    79    3    37
8     0     1    3   56   21   10    40    1  1116   11   111
9     1    68  139  102    3   40   139    1   168  419    57
10    0     1    0    0   31    0     0    0     0    0  1614
better model found
persisted
after epoch: 9,now: 2024-08-12 15:33:59.971428,epoch time: 0:25:00.158446,used: 3:50:14.513299,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9392391, 'precision': 0.84999466, 'recall': 0.8139335, 'specificity': 0.99336624, 'f1': 0.826501, 'auroc': 0.9952039}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     1    0     7    0    0    14     4     3    4     38
1     0  1238    0    16    0    0     0    68     7    0      3
2     2     0  199     0   27    0     1     9     8   60      6
3     1     3    0  7996    0   21     0   289   129    0      0
4     9     0   38     1  249    2     6     6    41   10    177
5     2     0    1    59    0  320     0     0     8  129      1
6    52     1    0     9    0    2  1792     3    14    3     31
7     1    10    2   171    1    0     2  6967    92    2     15
8     7     0    2   160   12    1     6    87  2985    3     33
9     9     0   41    14    2   49     3     5    10  354      5
10   50     6    7     8   31    3    18    25    52    0  12594
---- Validation: 
scalar performance:
{'acc': 0.93861175, 'precision': 0.8520231, 'recall': 0.81382483, 'specificity': 0.9932876, 'f1': 0.8269543, 'auroc': 0.995094}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0     5    0    0    16     7     9    1     31
1     0  1240    0    12    0    0     0    68     9    0      3
2     4     1  192     2   24    1     2     9     9   60      8
3     0     0    0  7991    0   25     0   266   157    1      0
4     6     0   43     1  250    2     5     7    43    7    175
5     4     0    3    61    0  322     0     0     6  124      1
6    55     1    1     6    0    1  1783     6     9    2     44
7     1    16    3   174    2    0     1  6949    94    4     21
8     4     0    6   162    9    2     4    92  2969    7     41
9     9     0   37    16    1   46     5     5     8  366      0
10   44     2    1     8   27    2    14    26    56    2  12614
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5116491, 'precision': 0.6079323, 'recall': 0.44284928, 'specificity': 0.94963384, 'f1': 0.44106555, 'auroc': 0.8415313}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   312     0   1    9    0    0   672    0    37   22   117
1     0  1285   1   52    0    0    19   37    44    0    61
2     2     2  51   15   79    9    28    1   311   59   458
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  113    0     4    0    10    0  1506
5     0     0   0  112    0  277    33    0    29  132     9
6     3     0   0    1    5    1  1528    0    36    2  1491
7     0    76   3  196    0    0   171  489   198    6    25
8     0     0   1   51    4    7     8    0  1182    5   112
9     3    13  68   90    5   53    79    3   290  433   100
10    0     0   0    0    3    0     0    0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-12 16:00:55.340938,epoch time: 0:26:55.369510,used: 4:17:09.882809,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:17:09.882809 at 2024-08-12 16:00:55.340938
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5116491, 'precision': 0.6079323, 'recall': 0.44284928, 'specificity': 0.94963384, 'f1': 0.44106555, 'auroc': 0.8415313}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   312     0   1    9    0    0   672    0    37   22   117
1     0  1285   1   52    0    0    19   37    44    0    61
2     2     2  51   15   79    9    28    1   311   59   458
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  113    0     4    0    10    0  1506
5     0     0   0  112    0  277    33    0    29  132     9
6     3     0   0    1    5    1  1528    0    36    2  1491
7     0    76   3  196    0    0   171  489   198    6    25
8     0     0   1   51    4    7     8    0  1182    5   112
9     3    13  68   90    5   53    79    3   290  433   100
10    0     0   0    0    3    0     0    0     0    0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5116491, 'precision': 0.6079323, 'recall': 0.44284928, 'specificity': 0.94963384, 'f1': 0.44106555, 'auroc': 0.8415313}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   312     0   1    9    0    0   672    0    37   22   117
1     0  1285   1   52    0    0    19   37    44    0    61
2     2     2  51   15   79    9    28    1   311   59   458
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  113    0     4    0    10    0  1506
5     0     0   0  112    0  277    33    0    29  132     9
6     3     0   0    1    5    1  1528    0    36    2  1491
7     0    76   3  196    0    0   171  489   198    6    25
8     0     0   1   51    4    7     8    0  1182    5   112
9     3    13  68   90    5   53    79    3   290  433   100
10    0     0   0    0    3    0     0    0     0    0  1643
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_11_43_45_seed_1_24142623_instance_wise_predictions.txt
accuracy from prediction file 0.5116490589799202
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 485105 KiB |  10924 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 393472 KiB |  10851 MiB |   1008 TiB |   1008 TiB |
|       from small pool |  91633 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 485105 KiB |  10924 MiB |   1009 TiB |   1009 TiB |
|       from large pool | 393472 KiB |  10851 MiB |   1008 TiB |   1008 TiB |
|       from small pool |  91633 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478828 KiB |  10910 MiB |   1007 TiB |   1007 TiB |
|       from large pool | 387840 KiB |  10837 MiB |   1006 TiB |   1006 TiB |
|       from small pool |  90988 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11374 MiB |  11374 MiB |  20302 MiB |   8928 MiB |
|       from large pool |  11246 MiB |  11246 MiB |  20144 MiB |   8898 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1946 MiB |   2515 MiB | 429875 GiB | 429874 GiB |
|       from large pool |   1931 MiB |   2513 MiB | 428640 GiB | 428638 GiB |
|       from small pool |     14 MiB |     33 MiB |   1235 GiB |   1235 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3951    |    5175    |   54344 K  |   54341 K  |
|       from large pool |      87    |     491    |   28441 K  |   28441 K  |
|       from small pool |    3864    |    5069    |   25903 K  |   25899 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3951    |    5175    |   54344 K  |   54341 K  |
|       from large pool |      87    |     491    |   28441 K  |   28441 K  |
|       from small pool |    3864    |    5069    |   25903 K  |   25899 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     183    |     184    |     287    |     104    |
|       from large pool |     119    |     120    |     208    |      89    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    1102    |   27333 K  |   27333 K  |
|       from large pool |      29    |      79    |   13535 K  |   13535 K  |
|       from small pool |      44    |    1072    |   13798 K  |   13798 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10924 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10851 MiB |   1008 TiB |   1008 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10924 MiB |   1009 TiB |   1009 TiB |
|       from large pool |  16640 KiB |  10851 MiB |   1008 TiB |   1008 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10910 MiB |   1007 TiB |   1007 TiB |
|       from large pool |  16640 KiB |  10837 MiB |   1006 TiB |   1006 TiB |
|       from small pool |      0 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2420 MiB |  11374 MiB |  20302 MiB |  17882 MiB |
|       from large pool |   2316 MiB |  11246 MiB |  20144 MiB |  17828 MiB |
|       from small pool |    104 MiB |    128 MiB |    158 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2515 MiB | 429876 GiB | 429876 GiB |
|       from large pool | 134912 KiB |   2513 MiB | 428640 GiB | 428640 GiB |
|       from small pool |      0 KiB |     35 MiB |   1235 GiB |   1235 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5175    |   54344 K  |   54344 K  |
|       from large pool |       2    |     491    |   28441 K  |   28441 K  |
|       from small pool |       0    |    5069    |   25903 K  |   25903 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5175    |   54344 K  |   54344 K  |
|       from large pool |       2    |     491    |   28441 K  |   28441 K  |
|       from small pool |       0    |    5069    |   25903 K  |   25903 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     184    |     287    |     205    |
|       from large pool |      30    |     120    |     208    |     178    |
|       from small pool |      52    |      64    |      79    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1102    |   27334 K  |   27334 K  |
|       from large pool |       3    |      79    |   13535 K  |   13535 K  |
|       from small pool |       0    |    1072    |   13799 K  |   13799 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 16:06:15 2024]
Finished job 0.
1 of 1 steps (100%) done
