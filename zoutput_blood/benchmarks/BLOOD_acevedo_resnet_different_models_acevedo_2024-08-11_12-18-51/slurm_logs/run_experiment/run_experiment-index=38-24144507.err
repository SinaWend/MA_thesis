Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Aug 12 11:52:33 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/38.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=38
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_12_03_24_seed_0_24144507

 Experiment start at: 2024-08-12 12:03:25.020304
before training, model accuracy: 0.07954943180084229
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7707352, 'precision': 0.4876849, 'recall': 0.4041958, 'specificity': 0.9737088, 'f1': 0.4069663, 'auroc': 0.90813416}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0    0    6   0    48   0   0   274    41    30   23     61
1    0  609   0    25   2   0     7   644     3    0     42
2    0    3   0    36   0   0   169    31    37   16     20
3    0    9   0  7319   0   1    17   894   151    6     41
4    0    6   0    19   0   0   139    26    44    3    301
5    0    0   0   344   1   3    40    13     7  110      3
6    0   27   0    97   0   0  1331    82    68   12    291
7    0   45   0   714   1   0    41  6122   155    0    186
8    0   11   0   656   1   1   260   353  1253   13    747
9    0    1   0   140   0   0   163    28    28  125      8
10   0   24   0    56   2   0   235   359    69    2  12045
---- Validation: 
scalar performance:
{'acc': 0.7692925, 'precision': 0.47774148, 'recall': 0.39846498, 'specificity': 0.9735, 'f1': 0.4016883, 'auroc': 0.90610266}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0    0    6   0    42   0   0   271    49    27   25     63
1    0  592   0    23   2   0     6   670     5    0     34
2    0    3   0    34   0   0   171    32    20   24     28
3    0    1   0  7326   2   1    27   879   157    3     44
4    0    0   0    15   0   0   145    21    53    5    300
5    0    1   0   336   0   2    45    16    14  104      3
6    0    7   0   101   0   0  1330    88    64   15    303
7    0   35   0   747   1   0    37  6086   160    0    199
8    0    5   0   669   0   0   233   374  1261   11    743
9    0    2   0   159   0   1   176    23    20  102     10
10   0   29   0    60   4   0   236   345    58    3  12061
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32281536, 'precision': 0.24281935, 'recall': 0.24812633, 'specificity': 0.92780966, 'f1': 0.2130043, 'auroc': 0.6937693}
confusion matrix:
    0    1   2    3   4   5     6    7    8    9     10
0    0    0   0    8   0   0  1077    3   12   65     5
1    0  515   0   19   0   0   159  454   27    6   319
2    0    0   0   53   0   0   557   17  175   46   167
3    0    0   0    0   0   0     0    0    0    0     0
4    0    0   0    0   0   0    90    2    8    0  1533
5    0    0   0  198   0   0   111    0   43  237     3
6    0    0   0    8   0   0  1273   14  159    2  1611
7    0   50   0   16   0   0   408  628   44    1    17
8    0    0   0   36   0   0   752    0  379   84   119
9    0    4   0  158   0   0   562   29  176  182    26
10   0    0   0    0   0   0     9    0    0    0  1637
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 12:50:10.458769,epoch time: 0:46:45.438465,used: 0:46:45.438465,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_12_03_24_seed_0_24144507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.4750107, 'precision': 0.30947405, 'recall': 0.18246001, 'specificity': 0.93895864, 'f1': 0.17078865, 'auroc': 0.7330539}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9     10
0    0   0   0   337   0   0    1   110    3   1    31
1    0  80   0   180   1   0    0  1056    0   0    15
2    0   0   0   221   1   0    1    77    2   2     8
3    0   0   0  7615  13   0    0   769    5   0    37
4    0   0   0   308   0   0    0   150    8   2    71
5    0   0   0   477   0   0    0    29    1   7     7
6    0   2   0  1040   1   1  108   481   34  30   210
7    0   2   0  4302   7   0    0  2852   12   1    87
8    0   0   0  2570   4   0    0   406  110   1   204
9    0   0   0   427   1   0    0    47    2   8     7
10   0  11   0  3176  27   0   69  2146  372  11  6981
---- Validation: 
scalar performance:
{'acc': 0.47615352, 'precision': 0.30291283, 'recall': 0.18220925, 'specificity': 0.9391563, 'f1': 0.16959411, 'auroc': 0.7319997}
confusion matrix:
    0   1   2     3   4   5   6     7    8   9     10
0    0   0   0   357   0   0   1    87   12   1    25
1    0  66   0   183   3   0   0  1064    0   0    16
2    0   0   0   233   2   0   1    69    1   1     5
3    0   0   0  7637  16   0   0   750    9   0    28
4    0   0   0   297   0   0   3   140    9   2    88
5    0   0   0   478   1   0   1    31    1   6     3
6    0   1   0  1044   1   0  96   482   46  30   208
7    0   0   0  4259   8   0   0  2901   10   0    87
8    0   0   0  2580   7   0   2   409  106   1   191
9    0   0   0   433   0   0   2    40    0  11     7
10   0  13   0  3093  40   1  81  2151  424   9  6984
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.15539075, 'precision': 0.092018634, 'recall': 0.13321172, 'specificity': 0.9141412, 'f1': 0.07336653, 'auroc': 0.5740173}
confusion matrix:
    0   1   2    3   4   5   6    7    8   9     10
0    0   0   0   61   0   0   0   24  131   3   951
1    0   0   0   12   0   0   0  116   19   0  1352
2    0   0   0   66   0   0   0   44  114   2   789
3    0   0   0    0   0   0   0    0    0   0     0
4    0   0   0    0   0   0   0    0    0   0  1633
5    0   0   0  311   0   0   0   34  118   0   129
6    0   0   0    6   0   0   0    6   29   0  3026
7    0   1   0   10   0   0   0  352   24   0   777
8    0   0   0  109   0   0   0   42  222   0   997
9    0   0   0  274   0   0   0  162  215   1   485
10   0   0   0    0   0   0   0    0    0   0  1646
early stop counter: 1
val acc:0.47615352272987366, best validation acc: 0.7692924737930298, corresponding to test acc:                         0.3228153586387634 / 0.3228153586387634
after epoch: 2,now: 2024-08-12 13:36:50.788896,epoch time: 0:46:40.330127,used: 1:33:25.768592,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_12_03_24_seed_0_24144507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.33077377, 'precision': 0.07939996, 'recall': 0.106707916, 'specificity': 0.9150101, 'f1': 0.08826963, 'auroc': 0.550449}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0    68   0   0   0   124   0   0   290
1    0   0   0    83   0   0   0   932   0   0   316
2    0   0   0    29   0   0   0    85   0   0   198
3    0   0   0  1207   0   0   0  2258   0   0  4972
4    0   0   0    82   0   0   0   132   0   0   325
5    0   0   0    48   0   0   0    95   0   0   378
6    0   0   0   209   0   0   0   565   0   0  1133
7    0   0   0  1448   0   0   0  2668   0   0  3148
8    0   0   0   534   0   0   0   648   0   0  2114
9    0   0   0    58   0   0   0   122   0   0   313
10   0   0   0  1680   0   0   0  2626   0   0  8488
---- Validation: 
scalar performance:
{'acc': 0.33213857, 'precision': 0.08020111, 'recall': 0.10712303, 'specificity': 0.91530734, 'f1': 0.088922404, 'auroc': 0.554189}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0    68   0   0   0   117   0   0   298
1    0   0   0    75   0   0   0   938   0   0   319
2    0   0   0    26   0   0   0    88   0   0   198
3    0   0   0  1290   0   0   0  2350   0   0  4800
4    0   0   0    59   0   0   0   138   0   0   342
5    0   0   0    68   0   0   0   101   0   0   352
6    0   0   0   220   0   0   0   547   0   0  1141
7    0   0   0  1490   0   0   0  2621   0   0  3154
8    0   0   0   547   0   0   0   706   0   0  2043
9    0   0   0    49   0   0   0   106   0   0   338
10   0   0   0  1624   0   0   0  2666   0   0  8506
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.149024, 'precision': 0.031550568, 'recall': 0.12948737, 'specificity': 0.91586506, 'f1': 0.05065883, 'auroc': 0.53715765}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9     10
0    0   0   0  249   0   0   0   870   0   0    51
1    0   0   0  261   0   0   0   712   0   0   526
2    0   0   0  204   0   0   0   508   0   0   303
3    0   0   0    0   0   0   0     0   0   0     0
4    0   0   0   53   0   0   0    86   0   0  1494
5    0   0   0   73   0   0   0   471   0   0    48
6    0   0   0  473   0   1   0  1079   0   0  1514
7    0   0   0  509   0   0   0   518   0   0   137
8    0   0   0  306   0   0   0   662   0   0   402
9    0   0   0  218   0   0   0   673   0   0   246
10   0   0   0   14   0   0   0    20   0   0  1612
early stop counter: 2
val acc:0.3321385681629181, best validation acc: 0.7692924737930298, corresponding to test acc:                         0.3228153586387634 / 0.3228153586387634
after epoch: 3,now: 2024-08-12 14:22:24.616133,epoch time: 0:45:33.827237,used: 2:18:59.595829,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_12_03_24_seed_0_24144507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.32965004, 'precision': 0.07017786, 'recall': 0.094204694, 'specificity': 0.9099602, 'f1': 0.06613341, 'auroc': 0.570385}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9      10
0    0   0   0   16   0   0   0    31   0   0    436
1    0   0   0   33   0   0   0   417   0   0    882
2    0   0   0    5   0   0   0    23   0   0    284
3    0   0   0  209   0   0   0   762   0   0   7467
4    0   0   0   12   0   0   0    37   0   0    490
5    0   0   0    9   0   0   0    19   0   0    492
6    0   0   0   46   0   0   0   177   0   0   1685
7    0   0   0  312   0   0   0  1087   0   0   5863
8    0   0   0   96   0   0   0   257   0   0   2943
9    0   0   0   13   0   0   0    19   0   0    461
10   0   0   0  578   0   0   0  1190   0   0  11025
---- Validation: 
scalar performance:
{'acc': 0.32823324, 'precision': 0.06760104, 'recall': 0.09347558, 'specificity': 0.9097894, 'f1': 0.06502531, 'auroc': 0.5656458}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9      10
0    0   0   0   22   0   0   0    30   0   0    431
1    0   0   0   34   0   0   0   438   0   0    860
2    0   0   0    5   0   0   0    16   0   0    291
3    0   0   0  186   0   0   0   767   0   0   7487
4    0   0   0   17   0   0   0    36   0   0    486
5    0   0   0   10   0   0   0    23   0   0    488
6    0   0   0   43   0   0   0   179   0   0   1686
7    0   0   0  337   0   0   0  1038   0   0   5890
8    0   0   0   86   0   0   0   267   0   0   2943
9    0   0   0   11   0   0   0    28   0   0    454
10   0   0   0  600   0   0   0  1149   0   0  11047
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1260757, 'precision': 0.020685073, 'recall': 0.103161395, 'specificity': 0.9114783, 'f1': 0.032298453, 'auroc': 0.54230416}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9     10
0    0   0   0   76   0   0   0  260   0   0   834
1    0   0   0  223   0   0   0  358   0   0   918
2    0   0   0   52   0   0   0  176   0   0   787
3    0   0   0    0   0   0   0    0   0   0     0
4    0   0   0    1   0   0   0   10   0   0  1622
5    0   0   0   79   0   0   0  268   0   0   245
6    0   0   0   22   0   0   0   77   0   0  2968
7    0   0   0  287   0   0   0  159   0   0   718
8    0   0   0   85   0   0   0  264   0   0  1021
9    0   0   0  148   0   0   0  327   0   0   662
10   0   0   0    1   0   0   0    2   0   0  1643
early stop counter: 3
val acc:0.3282332420349121, best validation acc: 0.7692924737930298, corresponding to test acc:                         0.3228153586387634 / 0.3228153586387634
after epoch: 4,now: 2024-08-12 15:10:53.201998,epoch time: 0:48:28.585865,used: 3:07:28.181694,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_12_03_24_seed_0_24144507
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 3:07:28.181694 at 2024-08-12 15:10:53.201998
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32281536, 'precision': 0.24281935, 'recall': 0.24812633, 'specificity': 0.92780966, 'f1': 0.2130043, 'auroc': 0.6937693}
confusion matrix:
    0    1   2    3   4   5     6    7    8    9     10
0    0    0   0    8   0   0  1077    3   12   65     5
1    0  515   0   19   0   0   159  454   27    6   319
2    0    0   0   53   0   0   557   17  175   46   167
3    0    0   0    0   0   0     0    0    0    0     0
4    0    0   0    0   0   0    90    2    8    0  1533
5    0    0   0  198   0   0   111    0   43  237     3
6    0    0   0    8   0   0  1273   14  159    2  1611
7    0   50   0   16   0   0   408  628   44    1    17
8    0    0   0   36   0   0   752    0  379   84   119
9    0    4   0  158   0   0   562   29  176  182    26
10   0    0   0    0   0   0     9    0    0    0  1637
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.32281536, 'precision': 0.24281935, 'recall': 0.24812633, 'specificity': 0.92780966, 'f1': 0.2130043, 'auroc': 0.6937693}
confusion matrix:
    0    1   2    3   4   5     6    7    8    9     10
0    0    0   0    8   0   0  1077    3   12   65     5
1    0  515   0   19   0   0   159  454   27    6   319
2    0    0   0   53   0   0   557   17  175   46   167
3    0    0   0    0   0   0     0    0    0    0     0
4    0    0   0    0   0   0    90    2    8    0  1533
5    0    0   0  198   0   0   111    0   43  237     3
6    0    0   0    8   0   0  1273   14  159    2  1611
7    0   50   0   16   0   0   408  628   44    1    17
8    0    0   0   36   0   0   752    0  379   84   119
9    0    4   0  158   0   0   562   29  176  182    26
10   0    0   0    0   0   0     9    0    0    0  1637
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_12_03_24_seed_0_24144507_instance_wise_predictions.txt
accuracy from prediction file 0.3228153641642762
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/38.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/38.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/38.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1704 MiB |  20452 MiB | 395647 GiB | 395645 GiB |
|       from large pool |   1511 MiB |  20295 MiB | 394825 GiB | 394824 GiB |
|       from small pool |    193 MiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1704 MiB |  20452 MiB | 395647 GiB | 395645 GiB |
|       from large pool |   1511 MiB |  20295 MiB | 394825 GiB | 394824 GiB |
|       from small pool |    193 MiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  20353 MiB | 394085 GiB | 394083 GiB |
|       from large pool |   1476 MiB |  20196 MiB | 393265 GiB | 393264 GiB |
|       from small pool |    192 MiB |    273 MiB |    819 GiB |    819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20988 MiB |  20988 MiB |  20988 MiB |      0 B   |
|       from large pool |  20712 MiB |  20712 MiB |  20712 MiB |      0 B   |
|       from small pool |    276 MiB |    276 MiB |    276 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 562322 KiB |   1192 MiB | 174591 GiB | 174591 GiB |
|       from large pool | 555344 KiB |   1191 MiB | 173701 GiB | 173700 GiB |
|       from small pool |   6978 KiB |     21 MiB |    890 GiB |    890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   27942 K  |   27937 K  |
|       from large pool |     182    |     799    |   12408 K  |   12408 K  |
|       from small pool |    4194    |    6508    |   15533 K  |   15529 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   27942 K  |   27937 K  |
|       from large pool |     182    |     799    |   12408 K  |   12408 K  |
|       from small pool |    4194    |    6508    |   15533 K  |   15529 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|       from large pool |     356    |     356    |     356    |       0    |
|       from small pool |     138    |     138    |     138    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |    1077    |   13102 K  |   13102 K  |
|       from large pool |      21    |     176    |    6940 K  |    6940 K  |
|       from small pool |      22    |    1056    |    6161 K  |    6161 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  20353 MiB | 394085 GiB | 394085 GiB |
|       from large pool |  16640 KiB |  20196 MiB | 393265 GiB | 393265 GiB |
|       from small pool |      0 KiB |    273 MiB |    819 GiB |    819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2254 MiB |  20988 MiB |  20988 MiB |  18734 MiB |
|       from large pool |   2054 MiB |  20712 MiB |  20712 MiB |  18658 MiB |
|       from small pool |    200 MiB |    276 MiB |    276 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1192 MiB | 174592 GiB | 174592 GiB |
|       from large pool |  59136 KiB |   1191 MiB | 173701 GiB | 173701 GiB |
|       from small pool |      0 KiB |     34 MiB |    890 GiB |    890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     160    |     494    |     494    |     334    |
|       from large pool |      60    |     356    |     356    |     296    |
|       from small pool |     100    |     138    |     138    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1077    |   13103 K  |   13103 K  |
|       from large pool |       4    |     176    |    6940 K  |    6940 K  |
|       from small pool |       0    |    1056    |    6162 K  |    6162 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  20452 MiB | 395647 GiB | 395647 GiB |
|       from large pool |  16640 KiB |  20295 MiB | 394825 GiB | 394825 GiB |
|       from small pool |      0 KiB |    274 MiB |    821 GiB |    821 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  20353 MiB | 394085 GiB | 394085 GiB |
|       from large pool |  16640 KiB |  20196 MiB | 393265 GiB | 393265 GiB |
|       from small pool |      0 KiB |    273 MiB |    819 GiB |    819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2254 MiB |  20988 MiB |  20988 MiB |  18734 MiB |
|       from large pool |   2054 MiB |  20712 MiB |  20712 MiB |  18658 MiB |
|       from small pool |    200 MiB |    276 MiB |    276 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1192 MiB | 174592 GiB | 174592 GiB |
|       from large pool |  59136 KiB |   1191 MiB | 173701 GiB | 173701 GiB |
|       from small pool |      0 KiB |     34 MiB |    890 GiB |    890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   27942 K  |   27942 K  |
|       from large pool |       2    |     799    |   12408 K  |   12408 K  |
|       from small pool |       0    |    6508    |   15533 K  |   15533 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     160    |     494    |     494    |     334    |
|       from large pool |      60    |     356    |     356    |     296    |
|       from small pool |     100    |     138    |     138    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1077    |   13103 K  |   13103 K  |
|       from large pool |       4    |     176    |    6940 K  |    6940 K  |
|       from small pool |       0    |    1056    |    6162 K  |    6162 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_15_27_40_seed_1_24144507

 Experiment start at: 2024-08-12 15:27:40.925956
before training, model accuracy: 0.06254810094833374
slurmstepd: error: *** JOB 24144507 ON supergpu03 CANCELLED AT 2024-08-12T15:40:09 ***
