Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 18:46:25 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/28.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=28
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414

 Experiment start at: 2024-08-11 18:56:38.923198
before training, model accuracy: 0.05282306298613548
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8393889, 'precision': 0.52091694, 'recall': 0.46489888, 'specificity': 0.98182046, 'f1': 0.4624408, 'auroc': 0.96508265}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    35   0   3   324    24    28   2     67
1    0  952   0    73   0   0     1   242     1   0     63
2    0    3   0    13   0   3   145    33    90   1     24
3    0    2   0  7569   0   0     5   519   309   0     31
4    0    0   0     7   0   0   119     4    90   0    319
5    0    0   0   306   0  63    89     2    52   7      2
6    0    4   0    33   0   0  1493    31    95   2    249
7    0   31   0   461   0   0     4  6457   178   0    133
8    0    0   0   311   0   0    63   196  2404   0    322
9    0    1   0   122   0  27   225    25    84   4      5
10   0    7   0    20   0   0   188    55    93   0  12431
---- Validation: 
scalar performance:
{'acc': 0.8395078, 'precision': 0.5248269, 'recall': 0.46550098, 'specificity': 0.9818729, 'f1': 0.46175322, 'auroc': 0.96565247}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    2   0    28   0   4   325    25    28   1     70
1    0  964   0    45   0   0     0   250     5   0     68
2    0    1   0    15   0   2   141    31    88   1     33
3    0    0   0  7558   0   0     4   528   323   0     27
4    0    0   0     5   0   0   119    11    81   0    323
5    0    0   0   304   0  57    92     0    57   8      3
6    0    1   0    33   0   0  1499    25   117   0    233
7    0   39   0   486   0   0     7  6424   177   0    132
8    0    1   0   303   0   0    79   176  2438   0    299
9    0    1   0   118   0  29   228    21    88   5      3
10   0    5   0    22   0   0   187    56    86   0  12440
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.43811655, 'precision': 0.4227934, 'recall': 0.3408155, 'specificity': 0.94052887, 'f1': 0.295164, 'auroc': 0.7720488}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     0   0   17   0   0  1130   17    5   0     1
1    0  1067   0   24   0   0    69  138   11   0   190
2    0     3   0   78   0   3   548   22  248   0   113
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    64    0   16   0  1553
5    0     0   0  359   0  30   126    1   75   0     1
6    0     2   0    1   0   0  1726    2   36   0  1300
7    0    98   0    6   0   0   117  885   24   0    34
8    0     0   0   63   0   3   367    2  911   0    24
9    0    13   0  344   0  10   494   41  220   1    14
10   0     0   0    0   0   0     4    0    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 19:34:11.356069,epoch time: 0:37:32.432871,used: 0:37:32.432871,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8835884, 'precision': 0.7782736, 'recall': 0.63481593, 'specificity': 0.987191, 'f1': 0.6636445, 'auroc': 0.98246974}
confusion matrix:
     0    1   2     3   4    5     6     7     8    9      10
0   162    0   2    15   0    4   178    24    22   34     42
1     0  984   0    25   0    0     1   294     4    0     24
2     9    3  53     9  16    5    17    30    66   88     16
3     0    1   0  7639   0   18     2   567   208    3      2
4     1    1  19     4  69    2    38    20   109   27    249
5     2    0   0   120   0  320     1     1    11   60      5
6    10    6   0     9   0    5  1757    31    38    5     47
7     0   29   0   301   1    0     8  6761   120    0     42
8     0    1   0   226   0    0    17   199  2773    2     77
9     5    2  13    51   0  143     5    17    35  215      7
10    1   16   1    16   7    2   158   129   163    7  12292
---- Validation: 
scalar performance:
{'acc': 0.88516784, 'precision': 0.7760432, 'recall': 0.636784, 'specificity': 0.9874031, 'f1': 0.66498584, 'auroc': 0.9830299}
confusion matrix:
     0    1   2     3   4    5     6     7     8    9      10
0   166    0   0    15   0    5   180    28    17   27     45
1     0  988   0    30   0    0     0   288     9    0     17
2     3    1  65     7  16    9    18    33    64   89      7
3     0    3   0  7666   0   22     5   536   200    1      7
4     2    1  18     4  54    1    48    15   120   28    248
5     2    0   1   124   0  326     0     2    11   53      2
6     6    3   0    17   0    6  1752    29    36   11     48
7     0   29   0   267   1    0     7  6814   108    0     39
8     0    1   3   247   0    0    30   185  2771    1     58
9     6    2  21    53   0  137     7    23    34  207      3
10    4   14   1    18   7    2   173   126   165    3  12283
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5530679, 'precision': 0.5197775, 'recall': 0.43335444, 'specificity': 0.95351213, 'f1': 0.38173473, 'auroc': 0.8403739}
confusion matrix:
    0     1   2    3   4    5     6     7     8   9     10
0    2     0   0   45   0    5  1026    39    18  35     0
1    0  1104   0   25   0    0    39   233    10   0    88
2    0     1   4   75   0   16   361    49   389   8   112
3    0     0   0    0   0    0     0     0     0   0     0
4    0     0   0    0   0    0    61     1    26   0  1545
5    1     0   0  348   0  165    35     0    27  16     0
6    0     1   0    1   0    0  2591     2    24   2   446
7    0    14   0    2   0    0    30  1084    24   0    10
8    0     0   0   74   0    5    46     3  1223  13     6
9    0    11   3  363   0   80   218   102   256  92    12
10   0     1   0    0   0    0     5     0     0   0  1640
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 20:10:13.150424,epoch time: 0:36:01.794355,used: 1:13:34.227226,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91729987, 'precision': 0.8001728, 'recall': 0.7453544, 'specificity': 0.9908663, 'f1': 0.76601267, 'auroc': 0.9911475}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   273     0    1    11    2    4    76    13     9   17     77
1     0  1227    1    19    0    0     0    70     3    0     12
2     1     3  116     5   57    4     3    10    16   91      6
3     1     1    0  7971    1   34     4   239   181    4      2
4     1     0   34     1  244    2     7     9    33   15    193
5     1     0    2    61    0  399     1     0     8   47      2
6    16     1    0    13    2    3  1754     4    20   10     83
7     1    63    2   373    4    0     5  6635   116    1     64
8     0     2    3   190   31    2     9    95  2854    8     99
9     3     0   39    16    2  161     5     5    13  244      5
10    9     2    3    10   73    2    43    26    56    3  12568
---- Validation: 
scalar performance:
{'acc': 0.91828275, 'precision': 0.8109039, 'recall': 0.7476027, 'specificity': 0.9909446, 'f1': 0.7714746, 'auroc': 0.9912868}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   272     0    2    13    2    4    62    13     8   21     86
1     0  1217    1    15    1    0     0    83     5    0     10
2     2     2  115     3   60    5     3     9    20   85      8
3     0     3    0  7950    0   35     4   248   193    3      4
4     2     0   26     2  233    3     2     3    51   15    202
5     0     0    1    64    0  394     2     0     7   52      1
6    13     0    2    12    3    1  1765     7    19    9     77
7     0    58    4   361    6    0     2  6635   138    0     61
8     1     1    6   200   27    6    13    81  2869    6     86
9     3     0   33    24    1  132     3     5    13  273      6
10    8     3    2    10   49    1    30    30    54    2  12607
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48737144, 'precision': 0.5420526, 'recall': 0.42832568, 'specificity': 0.9476469, 'f1': 0.3900196, 'auroc': 0.83314866}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   46     0   3   73   0   15   805    43    56  105    24
1    0  1180   0   38   0    0    12   157     7    0   105
2    0     7  23   88  23   29    44    43   407   19   332
3    0     0   0    0   0    0     0     0     0    0     0
4    0     1   0    0  34    0     2     1    21    0  1574
5    0     0   0  265   0  279     4     0    26   17     1
6    7     2   2    1   7    1  1320     1    33    1  1692
7    0    25   0   24   0    0    29  1038    26    0    22
8    0     0   2   99   2    8     7     1  1228    9    14
9    0    21  60  366   2  131    38    70   235  174    40
10   0     1   0    0   1    0     0     0     0    0  1644
better model found
persisted
after epoch: 3,now: 2024-08-11 20:46:23.623009,epoch time: 0:36:10.472585,used: 1:49:44.699811,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9105308, 'precision': 0.7897076, 'recall': 0.7828522, 'specificity': 0.99034625, 'f1': 0.7849134, 'auroc': 0.99010056}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     3    1     3    0    2    24    13     6   13     72
1     0  1076    1    14    0    0     0   229     5    1      6
2     5     6  187     0   33    1     1     3     6   68      2
3     7    14    0  7643    0   63     7   400   282   14      7
4     1     1   64     3  277    0     4     7    24   13    145
5     1     0    2    38    0  367     0     1     6  104      2
6    44     9    3     8    5    0  1751    23    10   11     42
7     3    61   17   206    9    0     9  6723   176    5     55
8     1    10   16   128   33    7    24    89  2893    8     87
9     7     2   42     9    1   87     2     2     7  330      4
10   15    64   11    11   89    3    24    90    40    7  12439
---- Validation: 
scalar performance:
{'acc': 0.911863, 'precision': 0.78539205, 'recall': 0.78338194, 'specificity': 0.99049294, 'f1': 0.78327936, 'auroc': 0.9906455}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   355     1    2     4    1    1    20    17     7    7     68
1     0  1089    0    14    1    0     1   216     5    0      6
2     4     2  169     0   39    0     0     5     3   87      3
3    10    18    1  7669    0   63    10   382   269   10      8
4     5     0   64     0  278    3     4    11    25   10    139
5     3     0    2    32    0  378     0     0     6   99      1
6    53     7    2     7    1    2  1758    17     7   10     44
7     5    58   19   205    8    0     7  6735   160    4     64
8     4     6   17   109   23    2    17    87  2918   15     98
9     4     1   45     8    0   88     1     3     5  330      8
10   21    85    9    13   94    3    28    87    38    7  12411
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5874204, 'precision': 0.60509443, 'recall': 0.50114506, 'specificity': 0.9577505, 'f1': 0.48083046, 'auroc': 0.85259056}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   166     0   4   25   0    4   624    26     8  304     9
1     0  1182   0   37   0    0    16   170     6    1    87
2     1     3  71   43  45   29    77    47   228  102   369
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   3    0  86    0    13     1    14    0  1515
5     0     0   0  168   0  330     4     0     8   80     2
6    25     0   2    1   3    0  2218     2     3    4   809
7     1     6   1   14   0    0    53  1056    11    4    18
8     0     0   3   98   2    7    21     5  1154   43    37
9     1    15  84  202   0  109    30    71    87  491    47
10    0     0   0    0   3    0     1     0     0    0  1642
new oracle model saved
early stop counter: 1
val acc:0.9118630290031433, best validation acc: 0.9182827472686768, corresponding to test acc:                         0.48737144470214844 / 0.5874204039573669
after epoch: 4,now: 2024-08-11 21:22:22.233017,epoch time: 0:35:58.610008,used: 2:25:43.309819,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90376174, 'precision': 0.80371433, 'recall': 0.76046824, 'specificity': 0.98935616, 'f1': 0.7762901, 'auroc': 0.98271555}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   335    13    0     2    0    1    29     8     5    1     87
1     0  1039    0     7    1    0     0   100    10    0    175
2     2     6  144     1   38    2     2     7     5   89     16
3     4   162    0  7339    0   26    16   465   343    0     85
4     0     4   37     0  265    1     3     8    23   14    184
5     3     2    1    40    0  412     0     2    13   39      9
6     7    22    0     1    0    0  1769    17    15    2     74
7     3   152    6   106    5    0     4  6730   154    1    103
8     3    19    3    59   17    1    10    94  2989    3     98
9     7     3   26    10    0  155     2     6    11  265      8
10    7   106    9     9   48    2    21    55    42    0  12492
---- Validation: 
scalar performance:
{'acc': 0.90394545, 'precision': 0.80181634, 'recall': 0.7622746, 'specificity': 0.9894388, 'f1': 0.77640337, 'auroc': 0.98307335}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   319    11    0     4    1    1    43    16     7    3     78
1     0  1076    0     6    2    0     1   109     6    0    132
2     1     3  146     1   42    3     3     4    10   80     19
3     4   153    1  7333    0   31     9   482   358    1     68
4     2     7   38     2  280    0     4     3    32   10    161
5     1     7    1    37    0  417     0     1     8   43      6
6     9    14    1     2    0    1  1775    16    11    2     77
7     2   162    7    99    5    0    12  6709   162    3    104
8     2    26    5    64   18    5     7    95  2954    0    120
9    10     1   30     9    1  148     3     2    16  262     11
10    8    88    8     6   43    1    29    49    41    0  12523
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5719583, 'precision': 0.60250974, 'recall': 0.47428662, 'specificity': 0.9556432, 'f1': 0.43831587, 'auroc': 0.83867824}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   48     0   1   18   0    1   982    19    15   77     9
1    0  1082   0   31   0    0    22   237     6    0   121
2    0     1  18   36  19   21    81    63   351   62   363
3    0     0   0    0   0    0     0     0     0    0     0
4    0     0   1    0  52    0    11     1    20    0  1548
5    0     0   0  200   0  287    23     0    28   53     1
6    5     0   0    1   1    0  2355     3    11    0   691
7    0     1   0   10   0    0    74  1049    18    0    12
8    0     0   1   48   0    5    17     3  1274    6    16
9    2    10  33  202   1   95    88   115   178  367    46
10   0     0   0    0   2    0     1     0     0    0  1643
early stop counter: 2
val acc:0.9039454460144043, best validation acc: 0.9182827472686768, corresponding to test acc:                         0.48737144470214844 / 0.5874204039573669
after epoch: 5,now: 2024-08-11 21:58:50.123533,epoch time: 0:36:27.890516,used: 3:02:11.200335,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92176795, 'precision': 0.829635, 'recall': 0.8212435, 'specificity': 0.9915819, 'f1': 0.82346666, 'auroc': 0.9932489}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   365     0    0     3    2    0    26    11     4    5     67
1     0  1152    2     6    1    0     0   150    13    0      8
2     2     1  180     0   44    1     4     7     3   67      3
3     2     2    1  7434    0   24     9   573   384    8      2
4     3     0   41     0  377    1     1     9    14    9     84
5     1     0    0    34    1  409     0     2     5   65      4
6     8     2    0     2    5    0  1819    15     8    2     47
7     3    44    7    77    8    0     5  6917   156    3     43
8     1     1   14    55   52    0     9    88  2979    5     90
9     5     0   40     5    3   91     1     2     7  337      1
10   10     9    5    10  161    3    15    74    22    1  12483
---- Validation: 
scalar performance:
{'acc': 0.92026216, 'precision': 0.83209705, 'recall': 0.81925523, 'specificity': 0.9913962, 'f1': 0.82337767, 'auroc': 0.9932117}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   360     0    0     5    1    0    23    17     4    3     70
1     0  1104    1    11    2    0     0   200     8    0      6
2     1     0  207     1   33    0     2     3     6   57      2
3     3     4    2  7409    3   23     9   592   383    3      9
4     0     1   45     1  368    1     1     6    13    8     95
5     3     0    2    41    0  401     0     1     8   62      3
6    10     1    2     2    4    0  1823    15     8    3     40
7     1    41   16    93    8    0     2  6888   171    3     42
8     1     1    6    42   55    3     5    80  3019    3     81
9     4     1   36     7    2  106     0     5     8  319      5
10    4    14    7     8  155    3    14    62    22    1  12506
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.61638564, 'precision': 0.6309774, 'recall': 0.51847833, 'specificity': 0.96037626, 'f1': 0.49628708, 'auroc': 0.8529397}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   125     0   3   14    0    0   741    29    19  216    23
1     0  1205   0   26    0    0    24   160     8    1    75
2     0     3  38   17  101   17    55    51   268   94   371
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  250    0    10     1    13    0  1358
5     0     0   0  146    0  305     3     0    24  111     3
6     5     0   1    1    5    0  2375     2     7    1   670
7     0     4   0    4    0    0    56  1070    14    0    16
8     0     0   1   32    8    2    12     6  1277   12    20
9     1    13  42  111    4   58    45   113   165  536    49
10    0     1   0    0   16    0     0     0     0    0  1629
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-11 22:35:09.969370,epoch time: 0:36:19.845837,used: 3:38:31.046172,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9375803, 'precision': 0.8529139, 'recall': 0.82374793, 'specificity': 0.993296, 'f1': 0.8349522, 'auroc': 0.9948703}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   375     0    0     3    1    1    23    16    11    3     50
1     0  1242    0     9    0    0     0    67     4    0      9
2     1     5  200     1   30    7     0    10     8   48      2
3     1    19    0  7857    0   11     1   335   204    0     10
4     1     0   39     0  331    2     2     9    44    7    104
5     1     0    0    46    0  432     0     0     7   32      2
6     9     8    2     4    0    3  1824     9    17    4     28
7     1    39    0   112    2    0     4  7011    75    1     19
8     3     3    5    81    6    3     5   120  3047    0     23
9     4     0   40    13    1  158     1    10    10  253      2
10   12    19    5     7   77    2    23    51   121    5  12471
---- Validation: 
scalar performance:
{'acc': 0.9354019, 'precision': 0.8497396, 'recall': 0.81732213, 'specificity': 0.9930604, 'f1': 0.8299733, 'auroc': 0.99490166}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   365     1    1     5    1    1    26    12     6    7     58
1     0  1231    0    14    0    0     0    74     3    0     10
2     1     1  200     1   24    2     2     8    14   55      4
3     0    28    0  7833    0   12     1   362   194    1      9
4     2     2   39     1  319    3     0    10    54    7    102
5     0     1    0    51    0  420     0     0     8   39      2
6     6     2    0     2    0    2  1835     9    13    1     38
7     1    55    0   109    2    0     6  6989    85    1     17
8     2     8    4    83    6    2     3   107  3061    0     20
9     4     1   40    12    1  160     1    10     7  255      2
10    8    27    9     7   73    3    23    49   133    2  12462
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5407542, 'precision': 0.59914243, 'recall': 0.45401496, 'specificity': 0.95362484, 'f1': 0.41145396, 'auroc': 0.8417974}
confusion matrix:
    0     1   2    3   4    5     6     7     8    9     10
0   57     0   0   90   0   11   622   126    14  239    11
1    0  1194   0   40   0    0     3   211     3    0    48
2    0     5  13  108  16   31    34   165   383   61   199
3    0     0   0    0   0    0     0     0     0    0     0
4    0     2   2    0  59    0     4     3    93    0  1470
5    0     0   0  313   0  242     1     0    13   22     1
6    2     0   1    4   1    2  1955    11   154    7   930
7    0     3   0    8   0    0    16  1132     2    0     3
8    0     0   1  139   0    2     1    25  1200    0     2
9    0    22   6  428   0  119    15   236    61  239    11
10   0     1   0    0   4    0     0     0     3    0  1638
better model found
persisted
after epoch: 7,now: 2024-08-11 23:11:07.775828,epoch time: 0:35:57.806458,used: 4:14:28.852630,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9305704, 'precision': 0.85045743, 'recall': 0.82629824, 'specificity': 0.9923527, 'f1': 0.8360281, 'auroc': 0.99179685}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     0    1     3    1    0    23    17     4    3     56
1     0  1042    2    10    1    0     0   198     4    0     75
2     0     0  217     1   46    0     0     4     4   35      5
3     5     8    1  7741    2   22    11   317   282    6     44
4     1     0   23     0  377    2     2     1    15    7    111
5     1     0    1    34    0  416     1     2     9   49      7
6     7     3    2     1    1    0  1810    23     7    2     52
7     4    25   18   139    8    0    10  6856   142    2     60
8     2     3    8    51   25    1    12    62  3048    2     81
9     4     0   54     3    4  108     2     0    10  304      4
10    4     5    7     6  109    2    11    32    18    2  12596
---- Validation: 
scalar performance:
{'acc': 0.9312826, 'precision': 0.8482069, 'recall': 0.8304682, 'specificity': 0.9924509, 'f1': 0.83731353, 'auroc': 0.99071264}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   380     1    0     2    2    1    20    13     4    3     57
1     0  1056    1     9    0    0     1   187     7    0     71
2     2     0  213     0   49    1     4     3     2   37      1
3     6     8    1  7719    1   23     6   312   306    8     50
4     2     0   29     0  381    1     2     4    11    5    104
5     1     1    0    28    1  426     0     0     7   52      5
6     8     1    0     2    2    2  1835    14     4    2     38
7     6    25   17   124    4    0     4  6857   155    0     73
8     1     2    7    49   29    0     9    58  3050    6     85
9     5     0   60     6    0  106     0     3     3  305      5
10    8     4    8     6  103    2    10    37    24    0  12594
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5651018, 'precision': 0.62500995, 'recall': 0.46865067, 'specificity': 0.955693, 'f1': 0.44681877, 'auroc': 0.84280795}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   110     0   2   47    0    1   637    46    12  272    43
1     1  1108   0   42    0    0    10   231     3    1   103
2     0     2  13   67   37   14    44    60   270   85   423
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  142    0     3     1    20    0  1466
5     0     0   0  307    0  187     6     0    25   66     1
6     0     0   0    2    2    1  2124     2    17    2   917
7     0     3   0   14    0    0    39  1087     6    0    15
8     0     0   1   95    2    1     8     9  1229    5    20
9     0    10  12  319    2   60    46   104    88  445    51
10    0     0   0    0   14    0     0     0     0    0  1632
early stop counter: 1
val acc:0.9312825798988342, best validation acc: 0.9354019165039062, corresponding to test acc:                         0.5407541990280151 / 0.6163856387138367
after epoch: 8,now: 2024-08-11 23:47:12.042055,epoch time: 0:36:04.266227,used: 4:50:33.118857,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94790775, 'precision': 0.87922925, 'recall': 0.8523774, 'specificity': 0.99430734, 'f1': 0.86412656, 'auroc': 0.99614215}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   396     2    0     2    1    0     8     4     2    2     66
1     1  1206    2    10    2    0     0    99     5    0      7
2     1     0  195     0   52    1     1     5     3   48      6
3     3     3    0  7906    0   20     4   225   271    1      6
4     3     0   15     0  386    1     0     2    17    8    107
5     0     0    1    19    1  389     0     0     6  104      1
6     8     0    0     3    5    0  1837     2     6    1     46
7     1    15    3   120    6    0     1  6994    85    3     36
8     0     0    4    55   13    2     1    67  3086    3     64
9     3     0   37     6    3   51     0     2     6  382      3
10    4     5    1     7   75    2     4    13    26    1  12652
---- Validation: 
scalar performance:
{'acc': 0.94733185, 'precision': 0.8761418, 'recall': 0.84981734, 'specificity': 0.9942352, 'f1': 0.861406, 'auroc': 0.99586004}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     1    0     3    0    0    11     4     2    2     75
1     0  1212    0     9    2    0     0    92     6    1     10
2     1     0  194     0   57    0     1     3     2   51      3
3     2     3    0  7893    0   24     2   237   266    5      8
4     1     0   15     0  390    1     1     3    11    8    109
5     1     0    0    20    1  394     0     0     6   98      1
6    10     2    1     4    5    1  1831     1     3    5     45
7     3     9    2   111    3    0     3  7001    93    2     38
8     0     2    6    64   12    1     1    59  3081    1     69
9     3     1   44     3    0   58     0     0     8  373      3
10    2     2    1     7   75    2     6    16    22    1  12662
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.541174, 'precision': 0.64843786, 'recall': 0.46724588, 'specificity': 0.9533756, 'f1': 0.45004877, 'auroc': 0.8453498}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   208     0   2   44    0    1   440    80    10  294    91
1     2  1025   0   37    0    0     4   299     2    1   129
2     0     0  18   40   36    4    11    96   179  102   529
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  195    0     0     3    19    0  1415
5     0     0   0  233    0  166     1     2    23  165     2
6     4     0   0    1    2    1  1580     2    20    0  1457
7     0     1   0    9    0    0    10  1126     5    0    13
8     0     0   1   80    2    0     3    13  1233    8    30
9     0     6  11  214    0   19     9   169    72  556    81
10    0     0   0    0   18    0     0     0     0    0  1628
better model found
persisted
after epoch: 9,now: 2024-08-12 00:23:23.560669,epoch time: 0:36:11.518614,used: 5:26:44.637471,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9427708, 'precision': 0.86835706, 'recall': 0.8393535, 'specificity': 0.9938655, 'f1': 0.8497235, 'auroc': 0.99536663}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     2    0    0    19     4     2    6     31
1     0  1176    0    10    0    0     0   113     6    0     27
2     0     0  184     0   34    5     3     1     4   76      5
3     4     9    0  7952    1   16    15   152   271    6     11
4     3     1   22     0  340    4     3     1    37    6    122
5     0     0    0    26    0  453     0     0     8   31      3
6    11     1    0     6    2    2  1855     5     4    3     18
7    13    27    4   162    1    0     8  6799   211    3     35
8     2     1    4    57    2    1     8    37  3145    3     35
9     1     0   17     4    1  160     0     2     8  296      4
10   16    15    1     6   30    2    26    16    62    2  12618
---- Validation: 
scalar performance:
{'acc': 0.9416611, 'precision': 0.86553156, 'recall': 0.8357483, 'specificity': 0.9937415, 'f1': 0.846098, 'auroc': 0.9952554}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0     4    0    2    20     4     3    2     34
1     0  1175    0    13    0    0     0   121     4    0     19
2     1     0  178     1   33    4     2     4     8   77      4
3    12    15    0  7928    0   20     8   175   265    2     15
4     6     0   25     0  322    1     5     5    31   12    132
5     0     1    0    26    0  448     0     0     7   37      2
6    11     1    0     2    0    1  1861     3     4    4     21
7    14    41    2   165    3    0     6  6777   215    3     39
8     1     0    3    45    3    3     9    25  3169    3     35
9     1     0   12     5    1  149     1     2     9  311      2
10   12    16    3     6   31    3    30    15    54    5  12621
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57860494, 'precision': 0.65694404, 'recall': 0.46243125, 'specificity': 0.95707345, 'f1': 0.4310139, 'auroc': 0.8436683}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   102     0   0   51   0    2   705    49    12  233    16
1     2  1018   0   43   0    0    26   305     8    1    96
2     0     0   8   84   4   12   103    53   361   86   304
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    0  41    0    14     1    41    0  1535
5     0     0   0  326   0  165     7     0    23   70     1
6     0     0   0    2   0    1  2603     3    26    1   431
7     0     1   0   11   0    0    28  1103    11    0    10
8     0     0   0  120   0    0    14     5  1219    3     9
9     1     5   3  404   0   45    53    90   131  371    34
10    0     0   0    0   1    0     3     0     2    0  1640
early stop counter: 1
val acc:0.9416611194610596, best validation acc: 0.9473318457603455, corresponding to test acc:                         0.5411739945411682 / 0.6163856387138367
after epoch: 10,now: 2024-08-12 00:59:32.677721,epoch time: 0:36:09.117052,used: 6:02:53.754523,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:02:53.754523 at 2024-08-12 00:59:32.677721
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.541174, 'precision': 0.64843786, 'recall': 0.46724588, 'specificity': 0.9533756, 'f1': 0.45004877, 'auroc': 0.8453498}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   208     0   2   44    0    1   440    80    10  294    91
1     2  1025   0   37    0    0     4   299     2    1   129
2     0     0  18   40   36    4    11    96   179  102   529
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  195    0     0     3    19    0  1415
5     0     0   0  233    0  166     1     2    23  165     2
6     4     0   0    1    2    1  1580     2    20    0  1457
7     0     1   0    9    0    0    10  1126     5    0    13
8     0     0   1   80    2    0     3    13  1233    8    30
9     0     6  11  214    0   19     9   169    72  556    81
10    0     0   0    0   18    0     0     0     0    0  1628
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.61638564, 'precision': 0.6309774, 'recall': 0.51847833, 'specificity': 0.96037626, 'f1': 0.49628708, 'auroc': 0.8529397}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   125     0   3   14    0    0   741    29    19  216    23
1     0  1205   0   26    0    0    24   160     8    1    75
2     0     3  38   17  101   17    55    51   268   94   371
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  250    0    10     1    13    0  1358
5     0     0   0  146    0  305     3     0    24  111     3
6     5     0   1    1    5    0  2375     2     7    1   670
7     0     4   0    4    0    0    56  1070    14    0    16
8     0     0   1   32    8    2    12     6  1277   12    20
9     1    13  42  111    4   58    45   113   165  536    49
10    0     1   0    0   16    0     0     0     0    0  1629
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_56_38_seed_0_24142414_instance_wise_predictions.txt
accuracy from prediction file 0.5411740012593578
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/28.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/28.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/28.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496026 KiB |  10931 MiB | 600909 GiB | 600908 GiB |
|       from large pool | 405312 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |  90714 KiB |    127 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 496026 KiB |  10931 MiB | 600909 GiB | 600908 GiB |
|       from large pool | 405312 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |  90714 KiB |    127 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10868 MiB | 598032 GiB | 598031 GiB |
|       from large pool | 387840 KiB |  10797 MiB | 597121 GiB | 597120 GiB |
|       from small pool |  90258 KiB |    126 MiB |    911 GiB |    911 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11236 MiB |  11236 MiB |  11236 MiB |      0 B   |
|       from large pool |  11108 MiB |  11108 MiB |  11108 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 239205 KiB |    849 MiB | 278085 GiB | 278085 GiB |
|       from large pool | 229568 KiB |    835 MiB | 277123 GiB | 277122 GiB |
|       from small pool |   9637 KiB |     15 MiB |    962 GiB |    962 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   44630 K  |   44627 K  |
|       from large pool |      87    |     490    |   20876 K  |   20876 K  |
|       from small pool |    2922    |    4522    |   23754 K  |   23751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   44630 K  |   44627 K  |
|       from large pool |      87    |     490    |   20876 K  |   20876 K  |
|       from small pool |    2922    |    4522    |   23754 K  |   23751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     284    |     284    |     284    |       0    |
|       from large pool |     220    |     220    |     220    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     986    |   19265 K  |   19265 K  |
|       from large pool |      14    |     112    |   10076 K  |   10076 K  |
|       from small pool |      22    |     972    |    9188 K  |    9188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10868 MiB | 598032 GiB | 598032 GiB |
|       from large pool |  16640 KiB |  10797 MiB | 597121 GiB | 597121 GiB |
|       from small pool |      0 KiB |    126 MiB |    911 GiB |    911 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 735232 KiB |  11236 MiB |  11236 MiB |  10518 MiB |
|       from large pool | 634880 KiB |  11108 MiB |  11108 MiB |  10488 MiB |
|       from small pool | 100352 KiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    849 MiB | 278086 GiB | 278086 GiB |
|       from large pool |  59136 KiB |    835 MiB | 277123 GiB | 277123 GiB |
|       from small pool |      0 KiB |     30 MiB |    962 GiB |    962 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   44630 K  |   44630 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23754 K  |   23754 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   44630 K  |   44630 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23754 K  |   23754 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     284    |     284    |     209    |
|       from large pool |      26    |     220    |     220    |     194    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     986    |   19266 K  |   19266 K  |
|       from large pool |       3    |     112    |   10076 K  |   10076 K  |
|       from small pool |       0    |     972    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10931 MiB | 600909 GiB | 600909 GiB |
|       from large pool |  16640 KiB |  10859 MiB | 599995 GiB | 599995 GiB |
|       from small pool |      0 KiB |    127 MiB |    913 GiB |    913 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10868 MiB | 598032 GiB | 598032 GiB |
|       from large pool |  16640 KiB |  10797 MiB | 597121 GiB | 597121 GiB |
|       from small pool |      0 KiB |    126 MiB |    911 GiB |    911 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 735232 KiB |  11236 MiB |  11236 MiB |  10518 MiB |
|       from large pool | 634880 KiB |  11108 MiB |  11108 MiB |  10488 MiB |
|       from small pool | 100352 KiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    849 MiB | 278086 GiB | 278086 GiB |
|       from large pool |  59136 KiB |    835 MiB | 277123 GiB | 277123 GiB |
|       from small pool |      0 KiB |     30 MiB |    962 GiB |    962 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   44630 K  |   44630 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23754 K  |   23754 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   44630 K  |   44630 K  |
|       from large pool |       2    |     490    |   20876 K  |   20876 K  |
|       from small pool |       0    |    4522    |   23754 K  |   23754 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      75    |     284    |     284    |     209    |
|       from large pool |      26    |     220    |     220    |     194    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     986    |   19266 K  |   19266 K  |
|       from large pool |       3    |     112    |   10076 K  |   10076 K  |
|       from small pool |       0    |     972    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414

 Experiment start at: 2024-08-12 01:14:31.852801
before training, model accuracy: 0.06982439011335373
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.81977737, 'precision': 0.58800054, 'recall': 0.43959135, 'specificity': 0.97932005, 'f1': 0.43300593, 'auroc': 0.9564141}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    17   0   1   304    14    46   0    101
1    0  954   0    20   0   0     1   295    11   0     51
2    0    1   0     8   0   0   153    19    67   0     64
3    0    6   0  7297   0   0    10   495   601   0     29
4    0    1   0     4   0   0    98     8    52   0    376
5    0    0   0   328   0  11    97     3    80   0      2
6    0    1   0    10   0   0  1339    34   102   0    421
7    0   46   0   470   0   0    15  6159   291   0    282
8    0    1   0   223   0   0   154   105  2291   0    521
9    0    0   0   106   0   2   229    16   133   2      5
10   0    1   0    17   0   0    92    42    54   0  12587
---- Validation: 
scalar performance:
{'acc': 0.82113147, 'precision': 0.4925894, 'recall': 0.44080973, 'specificity': 0.9794949, 'f1': 0.43399036, 'auroc': 0.9560197}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    22   0   3   296    20    50   0     92
1    0  940   0    12   0   0     0   307    11   0     62
2    0    0   0    12   0   0   159    21    58   0     62
3    0    6   0  7305   0   0    12   498   587   0     32
4    0    0   0     2   0   0    98     7    61   0    371
5    0    0   0   312   0  13    92     1   100   0      3
6    0    3   0    17   0   0  1344    26   116   0    402
7    0   45   0   470   0   0    18  6149   299   0    284
8    0    1   0   174   0   0   127   115  2370   0    509
9    0    0   0   119   0   2   230    18   119   0      5
10   0    1   0    14   0   0    95    53    56   0  12577
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.3838942, 'precision': 0.2512542, 'recall': 0.28833473, 'specificity': 0.9342977, 'f1': 0.245504, 'auroc': 0.7484306}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     0   0    4   0   0  1113    1   48   0     4
1    0  1023   0   17   0   0    64   42   65   0   288
2    0     2   0   19   0   0   629    2  160   0   203
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    55    0    4   0  1574
5    0     0   0  323   0   0    75    1  192   0     1
6    0     0   0    0   0   0  1610    1   18   0  1438
7    0   147   0    4   0   0   217  637   95   0    64
8    0     0   0   34   0   0   655    0  573   0   108
9    0    11   0   93   0   0   495    9  507   0    22
10   0     0   0    0   0   0     2    0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 01:51:47.631367,epoch time: 0:37:15.778566,used: 0:37:15.778566,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8813142, 'precision': 0.749194, 'recall': 0.6200757, 'specificity': 0.98667145, 'f1': 0.6301922, 'auroc': 0.9829335}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   105     0   2    12   0   27   122    15    26   90     84
1     0  1082   0    41   0    0     0   171     9    2     26
2     2     3  38    11   6    7     4    23    42  117     59
3     0     3   0  7698   0   63     2   338   323    2      9
4     3     0   7     2  10    5    12     4    83   26    387
5     2     0   1    87   0  368     0     0    11   50      2
6    17     6   1    14   0    9  1593    12    69   20    166
7     0    64   0   423   0    0     2  6408   254    3    111
8     0     2   0   199   0    4    14    84  2844    8    138
9     1     2  11    37   0  160     3     9    33  231      6
10    9     2   2    14   1    2    40    44   114    3  12563
---- Validation: 
scalar performance:
{'acc': 0.88334894, 'precision': 0.7552712, 'recall': 0.6171264, 'specificity': 0.9868925, 'f1': 0.6273022, 'auroc': 0.98229665}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   83     0   2    13   0   29   125    16    28   93     94
1    0  1079   0    35   0    1     0   185    10    1     21
2    1     3  36     6  11    8     1    20    49  115     62
3    0     3   0  7723   0   53     1   349   302    2      7
4    3     0   3     4  17    6     8     5    87   29    377
5    0     0   0    98   0  362     0     0    13   47      1
6   18     3   0    14   0    8  1611    23    62   23    146
7    0    66   0   385   0    1     6  6476   205    1    125
8    0     2   1   203   0    5    12    88  2839   12    134
9    0     2  13    35   0  160     2    15    29  232      5
10   5     3   0    13   0    2    52    40   111    4  12566
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48170432, 'precision': 0.48429012, 'recall': 0.4113762, 'specificity': 0.9466957, 'f1': 0.37010047, 'auroc': 0.81580484}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   33     1   0    9   0   35   821    3    98  158    12
1    0  1153   0   26   0    0    19   75    71    0   155
2    0     7   1   27   0   29    76    7   482   54   332
3    0     0   0    0   0    0     0    0     0    0     0
4    0     0   0    0   0    0    10    0    19    0  1604
5    0     0   0  239   0  278    10    0    43   21     1
6    2     2   0    1   0    0  1571    1   109    8  1373
7    1   103   1    9   0    0    76  804   116    3    51
8    0     0   0   83   0    7    10    0  1178   12    80
9    1    15   2  172   0  137    42   11   501  221    35
10   0     0   0    0   0    0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 02:27:51.178412,epoch time: 0:36:03.547045,used: 1:13:19.325611,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9058487, 'precision': 0.79087996, 'recall': 0.73068607, 'specificity': 0.98965937, 'f1': 0.75422704, 'auroc': 0.9892653}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   238     0    1     8    2    0   116     9     9    3     97
1     0  1202    2    11    1    1     1    87    13    0     14
2     8     1  149     2   71    0     4     1    15   48     13
3     1     0    0  7480    1   20    19   464   445    5      5
4     3     0   15     1  223    1    11     1    35    8    240
5    14     0    3    74    1  288     5     0    11  122      3
6    16     0    2     1    0    1  1812     8    12    3     53
7     0    27    9   200    7    0    10  6667   235    1    107
8     1     1   11    89   34    2    41    65  2924    3    125
9    23     1   66    16    5   63     7     5    18  282      7
10   11     0    1    10   35    2    58    29    51    1  12592
---- Validation: 
scalar performance:
{'acc': 0.90801126, 'precision': 0.79935, 'recall': 0.74119616, 'specificity': 0.98990035, 'f1': 0.76434577, 'auroc': 0.9897493}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   249     0    2     5    1    1   104     8    12    6     95
1     0  1210    1    10    1    0     0    85     6    0     19
2     5     2  148     1   68    0     4     5    13   51     15
3     0     1    0  7484    1   29    18   457   440    7      3
4     7     0   15     2  250    0     9     4    26    9    217
5    11     0    3    66    1  309     5     0    10  114      2
6     8     1    1     4    0    1  1818     9    14    2     50
7     0    28    8   195    5    0     7  6695   229    1     97
8     1     1   10    91   39    0    47    71  2901    4    131
9    28     1   71    24    3   45    12     3    15  282      9
10    8     0    2    13   39    1    57    22    53    1  12600
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48982018, 'precision': 0.557652, 'recall': 0.38397717, 'specificity': 0.94655246, 'f1': 0.34904143, 'auroc': 0.82727766}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0   45     1   0    6   0   0  1063    2    21    4    28
1    0  1219   0   22   0   0    18   84    28    0   128
2    1    12  12   22  15   0   143   10   213    8   579
3    0     0   0    0   0   0     0    0     0    0     0
4    0     1   0    0  15   0     5    0     8    0  1604
5    2     0   0  287   0  64   125    0    82   30     2
6    4     3   0    1   1   0  1994    1     6    0  1057
7    0    59   3    6   0   0   144  852    38    0    62
8    0     0   0   34   3   0    70    1  1032    0   230
9    7    34  42  114  11   6   235   24   428  123   113
10   0     0   0    0   1   0     0    0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 03:03:50.926713,epoch time: 0:35:59.748301,used: 1:49:19.073912,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9153735, 'precision': 0.79837453, 'recall': 0.7860031, 'specificity': 0.99075556, 'f1': 0.790652, 'auroc': 0.99008703}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   328     2    1     8    1    1    41    10     4    4     83
1     0  1179    1    27    3    0     0   103     8    0     11
2     5     0  186     2   48    1     2     3     4   57      4
3     3    19    0  7866    1   53    12   236   230   10      6
4     2     0   35     0  307    3     7     4    18    7    156
5     4     0    2    49    1  405     1     0     7   51      1
6    35     2    0    13    2    6  1791     6     8    2     41
7     4    78   18   336    2    0    15  6538   180    5     88
8     5     4   11   159   53    7    31    54  2837    6    128
9     8     1   57    17    1  136     2     2     6  260      3
10   13    35    6    21  102    1    28    46    27    0  12516
---- Validation: 
scalar performance:
{'acc': 0.9153671, 'precision': 0.794362, 'recall': 0.778274, 'specificity': 0.9907451, 'f1': 0.78449553, 'auroc': 0.99047333}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   322     3    2     4    2    2    45     9     6    5     83
1     0  1182    0    28    1    0     0   104     7    0     10
2     6     0  166     1   59    4     2     1     9   59      5
3     1    27    1  7900    0   47     9   218   225    7      5
4     1     1   35     0  308    3     4     3    18   11    155
5     1     0    3    46    1  407     2     0     7   53      1
6    35     6    2    13    2    2  1788     5     7    2     46
7     5    71   16   324    6    0     9  6541   178    5    110
8     5     7    9   166   53   10    23    56  2831    7    129
9     5     0   54    13    4  144     7     5     4  252      5
10   14    56    7    24   85    1    27    38    20    0  12524
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5620933, 'precision': 0.61535, 'recall': 0.45323184, 'specificity': 0.9543663, 'f1': 0.44611418, 'auroc': 0.8458478}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   203     1   1   11    0    1   884    0     9   24    36
1     0  1307   1   29    0    0    12   51    19    0    80
2     2    22  29   29   36   12    91    6   214   47   527
3     0     0   0    0    0    0     0    0     0    0     0
4     0     3   0    0  113    0     7    0     8    0  1502
5     2     0   0  239    0  205    60    0    32   52     2
6     8     3   0    1    2    0  2369    1     2    2   679
7     1   133   5   15    0    0   215  723    28    1    43
8     0     0   2   72    9    0    55    3  1103    7   119
9     2    53  67  158    4   43   132   17   253  343    65
10    0     1   0    0    6    0     0    0     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 03:39:52.765881,epoch time: 0:36:01.839168,used: 2:25:20.913080,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92701197, 'precision': 0.83680826, 'recall': 0.8022473, 'specificity': 0.9921698, 'f1': 0.81715465, 'auroc': 0.9937509}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   342     0    2     4    3    0    45    14    10    1     61
1     0  1211    0    10    0    0     0   100     6    0      5
2     7     0  184     2   46    1     1     8    16   43      4
3     2    12    0  7619    0    7     1   446   347    1      1
4     3     2   33     0  322    3     2     4    48    6    116
5     2     0    3    67    0  377     1     0    17   53      1
6    13     2    2     3    2    0  1814    10    20    2     39
7     1    15    1   113    2    0     2  6996   109    1     24
8     1     5    2    68   16    0     6    88  3082    0     28
9     7     0   48    14    3  103     1     9    23  282      3
10   18    25    4     8  119    2    30    56   113    0  12419
---- Validation: 
scalar performance:
{'acc': 0.9282065, 'precision': 0.8324964, 'recall': 0.802013, 'specificity': 0.9923223, 'f1': 0.8151716, 'auroc': 0.9938043}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   348     1    0     3    0    0    41    14    12    4     60
1     0  1220    2    10    1    0     1    87     6    0      5
2     3     1  183     0   50    2     4     7    10   51      1
3     2     9    0  7653    0    9     3   434   329    0      1
4     2     0   29     0  333    1     3     7    41    6    117
5     1     0    1    67    0  370     1     0    19   61      1
6    14     2    0     4    1    1  1829    11    13    2     31
7     2    21    3   107    1    0     2  6974   132    1     22
8     1     5    6    72   10    0     5    96  3077    0     24
9     6     0   62    14    1  107     4     7    23  266      3
10   20    27    4    10  115    1    28    45    98    0  12448
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5654516, 'precision': 0.6683035, 'recall': 0.4441992, 'specificity': 0.9553368, 'f1': 0.3953793, 'auroc': 0.8473224}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   115     0   0   22    0   0   881    52    54    5    41
1     0  1234   0   26    0   0     4   163    17    0    55
2     1    16   7   39    8   3    52    56   583    8   242
3     0     0   0    0    0   0     0     0     0    0     0
4     0     3   0    0  113   0     5     1    57    0  1454
5     0     0   0  369    0  68    36     3    96   19     1
6     8     3   0    2    2   1  2389     2    78    0   582
7     0    11   0    3    0   0    17  1112    15    0     6
8     0     0   0   54    0   0     8    14  1289    0     5
9     0    36   3  223    0  11    78   131   514  119    22
10    0     1   0    0    6   0     0     0     3    0  1636
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-12 04:15:51.125921,epoch time: 0:35:58.360040,used: 3:01:19.273120,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93228275, 'precision': 0.8323995, 'recall': 0.82715285, 'specificity': 0.9929061, 'f1': 0.8272456, 'auroc': 0.9936641}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   360     2    0     4    1    3    43     3    11    6     50
1     0  1266    0    12    0    0     0    37    10    1      5
2     1     0  178     0   35    0     2     2     5   88      1
3     3    39    2  7786    1   50     5   240   303    8      0
4     4     1   39     2  325    1     2     2    40   16    106
5     1     1    2    26    0  411     2     0     9   68      1
6     9     4    0     4    0    1  1862     5     8    2     13
7     0    61    6   195    2    0    11  6762   201    7     19
8     0     9    5    61    7    8    13    50  3114    9     19
9     3     0   20     6    1  106     2     2    10  341      2
10   12    44    6    10  101    1    35    39   102    4  12440
---- Validation: 
scalar performance:
{'acc': 0.9312291, 'precision': 0.8267132, 'recall': 0.82128954, 'specificity': 0.99280053, 'f1': 0.8208076, 'auroc': 0.9937105}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   340     0    0     3    1    1    57     5     8   11     57
1     0  1259    0    11    0    0     0    50    10    0      2
2     0     0  169     0   33    1     3     1     9   94      2
3     1    36    0  7785    0   65     8   234   300    9      2
4     1     2   42     2  323    3     1     3    42   13    107
5     1     2    0    21    0  416     0     0     8   72      1
6     6     4    0     7    1    1  1847     3    11    6     22
7     1    63    5   180    5    0     8  6765   210   10     18
8     1     9    8    67    7    4     7    56  3108    9     20
9     3     0   25     4    1   99     4     1     7  349      0
10   17    44   10     9  101    1    36    28    93    4  12453
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.600014, 'precision': 0.67125404, 'recall': 0.4830011, 'specificity': 0.95849514, 'f1': 0.45476088, 'auroc': 0.8492309}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   89     0   0   19   0    0   888    6    26   95    47
1    0  1279   0   33   0    0    14   96    23    0    54
2    1    12  12   32  22   10    67   11   525   92   231
3    0     0   0    0   0    0     0    0     0    0     0
4    0     4   0    0  72    0    10    0    63    0  1484
5    0     0   0  214   0  245    27    0    32   73     1
6    4     2   0    2   0    1  2686    2    37    2   331
7    0    31   0   23   0    0   219  830    49    5     7
8    0     0   0   73   0    1    22    4  1255    4    11
9    0    29   2  170   1   54    70   36   285  472    18
10   0     1   0    0   4    0     2    0     3    0  1636
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 04:51:47.304712,epoch time: 0:35:56.178791,used: 3:37:15.451911,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9392926, 'precision': 0.85499334, 'recall': 0.8346771, 'specificity': 0.9934342, 'f1': 0.84330094, 'auroc': 0.9935052}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   372     1    0     6    2    0    15     7     6    3     71
1     0  1223    0    12    0    0     0    87     6    0      4
2     2     0  183     0   39    0     1     3     6   74      4
3     1    25    2  8048    0   16     1   169   167    6      2
4     1     0   27     0  364    1     1     5    16   14    110
5     0     0    0    43    0  414     0     0     7   56      1
6    16     2    0     9    5    1  1826     9     9    4     26
7     0    49    6   234    7    0     3  6778   152    3     33
8     0     4    3   127   26    1     3    49  3038    3     42
9     1     0   25    13    1  101     0     3     5  341      3
10    5    42    5    18  115    2    11    30    43    0  12520
---- Validation: 
scalar performance:
{'acc': 0.93740803, 'precision': 0.84768105, 'recall': 0.8258126, 'specificity': 0.9932379, 'f1': 0.83501774, 'auroc': 0.9933426}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   365     3    1     8    2    1    18     6     6    5     68
1     0  1218    0    18    0    0     0    87     5    0      4
2     0     1  174     2   48    1     1     1     7   77      0
3     3    26    1  8061    1   18     2   154   167    3      4
4     2     2   33     4  356    1     1     2    21    9    108
5     1     0    0    47    0  416     0     0     8   48      1
6     9     7    2     5    2    1  1823     8    15    2     34
7     1    46    4   259    3    0     4  6777   136    3     32
8     1     1    4   129   26    2     6    59  3023    1     44
9     1     0   27    13    2  114     2     3     6  325      0
10    7    36    5    19  125    1    13    30    52    1  12507
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5595746, 'precision': 0.65729743, 'recall': 0.4449101, 'specificity': 0.95514506, 'f1': 0.4181613, 'auroc': 0.8446935}
confusion matrix:
     0     1   2    3    4   5     6    7     8    9     10
0   122     0   0   45    0   0   722   25    28  109   119
1     1  1297   0   38    0   0     4   82     9    0    68
2     0    30   3   73   34   0    28   20   475   54   298
3     0     0   0    0    0   0     0    0     0    0     0
4     0     4   0    1  100   0     3    2    40    0  1483
5     0     0   0  383    0  88    13    1    23   83     1
6     2     3   0    3    2   0  2276    2    73    2   704
7     0    35   0   70    0   0    77  953    20    0     9
8     0     1   0  129    1   1     3    9  1217    1     8
9     0    55   1  375    0  15    43   46   269  304    29
10    0     1   0    0    5   0     1    0     1    0  1638
better model found
persisted
after epoch: 7,now: 2024-08-12 05:27:27.416684,epoch time: 0:35:40.111972,used: 4:12:55.563883,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94413525, 'precision': 0.86550486, 'recall': 0.8412265, 'specificity': 0.9938936, 'f1': 0.85067314, 'auroc': 0.9947338}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   365     3    0     1    1    1    24     9     1    2     76
1     0  1288    0     6    0    0     1    31     4    0      2
2     1     1  199     0   35    0     2     4     1   67      2
3     3    61    1  7911    0   33     5   239   175    4      5
4     2     0   31     0  334    1     0     7    12    9    142
5     0     0    1    24    0  444     0     0     5   46      1
6     7     7    1     3    1    1  1834     4     7    4     39
7     0    77    5   143    2    1     3  6929    64    7     31
8     0    19    8    87   20    3     9    69  2984    9     88
9     3     1   24     8    2  114     2     1     3  331      4
10    7    27    2     6   32    1     5    26    18    1  12669
---- Validation: 
scalar performance:
{'acc': 0.9418216, 'precision': 0.8578836, 'recall': 0.833557, 'specificity': 0.99365115, 'f1': 0.84285766, 'auroc': 0.99446523}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   370     4    0     2    1    0    21     7     2    7     69
1     0  1281    0    10    0    0     0    33     7    0      1
2     0     1  187     0   37    0     1     3     4   74      5
3     0    61    1  7919    0   44     3   236   166    6      4
4     1     0   30     2  325    2     0     4    14    7    154
5     1     3    0    26    0  435     0     0     3   52      1
6     9     8    1     4    3    1  1830     3     8    3     38
7     1    94    2   153    3    0     4  6888    66    6     48
8     0    15    4    85   21    5    11    75  2994    5     81
9     3     1   27     4    2  116     2     5     5  326      2
10    6    29    1    10   47    1    10    25    12    0  12655
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5707689, 'precision': 0.69070256, 'recall': 0.454485, 'specificity': 0.95579004, 'f1': 0.41547844, 'auroc': 0.8408124}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   101     0   0   28   0    0   849    33    15   36   108
1     0  1327   0   30   0    0     4    77     4    0    57
2     0    47   1   42   2    2    36    31   386   36   432
3     0     0   0    0   0    0     0     0     0    0     0
4     0     7   0    0  20    0     4     2    30    0  1570
5     0     0   0  288   0  137    31     4    44   85     3
6     2     3   0    3   1    0  2428     2    39    0   589
7     0    51   0   22   0    0    57  1011    12    0    11
8     0     1   0   68   0    1    16    12  1240    1    31
9     0    97   0  229   0   20    69   102   304  249    67
10    0     1   0    0   1    0     0     0     0    0  1644
better model found
persisted
after epoch: 8,now: 2024-08-12 06:03:10.221820,epoch time: 0:35:42.805136,used: 4:48:38.369019,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9416738, 'precision': 0.8579493, 'recall': 0.84936845, 'specificity': 0.9938253, 'f1': 0.8509656, 'auroc': 0.99527526}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   375     0    1     5    3    1    34     6     4    7     46
1     0  1297    0    10    0    0     0    19     4    0      2
2     2     1  203     1   35    0     1     5     6   57      1
3     0    59    0  8020    0   33    10   137   175    2      1
4     2     2   33     0  355    1     2     4    28    7    105
5     0     0    0    24    1  455     0     0     3   37      1
6     5    14    0     6    1    0  1847     4     5    2     22
7     1   147    2   219    2    0     9  6711   155    2     17
8     2     9    4    91    7    3     9    44  3079    0     46
9     2     0   28     7    2  120     2     2     8  321      1
10    9    73    1     8   83    1     9    30    46    2  12533
---- Validation: 
scalar performance:
{'acc': 0.9395747, 'precision': 0.8522744, 'recall': 0.8428992, 'specificity': 0.99359953, 'f1': 0.844793, 'auroc': 0.9937167}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     5    0     3    0    0    31     4     5    6     51
1     0  1285    1     9    0    0     0    29     6    0      2
2     0     2  198     0   32    3     2     3     7   63      2
3     1    82    1  8007    0   27     8   138   173    1      2
4     1     1   35     0  346    2     3     4    28    9    110
5     1     0    1    23    0  451     1     0     5   38      1
6     8     5    0     7    2    0  1849     5     6    0     26
7     4   155    2   227    2    0    11  6686   150    4     24
8     0    10    3   100    4    2    13    40  3086    0     38
9     3     4   30     9    2  125     2     1     5  310      2
10    6    69    3     6   82    0    12    28    56    4  12530
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5711887, 'precision': 0.6881485, 'recall': 0.45090985, 'specificity': 0.9558208, 'f1': 0.40932822, 'auroc': 0.8423672}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   106     0   0   23   0    0   889    35     9   26    82
1     0  1295   0   32   0    0     4   118     9    0    41
2     0    31   1   47   5    2    62    37   578   25   227
3     0     0   0    0   0    0     0     0     0    0     0
4     0     8   0    0  34    0     8     2    78    0  1503
5     0     0   0  280   0  130    54     3    40   83     2
6     1     3   0    2   0    0  2510     2    78    0   471
7     0    16   0   24   0    0    65  1042    10    0     7
8     0     0   0   93   0    1    31     9  1225    1    10
9     0    47   0  291   0   14    91   100   381  184    29
10    0     2   0    0   2    0     2     0     3    0  1637
early stop counter: 1
val acc:0.9395747184753418, best validation acc: 0.9418215751647949, corresponding to test acc:                         0.5707688927650452 / 0.6000139713287354
after epoch: 9,now: 2024-08-12 06:38:53.466956,epoch time: 0:35:43.245136,used: 5:24:21.614155,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9470248, 'precision': 0.8721947, 'recall': 0.8519543, 'specificity': 0.9943855, 'f1': 0.8574537, 'auroc': 0.99636304}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   373     1    0     3    1    1    43     6     3    5     47
1     0  1270    0     7    0    0     1    38    10    0      5
2     0     0  169     0   50    1     3     0     5   82      2
3     1    18    1  7995    0   58     4   112   240    6      2
4     1     1   15     1  381    3     3     1    22    4    107
5     0     0    0    10    0  453     0     0     4   53      1
6     5     3    0     1    1    0  1871     2     7    1     17
7     1    54    5   218    5    1    13  6745   187    7     26
8     0     4    3    53    8    6     7    24  3154    5     32
9     1     0   12     2    0  108     1     2     5  358      4
10    8    25    2     7   48    2    22     9    44    0  12627
---- Validation: 
scalar performance:
{'acc': 0.9468236, 'precision': 0.8726607, 'recall': 0.85250586, 'specificity': 0.9943249, 'f1': 0.85810214, 'auroc': 0.9960917}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     2    0     6    1    1    33     3     2    3     54
1     0  1273    1     9    0    0     0    35     9    0      5
2     0     1  169     0   54    1     4     1     3   76      3
3     3    22    0  8001    0   62     6   118   223    3      2
4     1     1   14     1  367    1     3     1    27    9    114
5     0     0    0     7    0  465     0     0     4   44      1
6     3     3    0     3    0    1  1867     1     1    2     27
7     5    30    3   208    5    0    11  6764   201    4     34
8     0     1    4    63   11    7     5    28  3140    3     34
9     2     0   15     3    2  104     1     1     6  359      0
10    5    23    1     6   64    3    15    14    51    0  12614
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59147835, 'precision': 0.69597846, 'recall': 0.46474084, 'specificity': 0.9575073, 'f1': 0.43549228, 'auroc': 0.8398637}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   197     0   0    8   0    1   794    6    13   23   128
1     0  1232   0   29   0    0    16   97    14    0   111
2     0    14   1   12   9    2    61   10   496   29   381
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  41    0     9    0    50    0  1532
5     0     0   0  179   0  161    62    0    64  122     4
6     0     1   0    1   0    0  2748    1    48    0   268
7     0    17   0   28   0    0   176  888    37    0    18
8     0     0   0   40   0    1    38    2  1274    0    15
9     0    33   0  145   2   19   128   42   424  270    74
10    0     0   0    0   1    0     3    0     0    0  1642
better model found
persisted
after epoch: 10,now: 2024-08-12 07:14:45.765928,epoch time: 0:35:52.298972,used: 6:00:13.913127,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:00:13.913127 at 2024-08-12 07:14:45.765928
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59147835, 'precision': 0.69597846, 'recall': 0.46474084, 'specificity': 0.9575073, 'f1': 0.43549228, 'auroc': 0.8398637}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   197     0   0    8   0    1   794    6    13   23   128
1     0  1232   0   29   0    0    16   97    14    0   111
2     0    14   1   12   9    2    61   10   496   29   381
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  41    0     9    0    50    0  1532
5     0     0   0  179   0  161    62    0    64  122     4
6     0     1   0    1   0    0  2748    1    48    0   268
7     0    17   0   28   0    0   176  888    37    0    18
8     0     0   0   40   0    1    38    2  1274    0    15
9     0    33   0  145   2   19   128   42   424  270    74
10    0     0   0    0   1    0     3    0     0    0  1642
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.600014, 'precision': 0.67125404, 'recall': 0.4830011, 'specificity': 0.95849514, 'f1': 0.45476088, 'auroc': 0.8492309}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   89     0   0   19   0    0   888    6    26   95    47
1    0  1279   0   33   0    0    14   96    23    0    54
2    1    12  12   32  22   10    67   11   525   92   231
3    0     0   0    0   0    0     0    0     0    0     0
4    0     4   0    0  72    0    10    0    63    0  1484
5    0     0   0  214   0  245    27    0    32   73     1
6    4     2   0    2   0    1  2686    2    37    2   331
7    0    31   0   23   0    0   219  830    49    5     7
8    0     0   0   73   0    1    22    4  1255    4    11
9    0    29   2  170   1   54    70   36   285  472    18
10   0     1   0    0   4    0     2    0     3    0  1636
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_01_14_31_seed_1_24142414_instance_wise_predictions.txt
accuracy from prediction file 0.5914783460435178
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/28.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/28.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 497754 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool | 407040 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |  90714 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 497754 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool | 407040 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |  90714 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10868 MiB |   1168 TiB |   1168 TiB |
|       from large pool | 387840 KiB |  10797 MiB |   1166 TiB |   1166 TiB |
|       from small pool |  90258 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11244 MiB |  11244 MiB |  21762 MiB |  10518 MiB |
|       from large pool |  11116 MiB |  11116 MiB |  21604 MiB |  10488 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 286629 KiB |    955 MiB | 547745 GiB | 547745 GiB |
|       from large pool | 276992 KiB |    941 MiB | 545811 GiB | 545811 GiB |
|       from small pool |   9637 KiB |     30 MiB |   1933 GiB |   1933 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   89265 K  |   89262 K  |
|       from large pool |      87    |     490    |   41753 K  |   41753 K  |
|       from small pool |    2922    |    4522    |   47511 K  |   47508 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   89265 K  |   89262 K  |
|       from large pool |      87    |     490    |   41753 K  |   41753 K  |
|       from small pool |    2922    |    4522    |   47511 K  |   47508 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     291    |     291    |     500    |     209    |
|       from large pool |     227    |     227    |     421    |     194    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    1035    |   38967 K  |   38967 K  |
|       from large pool |      19    |     117    |   20582 K  |   20582 K  |
|       from small pool |      20    |    1016    |   18384 K  |   18384 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool |  16640 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10931 MiB |   1173 TiB |   1173 TiB |
|       from large pool |  16640 KiB |  10859 MiB |   1171 TiB |   1171 TiB |
|       from small pool |      0 KiB |    127 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10868 MiB |   1168 TiB |   1168 TiB |
|       from large pool |  16640 KiB |  10797 MiB |   1166 TiB |   1166 TiB |
|       from small pool |      0 KiB |    126 MiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 784384 KiB |  11244 MiB |  21762 MiB |  20996 MiB |
|       from large pool | 684032 KiB |  11116 MiB |  21604 MiB |  20936 MiB |
|       from small pool | 100352 KiB |    128 MiB |    158 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |    955 MiB | 547745 GiB | 547745 GiB |
|       from large pool |  59136 KiB |    941 MiB | 545812 GiB | 545812 GiB |
|       from small pool |      0 KiB |     30 MiB |   1933 GiB |   1933 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   89265 K  |   89265 K  |
|       from large pool |       2    |     490    |   41753 K  |   41753 K  |
|       from small pool |       0    |    4522    |   47511 K  |   47511 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   89265 K  |   89265 K  |
|       from large pool |       2    |     490    |   41753 K  |   41753 K  |
|       from small pool |       0    |    4522    |   47511 K  |   47511 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     291    |     500    |     421    |
|       from large pool |      30    |     227    |     421    |     391    |
|       from small pool |      49    |      64    |      79    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1035    |   38968 K  |   38968 K  |
|       from large pool |       3    |     117    |   20582 K  |   20582 K  |
|       from small pool |       0    |    1016    |   18385 K  |   18385 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 07:21:05 2024]
Finished job 0.
1 of 1 steps (100%) done
