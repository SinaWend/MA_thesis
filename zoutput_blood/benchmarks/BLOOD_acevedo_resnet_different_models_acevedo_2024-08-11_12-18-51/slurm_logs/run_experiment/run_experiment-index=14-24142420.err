Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 23:20:17 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/14.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=14
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420

 Experiment start at: 2024-08-11 23:28:28.866655
before training, model accuracy: 0.05282306298613548
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8097175, 'precision': 0.41619223, 'recall': 0.42436135, 'specificity': 0.97853804, 'f1': 0.4184306, 'auroc': 0.9412421}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    25   0   0  211    36   148   0     63
1    0  1086   0    13   0   0    0   186     6   0     41
2    0     0   0    11   0   0   69    36   172   0     24
3    0     0   0  7334   0   0    1   738   351   0     13
4    0     0   0     6   0   0   73    22   151   0    287
5    0     0   0   336   0   0   38     3   143   0      1
6    0     5   0    29   0   0  930    66   495   0    383
7    0    48   0   535   0   0    4  6400   165   0    111
8    0     2   0   434   0   0   55   323  2132   0    350
9    0     0   0   121   0   0   91    27   252   0      2
10   0     7   0    13   0   0  129    83   178   0  12382
---- Validation: 
scalar performance:
{'acc': 0.8084793, 'precision': 0.41607913, 'recall': 0.42445636, 'specificity': 0.97839946, 'f1': 0.4184099, 'auroc': 0.9391719}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    27   0   0  216    32   136   0     72
1    0  1094   0    13   0   0    0   177     6   0     42
2    0     1   0    15   0   0   66    44   163   0     23
3    0     1   0  7305   0   0    0   743   367   0     24
4    0     0   0    10   0   0   75    24   140   0    290
5    0     0   0   329   0   0   38     2   151   0      1
6    0     4   0    24   0   0  928    67   488   0    397
7    0    41   0   554   0   0    1  6363   191   0    115
8    0     0   0   454   0   0   63   315  2149   0    315
9    0     0   0   119   0   0   95    21   257   0      1
10   0     5   0    13   0   0  133    78   181   0  12386
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34310502, 'precision': 0.24397318, 'recall': 0.26629668, 'specificity': 0.92924523, 'f1': 0.22994056, 'auroc': 0.73686254}
confusion matrix:
    0    1   2    3   4   5     6    7    8   9     10
0    0    7   0    2   0   0  1144    8    7   0     2
1    0  984   0   18   0   0    87   75   10   0   325
2    0    1   0   30   0   0   800    3   45   0   136
3    0    0   0    0   0   0     0    0    0   0     0
4    0    0   0    0   0   0    74    0    0   0  1559
5    0    0   0  231   0   0   211    2  148   0     0
6    0    3   0    0   0   0  1169    1    3   0  1891
7    0  257   0    1   0   0   165  655   30   0    56
8    0    0   0   29   0   0   807    2  454   0    78
9    0    6   0  124   0   0   815   15  157   0    20
10   0    0   0    0   0   0     4    0    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 00:01:14.302482,epoch time: 0:32:45.435827,used: 0:32:45.435827,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.85867935, 'precision': 0.6402734, 'recall': 0.5049432, 'specificity': 0.98433614, 'f1': 0.5004853, 'auroc': 0.9723811}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    2     0   0    29   0    8   315    24    39   1     65
1    0  1118   0    17   0    0     0   168     7   0     21
2    0     0   0     5   0    2   104    53   121   2     25
3    0     0   0  7551   0    4     2   544   334   0      3
4    0     0   0     6   0    0   104    18   129   0    282
5    0     0   0   248   0  135    74     1    51  11      1
6    0     1   0    19   0    1  1597    34    83   2    171
7    0    37   0   368   0    0     3  6642   148   0     64
8    0     0   0   231   0    0    36   179  2677   1    172
9    0     0   0    79   0   50   205    24   120  13      2
10   0     8   0    26   0    1   181    55   163   0  12359
---- Validation: 
scalar performance:
{'acc': 0.85713524, 'precision': 0.6378619, 'recall': 0.5046706, 'specificity': 0.98414445, 'f1': 0.5005182, 'auroc': 0.9734123}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    1     0   0    25   0    6   328    20    42   1     60
1    0  1113   0    18   0    0     0   173     7   0     21
2    0     0   0     7   0    1   107    45   124   2     26
3    0     2   0  7495   0    6     2   556   377   0      2
4    0     0   0     3   0    1   101    13   135   0    286
5    0     0   0   261   0  146    49     2    48  13      2
6    0     3   0    17   0    4  1578    33    85   0    188
7    0    28   0   369   0    0     3  6657   140   0     68
8    0     1   0   242   0    0    47   175  2665   0    166
9    0     2   0    96   0   67   182    17   112  13      4
10   0     7   0    28   0    0   153    67   165   0  12376
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42853144, 'precision': 0.39231658, 'recall': 0.3453735, 'specificity': 0.93787706, 'f1': 0.31658572, 'auroc': 0.7714674}
confusion matrix:
    0     1   2   3   4    5     6    7    8   9     10
0    0     5   0   2   0    1  1149    7    4   1     1
1    0  1195   0  21   0    0    86   79    6   0   112
2    0     4   0   7   0   14   811    6   30   1   142
3    0     0   0   0   0    0     0    0    0   0     0
4    0     0   0   0   0    0    72    0    0   0  1561
5    0     0   0  85   0  258   208    1   35   2     3
6    0     3   0   0   0    0  1804    0    0   0  1260
7    0   312   0   3   0    0   176  633   12   0    28
8    0     0   0  12   0   28   695    1  563  17    54
9    0    12   0  49   0   78   880   19   58  27    14
10   0     0   0   0   0    0     1    0    0   0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 00:32:40.646826,epoch time: 0:31:26.344344,used: 1:04:11.780171,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.88934076, 'precision': 0.77230024, 'recall': 0.62926716, 'specificity': 0.98762095, 'f1': 0.6534657, 'auroc': 0.98351735}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   156     1   0    23   0   12   148    22    19   31     71
1     0  1165   0    18   0    0     0   129    10    0     10
2     5     0  25     8  21   10    12    47    77   79     28
3     0     0   0  7781   0   38     0   428   188    3      2
4     2     0   2     3  72    5    27    13   111   20    284
5     0     0   0   123   0  342     1     0    14   40      1
6     9     1   0    15   0   12  1665    27    34    8    136
7     0    35   0   377   0    0     3  6661   127    3     57
8     1     0   1   292   4    5    10   156  2690    6    130
9     3     2  13    45   2  180     9    11    52  171      4
10    4     6   1    16   7    3    96    51    96    0  12512
---- Validation: 
scalar performance:
{'acc': 0.89102584, 'precision': 0.76539814, 'recall': 0.6274366, 'specificity': 0.9877975, 'f1': 0.65123343, 'auroc': 0.9827882}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   151     0   0    18   0   19   149    21    15   29     81
1     0  1141   0    19   0    0     0   156     4    0     12
2     9     1  25     8  25    8    20    35    80   75     26
3     0     2   0  7816   0   36     0   407   174    2      3
4     4     0   8     5  64    2    40    12   108   12    284
5     2     0   0   118   0  351     3     2    13   31      1
6    16     1   0    22   1    8  1658    24    36    8    134
7     0    19   0   346   1    0     0  6718   128    1     52
8     1     0   0   288   5    9    16   142  2700    5    130
9     9     1   7    52   2  173    11    20    44  169      5
10    5     7   1    18   4    2    87    57    96    1  12518
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.45735675, 'precision': 0.5086448, 'recall': 0.4087717, 'specificity': 0.9425145, 'f1': 0.3851835, 'auroc': 0.81817025}
confusion matrix:
    0     1   2   3   4    5     6    7    8    9     10
0   32     0   0   1   0    2  1042    2    2   85     4
1    0  1206   0  25   0    0    75   63    9   11   110
2    3     1  10   4  48   30   423    4   56   96   340
3    0     0   0   0   0    0     0    0    0    0     0
4    0     0   0   0   7    0    15    0    1    1  1609
5    5     0   0  15   0  376    17    0    5  171     3
6    1     3   0   0   0    0  1310    0    0    3  1750
7    6   200   2   9   1    0   270  557   15   64    40
8    1     0   1  21  11   29   205    0  772  194   136
9    4    11  10  20   4   98   305    3   35  621    26
10   0     0   0   0   0    0     0    0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 01:04:00.275902,epoch time: 0:31:19.629076,used: 1:35:31.409247,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90793556, 'precision': 0.8027108, 'recall': 0.70701754, 'specificity': 0.98979795, 'f1': 0.7408267, 'auroc': 0.9883796}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   282     0    1     8    0    1    92    20    16    4     59
1     0  1182    0    12    1    0     0   124     2    0     11
2    12     1  102     3   33    2     6    47    37   56     13
3     0     0    0  7725    0   16     1   506   187    0      2
4     8     0   24     3  146    0    20    15    90   11    222
5     8     0    2   108    0  296     0     0    11   93      2
6    16     0    0    12    0    2  1759    21    27    3     67
7     0    22    1   198    1    0     2  6902    82    1     54
8     0     0    2   214    8    1    12   190  2792    3     74
9    32     2   38    45    0   69     8    11    26  260      2
10   14     2    4     5   28    1    88    42   118    3  12489
---- Validation: 
scalar performance:
{'acc': 0.9059783, 'precision': 0.7874892, 'recall': 0.7020216, 'specificity': 0.98961705, 'f1': 0.7334069, 'auroc': 0.9879591}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   272     0    1     8    0    0   105    19    11    5     62
1     0  1194    0    10    0    0     0   116     2    0     10
2    14     1  101     3   36    0     6    39    38   60     14
3     0     0    0  7683    0   17     1   542   189    5      3
4     7     0   35     2  157    2    18    14    82   11    211
5    10     0    1   114    0  293     3     2    13   84      1
6    21     0    1     4    0    0  1760    20    29    5     68
7     0    22    0   213    1    0     3  6905    79    0     42
8     1     0    1   221   11    4    14   196  2763    3     82
9    37     2   43    31    0   92     9    11    26  240      2
10   15     5    1     8   36    2    83    43   101    0  12502
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5239628, 'precision': 0.5490185, 'recall': 0.4306673, 'specificity': 0.94935715, 'f1': 0.42927742, 'auroc': 0.8328161}
confusion matrix:
    0     1   2   3    4    5     6    7    8    9     10
0   90     0   1   5    0    0  1052    2    2   15     3
1    1  1268   0  28    0    0    54   65    3    2    78
2   13     6  49   7  150    7   419    5   78   72   209
3    0     0   0   0    0    0     0    0    0    0     0
4    0     0   1   0  167    0    24    0    2    0  1439
5   37     0   0  70    0  224    50    0    6  202     3
6    6     4   1   0   19    0  2029    0    2    0  1006
7   12   222   8  17    0    0   256  595   13    5    36
8    5     0  16  50   32    8   180    0  928   96    55
9   49    20  66  47    4   18   358   13   40  500    22
10   0     1   0   0    5    0     1    0    0    0  1639
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 01:35:22.092423,epoch time: 0:31:21.816521,used: 2:06:53.225768,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.914223, 'precision': 0.8055032, 'recall': 0.74714696, 'specificity': 0.9905766, 'f1': 0.7693809, 'auroc': 0.990241}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   343     0    1     7    2    0    15    23     9    4     79
1     0  1197    0    13    0    0     0   114     2    0      4
2     8     1  140     4   36    1     0    36    22   58      6
3     2     1    0  7715    0   14     0   491   210    4      0
4     4     0   49     1  236    0     6    11    59   11    162
5     9     0    3    99    0  251     0     0    11  147      1
6    70     0    1    13    2    0  1669    24    29    6     92
7     1    30    1   174    2    0     0  6944    85    2     25
8     1     0    9   166   17    1     4   160  2872    4     62
9    18     0   50    22    0   42     1     9    28  319      4
10   23     8    5    14   63    1    19    65   111    2  12484
---- Validation: 
scalar performance:
{'acc': 0.91515315, 'precision': 0.8058121, 'recall': 0.74543834, 'specificity': 0.9906961, 'f1': 0.76887774, 'auroc': 0.9905994}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   339     1    0     6    0    0    24    21    18    6     68
1     0  1191    0    13    1    0     0   120     3    0      4
2     9     2  137     2   37    1     1    31    27   58      7
3     1     0    0  7728    0   20     0   464   221    5      1
4     3     0   50     4  228    0     3    12    65   15    159
5     8     0    1    93    0  261     0     0    14  143      1
6    70     1    0    11    5    0  1655    20    43    5     98
7     0    20    1   168    2    0     1  6971    78    1     23
8     0     0    5   165   24    1     2   163  2872    6     58
9    17     2   48    29    0   41     2    13    20  320      1
10   21     7    2    14   58    1    25    66    89    2  12511
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.484363, 'precision': 0.5706767, 'recall': 0.44037, 'specificity': 0.94652826, 'f1': 0.44130898, 'auroc': 0.8347434}
confusion matrix:
     0     1    2   3    4    5    6    7     8    9     10
0   320     1    2  14    0    0  750    2     7   33    41
1     1  1317    0  32    0    0   16   62     9    1    61
2     7    10   91   8  171    1   97    8   119   88   415
3     0     0    0   0    0    0    0    0     0    0     0
4     0     1    3   0  191    0    2    0     4    0  1432
5    24     0    0  81    0  154   20    0    11  297     5
6     9     5    2   0   22    0  765    0     2    1  2261
7    27   125   18  35    1    0  100  787    21   19    31
8     4     0   21  50   35    5   42    0  1041   76    96
9    28    34  140  59    5    6  116   11    65  620    53
10    0     0    0   0    9    0    0    0     0    0  1637
better model found
persisted
after epoch: 5,now: 2024-08-12 02:06:52.957440,epoch time: 0:31:30.865017,used: 2:38:24.090785,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9240689, 'precision': 0.81621516, 'recall': 0.7752984, 'specificity': 0.99170136, 'f1': 0.7909343, 'auroc': 0.99241275}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    1     7    0    0    15    10     5    3     48
1     0  1233    0    15    1    0     1    73     5    0      4
2    14     0  149     2   27    4     3    21    19   67      6
3     4     0    0  8063    0   24     0   226   120    2      0
4     9     0   47     4  234    1     8     9    61   14    151
5    11     0    2    81    0  344     0     0     8   74      1
6    44     0    0    11    1    1  1783     7    18    1     42
7     3    26    3   351    1    0     3  6756    92    3     26
8     4     1    4   273   12    4    12   106  2834    5     40
9    35     1   35    25    0  100     3     4    12  275      2
10   44     1    5    19   45    1    46    35   122    1  12473
---- Validation: 
scalar performance:
{'acc': 0.92467564, 'precision': 0.8222026, 'recall': 0.7752538, 'specificity': 0.99174416, 'f1': 0.7931725, 'auroc': 0.992397}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   381     0    0     9    0    0    28    11     6    4     44
1     0  1227    0    13    0    0     0    82     3    0      7
2    15     1  155     2   28    2     2    20    20   63      4
3     4     0    0  8064    0   18     3   222   126    3      0
4     5     0   48     2  221    1    11    10    63   12    166
5     8     0    1    75    0  346     1     0     8   81      1
6    58     0    1     9    2    2  1768    11    17    3     37
7     3    25    1   367    2    0     2  6750    83    2     30
8     4     1    4   267    9    4     9   103  2853    4     38
9    28     2   31    22    0   90     5     6    14  292      3
10   36     4    5    17   38    1    49    41    93    0  12512
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5266214, 'precision': 0.59787625, 'recall': 0.4480145, 'specificity': 0.9502061, 'f1': 0.45483434, 'auroc': 0.8323927}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   229     0   1   16    0    0   902    0     2    9    11
1     2  1295   0   40    0    0    30   62     4    1    65
2     5     9  66   12   92    5   246    4   120   49   407
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   2    0  124    0    11    0     5    0  1491
5    21     0   0  106    0  241    69    0    10  140     5
6     9     3   0    0   12    0  1737    0     3    0  1303
7     6    67   8   92    0    0   232  690    36    8    25
8     1     0  13   67   14    8    91    0  1059   49    68
9    27    29  90   95    4   24   317    3    60  445    43
10    0     1   0    0    4    0     0    0     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 02:38:07.417030,epoch time: 0:31:14.459590,used: 3:09:38.550375,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93030286, 'precision': 0.84180874, 'recall': 0.77813345, 'specificity': 0.9922482, 'f1': 0.8052914, 'auroc': 0.99355954}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   348     0    0    12    0    0    31    10     5    4     73
1     0  1246    0    16    1    0     0    60     4    0      4
2     3     1  142     1   49    0     2    23    11   74      6
3     0     0    0  7991    0   22     4   312   109    1      0
4     1     0   27     2  270    0     6    15    44   15    159
5     4     0    1    87    0  324     3     0     9   92      1
6    16     0    0    14    2    0  1797     4    17    2     56
7     0    31    4   243    2    0     2  6881    69    2     29
8     3     0    2   228   14    3     8   120  2847    3     67
9     9     1   37    27    0   72     5     3    14  315     10
10   14     5    1    16   49    3    19    27    47    1  12610
---- Validation: 
scalar performance:
{'acc': 0.9312826, 'precision': 0.8444, 'recall': 0.785239, 'specificity': 0.9923675, 'f1': 0.81088495, 'auroc': 0.993458}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   354     0    1     8    0    0    33     9     5    4     69
1     0  1248    0    19    1    0     1    54     4    0      5
2    10     2  155     3   38    0     2    20    17   59      6
3     1     2    0  8016    0   14     1   295   107    4      0
4     4     0   25     0  277    3     3     8    46   10    163
5     1     0    1    80    0  327     3     0     6  102      1
6    17     0    2    12    1    1  1803     4    10    4     54
7     0    26    3   236    2    0     2  6880    81    1     34
8     2     2    3   233   13    2     7   114  2859    1     60
9    11     1   41    25    1   75     6     6     9  314      4
10   12     5    5    23   47    0    27    35    58    1  12583
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4931785, 'precision': 0.60486186, 'recall': 0.41464964, 'specificity': 0.94689703, 'f1': 0.42116725, 'auroc': 0.8304865}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   110     0   2   16    0    0   968    0     2   13    59
1     0  1319   1   45    0    0    31   47     4    1    51
2     0    10  56   15  153    2   165    4   129   41   440
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   1    0  209    0     5    0     6    0  1411
5     4     0   0  130    0  176    72    0    10  186    14
6     2     5   0    0   16    0  1513    0     3    1  1527
7     0    76   8  169    0    0   278  566    25    8    34
8     1     0  13   86   24    2    66    0  1030   37   111
9     2    30  98  120   11   10   291    3    58  433    81
10    0     1   0    0    8    0     0    0     0    0  1637
better model found
persisted
after epoch: 7,now: 2024-08-12 03:09:38.055426,epoch time: 0:31:30.638396,used: 3:41:09.188771,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93498504, 'precision': 0.83334833, 'recall': 0.8164848, 'specificity': 0.9929348, 'f1': 0.8234527, 'auroc': 0.9937841}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   383     0    2     6    1    0    13     9     4    4     61
1     0  1255    0    14    0    0     0    54     5    0      3
2     3     1  211     1   29    1     3     8    13   38      4
3     2     0    0  7859    0   41     1   329   201    3      1
4     3     1   52     1  298    1     2     8    32   10    131
5     4     0    4    46    0  378     0     0     5   83      1
6    21     1    1    11    5    1  1797     5    14    5     47
7     1    35   10   176    4    0     2  6902   103    1     29
8     3     0    6   116   23    7     7    88  2980    2     63
9     8     1   73    13    2   89     3     5    12  285      2
10   29     7    7    15   69    2     7    21    39    0  12598
---- Validation: 
scalar performance:
{'acc': 0.93302125, 'precision': 0.8304746, 'recall': 0.81430197, 'specificity': 0.99272627, 'f1': 0.82093334, 'auroc': 0.9938274}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     0    1     4    0    1    14     5     8    2     63
1     0  1251    1    12    2    0     0    56     6    0      4
2     6     1  211     1   28    1     4     7    12   35      6
3     3     0    1  7850    0   36     0   339   206    4      1
4     4     1   54     2  299    1     5    11    22   10    130
5     5     0    2    47    0  360     0     1     6   99      1
6    22     0    3    10    4    0  1791     6    15    3     54
7     0    39   11   178    4    0     5  6887   112    1     28
8     1     2    9   117   23    8     7    95  2968    7     59
9    10     0   66     9    2   91     2     4    10  295      4
10   19     7   12    22   65    3     9    23    51    1  12584
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51864547, 'precision': 0.6080447, 'recall': 0.47027245, 'specificity': 0.9501913, 'f1': 0.4848104, 'auroc': 0.84218514}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   308     0    4   22    2    0   672    0     4   55   103
1     1  1299    1   48    0    0    21   60     7    3    59
2     2     8  142    9  207    8    83    2    95   59   400
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  252    0     3    0     3    0  1373
5     3     0    0   41    1  314    19    0     9  199     6
6     6     5    2    0   30    0  1176    0     2    1  1845
7     5    39   22  184    1    0   178  658    35   19    23
8     0     0   24   39   37   12    21    0  1048   61   128
9     4    26  202   61    7   35    82    4    61  583    72
10    0     1    0    0   12    0     0    0     0    0  1633
better model found
persisted
after epoch: 8,now: 2024-08-12 03:40:52.326363,epoch time: 0:31:14.270937,used: 4:12:23.459708,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9381421, 'precision': 0.8427988, 'recall': 0.8155111, 'specificity': 0.99315786, 'f1': 0.82750916, 'auroc': 0.9949241}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    0     7    1    1    11     5     2    1     49
1     0  1241    0    18    0    0     0    61     5    0      7
2     5     0  197     1   43    2     1    13     4   41      5
3     2     0    0  8126    0   22     1   166   114    4      1
4     6     0   40     1  298    2     3    10    22    3    153
5     6     0    1    55    0  366     0     1     7   83      1
6    43     0    0     8    3    1  1799     5     8    2     38
7     3    14    7   330    1    0     3  6806    63    6     31
8     9     0    9   196   27    5     2    92  2884    2     70
9    20     0   56    15    2   84     3     5     7  297      4
10   36     0    3    16   39    0    14    16    25    2  12644
---- Validation: 
scalar performance:
{'acc': 0.9365521, 'precision': 0.8465344, 'recall': 0.81481993, 'specificity': 0.99294364, 'f1': 0.8283763, 'auroc': 0.99480164}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    1     5    1    0     4     4     2    1     46
1     0  1237    0    19    0    0     2    65     3    0      6
2     6     1  195     1   27    1     2    13     6   49     11
3     2     1    0  8103    0   33     2   177   117    5      0
4     7     0   36     3  290    2     2     5    27    6    161
5     4     0    2    61    0  355     1     0     5   92      1
6    34     0    2    14    2    0  1803     2     7    2     42
7     2    12    4   336    2    0     2  6796    76    2     33
8     2     0    7   197   23    5     7    99  2865    3     88
9    16     0   53    19    0   76     1     2    12  308      6
10   42     1    5    16   37    1     6    13    32    1  12642
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47442803, 'precision': 0.5944239, 'recall': 0.43347198, 'specificity': 0.9459098, 'f1': 0.45439053, 'auroc': 0.82732517}
confusion matrix:
     0     1    2    3    4    5    6    7    8    9     10
0   471     0    3   25    0    0  504    0    3   25   139
1     1  1263    2   55    0    0   19   70    1    1    87
2     3     4   88   10  168    4   32    5   50   39   612
3     0     0    0    0    0    0    0    0    0    0     0
4     0     0    2    0  156    0    1    0    0    0  1474
5     5     0    0   75    2  250   19    0    8  201    32
6    20     1    1    0    9    0  878    1    1    1  2155
7     6    23   16  250    0    0  201  585   18   14    51
8     0     0   15   50   41    9   16    0  949   51   239
9    12    17  177   74   11   26   71    6   46  501   196
10    0     0    0    0    6    0    0    0    0    0  1640
better model found
persisted
after epoch: 9,now: 2024-08-12 04:12:21.981951,epoch time: 0:31:29.655588,used: 4:43:53.115296,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9420216, 'precision': 0.84502184, 'recall': 0.8354722, 'specificity': 0.99375135, 'f1': 0.8388225, 'auroc': 0.9954338}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    1     7    0    0    15     9     6    2     30
1     0  1255    0    15    0    0     0    55     4    0      3
2     6     0  234     0   16    2     2    11     6   33      2
3     0     1    0  8090    0   31     0   196   116    6      0
4     6     0   53     3  316    0     3     9    32    7    110
5     3     0    3    59    0  359     0     0     4   92      1
6    29     0    1    10    1    0  1827     5    14    3     18
7     2    11    4   215    2    0     1  6935    74    4     14
8     5     1    7   178   19    5     5    86  2946    7     34
9    15     0   58    15    0   80     2     3    10  307      3
10   45     1    5    14   83    2    20    23    73    0  12527
---- Validation: 
scalar performance:
{'acc': 0.9416878, 'precision': 0.84181386, 'recall': 0.83432883, 'specificity': 0.99372566, 'f1': 0.8364726, 'auroc': 0.9956128}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     8    0    0    14     6     4    4     37
1     0  1250    0    14    1    0     0    59     2    0      6
2     5     0  226     1   21    2     4     9     7   36      1
3     2     1    0  8061    0   29     0   223   122    2      0
4     7     0   64     1  304    1     5     6    37    9    105
5     6     0    2    46    0  370     0     0     4   92      1
6    33     0    0    10    1    0  1828     9     8    1     18
7     3    11    7   221    1    0     1  6937    69    1     14
8     3     3    6   180   21    7     5    83  2954    8     26
9    15     0   57    10    2   78     1     1     8  319      2
10   47     1    9    13   74    1    13    23    67    2  12546
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58301264, 'precision': 0.6347308, 'recall': 0.5012348, 'specificity': 0.9572371, 'f1': 0.52232754, 'auroc': 0.85382265}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   571     0    2   30    0    0   496    0     1   19    51
1     1  1290    2   56    0    0    13   75     4    1    57
2     4     5  142   15  208    8    51    4   167   47   364
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  291    0     7    0     7    0  1326
5     6     0    0   95    1  256    13    0     7  199    15
6    30     1    2    0   19    1  1897    1     8    1  1107
7     5    17    9  303    1    0   161  603    33   21    11
8     1     0    9   77   21    9    24    1  1104   44    80
9    12    17  159  108   11   32    71    6    75  545   101
10    0     0    0    0   12    0     0    0     0    0  1634
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-12 04:43:53.091739,epoch time: 0:31:31.109788,used: 5:15:24.225084,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:15:24.225084 at 2024-08-12 04:43:53.091739
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58301264, 'precision': 0.6347308, 'recall': 0.5012348, 'specificity': 0.9572371, 'f1': 0.52232754, 'auroc': 0.85382265}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   571     0    2   30    0    0   496    0     1   19    51
1     1  1290    2   56    0    0    13   75     4    1    57
2     4     5  142   15  208    8    51    4   167   47   364
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  291    0     7    0     7    0  1326
5     6     0    0   95    1  256    13    0     7  199    15
6    30     1    2    0   19    1  1897    1     8    1  1107
7     5    17    9  303    1    0   161  603    33   21    11
8     1     0    9   77   21    9    24    1  1104   44    80
9    12    17  159  108   11   32    71    6    75  545   101
10    0     0    0    0   12    0     0    0     0    0  1634
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58301264, 'precision': 0.6347308, 'recall': 0.5012348, 'specificity': 0.9572371, 'f1': 0.52232754, 'auroc': 0.85382265}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   571     0    2   30    0    0   496    0     1   19    51
1     1  1290    2   56    0    0    13   75     4    1    57
2     4     5  142   15  208    8    51    4   167   47   364
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  291    0     7    0     7    0  1326
5     6     0    0   95    1  256    13    0     7  199    15
6    30     1    2    0   19    1  1897    1     8    1  1107
7     5    17    9  303    1    0   161  603    33   21    11
8     1     0    9   77   21    9    24    1  1104   44    80
9    12    17  159  108   11   32    71    6    75  545   101
10    0     0    0    0   12    0     0    0     0    0  1634
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_23_28_28_seed_0_24142420_instance_wise_predictions.txt
accuracy from prediction file 0.5830126635415938
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/14.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494810 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool | 404096 KiB |  10877 MiB | 344198 GiB | 344197 GiB |
|       from small pool |  90714 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 494810 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool | 404096 KiB |  10877 MiB | 344198 GiB | 344197 GiB |
|       from small pool |  90714 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 342301 GiB | 342300 GiB |
|       from small pool |  90258 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11418 MiB |  11418 MiB |  11418 MiB |      0 B   |
|       from large pool |  11290 MiB |  11290 MiB |  11290 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 717605 KiB |   1129 MiB | 107909 GiB | 107908 GiB |
|       from large pool | 707968 KiB |   1126 MiB | 107201 GiB | 107201 GiB |
|       from small pool |   9637 KiB |     10 MiB |    707 GiB |    707 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   27226 K  |   27223 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2922    |    4522    |   15171 K  |   15168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   27226 K  |   27223 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2922    |    4522    |   15171 K  |   15168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     293    |     293    |     293    |       0    |
|       from large pool |     229    |     229    |     229    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |     980    |   14620 K  |   14620 K  |
|       from large pool |      16    |     119    |    7024 K  |    7024 K  |
|       from small pool |      33    |     963    |    7596 K  |    7596 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342301 GiB | 342301 GiB |
|       from small pool |      0 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |  11418 MiB |  11418 MiB |  10234 MiB |
|       from large pool |   1086 MiB |  11290 MiB |  11290 MiB |  10204 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1129 MiB | 107909 GiB | 107909 GiB |
|       from large pool |  59136 KiB |   1126 MiB | 107202 GiB | 107201 GiB |
|       from small pool |      0 KiB |     34 MiB |    707 GiB |    707 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     293    |     293    |     216    |
|       from large pool |      28    |     229    |     229    |     201    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     980    |   14621 K  |   14621 K  |
|       from large pool |       3    |     119    |    7024 K  |    7024 K  |
|       from small pool |       0    |     963    |    7597 K  |    7597 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342301 GiB | 342301 GiB |
|       from small pool |      0 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |  11418 MiB |  11418 MiB |  10234 MiB |
|       from large pool |   1086 MiB |  11290 MiB |  11290 MiB |  10204 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1129 MiB | 107909 GiB | 107909 GiB |
|       from large pool |  59136 KiB |   1126 MiB | 107202 GiB | 107201 GiB |
|       from small pool |      0 KiB |     34 MiB |    707 GiB |    707 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     293    |     293    |     216    |
|       from large pool |      28    |     229    |     229    |     201    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     980    |   14621 K  |   14621 K  |
|       from large pool |       3    |     119    |    7024 K  |    7024 K  |
|       from small pool |       0    |     963    |    7597 K  |    7597 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420

 Experiment start at: 2024-08-12 04:59:09.219644
before training, model accuracy: 0.06982439011335373
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.80252033, 'precision': 0.41757414, 'recall': 0.4154086, 'specificity': 0.9774277, 'f1': 0.41414964, 'auroc': 0.9395494}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    34   0   0  190    37   138   0     84
1    0  1058   0    15   0   0    0   197     4   0     57
2    0     0   0    24   0   0   56    50   162   0     20
3    0     0   0  7757   0   0    0   443   218   0     19
4    0     0   0    11   0   0   72    24   152   0    280
5    0     0   0   371   0   0   14     3   131   0      2
6    0     1   0    48   0   0  932    70   416   0    440
7    0    20   0   955   0   0    9  5979   157   0    145
8    0     0   0   736   0   0  104   226  1900   0    329
9    0     0   0   152   0   0   54    38   248   0      1
10   0     1   0    15   0   0  117    87   204   0  12369
---- Validation: 
scalar performance:
{'acc': 0.8017119, 'precision': 0.41545945, 'recall': 0.41594857, 'specificity': 0.9774065, 'f1': 0.4135303, 'auroc': 0.9399413}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    31   0   0  192    30   153   0     77
1    0  1075   0    16   0   0    0   183     2   0     56
2    0     0   0    22   0   0   67    43   160   0     20
3    0     0   0  7768   0   0    1   453   200   0     18
4    0     0   0     9   0   0   80    20   150   0    280
5    0     0   0   356   0   0    9     2   152   0      2
6    0     1   0    48   0   0  921    65   434   0    439
7    0    30   0   975   0   0   11  5920   176   0    153
8    0     0   0   708   0   0  124   240  1926   0    298
9    0     1   0   141   0   0   49    37   264   0      1
10   0     1   0    21   0   0  107    89   216   0  12362
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.38053593, 'precision': 0.24314241, 'recall': 0.29096457, 'specificity': 0.93477964, 'f1': 0.24177817, 'auroc': 0.74726003}
confusion matrix:
    0    1   2    3   4   5     6    7    8   9     10
0    0    0   0    3   0   0   897    5  262   0     3
1    0  938   0   18   0   0    38   86   91   0   328
2    0    1   0   15   0   0   492    5  378   0   124
3    0    0   0    0   0   0     0    0    0   0     0
4    0    0   0    0   0   0    85    0    6   0  1542
5    0    0   0  221   0   0    15    1  353   0     2
6    0    0   0    0   0   0  1484    0   82   0  1501
7    0  121   0    5   0   0    82  695  196   0    65
8    0    0   0   20   0   0   609    1  680   0    60
9    0   10   0   81   0   0   244    5  776   0    21
10   0    0   0    0   0   0     4    0    0   0  1642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 05:31:42.048565,epoch time: 0:32:32.828921,used: 0:32:32.828921,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.85463935, 'precision': 0.5483309, 'recall': 0.49257573, 'specificity': 0.98383003, 'f1': 0.48762804, 'auroc': 0.9728332}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    20   0   0   328    15    52   4     63
1    0  1138   0    19   0   0     0   145     4   0     26
2    0     0   0    15   0   3   113    54   101   3     23
3    0     0   0  7784   0   2     1   371   268   0     11
4    0     0   0     9   0   0   124    13   136   1    256
5    0     0   0   338   0  81    48     2    39  10      2
6    0     0   0    24   0   4  1550    30   113   0    186
7    0    29   0   546   0   0     8  6418   185   0     77
8    0     0   0   377   0   1    56   130  2601   0    131
9    0     0   0   134   0  39   150    24   128  17      1
10   0     4   0    13   0   0   188    51   185   0  12354
---- Validation: 
scalar performance:
{'acc': 0.8536579, 'precision': 0.66038305, 'recall': 0.49454653, 'specificity': 0.9837092, 'f1': 0.4915308, 'auroc': 0.97304815}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    31   0   2   324    19    47   3     57
1    0  1139   0    16   0   0     1   147     4   0     25
2    0     0   1    12   0   1   115    51   115   1     16
3    0     0   0  7786   0   0     2   364   284   0      4
4    0     0   0     6   0   0   111    14   134   0    274
5    0     0   0   329   0  88    52     1    44   7      0
6    0     2   0    27   0   4  1551    26   114   0    184
7    0    26   0   567   0   0     6  6384   187   0     95
8    0     1   0   364   0   0    53   150  2594   0    134
9    0     1   0   128   0  36   151    27   127  23      0
10   0     2   0    19   0   0   203    52   172   0  12348
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.45022038, 'precision': 0.3714627, 'recall': 0.32185793, 'specificity': 0.94082826, 'f1': 0.2841519, 'auroc': 0.7905277}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     0   0    4   0   2  1124    0   34   5     1
1    0  1161   0   21   0   0    73   34   52   0   158
2    0     2   0   26   0   3   746    1  130  10    97
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0   121    0    6   0  1506
5    0     0   0  316   0  67    89    0   71  48     1
6    0     0   0    0   0   0  2492    0   15   0   560
7    0   326   0    9   0   0   315  395   78   0    41
8    0     0   0   56   0   2   641    0  629   7    35
9    0    11   0  141   0  23   559    2  328  53    20
10   0     0   0    0   0   0     8    0    0   0  1638
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 06:02:57.404691,epoch time: 0:31:15.356126,used: 1:03:48.185047,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.88449806, 'precision': 0.7599271, 'recall': 0.60581744, 'specificity': 0.9873015, 'f1': 0.6189093, 'auroc': 0.98288935}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   88     0   0    21   0    4   217    19    41   42     51
1    0  1140   0    16   0    0     1   156     4    0     14
2   12     0   8     7   9    3    11    52    99   94     17
3    0     0   0  7691   0   24     1   450   268    5      0
4    4     0   2     2  20    1    41    21   176   18    254
5    3     0   0   156   0  264     4     2    15   76      1
6    1     1   0    12   1    9  1674    28    60    8    113
7    0    16   0   292   1    0     3  6767   148    0     36
8    0     0   0   250   0    4    10   155  2802    3     71
9    9     1   3    63   1   73    15    22    50  256      0
10   4     3   0    10   2    2   116    86   216    5  12349
---- Validation: 
scalar performance:
{'acc': 0.8831884, 'precision': 0.7729913, 'recall': 0.60381037, 'specificity': 0.98713887, 'f1': 0.6176822, 'auroc': 0.9825939}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   91     0   0    17   0    5   207    20    36   46     61
1    0  1145   0    15   0    0     1   156     5    0     10
2    8     0  12     4   4    1    17    58    97   94     17
3    0     0   0  7696   0   28     0   449   266    0      1
4    3     0   3     1  15    1    46    22   163   30    255
5    1     0   0   166   0  260     2     1    15   74      2
6    0     1   0    13   0    9  1639    31    73   14    128
7    0    14   0   301   0    1     1  6747   157    0     44
8    0     0   0   256   0    4    10   142  2819    3     62
9    9     0   4    60   0   70    14    27    56  251      2
10  11     4   2    12   0    2   117    84   219    2  12343
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5217239, 'precision': 0.47959393, 'recall': 0.43006143, 'specificity': 0.9498702, 'f1': 0.39108485, 'auroc': 0.8346758}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0    9     0   0    3   0   13  1022    0    35   85     3
1    0  1236   0   27   0    0    46   52    60    3    75
2    0     9   0   18   2   23   289    3   336  132   203
3    0     0   0    0   0    0     0    0     0    0     0
4    0     2   0    0   0    0    41    0    18    1  1571
5    0     0   0  134   0  309    14    0    26  108     1
6    0     1   0    0   0    0  2176    0    55    7   828
7    0   241   0   11   0    0   186  529   149   15    33
8    1     0   0   69   0   16   112    0  1023   76    73
9    0    18   0   81   0  103   116    2   265  531    21
10   0     1   0    0   0    0     1    0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 06:34:08.511339,epoch time: 0:31:11.106648,used: 1:34:59.291695,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.89996254, 'precision': 0.7855045, 'recall': 0.6943449, 'specificity': 0.9887707, 'f1': 0.72782713, 'auroc': 0.9872273}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   239     1    3    11    0    3    87    20    20   13     86
1     0  1192    1    19    0    0     0   104     6    0     10
2    13     0  115     3   43    3     3    25    22   73     12
3     0     0    0  7982    0   41     0   269   143    1      1
4    10     0   21     7  150    2     7    13    74   14    241
5     4     0    2   124    0  281     0     1    10   98      1
6    24     0    0    24    1    3  1691    19    30    9    106
7     0    38    3   529    0    0     3  6504   125    0     60
8     1     1    4   338    8    7    15   116  2683    6    116
9     9     1   38    42    1   87     5    17    25  266      2
10   22     4    3    11   32    1    39    50    95    4  12534
---- Validation: 
scalar performance:
{'acc': 0.9019125, 'precision': 0.7901798, 'recall': 0.6901653, 'specificity': 0.9889803, 'f1': 0.7240807, 'auroc': 0.98751867}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   236     0    1    14    1    3    86    17    19   24     82
1     0  1190    0    24    0    0     0   102     5    0     11
2     9     2  102     5   38    1     1    25    35   80     14
3     0     0    0  7978    0   37     0   278   142    3      2
4     7     1   20     5  137    1    13     9    79   16    251
5     3     0    2   121    0  275     0     0    12  107      1
6    26     0    2    19    1    6  1717    20    23    7     87
7     0    42    2   500    1    0     4  6538   113    1     64
8     0     1    2   339    3    3    12   127  2693    2    114
9    12     0   44    43    0   75     5    14    23  274      3
10   22     2    1     8   17    1    43    45    79    0  12578
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49695656, 'precision': 0.53097034, 'recall': 0.42878467, 'specificity': 0.94753224, 'f1': 0.413638, 'auroc': 0.8408739}
confusion matrix:
     0     1   2   3    4    5     6    7    8    9     10
0   269     0   0   3    0    4   794    0   26   51    23
1     0  1303   0  28    1    0    38   21   32    2    74
2    14    12  35  14  165   15   172    2  168   99   319
3     0     0   0   0    0    0     0    0    0    0     0
4     0     0   0   0   62    0     9    0    7    1  1554
5     3     0   0  74    0  336    20    0   26  130     3
6    12     1   0   0   19    0  1634    0   13    3  1385
7     2   419  15  34    0    0   247  294   95    6    52
8     2     0   4  42   31   13    60    0  993   60   165
9    26    19  67  60   20   69   116    0  189  532    39
10    0     1   0   0    0    0     0    0    0    0  1645
better model found
persisted
after epoch: 4,now: 2024-08-12 07:05:20.250105,epoch time: 0:31:11.738766,used: 2:06:11.030461,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.91515946, 'precision': 0.8060862, 'recall': 0.74501705, 'specificity': 0.9906399, 'f1': 0.76694167, 'auroc': 0.99033165}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   304     0    3     5    1    3    61    13    12   13     67
1     0  1229    0    15    0    0     1    74     5    0      8
2     9     1  142     2   19    2     1    22    18   83     13
3     0     0    1  7811    0   33     1   411   177    6      0
4    10     0   48     0  184    3     8     9    67   16    194
5     2     0    2    88    0  319     0     0     8  101      1
6    38     1    2     2    1    6  1740    15    24    5     73
7     1    41    1   245    0    0     2  6824   100    3     44
8     1     1    4   253    7    5    11   132  2792    8     80
9     7     1   35    20    1   91     7     8    12  309      2
10   34     4    8     6   31    2    32    43    82    2  12551
---- Validation: 
scalar performance:
{'acc': 0.9160626, 'precision': 0.8072246, 'recall': 0.74577683, 'specificity': 0.9907468, 'f1': 0.7673609, 'auroc': 0.9903585}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   306     0    1     5    0    0    57    14    19   17     64
1     0  1221    0    17    0    0     1    78     7    0      8
2     9     1  155     1   18    1     3    18    18   81      7
3     0     0    0  7816    0   47     2   406   166    3      0
4    14     0   43     1  169    3     6    14    68   17    204
5     4     0    2    85    0  327     0     1     7   94      1
6    38     0    1     6    1    3  1745    16    21    8     69
7     2    39    1   223    2    0     2  6851   101    4     40
8     3     1    4   231   10    7     8   132  2818    3     79
9     7     1   38    28    0   93     2    11    15  294      4
10   30     1    9     9   27    0    46    45    83    1  12545
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50829077, 'precision': 0.5781574, 'recall': 0.4420213, 'specificity': 0.94868237, 'f1': 0.42986265, 'auroc': 0.8483438}
confusion matrix:
     0     1   2   3    4    5     6    7     8    9     10
0   244     0   1   6    0    5   832    0    31   37    14
1     0  1328   0  33    0    0    30   22    26    1    59
2     3    15  63  14   89   14   155    1   183  103   375
3     0     0   0   0    0    0     0    0     0    0     0
4     0     1   1   0  112    0     5    0     5    0  1509
5     0     0   0  87    0  347    27    0    27  101     3
6    11     2   2   0   14    0  1601    0    10    9  1418
7     2   396  13  33    0    0   238  326    97   15    44
8     1     0   1  39   13   11    63    0  1054   39   149
9     9    26  76  63    2   81   122    1   168  548    41
10    0     1   0   0    3    0     0    0     0    0  1642
better model found
persisted
after epoch: 5,now: 2024-08-12 07:36:50.109659,epoch time: 0:31:29.859554,used: 2:37:40.890015,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92026967, 'precision': 0.8175957, 'recall': 0.76224345, 'specificity': 0.9911811, 'f1': 0.78601193, 'auroc': 0.99206084}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   334     0    0     4    0    1    46     8    13    5     72
1     0  1224    0     9    1    0     0    88     2    1      7
2    10     2  153     0   45    3     1    19    21   52      6
3     0     1    0  7660    0   27     2   492   250    4      1
4     3     1   30     1  241    1     3     9    46    6    198
5     4     0    3    77    0  324     1     1     6  104      1
6    29     0    1     5    1    0  1765    13    15    1     78
7     0    25    4   149    1    0     3  6920   114    0     48
8     1     2    6   135   16    3     9   131  2884    1    106
9    14     1   67    16    0   79     5    10    18  280      3
10   22     4    3     8   41    1    27    22    53    1  12611
---- Validation: 
scalar performance:
{'acc': 0.9222148, 'precision': 0.82175946, 'recall': 0.77156854, 'specificity': 0.9913937, 'f1': 0.7934506, 'auroc': 0.9926042}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   345     0    0     6    0    0    35    10     7    1     79
1     0  1223    0    14    0    0     1    86     3    0      5
2     6     0  170     1   47    0     4    19    11   46      8
3     1     0    0  7660    0   36     0   481   253    7      2
4    11     0   28     1  247    1     4    11    35    8    193
5     5     0    5    78    1  325     0     1     8   97      1
6    28     0    1     2    1    1  1756    18    21    1     79
7     1    40    2   146    2    0     2  6924   101    1     46
8     2     0    4   118   20    2     7   136  2913    1     93
9    17     1   67    14    1   79     4     8    14  284      4
10   17     2    5     6   39    2    25    24    45    1  12630
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5005947, 'precision': 0.58090216, 'recall': 0.41711515, 'specificity': 0.9474529, 'f1': 0.39679387, 'auroc': 0.83405274}
confusion matrix:
    0     1   2   3    4    5     6    7     8    9     10
0   59     0   1   5    0    2  1040    0    27   11    25
1    0  1342   0  28    0    0    29   24    27    0    49
2    0    15  31   9   87   12   182    2   174   31   472
3    0     0   0   0    0    0     0    0     0    0     0
4    0     1   0   0  128    0     7    0     5    0  1492
5    0     0   0  99    0  323    71    0    39   57     3
6    2     1   0   0    4    0  1867    0     4    3  1186
7    0   345   4  41    0    0   225  416    94    1    38
8    0     0   1  30   11    5    78    0  1072    6   167
9    0    34  90  55   11   70   248    1   269  275    84
10   0     1   0   0    3    0     0    0     0    0  1642
better model found
persisted
after epoch: 6,now: 2024-08-12 08:08:06.924721,epoch time: 0:31:16.815062,used: 3:08:57.705077,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9273866, 'precision': 0.83740485, 'recall': 0.77287424, 'specificity': 0.991958, 'f1': 0.79739016, 'auroc': 0.9932825}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     0    0     7    0    0    35    19    10    5     61
1     0  1236    0    15    0    0     0    70     7    0      4
2     4     0  192     2   23    1     2    21    16   45      6
3     0     0    0  7912    0   22     0   365   137    1      0
4     4     0   62     2  207    1     5    15    63    5    175
5     0     0    3    87    0  346     0     1    11   72      1
6    18     0    1    13    1    1  1768    21    21    3     60
7     0    21    0   189    2    0     1  6963    70    1     16
8     0     1    5   239    9    1     4   131  2847    2     56
9     4     1   79    31    0   91     5     9    12  257      3
10   26     2    5     8   26    2    17    49    72    0  12588
---- Validation: 
scalar performance:
{'acc': 0.92759126, 'precision': 0.8357154, 'recall': 0.7783712, 'specificity': 0.99200237, 'f1': 0.8007271, 'auroc': 0.9932164}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     1    1     7    0    0    31    19    13    6     59
1     0  1235    1    13    0    0     1    69     6    0      7
2     7     0  196     4   23    1     2    20    15   38      6
3     0     0    0  7911    0   23     1   361   142    2      0
4     4     0   58     0  226    2     2    17    55    8    167
5     3     0    4    82    0  356     1     0     6   68      1
6    23     0    1    15    3    2  1758    11    27    1     67
7     0    15    0   199    1    0     2  6953    79    0     16
8     0     0    6   224    6    2     6   133  2868    1     50
9     6     1   74    30    0   95     4    12    13  256      2
10   31     1    7     7   35    1    21    38    80    2  12573
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46841112, 'precision': 0.5851749, 'recall': 0.40448308, 'specificity': 0.9452646, 'f1': 0.3839449, 'auroc': 0.8405155}
confusion matrix:
    0     1    2    3    4    5     6    7     8    9     10
0   73     0    3   27    0    3   900    1    66   18    79
1    0  1330    0   50    0    0    16   29    17    0    57
2    1    16   45   38   44   14    59    3   346   31   418
3    0     0    0    0    0    0     0    0     0    0     0
4    0     0    0    1  104    0     3    0    11    0  1514
5    0     0    0  227    0  273    24    0    35   30     3
6    3     1    1    1    2    1  1299    0    39    1  1719
7    0   218    1  149    0    0   108  559   107    1    21
8    0     0    1  115    3    3    12    0  1177    0    59
9    0    34  101  203    1   94    85    5   362  194    58
10   0     1    0    0    4    0     0    0     0    0  1641
better model found
persisted
after epoch: 7,now: 2024-08-12 08:39:49.744521,epoch time: 0:31:42.819800,used: 3:40:40.524877,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9337008, 'precision': 0.84238714, 'recall': 0.7994744, 'specificity': 0.9927059, 'f1': 0.81846917, 'auroc': 0.99401796}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   369     0    0     5    1    0    23     5    12    1     67
1     0  1239    0    13    0    0     0    70     5    0      5
2     6     0  185     3   36    0     3    14    16   40      9
3     3     2    0  7857    0   33     0   347   192    2      3
4     6     0   34     1  268    1     4     9    46    9    161
5     4     0    1    56    0  352     1     0     8   98      1
6    31     0    0     5    3    1  1797    12    15    1     42
7     1    16    4   170    2    0     1  6954    76    2     36
8     4     1    6   126   20    2     3   127  2944    2     59
9     8     1   51    11    1   75     9    11    14  307      5
10   20     1    5     7   41    1    13    28    50    2  12626
---- Validation: 
scalar performance:
{'acc': 0.9335295, 'precision': 0.8442482, 'recall': 0.79959315, 'specificity': 0.9926702, 'f1': 0.8194579, 'auroc': 0.9942004}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   375     0    0     7    1    0    28     7     4    1     60
1     0  1235    0    14    0    0     0    73     4    0      6
2     7     0  183     1   39    1     1    23    13   37      7
3     1     0    0  7867    0   31     0   343   196    2      0
4     4     0   32     2  270    1     6     7    41    7    169
5     3     0    2    53    1  355     0     0    11   95      1
6    26     0    0     9    1    0  1807     8    15    2     40
7     3    14    1   172    1    0     1  6949    84    0     40
8     2     1    3   134   24    6     7   121  2926    0     72
9    10     0   60    16    2   72     8     8    11  302      4
10   22     0    3     7   36    2    19    22    53    1  12631
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49464774, 'precision': 0.5911783, 'recall': 0.42786825, 'specificity': 0.9473939, 'f1': 0.41150552, 'auroc': 0.8375158}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   79     0   0   10    0    2   957    0    40   17    65
1    0  1298   0   50    0    0    24   33    31    0    63
2    1     5  36   17   99   16    78    2   287   41   433
3    0     0   0    0    0    0     0    0     0    0     0
4    0     0   0    0  160    0     3    0    10    0  1460
5    0     0   0  106    0  351    42    0    34   52     7
6    3     0   0    1    5    1  1531    0    19    1  1506
7    0   125   2  151    0    0   219  503   114    4    46
8    0     0   1   40   11   10    37    0  1179    5    87
9    0    20  67  107    9   96   142    3   318  296    79
10   0     1   0    0    8    0     0    0     0    0  1637
better model found
persisted
after epoch: 8,now: 2024-08-12 09:11:28.654465,epoch time: 0:31:38.909944,used: 4:12:19.434821,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93394154, 'precision': 0.8245771, 'recall': 0.823188, 'specificity': 0.99289465, 'f1': 0.8225783, 'auroc': 0.994407}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     1    0     1    2    0    16     8     6    3     49
1     0  1268    0    12    1    0     0    45     2    0      3
2     5     1  210     2   25    1     2    10     8   47      1
3     4     2    0  7940    0   29     1   321   139    2      1
4     5     0   50     2  336    1     1     7    24    7    106
5     5     0    3    59    0  322     1     0     5  125      1
6    42     0    1     2    5    0  1792     7    14    3     42
7     2    70   10   162    4    0     3  6923    64    2     23
8     4     3   10   197   39    5     4   110  2870    4     49
9     4     1   66    16    2   53     4     4     6  337      0
10   30     2    8     5  140    2    16    26    49    2  12512
---- Validation: 
scalar performance:
{'acc': 0.9355624, 'precision': 0.8272967, 'recall': 0.82243145, 'specificity': 0.9930667, 'f1': 0.8235668, 'auroc': 0.9947972}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     1    0     6    3    0    14     8     3    4     47
1     0  1271    1    13    0    0     1    42     2    0      2
2     6     2  200     1   34    1     1    13     9   43      2
3     2     1    0  7973    1   28     2   311   119    3      0
4     3     0   37     1  350    1     4     8    27    8    100
5     1     0    1    68    1  316     1     0     6  126      1
6    57     0    1     4    0    0  1780    10    12    4     40
7     2    64    6   150    8    0     3  6945    63    3     21
8     4     2   10   192   38    4     7   115  2871    5     48
9     4     0   59    17    2   56     1     2     9  340      3
10   36     4   11     9  129    0    12    19    42    1  12533
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53501713, 'precision': 0.6006938, 'recall': 0.45373818, 'specificity': 0.9516416, 'f1': 0.44794747, 'auroc': 0.8525238}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   147     0    4    9    0    0   878    0    26   35    71
1     0  1401    0   34    0    0    11    6    15    0    32
2     1    20   92   15  218   10    81    1   229   66   282
3     0     0    0    0    0    0     0    0     0    0     0
4     0     2    0    0  424    0     3    0    11    0  1193
5     0     0    0   88    0  313    37    0    24  126     4
6     3     4    0    1   37    0  1745    0    30    4  1243
7     0   417    9  105    0    0   182  337    82    2    30
8     0     0    2   53   25   13    35    0  1154   14    74
9     0    52  172   94    4   50   120    2   169  424    50
10    0     1    0    0   35    0     0    0     0    0  1610
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 09:44:02.750893,epoch time: 0:32:34.096428,used: 4:44:53.531249,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9395602, 'precision': 0.84982276, 'recall': 0.81245697, 'specificity': 0.99340165, 'f1': 0.82544863, 'auroc': 0.995417}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     6    0    0    18     4     5    3     36
1     0  1243    0    15    0    0     0    63     6    0      5
2     3     0  196     0   32    0     3    13     9   51      5
3     1     0    0  7974    0   15     0   306   141    2      0
4     8     0   36     0  254    2     6     5    42    8    178
5     3     0    1    61    0  310     0     0     6  138      1
6    53     0    0    10    0    1  1793     5     9    3     33
7     1    11    4   145    1    0     2  6990    88    3     18
8     4     0    3   140    8    2     8    88  3000    4     39
9    10     0   46    12    1   46     2     6    12  352      5
10   56     2    3     9   34    2    14    27    51    1  12595
---- Validation: 
scalar performance:
{'acc': 0.93805003, 'precision': 0.8526905, 'recall': 0.8126732, 'specificity': 0.99321955, 'f1': 0.82629275, 'auroc': 0.99529254}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     5    0    0    20     7     5    1     33
1     0  1239    0    12    0    0     0    70     6    0      5
2     5     0  198     2   22    1     2    10    10   56      6
3     2     0    0  7963    0   21     0   292   159    3      0
4     6     0   38     0  255    2     4     5    46    5    178
5     5     0    3    64    0  306     0     0     7  135      1
6    55     0    1     3    0    1  1779     8     8    2     51
7     1    14    2   160    2    0     0  6968    91    5     22
8     4     0    5   145   11    2    10    99  2974    5     41
9    12     0   35    17    0   47     5     6     6  364      1
10   47     1    1     7   27    2    15    28    54    3  12611
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5271112, 'precision': 0.60198575, 'recall': 0.45478117, 'specificity': 0.9512278, 'f1': 0.45103294, 'auroc': 0.8439245}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   266     0   1   14    1    0   702    1    41   30   114
1     0  1307   1   45    0    0    17   37    39    0    53
2     1     4  59   15  108   12    35    2   323   58   398
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  119    0     4    0    11    0  1499
5     0     0   0  111    0  288    27    0    30  131     5
6     2     0   0    1    7    1  1637    0    40    2  1377
7     0    81   6  194    0    0   144  571   140    5    23
8     0     0   1   41    7    5     9    0  1224    7    76
9     2    13  99  101    4   52    74    4   281  422    85
10    0     1   0    0    4    0     0    0     0    0  1641
better model found
persisted
after epoch: 10,now: 2024-08-12 10:16:02.820809,epoch time: 0:32:00.069916,used: 5:16:53.601165,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:16:53.601165 at 2024-08-12 10:16:02.820809
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5271112, 'precision': 0.60198575, 'recall': 0.45478117, 'specificity': 0.9512278, 'f1': 0.45103294, 'auroc': 0.8439245}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   266     0   1   14    1    0   702    1    41   30   114
1     0  1307   1   45    0    0    17   37    39    0    53
2     1     4  59   15  108   12    35    2   323   58   398
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  119    0     4    0    11    0  1499
5     0     0   0  111    0  288    27    0    30  131     5
6     2     0   0    1    7    1  1637    0    40    2  1377
7     0    81   6  194    0    0   144  571   140    5    23
8     0     0   1   41    7    5     9    0  1224    7    76
9     2    13  99  101    4   52    74    4   281  422    85
10    0     1   0    0    4    0     0    0     0    0  1641
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53501713, 'precision': 0.6006938, 'recall': 0.45373818, 'specificity': 0.9516416, 'f1': 0.44794747, 'auroc': 0.8525238}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   147     0    4    9    0    0   878    0    26   35    71
1     0  1401    0   34    0    0    11    6    15    0    32
2     1    20   92   15  218   10    81    1   229   66   282
3     0     0    0    0    0    0     0    0     0    0     0
4     0     2    0    0  424    0     3    0    11    0  1193
5     0     0    0   88    0  313    37    0    24  126     4
6     3     4    0    1   37    0  1745    0    30    4  1243
7     0   417    9  105    0    0   182  337    82    2    30
8     0     0    2   53   25   13    35    0  1154   14    74
9     0    52  172   94    4   50   120    2   169  424    50
10    0     1    0    0   35    0     0    0     0    0  1610
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_12_04_59_09_seed_1_24142420_instance_wise_predictions.txt
accuracy from prediction file 0.5271111733016162
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/14.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/14.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496602 KiB |  10950 MiB | 689803 GiB | 689802 GiB |
|       from large pool | 405888 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 496602 KiB |  10950 MiB | 689803 GiB | 689802 GiB |
|       from large pool | 405888 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10882 MiB | 685930 GiB | 685930 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 684602 GiB | 684602 GiB |
|       from small pool |  90258 KiB |    126 MiB |   1328 GiB |   1328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11544 MiB |  11544 MiB |  21778 MiB |  10234 MiB |
|       from large pool |  11416 MiB |  11416 MiB |  21620 MiB |  10204 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1283 MiB |   1530 MiB | 226545 GiB | 226544 GiB |
|       from large pool |   1275 MiB |   1527 MiB | 225131 GiB | 225130 GiB |
|       from small pool |      7 MiB |     34 MiB |   1413 GiB |   1413 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   54451 K  |   54448 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    2922    |    4522    |   30342 K  |   30339 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   54451 K  |   54448 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    2922    |    4522    |   30342 K  |   30339 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     300    |     300    |     516    |     216    |
|       from large pool |     236    |     236    |     437    |     201    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |    1078    |   29578 K  |   29578 K  |
|       from large pool |      31    |     135    |   14493 K  |   14493 K  |
|       from small pool |      31    |    1046    |   15084 K  |   15084 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10950 MiB | 689803 GiB | 689803 GiB |
|       from large pool |  16640 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |      0 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10950 MiB | 689803 GiB | 689803 GiB |
|       from large pool |  16640 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |      0 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 685930 GiB | 685930 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 684602 GiB | 684602 GiB |
|       from small pool |      0 KiB |    126 MiB |   1328 GiB |   1328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1768 MiB |  11544 MiB |  21778 MiB |  20010 MiB |
|       from large pool |   1672 MiB |  11416 MiB |  21620 MiB |  19948 MiB |
|       from small pool |     96 MiB |    128 MiB |    158 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1530 MiB | 226545 GiB | 226545 GiB |
|       from large pool |  59136 KiB |   1527 MiB | 225132 GiB | 225131 GiB |
|       from small pool |      0 KiB |     34 MiB |   1413 GiB |   1413 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   54451 K  |   54451 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    4522    |   30342 K  |   30342 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   54451 K  |   54451 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    4522    |   30342 K  |   30342 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     300    |     516    |     433    |
|       from large pool |      35    |     236    |     437    |     402    |
|       from small pool |      48    |      64    |      79    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1078    |   29579 K  |   29579 K  |
|       from large pool |       3    |     135    |   14493 K  |   14493 K  |
|       from small pool |       0    |    1046    |   15085 K  |   15085 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 10:22:38 2024]
Finished job 0.
1 of 1 steps (100%) done
