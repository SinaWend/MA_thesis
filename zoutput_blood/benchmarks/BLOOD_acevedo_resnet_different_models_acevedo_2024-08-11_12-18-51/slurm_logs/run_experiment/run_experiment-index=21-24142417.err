Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 21:13:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/21.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=21
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417

 Experiment start at: 2024-08-11 21:23:03.137486
before training, model accuracy: 0.07954943180084229
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7183487, 'precision': 0.4164743, 'recall': 0.28393024, 'specificity': 0.9661633, 'f1': 0.27781197, 'auroc': 0.8919883}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   0   0   148   0   0   21    81   63  36    134
1    0  53   0    30   0   0    0  1153    2   0     94
2    0   1   0    87   1   0   13    88   44  18     60
3    0   0   0  7734   1   0    0   623   32   0     46
4    0   0   0    58   0   1   13    56   31   9    371
5    0   0   0   467   0   0    1     7   15  25      6
6    0   1   0   325   2   0  219   159  183  53    965
7    0   0   0  1190   0   0    0  5864   30   0    180
8    0   0   0  1329   0   0    8   582  476  11    888
9    0   1   0   321   0   0    7    57   33  63     11
10   0   0   0    89   0   0   17   159   82   8  12440
---- Validation: 
scalar performance:
{'acc': 0.718042, 'precision': 0.4134755, 'recall': 0.28042778, 'specificity': 0.966111, 'f1': 0.2715294, 'auroc': 0.8915841}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   1   0   148   0   0   16    93   60  41    124
1    0  36   0    30   0   0    0  1166    1   0     99
2    0   0   0    89   0   0   13    85   38  22     65
3    0   0   0  7764   0   0    1   597   34   2     42
4    0   0   0    46   0   0   16    46   37  11    383
5    0   0   0   468   0   0    1    11    8  28      5
6    0   1   0   323   2   0  177   166  196  60    983
7    0   0   0  1184   1   1    0  5860   30   0    189
8    0   0   0  1372   2   1    7   545  483   9    877
9    0   0   0   327   2   1    6    62   26  58     11
10   0   0   0   102   0   0    7   141   75   5  12466
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.23403065, 'precision': 0.19802248, 'recall': 0.21475568, 'specificity': 0.9221297, 'f1': 0.13562885, 'auroc': 0.6536218}
confusion matrix:
    0   1   2    3   4   5    6    7    8    9     10
0    0   1   0  103   1   0  264   38  104  595    64
1    0  35   0   13   2   0   54  888    6   13   488
2    0   0   0   91   1   0  115   97   65  124   522
3    0   0   0    0   0   0    0    0    0    0     0
4    0   0   0    2   0   0   18    3    0    1  1609
5    0   0   0  231   0   0    8    8   63  257    25
6    0   0   0   16   1   0  120   74   35   15  2806
7    0   5   0   24   6   2   47  984   35   27    34
8    0   0   0  137   0   1  121   49  258  302   502
9    0   1   0  243   3   2  108  145  111  304   220
10   0   0   0    0   0   0    0    1    0    1  1644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 21:57:16.763388,epoch time: 0:34:13.625902,used: 0:34:13.625902,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.82577056, 'precision': 0.5223073, 'recall': 0.46260744, 'specificity': 0.9805053, 'f1': 0.45992202, 'auroc': 0.94616926}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     1   0    57   0   0   238    38    90  14     45
1    0  1131   0    16   0   0     0   174     1   0     10
2    0     2   0    28   0   0   105    58   105   9      5
3    0     0   0  7796   0   0     1   479   157   0      4
4    0     1   0    21   0   0   120    26   146   6    219
5    0     0   0   382   0   3    13     0    45  76      2
6    0    11   0    92   0   0  1315    67   204   7    211
7    0    54   0   644   0   0     5  6406   111   0     42
8    0     2   0   663   0   0    81   307  2014   0    229
9    0     0   0   192   0   2    80    29   101  89      0
10   0    12   0    25   0   0   261   127   258   1  12110
---- Validation: 
scalar performance:
{'acc': 0.82640094, 'precision': 0.5330721, 'recall': 0.46384305, 'specificity': 0.9805866, 'f1': 0.46241993, 'auroc': 0.9469247}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    49   0   1   234    41    95  19     44
1    0  1129   0    17   0   0     0   171     4   0     11
2    0     0   0    33   0   0   101    57   100  13      8
3    0     0   0  7812   0   0     1   483   139   1      4
4    0     1   0    15   0   0   123    37   148   5    210
5    0     0   0   390   0   7    17     0    37  69      1
6    0    13   0    93   1   0  1299    53   238   5    206
7    0    47   0   640   0   0     8  6415   101   0     54
8    0     1   0   663   0   0    79   303  2034   1    215
9    0     1   0   192   0   2    85    27    91  93      2
10   0     9   0    25   0   0   259   118   279   0  12106
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42727208, 'precision': 0.29087812, 'recall': 0.29159427, 'specificity': 0.937195, 'f1': 0.24814591, 'auroc': 0.7395433}
confusion matrix:
    0     1   2    3   4   5     6    7    8    9     10
0    0     1   0    3   0   0  1142    2   14    7     1
1    0  1190   0    9   0   0   145   47    7    5    96
2    0     3   0   21   0   0   882    5   43   14    47
3    0     0   0    0   0   0     0    0    0    0     0
4    0     1   0    0   0   0   224    0    1    0  1407
5    0     0   0  173   0   0   181    1   68  166     3
6    0     4   0    2   0   0  2549    0   11    0   501
7    0   430   0    3   0   0   401  312    9    0     9
8    0     0   0   22   0   0   876    0  368   32    72
9    0    10   0   59   0   0   904   10   74   75     5
10   0     1   0    0   0   0    32    0    0    0  1613
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 22:30:11.312932,epoch time: 0:32:54.549544,used: 1:07:08.175446,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.85784996, 'precision': 0.66388744, 'recall': 0.5274473, 'specificity': 0.9842341, 'f1': 0.53339374, 'auroc': 0.96532345}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    5     0   0    24   0   15   217    32    92   40     58
1    0  1121   0    14   0    0     0   174     4    0     18
2    0     1   0    18   6    4    60    60   110   42     11
3    0     0   0  7531   0   13     1   625   262    2      4
4    0     0   0     5   4    1    80    23   173    8    245
5    0     0   0   243   0  173     4     1    26   73      1
6    0     6   0    33   0    6  1497    46   110   25    185
7    0    27   0   306   0    0     5  6741   129    0     55
8    0     0   0   293   0    3    21   270  2545    0    163
9    0     1   0    94   2   89    46    27    99  133      2
10   0     4   0    12   1    0   135    71   255    2  12313
---- Validation: 
scalar performance:
{'acc': 0.8587134, 'precision': 0.6049067, 'recall': 0.529485, 'specificity': 0.98428416, 'f1': 0.53520596, 'auroc': 0.96598625}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    0     1   0    30   0   10   203    37   101   40     61
1    0  1131   0    16   0    0     1   166     5    0     13
2    0     0   0     8   2    3    65    62   120   43      9
3    0     0   0  7516   0    9     1   666   243    1      4
4    0     0   0     3   3    2    84    22   164   11    250
5    0     0   0   244   0  171     7     2    30   65      2
6    0     3   0    28   0    2  1488    43   109   31    204
7    0    21   0   287   0    0     1  6768   134    0     54
8    0     0   0   310   0    3    19   244  2551    3    166
9    0     2   0    99   0   90    45    26    80  149      2
10   0     2   0    13   0    0   130    86   237    2  12326
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4505702, 'precision': 0.48138157, 'recall': 0.34486225, 'specificity': 0.94103926, 'f1': 0.313573, 'auroc': 0.76240796}
confusion matrix:
    0     1   2    3   4   5     6    7    8    9     10
0    0     0   0    3   0   1  1115    6   21   22     2
1    0  1175   0   13   0   0   106   79   16    3   107
2    0     6   0   25   0   0   564    9  181   27   203
3    0     0   0    0   0   0     0    0    0    0     0
4    0     2   0    0   1   0    63    0    1    0  1566
5    0     0   0  142   0  74    80    0   38  254     4
6    0     3   0    1   0   0  1971    0   13    0  1079
7    0   279   0    1   0   0   407  449   17    0    11
8    0     0   0   14   0   4   318    0  896   53    85
9    1    13   0   79   0   2   608   11  176  232    15
10   0     1   0    0   0   0     3    0    0    0  1642
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 23:03:04.442901,epoch time: 0:32:53.129969,used: 1:40:01.305415,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87700665, 'precision': 0.7271726, 'recall': 0.5855305, 'specificity': 0.9865634, 'f1': 0.5987121, 'auroc': 0.9742298}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   48     0   0    25   1    7   255    28    46   17     55
1    0  1116   0    16   1    0     1   180     7    0     11
2    0     0   2     6  35    6    63    47    88   57      7
3    0     0   0  7627   0   36     4   518   250    2      1
4    1     0   0     5  61    2    83    22   141   14    210
5    2     0   0   148   0  272     8     1    23   66      1
6    0     1   0    22   0    0  1698    37    45   12     93
7    0    13   0   309   1    0    10  6754   142    1     34
8    0     1   0   243   5    6    24   185  2727    3    101
9    5     0   3    63   8  102    54    19    66  172      1
10   4     4   0    15   4    0   164    85   212    3  12302
---- Validation: 
scalar performance:
{'acc': 0.876956, 'precision': 0.77119493, 'recall': 0.5901905, 'specificity': 0.98656, 'f1': 0.6041904, 'auroc': 0.9750087}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   52     0   0    26   0    8   257    30    43   17     50
1    0  1126   0    16   0    0     0   166    11    1     12
2    3     0   5     6  33    4    59    42    88   63      9
3    0     0   0  7617   0   36     1   509   270    3      4
4    0     0   0     6  58    0    90    20   144    9    212
5    2     0   0   156   0  270    11     1    28   52      1
6    0     0   0    20   0    0  1709    26    40   16     97
7    0    16   0   317   1    0     8  6729   154    0     40
8    0     0   0   244   4    6    21   181  2747    3     90
9    2     2   1    66   8   97    43    19    66  187      2
10   4     5   0    16   9    0   199    83   195    0  12285
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4682712, 'precision': 0.47337827, 'recall': 0.34663868, 'specificity': 0.9423733, 'f1': 0.32149953, 'auroc': 0.7699167}
confusion matrix:
    0     1   2    3   4   5     6    7    8    9     10
0    6     0   0    8   0   0  1146    0    5    3     2
1    1  1121   0   23   0   0   167   81   18    1    87
2    1     4   0   29  12   0   564    8  229   13   155
3    0     0   0    0   0   0     0    0    0    0     0
4    0     1   0    0  21   0    76    0   11    0  1524
5    1     0   0  150   0  96   153    0   11  179     2
6    0     0   0    2   0   0  2383    0   21    0   661
7    0    87   0   12   3   0   697  338   21    1     5
8    7     0   0   31   2   8   340    0  910   36    36
9   12     7   0  104   1   6   669    8  133  180    17
10   0     1   0    0   0   0     7    0    0    0  1638
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 23:35:59.192826,epoch time: 0:32:54.749925,used: 2:12:56.055340,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8937821, 'precision': 0.7700083, 'recall': 0.645175, 'specificity': 0.9882402, 'f1': 0.6716799, 'auroc': 0.9797801}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   155     0   1    28    2    4   130    19    38   30     76
1     0  1162   0    18    1    0     0   132     7    0     12
2     3     1  18    10   80    2     5    35    65   89      4
3     0     0   0  7798    0   35     1   424   173    2      3
4     0     1   3     3  130    1    19    14   129   27    212
5     0     0   0   118    0  325     2     0    13   62      1
6    15     2   0    22    0    4  1633    28    34   13    157
7     0    30   0   293    1    0     2  6765   128    0     45
8     0     0   0   277    4    7     3   144  2772    9     80
9     0     2  10    65   10  114     5    14    44  225      3
10    4     2   0    14   16    0    78    42   211    3  12423
---- Validation: 
scalar performance:
{'acc': 0.89150727, 'precision': 0.7665825, 'recall': 0.63981164, 'specificity': 0.9879639, 'f1': 0.66530204, 'auroc': 0.97939366}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   139     0   1    28    1    6   122    21    37   46     82
1     0  1155   0    18    0    0     0   138     7    0     14
2     3     2  12     9   65    2     5    41    58  110      5
3     0     0   0  7802    0   36     0   421   175    3      3
4     1     0   2     3  145    1     9    13   120   22    223
5     1     0   0   137    0  306     1     0    12   63      1
6    10     1   0    27    3    1  1642    25    39   15    145
7     0    37   0   305    2    0     5  6712   151    2     51
8     0     0   0   290    8    2     9   149  2736    8     94
9     2     0   6    62   11  101    11    21    42  235      2
10   10     2   1    11   18    1    68    35   201    4  12445
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4442734, 'precision': 0.49374205, 'recall': 0.36311138, 'specificity': 0.94158614, 'f1': 0.34101307, 'auroc': 0.78829956}
confusion matrix:
    0     1   2    3   4    5     6    7     8    9     10
0   60     0   0   21   0    0  1023    5    31   17    13
1    0  1216   0   35   6    0    64   67    19    1    91
2    5     6   1   45  84    0   173    9   364   51   277
3    0     0   0    0   0    0     0    0     0    0     0
4    0     2   0    0  52    0    14    0     9    0  1556
5    6     0   0  213   0  118    69    0    13  172     1
6    1     2   0    1  26    0  1431    0    37    4  1565
7    3   166   4   32  13    0   544  333    46    2    21
8    3     0   0   52   5    6   104    0  1111   39    50
9   14    12   4  165  31    7   248    9   223  382    42
10   0     0   0    0   0    0     0    0     0    0  1646
better model found
persisted
after epoch: 5,now: 2024-08-12 00:08:48.733049,epoch time: 0:32:49.540223,used: 2:45:45.595563,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90381527, 'precision': 0.792924, 'recall': 0.7048787, 'specificity': 0.98949975, 'f1': 0.73704344, 'auroc': 0.9843523}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   246     0   2    17    2    1    80    24    40    7     64
1     0  1178   0    13    0    0     0   120    11    0     10
2     6     1  85     7   62    3     3    31    44   68      2
3     0     1   0  7714    0   21     1   524   174    3      0
4     4     1  19     4  222    0     9    16   100   14    150
5     6     0   0   118    0  286     0     0    12   98      1
6    22     0   0    20    7    1  1721    28    33    4     72
7     1    34   1   187    2    0     5  6881   117    0     36
8     1     0   1   235   10    3     2   157  2834    3     48
9    11     2  30    48    7   70     5    12    42  265      1
10   18     5   0    11   66    0    65    64   212    2  12349
---- Validation: 
scalar performance:
{'acc': 0.902073, 'precision': 0.7864849, 'recall': 0.7028308, 'specificity': 0.9893216, 'f1': 0.73407495, 'auroc': 0.98430336}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   243     0   2    20    7    0    65    24    48   11     63
1     0  1176   4    15    3    0     0   116    10    0      8
2     7     0  87     6   67    0     6    30    41   66      2
3     0     0   0  7696    0   25     0   543   169    5      2
4     2     1  20     6  222    0    13    13    92   15    155
5     8     0   2   123    0  290     2     1    14   81      0
6    28     1   0    10    8    0  1733    29    34    9     56
7     0    38   1   188    3    0     3  6885   119    1     27
8     0     0   0   238   18    2     4   172  2796    5     61
9    19     1  28    57    5   67     5    18    37  255      1
10   17     4   0    12   63    0    76    66   214    3  12341
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5409641, 'precision': 0.54151314, 'recall': 0.41044945, 'specificity': 0.95152146, 'f1': 0.39650726, 'auroc': 0.81917924}
confusion matrix:
     0     1   2    3    4   5     6    7     8    9     10
0   240     0   0   12    0   0   895    3    12    1     7
1     0  1282   1   29    3   0    44   55    25    0    60
2    29     7  24   35  226   0   223   11   305   37   118
3     0     0   0    0    0   0     0    0     0    0     0
4     0     2   0    0  243   0    36    0    15    0  1337
5    22     0   0  223    0  78    97    0    12  160     0
6     3     3   2    2   58   0  2511    0    36    2   450
7     3   235  26   36    4   0   521  289    41    2     7
8    22     0   3   44   10   3   115    0  1128   25    20
9   108    21  40  137   34   4   294    7   176  306    10
10    0     1   0    0   12   0     2    0     0    0  1631
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 00:41:35.840417,epoch time: 0:32:47.107368,used: 3:18:32.702931,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.91023654, 'precision': 0.79810834, 'recall': 0.72630054, 'specificity': 0.990001, 'f1': 0.7561841, 'auroc': 0.98538893}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   278     0    2    20    1    0    43    22    20   16     81
1     0  1173    1    17    1    0     1   125     7    0      7
2     2     2  125     4   50    1     4    30    10   76      8
3     2     1    0  7882    1   40     0   407    98    5      1
4     1     0   31     6  213    0     9    20    59   21    179
5     6     0    2   110    0  304     0     0     7   91      1
6    43     0    1    17    3    1  1716    18    11    7     91
7     0    17    0   246    3    0     0  6893    67    1     36
8     2     0    2   304   19    5    12   175  2658   14    104
9     4     0   51    43    1   73     4    10    15  290      2
10   24     3    2    11   54    1    27    58   122    2  12489
---- Validation: 
scalar performance:
{'acc': 0.9106861, 'precision': 0.8000641, 'recall': 0.72641814, 'specificity': 0.99008334, 'f1': 0.75682133, 'auroc': 0.9852205}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   274     0    3    16    0    2    50    26    19   15     78
1     0  1157    0    20    1    0     0   138     7    0      9
2     5     1  121     3   47    0     2    35    17   73      8
3     2     0    0  7889    1   34     0   409   102    2      1
4     4     0   34     7  216    2     5    22    60   17    172
5     2     0    1    88    0  321     0     2     7   99      1
6    47     0    2    14    1    0  1701    24    22   11     86
7     0    24    2   229    1    0     3  6908    68    2     28
8     3     1    5   291   23    3     5   195  2669   10     91
9     5     0   41    44    0   73     6    13    18  289      4
10   21     2    1    10   49    0    27    57   124    4  12501
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51514727, 'precision': 0.5635561, 'recall': 0.4077678, 'specificity': 0.949203, 'f1': 0.40709442, 'auroc': 0.81216687}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   359     0   0   22    1    0   762    0    10    2    14
1     0  1257   2   54    2    0    61   41    10    0    72
2    16     5  36   47  188    1   171    5   233   48   265
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   0    0  189    0    16    0     6    0  1421
5    24     0   0  200    0  121    58    0     7  181     1
6     4     2   1    2   27    0  2082    0    14    2   933
7     5    98  20  164    6    0   616  214    25    4    12
8    13     0   4   70   11    7    87    0  1092   36    50
9    73    15  67  176   27    8   243    5   110  374    39
10    0     1   0    0    6    0     0    0     0    0  1639
better model found
persisted
after epoch: 7,now: 2024-08-12 01:14:22.177676,epoch time: 0:32:46.337259,used: 3:51:19.040190,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9171661, 'precision': 0.8076404, 'recall': 0.7556555, 'specificity': 0.99086297, 'f1': 0.7775829, 'auroc': 0.9874202}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   323     0    2    11    3    1    22    18    16   10     77
1     0  1195    0    18    1    0     0   101     9    1      7
2     6     3  135     3   49    0     2    23    19   71      1
3     1     0    0  7859    0   32     3   370   171    1      2
4     6     0   33     3  263    0     2    16    54   13    149
5     1     0    1    75    0  306     1     0    12  124      1
6    74     0    1    16    2    0  1691    12    12    6     93
7     0    31    4   240    4    0     4  6847    92    0     41
8     1     0    1   192   23    3    11   138  2811   11    105
9    14     0   40    26    2   55     3     8    22  318      5
10   30     2    3     8   62    1    19    42    90    2  12532
---- Validation: 
scalar performance:
{'acc': 0.9189782, 'precision': 0.80944246, 'recall': 0.7573115, 'specificity': 0.99103934, 'f1': 0.77943647, 'auroc': 0.9883539}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   318     0    0    12    0    0    27    16    17    8     85
1     0  1193    0    15    0    0     0   102     9    1     12
2     8     0  139     1   52    0     1    18    22   69      2
3     1     1    0  7892    0   36     1   347   155    5      2
4     4     0   39     1  252    0     6    10    53   14    160
5     6     0    2    64    0  315     0     0    12  121      1
6    61     1    1    15    2    0  1709    13    11    6     89
7     1    22    1   238    2    0     2  6853    90    3     53
8     6     1    2   189   23    2     7   140  2827    7     92
9    10     2   42    29    2   60     3     9    13  319      4
10   34     1    2     8   55    0    15    50    89    3  12539
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52760094, 'precision': 0.56486034, 'recall': 0.4093483, 'specificity': 0.9504749, 'f1': 0.39494917, 'auroc': 0.81362706}
confusion matrix:
     0     1   2    3    4   5     6    7     8    9     10
0   443     0   0   15    1   0   683    0    15    0    13
1     0  1291   1   40    2   0    54   21    17    0    73
2    27     5  47   29  207   0   146    3   217   48   286
3     0     0   0    0    0   0     0    0     0    0     0
4     0     0   0    0  192   0    19    0     5    0  1417
5    38     0   0  158    0  63    75    0    13  243     2
6     7     1   0    1   22   0  2224    0     7    2   803
7     6   185  23  146    5   0   583  147    50    2    17
8    14     0   2   30   10   1    91    0  1136   25    61
9   131    13  74   99   42   1   218    2   152  361    44
10    0     0   0    0    9   0     0    0     0    0  1637
better model found
persisted
after epoch: 8,now: 2024-08-12 01:47:09.284815,epoch time: 0:32:47.107139,used: 4:24:06.147329,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92511237, 'precision': 0.81299996, 'recall': 0.7830172, 'specificity': 0.99181634, 'f1': 0.7964994, 'auroc': 0.99042785}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   334     0    2    13    1    1    33    14     9   10     66
1     0  1214    1    16    1    0     0    81     6    0     13
2     6     1  193     1   45    0     1    10     6   49      0
3     0     0    0  7944    0   41     2   289   155    6      2
4     4     0   39     1  272    1     6    10    43   13    150
5     4     0    2    58    0  325     1     0    10  120      1
6    33     0    2    12    4    1  1789    16    10    3     38
7     0    31    8   232    5    0     2  6861    83    2     38
8     1     1    9   176   36    3     8   130  2829   16     87
9     4     0   67    27    1   68     6     9    12  297      2
10   22     1    6    15   87    0    28    37    73    3  12519
---- Validation: 
scalar performance:
{'acc': 0.9249967, 'precision': 0.81560004, 'recall': 0.78412443, 'specificity': 0.9918021, 'f1': 0.7984636, 'auroc': 0.99032056}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   331     0    2    11    3    0    33    19    11    9     64
1     0  1209    3    22    1    0     0    88     2    0      7
2     5     0  176     5   48    1     1    14     8   53      1
3     1     0    1  7943    0   34     0   295   157    9      0
4     1     0   35     3  293    1    10    11    37   15    133
5     3     0    4    63    1  331     0     0     9  109      1
6    34     0    1    13    1    1  1781    13     8    6     50
7     1    22    7   240    6    0     6  6849    86    1     47
8     1     1   10   177   36    4     9   140  2829   11     78
9     1     2   65    20    1   73     1     5    10  313      2
10   26     3    4     7   80    1    27    37    80    5  12526
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5453019, 'precision': 0.57711697, 'recall': 0.42731822, 'specificity': 0.9528078, 'f1': 0.42333183, 'auroc': 0.8265031}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   418     0    4   27    2    0   675    1    18    2    23
1     0  1334    2   43    1    0    23   22    12    0    62
2    10     5   77   34  277    0   113    3   182   59   255
3     0     0    0    0    0    0     0    0     0    0     0
4     0     2    0    0  218    0    17    0     7    0  1389
5    16     0    0  178    0  103    43    0     7  242     3
6     2     2    1    1   23    0  2313    0     9    2   714
7     0   244   56  251    7    0   393  159    37    4    13
8     2     0    5   46   28    3    63    0  1111   41    71
9    42    26  151  132   43    6   160    5   102  427    43
10    0     0    0    0   12    0     0    0     0    0  1634
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-12 02:19:55.884777,epoch time: 0:32:46.599962,used: 4:56:52.747291,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.92816246, 'precision': 0.839477, 'recall': 0.7760229, 'specificity': 0.99200743, 'f1': 0.8034863, 'auroc': 0.9911129}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   340     0    0    13    0    0    26    16     6    7     74
1     0  1192    0    19    1    0     0   108     4    0      7
2     8     0  152     3   45    1     3    18    14   66      2
3     1     0    0  8082    0   27     0   206   116    6      0
4     1     0   28     5  267    1     4    15    45   15    158
5     4     0    1    68    0  346     0     0    10   90      2
6    34     0    0    13    1    0  1760    16    14    7     62
7     1    22    3   329    3    0     2  6810    74    3     18
8     1     0    3   223   18    3     3   121  2847    4     73
9     6     1   39    29    0   75     3     9    16  307      8
10   13     2    1    17   36    0    20    49    64    2  12588
---- Validation: 
scalar performance:
{'acc': 0.92882174, 'precision': 0.8371305, 'recall': 0.77479553, 'specificity': 0.9920832, 'f1': 0.801814, 'auroc': 0.9911266}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   339     2    0    12    2    0    24    17    14    8     65
1     0  1200    0    20    1    0     0    97     5    0      9
2     8     2  148     3   43    0     3    25    10   67      3
3     0     0    0  8092    0   29     0   206   110    2      1
4     1     0   34     2  252    1     3    17    57   10    162
5     4     0    2    63    0  351     0     0    11   89      1
6    26     0    3    19    1    0  1767    16    17    5     54
7     0    14    2   320    4    0     1  6830    60    2     32
8     0     1    4   217   15    2     3   123  2852    2     77
9     7     1   42    30    2   73     2     5    19  311      1
10   21     1    1    15   40    0    14    41    79    2  12582
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51731616, 'precision': 0.592232, 'recall': 0.4213456, 'specificity': 0.9511239, 'f1': 0.4132169, 'auroc': 0.8120882}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   574     0   0   56   0    0   415    3    72    1    49
1     0  1296   1   70   0    0    16   37    21    0    58
2    18     5  36   51  83    1    26    3   420   52   320
3     0     0   0    0   0    0     0    0     0    0     0
4     0     2   0    0  99    0     8    0    23    0  1501
5    34     0   0  252   0  105    18    0    21  158     4
6    15     1   1    4  12    0  1813    0    56    2  1163
7     0   119  12  526   2    0   166  250    74    6     9
8     3     0   2   64   4    1    11    0  1242   10    33
9    82    20  43  258  12    6    50    6   265  336    59
10    0     0   0    1   2    0     0    0     0    0  1643
better model found
persisted
after epoch: 10,now: 2024-08-12 02:52:42.789052,epoch time: 0:32:46.904275,used: 5:29:39.651566,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:29:39.651566 at 2024-08-12 02:52:42.789052
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51731616, 'precision': 0.592232, 'recall': 0.4213456, 'specificity': 0.9511239, 'f1': 0.4132169, 'auroc': 0.8120882}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   574     0   0   56   0    0   415    3    72    1    49
1     0  1296   1   70   0    0    16   37    21    0    58
2    18     5  36   51  83    1    26    3   420   52   320
3     0     0   0    0   0    0     0    0     0    0     0
4     0     2   0    0  99    0     8    0    23    0  1501
5    34     0   0  252   0  105    18    0    21  158     4
6    15     1   1    4  12    0  1813    0    56    2  1163
7     0   119  12  526   2    0   166  250    74    6     9
8     3     0   2   64   4    1    11    0  1242   10    33
9    82    20  43  258  12    6    50    6   265  336    59
10    0     0   0    1   2    0     0    0     0    0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5453019, 'precision': 0.57711697, 'recall': 0.42731822, 'specificity': 0.9528078, 'f1': 0.42333183, 'auroc': 0.8265031}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   418     0    4   27    2    0   675    1    18    2    23
1     0  1334    2   43    1    0    23   22    12    0    62
2    10     5   77   34  277    0   113    3   182   59   255
3     0     0    0    0    0    0     0    0     0    0     0
4     0     2    0    0  218    0    17    0     7    0  1389
5    16     0    0  178    0  103    43    0     7  242     3
6     2     2    1    1   23    0  2313    0     9    2   714
7     0   244   56  251    7    0   393  159    37    4    13
8     2     0    5   46   28    3    63    0  1111   41    71
9    42    26  151  132   43    6   160    5   102  427    43
10    0     0    0    0   12    0     0    0     0    0  1634
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_21_23_02_seed_0_24142417_instance_wise_predictions.txt
accuracy from prediction file 0.5173161687539355
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/21.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/21.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/21.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    971 MiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |    839 MiB |  11810 MiB | 343488 GiB | 343487 GiB |
|       from small pool |    131 MiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    971 MiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |    839 MiB |  11810 MiB | 343488 GiB | 343487 GiB |
|       from small pool |    131 MiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    949 MiB |  11839 MiB | 343106 GiB | 343106 GiB |
|       from large pool |    817 MiB |  11761 MiB | 342319 GiB | 342318 GiB |
|       from small pool |    131 MiB |    212 MiB |    787 GiB |    787 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  12192 MiB |  12192 MiB |  12192 MiB |      0 B   |
|       from large pool |  11978 MiB |  11978 MiB |  11978 MiB |      0 B   |
|       from small pool |    214 MiB |    214 MiB |    214 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1532 MiB |   1793 MiB | 178413 GiB | 178411 GiB |
|       from large pool |   1522 MiB |   1788 MiB | 177595 GiB | 177593 GiB |
|       from small pool |     10 MiB |     14 MiB |    818 GiB |    818 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3767    |    6154    |   28180 K  |   28176 K  |
|       from large pool |     125    |     528    |   12055 K  |   12055 K  |
|       from small pool |    3642    |    5956    |   16124 K  |   16120 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3767    |    6154    |   28180 K  |   28176 K  |
|       from large pool |     125    |     528    |   12055 K  |   12055 K  |
|       from small pool |    3642    |    5956    |   16124 K  |   16120 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     301    |     301    |     301    |       0    |
|       from large pool |     194    |     194    |     194    |       0    |
|       from small pool |     107    |     107    |     107    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    1046    |   14688 K  |   14688 K  |
|       from large pool |      18    |      95    |    6534 K  |    6534 K  |
|       from small pool |      34    |    1027    |    8154 K  |    8154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |  16640 KiB |  11810 MiB | 343488 GiB | 343488 GiB |
|       from small pool |      0 KiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |  16640 KiB |  11810 MiB | 343488 GiB | 343488 GiB |
|       from small pool |      0 KiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  11839 MiB | 343106 GiB | 343106 GiB |
|       from large pool |  16640 KiB |  11761 MiB | 342319 GiB | 342319 GiB |
|       from small pool |      0 KiB |    212 MiB |    787 GiB |    787 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2504 MiB |  12192 MiB |  12192 MiB |   9688 MiB |
|       from large pool |   2362 MiB |  11978 MiB |  11978 MiB |   9616 MiB |
|       from small pool |    142 MiB |    214 MiB |    214 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   1793 MiB | 178413 GiB | 178413 GiB |
|       from large pool | 405248 KiB |   1788 MiB | 177595 GiB | 177595 GiB |
|       from small pool |      0 KiB |     36 MiB |    818 GiB |    818 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6154    |   28180 K  |   28180 K  |
|       from large pool |       2    |     528    |   12055 K  |   12055 K  |
|       from small pool |       0    |    5956    |   16124 K  |   16124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6154    |   28180 K  |   28180 K  |
|       from large pool |       2    |     528    |   12055 K  |   12055 K  |
|       from small pool |       0    |    5956    |   16124 K  |   16124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     301    |     301    |     189    |
|       from large pool |      41    |     194    |     194    |     153    |
|       from small pool |      71    |     107    |     107    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1046    |   14689 K  |   14689 K  |
|       from large pool |       4    |      95    |    6534 K  |    6534 K  |
|       from small pool |       0    |    1027    |    8155 K  |    8155 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |  16640 KiB |  11810 MiB | 343488 GiB | 343488 GiB |
|       from small pool |      0 KiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11887 MiB | 344277 GiB | 344277 GiB |
|       from large pool |  16640 KiB |  11810 MiB | 343488 GiB | 343488 GiB |
|       from small pool |      0 KiB |    213 MiB |    789 GiB |    789 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  11839 MiB | 343106 GiB | 343106 GiB |
|       from large pool |  16640 KiB |  11761 MiB | 342319 GiB | 342319 GiB |
|       from small pool |      0 KiB |    212 MiB |    787 GiB |    787 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2504 MiB |  12192 MiB |  12192 MiB |   9688 MiB |
|       from large pool |   2362 MiB |  11978 MiB |  11978 MiB |   9616 MiB |
|       from small pool |    142 MiB |    214 MiB |    214 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   1793 MiB | 178413 GiB | 178413 GiB |
|       from large pool | 405248 KiB |   1788 MiB | 177595 GiB | 177595 GiB |
|       from small pool |      0 KiB |     36 MiB |    818 GiB |    818 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6154    |   28180 K  |   28180 K  |
|       from large pool |       2    |     528    |   12055 K  |   12055 K  |
|       from small pool |       0    |    5956    |   16124 K  |   16124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6154    |   28180 K  |   28180 K  |
|       from large pool |       2    |     528    |   12055 K  |   12055 K  |
|       from small pool |       0    |    5956    |   16124 K  |   16124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     112    |     301    |     301    |     189    |
|       from large pool |      41    |     194    |     194    |     153    |
|       from small pool |      71    |     107    |     107    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1046    |   14689 K  |   14689 K  |
|       from large pool |       4    |      95    |    6534 K  |    6534 K  |
|       from small pool |       0    |    1027    |    8155 K  |    8155 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417

 Experiment start at: 2024-08-12 03:08:50.581439
before training, model accuracy: 0.06254810094833374
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7017605, 'precision': 0.3922623, 'recall': 0.2654792, 'specificity': 0.96370506, 'f1': 0.25346407, 'auroc': 0.89353406}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   0   0    81   0   4   61   110   16   0    211
1    0  34   0    59   0   0    1   968    0   0    269
2    0   0   0    79   0   0   17    91   28   0     97
3    0   0   0  7700   0   0    5   656   10   0     68
4    0   0   0    56   0   1   19    59    9   0    395
5    0   0   0   463   0   4   10    17   15   0     12
6    0   0   0   153   0  10  337   143   87   0   1178
7    0   0   1  1579   0   0    4  5396    7   0    277
8    0   1   0  1421   0   0   44   700  256   0    874
9    0   0   0   304   0   7   28    85   36   0     33
10   0   0   0    93   0   0   39   127   29   0  12502
---- Validation: 
scalar performance:
{'acc': 0.7010031, 'precision': 0.38295412, 'recall': 0.26567525, 'specificity': 0.9636101, 'f1': 0.25355762, 'auroc': 0.89409137}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   0   0    78   0   0   67   112   25   0    201
1    0  40   0    66   0   0    0   942    0   0    284
2    0   0   0    77   0   1   28    99   20   0     87
3    0   0   0  7651   0   0    2   698   11   0     78
4    0   0   0    58   0   0   22    66   10   0    383
5    0   0   0   456   0   1    5    29   18   0     12
6    0   0   0   158   0   4  366   145   88   0   1147
7    0   0   0  1561   0   0    3  5412    6   0    283
8    0   1   0  1428   0   3   50   676  230   0    908
9    0   0   0   312   0   6   22    77   31   0     45
10   0   0   0    82   0   0   34   141   32   0  12507
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.18715455, 'precision': 0.15887958, 'recall': 0.16713923, 'specificity': 0.9170032, 'f1': 0.09482507, 'auroc': 0.6534989}
confusion matrix:
    0   1   2    3   4   5    6    7   8   9     10
0    0   0   0   70   0  21  597   49  97   0   336
1    0  61   0   45   0   1    9  627   1   0   755
2    0   1   0  101   0   7   57   53  16   0   780
3    0   0   0    0   0   0    0    0   0   0     0
4    0   0   0    1   0   0    6    0   1   0  1625
5    0   0   0  442   0  15   20   47  22   0    46
6    0   5   0    3   0   3   78    2   2   0  2974
7    0  10   0   39   0   4   24  839   9   0   239
8    0   1   0  153   0  37  155  109  36   0   879
9    0   4   0  384   0  16   81  160  28   0   464
10   0   0   0    0   0   0    0    0   0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-12 03:43:02.031046,epoch time: 0:34:11.449607,used: 0:34:11.449607,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.82298803, 'precision': 0.42728105, 'recall': 0.44239205, 'specificity': 0.9799704, 'f1': 0.4335439, 'auroc': 0.94540834}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    23   0   1   231    29   122   0     77
1    0  1101   0    20   0   0     0   183     4   0     22
2    0     0   0    19   0   0    80    38   143   0     32
3    0     0   0  7678   0   0     7   514   222   0     17
4    0     1   0    16   0   0   109    25   111   0    277
5    0     0   0   373   0   0    28     1   116   0      2
6    0     1   0    38   0   0  1282    44   233   0    309
7    0    20   0   676   0   0    12  6310   130   0    117
8    0     1   0   540   0   0   152   257  2056   0    290
9    0     0   0   161   0   0    78    21   229   0      3
10   0     6   0    14   0   0   237    57   147   0  12333
---- Validation: 
scalar performance:
{'acc': 0.820436, 'precision': 0.516372, 'recall': 0.44130236, 'specificity': 0.9797164, 'f1': 0.43227422, 'auroc': 0.9446707}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    24   0   0   234    24   124   0     77
1    0  1096   0    24   0   0     2   178     7   0     25
2    0     0   0    24   0   0    72    46   144   0     26
3    0     0   0  7668   0   0     7   521   233   0     11
4    0     0   0    12   0   0   122    24   112   0    269
5    0     0   0   369   0   0    28     1   120   0      3
6    0     2   0    34   0   0  1289    39   228   0    316
7    0    25   0   684   0   0    12  6273   154   0    117
8    0     0   0   553   0   0   145   266  2046   0    286
9    0     0   0   172   0   0    71    22   226   1      1
10   0     5   0    14   0   0   265    61   152   0  12299
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42307425, 'precision': 0.30015945, 'recall': 0.30013204, 'specificity': 0.9385775, 'f1': 0.25222144, 'auroc': 0.731366}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     0   0    6   0   0   919    1  241   0     3
1    0  1077   0   28   0   0    88   71   53   0   182
2    0     4   0   32   0   0   529    3  197   0   250
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0   170    0    1   0  1462
5    0     0   0  251   0   1    67    1  270   0     2
6    0     1   0    1   0   0  2259    0    7   0   799
7    0   138   0   17   0   0   301  511  151   0    46
8    0     0   0   46   0   1   658    1  570   0    94
9    0    11   0  165   0   0   385    5  487   0    84
10   0     0   0    0   0   0    17    0    0   0  1629
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-12 04:15:51.427063,epoch time: 0:32:49.396017,used: 1:07:00.845624,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8427868, 'precision': 0.51413834, 'recall': 0.46558315, 'specificity': 0.9822373, 'f1': 0.46403623, 'auroc': 0.96131694}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   1    60   0   2   186    32   125  15     62
1    0  1076   0    73   0   0     0   171     4   0      8
2    0     0   0    31   0   0    45    84   125   6     21
3    0     0   0  7986   0   0     1   309   141   0      1
4    1     0   0    18   0   0    60    34   151   2    273
5    0     0   0   425   0   3    13     0    62  17      1
6    0     4   0    59   0   1  1397    39   214   2    192
7    0    14   0   732   0   0     2  6377    87   0     51
8    0     0   0   588   0   0    21   184  2400   0    102
9    1     1   0   234   0   5    53    32   129  33      5
10   0     4   0    48   0   0   145    96   271   0  12228
---- Validation: 
scalar performance:
{'acc': 0.8429316, 'precision': 0.65294415, 'recall': 0.46594232, 'specificity': 0.9822793, 'f1': 0.46356767, 'auroc': 0.9607499}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    1     0   0    48   0   0   193    30   141  10     60
1    0  1100   0    55   0   0     0   160     5   0     12
2    0     0   0    32   0   1    45    70   132   5     27
3    0     0   0  8008   0   0     0   311   116   0      5
4    0     0   0    14   0   0    62    29   163   1    270
5    0     0   0   424   0   4    17     0    57  18      1
6    0     2   0    80   0   0  1382    41   215   1    187
7    0    20   0   726   0   0     3  6385    93   0     38
8    0     0   0   599   0   0    23   192  2387   0     95
9    0     1   0   238   0   0    49    36   139  29      1
10   0     2   0    41   0   0   154   105   277   0  12217
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46029526, 'precision': 0.38072306, 'recall': 0.34315178, 'specificity': 0.9445428, 'f1': 0.2845985, 'auroc': 0.78626287}
confusion matrix:
    0     1   2    3   4   5     6    7     8   9     10
0    2     2   0   25   0   0   775    3   359   0     4
1    0  1234   0   48   0   0    20   68    55   0    74
2    0     9   0   90   0   0   236    9   417   0   254
3    0     0   0    0   0   0     0    0     0   0     0
4    0     1   0    1   0   0    62    0    17   0  1552
5    0     0   0  449   0   0    17    0   124   1     1
6    0     2   0    2   0   0  2044    0    68   0   951
7    1   227   0   95   0   0    82  589   148   0    22
8    0     0   0  119   0   0   135    0  1067   0    49
9    0    19   0  392   0   0   130    5   549   1    41
10   0     0   0    0   0   0     4    0     0   0  1642
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-12 04:48:38.243995,epoch time: 0:32:46.816932,used: 1:39:47.662556,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8756689, 'precision': 0.6759317, 'recall': 0.5494976, 'specificity': 0.9861119, 'f1': 0.5508585, 'auroc': 0.9759199}
confusion matrix:
    0     1   2     3   4   5     6     7     8    9      10
0   40     0   1    12   0   0   248    23    50   41     68
1    0  1161   0    19   0   0     0   128     9    0     13
2   20     0   6    10   1   0    52    62    70   43     48
3    0     0   0  7771   0   4     3   376   273    8      4
4    8     0   1     4   0   1    52    21   101    9    342
5    0     0   0   252   0  50    12     2    28  176      1
6    3     2   0    11   0   1  1652    22    67   15    134
7    0    26   0   397   0   0     4  6638   125    1     73
8    0     0   0   273   0   1    29   138  2745    5    104
9   11     0   2    86   0   7    54    23    69  230     10
10   6     1   0    15   0   0   117    51   167    1  12436
---- Validation: 
scalar performance:
{'acc': 0.8770095, 'precision': 0.69323725, 'recall': 0.5554899, 'specificity': 0.9862303, 'f1': 0.55929685, 'auroc': 0.9757991}
confusion matrix:
    0     1   2     3   4   5     6     7     8    9      10
0   52     0   0    12   0   0   217    22    52   48     80
1    0  1156   0    24   0   0     0   130     8    0     14
2   21     1   6     9   0   0    49    64    62   44     56
3    0     0   0  7801   0   3     5   382   242    4      3
4   10     0   0     5   0   0    68    25    99    7    325
5    0     1   0   264   0  56    16     0    20  162      2
6    0     2   0    24   0   0  1657    16    58   13    138
7    0    23   0   399   0   0     6  6662   120    1     54
8    0     0   0   281   0   0    23   152  2732    4    104
9    3     1   3    83   0  14    48    24    65  246      6
10   8     3   0    20   0   0   128    50   166    2  12419
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46190444, 'precision': 0.4139694, 'recall': 0.33587337, 'specificity': 0.9432702, 'f1': 0.29062137, 'auroc': 0.8052778}
confusion matrix:
    0     1   2    3   4   5     6    7    8    9     10
0   19     0   0    5   0   0  1049    0   87    6     4
1    2  1227   1   33   0   0    41   40   68    1    86
2   25     3   0   26   0   0   373    4  214   18   352
3    0     0   0    0   0   0     0    0    0    0     0
4    0     0   0    0   0   0    41    0    3    0  1589
5    5     0   0  255   0   3    61    0   89  177     2
6    0     1   0    0   0   0  2280    0   14    0   772
7    8   204   1   63   0   0   291  379  183    1    34
8   17     0   0   48   0   0   274    0  909   26    96
9   82     9   2  175   0   0   322    1  343  139    64
10   0     0   0    0   0   0     0    0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-12 05:21:24.902320,epoch time: 0:32:46.658325,used: 2:12:34.320881,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.89049125, 'precision': 0.75005984, 'recall': 0.6113566, 'specificity': 0.9875294, 'f1': 0.62639964, 'auroc': 0.98162603}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   194     0   0     9   0    0    98    25    19   41     97
1     0  1186   0    18   0    0     0   115     4    0      9
2    35     1  16     9   5    0    17    59    34   45     91
3     0     1   0  7706   0   19     2   508   192    4      4
4    19     0   9     2   6    0    21    14    62   11    395
5     0     0   0   180   0  123     4     0    16  196      2
6    18     1   0    24   0    1  1670    18    36   14    124
7     0    29   1   257   0    0     5  6800   109    0     61
8     3     2   0   248   0    4    19   159  2723   10    128
9    25     1   6    50   0   24    11    39    27  296     14
10   13     4   0    12   0    0    58    55    88    3  12563
---- Validation: 
scalar performance:
{'acc': 0.8912933, 'precision': 0.7485712, 'recall': 0.6136557, 'specificity': 0.9876516, 'f1': 0.6284776, 'auroc': 0.98219925}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   205     1   1    11   0    0   102    18    22   30     93
1     0  1189   0    16   0    0     0   106     9    0     12
2    32     1  23     4   3    0    15    63    34   58     79
3     0     0   0  7700   0   14     1   499   213    9      4
4    22     1   4     2   2    1    21    17    63    9    397
5     2     0   0   177   0  118     1     1    12  209      1
6    18     3   0    12   0    1  1662    16    43   19    134
7     1    25   1   251   0    0     1  6843    95    0     48
8     1     2   2   257   0    0    20   149  2739    3    123
9    23     0   6    54   0   24     9    30    39  292     16
10   22     2   0    10   0    1    64    53    93    3  12548
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.42965087, 'precision': 0.4437574, 'recall': 0.34500265, 'specificity': 0.9407154, 'f1': 0.3187882, 'auroc': 0.8030393}
confusion matrix:
     0     1   2    3   4   5     6    7    8    9     10
0   253     0   0    6   0   0   834    0   39   20    18
1     1  1277   2   26   0   0    27   28   47    1    90
2    80     6   2   16   2   0   149    3  143   44   570
3     0     0   0    0   0   0     0    0    0    0     0
4     1     0   0    0   1   0     8    0    3    0  1620
5    19     0   0  177   0  63    29    0   32  270     2
6     5     1   0    0   1   1  1428    0   13    0  1618
7    13   347   3   50   1   0   252  321  124    3    50
8    76     0   0   29   0   9   105    0  902   41   208
9   236    14   5  111   0  14   136    3  233  248   137
10    0     0   0    0   0   0     0    0    0    0  1646
better model found
persisted
after epoch: 5,now: 2024-08-12 05:54:17.673460,epoch time: 0:32:52.771140,used: 2:45:27.092021,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9004709, 'precision': 0.80220115, 'recall': 0.6564106, 'specificity': 0.988639, 'f1': 0.68234676, 'auroc': 0.9848934}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   275     0   1    12   0    0    43    29     7   37     79
1     0  1135   0    23   0    0     1   160     6    0      7
2    25     0  39     5  14    0     8    86    17   74     44
3     0     1   0  7997   0   19     0   302   115    4      2
4    26     0   9     0  45    2    11    29    46   12    359
5     0     0   1   130   0  205     2     1    11  170      1
6    27     0   0    18   0    4  1712    25    22   14     86
7     0    12   1   387   0    1     4  6772    54    1     30
8     1     0   2   322   2    5    15   230  2574    4    140
9    14     2   6    44   0   40     8    43     9  323      4
10   32     1   0    14   1    1    47    61    52    3  12579
---- Validation: 
scalar performance:
{'acc': 0.8986492, 'precision': 0.7907065, 'recall': 0.6548559, 'specificity': 0.9884279, 'f1': 0.6804642, 'auroc': 0.9848138}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   277     0   0    12   0    0    46    31    10   31     76
1     0  1134   0    23   0    0     0   159     5    0     11
2    35     0  32     7  20    0     2    81    12   82     41
3     0     0   0  7955   0   24     1   325   132    1      2
4    20     0   6     3  52    1    10    33    41   17    356
5     3     0   0   136   0  211     3     2     9  156      1
6    21     1   1    13   0    2  1718    22    21   13     96
7     1     8   1   378   2    1     1  6794    42    1     36
8     2     0   2   325   2    8    18   239  2552    3    145
9    14     1   8    49   1   41     6    38    11  316      8
10   36     1   0    12   4    1    52    62    70    3  12555
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48555237, 'precision': 0.4962722, 'recall': 0.3903851, 'specificity': 0.94700706, 'f1': 0.37425464, 'auroc': 0.8205896}
confusion matrix:
     0     1   2    3   4   5     6    7    8    9     10
0   375     0   0   13   0   0   698    0   59    8    17
1     1  1257   3   35   0   0    28   55   42    1    77
2   102     4   6   27  15   0   110    8  162   49   532
3     0     0   0    0   0   0     0    0    0    0     0
4     0     1   0    1  11   0     7    0    3    0  1610
5    30     0   0  239   0  85    16    0   26  194     2
6    14     1   0    0   7   1  1797    1   11    0  1235
7    12   206   6  132   0   2   186  508   90    4    18
8    58     0   0   69   1  10    53    1  984   27   167
9   240    11  18  182   3  10    73   10  202  271   117
10    0     0   0    0   0   0     0    0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-12 06:27:08.360981,epoch time: 0:32:50.687521,used: 3:18:17.779542,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9130726, 'precision': 0.80647445, 'recall': 0.71547693, 'specificity': 0.99030334, 'f1': 0.74501264, 'auroc': 0.9877679}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   305     0    4     8    1    0    42    23    12   22     66
1     0  1198    0    26    0    0     0    89    12    0      7
2    12     3  107     5   26    3     7    40    24   66     19
3     0     2    0  7984    0   28     0   276   147    1      0
4    16     0   35     4  125    3    12    18    61   14    251
5     0     0    0   114    0  299     2     4     8   92      2
6    22     0    1    20    0    3  1737    16    27    9     73
7     0    16    1   341    1    0     3  6781    99    0     21
8     3     0    4   289    3    5     7   103  2812    2     67
9    10     0   26    48    0   92     2    16    16  281      2
10   36     5    3    19   15    1    52    53   106    4  12498
---- Validation: 
scalar performance:
{'acc': 0.9146449, 'precision': 0.816812, 'recall': 0.72402513, 'specificity': 0.990458, 'f1': 0.7538137, 'auroc': 0.9884225}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   305     0    3     9    0    1    45    14    17   26     63
1     0  1193    0    23    0    0     0    98    12    0      6
2    15     2  109     6   30    1     2    43    21   62     21
3     1     0    1  7992    0   26     0   287   128    4      1
4    15     0   28     2  136    2    11    18    62   18    247
5     1     0    0   108    0  317     0     0     9   85      1
6    23     0    0    21    1    1  1759    12    22   10     59
7     0    12    2   349    0    1     1  6773    99    0     28
8     1     1    5   297    0    6     4   103  2800    3     76
9     8     1   26    41    0   85     0    13    20  295      4
10   38     1    6    21    7    0    68    46    89    5  12515
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47162947, 'precision': 0.49541506, 'recall': 0.38831812, 'specificity': 0.9458911, 'f1': 0.3649897, 'auroc': 0.8227516}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   378     0   1   14   0    0   621    0   132    2    22
1     0  1321   4   37   0    0    14   17    60    1    45
2    71     6  29   24  41    7    69    4   306   34   424
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0  23    0     4    0     8    0  1597
5    24     0   0  223   0  182    13    0    39  110     1
6     9     1   1    1  15    0  1609    0    32    0  1399
7     4   305  20  248   0    1   160  221   185    3    17
8    19     0   5   58   1   14    25    0  1131   12   105
9   163    12  92  175   4   53    53    1   319  202    63
10    0     0   0    0   1    0     0    0     0    0  1645
better model found
persisted
after epoch: 7,now: 2024-08-12 07:00:04.964221,epoch time: 0:32:56.603240,used: 3:51:14.382782,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.91911924, 'precision': 0.8099046, 'recall': 0.7532413, 'specificity': 0.99096787, 'f1': 0.77675986, 'auroc': 0.9891323}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   335     0    2     5    0    0    13    19     7   14     88
1     0  1200    0    16    0    0     1    95    10    1      9
2    14     2  136     4   46    4     1    28     7   53     17
3     1     1    0  7899    1   45     0   339   149    3      0
4    11     0   35     3  221    3     4    10    33    9    210
5     3     0    0    78    0  337     0     2     5   95      1
6    50     0    1    18    0    4  1688    17    33    2     95
7     1    17    4   255    2    0     2  6853    83    2     44
8     3     0    6   236    9   11     2   122  2826    1     80
9    16     0   38    25    0   95     3     8    10  293      5
10   41     2    5     9   43    1    11    42    71    1  12565
---- Validation: 
scalar performance:
{'acc': 0.9200214, 'precision': 0.80660313, 'recall': 0.7544321, 'specificity': 0.9911074, 'f1': 0.7756398, 'auroc': 0.9897579}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     0    2     8    0    2    16    16     8   10     75
1     0  1190    0    20    0    0     0   109     5    0      8
2    13     2  113     3   56    2     2    30    15   67      9
3     0     0    0  7933    0   46     0   312   143    5      1
4    11     0   23     0  232    4     3    18    33   14    201
5     2     0    3    64    0  344     0     0     6  101      1
6    55     0    1    13    3    3  1685    16    25    6    101
7     1    19    2   264    1    0     1  6844    92    3     38
8     1     0    9   232   12   11     5   123  2819    3     81
9    11     2   38    17    1   89     1     7    11  312      4
10   37     1    7    10   45    0    13    38    68    0  12577
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4740782, 'precision': 0.49707925, 'recall': 0.40514812, 'specificity': 0.94624484, 'f1': 0.39387053, 'auroc': 0.82160366}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   556     0    4    8    0    0   390    0   138    3    71
1     0  1324    7   31    1    1    12   22    29    1    71
2    43     5   65   11  190    8    22    6   162   30   473
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1    0    0  101    0     2    0     3    0  1526
5    43     0    1  120    0  177     6    0    41  203     1
6     7     0    1    0   84    1  1291    0    20    2  1661
7     4   316   28  247    2    2   168  276    85   12    24
8    17     0   18   27   14   35     9    0  1099   16   135
9   161    21  243   71   46   48    39    7   174  245    82
10    0     0    0    0    4    0     0    0     0    0  1642
better model found
persisted
after epoch: 8,now: 2024-08-12 07:32:51.305792,epoch time: 0:32:46.341571,used: 4:24:00.724353,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92267764, 'precision': 0.81836015, 'recall': 0.7659234, 'specificity': 0.9913873, 'f1': 0.7872161, 'auroc': 0.9908466}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   362     0    3     7    1    0    11    14     5    5     75
1     0  1215    0    19    0    0     0    80     6    0     12
2    10     3  146     4   40    2     1    28    18   45     15
3     1     1    1  7962    0   37     0   253   182    2      0
4    11     0   30     3  233    1     1     9    43   10    198
5     4     0    3    63    0  334     0     1     8  107      1
6    66     0    1    14    3    2  1702    10    26    4     80
7     0    23    8   320    1    0     0  6771    94    1     46
8     4     1    8   190    6    4     3   102  2881    1     96
9    24     0   55    23    1   65     2    15    10  294      4
10   39     1    4     8   29    2    19    32    69    0  12586
---- Validation: 
scalar performance:
{'acc': 0.92577237, 'precision': 0.82459116, 'recall': 0.77023125, 'specificity': 0.9917177, 'f1': 0.79281133, 'auroc': 0.9910048}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    1     9    1    0     8    14    14    3     62
1     0  1226    0    18    0    0     0    70     6    0     12
2    11     2  144     2   50    2     2    31    17   43      8
3     0     0    1  8003    0   37     0   243   152    2      2
4    12     0   25     1  231    1     2    17    41   10    199
5     4     0    0    64    0  339     0     1    11  100      2
6    52     0    1    17    0    1  1694    15    30    4     94
7     0    22    3   306    1    0     1  6801    88    3     40
8     3     1    6   191    8    6     7    98  2882    3     91
9    21     1   52    23    1   70     3     7    11  301      3
10   32     0    4    11   36    2    14    21    57    1  12618
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47442803, 'precision': 0.52651656, 'recall': 0.3913917, 'specificity': 0.9464117, 'f1': 0.3738992, 'auroc': 0.82080096}
confusion matrix:
     0     1    2    3   4    5     6    7     8    9     10
0   498     0    2   11   0    0   451    0   152    1    55
1     0  1290    4   41   0    0    14   16    43    1    90
2    34     3   36   16  79    3    18    2   289   30   505
3     0     0    0    0   0    0     0    0     0    0     0
4     0     0    0    0  79    0     3    0     6    0  1545
5    28     0    1  185   0  134     8    0    51  183     2
6     6     0    0    0  33    2  1511    0    22    0  1493
7     3   221   21  399   1    2   178  167   133    9    30
8     7     0    8   34   5   14    10    0  1183   12    97
9   131    16  145  127  15   13    30    1   331  240    88
10    0     0    0    0   3    0     0    0     0    0  1643
better model found
persisted
after epoch: 9,now: 2024-08-12 08:05:37.210484,epoch time: 0:32:45.904692,used: 4:56:46.629045,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9286173, 'precision': 0.8366108, 'recall': 0.77593565, 'specificity': 0.9920355, 'f1': 0.80047774, 'auroc': 0.99179167}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    2     3    0    2     9    16     8    3     69
1     0  1238    0    16    0    0     0    67     5    0      5
2    13     2  165     3   40    0     1    29    16   39      4
3     0     0    0  7998    0   20     0   292   125    1      2
4     7     0   42     0  223    2     2    11    42    7    203
5     3     0    2    85    0  346     0     0    10   73      2
6    70     2    3    25    1    2  1691     9    25    3     77
7     1    33    2   243    3    0     2  6890    66    0     24
8     2     2    2   215    5    1     0   116  2888    1     62
9    13     1   48    35    1   82     1     7    14  288      2
10   22     3    5     9   23    0     6    32    83    1  12610
---- Validation: 
scalar performance:
{'acc': 0.928367, 'precision': 0.8310258, 'recall': 0.77153283, 'specificity': 0.9920036, 'f1': 0.7954869, 'auroc': 0.9913529}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   365     0    1     8    1    1     5    15    11    5     71
1     0  1244    0    17    0    0     0    63     2    0      6
2    10     4  158     2   35    0     1    27    14   47     14
3     1     0    0  8023    1   18     0   274   122    1      0
4     8     0   45     2  216    2     0    12    48    7    199
5     4     1    1    80    0  338     0     0    12   83      2
6    76     1    1    15    1    1  1691    12    20    4     86
7     0    32    2   260    3    0     1  6873    66    2     26
8     1     2    5   224    9    3     2    98  2896    1     55
9     9     1   41    37    2   78     1    12    12  293      7
10   34     5    5     9   27    1    11    31    63    0  12610
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.456867, 'precision': 0.54926634, 'recall': 0.4044757, 'specificity': 0.94518816, 'f1': 0.38986027, 'auroc': 0.826403}
confusion matrix:
     0     1    2    3   4    5    6    7     8    9     10
0   648     2    4   36   0    0  230    2   129    9   110
1     0  1384    1   37   0    0    3   14    24    1    35
2    20    23   59   31  57    4    4    3   308   36   470
3     0     0    0    0   0    0    0    0     0    0     0
4     0     2    0    0  63    0    2    0     6    0  1560
5    13     0    1  195   0  187    2    0    27  164     3
6     5     4    2    4  35    1  907    0    43    0  2066
7     0   348   12  497   0    0   40  177    71    7    12
8     3     0    8   83   5   21    1    1  1150   13    85
9    56    46  178  192   7   35    8    6   225  311    73
10    0     1    0    0   1    0    0    0     0    0  1644
better model found
persisted
after epoch: 10,now: 2024-08-12 08:38:19.663610,epoch time: 0:32:42.453126,used: 5:29:29.082171,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:29:29.082171 at 2024-08-12 08:38:19.663610
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.456867, 'precision': 0.54926634, 'recall': 0.4044757, 'specificity': 0.94518816, 'f1': 0.38986027, 'auroc': 0.826403}
confusion matrix:
     0     1    2    3   4    5    6    7     8    9     10
0   648     2    4   36   0    0  230    2   129    9   110
1     0  1384    1   37   0    0    3   14    24    1    35
2    20    23   59   31  57    4    4    3   308   36   470
3     0     0    0    0   0    0    0    0     0    0     0
4     0     2    0    0  63    0    2    0     6    0  1560
5    13     0    1  195   0  187    2    0    27  164     3
6     5     4    2    4  35    1  907    0    43    0  2066
7     0   348   12  497   0    0   40  177    71    7    12
8     3     0    8   83   5   21    1    1  1150   13    85
9    56    46  178  192   7   35    8    6   225  311    73
10    0     1    0    0   1    0    0    0     0    0  1644
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48555237, 'precision': 0.4962722, 'recall': 0.3903851, 'specificity': 0.94700706, 'f1': 0.37425464, 'auroc': 0.8205896}
confusion matrix:
     0     1   2    3   4   5     6    7    8    9     10
0   375     0   0   13   0   0   698    0   59    8    17
1     1  1257   3   35   0   0    28   55   42    1    77
2   102     4   6   27  15   0   110    8  162   49   532
3     0     0   0    0   0   0     0    0    0    0     0
4     0     1   0    1  11   0     7    0    3    0  1610
5    30     0   0  239   0  85    16    0   26  194     2
6    14     1   0    0   7   1  1797    1   11    0  1235
7    12   206   6  132   0   2   186  508   90    4    18
8    58     0   0   69   1  10    53    1  984   27   167
9   240    11  18  182   3  10    73   10  202  271   117
10    0     0   0    0   0   0     0    0    0    0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_12_03_08_49_seed_1_24142417_instance_wise_predictions.txt
accuracy from prediction file 0.4568669978311061
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/21.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/21.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    973 MiB |  11890 MiB | 688413 GiB | 688412 GiB |
|       from large pool |    841 MiB |  11812 MiB | 686833 GiB | 686832 GiB |
|       from small pool |    131 MiB |    213 MiB |   1579 GiB |   1579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    973 MiB |  11890 MiB | 688413 GiB | 688412 GiB |
|       from large pool |    841 MiB |  11812 MiB | 686833 GiB | 686832 GiB |
|       from small pool |    131 MiB |    213 MiB |   1579 GiB |   1579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    949 MiB |  11847 MiB | 686213 GiB | 686212 GiB |
|       from large pool |    817 MiB |  11769 MiB | 684638 GiB | 684638 GiB |
|       from small pool |    131 MiB |    212 MiB |   1574 GiB |   1574 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  12216 MiB |  12216 MiB |  21904 MiB |   9688 MiB |
|       from large pool |  12002 MiB |  12002 MiB |  21618 MiB |   9616 MiB |
|       from small pool |    214 MiB |    214 MiB |    286 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1706 MiB |   2174 MiB | 370142 GiB | 370140 GiB |
|       from large pool |   1698 MiB |   2172 MiB | 368500 GiB | 368498 GiB |
|       from small pool |      8 MiB |     36 MiB |   1642 GiB |   1642 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3767    |    6154    |   56358 K  |   56355 K  |
|       from large pool |     125    |     528    |   24111 K  |   24111 K  |
|       from small pool |    3642    |    5956    |   32247 K  |   32244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3767    |    6154    |   56358 K  |   56355 K  |
|       from large pool |     125    |     528    |   24111 K  |   24111 K  |
|       from small pool |    3642    |    5956    |   32247 K  |   32244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     291    |     301    |     480    |     189    |
|       from large pool |     184    |     194    |     337    |     153    |
|       from small pool |     107    |     107    |     143    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    1063    |   29512 K  |   29512 K  |
|       from large pool |      21    |     100    |   13259 K  |   13259 K  |
|       from small pool |      33    |    1041    |   16252 K  |   16252 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11890 MiB | 688413 GiB | 688413 GiB |
|       from large pool |  16640 KiB |  11812 MiB | 686833 GiB | 686833 GiB |
|       from small pool |      0 KiB |    213 MiB |   1579 GiB |   1579 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11890 MiB | 688413 GiB | 688413 GiB |
|       from large pool |  16640 KiB |  11812 MiB | 686833 GiB | 686833 GiB |
|       from small pool |      0 KiB |    213 MiB |   1579 GiB |   1579 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  11847 MiB | 686213 GiB | 686213 GiB |
|       from large pool |  16640 KiB |  11769 MiB | 684638 GiB | 684638 GiB |
|       from small pool |      0 KiB |    212 MiB |   1574 GiB |   1574 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2680 MiB |  12216 MiB |  21904 MiB |  19224 MiB |
|       from large pool |   2540 MiB |  12002 MiB |  21618 MiB |  19078 MiB |
|       from small pool |    140 MiB |    214 MiB |    286 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   2174 MiB | 370142 GiB | 370142 GiB |
|       from large pool | 405248 KiB |   2172 MiB | 368500 GiB | 368500 GiB |
|       from small pool |      0 KiB |     36 MiB |   1642 GiB |   1642 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6154    |   56358 K  |   56358 K  |
|       from large pool |       2    |     528    |   24111 K  |   24111 K  |
|       from small pool |       0    |    5956    |   32247 K  |   32247 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6154    |   56358 K  |   56358 K  |
|       from large pool |       2    |     528    |   24111 K  |   24111 K  |
|       from small pool |       0    |    5956    |   32247 K  |   32247 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     301    |     480    |     365    |
|       from large pool |      45    |     194    |     337    |     292    |
|       from small pool |      70    |     107    |     143    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1063    |   29513 K  |   29513 K  |
|       from large pool |       4    |     100    |   13259 K  |   13259 K  |
|       from small pool |       0    |    1041    |   16253 K  |   16253 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Aug 12 08:45:08 2024]
Finished job 0.
1 of 1 steps (100%) done
