Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 12:20:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405

 Experiment start at: 2024-08-11 12:30:54.151245
before training, model accuracy: 0.05282306298613548
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8110285, 'precision': 0.4184495, 'recall': 0.42505348, 'specificity': 0.9786358, 'f1': 0.4198963, 'auroc': 0.9415741}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    27   0   0  207    38   146   0     65
1    0  1079   0    14   0   0    0   194     4   0     41
2    0     0   0    10   0   0   75    40   160   0     27
3    0     0   0  7354   0   0    0   731   336   0     16
4    0     0   0     7   0   0   77    23   144   0    288
5    0     0   0   341   0   0   39     3   137   0      1
6    0     3   0    34   0   0  946    70   470   0    385
7    0    34   0   539   0   0    3  6413   158   0    116
8    0     0   0   444   0   0   57   318  2131   0    346
9    0     0   0   126   0   0   87    24   253   0      3
10   0     7   0    15   0   0  128    82   170   0  12390
---- Validation: 
scalar performance:
{'acc': 0.8103517, 'precision': 0.41792697, 'recall': 0.4255418, 'specificity': 0.978576, 'f1': 0.41992977, 'auroc': 0.9396515}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    29   0   0  216    36   129   0     73
1    0  1086   0    14   0   0    0   184     6   0     42
2    0     1   0    15   0   0   69    47   159   0     21
3    0     0   0  7339   0   0    0   721   360   0     20
4    0     0   0     9   0   0   76    23   134   0    297
5    0     0   0   330   0   0   40     1   149   0      1
6    0     6   0    24   0   0  950    66   464   0    398
7    0    33   0   563   0   0    4  6378   175   0    112
8    0     1   0   469   0   0   56   300  2148   0    322
9    0     0   0   114   0   0   92    20   266   0      1
10   0     4   0    13   0   0  135    81   169   0  12394
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34408453, 'precision': 0.33295968, 'recall': 0.27213106, 'specificity': 0.92982346, 'f1': 0.23418263, 'auroc': 0.73988885}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     6   0    4   0   0  1133   15   10   0     2
1    0  1015   0   17   0   0    71   88    7   0   301
2    0     3   0   45   0   0   749    7   57   0   154
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    64    0    0   0  1569
5    0     0   0  273   0   1   170    2  144   0     2
6    0     4   0    0   0   0  1048    1    4   0  2010
7    0   285   0    1   0   0   110  703   17   0    48
8    0     0   0   48   0   0   729    4  508   0    81
9    0     9   0  211   0   0   715   24  158   0    20
10   0     0   0    0   0   0     3    0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 13:03:51.339750,epoch time: 0:32:57.188505,used: 0:32:57.188505,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8595623, 'precision': 0.63876885, 'recall': 0.51023877, 'specificity': 0.98452914, 'f1': 0.5038236, 'auroc': 0.9736852}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    3     0   0    30   0    7   316    21    41   2     63
1    0  1137   0    16   0    0     0   148     8   0     22
2    0     0   0     8   0    2   102    44   132   3     21
3    0     0   0  7558   0    7     2   515   353   0      3
4    0     0   0     6   0    0   103    17   143   0    270
5    0     0   0   234   0  149    74     1    52  10      1
6    0     1   0    17   0    1  1606    31    88   1    163
7    0    49   0   388   0    0     7  6574   180   0     64
8    0     0   0   222   0    1    34   152  2743   0    144
9    0     0   0    75   0   63   202    23   116  13      1
10   0     5   0    12   0    1   197    51   183   0  12344
---- Validation: 
scalar performance:
{'acc': 0.85911465, 'precision': 0.6501727, 'recall': 0.50969505, 'specificity': 0.98443544, 'f1': 0.50548124, 'auroc': 0.9744073}
confusion matrix:
    0     1   2     3   4    5     6     7     8   9      10
0    2     1   0    24   0    5   324    19    46   2     60
1    0  1143   0    16   0    0     0   144     8   0     21
2    0     0   0     6   0    2   108    39   135   2     20
3    0     1   0  7547   0    7     1   494   387   0      3
4    0     0   0     3   0    1   106     9   147   0    273
5    0     0   0   261   0  149    49     0    50  10      2
6    0     2   0    18   0    3  1582    32    90   1    180
7    0    34   0   384   0    0     2  6615   162   0     68
8    0     0   0   256   0    0    44   152  2695   0    149
9    0     3   0    96   0   65   180    15   113  20      1
10   0     4   0    13   0    0   166    52   196   0  12365
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.44721192, 'precision': 0.40270963, 'recall': 0.34871978, 'specificity': 0.9393077, 'f1': 0.3222035, 'auroc': 0.76890534}
confusion matrix:
    0     1   2   3   4    5     6    7    8   9     10
0    0     1   0   2   0    0  1160    4    2   1     0
1    0  1156   0  22   0    0   114   71    8   1   127
2    0     1   0   3   0   11   875    2   23   1    99
3    0     0   0   0   0    0     0    0    0   0     0
4    0     0   0   0   0    0    95    0    0   0  1538
5    0     0   0  43   0  268   252    0   23   5     1
6    0     3   0   0   0    0  2214    0    0   0   850
7    0   231   0   5   0    0   291  596   13   1    27
8    0     0   0  12   0   23   792    1  488  20    34
9    0    10   0  27   0   59   940   11   51  27    12
10   0     0   0   0   0    0     3    0    0   0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 13:35:38.088517,epoch time: 0:31:46.748767,used: 1:04:43.937272,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.89142764, 'precision': 0.784973, 'recall': 0.6360521, 'specificity': 0.98781544, 'f1': 0.6627846, 'auroc': 0.9840358}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   171     1   0    24   0   14   143    26    12   25     67
1     0  1164   0    17   0    0     0   129    11    0     11
2     3     0  28     7  24    9    14    40    75   84     28
3     2     0   0  7844   0   33     1   405   152    1      2
4     1     0   2     4  77    6    29    12   104   19    285
5     0     0   0   122   0  345     2     0    14   37      1
6     7     1   0    19   0   12  1672    22    31   11    132
7     0    22   1   382   0    0     1  6679   121    2     55
8     1     0   0   317   4    6    13   161  2651    5    137
9     3     1  12    46   0  180     8    12    47  180      3
10    5     5   0    18   6    2    91    59    97    2  12507
---- Validation: 
scalar performance:
{'acc': 0.89340645, 'precision': 0.77518255, 'recall': 0.6329019, 'specificity': 0.98803526, 'f1': 0.6588993, 'auroc': 0.984194}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   160     0   0    23   0   21   141    20    12   28     78
1     0  1150   0    19   0    0     0   144     5    0     14
2     4     1  25     8  24    8    21    35    78   77     31
3     0     0   0  7868   0   33     1   383   149    3      3
4     4     0   7     4  73    2    43    12   104   11    279
5     1     0   0   120   0  349     4     1    12   33      1
6    13     0   0    28   2    7  1666    24    31    9    128
7     1    13   0   354   1    0     2  6740   110    0     44
8     1     0   0   320   6    8    14   142  2666    4    135
9     7     0   9    50   1  174    11    17    42  178      4
10    3     5   1    15   4    3    96    57    86    1  12525
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47932553, 'precision': 0.5152502, 'recall': 0.41904813, 'specificity': 0.9447761, 'f1': 0.39523306, 'auroc': 0.8244632}
confusion matrix:
    0     1   2   3   4    5     6    7    8    9     10
0   28     1   0   2   0    1  1035    3    2   95     3
1    0  1191   2  25   0    0    83   70    7    9   112
2    3     3  12   4  62   32   456    5   65  109   264
3    0     0   0   0   0    0     0    0    0    0     0
4    0     0   1   0  19    0    21    0    2    1  1589
5    4     0   0  25   0  371    13    0    0  176     3
6    1     3   0   0   2    0  1605    0    0    3  1453
7    7   150   3  13   1    0   280  615   14   49    32
8    1     0   0  32  16   29   235    0  738  211   108
9    6    11  10  29   2  113   276    6   38  626    20
10   0     0   0   0   0    0     0    0    0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 14:07:19.575753,epoch time: 0:31:41.487236,used: 1:36:25.424508,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9079623, 'precision': 0.80283946, 'recall': 0.70951223, 'specificity': 0.9897995, 'f1': 0.7429243, 'auroc': 0.98855186}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   291     0   1     7    0    0    80    19    14    4     67
1     0  1187   0    12    1    0     0   119     2    0     11
2    12     1  98     4   37    1     5    38    42   60     14
3     0     0   0  7743    0   15     1   495   182    0      1
4     7     0  23     3  161    0    16    13    96   12    208
5     5     0   2   110    0  301     1     0     7   93      1
6    18     0   0    10    0    3  1758    22    28    2     66
7     1    26   0   219    1    0     3  6870    81    2     60
8     0     0   3   216    8    1    10   195  2783    3     77
9    31     1  37    44    0   77    11     9    27  253      3
10   18     2   5     6   23    1    82    34   129    3  12491
---- Validation: 
scalar performance:
{'acc': 0.90643305, 'precision': 0.7890065, 'recall': 0.7030418, 'specificity': 0.9896606, 'f1': 0.73451567, 'auroc': 0.98843074}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   274     0    0     8    0    0    95    20    10    6     70
1     0  1195    0    10    0    0     0   116     3    0      8
2    11     1  101     3   35    0     7    36    38   68     12
3     1     0    0  7689    0   17     1   530   195    6      1
4     7     0   33     4  162    2    18    13    82   10    208
5     8     0    2   110    0  290     3     1    14   92      1
6    18     0    0     6    0    0  1762    18    32    5     67
7     2    18    1   227    2    0     3  6877    81    1     53
8     1     0    2   222    8    4     8   173  2791    2     85
9    40     3   41    32    0   96     6     7    30  238      0
10   10     1    2     8   35    2    79    38   112    1  12508
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53109914, 'precision': 0.55650145, 'recall': 0.43006432, 'specificity': 0.95002353, 'f1': 0.43114477, 'auroc': 0.8345472}
confusion matrix:
     0     1   2   3    4    5     6    7    8    9     10
0   110     1   0   4    0    0  1035    2    2   13     3
1     1  1278   0  26    0    0    58   50    4    2    80
2    12     8  64   8  159    5   429    4   79   73   174
3     0     0   0   0    0    0     0    0    0    0     0
4     0     0   1   0  207    0    24    0    3    0  1398
5    42     0   0  74    0  186    54    0    3  230     3
6     8     4   1   0   31    0  2131    0    2    0   890
7    10   220  12   6    0    0   298  569   14    5    30
8     8     0  14  43   24   10   214    0  916   92    49
9    49    26  97  41    3   14   349   14   31  492    21
10    0     1   0   0    7    0     0    0    0    0  1638
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-11 14:39:03.189564,epoch time: 0:31:43.613811,used: 2:08:09.038319,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9143568, 'precision': 0.80326104, 'recall': 0.75202227, 'specificity': 0.9906441, 'f1': 0.77082664, 'auroc': 0.9909379}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   350     0    0     8    1    0    18    21     8    4     73
1     0  1202    0    10    2    0     0   107     5    0      4
2     8     0  143     3   40    1     0    26    23   63      5
3     3     0    0  7691    0   16     0   502   221    4      0
4     7     0   42     2  253    0     4     8    55   10    158
5    10     0    3    87    0  241     0     0    11  168      1
6    69     0    1    11    2    0  1669    27    31    6     90
7     2    23    1   167    2    0     2  6937   107    2     21
8     1     1    6   151   22    0     3   165  2883    6     58
9    17     1   51    25    0   40     1     8    23  326      1
10   24     5    4    11   82    1    21    62   102    3  12480
---- Validation: 
scalar performance:
{'acc': 0.91560787, 'precision': 0.80566996, 'recall': 0.75081164, 'specificity': 0.990776, 'f1': 0.77157545, 'auroc': 0.9910745}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   341     0    1    10    0    0    28    19    15    6     63
1     0  1201    0    10    1    0     0   109     4    0      7
2     8     2  142     2   40    1     1    27    25   59      5
3     1     0    0  7704    0   15     0   481   233    5      1
4     2     0   52     1  239    0     4    15    57   14    155
5     6     0    2    88    0  252     1     0    13  158      1
6    72     0    0    10    5    0  1662    25    36    7     91
7     0    15    0   160    3    1     1  6968    93    0     24
8     1     0    5   166   16    3     4   161  2877    6     57
9    15     1   47    23    0   42     1    10    19  333      2
10   21     9    4     6   70    1    26    58    89    1  12511
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5026237, 'precision': 0.5777955, 'recall': 0.44051245, 'specificity': 0.9482122, 'f1': 0.443036, 'auroc': 0.8395771}
confusion matrix:
     0     1    2   3    4    5     6    7     8    9     10
0   324     1    3   6    0    0   776    3     4   29    24
1     1  1334    0  29    0    0    19   48     7    1    60
2     9    13  108   8  231    0   110    5    97   76   358
3     0     0    0   0    0    0     0    0     0    0     0
4     0     1    2   0  254    0     4    0     1    0  1371
5    31     0    0  63    0  101    30    0     9  352     6
6     7     5    2   0   28    0  1075    0     3    1  1946
7    19   134   28  13    1    0   144  762    24    8    31
8     3     0   25  41   43    3    68    0  1013   84    90
9    31    38  168  43    5    3   149    9    61  578    52
10    0     1    0   0   10    0     0    0     0    0  1635
better model found
persisted
after epoch: 5,now: 2024-08-11 15:10:06.538746,epoch time: 0:31:03.349182,used: 2:39:12.387501,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9249786, 'precision': 0.8209411, 'recall': 0.7748706, 'specificity': 0.9917605, 'f1': 0.7919995, 'auroc': 0.9925742}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     0    1     4    0    0    11    11     4    2     57
1     0  1230    0    17    0    0     1    72     5    0      7
2    14     1  151     3   24    4     1    20    17   70      7
3     4     0    0  8056    0   21     0   237   118    3      0
4     6     0   46     4  219    2     9     8    72   13    159
5    11     0    0    79    0  344     0     0     7   79      1
6    60     0    0    11    0    1  1755     8    17    1     55
7     3    24    1   344    1    0     1  6778    86    3     23
8     2     1    4   252    9    3     6   122  2848    4     44
9    29     2   33    24    0   94     3     4    12  288      3
10   44     0    5     9   45    2    31    33   112    1  12510
---- Validation: 
scalar performance:
{'acc': 0.92443496, 'precision': 0.8222794, 'recall': 0.7706802, 'specificity': 0.9916897, 'f1': 0.79000473, 'auroc': 0.9928159}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     0    0    10    0    0    25    10     6    4     49
1     0  1228    0    13    1    0     0    80     3    0      7
2    16     1  147     3   25    2     1    21    22   69      5
3     1     0    0  8069    0   17     1   230   120    1      1
4     6     0   51     2  209    1     9    12    64   13    172
5     7     0    1    83    0  344     1     0     7   77      1
6    52     0    1    12    2    1  1760    10    19    4     47
7     2    25    2   360    1    0     3  6752    92    2     26
8     3     1    3   260    8    5     4   108  2858    3     43
9    26     1   28    20    0   99     2     5    13  295      4
10   39     6    3    15   36    1    38    39    99    1  12519
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5249423, 'precision': 0.604743, 'recall': 0.4511427, 'specificity': 0.9500687, 'f1': 0.4580183, 'auroc': 0.83137655}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   217     1    1    9    0    0   912    0     2   11    17
1     1  1301    0   35    0    0    28   52     8    1    73
2     5    10  104   14   88    6   194    6   135   52   401
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1    3    0  118    0     6    0     7    0  1498
5    17     0    0  102    0  244    70    0     7  149     3
6     9     4    0    0   11    0  1644    0     4    1  1394
7     6    87   13   65    0    0   262  655    36    5    35
8     1     0   10   60   11    7    91    0  1084   40    66
9    21    36  111   81    2   26   252    2    64  495    47
10    0     1    0    0    4    0     0    0     0    0  1641
better model found
persisted
after epoch: 6,now: 2024-08-11 15:41:18.340547,epoch time: 0:31:11.801801,used: 3:10:24.189302,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9292594, 'precision': 0.8401371, 'recall': 0.7783485, 'specificity': 0.99212277, 'f1': 0.8051084, 'auroc': 0.99346894}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   344     0    0    10    1    0    28    12     6    5     77
1     0  1237    0    17    1    0     1    69     3    0      3
2     4     1  143     1   51    2     2    21    13   67      7
3     0     0    0  7975    0   25     3   336    99    1      0
4     1     0   24     3  277    1     4    12    42   11    164
5     4     0    1    82    0  329     2     0     9   93      1
6    20     1    0    13    1    0  1790     5    18    1     59
7     0    30    4   233    2    0     3  6885    66    2     38
8     3     0    3   236   12    5     6   129  2839    4     58
9    10     1   39    30    0   67     5     6    12  315      8
10   16     7    1    16   60    1    18    27    47    1  12598
---- Validation: 
scalar performance:
{'acc': 0.93080115, 'precision': 0.8440605, 'recall': 0.78705883, 'specificity': 0.99231994, 'f1': 0.81201243, 'auroc': 0.9935834}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   360     0    1     8    1    0    26    11     5    3     68
1     0  1242    0    15    2    0     0    63     5    0      5
2     5     2  154     1   43    0     4    20    17   58      8
3     1     0    0  7987    0   16     0   325   109    2      0
4     4     0   22     0  287    2     4    13    48    8    151
5     0     0    1    76    0  325     2     0     6  110      1
6    23     0    3    11    1    0  1792     8    13    2     55
7     1    26    4   228    1    0     2  6890    75    0     38
8     1     2    4   233   11    2     7   119  2860    2     55
9     8     1   41    22    1   75     6     6     9  318      6
10   18     3    2    22   53    1    25    38    50    1  12583
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51052964, 'precision': 0.60641104, 'recall': 0.43256474, 'specificity': 0.94863725, 'f1': 0.43749306, 'auroc': 0.83252877}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   130     0    2   12    0    0   943    0     3   14    66
1     0  1332    1   36    0    0    29   41     5    1    54
2     1     8   68   15  165    3   134    3   177   35   406
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    1    0  263    0     7    0     7    0  1355
5     4     0    0  115    0  189    71    0    13  183    17
6     3     4    0    0   23    0  1521    0     5    1  1510
7     0    84   10   79    0    0   310  609    37    8    27
8     1     0    5   68   12    5    65    0  1105   32    77
9     3    32  106   91   15   19   236    5    95  448    87
10    0     1    0    0   13    0     0    0     0    0  1632
better model found
persisted
after epoch: 7,now: 2024-08-11 16:13:48.256003,epoch time: 0:32:29.915456,used: 3:42:54.104758,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93431616, 'precision': 0.8330426, 'recall': 0.81695914, 'specificity': 0.9928608, 'f1': 0.82344484, 'auroc': 0.9937053}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   375     0    1     6    1    1    19    11     4    2     63
1     0  1253    0    14    0    0     0    56     5    0      3
2     4     1  222     1   29    2     2     7     5   34      5
3     2     0    0  7848    0   39     1   339   205    2      1
4     2     0   52     1  306    3     3     8    31    9    124
5     5     0    5    47    0  367     0     0     6   90      1
6    17     0    2    12    5    0  1797     7    16    4     48
7     2    41   11   159    5    0     1  6912   100    1     31
8     3     0    4   130   26    5     6    89  2962    3     67
9     9     2   82    17    2   80     3     3     9  285      1
10   21     5    6    18   82    2    10    21    34    1  12594
---- Validation: 
scalar performance:
{'acc': 0.93272704, 'precision': 0.83287644, 'recall': 0.8161779, 'specificity': 0.9926734, 'f1': 0.8226423, 'auroc': 0.9937009}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   380     0    1     5    0    0    15     5     9    1     67
1     0  1252    1    16    2    0     0    49     5    0      7
2     5     0  223     0   23    2     4     8    10   28      9
3     3     0    1  7836    0   30     0   360   205    5      0
4     6     0   57     2  297    1     3     9    23    7    134
5     5     0    2    49    0  359     0     1     6   98      1
6    25     1    3    11    5    0  1783     3    19    4     54
7     1    39    6   169    4    0     3  6896   114    1     32
8     1     2   10   115   19   11     5    92  2978    4     59
9     9     0   78    12    2   81     2     4     8  295      2
10   19     5    8    29   76    3    10    22    52    1  12571
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53361785, 'precision': 0.617913, 'recall': 0.47936046, 'specificity': 0.9517081, 'f1': 0.49569997, 'auroc': 0.8448108}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   305     0    6   22    1    0   682    0     4   48   102
1     0  1331    1   42    0    0    19   42     3    1    60
2     3     2  154   10  227    8    59    3   109   55   385
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  348    0     4    0     3    0  1276
5     3     0    0   62    1  292    17    0     8  198    11
6     6     3    4    0   43    0  1244    0     5    1  1761
7     0    66   32  110    0    0   186  688    32   17    33
8     0     0   25   50   33   10    25    0  1068   55   104
9     4    26  216   70    5   35    75    4    54  571    77
10    0     1    0    0   19    0     0    0     0    0  1626
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-11 16:45:14.404812,epoch time: 0:31:26.148809,used: 4:14:20.253567,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93747324, 'precision': 0.84556806, 'recall': 0.8161579, 'specificity': 0.993051, 'f1': 0.8293774, 'auroc': 0.99512744}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   402     0    0     6    0    0     8     5     2    1     59
1     0  1235    0    17    1    0     0    68     3    0      8
2     4     0  202     1   39    2     2    11     5   42      4
3     5     0    0  8129    0   19     1   160   116    5      1
4     8     0   38     1  303    2     2     5    21    3    155
5     6     0    1    61    0  348     0     0     7   96      1
6    36     0    1    11    3    1  1800     3     4    1     47
7     3    15    4   358    1    0     2  6777    69    4     31
8     5     0    8   196   34    5     1    97  2874    3     73
9    14     0   60    17    3   69     3     3     6  314      4
10   33     0    4     9   44    0    14    17    17    2  12655
---- Validation: 
scalar performance:
{'acc': 0.93564266, 'precision': 0.84378433, 'recall': 0.8092185, 'specificity': 0.99283814, 'f1': 0.8246416, 'auroc': 0.9948183}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     2    1    0     8     6     4    2     50
1     0  1231    1    17    1    0     1    72     1    0      8
2     6     1  188     1   34    1     3    13     5   48     12
3     1     1    0  8091    0   28     0   187   128    4      0
4     7     0   33     2  296    2     2     8    21    7    161
5     3     0    2    69    0  333     0     0     5  108      1
6    30     0    1    11    2    0  1806     2     8    2     46
7     1    12    7   347    1    0     2  6781    78    3     33
8     3     0    7   192   29    5     4   100  2870    1     85
9    15     0   55    19    1   72     1     2     8  315      5
10   31     0    5     9   41    1    10    18    23    0  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48758134, 'precision': 0.600248, 'recall': 0.43829182, 'specificity': 0.9471054, 'f1': 0.46063703, 'auroc': 0.82987964}
confusion matrix:
     0     1    2    3    4    5     6    7    8    9     10
0   462     0    3   15    0    0   516    1    2   24   147
1     1  1301    2   38    0    0    18   51    1    2    85
2     2     2  116    6  210    3    20    3   33   36   584
3     0     0    0    0    0    0     0    0    0    0     0
4     0     0    2    0  174    0     1    0    0    0  1456
5     4     0    0   65    3  210    13    0    7  250    40
6    14     0    1    0   12    0  1019    0    0    1  2020
7     8    35   18  112    0    0   226  687   12   12    54
8     1     0   25   39   68    5    22    2  883   60   265
9     9    14  259   58   10   13    57    8   23  477   209
10    0     0    0    0    6    0     0    0    0    0  1640
better model found
persisted
after epoch: 9,now: 2024-08-11 17:16:19.971504,epoch time: 0:31:05.566692,used: 4:45:25.820259,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9407909, 'precision': 0.84322536, 'recall': 0.82942116, 'specificity': 0.99359906, 'f1': 0.83484554, 'auroc': 0.9953336}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     6    1    0    15     8     7    4     33
1     0  1252    0    12    0    0     0    61     4    0      3
2     6     0  224     0   19    2     3    12     5   38      3
3     2     1    0  8084    0   31     0   211   107    4      0
4     5     1   56     3  311    0     5     7    35    6    110
5     5     0    3    58    0  352     0     0     5   97      1
6    32     0    3    16    2    1  1819     4    12    0     19
7     2    19    5   229    2    0     2  6898    86    3     16
8     3     1   10   176   16    5     2    84  2947    5     44
9    13     0   52    18    0   80     2     4    11  310      3
10   42     1    4    13   73    2    20    22    59    0  12557
---- Validation: 
scalar performance:
{'acc': 0.9411529, 'precision': 0.8433432, 'recall': 0.8319082, 'specificity': 0.99364936, 'f1': 0.8360351, 'auroc': 0.99560344}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     7    0    0    15     6     5    2     39
1     0  1253    0    13    1    0     0    57     4    0      4
2     5     0  218     0   23    2     3    10     8   42      1
3     2     1    0  8064    0   35     0   213   124    1      0
4     7     0   61     0  302    1     4     6    40    7    111
5     6     0    3    48    0  364     0     0     5   94      1
6    37     0    0    10    1    0  1821     5     8    1     25
7     2    17    6   229    1    0     2  6919    72    1     16
8     5     2    5   189   15    9     8    79  2950    7     27
9    13     0   48    13    2   74     2     2     7  329      3
10   46     1    8    12   65    1    17    27    61    2  12556
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59266776, 'precision': 0.63695294, 'recall': 0.50118876, 'specificity': 0.9580484, 'f1': 0.52235305, 'auroc': 0.85161984}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   532     0    2   29    0    1   521    2     1   19    63
1     1  1325    1   46    0    0    17   49     2    1    57
2     3     3  142   13  213    4    58    4   109   45   421
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  264    0     8    0     4    0  1355
5     7     0    0   94    2  231    18    0     6  212    22
6    39     0    2    0    5    0  2092    0     3    1   925
7     5    23   14  229    0    0   180  658    26   14    15
8     2     0   11   66   29    8    33    1  1054   50   116
9    15    21  181   88    9   25    78    9    47  536   128
10    0     0    0    0    9    0     0    0     0    0  1637
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-11 17:47:27.366661,epoch time: 0:31:07.395157,used: 5:16:33.215416,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:16:33.215416 at 2024-08-11 17:47:27.366661
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59266776, 'precision': 0.63695294, 'recall': 0.50118876, 'specificity': 0.9580484, 'f1': 0.52235305, 'auroc': 0.85161984}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   532     0    2   29    0    1   521    2     1   19    63
1     1  1325    1   46    0    0    17   49     2    1    57
2     3     3  142   13  213    4    58    4   109   45   421
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  264    0     8    0     4    0  1355
5     7     0    0   94    2  231    18    0     6  212    22
6    39     0    2    0    5    0  2092    0     3    1   925
7     5    23   14  229    0    0   180  658    26   14    15
8     2     0   11   66   29    8    33    1  1054   50   116
9    15    21  181   88    9   25    78    9    47  536   128
10    0     0    0    0    9    0     0    0     0    0  1637
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.59266776, 'precision': 0.63695294, 'recall': 0.50118876, 'specificity': 0.9580484, 'f1': 0.52235305, 'auroc': 0.85161984}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   532     0    2   29    0    1   521    2     1   19    63
1     1  1325    1   46    0    0    17   49     2    1    57
2     3     3  142   13  213    4    58    4   109   45   421
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  264    0     8    0     4    0  1355
5     7     0    0   94    2  231    18    0     6  212    22
6    39     0    2    0    5    0  2092    0     3    1   925
7     5    23   14  229    0    0   180  658    26   14    15
8     2     0   11   66   29    8    33    1  1054   50   116
9    15    21  181   88    9   25    78    9    47  536   128
10    0     0    0    0    9    0     0    0     0    0  1637
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_12_30_53_seed_0_24142405_instance_wise_predictions.txt
accuracy from prediction file 0.592667739452879
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/11.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494810 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool | 404096 KiB |  10877 MiB | 344198 GiB | 344197 GiB |
|       from small pool |  90714 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 494810 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool | 404096 KiB |  10877 MiB | 344198 GiB | 344197 GiB |
|       from small pool |  90714 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 342301 GiB | 342300 GiB |
|       from small pool |  90258 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11418 MiB |  11418 MiB |  11418 MiB |      0 B   |
|       from large pool |  11290 MiB |  11290 MiB |  11290 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 717605 KiB |   1129 MiB | 107909 GiB | 107908 GiB |
|       from large pool | 707968 KiB |   1126 MiB | 107201 GiB | 107201 GiB |
|       from small pool |   9637 KiB |     11 MiB |    707 GiB |    707 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   27226 K  |   27223 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2922    |    4522    |   15171 K  |   15168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   27226 K  |   27223 K  |
|       from large pool |      87    |     490    |   12054 K  |   12054 K  |
|       from small pool |    2922    |    4522    |   15171 K  |   15168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     293    |     293    |     293    |       0    |
|       from large pool |     229    |     229    |     229    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      46    |    1098    |   14602 K  |   14602 K  |
|       from large pool |      16    |     119    |    7024 K  |    7024 K  |
|       from small pool |      30    |    1081    |    7578 K  |    7578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342301 GiB | 342301 GiB |
|       from small pool |      0 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |  11418 MiB |  11418 MiB |  10234 MiB |
|       from large pool |   1086 MiB |  11290 MiB |  11290 MiB |  10204 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1129 MiB | 107909 GiB | 107909 GiB |
|       from large pool |  59136 KiB |   1126 MiB | 107202 GiB | 107201 GiB |
|       from small pool |      0 KiB |     34 MiB |    707 GiB |    707 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     293    |     293    |     216    |
|       from large pool |      28    |     229    |     229    |     201    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1098    |   14603 K  |   14603 K  |
|       from large pool |       3    |     119    |    7024 K  |    7024 K  |
|       from small pool |       0    |    1081    |    7579 K  |    7579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10949 MiB | 344865 GiB | 344864 GiB |
|       from large pool |  16640 KiB |  10877 MiB | 344198 GiB | 344198 GiB |
|       from small pool |      0 KiB |    127 MiB |    666 GiB |    666 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 342965 GiB | 342965 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 342301 GiB | 342301 GiB |
|       from small pool |      0 KiB |    126 MiB |    664 GiB |    664 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1184 MiB |  11418 MiB |  11418 MiB |  10234 MiB |
|       from large pool |   1086 MiB |  11290 MiB |  11290 MiB |  10204 MiB |
|       from small pool |     98 MiB |    128 MiB |    128 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1129 MiB | 107909 GiB | 107909 GiB |
|       from large pool |  59136 KiB |   1126 MiB | 107202 GiB | 107201 GiB |
|       from small pool |      0 KiB |     34 MiB |    707 GiB |    707 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   27226 K  |   27226 K  |
|       from large pool |       2    |     490    |   12054 K  |   12054 K  |
|       from small pool |       0    |    4522    |   15171 K  |   15171 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     293    |     293    |     216    |
|       from large pool |      28    |     229    |     229    |     201    |
|       from small pool |      49    |      64    |      64    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1098    |   14603 K  |   14603 K  |
|       from large pool |       3    |     119    |    7024 K  |    7024 K  |
|       from small pool |       0    |    1081    |    7579 K  |    7579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405

 Experiment start at: 2024-08-11 18:02:29.436386
before training, model accuracy: 0.06982439011335373
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8032962, 'precision': 0.4184857, 'recall': 0.4136231, 'specificity': 0.97754055, 'f1': 0.41318172, 'auroc': 0.93975294}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    33   0   0  182    44   141   0     83
1    0  1012   0    16   0   0    0   236     5   0     62
2    0     0   0    25   0   0   54    51   165   0     17
3    0     1   0  7770   0   0    0   437   215   0     14
4    0     0   0    13   0   0   72    22   153   0    279
5    0     0   0   367   0   0   12     4   136   0      2
6    0     0   0    52   0   0  924    69   431   0    431
7    0    21   0   924   0   0    8  6012   159   0    141
8    0     0   0   717   0   0  100   220  1945   0    313
9    0     0   0   155   0   0   45    36   256   0      1
10   0     3   0    23   0   0  111    95   200   0  12361
---- Validation: 
scalar performance:
{'acc': 0.80128396, 'precision': 0.4152277, 'recall': 0.41279, 'specificity': 0.97738445, 'f1': 0.41131908, 'auroc': 0.9405941}
confusion matrix:
    0     1   2     3   4   5    6     7     8   9      10
0    0     0   0    33   0   0  188    31   154   0     77
1    0  1030   0    14   0   0    0   223     2   0     63
2    0     0   0    21   0   0   62    44   166   0     19
3    0     0   0  7782   0   0    1   447   194   0     16
4    0     0   0     8   0   0   78    21   146   0    286
5    0     0   0   354   0   0   10     2   153   0      2
6    0     0   0    55   0   0  893    71   463   0    426
7    0    26   0   952   0   0   11  5945   181   0    150
8    0     0   0   698   0   0  123   238  1958   0    279
9    0     0   0   146   0   0   50    34   262   0      1
10   0     2   0    22   0   0  110    94   220   0  12348
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.39592808, 'precision': 0.2497518, 'recall': 0.29214782, 'specificity': 0.9361709, 'f1': 0.24429935, 'auroc': 0.7455644}
confusion matrix:
    0    1   2    3   4   5     6    7    8   9     10
0    0    0   0    3   0   0   886    2  276   0     3
1    0  898   0   16   0   0    48   83  100   0   354
2    0    1   0   14   0   0   539    1  377   0    83
3    0    0   0    0   0   0     0    0    0   0     0
4    0    0   0    0   0   0   116    0    5   0  1512
5    0    0   0  219   0   0    22    0  349   0     2
6    0    0   0    0   0   0  1837    0   73   0  1157
7    0   92   0    8   0   0   114  634  266   0    50
8    0    0   0   14   0   0   667    0  651   0    38
9    0    9   0   68   0   0   264    3  780   0    13
10   0    0   0    0   0   0     7    0    0   0  1639
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 18:34:49.425903,epoch time: 0:32:19.989517,used: 0:32:19.989517,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8534086, 'precision': 0.5490825, 'recall': 0.492458, 'specificity': 0.98366606, 'f1': 0.48916999, 'auroc': 0.9730304}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    20   0   0   332    13    47   6     64
1    0  1131   0    20   0   0     0   149     3   0     29
2    0     0   0    17   0   2   109    55   100   6     23
3    0     0   0  7776   0   3     2   366   280   0     10
4    0     0   0     9   0   0   123    11   136   1    259
5    0     0   0   337   0  81    47     1    37  15      2
6    0     0   0    26   0   2  1542    30   121   0    186
7    0    34   0   559   0   0     6  6392   177   0     95
8    0     0   0   378   0   0    58   134  2587   0    139
9    0     0   0   135   0  36   155    27   114  25      1
10   0     2   0    15   0   0   199    52   164   0  12363
---- Validation: 
scalar performance:
{'acc': 0.85304266, 'precision': 0.6582024, 'recall': 0.49541265, 'specificity': 0.98362803, 'f1': 0.4933607, 'auroc': 0.97329915}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    33   0   4   322    17    48   2     57
1    0  1137   0    18   0   0     0   144     6   0     27
2    0     0   1    14   0   1   117    51   110   1     17
3    0     0   0  7772   0   0     1   371   290   0      6
4    0     0   0     5   0   0   106    16   141   0    271
5    0     0   0   326   0  93    49     2    39  12      0
6    0     2   0    28   0   5  1546    29   112   0    186
7    0    34   0   564   0   0     5  6377   184   0    101
8    0     1   0   360   0   0    51   153  2589   0    142
9    0     0   0   130   0  32   158    24   121  27      1
10   0     2   0    19   0   0   212    53   161   0  12349
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46267402, 'precision': 0.37129307, 'recall': 0.3291442, 'specificity': 0.94170403, 'f1': 0.2968224, 'auroc': 0.7911053}
confusion matrix:
    0     1   2    3   4    5     6    7    8   9     10
0    0     0   0    4   0    1  1130    0   24  10     1
1    0  1121   0   21   0    0   102   36   50   0   169
2    0     2   0   22   0    7   791    1  111  14    67
3    0     0   0    0   0    0     0    0    0   0     0
4    0     0   0    0   0    0   154    0    7   0  1472
5    0     0   0  252   0  105    96    0   58  80     1
6    0     0   0    0   0    0  2719    0    9   0   339
7    0   247   0    7   0    0   411  401   65   0    33
8    0     0   0   47   0    2   722    0  567   9    23
9    0    10   0  119   0   42   611    1  276  65    13
10   0     0   0    0   0    0    11    0    0   0  1635
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 19:05:56.858034,epoch time: 0:31:07.432131,used: 1:03:27.421648,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.88407, 'precision': 0.76878846, 'recall': 0.60700226, 'specificity': 0.98724437, 'f1': 0.6216183, 'auroc': 0.9832736}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   92     0   0    21   0    6   205    23    37   44     55
1    0  1140   0    17   0    0     0   154     5    0     15
2   10     0  10     5   9    2    10    50   101   95     20
3    0     0   0  7699   0   31     2   448   257    2      0
4    2     0   2     3  27    1    40    19   169   22    254
5    3     0   0   155   0  267     2     1    15   77      1
6    1     2   0    14   1   11  1670    26    61    8    113
7    0    18   0   300   0    0     4  6758   147    0     36
8    0     0   0   260   0    4     8   158  2792    4     69
9    8     1   4    63   1   76    17    28    46  249      0
10   5     3   0    11   2    3   119    87   220    4  12339
---- Validation: 
scalar performance:
{'acc': 0.88353616, 'precision': 0.77226067, 'recall': 0.6052466, 'specificity': 0.987166, 'f1': 0.6210917, 'auroc': 0.98275775}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   93     0   0    19   0    5   202    21    34   47     62
1    0  1144   0    17   0    0     1   156     4    0     10
2    8     0  15     4   6    2    17    55    96   91     18
3    0     0   0  7691   0   30     0   463   252    2      2
4    4     1   4     1  20    1    51    24   163   23    247
5    3     0   0   166   0  269     1     0    15   66      1
6    0     1   0    16   0    8  1641    31    70   14    127
7    0    16   0   300   0    0     1  6760   146    1     41
8    0     0   0   260   0    4     8   150  2804    4     66
9    7     0   5    64   0   79    17    28    51  240      2
10  12     3   0    12   1    2   116    84   210    2  12354
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53830546, 'precision': 0.6219136, 'recall': 0.43930233, 'specificity': 0.9512039, 'f1': 0.4009663, 'auroc': 0.8359005}
confusion matrix:
    0     1   2   3   4    5     6    7    8    9     10
0   15     0   0   1   0   11  1048    0   30   62     3
1    0  1222   0  29   0    0    54   54   61    3    76
2    0     7   1  12   1   24   346    2  318  125   179
3    0     0   0   0   0    0     0    0    0    0     0
4    0     1   0   0   1    0    59    0   23    1  1548
5    0     0   0  98   0  344    23    0   22  104     1
6    1     1   0   0   0    0  2437    0   45    4   579
7    0   159   0  14   0    0   283  514  151   20    23
8    0     0   0  48   0   22   157    0  986   94    63
9    1    15   0  57   0  114   171    1  228  533    17
10   0     1   0   0   0    0     3    0    1    0  1641
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-11 19:36:54.361269,epoch time: 0:30:57.503235,used: 1:34:24.924883,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9006582, 'precision': 0.7862892, 'recall': 0.69921744, 'specificity': 0.98886967, 'f1': 0.7320565, 'auroc': 0.987248}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   242     1    2    11    1    2    89    18    17   13     87
1     0  1179    0    19    0    0     0   116     5    0     13
2    12     0  117     4   46    2     4    27    23   69      8
3     0     1    0  7941    0   43     0   275   174    1      2
4     8     0   18     6  167    2     7    13    65   15    238
5     4     0    3   115    0  285     0     0    11  102      1
6    23     1    2    21    1    3  1693    20    28    7    108
7     0    45    2   498    0    1     4  6528   119    1     64
8     0     1    4   309   13    8    11   115  2718    5    111
9    11     1   44    41    1   82     5    14    24  267      3
10   24     6    6    17   27    1    40    50    94    4  12526
---- Validation: 
scalar performance:
{'acc': 0.9022068, 'precision': 0.7887161, 'recall': 0.6960701, 'specificity': 0.9890445, 'f1': 0.72964156, 'auroc': 0.9874263}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   242     0    1    14    1    1    87    17    20   19     81
1     0  1179    0    22    0    0     0   114     8    0      9
2     8     3  111     3   36    1     1    25    38   72     14
3     0     0    0  7971    0   39     0   279   145    3      3
4     9     0   19     6  158    1     9     7    70   17    243
5     4     0    2   119    0  278     0     0     9  108      1
6    26     0    1    20    3    5  1713    19    26    9     86
7     0    56    2   461    1    0     3  6548   122    1     71
8     0     1    3   334   11    3    11   126  2692    3    112
9    12     0   50    38    1   76     4    12    29  269      2
10   20     4    3    12   22    1    50    40    76    0  12568
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50318336, 'precision': 0.5406596, 'recall': 0.4299873, 'specificity': 0.9480522, 'f1': 0.4189597, 'auroc': 0.8420075}
confusion matrix:
     0     1   2   3    4    5     6    7    8    9     10
0   276     0   0   2    0    3   793    0   32   36    28
1     0  1269   0  29    1    0    44   24   47    0    85
2    13     7  39  13  149   17   160    1  199   94   323
3     0     0   0   0    0    0     0    0    0    0     0
4     0     0   1   0  107    0     9    0    8    0  1508
5     4     0   0  72    0  334    30    0   23  127     2
6    14     1   0   0   38    0  1745    0   28    2  1239
7     4   292  15  31    0    0   345  294  127    7    49
8     4     0   3  42   24    9    68    0  985   61   174
9    26    18  78  49   23   70   127    0  201  503    42
10    0     1   0   0    5    0     0    0    0    0  1640
better model found
persisted
after epoch: 4,now: 2024-08-11 20:07:44.206130,epoch time: 0:30:49.844861,used: 2:05:14.769744,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9131796, 'precision': 0.8018207, 'recall': 0.7421553, 'specificity': 0.99043334, 'f1': 0.7639248, 'auroc': 0.99009264}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   294     0    3     7    1    3    62    17    12   13     70
1     0  1223    0    13    1    0     1    85     3    0      6
2     8     1  143     2   21    2     2    17    16   86     14
3     0     5    1  7771    0   35     1   437   182    6      2
4     9     0   48     1  182    2     9    15    68   16    189
5     2     0    2    86    0  323     1     1     7   97      2
6    39     0    2     4    0    6  1736    20    20    4     76
7     2    45    1   242    1    0     3  6823   104    3     37
8     2     1    5   256    9    6    12   124  2795    5     79
9     5     0   38    20    1   93     2     8    18  306      2
10   28    11    6    12   35    2    31    43    88    4  12535
---- Validation: 
scalar performance:
{'acc': 0.91357493, 'precision': 0.8024831, 'recall': 0.7413528, 'specificity': 0.9904837, 'f1': 0.7628898, 'auroc': 0.9903652}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   298     0    1     6    0    1    63    14    17   16     67
1     0  1207    1    18    0    0     2    91     5    0      8
2     9     1  152     2   19    1     1    17    18   85      7
3     1     3    1  7796    0   45     1   430   160    3      0
4    12     0   42     2  169    3     7    13    73   16    202
5     4     0    2    87    0  328     0     2     4   93      1
6    42     1    2     9    2    3  1724    12    30    7     76
7     2    54    2   216    2    0     4  6840   102    4     39
8     3     5    7   235   12    8     9   126  2811    3     77
9     5     0   39    29    1   89     2    11    17  296      4
10   25    14    8    14   24    0    44    47    87    0  12533
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.517596, 'precision': 0.5919397, 'recall': 0.44146127, 'specificity': 0.94953257, 'f1': 0.42764682, 'auroc': 0.84869343}
confusion matrix:
     0     1   2   3    4    5     6    7     8    9     10
0   167     0   0   9    0    5   903    0    32   42    12
1     0  1304   0  31    0    0    36   26    33    0    69
2     1     8  71  17   74   18   155    2   231  107   331
3     0     0   0   0    0    0     0    0     0    0     0
4     0     1   2   0  159    0     5    0     6    0  1460
5     0     0   0  95    0  361    31    0    20   84     1
6    10     1   0   0   15    0  1843    0    18   11  1169
7     1   306  15  40    0    0   321  313   107   16    45
8     0     0   1  63   11    9    78    0  1037   38   133
9     1    23  67  73    1  112   126    0   193  506    35
10    0     1   0   0    8    0     0    0     0    0  1637
better model found
persisted
after epoch: 5,now: 2024-08-11 20:38:44.018298,epoch time: 0:30:59.812168,used: 2:36:14.581912,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92083156, 'precision': 0.8204318, 'recall': 0.76498264, 'specificity': 0.9912385, 'f1': 0.78868574, 'auroc': 0.9919795}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   335     0    0     4    0    1    43     8    14    4     74
1     0  1223    0    10    1    0     0    87     4    1      6
2     8     2  159     0   43    3     1    18    20   52      6
3     0     1    0  7685    0   29     2   476   240    3      1
4     5     0   29     2  227    1     4     8    51    9    203
5     3     0    3    72    0  337     3     1     5   96      1
6    25     0    1     5    1    0  1759    18    17    1     81
7     1    27    3   154    1    0     2  6911   115    0     50
8     1     1    7   150   17    3     7   128  2892    2     86
9    12     1   63    17    2   80     4    10    16  285      3
10   20     1    5     9   44    2    25    27    56    0  12604
---- Validation: 
scalar performance:
{'acc': 0.92189384, 'precision': 0.82153606, 'recall': 0.76684517, 'specificity': 0.9913478, 'f1': 0.7902158, 'auroc': 0.9925145}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   333     0    1     5    0    0    43    14     9    2     76
1     0  1221    0    15    0    0     1    88     3    0      4
2     5     0  163     2   41    0     4    22     9   55     11
3     1     0    0  7681    0   40     0   478   235    3      2
4     9     0   30     0  237    2     4    11    37    8    201
5     4     0    5    75    0  326     1     0    13   95      2
6    24     1    1     4    1    1  1753    20    19    1     83
7     1    33    1   148    2    0     2  6923   109    1     45
8     1     0    6   130   17    4     8   126  2917    1     86
9    13     1   66    14    1   82     2     7    13  290      4
10   15     3    7    11   39    2    23    28    46    1  12621
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50234383, 'precision': 0.5779824, 'recall': 0.42478454, 'specificity': 0.9478202, 'f1': 0.40558398, 'auroc': 0.837197}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   52     0   0    5    0    2  1039    0    37   13    22
1    0  1323   0   34    0    0    25   32    29    0    56
2    0    11  33   16  109   17   151    3   213   41   421
3    0     0   0    0    0    0     0    0     0    0     0
4    0     1   0    0  157    0     4    0     6    0  1465
5    0     0   0  108    0  341    64    0    33   42     4
6    3     1   0    1    8    1  1773    0    15    2  1263
7    0   264   4   46    0    0   214  482   116    2    36
8    0     0   1   47   14    8    76    0  1069    8   147
9    0    28  86   82    7  104   198    5   260  308    59
10   0     1   0    0    3    0     0    0     0    0  1642
better model found
persisted
after epoch: 6,now: 2024-08-11 21:09:42.848596,epoch time: 0:30:58.830298,used: 3:07:13.412210,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92650366, 'precision': 0.83063084, 'recall': 0.77737284, 'specificity': 0.9919016, 'f1': 0.7974997, 'auroc': 0.993505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   351     0    1     6    0    1    30    16     9    3     66
1     0  1234    0    15    0    0     0    74     4    0      5
2     3     0  199     1   23    1     1    17    16   48      3
3     0     0    0  7881    0   27     1   383   144    1      0
4     3     0   59     1  216    2     6    14    62    7    169
5     2     0    3    77    0  353     1     1     7   76      1
6    22     1    2    18    2    1  1767    16    19    3     56
7     0    27    2   187    2    0     1  6938    87    0     19
8     0     1    4   211   11    3     3   135  2872    2     53
9     6     1   84    29    1   93     3     7    14  252      2
10   28     1    9    13   32    3    25    48    70    0  12566
---- Validation: 
scalar performance:
{'acc': 0.9261201, 'precision': 0.82671976, 'recall': 0.77582455, 'specificity': 0.9918835, 'f1': 0.7954618, 'auroc': 0.99334}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   351     0    1     7    0    0    31    14    14    4     61
1     0  1233    1    13    0    0     0    73     6    0      6
2     7     0  194     3   22    2     2    16    19   41      6
3     0     0    0  7878    0   31     0   382   147    2      0
4     5     0   64     0  222    2     1    14    56    9    166
5     1     0    4    82    0  345     2     0     8   78      1
6    32     0    1    15    2    2  1750    15    28    1     62
7     0    19    0   186    1    0     2  6956    86    0     15
8     1     0    6   209   11    2     5   127  2886    1     48
9     9     1   73    28    0   97     2    12    12  257      2
10   27     3   10     9   38    1    22    38    94    3  12551
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.48492268, 'precision': 0.589363, 'recall': 0.41063055, 'specificity': 0.9468205, 'f1': 0.3892565, 'auroc': 0.8416557}
confusion matrix:
    0     1    2    3    4    5     6    7     8    9     10
0   61     0    1   20    0    2   956    0    63   20    47
1    0  1310    0   52    0    0    17   32    29    0    59
2    0    10   56   42   52   22    79    3   386   27   338
3    0     0    0    0    0    0     0    0     0    0     0
4    0     0    0    0  176    0     4    0    11    0  1442
5    0     0    0  203    0  299    33    0    31   24     2
6    3     0    0    2    4    1  1574    0    59    3  1421
7    0   194    2  135    0    0   163  483   164    1    22
8    0     0    1  114    4    3    23    0  1163    1    61
9    0    25  109  201    2  142    96    3   343  172    44
10   0     1    0    0    8    0     0    0     0    0  1637
better model found
persisted
after epoch: 7,now: 2024-08-11 21:40:45.340940,epoch time: 0:31:02.492344,used: 3:38:15.904554,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.93292487, 'precision': 0.8417958, 'recall': 0.7964915, 'specificity': 0.9925928, 'f1': 0.8166746, 'auroc': 0.9941457}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   366     0    0     6    0    0    22    11     8    1     69
1     0  1231    0    15    0    0     0    74     4    0      8
2     5     0  186     2   39    0     4    13    15   41      7
3     1     1    0  7883    0   33     0   340   174    4      3
4     4     1   32     1  269    1     7     9    36    8    171
5     3     0    0    57    0  348     1     0    11  100      1
6    28     0    0     7    2    1  1793    11    14    1     50
7     1    19    6   172    2    0     2  6959    64    2     35
8     4     1    5   144   19    2     7   133  2915    3     61
9     4     0   60    13    2   76     9    10    12  302      5
10   14     2    6     9   43    1    18    24    58    2  12617
---- Validation: 
scalar performance:
{'acc': 0.93280727, 'precision': 0.84802103, 'recall': 0.797392, 'specificity': 0.9925555, 'f1': 0.81960726, 'auroc': 0.99420863}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   365     0    0     9    2    0    31     7     5    1     63
1     0  1224    0    17    0    0     0    78     3    0     10
2     4     0  190     2   37    1     1    14    12   40     11
3     2     0    0  7879    0   33     0   346   178    2      0
4     4     0   28     2  265    1     7     5    46    6    175
5     2     0    3    55    1  352     1     0    11   95      1
6    19     0    0     9    1    0  1803     9    18    2     47
7     1    18    2   184    1    0     1  6943    78    0     37
8     0     1    3   148   18    4    10   132  2906    2     72
9     8     0   67    14    2   65     7     7    15  304      4
10   19     0    4     7   33    1    22    20    47    1  12642
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.507871, 'precision': 0.6008768, 'recall': 0.43514472, 'specificity': 0.94865596, 'f1': 0.4175964, 'auroc': 0.8370351}
confusion matrix:
    0     1   2    3    4    5     6    7     8    9     10
0   62     0   0    6    0    3  1000    1    35   16    47
1    0  1285   0   50    0    0    22   38    34    0    70
2    0     3  40   23   82   18   107    1   310   36   395
3    0     0   0    0    0    0     0    0     0    0     0
4    0     0   0    0  163    0     4    0    10    0  1456
5    0     0   0  108    0  354    56    0    23   48     3
6    2     0   0    1    3    1  1697    0    23    2  1338
7    0    95   4  118    0    0   196  590   112    3    46
8    0     0   1   58    4    7    55    0  1155    5    85
9    0    17  76  104    4  108   164    5   320  271    68
10   0     0   0    0    4    0     0    0     0    0  1642
better model found
persisted
after epoch: 8,now: 2024-08-11 22:11:50.682050,epoch time: 0:31:05.341110,used: 4:09:21.245664,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.93394154, 'precision': 0.83198106, 'recall': 0.81984305, 'specificity': 0.9928203, 'f1': 0.824705, 'auroc': 0.99477285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     0    0     4    1    0    13     7     6    4     55
1     0  1265    0    14    0    0     0    45     4    0      3
2     3     1  205     1   29    2     2    10     5   50      4
3     1     2    0  7995    0   23     1   292   123    2      0
4     6     0   41     4  331    1     1     8    23    8    116
5     3     0    2    67    0  323     1     0     3  121      1
6    32     0    2    10    4    0  1795     7    15    2     41
7     2    67    9   182    4    0     4  6905    60    2     28
8     3     2   11   234   34    4     5   116  2832    1     53
9     4     1   63    17    2   54     2     5     6  338      1
10   26     2    8    15  126    3    13    21    52    1  12525
---- Validation: 
scalar performance:
{'acc': 0.9345727, 'precision': 0.8309314, 'recall': 0.8154023, 'specificity': 0.99289554, 'f1': 0.8218536, 'auroc': 0.99484193}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   391     0    0     7    2    0    13    12     4    5     49
1     0  1267    0    13    0    0     0    44     3    0      5
2     5     3  190     1   37    1     1    12     8   50      4
3     0     0    0  7997    0   25     0   302   113    2      1
4     4     0   36     2  335    1     2     6    28    9    116
5     2     0    1    71    1  316     1     0     6  122      1
6    45     0    0     8    1    0  1779    12    11    4     48
7     0    56    4   179    4    0     2  6929    64    2     25
8     3     1   11   201   34    2     6   131  2856    6     45
9     3     0   60    17    2   56     2     1     9  341      2
10   32     2   11    15  119    0    13    18    48    0  12538
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5300497, 'precision': 0.60275453, 'recall': 0.45311034, 'specificity': 0.95126784, 'f1': 0.45177382, 'auroc': 0.8526695}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   142     0    2   12    0    0   892    1    21   32    68
1     0  1375    0   45    0    0    10   14    10    1    44
2     1    18  113   21  183   16    68    1   224   67   303
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1    1    0  433    0     4    0     9    0  1185
5     0     0    0  111    0  333    39    0    13   91     5
6     3     4    0    1   25    1  1704    0    35    3  1291
7     0   408    6  116    0    0   136  395    68    2    33
8     0     0    5   87   25   10    47    1  1084   17    94
9     1    49  178  120    0   75   108    4   158  394    50
10    0     1    1    0   41    0     0    0     0    0  1603
better model found
persisted
after epoch: 9,now: 2024-08-11 22:42:47.950589,epoch time: 0:30:57.268539,used: 4:40:18.514203,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9403093, 'precision': 0.8511095, 'recall': 0.8175757, 'specificity': 0.9934863, 'f1': 0.82939625, 'auroc': 0.9954623}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     1    0     7    0    0    10     5     6    5     40
1     0  1239    0    14    0    0     0    66     6    0      7
2     2     0  200     0   27    0     1     9     9   60      4
3     2     0    0  8012    0   15     0   279   129    1      1
4     8     0   40     0  263    2     5     6    39   11    165
5     3     0    1    62    0  322     0     0     5  126      1
6    51     0    1    13    1    2  1790     6    13    3     27
7     0    15    4   159    2    0     2  6973    89    3     16
8     5     0    3   156    8    1     4    87  2988    4     40
9     9     0   40    10    2   53     2     4    10  359      3
10   54     2    7    12   35    3    11    26    53    0  12591
---- Validation: 
scalar performance:
{'acc': 0.9392002, 'precision': 0.8569813, 'recall': 0.81609535, 'specificity': 0.9933282, 'f1': 0.83004934, 'auroc': 0.995433}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     5    0    0    15     5     9    1     36
1     0  1238    0    12    0    0     0    72     5    0      5
2     4     0  193     2   17    1     2    12     8   65      8
3     1     0    0  7998    0   20     0   284   133    4      0
4     6     0   41     1  261    3     4     5    42    8    168
5     4     0    2    64    0  317     0     1     5  127      1
6    55     0    1     9    0    1  1774     7    10    3     48
7     0    12    1   175    2    0     0  6967    84    6     18
8     5     0    7   162    8    2     8    88  2970    4     42
9     7     0   32    19    1   46     2     4     7  375      0
10   48     1    2    10   27    2    13    31    52    3  12607
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5159169, 'precision': 0.60646087, 'recall': 0.44931403, 'specificity': 0.95020527, 'f1': 0.44523373, 'auroc': 0.8446134}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   276     0   1   15    0    0   685    1    46   29   117
1     0  1300   1   47    0    0    15   32    49    0    55
2     2     3  66   21   81   15    24    1   354   61   387
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   1    0  136    0     3    0    13    0  1479
5     0     0   0  126    0  317    28    0    23   91     7
6     2     0   0    1    7    1  1539    0    68    3  1446
7     0    95   6  197    0    0   127  535   177    2    25
8     0     0   1   72    3    4    13    0  1189    8    80
9     2    14  99  117    1   81    73    5   305  373    67
10    0     0   0    0    3    0     0    0     0    0  1643
better model found
persisted
after epoch: 10,now: 2024-08-11 23:13:54.417950,epoch time: 0:31:06.467361,used: 5:11:24.981564,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 5:11:24.981564 at 2024-08-11 23:13:54.417950
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5159169, 'precision': 0.60646087, 'recall': 0.44931403, 'specificity': 0.95020527, 'f1': 0.44523373, 'auroc': 0.8446134}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   276     0   1   15    0    0   685    1    46   29   117
1     0  1300   1   47    0    0    15   32    49    0    55
2     2     3  66   21   81   15    24    1   354   61   387
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   1    0  136    0     3    0    13    0  1479
5     0     0   0  126    0  317    28    0    23   91     7
6     2     0   0    1    7    1  1539    0    68    3  1446
7     0    95   6  197    0    0   127  535   177    2    25
8     0     0   1   72    3    4    13    0  1189    8    80
9     2    14  99  117    1   81    73    5   305  373    67
10    0     0   0    0    3    0     0    0     0    0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53830546, 'precision': 0.6219136, 'recall': 0.43930233, 'specificity': 0.9512039, 'f1': 0.4009663, 'auroc': 0.8359005}
confusion matrix:
    0     1   2   3   4    5     6    7    8    9     10
0   15     0   0   1   0   11  1048    0   30   62     3
1    0  1222   0  29   0    0    54   54   61    3    76
2    0     7   1  12   1   24   346    2  318  125   179
3    0     0   0   0   0    0     0    0    0    0     0
4    0     1   0   0   1    0    59    0   23    1  1548
5    0     0   0  98   0  344    23    0   22  104     1
6    1     1   0   0   0    0  2437    0   45    4   579
7    0   159   0  14   0    0   283  514  151   20    23
8    0     0   0  48   0   22   157    0  986   94    63
9    1    15   0  57   0  114   171    1  228  533    17
10   0     1   0   0   0    0     3    0    1    0  1641
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_11_18_02_29_seed_1_24142405_instance_wise_predictions.txt
accuracy from prediction file 0.5159168823899811
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496602 KiB |  10950 MiB | 689803 GiB | 689802 GiB |
|       from large pool | 405888 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 496602 KiB |  10950 MiB | 689803 GiB | 689802 GiB |
|       from large pool | 405888 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |  90714 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |  10882 MiB | 685930 GiB | 685930 GiB |
|       from large pool | 387840 KiB |  10810 MiB | 684602 GiB | 684602 GiB |
|       from small pool |  90258 KiB |    126 MiB |   1328 GiB |   1328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11544 MiB |  11544 MiB |  21778 MiB |  10234 MiB |
|       from large pool |  11416 MiB |  11416 MiB |  21620 MiB |  10204 MiB |
|       from small pool |    128 MiB |    128 MiB |    158 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1285 MiB |   1530 MiB | 226546 GiB | 226545 GiB |
|       from large pool |   1275 MiB |   1527 MiB | 225131 GiB | 225130 GiB |
|       from small pool |      9 MiB |     34 MiB |   1414 GiB |   1414 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   54451 K  |   54448 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    2922    |    4522    |   30341 K  |   30338 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   54451 K  |   54448 K  |
|       from large pool |      87    |     490    |   24109 K  |   24109 K  |
|       from small pool |    2922    |    4522    |   30341 K  |   30338 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     300    |     300    |     516    |     216    |
|       from large pool |     236    |     236    |     437    |     201    |
|       from small pool |      64    |      64    |      79    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      67    |    1102    |   29641 K  |   29641 K  |
|       from large pool |      31    |     135    |   14493 K  |   14493 K  |
|       from small pool |      36    |    1081    |   15147 K  |   15147 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10950 MiB | 689803 GiB | 689803 GiB |
|       from large pool |  16640 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |      0 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10950 MiB | 689803 GiB | 689803 GiB |
|       from large pool |  16640 KiB |  10878 MiB | 688469 GiB | 688469 GiB |
|       from small pool |      0 KiB |    127 MiB |   1333 GiB |   1333 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10882 MiB | 685930 GiB | 685930 GiB |
|       from large pool |  16640 KiB |  10810 MiB | 684602 GiB | 684602 GiB |
|       from small pool |      0 KiB |    126 MiB |   1328 GiB |   1328 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1770 MiB |  11544 MiB |  21778 MiB |  20008 MiB |
|       from large pool |   1672 MiB |  11416 MiB |  21620 MiB |  19948 MiB |
|       from small pool |     98 MiB |    128 MiB |    158 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59136 KiB |   1530 MiB | 226546 GiB | 226546 GiB |
|       from large pool |  59136 KiB |   1527 MiB | 225131 GiB | 225131 GiB |
|       from small pool |      0 KiB |     34 MiB |   1414 GiB |   1414 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   54451 K  |   54451 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    4522    |   30341 K  |   30341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   54451 K  |   54451 K  |
|       from large pool |       2    |     490    |   24109 K  |   24109 K  |
|       from small pool |       0    |    4522    |   30341 K  |   30341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     300    |     516    |     432    |
|       from large pool |      35    |     236    |     437    |     402    |
|       from small pool |      49    |      64    |      79    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1102    |   29641 K  |   29641 K  |
|       from large pool |       3    |     135    |   14493 K  |   14493 K  |
|       from small pool |       0    |    1081    |   15147 K  |   15147 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 23:20:15 2024]
Finished job 0.
1 of 1 steps (100%) done
