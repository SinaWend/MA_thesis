Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 12:20:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142408

 Experiment start at: 2024-08-11 12:30:39.554948
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.07954943180084229
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7917915, 'precision': 0.45595628, 'recall': 0.41430068, 'specificity': 0.9760709, 'f1': 0.4227562, 'auroc': 0.9259811}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0    0    0   0    71   0   0   223    65    19   39     66
1    0  788   0    21   0   0     1   492     0    1     29
2    0    3   0    49   0   0   129    62    28   24     17
3    0    0   0  7723   1   0     5   642    52    4     10
4    0    1   0    36   0   0   139    48    49    8    258
5    0    0   0   399   0   0    17     4     4   94      3
6    0    4   0   191   1   0  1171   120    97   27    297
7    0    3   0   776   0   0    10  6340    54    0     77
8    0    0   0   949   1   0   124   532  1253   14    423
9    0    0   0   213   0   0   104    41    20  113      2
10   0    2   0    74   0   0   185   211   116    1  12206
---- Validation: 
scalar performance:
{'acc': 0.79448974, 'precision': 0.48300427, 'recall': 0.41766322, 'specificity': 0.97633886, 'f1': 0.42655534, 'auroc': 0.92478245}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0    0    0   0    74   1   0   220    55    26   37     70
1    0  798   0    24   0   0     4   481     1    0     24
2    0    0   0    43   0   0   141    77    17   16     18
3    0    1   0  7744   0   0     5   624    52    0     14
4    0    0   0    25   1   0   138    59    59    4    253
5    0    0   0   396   0   0    18     9     3   93      2
6    0    3   0   184   0   0  1200   123    84   25    289
7    0    5   0   755   1   0    11  6360    60    1     72
8    0    0   0   909   0   0   115   525  1254   18    475
9    0    1   0   217   1   0    99    45    12  116      2
10   0    0   0    59   0   0   170   226   107    5  12229
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.34555376, 'precision': 0.2411721, 'recall': 0.28384653, 'specificity': 0.931814, 'f1': 0.22646677, 'auroc': 0.7129803}
confusion matrix:
    0    1   2    3   4   5     6    7    8    9     10
0    0    0   0   18   0   0   881   40   26  200     5
1    0  477   0   12   0   0    48  781   11    5   165
2    0    0   0   46   0   0   360  202  181   95   131
3    0    0   0    0   0   0     0    0    0    0     0
4    0    1   0    1   0   0   101   27   17    3  1483
5    0    0   0  216   0   0    27    5   52  287     5
6    0    1   0    7   0   0  1040  251  265    9  1494
7    0   31   0    4   0   0   155  932   24    6    12
8    0    0   0   36   0   0   459   31  545  150   149
9    0    5   0  182   0   2   278  181  164  312    13
10   0    0   0    0   0   0     9    3    1    0  1633
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 13:06:59.736936,epoch time: 0:36:20.181988,used: 0:36:20.181988,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8618365, 'precision': 0.6879132, 'recall': 0.5421411, 'specificity': 0.98489493, 'f1': 0.5408665, 'auroc': 0.9684413}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0   16     0   0    24   0   56   229    28    53   35     42
1    0  1137   0    16   0    0     0   160     7    0     12
2    0     4   0    15   2   17   101    60    64   36     13
3    0     0   0  7795   0    7     2   465   166    0      2
4    0     0   0     6   6    5   110    33   131   12    236
5    0     0   0   215   0  237     4     0    24   39      1
6    0     4   0    39   0   14  1601    36   113   20     80
7    0    27   0   438   0    0     7  6637   128    0     27
8    0     1   0   378   0    7    21   264  2559    5     61
9    0     0   0    98   0  169    49    34    40  103      0
10   0     7   0    15   1    0   208   118   319    4  12121
---- Validation: 
scalar performance:
{'acc': 0.86130804, 'precision': 0.6567997, 'recall': 0.5417532, 'specificity': 0.98480916, 'f1': 0.54111713, 'auroc': 0.96891373}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    9     0   0    37   0   50   224    24    59   30     50
1    0  1128   0    14   0    0     0   175     5    0     10
2    0     0   0    13   2   13   108    62    62   41     11
3    0     1   0  7754   0   13     0   485   185    0      2
4    0     1   0     4   4    8   108    29   132   11    242
5    0     0   0   222   0  231     4     1    23   39      1
6    1     4   0    49   0   15  1582    44   110   15     88
7    0    21   0   415   0    0     3  6683   112    1     30
8    0     1   0   374   1    5    21   283  2549    4     58
9    0     0   0    86   2  163    45    28    44  125      0
10   1     9   0    17   0    4   194   112   323    1  12135
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5133982, 'precision': 0.5598911, 'recall': 0.39339298, 'specificity': 0.94859004, 'f1': 0.34955773, 'auroc': 0.7874431}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0    1     0   0   18   0   9  1020   12    60   48     2
1    0  1118   0   22   0   0    50  207    22    2    78
2    0     1   0   34   0   2   417   61   415   30    55
3    0     0   0    0   0   0     0    0     0    0     0
4    0     4   0    0   2   0   157    0    41    0  1429
5    0     0   0  260   0  99    30    0    50  151     2
6    0     1   0    0   0   0  2434   14   195    0   423
7    0    93   0    6   0   0   257  749    54    0     5
8    0     0   0   23   0   9   192    0  1102   32    12
9    0    13   0  167   0  23   312   50   359  210     3
10   0     0   0    0   0   0    22    1     0    0  1623
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 13:42:29.411066,epoch time: 0:35:29.674130,used: 1:11:49.856118,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.67875105, 'precision': 0.53683764, 'recall': 0.2944597, 'specificity': 0.9623873, 'f1': 0.30528945, 'auroc': 0.8664201}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    2    0   0   282   0   1   18    76   16   5     83
1    0  365   0    46   0   0    1   900    0   0     19
2    0    0   0   166   3   1    4   109    2   0     27
3    0    0   0  8238   0   0    0   190    3   0      5
4    1    0   0   118   4   0    9   131   37   2    237
5    0    0   0   505   0   4    0     2    0   9      1
6    1    1   0   438   5   0  517   334   54  15    543
7    0    0   0  2201   0   0    1  5022    4   0     36
8    0    0   0  2195   0   1    1   433  447   0    219
9    0    0   0   447   0   1    0    27    1  15      2
10   0    6   0   347   6   0   36  1209  434   0  10755
---- Validation: 
scalar performance:
{'acc': 0.67834693, 'precision': 0.47440085, 'recall': 0.29345155, 'specificity': 0.96234095, 'f1': 0.30353123, 'auroc': 0.8670282}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9      10
0    0    0   0   298   0   0   13    76   18   4     74
1    0  370   0    50   1   0    0   884    0   0     27
2    0    0   0   166   2   0    7   102    5   4     26
3    0    0   0  8238   0   0    0   193    2   0      7
4    1    0   0   126   4   0   12   138   23   3    232
5    0    0   0   503   0   3    1     2    1   8      3
6    1    1   0   471   2   0  508   320   54  18    533
7    0    0   0  2215   0   0    1  5009    5   0     35
8    1    0   0  2234   1   0    2   397  446   0    215
9    0    0   0   434   0   4    2    35    0  14      4
10   1    2   0   344   5   2   49  1208  415   2  10768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.22563493, 'precision': 0.22451948, 'recall': 0.2053015, 'specificity': 0.92174584, 'f1': 0.1277108, 'auroc': 0.65763164}
confusion matrix:
    0    1   2    3   4   5   6    7    8   9     10
0    0    0   0   39   1   0  15  100  215   2   798
1    0  198   0    5   0   0   5  675    3   0   613
2    0    0   0   70   0   0   1  119  180   2   643
3    0    0   0    0   0   0   0    0    0   0     0
4    0    0   0    0   0   0   0    0    1   0  1632
5    0    0   0  460   0   0   0   23   91   0    18
6    0    0   0    5   0   0   5   36   71   3  2947
7    0    0   0    2   0   0   0  926    3   0   233
8    0    0   0   99   0   0   0   82  446   0   743
9    0    0   0  309   0   0   1  404  246   4   173
10   0    0   0    0   0   0   0    0    0   0  1646
early stop counter: 1
val acc:0.6783469319343567, best validation acc: 0.8613080382347107, corresponding to test acc:                         0.5133981704711914 / 0.5133981704711914
after epoch: 3,now: 2024-08-11 14:17:53.779079,epoch time: 0:35:24.368013,used: 1:47:14.224131,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.52991223, 'precision': 0.26160443, 'recall': 0.18742612, 'specificity': 0.94472814, 'f1': 0.16048507, 'auroc': 0.7557172}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   343   0   0   0    69   1   0    70
1    0   0   0   148   0   0   0  1143   0   0    40
2    0   0   0   240   0   0   0    52   0   0    20
3    0   0   0  8153   3   0   0   264   0   0    16
4    0   0   0   239   0   0   0   122   1   0   177
5    0   0   0   517   0   0   0     3   0   0     1
6    0   0   0   841   0   0  23   513   1   0   530
7    0   0   0  4296   0   0   0  2873   0   0    96
8    0   0   0  2641   0   0   0   352  14   0   289
9    0   0   0   475   0   0   0    15   0   0     3
10   0   2   0  1722   0   0   1  2286  38   0  8743
---- Validation: 
scalar performance:
{'acc': 0.53203154, 'precision': 0.23620489, 'recall': 0.18758294, 'specificity': 0.94499147, 'f1': 0.15988868, 'auroc': 0.7582254}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   333   0   0   0    65   1   0    84
1    0   0   0   148   0   0   0  1142   0   0    42
2    0   0   0   235   0   0   0    51   0   0    26
3    0   0   0  8148   5   0   0   275   0   0    12
4    0   0   0   229   0   0   0   118   0   0   192
5    0   0   0   515   0   0   0     2   0   0     4
6    1   0   0   835   0   0  11   538   6   0   517
7    0   1   0  4268   1   0   0  2919   0   0    76
8    0   0   0  2662   0   0   0   345   8   0   281
9    0   0   0   470   0   0   0    18   0   0     5
10   0   2   0  1625   0   0   3  2321  41   0  8804
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.13034353, 'precision': 0.14911047, 'recall': 0.12526505, 'specificity': 0.9158838, 'f1': 0.06643283, 'auroc': 0.5568269}
confusion matrix:
    0   1   2    3   4   5   6     7   8   9    10
0    0   0   0  526   0   0   0   600   0   0   44
1    0   0   0   46   0   0   0  1441   0   0   12
2    0   0   0  273   0   0   0   709   0   0   33
3    0   0   0    0   0   0   0     0   0   0    0
4    0   0   0  181   0   0   0   888   1   0  563
5    0   0   0  526   0   0   0    65   0   0    1
6    0   1   0  701   0   0   7  2283   0   0   75
7    0   0   0  176   0   0   0   986   0   0    2
8    0   0   0  631   0   0   0   697   0   0   42
9    0   0   0  615   0   0   0   517   0   0    5
10   0   1   0  153   0   0   0   619   3   0  870
early stop counter: 2
val acc:0.5320315361022949, best validation acc: 0.8613080382347107, corresponding to test acc:                         0.5133981704711914 / 0.5133981704711914
after epoch: 4,now: 2024-08-11 14:53:04.025306,epoch time: 0:35:10.246227,used: 2:22:24.470358,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.40555435, 'precision': 0.101793304, 'recall': 0.13413033, 'specificity': 0.92597234, 'f1': 0.11543786, 'auroc': 0.61552805}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   145   0   0   0    80   0   0   258
1    0   0   0   105   0   0   0   875   0   0   352
2    0   0   0   120   0   0   0    80   0   0   112
3    0   0   0  4153   0   0   0  1583   0   0  2701
4    0   0   0   105   0   0   0    97   0   0   337
5    0   0   0   229   0   0   0    58   0   0   234
6    0   0   0   289   0   0   0   461   0   0  1158
7    0   0   0  3438   0   0   0  2066   0   0  1759
8    0   0   0   982   0   0   0   550   0   0  1763
9    0   0   0   221   0   0   0    69   0   0   203
10   0   0   0  1927   0   0   0  1923   4   0  8939
---- Validation: 
scalar performance:
{'acc': 0.41061923, 'precision': 0.114736035, 'recall': 0.13614345, 'specificity': 0.9266394, 'f1': 0.11727123, 'auroc': 0.61139846}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   151   0   0   0    61   0   0   271
1    0   0   0   117   0   0   0   904   0   0   311
2    0   0   0   112   0   0   0    92   0   0   108
3    0   0   0  4234   0   0   0  1560   0   0  2646
4    0   0   0   118   0   0   0   102   0   0   319
5    0   0   0   238   0   0   0    47   0   0   236
6    0   0   0   303   0   0   0   480   0   0  1125
7    0   0   0  3389   0   0   0  2133   0   0  1743
8    0   0   0   997   0   0   0   505   1   0  1793
9    0   0   0   194   0   0   0   100   0   0   199
10   0   1   0  1880   0   0   0  1925   7   0  8983
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.05911985, 'precision': 0.01213106, 'recall': 0.04726424, 'specificity': 0.9074189, 'f1': 0.016731787, 'auroc': 0.47645068}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9     10
0    0   0   0   227   0   0   0   21   0   0   922
1    0   0   0    64   0   0   0  253   0   0  1182
2    0   0   0   412   0   0   0   13   0   0   590
3    0   0   0     0   0   0   0    0   0   0     0
4    0   0   0   577   0   0   0   50   0   0  1006
5    0   0   0   211   0   0   0    4   0   0   377
6    0   0   0  1442   0   0   0  107   0   0  1518
7    0   0   0    71   0   0   0   26   0   0  1067
8    0   0   0   466   0   0   0   13   0   0   891
9    0   0   0   571   0   0   0   14   0   0   552
10   0   0   0   704   0   0   0  123   0   0   819
early stop counter: 3
val acc:0.41061922907829285, best validation acc: 0.8613080382347107, corresponding to test acc:                         0.5133981704711914 / 0.5133981704711914
after epoch: 5,now: 2024-08-11 15:28:09.797859,epoch time: 0:35:05.772553,used: 2:57:30.242911,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:57:30.242911 at 2024-08-11 15:28:09.797859
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5133982, 'precision': 0.5598911, 'recall': 0.39339298, 'specificity': 0.94859004, 'f1': 0.34955773, 'auroc': 0.7874431}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0    1     0   0   18   0   9  1020   12    60   48     2
1    0  1118   0   22   0   0    50  207    22    2    78
2    0     1   0   34   0   2   417   61   415   30    55
3    0     0   0    0   0   0     0    0     0    0     0
4    0     4   0    0   2   0   157    0    41    0  1429
5    0     0   0  260   0  99    30    0    50  151     2
6    0     1   0    0   0   0  2434   14   195    0   423
7    0    93   0    6   0   0   257  749    54    0     5
8    0     0   0   23   0   9   192    0  1102   32    12
9    0    13   0  167   0  23   312   50   359  210     3
10   0     0   0    0   0   0    22    1     0    0  1623
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5133982, 'precision': 0.5598911, 'recall': 0.39339298, 'specificity': 0.94859004, 'f1': 0.34955773, 'auroc': 0.7874431}
confusion matrix:
    0     1   2    3   4   5     6    7     8    9     10
0    1     0   0   18   0   9  1020   12    60   48     2
1    0  1118   0   22   0   0    50  207    22    2    78
2    0     1   0   34   0   2   417   61   415   30    55
3    0     0   0    0   0   0     0    0     0    0     0
4    0     4   0    0   2   0   157    0    41    0  1429
5    0     0   0  260   0  99    30    0    50  151     2
6    0     1   0    0   0   0  2434   14   195    0   423
7    0    93   0    6   0   0   257  749    54    0     5
8    0     0   0   23   0   9   192    0  1102   32    12
9    0    13   0  167   0  23   312   50   359  210     3
10   0     0   0    0   0   0    22    1     0    0  1623
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_12_30_38_seed_0_24142408_instance_wise_predictions.txt
accuracy from prediction file 0.5133981669348632
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/4.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1698 MiB |  13312 MiB | 305640 GiB | 305639 GiB |
|       from large pool |   1505 MiB |  13157 MiB | 304859 GiB | 304858 GiB |
|       from small pool |    193 MiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1698 MiB |  13312 MiB | 305640 GiB | 305639 GiB |
|       from large pool |   1505 MiB |  13157 MiB | 304859 GiB | 304858 GiB |
|       from small pool |    193 MiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  13266 MiB | 304781 GiB | 304779 GiB |
|       from large pool |   1476 MiB |  13110 MiB | 304001 GiB | 304000 GiB |
|       from small pool |    192 MiB |    273 MiB |    779 GiB |    779 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  13614 MiB |  13614 MiB |  13614 MiB |      0 B   |
|       from large pool |  13338 MiB |  13338 MiB |  13338 MiB |      0 B   |
|       from small pool |    276 MiB |    276 MiB |    276 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1653 MiB |   1725 MiB | 179559 GiB | 179558 GiB |
|       from large pool |   1644 MiB |   1721 MiB | 178715 GiB | 178714 GiB |
|       from small pool |      8 MiB |     23 MiB |    843 GiB |    843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   22029 K  |   22025 K  |
|       from large pool |     182    |     489    |    9083 K  |    9083 K  |
|       from small pool |    4194    |    6508    |   12946 K  |   12942 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   22029 K  |   22025 K  |
|       from large pool |     182    |     489    |    9083 K  |    9083 K  |
|       from small pool |    4194    |    6508    |   12946 K  |   12942 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     293    |     293    |     293    |       0    |
|       from large pool |     155    |     155    |     155    |       0    |
|       from small pool |     138    |     138    |     138    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    1125    |    9445 K  |    9444 K  |
|       from large pool |      30    |      76    |    4468 K  |    4468 K  |
|       from small pool |      24    |    1095    |    4976 K  |    4976 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13312 MiB | 305640 GiB | 305640 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 304859 GiB | 304859 GiB |
|       from small pool |      0 KiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13312 MiB | 305640 GiB | 305640 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 304859 GiB | 304859 GiB |
|       from small pool |      0 KiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13266 MiB | 304781 GiB | 304781 GiB |
|       from large pool |  16640 KiB |  13110 MiB | 304001 GiB | 304001 GiB |
|       from small pool |      0 KiB |    273 MiB |    779 GiB |    779 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3352 MiB |  13614 MiB |  13614 MiB |  10262 MiB |
|       from large pool |   3150 MiB |  13338 MiB |  13338 MiB |  10188 MiB |
|       from small pool |    202 MiB |    276 MiB |    276 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   1964 MiB | 179560 GiB | 179560 GiB |
|       from large pool | 405248 KiB |   1941 MiB | 178716 GiB | 178716 GiB |
|       from small pool |      0 KiB |     40 MiB |    844 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   22029 K  |   22029 K  |
|       from large pool |       2    |     489    |    9083 K  |    9083 K  |
|       from small pool |       0    |    6508    |   12946 K  |   12946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   22029 K  |   22029 K  |
|       from large pool |       2    |     489    |    9083 K  |    9083 K  |
|       from small pool |       0    |    6508    |   12946 K  |   12946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     159    |     293    |     293    |     134    |
|       from large pool |      58    |     155    |     155    |      97    |
|       from small pool |     101    |     138    |     138    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1125    |    9446 K  |    9446 K  |
|       from large pool |       4    |      76    |    4468 K  |    4468 K  |
|       from small pool |       0    |    1095    |    4977 K  |    4977 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13312 MiB | 305640 GiB | 305640 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 304859 GiB | 304859 GiB |
|       from small pool |      0 KiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13312 MiB | 305640 GiB | 305640 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 304859 GiB | 304859 GiB |
|       from small pool |      0 KiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13266 MiB | 304781 GiB | 304781 GiB |
|       from large pool |  16640 KiB |  13110 MiB | 304001 GiB | 304001 GiB |
|       from small pool |      0 KiB |    273 MiB |    779 GiB |    779 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3352 MiB |  13614 MiB |  13614 MiB |  10262 MiB |
|       from large pool |   3150 MiB |  13338 MiB |  13338 MiB |  10188 MiB |
|       from small pool |    202 MiB |    276 MiB |    276 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   1964 MiB | 179560 GiB | 179560 GiB |
|       from large pool | 405248 KiB |   1941 MiB | 178716 GiB | 178716 GiB |
|       from small pool |      0 KiB |     40 MiB |    844 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   22029 K  |   22029 K  |
|       from large pool |       2    |     489    |    9083 K  |    9083 K  |
|       from small pool |       0    |    6508    |   12946 K  |   12946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   22029 K  |   22029 K  |
|       from large pool |       2    |     489    |    9083 K  |    9083 K  |
|       from small pool |       0    |    6508    |   12946 K  |   12946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     159    |     293    |     293    |     134    |
|       from large pool |      58    |     155    |     155    |      97    |
|       from small pool |     101    |     138    |     138    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1125    |    9446 K  |    9446 K  |
|       from large pool |       4    |      76    |    4468 K  |    4468 K  |
|       from small pool |       0    |    1095    |    4977 K  |    4977 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_42_46_seed_1_24142408

 Experiment start at: 2024-08-11 15:42:47.542607
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.06254810094833374
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7899722, 'precision': 0.43687972, 'recall': 0.4020313, 'specificity': 0.9753811, 'f1': 0.40130296, 'auroc': 0.93037814}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    0   0    32   0   0   228    32    80   0    111
1    0  987   0    36   0   0     1   236     0   0     72
2    0    3   0    30   0   0    82    39    96   0     62
3    0    8   0  7715   0   0     4   527   144   0     40
4    0    2   0    14   0   0    90    17    58   0    358
5    0    2   0   407   0   1    21     1    87   0      2
6    0    7   0    67   0   0  1075    54   134   0    571
7    0   56   0   931   0   0    10  5976   111   0    180
8    0    8   0   828   0   0   180   310  1342   0    628
9    0    1   0   200   0   2    89    26   160   0     15
10   0   19   0    36   0   0   159    70    76   0  12430
---- Validation: 
scalar performance:
{'acc': 0.7938478, 'precision': 0.45590532, 'recall': 0.40492252, 'specificity': 0.9758511, 'f1': 0.40467495, 'auroc': 0.9276994}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    2   0    31   0   1   206    34    89   0    120
1    0  987   0    44   0   0     1   232     4   0     64
2    0    2   0    33   0   0    75    44   100   0     58
3    0    6   0  7708   0   0    13   569   118   0     26
4    0    1   0    15   0   0    92    21    66   0    344
5    0    0   0   409   0   1    31     0    78   0      2
6    0    9   0    64   0   0  1082    50   131   0    572
7    0   44   0   874   0   0     8  6053   103   0    183
8    0    3   0   813   0   0   177   306  1401   0    596
9    0    1   0   199   0   0   109    21   152   0     11
10   0   16   0    29   0   0   152    67    86   0  12446
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2797873, 'precision': 0.21182314, 'recall': 0.23674767, 'specificity': 0.925699, 'f1': 0.19640775, 'auroc': 0.6884962}
confusion matrix:
    0    1   2    3   4   5    6    7    8   9     10
0    0    1   0   43   0   2  879   10  188   0    47
1    0  863   0   41   0   0   27  151   41   0   376
2    0    2   0   87   0   2  165   20  197   0   542
3    0    0   0    0   0   0    0    0    0   0     0
4    0    0   0    0   0   0   20    0    2   0  1611
5    0    0   0  445   0   0   12    1  128   0     6
6    0    2   0    0   0   4  358    1   33   0  2669
7    0   74   0   45   0   0  131  660  141   0   113
8    0    0   0  151   0   3  378    8  474   0   356
9    0    9   0  398   0   1  101   39  432   0   157
10   0    0   0    0   0   0    2    0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 16:19:09.904103,epoch time: 0:36:22.361496,used: 0:36:22.361496,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_42_46_seed_1_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.85867935, 'precision': 0.62729394, 'recall': 0.49377733, 'specificity': 0.984094, 'f1': 0.4894576, 'auroc': 0.96984434}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    1     0   1    23   0   3   288    21    43  19     84
1    0  1141   0    29   0   0     0   139     9   0     14
2    0     2   1    17   0   2    99    40    81   5     65
3    0     3   0  7839   0   0     5   403   183   0      4
4    1     0   0     3   0   0    89    23    91   1    331
5    0     0   0   331   0  35    58     1    61  34      1
6    0     5   0    32   0   0  1587    26    83   1    173
7    0    54   0   508   0   0     4  6483   137   0     78
8    0     1   0   353   0   0    46   174  2565   0    155
9    0     1   1   110   0  13   170    20   117  50     11
10   0    13   0    30   0   0   181    57   121   0  12392
---- Validation: 
scalar performance:
{'acc': 0.8589006, 'precision': 0.5866989, 'recall': 0.4909938, 'specificity': 0.98409605, 'f1': 0.4866448, 'auroc': 0.9689813}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    1     2   1    18   0   3   270    33    54  20     81
1    0  1123   0    29   0   0     0   153    10   0     17
2    0     1   0    14   0   1    89    40    92   9     66
3    0     0   0  7828   0   0     2   401   205   0      4
4    1     0   1     6   0   0    89    24    97   1    320
5    0     1   0   323   0  27    60     2    56  51      1
6    0     3   0    34   0   0  1582    28    69   2    190
7    0    56   0   516   0   0     6  6505   113   0     69
8    0     1   0   373   0   0    44   172  2552   0    154
9    0     0   1   122   0  14   153    25   117  52      9
10   0     8   0    28   0   0   152    51   117   0  12440
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46904078, 'precision': 0.26790562, 'recall': 0.3547462, 'specificity': 0.9447733, 'f1': 0.28675365, 'auroc': 0.7894247}
confusion matrix:
    0     1   2    3   4   5     6    7     8   9     10
0    0     2   0   10   0   0   956    5   194   0     3
1    0  1137   0   27   0   0    12  128    64   0   131
2    0     4   0   18   0   0   244   21   532   0   196
3    0     0   0    0   0   0     0    0     0   0     0
4    0     1   0    0   0   0    46    0    27   0  1559
5    0     0   0  303   0   0    31    0   258   0     0
6    0     2   0    0   0   0  2021    2   176   0   866
7    0   129   0   12   0   0    95  754   150   0    24
8    0     0   0   29   0   0   155    0  1150   0    36
9    0     9   0  128   0   0   121   25   829   0    25
10   0     0   0    0   0   0     4    0     0   0  1642
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 16:54:06.156229,epoch time: 0:34:56.252126,used: 1:11:18.613622,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_42_46_seed_1_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5634899, 'precision': 0.3287543, 'recall': 0.19742206, 'specificity': 0.94233894, 'f1': 0.19459015, 'auroc': 0.7793714}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   0   0    35   0   0   40    29    8   6    365
1    0   2   0    56   0   0    0   207    2   0   1065
2    0   0   0     6   0   0    1    24    1   2    278
3    0   2   0  5160   0   0   14  1032  455  32   1743
4    0   0   0     8   0   1    4    10    2   1    512
5    0   0   0   173   0   1   28    31   46  45    197
6    0   0   0    44   0   0  143    74   10   0   1637
7    0   0   0   533   0   0    0  2864   54   3   3809
8    0   0   0   199   0   0   10   194  146   0   2747
9    0   0   0    62   0   2   38    42   23  24    302
10   0   0   0    40   0   0    3    26    2   0  12721
---- Validation: 
scalar performance:
{'acc': 0.56190985, 'precision': 0.3512388, 'recall': 0.19656835, 'specificity': 0.94223154, 'f1': 0.1935227, 'auroc': 0.7790681}
confusion matrix:
    0   1   2     3   4   5    6     7    8   9      10
0    0   0   0    37   0   0   31    32    4   8    371
1    0   4   0    55   0   0    0   227    1   0   1045
2    0   0   0    10   0   0    3    26    2   1    270
3    0   2   0  5134   0   1   26  1024  478  32   1743
4    0   0   0    10   0   0    2     6    2   1    518
5    0   0   0   177   0   2   35    27   41  39    200
6    0   0   0    40   0   0  169    63   10   4   1622
7    0   1   1   634   0   0    0  2818   46   2   3763
8    0   0   0   215   0   0   13   199  146   5   2718
9    0   0   0    59   0   1   43    54   22  16    298
10   0   0   0    34   0   0    2    39    3   0  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.14307703, 'precision': 0.1320163, 'recall': 0.12205478, 'specificity': 0.9116063, 'f1': 0.06408293, 'auroc': 0.62508553}
confusion matrix:
    0   1   2    3   4   5    6    7   8   9     10
0    0   0   0   10   0   1  207   13   0   0   939
1    0   0   0    7   0   0    0   34   0   0  1458
2    0   0   0    4   0   1   37    6   5   0   962
3    0   0   0    0   0   0    0    0   0   0     0
4    0   0   0    0   0   0    0    0   0   0  1633
5    0   0   0  113   0   2  193   19  54   7   204
6    0   0   0    0   0   0    2    1   1   0  3063
7    0   1   0    3   0   0    1  389   0   0   770
8    0   0   0    7   0   0   18    5   6   0  1334
9    0   1   0   21   0   0  136   50  21   0   908
10   0   0   0    0   0   0    0    0   0   0  1646
early stop counter: 1
val acc:0.5619098544120789, best validation acc: 0.8589006066322327, corresponding to test acc:                         0.46904078125953674 / 0.46904078125953674
after epoch: 3,now: 2024-08-11 17:28:58.971352,epoch time: 0:34:52.815123,used: 1:46:11.428745,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_42_46_seed_1_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.45454302, 'precision': 0.16345948, 'recall': 0.13705125, 'specificity': 0.9255082, 'f1': 0.115069956, 'auroc': 0.66301125}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0    10   0   0   0    6   0   0    467
1    0   0   0    14   0   0   0  168   0   0   1150
2    0   0   0     2   0   0   0    7   0   0    303
3    0   0   0  3944   0   0   1  560   9   3   3922
4    0   0   0     4   0   0   0    3   0   0    532
5    0   0   0   149   0   0   0    6   5   0    361
6    0   0   0    12   0   0   0   59   1   0   1836
7    0   0   0    92   0   0   0  322   0   0   6851
8    0   0   0    96   0   0   0   56   5   0   3139
9    0   0   0    35   0   0   0    8   1   0    447
10   0   0   0    13   0   0   0   59   0   0  12718
---- Validation: 
scalar performance:
{'acc': 0.45606527, 'precision': 0.17333578, 'recall': 0.1376173, 'specificity': 0.92573345, 'f1': 0.11571344, 'auroc': 0.66400194}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     3   0   0   0    6   0   0    474
1    0   0   0    11   0   0   0  178   0   0   1143
2    0   0   0     1   0   0   0    5   0   0    306
3    0   0   0  3979   0   0   2  611  10   2   3836
4    0   0   0     5   0   0   0    3   0   0    531
5    0   0   0   163   0   0   0    7   3   2    346
6    0   0   0    19   0   0   0   46   0   0   1843
7    0   0   0    76   0   0   0  324   0   0   6865
8    0   0   0   103   0   0   0   58   7   0   3128
9    0   0   0    32   0   0   0   10   0   0    451
10   0   0   0     7   0   0   0   49   0   0  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1153012, 'precision': 0.043760967, 'recall': 0.091053545, 'specificity': 0.9092478, 'f1': 0.019297961, 'auroc': 0.520622}
confusion matrix:
    0   1   2    3   4   5   6   7   8   9     10
0    0   0   0    2   0   0   0   0   0   0  1168
1    0   0   0    5   0   0   0  12   0   0  1482
2    0   0   0    6   0   0   0   2   0   0  1007
3    0   0   0    0   0   0   0   0   0   0     0
4    0   0   0    0   0   0   0   0   0   0  1633
5    0   0   0  120   0   0   1   5   2   0   464
6    0   0   0    1   0   0   0   0   0   0  3066
7    0   0   0    0   0   0   0   1   0   0  1163
8    0   0   0    7   0   0   0   3   1   0  1359
9    0   0   0   22   0   0   0   9   0   0  1106
10   0   0   0    0   0   0   0   0   0   0  1646
early stop counter: 2
val acc:0.45606526732444763, best validation acc: 0.8589006066322327, corresponding to test acc:                         0.46904078125953674 / 0.46904078125953674
after epoch: 4,now: 2024-08-11 18:03:56.779659,epoch time: 0:34:57.808307,used: 2:21:09.237052,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_42_46_seed_1_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.44175407, 'precision': 0.1484366, 'recall': 0.131074, 'specificity': 0.9231782, 'f1': 0.105290785, 'auroc': 0.59340715}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     2   0   0   0    1   0   0    480
1    0   0   0    11   0   0   0    3   0   0   1317
2    0   0   0     0   0   0   0    0   0   0    312
3    0   0   0  3685   0   0   0  172   4   0   4576
4    0   0   0     3   0   0   0    0   0   0    536
5    0   0   0   106   0   0   0    1   1   0    413
6    0   0   0     6   0   0   0    0   0   0   1902
7    0   0   0   104   0   0   0   39   0   0   7121
8    0   0   0   116   0   0   0    9   1   0   3168
9    0   0   0    19   0   0   0    1   0   0    473
10   0   0   0     7   0   0   0    1   0   0  12786
---- Validation: 
scalar performance:
{'acc': 0.44023004, 'precision': 0.16251495, 'recall': 0.13049832, 'specificity': 0.9230088, 'f1': 0.10477428, 'auroc': 0.5961517}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0     3   0   0   0    0   0   0    480
1    0   0   0     9   0   0   0    3   0   0   1320
2    0   0   0     0   0   0   0    0   0   0    312
3    0   0   0  3624   0   0   1  216   3   0   4596
4    0   0   0     4   0   0   0    0   0   0    535
5    0   0   0   114   0   0   0    0   1   0    406
6    0   0   0     7   0   0   0    0   0   0   1901
7    0   0   0    98   0   0   0   45   0   1   7121
8    0   0   0   128   0   0   0    8   2   0   3158
9    0   0   0    18   0   0   0    1   0   0    474
10   0   0   0     8   0   0   0    0   0   1  12787
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.010528875, 'recall': 0.09090909, 'specificity': 0.90914446, 'f1': 0.018872036, 'auroc': 0.46726072}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   1   0   0   0   0   0   0  1169
1    0   0   0   3   0   0   0   6   0   0  1490
2    0   0   0   1   0   0   0   1   0   0  1013
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0  47   0   0   0  13   0   0   532
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   3   0   0   0   1   0   0  1366
9    0   0   0   2   0   0   0   3   0   0  1132
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 3
val acc:0.44023004174232483, best validation acc: 0.8589006066322327, corresponding to test acc:                         0.46904078125953674 / 0.46904078125953674
after epoch: 5,now: 2024-08-11 18:39:16.554125,epoch time: 0:35:19.774466,used: 2:56:29.011518,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_42_46_seed_1_24142408
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 2:56:29.011518 at 2024-08-11 18:39:16.554125
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46904078, 'precision': 0.26790562, 'recall': 0.3547462, 'specificity': 0.9447733, 'f1': 0.28675365, 'auroc': 0.7894247}
confusion matrix:
    0     1   2    3   4   5     6    7     8   9     10
0    0     2   0   10   0   0   956    5   194   0     3
1    0  1137   0   27   0   0    12  128    64   0   131
2    0     4   0   18   0   0   244   21   532   0   196
3    0     0   0    0   0   0     0    0     0   0     0
4    0     1   0    0   0   0    46    0    27   0  1559
5    0     0   0  303   0   0    31    0   258   0     0
6    0     2   0    0   0   0  2021    2   176   0   866
7    0   129   0   12   0   0    95  754   150   0    24
8    0     0   0   29   0   0   155    0  1150   0    36
9    0     9   0  128   0   0   121   25   829   0    25
10   0     0   0    0   0   0     4    0     0   0  1642
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.46904078, 'precision': 0.26790562, 'recall': 0.3547462, 'specificity': 0.9447733, 'f1': 0.28675365, 'auroc': 0.7894247}
confusion matrix:
    0     1   2    3   4   5     6    7     8   9     10
0    0     2   0   10   0   0   956    5   194   0     3
1    0  1137   0   27   0   0    12  128    64   0   131
2    0     4   0   18   0   0   244   21   532   0   196
3    0     0   0    0   0   0     0    0     0   0     0
4    0     1   0    0   0   0    46    0    27   0  1559
5    0     0   0  303   0   0    31    0   258   0     0
6    0     2   0    0   0   0  2021    2   176   0   866
7    0   129   0   12   0   0    95  754   150   0    24
8    0     0   0   29   0   0   155    0  1150   0    36
9    0     9   0  128   0   0   121   25   829   0    25
10   0     0   0    0   0   0     4    0     0   0  1642
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_42_46_seed_1_24142408_instance_wise_predictions.txt
accuracy from prediction file 0.46904078919750924
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1693 MiB |  13312 MiB | 611279 GiB | 611278 GiB |
|       from large pool |   1500 MiB |  13157 MiB | 609717 GiB | 609715 GiB |
|       from small pool |    193 MiB |    274 MiB |   1562 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1693 MiB |  13312 MiB | 611279 GiB | 611278 GiB |
|       from large pool |   1500 MiB |  13157 MiB | 609717 GiB | 609715 GiB |
|       from small pool |    193 MiB |    274 MiB |   1562 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  13266 MiB | 609563 GiB | 609561 GiB |
|       from large pool |   1476 MiB |  13110 MiB | 608003 GiB | 608002 GiB |
|       from small pool |    192 MiB |    273 MiB |   1559 GiB |   1559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  13766 MiB |  13766 MiB |  24028 MiB |  10262 MiB |
|       from large pool |  13490 MiB |  13490 MiB |  23678 MiB |  10188 MiB |
|       from small pool |    276 MiB |    276 MiB |    350 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3250 MiB |   3441 MiB | 376351 GiB | 376348 GiB |
|       from large pool |   3241 MiB |   3438 MiB | 374658 GiB | 374655 GiB |
|       from small pool |      8 MiB |     40 MiB |   1693 GiB |   1693 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   44059 K  |   44055 K  |
|       from large pool |     182    |     489    |   18166 K  |   18166 K  |
|       from small pool |    4194    |    6508    |   25893 K  |   25889 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   44059 K  |   44055 K  |
|       from large pool |     182    |     489    |   18166 K  |   18166 K  |
|       from small pool |    4194    |    6508    |   25893 K  |   25889 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     293    |     419    |     134    |
|       from large pool |     147    |     155    |     244    |      97    |
|       from small pool |     138    |     138    |     175    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    1125    |   18848 K  |   18848 K  |
|       from large pool |      49    |      91    |    8933 K  |    8933 K  |
|       from small pool |      25    |    1095    |    9915 K  |    9915 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13312 MiB | 611279 GiB | 611279 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 609717 GiB | 609717 GiB |
|       from small pool |      0 KiB |    274 MiB |   1562 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13312 MiB | 611279 GiB | 611279 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 609717 GiB | 609717 GiB |
|       from small pool |      0 KiB |    274 MiB |   1562 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13266 MiB | 609563 GiB | 609562 GiB |
|       from large pool |  16640 KiB |  13110 MiB | 608003 GiB | 608003 GiB |
|       from small pool |      0 KiB |    273 MiB |   1559 GiB |   1559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4944 MiB |  13766 MiB |  24028 MiB |  19084 MiB |
|       from large pool |   4742 MiB |  13490 MiB |  23678 MiB |  18936 MiB |
|       from small pool |    202 MiB |    276 MiB |    350 MiB |    148 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   3455 MiB | 376352 GiB | 376352 GiB |
|       from large pool | 405248 KiB |   3438 MiB | 374659 GiB | 374658 GiB |
|       from small pool |      0 KiB |     40 MiB |   1693 GiB |   1693 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   44059 K  |   44059 K  |
|       from large pool |       2    |     489    |   18166 K  |   18166 K  |
|       from small pool |       0    |    6508    |   25893 K  |   25893 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   44059 K  |   44059 K  |
|       from large pool |       2    |     489    |   18166 K  |   18166 K  |
|       from small pool |       0    |    6508    |   25893 K  |   25893 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     168    |     293    |     419    |     251    |
|       from large pool |      67    |     155    |     244    |     177    |
|       from small pool |     101    |     138    |     175    |      74    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1125    |   18849 K  |   18849 K  |
|       from large pool |       4    |      91    |    8933 K  |    8933 K  |
|       from small pool |       0    |    1095    |    9916 K  |    9916 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 18:45:38 2024]
Finished job 0.
1 of 1 steps (100%) done
