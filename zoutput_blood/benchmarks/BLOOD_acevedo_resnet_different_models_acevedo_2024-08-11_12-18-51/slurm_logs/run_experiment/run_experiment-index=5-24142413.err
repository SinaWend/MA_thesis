Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug 11 14:56:28 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_05_34_seed_0_24142413

 Experiment start at: 2024-08-11 15:05:34.752111
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.07954943180084229
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.79200554, 'precision': 0.4545118, 'recall': 0.41554496, 'specificity': 0.97604996, 'f1': 0.4241896, 'auroc': 0.92790675}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0    0    1   0    74   0   0   207    67    30   43     61
1    0  855   0    21   0   0     3   431     1    0     21
2    0    2   0    55   0   0   122    62    28   22     21
3    0    0   0  7773   0   0     3   599    48    1     13
4    0    1   0    38   0   0   123    48    57    8    264
5    0    0   0   405   0   0    14     5     9   85      3
6    0    3   0   209   0   0  1128   111   110   38    309
7    0    4   0   837   0   0     7  6276    52    0     84
8    0    0   0  1010   2   0   123   509  1230    9    413
9    0    0   0   230   0   0    94    34    25  110      0
10   0    7   0    71   1   0   164   197   123    2  12230
---- Validation: 
scalar performance:
{'acc': 0.79564, 'precision': 0.45904475, 'recall': 0.42063028, 'specificity': 0.9764572, 'f1': 0.42962912, 'auroc': 0.9263557}
confusion matrix:
    0    1   2     3   4   5     6     7     8    9      10
0    0    0   0    80   1   0   205    54    35   43     65
1    0  872   0    29   0   0     4   400     1    0     26
2    0    1   0    45   0   0   133    71    24   20     18
3    0    0   0  7764   0   0     2   599    64    0     11
4    0    1   0    25   0   0   128    65    61    5    254
5    0    0   0   404   0   0    17     5    10   84      1
6    0    2   0   196   0   0  1133   117   119   29    312
7    0    7   0   799   1   0    11  6326    61    1     59
8    0    2   0   955   0   0    97   517  1257   11    457
9    0    0   0   231   0   0    86    39    14  122      1
10   0    2   0    59   0   0   155   182   122    5  12271
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.33988667, 'precision': 0.24018964, 'recall': 0.27919233, 'specificity': 0.93082213, 'f1': 0.22430448, 'auroc': 0.7078656}
confusion matrix:
    0    1   2    3   4   5    6    7    8    9     10
0    0    0   0   10   0   0  937   36   21  161     5
1    0  534   0    5   0   0   57  721    8    4   170
2    0    0   0   40   0   0  416  195  144   74   146
3    0    0   0    0   0   0    0    0    0    0     0
4    0    1   0    0   0   0   96   13    8    1  1514
5    0    0   0  184   0   0   41    5   71  286     5
6    0    1   0    4   0   0  996  211  142    3  1710
7    0   43   0    1   0   0  149  945   12    2    12
8    0    0   0   28   0   0  533   33  482  105   189
9    0    3   0  132   0   2  333  199  185  263    20
10   0    0   0    0   0   0    7    1    0    0  1638
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 15:44:52.748237,epoch time: 0:39:17.996126,used: 0:39:17.996126,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_05_34_seed_0_24142413
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.81343645, 'precision': 0.62762845, 'recall': 0.49676713, 'specificity': 0.97967577, 'f1': 0.49668548, 'auroc': 0.9511738}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    2     0   0    82   0   22   207    41    47   65     17
1    0  1063   0    24   0    0     0   233     1    0     11
2    0     0   0    35   0    9    90    96    41   36      5
3    0     0   0  7974   0    3     2   388    68    1      1
4    0     0   0    12   1    4   135    52   168   16    151
5    0     0   0   303   0  161     2     0     7   46      1
6    0     3   0   105   0    9  1506    69   114   38     63
7    0     4   0   700   0    0     4  6470    67    0     19
8    0     0   0   841   0    2    32   361  2022   11     27
9    0     0   0   148   1  120    39    40    24  121      0
10   0     4   0    29   1    1   401   191  1069   14  11083
---- Validation: 
scalar performance:
{'acc': 0.8142303, 'precision': 0.6890762, 'recall': 0.49797207, 'specificity': 0.97976726, 'f1': 0.4980182, 'auroc': 0.9508704}
confusion matrix:
    0     1   2     3   4    5     6     7     8    9      10
0    2     0   0    71   0   30   201    34    54   70     21
1    0  1074   0    19   0    0     0   225     2    0     12
2    0     0   0    36   0    8    92    95    36   43      2
3    0     0   0  7974   0    5     0   385    72    1      3
4    0     1   0     9   2    8   150    50   156   16    147
5    0     0   0   301   0  149     5     2    11   52      1
6    0     2   0   122   0    8  1482    72   129   39     54
7    0     2   0   675   0    0     2  6493    72    0     21
8    0     0   0   820   0    1    25   360  2053    5     32
9    0     0   0   154   0  105    41    35    23  135      0
10   0     2   0    48   0    2   392   216  1051    9  11076
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47085986, 'precision': 0.34688228, 'recall': 0.38211977, 'specificity': 0.94484997, 'f1': 0.3194105, 'auroc': 0.7686166}
confusion matrix:
    0     1   2    3   4   5     6     7     8    9     10
0    0     0   0    3   0   3  1012    44    38   67     3
1    0  1024   0    7   0   0    24   317    24    1   102
2    0     0   0   36   0   3   285   121   450   53    67
3    0     0   0    0   0   0     0     0     0    0     0
4    0     1   0    0   0   0   114     7   110    0  1401
5    0     0   0  246   0  32    28     2    57  225     2
6    0     0   0    0   0   0  1613    54   786    0   614
7    0    23   0    1   0   0    65  1039    26    0    10
8    0     0   0   17   0   2   171     8  1127   35    10
9    0     5   0  130   0  15   201   192   313  271    10
10   0     0   0    0   0   0    18     0     4    0  1624
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-11 16:22:53.334245,epoch time: 0:38:00.586008,used: 1:17:18.582134,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_05_34_seed_0_24142413
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.5787136, 'precision': 0.47670716, 'recall': 0.22547789, 'specificity': 0.9508146, 'f1': 0.2174151, 'auroc': 0.7952928}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9     10
0    1    0   0   374   0   0    4    78    1   0    25
1    0  170   0   128   0   0    0  1012    0   0    21
2    0    0   0   242   0   0    2    58    1   0     9
3    0    0   0  8255   0   0    0   176    0   0     5
4    0    0   0   268   0   0    3   130    5   1   132
5    0    0   0   507   0   0    1     7    0   2     4
6    0    0   0   956   1   0  207   458    8   1   277
7    0    1   0  3527   0   0    1  3694    1   0    40
8    0    0   0  2662   0   0    1   372   97   0   164
9    0    0   0   457   0   0    1    27    1   3     4
10   0    3   0  1546   1   0   53  1767  219   1  9203
---- Validation: 
scalar performance:
{'acc': 0.5764344, 'precision': 0.43772218, 'recall': 0.2232857, 'specificity': 0.9505622, 'f1': 0.21394065, 'auroc': 0.79422617}
confusion matrix:
    0    1   2     3   4   5    6     7    8   9     10
0    1    0   0   356   0   0    4    83    1   1    37
1    0  166   0   135   0   0    2  1012    0   0    17
2    0    0   0   235   0   0    1    63    1   0    12
3    0    0   0  8226   0   0    0   210    1   0     3
4    0    0   0   261   0   0    7   136    8   0   127
5    0    0   0   508   0   0    0     3    0   3     7
6    0    0   0   963   0   0  193   481    7   1   263
7    0    0   0  3509   0   0    0  3717    3   0    36
8    0    0   0  2690   0   0    0   346   86   0   174
9    0    0   0   454   0   0    1    34    0   0     4
10   0    2   0  1578   1   0   54  1762  236   2  9161
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.20898342, 'precision': 0.25419074, 'recall': 0.18827677, 'specificity': 0.92244625, 'f1': 0.11442369, 'auroc': 0.66355085}
confusion matrix:
    0   1   2    3   4   5   6     7    8   9     10
0    0   2   0  679   0   1   8   261   20   1   198
1    0  90   0   45   0   0   4  1176    6   0   178
2    0   0   0  295   0   0   0   398   48   0   274
3    0   0   0    0   0   0   0     0    0   0     0
4    0   0   0    8   0   0   0    82   19   0  1524
5    0   0   0  551   0   0   0    23    2   0    16
6    0   2   0  249   0   0  44   758  103   0  1911
7    0   1   0  254   0   0   0   880    3   0    26
8    0   0   0  597   0   0   0   127  343   1   302
9    0   0   0  796   0   0   2   269    9   0    61
10   0   0   0    0   0   0   1    11    4   0  1630
early stop counter: 1
val acc:0.5764343738555908, best validation acc: 0.8142303228378296, corresponding to test acc:                         0.4708598554134369 / 0.4708598554134369
after epoch: 3,now: 2024-08-11 17:00:53.003779,epoch time: 0:37:59.669534,used: 1:55:18.251668,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_05_34_seed_0_24142413
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.3718429, 'precision': 0.106509484, 'recall': 0.13329923, 'specificity': 0.9251495, 'f1': 0.11407432, 'auroc': 0.5882536}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   166   0   0   0   156   0   0   161
1    0   0   0   284   0   0   0   857   0   0   190
2    0   0   0   126   0   0   0   107   0   0    79
3    0   0   0  4505   0   0   0  2958   0   0   973
4    0   0   0   197   0   0   0   155   0   0   187
5    0   0   0   313   0   0   0   123   0   0    85
6    0   0   0   522   0   0   0   722   0   0   664
7    0   0   0  3007   0   0   0  3329   0   0   929
8    0   0   0  1499   0   0   0  1121   0   0   676
9    0   0   0   247   0   0   0   154   0   0    92
10   0   0   0  3690   0   0   0  3038   0   0  6064
---- Validation: 
scalar performance:
{'acc': 0.37365255, 'precision': 0.1066387, 'recall': 0.13354278, 'specificity': 0.9253191, 'f1': 0.11450497, 'auroc': 0.5943175}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9     10
0    0   0   0   167   0   0   0   138   0   0   178
1    0   0   0   295   0   0   0   843   0   0   194
2    0   0   0   143   0   0   0    99   0   0    70
3    0   0   0  4432   0   0   0  2995   0   0  1013
4    0   0   0   177   0   0   0   161   0   0   201
5    0   0   0   306   0   0   0   139   0   0    76
6    0   0   0   484   0   0   0   739   0   0   685
7    0   0   0  3019   0   0   0  3337   0   0   909
8    0   0   0  1481   0   0   0  1150   0   0   665
9    0   0   0   256   0   0   0   135   0   0   102
10   0   0   0  3689   0   0   0  2907   0   0  6200
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.10102847, 'precision': 0.050998144, 'recall': 0.101891, 'specificity': 0.91455853, 'f1': 0.053710677, 'auroc': 0.5197146}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9    10
0    0   0   0   207   0   0   0   834   0   0  129
1    0   0   0   207   0   0   0  1230   0   0   62
2    0   0   0   605   0   0   0   385   0   0   25
3    0   0   0     0   0   0   0     0   0   0    0
4    0   0   0   858   0   0   0   601   0   0  174
5    0   0   0   371   0   0   0   183   0   0   38
6    0   0   0  1823   0   0   0  1192   0   0   52
7    0   0   0   111   0   0   0   968   0   0   85
8    0   0   0   835   0   0   0   497   0   0   38
9    0   0   0   688   0   0   0   377   0   0   72
10   0   0   0   869   0   0   0   299   2   0  476
early stop counter: 2
val acc:0.37365254759788513, best validation acc: 0.8142303228378296, corresponding to test acc:                         0.4708598554134369 / 0.4708598554134369
after epoch: 4,now: 2024-08-11 17:38:52.904574,epoch time: 0:37:59.900795,used: 2:33:18.152463,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_05_34_seed_0_24142413
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.3284996, 'precision': 0.07681167, 'recall': 0.095052175, 'specificity': 0.9104474, 'f1': 0.07203123, 'auroc': 0.5614885}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    37   0   0   0    44   0   0    402
1    0   0   0    91   0   0   0   613   0   0    628
2    0   0   0     7   0   0   0    16   0   0    289
3    0   0   0   857   0   0   0   508   0   0   7072
4    0   0   0    29   0   0   0    32   0   0    478
5    0   0   0    36   0   0   0    18   0   0    467
6    0   0   0   147   0   0   0   194   0   0   1567
7    0   0   0   672   0   0   0   861   0   0   5730
8    0   0   0   265   0   0   0   239   0   0   2791
9    0   0   0    25   0   0   0    18   0   0    450
10   0   0   0  1032   0   0   0  1201   0   0  10560
---- Validation: 
scalar performance:
{'acc': 0.3284205, 'precision': 0.077726446, 'recall': 0.09526577, 'specificity': 0.9104038, 'f1': 0.0725229, 'auroc': 0.56136656}
confusion matrix:
    0   1   2     3   4   5   6     7   8   9      10
0    0   0   0    28   0   0   0    33   0   0    422
1    0   0   0    76   0   0   0   623   0   0    633
2    0   0   0    13   0   0   0    20   0   0    279
3    0   0   0   848   0   0   0   487   0   0   7105
4    0   0   0    38   0   0   0    34   0   0    467
5    0   0   0    47   0   0   0    10   0   0    464
6    0   0   0   126   0   0   0   202   0   0   1580
7    0   0   0   659   0   0   0   911   0   0   5695
8    0   0   0   264   0   0   0   188   0   0   2844
9    0   0   0    28   0   0   0    21   0   0    444
10   0   0   0  1045   0   0   0  1232   0   0  10519
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11138319, 'precision': 0.014432397, 'recall': 0.08911591, 'specificity': 0.9098277, 'f1': 0.024221312, 'auroc': 0.557373}
confusion matrix:
    0   1   2    3   4   5   6    7   8   9     10
0    0   0   0   24   0   0   0  116   0   0  1030
1    0   0   0   27   0   0   0  165   0   0  1307
2    0   0   0   77   0   0   0  158   0   0   780
3    0   0   0    0   0   0   0    0   0   0     0
4    0   0   0   82   0   0   0  273   0   0  1278
5    0   0   0   17   0   0   0   19   0   0   556
6    0   0   0  220   0   0   0  923   0   0  1924
7    0   0   0   13   0   0   0   52   0   0  1099
8    0   0   0  168   0   0   0  255   0   0   947
9    0   0   0   41   0   0   0   83   0   0  1013
10   0   0   0   31   0   0   0   75   0   0  1540
early stop counter: 3
val acc:0.328420490026474, best validation acc: 0.8142303228378296, corresponding to test acc:                         0.4708598554134369 / 0.4708598554134369
after epoch: 5,now: 2024-08-11 18:16:48.265138,epoch time: 0:37:55.360564,used: 3:11:13.513027,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_05_34_seed_0_24142413
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 5 with time: 3:11:13.513027 at 2024-08-11 18:16:48.265138
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47085986, 'precision': 0.34688228, 'recall': 0.38211977, 'specificity': 0.94484997, 'f1': 0.3194105, 'auroc': 0.7686166}
confusion matrix:
    0     1   2    3   4   5     6     7     8    9     10
0    0     0   0    3   0   3  1012    44    38   67     3
1    0  1024   0    7   0   0    24   317    24    1   102
2    0     0   0   36   0   3   285   121   450   53    67
3    0     0   0    0   0   0     0     0     0    0     0
4    0     1   0    0   0   0   114     7   110    0  1401
5    0     0   0  246   0  32    28     2    57  225     2
6    0     0   0    0   0   0  1613    54   786    0   614
7    0    23   0    1   0   0    65  1039    26    0    10
8    0     0   0   17   0   2   171     8  1127   35    10
9    0     5   0  130   0  15   201   192   313  271    10
10   0     0   0    0   0   0    18     0     4    0  1624
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47085986, 'precision': 0.34688228, 'recall': 0.38211977, 'specificity': 0.94484997, 'f1': 0.3194105, 'auroc': 0.7686166}
confusion matrix:
    0     1   2    3   4   5     6     7     8    9     10
0    0     0   0    3   0   3  1012    44    38   67     3
1    0  1024   0    7   0   0    24   317    24    1   102
2    0     0   0   36   0   3   285   121   450   53    67
3    0     0   0    0   0   0     0     0     0    0     0
4    0     1   0    0   0   0   114     7   110    0  1401
5    0     0   0  246   0  32    28     2    57  225     2
6    0     0   0    0   0   0  1613    54   786    0   614
7    0    23   0    1   0   0    65  1039    26    0    10
8    0     0   0   17   0   2   171     8  1127   35    10
9    0     5   0  130   0  15   201   192   313  271    10
10   0     0   0    0   0   0    18     0     4    0  1624
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_15_05_34_seed_0_24142413_instance_wise_predictions.txt
accuracy from prediction file 0.47085986147064995
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/5.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1698 MiB |  13312 MiB | 305640 GiB | 305639 GiB |
|       from large pool |   1505 MiB |  13157 MiB | 304859 GiB | 304858 GiB |
|       from small pool |    193 MiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1698 MiB |  13312 MiB | 305640 GiB | 305639 GiB |
|       from large pool |   1505 MiB |  13157 MiB | 304859 GiB | 304858 GiB |
|       from small pool |    193 MiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  13266 MiB | 304781 GiB | 304779 GiB |
|       from large pool |   1476 MiB |  13110 MiB | 304001 GiB | 304000 GiB |
|       from small pool |    192 MiB |    273 MiB |    779 GiB |    779 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  13614 MiB |  13614 MiB |  13614 MiB |      0 B   |
|       from large pool |  13338 MiB |  13338 MiB |  13338 MiB |      0 B   |
|       from small pool |    276 MiB |    276 MiB |    276 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1653 MiB |   1725 MiB | 179559 GiB | 179558 GiB |
|       from large pool |   1644 MiB |   1721 MiB | 178715 GiB | 178714 GiB |
|       from small pool |      8 MiB |     21 MiB |    843 GiB |    843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   22029 K  |   22025 K  |
|       from large pool |     182    |     489    |    9083 K  |    9083 K  |
|       from small pool |    4194    |    6508    |   12946 K  |   12942 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   22029 K  |   22025 K  |
|       from large pool |     182    |     489    |    9083 K  |    9083 K  |
|       from small pool |    4194    |    6508    |   12946 K  |   12942 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     293    |     293    |     293    |       0    |
|       from large pool |     155    |     155    |     155    |       0    |
|       from small pool |     138    |     138    |     138    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    1108    |    9533 K  |    9533 K  |
|       from large pool |      30    |      76    |    4468 K  |    4468 K  |
|       from small pool |      23    |    1078    |    5064 K  |    5064 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13312 MiB | 305640 GiB | 305640 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 304859 GiB | 304859 GiB |
|       from small pool |      0 KiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13312 MiB | 305640 GiB | 305640 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 304859 GiB | 304859 GiB |
|       from small pool |      0 KiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13266 MiB | 304781 GiB | 304781 GiB |
|       from large pool |  16640 KiB |  13110 MiB | 304001 GiB | 304001 GiB |
|       from small pool |      0 KiB |    273 MiB |    779 GiB |    779 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3352 MiB |  13614 MiB |  13614 MiB |  10262 MiB |
|       from large pool |   3150 MiB |  13338 MiB |  13338 MiB |  10188 MiB |
|       from small pool |    202 MiB |    276 MiB |    276 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   1964 MiB | 179560 GiB | 179560 GiB |
|       from large pool | 405248 KiB |   1941 MiB | 178716 GiB | 178716 GiB |
|       from small pool |      0 KiB |     41 MiB |    844 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   22029 K  |   22029 K  |
|       from large pool |       2    |     489    |    9083 K  |    9083 K  |
|       from small pool |       0    |    6508    |   12946 K  |   12946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   22029 K  |   22029 K  |
|       from large pool |       2    |     489    |    9083 K  |    9083 K  |
|       from small pool |       0    |    6508    |   12946 K  |   12946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     159    |     293    |     293    |     134    |
|       from large pool |      58    |     155    |     155    |      97    |
|       from small pool |     101    |     138    |     138    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1108    |    9534 K  |    9534 K  |
|       from large pool |       4    |      76    |    4468 K  |    4468 K  |
|       from small pool |       0    |    1078    |    5065 K  |    5065 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13312 MiB | 305640 GiB | 305640 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 304859 GiB | 304859 GiB |
|       from small pool |      0 KiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13312 MiB | 305640 GiB | 305640 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 304859 GiB | 304859 GiB |
|       from small pool |      0 KiB |    274 MiB |    781 GiB |    781 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13266 MiB | 304781 GiB | 304781 GiB |
|       from large pool |  16640 KiB |  13110 MiB | 304001 GiB | 304001 GiB |
|       from small pool |      0 KiB |    273 MiB |    779 GiB |    779 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3352 MiB |  13614 MiB |  13614 MiB |  10262 MiB |
|       from large pool |   3150 MiB |  13338 MiB |  13338 MiB |  10188 MiB |
|       from small pool |    202 MiB |    276 MiB |    276 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   1964 MiB | 179560 GiB | 179560 GiB |
|       from large pool | 405248 KiB |   1941 MiB | 178716 GiB | 178716 GiB |
|       from small pool |      0 KiB |     41 MiB |    844 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   22029 K  |   22029 K  |
|       from large pool |       2    |     489    |    9083 K  |    9083 K  |
|       from small pool |       0    |    6508    |   12946 K  |   12946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   22029 K  |   22029 K  |
|       from large pool |       2    |     489    |    9083 K  |    9083 K  |
|       from small pool |       0    |    6508    |   12946 K  |   12946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     159    |     293    |     293    |     134    |
|       from large pool |      58    |     155    |     155    |      97    |
|       from small pool |     101    |     138    |     138    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1108    |    9534 K  |    9534 K  |
|       from large pool |       4    |      76    |    4468 K  |    4468 K  |
|       from small pool |       0    |    1078    |    5065 K  |    5065 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_18_32_57_seed_1_24142413

 Experiment start at: 2024-08-11 18:32:58.206058
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.06254810094833374
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.79452056, 'precision': 0.4586501, 'recall': 0.4050585, 'specificity': 0.9759612, 'f1': 0.40647817, 'auroc': 0.9298533}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    1   0    29   0   0   214    29    94   0    116
1    0  974   0    94   0   0     1   204     2   0     57
2    0    1   0    26   0   1    68    46   119   0     51
3    0    2   0  7679   0   0     4   558   165   0     30
4    0    0   0    16   0   0    83    19    70   0    351
5    0    0   0   397   0   1    25     0    95   0      3
6    0    5   0    72   0   0  1044    48   155   0    584
7    0   27   0   864   0   0     6  6046   138   0    183
8    0    2   0   775   0   0   146   304  1519   0    550
9    0    2   0   193   0   0    94    26   169   0      9
10   0   10   0    52   0   0   140    62    93   0  12433
---- Validation: 
scalar performance:
{'acc': 0.7961482, 'precision': 0.41473734, 'recall': 0.40503138, 'specificity': 0.9761288, 'f1': 0.40677923, 'auroc': 0.92763644}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    1   0    34   0   0   206    32    99   0    111
1    0  966   0    99   0   0     0   199     7   0     61
2    0    3   0    35   0   0    71    42   104   0     57
3    0    3   0  7691   0   0     6   574   139   0     27
4    0    0   0    17   0   0    85    20    73   0    344
5    0    1   0   400   0   0    31     2    85   0      2
6    0    5   0    74   0   0  1032    48   159   0    590
7    0   22   0   840   0   0     2  6081   131   0    189
8    0    1   0   779   0   0   136   294  1542   0    544
9    0    0   0   197   0   0   107    17   166   0      6
10   0    9   0    44   0   0   136    58    97   0  12452
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2929406, 'precision': 0.20220605, 'recall': 0.25680324, 'specificity': 0.9276067, 'f1': 0.2007806, 'auroc': 0.7006606}
confusion matrix:
    0    1   2    3   4   5    6    7    8   9     10
0    0    3   0   31   0   1  751   17  283   0    84
1    0  874   0   33   0   0   10  216   37   0   329
2    0    9   0   83   0   1   67   35  300   0   520
3    0    0   0    0   0   0    0    0    0   0     0
4    0    0   0    0   0   0    8    0   12   0  1613
5    0    0   0  437   0   0    6    5  141   0     3
6    0    5   0    1   0   0  194    1   80   0  2786
7    0   96   0   12   0   1   45  800  139   0    71
8    0    0   0  148   0   2  186   20  673   0   341
9    0   15   0  371   0   1   47   91  508   0   104
10   0    0   0    0   0   0    0    0    0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-11 19:12:18.446133,epoch time: 0:39:20.240075,used: 0:39:20.240075,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_18_32_57_seed_1_24142413
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.7664544, 'precision': 0.47516865, 'recall': 0.40202382, 'specificity': 0.9719684, 'f1': 0.41420132, 'auroc': 0.8970823}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    3   0    30   0   7   215    18    24   6    180
1    0  943   0   100   0   0     0   175     4   1    109
2    0    5   0    23   0   3    61    24    41   2    153
3    0    8   0  6612   0   1    60   950   702   9     95
4    0    1   0    14   0   1    29     7    28   1    458
5    0    1   0   250   0  24    84     2   109  38     13
6    0    3   0    32   0   4  1060    23    54   3    728
7    0   29   1   533   0   2    21  5778   252   2    646
8    0    2   0   413   0   2    98   147  1539   0   1093
9    0    3   0    95   0  17   144    23   122  38     51
10   0    9   0    54   0   0    33    21    24   0  12653
---- Validation: 
scalar performance:
{'acc': 0.7621506, 'precision': 0.46648368, 'recall': 0.39592227, 'specificity': 0.9714319, 'f1': 0.40782768, 'auroc': 0.8963237}
confusion matrix:
    0    1   2     3   4   5     6     7     8   9      10
0    0    3   0    30   0   6   208    23    27   4    182
1    0  920   0   106   0   0     2   175     4   0    125
2    0    3   0    24   0   6    54    28    39   4    154
3    0   11   0  6594   0   1    60   956   732   5     81
4    0    0   0    20   0   1    35    10    30   0    443
5    0    1   0   240   0  21    96     8   113  28     14
6    0    2   0    37   0   0  1047    25    55   2    740
7    0   20   0   575   0   1    22  5732   245   2    668
8    0    3   0   418   0   3    91   162  1503   1   1115
9    0    2   0   110   0  31   147    21    96  30     56
10   0    5   0    70   0   0    42    18    15   0  12646
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.26971245, 'precision': 0.2042937, 'recall': 0.24487513, 'specificity': 0.92433894, 'f1': 0.18778253, 'auroc': 0.7238123}
confusion matrix:
    0    1   2    3   4   5    6     7    8   9     10
0    0    8   0   10   0  32  839    30   24   0   227
1    0  770   0   12   0   0    4   330    0   0   383
2    0   20   0   15   0  20   83    56   81   0   740
3    0    0   0    0   0   0    0     0    0   0     0
4    0    0   0    0   0   0    0     0    1   0  1632
5    0    2   0  122   0  64   82    18  276   0    28
6    0    6   0    0   0   5  159     3    1   0  2893
7    0   51   0    4   0   1   19  1025    1   0    63
8    0    6   0   32   0  37  165    45  191   0   894
9    0   50   0   59   0  68  150   198  259   0   353
10   0    0   0    0   0   0    0     0    0   0  1646
early stop counter: 1
val acc:0.7621505856513977, best validation acc: 0.7961481809616089, corresponding to test acc:                         0.29294058680534363 / 0.29294058680534363
after epoch: 2,now: 2024-08-11 19:50:18.288793,epoch time: 0:37:59.842660,used: 1:17:20.082735,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_18_32_57_seed_1_24142413
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.44469714, 'precision': 0.18398675, 'recall': 0.13692287, 'specificity': 0.9250719, 'f1': 0.11964414, 'auroc': 0.624013}
confusion matrix:
    0   1   2     3   4   5   6    7    8   9      10
0    0   0   0    42   0   0   2   10    0   2    427
1    0   0   0   124   0   0   0  151    1   0   1056
2    0   0   0    17   0   0   1   17    1   0    276
3    0   0   0  3123   0   0  11  666  233   4   4401
4    0   0   0    16   0   0   0   10    5   0    507
5    0   0   0   130   0   0   2   18   17  15    339
6    0   0   0    82   0   0   1   81    3   3   1738
7    0   0   0   468   0   0   2  843   23   0   5927
8    0   0   0   162   0   0   3  100   39   0   2992
9    0   0   0    63   0   0   0   30    6  11    383
10   0   0   0    77   0   0   3  104    4   0  12604
---- Validation: 
scalar performance:
{'acc': 0.4451518, 'precision': 0.18752408, 'recall': 0.13651626, 'specificity': 0.9251104, 'f1': 0.118791446, 'auroc': 0.62347287}
confusion matrix:
    0   1   2     3   4   5   6    7    8   9      10
0    0   0   0    47   0   0   1   11    0   1    423
1    0   0   0   116   0   0   0  152    0   0   1064
2    0   0   0    18   0   0   0   10    3   0    281
3    0   0   0  3119   0   0  17  676  199   4   4425
4    0   0   0    16   0   0   0   17    0   1    505
5    0   0   0   129   0   0   0   19   13  21    339
6    0   0   0    71   0   0   7   72    4   1   1753
7    0   0   0   463   0   0   4  859   34   0   5905
8    0   0   0   170   0   0   1  108   33   1   2983
9    0   0   0    71   0   0   4   25    7   7    379
10   0   0   0    82   0   0   1   92    4   0  12617
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.1153012, 'precision': 0.040782504, 'recall': 0.091065295, 'specificity': 0.90911305, 'f1': 0.019103436, 'auroc': 0.4656737}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   2   0   0   0   3   0   0  1494
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   5   0   0   0   0   0   0   587
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   2   0   0  1162
8    0   0   0   0   0   0   0   1   0   0  1369
9    0   0   0   1   0   0   0   0   0   0  1136
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 2
val acc:0.44515180587768555, best validation acc: 0.7961481809616089, corresponding to test acc:                         0.29294058680534363 / 0.29294058680534363
after epoch: 3,now: 2024-08-11 20:28:13.905728,epoch time: 0:37:55.616935,used: 1:55:15.699670,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_18_32_57_seed_1_24142413
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.4229452, 'precision': 0.1462788, 'recall': 0.123821534, 'specificity': 0.9207516, 'f1': 0.09775613, 'auroc': 0.5702187}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0    16   0   0   0    3   0   0    464
1    0   0   0    79   0   0   0   49   0   0   1204
2    0   0   0     2   0   0   0    1   0   0    309
3    0   0   0  2960   0   0   1  151  52   0   5275
4    0   0   0     6   0   0   0    0   0   0    533
5    0   0   0    72   0   0   0    0   6   0    443
6    0   0   0    22   0   0   0    4   2   0   1880
7    0   0   0   157   0   0   0   87   3   0   7018
8    0   0   0    92   0   0   0    7   7   0   3190
9    0   0   0    31   0   0   0    1   2   0    457
10   0   0   0    24   0   0   0   12   0   0  12754
---- Validation: 
scalar performance:
{'acc': 0.42514378, 'precision': 0.14847851, 'recall': 0.124702916, 'specificity': 0.9210184, 'f1': 0.09888203, 'auroc': 0.5696764}
confusion matrix:
    0   1   2     3   4   5   6    7   8   9      10
0    0   0   0    12   0   0   0    2   0   0    469
1    0   0   0    66   0   1   0   56   0   0   1209
2    0   0   0     2   0   0   0    1   1   0    308
3    0   0   0  3049   0   0   0  144  35   0   5212
4    0   0   0     9   0   0   0    0   0   0    530
5    0   0   0    89   0   0   0    1   7   0    424
6    0   0   0    21   0   0   0    2   1   0   1884
7    0   0   0   130   0   0   0   89   2   0   7044
8    0   0   0    86   0   0   0   11   6   0   3193
9    0   0   0    32   0   0   0    1   0   0    460
10   0   0   0    29   0   0   0   15   2   0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.11516127, 'precision': 0.011516127, 'recall': 0.1, 'specificity': 0.90909094, 'f1': 0.020653743, 'auroc': 0.45729092}
confusion matrix:
    0   1   2   3   4   5   6   7   8   9     10
0    0   0   0   0   0   0   0   0   0   0  1170
1    0   0   0   0   0   0   0   0   0   0  1499
2    0   0   0   0   0   0   0   0   0   0  1015
3    0   0   0   0   0   0   0   0   0   0     0
4    0   0   0   0   0   0   0   0   0   0  1633
5    0   0   0   0   0   0   0   0   0   0   592
6    0   0   0   0   0   0   0   0   0   0  3067
7    0   0   0   0   0   0   0   0   0   0  1164
8    0   0   0   0   0   0   0   0   0   0  1370
9    0   0   0   0   0   0   0   0   0   0  1137
10   0   0   0   0   0   0   0   0   0   0  1646
early stop counter: 3
val acc:0.4251437783241272, best validation acc: 0.7961481809616089, corresponding to test acc:                         0.29294058680534363 / 0.29294058680534363
after epoch: 4,now: 2024-08-11 21:06:09.354765,epoch time: 0:37:55.449037,used: 2:33:11.148707,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_18_32_57_seed_1_24142413
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 2:33:11.148707 at 2024-08-11 21:06:09.354765
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2929406, 'precision': 0.20220605, 'recall': 0.25680324, 'specificity': 0.9276067, 'f1': 0.2007806, 'auroc': 0.7006606}
confusion matrix:
    0    1   2    3   4   5    6    7    8   9     10
0    0    3   0   31   0   1  751   17  283   0    84
1    0  874   0   33   0   0   10  216   37   0   329
2    0    9   0   83   0   1   67   35  300   0   520
3    0    0   0    0   0   0    0    0    0   0     0
4    0    0   0    0   0   0    8    0   12   0  1613
5    0    0   0  437   0   0    6    5  141   0     3
6    0    5   0    1   0   0  194    1   80   0  2786
7    0   96   0   12   0   1   45  800  139   0    71
8    0    0   0  148   0   2  186   20  673   0   341
9    0   15   0  371   0   1   47   91  508   0   104
10   0    0   0    0   0   0    0    0    0   0  1646
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.2929406, 'precision': 0.20220605, 'recall': 0.25680324, 'specificity': 0.9276067, 'f1': 0.2007806, 'auroc': 0.7006606}
confusion matrix:
    0    1   2    3   4   5    6    7    8   9     10
0    0    3   0   31   0   1  751   17  283   0    84
1    0  874   0   33   0   0   10  216   37   0   329
2    0    9   0   83   0   1   67   35  300   0   520
3    0    0   0    0   0   0    0    0    0   0     0
4    0    0   0    0   0   0    8    0   12   0  1613
5    0    0   0  437   0   0    6    5  141   0     3
6    0    5   0    1   0   0  194    1   80   0  2786
7    0   96   0   12   0   1   45  800  139   0    71
8    0    0   0  148   0   2  186   20  673   0   341
9    0   15   0  371   0   1   47   91  508   0   104
10   0    0   0    0   0   0    0    0    0   0  1646
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_11_18_32_57_seed_1_24142413_instance_wise_predictions.txt
accuracy from prediction file 0.29294060029385016
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_resnet_different_models_acevedo_2024-08-11_12-18-51/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1693 MiB |  13312 MiB | 552002 GiB | 552000 GiB |
|       from large pool |   1500 MiB |  13157 MiB | 550593 GiB | 550591 GiB |
|       from small pool |    193 MiB |    274 MiB |   1408 GiB |   1408 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1693 MiB |  13312 MiB | 552002 GiB | 552000 GiB |
|       from large pool |   1500 MiB |  13157 MiB | 550593 GiB | 550591 GiB |
|       from small pool |    193 MiB |    274 MiB |   1408 GiB |   1408 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1668 MiB |  13266 MiB | 550447 GiB | 550445 GiB |
|       from large pool |   1476 MiB |  13110 MiB | 549041 GiB | 549039 GiB |
|       from small pool |    192 MiB |    273 MiB |   1405 GiB |   1405 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  13766 MiB |  13766 MiB |  24028 MiB |  10262 MiB |
|       from large pool |  13490 MiB |  13490 MiB |  23678 MiB |  10188 MiB |
|       from small pool |    276 MiB |    276 MiB |    350 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3250 MiB |   3441 MiB | 337410 GiB | 337407 GiB |
|       from large pool |   3241 MiB |   3438 MiB | 335882 GiB | 335879 GiB |
|       from small pool |      8 MiB |     41 MiB |   1528 GiB |   1528 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4376    |    6763    |   39781 K  |   39776 K  |
|       from large pool |     182    |     489    |   16417 K  |   16417 K  |
|       from small pool |    4194    |    6508    |   23363 K  |   23359 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4376    |    6763    |   39781 K  |   39776 K  |
|       from large pool |     182    |     489    |   16417 K  |   16417 K  |
|       from small pool |    4194    |    6508    |   23363 K  |   23359 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     293    |     419    |     134    |
|       from large pool |     147    |     155    |     244    |      97    |
|       from small pool |     138    |     138    |     175    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    1116    |   17078 K  |   17078 K  |
|       from large pool |      49    |      91    |    8079 K  |    8079 K  |
|       from small pool |      24    |    1078    |    8999 K  |    8999 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13312 MiB | 552002 GiB | 552002 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 550593 GiB | 550593 GiB |
|       from small pool |      0 KiB |    274 MiB |   1408 GiB |   1408 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13312 MiB | 552002 GiB | 552002 GiB |
|       from large pool |  16640 KiB |  13157 MiB | 550593 GiB | 550593 GiB |
|       from small pool |      0 KiB |    274 MiB |   1408 GiB |   1408 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13266 MiB | 550447 GiB | 550447 GiB |
|       from large pool |  16640 KiB |  13110 MiB | 549041 GiB | 549041 GiB |
|       from small pool |      0 KiB |    273 MiB |   1405 GiB |   1405 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4944 MiB |  13766 MiB |  24028 MiB |  19084 MiB |
|       from large pool |   4742 MiB |  13490 MiB |  23678 MiB |  18936 MiB |
|       from small pool |    202 MiB |    276 MiB |    350 MiB |    148 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 405248 KiB |   3455 MiB | 337411 GiB | 337411 GiB |
|       from large pool | 405248 KiB |   3438 MiB | 335883 GiB | 335882 GiB |
|       from small pool |      0 KiB |     41 MiB |   1528 GiB |   1528 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6763    |   39781 K  |   39781 K  |
|       from large pool |       2    |     489    |   16417 K  |   16417 K  |
|       from small pool |       0    |    6508    |   23363 K  |   23363 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6763    |   39781 K  |   39781 K  |
|       from large pool |       2    |     489    |   16417 K  |   16417 K  |
|       from small pool |       0    |    6508    |   23363 K  |   23363 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     168    |     293    |     419    |     251    |
|       from large pool |      67    |     155    |     244    |     177    |
|       from small pool |     101    |     138    |     175    |      74    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1116    |   17079 K  |   17079 K  |
|       from large pool |       4    |      91    |    8079 K  |    8079 K  |
|       from small pool |       0    |    1078    |    9000 K  |    9000 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug 11 21:12:57 2024]
Finished job 0.
1 of 1 steps (100%) done
